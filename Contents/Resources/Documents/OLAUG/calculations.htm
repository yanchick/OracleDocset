<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-86340"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Enhancing%20Your%20Database%20with%20Analytic%C2%A0Content"></a><title>Enhancing Your Database with Analytic&nbsp;Content</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1023"/>
<meta name="dcterms.created" content="2014-06-27T10:40:4Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="OLAP User&#39;s Guide"/>
<meta name="dcterms.identifier" content="E53237-01"/>
<meta name="dcterms.isVersionOf" content="OLAUG"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="awgloss.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="query.htm" title="Previous" type="text/html"/>
<link rel="Next" href="reports.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E53237-01.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">9/17</span> <!-- End Header -->
<div id="OLAUG500" class="chapter"><a id="CIHBFBGG"></a>
<h1 class="chapter"><span class="secnum">5</span> Enhancing Your Database with Analytic&nbsp;Content</h1>
<p>Oracle OLAP provides an extensive set of analytic functions for enhancing your database with information-rich content. This chapter explains how you can use Analytic Workspace Manager to create calculated measures using templates and free-form calculations.</p>
<p>This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#CIHBADHE">What Is a Calculated Measure?</a></p>
</li>
<li>
<p><a href="#CIHHBEEA">Functions for Defining Calculations</a></p>
</li>
<li>
<p><a href="#CIHCFCGH">Creating Calculated Measures</a></p>
</li>
<li>
<p><a href="#CIHJGEJA">Using Calculation Templates</a></p>
</li>
<li>
<p><a href="#CIHDGEEA">Creating User-Defined Expressions</a></p>
</li>
<li>
<p><a href="#BABDECCE">Creating Calculated Measures Using the OLAP DML</a></p>
</li>
</ul>
<a id="CIHBADHE"></a>
<div id="OLAUG9187" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">What Is a Calculated Measure?</h2>
<p><a id="sthref348"></a>Calculated measures return values that are computed at run time from data stored in one or more measures. Like relational views, calculated measures store queries against data stored in other objects. Because calculated measures do not store data, you can create dozens of them without increasing the size of the database. You can use them as the basis for defining other calculated measures, which adds depth to the types of calculations you can create using the templates in Analytic Workspace Manager.</p>
<p>As soon as you create a calculated measure, it appears as a column in a cube view. Because calculated measures do not contain data, they are not associated with a build process. You can create a calculated measure at any time, and it is available immediately for querying by SQL applications.</p>
</div>
<!-- class="sect1" -->
<a id="CIHHBEEA"></a>
<div id="OLAUG9188" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Functions for Defining Calculations</h2>
<p>The library of functions for defining calculated measures contains these basic categories:</p>
<ul>
<li>
<p><a href="#CIHDFAGF">Arithmetic Operators</a>: Perform calculations on the values of two measures.</p>
</li>
<li>
<p><a href="#CIHCCHIB">Analytic Functions</a>: Perform calculations on an ordered series or a range of values in a single measure or column.</p>
</li>
<li>
<p><a href="#CIHBACGD">Single-Row Functions</a>: Perform calculations on a value in a single row.</p>
</li>
</ul>
<a id="CIHDFAGF"></a>
<div id="OLAUG9189" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Arithmetic Operators</h3>
<p>You can perform the following <a id="sthref349"></a>arithmetic operations using two measures. The calculations in the cube are performed on a cell-by-cell basis at all levels of the dimension hierarchies.</p>
<ul>
<li>
<p><span class="bold">Addition</span>: Adds the values of two measures.</p>
</li>
<li>
<p><span class="bold">Subtraction</span>: Subtracts the values of one measure from the values of another measure.</p>
</li>
<li>
<p><span class="bold">Multiplication</span>: Multiplies the values of two measures.</p>
</li>
<li>
<p><span class="bold">Division</span> or <span class="bold">Ratio</span>: Divides the values of one measure by the values of another measure.</p>
</li>
<li>
<p><span class="bold">Percent Difference</span>: Calculates the percent difference between the values of two measures.</p>
</li>
</ul>
<p>The arithmetic operations are available in Analytic Workspace Manager as templates. as described in <a href="#CIHJGEJA">&#34;Using Calculation Templates&#34;</a>.</p>
</div>
<!-- class="sect2" -->
<a id="CIHCCHIB"></a>
<div id="OLAUG9190" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Analytic Functions</h3>
<p>The <a id="sthref350"></a>analytic functions provide the most powerful computations and fuel the most useful queries for business intelligence and similar applications. They include a variety of rank, share, time series, and other single-column functions. The analytic functions enable analysts and decision makers to make comparisons and identify trends.</p>
<p>Analytic functions provided by Oracle OLAP leverage the knowledge associated with the dimensions about levels and family relationships. Time dimensions have additional information that enables them to support time series methods such as lags, leads, moving and cumulative calculations. Because the knowledge is stored with the dimension, you do not need to specify these relationships when creating a calculated measure.</p>
<p>The analytic functions are available in Analytic Workspace Manager as templates. They are described in <a href="#CIHJGEJA">&#34;Using Calculation Templates&#34;</a>.</p>
</div>
<!-- class="sect2" -->
<a id="CIHBACGD"></a>
<div id="OLAUG9191" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Single-Row Functions</h3>
<p>Oracle OLAP supports most of the SQL <a id="sthref351"></a>single-row functions including:</p>
<ul>
<li>
<p>Numeric functions such as <code>ABS</code>, <code>CEIL</code>, <code>FLOOR</code>, <code>POWER</code>, <code>ROUND</code>, and <code>TRUNC</code>.</p>
</li>
<li>
<p>Character functions such as <code>CONCAT</code>, <code>LPAD</code>, <code>RPAD</code>, <code>LTRIM</code>, <code>RTRIM</code>, <code>REPLACE</code>, and <code>SUBSTR</code>.</p>
</li>
<li>
<p>Datetime functions such as <code>CURRENT_DAY</code>, <code>MONTHS_BETWEEN</code>, <code>NEXT_DAY</code>, and <code>SYSTIMESTAMP</code>.</p>
</li>
<li>
<p>Comparison functions <code>GREATEST</code> and <code>LEAST</code>.</p>
</li>
<li>
<p>Conversion functions such as <code>TO_CHAR</code>, <code>TO_DATE</code>, <code>TO_NUMBER</code>, and <code>TO_TIMESTAMP</code>.</p>
</li>
</ul>
<p>You can use these functions to manipulate the data values in a measure, typically as part of a more complex calculation. These functions are not available as templates, but you can use them in free-form calculations, as described in <a href="#CIHDGEEA">&#34;Creating User-Defined Expressions&#34;</a>.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CIHCFCGH"></a>
<div id="OLAUG9192" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Creating Calculated Measures</h2>
<p><a id="sthref352"></a>Analytic Workspace Manager provides easy-to-use templates for creating calculated measures. You can create them in the same cube with the source measures, or you can create them in a separate cube.</p>
<p>Calculated measures are available for querying as additional columns in a cube view (such as <code>UNITS_CUBE_VIEW</code>). They are not available through cube materialized views (such as <code>CB$UNITS_CUBE</code>).</p>
<p><a id="sthref353"></a><a id="sthref354"></a>The calculated measure generator quickly generates the standard calculated measures for one or more measures of a cube, including rank, share, prior and future periods, period-to-date, parallel period, moving aggregates, and cumulative aggregates. The generator uses naming rules for formulating the names and descriptions. You can customize these rules on the Naming Rules tab.</p>
<p>You can also create individual calculated measures, including user-defined expressions in the OLAP expression syntax or the OLAP DML.</p>
<p class="orderedlisttitle">To create multiple calculated measures:&nbsp;</p>
<ol>
<li>
<p>In the navigation tree, right-click a cube and select <span class="bold">Generate Calculated Measures</span>.</p>
</li>
<li>
<p>On the Calculations tab, select the measures on which to base the calculated measures.</p>
</li>
<li>
<p>Scroll down the Calculation Details and select each type of calculated measure you want to create for this selection of measures. Modify the calculations as desired by altering the templates.</p>
</li>
<li>
<p>Select the Time dimension to use for time series calculations.</p>
</li>
<li>
<p>Review the list of calculated measures. You can change the generated names by using the Naming Rules tab.</p>
</li>
<li>
<p>Click <span class="bold">Generate Calculations</span> to create the calculated measures.</p>
</li>
<li>
<p>Repeat this procedure if you want to generate variations of the same basic types of calculations, such as another Share calculation for the same measure but on a different dimension. Change the naming rules to generate new, unique names.</p>
</li>
</ol>
<p><a href="#BABFAAID">Figure 5-1</a> shows the Generate Calculated Measures dialog box.</p>
<div id="OLAUG9479" class="figure">
<p class="titleinfigure"><a id="BABFAAID"></a>Figure 5-1 Generating Multiple Calculated Measures</p>
<img width="617" height="540" src="img/calc_gen.gif" alt="Description of Figure 5-1 follows"/><br/>
<a id="sthref356" href="img_text/calc_gen.htm">Description of &#34;Figure 5-1 Generating Multiple Calculated Measures&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p class="orderedlisttitle">To create a single calculated measure:&nbsp;</p>
<ol>
<li>
<p>In the navigation tree, expand a cube folder.</p>
</li>
<li>
<p>Right-click Calculated Measures, then select <span class="bold">Create Calculated Measure</span> from the context menu.</p>
<p>The Create Calculated Measure dialog box appears.</p>
</li>
<li>
<p>Enter a descriptive name.</p>
</li>
<li>
<p>Select a calculation type.</p>
<p>Your choice of an arithmetic or analytic function dynamically changes the Calculation template.</p>
</li>
<li>
<p>Modify the calculation template.</p>
</li>
<li>
<p>Click <span class="bold">Create</span>.</p>
<p>The calculated measure appears in the navigation tree in the Calculated Measures folder.</p>
</li>
<li>
<p>Select the <span class="bold">Advanced</span> option to display the References, Dependencies, and Expressions tabs. The tabs have the following information:</p>
<ul>
<li>
<p>The References tab has a table that lists the measures that Analytic Workspace Manager references as it performs the calculations specified by this calculated measure. If the Enable SQL Expressions option is selected for the cube, then the table has a check mark in the Create column for any additional calculated measure that Analytic Workspace automatically creates.</p>
</li>
<li>
<p>The Dependencies tab has a table that lists the other calculated measures that depend on this calculated measure. Analytic Workspace Manager uses this calculated measure as it performs the calculations for the measures in this table.</p>
</li>
<li>
<p>The Expressions tab has a table that lists the expressions used by the calculated measure. This tab appears only if the Enable SQL Expressions option is selected for the cube.</p>
</li>
</ul>
</li>
</ol>
<p><a href="#CIHIBJBF">Figure 5-2</a> displays the Create Calculated Measure dialog box.</p>
<div id="OLAUG9480" class="figure">
<p class="titleinfigure"><a id="CIHIBJBF"></a>Figure 5-2 Creating a Calculated Measure</p>
<img width="769" height="516" src="img/calcs_lag.gif" alt="Description of Figure 5-2 follows"/><br/>
<a id="sthref358" href="img_text/calcs_lag.htm">Description of &#34;Figure 5-2 Creating a Calculated Measure&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<a id="CIHDAHGD"></a>
<div id="OLAUG9193" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Modifying a Template</h3>
<p><a id="sthref359"></a><a id="sthref360"></a>The calculation that you selected is presented as template, which is a description of the calculation with variable parts that enable you to customize it.</p>
<p><a href="#CIHCHJDC">Figure 5-3</a> shows the template for calculating the prior period. You can view the choice lists by clicking the links.</p>
<div id="OLAUG9481" class="figure">
<p class="titleinfigure"><a id="CIHCHJDC"></a>Figure 5-3 Changing the Variable Parts of a Calculation</p>
<img width="589" height="93" src="img/calcs_measures.gif" alt="Description of Figure 5-3 follows"/><br/>
<a id="sthref361" href="img_text/calcs_measures.htm">Description of &#34;Figure 5-3 Changing the Variable Parts of a Calculation&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>You can include all values of a measure in a calculation, or, for some types of calculations, you can filter the measure to include only a selection of values. To limit one or more dimensions to a single dimension member, click the ellipses (<code>...</code>) next to the measure. The Qualify Measure dialog box appears, as shown in <a href="#CIHDIGAH">Figure 5-4</a>.</p>
<div id="OLAUG9482" class="figure">
<p class="titleinfigure"><a id="CIHDIGAH"></a>Figure 5-4 Limiting a Dimension to a Single Member</p>
<img width="360" height="241" src="img/calc_qualify.gif" alt="Description of Figure 5-4 follows"/><br/>
<a id="sthref362" href="img_text/calc_qualify.htm">Description of &#34;Figure 5-4 Limiting a Dimension to a Single Member&#34;</a><br/>
<br/></div>
<!-- class="figure" --></div>
<!-- class="sect2" -->
<a id="CIHJGIIE"></a>
<div id="OLAUG9194" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Choosing a Range of Time Periods</h3>
<p><a id="sthref363"></a><a id="sthref364"></a>Many calculations are performed over time periods at the same level in the hierarchy. In some types of calculations, you can control the range of time periods that are used in the same calculation. For example, you might want to calculate a running total of months for each fiscal year, not a running total that begins with the first month stored in the cube.</p>
<p>You can use the following methods for identifying the range of time periods to calculate together:</p>
<ul>
<li>
<p><span class="bold">Level</span>: Calculates all time periods at the same level, so that all months in the cube are included in one calculation, all quarters are included in another calculation, and so forth.</p>
</li>
<li>
<p><span class="bold">Parent</span>: Calculates all time periods with the same parent, so that all months in Q1-07 are included in one calculation, all months in Q2-07 are included in another calculation, and so forth.</p>
</li>
<li>
<p><span class="bold">Ancestor at level</span>: Calculates all time periods with the same ancestor at a specified level. For example, if the specified level is Year in a Year-Quarter-Month hierarchy, then Q1-06 to Q4-06 are included in one calculation, Q1-07 to Q4-07 are included in another calculation, Jan-06 to Dec-06 are included in a third calculation, and so forth. Any levels higher in the hierarchy are not calculated.</p>
</li>
<li>
<p><span class="bold">Gregorian periods</span>: The <a id="sthref365"></a>Gregorian periods -- Year, Quarter, Month, and Week -- impose the Gregorian calendar onto the selected hierarchy. This can be useful for analyzing data that uses nonstandard calendar hierarchies. For example, if you use Gregorian Year on a fiscal hierarchy that begins July 1 and ends June 30, then the last half of one fiscal year and the first half of the next fiscal year are calculated together. Time periods higher in the hierarchy than the specified Gregorian period are not calculated.</p>
</li>
</ul>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CIHJGEJA"></a>
<div id="OLAUG9195" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Using Calculation Templates</h2>
<p><a id="sthref366"></a>Analytic Workspace Manager provides templates for all of the calculations typically in demand for business intelligence applications. The following topics describe the types of calculations available as calculation templates in Analytic Workspace Manager.</p>
<div id="OLAUG9196" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref367"></a>
<h3 class="sect2">Arithmetic Calculations</h3>
<p>Basic mathematical operations enable you to perform cell-by-cell calculations on two measures, as described in <a href="#CIHDFAGF">&#34;Arithmetic Operators&#34;</a>.</p>
<p class="subhead2"><a id="OLAUG9483"></a>Arithmetic Example</p>
<p>This template defines a calculated measure for the Global Price Cube using Percent Difference:</p>
<pre>Percent difference between measure <span class="underline">UNIT_PRICE</span> and measure <span class="underline">UNIT_COST</span>.
</pre>
<p>A query against this calculated measure returns results like these. The <code>PCT_CHG</code> column shows the percent change between <code>PRICE</code> and <code>COST</code>, which is calculated as <code>PRICE-COST/COST</code>.</p>
<pre>PRODUCT                   PRICE       COST   PCT_DIFF
-------------------- ---------- ---------- ----------
Envoy Ambassador           2892       2664        .09
Envoy Executive            2803       2644        .06
Envoy Standard             1662       1737       -.04
Sentinel Financial         1755       1658        .06
Sentinel Multimedia        1770       1813       -.02
Sentinel Standard          1552       1410         .1
</pre></div>
<!-- class="sect2" -->
<div id="OLAUG9204" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref368"></a>
<h3 class="sect2">Index</h3>
<p><a id="sthref369"></a>An index is a mathematical operation calculated on a single measure. An index calculates the percentage difference between the values of a measure and a selected value that serves as a base number.</p>
<p>An index does not use a calculation template. Instead, it provides a list of dimension members for each dimension of the cube, from which you can choose one to use as an index, as shown in <a href="#CIHFAADE">Figure 5-5</a>.</p>
<div id="OLAUG9484" class="figure">
<p class="titleinfigure"><a id="CIHFAADE"></a>Figure 5-5 Calculating a Product Index</p>
<img width="764" height="342" src="img/calc_index.gif" alt="Description of Figure 5-5 follows"/><br/>
<a id="sthref370" href="img_text/calc_index.htm">Description of &#34;Figure 5-5 Calculating a Product Index&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p class="subhead2"><a id="OLAUG9485"></a>Index Example</p>
<p>This example creates an index on the Product dimension using <code>Desktop PCs</code> as the index.</p>
<pre>PRODUCT                   SALES PROD_INDEX
-------------------- ---------- ----------
Desktop PCs            76682955        100
Portable PCs           18072328         24
CD/DVD                 17302122         23
Modems/Fax              5565552          7
Memory                  5347292          7
Monitors                3926632          5
</pre></div>
<!-- class="sect2" -->
<div id="OLAUG9199" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref371"></a>
<h3 class="sect2">Prior and Future Periods</h3>
<p><a id="sthref372"></a><a id="sthref373"></a><a id="sthref374"></a><a id="sthref375"></a>Oracle OLAP provides several calculations for prior or future time periods:</p>
<ul>
<li>
<p><span class="bold">Prior Period</span>: Returns the value of a measure at an earlier time period.</p>
</li>
<li>
<p><span class="bold">Difference From Prior Period</span>: Calculates the difference between values for the current time period and an earlier period.</p>
</li>
<li>
<p><span class="bold">Percent Difference From Prior Period</span>: Calculates the percent difference between the values for the current time period and an earlier period.</p>
</li>
<li>
<p><span class="bold">Future Period</span>: Returns the value of a measure at a later time period.</p>
</li>
<li>
<p><span class="bold">Difference From Future Period</span>: Calculates the difference between the values for the current time period and a later period.</p>
</li>
<li>
<p><span class="bold">Percent Difference From Future Period</span>: Calculates the percent difference between the values for the current time period and a later period.</p>
</li>
</ul>
<p>When creating a calculation for prior or future time periods, you choose the measure, the time dimension, the hierarchy, and the number of periods from the current period.</p>
<p class="subhead2"><a id="OLAUG9486"></a>Prior Period Example</p>
<p>This template defines a calculated measure using Prior Period:</p>
<pre>Prior period for measure <span class="underline">SALES</span> in <span class="underline">TIME</span> dimension and <span class="underline">TIME.CALENDAR</span> hierarchy <span class="underline">1</span> period ago.
</pre>
<p>These are the results of a query against the calculated measure. The <code>PRIOR_PERIOD</code> column shows the value of Sales for the preceding period at the same level in the Calendar hierarchy.</p>
<pre>TIME     TIME_LEVEL                SALES PRIOR_PERIOD
-------- -------------------- ---------- ------------
2005     CALENDAR_YEAR         136986572    144290686
2006     CALENDAR_YEAR         140138317    136986572
Q1.05    CALENDAR_QUARTER       31381338     41988687
Q2.05    CALENDAR_QUARTER       37642741     31381338
Q3.05    CALENDAR_QUARTER       32617249     37642741
Q4.05    CALENDAR_QUARTER       35345244     32617249
Q1.06    CALENDAR_QUARTER       36154815     35345244
Q2.06    CALENDAR_QUARTER       36815657     36154815
Q3.06    CALENDAR_QUARTER       32318935     36815657
Q4.06    CALENDAR_QUARTER       34848911     32318935
</pre></div>
<!-- class="sect2" -->
<div id="OLAUG9201" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref376"></a>
<h3 class="sect2">Period to Date</h3>
<p>Period-to-date functions perform a calculation over time periods with the same parent up to the current period. These functions calculate period-to-date:</p>
<ul>
<li>
<p><a id="sthref377"></a><span class="bold">Period to Date</span>: Calculates the values up to the current time period.</p>
</li>
<li>
<p><span class="bold">Period to Date Period Ago</span>: Calculates the data values up to a prior time period.</p>
</li>
<li>
<p><span class="bold">Difference From Period to Date Period Ago</span>: Calculates the difference in data values up to the current time period compared to the same calculation up to a prior period.</p>
</li>
<li>
<p><span class="bold">Percent Difference From Period To Date Period Ago</span>: Calculates the percent difference in data values up to the current time period compared to the same calculation up to a prior period.</p>
</li>
</ul>
<p>When creating a period-to-date calculation, you can choose from these aggregation methods:</p>
<ul>
<li>
<p>Sum</p>
</li>
<li>
<p>Average</p>
</li>
<li>
<p>Maximum</p>
</li>
<li>
<p>Minimum</p>
</li>
</ul>
<p>You also choose the measure, the time dimension, and the hierarchy.</p>
<p class="subhead2"><a id="OLAUG9487"></a>Period to Date Example</p>
<p>This template defines a calculated measure using Period to Date.</p>
<pre><span class="underline">Gregorian Year</span> to date for <span class="underline">SALES</span> in the <span class="underline">TIME</span> dimension and <span class="underline">TIME.CALENDAR</span> hierarchy. Aggregate using <span class="underline">MINIMUM</span> from the <span class="underline">beginning</span> of the period.
</pre>
<p>These are the results of a query against the calculated measure. The <code>MIN_TO_DATE</code> column displays the current minimum <code>SALES</code> value within the current level and year.</p>
<pre>TIME     TIME_LEVEL                SALES MIN_TO_DATE
-------- -------------------- ---------- -----------
Q1.06    CALENDAR_QUARTER       36154815    36154815
Q2.06    CALENDAR_QUARTER       36815657    36154815
Q3.06    CALENDAR_QUARTER       32318935    32318935
Q4.06    CALENDAR_QUARTER       34848911    32318935
JAN-06   MONTH                  13119235    13119235
FEB-06   MONTH                  11441738    11441738
MAR-06   MONTH                  11593842    11441738
APR-06   MONTH                  11356940    11356940
MAY-06   MONTH                  13820218    11356940
JUN-06   MONTH                  11638499    11356940
JUL-06   MONTH                   9417316     9417316
AUG-06   MONTH                  11596052     9417316
SEP-06   MONTH                  11305567     9417316
OCT-06   MONTH                  11780401     9417316
NOV-06   MONTH                  10653184     9417316
DEC-06   MONTH                  12415325     9417316
</pre></div>
<!-- class="sect2" -->
<div id="OLAUG9198" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref378"></a>
<h3 class="sect2">Share</h3>
<p><a id="sthref379"></a>Share calculates the ratio of a measure&#39;s value for the current dimension member to the value for a related member of the same dimension. You can choose whether the related member is:</p>
<ul>
<li>
<p><span class="bold">Top of hierarchy</span>: Calculates the ratio of each member to the total.</p>
</li>
<li>
<p><span class="bold">Member&#39;s parent</span>: Calculates the ratio of each member to its parent.</p>
</li>
<li>
<p><span class="bold">Member&#39;s ancestor at level</span>: Calculates the ratio of each member to its ancestor, that is, a member at a specified level higher in the hierarchy.</p>
</li>
</ul>
<p>When creating a share calculation, you can choose the measure, dimension, and hierarchy. You also have the option of multiplying the results by 100 to get percentages instead of fractions.</p>
<p class="subhead2"><a id="OLAUG9488"></a>Share Example</p>
<p>This template defines a calculated measure using <code>SHARE</code>:</p>
<pre>Share of measure <span class="underline">SALES</span> in <span class="underline">PRODUCT.PRIMARY</span> hierarchy of the <span class="underline">PRODUCT</span> dimension as a ratio of <span class="underline">top of hierarchy</span>.
</pre>
<p>These are the results of a query against the calculated measure. The <code>TOTAL_SHARE</code> column displays the percent share of the total for the selected products.</p>
<pre>PRODUCT              PROD_LEVEL           SALES TOTAL_SHARE
-------------------- --------------- ---------- -----------
Total Product        TOTAL            144290686         100
Hardware             CLASS            130145388          90
Desktop PCs          FAMILY            78770152          55
Portable PCs         FAMILY            19066575          13
CD/DVD               FAMILY            16559860          11
Software/Other       CLASS             14145298          10
Accessories          FAMILY             6475353           4
Operating Systems    FAMILY             5738775           4
Memory               FAMILY             5430466           4
Modems/Fax           FAMILY             5844185           4
Monitors             FAMILY             4474150           3
Documentation        FAMILY             1931170           1
</pre></div>
<!-- class="sect2" -->
<div id="OLAUG9197" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref380"></a>
<h3 class="sect2">Rank</h3>
<p>Rank orders the values of a dimension based on the values of the selected measure. When defining a rank calculation, you choose the dimension, a hierarchy, and the measure.</p>
<p>You can choose a method for handling identical values:</p>
<ul>
<li>
<p><span class="bold"><a id="sthref381"></a>Rank</span>: Assigns the same rank to identical values, so there may be fewer ranks than there are members. For example, it may return <code>1</code>, <code>2</code>, <code>3</code>, <code>3</code>, <code>4</code> for a series of five dimension members.</p>
</li>
<li>
<p><a id="sthref382"></a><span class="bold">Dense Rank</span>: Assigns the same minimum rank to identical values. For example, it may return <code>1</code>, <code>2</code>, <code>3</code>, <code>3</code>, <code>5</code> for a series of five dimension members.</p>
</li>
<li>
<p><span class="bold"><a id="sthref383"></a>Average Rank</span>: Assigns the same average rank to identical values. For example, it may return <code>1</code>, <code>2</code>, <code>3.5</code>, <code>3.5</code>, <code>5</code> for a series of five dimension members.</p>
</li>
</ul>
<p>You can also choose the group in which the dimension members are ranked:</p>
<ul>
<li>
<p><span class="bold">Member&#39;s level</span>: Ranks members at the same level.</p>
</li>
<li>
<p><span class="bold">Member&#39;s parent</span>: Ranks members with the same parent.</p>
</li>
<li>
<p><span class="bold">Member&#39;s ancestor at level</span>: Ranks members with the same ancestor at a specified level higher in the hierarchy.</p>
</li>
</ul>
<p class="subhead2"><a id="OLAUG9489"></a>Rank Example</p>
<p>This template defines a calculated measure using Rank:</p>
<pre>Rank members of the <span class="underline">PRODUCT</span> dimension and <span class="underline">PRODUCT.PRIMARY</span> hierarchy based on measure <span class="underline">SALES</span>. Calculate rank using <span class="underline">RANK</span> method with <span class="underline">member&#39;s parent</span> in order <span class="underline">lowest to highest</span>. Rank NA (null) values <span class="underline">nulls last</span>.
</pre>
<p>These are the results of a query against the calculated measure in which the products are ordered by <code>RANK</code>:</p>
<pre>PRODUCT                   SALES       RANK
-------------------- ---------- ----------
Monitors                4474150          1
Memory                  5430466          2
Modems/Fax              5844185          3
CD/DVD                 16559860          4
Portable PCs           19066575          5
Desktop PCs            78770152          6
</pre></div>
<!-- class="sect2" -->
<div id="OLAUG9200" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref384"></a>
<h3 class="sect2">Parallel Period</h3>
<p><a id="sthref385"></a>Parallel periods are at the same level as the current time period, but have different parents in an earlier period. For example, you may want to compare current sales with sales for the prior year at the quarter and month levels.</p>
<p>Oracle OLAP provides several functions for parallel periods:</p>
<ul>
<li>
<p><span class="bold">Parallel Period</span>: Calculates the value of the parallel period.</p>
</li>
<li>
<p><span class="bold">Difference From Parallel Period</span>: Calculates the difference in values between the current period and the parallel period.</p>
</li>
<li>
<p><span class="bold">Percent Difference From Parallel Period</span>: Calculates the percent difference in values between the current period and the parallel period.</p>
</li>
</ul>
<p>To identify the parallel period, you specify a level and the number of periods before the current period. You can also decide what happens when two periods do not exactly match, such as comparing daily sales for February (28 days) with January (31 days).</p>
<p>You also choose the measure, the time dimension, and the hierarchy.</p>
<p class="subhead2"><a id="OLAUG9490"></a>Parallel Period Example</p>
<p>This template defines a calculated measure using Parallel Period.</p>
<pre><span class="underline">Parallel period</span> for <span class="underline">SALES</span> in the <span class="underline">TIME</span> dimension and <span class="underline">TIME.CALENDAR</span> hierarchy <span class="underline">1</span> <span class="underline">TIME.CALENDAR.QUARTER</span> ago based on position from <span class="underline">beginning to ending</span> of period.
</pre>
<p>These are the results of a query against the calculated measure, which lists the months for two calendar quarters. The parallel month has the same position within the previous quarter. The prior period for <code>JUL-06</code> is <code>APR-06,</code> for <code>AUG-06</code> is <code>MAY-06</code>, and for <code>SEP-06</code> is <code>JUN-06</code>.</p>
<pre>TIME     PARENT          SALES   LAST_QTR
-------- ---------- ---------- ----------
APR-06   CY2006.Q2    11356940   13119235
MAY-06   CY2006.Q2    13820218   11441738
JUN-06   CY2006.Q2    11638499   11593842
JUL-06   CY2006.Q3     9417316   11356940
AUG-06   CY2006.Q3    11596052   13820218
SEP-06   CY2006.Q3    11305567   11638499
</pre></div>
<!-- class="sect2" -->
<div id="OLAUG9203" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref386"></a>
<h3 class="sect2">Moving Calculations</h3>
<p><a id="sthref387"></a><a id="sthref388"></a><a id="sthref389"></a><a id="sthref390"></a><a id="sthref391"></a>Moving calculations are performed over the time periods surrounding the current period. Oracle OLAP provides several aggregation methods for moving calculations:</p>
<ul>
<li>
<p><span class="bold">Moving Average</span>: Calculates the average value for a measure over a fixed number of time periods.</p>
</li>
<li>
<p><span class="bold">Moving Maximum</span>: Calculates the maximum value for a measure over a fixed number of time periods.</p>
</li>
<li>
<p><span class="bold">Moving Minimum</span>: Calculates the minimum value for a measure over a fixed number of time periods.</p>
</li>
<li>
<p><span class="bold">Moving Total</span>: Returns the total value for a measure over a fixed number of time periods.</p>
</li>
</ul>
<p>You can choose the measure, the time dimension, and the hierarchy. You can also select the range, as described in <a href="#CIHJGIIE">&#34;Choosing a Range of Time Periods&#34;</a>, and the number of time periods before and after the current period to include in the calculation.</p>
<p class="subhead2"><a id="OLAUG9491"></a>Moving Calculation Example</p>
<p>This template defines a calculated measure using Moving Minimum.</p>
<pre>Moving minimum of <span class="underline">SALES</span> in the <span class="underline">TIME</span> dimension and <span class="underline">TIME.CALENDAR</span> hierarchy. Include <span class="underline">1</span> preceding and <span class="underline">1</span> following members within <span class="underline">level</span>.
</pre>
<p>These are the results of a query against the calculated measure, which displays values for the descendants of calendar year 2004. Each value of Minimum Sales is the smallest among the current value and the values immediately before and after it. The calculation is performed over all members of a level in the cube.</p>
<pre>TIME     TIME_LEVEL                SALES  MIN_SALES
-------- -------------------- ---------- ----------
Q1.04    CALENDAR_QUARTER       32977874   32977874
Q2.04    CALENDAR_QUARTER       35797921   32977874
Q3.04    CALENDAR_QUARTER       33526203   33526203
Q4.04    CALENDAR_QUARTER       41988687   31381338
JAN-04   MONTH                  11477898   10982016
FEB-04   MONTH                  10982016   10517960
MAR-04   MONTH                  10517960   10517960
APR-04   MONTH                  11032057   10517960
MAY-04   MONTH                  11432616   11032057
JUN-04   MONTH                  13333248   11432616
JUL-04   MONTH                  12070352   11108893
AUG-04   MONTH                  11108893   10346958
SEP-04   MONTH                  10346958   10346958
OCT-04   MONTH                  14358605   10346958
NOV-04   MONTH                  12757560   12757560
DEC-04   MONTH                  14872522   12093518
</pre></div>
<!-- class="sect2" -->
<div id="OLAUG9202" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref392"></a>
<h3 class="sect2">Cumulative Calculations</h3>
<p><a id="sthref393"></a><a id="sthref394"></a><a id="sthref395"></a><a id="sthref396"></a><a id="sthref397"></a>Cumulative calculations start with the first time period and calculate up to the current member, or start with the last time period and calculate back to the current member. Oracle OLAP provides several aggregation methods for cumulative calculations:</p>
<ul>
<li>
<p><span class="bold">Cumulative Average</span>: Calculates a running average across time periods.</p>
</li>
<li>
<p><span class="bold">Cumulative Maximum</span>: Calculates the maximum value across time periods.</p>
</li>
<li>
<p><span class="bold">Cumulative Minimum</span>: Calculates the minimum value across time periods.</p>
</li>
<li>
<p><span class="bold">Cumulative Total</span>: Calculates a running total across time periods.</p>
</li>
</ul>
<p>You can choose the measure, the time dimension, and the hierarchy. You can also select the range, as described in <a href="#CIHJGIIE">&#34;Choosing a Range of Time Periods&#34;</a>, and whether you want to start the calculation with the first period and calculate forward, or start with the last period and calculate back.</p>
<p class="subhead2"><a id="CIHHJBGJ"></a><a id="OLAUG9492"></a>Cumulative Calculation Example</p>
<p>This template defines a calculated measure using Cumulative Minimum.</p>
<pre>Cumulative minimum of <span class="underline">SALES</span> in the <span class="underline">TIME</span> dimension and <span class="underline">TIME.CALENDAR</span> hierarchy within <span class="underline">ancestor at level</span> <span class="underline">TIME.CALENDAR_YEAR</span>. Total from <span class="underline">beginning to current</span> member.
</pre>
<p>These are the results of a query against the calculated measure, which displays values for the descendants of calendar year 2004. The minimum value for quarters begins with Q1-04 and ends with Q4-04, and for months begins with Jan-04 and ends with Dec-04.</p>
<pre>TIME     TIME_LEVEL                SALES  MIN_SALES
-------- -------------------- ---------- ----------
Q1.04    CALENDAR_QUARTER       32977874   32977874
Q2.04    CALENDAR_QUARTER       35797921   32977874
Q3.04    CALENDAR_QUARTER       33526203   32977874
Q4.04    CALENDAR_QUARTER       41988687   32977874
JAN-04   MONTH                  11477898   11477898
FEB-04   MONTH                  10982016   10982016
MAR-04   MONTH                  10517960   10517960
APR-04   MONTH                  11032057   10517960
MAY-04   MONTH                  11432616   10517960
JUN-04   MONTH                  13333248   10517960
JUL-04   MONTH                  12070352   10517960
AUG-04   MONTH                  11108893   10517960
SEP-04   MONTH                  10346958   10346958
OCT-04   MONTH                  14358605   10346958
NOV-04   MONTH                  12757560   10346958
DEC-04   MONTH                  14872522   10346958
</pre></div>
<!-- class="sect2" -->
<div id="OLAUG9205" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref398"></a>
<h3 class="sect2">Nested Calculations</h3>
<p><a id="sthref399"></a><a id="sthref400"></a>You can extend the variety of functions available through the templates by using a calculated measure as the basis for another calculated measure.</p>
<p>For example, Analytic Workspace Manager has templates for Moving Average and for Difference From Prior Period. You can create a calculated measure that calculates a moving average, then calculate the difference between the current and the previous moving averages.</p>
<p class="subhead2"><a id="OLAUG9493"></a>Nested Calculations Example</p>
<p>This template creates a moving average for Units named <code>UNITS_MOVING_AVG</code>:</p>
<pre>Moving average of UNITS in the TIME dimension and TIME.CALENDAR hierarchy. Include 1 preceding and 1 following members within level.
</pre>
<p>The next template creates a Difference From Prior Period calculation from <code>UNITS_MOVING_AVG</code>.</p>
<pre>Difference from prior period for <span class="underline">UNITS_MOVING_AVG</span> in TIME dimension and <span class="underline">TIME.CALENDAR</span> hierarchy <span class="underline">1</span> period ago.
</pre>
<p>These are the results of a query against the Units measure and the two calculated measures. The <code>MOVING_AVG</code> column shows the moving average, and the <code>DIFF</code> column shows the difference between the current moving average and the prior period&#39;s.</p>
<pre>TIME     TIME_LEVEL                UNITS MOVING_AVG       DIFF
-------- -------------------- ---------- ---------- ----------
JAN-06   MONTH                     47776      48520         66
FEB-06   MONTH                     47695      48940        419
MAR-06   MONTH                     51348      48683       -257
APR-06   MONTH                     47005      50387       1705
MAY-06   MONTH                     52809      48411      -1976
JUN-06   MONTH                     45419      48872        461
JUL-06   MONTH                     48388      47546      -1326
AUG-06   MONTH                     48830      47857        312
SEP-06   MONTH                     46354      47532       -326
OCT-06   MONTH                     47411      46869       -663
NOV-06   MONTH                     46842      49768       2899
DEC-06   MONTH                     55052      50947       1179
2006     CALENDAR_YEAR            584929     575324      -4032
Q1.06    CALENDAR_QUARTER         146819     145705       2093
Q2.06    CALENDAR_QUARTER         145233     145208       -497
Q3.06    CALENDAR_QUARTER         143572     146037        829
Q4.06    CALENDAR_QUARTER         149305     146439        402
</pre></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CIHDGEEA"></a>
<div id="OLAUG9206" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Creating User-Defined Expressions</h2>
<p><a id="sthref401"></a><a id="sthref402"></a>Among the calculation types is a user-defined expression. Typically, you create calculations using the OLAP expression syntax, which includes the analytic functions, arithmetic operators, and single-row functions described in this chapter. The OLAP syntax is an extension of the SQL syntax. If you have used SQL analytic functions or single-row functions, then this syntax is familiar to you.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
For user-defined OLAP DML expressions, see <a href="#BABDECCE">&#34;Creating Calculated Measures Using the OLAP DML&#34;</a>.</div>
<div id="OLAUG9494" class="sect2"><a id="sthref403"></a>
<h3 class="sect2">Using the OLAP Expression Syntax</h3>
<p>The easiest way to formulate an expression in the OLAP expression syntax is to let Analytic Workspace Manager do the work for you. You can use the templates to create a similar calculation, and cut-and-paste the syntax as the basis for a new calculation.</p>
<p class="orderedlisttitle">To create a user-defined expression in the OLAP expression syntax:&nbsp;</p>
<ol>
<li>
<p>Open the Create Calculated Measure dialog box.</p>
</li>
<li>
<p>Select the calculation type that most closely matches the one you want to define.</p>
</li>
<li>
<p>Modify the template as desired.</p>
</li>
<li>
<p>Cut-and-paste the calculation from the Calculation box into a text editor.</p>
</li>
<li>
<p>Repeat these steps if your calculation uses two or more functions.</p>
</li>
<li>
<p>Modify the calculation as desired in the text editor. You can combine numeric operators, analytic functions, and single-row functions in a single calculation.</p>
</li>
<li>
<p>From the Calculation Types list, select <span class="bold">OLAP Expression Syntax</span>.</p>
</li>
<li>
<p>Cut-and-paste the calculation from the text editor into the Calculation box.</p>
</li>
<li>
<p>Click <span class="bold">Create</span>.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
Analytic Workspace Manager Help for detailed information about the OLAP expression syntax.</div>
</div>
<!-- class="sect2" -->
<a id="BABCHFHE"></a>
<div id="OLAUG9495" class="sect2">
<h3 class="sect2">Expression Syntax Example Using an Arithmetic Operator</h3>
<p>This template for Multiplication generates a calculation using Units Sold and Unit Cost.</p>
<pre>Multiply measure <span class="underline">UNITS</span> by measure <span class="underline">UNIT_COST</span>.
</pre>
<p>The template generates this calculation using the multiplication operator (*). It appears in the Calculation box. Notice that UNITS is in the Units Cube and UNIT_COST is in the Price Cube.</p>
<pre>UNITS_CUBE.UNITS * PRICE_CUBE.UNIT_COST
</pre>
<p>The syntax of this calculation is so simple that you only need the template to obtain the qualified name of the measure.</p>
<p>Following is a free-form calculation that calculates a 2% increase in units sold:</p>
<pre>UNITS_CUBE.UNITS * 1.02
</pre>
<p>These are the results of a query against this calculated measure:</p>
<pre>PRODUCT                   UNITS     TARGET
-------------------- ---------- ----------
Envoy Ambassador           2116       2158
Envoy Executive            2481       2531
Envoy Standard             3300       3366
Sentinel Financial        30513      31123
Sentinel Multimedia        7948       8107
Sentinel Standard          7302       7448
</pre></div>
<!-- class="sect2" -->
<a id="BABHDGBC"></a>
<div id="OLAUG9496" class="sect2">
<h3 class="sect2">Free-Form Calculation Example Using an Analytic Function</h3>
<p>This template for Cumulative Average generates a calculation for the average number of units sold:</p>
<pre>Cumulative average of <span class="underline">UNITS</span> in the <span class="underline">TIME</span> dimension and <span class="underline">TIME.CALENDAR</span> hierarchy within <span class="underline">level</span>. Total from <span class="underline">beginning to following</span> member.
</pre>
<p>The template generates this calculation using the <code>AVG</code> function.</p>
<pre>AVG(UNITS_CUBE.UNITS) OVER HIERARCHY (TIME.CALENDAR BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING WITHIN LEVEL)
</pre>
<p>Following is a free-form calculation that computes the percent difference between current units sold and the cumulative average. It uses the <code>AVG</code> function and the subtraction (<code>-</code>), division (<code>/</code>) and multiplication (<code>*</code>) operators.</p>
<pre>((UNITS_CUBE.UNITS - AVG(UNITS_CUBE.UNITS) OVER HIERARCHY (TIME.CALENDAR BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING WITHIN LEVEL)) / AVG(UNITS_CUBE.UNITS) OVER HIERARCHY (TIME.CALENDAR BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING WITHIN LEVEL)) * 100
</pre>
<p>These are the results of a query against this calculated measure.</p>
<pre>TIME          UNITS    CUM_AVG   PCT_DIFF
-------- ---------- ---------- ----------
Q1.06        146819     107965         36
Q2.06        145233     109062         33
Q3.06        143572     110048         30
Q4.06        149305     111138         34
</pre>
<p>You could also create this calculation using templates:</p>
<ol>
<li>
<p>Calculate the cumulative average of <code>UNITS</code> with the Cumulative Average template.</p>
</li>
<li>
<p>Calculate the percent difference between current <code>UNITS</code> and the cumulative average with the Percent Difference template.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<div id="OLAUG9497" class="sect2"><a id="sthref405"></a>
<h3 class="sect2">Expression Syntax Analytic Functions</h3>
<p><a href="#CIHBEFFH">Table 5-1</a> describes the <a id="sthref406"></a>analytic functions that you can use to create free-form calculations using the OLAP expression syntax. For the syntax of these functions, refer to Analytic Workspace Manager Help.</p>
<div id="OLAUG9498" class="tblhruleformal">
<p class="titleintable"><a id="sthref407"></a><a id="CIHBEFFH"></a>Table 5-1 OLAP Expression Syntax Analytic Functions</p>
<table class="cellalignment3633" title="OLAP Expression Syntax Analytic Functions" summary="Descriptions of OLAP analytic functions" dir="ltr">
<thead>
<tr class="cellalignment3624">
<th class="cellalignment3634" id="r1c1-t4">Function</th>
<th class="cellalignment3634" id="r1c2-t4">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r2c1-t4" headers="r1c1-t4">
<p><a id="sthref408"></a><code>AVERAGE_RANK</code></p>
</td>
<td class="cellalignment3630" headers="r2c1-t4 r1c2-t4">
<p>Orders the members of a dimension based on the values of an expression. The function returns the sequence numbers of the dimension members, and assigns the same average rank to identical values.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r3c1-t4" headers="r1c1-t4">
<p><code><a id="sthref409"></a>AVG</code></p>
</td>
<td class="cellalignment3630" headers="r3c1-t4 r1c2-t4">
<p>Returns the average of a selection of values calculated over time.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r4c1-t4" headers="r1c1-t4">
<p><code>COUNT</code></p>
</td>
<td class="cellalignment3630" headers="r4c1-t4 r1c2-t4">
<p>Tallies the number of data values identified by a selection of dimension members.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r5c1-t4" headers="r1c1-t4">
<p><code><a id="sthref410"></a>DENSE_RANK</code></p>
</td>
<td class="cellalignment3630" headers="r5c1-t4 r1c2-t4">
<p>Orders dimension members based on the values of an expression. The function returns the sequence numbers of the dimension members, and assigns the same minimum rank to identical values.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r6c1-t4" headers="r1c1-t4">
<p><code><a id="sthref411"></a>HIER_ANCESTOR</code></p>
</td>
<td class="cellalignment3630" headers="r6c1-t4 r1c2-t4">
<p>Returns an ancestor at a particular level of a hierarchy for either all members in the hierarchy or a particular member.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r7c1-t4" headers="r1c1-t4">
<p><code><a id="sthref412"></a>HIER_CHILD_COUNT</code></p>
</td>
<td class="cellalignment3630" headers="r7c1-t4 r1c2-t4">
<p>Returns the number of children of either all dimension members in a hierarchy or a particular member.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r8c1-t4" headers="r1c1-t4">
<p><code><a id="sthref413"></a>HIER_DEPTH</code></p>
</td>
<td class="cellalignment3630" headers="r8c1-t4 r1c2-t4">
<p>Returns a number representing the level depth of either all members of a hierarchy or a particular member, where 0 is the top level.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r9c1-t4" headers="r1c1-t4">
<p><code><a id="sthref414"></a>HIER_LEVEL</code></p>
</td>
<td class="cellalignment3630" headers="r9c1-t4 r1c2-t4">
<p>Returns the level of either all members of a hierarchy or a particular member.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r10c1-t4" headers="r1c1-t4">
<p><a id="sthref415"></a><code>HIER_PARENT</code></p>
</td>
<td class="cellalignment3630" headers="r10c1-t4 r1c2-t4">
<p>Returns the parent of either all dimension members in a hierarchy or a particular member.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r11c1-t4" headers="r1c1-t4">
<p><code><a id="sthref416"></a>HIER_TOP</code></p>
</td>
<td class="cellalignment3630" headers="r11c1-t4 r1c2-t4">
<p>Returns the topmost ancestor of either all members of a hierarchy or a particular member.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r12c1-t4" headers="r1c1-t4">
<p><code><a id="sthref417"></a>LAG</code></p>
</td>
<td class="cellalignment3630" headers="r12c1-t4 r1c2-t4">
<p>Returns the value of an expression at a specified number of time periods before the current period.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r13c1-t4" headers="r1c1-t4">
<p><code><a id="sthref418"></a>LAG_VARIANCE</code></p>
</td>
<td class="cellalignment3630" headers="r13c1-t4 r1c2-t4">
<p>Returns the difference between values for the current time period and a prior period.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r14c1-t4" headers="r1c1-t4">
<p><code><a id="sthref419"></a>LAG_VARIANCE_PERCENT</code></p>
</td>
<td class="cellalignment3630" headers="r14c1-t4 r1c2-t4">
<p>Returns the percent different between values for the current time period and a prior period.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r15c1-t4" headers="r1c1-t4">
<p><code><a id="sthref420"></a>LEAD</code></p>
</td>
<td class="cellalignment3630" headers="r15c1-t4 r1c2-t4">
<p>Returns the value of an expression at a specified number of time periods after the current period.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r16c1-t4" headers="r1c1-t4">
<p><code><a id="sthref421"></a>LEAD_VARIANCE</code></p>
</td>
<td class="cellalignment3630" headers="r16c1-t4 r1c2-t4">
<p>Returns the difference between values for the current time period and a future period.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r17c1-t4" headers="r1c1-t4">
<p><code><a id="sthref422"></a>LEAD_VARIANCE_PERCENT</code></p>
</td>
<td class="cellalignment3630" headers="r17c1-t4 r1c2-t4">
<p>Returns the percent different between values for the current time period and a future period.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r18c1-t4" headers="r1c1-t4">
<p><code><a id="sthref423"></a>MAX</code></p>
</td>
<td class="cellalignment3630" headers="r18c1-t4 r1c2-t4">
<p>Returns the largest of a selection of data values calculated over a particular dimension.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r19c1-t4" headers="r1c1-t4">
<p><code><a id="sthref424"></a>MIN</code></p>
</td>
<td class="cellalignment3630" headers="r19c1-t4 r1c2-t4">
<p>Returns the smallest of a selection of data values calculated over a particular dimension.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r20c1-t4" headers="r1c1-t4">
<p><code>OLAP_DML_EXPRESSION</code></p>
</td>
<td class="cellalignment3630" headers="r20c1-t4 r1c2-t4">
<p>Executes an expression in the OLAP DML language.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r21c1-t4" headers="r1c1-t4">
<p><code><a id="sthref425"></a>RANK</code></p>
</td>
<td class="cellalignment3630" headers="r21c1-t4 r1c2-t4">
<p>Orders the members of a dimension based on the values of an expression. The function returns the sequence numbers of the dimension members, and assigns the same rank to identical values.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r22c1-t4" headers="r1c1-t4">
<p><code><a id="sthref426"></a>ROW_NUMBER</code></p>
</td>
<td class="cellalignment3630" headers="r22c1-t4 r1c2-t4">
<p>Orders the members of a dimension based on the values of an expression. The function returns the sequence numbers of the dimension members, and assigns a unique and arbitrary rank to identical values.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r23c1-t4" headers="r1c1-t4">
<p><code><a id="sthref427"></a>SHARE</code></p>
</td>
<td class="cellalignment3630" headers="r23c1-t4 r1c2-t4">
<p>Calculates the ratio of an expression&#39;s value for the current dimension member to the value for a related member of the same dimension.</p>
</td>
</tr>
<tr class="cellalignment3624">
<td class="cellalignment3630" id="r24c1-t4" headers="r1c1-t4">
<p><code><a id="sthref428"></a>SUM</code></p>
</td>
<td class="cellalignment3630" headers="r24c1-t4 r1c2-t4">
<p>Returns the total of a selection of values calculated over a particular dimension.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblhruleformal" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABDECCE"></a>
<div id="OLAUG9499" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Creating Calculated Measures Using the <a id="sthref429"></a>OLAP DML</h2>
<p>The most advanced business calculations, such as forecasts, models, and allocations, are available through the <a href="awgloss.htm#BABIJEBF"><span class="xrefglossterm">OLAP DML</span></a>. The OLAP DML is the internal data definition and manipulation language for analytic workspaces. Its primary data structures are dimensions, variables, formulas, and valuesets. These dimensional objects in an analytic workspace support the high-level dimensional objects in the database, such as cubes, cube dimensions, measures, attributes, and hierarchies.</p>
<p>Several commands in the OLAP DML support dimensional database objects such as cubes, levels, and hierarchies. You can use these commands, as well as the other functions, operators, and so forth in the language.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
&#34;Cube-Aware OLAP DML Statements&#34; in the <a class="olink OLADM1043" href="../OLADM/dml_basics.htm#OLADM1043"><span class="italic">Oracle OLAP DML Reference</span></a></div>
<p>The OLAP DML is a mature language that was developed specifically for creating and managing dimensional objects and for manipulating dimensional data. Although programming in the OLAP DML requires significant skill, the language offers more power and flexibility than any other language.</p>
<div id="OLAUG9500" class="sect2"><a id="sthref430"></a>
<h3 class="sect2">Selecting an OLAP DML Calculation Type</h3>
<p>Analytic Workspace Manager supports two types of user-defined expressions using the OLAP DML:</p>
<ul>
<li>
<p><span class="bold">OLAP DML Expression</span>: Calculates an OLAP DML expression. Choose this calculation type to execute an existing program, a built-in function, or a single expression. The expression is stored as the EQ statement of a formula in the analytic workspace.</p>
</li>
<li>
<p><span class="bold">OLAP DML Function</span>: Executes an OLAP DML program entered in the Program Body field that returns values. Choose this calculation type to develop a new program in the OLAP DML. The name of the program is stored in the EQ statement of a formula in the analytic workspace.</p>
</li>
</ul>
<p class="orderedlisttitle">To create an OLAP DML Expression:&nbsp;</p>
<ol>
<li>
<p>Open the Create Calculated Measure dialog box.</p>
</li>
<li>
<p>From the Calculation Types list, select <span class="bold">OLAP DML Expression</span>.</p>
</li>
<li>
<p>For Data Type, select the data type of the return value.</p>
</li>
<li>
<p>Enter the expression in the OLAP DML field.</p>
</li>
<li>
<p>Click <span class="bold">Compile Expression</span> to check for syntax errors and to save a compiled version of the expression.</p>
</li>
<li>
<p>Click <span class="bold">Create</span> to create the calculated measure.</p>
</li>
</ol>
<p class="orderedlisttitle">To create an OLAP DML Function:&nbsp;</p>
<ol>
<li>
<p>Open the Create Calculated Measure dialog box.</p>
</li>
<li>
<p>From the Calculation Types list, select <span class="bold">OLAP DML Function.</span></p>
</li>
<li>
<p>For Data Type, select the data type of the return value.</p>
</li>
<li>
<p>Enter a name for the function.</p>
</li>
<li>
<p>Enter the program in the Program Body field. Omit the <code>DEFINE</code>, <code>PROGRAM</code>, and <code>END</code> commands, because they are generated automatically.</p>
</li>
<li>
<p>Click <span class="bold">Compile Expression</span> to check for syntax errors and to save a compiled version of the program.</p>
</li>
<li>
<p>Click <span class="bold">Create</span> to create the calculated measure.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<div id="OLAUG9501" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref433"></a>
<h3 class="sect2">OLAP DML Expression Examples</h3>
<p>The OLAP DML has many built-in functions. This example creates a calculated measure using the <code>RANDOM</code> function. <a href="#BABECJDJ">Figure 5-6</a> shows the definition of this simple calculation. The calculated measure generates values in the default range of 0 to 1.</p>
<div id="OLAUG9502" class="figure">
<p class="titleinfigure"><a id="BABECJDJ"></a>Figure 5-6 Using an OLAP DML Expression</p>
<img width="286" height="178" src="img/dml_express.gif" alt="Description of Figure 5-6 follows"/><br/>
<a id="sthref434" href="img_text/dml_express.htm">Description of &#34;Figure 5-6 Using an OLAP DML Expression&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>The next example uses an arithmetic operator to calculate a 2% increase in units sold. This example of the OLAP DML is identical to the example in <a href="#BABCHFHE">&#34;Expression Syntax Example Using an Arithmetic Operator&#34;</a>. However, note the difference in naming convention for the measure.</p>
<pre>units_cube_units * 1.02
</pre>
<p>These are the results of a query against the two calculated measures created as OLAP DML expressions:</p>
<pre>PRODUCT                   UNITS     TARGET     RANDOM
-------------------- ---------- ---------- ----------
Envoy Ambassador           2116       2158      .6467
Envoy Executive            2481       2531      .0773
Envoy Standard             3300       3366      .2349
Sentinel Financial        30513      31123      .6027
Sentinel Multimedia        7948       8107      .6494
Sentinel Standard          7302       7448      .5912
</pre></div>
<!-- class="sect2" -->
<div id="OLAUG9503" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref435"></a>
<h3 class="sect2">OLAP DML Function Example</h3>
<p>An OLAP DML program that returns a value is also function. The following program returns the value <code>ALERT</code> when current sales are less than the previous year&#39;s. The actual calculation is performed by another calculated measure, UNITS_CUBE_SALES_PCT_CHG_PY, which is the percent change from the prior year for Sales. If sales are greater, then the program returns <code>OKAY</code>.</p>
<div id="OLAUG9504" class="example">
<p class="titleinexample"><a id="sthref436"></a>Example 5-1 OLAP DML Function</p>
<pre>VARIABLE _alert   TEXT
VARIABLE _product NUMBER
 
TRAP ON error
 
_product = product + 0
 
TEMPSTAT product
DO
  LIMIT product TO CHILDREN USING product_parentrel _product
  LIMIT product KEEP UNITS_CUBE_SALES_PCT_CHG_PY LT 0
 
  IF STATLEN(product) GT 0
    THEN _alert = &#39;ALERT&#39;
    ELSE _alert = &#39;OKAY&#39;
 
DOEND
 
RETURN _alert
 
error:
RETURN &#39;ERROR&#39;
</pre></div>
<!-- class="example" -->
<p><a href="#BABDHIDB">Figure 5-7</a> shows the definition of this program as a calculated measure.</p>
<div id="OLAUG9505" class="figure">
<p class="titleinfigure"><a id="BABDHIDB"></a>Figure 5-7 Using an OLAP DML Function</p>
<img width="760" height="418" src="img/dml_function.gif" alt="Description of Figure 5-7 follows"/><br/>
<a id="sthref437" href="img_text/dml_function.htm">Description of &#34;Figure 5-7 Using an OLAP DML Function&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>These are the results of a query against this calculated measure:</p>
<pre>CHANNEL         TIME         PCTCHG STATUS
--------------- -------- ---------- ------
Catalog         Q1.06            -1 ALERT
Catalog         Q2.06            -1 ALERT
Catalog         Q3.06            -3 ALERT
Catalog         Q4.06            -7 ALERT
Direct Sales    Q1.06            -3 ALERT
Direct Sales    Q2.06            -1 ALERT
Direct Sales    Q3.06            10 OKAY
Direct Sales    Q4.06            -4 ALERT
Internet        Q1.06            29 OKAY
Internet        Q2.06             3 ALERT
Internet        Q3.06             0 ALERT
Internet        Q4.06            16 OKAY
</pre></div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment3623">
<tr>
<td class="cellalignment3630">
<table class="cellalignment3628">
<tr>
<td class="cellalignment3627"><a href="query.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment3627"><a href="reports.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment3632">
<table class="cellalignment3626">
<tr>
<td class="cellalignment3627"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment3627"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment3627"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment3627"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment3627"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment3627"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>