<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-86767"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Using%20SQL%20Statements%20to%20Manage%20Oracle%20ASM%20File%20Access%20Control"></a><title>Using SQL Statements to Manage Oracle ASM File Access Control</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="dcterms.created" content="2017-07-10T10:06:05Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Automatic Storage Management Administrator&#39;s Guide"/>
<meta name="dcterms.identifier" content="E41058-12"/>
<meta name="dcterms.isVersionOf" content="OSTMG"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2007, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="GUID-684CA4CB-EC16-4ECC-9771-184B11686918.htm" title="Previous" type="text/html"/>
<link rel="Next" href="GUID-CCB2AE8D-2F2A-49DD-8F1D-6BF2F2DAFECB.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41058-12.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-59D1AD06-DDE9-4037-B293-CCD35BB300CB"></a> <span id="PAGE" style="display:none;">156/612</span> <!-- End Header -->
<a id="OSTMG94154"></a>
<h1 id="OSTMG-GUID-59D1AD06-DDE9-4037-B293-CCD35BB300CB" class="sect1">Using SQL Statements to Manage Oracle ASM File Access Control</h1>
<div>
<p><a id="d40199e130" class="indexterm-anchor"></a>You can use the <code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> SQL statement to manage file access control for Oracle ASM disk groups. These SQL statements are available for both database and Oracle ASM instances.</p>
<p>When administering users with SQL*Plus, the users must be existing operating system users and their user names must have corresponding operating system user IDs. However, only users in the same cluster as the Oracle ASM instance can be validated.</p>
<div class="infobox-note" id="GUID-59D1AD06-DDE9-4037-B293-CCD35BB300CB__GUID-F63653DF-1870-4741-A628-898C9A5BECA3">
<p class="notep1">Note:</p>
<p>When modifying ownership of files, the previous owner of a file cannot be dropped while the file is still open even after the ownership of the file has changed.</p>
</div>
<p>The SQL statements that support disk group access control are:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">ADD</code> <code class="codeph">USERGROUP</code> <code class="codeph">WITH</code> <code class="codeph">MEMBER</code></p>
<p>Adds an Oracle ASM user group to a disk group. The user group name is limited to a maximum of 30 characters. The operating system users of the databases identified in the <code class="codeph">MEMBER</code> clause must be in the disk group, as shown by <code class="codeph">V$ASM_USER</code>, or the command returns an error. Any users authenticated as <code class="codeph">SYSASM</code> or <code class="codeph">SYSDBA</code> can create new user groups. For example:</p>
<pre dir="ltr">SQL&gt; SELECT group_number, os_name FROM V$ASM_USER;

GROUP_NUMBER OS_NAME
------------ ----------------------------------------------------------------
           1 oracle1
           1 oracle2
...

SQL&gt; ALTER DISKGROUP data ADD USERGROUP &#39;test_grp1&#39; 
     WITH MEMBER &#39;oracle1&#39;,&#39;oracle2&#39;;
</pre></li>
<li>
<p><code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">DROP</code> <code class="codeph">USERGROUP</code></p>
<p>Drops an Oracle ASM user group from a disk group. Dropping a group might leave some files without a valid group. For those files to have a valid group, you must manually update the group associated with those files to a valid group.</p>
<pre dir="ltr">SQL&gt; ALTER DISKGROUP data DROP USERGROUP &#39;test_grp1&#39;;
</pre></li>
<li>
<p><code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">MODIFY</code> <code class="codeph">USERGROUP</code> <code class="codeph">ADD</code> <code class="codeph">MEMBER</code></p>
<p>Adds users to the specified user group. The users must be in the disk group, as shown by <code class="codeph">V$ASM_USER</code>, or the command returns an error. Only the creator of the group or the Oracle ASM administrator can modify group membership.</p>
<pre dir="ltr">SQL&gt; ALTER DISKGROUP data MODIFY USERGROUP &#39;test_grp2&#39; ADD MEMBER &#39;oracle2&#39;;
</pre></li>
<li>
<p><code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">MODIFY</code> <code class="codeph">USERGROUP</code> <code class="codeph">DROP</code> <code class="codeph">MEMBER</code></p>
<p>Removes users from the specified user group. If a member is not in the user group, then an error is returned. Only the creator of the group or the Oracle ASM administrator can modify group membership.</p>
<pre dir="ltr">SQL&gt; ALTER DISKGROUP data MODIFY USERGROUP &#39;test_grp2&#39; DROP MEMBER &#39;oracle2&#39;;
</pre></li>
<li>
<p><code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">ADD</code> <code class="codeph">USER</code></p>
<p>Adds operating system (OS) users to an Oracle ASM disk group, so that these users can have access privileges on the disk group. If a user exists in the disk group, as shown by <code class="codeph">V$ASM_USER</code>, then the command records an error and continues to add other users, if any.</p>
<p>The operating system user of a running database instance is automatically added to a disk group when the database instance accesses that disk group and creates files. However, for a database instance to read files in a disk group without creating any files, then you must use the <code class="codeph">ADD</code> <code class="codeph">USER</code> clause to add the operating system user associated with that database to the disk group. Also, you can use this clause to add the operating system user associated with a database to an existing disk group immediately after setting the Oracle ASM File Access Control disk group attributes and before creating new files.</p>
<pre dir="ltr">SQL&gt;  ALTER DISKGROUP DATA ADD USER &#39;oracle1&#39;;
</pre></li>
<li>
<p><code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">DROP</code> <code class="codeph">USER</code></p>
<p>Drops operating system users from an Oracle ASM disk group. If a user is not in the disk group, then this command records an error and continues to drop other users, if any.</p>
<p>If the user owns any files on the same Oracle ASM disk group, then this command fails with an error, unless the <code class="codeph">CASCADE</code> keyword is specified. If the latter case, then the user is deleted, along with all the files that the user owns.</p>
<p>If any files owned by the user are currently open, then the <code class="codeph">DROP</code> <code class="codeph">USER</code> command fails, and no files are deleted.</p>
<pre dir="ltr">SQL&gt;  ALTER DISKGROUP DATA DROP USER &#39;oracle1&#39;;
</pre></li>
<li>
<p><code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">REPLACE</code> <code class="codeph">USER</code></p>
<p>Replaces one operating system user with another in an Oracle ASM disk group. The replacement user must not be a user currently in the disk group user list.</p>
<p>If the command succeeds, all files that were previously owned by current user are now owned by the replacement user. The current user is automatically removed from the user list of the disk group. Adding the current user back to the disk group is possible, but this user does not own any files.</p>
<p>When changing the owner of an open file, the new owner cannot be dropped with the owner&#39;s files until all instances within a cluster are restarted.</p>
<p>Only an Oracle ASM administrator can run this command.</p>
<pre dir="ltr">SQL&gt; ALTER DISKGROUP disk_group REPLACE USER oracle1 WITH oracle2;
</pre></li>
<li>
<p><code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">SET</code> <code class="codeph">PERMISSION</code></p>
<p>Modifies permissions of an Oracle ASM file. Setting <code class="codeph">read</code> <code class="codeph">only</code> permission to a file that has <code class="codeph">read</code> <code class="codeph">write</code> permission revokes the <code class="codeph">write</code> permission. Only the file owner or the Oracle ASM administrator can change the permissions of a file.</p>
<pre dir="ltr">SQL&gt; ALTER DISKGROUP data SET PERMISSION OWNER=read write, GROUP=read only,
     OTHER=none FOR FILE &#39;+data/controlfile.f&#39;;
</pre></li>
<li>
<p><code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">SET</code> <code class="codeph">OWNERSHIP</code></p>
<p>Changes the owner or group of a file to the specified user or user group name, respectively. If the specified user or user group name does not exist, this command fails with an error. Only the owner of the file or the Oracle ASM administrator can run this command, and only the Oracle ASM administrator can change the owner. Also, the user group name must exist, and the owner of the file must be a member of that group.</p>
<pre dir="ltr">SQL&gt; ALTER DISKGROUP data SET OWNERSHIP OWNER=&#39;oracle1&#39;, GROUP=&#39;test_grp1&#39;
     FOR FILE &#39;+data/controlfile.f&#39;;
</pre></li>
</ul>
<div class="infoboxnotealso" id="GUID-59D1AD06-DDE9-4037-B293-CCD35BB300CB__GUID-C2BF7C61-EA39-4EF3-B499-ED3E7274553D">
<p class="notep1">See Also:</p>
<p>The <a class="olink SQLRF01113" target="_blank" href="../SQLRF/statements_1009.htm#SQLRF01113"><code class="codeph">ALTER DISKGROUP</code></a> SQL statement in the <a class="olink SQLRF01113" target="_blank" href="../SQLRF/statements_1009.htm#SQLRF01113"><span class="italic">Oracle Database SQL Language Reference</span></a></p>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1687">
<tr>
<td class="cellalignment1694">
<table class="cellalignment1692">
<tr>
<td class="cellalignment1691"><a href="GUID-684CA4CB-EC16-4ECC-9771-184B11686918.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1691"><a href="GUID-CCB2AE8D-2F2A-49DD-8F1D-6BF2F2DAFECB.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2007, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1696">
<table class="cellalignment1690">
<tr>
<td class="cellalignment1691"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1691"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1691"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1691"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1691"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1691"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>