<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-86762"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Oracle%20ASM%20Fast%20Mirror%20Resync"></a><title>Oracle ASM Fast Mirror Resync</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="dcterms.created" content="2017-07-10T10:06:05Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Automatic Storage Management Administrator&#39;s Guide"/>
<meta name="dcterms.identifier" content="E41058-12"/>
<meta name="dcterms.isVersionOf" content="OSTMG"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2007, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="GUID-CF8EC329-446D-4A7B-B252-76AC9F40CA45.htm" title="Previous" type="text/html"/>
<link rel="Next" href="GUID-FBAEBFA6-60AE-4189-A3BA-90F477CD2646.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41058-12.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-56B52297-F4E2-4D36-A573-3200A0C78D31"></a> <span id="PAGE" style="display:none;">138/612</span> <!-- End Header -->
<a id="OSTMG10044"></a>
<h1 id="OSTMG-GUID-56B52297-F4E2-4D36-A573-3200A0C78D31" class="sect1">Oracle ASM Fast Mirror Resync</h1>
<div>
<p><a id="d33108e130" class="indexterm-anchor"></a><a id="d33108e134" class="indexterm-anchor"></a><a id="d33108e136" class="indexterm-anchor"></a>Restoring the redundancy of an Oracle ASM disk group after a transient disk path failure can be time consuming. This is especially true if the recovery process requires rebuilding an entire Oracle ASM disk group. Oracle ASM fast mirror resync significantly reduces the time to resynchronize a failed disk in such situations. When you replace the failed disk, Oracle ASM can quickly resynchronize the Oracle ASM disk extents.</p>
<div class="infobox-note" id="GUID-56B52297-F4E2-4D36-A573-3200A0C78D31__GUID-E193F684-F6F4-4545-B7BE-22EF2CE494B3">
<p class="notep1">Note:</p>
<p>To use this feature, the disk group compatibility attributes must be set to <code class="codeph">11.1</code> or higher. For more information, refer to <span class="q">&#34;<a href="GUID-FBB5AA72-5208-48E1-BD8D-0FD4C6876F34.htm">Disk Group Compatibility</a>&#34;</span>.</p>
</div>
<p>Any problems that make a failure group temporarily unavailable are considered transient failures that can be recovered by the Oracle ASM fast mirror resync feature. For example, transient failures can be caused by disk path malfunctions, such as cable failures, host bus adapter failures, controller failures, or disk power supply interruptions.</p>
<p>Oracle ASM fast resync keeps track of pending changes to extents on an offline disk during an outage. The extents are resynced when the disk is brought back online.</p>
<p><a id="d33108e157" class="indexterm-anchor"></a>By default, Oracle ASM drops a disk in 3.6 hours after it is taken offline. <a id="d33108e162" class="indexterm-anchor"></a>You can set the <code class="codeph">DISK_REPAIR_TIME</code> disk group attribute to delay the drop operation by specifying a time interval to repair the disk and bring it back online. The time can be specified in units of minutes (<code class="codeph">m</code> or <code class="codeph">M</code>) or hours (<code class="codeph">h</code> or <code class="codeph">H</code>). If you omit the unit, then the default unit is hours. The <code class="codeph">DISK_REPAIR_TIME</code> disk group attribute can only be set with the <code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> SQL statement and is only applicable to normal and high redundancy disk groups.</p>
<p>If the attribute is not set explicitly, then the default value (<code class="codeph">3.6h</code>) applies to disks that have been set to <code class="codeph">OFFLINE</code> mode without an explicit <code class="codeph">DROP</code> <code class="codeph">AFTER</code> clause. Disks taken offline due to I/O errors do not have a <code class="codeph">DROP</code> <code class="codeph">AFTER</code> clause.</p>
<p>The default <code class="codeph">DISK_REPAIR_TIME</code> attribute value is an estimate that should be adequate for most environments. However, ensure that the attribute value is set to the amount of time that you think is necessary in your environment to fix any transient disk error, and during which you are able to tolerate reduced data redundancy.</p>
<p>The elapsed time (since the disk was set to <code class="codeph">OFFLINE</code> mode) is incremented only when the disk group containing the offline disks is mounted. The <code class="codeph">REPAIR_TIMER</code> column of <code class="codeph">V$ASM_DISK</code> shows the amount of time left (in seconds) before an offline disk is dropped. After the specified time has elapsed, Oracle ASM drops the disk. You can override this attribute with the <code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">OFFLINE</code> <code class="codeph">DISK</code> statement and the <code class="codeph">DROP</code> <code class="codeph">AFTER</code> clause.</p>
<div class="infobox-note" id="GUID-56B52297-F4E2-4D36-A573-3200A0C78D31__GUID-A6CC7523-13EE-46B4-A8C9-99E9F5A1570E">
<p class="notep1">Note:</p>
<p>If a disk is offlined by Oracle ASM because of an I/O (write) error or is explicitly offlined using the <code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code>... <code class="codeph">OFFLINE</code> statement without the <code class="codeph">DROP</code> <code class="codeph">AFTER</code> clause, then the value specified for the <code class="codeph">DISK_REPAIR_TIME</code> attribute for the disk group is used.</p>
<p>Altering the <code class="codeph">DISK_REPAIR_TIME</code> attribute has no effect on offline disks. The new value is used for any disks that go offline after the attribute is updated. You can confirm this behavior by viewing the Oracle ASM alert log.</p>
</div>
<p>If an offline disk is taken offline for a second time, then the elapsed time is reset and restarted. If another time is specified with the <code class="codeph">DROP</code> <code class="codeph">AFTER</code> clause for this disk, the first value is overridden and the new value applies. A disk that is in <code class="codeph">OFFLINE</code> mode cannot be dropped with an <code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">DROP</code> <code class="codeph">DISK</code> statement; an error is returned if attempted. If for some reason the disk must be dropped (such as the disk cannot be repaired) before the repair time has expired, a disk can be dropped immediately by issuing a second <code class="codeph">OFFLINE</code> statement with a <code class="codeph">DROP</code> <code class="codeph">AFTER</code> clause specifying <code class="codeph">0h</code> or <code class="codeph">0m</code>.</p>
<p>You can use <code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> to set the <code class="codeph">DISK_REPAIR_TIME</code> attribute to a specified hour or minute value, such as 4.5 hours or 270 minutes. For example:</p>
<pre dir="ltr">ALTER DISKGROUP data SET ATTRIBUTE &#39;disk_repair_time&#39; = &#39;4.5h&#39;
ALTER DISKGROUP data SET ATTRIBUTE &#39;disk_repair_time&#39; = &#39;270m&#39;
</pre>
<p>After you repair the disk, run the SQL statement <code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">ONLINE</code> <code class="codeph">DISK</code>. This statement brings a repaired disk group back online to enable writes so that no new writes are missed. This statement also starts a procedure to copy of all of the extents that are marked as stale on their redundant copies.</p>
<p>If a disk goes offline when the Oracle ASM instance is in rolling upgrade mode, the disk remains offline until the rolling upgrade has ended and the timer for dropping the disk is stopped until the Oracle ASM cluster is out of rolling upgrade mode. See <span class="q">&#34;<a href="GUID-383A26A4-AB4E-458B-AF6A-C9DA5E15AD2A.htm">Upgrading and Patching Oracle ASM</a>&#34;</span>. Examples of taking disks offline and bringing them online follow.</p>
<p>The following example takes disk <code class="codeph">DATA_001</code> offline and drops it after five minutes.</p>
<pre dir="ltr">ALTER DISKGROUP data OFFLINE DISK DATA_001 DROP AFTER 5m;
</pre>
<p>The next example takes the disk <code class="codeph">DATA_001</code> offline and drops it after the time period designated by <code class="codeph">DISK_REPAIR_TIME</code> elapses:</p>
<pre dir="ltr">ALTER DISKGROUP data OFFLINE DISK DATA_001;
</pre>
<p>This example takes all of the disks in failure group <code class="codeph">FG2</code> offline and drops them after the time period designated by <code class="codeph">DISK_REPAIR_TIME</code> elapses. If you used a <code class="codeph">DROP</code> <code class="codeph">AFTER</code> clause, then the disks would be dropped after the specified time:</p>
<pre dir="ltr">ALTER DISKGROUP data OFFLINE DISKS IN FAILGROUP FG2;
</pre>
<p>The next example brings all of the disks in failure group <code class="codeph">FG2</code> online:</p>
<pre dir="ltr">ALTER DISKGROUP data ONLINE DISKS IN FAILGROUP FG2;
</pre>
<p>This example brings only disk <code class="codeph">DATA_001</code> online:</p>
<pre dir="ltr">ALTER DISKGROUP data ONLINE DISK DATA_001;
</pre>
<p>This example brings all of the disks in disk group <code class="codeph">DATA</code> online:</p>
<pre dir="ltr">ALTER DISKGROUP data ONLINE ALL;
</pre>
<p>Querying the <code class="codeph">V$ASM_OPERATION</code> view while you run <code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">ONLINE</code> statements displays the name and state of the current operation that you are performing. For example, the following SQL query shows values in the <code class="codeph">PASS</code> column during an online operation.</p>
<pre dir="ltr">SQL&gt; SELECT GROUP_NUMBER, PASS, STATE FROM V$ASM_OPERATION;
 
GROUP_NUMBER PASS      STAT
------------ --------- ----
           1 RESYNC    RUN
           1 REBALANCE WAIT
           1 COMPACT   WAIT
</pre>
<p>An offline operation does not generate a display in a <code class="codeph">V$ASM_OPERATION</code> view query.</p>
<p><a id="d33108e430" class="indexterm-anchor"></a>You can set the <code class="codeph">FAILGROUP_REPAIR_TIME</code> and <code class="codeph">CONTENT.TYPE</code> disk group attributes. The <code class="codeph">FAILGROUP_REPAIR_TIME</code> disk group attribute specifies a default repair time for the failure groups in the disk group. The <code class="codeph">CONTENT.TYPE</code> disk group attribute specifies the type of data expected to be stored in a disk group. You can set these attributes with ASMCA, ASMCMD <code class="codeph">mkdg</code>, or SQL <code class="codeph">CREATE</code> and <code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> statements. For information about disk group attributes, refer to <span class="q">&#34;<a href="GUID-28A6ABB3-0AAB-4F7F-A843-CD5187F4D8DC.htm">Managing Disk Group Attributes</a>&#34;</span>.</p>
<p>The ASMCMD <code class="codeph">lsop</code> command shows the resync time estimate. There are separate rows in the <code class="codeph">V$ASM_OPERATION</code> table for different phases of rebalance: disk resync, rebalance, and data compaction.</p>
<p>The ASMCMD <code class="codeph">online</code> command has a <code class="codeph">power</code> option to specify the power for the online operation. The SQL <code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">REPLACE</code> <code class="codeph">DISK</code> statement also has the power option.</p>
<p>The ASMCMD <code class="codeph">chdg</code> command provides the <code class="codeph">replace</code> option in addition to the <code class="codeph">add</code> and <code class="codeph">drop</code> tags. The ASMCMD <code class="codeph">mkdg</code> command has an additional time parameter (<code class="codeph">-t</code>) to specify the time to offline a failure group.</p>
<div class="infoboxnotealso" id="GUID-56B52297-F4E2-4D36-A573-3200A0C78D31__GUID-0146265F-DCE8-4B81-93CE-6B8CC5298EB6">
<p class="notep1">See Also:</p>
<p><a class="olink SQLRF01113" target="_blank" href="../SQLRF/statements_1009.htm#SQLRF01113"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about <a class="olink SQLRF01113" target="_blank" href="../SQLRF/statements_1009.htm#SQLRF01113"><code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code></a> and <a class="olink SQLRF01114" target="_blank" href="../SQLRF/statements_5009.htm#SQLRF01114"><code class="codeph">CREATE</code> <code class="codeph">DISKGROUP</code></a></p>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1687">
<tr>
<td class="cellalignment1694">
<table class="cellalignment1692">
<tr>
<td class="cellalignment1691"><a href="GUID-CF8EC329-446D-4A7B-B252-76AC9F40CA45.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1691"><a href="GUID-FBAEBFA6-60AE-4189-A3BA-90F477CD2646.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2007, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1696">
<table class="cellalignment1690">
<tr>
<td class="cellalignment1691"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1691"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1691"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1691"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1691"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1691"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>