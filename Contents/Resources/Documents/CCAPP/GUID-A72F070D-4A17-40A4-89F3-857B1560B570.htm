<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-2925"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/catalogSearch.jsp"></a><title>catalogSearch.jsp</title>
<meta name="generator" content="DITA Open Toolkit version 1.7.5"/>
<meta name="dcterms.created" content="2015-05-15T00:35:11Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Text Application Developer&#39;s Guide"/>
<meta name="dcterms.identifier" content="E41398-07"/>
<meta name="dcterms.isVersionOf" content="CCAPP"/>
<meta name="dcterms.rights" content="Copyright &nbsp;&copy;&nbsp;2001, 2015, Oracle and/or its affiliates. All rights reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="GUID-3F66BB43-5E4C-4F76-B6B2-B91BAA40609F.htm" title="Previous" type="text/html"/>
<link rel="Next" href="GUID-300F0473-9FD7-45A2-8233-CED5E54AEBDC.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41398-07.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-A72F070D-4A17-40A4-89F3-857B1560B570"></a> <span id="PAGE" style="display:none;">319/321</span> <!-- End Header --><a id="CCAPP9390"></a>
<h1 id="CCAPP-GUID-A72F070D-4A17-40A4-89F3-857B1560B570" class="sect1">catalogSearch.jsp</h1>
<div>
<div class="section">
<pre>&lt;%@ page import=&#34;java.sql.* , oracle.jsp.dbutil.*&#34; %&gt;
&lt;jsp:useBean id=&#34;name&#34; class=&#34;oracle.jsp.jml.JmlString&#34; scope=&#34;request&#34; &gt;
&lt;jsp:setProperty name=&#34;name&#34; property=&#34;value&#34; param=&#34;v_query&#34; /&gt;
&lt;/jsp:useBean&gt;

&lt;%
  String connStr=&#34;jdbc:oracle:thin:@machine-domain-name:1521:betadev&#34;;

  java.util.Properties info = new java.util.Properties();

  Connection conn = null;
  ResultSet  rset = null;
  Statement  stmt = null;


       if (name.isEmpty() ) { 

%&gt;
           &lt;html&gt;
             &lt;title&gt;Catalog Search&lt;/title&gt;
             &lt;body&gt;
             &lt;center&gt;
               &lt;form method=post&gt;
               Search for book title:
               &lt;input type=text name=&#34;v_query&#34; size=10&gt;
               where publisher is
               &lt;select name=&#34;v_publisher&#34;&gt;
                  &lt;option value=&#34;ADDISON WESLEY&#34;&gt;ADDISON WESLEY
                  &lt;option value=&#34;HUMMING BOOKS&#34;&gt;HUMMING BOOKS
                  &lt;option value=&#34;WRENCH BOOKS&#34;&gt;WRENCH BOOKS
                  &lt;option value=&#34;SPOT-ON PUBLISHING&#34;&gt;SPOT-ON PUBLISHING
                  &lt;option value=&#34;SPINDRIFT BOOKS&#34;&gt;SPINDRIFT BOOKS
                  &lt;option value=&#34;LOW LIFE BOOK CO&#34;&gt;LOW LIFE BOOK CO
                  &lt;option value=&#34;KLONDIKE BOOKS&#34;&gt;KLONDIKE BOOKS
                  &lt;option value=&#34;CALAMITY BOOKS&#34;&gt;CALAMITY BOOKS
                  &lt;option value=&#34;IBEX BOOKS INC&#34;&gt;IBEX BOOKS INC
                  &lt;option value=&#34;BIG LITTLE BOOKS&#34;&gt;BIG LITTLE BOOKS
               &lt;/select&gt;
               and price is 
               &lt;select name=&#34;v_op&#34;&gt;
                 &lt;option value=&#34;=&#34;&gt;=
                 &lt;option value=&#34;&amp;lt;&#34;&gt;&amp;lt;
                 &lt;option value=&#34;&amp;gt;&#34;&gt;&amp;gt;
               &lt;/select&gt;
               &lt;input type=text name=&#34;v_price&#34; size=2&gt;
               &lt;input type=submit value=&#34;Search&#34;&gt;
               &lt;/form&gt;
             &lt;/center&gt;
             &lt;hr&gt;
             &lt;/body&gt;
           &lt;/html&gt;

&lt;%
      }
      else {

         String v_query = request.getParameter(&#34;v_query&#34;);
         String v_publisher = request.getParameter(&#34;v_publisher&#34;);
         String v_price = request.getParameter(&#34;v_price&#34;);
         String v_op    = request.getParameter(&#34;v_op&#34;);
%&gt;

         &lt;html&gt;
           &lt;title&gt;Catalog Search&lt;/title&gt;
           &lt;body&gt;
           &lt;center&gt;
            &lt;form method=post action=&#34;catalogSearch.jsp&#34;&gt;
            Search for book title:
            &lt;input type=text name=&#34;v_query&#34; value= 
            &lt;%= v_query %&gt;
            size=10&gt;
            where publisher is
            &lt;select name=&#34;v_publisher&#34;&gt;
                  &lt;option value=&#34;ADDISON WESLEY&#34;&gt;ADDISON WESLEY
                  &lt;option value=&#34;HUMMING BOOKS&#34;&gt;HUMMING BOOKS
                  &lt;option value=&#34;WRENCH BOOKS&#34;&gt;WRENCH BOOKS
                  &lt;option value=&#34;SPOT-ON PUBLISHING&#34;&gt;SPOT-ON PUBLISHING
                  &lt;option value=&#34;SPINDRIFT BOOKS&#34;&gt;SPINDRIFT BOOKS
                  &lt;option value=&#34;LOW LIFE BOOK CO&#34;&gt;LOW LIFE BOOK CO
                  &lt;option value=&#34;KLONDIKE BOOKS&#34;&gt;KLONDIKE BOOKS
                  &lt;option value=&#34;CALAMITY BOOKS&#34;&gt;CALAMITY BOOKS
                  &lt;option value=&#34;IBEX BOOKS INC&#34;&gt;IBEX BOOKS INC
                  &lt;option value=&#34;BIG LITTLE BOOKS&#34;&gt;BIG LITTLE BOOKS
            &lt;/select&gt;
            and price is 
            &lt;select name=&#34;v_op&#34;&gt;
               &lt;option value=&#34;=&#34;&gt;=
               &lt;option value=&#34;&amp;lt;&#34;&gt;&amp;lt;
               &lt;option value=&#34;&amp;gt;&#34;&gt;&amp;gt;
            &lt;/select&gt;
            &lt;input type=text name=&#34;v_price&#34; value=
            &lt;%= v_price %&gt; size=2&gt;
            &lt;input type=submit value=&#34;Search&#34;&gt;
            &lt;/form&gt;
            &lt;/center&gt;
          
&lt;%
     try {

       DriverManager.registerDriver(new oracle.jdbc.driver.OracleDriver() );
       info.put (&#34;user&#34;, &#34;ctxdemo&#34;);
       info.put (&#34;password&#34;,&#34;ctxdemo&#34;);
       conn = DriverManager.getConnection(connStr,info);

         stmt = conn.createStatement();
         String theQuery = request.getParameter(&#34;v_query&#34;);
         String thePrice = request.getParameter(&#34;v_price&#34;);

 // select id,title 
 // from book_catalog 
 // where catsearch (title,&#39;Java&#39;,&#39;price &gt;10 order by price&#39;) &gt; 0

 // select title 
 // from book_catalog 
 // where catsearch(title,&#39;Java&#39;,&#39;publisher = &#39;&#39;CALAMITY BOOKS&#39;&#39; 
          and price &lt; 40 order by price&#39; )&gt;0

         String myQuery = &#34;select title, publisher, price from book_catalog
             where catsearch(title, &#39;&#34;+theQuery+&#34;&#39;, 
             &#39;publisher = &#39;&#39;&#34;+v_publisher+&#34;&#39;&#39; and price &#34;+v_op+thePrice+&#34; 
             order by price&#39; ) &gt; 0&#34;;
         rset = stmt.executeQuery(myQuery);

         String color = &#34;ffffff&#34;;

         String myTitle = null;
         String myPublisher = null;
         int myPrice = 0;
         int items = 0;

         while (rset.next()) {
            myTitle     = (String)rset.getString(1);
            myPublisher = (String)rset.getString(2);
            myPrice     = (int)rset.getInt(3);
            items++;

            if (items == 1) {
%&gt;
               &lt;center&gt;
                  &lt;table border=&#34;0&#34;&gt;
                     &lt;tr bgcolor=&#34;#6699CC&#34;&gt;
                       &lt;th&gt;Title&lt;/th&gt;
                       &lt;th&gt;Publisher&lt;/th&gt;
                       &lt;th&gt;Price&lt;/th&gt;
                     &lt;/tr&gt;
&lt;%
            }
%&gt; 
            &lt;tr bgcolor=&#34;#&lt;%= color %&gt;&#34;&gt;
             &lt;td&gt; &lt;%= myTitle %&gt;&lt;/td&gt;
             &lt;td&gt; &lt;%= myPublisher %&gt;&lt;/td&gt;
             &lt;td&gt; $&lt;%= myPrice %&gt;&lt;/td&gt;
            &lt;/tr&gt;
&lt;%
            if (color.compareTo(&#34;ffffff&#34;) == 0)
               color = &#34;eeeeee&#34;;
             else
               color = &#34;ffffff&#34;;

      }
      
   } catch (SQLException e) {

%&gt;

      &lt;b&gt;Error: &lt;/b&gt; &lt;%= e %&gt;&lt;p&gt;

&lt;%

  } finally {
       if (conn != null) conn.close();
       if (stmt != null) stmt.close();
       if (rset != null) rset.close();
   }
   
%&gt;
    &lt;/table&gt;
    &lt;/center&gt;
   &lt;/body&gt;
   &lt;/html&gt;
&lt;%
 }
%&gt;
</pre></div>
<!-- class="section" --></div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment6351">
<tr>
<td class="cellalignment6358">
<table class="cellalignment6356">
<tr>
<td class="cellalignment6355"><a href="GUID-3F66BB43-5E4C-4F76-B6B2-B91BAA40609F.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment6355"><a href="GUID-300F0473-9FD7-45A2-8233-CED5E54AEBDC.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright &nbsp;&copy;&nbsp;2001, 2015, Oracle and/or its affiliates. All rights reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment6360">
<table class="cellalignment6354">
<tr>
<td class="cellalignment6355"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment6355"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment6355"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment6355"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment6355"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment6355"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>