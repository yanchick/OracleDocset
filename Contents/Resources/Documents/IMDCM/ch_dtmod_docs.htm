<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-47076"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Creating%20DICOM%20Configuration%20Documents"></a><title>Creating DICOM Configuration Documents</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1023"/>
<meta name="description" content="Presents reference and other information about using Oracle Database to store, manage, and retrieve DICOM content such as single-frame and multiframe images, waveforms, slices of 3-D volumes, video segments, and structured reports in an integrated fashion with other enterprise information. Oracle Multimedia DICOM extends Oracle Database reliability, availability, and data management to media objects in medical applications. Oracle Multimedia DICOM supports Digital Imaging and Communications in Medicine, the standard for medical images."/>
<meta name="dcterms.created" content="2014-07-31T9:38:57Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Multimedia DICOM Developer&#39;s Guide"/>
<meta name="dcterms.identifier" content="E17698-09"/>
<meta name="dcterms.isVersionOf" content="IMDCM"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2007, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="dm_glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="ch_adm_over.htm" title="Previous" type="text/html"/>
<link rel="Next" href="ch_adm_repos.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E17698-09.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">21/32</span> <!-- End Header -->
<div id="IMDCM9500" class="chapter"><a id="BABEIHCA"></a>
<h1 class="chapter"><span class="secnum">11</span> Creating DICOM Configuration Documents</h1>
<p>Administrators can perform several repository management tasks, including <a id="sthref841"></a>creating their own configuration documents. This chapter describes the characteristics of configuration documents and provides instructions on how to write configuration documents that are specific to a particular organization or enterprise.</p>
<p>Oracle Multimedia DICOM supports the processing of DICOM files that contain private attribute definer names consisting of special characters. To enable referencing of DICOM metadata tags that refer to private attribute definers using these special characters, Oracle Multimedia DICOM extends the syntax for value locators used in the DICOM configuration documents to enable the expression of these definers. The <a href="dm_glossary.htm#BABEJEIB"><span class="xrefglossterm">DICOM value locator</span></a> type <a id="sthref842"></a>identifies DICOM attributes or their child components within the DICOM content. See <a href="ch_adm_ref.htm#CHEDJCDJ">General Format for DICOM Value Locators</a> for reference information.</p>
<p>Administrators can use DICOM value locators with anonymity, constraint, and mapping documents. The DICOM value locator is also used in the mid-tier Java API. See <a href="#CIHHIHGC">Section 11.2.1.5</a>, <a href="#CIHHHAII">Section 11.2.2.5</a>, and <a href="#CIHFHDFB">Section 11.2.4.6</a>, respectively, for more information about using DICOM value locators in anonymity, constraint, and mapping documents. See <a href="ch_adm_over.htm#BGBEBEFE">Chapter 10</a> for more information about inserting, updating, and deleting configuration documents. See <a href="ch_adm_repos.htm#BACIFIHC">Chapter 12</a> for examples of these processes.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink IMMTJ" href="../IMMTJ/toc.htm"><span class="italic">Oracle Multimedia Mid-Tier Java API Reference</span></a> for reference information about the Java classes that support DICOM value locators in the middle tier</p>
</li>
<li>
<p><code><a href="http://medical.nema.org/">http://medical.nema.org/</a></code> for more information about the data structure and encoding definitions of DICOM content, as defined in the DICOM standard</p>
</li>
</ul>
</div>
<p>This chapter includes these sections:</p>
<ul>
<li>
<p><a href="#BABDAFAD">Characteristics of Configuration Documents</a></p>
</li>
<li>
<p><a href="#BABHIIIH">Writing Configuration Documents</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
In this chapter, names of attributes for XML elements appear in monospace type.</div>
<a id="BABDAFAD"></a>
<div id="IMDCM9510" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">11.1</span> Characteristics of Configuration Documents</h2>
<p>After installation, the Oracle Multimedia DICOM data model repository contains the following set of default configuration documents:</p>
<ul>
<li>
<p>Anonymity (<code>ordcman.xml</code>)</p>
</li>
<li>
<p>Constraint (<code>ordcmct.xml</code>, <code>ordcmcmd.xml</code>, <code>ordcmcmc.xml</code>)</p>
</li>
<li>
<p>Mapping (<code>ordcmmp.xml</code>)</p>
</li>
<li>
<p>Standard Dictionary (<code>ordcmsd.xml</code>)</p>
</li>
<li>
<p>Private Dictionary (<code>ordcmpv.xml</code>)</p>
</li>
<li>
<p>Preference (<code>ordcmpf.xml</code>)</p>
</li>
<li>
<p>UID Definition (<code>ordcmui.xml</code>)</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
<p>In addition, users can:</p>
<ul>
<li>
<p>Install an optional stored tag list document that specifies the DICOM attributes to be extracted from the embedded DICOM content and stored in the XML metadata attribute of the ORDDicom object when the setProperties( ) method is called.</p>
</li>
<li>
<p>Configure a DICOM protocol document to manage the behavior of a DICOM protocol adapter instance configured to use Oracle Database as the backing storage mechanism for DICOM images and metadata.</p>
</li>
</ul>
</div>
<p>See <a href="ch_cncpt.htm#CIHIAJJC">Section 2.4.1</a> for a brief definition of each configuration document.</p>
<p>Each type of configuration document has a specific set of characteristics<a id="sthref843"></a>, which are briefly described in these sections:</p>
<ul>
<li>
<p><a href="#CIHGHJHA">Characteristics of Anonymity Documents</a></p>
</li>
<li>
<p><a href="#CIHFIJAB">Characteristics of Constraint Documents</a></p>
</li>
<li>
<p><a href="#BEIEBIBH">Characteristics of DICOM Protocol Documents</a></p>
</li>
<li>
<p><a href="#BGBBDCFD">Characteristics of Mapping Documents</a></p>
</li>
<li>
<p><a href="#CIHEGFJE">Characteristics of Preference Documents</a></p>
</li>
<li>
<p><a href="#CIHEGDIC">Characteristics of Private Dictionary Documents</a></p>
</li>
<li>
<p><a href="#CIHGEEJE">Characteristics of Standard Dictionary Documents</a></p>
</li>
<li>
<p><a href="#CIHEHCAF">Characteristics of Stored Tag List Documents</a></p>
</li>
<li>
<p><a href="#CIHHEHGF">Characteristics of UID Definition Documents</a></p>
</li>
</ul>
<a id="CIHGHJHA"></a>
<div id="IMDCM13459" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">11.1.1</span> Characteristics of Anonymity Documents</h3>
<p>Anonymity documents <a id="sthref844"></a>have these characteristics:</p>
<ul>
<li>
<p>No other document types depend on anonymity documents.</p>
</li>
<li>
<p>There are no dependencies between anonymity documents.</p>
</li>
<li>
<p>Anonymity documents depend on the standard and private dictionary documents.</p>
</li>
<li>
<p>There is no maximum limit on the number of anonymity documents in the repository.</p>
</li>
<li>
<p>Changes made to anonymity documents affect the results of the isAnonymous( ) and makeAnonymous( ) methods.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="CIHFIJAB"></a>
<div id="IMDCM13460" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">11.1.2</span> Characteristics of Constraint Documents</h3>
<p>Constraint documents<a id="sthref845"></a> have these characteristics:</p>
<ul>
<li>
<p>No other document types depend on constraint documents.</p>
</li>
<li>
<p>There may be dependencies between constraint documents.</p>
</li>
<li>
<p>Constraint documents depend on the standard and private dictionary documents and the preference document.</p>
</li>
<li>
<p>There is no limit on the number of constraint documents in the repository.</p>
</li>
<li>
<p>Constraint documents can be written in such a way that later constraint documents depend on previously inserted constraint documents. As an example using installed constraint documents, <code>ordcmct.xml</code> depends on <code>ordcmcmd.xml</code>, and both of those documents depend on <code>ordcmcmc.xml</code>.</p>
</li>
<li>
<p>The isConformanceValid( ) method depends on the specified constraint rule and the DICOM content. If the constraint rule (defined in a constraint document) is changed, the DICOM content may be validated differently.</p>
</li>
<li>
<p>The preference parameter EXP_IF_NULL_ATTR_IN_CONSTRAINT in the preference document can be used to specify whether to raise an exception when encountering a null value for the attributes specified in the constraint rules. If this preference parameter is set to <code>true</code>, the isConformanceValid( ) method raises an exception; otherwise, the predicate that was encountered is evaluated to <code>false</code>.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="BEIEBIBH"></a>
<div id="IMDCM13943" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">11.1.3</span> Characteristics of DICOM Protocol Documents</h3>
<p>DICOM protocol documents<a id="sthref846"></a> have these characteristics:</p>
<ul>
<li>
<p>No other document types depend on DICOM protocol documents.</p>
</li>
<li>
<p>There are no dependencies between DICOM protocol documents.</p>
</li>
<li>
<p>There is no limit on the number of DICOM protocol documents in the repository.</p>
</li>
<li>
<p>Each DICOM protocol document must contain at least one storage configuration element (the <code>&lt;storage&gt;</code> tag), which can be repeated. This element enables you to specify a table in Oracle Database to use for DICOM image and metadata storage.</p>
</li>
<li>
<p>Each DICOM protocol document must adhere to the <code>ordcmdp.xsd</code> schema.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="BGBBDCFD"></a>
<div id="IMDCM13461" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">11.1.4</span> Characteristics of Mapping Documents</h3>
<p>Mapping documents<a id="sthref847"></a> have these characteristics:</p>
<ul>
<li>
<p>No other document types depend on mapping documents.</p>
</li>
<li>
<p>There are no dependencies between mapping documents.</p>
</li>
<li>
<p>Mapping documents depend on the standard and private dictionary documents and the preference document.</p>
</li>
<li>
<p>There is no limit on the number of mapping documents in the repository.</p>
</li>
<li>
<p>Changes made to mapping documents affect the results of the extractMetadata( ) method, when the mapping document is used as a parameter.</p>
</li>
<li>
<p>If a mapping document specifies a metadata namespace value in the &lt;NAMESPACE&gt; element, the XML schema that corresponds to the metadata namespace value must be registered with Oracle XML DB.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<p><a class="olink ADXDB0600" href="../ADXDB/xdb05sto.htm#ADXDB0600"><span class="italic">Oracle XML DB Developer&#39;s Guide</span></a> for more information about registering XML schemas</p>
</div>
<p>To enable the extractMetadata( ) method to function correctly, the structure of the mapping document must be consistent with the XML schema that corresponds to the value of the &lt;NAMESPACE&gt; element.</p>
</li>
<li>
<p>Extracted metadata is schema validated only if both of these conditions exist:</p>
<ul>
<li>
<p>The mapping document specifies a value in the &lt;NAMESPACE&gt; element.</p>
</li>
<li>
<p>The value of the preference parameter VALIDATE_METADATA in the preference document is <code>true</code>.</p>
</li>
</ul>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="CIHEGFJE"></a>
<div id="IMDCM13464" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">11.1.5</span> Characteristics of Preference Documents</h3>
<p>Preference documents<a id="sthref848"></a> have these characteristics:</p>
<ul>
<li>
<p>A maximum of two (one Oracle-defined and one user-defined) preference documents are permitted in the repository. The installed, Oracle-defined preference document (<code>ordcmpf.xml</code>) includes Oracle-fixed preference parameter names and lists of values. The user-defined preference document can update the default preference parameter values that were set in the Oracle-defined preference document.</p>
</li>
<li>
<p>Changes to preference parameter values in preference documents change the behavior of DICOM methods, functions, and procedures. Specifically, preference parameter values that are defined in the user-defined preference document override the default values defined in the Oracle-defined preference document.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="CIHEGDIC"></a>
<div id="IMDCM13463" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">11.1.6</span> Characteristics of Private Dictionary Documents</h3>
<p>Private dictionary documents<a id="sthref849"></a> have these characteristics:</p>
<ul>
<li>
<p>One private dictionary document (<code>ordcmpv.xml</code>) is installed by Oracle.</p>
</li>
<li>
<p>There is no limit on the number of private dictionary documents in the repository.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="CIHGEEJE"></a>
<div id="IMDCM13462" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">11.1.7</span> Characteristics of Standard Dictionary Documents</h3>
<p>Standard dictionary documents<a id="sthref850"></a> have these characteristics:</p>
<ul>
<li>
<p>One standard dictionary document (<code>ordcmsd.xml</code>) is installed by Oracle.</p>
</li>
<li>
<p>Changes to standard dictionary documents must be limited to updates in the DICOM standard.</p>
</li>
<li>
<p>There is no limit on the number of standard dictionary documents in the repository.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="CIHEHCAF"></a>
<div id="IMDCM13624" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">11.1.8</span> Characteristics of Stored Tag List Documents</h3>
<p>Stored tag list documents<a id="sthref851"></a> have these characteristics:</p>
<ul>
<li>
<p>Only one stored tag list document can exist in the repository.</p>
</li>
<li>
<p>The stored tag list document depends on the standard and private dictionary documents and the preference document.</p>
</li>
<li>
<p>The preference parameter MANDATE_ATTR_TAGS_IN_STL enforces the rule that all tags used by the constraint and mapping documents are listed in the stored tag list document. The value of the MANDATE_ATTR_TAGS_IN_STL preference parameter in the preference document is <code>false</code>, by default. If this preference parameter is set to <code>true</code>, the rule is enforced; otherwise it is not enforced.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="CIHHEHGF"></a>
<div id="IMDCM13465" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">11.1.9</span> Characteristics of UID Definition Documents</h3>
<p>UID definition documents<a id="sthref852"></a> have these characteristics:</p>
<ul>
<li>
<p>A maximum of two (one Oracle-defined and one user-defined) UID definition documents are permitted in the repository. The installed, Oracle-defined UID definition document (<code>ordcmui.xml</code>) includes the UID definitions listed in Part 6 of the DICOM standard.</p>
</li>
<li>
<p>Changes to user-defined UID definition documents must be limited to updates in the DICOM standard or additions of new UID values.</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
Existing UID values must not be changed.</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABHIIIH"></a>
<div id="IMDCM9520" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">11.2</span> Writing Configuration Documents</h2>
<p>Administrators can write one or more configuration documents to support specific applications or organizations. These subsections describe how to create<a id="sthref853"></a><a id="sthref854"></a> each type of configuration document:</p>
<ul>
<li>
<p><a href="#BGBGDDHD">Creating Anonymity Documents</a></p>
</li>
<li>
<p><a href="#BGBECDAJ">Creating Constraint Documents</a></p>
</li>
<li>
<p><a href="#BEIFCJIB">Creating DICOM Protocol Documents</a></p>
</li>
<li>
<p><a href="#BGBGGFCJ">Creating Mapping Documents and Metadata XML Schemas</a></p>
</li>
<li>
<p><a href="#BGBBBGBI">Creating Preference Documents</a></p>
</li>
<li>
<p><a href="#CIHHFHGC">Creating Private Dictionary Documents</a></p>
</li>
<li>
<p><a href="#CIHGBBJB">Creating Standard Dictionary Documents</a></p>
</li>
<li>
<p><a href="#CIHDAAAG">Creating Stored Tag List Documents</a></p>
</li>
<li>
<p><a href="#CIHDAFGF">Creating UID Definition Documents</a></p>
</li>
</ul>
<a id="BGBGDDHD"></a>
<div id="IMDCM13466" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">11.2.1</span> Creating Anonymity Documents</h3>
<p>Anonymity documents<a id="sthref855"></a> specify the set of attributes to be made anonymous, and the actions to be taken to make those attributes anonymous. In the ORDDicom object, anonymity documents are used by the methods isAnonymous( ) and makeAnonymous( ) to create new objects in which personally identifying information has been removed or replaced.</p>
<p>The XML schema <code>ordcman.xsd</code> defines the XML schema that constrains anonymity documents. (See <a href="ap_schemas.htm#BABEBCJJ">Appendix B</a> for more information about this schema.)</p>
<p>The default anonymity document, <code>ordcman.xml</code>, lists a subset of the attributes defined in the Basic Application Level Confidentiality Profile in Part 15 of the DICOM standard. These attributes are either removed or replaced with the string <code>&#34;anonymous&#34;</code> in the DICOM content. In addition, the default anonymity document removes all undefined standard attributes and all private attributes from the DICOM content.</p>
<p>Within each anonymity document, the &lt;ANONYMITY_ACTION&gt; element includes an <code>action</code> attribute. The value of the <code>action</code> attribute can apply to a single attribute or to a set of attributes within that anonymity document. Global actions apply to a set of attributes, such as all private attributes.</p>
<p><a href="#CIHFDFJI">Table 11-1</a> describes the valid values for the <code>action</code> attribute.</p>
<div id="IMDCM13467" class="tblruleformal">
<p class="titleintable"><a id="sthref856"></a><a id="CIHFDFJI"></a>Table 11-1 action Attribute Values</p>
<table class="cellalignment2223" title="action Attribute Values" summary="Values for the action attribute" dir="ltr">
<thead>
<tr class="cellalignment2212">
<th class="cellalignment2219" id="r1c1-t7">Value</th>
<th class="cellalignment2219" id="r1c2-t7">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r2c1-t7" headers="r1c1-t7">
<p><code>none</code></p>
</td>
<td class="cellalignment2220" headers="r2c1-t7 r1c2-t7">
<p>No action is taken. The unchanged value of the specified attribute or the set of attributes appears in the resulting DICOM content.</p>
</td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r3c1-t7" headers="r1c1-t7">
<p><code>remove</code></p>
</td>
<td class="cellalignment2220" headers="r3c1-t7 r1c2-t7">
<p>The default value. The specified attribute or the set of attributes is removed from the resulting DICOM content.</p>
<p><span class="bold">Note:</span> Some imaging applications may depend on certain attributes (for example: <code>SOP_INSTANCE_UID</code> or <code>SOP_CLASS_UID</code>). In these cases, use the <code>replace</code> action with an appropriate value in place of the <code>remove</code> action.</p>
</td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r4c1-t7" headers="r1c1-t7">
<p><code>replace</code></p>
</td>
<td class="cellalignment2220" headers="r4c1-t7 r1c2-t7">
<p>The attribute value is replaced by the specified value in the resulting DICOM content. The specified replacement value must be a string representation that matches the data type of the tag as defined by the &lt;VR&gt; element in the data dictionaries.</p>
<p><span class="bold">Note:</span> This action value is not permitted for global actions.</p>
<p>For example:</p>
<p>The standard tag <code>00100022</code> represents the Patient ID, which has a &lt;VR&gt; value of <code>CS (CODE_STRING)</code> in the data dictionary. The data type <code>CS</code> is defined in the XML schema <code>ordcmrdt.xsd</code> as <code>xs:token of length 16</code>. The replacement value must be a string representation that conforms to this definition.</p>
<p>The standard tag <code>00081160</code> represents the Referenced Frame Number, which has a &lt;VR&gt; value of <code>IS (INTEGER_STRING)</code>. The data type <code>IS</code> is defined in the XML schema <code>ordcmrdt.xsd</code> as <code>xs:integer</code>. The replacement value must be a string representation that conforms to this definition.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblruleformal" -->
<p>Attributes in anonymity documents can be standard or private. Standard and private attributes can be either defined or undefined. Defined standard attributes are defined in the DICOM standard and in the standard dictionary in the data model repository. Defined private attributes are defined by and specific to a particular organization. Defined private attributes known to Oracle Multimedia are defined in the private dictionary in the data model repository. Undefined attributes are defined in neither the standard dictionary nor the private dictionary in the data model repository.</p>
<p>The &lt;INDIVIDUAL_ATTRIBUTE&gt; element defines the action taken to make a defined standard or private attribute anonymous. For private attributes, the action specified in this element always overrides the global action defined by the &lt;PRIVATE_ATTRIBUTES&gt; element. In addition, standard or private attributes that are undefined cannot be specified as &lt;INDIVIDUAL_ATTRIBUTE&gt; element values in an anonymity document.</p>
<p><a href="#CIHICAAC">Table 11-2</a> describes the elements that define the global actions in the anonymity document.</p>
<div id="IMDCM13468" class="tblruleformal">
<p class="titleintable"><a id="sthref857"></a><a id="CIHICAAC"></a>Table 11-2 Global Action Elements</p>
<table class="cellalignment2223" title="Global Action Elements" summary="Elements for global actions" dir="ltr">
<thead>
<tr class="cellalignment2212">
<th class="cellalignment2219" id="r1c1-t8">Element</th>
<th class="cellalignment2219" id="r1c2-t8">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r2c1-t8" headers="r1c1-t8">
<p>&lt;PRIVATE_ATTRIBUTES&gt;</p>
</td>
<td class="cellalignment2220" headers="r2c1-t8 r1c2-t8">
<p>Specifies the action performed on all defined and undefined private attributes.</p>
<p><span class="bold">Note:</span> The action for a private attribute defined by the &lt;INDIVIDUAL_ATTRIBUTE&gt; element always overrides the global action defined by the &lt;PRIVATE_ATTRIBUTES&gt; element.</p>
</td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r3c1-t8" headers="r1c1-t8">
<p>&lt;UNDEFINED_STANDARD_ATTRIBUTES&gt;</p>
</td>
<td class="cellalignment2220" headers="r3c1-t8 r1c2-t8">
<p>Specifies the action performed on all standard attributes that are not defined in the standard dictionaries in the data model repository.</p>
<p>A DICOM attribute tag contains a group number and an element number.</p>
<p>A standard attribute tag is identified by an even-numbered group number.</p>
</td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r4c1-t8" headers="r1c1-t8">
<p>&lt;UNDEFINED_PRIVATE_ATRIBUTES&gt;</p>
</td>
<td class="cellalignment2220" headers="r4c1-t8 r1c2-t8">
<p>Specifies the action performed on all private attributes that are not defined in the private dictionaries in the data model repository.</p>
<p><span class="bold">Note:</span> The action value defined by this element takes precedence over the action value defined by the &lt;PRIVATE_ATTRIBUTES &gt; element.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblruleformal" -->
<p>Examples of valid values for an &lt;ATTRIBUTE_TAG&gt; element are as follows: <code>00100010</code>, <code>00100010(DICOM)</code>, <code>10871100(PRIVATE ORG)</code>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Currently, only these values are permitted for the definer name in a private attribute:
<ul>
<li>
<p>The uppercase and lowercase letters: <code>A-Z</code></p>
</li>
<li>
<p>The numbers: <code>0-9</code></p>
</li>
<li>
<p>The characters: <code>&#39;.&#39;</code>(dot), <code>&#39; &#39;</code> (space), and <code>&#39;/&#39;</code>(forward slash)</p>
</li>
</ul>
</div>
<p>The following subsections contain examples that show how to create anonymity documents:</p>
<ul>
<li>
<p><a href="#BEICJDDJ">Making Standard Attributes Anonymous</a></p>
</li>
<li>
<p><a href="#BEICAJIB">Making Undefined Standard Attributes Anonymous</a></p>
</li>
<li>
<p><a href="#BEIDDHJJ">Making Selected Private Attributes Anonymous</a></p>
</li>
<li>
<p><a href="#BEIEAGHA">Making All Private Attributes Anonymous</a></p>
</li>
<li>
<p><a href="#CIHHIHGC">Using DICOM Value Locators in Anonymity Documents</a></p>
</li>
</ul>
<a id="BEICJDDJ"></a>
<div id="IMDCM13469" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.1.1</span> Making Standard Attributes Anonymous</h4>
<p>This subsection shows how to replace a single standard attribute with specified values that make that attribute anonymous in the resulting DICOM content. <a href="#CIHIJIFA">Example 11-1</a> shows a code segment for the standard attribute <code>Patient&#39;s Name</code>. The XML statements where these actions are defined are highlighted in bold.</p>
<div id="IMDCM13658" class="example">
<p class="titleinexample"><a id="CIHIJIFA"></a>Example 11-1 Making a Standard Attribute Anonymous</p>
<pre>&lt;INDIVIDUAL_ATTRIBUTE&gt;
   <span class="bold">&lt;ATTRIBUTE_TAG&gt;00100010&lt;/ATTRIBUTE_TAG&gt;</span>
   &lt;DESCRIPTION&gt;Patient&#39;s Name &lt;/DESCRIPTION&gt;
   <span class="bold">&lt;ANONYMITY_ACTION action=&#34;replace&#34;&gt;anonymous&lt;/ANONYMITY_ACTION&gt;</span>
&lt;/INDIVIDUAL_ATTRIBUTE&gt;
</pre></div>
<!-- class="example" -->
<p>The following code segment shows how the &lt;ATTRIBUTE_TAG&gt; value <code>00100010</code> is defined in the standard dictionary in the data model repository. If the definer name is not specified in the &lt;ATTRIBUTE_TAG&gt; value, the default value of <code>&#34;DICOM</code>&#34; is assumed. The value of the <code>00100010</code> tag is replaced with the value <code>&#34;anonymous&#34;</code> in the resulting DICOM content.</p>
<p>The standard attribute tag <code>00100010</code> is defined as follows in the standard dictionary:</p>
<pre>&lt;STANDARD_ATTRIBUTE_DEFINITION&gt;
   &lt;TAG&gt;00100010&lt;/TAG&gt;
   &lt;NAME&gt;Patient&#39;s Name&lt;/NAME&gt;
   &lt;VR&gt;PN&lt;/VR&gt;
   &lt;VM&gt;1&lt;/VM&gt;
&lt;/STANDARD_ATTRIBUTE_DEFINITION&gt;
</pre>
<p>The tag definition shown in the preceding code segment represents the standard attribute <code>Patient&#39;s Name</code>, of data type <code>PN</code> as defined by the &lt;VR&gt; element. The &lt;VR&gt; element is the value representation element used to specify standard data types, as defined in Part 5 of the DICOM standard. The data type <code>PN</code> is defined in the XML schema <code>ordcmrdt.xsd</code>. The replacement value for the attribute <code>Patient&#39;s Name</code> must be a string representation of the value defined by the &lt;VR&gt; element.</p>
</div>
<!-- class="sect3" -->
<a id="BEICAJIB"></a>
<div id="IMDCM13472" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.1.2</span> Making Undefined Standard Attributes Anonymous</h4>
<p>This subsection shows how to use the action value <code>remove</code> to remove all undefined standard attributes from the resulting DICOM content. <a href="#CIHIJIGI">Example 11-2</a> shows the XML statement where this action is defined.</p>
<div id="IMDCM13659" class="example">
<p class="titleinexample"><a id="CIHIJIGI"></a>Example 11-2 Removing All Undefined Standard Attributes</p>
<pre>&lt;UNDEFINED_STANDARD_ATTRIBUTES action=&#34;remove&#34; /&gt;
</pre></div>
<!-- class="example" --></div>
<!-- class="sect3" -->
<a id="BEIDDHJJ"></a>
<div id="IMDCM13470" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.1.3</span> Making Selected Private Attributes Anonymous</h4>
<p>This subsection shows how to replace a single private attribute with specified values that make that attribute anonymous in the resulting DICOM content. <a href="#CIHEEBAB">Example 11-3</a> shows a code segment for the private attribute <code>10871100(PRIVATE ORG)</code>. The XML statements where these actions are defined are highlighted in bold.</p>
<div id="IMDCM13660" class="example">
<p class="titleinexample"><a id="CIHEEBAB"></a>Example 11-3 Making a Private Attribute Anonymous</p>
<pre>&lt;INDIVIDUAL_ATTRIBUTE&gt;
   <span class="bold">&lt;ATTRIBUTE_TAG&gt;10871100(PRIVATE ORG)&lt;/ATTRIBUTE_TAG&gt;</span>
   &lt;DESCRIPTION&gt;Media Type &lt;/DESCRIPTION&gt;
   <span class="bold">&lt;ANONYMITY_ACTION action=&#34;replace&#34;&gt; replaced&lt;/ANONYMITY_ACTION&gt;</span>
&lt;/INDIVIDUAL_ATTRIBUTE&gt;
</pre></div>
<!-- class="example" -->
<p>In <a href="#CIHEEBAB">Example 11-3</a>, the &lt;ATTRIBUTE_TAG&gt; value <code>10871100</code> with the definer name <code>PRIVATE ORG</code> must be defined in a private dictionary in the data model repository. The value of the private attribute <code>10871100(PRIVATE ORG)</code> is replaced with the specified value in the resulting DICOM content.</p>
<p>The private attribute tag <code>10871100</code> is defined as follows in the private dictionary:</p>
<pre>&lt;PRIVATE_ATTRIBUTE_DEFINITION&gt;
  &lt;TAG&gt;10871100&lt;/TAG&gt;
  &lt;NAME&gt;Media Type&lt;/NAME&gt;
  &lt;DEFINER&gt;PRIVATE ORG&lt;/DEFINER&gt;
  &lt;VR&gt;CS&lt;/VR&gt;
  &lt;VM&gt;1&lt;/VM&gt;
&lt;/PRIVATE_ATTRIBUTE_DEFINITION&gt;
</pre>
<p>This tag definition shown in the preceding code segment represents the private attribute <code>10871100(PRIVATE ORG)</code>, of data type <code>CS</code> and name <code>Media Type</code> as defined by the &lt;VR&gt; element. The data type <code>CS</code> is defined in the XML schema <code>ordcmrdt.xsd</code> as <code>xs:token of length 16</code>. The replacement value must be a string representation that conforms to the value defined by the &lt;VR&gt; element.</p>
</div>
<!-- class="sect3" -->
<a id="BEIEAGHA"></a>
<div id="IMDCM13471" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.1.4</span> Making All Private Attributes Anonymous</h4>
<p>This subsection shows how to make several private attributes anonymous by removing or replacing those attributes with specified values that make them anonymous in the resulting DICOM content.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Keep these guidelines in mind:
<ul>
<li>
<p>The action value for a specified private attribute defined by the &lt;INDIVIDUAL_ATTRIBUTE&gt; element always overrides the global action defined by the &lt;PRIVATE_ATTRIBUTES&gt; element.</p>
</li>
<li>
<p>The global action specified by the &lt;UNDEFINED_PRIVATE_ATTRIBUTES&gt; element overrides the global action defined by the &lt;PRIVATE_ATTRIBUTE&gt; element.</p>
</li>
</ul>
</div>
<p><a href="#CIHBAIAE">Example 11-4</a> shows a code segment that uses the action value <code>remove</code> to remove all private attributes in the resulting DICOM content.</p>
<div id="IMDCM13661" class="example">
<p class="titleinexample"><a id="CIHBAIAE"></a>Example 11-4 Removing All Private Attributes</p>
<pre>&lt;PRIVATE_ATTRIBUTES action=&#34;remove&#34;&gt;&lt;/PRIVATE_ATTRIBUTES&gt;
&lt;UNDEFINED_PRIVATE_ATTRIBUTES action=&#34;remove&#34; /&gt;
</pre></div>
<!-- class="example" -->
<p>Similarly, <a href="#CIHBCACI">Example 11-5</a> shows a code segment that uses the action value <code>remove</code> to remove all undefined private attributes from the resulting DICOM content. And, this code segment uses the action value <code>replace</code> to replace the value of the tag for the defined private attribute <code>10871100(PRIVATE ORG)</code> with the string <code>&#34;anonymous&#34;</code> in the resulting DICOM content. The XML statements where these actions are defined are highlighted in bold.</p>
<div id="IMDCM13662" class="example">
<p class="titleinexample"><a id="CIHBCACI"></a>Example 11-5 Removing All Undefined Private Attributes</p>
<pre><span class="bold">&lt;PRIVATE_ATTRIBUTES action=&#34;remove&#34;&gt;&lt;/PRIVATE_ATTRIBUTES&gt;</span>
&lt;INDIVIDUAL_ATTRIBUTE&gt;
    <span class="bold">&lt;ATTRIBUTE_TAG&gt;10871100(PRIVATE ORG)&lt;/ATTRIBUTE_TAG&gt;</span>
    &lt;DESCRIPTION&gt;Media Type &lt;/DESCRIPTION&gt;
     <span class="bold">&lt;ANONYMITY_ACTION action=&#34;replace&#34;&gt; anonymous&lt;/ANONYMITY_ACTION&gt;</span>
&lt;/INDIVIDUAL_ATTRIBUTE&gt;
</pre></div>
<!-- class="example" -->
<p><a href="#CIHBHGCI">Example 11-6</a> shows a code segment that uses the action value <code>none</code> to include all defined private attributes in the resulting DICOM content. And, this code segment uses the action value <code>remove</code> to remove all undefined private attributes from the resulting DICOM content.</p>
<div id="IMDCM13663" class="example">
<p class="titleinexample"><a id="CIHBHGCI"></a>Example 11-6 Including Defined Private Attributes and Removing Undefined Private Attributes</p>
<pre>&lt;PRIVATE_ATTRIBUTES action=&#34;none&#34;&gt;&lt;/PRIVATE_ATTRIBUTES&gt;
&lt;UNDEFINED_PRIVATE_ATTRIBUTES action=&#34;remove&#34; /&gt; 
</pre></div>
<!-- class="example" -->
<p><a href="#CIHEEBGE">Example 11-7</a> shows a code segment that uses the action value <code>remove</code> to remove all defined private attributes from the resulting DICOM content. And, this code segment uses the action value <code>none</code> to include all undefined private attributes in the resulting DICOM content.</p>
<div id="IMDCM13664" class="example">
<p class="titleinexample"><a id="CIHEEBGE"></a>Example 11-7 Removing Defined Private Attributes and Including Undefined Private Attributes</p>
<pre>&lt;PRIVATE_ATTRIBUTES action=&#34;remove&#34;&gt;&lt;/PRIVATE_ATTRIBUTES&gt;
&lt;UNDEFINED_PRIVATE_ATTRIBUTES action=&#34;none&#34; /&gt; 
</pre></div>
<!-- class="example" --></div>
<!-- class="sect3" -->
<a id="CIHHIHGC"></a>
<div id="IMDCM13625" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.1.5</span> Using DICOM Value Locators in Anonymity Documents</h4>
<p>This subsection shows how to use DICOM value locators to specify attributes in anonymity documents. <a href="#CIHHJJBI">Example 11-8</a> shows how to specify the attribute <code>Person Name</code> with a DICOM value locator to make the attribute anonymous in the resulting DICOM content. This attribute is a child attribute of the attribute Content Sequence (data type SQ). The XML statement where this action is performed is highlighted in bold.</p>
<div id="IMDCM13665" class="example">
<p class="titleinexample"><a id="CIHHJJBI"></a>Example 11-8 Simple DICOM Value Locator in an Anonymity Document</p>
<pre>&lt;INDIVIDUAL_ATTRIBUTE&gt;
  <span class="bold">&lt;ATTRIBUTE_TAG&gt;0040A730[1].0040A123&lt;/ATTRIBUTE_TAG&gt;</span>
  &lt;DESCRIPTION&gt; Person Name &lt;/DESCRIPTION&gt;
  &lt;ANONYMITY_ACTION action=&#34;replace&#34;&gt;anonymous&lt;/ANONYMITY_ACTION&gt;
&lt;/INDIVIDUAL_ATTRIBUTE&gt;
</pre></div>
<!-- class="example" -->
<p>The standard attribute tags <code>0040A730</code> and <code>0040A123</code> are defined as follows in the standard dictionary:</p>
<pre>&lt;STANDARD_ATTRIBUTE_DEFINITION&gt;
   &lt;TAG&gt;0040A730&lt;/TAG&gt;
   &lt;NAME&gt;Content Sequence&lt;/NAME&gt;
   &lt;VR&gt;SQ&lt;/VR&gt;
   &lt;VM&gt;1&lt;/VM&gt;
&lt;/STANDARD_ATTRIBUTE_DEFINITION&gt;
&lt;STANDARD_ATTRIBUTE_DEFINITION&gt;
   &lt;TAG&gt;0040A123&lt;/TAG&gt;
   &lt;NAME&gt;Person Name&lt;/NAME&gt;
   &lt;VR&gt;PN&lt;/VR&gt;
   &lt;VM&gt;1&lt;/VM&gt;
&lt;/STANDARD_ATTRIBUTE_DEFINITION&gt;
</pre>
<p><a href="#CIHCHBDI">Example 11-9</a> shows how to use a DICOM value locator with a wildcard character in an anonymity document to remove attributes with multiple values in the resulting DICOM content. The XML statement where the DICOM value locator is used is highlighted in bold.</p>
<div id="IMDCM13666" class="example">
<p class="titleinexample"><a id="CIHCHBDI"></a>Example 11-9 DICOM Value Locator with a Wildcard Character in an Anonymity Document</p>
<pre>&lt;INDIVIDUAL_ATTRIBUTE&gt;
  <span class="bold">&lt;ATTRIBUTE_TAG&gt;00081050[*]&lt;/ATTRIBUTE_TAG&gt;</span>
  &lt;DESCRIPTION&gt; Performaing physician&#39;s name &lt;/DESCRIPTION&gt;
  &lt;ANONYMITY_ACTION action=&#34;remove&#34;&gt;&lt;/ANONYMITY_ACTION&gt;
&lt;/INDIVIDUAL_ATTRIBUTE&gt;
</pre></div>
<!-- class="example" -->
<p>The standard attribute tag <span class="bold">00081050</span> is defined as follows in the standard dictionary:</p>
<pre>&lt;STANDARD_ATTRIBUTE_DEFINITION&gt;
   &lt;TAG&gt;00081050&lt;/TAG&gt;
   &lt;NAME&gt;Performing Physician&#39;s Name&lt;/NAME&gt;
   &lt;VR&gt;PN&lt;/VR&gt;
   &lt;VM&gt;1-n&lt;/VM&gt;
&lt;/STANDARD_ATTRIBUTE_DEFINITION&gt;
</pre>
<p>In the tag definition shown in the preceding code segment, the &lt;VM&gt; element indicates that this attribute can contain multiple values. Using a wildcard character in the DICOM value locator ensures that all the values for this attribute are made anonymous.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
DICOM value locators with the TAG_FIELD component are not supported in anonymity documents.</div>
<p>See <a href="ch_adm_ref.htm#CHEDJCDJ">General Format for DICOM Value Locators</a> for more information about the DICOM value locator type.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="BGBECDAJ"></a>
<div id="IMDCM13473" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">11.2.2</span> Creating Constraint Documents</h3>
<p>Constraint documents<a id="sthref858"></a> define one or more constraint rules. The XML schema <code>ordcmct.xsd</code> defines the XML schema that constrains constraint documents. (See <a href="ap_schemas.htm#BABEBCJJ">Appendix B</a> for more information about this schema.)</p>
<p>The default constraint documents (<code>ordcmct.xml</code>, <code>ordcmcmd.xml</code>, <code>ordcmcmc.xml</code>), are XML representations of the rules to check the conformance of DICOM content, according to the DICOM standard and other organization-wide guidelines. (See <a href="ap_confg_docs.htm#BEIECEEI">Appendix A</a> for more information about these configuration documents.)</p>
<p>At run time, users can invoke a PL/SQL or Java function to check the conformance of DICOM content according to one or more invokable constraint rules. Each invokable constraint rule is defined as a global rule (using the &lt;GLOBAL_RULE&gt; element). Global rules are constraint rules that define requirements to be met by the DICOM content.</p>
<p>Constraint rules can comprise individual constraint predicates (using the &lt;PREDICATE&gt; element). A <a href="dm_glossary.htm#CHDJAJID"><span class="xrefglossterm">constraint predicate</span></a> defines conditions on DICOM content. A predicate can be a logical statement, a relational statement that compares values, a function call evaluation that returns a Boolean type, or a reference to other predicate definitions. Predicate definitions are recursive. For example, when used as a logical statement, a predicate includes the logical OR of two other predicates. Each of the other predicates, in turn, can be a relational predicate.</p>
<p>Predicates operate on individual attributes or sets of attributes in the DICOM content. Within a predicate, attributes are specified with the &lt;ATTRIBUTE_TAG&gt; element. Attributes are defined by the DICOM standard or by the private organizations or enterprises that create DICOM content. Attributes can be specified using simple DICOM value locators or more complex DICOM value locators, including those with macro substitution strings (see <a href="ch_adm_ref.htm#CHEDJCDJ">General Format for DICOM Value Locators</a>).</p>
<p>Complex constraint rules can be defined more simply using constraint macros. Each <a href="dm_glossary.htm#CHDIGECI"><span class="xrefglossterm">constraint macro</span></a> can be defined as a global macro (using the &lt;GLOBAL_MACRO&gt; element). Constraint macros follow the same predicate definition grammar as constraint rules. They differ from constraint rules in that the predicate operands in constraint macros can contain macro parameters rather than the fixed values contained in constraint rules. The macro parameters in a constraint macro are replaced with parameter values when the macro is invoked (using the &lt;INVOKE_MACRO&gt; element). Constraint macros can also be recursive. As an example, constraint macro A is recursive if it invokes itself or other constraint macros that invoke constraint macro A. Recursive constraint macros are useful when specifying validation requirements for hierarchical or recursive structured DICOM content, such as the content in a DICOM structured report.</p>
<p>Constraint definitions can be separated into multiple constraint document files, with each constraint file defining one or more constraint rules or constraint macros. Global rules and global macros can reference other internal and external global rules and global macros. Internal rules and internal macros are defined within the same constraint file. External rules and external macros are imported from other constraint document files that define those rules and macros. Before referencing a set of external constraint rules or external constraint macros in your constraint file, you must specify those rules or macros in your file (using the &lt;EXTERNAL_RULE_INCLUDE&gt; element or the &lt;EXTERNAL_MACRO_INCLUDE&gt; element, respectively). In addition, DICOM administrators must insert the <span class="italic">referenced</span> constraint document files into the repository before inserting the <span class="italic">referencing</span> constraint files.</p>
<p>In the XML constraint schema <code>ordcmct.xsd</code>, &lt;ACTION&gt; elements are defined to associate conformance validation messages with a predicate, a constraint rule, or a constraint macro. If predicates are evaluated to the conditions specified in the &lt;ACTION&gt; elements associated with the predicates, you can see these messages after conformance validation by querying the view orddcm_conformance_vld_msgs. (See <a href="ch_dtmod_ref.htm#CHDGIBBG">orddcm_conformance_vld_msgs</a> for reference information.)</p>
<p>The following subsections contain examples that show how to create a variety of constraint documents:</p>
<ul>
<li>
<p><a href="#CIHBDCAI">Defining a Simple Constraint Rule</a></p>
</li>
<li>
<p><a href="#BEIEFDGF">Defining Constraint Rules by Importing Other Constraint Rules</a></p>
</li>
<li>
<p><a href="#BGBGGBAG">Defining and Referencing Constraint Macros</a></p>
</li>
<li>
<p><a href="#CIHBEFJJ">Defining Recursive Constraint Macros</a></p>
</li>
<li>
<p><a href="#CIHHHAII">Using DICOM Value Locators in Constraint Documents</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
These subsections contain references to tables in the DICOM standard. For more information about these tables, see the DICOM standard, which is available on the Web site for the National Electrical Manufacturers Association (NEMA) at
<p><code><a href="http://medical.nema.org/">http://medical.nema.org/</a></code></p>
</div>
<a id="CIHBDCAI"></a>
<div id="IMDCM13474" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.2.1</span> Defining a Simple Constraint Rule</h4>
<p>This subsection shows how to construct a simple constraint rule that checks two conditions required by the SOP Common Module, which is defined in the DICOM standard, in PS 3.3, Table C.12-1.</p>
<p>The following table shows the SOP Class UID and SOP Instance UID conditions as they are defined in the SOP Common Module of the DICOM standard.</p>
<div class="inftblruleinformal">
<table class="cellalignment2223" title="Part of DICOM SOP Common Module table" summary="SOP Common Module" dir="ltr">
<thead>
<tr class="cellalignment2212">
<th class="cellalignment2219" id="r1c1-t13">Attribute Name</th>
<th class="cellalignment2219" id="r1c2-t13">Tag</th>
<th class="cellalignment2219" id="r1c3-t13">Type</th>
<th class="cellalignment2219" id="r1c4-t13">Attribute Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r2c1-t13" headers="r1c1-t13">SOP Class UID</td>
<td class="cellalignment2220" headers="r2c1-t13 r1c2-t13">(0008,0016)</td>
<td class="cellalignment2220" headers="r2c1-t13 r1c3-t13">1</td>
<td class="cellalignment2220" headers="r2c1-t13 r1c4-t13">Uniquely identifies the SOP Class. See C.12.1.1.1 for further explanation. See also PS 3.4.</td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r3c1-t13" headers="r1c1-t13">SOP Instance UID</td>
<td class="cellalignment2220" headers="r3c1-t13 r1c2-t13">(0008,0018)</td>
<td class="cellalignment2220" headers="r3c1-t13 r1c3-t13">1</td>
<td class="cellalignment2220" headers="r3c1-t13 r1c4-t13">Uniquely identifies the SOP Instance. See C.12.1.1.1 for further explanation. See also PS 3.4.</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>The two entries in the preceding table indicate that the attributes <code>SOP Class UID (0008,0016)</code> and <code>SOP Instance UID (0008,0018)</code> must exist and cannot be empty.</p>
<p>The code segment in <a href="#CIHBABIF">Example 11-10</a> shows a predicate that checks whether the attribute <code>SOP Class UID (0008,0016)</code> is not empty:</p>
<div id="IMDCM13667" class="example">
<p class="titleinexample"><a id="CIHBABIF"></a>Example 11-10 Predicate for One Condition on SOP Class UID</p>
<pre>    &lt;PREDICATE&gt;
      &lt;BOOLEAN_FUNC operator=&#34;notEmpty&#34;&gt;
        &lt;ATTRIBUTE_TAG&gt;00080016&lt;/ATTRIBUTE_TAG&gt;
      &lt;/BOOLEAN_FUNC&gt;
    &lt;/PREDICATE&gt;
</pre></div>
<!-- class="example" -->
<p>The code segment in <a href="#CIHIFBGH">Example 11-11</a> shows a predicate the checks whether the attribute <code>SOP Instance UID (0008,0018)</code> is not empty:</p>
<div id="IMDCM13668" class="example">
<p class="titleinexample"><a id="CIHIFBGH"></a>Example 11-11 Predicate for One Condition on SOP Instance UID</p>
<pre>   &lt;PREDICATE&gt;
      &lt;BOOLEAN_FUNC operator=&#34;notEmpty&#34;&gt;
        &lt;ATTRIBUTE_TAG&gt;00080018&lt;/ATTRIBUTE_TAG&gt;
      &lt;/BOOLEAN_FUNC&gt;
    &lt;/PREDICATE&gt;
</pre></div>
<!-- class="example" -->
<p>Checking whether both of these attributes are not empty is equivalent to doing a logical AND operation for the two predicates shown in <a href="#CIHBABIF">Example 11-10</a> and <a href="#CIHIFBGH">Example 11-11</a>. The prescribed way to undertake this operation is to define another predicate that performs a logical AND operation on the preceding two predicates. <a href="#CIHDFGAG">Example 11-12</a> shows a predicate with a logical AND operation for these two conditions:</p>
<div id="IMDCM13669" class="example">
<p class="titleinexample"><a id="CIHDFGAG"></a>Example 11-12 Predicate for Two Conditions</p>
<pre> &lt;PREDICATE&gt;
    &lt;LOGICAL operator=&#34;and&#34;&gt;
     &lt;PREDICATE&gt;
      &lt;BOOLEAN_FUNC operator=&#34;notEmpty&#34;&gt;
        &lt;ATTRIBUTE_TAG&gt;00080016&lt;/ATTRIBUTE_TAG&gt;
      &lt;/BOOLEAN_FUNC&gt;
    &lt;/PREDICATE&gt;
    &lt;PREDICATE&gt;
      &lt;BOOLEAN_FUNC operator=&#34;notEmpty&#34;&gt;
        &lt;ATTRIBUTE_TAG&gt;00080018&lt;/ATTRIBUTE_TAG&gt;
      &lt;/BOOLEAN_FUNC&gt;
    &lt;/PREDICATE&gt;
   &lt;/LOGICAL&gt;
&lt;/PREDICATE&gt;
</pre></div>
<!-- class="example" -->
<p>A simpler way to define predicates having logical AND relations is by omitting the outer predicate that was shown in <a href="#CIHDFGAG">Example 11-12</a>. Thus, taking the complete constraint rule from the constraint document <code>ordcmcmd.xml</code>, the global rule <code>SOPCommonModule</code> can be defined as shown in <a href="#CIHGJGBD">Example 11-13</a>:</p>
<div id="IMDCM13670" class="example">
<p class="titleinexample"><a id="CIHGJGBD"></a>Example 11-13 Global Rule for Two Boolean Functions</p>
<pre>  &lt;GLOBAL_RULE name=&#34;SOPCommonModule&#34;&gt;
    &lt;DESCRIPTION&gt;
      A subset of SOP Common Module defined in DICOM standard
    &lt;/DESCRIPTION&gt;
    &lt;PREDICATE&gt;
      &lt;BOOLEAN_FUNC operator=&#34;notEmpty&#34;&gt;
        &lt;ATTRIBUTE_TAG&gt;00080016&lt;/ATTRIBUTE_TAG&gt;
      &lt;/BOOLEAN_FUNC&gt;
    &lt;/PREDICATE&gt;
    &lt;PREDICATE&gt;
      &lt;BOOLEAN_FUNC operator=&#34;notEmpty&#34;&gt;
        &lt;ATTRIBUTE_TAG&gt;00080018&lt;/ATTRIBUTE_TAG&gt;
      &lt;/BOOLEAN_FUNC&gt;
    &lt;/PREDICATE&gt;
  &lt;/GLOBAL_RULE&gt;
</pre></div>
<!-- class="example" -->
<p>Each global rule must have a unique name. Furthermore, each global rule can include an optional &lt;DESCRIPTION&gt; element to provide descriptive information about that rule.</p>
<p>The code segment in <a href="#CIHGJGBD">Example 11-13</a> shows how to define predicates that represent Boolean functions or logical relations. Predicates that represent relational relations can be defined similarly.</p>
<p><a href="#BEICIFDH">Example 11-14</a> is a partial code segment that shows two sample predicates within a global rule. These predicates ensure that no error is raised when the DICOM content that is being validated does not contain attributes in the global rule. <a href="ch_gen_over.htm#BGBJCHGI">Example 3-1</a> shows the complete code segment for this global rule (for the Patient Module).</p>
<div id="IMDCM13808" class="example">
<p class="titleinexample"><a id="BEICIFDH"></a>Example 11-14 Global Rule for Two Conditions on Patient&#39;s Sex</p>
<pre>&lt;GLOBAL_RULE name=&#34;PatientModule&#34;&gt;
.
.
.
   &lt;PREDICATE&gt;
     &lt;BOOLEAN_FUNC operator=&#34;notEmpty&#34;&gt;
       &lt;ATTRIBUTE_TAG&gt;00100040&lt;/ATTRIBUTE_TAG&gt;
     &lt;/BOOLEAN_FUNC&gt;
   &lt;/PREDICATE&gt;
   &lt;PREDICATE&gt;
     &lt;DESCRIPTION&gt;Patient&#39;s Sex&lt;/DESCRIPTION&gt;
     &lt;RELATIONAL operator=&#34;in&#34;&gt;
       &lt;ATTRIBUTE_TAG&gt;00100040&lt;/ATTRIBUTE_TAG&gt;
       &lt;STRING_VALUE&gt;M&lt;/STRING_VALUE&gt;
       &lt;STRING_VALUE&gt;F&lt;/STRING_VALUE&gt;
       &lt;STRING_VALUE&gt;O&lt;/STRING_VALUE&gt;
     &lt;/RELATIONAL&gt;
   &lt;/PREDICATE&gt;
.
.
.
&lt;/GLOBAL_RULE&gt;
</pre></div>
<!-- class="example" -->
<p>The first predicate in <a href="#BEICIFDH">Example 11-14</a> tests the condition that the attribute <code>Patient&#39;s Sex (0010, 0040)</code> is not empty. This predicate ensures that all subsequent predicates that reference the attribute <code>Patient&#39;s Sex (0010, 0040)</code> are tested only when this predicate returns true during conformance validation. Thus, the second predicate is tested only when the DICOM content that is being validated contains the attribute <code>Patient&#39;s Sex (0010, 0040)</code> <span class="italic">and</span> the value is not empty. Therefore, no error is raised if the DICOM content does not contain the attribute <code>Patient&#39;s Sex (0010, 0040)</code>.</p>
<p>See <a href="#CIHBEFJJ">Section 11.2.2.4</a> for more examples of predicates that represent relational relations.</p>
</div>
<!-- class="sect3" -->
<a id="BEIEFDGF"></a>
<div id="IMDCM13475" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.2.2</span> Defining Constraint Rules by Importing Other Constraint Rules</h4>
<p>This subsection shows how to construct constraint rules hierarchically by referencing other external constraint rules. This section also shows how to reference external constraint rules.</p>
<p>The constraint document <code>ordcmct.xml</code> defines the global rule <code>OracleOrdObject</code>. This constraint rule is defined as the logical AND relation of three constraint rules: <code>SOPCommonModule</code>, <code>GeneralSeriesModule</code>, and <code>GeneralStudyModule</code>. <a href="#CIHDCGEB">Example 11-15</a> shows a global rule with a logical AND relation for these three constraint rules:</p>
<div id="IMDCM13671" class="example">
<p class="titleinexample"><a id="CIHDCGEB"></a>Example 11-15 Global Rule for a Logical Relation</p>
<pre> &lt;GLOBAL_RULE name=&#34;OracleOrdObject&#34;&gt;
  &lt;PREDICATE&gt;
    &lt;GLOBAL_RULE_REF&gt;SOPCommonModule&lt;/GLOBAL_RULE_REF&gt;
  &lt;/PREDICATE&gt;
  &lt;PREDICATE&gt;
    &lt;GLOBAL_RULE_REF&gt;GeneralSeriesModule&lt;/GLOBAL_RULE_REF&gt;
  &lt;/PREDICATE&gt;
  &lt;PREDICATE&gt;
    &lt;GLOBAL_RULE_REF&gt;GeneralStudyModule&lt;/GLOBAL_RULE_REF&gt;
  &lt;/PREDICATE&gt;  
 &lt;/GLOBAL_RULE&gt;
</pre></div>
<!-- class="example" -->
<p>These three constraint rules are defined in the constraint document <code>ordcmcmd.xml</code> and imported into the DICOM constraint document <code>ordcmct.xml</code>. <a href="#CIHDDFBI">Example 11-16</a> shows an external rule for these constraint rules:</p>
<div id="IMDCM13672" class="example">
<p class="titleinexample"><a id="CIHDDFBI"></a>Example 11-16 External Rule for Three Constraint Rules</p>
<pre> &lt;EXTERNAL_RULE_INCLUDE name=&#34;GeneralStudyModule&#34;&gt;
   A subset of General Study Module defined in DICOM standard
 &lt;/EXTERNAL_RULE_INCLUDE&gt;   
 &lt;EXTERNAL_RULE_INCLUDE name=&#34;GeneralSeriesModule&#34;&gt;
   A subset of General Series Module defined in DICOM standard
 &lt;/EXTERNAL_RULE_INCLUDE&gt; 
 &lt;EXTERNAL_RULE_INCLUDE  name=&#34;SOPCommonModule&#34;&gt;
   A subset of SOP Common Module defined in DICOM standard
 &lt;/EXTERNAL_RULE_INCLUDE&gt;
</pre></div>
<!-- class="example" -->
<p>Thus, the global rule <code>OracleOrdObject</code> references the global rule <code>SOPCommonModule</code> that is defined in <a href="#CIHBDCAI">Section 11.2.2.1</a>. Other constraint rules can also reference the global rule <code>SOPCommonModule</code>. In this way, constraint documents can be written in a modular and structured fashion.</p>
</div>
<!-- class="sect3" -->
<a id="BGBGGBAG"></a>
<div id="IMDCM13476" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.2.3</span> Defining and Referencing Constraint Macros</h4>
<p>This subsection shows how to construct a constraint macro that checks whether a DICOM attribute is a code sequence attribute. The constraint macro performs this checking operation by following the first two conditions required by the Code Sequence Macro, which is defined in the DICOM standard, in PS 3.3, Table 8.8-1.</p>
<p>The following table shows the Code Value and Coding Scheme Designator conditions as they are defined in the Code Sequence Macro of the DICOM standard.</p>
<div class="inftblruleinformal">
<table class="cellalignment2223" title="Part of DICOM Code Sequence Macro table" summary="Code Sequence Macro" dir="ltr">
<thead>
<tr class="cellalignment2212">
<th class="cellalignment2219" id="r1c1-t14">Attribute Name</th>
<th class="cellalignment2219" id="r1c2-t14">Tag</th>
<th class="cellalignment2219" id="r1c3-t14">Type</th>
<th class="cellalignment2219" id="r1c4-t14">Attribute Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r2c1-t14" headers="r1c1-t14">Code Value</td>
<td class="cellalignment2220" headers="r2c1-t14 r1c2-t14">(0008,0100)</td>
<td class="cellalignment2220" headers="r2c1-t14 r1c3-t14">1C</td>
<td class="cellalignment2220" headers="r2c1-t14 r1c4-t14">See Section 8.1. Required if a sequence item is present.</td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r3c1-t14" headers="r1c1-t14">Coding Scheme Designator</td>
<td class="cellalignment2220" headers="r3c1-t14 r1c2-t14">(0008,0102)</td>
<td class="cellalignment2220" headers="r3c1-t14 r1c3-t14">1C</td>
<td class="cellalignment2220" headers="r3c1-t14 r1c4-t14">See Section 8.2. Required if a sequence item is present.</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>The two entries in the preceding table indicate that the mandatory child attributes <code>Code Value (0008,0100)</code> and <code>Coding Scheme Designator (0008,0102)</code> must not be empty.</p>
<p><a href="#CIHJHIIB">Example 11-17</a> shows a global macro definition (from the default constraint document <code>ordcmcmc.xml</code>) that checks whether the attributes <code>Code Value (0008,0100)</code> and <code>Coding Scheme Designator (0008,0102)</code> are not empty:</p>
<div id="IMDCM13673" class="example">
<p class="titleinexample"><a id="CIHJHIIB"></a>Example 11-17 Global Macro for a Condition</p>
<pre>  &lt;GLOBAL_MACRO name=&#34;CodeSequenceMacro&#34;&gt;
   &lt;DESCRIPTION&gt;
     A subset of Code Sequence Macro defined in DICOM standard
   &lt;/DESCRIPTION&gt;
  &lt;PARAMETER_DECLARATION&gt;CodeAttr&lt;/PARAMETER_DECLARATION&gt;
  &lt;PREDICATE&gt;
   &lt;DESCRIPTION&gt;Code value must not be empty&lt;/DESCRIPTION&gt;
   &lt;BOOLEAN_FUNC operator=&#34;notEmpty&#34;&gt;
    &lt;ATTRIBUTE_TAG&gt;${CodeAttr}.00080100&lt;/ATTRIBUTE_TAG&gt;
   &lt;/BOOLEAN_FUNC&gt;
  &lt;/PREDICATE&gt;
  &lt;PREDICATE&gt;
   &lt;DESCRIPTION&gt;Coding scheme designator must not be empty&lt;/DESCRIPTION&gt;
   &lt;BOOLEAN_FUNC operator=&#34;notEmpty&#34;&gt;
    &lt;ATTRIBUTE_TAG&gt;${CodeAttr}.00080102&lt;/ATTRIBUTE_TAG&gt;
   &lt;/BOOLEAN_FUNC&gt;
  &lt;/PREDICATE&gt;
 &lt;/GLOBAL_MACRO&gt;
</pre></div>
<!-- class="example" -->
<p>Predicates that are included in constraint macros include operands that contain parameters. These parameters must be defined in &lt;PARAMETER_DECLARATION&gt; elements. When the parameters are referenced in these operands, the parameters must be preceded by the dollar sign symbol and enclosed within braces as in: <code>${ }</code>. In the preceding code segment, the parameter <code>CodeAttr</code> represents the code sequence to be examined. Thus, checking whether the code value of the parameter <code>CodeAttr</code> is not empty is equivalent to checking whether the parameter <code>${CodeAttr}.00080100</code> is not empty.</p>
<p>Constraint macros can be invoked by one or more constraint rules, with the macro parameters being set to different values. To invoke a constraint macro, you must specify the name of the macro with the name value pairs of all parameters for that macro.</p>
<p><a href="#CIHDJDCH">Example 11-18</a> shows the definition for the global rule <code>GeneralSeriesModule</code> (from the default constraint document <code>ordcmcmd.xml</code>), which invokes the constraint macro <code>CodeSequenceMacro</code>. The code statements where this macro is invoked are highlighted in bold.</p>
<div id="IMDCM13674" class="example">
<p class="titleinexample"><a id="CIHDJDCH"></a>Example 11-18 Global Rule with a Constraint Macro</p>
<pre>&lt;GLOBAL_RULE name=&#34;GeneralSeriesModule&#34;&gt;
    &lt;DESCRIPTION&gt;
      A subset of General Series Module defined in DICOM standard
    &lt;/DESCRIPTION&gt;
    &lt;PREDICATE&gt;
      &lt;BOOLEAN_FUNC operator=&#34;notEmpty&#34;&gt;
        &lt;ATTRIBUTE_TAG&gt;00080060&lt;/ATTRIBUTE_TAG&gt;
      &lt;/BOOLEAN_FUNC&gt;
      &lt;ACTION action=&#34;warning&#34; when=&#34;false&#34;&gt;
        missing attribute 00080060 
      &lt;/ACTION&gt;
    &lt;/PREDICATE&gt;
    &lt;PREDICATE&gt;
      &lt;BOOLEAN_FUNC operator=&#34;notEmpty&#34;&gt;
        &lt;ATTRIBUTE_TAG&gt;0020000E&lt;/ATTRIBUTE_TAG&gt;
      &lt;/BOOLEAN_FUNC&gt;
      &lt;ACTION action=&#34;warning&#34; when=&#34;false&#34;&gt;
        missing attribute 0020000E 
      &lt;/ACTION&gt;
    &lt;/PREDICATE&gt;
    &lt;PREDICATE&gt;
      &lt;LOGICAL operator=&#34;derive&#34;&gt;
        &lt;PREDICATE&gt;
          &lt;BOOLEAN_FUNC operator=&#34;notEmpty&#34;&gt;
            &lt;ATTRIBUTE_TAG&gt;00400260&lt;/ATTRIBUTE_TAG&gt;
          &lt;/BOOLEAN_FUNC&gt;
        &lt;/PREDICATE&gt;
        &lt;PREDICATE&gt;
          <span class="bold">&lt;INVOKE_MACRO&gt;</span>
            <span class="bold">&lt;MACRO_NAME&gt;CodeSequenceMacro&lt;/MACRO_NAME&gt;</span>
            <span class="bold">&lt;PARAMETER&gt;</span>
              <span class="bold">&lt;NAME&gt;CodeAttr&lt;/NAME&gt;</span>
              <span class="bold">&lt;VALUE&gt;00400260&lt;/VALUE&gt;</span>
            <span class="bold">&lt;/PARAMETER&gt;</span>
          <span class="bold">&lt;/INVOKE_MACRO&gt;</span>
          &lt;ACTION action=&#34;warning&#34; when=&#34;false&#34;&gt;
            missing attribute 00400260.00080100 or 00400260.00080102 
          &lt;/ACTION&gt;
        &lt;/PREDICATE&gt;
      &lt;/LOGICAL&gt;
    &lt;/PREDICATE&gt;
    &lt;ACTION action=&#34;warning&#34; when=&#34;false&#34;&gt;
      GeneralSeriesModule is not satisfied
    &lt;/ACTION&gt;
  &lt;/GLOBAL_RULE&gt;  
</pre></div>
<!-- class="example" -->
<p>Because the constraint macro <code>CodeSequenceMacro</code> is defined in a different constraint file, it is imported in the beginning of the constraint document <code>ordcmcmd.xml</code>, as follows:</p>
<pre>&lt;EXTERNAL_MACRO_INCLUDE name=&#34;CodeSequenceMacro&#34;&gt;
Defines a code sequence macro&lt;/EXTERNAL_MACRO_INCLUDE&gt;
</pre>
<p>When users check whether the DICOM content conforms to the constraint rule <code>GeneralSeriesModule</code>, the DICOM content is checked against the constraint macro <code>CodeSequenceMacro</code>, where the parameter <code>CodeAttr</code> is substituted as <code>00400260</code>. Specifically, the predicate to check the &lt;ATTRIBUTE_TAG&gt; element <code>${CodeAttr}.00080100 not empty</code> becomes <code>00400260.00080100 not empty</code>. And, the &lt;ATTRIBUTE_TAG&gt; element <code>${CodeAttr}.00080102 not empty</code> becomes <code>00400260.00080102 not empty</code>.</p>
<p>If the constraint macro <code>CodeSequenceMacro</code> with the parameter <code>CodeAttr</code> substituted as <code>00400260</code> evaluates to <code>false</code> on the DICOM content, the view orddcm_conformance_vld_msgs contains the message <code>&#34;missing attribute 00400260.00080100 or 00400260.00080102&#34;</code> for the DICOM content. These conformance validation messages can be used to provide information about specific attributes in the DICOM content that do not conform to the constraint rules.</p>
<p>See the <a href="ch_dtmod_ref.htm#CHDGIBBG">orddcm_conformance_vld_msgs</a> view for more information about these messages.</p>
</div>
<!-- class="sect3" -->
<a id="CIHBEFJJ"></a>
<div id="IMDCM13477" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.2.4</span> Defining Recursive Constraint Macros</h4>
<p>This subsection shows two examples that check a subset of attributes required by the SR Document Content Module, which is defined in the DICOM standard, in PS 3.3, Section C.17.3.</p>
<p>The following table shows the Content Sequence and Relationship Type attributes as they are defined in the Document Relationship Macro Attributes in Table C.17-6. The table also shows the Value Type attribute as it is defined in the Document Content Macro Attributes in Table C.17-5.</p>
<div class="inftblruleinformal">
<table class="cellalignment2223" title="Portions of three DICOM SR Document Content Module tables" summary="SR Document Content Module attributes" dir="ltr">
<thead>
<tr class="cellalignment2212">
<th class="cellalignment2219" id="r1c1-t15">Attribute Name</th>
<th class="cellalignment2219" id="r1c2-t15">Tag</th>
<th class="cellalignment2219" id="r1c3-t15">Type</th>
<th class="cellalignment2219" id="r1c4-t15">Attribute Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r2c1-t15" headers="r1c1-t15">Content Sequence</td>
<td class="cellalignment2220" headers="r2c1-t15 r1c2-t15">(0040,A730)</td>
<td class="cellalignment2220" headers="r2c1-t15 r1c3-t15">1C</td>
<td class="cellalignment2220" headers="r2c1-t15 r1c4-t15">A potentially recursively nested Sequence of items that conveys content that is the Target of Relationships with the enclosing Source Content Item.
<p>One or more Items may be included in this sequence.</p>
<p>Required if the enclosing Content Item has relationships.</p>
<p>Notes:</p>
<ol>
<li>
<p>If this Attribute is not present then the enclosing Item is a leaf.</p>
</li>
<li>
<p>The order of Items within this Sequence is semantically significant for presentation.</p>
</li>
</ol>
<p>See C.17.3.2.4 for further explanation.</p>
</td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r3c1-t15" headers="r1c1-t15">Relationship Type</td>
<td class="cellalignment2220" headers="r3c1-t15 r1c2-t15">(0040,A010)</td>
<td class="cellalignment2220" headers="r3c1-t15 r1c3-t15">1</td>
<td class="cellalignment2220" headers="r3c1-t15 r1c4-t15">The type of relationship between the (enclosing) Source Content Item and the Target Content Item.
<p>IODs specify additional constraints on Relationships (including lists of Enumerated Values).</p>
<p>Defined Terms:</p>
<br/>
CONTAINS<br/>
HAS PROPERTIES<br/>
HAS OBS CONTEXT<br/>
HAS ACQ CONTEXT<br/>
INFERRED FROM<br/>
SELECTED FROM<br/>
HAS CONCEPT MOD
<p>See C.17.3.2.4 for further explanation.</p>
</td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r4c1-t15" headers="r1c1-t15">Value Type</td>
<td class="cellalignment2220" headers="r4c1-t15 r1c2-t15">(0040,A040)</td>
<td class="cellalignment2220" headers="r4c1-t15 r1c3-t15">1</td>
<td class="cellalignment2220" headers="r4c1-t15 r1c4-t15">The type of the value encoded in this Content Item.
<p>Defined Terms:</p>
<br/>
TEXT<br/>
NUM<br/>
CODE<br/>
DATETIME<br/>
DATE<br/>
TIME<br/>
UIDREF<br/>
PNAME<br/>
COMPOSITE<br/>
IMAGE<br/>
WAVEFORM<br/>
SCOORD<br/>
TCOORD<br/>
CONTAINER
<p>See C.17.3.2.1 for further explanation.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>For example, the attribute <code>Content Sequence (0040,A730)</code> provides the hierarchical structuring of the Content Tree (DICOM standard, PS 3.3, Section C.17.3.1) by recursively nesting Content Items. A parent (or source) Content Item has an explicit relationship to each child (or target) Content Item, which is conveyed by the attribute <code>Relationship Type (0040,A010)</code> (DICOM standard, PS 3.3, Section C.17.3.2.4).</p>
<p>To avoid infinite loops and control how many levels of the hierarchy structure to evaluate, use the preference parameter MAX_RECURSION_DEPTH in the preference document to specify the number of levels of recursion for a constraint macro. See <a href="#BEIECGDH">Section 11.2.5.6</a> for information about defining this preference parameter in a preference document.</p>
<p>The code segment in <a href="#CIHFJJCB">Example 11-19</a> is an example of recursion with a single constraint macro that invokes itself. The code segment in <a href="#CIHCECFG">Example 11-20</a> is an example of recursion between two different constraint macros, with the first macro invoking a second macro, which then invokes the first macro.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The examples in this section are not shipped with the installation software.</div>
<p class="subhead2"><a id="IMDCM13478"></a>Recursion with a Single Constraint Macro</p>
<p><a href="#CIHFJJCB">Example 11-19</a> defines the recursive global constraint macro <code>DocumentContentMacro</code>. This macro is invoked by the global constraint rule <code>DocumentContentModule</code>. The code statements where this macro is defined and invoked are highlighted in bold.</p>
<div id="IMDCM13675" class="example">
<p class="titleinexample"><a id="CIHFJJCB"></a>Example 11-19 One Constraint Macro with Recursion</p>
<pre><span class="bold">&lt;GLOBAL_MACRO name=&#34;DocumentContentMacro&#34;&gt;</span>
    &lt;PARAMETER_DECLARATION&gt;tag&lt;/PARAMETER_DECLARATION&gt;
    &lt;PREDICATE&gt;
      &lt;BOOLEAN_FUNC operator=&#34;notEmpty&#34;&gt;
        &lt;ATTRIBUTE_TAG&gt;${tag}.0040A010&lt;/ATTRIBUTE_TAG&gt;
      &lt;/BOOLEAN_FUNC&gt;
    &lt;/PREDICATE&gt;
    &lt;PREDICATE&gt;
      &lt;RELATIONAL operator=&#34;in&#34;&gt;
        &lt;ATTRIBUTE_TAG&gt;${tag}.0040A010&lt;/ATTRIBUTE_TAG&gt;
        &lt;STRING_VALUE&gt;CONTAINS&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;HAS PROPERTIES&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;HAS OBS CONTEXT&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;HAS ACQ CONTEXT&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;INFERRED FROM&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;SELECTED FROM&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;HAS CONCEPT MOD&lt;/STRING_VALUE&gt;
      &lt;/RELATIONAL&gt;
    &lt;/PREDICATE&gt;
    &lt;PREDICATE&gt;
      &lt;BOOLEAN_FUNC operator=&#34;notEmpty&#34;&gt;
        &lt;ATTRIBUTE_TAG&gt;${tag}.0040A040&lt;/ATTRIBUTE_TAG&gt;
      &lt;/BOOLEAN_FUNC&gt;
      &lt;ACTION action=&#34;log&#34; when=&#34;true&#34;&gt;${RUNTIME_TAG} is not empty&lt;/ACTION&gt;
    &lt;/PREDICATE&gt;
    &lt;PREDICATE&gt;
      &lt;LOGICAL operator=&#34;derive&#34;&gt;
        &lt;PREDICATE&gt;
          &lt;RELATIONAL operator=&#34;eq&#34;&gt;
            &lt;ATTRIBUTE_TAG&gt;${tag}.0040A040&lt;/ATTRIBUTE_TAG&gt;
            &lt;STRING_VALUE&gt;CONTAINER&lt;/STRING_VALUE&gt;
          &lt;/RELATIONAL&gt;
           &lt;ACTION action=&#34;log&#34; when=&#34;false&#34;&gt;${RUNTIME_TAG} value is not
             CONTAINER&lt;/ACTION&gt;
        &lt;/PREDICATE&gt;
        &lt;PREDICATE&gt;
          &lt;INVOKE_MACRO&gt;
            <span class="bold">&lt;MACRO_NAME&gt;DocumentContentMacro&lt;/MACRO_NAME&gt;</span>
            &lt;PARAMETER&gt;
              &lt;NAME&gt;tag&lt;/NAME&gt;
              &lt;VALUE&gt;${tag}.0040A730[*]&lt;/VALUE&gt;
            &lt;/PARAMETER&gt;
          &lt;/INVOKE_MACRO&gt;
        &lt;/PREDICATE&gt;
      &lt;/LOGICAL&gt;
    &lt;/PREDICATE&gt;
  &lt;/GLOBAL_MACRO&gt;
&lt;GLOBAL_RULE name=&#34;DocumentContentModule&#34;&gt;
    &lt;PREDICATE&gt;
      &lt;INVOKE_MACRO&gt;
        <span class="bold">&lt;MACRO_NAME&gt;DocumentContentMacro&lt;/MACRO_NAME&gt;</span>
        &lt;PARAMETER&gt;
          &lt;NAME&gt;tag&lt;/NAME&gt;
          &lt;VALUE&gt;0040A730[*]&lt;/VALUE&gt;
        &lt;/PARAMETER&gt;
      &lt;/INVOKE_MACRO&gt;
    &lt;/PREDICATE&gt;
  &lt;/GLOBAL_RULE&gt;
</pre></div>
<!-- class="example" -->
<p>During conformance validation, the <code>${RUNTIME_TAG}</code> tags in &lt;ACTION&gt; elements are replaced by the DICOM value locators whose corresponding attributes in the DICOM content are evaluated to meet the condition specified by the <code>when</code> attribute of the &lt;ACTION&gt; element. The first action creates a message that contains a list of DICOM value locators, all ending with tag <code>0040A040</code>, whose corresponding attributes in the DICOM content are not empty. The second action creates a message that contains a list of DICOM value locators, all ending with tag <code>0040A040</code>, whose corresponding attributes in the DICOM content do not match <code>CONTAINER</code>.</p>
<p>In <a href="#CIHFJJCB">Example 11-19</a>, the recursion occurs when the recursive constraint macro invokes itself by specifying the name value pair of the parameter defined for that macro.</p>
<p>In the definition of the macro <code>DocumentContentMacro</code>, the first predicate checks whether the attribute <code>${tag}.0040A010</code> is not empty. The second predicate uses a relational operation to check whether this attribute has a valid value. The third predicate checks whether the attribute <code>${tag}.0040A040</code> is not empty. The fourth predicate checks whether the value of <code>${tag}.0040A040</code> is <code>CONTAINER</code>. If so, then the macro <code>DocumentContentMacro</code> is invoked on the content sequence of <code>${tag}.0040A730[*]</code>. The code <code>[*]</code> is a wildcard character that represents the numbered series of attributes in the constraint document to be checked by the macro.</p>
<p class="subhead2"><a id="IMDCM13479"></a>Recursion with Two Constraint Macros</p>
<p><a href="#CIHCECFG">Example 11-20</a> defines two recursive global constraint macros: <code>DocumentContentMacroA</code> and <code>DocumentContentMacroB</code>. The code statements where these macros are defined and invoked are highlighted in bold.</p>
<div id="IMDCM13676" class="example">
<p class="titleinexample"><a id="CIHCECFG"></a>Example 11-20 Two Constraint Macros with Recursion</p>
<pre>  <span class="bold">&lt;GLOBAL_MACRO name=&#34;DocumentContentMacroA&#34;&gt;</span>
    &lt;PARAMETER_DECLARATION&gt;attr&lt;/PARAMETER_DECLARATION&gt;
    &lt;PREDICATE&gt;
      &lt;BOOLEAN_FUNC operator=&#34;notEmpty&#34;&gt;
        &lt;ATTRIBUTE_TAG&gt;${attr}.0040A040&lt;/ATTRIBUTE_TAG&gt;
      &lt;/BOOLEAN_FUNC&gt;
    &lt;/PREDICATE&gt;
    &lt;PREDICATE&gt;
      &lt;LOGICAL operator=&#34;derive&#34;&gt;
        &lt;PREDICATE&gt;
          &lt;RELATIONAL operator=&#34;eq&#34;&gt;
            &lt;ATTRIBUTE_TAG&gt;${attr}.0040A040&lt;/ATTRIBUTE_TAG&gt;
            &lt;STRING_VALUE&gt;CONTAINER&lt;/STRING_VALUE&gt;
           &lt;/RELATIONAL&gt;
        &lt;/PREDICATE&gt;
        &lt;PREDICATE&gt;
          &lt;INVOKE_MACRO&gt;
            <span class="bold">&lt;MACRO_NAME&gt;DocumentContentMacroB&lt;/MACRO_NAME&gt;</span>
            &lt;PARAMETER&gt;
              &lt;NAME&gt;tag&lt;/NAME&gt;
              &lt;VALUE&gt;${attr}.0040A730[*]&lt;/VALUE&gt;
            &lt;/PARAMETER&gt;
          &lt;/INVOKE_MACRO&gt;
        &lt;/PREDICATE&gt;
      &lt;/LOGICAL&gt;
    &lt;/PREDICATE&gt;
  &lt;/GLOBAL_MACRO&gt;
 
  <span class="bold">&lt;GLOBAL_MACRO name=&#34;DocumentContentMacroB&#34;&gt;</span>
    &lt;PARAMETER_DECLARATION&gt;tag&lt;/PARAMETER_DECLARATION&gt;
    &lt;PREDICATE&gt;
      &lt;BOOLEAN_FUNC operator=&#34;notEmpty&#34;&gt;
        &lt;ATTRIBUTE_TAG&gt;${tag}.0040A010&lt;/ATTRIBUTE_TAG&gt;
      &lt;/BOOLEAN_FUNC&gt;
    &lt;/PREDICATE&gt;
    &lt;PREDICATE&gt;
      &lt;RELATIONAL operator=&#34;in&#34;&gt;
        &lt;ATTRIBUTE_TAG&gt;${tag}.0040A010&lt;/ATTRIBUTE_TAG&gt;
        &lt;STRING_VALUE&gt;CONTAINS&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;HAS PROPERTIES&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;HAS OBS CONTEXT&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;HAS ACQ CONTEXT&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;INFERRED FROM&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;SELECTED FROM&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;HAS CONCEPT MOD&lt;/STRING_VALUE&gt;
      &lt;/RELATIONAL&gt;
    &lt;/PREDICATE&gt;
    &lt;PREDICATE&gt;
      &lt;INVOKE_MACRO&gt;
        <span class="bold">&lt;MACRO_NAME&gt;DocumentContentMacroA&lt;/MACRO_NAME&gt;</span>
        &lt;PARAMETER&gt;
          &lt;NAME&gt;attr&lt;/NAME&gt;
          &lt;VALUE&gt;${tag}&lt;/VALUE&gt;
        &lt;/PARAMETER&gt;
      &lt;/INVOKE_MACRO&gt;
    &lt;/PREDICATE&gt;
  &lt;/GLOBAL_MACRO&gt;
</pre></div>
<!-- class="example" -->
<p>In <a href="#CIHCECFG">Example 11-20</a>, the recursion occurs when <code>DocumentContentMacroB</code> invokes <code>DocumentContentMacroA</code>, and then <code>DocumentContentMacroA</code> invokes <code>DocumentContentMacroB</code>.</p>
</div>
<!-- class="sect3" -->
<a id="CIHHHAII"></a>
<div id="IMDCM13626" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.2.5</span> Using DICOM Value Locators in Constraint Documents</h4>
<p>This subsection shows how to use DICOM value locators to specify attributes in constraint documents. DICOM value locators can be used to specify predicates that include private attributes and their definers. DICOM value locators can contain macros for substitution when the constraint document is loaded into the repository.</p>
<p>The following list shows a few examples of valid macro substitution strings:</p>
<ul>
<li>
<p>A complete series of sublocators</p>
</li>
<li>
<p>A tag, including the special wildcard tag <code>&#34;.&#34;</code></p>
</li>
<li>
<p>A definer name (<code>DICOM</code>, the default name, or the name of a private definer)</p>
</li>
<li>
<p>An item number (a positive integer or the wildcard character <code>&#39;*&#39;</code>)</p>
</li>
</ul>
<p>See <a href="ch_adm_ref.htm#CHEDJCDJ">General Format for DICOM Value Locators</a> for complete reference information.</p>
<p><a href="#CIHJCFGF">Example 11-21</a> shows how to specify the attribute <code>Content Sequence</code> with a DICOM value locator in a global constraint macro and create a log of the results at run time. (This example uses some code from <a href="#CIHFJJCB">Example 11-19</a>.) The DICOM value locators are highlighted in bold.</p>
<div id="IMDCM13677" class="example">
<p class="titleinexample"><a id="CIHJCFGF"></a>Example 11-21 DICOM Value Locator with a Wildcard Character in a Constraint Macro</p>
<pre>&lt;GLOBAL_MACRO name=&#34;DocumentContentMacro&#34;&gt;
    &lt;PARAMETER_DECLARATION&gt;tag&lt;/PARAMETER_DECLARATION&gt;
    &lt;PREDICATE&gt;
      &lt;BOOLEAN_FUNC operator=&#34;notEmpty&#34;&gt;
        &lt;ATTRIBUTE_TAG&gt;<span class="bold">${tag}.0040A010</span>&lt;/ATTRIBUTE_TAG&gt;
      &lt;/BOOLEAN_FUNC&gt;
    &lt;/PREDICATE&gt;
    &lt;PREDICATE&gt;
      &lt;RELATIONAL operator=&#34;in&#34;&gt;
        &lt;ATTRIBUTE_TAG&gt;<span class="bold">${tag}.0040A010</span>&lt;/ATTRIBUTE_TAG&gt;
        &lt;STRING_VALUE&gt;CONTAINS&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;HAS PROPERTIES&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;HAS OBS CONTEXT&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;HAS ACQ CONTEXT&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;INFERRED FROM&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;SELECTED FROM&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;HAS CONCEPT MOD&lt;/STRING_VALUE&gt;
      &lt;/RELATIONAL&gt;
    &lt;/PREDICATE&gt;
    &lt;PREDICATE&gt;
      &lt;BOOLEAN_FUNC operator=&#34;notEmpty&#34;&gt;
        &lt;ATTRIBUTE_TAG&gt;<span class="bold">${tag}.0040A040</span>&lt;/ATTRIBUTE_TAG&gt;
      &lt;/BOOLEAN_FUNC&gt;
      &lt;ACTION action=&#34;log&#34; when=&#34;true&#34;&gt;${RUNTIME_TAG} is not empty&lt;/ACTION&gt;
    &lt;/PREDICATE&gt;
    &lt;PREDICATE&gt;
      &lt;LOGICAL operator=&#34;derive&#34;&gt;
        &lt;PREDICATE&gt;
          &lt;RELATIONAL operator=&#34;eq&#34;&gt;
            &lt;ATTRIBUTE_TAG&gt;<span class="bold">${tag}.0040A040</span>&lt;/ATTRIBUTE_TAG&gt;
            &lt;STRING_VALUE&gt;CONTAINER&lt;/STRING_VALUE&gt;
          &lt;/RELATIONAL&gt;
           &lt;ACTION action=&#34;log&#34; when=&#34;false&#34;&gt;${RUNTIME_TAG} value is not
             CONTAINER&lt;/ACTION&gt;
        &lt;/PREDICATE&gt;
        &lt;PREDICATE&gt;
          &lt;INVOKE_MACRO&gt;
            &lt;MACRO_NAME&gt;DocumentContentMacro&lt;/MACRO_NAME&gt;
            &lt;PARAMETER&gt;
              &lt;NAME&gt;tag&lt;/NAME&gt;
              &lt;VALUE&gt;<span class="bold">${tag}.0040A730[*]</span>&lt;/VALUE&gt;
            &lt;/PARAMETER&gt;
          &lt;/INVOKE_MACRO&gt;
        &lt;/PREDICATE&gt;
      &lt;/LOGICAL&gt;
    &lt;/PREDICATE&gt;
  &lt;/GLOBAL_MACRO&gt;
&lt;GLOBAL_RULE name=&#34;DocumentContentModule&#34;&gt;
    &lt;PREDICATE&gt;
      &lt;INVOKE_MACRO&gt;
        &lt;MACRO_NAME&gt;DocumentContentMacro&lt;/MACRO_NAME&gt;
        &lt;PARAMETER&gt;
          &lt;NAME&gt;tag&lt;/NAME&gt;
          &lt;VALUE&gt;<span class="bold">0040A730[*]</span>&lt;/VALUE&gt;
        &lt;/PARAMETER&gt;
      &lt;/INVOKE_MACRO&gt;
    &lt;/PREDICATE&gt;
  &lt;/GLOBAL_RULE&gt;
</pre></div>
<!-- class="example" -->
<p>The standard attribute tags <code>0040A010</code>, <code>0040A040</code>, and <code>0040A730</code> are defined as follows in the standard dictionary:</p>
<pre>&lt;STANDARD_ATTRIBUTE_DEFINITION&gt;
   &lt;TAG&gt;0040A010&lt;/TAG&gt;
   &lt;NAME&gt;Relationship Type&lt;/NAME&gt;
   &lt;VR&gt;CS&lt;/VR&gt;
   &lt;VM&gt;1&lt;/VM&gt;
&lt;/STANDARD_ATTRIBUTE_DEFINITION&gt;
&lt;STANDARD_ATTRIBUTE_DEFINITION&gt;
   &lt;TAG&gt;0040A040&lt;/TAG&gt;
   &lt;NAME&gt;Value Type&lt;/NAME&gt;
   &lt;VR&gt;CS&lt;/VR&gt;
   &lt;VM&gt;1&lt;/VM&gt;
&lt;/STANDARD_ATTRIBUTE_DEFINITION&gt;
&lt;STANDARD_ATTRIBUTE_DEFINITION&gt;
   &lt;TAG&gt;0040A730&lt;/TAG&gt;
   &lt;NAME&gt;Content Sequence&lt;/NAME&gt;
   &lt;VR&gt;SQ&lt;/VR&gt;
   &lt;VM&gt;1&lt;/VM&gt;
&lt;/STANDARD_ATTRIBUTE_DEFINITION&gt;
</pre>
<p>In the tag definition shown in the preceding code segment, the &lt;VR&gt; element of tag <code>0040A730</code> indicates that this tag is a sequence tag and the corresponding attribute in the DICOM content can contain multiple sequence items. Using a wildcard character in the DICOM value locator ensures that all the items for this attribute are checked.</p>
<p><a href="#CIHIFCBG">Example 11-22</a> shows how to specify all the <code>Relationship Type</code> attributes with a DICOM value locator in a global rule. The DICOM value locator is highlighted in bold.</p>
<div id="IMDCM13678" class="example">
<p class="titleinexample"><a id="CIHIFCBG"></a>Example 11-22 DICOM Value Locator with a Special Wildcard Tag in a Global Rule</p>
<pre>&lt;GLOBAL_RULE name=&#34;MagicTagTest&#34;&gt;
    &lt;PREDICATE&gt;
       &lt;RELATIONAL operator=&#34;in&#34;&gt;
        &lt;ATTRIBUTE_TAG&gt;<span class="bold">..0040A010</span>&lt;/ATTRIBUTE_TAG&gt;
        &lt;STRING_VALUE&gt;CONTAINS&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;HAS PROPERTIES&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;HAS OBS CONTEXT&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;HAS ACQ CONTEXT&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;INFERRED FROM&lt;/STRING_VALUE&gt;
        &lt;STRING_VALUE&gt;HAS CONCEPT MOD&lt;/STRING_VALUE&gt;
      &lt;/RELATIONAL&gt;
      &lt;ACTION action=&#34;log&#34; when=&#34;false&#34;&gt;${RUNTIME_TAG} does not contain required
        values&lt;/ACTION&gt;
    &lt;/PREDICATE&gt;
  &lt;/GLOBAL_RULE&gt;
 
</pre></div>
<!-- class="example" -->
<p>In <a href="#CIHIFCBG">Example 11-22</a>, the DICOM value locator for all <code>0040A010</code> attributes includes the special wildcard tag <code>&#34;.&#34;</code> to indicate that the predicate performs a relational operation to check all the Relational Type attributes in the DICOM content.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The following restrictions apply to the use of the special wildcard tag <code>&#34;.&#34;</code> in a DICOM value locator:
<ul>
<li>
<p>It can be used by one predicate operand only.</p>
</li>
<li>
<p>It cannot be used within a recursive constraint macro, or to call a recursive constraint macro.</p>
</li>
</ul>
</div>
<p>See <a href="ch_adm_ref.htm#CHEDJCDJ">General Format for DICOM Value Locators</a> for more information about the DICOM value locator type.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="BEIFCJIB"></a>
<div id="IMDCM13944" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">11.2.3</span> Creating DICOM Protocol Documents</h3>
<p>DICOM protocol documents<a id="sthref859"></a> define the behavior of a DICOM protocol adapter instance configured to use Oracle Database as the backing storage mechanism for DICOM images and metadata. DICOM protocol XML configuration documents (such as <code>ordcmdp.xml</code>) must adhere to the <code>ordcmdp.xsd</code> schema<a id="sthref860"></a><a id="sthref861"></a>. (See <a href="ap_schemas.htm#BABEBCJJ">Appendix B</a> for more information about this schema.) This document has one element, the storage configuration element (the <code>&lt;storage&gt;</code> tag), which can be repeated. This element enables you to specify a table in Oracle Database to use for DICOM image and metadata storage.</p>
<p>The following table describes the XML attributes that the <code>&lt;storage&gt;</code> tag supports:</p>
<div class="inftblruleinformal">
<table class="cellalignment2223" summary="List of attributes for the storage tag" dir="ltr">
<thead>
<tr class="cellalignment2212">
<th class="cellalignment2219" id="r1c1-t18">Attribute</th>
<th class="cellalignment2219" id="r1c2-t18">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r2c1-t18" headers="r1c1-t18"><code>table</code></td>
<td class="cellalignment2220" headers="r2c1-t18 r1c2-t18">Required. Specifies the schema-qualified name of the table where DICOM images and metadata are to be stored.</td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r3c1-t18" headers="r1c1-t18"><code>id_col</code></td>
<td class="cellalignment2220" headers="r3c1-t18 r1c2-t18">Required. Identifies the column in the storage table (specified by the <code>table</code> attribute) where the SOP instance UID (0008,0018) of the DICOM image is stored. This UID serves to uniquely identify the image (and the corresponding metadata for the image).</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Within the <code>&lt;storage&gt;</code> tag, you can add subelements that specify which column (the enclosing table for the column is identified in the <code>table</code> attribute of the enclosing <code>&lt;storage&gt;</code> tag) to use for storing DICOM images, metadata, and derived data (such as preview images). These optional tags are supported:</p>
<div class="inftblruleinformal">
<table class="cellalignment2223" summary="List of optional tags for the storage tag" dir="ltr">
<thead>
<tr class="cellalignment2212">
<th class="cellalignment2219" id="r1c1-t19">Tag</th>
<th class="cellalignment2219" id="r1c2-t19">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r2c1-t19" headers="r1c1-t19"><code>&lt;dicom&gt;</code></td>
<td class="cellalignment2220" headers="r2c1-t19 r1c2-t19">Specifies where to store the original DICOM image (either as a SecureFiles BLOB or an ORDDicom object). The <code>column</code> attribute of this tag specifies the name of the column to use for storing the image. The <code>type</code> attribute (optional) of this tag specifies the type of DICOM storage: BLOB or ORDDicom.</td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r3c1-t19" headers="r1c1-t19"><code>&lt;metadata&gt;</code></td>
<td class="cellalignment2220" headers="r3c1-t19 r1c2-t19">Specifies where to store the XML representation of the DICOM image metadata (as XMLType). The <code>column</code> attribute of this tag specifies the name of the column to use for storing the XML metadata.</td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r4c1-t19" headers="r1c1-t19"><code>&lt;preview&gt;</code></td>
<td class="cellalignment2220" headers="r4c1-t19 r1c2-t19">Specifies where to store a preview version (as JPEG, TIF, and so on.) of the DICOM image. The <code>column</code> attribute of this tag specifies the name of the column to use for storing the DICOM image preview. The <code>options</code> attribute specifies the image transformation to use when generating the preview image. This includes (but is not limited to) the following parameters: <code>file format</code>, <code>size</code>, and <code>rotation</code> (see <a class="olink AIVUG80486" href="../AIVUG/ch_imgref.htm#AIVUG80486"><span class="italic">Oracle Multimedia Reference</span></a> for a complete set of configuration options). The <code>type</code> attribute (optional) of this tag specifies the type of image storage: either as BLOB or ORDImage.</td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r5c1-t19" headers="r1c1-t19"><code>&lt;attribute&gt;</code></td>
<td class="cellalignment2220" headers="r5c1-t19 r1c2-t19">Specifies where to store the attribute value extracted from the DICOM image corresponding to the given DICOM tag. The <code>column</code> attribute of this tag specifies the name of the column to use for storing the metadata value. The <code>tag</code> attribute specifies which DICOM tag to use. The <code>type</code> attribute (optional) of this tag specifies the type of attribute storage (for ex. the type of the underlying column - <code>varchar2</code>, <code>number</code>, and so on).</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p><a href="#BEIBGAEF">Example 11-23</a> shows an example<a id="sthref862"></a> of a DICOM protocol configuration document:</p>
<div id="IMDCM13945" class="example">
<p class="titleinexample"><a id="BEIBGAEF"></a>Example 11-23 Sample DICOM Protocol Configuration Document</p>
<pre>&lt;DICOM_PROTOCOL xmlns=&#34;http://xmlns.oracle.com/ord/dicom/protocol_1_0&#34;
xmlns:dt=&#34;http://xmlns.oracle.com/ord/dicom/datatype_1_0&#34;
xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;
xsi:schemaLocation=&#34;http://xmlns.oracle.com/ord/dicom/protocol_1_0
http://xmlns.oracle.com/ord/dicom/protocol_1_0&#34;&gt;
  &lt;DOCUMENT_HEADER&gt;
    &lt;dt:DOCUMENT_CHANGE_LOG&gt;
      &lt;dt:DOCUMENT_MODIFIER&gt;Anonymous user&lt;/dt:DOCUMENT_MODIFIER&gt;
      &lt;dt:DOCUMENT_MODIFICATION_DATE&gt;2011-09-08&lt;/dt:DOCUMENT_MODIFICATION_DATE&gt;
      &lt;dt:DOCUMENT_VERSION&gt;1.0&lt;/dt:DOCUMENT_VERSION&gt;
      &lt;dt:MODIFICATION_COMMENT&gt;DICOM protocol doc for
orddicom&lt;/dt:MODIFICATION_COMMENT&gt;
    &lt;/dt:DOCUMENT_CHANGE_LOG&gt;
  &lt;/DOCUMENT_HEADER&gt;
  &lt;STORAGE table=&#39;dcm_user.dcm_table&#39; id_col=&#34;dicomID&#34;&gt;
    &lt;DICOM  column=&#34;dicomobj&#34; type=&#34;ORDDicom&#34;/&gt;
  &lt;/STORAGE&gt;
  &lt;STORAGE table=&#39;dcm_user.attr_table&#39; id_col=&#34;attrID&#34;&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00020002&#34;&#39; tag=&#34;00020002&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00020003&#34;&#39; tag=&#34;00020003&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00020010&#34;&#39; tag=&#34;00020010&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00080016&#34;&#39; tag=&#34;00080016&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00080018&#34;&#39; tag=&#34;00080018&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00080020&#34;&#39; tag=&#34;00080020&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00080030&#34;&#39; tag=&#34;00080030&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00080050&#34;&#39; tag=&#34;00080050&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00080056&#34;&#39; tag=&#34;00080056&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00080060&#34;&#39; tag=&#34;00080060&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00080061&#34;&#39; tag=&#34;00080061&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00080064&#34;&#39; tag=&#34;00080064&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00080068&#34;&#39; tag=&#34;00080068&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00080070&#34;&#39; tag=&#34;00080070&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00080080&#34;&#39; tag=&#34;00080080&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00080081&#34;&#39; tag=&#34;00080081&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00080090&#34;&#39; tag=&#34;00080090&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00080096&#34;&#39; tag=&#34;00080096&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00081030&#34;&#39; tag=&#34;00081030&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00081050&#34;&#39; tag=&#34;00081050&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00100010&#34;&#39; tag=&#34;00100010&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00100020&#34;&#39; tag=&#34;00100020&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00100030&#34;&#39; tag=&#34;00100030&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00100040&#34;&#39; tag=&#34;00100040&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_0020000D&#34;&#39; tag=&#34;0020000D&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_0020000E&#34;&#39; tag=&#34;0020000E&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00200010&#34;&#39; tag=&#34;00200010&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00200011&#34;&#39; tag=&#34;00200011&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00200012&#34;&#39; tag=&#34;00200012&#34;/&gt;
    &lt;ATTRIBUTE column=&#39;&#34;DICOM_00200013&#34;&#39; tag=&#34;00200013&#34;/&gt;
  &lt;/STORAGE&gt;
  &lt;STORAGE table=&#39;dcm_user.img_table&#39; id_col=&#34;imageID&#34;&gt;
    &lt;PREVIEW  column=&#34;imageobj&#34; options=&#34;fileformat=jpeg scale=0.5&#34;/&gt;
    &lt;PREVIEW  column=&#34;imageblob&#34; options=&#34;fileformat=jpeg&#34;/&gt;
  &lt;/STORAGE&gt;
&lt;/DICOM_PROTOCOL&gt;
</pre></div>
<!-- class="example" -->
<p>In <a href="#BEIBGAEF">Example 11-23</a>, DICOM images are stored in the column <code>dicomobj</code> of table <code>dcm_user.dcm_table</code> as type <code>ORDDicom</code>. DICOM attributes are stored in columns of the table <code>dcm_user.attr_table</code> according to their tag numbers. Previews of DICOM images are stored in columns of the table <code>dcm_user.img_table</code> according to different processing options. (See <a href="ap_img_proc.htm#CIHJIGGI">Appendix D</a> for details about processing options.) These tables must be created in the database before you can use the configuration document.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
To use the configuration document, you must deploy an instance of the DICOM protocol adapter that references the specified document.</div>
<p>You can also configure the storing of DICOM images in columns of type <code>BLOB</code> and specify a separate column for storing metadata such as in this code segment:</p>
<pre> &lt;STORAGE table=&#39;dcm_user.dcm_table&#39; id_col=&#34;dicomID&#34;&gt;
    &lt;DICOM  column=&#34;dicomblob&#34; type=&#34;BLOB&#34;/&gt;
  &lt;/STORAGE&gt;
  &lt;STORAGE table=&#39;dcm_user.meta_table&#39; id_col=&#34;metaID&#34;&gt;
    &lt;METADATA column=&#34;meta&#34;/&gt;
  &lt;/STORAGE&gt;
</pre>
<p>See <a href="ch_gen_prtcl.htm#CIHBFFBD">Chapter 4</a> for more information about DICOM protocol support for Oracle Database.</p>
</div>
<!-- class="sect2" -->
<a id="BGBGGFCJ"></a>
<div id="IMDCM13480" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">11.2.4</span> Creating Mapping Documents and Metadata XML Schemas</h3>
<p>Mapping documents<a id="sthref863"></a> define how the DICOM attributes are mapped into an XML document. The metadata XML document can be constrained by an XML schema, or it can be a well-formed XML document with no XML schema constraints.</p>
<p>The XML schema <code>ordcmmp.xsd</code> defines the XML schema that constrains mapping documents. (See <a href="ap_schemas.htm#BABEBCJJ">Appendix B</a> for more information about this schema.)</p>
<p>The following subsections describe the structure of mapping documents and metadata XML schemas. The subsections also contain code examples that show how to create mapping documents and corresponding metadata schemas:</p>
<ul>
<li>
<p><a href="#BEIGGAIC">Structure of a Mapping Document</a></p>
</li>
<li>
<p><a href="#BEIDEEEB">Structure of a Metadata XML Schema</a></p>
</li>
<li>
<p><a href="#BGBFGJCB">Creating a Mapping Document for Metadata with No Schema Constraints</a></p>
</li>
<li>
<p><a href="#BGBFAJJI">Creating a Mapping Document for Metadata with Schema Constraints and a Mapped Section Only</a></p>
</li>
<li>
<p><a href="#BEIFCDFC">Creating a Mapping Document for Metadata with Schema Constraints</a></p>
</li>
<li>
<p><a href="#CIHFHDFB">Using DICOM Value Locators in Mapping Documents</a></p>
</li>
</ul>
<a id="BEIGGAIC"></a>
<div id="IMDCM13481" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.4.1</span> Structure of a Mapping Document</h4>
<p>Each mapping document must include a root element and a namespace declaration, similar to the following:</p>
<pre>&lt;XML_MAPPING_DOCUMENT xmlns=&#34;http://xmlns.oracle.com/ord/dicom/mapping_1_0&#34;
xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;
xsi:schemaLocation=&#34;http://xmlns.oracle.com/ord/dicom/mapping_1_0
http://xmlns.oracle.com/ord/dicom/mapping_1_0&#34;&gt; 
</pre>
<p>The remaining elements in the mapping document, in order of appearance, are as follows:</p>
<ul>
<li>
<p>&lt;dt:DOCUMENT_HEADER&gt;: This element is optional. It is used to keep the update record of the XML document. If this element is specified, add the following namespace declaration to the root element:</p>
<pre>namespace: xmlns:dt=http://xmlns.oracle.com/ord/dicom/datatype_1_0&#34;
</pre></li>
<li>
<p>&lt;NAMESPACE&gt;: This mandatory element specifies the namespace of the metadata XML document. This namespace must match the target namespace of the corresponding metadata schema. If this element is empty, the extracted metadata XML is not schema constrained.</p>
</li>
<li>
<p>&lt;ROOT_ELEM_TAG&gt;: This mandatory element specifies the root element name of the metadata XML document.</p>
</li>
<li>
<p>&lt;UNMAPPED_ELEM&gt;: This element specifies the XML path to the element that is the parent element of all unmapped attributes. This XML path is relative to the root element (specified by the element &lt;ROOT_ELEM_TAG&gt;) of the metadata XML. If this element is omitted or empty, the parent element of the unmapped attributes is the root element of the metadata XML document. See <a href="ch_cncpt.htm#BCEDAJAH">Section 2.5</a> for more information about unmapped attributes.</p>
</li>
<li>
<p>&lt;MAPPED_ELEM&gt;: This element specifies the XML path to the element that is the parent element of all mapped attributes. This XML path is relative to the root element of the metadata XML (specified by the element &lt;ROOT_ELEM_TAG&gt;). If this element is omitted or empty, the parent element of the mapped attributes is the root element of the metadata XML document. See <a href="ch_cncpt.htm#BCEDAJAH">Section 2.5</a> for more information about mapped attributes.</p>
</li>
<li>
<p>&lt;MAPPED_PATH&gt;: This element specifies the XML path to a mapped attribute. This XML path is relative to the parent element of the mapped attributes as defined by the element &lt;MAPPED_ELEM&gt;. This element can be used multiple times within a mapping document to specify the XML paths to all mapped attributes. The order of appearance of each &lt;MAPPED_PATH&gt; element reflects the order of appearance of the mapped attributes in a metadata XML document. Within the &lt;MAPPED_PATH&gt; element, the &lt;ATTRIBUTE_TAG&gt; and &lt;PATH&gt; elements are used to define each mapped attribute tag and its XML path, respectively.</p>
</li>
</ul>
</div>
<!-- class="sect3" -->
<a id="BEIDEEEB"></a>
<div id="IMDCM13482" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.4.2</span> Structure of a Metadata XML Schema</h4>
<p>During the process of extracting DICOM metadata and encoding it into an XML document, a mapping document is used to encode the DICOM attributes into an XML document, and an XML schema is used to validate the encoded metadata XML document. To extract DICOM metadata into a schema-valid XML document, the mapping document and the XML schema definition for the metadata XML document must be synchronized.</p>
<p>The general rules for creating an XML schema for a metadata XML document that is specific to a particular application are as follows:</p>
<ul>
<li>
<p>The order of the elements defined in the XML schema must match the order of the mapped XML paths for those elements.</p>
</li>
<li>
<p>The XML schema must use data types that are either compatible with or less restrictive than the data types defined by Oracle in the schema <code>ordcmmddt.xsd</code>.</p>
</li>
<li>
<p>To extract unmapped DICOM attributes into the XML document, the parent element of the unmapped attributes must be defined as type DATASET_T (as in the schema <code>ordcmmddt.xsd</code>).</p>
</li>
<li>
<p>If the attributes <code>writeTag</code>, <code>writeName</code>, <code>writeDefiner</code>, and <code>writeRawValue</code> of the &lt;MAPPED_PATH&gt; element are set to <code>&#34;true&#34;</code> in the mapping document, the XML schema must define the corresponding attributes <code>tag</code>, <code>name</code>, <code>definer</code>, and <code>rawValue</code> for each element that is described by the &lt;MAPPED_PATH&gt; element in the mapping document.</p>
</li>
<li>
<p>If the attribute <code>occurs</code> of the &lt;MAPPED_PATH&gt; element in the mapping document is set to <code>&#34;false&#34;</code> either implicitly or explicitly, the XML schema definition of the element must set the attribute <code>minOccurs</code> to <code>&#34;0&#34;</code>.</p>
</li>
<li>
<p>If the attribute <code>notEmpty</code> of the &lt;MAPPED_PATH&gt; element in the mapping document is set to <code>&#34;false&#34;</code>, the XML schema definition for the element must set the attribute <code>xsi:nillable</code> to <code>&#34;true&#34;</code>. Otherwise, the element defined by the &lt;MAPPED_PATH&gt; element must permit an empty value.</p>
</li>
</ul>
</div>
<!-- class="sect3" -->
<a id="BGBFGJCB"></a>
<div id="IMDCM13483" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.4.3</span> Creating a Mapping Document for Metadata with No Schema Constraints</h4>
<p>This subsection describes how to create a mapping document and a well-formed metadata XML document with no XML schema constraints. For applications that require only a well-formed metadata XML document, the mapping document can contain an empty &lt;NAMESPACE&gt; element because the extracted metadata need not conform to any XML schema.</p>
<p>This subsection also includes a code example of a mapping document, followed by a code example of the resulting metadata XML document. Appropriate XML statements are highlighted in bold to show where the main actions occur in both the mapping document and the related XML document. Descriptions of each bolded XML statement follow the examples.</p>
<p><a href="#CIHGIBGH">Example 11-24</a> shows a sample mapping document with an empty &lt;NAMESPACE&gt; element. This example also shows the values to be specified for the <code>occurs</code>, <code>notEmpty</code>, <code>writeTag</code>, <code>writeDefiner</code>, and <code>writeName</code> attributes in the &lt;MAPPED_PATH&gt; element to define the extracted metadata XML document. If these attributes are not specified, they are set to <code>&#34;false&#34;</code>, the default value.</p>
<div id="IMDCM13484" class="example">
<p class="titleinexample"><a id="CIHGIBGH"></a>Example 11-24 Sample Mapping Document for Metadata with No Schema Constraints</p>
<pre>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
&lt;XML_MAPPING_DOCUMENT 
    xmlns=&#34;http://xmlns.oracle.com/ord/dicom/mapping_1_0&#34; 
    xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; 
    xsi:schemaLocation=&#34;http://xmlns.oracle.com/ord/dicom/mapping_1_0
        http://xmlns.oracle.com/ord/dicom/mapping_1_0&#34;&gt;
  <span class="bold">&lt;NAMESPACE&gt;&lt;/NAMESPACE&gt;</span>
  &lt;ROOT_ELEM_TAG&gt;DICOM_OBJECT&lt;/ROOT_ELEM_TAG&gt;
  &lt;UNMAPPED_ELEM&gt;OTHER_ATTRIBUTES&lt;/UNMAPPED_ELEM&gt;
  &lt;MAPPED_ELEM&gt;KEY_ATTRIBUTES&lt;/MAPPED_ELEM&gt;
    
  &lt;MAPPED_PATH occurs=&#34;true&#34; notEmpty=&#34;true&#34;&gt;
    &lt;ATTRIBUTE_TAG&gt;00100010&lt;/ATTRIBUTE_TAG&gt;
    &lt;PATH&gt;PATIENT/NAME&lt;/PATH&gt;
  &lt;/MAPPED_PATH&gt;
    
  &lt;MAPPED_PATH occurs=&#34;true&#34; notEmpty=&#34;true&#34;&gt;
    &lt;ATTRIBUTE_TAG&gt;00100020&lt;/ATTRIBUTE_TAG&gt;
    &lt;PATH&gt;PATIENT/ID&lt;/PATH&gt;
  &lt;/MAPPED_PATH&gt;
 
  &lt;MAPPED_PATH occurs=&#34;true&#34; notEmpty=&#34;false&#34;&gt;
    &lt;ATTRIBUTE_TAG&gt;00100030&lt;/ATTRIBUTE_TAG&gt;
    &lt;PATH&gt;PATIENT/BIRTH_DATE&lt;/PATH&gt;
  &lt;/MAPPED_PATH&gt;
 
  <span class="bold">&lt;MAPPED_PATH occurs=&#34;false&#34; notEmpty=&#34;false&#34;&gt;</span>
    &lt;ATTRIBUTE_TAG&gt;00100040&lt;/ATTRIBUTE_TAG&gt;
    &lt;PATH&gt;PATIENT/SEX&lt;/PATH&gt;
  &lt;/MAPPED_PATH&gt;
 
 <span class="bold"> &lt;MAPPED_PATH writeTag=&#34;true&#34; writeDefiner=&#34;true&#34; writeName=&#34;true&#34;&gt;</span>
    &lt;ATTRIBUTE_TAG&gt;00200010&lt;/ATTRIBUTE_TAG&gt;
    &lt;PATH&gt;STUDY/ID&lt;/PATH&gt;
  &lt;/MAPPED_PATH&gt;
 
  &lt;MAPPED_PATH&gt;
    &lt;ATTRIBUTE_TAG&gt;00080030&lt;/ATTRIBUTE_TAG&gt;
    &lt;PATH&gt;STUDY/TIME&lt;/PATH&gt;
  &lt;/MAPPED_PATH&gt;
 
  <span class="bold">&lt;MAPPED_PATH&gt;</span>
    <span class="bold">&lt;ATTRIBUTE_TAG&gt;00081080&lt;/ATTRIBUTE_TAG&gt;</span>
    <span class="bold">&lt;PATH&gt;STUDY/ADMITTING_DIAGNOSES_DESCRIPTION&lt;/PATH&gt;</span>
  <span class="bold">&lt;/MAPPED_PATH&gt;</span>
 
&lt;/XML_MAPPING_DOCUMENT&gt;
 
</pre></div>
<!-- class="example" -->
<p><a href="#CIHJAGDD">Example 11-25</a> shows the resulting metadata XML document whose XML metadata was extracted with the value of the extractOption parameter in the extractMetadata( ) method set to <code>MAPPED</code>.</p>
<div id="IMDCM13679" class="example">
<p class="titleinexample"><a id="CIHJAGDD"></a>Example 11-25 Resulting XML Document for <a href="#CIHGIBGH">Example 11-24</a></p>
<pre>&lt;?xml version=&#34;1.0&#34; encoding=&#34;DEC-MCS&#34;?&gt;
<span class="bold">&lt;DICOM_OBJECT xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;&gt;</span>
  &lt;KEY_ATTRIBUTES&gt;
    &lt;PATIENT&gt;
      &lt;NAME&gt;
        &lt;NAME type=&#34;unibyte&#34;&gt;
          &lt;FAMILY&gt;CANCIO   2HR A-02-013&lt;/FAMILY&gt;
        &lt;/NAME&gt;
        &lt;VALUE&gt;CANCIO   2HR A-02-013&lt;/VALUE&gt;
      &lt;/NAME&gt;
      &lt;ID&gt;ISRSCT610b&lt;/ID&gt;
      &lt;BIRTH_DATE xsi:nil=&#34;true&#34;/&gt;
      &lt;SEX xsi:nil=&#34;true&#34;/&gt;
    &lt;/PATIENT&gt;
    &lt;STUDY&gt;
      <span class="bold">&lt;ID definer=&#34;DICOM&#34; tag=&#34;00200010&#34; name=&#34;Study ID&#34;&gt;352&lt;/ID&gt;</span>
      &lt;TIME&gt;18:48:41.000000&lt;/TIME&gt;
    &lt;/STUDY&gt;
  &lt;/KEY_ATTRIBUTES&gt;
&lt;/DICOM_OBJECT&gt;
</pre></div>
<!-- class="example" -->
<p>In <a href="#CIHGIBGH">Example 11-24</a> and <a href="#CIHJAGDD">Example 11-25</a>, these actions occur:</p>
<ul>
<li>
<p>In the mapping document, the &lt;NAMESPACE&gt; element is empty. As a result, the resulting extracted XML document does not include the default namespace declaration because it is not constrained by an XML schema.</p>
</li>
<li>
<p>The &lt;ROOT_ELEM_TAG&gt; element in the mapping document matches the root element tag (shown in the &lt;DICOM_OBJECT&gt; element) in the extracted XML document.</p>
</li>
<li>
<p>In the mapping document, the value of the <code>notEmpty</code> attribute of the &lt;MAPPED_PATH&gt; element for the DICOM attribute with tag <code>00100040</code> is <code>&#34;false&#34;</code>. In the extracted XML document, the value of the <code>xsi:nil</code> attribute in the &lt;BIRTH_DATE&gt; element is set to <code>&#34;true&#34;</code> because this DICOM attribute is empty in the DICOM content.</p>
</li>
<li>
<p>In the mapping document, the &lt;MAPPED_PATH&gt; element for the DICOM attribute with tag <code>00200010</code>, the <code>writeTag</code>, <code>writeName</code>, and <code>writeDefiner</code> attributes are set to <code>&#34;true&#34;</code>. In the extracted XML document, the child element &lt;ID&gt; under the &lt;STUDY&gt; element has corresponding <code>definer</code>, <code>tag</code>, and <code>name</code> attributes.</p>
</li>
<li>
<p>In the mapping document, the &lt;MAPPED_PATH&gt; element for the DICOM attribute with tag <code>00081080</code> uses the default value (<code>&#34;false&#34;</code>) for the <code>occurs</code> attribute. Because this DICOM attribute does not exist in the DICOM content, the element &lt;ADMITTING_DIAGNOSES_DESCRIPTION&gt; does not exist in the extracted XML document.</p>
</li>
</ul>
<p>See <a href="ch_dev_ref.htm#CHDIJBDF">extractMetadata( )</a> for reference information about this method and the supported values for the extractOption parameter.</p>
</div>
<!-- class="sect3" -->
<a id="BGBFAJJI"></a>
<div id="IMDCM13485" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.4.4</span> Creating a Mapping Document for Metadata with Schema Constraints and a Mapped Section Only</h4>
<p>This subsection describes how to create a mapping document and a metadata XML document with XML schema constraints, discarding the unmapped section. This example can be used in applications that require only the DICOM attributes defined in the mapped section of the XML metadata, and in metadata XML documents with XML schema constraints.</p>
<p>This subsection also includes code examples of a mapping document, an XML schema, and the resulting metadata XML document constrained by the schema. Appropriate XML statements are highlighted in bold to show where the main actions occur in both the mapping document and the related XML document. Descriptions of each bolded XML statement follow the examples.</p>
<p>The extractMetadata( ) method of the ORDDicom object can extract all or part of the metadata into an XML document based on the value of the extractOption parameter.</p>
<p>See <a href="ch_dev_ref.htm#CHDIJBDF">extractMetadata( )</a> for reference information about this method and the supported values for the extractOption parameter.</p>
<p><a href="#CIHCCJJA">Example 11-26</a> shows a sample mapping document that specifies the namespace of the metadata XML document, so that the metadata document can be constrained by an XML schema.</p>
<div id="IMDCM13486" class="example">
<p class="titleinexample"><a id="CIHCCJJA"></a>Example 11-26 Sample Mapping Document for Metadata with Schema Constraints and a Mapped Section Only</p>
<pre>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
&lt;XML_MAPPING_DOCUMENT 
    xmlns=&#34;http://xmlns.oracle.com/ord/dicom/mapping_1_0&#34; 
    xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; 
    xsi:schemaLocation=&#34;http://xmlns.oracle.com/ord/dicom/mapping_1_0
        http://xmlns.oracle.com/ord/dicom/mapping_1_0&#34;&gt;
  <span class="bold">&lt;NAMESPACE&gt;http://www.mycompany.com/dicom/example2&lt;/NAMESPACE&gt;</span>
  &lt;ROOT_ELEM_TAG&gt;DICOM_OBJECT&lt;/ROOT_ELEM_TAG&gt;
  <span class="bold">&lt;UNMAPPED_ELEM&gt;&lt;/UNMAPPED_ELEM&gt;</span>
  <span class="bold">&lt;MAPPED_ELEM&gt;&lt;/MAPPED_ELEM&gt;</span>
    
  &lt;MAPPED_PATH occurs=&#34;true&#34; notEmpty=&#34;true&#34;&gt;
    &lt;ATTRIBUTE_TAG&gt;00100010&lt;/ATTRIBUTE_TAG&gt;
    &lt;PATH&gt;PATIENT/NAME&lt;/PATH&gt;
  &lt;/MAPPED_PATH&gt;
    
  &lt;MAPPED_PATH occurs=&#34;true&#34; notEmpty=&#34;true&#34;&gt;
    &lt;ATTRIBUTE_TAG&gt;00100020&lt;/ATTRIBUTE_TAG&gt;
    &lt;PATH&gt;PATIENT/ID&lt;/PATH&gt;
  &lt;/MAPPED_PATH&gt;
  &lt;MAPPED_PATH occurs=&#34;true&#34; notEmpty=&#34;false&#34;&gt;
    &lt;ATTRIBUTE_TAG&gt;00100030&lt;/ATTRIBUTE_TAG&gt;
    &lt;PATH&gt;PATIENT/BIRTH_DATE&lt;/PATH&gt;
  &lt;/MAPPED_PATH&gt;
  
  &lt;MAPPED_PATH occurs=&#34;false&#34; notEmpty=&#34;false&#34;&gt;
    &lt;ATTRIBUTE_TAG&gt;00100040&lt;/ATTRIBUTE_TAG&gt;
    &lt;PATH&gt;PATIENT/SEX&lt;/PATH&gt;
  &lt;/MAPPED_PATH&gt;
  
  &lt;MAPPED_PATH writeTag=&#34;true&#34; writeDefiner=&#34;true&#34; writeName=&#34;true&#34;&gt;
    &lt;ATTRIBUTE_TAG&gt;00200010&lt;/ATTRIBUTE_TAG&gt;
    &lt;PATH&gt;STUDY/ID&lt;/PATH&gt;
  &lt;/MAPPED_PATH&gt;
  
  &lt;MAPPED_PATH&gt;
    &lt;ATTRIBUTE_TAG&gt;00080030&lt;/ATTRIBUTE_TAG&gt;
    &lt;PATH&gt;STUDY/TIME&lt;/PATH&gt;
  &lt;/MAPPED_PATH&gt;
 
   &lt;MAPPED_PATH&gt;
    &lt;ATTRIBUTE_TAG&gt;00081080&lt;/ATTRIBUTE_TAG&gt;
    &lt;PATH&gt;STUDY/ADMITTING_DIAGNOSES_DESCRIPTION&lt;/PATH&gt;
  &lt;/MAPPED_PATH&gt;
 
&lt;/XML_MAPPING_DOCUMENT&gt;
</pre></div>
<!-- class="example" -->
<p>The mapping document in <a href="#CIHCCJJA">Example 11-26</a> differs from the mapping document in <a href="#CIHGIBGH">Example 11-24</a> as follows:</p>
<ul>
<li>
<p>The &lt;NAMESPACE&gt; element contains a value.</p>
</li>
<li>
<p>The &lt;UNMAPPED_ELEM&gt; and the &lt;MAPPED_ELEM&gt; elements are empty, thus the mapped path is relative to the &lt;ROOT_ELEM_TAG&gt; element.</p>
</li>
</ul>
<p>The XML schema for the mapping document in <a href="#CIHCCJJA">Example 11-26</a> is defined in <a href="#CIHCGFBH">Example 11-27</a>:</p>
<div id="IMDCM13734" class="example">
<p class="titleinexample"><a id="CIHCGFBH"></a>Example 11-27 Sample XML Schema for <a href="#CIHCCJJA">Example 11-26</a></p>
<pre>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
 &lt;xs:schema 
    <span class="bold">xmlns=&#34;http://www.mycompany.com/dicom/example2&#34;</span> 
    xmlns:xdb=&#34;http://xmlns.oracle.com/xdb&#34; 
    xmlns:xs=&#34;http://www.w3.org/2001/XMLSchema&#34; 
    <span class="bold">targetNamespace=&#34;http://www.mycompany.com/dicom/example2&#34;</span> 
    elementFormDefault=&#34;qualified&#34; 
    attributeFormDefault=&#34;unqualified&#34;&gt;
   &lt;xs:element name=&#34;DICOM_OBJECT&#34;&gt;
    &lt;xs:complexType&gt;
      &lt;xs:sequence&gt;
        &lt;xs:element name=&#34;PATIENT&#34;&gt;
          &lt;xs:complexType&gt;
            &lt;xs:sequence&gt;
              <span class="bold">&lt;xs:element name=&#34;NAME&#34; type=&#34;PERSON_NAME&#34;/&gt;</span>
              &lt;xs:element name=&#34;ID&#34; type=&#34;xs:string&#34;/&gt;
              <span class="bold">&lt;xs:element name=&#34;BIRTH_DATE&#34;  type=&#34;xs:date&#34; nillable=&#34;true&#34;/&gt;</span>
              <span class="bold">&lt;xs:element name=&#34;SEX&#34;  type=&#34;xs:string&#34; minOccurs=&#34;0&#34;</span>
                  <span class="bold">nillable=&#34;true&#34;/&gt;</span>
            &lt;/xs:sequence&gt;
          &lt;/xs:complexType&gt;
        &lt;/xs:element&gt;
        &lt;xs:element name=&#34;STUDY&#34;&gt;
          &lt;xs:complexType&gt;
            &lt;xs:sequence&gt;
              <span class="bold">&lt;xs:element name=&#34;ID&#34; type = &#34;ID_TYPE&#34; minOccurs=&#34;0&#34;</span>
                  <span class="bold">nillable=&#34;true&#34;/&gt;</span>
              &lt;<span class="bold">xs:element name=&#34;TIME&#34;  type=&#34;xs:time&#34; minOccurs=&#34;0&#34;</span>
                  <span class="bold">nillable=&#34;true&#34;/&gt;</span>
              &lt;xs:element name=&#34;ADMITTING_DIAGNOSES_DESCRIPTION&#34;  type=&#34;xs:string&#34;
                  minOccurs=&#34;0&#34; nillable=&#34;true&#34;/&gt;
            &lt;/xs:sequence&gt;
          &lt;/xs:complexType&gt;
        &lt;/xs:element&gt;
      &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;
  <span class="bold">&lt;xs:complexType name=&#34;PERSON_NAME&#34;&gt;</span>
    &lt;xs:sequence&gt;
      &lt;xs:element name=&#34;NAME&#34;&gt;
        &lt;xs:complexType&gt;
          &lt;xs:sequence&gt;
            &lt;xs:element name=&#34;FAMILY&#34; type=&#34;xs:string&#34; minOccurs=&#34;0&#34;
                nillable=&#34;true&#34;/&gt;
            &lt;xs:element name=&#34;GIVEN&#34; type=&#34;xs:string&#34; minOccurs=&#34;0&#34;
                nillable=&#34;true&#34;/&gt;
            &lt;xs:element name=&#34;MIDDLE&#34; type=&#34;xs:string&#34; minOccurs=&#34;0&#34;
                nillable=&#34;true&#34;/&gt;
            &lt;xs:element name=&#34;PREFIX&#34; type=&#34;xs:string&#34; minOccurs=&#34;0&#34;
                nillable=&#34;true&#34;/&gt;
            &lt;xs:element name=&#34;SUFFIX&#34; type=&#34;xs:string&#34; minOccurs=&#34;0&#34;
                nillable=&#34;true&#34;/&gt;
          &lt;/xs:sequence&gt;
          &lt;xs:attribute name=&#34;type&#34; default=&#34;unibyte&#34;&gt;
            &lt;xs:simpleType&gt;
              &lt;xs:restriction base=&#34;xs:token&#34;&gt;
                &lt;xs:enumeration value=&#34;unibyte&#34;/&gt;
                &lt;xs:enumeration value=&#34;ideographic&#34;/&gt;
                &lt;xs:enumeration value=&#34;phonetic&#34;/&gt;
              &lt;/xs:restriction&gt;
            &lt;/xs:simpleType&gt;
          &lt;/xs:attribute&gt;
        &lt;/xs:complexType&gt;
      &lt;/xs:element&gt;
      &lt;xs:element name=&#34;VALUE&#34; minOccurs=&#34;0&#34; nillable=&#34;true&#34;&gt;
        &lt;xs:simpleType&gt;
          &lt;xs:restriction base=&#34;xs:token&#34;&gt;
            &lt;xs:maxLength value=&#34;64&#34;/&gt;
          &lt;/xs:restriction&gt;
        &lt;/xs:simpleType&gt;
      &lt;/xs:element&gt;
   &lt;/xs:sequence&gt;
  &lt;/xs:complexType&gt;
  <span class="bold">&lt;xs:complexType name=&#34;ID_TYPE&#34;&gt;</span>
    &lt;xs:simpleContent&gt;
      &lt;xs:extension base=&#34;xs:string&#34;&gt;
        &lt;xs:attribute name=&#34;tag&#34; type=&#34;xs:string&#34;/&gt;
        &lt;xs:attribute name=&#34;definer&#34; type=&#34;xs:string&#34;/&gt;
        &lt;xs:attribute name=&#34;name&#34; type=&#34;xs:string&#34;/&gt;
      &lt;/xs:extension&gt;
    &lt;/xs:simpleContent&gt;
  &lt;/xs:complexType&gt;
&lt;/xs:schema&gt;
</pre></div>
<!-- class="example" -->
<p>In <a href="#CIHCCJJA">Example 11-26</a> and the associated XML schema (in <a href="#CIHCGFBH">Example 11-27</a>), the following elements and data types are defined:</p>
<ul>
<li>
<p>The namespace declaration of the metadata XML schema has the same value as the &lt;NAMESPACE&gt; element in the mapping document.</p>
</li>
<li>
<p>For the &lt;MAPPED_PATH&gt; element in the mapping document that has the value of the <code>notEmpty</code> attribute set to <code>&#34;false&#34;</code> either explicitly, as for tag <code>00100030</code>, or implicitly using the default value, as for tag <code>00800030</code>, the corresponding element defined in the XML schema has the value of the <code>nillable</code> attribute set to <code>&#34;true&#34;</code>, as in the &lt;BIRTH_DATE&gt; element and the &lt;TIME&gt; element.</p>
</li>
<li>
<p>Any &lt;MAPPED_PATH&gt; element in the mapping document that has the value of the <code>occurs</code> attribute set to <code>&#34;false&#34;</code> either explicitly, as for tag <code>00100040</code>, or implicitly using the default value, as for tag <code>00800030</code>, the corresponding element defined in the XML schema must have the value of the attribute <code>minOccurs</code> set to <code>&#34;0&#34;</code>, as in the &lt;SEX&gt; element and the &lt;TIME&gt; element.</p>
</li>
<li>
<p>The data type defined in the XML schema must be compatible with the data type defined by Oracle in the schema <code>ordcmmddt.xsd</code>. In Example 2, the <code>&#34;PERSON_NAME&#34;</code> data type definition is copied from the schema <code>ordcmmddt.xsd</code>, while the <code>&#34;ID_TYPE&#34;</code> data type is defined so that the &lt;ID&gt; element under the &lt;STUDY&gt; element can have the <code>tag</code>, <code>definer</code>, and <code>name</code> attributes. The <code>&#34;ID_TYPE&#34;</code> data type is compatible with the <code>&#34;SH_ATTR_T&#34;</code> data type defined by Oracle. The &lt;SEX&gt; element is defined to use the <code>&#34;xs:string&#34;</code> data type, which is compatible with the Oracle-defined data type <code>&#34;CS&#34;</code>.</p>
</li>
<li>
<p>The &lt;UNMAPPED_ELEM&gt; element is empty in the mapping document, and the root element &lt;DICOM_OBJECT&gt; of the metadata XML is not defined as the &#34;DATASET_T&#34; type. With this schema constraint, a valid metadata XML document can include a mapped section only. Thus, if the application attempts to extract metadata using a value of <code>&#34;ALL&#34;</code> or <code>&#34;STANDARD&#34;</code> for the extractOption parameter, the attempt returns this error:</p>
<p><code>ORA-53259: cannot extract metadata that conforms to the schema definition</code></p>
</li>
</ul>
<p><a href="#CIHECEIG">Example 11-28</a> shows the resulting metadata XML document whose XML metadata was extracted with the value of the extractOption parameter in the extractMetadata( ) method set to <code>MAPPED</code>.</p>
<div id="IMDCM13680" class="example">
<p class="titleinexample"><a id="CIHECEIG"></a>Example 11-28 Resulting XML Document for <a href="#CIHCCJJA">Example 11-26</a></p>
<pre>&lt;?xml version=&#34;1.0&#34; encoding=&#34;DEC-MCS&#34;?&gt;
&lt;DICOM_OBJECT xmlns=&#34;http://www.mycompany.com/dicom/example2&#34;
  xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;
  xsi:schemaLocation=&#34;http://www.mycompany.com/dicom/example2
  http://www.mycompany.com/dicom/example2&#34;&gt;
  &lt;PATIENT&gt;
    &lt;NAME&gt;
      &lt;NAME type=&#34;unibyte&#34;&gt;
        &lt;FAMILY&gt;CANCIO   2HR A-02-013&lt;/FAMILY&gt;
      &lt;/NAME&gt;
      &lt;VALUE&gt;CANCIO   2HR A-02-013&lt;/VALUE&gt;
    &lt;/NAME&gt;
    &lt;ID&gt;ISRSCT610b&lt;/ID&gt;
    &lt;BIRTH_DATE xsi:nil=&#34;true&#34;/&gt;
    &lt;SEX xsi:nil=&#34;true&#34;/&gt;
  &lt;/PATIENT&gt;
  &lt;STUDY&gt;
    &lt;ID definer=&#34;DICOM&#34; tag=&#34;00200010&#34; name=&#34;Study ID&#34;&gt;352&lt;/ID&gt;
    &lt;TIME&gt;18:48:41.000000&lt;/TIME&gt;
  &lt;/STUDY&gt;
&lt;/DICOM_OBJECT&gt;
</pre></div>
<!-- class="example" --></div>
<!-- class="sect3" -->
<a id="BEIFCDFC"></a>
<div id="IMDCM13487" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.4.5</span> Creating a Mapping Document for Metadata with Schema Constraints</h4>
<p>This subsection describes how to create a mapping document and a metadata XML document with XML schema constraints, including the unmapped section.</p>
<p>This subsection also includes code examples of a mapping document, an XML schema, and the resulting metadata XML document constrained by the schema. Appropriate XML statements are highlighted in bold to show where the main actions occur in both the mapping document and the related XML document. Descriptions of each bolded XML statement follow the examples.</p>
<p><a href="#CIHDJHED">Example 11-29</a> shows a sample mapping document that includes a sequence type attribute in the mapped section.</p>
<div id="IMDCM13488" class="example">
<p class="titleinexample"><a id="CIHDJHED"></a>Example 11-29 Sample Mapping Document for Metadata with Schema Constraints</p>
<pre>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
&lt;XML_MAPPING_DOCUMENT 
    xmlns=&#34;http://xmlns.oracle.com/ord/dicom/mapping_1_0&#34; 
    xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; 
    xsi:schemaLocation=&#34;http://xmlns.oracle.com/ord/dicom/mapping_1_0
        http://xmlns.oracle.com/ord/dicom/mapping_1_0&#34;&gt;
  <span class="bold">&lt;NAMESPACE&gt;http://www.mycompany.com/dicom/example3&lt;/NAMESPACE&gt;</span>
  <span class="bold">&lt;ROOT_ELEM_TAG&gt;DICOM_OBJECT&lt;/ROOT_ELEM_TAG&gt;</span>
  <span class="bold">&lt;UNMAPPED_ELEM&gt;OTHER_ATTRIBUTES&lt;/UNMAPPED_ELEM&gt;</span>
  <span class="bold">&lt;MAPPED_ELEM&gt;KEY_ATTRIBUTES&lt;/MAPPED_ELEM&gt;</span>
 
  &lt;MAPPED_PATH occurs=&#34;true&#34; notEmpty=&#34;true&#34;&gt;
    &lt;ATTRIBUTE_TAG&gt;00100010&lt;/ATTRIBUTE_TAG&gt;
    &lt;PATH&gt;PATIENT/NAME&lt;/PATH&gt;
  &lt;/MAPPED_PATH&gt;
 
  &lt;MAPPED_PATH occurs=&#34;true&#34; notEmpty=&#34;true&#34;&gt;
    &lt;ATTRIBUTE_TAG&gt;00100020&lt;/ATTRIBUTE_TAG&gt;
    &lt;PATH&gt;PATIENT/ID&lt;/PATH&gt;
  &lt;/MAPPED_PATH&gt;
 
  &lt;MAPPED_PATH occurs=&#34;true&#34; notEmpty=&#34;false&#34;&gt;
&lt;ATTRIBUTE_TAG&gt;00100030&lt;/ATTRIBUTE_TAG&gt;
    &lt;PATH&gt;PATIENT/BIRTH_DATE&lt;/PATH&gt;
  &lt;/MAPPED_PATH&gt;
 
  &lt;MAPPED_PATH occurs=&#34;false&#34; notEmpty=&#34;false&#34;&gt;
    &lt;ATTRIBUTE_TAG&gt;00100040&lt;/ATTRIBUTE_TAG&gt;
    &lt;PATH&gt;PATIENT/SEX&lt;/PATH&gt;
  &lt;/MAPPED_PATH&gt;
 
  &lt;MAPPED_PATH writeTag=&#34;true&#34; writeDefiner=&#34;true&#34; writeName=&#34;true&#34;&gt;
    &lt;ATTRIBUTE_TAG&gt;00200010&lt;/ATTRIBUTE_TAG&gt;
    &lt;PATH&gt;STUDY/ID&lt;/PATH&gt;
  &lt;/MAPPED_PATH&gt;
 
  &lt;<span class="bold">MAPPED_PATH&gt;</span>
    <span class="bold">&lt;ATTRIBUTE_TAG&gt;00081084&lt;/ATTRIBUTE_TAG&gt;</span>
    <span class="bold">&lt;PATH&gt;</span>
      <span class="bold">STUDY/ADMITTING_DIAGNOSES_CODE_SEQUENCE</span>
    <span class="bold">&lt;/PATH&gt;</span>
  <span class="bold">&lt;/MAPPED_PATH&gt;</span>
 
&lt;/XML_MAPPING_DOCUMENT&gt;
 
</pre></div>
<!-- class="example" -->
<p>The mapping document in <a href="#CIHDJHED">Example 11-29</a> differs from the mapping document in <a href="#CIHCCJJA">Example 11-26</a> as follows:</p>
<ul>
<li>
<p>The &lt;UNMAPPED_ELEM&gt; and &lt;MAPPED_ELEM&gt; elements are not empty.</p>
</li>
<li>
<p>There is a &lt;MAPPED_PATH&gt; element for tag <code>00081084</code>, which is of DICOM sequence type.</p>
</li>
</ul>
<p>The XML schema code segment in <a href="#CIHEBIJH">Example 11-30</a> shows how to define the unmapped root element for the mapping document in <a href="#CIHDJHED">Example 11-29</a> to include the unmapped section in the extracted metadata XML document. This code segment also shows how to use Oracle-defined data types from the schema <code>ordcmmddt.xsd</code>.</p>
<div id="IMDCM13735" class="example">
<p class="titleinexample"><a id="CIHEBIJH"></a>Example 11-30 Sample XML Schema for <a href="#CIHDJHED">Example 11-29</a></p>
<pre>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
&lt;xs:schema xmlns=&#34;http://www.mycompany.com/dicom/example3&#34; 
           xmlns:xdb=&#34;http://xmlns.oracle.com/xdb&#34; 
           xmlns:xs=&#34;http://www.w3.org/2001/XMLSchema&#34; 
           targetNamespace=&#34;http://www.mycompany.com/dicom/example3&#34; 
           elementFormDefault=&#34;qualified&#34; 
           attributeFormDefault=&#34;unqualified&#34;&gt;
  <span class="bold">&lt;xs:include schemaLocation=&#34;http://www.mycompany.com/dicom/datatype_3&#34;/&gt;</span>
  &lt;xs:element name=&#34;DICOM_OBJECT&#34;&gt;
    &lt;xs:complexType&gt;
      &lt;xs:sequence&gt;
        &lt;xs:element name=&#34;KEY_ATTRIBUTES&#34;&gt;
          &lt;xs:complexType&gt;
            &lt;xs:sequence&gt;
             &lt;xs:element name=&#34;PATIENT&#34;&gt;
               &lt;xs:complexType&gt;
                 &lt;xs:sequence&gt;
                   <span class="bold">&lt;xs:element name=&#34;NAME&#34; type=&#34;PN&#34;&gt;</span>
                   &lt;/xs:element&gt;
                   &lt;xs:element name=&#34;ID&#34; type=&#34;xs:string&#34;&gt;
                   &lt;/xs:element&gt;
                   &lt;xs:element name=&#34;BIRTH_DATE&#34; type=&#34;xs:date&#34; nillable=&#34;true&#34;&gt;
                   &lt;/xs:element&gt;
                   &lt;xs:element name=&#34;SEX&#34; type=&#34;xs:string&#34; minOccurs=&#34;0&#34;
                       nillable=&#34;true&#34;&gt;
                   &lt;/xs:element&gt;
                 &lt;/xs:sequence&gt;
               &lt;/xs:complexType&gt;
             &lt;/xs:element&gt;
             &lt;xs:element name=&#34;STUDY&#34;&gt;
               &lt;xs:complexType&gt;
                 &lt;xs:sequence&gt;
                   &lt;xs:element name=&#34;ID&#34; type=&#34;SH_ATTR_T&#34; minOccurs=&#34;0&#34;
                       nillable=&#34;true&#34;/&gt;
                   <span class="bold">&lt;xs:element name=&#34;ADMITTING_DIAGNOSES_CODE_SEQUENCE&#34; type=&#34;SQ&#34;</span>
                       <span class="bold">nillable=&#34;true&#34; minOccurs=&#34;0&#34;/&gt;</span>
                 &lt;/xs:sequence&gt;
               &lt;/xs:complexType&gt;
             &lt;/xs:element&gt;
            &lt;/xs:sequence&gt;
          &lt;/xs:complexType&gt;
        &lt;/xs:element&gt;
        &lt;/xs:element&gt;
        <span class="bold">&lt;xs:element name=&#34;OTHER_ATTRIBUTES&#34; type=&#34;DATASET_T&#34; minOccurs=&#34;0&#34;</span>
            <span class="bold">maxOccurs=&#34;unbounded&#34;&gt;</span>
        &lt;/xs:element&gt;
      &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;
&lt;/xs:schema&gt;
</pre></div>
<!-- class="example" -->
<p>In <a href="#CIHDJHED">Example 11-29</a> and the associated XML schema (in <a href="#CIHEBIJH">Example 11-30</a>), the following actions occur:</p>
<ul>
<li>
<p>Instead of defining its own data types as in <a href="#BGBFAJJI">Section 11.2.4.4</a>, this XML schema uses the Oracle-defined data types by copying the schema <code>ordcmmddt.xsd</code> into an application-specific XSD file and then changing the namespace declaration, as in this XML code segment:</p>
<pre>&lt;xs:schema 
xmlns=&#34;http://www.mycompany.com/dicom/example3&#34; 
xmlns:xs=&#34;http://www.w3.org/2001/XMLSchema&#34; 
xmlns:xdb=&#34;http://xmlns.oracle.com/xdb&#34; 
targetNamespace=&#34;http://www.mycompany.com/dicom/example3&#34;
elementFormDefault=&#34;qualified&#34; 
attributeFormDefault=&#34;unqualified&#34;&gt;
</pre>
<p>This data type XML schema is registered as a global XML schema with Oracle XML DB<a id="sthref864"></a>, using the following namespace URL:</p>
<pre>&#34;http://www.mycompany.com/dicom/datatype_3&#34;
</pre>
<p>Then, this registered namespace URL is included in the metadata XML schema.</p>
<p>See <a class="olink ADXDB0600" href="../ADXDB/xdb05sto.htm#ADXDB0600"><span class="italic">Oracle XML DB Developer&#39;s Guide</span></a> for more information about registering global and local XML schemas.</p>
</li>
<li>
<p>Because the Oracle-defined data types are included in the XML schema, they can be referenced directly, as shown in the &lt;NAME&gt;, &lt;ADMITTING_DIAGNOSES_CODE_SEQUENCE&gt;, and &lt;OTHER_ATTRIBUTES&gt; elements.</p>
</li>
<li>
<p>The &lt;OTHER_ATTRIBUTES&gt; element is defined as type &#34;DATASET_T&#34; to enable the inclusion of all unmapped DICOM attributes under this element when a value of <code>ALL</code> or <code>STANDARD</code> is passed to the extractMetadata( ) method for the extractOption parameter. Because the <code>minOccurs</code> attribute is defined as <code>0</code>, when the value <code>MAPPED</code> is passed to the extractMetadata( ) method, only the mapped section is included in the extracted XML document.</p>
</li>
</ul>
<p><a href="#CIHDJAHE">Example 11-31</a> shows the resulting metadata XML document whose XML metadata was extracted with the value of the extractOption parameter in the extractMetadata( ) method set to <code>MAPPED</code>.</p>
<div id="IMDCM13681" class="example">
<p class="titleinexample"><a id="CIHDJAHE"></a>Example 11-31 Resulting XML Document for <a href="#CIHDJHED">Example 11-29</a> (MAPPED)</p>
<pre>&lt;?xml version=&#34;1.0&#34; encoding=&#34;DEC-MCS&#34;?&gt;
&lt;DICOM_OBJECT xmlns=&#34;http://www.mycompany.com/dicom/example3&#34;
   xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;
   xsi:schemaLocation=&#34;http://www.mycompany.com/dicom/example3
   http://www.mycompany.com/dicom/example3&#34;&gt;
  &lt;KEY_ATTRIBUTES&gt;
    &lt;PATIENT&gt;
      &lt;NAME&gt;
        &lt;NAME type=&#34;unibyte&#34;&gt;
          &lt;FAMILY&gt;CANCIO   2HR A-02-013&lt;/FAMILY&gt;
        &lt;/NAME&gt;
        &lt;VALUE&gt;CANCIO   2HR A-02-013&lt;/VALUE&gt;
      &lt;/NAME&gt;
      &lt;ID&gt;ISRSCT610b&lt;/ID&gt;
      &lt;BIRTH_DATE xsi:nil=&#34;true&#34;/&gt;
      &lt;SEX xsi:nil=&#34;true&#34;/&gt;
    &lt;/PATIENT&gt;
    &lt;STUDY&gt;
      &lt;ID definer=&#34;DICOM&#34; tag=&#34;00200010&#34; name=&#34;Study ID&#34;&gt;352&lt;/ID&gt;
      &lt;ADMITTING_DIAGNOSES_CODE_SEQUENCE&gt;
        &lt;ITEM&gt;
          &lt;SHORT_STRING tag=&#34;00080100&#34; definer=&#34;DICOM&#34; name=&#34;Code Value&#34;
             offset=&#34;692&#34; length=&#34;0&#34;/&gt;
          &lt;SHORT_STRING tag=&#34;00080102&#34; definer=&#34;DICOM&#34; name=&#34;Coding Scheme
             Designator&#34; offset=&#34;700&#34; length=&#34;0&#34;/&gt;
          &lt;SHORT_STRING tag=&#34;00080103&#34; definer=&#34;DICOM&#34; name=&#34;Coding Scheme
             Version&#34; offset=&#34;708&#34; length=&#34;0&#34;/&gt;
          &lt;LONG_STRING tag=&#34;00080104&#34; definer=&#34;DICOM&#34; name=&#34;Code Meaning&#34;
             offset=&#34;716&#34; length=&#34;0&#34;/&gt;
          &lt;CODE_STRING tag=&#34;00080105&#34; definer=&#34;DICOM&#34; name=&#34;Mapping Resource&#34;
             offset=&#34;724&#34; length=&#34;0&#34;/&gt;
          &lt;DATE_TIME tag=&#34;00080106&#34; definer=&#34;DICOM&#34; name=&#34;Context Group Version&#34;
             offset=&#34;732&#34; length=&#34;0&#34; xsi:nil=&#34;true&#34; rawValue=&#34;&#34;
               byteOrderLE=&#34;true&#34;/&gt;
          &lt;DATE_TIME tag=&#34;00080107&#34; definer=&#34;DICOM&#34; name=&#34;Context Group Local
               Version&#34; offset=&#34;740&#34; length=&#34;0&#34; xsi:nil=&#34;true&#34; rawValue=&#34;&#34;
               byteOrderLE=&#34;true&#34;/&gt;
          &lt;CODE_STRING tag=&#34;0008010B&#34; definer=&#34;DICOM&#34; name=&#34;Context Group
               Extension Flag&#34; offset=&#34;748&#34; length=&#34;0&#34;/&gt;
          &lt;UNIQUE_ID tag=&#34;0008010D&#34; definer=&#34;DICOM&#34; name=&#34;Context Group Extension
               Creator UID&#34; offset=&#34;756&#34; length=&#34;0&#34; xsi:nil=&#34;true&#34; rawValue=&#34;&#34;
               byteOrderLE=&#34;true&#34;/&gt;
          &lt;CODE_STRING tag=&#34;0008010F&#34; definer=&#34;DICOM&#34; name=&#34;Context Identifier&#34;
               offset=&#34;764&#34; length=&#34;0&#34;/&gt;
        &lt;/ITEM&gt;
      &lt;/ADMITTING_DIAGNOSES_CODE_SEQUENCE&gt;
    &lt;/STUDY&gt;
  &lt;/KEY_ATTRIBUTES&gt;
&lt;/DICOM_OBJECT&gt;
</pre></div>
<!-- class="example" -->
<p><a href="#CIHIGAJI">Example 11-32</a> shows the resulting metadata XML document whose XML metadata was extracted with the value of the extractOption parameter in the extractMetadata( ) method set to <code>ALL</code>.</p>
<div id="IMDCM13682" class="example">
<p class="titleinexample"><a id="CIHIGAJI"></a>Example 11-32 Resulting XML Document for <a href="#CIHDJHED">Example 11-29</a> (ALL)</p>
<pre>&lt;?xml version=&#34;1.0&#34; encoding=&#34;DEC-MCS&#34;?&gt;
&lt;DICOM_OBJECT xmlns=&#34;http://www.mycompany.com/dicom/example3&#34;
   xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;
   xsi:schemaLocation=&#34;http://www.mycompany.com/dicom/example3
   http://www.mycompany.com/dicom/example3&#34;&gt;
  &lt;KEY_ATTRIBUTES&gt;
    &lt;PATIENT&gt;
      &lt;NAME&gt;
        &lt;NAME type=&#34;unibyte&#34;&gt;
          &lt;FAMILY&gt;CANCIO   2HR A-02-013&lt;/FAMILY&gt;
        &lt;/NAME&gt;
        &lt;VALUE&gt;CANCIO   2HR A-02-013&lt;/VALUE&gt;
      &lt;/NAME&gt;
      &lt;ID&gt;ISRSCT610b&lt;/ID&gt;
      &lt;BIRTH_DATE xsi:nil=&#34;true&#34;/&gt;
      &lt;SEX xsi:nil=&#34;true&#34;/&gt;
    &lt;/PATIENT&gt;
    &lt;STUDY&gt;
      &lt;ID definer=&#34;DICOM&#34; tag=&#34;00200010&#34; name=&#34;Study ID&#34;&gt;352&lt;/ID&gt;
      &lt;ADMITTING_DIAGNOSES_CODE_SEQUENCE&gt;
        &lt;ITEM&gt;
          &lt;SHORT_STRING tag=&#34;00080100&#34; definer=&#34;DICOM&#34; name=&#34;Code Value&#34;
             offset=&#34;692&#34; length=&#34;0&#34;/&gt;
          &lt;SHORT_STRING tag=&#34;00080102&#34; definer=&#34;DICOM&#34; name=&#34;Coding Scheme
             Designator&#34; offset=&#34;700&#34; length=&#34;0&#34;/&gt;
          &lt;SHORT_STRING tag=&#34;00080103&#34; definer=&#34;DICOM&#34; name=&#34;Coding Scheme
             Version&#34; offset=&#34;708&#34; length=&#34;0&#34;/&gt;
          &lt;LONG_STRING tag=&#34;00080104&#34; definer=&#34;DICOM&#34; name=&#34;Code Meaning&#34;
             offset=&#34;716&#34; length=&#34;0&#34;/&gt;
          &lt;CODE_STRING tag=&#34;00080105&#34; definer=&#34;DICOM&#34; name=&#34;Mapping Resource&#34;
             offset=&#34;724&#34; length=&#34;0&#34;/&gt;
          &lt;DATE_TIME tag=&#34;00080106&#34; definer=&#34;DICOM&#34; name=&#34;Context Group Version&#34;
             offset=&#34;732&#34; length=&#34;0&#34; xsi:nil=&#34;true&#34; rawValue=&#34;&#34;
             byteOrderLE=&#34;true&#34;/&gt;
          &lt;DATE_TIME tag=&#34;00080107&#34; definer=&#34;DICOM&#34; name=&#34;Context Group Local
             Version&#34; offset=&#34;740&#34; length=&#34;0&#34; xsi:nil=&#34;true&#34; rawValue=&#34;&#34;
             byteOrderLE=&#34;true&#34;/&gt;
          &lt;CODE_STRING tag=&#34;0008010B&#34; definer=&#34;DICOM&#34; name=&#34;Context Group
             Extension Flag&#34; offset=&#34;748&#34; length=&#34;0&#34;/&gt;
          &lt;UNIQUE_ID tag=&#34;0008010D&#34; definer=&#34;DICOM&#34; name=&#34;Context Group Extension
             Creator UID&#34; offset=&#34;756&#34; length=&#34;0&#34; xsi:nil=&#34;true&#34; rawValue=&#34;&#34;
             byteOrderLE=&#34;true&#34;/&gt;
          &lt;CODE_STRING tag=&#34;0008010F&#34; definer=&#34;DICOM&#34; name=&#34;Context Identifier&#34;
             offset=&#34;764&#34; length=&#34;0&#34;/&gt;
        &lt;/ITEM&gt;
      &lt;/ADMITTING_DIAGNOSES_CODE_SEQUENCE&gt;
    &lt;/STUDY&gt;
  &lt;/KEY_ATTRIBUTES&gt;
  &lt;OTHER_ATTRIBUTES&gt;
    &lt;OTHER_BYTE tag=&#34;00020001&#34; definer=&#34;DICOM&#34; name=&#34;File Meta Information
       Version&#34; offset=&#34;156&#34; length=&#34;2&#34;&gt;AQA=
 
&lt;/OTHER_BYTE&gt;
    &lt;UNIQUE_ID tag=&#34;00020002&#34; definer=&#34;DICOM&#34; name=&#34;Media Storage SOP Class UID&#34;
       offset=&#34;166&#34; length=&#34;26&#34;&gt;1.2.840.10008.5.1.4.1.1.2&lt;/UNIQUE_ID&gt;
    &lt;UNIQUE_ID tag=&#34;00020003&#34; definer=&#34;DICOM&#34; name=&#34;Media Storage SOP Instance
       UID&#34; offset=&#34;200&#34; length=&#34;54&#34;&gt;1.2.392.200036.91&lt;/UNIQUE_ID&gt;
    &lt;UNIQUE_ID tag=&#34;00020010&#34; definer=&#34;DICOM&#34; name=&#34;Transfer Syntax UID&#34;
       offset=&#34;262&#34; length=&#34;18&#34;&gt;1.2.840.10008.1.2&lt;/UNIQUE_ID&gt;
    &lt;UNIQUE_ID tag=&#34;00020012&#34; definer=&#34;DICOM&#34; name=&#34;Implementation Class UID&#34;
       offset=&#34;288&#34; length=&#34;16&#34;&gt;1.2.804.114118.3&lt;/UNIQUE_ID&gt;
&lt;APPLICATION_ENTITY tag=&#34;00020016&#34; definer=&#34;DICOM&#34; name=&#34;Source Application Entity
    Title&#34; offset=&#34;326&#34; length=&#34;0&#34; xsi:nil=&#34;true&#34; rawValue=&#34;&#34; byteOrderLE=&#34;true&#34;/&gt;
    &lt;CODE_STRING tag=&#34;00080008&#34; definer=&#34;DICOM&#34; name=&#34;Image Type&#34; offset=&#34;334&#34;
       length=&#34;22&#34;&gt;ORIGINAL&lt;/CODE_STRING&gt;
    &lt;CODE_STRING tag=&#34;00080008&#34; definer=&#34;DICOM&#34; name=&#34;Image Type&#34; offset=&#34;334&#34;
       length=&#34;22&#34;&gt;PRIMARY&lt;/CODE_STRING&gt;
    &lt;CODE_STRING tag=&#34;00080008&#34; definer=&#34;DICOM&#34; name=&#34;Image Type&#34; offset=&#34;334&#34;
       length=&#34;22&#34;&gt;AXIAL&lt;/CODE_STRING&gt;
    &lt;UNIQUE_ID tag=&#34;00080016&#34; definer=&#34;DICOM&#34; name=&#34;SOP Class UID&#34; offset=&#34;364&#34;
       length=&#34;26&#34;&gt;1.2.840.10008.5.1.4.1.1.2&lt;/UNIQUE_ID&gt;
    &lt;UNIQUE_ID tag=&#34;00080018&#34; definer=&#34;DICOM&#34; name=&#34;SOP Instance UID&#34; offset=&#34;398&#34;
       length=&#34;54&#34;&gt;1.2.392.200036.91&lt;/UNIQUE_ID&gt;
    &lt;DATE tag=&#34;00080020&#34; definer=&#34;DICOM&#34; name=&#34;Study Date&#34; offset=&#34;460&#34;
   length=&#34;8&#34;&gt;2004-02-23&lt;/DATE&gt;
    &lt;DATE tag=&#34;00080022&#34; definer=&#34;DICOM&#34; name=&#34;Acquisition Date&#34; offset=&#34;476&#34;
   length=&#34;8&#34;&gt;2004-02-23&lt;/DATE&gt;
    &lt;DATE tag=&#34;00080023&#34; definer=&#34;DICOM&#34; name=&#34;Content Date&#34; offset=&#34;492&#34;
   length=&#34;8&#34;&gt;2004-02-23&lt;/DATE&gt;
    &lt;TIME tag=&#34;00080030&#34; definer=&#34;DICOM&#34; name=&#34;Study Time&#34; offset=&#34;508&#34;
   length=&#34;14&#34;&gt;18:48:41.000000&lt;/TIME&gt;
    &lt;TIME tag=&#34;00080032&#34; definer=&#34;DICOM&#34; name=&#34;Acquisition Time&#34; offset=&#34;530&#34;
   length=&#34;14&#34;&gt;18:50:52.100000&lt;/TIME&gt;
    &lt;TIME tag=&#34;00080033&#34; definer=&#34;DICOM&#34; name=&#34;Content Time&#34; offset=&#34;552&#34;
   length=&#34;14&#34;&gt;18:50:52.725000&lt;/TIME&gt;
    &lt;SHORT_STRING tag=&#34;00080050&#34; definer=&#34;DICOM&#34; name=&#34;Accession Number&#34;
   offset=&#34;574&#34; length=&#34;4&#34;&gt;352&lt;/SHORT_STRING&gt;
    &lt;CODE_STRING tag=&#34;00080060&#34; definer=&#34;DICOM&#34; name=&#34;Modality&#34; offset=&#34;586&#34;
   length=&#34;2&#34;&gt;CT&lt;/CODE_STRING&gt;
.
.
.
 
    &lt;SHORT_STRING tag=&#34;00400253&#34; definer=&#34;DICOM&#34; name=&#34;Performed Procedure Step
      ID&#34; offset=&#34;1742&#34; length=&#34;4&#34;&gt;351&lt;/SHORT_STRING&gt;
    &lt;OTHER_WORD tag=&#34;7FE00010&#34; definer=&#34;DICOM&#34; name=&#34;Pixel Data&#34; offset=&#34;1766&#34;
      length=&#34;524288&#34; truncated=&#34;true&#34; xsi:nil=&#34;true&#34; endian=&#34;little&#34;/&gt;
  &lt;/OTHER_ATTRIBUTES&gt;
&lt;/DICOM_OBJECT&gt;
</pre></div>
<!-- class="example" --></div>
<!-- class="sect3" -->
<a id="CIHFHDFB"></a>
<div id="IMDCM13627" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.4.6</span> Using DICOM Value Locators in Mapping Documents</h4>
<p>This subsection shows how to use DICOM value locators to specify attributes in mapping documents. <a href="#CIHJGIDA">Example 11-33</a> shows how to use a DICOM value locator to specify the family name field of the <code>Patient&#39;s Name</code> attribute with unibyte encoding in a mapping document. The XML statement where this action is performed is highlighted in bold.</p>
<div id="IMDCM13683" class="example">
<p class="titleinexample"><a id="CIHJGIDA"></a>Example 11-33 DICOM Value Locator for an Attribute with Unibyte Encoding in a Mapping Document</p>
<pre>&lt;MAPPED_PATH&gt;
    <span class="bold">&lt;ATTRIBUTE_TAG&gt;00100010#UnibyteFamily&lt;/ATTRIBUTE_TAG&gt;</span>
    &lt;PATH&gt;FAMILY_NAME&lt;/PATH&gt;
&lt;/MAPPED_PATH&gt;
</pre></div>
<!-- class="example" -->
<p>Using the mapping document that contains the code shown in <a href="#CIHJGIDA">Example 11-33</a> in the extractMetadata( ) method results in an XML document that contains the tag &lt;FAMILY_NAME&gt; with the value that corresponds to the family name field of the attribute <code>00100010</code>.</p>
<p><a href="#CIHFCEEG">Example 11-34</a> shows how to use a DICOM value locator to specify an attribute embedded within a sequence attribute in a mapping document.</p>
<div id="IMDCM13684" class="example">
<p class="titleinexample"><a id="CIHFCEEG"></a>Example 11-34 DICOM Value Locator for an Embedded Sequence Attribute in a Mapping Document</p>
<pre>&lt;MAPPED_PATH&gt;
    &lt;ATTRIBUTE_TAG&gt;0040A730[2].0040A010&lt;/ATTRIBUTE_TAG&gt;
    &lt;PATH&gt;RELATIONSHIP&lt;/PATH&gt;
&lt;/MAPPED_PATH&gt;
</pre></div>
<!-- class="example" -->
<p>Using the mapping document that contains the code shown in <a href="#CIHFCEEG">Example 11-34</a> in the extractMetadata( ) method results in an XML document that contains the tag &lt;RELATIONSHIP&gt; with the value that corresponds to the value of attribute <code>0040A010</code>. Attribute <code>0040A010</code> is embedded within the second item of the sequence attribute <code>0040A730</code>.</p>
<p>The standard attribute tags <code>0040A730</code> and <code>0040A010</code> are defined as follows in the standard dictionary:</p>
<pre>&lt;STANDARD_ATTRIBUTE_DEFINITION&gt;
   &lt;TAG&gt;0040A730&lt;/TAG&gt;
   &lt;NAME&gt;Content Sequence&lt;/NAME&gt;
   &lt;VR&gt;SQ&lt;/VR&gt;
   &lt;VM&gt;1&lt;/VM&gt;
&lt;/STANDARD_ATTRIBUTE_DEFINITION&gt;

&lt;STANDARD_ATTRIBUTE_DEFINITION&gt;
   &lt;TAG&gt;0040A010&lt;/TAG&gt;
   &lt;NAME&gt;Relationship Type&lt;/NAME&gt;
   &lt;VR&gt;CS&lt;/VR&gt;
   &lt;VM&gt;1&lt;/VM&gt;
&lt;/STANDARD_ATTRIBUTE_DEFINITION&gt;
</pre>
<p>In the tag definition shown in the preceding code segment, the &lt;VR&gt; element shows that attribute <code>0040A730</code> is an attribute of sequence type. By using the DICOM value locator, any attribute that is embedded within a sequence type attribute can be retrieved individually into the resulting XML metadata document.</p>
<p><a href="#CIHCJIAF">Example 11-35</a> shows how to use a DICOM value locator to specify a single value of an attribute that contains multiple values in a mapping document.</p>
<div id="IMDCM13685" class="example">
<p class="titleinexample"><a id="CIHCJIAF"></a>Example 11-35 DICOM Value Locator for a Single Attribute Value in a Mapping Document</p>
<pre>&lt;MAPPED_PATH&gt;
    &lt;ATTRIBUTE_TAG&gt;00080008[3]&lt;/ATTRIBUTE_TAG&gt;
    &lt;PATH&gt;IMAGE_TYPE&lt;/PATH&gt;
&lt;/MAPPED_PATH&gt;
</pre></div>
<!-- class="example" -->
<p>Using the mapping document that contains the code shown in <a href="#CIHCJIAF">Example 11-35</a> in the extractMetadata( ) method results in an XML document that contains the tag &lt;IMAGE_TYPE&gt; with the value that corresponds to the third value of the attribute <code>00080008</code>.</p>
<p>The standard attribute tag <code>00080008</code> is defined as follows in the standard dictionary:</p>
<pre>&lt;STANDARD_ATTRIBUTE_DEFINITION&gt;
   &lt;TAG&gt;00080008&lt;/TAG&gt;
   &lt;NAME&gt;Image Type&lt;/NAME&gt;
   &lt;VR&gt;CS&lt;/VR&gt;
   &lt;VM&gt;1-n&lt;/VM&gt;
&lt;/STANDARD_ATTRIBUTE_DEFINITION&gt;
</pre>
<p>In the tag definition shown in the preceding code segment, the &lt;VM&gt; element shows that the attribute can contain multiple values. Using the DICOM value locator with an item number such as <code>00080008[3]</code> ensures that the specific (third) value is retrieved.</p>
<p>See <a href="ch_adm_ref.htm#CHEDJCDJ">General Format for DICOM Value Locators</a> for more information about the DICOM value locator type.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="BGBBBGBI"></a>
<div id="IMDCM13501" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">11.2.5</span> Creating Preference Documents</h3>
<p>Preference documents<a id="sthref865"></a> are XML documents that list the set of preference parameters<a id="sthref866"></a> that define the run-time behavior of Oracle Multimedia DICOM.</p>
<p>The XML document <code>ordcmpf.xsd</code> defines the XML schema that constrains preference documents. (See <a href="ap_schemas.htm#BABEBCJJ">Appendix B</a> for more information about this schema. The text within the &lt;xs: annotation&gt; element includes a detailed description of the preference parameters and their valid values.)</p>
<p>The default preference document <code>ordcmpf.xml</code> includes the default values for the run-time preference parameters for Oracle Multimedia DICOM. (See <a href="ap_confg_docs.htm#BEIECEEI">Appendix A</a> for more information about this configuration document.)</p>
<p>Within a preference document, a &lt;PREFERENCE_DEF&gt; element is used to define each preference parameter and its value.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Keep these additional guidelines in mind:
<ul>
<li>
<p>A maximum of two (one Oracle-defined and one user-defined) preference documents are permitted in the repository.</p>
</li>
<li>
<p>Changes to preference parameter values in preference documents change the behavior of DICOM methods, functions, and procedures. Specifically, preference parameter values that are defined in the user-defined preference document override the default values defined in the Oracle-defined preference document <code>ordcmpf.xml</code>.</p>
</li>
<li>
<p>All preference parameter names and their associated values are defined by Oracle. User-defined preference documents can change the values of the Oracle-defined preference parameters.</p>
</li>
</ul>
</div>
<p>The following subsections contain examples that show how to define preference parameter values in a preference document:</p>
<ul>
<li>
<p><a href="#BEIECAGD">Defining the BINARY_SKIP_INVALID_ATTR Preference Parameter</a></p>
</li>
<li>
<p><a href="#BEIIGHAI">Defining the CONFORMANCE_LEVEL Preference Parameter</a></p>
</li>
<li>
<p><a href="#BEIBGABE">Defining the EXP_IF_NULL_ATTR_IN_CONSTRAINT Preference Parameter</a></p>
</li>
<li>
<p><a href="#BEIFBGCF">Defining the IGNORED_EXP_LIST Preference Parameter</a></p>
</li>
<li>
<p><a href="#CIHCJAJI">Defining the MANDATE_ATTR_TAGS_IN_STL Preference Parameter</a></p>
</li>
<li>
<p><a href="#BEIECGDH">Defining the MAX_RECURSION_DEPTH Preference Parameter</a></p>
</li>
<li>
<p><a href="#BEIDGHFH">Defining the SPECIFIC_CHARACTER_SET Preference Parameter</a></p>
</li>
<li>
<p><a href="#BEIHHHGC">Defining the SQ_WRITE_LEN Preference Parameter</a></p>
</li>
<li>
<p><a href="#BEIJIAJG">Defining the VALIDATE_METADATA Preference Parameter</a></p>
</li>
<li>
<p><a href="#BEIJIGCD">Defining the XML_SKIP_ATTR Preference Parameter</a></p>
</li>
</ul>
<a id="BEIECAGD"></a>
<div id="IMDCM13760" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.5.1</span> Defining the BINARY_SKIP_INVALID_ATTR Preference Parameter</h4>
<p>The BINARY_SKIP_INVALID_ATTR preference parameter is used to specify whether Oracle Multimedia DICOM includes or skips invalid attributes and their values in the binary output of DICOM content when making a copy of the DICOM Part 10 file. Invalid attributes are attributes that do not conform to the specified DICOM standard. <a href="#BEICIEGF">Example 11-36</a> shows how to define this preference parameter in a preference document.</p>
<div id="IMDCM13761" class="example">
<p class="titleinexample"><a id="BEICIEGF"></a>Example 11-36 Definition of the BINARY_SKIP_INVALID_ATTR Preference Parameter</p>
<pre>  &lt;PREFERENCE_DEF&gt;
    &lt;PARAMETER&gt;BINARY_SKIP_INVALID_ATTR&lt;/PARAMETER&gt;
    &lt;DESCRIPTION&gt;
      Do not skip the value of attributes that do not conform to the 
      DICOM specification when making a copy of a DICOM Part 10 file.
    &lt;/DESCRIPTION&gt;
    &lt;VALUE&gt;false&lt;/VALUE&gt;
  &lt;/PREFERENCE_DEF&gt;
</pre></div>
<!-- class="example" -->
<p>The &lt;PARAMETER&gt; element specifies the Oracle-defined preference parameter <code>BINARY_SKIP_INVALID_ATTR</code>.</p>
<p>The &lt;VALUE&gt; element represents the value of the BINARY_SKIP_INVALID_ATTR preference parameter, which is <code>false</code> by default.</p>
<p>If the value of this preference parameter is <code>false</code>, invalid attributes and their values are included in the corresponding output. If the preference parameter value is set to <code>true</code>, the attribute values are included in the output with length <code>0</code>.</p>
</div>
<!-- class="sect3" -->
<a id="BEIIGHAI"></a>
<div id="IMDCM13971" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.5.2</span> Defining the CONFORMANCE_LEVEL Preference Parameter</h4>
<p>The CONFORMANCE_LEVEL preference parameter is used to specify which types of errors and exceptions Oracle Multimedia DICOM ignores or reports when processing DICOM content. <a href="#BEIJHEHB">Example 11-37</a> shows how to define this preference parameter in a preference document.</p>
<div id="IMDCM13972" class="example">
<p class="titleinexample"><a id="BEIJHEHB"></a>Example 11-37 Definition of the CONFORMANCE_LEVEL Preference Parameter</p>
<pre>  &lt;PREFERENCE_DEF&gt;
    &lt;PARAMETER&gt;CONFORMANCE_LEVEL&lt;/PARAMETER&gt;
    &lt;DESCRIPTION&gt;
      Ignore selected exceptions.
    &lt;/DESCRIPTION&gt;
    &lt;VALUE&gt;ignoreException&lt;/VALUE&gt;
  &lt;/PREFERENCE_DEF&gt;
</pre></div>
<!-- class="example" -->
<p>The &lt;PARAMETER&gt; element specifies the Oracle-defined preference parameter <code>CONFORMANCE_LEVEL</code>.</p>
<p>The &lt;VALUE&gt; element represents the value of the CONFORMANCE_LEVEL parameter, which is <code>ignoreException</code> by default. Other valid values are: <code>leastConform</code> and <code>mostConform</code>.</p>
<p>The default value <code>ignoreException</code> instructs all functions to ignore the types of exceptions specified in the preference parameter IGNORED_EXP_LIST.</p>
<p>The value <code>leastConform</code> instructs all functions to ignore errors and exceptions to maximize the processing of DICOM content.</p>
<p>If the value is set to <code>mostConform</code>, all functions throw an exception when encountering DICOM content that does not conform to the DICOM standard. (This behavior does not include backward compatibility cases that are allowed by the DICOM standard.)</p>
</div>
<!-- class="sect3" -->
<a id="BEIBGABE"></a>
<div id="IMDCM13764" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.5.3</span> Defining the EXP_IF_NULL_ATTR_IN_CONSTRAINT Preference Parameter</h4>
<p>The EXP_IF_NULL_ATTR_IN_CONSTRAINT preference parameter is used to specify whether Oracle Multimedia DICOM throws an exception when encountering a missing attribute or a null attribute value during conformance validation. <a href="#BEIEICDA">Example 11-38</a> shows how to define this preference parameter in a preference document.</p>
<div id="IMDCM13765" class="example">
<p class="titleinexample"><a id="BEIEICDA"></a>Example 11-38 Definition of the EXP_IF_NULL_ATTR_IN_CONSTRAINT Preference Parameter</p>
<pre>  &lt;PREFERENCE_DEF&gt;
    &lt;PARAMETER&gt;EXP_IF_NULL_ATTR_IN_CONSTRAINT&lt;/PARAMETER&gt;
    &lt;DESCRIPTION&gt;
      Throw an exception if a missing attribute or a null 
      attribute value is encountered during conformance 
      validation.
    &lt;/DESCRIPTION&gt;
    &lt;VALUE&gt;true&lt;/VALUE&gt;
  &lt;/PREFERENCE_DEF&gt;
</pre></div>
<!-- class="example" -->
<p>The &lt;PARAMETER&gt; element specifies the Oracle-defined preference parameter <code>EXP_IF_NULL_ATTR_IN_CONSTRAINT</code>.</p>
<p>The &lt;VALUE&gt; element represents the value of the EXP_IF_NULL_ATTR_IN_CONSTRAINT preference parameter, which is <code>true</code> by default.</p>
<p>In a constraint predicate that is not preceded by a notEmpty Boolean function predicate on an attribute, when the value of this preference parameter is <code>true</code>, an exception is thrown at the first occurrence of either of these conditions:</p>
<ul>
<li>
<p>The attribute is missing.</p>
</li>
<li>
<p>The attribute has a null value.</p>
</li>
</ul>
<p>See <a href="#BEICIFDH">Example 11-14</a> for more information.</p>
<p>If the value is set to <code>false</code>, no exception is thrown.</p>
<p>This preference parameter affects the results of the method isConformanceValid( ). See the <a href="ch_dev_ref.htm#CHDDGCCH">isConformanceValid( )</a> method for more information.</p>
</div>
<!-- class="sect3" -->
<a id="BEIFBGCF"></a>
<div id="IMDCM13973" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.5.4</span> Defining the IGNORED_EXP_LIST Preference Parameter</h4>
<p>The IGNORED_EXP_LIST preference parameter is used to specify the types of exceptions that Oracle Multimedia DICOM ignores when processing DICOM content. This preference parameter is effective only when the value of the CONFORMANCE_LEVEL preference parameter is set to <code>ignoreException</code>. <a href="#BEICGCDB">Example 11-39</a> shows how to define this preference parameter in a preference document.</p>
<div id="IMDCM13974" class="example">
<p class="titleinexample"><a id="BEICGCDB"></a>Example 11-39 Definition of the IGNORED_EXP_LIST Preference Parameter</p>
<pre>  &lt;PREFERENCE_DEF&gt;
    &lt;PARAMETER&gt;IGNORED_EXP_LIST&lt;/PARAMETER&gt;
    &lt;DESCRIPTION&gt;
      Do not throw exceptions if: mandatory attributes are missing
      from the DICOM content (MISSING_ATTR), the DICOM file magic number
      &#34;DICM&#34; is missing (MISSING_MAGIC), an attribute has an invalid value
      representation value (INVALID_VR), an attribute has an incorrect
      value multiplicity (INVALID_VM), or a DICOM Part 10 file contains
      invalid data (PARSE_ERR).
    &lt;/DESCRIPTION&gt;
    &lt;VALUE&gt;MISSING_ATTR MISSING_MAGIC INVALID_VR INVALID_VM PARSE_ERR&lt;/VALUE&gt;
  &lt;/PREFERENCE_DEF&gt;
</pre></div>
<!-- class="example" -->
<p>The &lt;PARAMETER&gt; element specifies the Oracle-defined preference parameter <code>IGNORED_EXP_LIST</code>.</p>
<p>The &lt;VALUE&gt; element represents the value of the IGNORED_EXP_LIST preference parameter, which lists one or more exceptions to be ignored.</p>
</div>
<!-- class="sect3" -->
<a id="CIHCJAJI"></a>
<div id="IMDCM13629" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.5.5</span> Defining the MANDATE_ATTR_TAGS_IN_STL Preference Parameter</h4>
<p>The MANDATE_ATTR_TAGS_IN_STL preference parameter is used to specify whether Oracle Multimedia DICOM enforces the rule that all tags used by the constraint and mapping documents must be listed in the stored tag list document. <a href="#CIHDBBHG">Example 11-40</a> shows how to define this preference parameter in a preference document.</p>
<div id="IMDCM13695" class="example">
<p class="titleinexample"><a id="CIHDBBHG"></a>Example 11-40 Definition of the MANDATE_ATTR_TAGS_IN_STL Preference Parameter</p>
<pre>  &lt;PREFERENCE_DEF&gt;
    &lt;PARAMETER&gt;MANDATE_ATTR_TAGS_IN_STL&lt;/PARAMETER&gt;
    &lt;DESCRIPTION&gt;
      All tags in the constraint and mapping docs must be listed in the 
      STORED_TAG_LIST document.
    &lt;/DESCRIPTION&gt;
    &lt;VALUE&gt;true&lt;/VALUE&gt;
  &lt;/PREFERENCE_DEF&gt;
</pre></div>
<!-- class="example" -->
<p>The &lt;PARAMETER&gt; element specifies the Oracle-defined preference parameter <code>MANDATE_ATTR_TAGS_IN_STL</code>.</p>
<p>The &lt;VALUE&gt; element represents the value of the MANDATE_ATTR_TAGS_IN_STL preference parameter, which is <code>false</code> by default.</p>
<p>The value of this preference parameter determines whether to enforce the rule that all tags used by the constraint and mapping documents are listed in the stored tag list document. If the value of this preference parameter is set to <code>true</code>, the rule is enforced. If the value is <code>false</code>, the rule is not enforced.</p>
<p>However, if an existing stored tag list document does not satisfy the rule, the value of the preference parameter cannot be set to <code>true</code> until the stored tag list document is updated. Also, if the value of this preference parameter is <code>true</code>, only constraint and mapping documents that use tags listed in the stored tag list document can be inserted into the repository.</p>
</div>
<!-- class="sect3" -->
<a id="BEIECGDH"></a>
<div id="IMDCM13770" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.5.6</span> Defining the MAX_RECURSION_DEPTH Preference Parameter</h4>
<p>The MAX_RECURSION_DEPTH preference parameter is used to specify the maximum level of recursion Oracle Multimedia DICOM uses to evaluate recursive constraint macros during conformance validation. <a href="#BEIBAJFA">Example 11-41</a> shows how to define this preference parameter in a preference document.</p>
<div id="IMDCM13771" class="example">
<p class="titleinexample"><a id="BEIBAJFA"></a>Example 11-41 Definition of the MAX_RECURSION_DEPTH Preference Parameter</p>
<pre>  &lt;PREFERENCE_DEF&gt;
    &lt;PARAMETER&gt;MAX_RECURSION_DEPTH&lt;/PARAMETER&gt;
    &lt;DESCRIPTION&gt;
      The maximum level of recursion when evaluating a recursive constraint 
      during conformation validation.
    &lt;/DESCRIPTION&gt;
    &lt;VALUE&gt;16&lt;/VALUE&gt;
  &lt;/PREFERENCE_DEF&gt;
</pre></div>
<!-- class="example" -->
<p>The &lt;PARAMETER&gt; element specifies the Oracle-defined preference parameter <code>MAX_RECURSION_DEPTH</code>.</p>
<p>The &lt;VALUE&gt; element represents the value of the MAX_RECURSION_DEPTH preference parameter. Valid values are integers from <code>1</code> to <code>32767</code>. The default is <code>16</code>. If the recursion level exceeds the value of this parameter, an exception is thrown.</p>
<p>See <a href="#CIHBEFJJ">Section 11.2.2.4</a> for more information about recursive constraint macros.</p>
</div>
<!-- class="sect3" -->
<a id="BEIDGHFH"></a>
<div id="IMDCM13774" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.5.7</span> Defining the SPECIFIC_CHARACTER_SET Preference Parameter</h4>
<p>The SPECIFIC_CHARACTER_SET preference parameter is used to specify the character set Oracle Multimedia DICOM uses to decode certain data elements (those with value representations of SH, LO, ST, LT, PN, and UT) when the standard attribute Specific Character Set is not specified. <a href="#BEIIBHHA">Example 11-42</a> shows how to define this preference parameter in a preference document.</p>
<div id="IMDCM13775" class="example">
<p class="titleinexample"><a id="BEIIBHHA"></a>Example 11-42 Definition of the SPECIFIC_CHARACTER_SET Preference Parameter</p>
<pre>  &lt;PREFERENCE_DEF&gt;
    &lt;PARAMETER&gt;SPECIFIC_CHARACTER_SET&lt;/PARAMETER&gt;
    &lt;DESCRIPTION&gt;
      Use the ASCII character set to decode data elements SH (Short String), 
      LO (Long String), ST (Short Text), LT (Long Text), PN (Person Name), 
      and UT (Unlimited Text) when the Specific Character Set Attribute is
      missing.
    &lt;/DESCRIPTION&gt;
    &lt;VALUE&gt;ASCII&lt;/VALUE&gt;
  &lt;/PREFERENCE_DEF&gt;
</pre></div>
<!-- class="example" -->
<p>The &lt;PARAMETER&gt; element specifies the Oracle-defined preference parameter <code>SPECIFIC_CHARACTER_SET</code>.</p>
<p>The &lt;VALUE&gt; element represents the value of the SPECIFIC_CHARACTER_SET preference parameter. Valid values are:</p>
<div class="inftblruleinformal">
<table class="cellalignment2223" summary="List of character sets" dir="ltr">
<thead>
<tr class="cellalignment2212">
<th class="cellalignment2219" id="r1c1-t22">Character Sets</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r2c1-t22" headers="r1c1-t22"><code>ASCII</code>(default value)</td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r3c1-t22" headers="r1c1-t22"><code>ISO_IR 100</code></td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r4c1-t22" headers="r1c1-t22"><code>ISO_IR 101</code></td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r5c1-t22" headers="r1c1-t22"><code>ISO_IR 109</code></td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r6c1-t22" headers="r1c1-t22"><code>ISO_IR 110</code></td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r7c1-t22" headers="r1c1-t22"><code>ISO_IR 144</code></td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r8c1-t22" headers="r1c1-t22"><code>ISO_IR 127</code></td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r9c1-t22" headers="r1c1-t22"><code>ISO_IR 126</code></td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r10c1-t22" headers="r1c1-t22"><code>ISO_IR 138</code></td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r11c1-t22" headers="r1c1-t22"><code>ISO_IR 148</code></td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r12c1-t22" headers="r1c1-t22"><code>ISO_IR 13</code></td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r13c1-t22" headers="r1c1-t22"><code>ISO_IR 166</code></td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r14c1-t22" headers="r1c1-t22"><code>ISO_IR 192</code></td>
</tr>
<tr class="cellalignment2212">
<td class="cellalignment2220" id="r15c1-t22" headers="r1c1-t22"><code>GB18030</code></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>The value of this preference parameter determines how data elements with value representations of SH (Short String), LO (Long String), ST (Short Text) LT (Long Text), PN (Person Name), and UT (Unlimited Text) are decoded when the standard attribute <code>Specific Character Set (0008,0005)</code> is missing. The DICOM standard mandates using the default character set <code>ISO-IR 6</code> or <code>ASCII</code> for decoding when the standard attribute <code>Specific Character Set</code> is not specified. This preference parameter enables applications to specify a character set other than the DICOM standard default character set in these cases.</p>
</div>
<!-- class="sect3" -->
<a id="BEIHHHGC"></a>
<div id="IMDCM13776" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.5.8</span> Defining the SQ_WRITE_LEN Preference Parameter</h4>
<p>The SQ_WRITE_LEN preference parameter is used to specify how the method writeMetadata( ) encodes DICOM sequence (SQ) types. <a href="#BEIBFGHJ">Example 11-43</a> shows how to define this preference parameter in a preference document.</p>
<div id="IMDCM13809" class="example">
<p class="titleinexample"><a id="BEIBFGHJ"></a>Example 11-43 Definition of the SQ_WRITE_LEN Preference Parameter</p>
<pre>  &lt;PREFERENCE_DEF&gt;
    &lt;PARAMETER&gt;SQ_WRITE_LEN&lt;/PARAMETER&gt;
    &lt;DESCRIPTION&gt;
      All sequence types are encoded in XML with an explicit length and 
      without sequence delimiters.
    &lt;/DESCRIPTION&gt;
    &lt;VALUE&gt;true&lt;/VALUE&gt;
  &lt;/PREFERENCE_DEF&gt;
</pre></div>
<!-- class="example" -->
<p>The &lt;PARAMETER&gt; element specifies the Oracle-defined preference parameter <code>SQ_WRITE_LEN</code>.</p>
<p>The &lt;VALUE&gt; element represents the value of the SQ_WRITE_LEN preference parameter, which is <code>true</code> by default.</p>
<p>The value of this preference parameter specifies how the DICOM sequence (SQ) types are encoded by the method writeMetadata( ). See the <a href="ch_dev_ref.htm#CHDCGJIJ">writeMetadata( )</a> method for more information.</p>
<p>If the value of this preference parameter is <code>true</code>, the SQ types are encoded with explicit lengths and without item or sequence delimiters. This default behavior enables DICOM viewers to skip the sequence attributes.</p>
<p>If the value is set to <code>false</code>, the SQ types are encoded with variable (undefined) lengths and terminated with sequence delimiters. This option enables backward compatibility with older DICOM viewers and DICOM applications that support only undefined lengths for SQ types.</p>
</div>
<!-- class="sect3" -->
<a id="BEIJIAJG"></a>
<div id="IMDCM13628" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.5.9</span> Defining the VALIDATE_METADATA Preference Parameter</h4>
<p>The VALIDATE_METADATA preference parameter is used to specify whether to validate XML documents that are used in DICOM functions and procedures. <a href="#CIHCJDED">Example 11-44</a> shows how to define this preference parameter in a preference document.</p>
<div id="IMDCM13810" class="example">
<p class="titleinexample"><a id="CIHCJDED"></a>Example 11-44 Definition of the VALIDATE_METADATA Preference Parameter</p>
<pre>  &lt;PREFERENCE_DEF&gt;
    &lt;PARAMETER&gt;VALIDATE_METADATA&lt;/PARAMETER&gt;
    &lt;DESCRIPTION&gt;
      Do not validate XML metadata documents.
    &lt;/DESCRIPTION&gt;
    &lt;VALUE&gt;false&lt;/VALUE&gt;
 &lt;/PREFERENCE_DEF&gt;
</pre></div>
<!-- class="example" -->
<p>The &lt;PARAMETER&gt; element specifies the Oracle-defined preference parameter <code>VALIDATE_METADATA</code>.</p>
<p>The &lt;VALUE&gt; element represents the value of the preference parameter VALIDATE_METADATA, which is <code>false</code> by default.</p>
<p>The value of this preference parameter determines whether to validate the XML documents used in the DICOM functions and procedures. All XML documents used in the DICOM functions and procedures, except those that are generated by the method extractMetadata( ), are validated against the Oracle default DICOM metadata schema. The XML documents generated by the method extractMetadata( ) are validated against the XML schema whose namespace is defined in the specified mapping document. See the <a href="ch_dev_ref.htm#CHDIJBDF">extractMetadata( )</a> method and <a href="#BGBBDCFD">Section 11.1.4</a> for more information.</p>
<p>If the value of this preference parameter is <code>false</code>, the XML documents are not validated.</p>
<p>If the value is set to <code>true</code>, the XML documents are validated against a specific XML schema that is registered with Oracle XML DB. However, if the metadata namespace in the mapping document is not available to the current user, invoking the extractMetadata( ) method with this value set to <code>true</code> raises an error.</p>
</div>
<!-- class="sect3" -->
<a id="BEIJIGCD"></a>
<div id="IMDCM13778" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.5.10</span> Defining the XML_SKIP_ATTR Preference Parameter</h4>
<p>The XML_SKIP_ATTR preference parameter is used to specify size limits for DICOM attributes to omit when encoding into XML. <a href="#BEIGABJC">Example 11-45</a> shows how to define this preference parameter in a preference document.</p>
<div id="IMDCM13779" class="example">
<p class="titleinexample"><a id="BEIGABJC"></a>Example 11-45 Definition of the XML_SKIP_ATTR Preference Parameter</p>
<pre>  &lt;PREFERENCE_DEF&gt;
    &lt;PARAMETER&gt;XML_SKIP_ATTR&lt;/PARAMETER&gt;
    &lt;DESCRIPTION&gt;
      When encoding DICOM attributes into XML, omit the DICOM attributes
      with sizes larger than 512 bytes.
    &lt;/DESCRIPTION&gt;
    &lt;VALUE&gt;512&lt;/VALUE&gt;
  &lt;/PREFERENCE_DEF&gt;
</pre></div>
<!-- class="example" -->
<p>The &lt;PARAMETER&gt; element specifies the Oracle-defined preference parameter <code>XML_SKIP_ATTR</code>.</p>
<p>The &lt;VALUE&gt; element represents the value of the XML_SKIP_ATTR preference parameter. Valid values are integers from <code>128</code> to <code>2</code><sup>32</sup><code>-1</code>. The default is <code>512</code>.</p>
<p>The value of this preference parameter is used to specify size limits for DICOM attributes to be omitted when encoding into XML. Omit DICOM attributes whose size (in bytes) in the DICOM content is larger than the value of this preference parameter. If an attribute of type SQ is omitted, its child items are also omitted.</p>
<p>In addition, the value of this preference parameter affects the following:</p>
<ul>
<li>
<p>The metadata generated by the method extractMetadata( ). See the <a href="ch_dev_ref.htm#CHDIJBDF">extractMetadata( )</a> method for more information.</p>
</li>
<li>
<p>The behavior of the setProperties( ) method. See the <a href="ch_dev_ref.htm#CHDCAEJH">setProperties( )</a> method for more information.</p>
</li>
</ul>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CIHHFHGC"></a>
<div id="IMDCM13494" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">11.2.6</span> Creating Private Dictionary Documents</h3>
<p>Private dictionary documents<a id="sthref867"></a> are XML documents that list the attributes defined by modality manufacturers or organizations other than the DICOM Standards Committee.</p>
<p>Private organizations or manufacturers of modalities can include attributes that are specific to their particular organizations in their DICOM content. These private attributes must be defined in a private dictionary document and stored in the data model repository to enable Oracle Multimedia to process metadata associated with the private attributes in the DICOM content.</p>
<p>The XML schema <code>ordcmpv.xsd</code> defines the XML schema that constrains private dictionary documents. (See <a href="ap_schemas.htm#BABEBCJJ">Appendix B</a> for more information about this schema.)</p>
<p>The default private dictionary document <code>ordcmpv.xml</code> lists the private attributes defined by Oracle. (See <a href="ap_confg_docs.htm#BEIECEEI">Appendix A</a> for more information about this configuration document.)</p>
<p>The XML schema <code>ordcmrdt.xsd</code> defines the DICOM standard data types and Oracle extensions to those data types, which are used by all other DICOM XML schemas. (See <a href="ap_schemas.htm#BABEBCJJ">Appendix B</a> for more information about this schema.)</p>
<p>The following subsections contain examples that show how to create private dictionary documents:</p>
<ul>
<li>
<p><a href="#BEIEGJGD">Defining Private Attributes</a></p>
</li>
<li>
<p><a href="#BEIHHGDA">Defining Attribute Definers</a></p>
</li>
<li>
<p><a href="#BEIGJIJD">Retiring Private Attributes</a></p>
</li>
</ul>
<a id="BEIEGJGD"></a>
<div id="IMDCM13495" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.6.1</span> Defining Private Attributes</h4>
<p>The private attribute definition in the private dictionary permits three types of attribute tags: simple tags, wildcard tags, and range tags. An attribute tag value consists of the group number followed by an element number.</p>
<p>A simple attribute tag is 4-byte hexadecimal number that consists of a group number followed by an element number (for example: <code>10871100</code>).</p>
<p>A wildcard attribute tag represents a set of hexadecimal numbers. It also consists of a group number followed by an element number, where portions of the value are replaced by the character <code>x</code> or <code>X</code> (for example: <code>1087xx00</code>).</p>
<p>A range attribute tag represents a range of hexadecimal numbers. It consists of two simple attribute tags that define a range of values. The starting range value must be less than the ending range value.</p>
<p>Each private attribute in the private dictionary document is represented by a &lt;PRIVATE_ATTRIBUTE_DEFINITION&gt; element.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Keep these additional guidelines in mind:
<ul>
<li>
<p>Do not use wildcard attribute tags within range attribute tags.</p>
</li>
<li>
<p>The definer name <code>&#34;DICOM&#34;</code> and the UID <code>&#34;1.2.840.10008.1&#34;</code> are reserved by Oracle to refer to DICOM standard attributes. Do not use them in private dictionaries.</p>
</li>
<li>
<p>Oracle recommends associating all DICOM private attributes in the DICOM content with a UID-qualified name.</p>
</li>
<li>
<p>The value of a tag-definer pair must be unique within the private dictionary document.</p>
</li>
</ul>
</div>
<p class="subhead2"><a id="IMDCM13496"></a>Defining a Private Attribute Using a Simple Attribute Tag</p>
<p><a href="#CIHJGHHC">Example 11-46</a> shows how to define a private attribute with a simple attribute tag. The XML statements where this action is defined are highlighted in bold.</p>
<div id="IMDCM13689" class="example">
<p class="titleinexample"><a id="CIHJGHHC"></a>Example 11-46 Definition of a Private Attribute with a Simple Attribute Tag</p>
<pre>&lt;PRIVATE_ATTRIBUTE_DEFINITION&gt;
<span class="bold">  &lt;TAG&gt;FFFF1001&lt;/TAG&gt;</span>
  &lt;NAME&gt;locator macro tag&lt;/NAME&gt;
  <span class="bold">&lt;DEFINER&gt;ORACLE&lt;/DEFINER&gt;</span>
  &lt;VR&gt;SQ&lt;/VR&gt;
  &lt;VM&gt;1&lt;/VM&gt;
 &lt;/PRIVATE_ATTRIBUTE_DEFINITION&gt;
</pre></div>
<!-- class="example" -->
<p>In <a href="#CIHJGHHC">Example 11-46</a>, the &lt;TAG&gt; element represents the hexadecimal value of the attribute tag <code>FFFF1001</code>. The &lt;NAME&gt; element represents the name of the organization defining the tag, <code>ORACLE</code>. The &lt;VR&gt; element represents the value representation of the attribute tag. The &lt;VR&gt; element is defined as type VR_T in the XML schema <code>ordcmrdt.xsd</code>. The &lt;VR&gt; element value must be one of the values that are listed for type &lt;VR_T&gt; in the XML schema <code>ordcmrdt.xsd</code>. The &lt;VM&gt; element represents the value multiplicity of the attribute tag. The &lt;VM&gt; element is defined as type VM_T in the XML schema <code>ordcmrdt.xsd</code>. The &lt;VM&gt; element value must be one of the values listed for type VM_T in the XML schema <code>ordcmrdt.xsd</code>. (See the type &lt;VR_T&gt; and the type &lt;VM_T&gt; listed in the XML schema <code>ordcmrdt.xsd</code> for more information about the value representation and value multiplicity data types supported by Oracle Multimedia DICOM.)</p>
<p class="subhead2"><a id="IMDCM13497"></a>Defining a Private Attribute Using a Wildcard Attribute Tag</p>
<p><a href="#CIHJFJAC">Example 11-47</a> shows how to define a private attribute with a wildcard attribute tag. The XML statements where this action is defined are highlighted in bold.</p>
<div id="IMDCM13690" class="example">
<p class="titleinexample"><a id="CIHJFJAC"></a>Example 11-47 Definition of a Private Attribute with a Wildcard Attribute Tag</p>
<pre>&lt;PRIVATE_ATTRIBUTE_DEFINITION&gt;
   <span class="bold">&lt;TAG&gt;0119XX00&lt;/TAG&gt;</span>
   &lt;NAME&gt;PRIVATE TAG1&lt;/NAME&gt;
   <span class="bold">&lt;DEFINER&gt;PRIVATE_ORG&lt;/DEFINER&gt;</span>
   &lt;VR&gt;IS&lt;/VR&gt;
   &lt;VM&gt;1&lt;/VM&gt;
&lt;/PRIVATE_ATTRIBUTE_DEFINITION&gt;
</pre></div>
<!-- class="example" -->
<p>In <a href="#CIHJFJAC">Example 11-47</a>, the private attribute definition contains the wildcard tag <code>0119XX00</code> and the definer name <code>PRIVATE_ORG</code>.</p>
<p class="subhead2"><a id="IMDCM13498"></a>Defining a Private Attribute Using a Range Attribute Tag</p>
<p><a href="#CIHECHHJ">Example 11-48</a> shows how to define a private attribute with a range attribute tag. The XML statements where this action is defined are highlighted in bold.</p>
<div id="IMDCM13691" class="example">
<p class="titleinexample"><a id="CIHECHHJ"></a>Example 11-48 Definition of a Private Attribute with a Range Attribute Tag</p>
<pre>&lt;PRIVATE_ATTRIBUTE_DEFINITION&gt;
   <span class="bold">&lt;TAG_RANGE&gt;</span>
     <span class="bold"> &lt;dt:STARTING_TAG&gt;A0110010&lt;/dt:STARTING_TAG&gt;</span>
      <span class="bold">&lt;dt:ENDING_TAG&gt;A01AAA10&lt;/dt:ENDING_TAG&gt;</span>
    <span class="bold">&lt;/TAG_RANGE&gt;</span>
   &lt;NAME&gt;Private Tag&lt;/NAME&gt;
   <span class="bold">&lt;DEFINER&gt;1.2.840.423&lt;/DEFINER&gt;</span>
   &lt;VR&gt;ST&lt;/VR&gt;
   &lt;VM&gt;1&lt;/VM&gt;
&lt;/PRIVATE_ATTRIBUTE_DEFINITION&gt;
</pre></div>
<!-- class="example" -->
<p>In <a href="#CIHECHHJ">Example 11-48</a>, the private attribute definition contains a range tag that specifies all tag ranges from <code>A0110010</code> to <code>A01AAA10</code>. The definer name <code>1.2.840.423</code> is a UID value.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
An attribute definition cannot match another attribute definition of the same tag-definer pair within a private dictionary document.</div>
<p>The following XML code segment shows an example of an attribute definition that is <span class="italic">not</span> permitted in the private dictionary:</p>
<pre>&lt;PRIVATE_ATTRIBUTE_DEFINITION&gt;
  &lt;TAG&gt;0119XX00&lt;/TAG&gt;
  &lt;NAME&gt;private tag&lt;/NAME&gt;
  &lt;DEFINER&gt;PRIVATE_ORG&lt;/DEFINER&gt;
.
.
.
 &lt;/PRIVATE_ATTRIBUTE_DEFINITION&gt;
 
&lt;PRIVATE_ATTRIBUTE_DEFINITION&gt;
  &lt;TAG&gt;01191100&lt;/TAG&gt;
  &lt;NAME&gt;private tag&lt;/NAME&gt;
  &lt;DEFINER&gt;PRIVATE_ORG&lt;/DEFINER&gt;
.
.
.
 &lt;/PRIVATE_ATTRIBUTE_DEFINITION&gt;
</pre>
<p>In the preceding code segment, the tag-definer pair (<code>01191100</code>, <code>PRIVATE_ORG</code>) matches the tag-definer pair (<code>0119XX00</code>, <code>PRIVATE_ORG</code>).</p>
</div>
<!-- class="sect3" -->
<a id="BEIHHGDA"></a>
<div id="IMDCM13499" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.6.2</span> Defining Attribute Definers</h4>
<p>An attribute definer refers to the definer name and UID of an organization defining private attributes.</p>
<p>The &lt;ATTRIBUTE_DEFINERS&gt; element is an optional element that represents all private definer names and definer UIDs used in a private dictionary document.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The definer name <code>&#34;DICOM&#34;</code> and the UID <code>&#34;1.2.840.10008.1&#34;</code> are reserved by Oracle to refer to DICOM standard attributes. Do not use them in private dictionaries.</div>
<p>The &lt;ATTRIBUTE_DEFINERS&gt; element is of type ATTR_DEFINERS_T. This type is defined in the XML schema <code>ordcmrdt.xsd</code>.</p>
<p><a href="#CIHDDJBC">Example 11-49</a> shows how to define the definer name and UID for an organization that defines private attributes:</p>
<div id="IMDCM13692" class="example">
<p class="titleinexample"><a id="CIHDDJBC"></a>Example 11-49 Definition of an Attribute Definer</p>
<pre>&lt;ATTRIBUTE_DEFINERS&gt;
  &lt;dt:ATTR_DEFINER&gt;
   &lt;dt:NAME&gt;1.2.1234.12345.123456.2.0&lt;/dt:NAME&gt;
   &lt;dt:UID&gt;1.2.1234.12345.123456.2.0&lt;/dt:UID&gt;
  &lt;/dt:ATTR_DEFINER&gt;
  &lt;dt:ATTR_DEFINER&gt;
   &lt;dt:NAME&gt;PRIVATE ORG&lt;/dt:NAME&gt;
   &lt;dt:UID&gt;1.2.123.1234&lt;/dt:UID&gt;
  &lt;/dt:ATTR_DEFINER&gt;
 &lt;/ATTRIBUTE_DEFINERS&gt;
</pre></div>
<!-- class="example" -->
<p>In <a href="#CIHDDJBC">Example 11-49</a>, the prefix <code>dt</code> is mapped to the namespace <code>http://xmlns.oracle.com/ord/dicom/datatype_1_0</code> where the &lt;ATTR_DEFINER&gt; element is defined. The value of the &lt;dt:NAME&gt; element represents the name of the private organization. The value of the &lt;dt:UID&gt; element represents the UID of the private organization.</p>
</div>
<!-- class="sect3" -->
<a id="BEIGJIJD"></a>
<div id="IMDCM13500" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.6.3</span> Retiring Private Attributes</h4>
<p>Private attributes included in private dictionary documents can be retired when they are no longer needed. <a href="#CIHHAHDJ">Example 11-50</a> shows how to define a private attribute as retired. The XML statement where this action is defined is highlighted in bold.</p>
<div id="IMDCM13693" class="example">
<p class="titleinexample"><a id="CIHHAHDJ"></a>Example 11-50 Definition of a Private Attribute as Retired</p>
<pre>&lt;PRIVATE_ATTRIBUTE_DEFINITION&gt;
   &lt;TAG&gt;01191100&lt;/TAG&gt;
   &lt;NAME&gt;locator macro tag&lt;/NAME&gt;
   &lt;DEFINER&gt;PRIVATE_ORG&lt;/DEFINER&gt;
   &lt;VR&gt;SQ&lt;/VR&gt;
   &lt;VM&gt;1&lt;/VM&gt;
   <span class="bold">&lt;RETIRED&gt;true&lt;/RETIRED&gt;</span>
&lt;/PRIVATE_ATTRIBUTE_DEFINITION&gt;
</pre></div>
<!-- class="example" -->
<p>In <a href="#CIHHAHDJ">Example 11-50</a>, for the &lt;RETIRED&gt; element, a value of <code>true</code> indicates that the attribute is retired and corresponds to the <code>RET</code> value used in the DICOM standard. Oracle recommends providing the &lt;VR&gt; and &lt;VM&gt; element values for a retired attribute to enable the metadata to be extracted from the DICOM content.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CIHGBBJB"></a>
<div id="IMDCM13489" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">11.2.7</span> Creating Standard Dictionary Documents</h3>
<p>Standard dictionary documents<a id="sthref868"></a> are XML representations of the data dictionary defined by the DICOM standard.</p>
<p>The XML schema <code>ordcmsd.xsd</code> defines the XML schema that constrains standard dictionary documents. (See <a href="ap_schemas.htm#BABEBCJJ">Appendix B</a> for more information about this schema. The text within the &lt;xs: annotation&gt; element includes a detailed description of the schema elements.)</p>
<p>The default standard dictionary document <code>ordcmsd.xml</code> is an XML representation of the data dictionary, as defined in Part 6 of the DICOM standard. (See <a href="ap_confg_docs.htm#BEIECEEI">Appendix A</a> for more information about this configuration document.)</p>
<p>The XML schema <code>ordcmrdt.xsd</code> defines the DICOM standard data types and Oracle extensions to those data types, which are used by all other DICOM XML schemas. (See <a href="ap_schemas.htm#BABEBCJJ">Appendix B</a> for more information about this schema.)</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Standard dictionary documents must not include any other attributes, such as attributes defined by manufacturers of modalities or organizations other than the DICOM Standards Committee.</div>
<p>Through the Oracle Technology Network, Oracle may release new standard dictionary documents along with installation instructions for DICOM administrators. These new standard dictionary documents reflect new releases of, or addendums to, the DICOM standard.</p>
<p>The following subsections contain examples that show how to create standard dictionary documents:</p>
<ul>
<li>
<p><a href="#BEIHFCJD">Defining Standard Attributes</a></p>
</li>
<li>
<p><a href="#BEIBHIED">Retiring Standard Attributes</a></p>
</li>
</ul>
<a id="BEIHFCJD"></a>
<div id="IMDCM13490" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.7.1</span> Defining Standard Attributes</h4>
<p>The standard attribute definition in the standard dictionary permits two types of attribute tags: simple tags and wildcard tags. An attribute tag value consists of the group number followed by an element number.</p>
<p>A simple attribute tag is 4-byte hexadecimal number that consists of a group number followed by an element number (for example: <code>10871100</code>).</p>
<p>A wildcard attribute tag represents a set of hexadecimal numbers. It also consists of a group number followed by an element number, where portions of the value are replaced by the character <code>x</code> or <code>X</code> (for example: <code>1087xx00</code>).</p>
<p>Each standard attribute in the standard dictionary document is represented by a &lt;STANDARD_ATTRIBUTE_DEFINITION&gt; element. Each standard attribute listed in the XML document corresponds to a related tag that is defined in Part 6 of the DICOM standard.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The definer name <code>&#34;DICOM&#34;</code> and the UID <code>&#34;1.2.840.10008.1&#34;</code> are reserved by Oracle to refer to DICOM standard attributes.</div>
<p class="subhead2"><a id="IMDCM13491"></a>Defining a Standard Attribute Using a Simple Attribute Tag</p>
<p><a href="#CIHBFDGH">Example 11-51</a> shows how to define a standard attribute with a simple attribute tag. The XML statements where this action is defined are highlighted in bold.</p>
<div id="IMDCM13686" class="example">
<p class="titleinexample"><a id="CIHBFDGH"></a>Example 11-51 Definition of a Standard Attribute with a Simple Attribute Tag</p>
<pre>&lt;STANDARD_ATTRIBUTE_DEFINITION&gt;
   <span class="bold">&lt;TAG&gt;00080008&lt;/TAG&gt;</span>
   <span class="bold">&lt;NAME&gt;Image Type&lt;/NAME&gt;</span>
   &lt;VR&gt;CS&lt;/VR&gt;
   &lt;VM&gt;1-n&lt;/VM&gt;
&lt;/STANDARD_ATTRIBUTE_DEFINITION&gt;
</pre></div>
<!-- class="example" -->
<p>In <a href="#CIHBFDGH">Example 11-51</a>, the &lt;TAG&gt; element represents the hexadecimal value of the attribute tag <code>00080008</code>, which is defined by the DICOM standard. This attribute tag value consists of a group number, followed by an element number. The &lt;NAME&gt; element represents the name of the attribute tag that is defined by the DICOM standard. The &lt;VR&gt; element represents the value representation of the attribute tag that is defined by the DICOM standard. The &lt;VM&gt; element represents the value multiplicity of the attribute tag defined by the DICOM standard. (See the type &lt;VR_T&gt; and the type &lt;VM_T&gt; listed in the XML schema <code>ordcmrdt.xsd</code> for more information about the value representation and value multiplicity data types supported by Oracle Multimedia DICOM.)</p>
<p class="subhead2"><a id="IMDCM13492"></a>Defining a Standard Attribute Using a Wildcard Attribute Tag</p>
<p><a href="#CIHHBBGE">Example 11-52</a> shows how to define a standard attribute with a wildcard attribute tag. The XML statements where this action is defined are highlighted in bold.</p>
<div id="IMDCM13687" class="example">
<p class="titleinexample"><a id="CIHHBBGE"></a>Example 11-52 Definition of a Standard Attribute with a Wildcard Attribute Tag</p>
<pre>&lt;STANDARD_ATTRIBUTE_DEFINITION&gt;
   <span class="bold">&lt;TAG&gt;60xx0010&lt;/TAG&gt;</span>
   &lt;NAME&gt;Overlay Rows&lt;/NAME&gt;
   &lt;VR&gt;US&lt;/VR&gt;
   &lt;VM&gt;1&lt;/VM&gt;
&lt;/STANDARD_ATTRIBUTE_DEFINITION&gt;
</pre></div>
<!-- class="example" -->
<p>In <a href="#CIHHBBGE">Example 11-52</a>, the standard attribute definition contains the wildcard tag <code>60xx0010</code>.</p>
</div>
<!-- class="sect3" -->
<a id="BEIBHIED"></a>
<div id="IMDCM13493" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.7.2</span> Retiring Standard Attributes</h4>
<p>Standard attributes included in the standard dictionary document are retired in the DICOM standard when they are no longer needed. <a href="#CIHDGBDG">Example 11-53</a> shows the definition of a standard attribute as retired. The XML statement where this action is defined is highlighted in bold.</p>
<div id="IMDCM13688" class="example">
<p class="titleinexample"><a id="CIHDGBDG"></a>Example 11-53 Definition of a Standard Attribute As Retired</p>
<pre>&lt;STANDARD_ATTRIBUTE_DEFINITION&gt;
   &lt;TAG&gt;00080010&lt;/TAG&gt;
   &lt;NAME&gt;Recognition Code&lt;/NAME&gt;
   &lt;VR&gt;CS&lt;/VR&gt;
   &lt;VM&gt;1&lt;/VM&gt;
   <span class="bold">&lt;RETIRED&gt;true&lt;/RETIRED&gt;</span>
&lt;/STANDARD_ATTRIBUTE_DEFINITION&gt;
</pre></div>
<!-- class="example" -->
<p>In <a href="#CIHDGBDG">Example 11-53</a>, for the &lt;RETIRED&gt; element a value of <code>true</code> indicates that the attribute is retired and corresponds to the <code>RET</code> value used in the DICOM standard. Oracle recommends providing the &lt;VR&gt; and &lt;VM&gt; element values for a retired attribute to enable the metadata to be extracted from the DICOM content.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CIHDAAAG"></a>
<div id="IMDCM13630" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">11.2.8</span> Creating Stored Tag List Documents</h3>
<p>Stored tag list documents<a id="sthref869"></a> specify the DICOM attributes to be extracted from the embedded DICOM content and stored in the XML metadata attribute of the ORDDicom object when the setProperties( ) method is called. The XML schema <code>ordcmstl.xsd</code> defines the XML schema that constrains stored tag list documents. (See <a href="ap_schemas.htm#BABEBCJJ">Appendix B</a> for more information about this schema.)</p>
<p>Generally, stored tag list documents contain the attribute tags used in mapping and constraint documents. Each attribute tag value in a stored tag list document is defined by an &lt;ATTRIBUTE_TAG&gt; element.</p>
<p>Oracle recommends using the <a href="ch_adm_ref.htm#CHEJJBJE">generateTagListDocument( ) Function</a> to create a stored tag list document. For example, a stored tag list might include some tags shown in the following code segment:</p>
<pre>&lt;ATTRIBUTE_TAG&gt;00080008[3]&lt;/ATTRIBUTE_TAG&gt;
&lt;ATTRIBUTE_TAG&gt;00081155(DICOM)&lt;/ATTRIBUTE_TAG&gt;
&lt;ATTRIBUTE_TAG&gt;00082112.00081150&lt;/ATTRIBUTE_TAG&gt;
&lt;ATTRIBUTE_TAG&gt;00082112.0040A170.00080104&lt;/ATTRIBUTE_TAG&gt;
&lt;ATTRIBUTE_TAG&gt;0040A730.0040A123[1]#PersonName&lt;/ATTRIBUTE_TAG&gt;
&lt;ATTRIBUTE_TAG&gt;0040A730[2].0040A160&lt;/ATTRIBUTE_TAG&gt;
</pre>
<p>See <a href="ch_adm_repos.htm#CHDEGHBF">Section 12.4</a> for examples of generating and inserting stored tag list documents into the repository. See <a href="ch_gen_over.htm#CHDJGADI">Section 3.2.10</a> for information about using a stored tag list to extract specific attributes from DICOM content.</p>
</div>
<!-- class="sect2" -->
<a id="CIHDAFGF"></a>
<div id="IMDCM13503" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">11.2.9</span> Creating UID Definition Documents</h3>
<p>UID definition documents are XML representations of the unique identifiers (UIDs) defined by the DICOM standard. The UID definitions are used by Oracle Multimedia DICOM to parse the DICOM content.<a id="sthref870"></a></p>
<p>The XML schema <code>ordcmui.xsd</code> defines the XML schema that constrains UID definition documents. (See <a href="ap_schemas.htm#BABEBCJJ">Appendix B</a> for more information about this schema. The text within the &lt;xs: annotation&gt; element includes a detailed description of the attributes used in the schema.)</p>
<p>The default UID definition document <code>ordcmui.xml</code> includes the UIDs listed in Part 6 of the DICOM standard.</p>
<p>Within a UID definition document, a &lt;UID_DEF&gt; element is used to define each UID definition.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Keep these additional guidelines in mind:
<ul>
<li>
<p>A maximum of two (one Oracle-defined and one user-defined) UID definition documents are permitted in the repository.</p>
</li>
<li>
<p>Changes in user-defined UID definition documents must be limited to updates in the DICOM standard or additions of new UID values. See Part 5 of the DICOM standard for more information about creating privately defined unique identifiers.</p>
</li>
<li>
<p>Existing UIDs defined by the DICOM standard can be changed <span class="italic">only</span> to include updates in the DICOM standard.</p>
</li>
</ul>
</div>
<p>The following subsections contain examples that show how to create UID definitions in UID definition documents:</p>
<ul>
<li>
<p><a href="#BEIEIEFC">Defining UID Definitions</a></p>
</li>
<li>
<p><a href="#BEIHFIIH">Retiring UID Definitions</a></p>
</li>
</ul>
<a id="BEIEIEFC"></a>
<div id="IMDCM13504" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.9.1</span> Defining UID Definitions</h4>
<p><a href="#CIHCFDBE">Example 11-54</a> shows how to define a storage class UID definition. The XML statements where this action is defined are highlighted in bold.</p>
<div id="IMDCM13696" class="example">
<p class="titleinexample"><a id="CIHCFDBE"></a>Example 11-54 Definition of a Storage Class UID Definition</p>
<pre> <span class="bold">&lt;UID_DEF classification=&#34;storageClass&#34; contentType=&#34;image&#34;&gt;</span>
    <span class="bold">&lt;UID&gt;1.2.840.10008.5.1.4.1.1.2&lt;/UID&gt;</span>
    <span class="bold">&lt;NAME&gt;CT Image Storage&lt;/NAME&gt;</span>
  &lt;/UID_DEF&gt;
</pre></div>
<!-- class="example" -->
<p>In <a href="#CIHCFDBE">Example 11-54</a>, the &lt;UID&gt; element value <code>1.2.840.10008.5.1.4.1.1.2</code> represents a UID value that is defined by the DICOM standard. The &lt;NAME&gt; element value <code>CT Image Storage</code> represents the UID name that is defined by the DICOM standard. The value of the <code>classification</code> attribute <code>&#34;storageClass&#34;</code> in the &lt;UID_DEF&gt; element corresponds to the UID type SOP Class defined by the DICOM standard. The value of the <code>contentType</code> attribute <code>&#34;image&#34;</code> indicates that the DICOM content contains pixel data.</p>
</div>
<!-- class="sect3" -->
<a id="BEIHFIIH"></a>
<div id="IMDCM13505" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">11.2.9.2</span> Retiring UID Definitions</h4>
<p><a href="#CIHGBEHA">Example 11-55</a> shows how to define a UID definition for transfer syntax as retired. The XML statements where this action is defined are highlighted in bold.</p>
<div id="IMDCM13697" class="example">
<p class="titleinexample"><a id="CIHGBEHA"></a>Example 11-55 Definition of a UID Definition as Retired</p>
<pre> <span class="bold">&lt;UID_DEF classification=&#34;transferSyntax&#34; isCompressed=&#34;true&#34; isEVR=&#34;true&#34;</span>
          <span class="bold">isLE=&#34;true&#34; retired=&#34;true&#34;&gt;</span>
    <span class="bold">&lt;UID&gt;1.2.840.10008.1.2.4.52&lt;/UID&gt;</span>
    <span class="bold">&lt;NAME&gt;JPEG Extended (Process 3 and 5) (Retired)&lt;/NAME&gt;</span>
  &lt;/UID_DEF&gt;
</pre></div>
<!-- class="example" -->
<p>In <a href="#CIHGBEHA">Example 11-55</a>, the &lt;UID&gt; element value <code>1.2.840.10008.1.2.4.52</code> represents a UID value that is defined by the DICOM standard. The &lt;NAME&gt; element value <code>JPEG Extended (Process 3 and 5) (Retired)</code> represents the UID name that is defined by the DICOM standard. The value of the <code>classification</code> attribute <code>&#34;transferSyntax&#34;</code> corresponds to the UID type Transfer Syntax defined by the DICOM standard. The values of the attributes <code>isCompressed</code>, <code>isEVR</code> (explicit VR), and <code>isLE</code> (little endian) are derived from the transfer syntax definitions listed in Part 5 of the DICOM standard. The value of the <code>retired</code> attribute <code>&#34;true&#34;</code> indicates that this UID definition is retired.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2211">
<tr>
<td class="cellalignment2220">
<table class="cellalignment2216">
<tr>
<td class="cellalignment2215"><a href="ch_adm_over.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2215"><a href="ch_adm_repos.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2007, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2222">
<table class="cellalignment2214">
<tr>
<td class="cellalignment2215"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2215"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2215"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2215"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2215"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2215"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>