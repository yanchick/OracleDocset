<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-74423"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Statement%20Functions"></a><title>Statement Functions</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="description" content="Lists and describes the statement functions."/>
<meta name="keywords" content="OCIStmtExecute(), OCI_DESCRIBE_ONLY, OCIStmtFetch2(), cursor cancellation, canceling a cursor, OCIStmtGetNextResult (), OCIStmtGetPieceInfo(), OCIStmtPrepare2(), OCI_FOREIGN_SYNTAX, OCIStmtRelease(), OCIStmtSetPieceInfo()"/>
<meta name="dcterms.created" content="2017-06-09T09:07:30Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Call Interface Programmer&#39;s Guide"/>
<meta name="dcterms.identifier" content="E49886-11"/>
<meta name="dcterms.isVersionOf" content="LNOCI"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="oci17msc.htm" title="Previous" type="text/html"/>
<link rel="Next" href="oci17msc002.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E49886-11.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-7C0AF073-7870-4866-BBC9-D2BF3D8E5CCE"></a> <span id="PAGE" style="display:none;">28/84</span> <!-- End Header -->
<a id="LNOCI17162"></a><a id="LNOCI161"></a>
<h1 id="LNOCI-GUID-7C0AF073-7870-4866-BBC9-D2BF3D8E5CCE" class="sect1">Statement Functions</h1>
<div>
<p>Lists and describes the statement functions.</p>
<div class="section">
<p><a href="oci17msc001.htm#GUID-7C0AF073-7870-4866-BBC9-D2BF3D8E5CCE__CIHEFHCE" title="This table has 2 columns. Column 1 is the OCI function name and column 2 describes its purpose.">Table 17-1</a> lists the statement functions that are described in this section. Use functions that end in &#34;2&#34; for all new applications.</p>
</div>
<!-- class="section" -->
<div class="tblformalwide" id="GUID-7C0AF073-7870-4866-BBC9-D2BF3D8E5CCE__CIHEFHCE">
<p class="titleintable">Table 17-1 Statement Functions &nbsp;</p>
<table class="cellalignment6157" title="Statement Functions &nbsp;" summary="This table has 2 columns. Column 1 is the OCI function name and column 2 describes its purpose.">
<thead>
<tr class="cellalignment6151">
<th class="cellalignment6247" id="d184233e165">Function</th>
<th class="cellalignment6186" id="d184233e168">Purpose</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment6151">
<td class="cellalignment6248" id="d184233e173" headers="d184233e165">
<p><a href="oci17msc001.htm#GUID-98B26708-3E02-45C0-8258-5D5544F32BE9" title="Associates an application request with a server.">OCIStmtExecute()</a></p>
</td>
<td class="cellalignment6189" headers="d184233e173 d184233e168">
<p>Send statements to server for execution</p>
</td>
</tr>
<tr class="cellalignment6151">
<td class="cellalignment6248" id="d184233e184" headers="d184233e165">
<p><a href="oci17msc001.htm#GUID-DF585B90-58BA-45FC-B7CE-6F7F987C03B9" title="Fetches a row from the (scrollable) result set.">OCIStmtFetch2()</a></p>
</td>
<td class="cellalignment6189" headers="d184233e184 d184233e168">
<p>Fetch rows from a query and fetches a row from the (scrollable) result set</p>
</td>
</tr>
<tr class="cellalignment6151">
<td class="cellalignment6248" id="d184233e195" headers="d184233e165">
<p><a href="oci17msc001.htm#GUID-60B998F9-F213-43BA-AB84-76F1EC6A6687">OCIStmtGetNextResult()</a></p>
</td>
<td class="cellalignment6189" headers="d184233e195 d184233e168">
<p>Returns the implicit results from an executed PL/SQL statement handle</p>
</td>
</tr>
<tr class="cellalignment6151">
<td class="cellalignment6248" id="d184233e203" headers="d184233e165">
<p><a href="oci17msc001.htm#GUID-3D9B5C7B-E2A1-485D-852C-2434F303EC11" title="Returns piece information for a piecewise operation.">OCIStmtGetPieceInfo()</a></p>
</td>
<td class="cellalignment6189" headers="d184233e203 d184233e168">
<p>Get piece information for piecewise operations</p>
</td>
</tr>
<tr class="cellalignment6151">
<td class="cellalignment6248" id="d184233e214" headers="d184233e165">
<p><a href="oci17msc001.htm#GUID-E6C1DC67-D464-4D2A-9F19-737423D31779" title="Prepares a SQL or PL/SQL statement for execution.">OCIStmtPrepare2()</a></p>
</td>
<td class="cellalignment6189" headers="d184233e214 d184233e168">
<p>Prepare a SQL or PL/SQL statement for execution. The user also has the option of using the statement cache, if it has been enabled.</p>
</td>
</tr>
<tr class="cellalignment6151">
<td class="cellalignment6248" id="d184233e225" headers="d184233e165">
<p><a href="oci17msc001.htm#GUID-256034CE-2ADB-4BE5-BC8D-748307F2EA8E" title="Releases the statement handle obtained by a call to OCIStmtPrepare2().">OCIStmtRelease()</a></p>
</td>
<td class="cellalignment6189" headers="d184233e225 d184233e168">
<p>Release the statement handle</p>
</td>
</tr>
<tr class="cellalignment6151">
<td class="cellalignment6248" id="d184233e239" headers="d184233e165">
<p><a href="oci17msc001.htm#GUID-CDB6F3E3-0FB6-49A7-A8AE-83CD330A359F" title="Sets piece information for a piecewise operation.">OCIStmtSetPieceInfo()</a></p>
</td>
<td class="cellalignment6189" headers="d184233e239 d184233e168">
<p>Set piece information for piecewise operations</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
<a id="LNOCI17163"></a>
<div class="props_rev_3"><a id="GUID-98B26708-3E02-45C0-8258-5D5544F32BE9"></a>
<h2 id="LNOCI-GUID-98B26708-3E02-45C0-8258-5D5544F32BE9" class="sect2">OCIStmtExecute()</h2>
<div>
<p>Associates an application request with a server.</p>
<div class="section">
<p class="subhead2">Purpose</p>
<p>Associates an application request with a server.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Syntax</p>
<pre dir="ltr">sword OCIStmtExecute ( OCISvcCtx           *svchp,
                       OCIStmt             *stmtp,
                       OCIError            *errhp,
                       ub4                  iters,
                       ub4                  rowoff,
                       const OCISnapshot   *snap_in,
                       OCISnapshot         *snap_out,
                       ub4                  mode );
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Parameters</p>
<dl>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74374"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-98B26708-3E02-45C0-8258-5D5544F32BE9__GUID-94B22E59-0266-4CDC-A815-CB3892BAE059"><!-- --></a><span class="bold">svchp</span> (IN/OUT)</dt>
<dd>
<p>Service context handle.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74375"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-98B26708-3E02-45C0-8258-5D5544F32BE9__GUID-98AB964C-E9A5-4BA3-A3AF-06C0348C4CA7"><!-- --></a><span class="bold">stmtp</span> (IN/OUT)</dt>
<dd>
<p>A statement handle. It defines the statement and the associated data to be executed at the server. It is invalid to pass in a statement handle that has bind of data types only supported in release 8.x or later, when <code class="codeph">svchp</code> points to an Oracle7 server.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74376"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-98B26708-3E02-45C0-8258-5D5544F32BE9__GUID-F8829107-3658-42E0-884B-AD5A04506BBE"><!-- --></a><span class="bold">errhp</span> (IN/OUT)</dt>
<dd>
<p>An error handle that you can pass to <code class="codeph">OCIErrorGet()</code> for diagnostic information, when there is an error.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74377"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-98B26708-3E02-45C0-8258-5D5544F32BE9__GUID-836A20FE-D220-4503-9C7C-5A8FA2291385"><!-- --></a><span class="bold">iters</span> (IN)</dt>
<dd>
<p>For non-<code class="codeph">SELECT</code> statements, the number of times this statement is executed equals <code class="codeph">iters</code> - <code class="codeph">rowoff</code>.</p>
<p>For <code class="codeph">SELECT</code> statements, if <code class="codeph">iters</code> is nonzero, then defines must have been done for the statement handle. The execution fetches <code class="codeph">iters</code> rows into these predefined buffers and prefetches more rows depending upon the prefetch row count. If you do not know how many rows the <code class="codeph">SELECT</code> statement retrieves, then set <code class="codeph">iters</code> to zero.</p>
<p>This function returns an error if <code class="codeph">iters</code>=0 for non-<code class="codeph">SELECT</code> statements.</p>
<div class="infobox-note" id="GUID-98B26708-3E02-45C0-8258-5D5544F32BE9__GUID-3B1D6C9A-63FB-4347-8E2F-A60DE285792B">
<p class="notep1">Note:</p>
<p>For array DML operations, set <code class="codeph">iters</code> &lt;= 32767 to get better performance.</p>
</div>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74378"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-98B26708-3E02-45C0-8258-5D5544F32BE9__GUID-7315C89B-0651-4F44-9408-B7773387F991"><!-- --></a><span class="bold">rowoff</span> (IN)</dt>
<dd>
<p>The starting index from which the data in an array bind is relevant for this multiple row execution.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74379"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-98B26708-3E02-45C0-8258-5D5544F32BE9__GUID-4B5E2290-79A4-4E4D-9F7C-73AEA3989F65"><!-- --></a><span class="bold">snap_in</span> (IN)</dt>
<dd>
<p>This parameter is optional. If it is supplied, then it must point to a snapshot descriptor of type <code class="codeph">OCI_DTYPE_SNAP</code>. The contents of this descriptor must be obtained from the <code class="codeph">snap_out</code> parameter of a previous call. The descriptor is ignored if the SQL is not a <code class="codeph">SELECT</code> statement. This facility allows multiple service contexts to Oracle Database to see the same consistent snapshot of the database&#39;s <span class="italic">committed</span> data. However, uncommitted data in one context is <span class="italic">not</span> visible to another context even using the same snapshot.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74380"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-98B26708-3E02-45C0-8258-5D5544F32BE9__GUID-FC43A8A0-8057-4965-880C-681F69CA5913"><!-- --></a><span class="bold">snap_out</span> (OUT)</dt>
<dd>
<p>This parameter is optional. If it is supplied, then it must point to a descriptor of type <code class="codeph">OCI_DTYPE_SNAP</code>. This descriptor is filled in with an opaque representation that is the current Oracle Database system change number (SCN) suitable as a <code class="codeph">snap_in</code> input to a subsequent call to <code class="codeph">OCIStmtExecute()</code>. To avoid &#34;snapshot too old&#34; errors, do not use this descriptor any longer than necessary.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74381"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-98B26708-3E02-45C0-8258-5D5544F32BE9__GUID-4C5AC6D6-8A44-4790-90FB-30AE3CF200FE"><!-- --></a><span class="bold">mode</span> (IN)</dt>
<dd>
<p>The modes are:</p>
</dd>
</dl>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">OCI_BATCH_ERRORS</code> - See <a href="oci04sql.htm#GUID-665D540E-9BD1-4505-9FB8-1EBD7C0DFB7D">Using Batch Error Mode</a> for information about this mode.</p>
</li>
<li>
<p><code class="codeph">OCI_COMMIT_ON_SUCCESS</code> - When a statement is executed in this mode, the current transaction is committed after execution, if execution completes successfully.</p>
</li>
<li>
<p><code class="codeph">OCI_DEFAULT</code> - Calling <code class="codeph">OCIStmtExecute()</code> in this mode executes the statement. It also implicitly returns describe information about the select list.</p>
</li>
<li>
<p><code class="codeph">OCI_DESCRIBE_ONLY</code> - This mode is for users who want to describe a query before execution. Calling <code class="codeph">OCIStmtExecute()</code> in this mode does not execute the statement, but it does return the select-list description. To maximize performance, Oracle recommends that applications execute the statement in default mode and use the implicit describe that accompanies the execution.</p>
</li>
<li>
<p><code class="codeph">OCI_EXACT_FETCH</code> - Used when the application knows in advance exactly how many rows it is fetching. This mode turns prefetching off for Oracle Database release 8 or later mode, and requires that defines be done before the execute call. Using this <code class="codeph">mode</code> cancels the cursor after the desired rows are fetched and may result in reduced server-side resource usage.</p>
</li>
<li>
<p><code class="codeph">OCI_PARSE_ONLY</code> - This mode allows the user to parse the query before execution. Executing in this mode parses the query and returns parse errors in the SQL, if any. Users must note that this involves an additional round-trip to the server. To maximize performance, Oracle recommends that the user execute the statement in the default mode, which, parses the statement as part of the bundled operation.</p>
</li>
<li>
<p><code class="codeph">OCI_STMT_SCROLLABLE_READONLY</code> - Required for the result set to be scrollable. The result set cannot be updated. See <a href="oci04sql.htm#GUID-E0EAF0A9-2C7D-468D-BF43-C9056F3497E6" title="If an OCI application has processed a query, it is typically necessary to fetch the results with OCIStmtFetch2() after the statement has completed execution.">About Fetching Results</a> for more information about this mode. This mode cannot be used with any other mode.</p>
<p><code class="codeph">OCI_RETURN_ROW_COUNT_ARRAY</code> - This mode allows the user to get DML rowcounts per iteration. It is an error to pass this mode for statements that are not DMLs. See <a href="ociaahan.htm#GUID-A251CF91-EB9F-4DBC-8BB8-FB5EA92C20DE">Statement Handle Attributes</a> for more information. This mode can be used along with <code class="codeph">OCI_BATCH_ERRORS</code>.</p>
</li>
</ul>
<p>The modes are not mutually exclusive; you can use them together, except for <code class="codeph">OCI_STMT_SCROLLABLE_READONLY</code>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Comments</p>
<p>This function is used to execute a prepared SQL statement. Using an execute call, the application associates a request with a server.</p>
<p>If a <code class="codeph">SELECT</code> statement is executed, then the description of the select list is available implicitly as a response. This description is buffered on the client side for describes, fetches, and define type conversions. Hence it is optimal to describe a select list only after an execute.</p>
<div class="infoboxnotealso" id="GUID-98B26708-3E02-45C0-8258-5D5544F32BE9__GUID-B173598A-DB6B-4D21-B3A7-A4347F02D1A9">
<p class="notep1">See Also:</p>
<p><a href="oci04sql.htm#GUID-DDB109DD-52EB-4AA8-A69A-34015F8D5D6E" title="If your OCI application is processing a query, you may need to obtain more information about the items in the select list.">About Describing Select-List Items</a></p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p>Also for <code class="codeph">SELECT</code> statements, some results are available implicitly. Rows are received and buffered at the end of the execute. For queries with small row count, a prefetch causes memory to be released in the server if the end of fetch is reached, an optimization that may result in memory usage reduction. The set attribute call has been defined to set the number of rows to be prefetched for each result set.</p>
<p>For <code class="codeph">SELECT</code> statements, at the end of the execute, the statement handle implicitly maintains a reference to the service context on which it is executed. It is the developer&#39;s responsibility to maintain the integrity of the service context. The implicit reference is maintained until the statement handle is freed or the fetch is canceled or an end of fetch condition is reached.</p>
<p>To reexecute a DDL statement, you must prepare the statement again using <code class="codeph">OCIStmtPrepare2()</code>.</p>
<div class="infobox-note" id="GUID-98B26708-3E02-45C0-8258-5D5544F32BE9__GUID-5BCECC04-5577-4EB5-97B0-984AAD8B4ED9">
<p class="notep1">Note:</p>
<p>If output variables are defined for a <code class="codeph">SELECT</code> statement before a call to <code class="codeph">OCIStmtExecute()</code>, the number of rows specified by <code class="codeph">iters</code> are fetched directly into the defined output buffers and additional rows equivalent to the prefetch count are prefetched. If there are no additional rows, then the fetch is complete without calling <a href="oci17msc001.htm#GUID-DF585B90-58BA-45FC-B7CE-6F7F987C03B9" title="Fetches a row from the (scrollable) result set.">OCIStmtFetch2()</a> or deprecated <a href="ociaedep002.htm#GUID-536D38A8-B463-48F8-8B91-FD3F2872AF85" title="This function was deprecated in a release previous to Oracle 11g R2 (11.2).">OCIStmtFetch()</a>.</p>
</div>
<div class="infoboxnotealso" id="GUID-98B26708-3E02-45C0-8258-5D5544F32BE9__GUID-1DC5636F-CB73-411B-888F-E559C5A18F56">
<p class="notep1">See Also:</p>
<p><a href="oci02bas.htm#GUID-83F4D3B1-56A7-4EEE-A905-BB84D399713D">Polling Mode Operations in OCI</a></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="LNOCI17165"></a>
<div class="props_rev_3"><a id="GUID-DF585B90-58BA-45FC-B7CE-6F7F987C03B9"></a>
<h2 id="LNOCI-GUID-DF585B90-58BA-45FC-B7CE-6F7F987C03B9" class="sect2">OCIStmtFetch2()</h2>
<div>
<p>Fetches a row from the (scrollable) result set.</p>
<div class="section">
<p class="subhead2">Purpose</p>
<p>Fetches a row from the (scrollable) result set. You are encouraged to use this fetch call instead of the deprecated call <code class="codeph">OCIStmtFetch()</code>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Syntax</p>
<pre dir="ltr">sword OCIStmtFetch2 ( OCIStmt     *stmthp,
                      OCIError    *errhp, 
                      ub4          nrows,
                      ub2          orientation,
                      sb4          fetchOffset,
                      ub4          mode );
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Parameters</p>
<dl>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74382"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-DF585B90-58BA-45FC-B7CE-6F7F987C03B9__GUID-2BAE1DEB-1219-4B15-86F1-D06F3097D733"><!-- --></a>stmthp (IN/OUT)</dt>
<dd>
<p>This is the statement handle of the (scrollable) result set.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74383"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-DF585B90-58BA-45FC-B7CE-6F7F987C03B9__GUID-E71C8D72-ADCC-434C-A52F-4C0F6D225A82"><!-- --></a>errhp (IN/OUT)</dt>
<dd>
<p>An error handle that you can pass to <code class="codeph">OCIErrorGet()</code> for diagnostic information if an error occurs.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74384"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-DF585B90-58BA-45FC-B7CE-6F7F987C03B9__GUID-C942FE05-D723-4DBE-9251-21273BB63856"><!-- --></a>nrows (IN)</dt>
<dd>
<p>Number of rows to be fetched from the current position.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74385"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-DF585B90-58BA-45FC-B7CE-6F7F987C03B9__GUID-0C72A0AC-E6DD-4A4B-B7E5-F386A0887A15"><!-- --></a>orientation (IN)</dt>
<dd>
<p>The acceptable values are:</p>
</dd>
</dl>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">OCI_DEFAULT</code> - Has the same effect as <code class="codeph">OCI_FETCH_NEXT</code></p>
</li>
<li>
<p><code class="codeph">OCI_FETCH_CURRENT</code> - Gets the current row.</p>
</li>
<li>
<p><code class="codeph">OCI_FETCH_NEXT</code> - Gets the next row from the current position. It is the default (has the same effect as <code class="codeph">OCI_DEFAULT</code>). Use for a nonscrollable statement handle.</p>
</li>
<li>
<p><code class="codeph">OCI_FETCH_FIRST</code> - Gets the first row in the result set.</p>
</li>
<li>
<p><code class="codeph">OCI_FETCH_LAST</code> - Gets the last row in the result set.</p>
</li>
<li>
<p><code class="codeph">OCI_FETCH_PRIOR</code> - Positions the result set on the previous row from the current row in the result set. You can fetch multiple rows using this mode, from the &#34;previous row&#34; also.</p>
</li>
<li>
<p><code class="codeph">OCI_FETCH_ABSOLUTE</code> - Fetches the row number (specified by <code class="codeph">fetchOffset</code> parameter) in the result set using absolute positioning.</p>
</li>
<li>
<p><code class="codeph">OCI_FETCH_RELATIVE</code> - Fetches the row number (specified by <code class="codeph">fetchOffset</code> parameter) in the result set using relative positioning.</p>
</li>
</ul>
<dl>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74386"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-DF585B90-58BA-45FC-B7CE-6F7F987C03B9__GUID-E00D197E-A7FF-40A8-A321-67A0B0DCE09B"><!-- --></a>fetchOffset (IN)</dt>
<dd>
<p>The offset to be used with the orientation parameter for changing the current row position.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74387"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-DF585B90-58BA-45FC-B7CE-6F7F987C03B9__GUID-329DA0E7-8053-4D1E-B443-47E00893EB07"><!-- --></a>mode (IN)</dt>
<dd>
<p>Pass in <code class="codeph">OCI_DEFAULT</code>.</p>
</dd>
</dl>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Comments</p>
<p>The fetch call works similarly to the deprecated <code class="codeph">OCIStmtFetch()</code> call, but with the addition of the <code class="codeph">fetchOffset</code> parameter. It can be used on any statement handle, whether it is scrollable or not. For a <span class="italic">nonscrollable statement handle</span>, the only acceptable value of <code class="codeph">orientation</code> is <code class="codeph">OCI_FETCH_NEXT</code>, and the <code class="codeph">fetchOffset</code> parameter is ignored.</p>
<p>For new applications you are encouraged to use this call, <code class="codeph">OCIStmtFetch2()</code>.</p>
<p>A <code class="codeph">fetchOffset</code> with <code class="codeph">orientation</code> set to <code class="codeph">OCI_FETCH_RELATIVE</code> is equivalent to all of the following:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">OCI_FETCH_CURRENT</code> with a value of <code class="codeph">fetchOffset</code> equal to 0</p>
</li>
<li>
<p><code class="codeph">OCI_FETCH_NEXT</code> with a value of <code class="codeph">fetchOffset</code> equal to 1</p>
</li>
<li>
<p><code class="codeph">OCI_FETCH_PRIOR</code> with a value of <code class="codeph">fetchOffset</code> equal to -1</p>
</li>
</ul>
<p><code class="codeph">OCI_ATTR_UB8_ROW_COUNT</code> contains the highest absolute row value that was fetched.</p>
<p>All other orientation modes besides <code class="codeph">OCI_FETCH_ABSOLUTE</code> and <code class="codeph">OCI_FETCH_RELATIVE</code> ignore the <code class="codeph">fetchOffset</code> value.</p>
<p>This call can also be used to determine the number of rows in the result set by using <code class="codeph">OCI_FETCH_LAST</code> and then calling <code class="codeph">OCIAttrGet()</code> on <code class="codeph">OCI_ATTR_CURRENT_POSITION</code>. But the response time of this call can be high. If <code class="codeph">nrows</code> is set to be greater than 1 with <code class="codeph">OCI_FETCH_LAST</code> orientation, nrows is considered to be 1.</p>
<p>The return codes are the same as for deprecated <code class="codeph">OCIStmtFetch()</code>, except that <code class="codeph">OER(1403)</code> with return code <code class="codeph">OCI_NO_DATA</code> is returned every time a fetch on a scrollable statement handle (or execute) is made and not all rows requested by the application could be fetched.</p>
<p>If you call <code class="codeph">OCIStmtFetch2()</code> with the <code class="codeph">nrows</code> parameter set to 0, this cancels the cursor.</p>
<p>The scrollable statement handle must be explicitly canceled (that is, fetch with 0 rows) or freed to release server-side resources for the scrollable cursor. A nonscrollable statement handle is implicitly canceled on receiving the <code class="codeph">OER(1403)</code>.</p>
<p>Use <code class="codeph">OCI_ATTR_ROWS_FETCHED</code> to find the number of rows that were successfully fetched into the user&#39;s buffers in the last fetch call.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="LNOCI72808"></a>
<div class="props_rev_3"><a id="GUID-60B998F9-F213-43BA-AB84-76F1EC6A6687"></a>
<h2 id="LNOCI-GUID-60B998F9-F213-43BA-AB84-76F1EC6A6687" class="sect2">OCIStmtGetNextResult()</h2>
<div>
<div class="section">
<p class="subhead2">Purpose</p>
<p>Returns the implicit results from an executed PL/SQL statement handle.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Syntax</p>
<pre dir="ltr">sword OCIStmtGetNextResult (OCIStmt   *stmthp,
                            OCIError  *errhp,
                            void     **result,
                            ub4       *rtype,
                            ub4        mode)
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Parameters</p>
<dl>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74388"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-60B998F9-F213-43BA-AB84-76F1EC6A6687__GUID-C9AA5F24-D793-46C2-A1D6-912391704690"><!-- --></a>stmthp (IN)</dt>
<dd>
<p>The executed statement handle.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74389"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-60B998F9-F213-43BA-AB84-76F1EC6A6687__GUID-6A4DF194-B480-4558-8A64-9E7994D352B9"><!-- --></a>errhp (IN)</dt>
<dd>
<p>An error handle that you can pass to <a href="oci17msc007.htm#GUID-4B99087C-74F6-498A-8310-D6645172390A" title="Returns an error message and an Oracle Database error code.">OCIErrorGet()</a> for diagnostic information when there is an error.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74390"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-60B998F9-F213-43BA-AB84-76F1EC6A6687__GUID-42FC2674-0AA9-4106-AC6F-4F63A2D029B3"><!-- --></a>result (OUT)</dt>
<dd>
<p>The next implicit result from the executed PL/SQL statement.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74391"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-60B998F9-F213-43BA-AB84-76F1EC6A6687__GUID-1DEDE130-65A6-4013-98D8-164C549CC5EA"><!-- --></a>rtype (OUT)</dt>
<dd>
<p>The type of the implicit result. The only possible value is <code class="codeph">OCI_RESULT_TYPE_SELECT</code>.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74392"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-60B998F9-F213-43BA-AB84-76F1EC6A6687__GUID-9847E2DB-4812-408E-B807-519980F9C04F"><!-- --></a>mode (IN)</dt>
<dd>
<p>The only possible value is <code class="codeph">OCI_DEFAULT</code> (default mode).</p>
</dd>
</dl>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Comments</p>
<p>Each call to <code class="codeph">OCIStmtGetNextResult()</code> retrieves a single implicit result in the order in which they were returned from the PL/SQL procedure or block. If no more results are available, then <code class="codeph">OCI_NO_DATA</code> is returned. If <code class="codeph">rtype</code> is <code class="codeph">OCI_RESULT_TYPE_SELECT</code>, then the returned result can be cast as an OCI statement handle, and is allocated by OCI. Applications can do normal OCI define and fetch calls to fetch rows from the implicit result sets. The returned OCI statement handle cannot be freed explicitly. All implicit result sets are automatically closed and freed when the top-level statement handle is freed or released.</p>
<p>See <span class="q">&#34;<a href="ociaahan.htm#GUID-A251CF91-EB9F-4DBC-8BB8-FB5EA92C20DE__CACCDJFH">OCI_ATTR_IMPLICIT_RESULT_COUNT</a>&#34;</span> for information about this statement handle attribute, which returns the total number of implicit results available on the top-level OCI statement handle.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Returns</p>
<p>Returns one of the following:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">OCI_ERROR</code></p>
</li>
<li>
<p><code class="codeph">OCI_SUCCESS</code></p>
</li>
<li>
<p><code class="codeph">OCI_NO_DATA</code> - When all implicit result sets have been retrieved from the top-level statement handle</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Related Functions</p>
</div>
<!-- class="section" --></div>
</div>
<a id="LNOCI17166"></a>
<div class="props_rev_3"><a id="GUID-3D9B5C7B-E2A1-485D-852C-2434F303EC11"></a>
<h2 id="LNOCI-GUID-3D9B5C7B-E2A1-485D-852C-2434F303EC11" class="sect2">OCIStmtGetPieceInfo()</h2>
<div>
<p>Returns piece information for a piecewise operation.</p>
<div class="section">
<p class="subhead2">Purpose</p>
<p>Returns piece information for a piecewise operation.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Syntax</p>
<pre dir="ltr">sword OCIStmtGetPieceInfo( const OCIStmt  *stmtp,
                           OCIError       *errhp,
                           void          **hndlpp,
                           ub4            *typep,
                           ub1            *in_outp,
                           ub4            *iterp, 
                           ub4            *idxp,
                           ub1            *piecep );
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Parameters</p>
<dl>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74393"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-3D9B5C7B-E2A1-485D-852C-2434F303EC11__GUID-A015D550-5FEF-4D80-A006-1861FF5AAA29"><!-- --></a><span class="bold">stmtp</span> (IN)</dt>
<dd>
<p>The statement that when executed returned <code class="codeph">OCI_NEED_DATA</code>.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74394"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-3D9B5C7B-E2A1-485D-852C-2434F303EC11__GUID-1D76B139-7F03-46F6-8227-9FD8C76C971E"><!-- --></a><span class="bold">errhp</span> (OUT)</dt>
<dd>
<p>An error handle that you can pass to <code class="codeph">OCIErrorGet()</code> for diagnostic information when there is an error.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74395"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-3D9B5C7B-E2A1-485D-852C-2434F303EC11__GUID-A377D040-3B91-43CB-BFF5-45FF3F73684C"><!-- --></a><span class="bold">hndlpp</span> (OUT)</dt>
<dd>
<p>Returns a pointer to the bind or define handle of the bind or define whose run-time data is required or is being provided.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74396"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-3D9B5C7B-E2A1-485D-852C-2434F303EC11__GUID-99330842-72B2-410A-A3C0-D2392CA1398D"><!-- --></a><span class="bold">typep</span> (OUT)</dt>
<dd>
<p>The type of the handle pointed to by <code class="codeph">hndlpp</code>: <code class="codeph">OCI_HTYPE_BIND</code> (for a bind handle) or <code class="codeph">OCI_HTYPE_DEFINE</code> (for a define handle).</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74397"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-3D9B5C7B-E2A1-485D-852C-2434F303EC11__GUID-3A1632D7-FA25-4765-9FAB-BE3BC56BAFFC"><!-- --></a><span class="bold">in_outp</span> (OUT)</dt>
<dd>
<p>Returns <code class="codeph">OCI_PARAM_IN</code> if the data is required for an IN bind value. Returns <code class="codeph">OCI_PARAM_OUT</code> if the data is available as an OUT bind variable or a define position value.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74398"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-3D9B5C7B-E2A1-485D-852C-2434F303EC11__GUID-AAC10373-C712-43F8-9BA4-05D63ABCEFE6"><!-- --></a><span class="bold">iterp</span> (OUT)</dt>
<dd>
<p>Returns the row number of a multiple row operation.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74399"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-3D9B5C7B-E2A1-485D-852C-2434F303EC11__GUID-57517BE6-F242-49F4-ABA9-E0A9FAC98FE0"><!-- --></a><span class="bold">idxp</span> (OUT)</dt>
<dd>
<p>The index of an array element of a PL/SQL array bind operation.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74400"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-3D9B5C7B-E2A1-485D-852C-2434F303EC11__GUID-F94E85BD-C17D-4903-9263-288701D9B367"><!-- --></a><span class="bold">piecep</span> (OUT)</dt>
<dd>
<p>Returns one of these defined values: <code class="codeph">OCI_ONE_PIECE</code>, <code class="codeph">OCI_FIRST_PIECE</code>, <code class="codeph">OCI_NEXT_PIECE</code>, or <code class="codeph">OCI_LAST_PIECE</code>.</p>
</dd>
</dl>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Comments</p>
<p>When an execute or fetch call returns <code class="codeph">OCI_NEED_DATA</code> to get or return a dynamic bind, define value, or piece, <code class="codeph">OCIStmtGetPieceInfo()</code> returns the relevant information: bind or define handle, iteration, index number, and which piece.</p>
<div class="infoboxnotealso" id="GUID-3D9B5C7B-E2A1-485D-852C-2434F303EC11__GUID-80964251-91F7-4D45-9103-419A02D250CA">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="oci05bnd.htm#GUID-6C5EA0C6-0C1D-4CD5-B47F-1B95B4E9C558" title="You can use OCI to perform piecewise inserts, updates, and fetches of data.">Runtime Data Allocation and Piecewise Operations in OCI</a> for more information about using <code class="codeph">OCIStmtGetPieceInfo()</code></p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="LNOCI17168"></a>
<div class="props_rev_3"><a id="GUID-E6C1DC67-D464-4D2A-9F19-737423D31779"></a>
<h2 id="LNOCI-GUID-E6C1DC67-D464-4D2A-9F19-737423D31779" class="sect2">OCIStmtPrepare2()</h2>
<div>
<p>Prepares a SQL or PL/SQL statement for execution.</p>
<div class="section">
<p class="subhead2">Purpose</p>
<p>Prepares a SQL or PL/SQL statement for execution. The user has the option of using the statement cache, if it has been enabled.</p>
<p>Oracle strongly encourages use of <code class="codeph">OCIStmtPrepare2()</code> in all OCI applications instead of the deprecated call <code class="codeph">OCIStmtPrepare()</code>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Syntax</p>
<pre dir="ltr">sword OCIStmtPrepare2 ( OCISvcCtx      *svchp,
                        OCIStmt       **stmthp,
                        OCIError       *errhp,
                        const OraText  *stmttext,
                        ub4             stmt_len,
                        const OraText  *key,
                        ub4             keylen,
                        ub4             language,
                        ub4             mode );
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Parameters</p>
<dl>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74401"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-E6C1DC67-D464-4D2A-9F19-737423D31779__GUID-9CC645EA-E62B-42DB-9977-FDDE0E3AB1CB"><!-- --></a>svchp (IN)</dt>
<dd>
<p>The service context to be associated with the statement.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74402"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-E6C1DC67-D464-4D2A-9F19-737423D31779__GUID-FE4E97C7-7C50-4FE0-8797-C5AA2839F475"><!-- --></a>stmthp (OUT)</dt>
<dd>
<p>Pointer to the statement handle returned.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74403"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-E6C1DC67-D464-4D2A-9F19-737423D31779__GUID-F4B1D72C-138F-4E54-BA43-C6A09F61F2C4"><!-- --></a>errhp (IN)</dt>
<dd>
<p>A pointer to the error handle for diagnostics.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74404"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-E6C1DC67-D464-4D2A-9F19-737423D31779__GUID-D61993BF-02D2-40CD-91E6-1E3496FEB631"><!-- --></a>stmttext (IN)</dt>
<dd>
<p>The statement text. The semantics of the <code class="codeph">stmttext</code> are same as those of <code class="codeph">OCIStmtPrepare()</code>; that is, the string must be <code class="codeph">NULL</code>-terminated.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74405"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-E6C1DC67-D464-4D2A-9F19-737423D31779__GUID-2F7C215F-4D1F-4149-A409-556E99DC0E57"><!-- --></a>stmt_len (IN)</dt>
<dd>
<p>The statement text length.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74406"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-E6C1DC67-D464-4D2A-9F19-737423D31779__GUID-AA495DEF-2F55-4B52-B987-9BCC8F162073"><!-- --></a>key (IN)</dt>
<dd>
<p>For statement caching only. The key to be used for searching the statement in the statement cache. If the key is passed in, then the statement text and other parameters are ignored and the search is solely based on the key.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74407"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-E6C1DC67-D464-4D2A-9F19-737423D31779__GUID-34F62C41-4342-4AF1-93D8-946FB4E1DFA5"><!-- --></a>keylen (IN)</dt>
<dd>
<p>For statement caching only. The length of the key.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74408"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-E6C1DC67-D464-4D2A-9F19-737423D31779__GUID-2F23A7AB-DD2E-43D3-89A4-C821F1BBE285"><!-- --></a>language (IN)</dt>
<dd>
<div class="p">Specifies V7, or native syntax. Possible values are as follows:
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">OCI_V7_SYNTAX</code> - V7 ORACLE parsing syntax.</p>
</li>
<li>
<p><code class="codeph">OCI_NTV_SYNTAX</code> - Syntax depends upon the version of the server.</p>
<p><code class="codeph">OCI_FOREIGN_SYNTAX</code> - Specifies the statement to be translated according to the SQL translation profile set in the session.</p>
</li>
</ul>
</div>
</dd>
</dl>
<dl>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74409"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-E6C1DC67-D464-4D2A-9F19-737423D31779__GUID-E66C61D8-4FFB-4360-9493-E7C4E44D92D7"><!-- --></a>mode (IN)</dt>
<dd>
<p>This function can be used with and without statement caching. This is determined at the time of connection or session pool creation. If caching is enabled for a session, then all statements in the session have caching enabled, and if caching is not enabled, then all statements are not cached.</p>
<div class="p">The valid modes are as follows:
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">OCI_DEFAULT</code> - Caching is not enabled. If the statement is not found in the cache, this mode allocates a new statement handle and prepares the statement handle for execution. If the statement is not found in the cache and one of the following circumstances applies, then the subsequent actions follow:</p>
<ul style="list-style-type: disc;">
<li>
<p>Only the text has been supplied: a new statement is allocated and prepared and returned. The tag <code class="codeph">NULL</code>. <code class="codeph">OCI_SUCCESS</code> is returned.</p>
</li>
<li>
<p>Only the tag has been supplied: <code class="codeph">stmthp</code> is <code class="codeph">NULL</code>. <code class="codeph">OCI_ERROR</code> is returned.</p>
</li>
<li>
<p>Both text and key were supplied: a new statement is allocated and prepared and returned. The tag <code class="codeph">NULL</code>. <code class="codeph">OCI_SUCCESS_WITH_INFO</code> is returned, as the returned statement differs from the requested statement in that the tag is <code class="codeph">NULL</code>.</p>
</li>
</ul>
</li>
<li>
<p><code class="codeph">OCI_PREP2_CACHE_SEARCHONLY</code> - In this case, if the statement is not found (a <code class="codeph">NULL</code> statement handle is returned), you must take further action. If the statement is found, <code class="codeph">OCI_SUCCESS</code> is returned. Otherwise, <code class="codeph">OCI_ERROR</code> is returned.</p>
</li>
<li>
<p><code class="codeph">OCI_PREP2_GET_PLSQL_WARNINGS</code> - If warnings are enabled in the session and the PL/SQL program is compiled with warnings, then <code class="codeph">OCI_SUCCESS_WITH_INFO</code> is the return status from the execution. Use <code class="codeph">OCIErrorGet()</code> to find the new error number corresponding to the warnings.</p>
</li>
<li>
<p><code class="codeph">OCI_PREP2_IMPL_RESULTS_CLIENT</code> - The mode should be passed as <code class="codeph">OCI_PREP2_IMPL_RESULTS_CLIENT</code> when this call is made in an external procedure and implicit results need to be processed. See <a href="oci10new.htm#GUID-F5BF8851-F491-4EF8-BA20-B6146AF2700F" title="Beginning with Oracle Database 12c Release 1 (12.1) , PL/SQL can return results (cursors) implicitly from stored procedures and anonymous PL/SQL blocks. OCIStmtGetNextResult() is provided to retrieve and process the implicit results.">OCI Support for Implicit Results</a> for more details.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<!-- class="section" --></div>
</div>
<a id="LNOCI17169"></a>
<div class="props_rev_3"><a id="GUID-256034CE-2ADB-4BE5-BC8D-748307F2EA8E"></a>
<h2 id="LNOCI-GUID-256034CE-2ADB-4BE5-BC8D-748307F2EA8E" class="sect2">OCIStmtRelease()</h2>
<div>
<p>Releases the statement handle obtained by a call to <code class="codeph">OCIStmtPrepare2()</code>.</p>
<div class="section">
<p class="subhead2">Purpose</p>
<p>Releases the statement handle obtained by a call to <code class="codeph">OCIStmtPrepare2()</code>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Syntax</p>
<pre dir="ltr">sword OCIStmtRelease ( OCIStmt        *stmthp,  
                       OCIError       *errhp,
                       const OraText  *key,
                       ub4             keylen,
                       ub4             mode );  
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Parameters</p>
<dl>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74410"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-256034CE-2ADB-4BE5-BC8D-748307F2EA8E__GUID-072C1C9E-7EB9-4391-82BA-37A702D2D450"><!-- --></a>stmthp (IN/OUT)</dt>
<dd>
<p>The statement handle returned by <code class="codeph">OCIStmtPrepare2()</code>.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74411"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-256034CE-2ADB-4BE5-BC8D-748307F2EA8E__GUID-D86B2A53-EE7B-4D20-843B-2A704CFC8640"><!-- --></a>errhp (IN)</dt>
<dd>
<p>The error handle used for diagnostics.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74412"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-256034CE-2ADB-4BE5-BC8D-748307F2EA8E__GUID-B4676628-F568-41FC-9E16-DE512B5BD892"><!-- --></a>key (IN)</dt>
<dd>
<p>Only valid for statement caching. The key to be associated with the statement in the cache. This is a SQL string passed in by the caller. If a <code class="codeph">NULL</code> key is passed in, the statement is not tagged.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74413"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-256034CE-2ADB-4BE5-BC8D-748307F2EA8E__GUID-A637BC2F-7F1E-492F-A00F-E7E060DF10D2"><!-- --></a>keylen (IN)</dt>
<dd>
<p>Only valid for statement caching. The length of the key.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74414"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-256034CE-2ADB-4BE5-BC8D-748307F2EA8E__GUID-D06B03DB-F513-4157-A58A-3F057EA59E3F"><!-- --></a>mode (IN)</dt>
<dd>
<p>The valid modes are:</p>
</dd>
</dl>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">OCI_DEFAULT</code></p>
</li>
<li>
<p><code class="codeph">OCI_STRLS_CACHE_DELETE</code> - Only valid for statement caching. The statement is not kept in the cache anymore.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="LNOCI17170"></a>
<div class="props_rev_3"><a id="GUID-CDB6F3E3-0FB6-49A7-A8AE-83CD330A359F"></a>
<h2 id="LNOCI-GUID-CDB6F3E3-0FB6-49A7-A8AE-83CD330A359F" class="sect2">OCIStmtSetPieceInfo()</h2>
<div>
<p>Sets piece information for a piecewise operation.</p>
<div class="section">
<p class="subhead2">Purpose</p>
<p>Sets piece information for a piecewise operation.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Syntax</p>
<pre dir="ltr">sword OCIStmtSetPieceInfo ( void              *hndlp,
                            ub4                type,
                            OCIError          *errhp,
                            const void        *bufp,
                            ub4               *alenp, 
                            ub1                piece,
                            const void        *indp, 
                            ub2               *rcodep ); 
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Parameters</p>
<dl>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74415"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-CDB6F3E3-0FB6-49A7-A8AE-83CD330A359F__GUID-7B7BCA48-9683-4A65-86E4-608CC204F01E"><!-- --></a>hndlp (IN/OUT)</dt>
<dd>
<p>The bind or define handle.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74416"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-CDB6F3E3-0FB6-49A7-A8AE-83CD330A359F__GUID-65BFB57C-98C4-4FC7-B0E4-D376F29A6281"><!-- --></a>type (IN)</dt>
<dd>
<p>Type of the handle.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74417"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-CDB6F3E3-0FB6-49A7-A8AE-83CD330A359F__GUID-1BCDB916-2486-4B05-9E38-0257B27B34A5"><!-- --></a>errhp (OUT)</dt>
<dd>
<p>An error handle that you can pass to <code class="codeph">OCIErrorGet()</code> for diagnostic information when there is an error.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74418"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-CDB6F3E3-0FB6-49A7-A8AE-83CD330A359F__GUID-DFAD8D6C-2F81-40A2-BFC7-160C79410C64"><!-- --></a>bufp (IN/OUT)</dt>
<dd>
<p>A pointer to storage containing the data value or the piece when it is an IN bind variable; otherwise, <code class="codeph">bufp</code> is a pointer to storage for getting a piece or a value for OUT binds and define variables. For named data types or <code class="codeph">REF</code>s, a pointer to the object or <code class="codeph">REF</code> is returned.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74419"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-CDB6F3E3-0FB6-49A7-A8AE-83CD330A359F__GUID-4223FECC-D6EC-4915-BA8C-6BCA3D29E0A1"><!-- --></a>alenp (IN/OUT)</dt>
<dd>
<p>The length of the piece or the value. Do not change this parameter between executions of the same SQL statement.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74420"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-CDB6F3E3-0FB6-49A7-A8AE-83CD330A359F__GUID-04DF683B-CC22-40E6-BD22-14F46564A668"><!-- --></a>piece (IN)</dt>
<dd>
<p>The piece parameter. Valid values are:</p>
</dd>
</dl>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">OCI_ONE_PIECE</code></p>
</li>
<li>
<p><code class="codeph">OCI_FIRST_PIECE</code></p>
</li>
<li>
<p><code class="codeph">OCI_NEXT_PIECE</code></p>
</li>
<li>
<p><code class="codeph">OCI_LAST_PIECE</code></p>
</li>
</ul>
<p>This parameter is used for IN bind variables only.</p>
<dl>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74421"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-CDB6F3E3-0FB6-49A7-A8AE-83CD330A359F__GUID-F4397FB0-4867-432B-A68A-877AEB1F5AC4"><!-- --></a>indp (IN/OUT)</dt>
<dd>
<p>Indicator. A pointer to an <code class="codeph">sb2</code> value or pointer to an indicator structure for named data types (SQLT_NTY) and <code class="codeph">REF</code>s (SQLT_REF), that is, depending upon the data type, <code class="codeph">*indp</code> is either an <code class="codeph">sb2</code> or a <code class="codeph">void</code> *.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-74422"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-CDB6F3E3-0FB6-49A7-A8AE-83CD330A359F__GUID-4E4F62B8-0C80-4740-A9D2-42B284D7FDE5"><!-- --></a>rcodep (IN/OUT)</dt>
<dd>
<p>Return code.</p>
</dd>
</dl>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Comments</p>
<p>When an execute call returns <code class="codeph">OCI_NEED_DATA</code> to get a dynamic IN/OUT bind value or piece, <code class="codeph">OCIStmtSetPieceInfo()</code> sets the piece information: the buffer, the length, which piece is currently being processed, the indicator, and the return code for this column.</p>
<div class="infoboxnotealso" id="GUID-CDB6F3E3-0FB6-49A7-A8AE-83CD330A359F__GUID-DC609D41-CC01-46BF-890C-68E392E9B456">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="oci05bnd.htm#GUID-6C5EA0C6-0C1D-4CD5-B47F-1B95B4E9C558" title="You can use OCI to perform piecewise inserts, updates, and fetches of data.">Runtime Data Allocation and Piecewise Operations in OCI</a> for more information about using <code class="codeph">OCIStmtSetPieceInfo()</code></p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment6150">
<tr>
<td class="cellalignment6162">
<table class="cellalignment6155">
<tr>
<td class="cellalignment6154"><a href="oci17msc.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment6154"><a href="oci17msc002.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment6164">
<table class="cellalignment6153">
<tr>
<td class="cellalignment6154"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment6154"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment6154"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment6154"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment6154"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment6154"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>