<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-3915"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Overview%20of%20the%20Multitenant%20Architecture"></a><title>Overview of the Multitenant Architecture</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="containers, CDB, PDBs, containers, CDBs, root container, root, data dictionary, upgrades, database, object links, in CDBs, object links, metadata links, in CDBs, metadata links, container data objects, storage in a CDB, common users, users, database, common, local users, roles, local, local role, local rules, local roles, privileges, granting common, granting privileges to, common roles, granting, common privilege grants, auditing, audit policies, common objects, audit configurations, files"/>
<meta name="dcterms.created" content="2017-07-10T11:33:29Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Concepts"/>
<meta name="dcterms.identifier" content="E41396-15"/>
<meta name="dcterms.isVersionOf" content="CNCPT"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1993, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="cdbovrvw.htm" title="Previous" type="text/html"/>
<link rel="Next" href="part_admdev.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41396-15.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-7F629DD8-D4DE-4FD7-9C35-38AC016DDCDC"></a> <span id="PAGE" style="display:none;">28/34</span> <!-- End Header -->
<script>
//<![CDATA[
window.name='cdblogic'
//]]>
</script> <script>
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" lang="en-us" ><head><title>');
   
    msg.document.write('Footnote&amp;nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('');
    msg.document.write('<style> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]\u003e <\/style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
</script><noscript>
<p>The script content on this page is for navigation purposes only and does not alter the content in any way.</p>
</noscript><a id="CNCPT89248"></a>
<h1 id="CNCPT-GUID-7F629DD8-D4DE-4FD7-9C35-38AC016DDCDC" class="sect1"><span class="enumeration_chapter">18</span> Overview of the Multitenant Architecture</h1>
<div>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="cdblogic.htm#GUID-5C339A60-2163-4ECE-B7A9-4D67D3D894FB" title="A container is a collection of schemas, objects, and related structures in a multitenant container database (CDB) that appears logically to an application as a separate database. Within a CDB, each container has a unique ID and name.">Overview of Containers in a CDB</a></p>
</li>
<li>
<p><a href="cdblogic.htm#GUID-5660AC5E-BFD4-41BE-8404-C31870FE4D48" title="Clients must connect to PDBs using services. A connection using a service name starts a new session in a PDB. A foreground process, and therefore a session, at every moment of its lifetime, has a uniquely defined current container.">Overview of Services in a CDB</a></p>
</li>
<li>
<p><a href="cdblogic.htm#GUID-B8A0393D-EB92-4020-81EA-7773EE60330C" title="Every user that owns objects that define the database is common. User-created users are either local or common. A common user is a database user that has the same identity in the root and in every existing and future PDB. Every common user can connect to and perform operations within the root, and within any PDB in which it has privileges.A local user is a database user that is not common and can operate only within a single PDB.A local role exists only in a single PDB, just as a role in a non-CDB exists only in the non-CDB. A local role can only contain roles and privileges that apply within the container in which the role exists.In a CDB, every act of granting, whether local or common, occurs within a specific container. Roles and privileges may be granted locally to users and roles regardless of whether the grantees, grantors, or roles being granted are local or common.A user or role may be locally granted a privilege (CONTAINER=CURRENT). Privileges and common roles may be granted commonly.In a CDB, PUBLIC is a common role. In a PDB, privileges granted locally to PUBLIC enable all local and common user account to exercise these privileges in this PDB only.In this scenario, SYSTEM creates common user c##dba and tries to give this user privileges to query a table in the hr schema in hrpdb. For both mixed mode and unified auditing, a common audit configuration is visible and enforced across all PDBs.">Overview of Commonality in a CDB</a></p>
</li>
<li>
<p><a href="cdblogic.htm#GUID-5902ABDC-40BE-4CF4-9917-A5D7F4C396F1" title="A CDB has the same structure as a non-CDB, except that each PDB and application root has its own set of tablespaces, including its own SYSTEM, SYSAUX, and undo tablespaces.">Overview of Database Files in a CDB</a></p>
</li>
</ul>
</div>
<a id="CNCPT89249"></a>
<div class="props_rev_3"><a id="GUID-5C339A60-2163-4ECE-B7A9-4D67D3D894FB"></a>
<h2 id="CNCPT-GUID-5C339A60-2163-4ECE-B7A9-4D67D3D894FB" class="sect2">Overview of Containers in a CDB</h2>
<div>
<p>A <span class="bold">container</span> is a collection of schemas, objects, and related structures in a <span class="bold">multitenant container database (CDB)</span> that appears logically to an application as a separate database. Within a CDB, each container has a unique ID and name.</p>
<p>The root and every <a href="glossary.htm#GUID-15825EC2-B512-4FD1-A734-AE4DAB3B3AEC"><span class="xrefglossterm">pluggable database (PDB)</span></a> is considered a container. PDBs isolate data and operations so that from the perspective of a user or application, each PDB appears as if it were a traditional non-CDB.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="cdblogic.htm#GUID-4311CC75-87D3-4548-A7CE-11FE5141C9E3" title="The root container, also called the root, is a collection of schemas, schema objects, and nonschema objects to which all PDBs belong. Every CDB has one and only one root container, named CDB$ROOT, which stores the system metadata required to manage PDBs. All PDBs belong to the root.">The Root</a></p>
</li>
<li>
<p><a href="cdblogic.htm#GUID-49C0C90D-5A72-4131-8C3D-B07341C75CB2">PDBs</a></p>
</li>
<li>
<p><a href="cdblogic.htm#GUID-A356382A-413A-4A42-98DC-6C2464808202" title="From the user and application perspective, the data dictionary in each container in a CDB is separate, as it would be in a non-CDB.">Data Dictionary Architecture in a CDB</a></p>
</li>
<li>
<p><a href="cdblogic.htm#GUID-2278B77D-9D81-46A8-9F57-6F5F8B96964C">Current Container</a></p>
</li>
<li>
<p><a href="cdblogic.htm#GUID-05B15BE7-D8CD-4D8C-A33F-38C1BB09D893">Cross-Container Operations</a></p>
</li>
</ul>
</div>
<a id="CNCPT89250"></a>
<div class="props_rev_3"><a id="GUID-4311CC75-87D3-4548-A7CE-11FE5141C9E3"></a>
<h3 id="CNCPT-GUID-4311CC75-87D3-4548-A7CE-11FE5141C9E3" class="sect3">The Root</h3>
<div>
<p>The <span class="bold">root container</span>, also called <span class="italic">the root</span>, is a collection of schemas, schema objects, and nonschema objects to which all PDBs belong. Every CDB has one and only one root container, named <code class="codeph">CDB$ROOT</code>, which stores the system metadata required to manage PDBs. All PDBs belong to the root.</p>
<p>The root does not store user data. Thus, you must not add user data to the root or modify system-supplied schemas in the root. However, you can create common users and roles for database administration (see <span class="q">&#34;<a href="cdblogic.htm#GUID-19337B94-645B-45E8-842C-762BBC544B13" title="A common user is a database user that has the same identity in the root and in every existing and future PDB. Every common user can connect to and perform operations within the root, and within any PDB in which it has privileges.">Common Users in a CDB</a>&#34;</span>). A common user with the necessary privileges can switch between PDBs.</p>
<div class="infoboxnotealso" id="GUID-4311CC75-87D3-4548-A7CE-11FE5141C9E3__GUID-05C78509-1FE1-40AF-A8C2-B7ABFC24C922">
<p class="notep1">See Also:</p>
<p><a class="olink ADMIN13507" target="_blank" href="../ADMIN/cdb_intro.htm#ADMIN13507"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a></p>
</div>
</div>
</div>
<a id="CNCPT89251"></a>
<div class="props_rev_3"><a id="GUID-49C0C90D-5A72-4131-8C3D-B07341C75CB2"></a>
<h3 id="CNCPT-GUID-49C0C90D-5A72-4131-8C3D-B07341C75CB2" class="sect3">PDBs</h3>
<div>
<p><a id="d83305e1104" class="indexterm-anchor"></a>A <a href="glossary.htm#GUID-D6932E25-775E-4FF1-BB08-F8999629093C"><span class="xrefglossterm">PDB</span></a> is a user-created set of schemas, objects, and related structures that appears logically to an application as a separate database. Every PDB is owned by <code class="codeph">SYS</code>, which is a common user in the CDB (see <span class="q">&#34;<a href="cdblogic.htm#GUID-19337B94-645B-45E8-842C-762BBC544B13" title="A common user is a database user that has the same identity in the root and in every existing and future PDB. Every common user can connect to and perform operations within the root, and within any PDB in which it has privileges.">Common Users in a CDB</a>&#34;</span>), regardless of which user created the PDB.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="cdblogic.htm#GUID-962835F2-3DD2-4D00-8817-2E63532E00AE">Purpose of PDBs</a></p>
</li>
<li>
<p><a href="cdblogic.htm#GUID-F3ECBB59-C43F-4C1D-93FC-80BDFE2233E6">Names for PDBs</a></p>
</li>
<li>
<p><a href="cdblogic.htm#GUID-6A7183B5-E0AA-47E1-992C-838FDF21C3D9">Scope for Names and Privileges in PDBs</a></p>
</li>
<li>
<p><a href="cdblogic.htm#GUID-C3B11701-F23A-4781-91EE-C907F0AF2527">Database Links Between PDBs</a></p>
</li>
</ul>
</div>
<a id="CNCPT89345"></a>
<div class="props_rev_3"><a id="GUID-962835F2-3DD2-4D00-8817-2E63532E00AE"></a>
<h4 id="CNCPT-GUID-962835F2-3DD2-4D00-8817-2E63532E00AE" class="sect4">Purpose of PDBs</h4>
<div>
<p><a id="d83305e1380" class="indexterm-anchor"></a>You can use PDBs to achieve the following goals:</p>
<ul style="list-style-type: disc;">
<li>
<p>Store data specific to a particular application</p>
<p>For example, a sales application can have its own dedicated PDB, and a human resources application can have its own dedicated PDB.</p>
</li>
<li>
<p>Move data into a different CDB</p>
<p>A database is &#34;pluggable&#34; because you can package it as a self-contained unit, and then move it into another CDB.</p>
</li>
<li>
<p>Isolate grants within PDBs</p>
<p>A local or common user with appropriate privileges can grant <code class="codeph">EXECUTE</code> privileges on a package to <code class="codeph">PUBLIC</code> within an individual PDB.</p>
</li>
</ul>
</div>
</div>
<a id="CNCPT89395"></a>
<div class="props_rev_3"><a id="GUID-F3ECBB59-C43F-4C1D-93FC-80BDFE2233E6"></a>
<h4 id="CNCPT-GUID-F3ECBB59-C43F-4C1D-93FC-80BDFE2233E6" class="sect4">Names for PDBs</h4>
<div>
<p>PDBs must be uniquely named within a CDB, and follow the same naming rules as service names. Moreover, because a PDB has a service with its own name, a PDB name must be unique across all CDBs whose services are exposed through a specific listener.</p>
<p>The first character of a user-created PDB name must be alphanumeric, with remaining characters either alphanumeric or an underscore (<code class="codeph">_</code>). Because service names are case-insensitive, PDB names are case-insensitive, and are in upper case even if specified using delimited identifiers.</p>
<div class="infoboxnotealso" id="GUID-F3ECBB59-C43F-4C1D-93FC-80BDFE2233E6__GUID-3D4E8984-289C-4E86-A8A4-D4B5F513C78A">
<p class="notep1">See Also:</p>
<p><a class="olink NETRF175" target="_blank" href="../NETRF/syntax.htm#NETRF175"><span class="italic">Oracle Database Net Services Reference</span></a> for the rules for service names</p>
</div>
</div>
</div>
<a id="CNCPT89396"></a>
<div class="props_rev_3"><a id="GUID-6A7183B5-E0AA-47E1-992C-838FDF21C3D9"></a>
<h4 id="CNCPT-GUID-6A7183B5-E0AA-47E1-992C-838FDF21C3D9" class="sect4">Scope for Names and Privileges in PDBs</h4>
<div>
<p>PDBs have separate namespaces, which has implications for the following structures:</p>
<ul style="list-style-type: disc;">
<li>
<p>Schemas</p>
<p>A schema contained in one PDB may have the same name as a schema in a different PDB. These two schemas may represent distinct local users, distinguished by the PDB in which the user name is resolved at connect time, or a common user (see <span class="q">&#34;<a href="cdblogic.htm#GUID-3BB161DA-9CC0-4D61-A2C1-5D3662E0DECF" title="Every user that owns objects that define the database is common. User-created users are either local or common.">Overview of Common and Local Users in a CDB</a>&#34;</span>).</p>
</li>
<li>
<p>Objects</p>
<p>An object must be uniquely named within a PDB, not across all containers in the CDB. This is true both of schema objects and nonschema objects. Identically named database objects and other dictionary objects contained in different PDBs are distinct from one another.</p>
<p>An Oracle Database directory is an example of a nonschema object. In a CDB, common user <code class="codeph">SYS</code> owns directories. Because each PDB has its own <code class="codeph">SYS</code> schema, directories belong to a PDB by being created in the <code class="codeph">SYS</code> schema of the PDB.</p>
</li>
</ul>
<p>During name resolution, the database consults only the data dictionary of the container to which the user is connected. This behavior applies to object names, the <code class="codeph">PUBLIC</code> schema, and schema names.</p>
</div>
</div>
<a id="CNCPT89253"></a>
<div class="props_rev_3"><a id="GUID-C3B11701-F23A-4781-91EE-C907F0AF2527"></a>
<h4 id="CNCPT-GUID-C3B11701-F23A-4781-91EE-C907F0AF2527" class="sect4">Database Links Between PDBs</h4>
<div>
<p><a id="d83305e2147" class="indexterm-anchor"></a><a id="d83305e2151" class="indexterm-anchor"></a>In a CDB, all database objects reside in a schema, which in turn resides in a container. Because PDBs appear to users as non-CDBs, schemas must be uniquely named within a container but not across containers. For example, the <code class="codeph">rep</code> schema can exist in both <code class="codeph">salespdb</code> and <code class="codeph">hrpdb</code>. The two schemas are independent (see <a href="cdblogic.htm#GUID-19337B94-645B-45E8-842C-762BBC544B13__CEGJAAGC">Figure 18-7</a> for an example).</p>
<p>A user connected to one PDB must use database links to access objects in a different PDB. This behavior is directly analogous to a user in a non-CDB accessing objects in a different non-CDB.</p>
<div class="infoboxnotealso" id="GUID-C3B11701-F23A-4781-91EE-C907F0AF2527__GUID-A9FDA945-DCB3-4534-8847-27822699013B">
<p class="notep1">See Also:</p>
<p><a class="olink ADMIN13859" target="_blank" href="../ADMIN/cdb_pdb_admin.htm#ADMIN13859"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> to learn how to access objects in other PDBs using database links</p>
</div>
</div>
</div>
</div>
<a id="CNCPT89255"></a>
<div class="props_rev_3"><a id="GUID-A356382A-413A-4A42-98DC-6C2464808202"></a>
<h3 id="CNCPT-GUID-A356382A-413A-4A42-98DC-6C2464808202" class="sect3">Data Dictionary Architecture in a CDB</h3>
<div>
<p>From the user and application perspective, the data dictionary in each container in a CDB is separate, as it would be in a non-CDB.</p>
<p>For example, the <code class="codeph">DBA_OBJECTS</code> view in each PDB can show a different number of rows. This dictionary separation enables Oracle Database to manage the PDBs separately from each other and from the root.</p>
</div>
<a id="CNCPT89347"></a><a id="CNCPT89346"></a>
<div class="props_rev_3"><a id="GUID-0AF14A64-DD38-4755-94ED-2021CE137A90"></a>
<h4 id="CNCPT-GUID-0AF14A64-DD38-4755-94ED-2021CE137A90" class="sect4">Purpose of Data Dictionary Separation</h4>
<div>
<p>In a newly created non-CDB that does not yet contain user data, the data dictionary contains only system metadata. For example, the <code class="codeph">TAB$</code> table contains rows that describe only Oracle-supplied tables, for example, <code class="codeph">TRIGGER$</code> and <code class="codeph">SERVICE$</code>.</p>
<p>The following graphic depicts three underlying data dictionary tables, with the red bars indicating rows describing the system.</p>
<div class="figure" id="GUID-0AF14A64-DD38-4755-94ED-2021CE137A90__GUID-647E292D-76FB-4248-A891-1FCB55388CEA">
<p class="titleinfigure">Figure 18-1 Unmixed Data Dictionary Metadata in a Non-CDB</p>
<img width="362" height="123" src="img/GUID-6B5A128B-A583-45C7-AD18-B5EA1A5A94FC-default.png" alt="Description of Figure 18-1 follows" title="Description of Figure 18-1 follows"/><br/>
<a href="img_text/GUID-6B5A128B-A583-45C7-AD18-B5EA1A5A94FC-print.htm">Description of &#34;Figure 18-1 Unmixed Data Dictionary Metadata in a Non-CDB&#34;</a></div>
<!-- class="figure" -->
<p>If users create their own schemas and tables in this non-CDB, then the data dictionary now contains some rows that describe Oracle-supplied entities, and other rows that describe user-created entities. For example, the <code class="codeph">TAB$</code> dictionary table now has a row describing <code class="codeph">employees</code> and a row describing <code class="codeph">departments</code>.</p>
<div class="figure" id="GUID-0AF14A64-DD38-4755-94ED-2021CE137A90__GUID-A14C0DC8-58A4-47EA-9C82-90FF2CAFA591">
<p class="titleinfigure">Figure 18-2 Mixed Data Dictionary Metadata in a Non-CDB</p>
<img width="647" height="123" src="img/GUID-99B809A0-C7B2-4ADA-90A6-B13E85E037D2-default.png" alt="Description of Figure 18-2 follows" title="Description of Figure 18-2 follows"/><br/>
<a href="img_text/GUID-99B809A0-C7B2-4ADA-90A6-B13E85E037D2-print.htm">Description of &#34;Figure 18-2 Mixed Data Dictionary Metadata in a Non-CDB&#34;</a></div>
<!-- class="figure" -->
<p>In a CDB, the data dictionary metadata is split between the root and the PDBs. In the following figure, the <code class="codeph">employees</code> and <code class="codeph">departments</code> tables reside in a PDB. The data dictionary for this user data also resides in the PDB. Thus, the <code class="codeph">TAB$</code> table in the PDB has a row for the <code class="codeph">employees</code> table and a row for the <code class="codeph">departments</code> table.</p>
<div class="figure" id="GUID-0AF14A64-DD38-4755-94ED-2021CE137A90__CIHBJBFA">
<p class="titleinfigure">Figure 18-3 Data Dictionary Architecture in a CDB</p>
<img width="590" height="350" src="img/GUID-3DBCEF49-DEEB-4E2A-BC7C-054C296AB150-default.png" alt="Description of Figure 18-3 follows" title="Description of Figure 18-3 follows"/><br/>
<a href="img_text/GUID-3DBCEF49-DEEB-4E2A-BC7C-054C296AB150-print.htm">Description of &#34;Figure 18-3 Data Dictionary Architecture in a CDB&#34;</a></div>
<!-- class="figure" -->
<p>The preceding graphic shows that the data dictionary in the PDB contains pointers to the data dictionary in the root. Internally, Oracle-supplied objects such as data dictionary table definitions and PL/SQL packages are represented <span class="italic">only</span> in the root. This architecture achieves two main goals within the CDB:</p>
<ul style="list-style-type: disc;">
<li>
<p>Reduction of duplication</p>
<p>For example, instead of storing the source code for the <code class="codeph">DBMS_ADVISOR</code> PL/SQL package in every PDB, the CDB stores it only in <code class="codeph">CDB$ROOT</code>, which saves disk space.</p>
</li>
<li>
<p>Ease of database upgrade</p>
<p>If the definition of a data dictionary table existed in every PDB, and if the definition were to change in a new release, then each PDB would need to be upgraded separately to capture the change. Storing the table definition only once in the root eliminates this problem.</p>
</li>
</ul>
</div>
</div>
<a id="CNCPT89348"></a>
<div class="props_rev_3"><a id="GUID-C7F5F6BD-E905-4402-A685-D4A79CF565EA"></a>
<h4 id="CNCPT-GUID-C7F5F6BD-E905-4402-A685-D4A79CF565EA" class="sect4">Metadata and Object Links in the CDB Root</h4>
<div>
<p>The CDB uses an internal mechanism to separate data dictionary information.</p>
<p>Specifically, Oracle Database uses the following automatically managed pointers:</p>
<ul style="list-style-type: disc;">
<li>
<p>Metadata links</p>
<p>Oracle Database stores metadata about dictionary objects only in the root. For example, the column definitions for the <code class="codeph">OBJ$</code> dictionary table, which underlies the <code class="codeph">DBA_OBJECTS</code> data dictionary view, exist only in the root. As depicted in <a href="cdblogic.htm#GUID-0AF14A64-DD38-4755-94ED-2021CE137A90__CIHBJBFA">Figure 18-3</a>, the <code class="codeph">OBJ$</code> table in each PDB uses an internal mechanism called a <a href="glossary.htm#GUID-CFF95408-C548-4FE2-AFBA-39F647E3AC32"><span class="xrefglossterm">metadata link</span></a> to point to the definition of <code class="codeph">OBJ$</code> stored in the root.</p>
<p>The <span class="italic">data</span> corresponding to a metadata link resides in its PDB, not in the root. For example, if you create table <code class="codeph">mytable</code> in <code class="codeph">hrpdb</code> and add rows to it, then the rows are stored in the PDB files. The data dictionary views in the PDB and in the root contain different rows. For example, a new row describing <code class="codeph">mytable</code> exists in the <code class="codeph">OBJ$</code> table in <code class="codeph">hrpdb</code>, but not in the <code class="codeph">OBJ$</code> table in the root. Thus, a query of <code class="codeph">DBA_OBJECTS</code> in the root and <code class="codeph">DBA_OBJECTS</code> in <code class="codeph">hrdpb</code> shows different result sets.</p>
</li>
<li>
<p>Object links</p>
<p>In some cases, Oracle Database stores the data (not metadata) for an object only once in the root. For example, AWR data resides in the root. Each PDB uses an internal mechanism called an <a href="glossary.htm#GUID-58284157-F969-4848-92A2-6484C64A2CD3"><span class="xrefglossterm">object link</span></a> to point to the AWR data in the root, thereby making views such as <code class="codeph">DBA_HIST_ACTIVE_SESS_HISTORY</code> and <code class="codeph">DBA_HIST_BASELINE</code> accessible in each separate container.</p>
</li>
</ul>
<p>Oracle Database automatically creates and manages object and metadata links. Users cannot add, modify, or remove these links.</p>
<div class="infoboxnotealso" id="GUID-C7F5F6BD-E905-4402-A685-D4A79CF565EA__GUID-4ADFA3B9-13F6-4209-A271-3240352DD3AA">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="datadict.htm#GUID-9B9ABE1C-A1E3-464F-8936-978250DC3E1F" title="An important part of an Oracle database is its data dictionary, which is a read-only set of tables that provides administrative metadata about the database.">Overview of the Data Dictionary</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="cncptdba.htm#GUID-1C0B57E9-1D1D-4C48-8A3D-5F56160435ED" title="Automatic Workload Repository (AWR) is a repository of historical performance data that includes cumulative statistics for the system, sessions, individual SQL statements, segments, and services.">Automatic Workload Repository (AWR)</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
</div>
<a id="CNCPT89350"></a><a id="CNCPT89351"></a><a id="CNCPT89349"></a>
<div class="props_rev_3"><a id="GUID-1A22B2C5-B302-450E-BB41-6CB6B1AE75B0"></a>
<h4 id="CNCPT-GUID-1A22B2C5-B302-450E-BB41-6CB6B1AE75B0" class="sect4">Container Data Objects in a CDB</h4>
<div>
<p>A <span class="bold">container data object</span> is a table or view containing data pertaining to multiple containers and possibly the CDB as a whole, along with mechanisms to restrict data visible to specific common users through such objects to one or more containers.</p>
<p>Examples of container data objects are Oracle-supplied views whose names begin with <code class="codeph">V$</code> and <code class="codeph">CDB_</code>. All container data objects have a <code class="codeph">CON_ID</code> column. The following table shows the meaning of the values for this column.</p>
<div class="tblformal" id="GUID-1A22B2C5-B302-450E-BB41-6CB6B1AE75B0__CIHGEJIG">
<p class="titleintable">Table 18-1 Container ID Values</p>
<table class="cellalignment1206" title="Container ID Values" summary="Container ID values">
<thead>
<tr class="cellalignment1197">
<th class="cellalignment1252" id="d83305e3340">Container ID</th>
<th class="cellalignment1253" id="d83305e3343">Rows pertain to</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1197">
<td class="cellalignment1254" id="d83305e3348" headers="d83305e3340">
<p><code class="codeph">0</code></p>
</td>
<td class="cellalignment1255" headers="d83305e3348 d83305e3343">
<p>Whole CDB, or non-CDB</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1254" id="d83305e3356" headers="d83305e3340">
<p><code class="codeph">1</code></p>
</td>
<td class="cellalignment1255" headers="d83305e3356 d83305e3343">
<p><code class="codeph">CDB$ROOT</code></p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1254" id="d83305e3365" headers="d83305e3340">
<p><code class="codeph">2</code></p>
</td>
<td class="cellalignment1255" headers="d83305e3365 d83305e3343">
<p><code class="codeph">PDB$SEED</code></p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1254" id="d83305e3374" headers="d83305e3340">
<p>All Other IDs</p>
</td>
<td class="cellalignment1255" headers="d83305e3374 d83305e3343">
<p>User-Created PDBs</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>In a CDB, for every <code class="codeph">DBA_</code> view, a corresponding <code class="codeph">CDB_</code> view exists. The owner of a <code class="codeph">CDB_</code> view is the owner of the corresponding <code class="codeph">DBA_</code> view. The following figure shows the relationship among the different categories of dictionary views.</p>
<div class="figure" id="GUID-1A22B2C5-B302-450E-BB41-6CB6B1AE75B0__GUID-BD297D24-43B1-4578-B925-E525E1D2E762">
<p class="titleinfigure">Figure 18-4 Dictionary View Relationships in a CDB</p>
<img width="366" height="174" src="img/GUID-94C81541-994C-4B92-9A5B-D7AE20B77DAB-default.png" alt="Description of Figure 18-4 follows" title="Description of Figure 18-4 follows"/><br/>
<a href="img_text/GUID-94C81541-994C-4B92-9A5B-D7AE20B77DAB-print.htm">Description of &#34;Figure 18-4 Dictionary View Relationships in a CDB&#34;</a></div>
<!-- class="figure" -->
<p>When the current container is a PDB, a user can view data dictionary information for the current PDB only. To an application connected to a PDB, the data dictionary appears as it would for a non-CDB. When the current container is the root, however, a common user can query <code class="codeph">CDB_</code> views to see metadata for the root and for PDBs for which this user is privileged.</p>
<p>The following table shows a scenario involving queries of <code class="codeph">CDB_</code> views. Each row describes an action that occurs after the action in the preceding row.</p>
<div class="tblformalwide" id="GUID-1A22B2C5-B302-450E-BB41-6CB6B1AE75B0__QUERYINGCDB_VIEWS-1BFA3C28">
<p class="titleintable">Table 18-2 Querying CDB_ Views</p>
<table class="cellalignment1211" title="Querying CDB_ Views" summary="Querying CDB_ views">
<thead>
<tr class="cellalignment1197">
<th class="cellalignment1222" id="d83305e3419">Operation</th>
<th class="cellalignment1222" id="d83305e3422">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e3427" headers="d83305e3419">
<pre dir="ltr">SQL&gt; CONNECT SYSTEM
Enter password: ********
Connected.
</pre></td>
<td class="cellalignment1223" headers="d83305e3427 d83305e3422">
<p>The <code class="codeph">SYSTEM</code> user, which is common to all containers in the CDB, connects to the root.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e3437" headers="d83305e3419">
<pre dir="ltr">SQL&gt; SELECT COUNT(*) FROM CDB_USERS 
WHERE CON_ID=1;

COUNT(*)
--------
      41
</pre></td>
<td class="cellalignment1223" headers="d83305e3437 d83305e3422">
<p><code class="codeph">SYSTEM</code> queries <code class="codeph">CDB_USERS</code> to obtain the number of common users in the CDB. The output indicates that 41 common users exist.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e3449" headers="d83305e3419">
<pre dir="ltr">SQL&gt; SELECT COUNT(DISTINCT(CON_ID)) 
FROM CDB_USERS;
 
COUNT(DISTINCT(CON_ID))
-----------------------
                      4
</pre></td>
<td class="cellalignment1223" headers="d83305e3449 d83305e3422">
<p><code class="codeph">SYSTEM</code> queries <code class="codeph">CDB_USERS</code> to determine the number of distinct containers in the CDB.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e3461" headers="d83305e3419">
<pre dir="ltr">SQL&gt; CONNECT SYSTEM@hrdb
Enter password: ********
Connected.
</pre></td>
<td class="cellalignment1223" headers="d83305e3461 d83305e3422">
<p>The <code class="codeph">SYSTEM</code> user now connects to the PDB named <code class="codeph">hrpdb</code>.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e3474" headers="d83305e3419">
<pre dir="ltr">SQL&gt; SELECT COUNT(*) FROM CDB_USERS;
 
  COUNT(*)
----------
        45
</pre></td>
<td class="cellalignment1223" headers="d83305e3474 d83305e3422">
<p><code class="codeph">SYSTEM</code> queries <code class="codeph">CDB_USERS</code>. The output indicates that 45 users exist. Because <code class="codeph">SYSTEM</code> is not connected to the root, the <code class="codeph">CDB_USERS</code> view shows the same output as <code class="codeph">DBA_USERS</code>. Because <code class="codeph">DBA_USERS</code> only shows the users in the <span class="italic">current</span> container, it shows 45.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="infoboxnotealso" id="GUID-1A22B2C5-B302-450E-BB41-6CB6B1AE75B0__GUID-D1A3621E-4DA2-4421-857E-011179130C32">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="cdblogic.htm#GUID-19337B94-645B-45E8-842C-762BBC544B13" title="A common user is a database user that has the same identity in the root and in every existing and future PDB. Every common user can connect to and perform operations within the root, and within any PDB in which it has privileges.">Common Users in a CDB</a>&#34;</span></p>
</li>
<li>
<p><a class="olink ADMIN13931" target="_blank" href="../ADMIN/cdb_mon.htm#ADMIN13931"><span><cite>Oracle Database Administrator&rsquo;s Guide</cite></span></a></p>
</li>
</ul>
</div>
</div>
</div>
<a id="CNCPT89456"></a>
<div class="props_rev_3"><a id="GUID-F9CD5EAB-66EB-4450-9136-93C7DB27E316"></a>
<h4 id="CNCPT-GUID-F9CD5EAB-66EB-4450-9136-93C7DB27E316" class="sect4">Data Dictionary Storage in a CDB</h4>
<div>
<p>The data dictionary that stores the metadata for the CDB as a whole is stored only in the system tablespaces.</p>
<p>The data dictionary that stores the metadata for a specific PDB is stored in the self-contained tablespaces dedicated to this PDB. The PDB tablespaces contain both the data and metadata for an application back end. Thus, each set of data dictionary tables is stored in its own dedicated set of tablespaces.</p>
<div class="infoboxnotealso" id="GUID-F9CD5EAB-66EB-4450-9136-93C7DB27E316__GUID-EA807B3E-A81D-4866-8B1D-2DF7066B81A8">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="datadict.htm#GUID-9B9ABE1C-A1E3-464F-8936-978250DC3E1F" title="An important part of an Oracle database is its data dictionary, which is a read-only set of tables that provides administrative metadata about the database.">Overview of the Data Dictionary</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="cdblogic.htm#GUID-5902ABDC-40BE-4CF4-9917-A5D7F4C396F1" title="A CDB has the same structure as a non-CDB, except that each PDB and application root has its own set of tablespaces, including its own SYSTEM, SYSAUX, and undo tablespaces.">Overview of Tablespaces and Database Files in a CDB</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<a id="CNCPT89457"></a>
<div class="props_rev_3"><a id="GUID-2278B77D-9D81-46A8-9F57-6F5F8B96964C"></a>
<h3 id="CNCPT-GUID-2278B77D-9D81-46A8-9F57-6F5F8B96964C" class="sect3">Current Container</h3>
<div>
<p>For a given session, the current container is the one in which the session is running. The current container can be the root (for common users only) or a PDB.</p>
<p>Each session has exactly one current container at any point in time. Because the data dictionary in each container is separate, Oracle Databases uses the data dictionary in the current container for name resolution and privilege authorization.</p>
<div class="infoboxnotealso" id="GUID-2278B77D-9D81-46A8-9F57-6F5F8B96964C__GUID-1F0ED68E-075B-467B-8034-EDEAEF5BC09C">
<p class="notep1">See Also:</p>
<p><a class="olink ADMIN14214" target="_blank" href="../ADMIN/cdb_admin.htm#ADMIN14214"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> to learn more about the current container</p>
</div>
</div>
</div>
<a id="CNCPT89304"></a>
<div class="props_rev_3"><a id="GUID-05B15BE7-D8CD-4D8C-A33F-38C1BB09D893"></a>
<h3 id="CNCPT-GUID-05B15BE7-D8CD-4D8C-A33F-38C1BB09D893" class="sect3">Cross-Container Operations</h3>
<div>
<p>A <span class="bold"><a href="glossary.htm#GUID-FD2637AF-A931-4B83-AA6D-1D9CC5397BED"><span class="xrefglossterm">cross-container operation</span></a></span> is a DDL statement that affects any of the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>The CDB itself</p>
</li>
<li>
<p>Multiple containers</p>
</li>
<li>
<p>Multiple entities such as common users or common roles that are represented in multiple containers</p>
</li>
<li>
<p>A container different from the one to which the user issuing the DDL statement is currently connected</p>
</li>
</ul>
<p>Only a common user connected to the root can perform cross-container operations (see <span class="q">&#34;<a href="cdblogic.htm#GUID-19337B94-645B-45E8-842C-762BBC544B13" title="A common user is a database user that has the same identity in the root and in every existing and future PDB. Every common user can connect to and perform operations within the root, and within any PDB in which it has privileges.">Common Users in a CDB</a>&#34;</span>). Examples include user <code class="codeph">SYSTEM</code> granting a privilege commonly to another common user (see <span class="q">&#34;<a href="cdblogic.htm#GUID-30BAB0BC-3FCA-469C-A578-161271EAEB05" title="Privileges and common roles may be granted commonly.">Roles and Privileges Granted Commonly in a CDB</a>&#34;</span>), and an <code class="codeph">ALTER DATABASE . . . RECOVER</code> statement that applies to the entire CDB.</p>
<div class="infoboxnotealso" id="GUID-05B15BE7-D8CD-4D8C-A33F-38C1BB09D893__GUID-A0F7587A-AE63-43EC-A4DF-13DFF4D1DF30">
<p class="notep1">See Also:</p>
<p><a class="olink ADMIN13606" target="_blank" href="../ADMIN/cdb_admin.htm#ADMIN13606"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a></p>
</div>
</div>
</div>
</div>
<a id="CNCPT89271"></a><a id="CNCPT89270"></a>
<div class="props_rev_3"><a id="GUID-5660AC5E-BFD4-41BE-8404-C31870FE4D48"></a>
<h2 id="CNCPT-GUID-5660AC5E-BFD4-41BE-8404-C31870FE4D48" class="sect2">Overview of Services in a CDB</h2>
<div>
<p>Clients must connect to PDBs using services. A connection using a service name starts a new session in a PDB. A foreground process, and therefore a session, at every moment of its lifetime, has a uniquely defined current container.</p>
<p>The following figure shows two clients connecting to PDBs using two different listeners.</p>
<div class="figure" id="GUID-5660AC5E-BFD4-41BE-8404-C31870FE4D48__CEGCEABG">
<p class="titleinfigure">Figure 18-5 Services in a CDB</p>
<img width="498" height="366" src="img/GUID-FF945E6C-E472-4DCF-A373-9DF3391C69E2-default.png" alt="Description of Figure 18-5 follows" title="Description of Figure 18-5 follows"/><br/>
<a href="img_text/GUID-FF945E6C-E472-4DCF-A373-9DF3391C69E2-print.htm">Description of &#34;Figure 18-5 Services in a CDB&#34;</a></div>
<!-- class="figure" --></div>
<a id="CNCPT89458"></a>
<div class="props_rev_3"><a id="GUID-7400E086-28A3-4089-88AB-7E270AA33ABE"></a>
<h3 id="CNCPT-GUID-7400E086-28A3-4089-88AB-7E270AA33ABE" class="sect3">Service Creation in a CDB</h3>
<div>
<p>When you create a PDB, the database automatically creates and starts a service inside the CDB. The service has a property, shown in the <code class="codeph">DBA_SERVICES.PDB</code> column, that identifies the PDB as the initial current container for the service. The service has the same name as the PDB. The PDB name must be a valid service name, and must be unique within the CDB. For example, in <a href="cdblogic.htm#GUID-5660AC5E-BFD4-41BE-8404-C31870FE4D48__CEGCEABG">Figure 18-5</a> the PDB named <code class="codeph">hrpdb</code> has a default service named <code class="codeph">hrpdb</code>. The default service must not be dropped.</p>
<p>You can create additional services for each PDB. Each additional service denotes its PDB as the initial current container. In <a href="cdblogic.htm#GUID-5660AC5E-BFD4-41BE-8404-C31870FE4D48__CEGCEABG">Figure 18-5</a>, nondefault services exist for <code class="codeph">erppdb</code> and <code class="codeph">hrpdb</code>. Create, maintain, and drop additional services using the same techniques that you use in a non-CDB.</p>
<div class="infobox-note" id="GUID-7400E086-28A3-4089-88AB-7E270AA33ABE__GUID-E16349F3-B1D5-4721-B3A4-51D32014CCA9">
<p class="notep1">Note:</p>
<p>When two or more CDBs on the same computer system use the same listener, and two or more PDBs have the same service name in these CDBs, a connection that specifies this service name connects randomly to one of the PDBs with the service name. To avoid incorrect connections, ensure that all service names for PDBs are unique on the computer system, or configure a separate listener for each CDB on the computer system.</p>
</div>
<div class="infoboxnotealso" id="GUID-7400E086-28A3-4089-88AB-7E270AA33ABE__GUID-091AAC84-DD80-49F8-A2F2-623BC5C76401">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="dist_pro.htm#GUID-C931A159-E1FE-4DB3-A811-510C42516683" title="A service name is a logical representation of a service used for client connections.">Service Names</a>&#34;</span></p>
</li>
<li>
<p><a class="olink ADMIN13973" target="_blank" href="../ADMIN/cdb_pdb_admin.htm#ADMIN13973"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> to learn how to manage services associated with PDBs</p>
</li>
</ul>
</div>
</div>
</div>
<a id="CNCPT89252"></a><a id="CNCPT89459"></a>
<div class="props_rev_3"><a id="GUID-A0449CA4-1704-415E-8D85-964517943159"></a>
<h3 id="CNCPT-GUID-A0449CA4-1704-415E-8D85-964517943159" class="sect3">Connections to Containers in a CDB</h3>
<div>
<p>A CDB administrator with the appropriate privileges can connect to any container in the CDB. The administrator can use either of the following techniques:</p>
<ul style="list-style-type: disc;">
<li>
<p>Use the <code class="codeph">ALTER SESSION SET CONTAINER</code> statement, which is useful for both connection pooling and advanced CDB administration, to switch between containers.</p>
<p>For example, a CDB administrator can connect to the root in one session, and then in the same session switch to a PDB. In this case, the user requires the <code class="codeph">SET CONTAINER</code> system privilege in the container.</p>
</li>
<li>
<p>Connect directly to a PDB.</p>
<p>In this case, the user requires the <code class="codeph">CREATE SESSION</code> privilege in the container.</p>
</li>
</ul>
<p><a href="cdblogic.htm#GUID-A0449CA4-1704-415E-8D85-964517943159__ServicesInACDB-1BFABC43" title="Sessions in a CDB">Table 18-3</a> describes a scenario involving the CDB in <a href="cdblogic.htm#GUID-5660AC5E-BFD4-41BE-8404-C31870FE4D48__CEGCEABG">Figure 18-5</a>. Each row describes an action that occurs after the action in the preceding row. Common user <code class="codeph">SYSTEM</code> queries the name of the current container and the names of PDBs in the CDB.</p>
<div class="tblformalwide" id="GUID-A0449CA4-1704-415E-8D85-964517943159__ServicesInACDB-1BFABC43">
<p class="titleintable">Table 18-3 Services in a CDB</p>
<table class="cellalignment1211" title="Services in a CDB" summary="Sessions in a CDB">
<thead>
<tr class="cellalignment1197">
<th class="cellalignment1222" id="d83305e5098">Operation</th>
<th class="cellalignment1222" id="d83305e5101">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e5106" headers="d83305e5098">
<pre dir="ltr">SQL&gt; CONNECT SYSTEM@prod
Enter password: ********
Connected.
</pre></td>
<td class="cellalignment1223" headers="d83305e5106 d83305e5101">
<p>The <code class="codeph">SYSTEM</code> user, which is common to all containers in the CDB, connects to the root using service named <code class="codeph">prod</code>.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e5119" headers="d83305e5098">
<pre dir="ltr">SQL&gt; SHOW CON_NAME
 
CON_NAME
--------
CDB$ROOT
</pre></td>
<td class="cellalignment1223" headers="d83305e5119 d83305e5101">
<p><code class="codeph">SYSTEM</code> uses the SQL*Plus command <code class="codeph">SHOW</code> <code class="codeph">CON_NAME</code> to list the name of the container to which the user is currently connected. <code class="codeph">CDB$ROOT</code> is the name of the root container.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e5137" headers="d83305e5098">
<pre dir="ltr">SQL&gt; SELECT NAME, PDB 
  FROM V$SERVICES 
  ORDER BY PDB, NAME;

NAME                    PDB
----------------------  --------
SYS$BACKGROUND          CDB$ROOT
SYS$USERS               CDB$ROOT
prod.example.com        CDB$ROOT
erppdb.example.com      ERPPDB
erp.example.com         ERPPDB
hr.example.com          HRPDB
hrpdb.example.com       HRPDB
salespdb.example.com    SALESPDB

8 rows selected.
</pre></td>
<td class="cellalignment1223" headers="d83305e5137 d83305e5101">
<p>A query of <code class="codeph">V$SERVICES</code> shows that three PDBs exist with service names that match the PDB name. Both <code class="codeph">hrpdb</code> and <code class="codeph">erppdb</code> have an additional service.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e5153" headers="d83305e5098">
<pre dir="ltr">SQL&gt; ALTER SESSION 
  SET CONTAINER = hrpdb;

Session altered.
</pre></td>
<td class="cellalignment1223" headers="d83305e5153 d83305e5101">
<p><code class="codeph">SYSTEM</code> uses <code class="codeph">ALTER SESSION</code> to connect to <code class="codeph">hrpdb</code>.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e5168" headers="d83305e5098">
<pre dir="ltr">SQL&gt; SELECT 
  SYS_CONTEXT(&#39;USERENV&#39;, &#39;CON_NAME&#39;) 
  AS CUR_CONTAINER FROM DUAL;
 
CUR_CONTAINER
-------------
HRPDB
</pre></td>
<td class="cellalignment1223" headers="d83305e5168 d83305e5101">
<p>A query confirms that the current container is now <code class="codeph">hrpdb</code>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="infoboxnotealso" id="GUID-A0449CA4-1704-415E-8D85-964517943159__GUID-5808523D-3D39-471C-9AC3-D1072F954C84">
<p class="notep1">See Also:</p>
<p><a class="olink ADMIN13861" target="_blank" href="../ADMIN/cdb_pdb_admin.htm#ADMIN13861"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> to learn how to connect to PDBs</p>
</div>
</div>
</div>
</div>
<a id="CNCPT89352"></a>
<div class="props_rev_3"><a id="GUID-B8A0393D-EB92-4020-81EA-7773EE60330C"></a>
<h2 id="CNCPT-GUID-B8A0393D-EB92-4020-81EA-7773EE60330C" class="sect2">Overview of Commonality in a CDB</h2>
<div>
<p>In a CDB, the basic principle of commonality is that <span class="italic">a common phenomenon is the same in every existing and future container</span>. In a CDB, &#34;common&#34; means &#34;common to all containers.&#34; In contrast, a local phenomenon is restricted to exactly one existing container.</p>
<p>A corollary to the principle of commonality is that <span class="italic">only a common user can alter the existence of common phenomena</span>. More precisely, only a common user connected to the root can create, destroy, or modify CDB-wide attributes of a common user or role.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="cdblogic.htm#GUID-3BB161DA-9CC0-4D61-A2C1-5D3662E0DECF" title="Every user that owns objects that define the database is common. User-created users are either local or common.">Overview of Common and Local Users in a CDB</a></p>
</li>
<li>
<p><a href="cdblogic.htm#GUID-19E279FC-9E50-4AE7-B852-1C6409066BC1" title="A local role exists only in a single PDB, just as a role in a non-CDB exists only in the non-CDB. A local role can only contain roles and privileges that apply within the container in which the role exists.">Overview of Common and Local Roles in a CDB</a></p>
</li>
<li>
<p><a href="cdblogic.htm#GUID-16473474-7F47-4E40-A592-01836E7D911C" title="In a CDB, every act of granting, whether local or common, occurs within a specific container. Roles and privileges may be granted locally to users and roles regardless of whether the grantees, grantors, or roles being granted are local or common.A user or role may be locally granted a privilege (CONTAINER=CURRENT). Privileges and common roles may be granted commonly.In a CDB, PUBLIC is a common role. In a PDB, privileges granted locally to PUBLIC enable all local and common user account to exercise these privileges in this PDB only.In this scenario, SYSTEM creates common user c##dba and tries to give this user privileges to query a table in the hr schema in hrpdb.">Overview of Privilege and Role Grants in a CDB</a></p>
</li>
<li>
<p><a href="cdblogic.htm#GUID-232E8018-9BA8-4412-BAA6-98FC9B19D8E3" title="For both mixed mode and unified auditing, a common audit configuration is visible and enforced across all PDBs.">Overview of Common Audit Configurations</a></p>
</li>
</ul>
</div>
<a id="CNCPT89397"></a><a id="CNCPT89257"></a>
<div class="props_rev_3"><a id="GUID-3BB161DA-9CC0-4D61-A2C1-5D3662E0DECF"></a>
<h3 id="CNCPT-GUID-3BB161DA-9CC0-4D61-A2C1-5D3662E0DECF" class="sect3">Overview of Common and Local Users in a CDB</h3>
<div>
<p>Every user that owns objects that define the database is common. User-created users are either local or common.</p>
<p><a href="cdblogic.htm#GUID-3BB161DA-9CC0-4D61-A2C1-5D3662E0DECF__CIHIDFJD">Figure 18-6</a> shows the possible user types in a CDB.</p>
<div class="figure" id="GUID-3BB161DA-9CC0-4D61-A2C1-5D3662E0DECF__CIHIDFJD">
<p class="titleinfigure">Figure 18-6 Users in a CDB</p>
<img width="434" height="243" src="img/GUID-AD48BD11-F101-4367-A655-5B1D44459D8A-default.png" alt="Description of Figure 18-6 follows" title="Description of Figure 18-6 follows"/><br/>
<a href="img_text/GUID-AD48BD11-F101-4367-A655-5B1D44459D8A-print.htm">Description of &#34;Figure 18-6 Users in a CDB&#34;</a></div>
<!-- class="figure" --></div>
<a id="CNCPT89258"></a><a id="CNCPT89259"></a>
<div class="props_rev_3"><a id="GUID-19337B94-645B-45E8-842C-762BBC544B13"></a>
<h4 id="CNCPT-GUID-19337B94-645B-45E8-842C-762BBC544B13" class="sect4">Common Users in a CDB</h4>
<div>
<p>A <span class="bold">common user</span> is a database user that has the same identity in the root and in every existing and future PDB. Every common user can connect to and perform operations within the root, and within any PDB in which it has privileges.</p>
<p>Every common user is either Oracle-supplied or user-created. Examples of Oracle-supplied common users are <code class="codeph">SYS</code> and <code class="codeph">SYSTEM</code>.</p>
<p><a href="cdblogic.htm#GUID-19337B94-645B-45E8-842C-762BBC544B13__CEGJAAGC">Figure 18-7</a> shows sample users and schemas in two PDBs: <code class="codeph">hrpdb</code> and <code class="codeph">salespdb</code>. <code class="codeph">SYS</code> and <code class="codeph">c##dba</code> are common users who have schemas in <code class="codeph">CDB$ROOT</code>, <code class="codeph">hrpdb</code>, and <code class="codeph">salespdb</code>. Local users <code class="codeph">hr</code> and <code class="codeph">rep</code> exist in <code class="codeph">hrpdb</code>. Local users <code class="codeph">hr</code> and <code class="codeph">rep</code> also exist in <code class="codeph">salespdb</code>.</p>
<div class="figure" id="GUID-19337B94-645B-45E8-842C-762BBC544B13__CEGJAAGC">
<p class="titleinfigure">Figure 18-7 Users and Schemas in a CDB</p>
<img width="665" height="575" src="img/GUID-8D161A38-5BB0-4C97-87A7-87C2C5579505-default.png" alt="Description of Figure 18-7 follows" title="Description of Figure 18-7 follows"/><br/>
<a href="img_text/GUID-8D161A38-5BB0-4C97-87A7-87C2C5579505-print.htm">Description of &#34;Figure 18-7 Users and Schemas in a CDB&#34;</a></div>
<!-- class="figure" -->
<p>Common users have the following characteristics:</p>
<ul style="list-style-type: disc;">
<li>
<p>A common user can log in to any container (including <code class="codeph">CDB$ROOT</code>) in which it has the <code class="codeph">CREATE SESSION</code> privilege.</p>
<p>A common user need not have the same privileges in every container. For example, the <code class="codeph">c##dba</code> user may have the privilege to create a session in <code class="codeph">hrpdb</code> and in the root, but <span class="italic">not</span> to create a session in <code class="codeph">salespdb</code>. Because a common user with the appropriate privileges can switch between containers, a common user in the root can administer PDBs.</p>
</li>
<li>
<p>The name of every user-created common user must begin with the characters <code class="codeph">c##</code> or <code class="codeph">C##</code>. (Oracle-supplied common user names do not have this restriction.)</p>
<p>No local user name may begin with the characters <code class="codeph">c##</code> or <code class="codeph">C##</code>.</p>
</li>
<li>
<p>The names of common users must contain only ASCII or EBCDIC characters.</p>
</li>
<li>
<p>Every common user is uniquely named across all containers.</p>
<p>A common user resides in the root, but must be able to connect to every PDB with the same identity.</p>
</li>
<li>
<p>The schemas for a common user can differ in each container.</p>
<p>For example, if <code class="codeph">c##dba</code> is a common user that has privileges on multiple containers, then the <code class="codeph">c##dba</code> schema in each of these containers may contain different objects.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-19337B94-645B-45E8-842C-762BBC544B13__GUID-E48B4236-84A7-47E4-A01D-F744986D5B78">
<p class="notep1">See Also:</p>
<p><a class="olink DBSEG580" target="_blank" href="../DBSEG/users.htm#DBSEG580"><span><cite>Oracle Database Security Guide</cite></span></a> to learn about common and local accounts</p>
</div>
</div>
</div>
<a id="CNCPT89353"></a><a id="CNCPT89260"></a>
<div class="props_rev_3"><a id="GUID-44E8518A-E02C-429C-9B06-16078EB3251A"></a>
<h4 id="CNCPT-GUID-44E8518A-E02C-429C-9B06-16078EB3251A" class="sect4">Local Users in a CDB</h4>
<div>
<p>A <span class="bold">local user</span> is a database user that is not common and can operate only within a single PDB.</p>
<p>Local users have the following characteristics:</p>
<ul style="list-style-type: disc;">
<li>
<p>A local user is specific to a particular PDB and may own a schema in this PDB.</p>
<p>In <a href="cdblogic.htm#GUID-19337B94-645B-45E8-842C-762BBC544B13__CEGJAAGC">Figure 18-7</a>, local user <code class="codeph">hr</code> on <code class="codeph">hrpdb</code> owns the <code class="codeph">hr</code> schema. On <code class="codeph">salespdb</code>, local user <code class="codeph">rep</code> owns the <code class="codeph">rep</code> schema, and local user <code class="codeph">hr</code> owns the <code class="codeph">hr</code> schema.</p>
</li>
<li>
<p>A local user can administer a PDB, including opening and closing it.</p>
<p>A common user with <code class="codeph">SYSDBA</code> privileges can grant <code class="codeph">SYSDBA</code> privileges to a local user. In this case, the privileged user remains local.</p>
</li>
<li>
<p>A local user in one PDB cannot log in to another PDB or to the CDB root.</p>
<p>For example, when local user <code class="codeph">hr</code> connects to <code class="codeph">hrpdb</code>, <code class="codeph">hr</code> cannot access objects in the <code class="codeph">sh</code> schema that reside in the <code class="codeph">salespdb</code> database without using a database link. In the same way, when local user <code class="codeph">sh</code> connects to the <code class="codeph">salespdb</code> PDB, <code class="codeph">sh</code> cannot access objects in the <code class="codeph">hr</code> schema that resides in <code class="codeph">hrpdb</code> without using a database link.</p>
</li>
<li>
<p>The name of a local user must not begin with the characters <code class="codeph">c##</code> or <code class="codeph">C##</code>.</p>
</li>
<li>
<p>The name of a local user must only be unique within its PDB.</p>
<p>The user name and the PDB in which that user schema is contained determine a unique local user. <a href="cdblogic.htm#GUID-19337B94-645B-45E8-842C-762BBC544B13__CEGJAAGC">Figure 18-7</a> shows that a local user and schema named <code class="codeph">rep</code> exist on <code class="codeph">hrpdb</code>. A completely independent local user and schema named <code class="codeph">rep</code> exist on the <code class="codeph">salespdb</code> PDB.</p>
</li>
</ul>
<p>The following table describes a scenario involving the CDB in <a href="cdblogic.htm#GUID-19337B94-645B-45E8-842C-762BBC544B13__CEGJAAGC">Figure 18-7</a>. Each row describes an action that occurs after the action in the preceding row. Common user <code class="codeph">SYSTEM</code> creates local users in two PDBs.</p>
<div class="tblformalwide" id="GUID-44E8518A-E02C-429C-9B06-16078EB3251A__OPERATIONDESCRIPTIONSQLCONNECTSYSTE-1BFC3C7B">
<p class="titleintable">Table 18-4 Local Users in a CDB</p>
<table class="cellalignment1211" title="Local Users in a CDB" summary="This table describes a scenario involving the CDB. Each row describes an action that occurs after the action in the preceding row.">
<thead>
<tr class="cellalignment1197">
<th class="cellalignment1222" id="d83305e6474">Operation</th>
<th class="cellalignment1222" id="d83305e6477">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e6482" headers="d83305e6474">
<pre dir="ltr">SQL&gt; CONNECT SYSTEM@hrpdb
Enter password: ********
Connected.
</pre></td>
<td class="cellalignment1223" headers="d83305e6482 d83305e6477">
<p><code class="codeph">SYSTEM</code> connects to the <code class="codeph">hrpdb</code> container using the service name <code class="codeph">hrpdb</code>.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e6497" headers="d83305e6474">
<pre dir="ltr">SQL&gt; CREATE USER rep IDENTIFIED BY <span class="italic">password</span>; 

User created.

SQL&gt; GRANT CREATE SESSION TO rep;

Grant succeeded.
</pre></td>
<td class="cellalignment1223" headers="d83305e6497 d83305e6477">
<p><code class="codeph">SYSTEM</code> now creates a local user <code class="codeph">rep</code> and grants the <code class="codeph">CREATE SESSION</code> privilege in this PDB to this user. The user is local because common users can only be created by a common user connected to the root.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e6515" headers="d83305e6474">
<pre dir="ltr">SQL&gt; CONNECT rep@salespdb
Enter password: *******
ERROR:
ORA-01017: invalid username/password; logon denied
</pre></td>
<td class="cellalignment1223" headers="d83305e6515 d83305e6477">
<p>The <code class="codeph">rep</code> user, which is local to <code class="codeph">hrpdb</code>, attempts to connect to <code class="codeph">salespdb</code>. The attempt fails because <code class="codeph">rep</code> does not exist in PDB <code class="codeph">salespdb</code>. This behavior mimics the behavior of non-CDBs. A user account on one non-CDB is independent of user accounts on a different non-CDB.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e6537" headers="d83305e6474">
<pre dir="ltr">SQL&gt; CONNECT SYSTEM@salespdb
Enter password: ********
Connected.
</pre></td>
<td class="cellalignment1223" headers="d83305e6537 d83305e6477">
<p><code class="codeph">SYSTEM</code> connects to the <code class="codeph">salespdb</code> container using the service name <code class="codeph">salespdb</code>.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e6552" headers="d83305e6474">
<pre dir="ltr">SQL&gt; CREATE USER rep IDENTIFIED BY <span class="italic">password</span>; 

User created.

SQL&gt; GRANT CREATE SESSION TO rep;

Grant succeeded.
</pre></td>
<td class="cellalignment1223" headers="d83305e6552 d83305e6477">
<p><code class="codeph">SYSTEM</code> creates a local user <code class="codeph">rep</code> in <code class="codeph">salespdb</code> and grants the <code class="codeph">CREATE SESSION</code> privilege in this PDB to this user. Because the name of a local user must only be unique within its PDB, a user named <code class="codeph">rep</code> can exist in both <code class="codeph">salespdb</code> and <code class="codeph">hrpdb</code>.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e6583" headers="d83305e6474">
<pre dir="ltr">SQL&gt; CONNECT rep@salespdb
Enter password: *******
Connected.
</pre></td>
<td class="cellalignment1223" headers="d83305e6583 d83305e6477">
<p>The <code class="codeph">rep</code> user successfully logs in to <code class="codeph">salespdb</code>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="infoboxnotealso" id="GUID-44E8518A-E02C-429C-9B06-16078EB3251A__GUID-2B5FD5EB-276B-4599-85C7-FE18C5AB74B2">
<p class="notep1">See Also:</p>
<p><a class="olink DBSEG581" target="_blank" href="../DBSEG/users.htm#DBSEG581"><span><cite>Oracle Database Security Guide</cite></span></a> to learn about local user accounts</p>
</div>
</div>
</div>
</div>
<a id="CNCPT89398"></a>
<div class="props_rev_3"><a id="GUID-19E279FC-9E50-4AE7-B852-1C6409066BC1"></a>
<h3 id="CNCPT-GUID-19E279FC-9E50-4AE7-B852-1C6409066BC1" class="sect3">Overview of Common and Local Roles in a CDB</h3>
<div>
<p>Every Oracle-supplied role is common. In Oracle-supplied scripts, every privilege or role granted to Oracle-supplied users and roles is granted commonly, with one exception: system privileges are granted locally to the common role <code class="codeph">PUBLIC</code> (see <span class="q">&#34;<a href="cdblogic.htm#GUID-B0D2B368-83B2-4876-A06E-A6A86046530C" title="In a CDB, PUBLIC is a common role. In a PDB, privileges granted locally to PUBLIC enable all local and common user account to exercise these privileges in this PDB only.">Grants to PUBLIC in a CDB</a>&#34;</span>). User-created roles are either local or common.</p>
</div>
<a id="CNCPT89265"></a>
<div class="props_rev_3"><a id="GUID-41E5D1A9-30D4-4FFF-A74F-F1173D8B1BF7"></a>
<h4 id="CNCPT-GUID-41E5D1A9-30D4-4FFF-A74F-F1173D8B1BF7" class="sect4">Common Roles in a CDB</h4>
<div>
<p>A <a href="glossary.htm#GUID-E3EB68E5-49CA-4AC5-B7DD-DDA430ABA261"><span class="xrefglossterm">common role</span></a> is a database role that exists in the root and in every existing and future PDB. Common roles are useful for cross-container operations (see <span class="q">&#34;<a href="cdblogic.htm#GUID-05B15BE7-D8CD-4D8C-A33F-38C1BB09D893">Cross-Container Operations</a>&#34;</span>), ensuring that a common user has a role in every container.</p>
<p>Every common role is either user-created or Oracle-supplied. All Oracle-supplied roles are common, such as <code class="codeph">DBA</code> and <code class="codeph">PUBLIC</code>. User-created common roles must have names starting with <code class="codeph">C##</code> or <code class="codeph">c##</code>, and must contain only ASCII or EBCDIC characters. For example, a CDB administrator might create common user <code class="codeph">c##dba</code>, and then grant the <code class="codeph">DBA</code> role commonly to this user, so that <code class="codeph">c##dba</code> has the <code class="codeph">DBA</code> role in any existing and future PDB.</p>
<p>A user can only perform common operations on a common role, for example, granting privileges commonly to the role, when the following criteria are met:</p>
<ul style="list-style-type: disc;">
<li>
<p>The user is a common user whose current container is root.</p>
</li>
<li>
<p>The user has the <code class="codeph">SET CONTAINER</code> privilege granted commonly, which means that the privilege applies in all containers.</p>
</li>
<li>
<p>The user has privilege controlling the ability to perform the specified operation, and this privilege has been granted commonly (see <span class="q">&#34;<a href="cdblogic.htm#GUID-30BAB0BC-3FCA-469C-A578-161271EAEB05" title="Privileges and common roles may be granted commonly.">Roles and Privileges Granted Commonly in a CDB</a>&#34;</span>).</p>
</li>
</ul>
<p>For example, to create a common role, a common user must have the <code class="codeph">CREATE ROLE</code> and the <code class="codeph">SET CONTAINER</code> privileges granted commonly. In the <code class="codeph">CREATE ROLE</code> statement, the <code class="codeph">CONTAINER=ALL</code> clause specifies that the role is common.</p>
<div class="infoboxnotealso" id="GUID-41E5D1A9-30D4-4FFF-A74F-F1173D8B1BF7__GUID-D4A22D52-4971-4C0F-9850-B06341E44F16">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink DBSEG761" target="_blank" href="../DBSEG/authorization.htm#DBSEG761"><span class="italic">Oracle Database Security Guide</span></a> to learn how to manage common roles</p>
</li>
<li>
<p><a class="olink SQLRF01311" target="_blank" href="../SQLRF/statements_6014.htm#SQLRF01311"><span class="italic">Oracle Database SQL Language Reference</span></a> to learn about the <code class="codeph">CREATE ROLE</code> statement</p>
</li>
</ul>
</div>
</div>
</div>
<a id="CNCPT89354"></a>
<div class="props_rev_3"><a id="GUID-243E6C32-C69E-4829-A419-1CF1E8FE3892"></a>
<h4 id="CNCPT-GUID-243E6C32-C69E-4829-A419-1CF1E8FE3892" class="sect4">Local Roles in a CDB</h4>
<div>
<p>A <span class="bold">local role</span> exists only in a single PDB, just as a role in a non-CDB exists only in the non-CDB. A local role can only contain roles and privileges that apply within the container in which the role exists.</p>
<p>PDBs in the same CDB may contain local roles with the same name. For example, the user-created role <code class="codeph">pdbadmin</code> may exist in both <code class="codeph">hrpdb</code> and <code class="codeph">salespdb</code>. These roles are completely independent of each other, just as they would be in separate non-CDBs.</p>
<div class="infoboxnotealso" id="GUID-243E6C32-C69E-4829-A419-1CF1E8FE3892__GUID-71376A80-117C-4462-A08C-DBBFB2D16905">
<p class="notep1">See Also:</p>
<p><a class="olink DBSEG761" target="_blank" href="../DBSEG/authorization.htm#DBSEG761"><span><cite>Oracle Database Security Guide</cite></span></a> to learn how to manage local roles</p>
</div>
</div>
</div>
</div>
<a id="CNCPT89261"></a>
<div class="props_rev_3"><a id="GUID-16473474-7F47-4E40-A592-01836E7D911C"></a>
<h3 id="CNCPT-GUID-16473474-7F47-4E40-A592-01836E7D911C" class="sect3">Overview of Privilege and Role Grants in a CDB</h3>
<div>
<p>Just as in a non-CDB, users in a CDB can grant roles and privileges. A key difference in a CDB is the distinction between roles and privileges that are locally granted and commonly granted. A privilege or role granted locally is exercisable only in the container in which it was granted. A privilege or role granted commonly is exercisable in every existing and future container.</p>
<p>Users and roles may be common or local. However, a privilege is <span class="italic">in itself</span> neither common nor local. If a user grants a privilege locally using the <code class="codeph">CONTAINER=CURRENT</code> clause, then the grantee has a privilege exercisable only in the current container. If a user grants a privilege commonly using the <code class="codeph">CONTAINER=ALL</code> clause, then the grantee has a privilege exercisable in any existing and future container.</p>
</div>
<a id="CNCPT89355"></a>
<div class="props_rev_3"><a id="GUID-EA93A258-63A2-481D-A1E1-B6F06EC9EDBC"></a>
<h4 id="CNCPT-GUID-EA93A258-63A2-481D-A1E1-B6F06EC9EDBC" class="sect4">Principles of Privilege and Role Grants in a CDB</h4>
<div>
<p>In a CDB, every act of granting, whether local or common, occurs within a specific container.</p>
<p>The basic principles of granting are as follows:</p>
<ul style="list-style-type: disc;">
<li>
<p>Both common and local phenomena may grant and be granted locally.</p>
</li>
<li>
<p>Only common phenomena may grant or be granted commonly.</p>
</li>
</ul>
<p>Local users, roles, and privileges are by definition restricted to a particular container. Thus, local users may not grant roles and privileges commonly, and local roles and privileges may not be granted commonly.</p>
<p>The following sections describe the implications of the preceding principles.</p>
</div>
</div>
<a id="CNCPT89356"></a><a id="CNCPT89262"></a>
<div class="props_rev_3"><a id="GUID-3E2C71F3-1B94-4D3E-A7E7-92BB76511D73"></a>
<h4 id="CNCPT-GUID-3E2C71F3-1B94-4D3E-A7E7-92BB76511D73" class="sect4">Privileges and Roles Granted Locally in a CDB</h4>
<div>
<p>Roles and privileges may be granted locally to users and roles <span class="italic">regardless</span> of whether the grantees, grantors, or roles being granted are local or common.</p>
<p>The following table explains the valid possibilities for locally granted roles and privileges.</p>
<div class="tblformal" id="GUID-3E2C71F3-1B94-4D3E-A7E7-92BB76511D73__CIHIDGBB">
<p class="titleintable">Table 18-5 Local Grants</p>
<table class="cellalignment1206" title="Local Grants" summary="This table explains the valid possibilities for locally granted roles and privileges.">
<thead>
<tr class="cellalignment1197">
<th class="cellalignment1236" id="d83305e8187">Phenomenon</th>
<th class="cellalignment1236" id="d83305e8190">May Grant Locally</th>
<th class="cellalignment1236" id="d83305e8193">May Be Granted Locally</th>
<th class="cellalignment1236" id="d83305e8196">May Receive a Role or Privilege Granted Locally</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1197">
<td class="cellalignment1238" id="d83305e8201" headers="d83305e8187">
<p>Common User</p>
</td>
<td class="cellalignment1238" headers="d83305e8201 d83305e8190">
<p>Yes</p>
</td>
<td class="cellalignment1238" headers="d83305e8201 d83305e8193">
<p>N/A</p>
</td>
<td class="cellalignment1238" headers="d83305e8201 d83305e8196">
<p>Yes</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1238" id="d83305e8214" headers="d83305e8187">
<p>Local User</p>
</td>
<td class="cellalignment1238" headers="d83305e8214 d83305e8190">
<p>Yes</p>
</td>
<td class="cellalignment1238" headers="d83305e8214 d83305e8193">
<p>N/A</p>
</td>
<td class="cellalignment1238" headers="d83305e8214 d83305e8196">
<p>Yes</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1238" id="d83305e8227" headers="d83305e8187">
<p>Common Role</p>
</td>
<td class="cellalignment1238" headers="d83305e8227 d83305e8190">
<p>N/A</p>
</td>
<td class="cellalignment1238" headers="d83305e8227 d83305e8193">
<p>Yes<a id="fn_1" href="#fn_1" onclick="footdisplay(1,&#34;Privileges in this role are available to the grantee only in the container in which the role was granted, regardless of whether the privileges were granted to the role locally or commonly. &#34;)"><sup>Foot&nbsp;1</sup></a></p>
</td>
<td class="cellalignment1238" headers="d83305e8227 d83305e8196">
<p>Yes</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1238" id="d83305e8243" headers="d83305e8187">
<p>Local Role</p>
</td>
<td class="cellalignment1238" headers="d83305e8243 d83305e8190">
<p>N/A</p>
</td>
<td class="cellalignment1238" headers="d83305e8243 d83305e8193">
<p>Yes<a id="fn_2" href="#fn_2" onclick="footdisplay(2,&#34;Privileges in this role are available to the grantee only in the container in which the role was granted and created. &#34;)"><sup>Foot&nbsp;2</sup></a></p>
</td>
<td class="cellalignment1238" headers="d83305e8243 d83305e8196">
<p>Yes</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1238" id="d83305e8259" headers="d83305e8187">
<p>Privilege</p>
</td>
<td class="cellalignment1238" headers="d83305e8259 d83305e8190">
<p>N/A</p>
</td>
<td class="cellalignment1238" headers="d83305e8259 d83305e8193">
<p>Yes</p>
</td>
<td class="cellalignment1238" headers="d83305e8259 d83305e8196">
<p>N/A</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;1</sup></p>
<p>Privileges in this role are available to the grantee only in the container in which the role was granted, regardless of whether the privileges were granted to the role locally or commonly.</p>
<p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;2</sup></p>
<p>Privileges in this role are available to the grantee only in the container in which the role was granted and created.</p>
</div>
<a id="CNCPT89357"></a>
<div class="props_rev_3"><a id="GUID-32330FD6-C021-4E5A-82D7-C745F58913E6"></a>
<h5 id="CNCPT-GUID-32330FD6-C021-4E5A-82D7-C745F58913E6" class="sect5">What Makes a Grant Local</h5>
<div>
<p>A role or privilege is granted locally when the following criteria are met:</p>
<ul style="list-style-type: disc;">
<li>
<p>The grantor has the necessary privileges to grant the specified role or privileges.</p>
<p>For system roles and privileges, the grantor must have the <code class="codeph">ADMIN</code> <code class="codeph">OPTION</code> for the role or privilege being granted. For object privileges, the grantor must have the <code class="codeph">GRANT</code> <code class="codeph">OPTION</code> for the privilege being granted.</p>
</li>
<li>
<p>The grant applies to only one container.</p>
<p>By default, the <code class="codeph">GRANT</code> statement includes the <code class="codeph">CONTAINER=CURRENT</code> clause, which indicates that the privilege or role is being granted locally.</p>
</li>
</ul>
</div>
</div>
<a id="CNCPT89358"></a>
<div class="props_rev_3"><a id="GUID-4DE0907B-4F26-450E-8A4C-1D19A2563561"></a>
<h5 id="CNCPT-GUID-4DE0907B-4F26-450E-8A4C-1D19A2563561" class="sect5">Roles and Privileges Granted Locally</h5>
<div>
<p>A user or role may be locally granted a <span class="italic">privilege</span> (<code class="codeph">CONTAINER=CURRENT</code>).</p>
<p>For example, a <code class="codeph">READ ANY TABLE</code> privilege granted locally to a local or common user in <code class="codeph">hrpdb</code> applies only to <span class="italic">this</span> user in <span class="italic">this</span> PDB. Analogously, the <code class="codeph">READ ANY TABLE</code> privilege granted to user <code class="codeph">hr</code> in a non-CDB has no bearing on the privileges of an <code class="codeph">hr</code> user that exists in a separate non-CDB.</p>
<p>A user or role may be locally granted a <span class="italic">role</span> (<code class="codeph">CONTAINER=CURRENT</code>). As shown in <a href="cdblogic.htm#GUID-3E2C71F3-1B94-4D3E-A7E7-92BB76511D73__CIHIDGBB" title="This table explains the valid possibilities for locally granted roles and privileges.">Table 18-5</a>, a <span class="italic">common</span> role may receive a privilege granted <span class="italic">locally</span>. For example, the common role <code class="codeph">c##dba</code> may be granted the <code class="codeph">READ ANY TABLE</code> privilege locally in <code class="codeph">hrpdb</code>. If the <code class="codeph">c##cdb</code> common role is granted locally, then privileges in the role apply <span class="italic">only</span> in the container in which the role is granted. In this example, a common user who has the <code class="codeph">c##cdba</code> role does not, because of a privilege granted locally to this role in <code class="codeph">hrpdb</code>, have the right to exercise this privilege in any PDB other than <code class="codeph">hrpdb</code>.</p>
<div class="infoboxnotealso" id="GUID-4DE0907B-4F26-450E-8A4C-1D19A2563561__GUID-EACE83F6-4C19-40B0-BBE0-B6DB0D1794CB">
<p class="notep1">See Also:</p>
<p><a class="olink DBSEG588" target="_blank" href="../DBSEG/authorization.htm#DBSEG588"><span><cite>Oracle Database Security Guide</cite></span></a> to learn how to grant roles and privileges in a CDB</p>
</div>
</div>
</div>
</div>
<a id="CNCPT89360"></a><a id="CNCPT89359"></a>
<div class="props_rev_3"><a id="GUID-30BAB0BC-3FCA-469C-A578-161271EAEB05"></a>
<h4 id="CNCPT-GUID-30BAB0BC-3FCA-469C-A578-161271EAEB05" class="sect4">Roles and Privileges Granted Commonly in a CDB</h4>
<div>
<p>Privileges and common roles may be granted commonly.</p>
<p>User accounts or roles may be granted roles and privileges commonly only if the grantees and grantors are both <span class="italic">common</span>. If a role is being granted commonly, then the role itself must be common. The following table explains the possibilities for common grants.</p>
<div class="tblformal" id="GUID-30BAB0BC-3FCA-469C-A578-161271EAEB05__CIHCHGGB">
<p class="titleintable">Table 18-6 Common Grants</p>
<table class="cellalignment1206" title="Common Grants" summary="This table explains the possibilities for common grants.">
<thead>
<tr class="cellalignment1197">
<th class="cellalignment1252" id="d83305e9128">Phenomenon</th>
<th class="cellalignment1219" id="d83305e9131">May Grant Commonly</th>
<th class="cellalignment1256" id="d83305e9134">May Be Granted Commonly</th>
<th class="cellalignment1226" id="d83305e9137">May Receive Roles and Privileges Granted Commonly</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1197">
<td class="cellalignment1254" id="d83305e9142" headers="d83305e9128">
<p>Common User Account</p>
</td>
<td class="cellalignment1221" headers="d83305e9142 d83305e9131">
<p>Yes</p>
</td>
<td class="cellalignment1257" headers="d83305e9142 d83305e9134">
<p>N/A</p>
</td>
<td class="cellalignment1229" headers="d83305e9142 d83305e9137">
<p>Yes</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1254" id="d83305e9155" headers="d83305e9128">
<p>Local User Account</p>
</td>
<td class="cellalignment1221" headers="d83305e9155 d83305e9131">
<p>No</p>
</td>
<td class="cellalignment1257" headers="d83305e9155 d83305e9134">
<p>N/A</p>
</td>
<td class="cellalignment1229" headers="d83305e9155 d83305e9137">
<p>No</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1254" id="d83305e9168" headers="d83305e9128">
<p>Common Role</p>
</td>
<td class="cellalignment1221" headers="d83305e9168 d83305e9131">
<p>N/A</p>
</td>
<td class="cellalignment1257" headers="d83305e9168 d83305e9134">
<p>Yes<a id="fn_3" href="#fn_3" onclick="footdisplay(3,&#34;Privileges that were granted commonly to a common role are available to the grantee across all containers. In addition, any privilege granted locally to a common role is available to the grantee only in the container in which that privilege was granted to the common role. &#34;)"><sup>Foot&nbsp;3</sup></a></p>
</td>
<td class="cellalignment1229" headers="d83305e9168 d83305e9137">
<p>Yes</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1254" id="d83305e9184" headers="d83305e9128">
<p>Local Role</p>
</td>
<td class="cellalignment1221" headers="d83305e9184 d83305e9131">
<p>N/A</p>
</td>
<td class="cellalignment1257" headers="d83305e9184 d83305e9134">
<p>No</p>
</td>
<td class="cellalignment1229" headers="d83305e9184 d83305e9137">
<p>No</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1254" id="d83305e9197" headers="d83305e9128">
<p>Privilege</p>
</td>
<td class="cellalignment1221" headers="d83305e9197 d83305e9131">
<p>N/A</p>
</td>
<td class="cellalignment1257" headers="d83305e9197 d83305e9134">
<p>Yes</p>
</td>
<td class="cellalignment1229" headers="d83305e9197 d83305e9137">
<p>N/A</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;3</sup></p>
<p>Privileges that were granted commonly to a common role are available to the grantee across all containers. In addition, any privilege granted locally to a common role is available to the grantee only in the container in which that privilege was granted to the common role.</p>
<div class="infoboxnotealso" id="GUID-30BAB0BC-3FCA-469C-A578-161271EAEB05__GUID-5D05879E-C26F-41A5-B8E8-83EA7F5FF43C">
<p class="notep1">See Also:</p>
<p><a class="olink GUID-0EF81AD5-7102-499A-81F3-74ECCDFC2926" target="_blank" href="../DBSEG/authorization.htm#GUID-0EF81AD5-7102-499A-81F3-74ECCDFC2926"><span><cite>Oracle Database Security Guide</cite></span></a> to learn more about common grants</p>
</div>
</div>
<a id="CNCPT89361"></a>
<div class="props_rev_3"><a id="GUID-0AD54CDC-69C9-4ED3-B98C-BD397B06D0DE"></a>
<h5 id="CNCPT-GUID-0AD54CDC-69C9-4ED3-B98C-BD397B06D0DE" class="sect5">What Makes a Grant Common</h5>
<div>
<p>A role or privilege is granted commonly when the following criteria are met:</p>
<ul style="list-style-type: disc;">
<li>
<p>The grantor is a common user.</p>
</li>
<li>
<p>The grantee is a common user or common role.</p>
</li>
<li>
<p>The grantor has the necessary privileges to grant the specified role or privileges.</p>
<p>For system roles and privileges, the grantor must have the <code class="codeph">ADMIN</code> <code class="codeph">OPTION</code> for the role or privilege being granted. For object privileges, the grantor must have the <code class="codeph">GRANT</code> <code class="codeph">OPTION</code> for the privilege being granted.</p>
</li>
<li>
<p>The grant applies to all containers.</p>
<p>The <code class="codeph">GRANT</code> statement includes a <code class="codeph">CONTAINER=ALL</code> clause specifying that the privilege or role is being granted commonly.</p>
</li>
<li>
<p>If a role is being granted, then it must be common, and if an object privilege is being granted, then the object on which the privilege is granted must be common.</p>
</li>
</ul>
</div>
</div>
<a id="CNCPT89362"></a>
<div class="props_rev_3"><a id="GUID-13FAB488-8475-4B7B-A153-5C4BF61D834F"></a>
<h5 id="CNCPT-GUID-13FAB488-8475-4B7B-A153-5C4BF61D834F" class="sect5">Roles and Privileges Granted Commonly</h5>
<div>
<p>A common user or role may be commonly granted a <span class="italic">privilege</span> (<code class="codeph">CONTAINER=ALL</code>). The privilege is granted to this common user or role in all existing and future containers. For example, a <code class="codeph">SELECT ANY TABLE</code> privilege granted commonly to common user <code class="codeph">c##dba</code> applies to this user in all containers.</p>
<p>A user or role may receive a common role granted commonly. As mentioned in a footnote on <a href="cdblogic.htm#GUID-30BAB0BC-3FCA-469C-A578-161271EAEB05__CIHCHGGB" title="This table explains the possibilities for common grants.">Table 18-6</a>, a common role may receive a privilege granted locally. Thus, a common user can be granted a common role, and this role may contain locally granted privileges. For example, the common role <code class="codeph">c##admin</code> may be granted the <code class="codeph">SELECT ANY TABLE</code> privilege that is local to <code class="codeph">hrpdb</code>. Locally granted privileges in a common role apply <span class="italic">only</span> in the container in which the privilege was granted. Thus, the common user with the <code class="codeph">c##admin</code> role does not have the right to exercise an <code class="codeph">hrpdb</code>-contained privilege in <code class="codeph">salespdb</code> or any PDB other than <code class="codeph">hrpdb</code>.</p>
<div class="infoboxnotealso" id="GUID-13FAB488-8475-4B7B-A153-5C4BF61D834F__GUID-C56B0D25-0458-4FE5-B2D3-5853EFDAF22C">
<p class="notep1">See Also:</p>
<p><a class="olink DBSEG588" target="_blank" href="../DBSEG/authorization.htm#DBSEG588"><span class="italic">Oracle Database Security Guide</span></a> to learn how to grant roles and privileges in a CDB</p>
</div>
</div>
</div>
</div>
<a id="CNCPT89363"></a>
<div class="props_rev_3"><a id="GUID-B0D2B368-83B2-4876-A06E-A6A86046530C"></a>
<h4 id="CNCPT-GUID-B0D2B368-83B2-4876-A06E-A6A86046530C" class="sect4">Grants to PUBLIC in a CDB</h4>
<div>
<p>In a CDB, <code class="codeph">PUBLIC</code> is a common role. In a PDB, privileges granted locally to <code class="codeph">PUBLIC</code> enable all local and common user account to exercise these privileges in this PDB only.</p>
<p>Every privilege and role granted to Oracle-supplied users and roles is granted commonly except for system privileges granted to <code class="codeph">PUBLIC</code>, which are granted locally. This exception exists because you may want to revoke some grants included by default in Oracle Database, such as <code class="codeph">EXECUTE</code> on the <code class="codeph">SYS.UTL_FILE</code> package.</p>
<p>Assume that local user account <code class="codeph">hr</code> exists in <code class="codeph">hrpdb</code>. This user locally grants the <code class="codeph">SELECT</code> privilege on <code class="codeph">hr.employees</code> to <code class="codeph">PUBLIC</code>. Common and local users in <code class="codeph">hrpdb</code> may exercise the privilege granted to <code class="codeph">PUBLIC</code>. User accounts in <code class="codeph">salespdb</code> or any other PDB do not have the privilege to query <code class="codeph">hr.employees</code> in <code class="codeph">hrpdb</code>.</p>
<p>Privileges granted commonly to <code class="codeph">PUBLIC</code> enable all local users to exercise the granted privilege in their respective PDBs and enable all common users to exercise this privilege in the PDBs to which they have access. Oracle recommends that users do not commonly grant privileges and roles to <code class="codeph">PUBLIC</code>.</p>
<div class="infoboxnotealso" id="GUID-B0D2B368-83B2-4876-A06E-A6A86046530C__GUID-B9F2FF6E-D53E-4326-803C-47B48E4C5745">
<p class="notep1">See Also:</p>
<p><a class="olink GUID-8386733A-6F0E-41D0-9E77-4E767FFE91C9" target="_blank" href="../DBSEG/authorization.htm#GUID-8386733A-6F0E-41D0-9E77-4E767FFE91C9"><span><cite>Oracle Database Security Guide</cite></span></a> to learn how the <code class="codeph">PUBLIC</code> role works in a multitenant environment</p>
</div>
</div>
</div>
<a id="CNCPT89365"></a><a id="CNCPT89364"></a>
<div class="props_rev_3"><a id="GUID-8F48CCCC-200B-46C1-8C0D-9410FF54CEA7"></a>
<h4 id="CNCPT-GUID-8F48CCCC-200B-46C1-8C0D-9410FF54CEA7" class="sect4">Grants of Privileges and Roles: Scenario</h4>
<div>
<p>In this scenario, <code class="codeph">SYSTEM</code> creates common user <code class="codeph">c##dba</code> and tries to give this user privileges to query a table in the <code class="codeph">hr</code> schema in <code class="codeph">hrpdb</code>.</p>
<p>The scenario shows how the <code class="codeph">CONTAINER</code> clause affects grants of roles and privileges. The first column shows operations in <code class="codeph">CDB$ROOT</code>. The second column shows operations in <code class="codeph">hrpdb</code>.</p>
<div class="tblformalwide" id="GUID-8F48CCCC-200B-46C1-8C0D-9410FF54CEA7__GRANTINGROLESANDPRIVILEGES-1BFD50E8">
<p class="titleintable">Table 18-7 Granting Roles and Privileges in a CDB</p>
<table class="cellalignment1211" title="Granting Roles and Privileges in a CDB" summary="This table shows the grants of roles and privileges in a CDB.">
<thead>
<tr class="cellalignment1197">
<th class="cellalignment1222" id="d83305e10368">t</th>
<th class="cellalignment1222" id="d83305e10371">Operations in CDB$ROOT</th>
<th class="cellalignment1222" id="d83305e10374">Operations in hrpdb</th>
<th class="cellalignment1222" id="d83305e10377">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e10382" headers="d83305e10368">
<p>t1</p>
</td>
<td class="cellalignment1223" headers="d83305e10382 d83305e10371">
<pre dir="ltr">SQL&gt; CONNECT SYSTEM@root
Enter password: *******
Connected.
</pre></td>
<td class="cellalignment1223" headers="d83305e10382 d83305e10374">
<p>n/a</p>
</td>
<td class="cellalignment1223" headers="d83305e10382 d83305e10377">
<p>Common user <code class="codeph">SYSTEM</code> connects to the root container.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e10398" headers="d83305e10368">
<p>t2</p>
</td>
<td class="cellalignment1223" headers="d83305e10398 d83305e10371">
<pre dir="ltr">SQL&gt; CREATE USER c##dba 
IDENTIFIED BY <span class="italic">password</span> 
CONTAINER=ALL;
</pre></td>
<td class="cellalignment1223" headers="d83305e10398 d83305e10374">
<p>n/a</p>
</td>
<td class="cellalignment1223" headers="d83305e10398 d83305e10377">
<p><code class="codeph">SYSTEM</code> creates common user <code class="codeph">c##dba</code>. The clause <code class="codeph">CONTAINER=ALL</code> makes the user a common user.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e10422" headers="d83305e10368">
<p>t3</p>
</td>
<td class="cellalignment1223" headers="d83305e10422 d83305e10371">
<pre dir="ltr">SQL&gt; GRANT CREATE SESSION 
  TO c##dba;
</pre></td>
<td class="cellalignment1223" headers="d83305e10422 d83305e10374">
<p>n/a</p>
</td>
<td class="cellalignment1223" headers="d83305e10422 d83305e10377">
<p><code class="codeph">SYSTEM</code> grants the <code class="codeph">CREATE SESSION</code> system privilege to <code class="codeph">c##dba</code>. Because the clause <code class="codeph">CONTAINER=ALL</code> is absent, this privilege is granted locally and thus applies <span class="italic">only</span> to the root, which is the current container.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e10449" headers="d83305e10368">
<p>t4</p>
</td>
<td class="cellalignment1223" headers="d83305e10449 d83305e10371">
<pre dir="ltr">SQL&gt; CREATE ROLE c##admin 
  CONTAINER=ALL;
</pre></td>
<td class="cellalignment1223" headers="d83305e10449 d83305e10374">
<p>n/a</p>
</td>
<td class="cellalignment1223" headers="d83305e10449 d83305e10377">
<p><code class="codeph">SYSTEM</code> creates a common role named <code class="codeph">c##admin</code>. The clause <code class="codeph">CONTAINER=ALL</code> makes the role a common role.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e10470" headers="d83305e10368">
<p>t5</p>
</td>
<td class="cellalignment1223" headers="d83305e10470 d83305e10371">
<pre dir="ltr">SQL&gt; GRANT SELECT ANY TABLE 
  TO c##admin;
Grant succeeded.
</pre></td>
<td class="cellalignment1223" headers="d83305e10470 d83305e10374">
<p>n/a</p>
</td>
<td class="cellalignment1223" headers="d83305e10470 d83305e10377">
<p><code class="codeph">SYSTEM</code> grants the <code class="codeph">SELECT ANY TABLE</code> privilege to the <code class="codeph">c##admin</code> role. The absence of the <code class="codeph">CONTAINER=ALL</code> clause makes the privilege local to the root. Thus, this common role contains a privilege that is exercisable only in the root.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e10494" headers="d83305e10368">
<p>t6</p>
</td>
<td class="cellalignment1223" headers="d83305e10494 d83305e10371">
<pre dir="ltr">SQL&gt; GRANT c##admin TO c##dba;
SQL&gt; EXIT;
</pre></td>
<td class="cellalignment1223" headers="d83305e10494 d83305e10374">
<p>n/a</p>
</td>
<td class="cellalignment1223" headers="d83305e10494 d83305e10377">
<p><code class="codeph">SYSTEM</code> grants the <code class="codeph">c##admin</code> role to <code class="codeph">c##dba</code>. Because the <code class="codeph">CONTAINER=ALL</code> clause is absent, the role applies <span class="italic">only</span> to the current container, even though it is a common role. If <code class="codeph">c##dba</code> connects to a PDB, then <code class="codeph">c##dba</code> does not have this role.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e10528" headers="d83305e10368">
<p>t7</p>
</td>
<td class="cellalignment1223" headers="d83305e10528 d83305e10371">
<p>n/a</p>
</td>
<td class="cellalignment1223" headers="d83305e10528 d83305e10374">
<pre dir="ltr">SQL&gt; CONNECT c##dba@hrpdb
Enter password: *******
ERROR: ORA-01045: user c##dba
lacks CREATE SESSION privilege;
logon denied
</pre></td>
<td class="cellalignment1223" headers="d83305e10528 d83305e10377">
<p><code class="codeph">c##dba</code> fails to connect to <code class="codeph">hrpdb</code> because the grant at t3 was local to the root.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e10546" headers="d83305e10368">
<p>t8</p>
</td>
<td class="cellalignment1223" headers="d83305e10546 d83305e10371">
<p>n/a</p>
</td>
<td class="cellalignment1223" headers="d83305e10546 d83305e10374">
<pre dir="ltr">SQL&gt; CONNECT SYSTEM@hrpdb
Enter password: *******
Connected.
</pre></td>
<td class="cellalignment1223" headers="d83305e10546 d83305e10377">
<p><code class="codeph">SYSTEM</code> connects to <code class="codeph">hrpdb</code>.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e10564" headers="d83305e10368">
<p>t9</p>
</td>
<td class="cellalignment1223" headers="d83305e10564 d83305e10371">
<p>n/a</p>
</td>
<td class="cellalignment1223" headers="d83305e10564 d83305e10374">
<pre dir="ltr">SQL&gt; GRANT CONNECT, RESOURCE TO c##dba;
Grant succeeded.
SQL&gt; EXIT
</pre></td>
<td class="cellalignment1223" headers="d83305e10564 d83305e10377">
<p><code class="codeph">SYSTEM</code> grants the <code class="codeph">CONNECT</code> and <code class="codeph">RESOURCE</code> roles to common user <code class="codeph">c##dba</code>. Because the clause <code class="codeph">CONTAINER=ALL</code> is absent, the grant is local to <code class="codeph">hrpdb</code>.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e10594" headers="d83305e10368">
<p>t10</p>
</td>
<td class="cellalignment1223" headers="d83305e10594 d83305e10371">
<p>n/a</p>
</td>
<td class="cellalignment1223" headers="d83305e10594 d83305e10374">
<pre dir="ltr">SQL&gt; CONNECT c##dba@hrpdb
Enter password: *******
Connected.
</pre></td>
<td class="cellalignment1223" headers="d83305e10594 d83305e10377">
<p>Common user <code class="codeph">c##dba</code> connects to <code class="codeph">hrpdb</code>.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e10613" headers="d83305e10368">
<p>t11</p>
</td>
<td class="cellalignment1223" headers="d83305e10613 d83305e10371">
<p>n/a</p>
</td>
<td class="cellalignment1223" headers="d83305e10613 d83305e10374">
<pre dir="ltr">SQL&gt; SELECT COUNT(*)
FROM hr.employees;
select * from hr.employees
                 *
ERROR at line 1:
ORA-00942: table or view does
not exist
</pre></td>
<td class="cellalignment1223" headers="d83305e10613 d83305e10377">
<p>The query of <code class="codeph">hr.employees</code> still returns an error because <code class="codeph">c##dba</code> does not have select privileges on tables in <code class="codeph">hrpdb</code>. The <code class="codeph">SELECT ANY TABLE</code> privilege granted locally at t5 is restricted to the root and thus does not apply to <code class="codeph">hrpdb</code>.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e10642" headers="d83305e10368">
<p>t12</p>
</td>
<td class="cellalignment1223" headers="d83305e10642 d83305e10371">
<pre dir="ltr">SQL&gt; CONNECT SYSTEM@root
Enter password: *******
Connected.
</pre></td>
<td class="cellalignment1223" headers="d83305e10642 d83305e10374">
<p>n/a</p>
</td>
<td class="cellalignment1223" headers="d83305e10642 d83305e10377">
<p>Common user <code class="codeph">SYSTEM</code> connects to the root container.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e10658" headers="d83305e10368">
<p>t13</p>
</td>
<td class="cellalignment1223" headers="d83305e10658 d83305e10371">
<pre dir="ltr">SQL&gt; GRANT SELECT ANY TABLE
 TO c##admin CONTAINER=ALL;
Grant succeeded.
</pre></td>
<td class="cellalignment1223" headers="d83305e10658 d83305e10374">
<p>n/a</p>
</td>
<td class="cellalignment1223" headers="d83305e10658 d83305e10377">
<p><code class="codeph">SYSTEM</code> grants the <code class="codeph">SELECT ANY TABLE</code> privilege to the <code class="codeph">c##admin</code> role. The presence of <code class="codeph">CONTAINER=ALL</code> means the privilege is being granted commonly.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e10682" headers="d83305e10368">
<p>t14</p>
</td>
<td class="cellalignment1223" headers="d83305e10682 d83305e10371">
<p>n/a</p>
</td>
<td class="cellalignment1223" headers="d83305e10682 d83305e10374">
<pre dir="ltr">SQL&gt; SELECT COUNT(*) FROM 
  hr.employees;
select * from hr.employees
                 *
ERROR at line 1:
ORA-00942: table or view does
not exist
</pre></td>
<td class="cellalignment1223" headers="d83305e10682 d83305e10377">
<p>A query of <code class="codeph">hr.employees</code> still returns an error. The reason is that at t6 the <code class="codeph">c##admin</code> common role was granted to <code class="codeph">c##dba</code> in the root only.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e10704" headers="d83305e10368">
<p>t15</p>
</td>
<td class="cellalignment1223" headers="d83305e10704 d83305e10371">
<pre dir="ltr">SQL&gt; GRANT c##admin TO c##dba
  CONTAINER=ALL;
Grant succeeded.
</pre></td>
<td class="cellalignment1223" headers="d83305e10704 d83305e10374">
<p>n/a</p>
</td>
<td class="cellalignment1223" headers="d83305e10704 d83305e10377">
<p><code class="codeph">SYSTEM</code> grants the common role named <code class="codeph">c##admin</code> to <code class="codeph">c##dba</code>, specifying <code class="codeph">CONTAINER=ALL</code>. Now user <code class="codeph">c##dba</code> has the role in <span class="italic">all</span> containers, not just the root.</p>
</td>
</tr>
<tr class="cellalignment1197">
<td class="cellalignment1223" id="d83305e10734" headers="d83305e10368">
<p>t17</p>
</td>
<td class="cellalignment1223" headers="d83305e10734 d83305e10371">
<p>n/a</p>
</td>
<td class="cellalignment1223" headers="d83305e10734 d83305e10374">
<pre dir="ltr">SQL&gt; SELECT COUNT(*)
  FROM hr.employees;

  COUNT(*)
----------
       107
</pre></td>
<td class="cellalignment1223" headers="d83305e10734 d83305e10377">
<p>The query succeeds.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="infoboxnotealso" id="GUID-8F48CCCC-200B-46C1-8C0D-9410FF54CEA7__GUID-A1BE1E0C-89BD-4466-A30C-5EC8CA7F186F">
<p class="notep1">See Also:</p>
<p><a class="olink DBSEG761" target="_blank" href="../DBSEG/authorization.htm#DBSEG761"><span><cite>Oracle Database Security Guide</cite></span></a> to learn how to manage common and local roles</p>
</div>
</div>
</div>
</div>
<a id="CNCPT89267"></a>
<div class="props_rev_3"><a id="GUID-232E8018-9BA8-4412-BAA6-98FC9B19D8E3"></a>
<h3 id="CNCPT-GUID-232E8018-9BA8-4412-BAA6-98FC9B19D8E3" class="sect3">Overview of Common Audit Configurations</h3>
<div>
<p>For both mixed mode and unified auditing, a <span class="bold">common audit configuration</span> is visible and enforced across all PDBs.</p>
<p>Audit configurations are either local or common. The scoping rules that apply to other local or common phenomena, such as users and roles, all apply to audit configurations.</p>
<div class="infobox-note" id="GUID-232E8018-9BA8-4412-BAA6-98FC9B19D8E3__GUID-681F518D-E24D-43BC-92EB-974F813DF239">
<p class="notep1">Note:</p>
<p>Audit initialization parameters exist at the CDB level and not in each PDB.</p>
</div>
<p>PDBs support the following auditing options:</p>
<ul style="list-style-type: disc;">
<li>
<p>Object auditing</p>
<p>Object auditing refers to audit configurations for specific objects. Only common objects can be part of the common audit configuration. A local audit configuration cannot contain common objects.</p>
</li>
<li>
<p>Audit policies</p>
<p>Audit policies can be local or common:</p>
<ul style="list-style-type: disc;">
<li>
<p>Local audit policies</p>
<p>A local audit policy applies to a single PDB. You can enforce local audit policies for local and common users in this PDB only. Attempts to enforce local audit policies across all containers result in an error.</p>
<p>In all cases, enforcing of a local audit policy is part of the local auditing framework.</p>
</li>
<li>
<p>Common audit policies</p>
<p>A common audit policy applies to all containers. This policy can only contain actions, system privileges, common roles, and common objects. You can apply a common audit policy only to common users. Attempts to enforce a common audit policy for a local user across all containers result in an error.</p>
</li>
</ul>
</li>
</ul>
<p>A common audit configuration is stored in the <code class="codeph">SYS</code> schema of the root. A local audit configuration is stored in the <code class="codeph">SYS</code> schema of the PDB to which it applies.</p>
<p>Audit trails are stored in the <code class="codeph">SYS</code> or <code class="codeph">AUDSYS</code> schemas of the relevant PDBs. Operating system and XML audit trails for PDBs are stored in subdirectories of the directory specified by the <code class="codeph">AUDIT_FILE_DEST</code> initialization parameter.</p>
<div class="infoboxnotealso" id="GUID-232E8018-9BA8-4412-BAA6-98FC9B19D8E3__GUID-A12F38D1-D41E-4997-ACD8-FEF29578082F">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="cmntopc.htm#GUID-377114CE-BCB9-4135-A8EE-44FFA43F1D6E" title="You can use a single SQL statement to create a named unified audit policy that specifies a set of audit options. These options can specify system privileges, actions, or roles to be audited inside the database.To perform auditing, you must be granted the appropriate system privileges.">Database Auditing</a>&#34;</span></p>
</li>
<li>
<p><a class="olink DBSEG617" target="_blank" href="../DBSEG/auditing.htm#DBSEG617"><span><cite>Oracle Database Security Guide</cite></span></a> to learn about common audit configurations</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<a id="CNCPT89269"></a><a id="CNCPT89268"></a>
<div class="props_rev_3"><a id="GUID-5902ABDC-40BE-4CF4-9917-A5D7F4C396F1"></a>
<h2 id="CNCPT-GUID-5902ABDC-40BE-4CF4-9917-A5D7F4C396F1" class="sect2">Overview of Tablespaces and Database Files in a CDB</h2>
<div>
<p>A CDB has the same structure as a non-CDB, except that each PDB and application root has its own set of tablespaces, including its own <code class="codeph">SYSTEM</code>, <code class="codeph">SYSAUX</code>, and undo tablespaces.</p>
<p>A CDB contains the following files:</p>
<ul style="list-style-type: disc;">
<li>
<p>One <a href="glossary.htm#GUID-DF498605-D186-451B-87AA-73DF396AD599"><span class="xrefglossterm">control file</span></a></p>
</li>
<li>
<p>One <a href="glossary.htm#GUID-2A8BC112-AB70-4B06-9F85-FE975861CEE0"><span class="xrefglossterm">online redo log</span></a></p>
</li>
<li>
<p>One set of <a href="glossary.htm#GUID-297B963A-989C-4720-B061-A2352FF72892"><span class="xrefglossterm">undo data</span></a> files</p>
<p>In a single-instance CDB, only one active undo tablespace exists. For an Oracle RAC CDB, one active undo tablespace exists for every instance. Only a common user who has the appropriate privileges and whose current container is the root can create an undo tablespace. All undo tablespaces are visible in the data dictionaries and related views of all containers.</p>
</li>
<li>
<p><code class="codeph">SYSTEM</code> and <code class="codeph">SYSAUX</code> tablespaces for every container</p>
<p>The primary physical difference between CDBs and non-CDBs is the data files in <code class="codeph">SYSTEM</code> and <code class="codeph">SYSAUX</code>. A non-CDB has only one <code class="codeph">SYSTEM</code> tablespace and one <code class="codeph">SYSAUX</code> tablespace. In contrast, the CDB root and each PDB has its own <code class="codeph">SYSTEM</code> and <code class="codeph">SYSAUX</code> tablespaces. Each container also has its own set of dictionary tables describing the objects that reside in the container.</p>
</li>
<li>
<p>Zero or more user-created tablespaces</p>
<p>In a typical use case, each PDB has its own set of non-system tablespaces. These tablespaces contain the data for user-defined schemas and objects in the PDB.</p>
<p>Within a PDB, you manage permanent and temporary tablespaces in the same way that you manage them in a non-CDB. You can also limit the amount of storage used by the data files for a PDB by using the <code class="codeph">STORAGE</code> clause in a <code class="codeph">CREATE PLUGGABLE DATABASE</code> or <code class="codeph">ALTER PLUGGABLE DATABASE</code> statement.</p>
<p>The storage of the data dictionary within the PDB enables it to be portable. You can unplug a PDB from a CDB, and plug it in to a different CDB.</p>
</li>
<li>
<p>A set of temp files for every container</p>
<p>One default temporary tablespace exists for the CDB root, and one for every PDB.</p>
</li>
</ul>
<p>The following figure shows aspects of the physical storage architecture of a CDB with two PDBs: <code class="codeph">hrpdb</code> and <code class="codeph">salespdb</code>.</p>
<div class="figure" id="GUID-5902ABDC-40BE-4CF4-9917-A5D7F4C396F1__CEGEADHD">
<p class="titleinfigure">Figure 18-8 Architecture of a CDB</p>
<img width="648" height="347" src="img/GUID-26734233-E701-4680-B471-4E675D434754-default.png" alt="Description of Figure 18-8 follows" title="Description of Figure 18-8 follows"/><br/>
<a href="img_text/GUID-26734233-E701-4680-B471-4E675D434754-print.htm">Description of &#34;Figure 18-8 Architecture of a CDB&#34;</a></div>
<!-- class="figure" -->
<div class="infoboxnotealso" id="GUID-5902ABDC-40BE-4CF4-9917-A5D7F4C396F1__GUID-C37EF760-7083-4C71-83D4-274EC03E1D3B">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="cdblogic.htm#GUID-A356382A-413A-4A42-98DC-6C2464808202" title="From the user and application perspective, the data dictionary in each container in a CDB is separate, as it would be in a non-CDB.">Data Dictionary Architecture in a CDB</a>&#34;</span></p>
</li>
<li>
<p><span><cite>Oracle Database Administrator&rsquo;s Guide</cite></span> to learn about the state of a CDB after creation</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1196">
<tr>
<td class="cellalignment1203">
<table class="cellalignment1201">
<tr>
<td class="cellalignment1200"><a href="cdbovrvw.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1200"><a href="part_admdev.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1993, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1205">
<table class="cellalignment1199">
<tr>
<td class="cellalignment1200"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1200"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1200"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1200"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1200"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1200"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>


</body></html>