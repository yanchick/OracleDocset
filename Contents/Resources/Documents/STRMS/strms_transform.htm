<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-104479"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Rule-Based%20Transformations"></a><title>Rule-Based Transformations</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1032"/>
<meta name="dcterms.created" content="2014-12-23T13:28:6Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Streams Concepts and Administration"/>
<meta name="dcterms.identifier" content="E53116-02"/>
<meta name="dcterms.isVersionOf" content="STRMS"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2002, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="strms_glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="strms_rules.htm" title="Previous" type="text/html"/>
<link rel="Next" href="pt_adconcepts.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E53116-02.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">13/57</span> <!-- End Header -->
<div id="STRMS106" class="chapter"><a id="CACIIJHJ"></a> <a id="CACIHJBG"></a>
<h1 class="chapter"><span class="secnum">6</span> Rule-Based Transformations</h1>
<p><a id="sthref327"></a><a id="sthref328"></a><a id="sthref329"></a><a id="sthref330"></a>A <span class="bold">rule-based transformation</span> is any modification to a <a href="strms_glossary.htm#CHDFHHGJ"><span class="xrefglossterm">message</span></a> when a <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a> in a <a href="strms_glossary.htm#CHDEEDIJ"><span class="xrefglossterm">positive rule set</span></a> evaluates to <code dir="ltr">TRUE</code>. There are two types of rule-based transformations: declarative and custom.</p>
<p>The following topics contain information about rule-based transformations:</p>
<ul>
<li>
<p><a href="#CJADBDFH">Declarative Rule-Based Transformations</a></p>
</li>
<li>
<p><a href="#CJAFFDEE">Custom Rule-Based Transformations</a></p>
</li>
<li>
<p><a href="#CJAGDDAB">Rule-Based Transformations and Oracle Streams Clients</a></p>
</li>
<li>
<p><a href="#CACFFFIH">Transformation Ordering</a></p>
</li>
<li>
<p><a href="#CJAIJIFG">Considerations for Rule-Based Transformations</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_mtransform.htm#CHDGDHDE">Chapter 19, &#34;Managing Rule-Based Transformations&#34;</a></p>
</li>
<li>
<p><a href="strms_trmon.htm#CFFIAFJJ">Chapter 28, &#34;Monitoring Rule-Based Transformations&#34;</a></p>
</li>
<li>
<p><a href="strms_trrules.htm#BABEHCCE">Chapter 34, &#34;Troubleshooting Rules and Rule-Based Transformations&#34;</a></p>
</li>
</ul>
</div>
<a id="CJADBDFH"></a>
<div id="STRMS151" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Declarative Rule-Based Transformations<a id="sthref331"></a><a id="sthref332"></a><a id="sthref333"></a><a id="sthref334"></a><a id="sthref335"></a><a id="sthref336"></a><a id="sthref337"></a><a id="sthref338"></a></h2>
<p><span class="bold">Declarative rule-based transformations</span> cover a set of common transformation scenarios for row LCRs.</p>
<p>You specify (or declare) such a transformation using one of the following procedures in the <code dir="ltr">DBMS_STREAMS_ADM</code> package:</p>
<ul>
<li>
<p><code dir="ltr">ADD_COLUMN</code> either adds or removes a declarative transformation that adds a column to a row LCR.</p>
</li>
<li>
<p><code dir="ltr">DELETE_COLUMN</code> either adds or removes a declarative transformation that deletes a column from a row LCR.</p>
</li>
<li>
<p><code dir="ltr">KEEP_COLUMNS</code> either adds or removes a declarative transformation that keeps a list of columns in a row LCR. The transformation removes columns that are not in the list from the row LCR.</p>
</li>
<li>
<p><code dir="ltr">RENAME_COLUMN</code> either adds or removes a declarative transformation that renames a column in a row LCR.</p>
</li>
<li>
<p><code dir="ltr">RENAME_SCHEMA</code> either adds or removes a declarative transformation that renames the schema in a row LCR.</p>
</li>
<li>
<p><code dir="ltr">RENAME_TABLE</code> either adds or removes a declarative transformation that renames the table in a row LCR.</p>
</li>
</ul>
<p>When you specify a declarative rule-based transformation, you specify the <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a> that is associated with it. When the specified rule evaluates to <code dir="ltr">TRUE</code> for a row LCR, Oracle Streams performs the declarative transformation internally on the row LCR, without invoking PL/SQL.</p>
<p>Declarative rule-based transformations provide the following advantages:</p>
<ul>
<li>
<p>Performance is improved because the transformations are run internally without using PL/SQL.</p>
</li>
<li>
<p>Complexity is reduced because custom PL/SQL functions are not required.</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
Declarative rule-based transformations can transform row LCRs only. These row LCRs can be <a href="strms_glossary.htm#CHDCHEJI"><span class="xrefglossterm">captured LCR</span></a>s or <a href="strms_glossary.htm#CBAGDEIH"><span class="xrefglossterm">persistent LCR</span></a>s. Therefore, a DML rule must be specified when you run one of the procedures to add a declarative transformation. If a DDL rule is specified, then an error is raised.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_mtransform.htm#BABDFDEA">&#34;Managing Declarative Rule-Based Transformations&#34;</a></p>
</li>
<li>
<p><a href="ap_restrictions.htm#CIHICJBG">&#34;Unsupported Data Types for Declarative Rule-Based Transformations&#34;</a></p>
</li>
<li>
<p><a href="strms_capture.htm#i1006190">&#34;Row LCRs&#34;</a></p>
</li>
<li>
<p><a class="olink SQLRF0021" href="../SQLRF/sql_elements001.htm#SQLRF0021"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about data types</p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="CJAFFDEE"></a>
<div id="STRMS160" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Custom Rule-Based Transformations<a id="sthref339"></a><a id="sthref340"></a></h2>
<p><span class="bold">Custom rule-based transformations</span> require a user-defined PL/SQL function to perform the transformation. The function takes as input an <code dir="ltr">ANYDATA</code> object containing a <a href="strms_glossary.htm#CHDFHHGJ"><span class="xrefglossterm">message</span></a> and returns either an <code dir="ltr">ANYDATA</code> object containing the transformed message or an array that contains zero or more <code dir="ltr">ANYDATA</code> encapsulations of a message. A custom rule-based transformation function that returns one message is a one-to-one transformation function. A custom rule-based transformation function that can return more than one message in an array is a one-to-many transformation function. One-to-one transformation functions are supported for any type of <a href="strms_glossary.htm#CHDDDJGJ"><span class="xrefglossterm">Oracle Streams client</span></a>, but one-to-many transformation functions are supported only for Oracle Streams <a href="strms_glossary.htm#CHDBHECD"><span class="xrefglossterm">capture process</span></a>es and <a href="strms_glossary.htm#CBACHEDJ"><span class="xrefglossterm">synchronous capture</span></a>s.</p>
<p>To specify a custom rule-based transformation, use the <code dir="ltr">DBMS_STREAMS_ADM.SET_RULE_TRANSFORM_FUNCTION</code> procedure. You can use a custom rule-based transformation to modify <a href="strms_glossary.htm#CHDCHEJI"><span class="xrefglossterm">captured LCR</span></a>s, <a href="strms_glossary.htm#CBAGDEIH"><span class="xrefglossterm">persistent LCR</span></a>s, and <a href="strms_glossary.htm#CBAGGIDA"><span class="xrefglossterm">persistent user message</span></a>s.</p>
<p>For example, a custom rule-based transformation can be used when the data type of a particular column in a table is different at two different databases. The column might be a <code dir="ltr">NUMBER</code> column in the <a href="strms_glossary.htm#CHDHFBJG"><span class="xrefglossterm">source database</span></a> and a <code dir="ltr">VARCHAR2</code> column in the <a href="strms_glossary.htm#CHDGCAJA"><span class="xrefglossterm">destination database</span></a>. In this case, the transformation takes as input an <code dir="ltr">ANYDATA</code> object containing a row LCR with a <code dir="ltr">NUMBER</code> data type for a column and returns an <code dir="ltr">ANYDATA</code> object containing a row LCR with a <code dir="ltr">VARCHAR2</code> data type for the same column.</p>
<p>Other examples of custom transformations on messages include:</p>
<ul>
<li>
<p>Splitting a column into several columns</p>
</li>
<li>
<p>Combining several columns into one column</p>
</li>
<li>
<p>Modifying the contents of a column</p>
</li>
<li>
<p>Modifying the payload of a user message</p>
</li>
</ul>
<p>Custom rule-based transformations provide the following advantages:</p>
<ul>
<li>
<p>Flexibility is increased because you can use PL/SQL to perform custom transformations.</p>
</li>
<li>
<p>A wider range of messages can be transformed, including DDL LCRs and user messages, as well as row LCRs.</p>
</li>
</ul>
<p>The following considerations apply to custom rule-based transformations:</p>
<ul>
<li>
<p>When you perform custom rule-based transformations on DDL LCRs, you probably need to modify the DDL text in the DDL LCR to match any other modifications. For example, if the rule-based transformation changes the name of a table in the DDL LCR, then the rule-based transformation should change the table name in the DDL text in the same way.</p>
</li>
<li>
<p>If possible, avoid specifying a custom rule-based transformation for a <a href="strms_glossary.htm#CHDEJCHD"><span class="xrefglossterm">global rule</span></a> or <a href="strms_glossary.htm#CHDFAGCF"><span class="xrefglossterm">schema rule</span></a> if the transformation pertains to a relatively small number of LCRs that will evaluate to <code dir="ltr">TRUE</code> for the <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a>. For example, a custom rule-based transformation that operates on a single table can be specified for a schema rule, and this schema can contain hundreds of tables. Specifying such a rule-based transformation has performance implications because extra processing is required for the LCRs that will not be transformed.</p>
<p>To avoid specifying such a custom rule-based transformation, either you can use a <a href="strms_glossary.htm#CHDEAFJH"><span class="xrefglossterm">procedure DML handler</span></a> to perform the transformation, or you can specify the transformation for a <a href="strms_glossary.htm#CHDEGGGH"><span class="xrefglossterm">table rule</span></a> instead of a global or schema rule. However, replacing a global or schema rule with table rules results in an increase in the total number of rules and additional maintenance when a new table is added.</p>
</li>
<li>
<p>When a custom rule-based transformation that uses a one-to-one transformation function receives a <a href="strms_glossary.htm#CHDCHEJI"><span class="xrefglossterm">captured LCR</span></a> or <a href="strms_glossary.htm#CBAGDEIH"><span class="xrefglossterm">persistent LCR</span></a>, the transformation can construct a new LCR and return it. Similarly, when a custom rule-based transformation that uses a one-to-many transformation function receives a captured LCR or a persistent LCR, the transformation can construct multiple new LCRs and return them in an array.</p>
<p>For any LCR constructed and returned by a custom rule-based transformation, the <code dir="ltr">source_database_name</code>, <code dir="ltr">transaction_id</code>, and <code dir="ltr">scn</code> parameter values must match the values in the original LCR. Oracle automatically specifies the values in the original LCR for these parameters, even if an attempt is made to construct LCRs with different values.</p>
</li>
<li>
<p>A custom rule-based transformation that receives a <a href="strms_glossary.htm#CHDDIHEC"><span class="xrefglossterm">user message</span></a> can construct a new message and return it. In this case, the returned message can be an LCR constructed by the custom rule-based transformation.</p>
</li>
<li>
<p>A custom rule-based transformation cannot convert an LCR into a non-LCR message. This restriction applies to captured LCRs and persistent LCRs.</p>
</li>
<li>
<p>A custom rule-based transformation cannot convert a row LCR into a DDL LCR or a DDL LCR into a row LCR. This restriction applies to captured LCRs and persistent LCRs.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#BABIDDEI">&#34;Required Privileges for Custom Rule-Based Transformations&#34;</a></p>
</li>
<li>
<p><a href="strms_mtransform.htm#BABDDFEC">&#34;Managing Custom Rule-Based Transformations&#34;</a></p>
</li>
<li>
<p><a href="ap_restrictions.htm#BABEGFGC">&#34;Unsupported Data Types for Custom Rule-Based Transformations&#34;</a></p>
</li>
<li>
<p><a href="strms_rules.htm#g1049257">&#34;How Rules Are Used in Oracle Streams&#34;</a></p>
</li>
<li>
<p><a href="strms_apply.htm#BGBCDIDA">&#34;Types of Messages That Can Be Processed with an Apply Process&#34;</a></p>
</li>
<li>
<p><a class="olink ARPLS591" href="../ARPLS/d_streams_adm.htm#ARPLS591"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the <code dir="ltr">SET_RULE_TRANSFORM_FUNCTION</code> procedure</p>
</li>
<li>
<p><a href="strms_capture.htm#i1006153">&#34;Logical Change Records (LCRs)&#34;</a></p>
</li>
</ul>
</div>
<div id="STRMS444" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref341"></a>
<h3 class="sect2">Custom Rule-Based Transformations and Action Contexts<a id="sthref342"></a><a id="sthref343"></a><a id="sthref344"></a></h3>
<p>You use the <code dir="ltr">SET_RULE_TRANSFORM_FUNCTION</code> procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package to specify a custom rule-based transformation for a <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a>. This procedure modifies the <a href="strms_glossary.htm#CBACHAJI"><span class="xrefglossterm">action context</span></a> of a rule to specify the transformation. A rule action context is optional information associated with a rule that is interpreted by the client of the <a href="strms_glossary.htm#CHDIIIDH"><span class="xrefglossterm">rules engine</span></a> after the rule evaluates to <code dir="ltr">TRUE</code> for a <a href="strms_glossary.htm#CHDFHHGJ"><span class="xrefglossterm">message</span></a>. The client of the rules engine can be a user-created application or an internal feature of Oracle, such as Oracle Streams. The information in an action context is an object of type <code dir="ltr">SYS.RE$NV_LIST</code>, which consists of a list of name-value pairs.</p>
<p><a id="sthref345"></a><a id="sthref346"></a>A custom rule-based transformation in Oracle Streams always consists of the following name-value pair in an action context:</p>
<ul>
<li>
<p>If the function is a one-to-one transformation function, then the name is <code dir="ltr">STREAMS$_TRANSFORM_FUNCTION</code>. If the function is a one-to-many transformation function, then the name is <code dir="ltr">STREAMS$_ARRAY_TRANS_FUNCTION</code>.</p>
</li>
<li>
<p>The value is an <code dir="ltr">ANYDATA</code> instance containing a PL/SQL function name specified as a <code dir="ltr">VARCHAR2</code>. This function performs the transformation.</p>
</li>
</ul>
<p>You can display the existing custom rule-based transformations in a database by querying the <code dir="ltr">DBA_STREAMS_TRANSFORM_FUNCTION</code> data dictionary view.</p>
<p>When a rule in a <a href="strms_glossary.htm#CHDEEDIJ"><span class="xrefglossterm">positive rule set</span></a> evaluates to <code dir="ltr">TRUE</code> for a message in an Oracle Streams environment, and an action context that contains a name-value pair with the name <code dir="ltr">STREAMS$_TRANSFORM_FUNCTION</code> or <code dir="ltr">STREAMS$_ARRAY_TRANS_FUNCTION</code> is returned, the PL/SQL function is run, taking the message as an input parameter. Other names in an action context beginning with <code dir="ltr">STREAMS$_</code> are used internally by Oracle and must not be directly added, modified, or removed. Oracle Streams ignores any name-value pair that does not begin with <code dir="ltr">STREAMS$_</code> or <code dir="ltr">APPLY$_</code>.</p>
<p>When a rule evaluates to <code dir="ltr">FALSE</code> for a message in an Oracle Streams environment, the rule is not returned to the client, and any PL/SQL function appearing in a name-value pair in the action context is not run. Different rules can use the same or different transformations. For example, different transformations can be associated with different operation types, tables, or schemas for which messages are being captured, propagated, applied, or dequeued.</p>
</div>
<!-- class="sect2" -->
<a id="BABIDDEI"></a>
<div id="STRMS445" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Required Privileges for Custom Rule-Based Transformations<a id="sthref347"></a></h3>
<p>The user who calls the transformation function must have <code dir="ltr">EXECUTE</code> privilege on the function. The following list describes which user calls the transformation function:</p>
<ul>
<li>
<p>If a transformation is specified for a <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a> used by a <a href="strms_glossary.htm#CHDBHECD"><span class="xrefglossterm">capture process</span></a>, then the <a href="strms_glossary.htm#CBAEBCEE"><span class="xrefglossterm">capture user</span></a> for the capture process calls the transformation function.</p>
</li>
<li>
<p>If a transformation is specified for a rule used by a <a href="strms_glossary.htm#CBACHEDJ"><span class="xrefglossterm">synchronous capture</span></a>, then the capture user for the synchronous capture calls the transformation function.</p>
</li>
<li>
<p>If a transformation is specified for a rule used by a <a href="strms_glossary.htm#CHDEICIC"><span class="xrefglossterm">propagation</span></a>, then the owner of the <a href="strms_glossary.htm#CHDCGACA"><span class="xrefglossterm">source queue</span></a> for the propagation calls the transformation function.</p>
</li>
<li>
<p>If a transformation is specified on a rule used by an <a href="strms_glossary.htm#CHDJBHJC"><span class="xrefglossterm">apply process</span></a>, then the <a href="strms_glossary.htm#CHDGCCIF"><span class="xrefglossterm">apply user</span></a> for the apply process calls the transformation function.</p>
</li>
<li>
<p>If a transformation is specified on a rule used by a <a href="strms_glossary.htm#CHDDGHHB"><span class="xrefglossterm">messaging client</span></a>, then the user who invokes the messaging client calls the transformation function.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_mtransform.htm#CHDGDHDE">Chapter 19, &#34;Managing Rule-Based Transformations&#34;</a></p>
</li>
<li>
<p><a href="strms_capture.htm#i1006083">Chapter 2, &#34;Oracle Streams Information Capture&#34;</a></p>
</li>
<li>
<p><a href="strms_prop.htm#i1006210">Chapter 3, &#34;Message Propagation Between Queues&#34;</a></p>
</li>
<li>
<p><a href="strms_apply.htm#g1018604">Chapter 4, &#34;Oracle Streams Information Consumption&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CJAGDDAB"></a>
<div id="STRMS446" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Rule-Based Transformations and Oracle Streams Clients</h2>
<p>The following sections provide more information about rule-based transformations and <a href="strms_glossary.htm#CHDDDJGJ"><span class="xrefglossterm">Oracle Streams client</span></a>s:</p>
<ul>
<li>
<p><a href="#i1017903">Rule-Based Transformations and Capture Processes</a></p>
</li>
<li>
<p><a href="#BABDIGFI">Rule-Based Transformations and Synchronous Captures</a></p>
</li>
<li>
<p><a href="#i1017932">Rule-Based Transformations and Propagations</a></p>
</li>
<li>
<p><a href="#i1017933">Rule-Based Transformations and an Apply Process</a></p>
</li>
<li>
<p><a href="#i1017934">Rule-Based Transformations and a Messaging Client</a></p>
</li>
<li>
<p><a href="#i1017960">Multiple Rule-Based Transformations</a></p>
</li>
</ul>
<p>The information in this section applies to both declarative and <a href="strms_glossary.htm#CHDDGIFE"><span class="xrefglossterm">custom rule-based transformation</span></a>s.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_mtransform.htm#CHDGDHDE">Chapter 19, &#34;Managing Rule-Based Transformations&#34;</a></p>
</li>
<li>
<p><a href="strms_adrules.htm#i1006303">&#34;Rule Action Context&#34;</a></p>
</li>
<li>
<p><a href="strms_apply.htm#BGBCDIDA">&#34;Types of Messages That Can Be Processed with an Apply Process&#34;</a></p>
</li>
</ul>
</div>
<a id="i1017903"></a>
<div id="STRMS447" class="sect2">
<h3 class="sect2">Rule-Based Transformations and Capture Processes<a id="sthref348"></a><a id="sthref349"></a></h3>
<p>For a transformation to be performed during capture by a <a href="strms_glossary.htm#CHDBHECD"><span class="xrefglossterm">capture process</span></a>, a <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a> that is associated with a rule-based transformation in the <a href="strms_glossary.htm#CHDEEDIJ"><span class="xrefglossterm">positive rule set</span></a> for the capture process must evaluate to <code dir="ltr">TRUE</code> for a particular change found in the redo log.</p>
<p>If the transformation is a <a href="strms_glossary.htm#CHDBDEJG"><span class="xrefglossterm">declarative rule-based transformation</span></a>, then Oracle transforms the <a href="strms_glossary.htm#CHDCHEJI"><span class="xrefglossterm">captured LCR</span></a> internally when the rule in a positive rule set evaluates to <code dir="ltr">TRUE</code> for the message. If the transformation is a <a href="strms_glossary.htm#CHDDGIFE"><span class="xrefglossterm">custom rule-based transformation</span></a>, then an <a href="strms_glossary.htm#CBACHAJI"><span class="xrefglossterm">action context</span></a> containing a name-value pair with the name <code dir="ltr">STREAMS$_TRANSFORM_FUNCTION</code> or <code dir="ltr">STREAMS$_ARRAY_TRANS_FUNCTION</code> is returned to the capture process when the rule in a positive rule set evaluates to <code dir="ltr">TRUE</code> for the captured LCR.</p>
<p>The capture process completes the following steps to perform a rule-based transformation:</p>
<ol>
<li>
<p>Formats the change in the redo log into an LCR.</p>
</li>
<li>
<p>Converts the LCR into an <code dir="ltr">ANYDATA</code> object.</p>
</li>
<li>
<p>Transforms the LCR. If the transformation is a declarative rule-based transformation, then Oracle transforms the <code dir="ltr">ANYDATA</code> object internally based on the specifications of the declarative transformation. If the transformation is a custom rule-based transformation, then the <a href="strms_glossary.htm#CBAEBCEE"><span class="xrefglossterm">capture user</span></a> for the capture process runs the PL/SQL function in the name-value pair to transform the <code dir="ltr">ANYDATA</code> object.</p>
</li>
<li>
<p>Enqueues one or more transformed <code dir="ltr">ANYDATA</code> objects into the <a href="strms_glossary.htm#CHDIDCDI"><span class="xrefglossterm">queue</span></a> associated with the capture process, or discards the LCR if an array that contains zero elements is returned by the transformation function.</p>
</li>
</ol>
<p>All actions are performed by the capture user for the capture process. <a href="#i1007231">Figure 6-1</a> shows a transformation during capture by a capture process.</p>
<div id="STRMS448" class="figure">
<p class="titleinfigure"><a id="i1007231"></a>Figure 6-1 Transformation During Capture by a Capture Process</p>
<img width="227" height="420" src="img/strms020.gif" alt="Description of Figure 6-1 follows"/><br/>
<a id="sthref350" href="img_text/strms020.htm">Description of &#34;Figure 6-1 Transformation During Capture by a Capture Process&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>For example, if an LCR is transformed during capture by a capture process, then the transformed LCR is enqueued into the queue used by the capture process. Therefore, if such a captured LCR is propagated from the <code dir="ltr">dbs1.example.com</code> database to the <code dir="ltr">dbs2.example.com</code> and the <code dir="ltr">dbs3.example.com</code> databases, then the queues at <code dir="ltr">dbs2.example.com</code> and <code dir="ltr">dbs3.example.com</code> will contain the transformed LCR after propagation.</p>
<p>The advantages of performing transformations during capture by a capture process are the following:</p>
<ul>
<li>
<p>Security can be improved if the transformation removes or changes private information, because this private information does not appear in the <a href="strms_glossary.htm#CHDCGACA"><span class="xrefglossterm">source queue</span></a> and is not propagated to any <a href="strms_glossary.htm#CHDHJHJD"><span class="xrefglossterm">destination queue</span></a>.</p>
</li>
<li>
<p>Space consumption can be reduced, depending on the type of transformation performed. For example, a transformation that reduces the amount of data results in less data to enqueue, propagate, and apply.</p>
</li>
<li>
<p>Transformation overhead is reduced when there are multiple destinations for a transformed LCR, because the transformation is performed only once at the source, not at multiple destinations.</p>
</li>
<li>
<p>A capture process transformation can transform a single message into multiple messages.</p>
</li>
</ul>
<p>The possible disadvantages of performing transformations during capture by a capture process are the following:</p>
<ul>
<li>
<p>The transformation overhead occurs in the <a href="strms_glossary.htm#CHDHFBJG"><span class="xrefglossterm">source database</span></a> if the capture process is a <a href="strms_glossary.htm#CHDDGCGH"><span class="xrefglossterm">local capture process</span></a>. However, if the capture process is a <a href="strms_glossary.htm#CHDHEBHD"><span class="xrefglossterm">downstream capture process</span></a>, then this overhead occurs at the <a href="strms_glossary.htm#CHDBJECA"><span class="xrefglossterm">downstream database</span></a>, not at the source database.</p>
</li>
<li>
<p>All sites receive the transformed LCR.</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
A rule-based transformation cannot be used with a capture process to modify or remove a column of a data type that is not supported by Oracle Streams.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_capture.htm#i1006263">&#34;Data Types Captured by Capture Processes&#34;</a></p>
</li>
<li>
<p><a href="strms_mtransform.htm#CHDGDHDE">&#34;Managing Rule-Based Transformations&#34;</a></p>
</li>
</ul>
</div>
<a id="i1017899"></a>
<div id="STRMS449" class="sect3">
<h4 class="sect3">Rule-Based Transformation Errors During Capture by a Capture Process<a id="sthref351"></a></h4>
<p>If an error occurs when the transformation is run during capture by a capture process, then the error is returned to the capture process. The behavior of the capture process depends on the type of transformation being performed and the type of error encountered. The following capture process behaviors are possible:</p>
<ul>
<li>
<p>If the transformation is a declarative rule-based transformation, and the capture process can ignore the error, then the capture process performs the transformation and captures the change. For example, if a capture process tries to perform a <code dir="ltr">DELETE_COLUMN</code> declarative rule-based transformation, and the column specified for deletion does not exist in the row LCR, then the capture process captures the change and continues to run.</p>
</li>
<li>
<p>If the transformation is a declarative rule-based transformation, and the capture process cannot ignore the error, then the change is not captured, and the capture process becomes disabled. For example, if a capture process tries to perform an <code dir="ltr">ADD_COLUMN</code> declarative rule-based transformation, and the column specified for addition already exists in the row LCR, then the change is not captured, and the capture process becomes disabled.</p>
</li>
<li>
<p>Whenever an error is encountered in a custom rule-based transformation, the change is not captured, and the capture process becomes disabled.</p>
</li>
</ul>
<p>If the capture process becomes disabled, then you must either change or remove the rule-based transformation to avoid the error before the capture process can be enabled.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="BABDIGFI"></a>
<div id="STRMS450" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Rule-Based Transformations and Synchronous Captures<a id="sthref352"></a><a id="sthref353"></a></h3>
<p>For a transformation to be performed during capture by a <a href="strms_glossary.htm#CBACHEDJ"><span class="xrefglossterm">synchronous capture</span></a>, a <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a> that is associated with a rule-based transformation in the <a href="strms_glossary.htm#CHDEEDIJ"><span class="xrefglossterm">positive rule set</span></a> for the synchronous capture must evaluate to <code dir="ltr">TRUE</code> for a particular DML change made to a table.</p>
<p>If the transformation is a <a href="strms_glossary.htm#CHDBDEJG"><span class="xrefglossterm">declarative rule-based transformation</span></a>, then Oracle transforms the <a href="strms_glossary.htm#CBAGDEIH"><span class="xrefglossterm">persistent LCR</span></a> internally when the rule in a positive rule set evaluates to <code dir="ltr">TRUE</code> for the message. If the transformation is a <a href="strms_glossary.htm#CHDDGIFE"><span class="xrefglossterm">custom rule-based transformation</span></a>, then an <a href="strms_glossary.htm#CBACHAJI"><span class="xrefglossterm">action context</span></a> containing a name-value pair with the name <code dir="ltr">STREAMS$_TRANSFORM_FUNCTION</code> is returned to the capture process when the rule in a positive rule set evaluates to <code dir="ltr">TRUE</code> for the persistent LCR.</p>
<p>The synchronous capture completes the following steps to perform a rule-based transformation:</p>
<ol>
<li>
<p>Formats the change in the redo log into a row LCR.</p>
</li>
<li>
<p>Converts the row LCR into an <code dir="ltr">ANYDATA</code> object.</p>
</li>
<li>
<p>Transforms the LCR. If the transformation is a declarative rule-based transformation, then Oracle transforms the <code dir="ltr">ANYDATA</code> object internally based on the specifications of the declarative transformation. If the transformation is a custom rule-based transformation, then the <a href="strms_glossary.htm#CBAEBCEE"><span class="xrefglossterm">capture user</span></a> for the synchronous capture runs the PL/SQL function in the name-value pair to transform the <code dir="ltr">ANYDATA</code> object.</p>
</li>
<li>
<p>Enqueues the transformed <code dir="ltr">ANYDATA</code> object into the <a href="strms_glossary.htm#CHDIDCDI"><span class="xrefglossterm">queue</span></a> associated with the synchronous capture.</p>
</li>
</ol>
<p>All actions are performed by the capture user for the synchronous capture. <a href="#BABFFCHG">Figure 6-2</a> shows a transformation during capture.</p>
<div id="STRMS451" class="figure">
<p class="titleinfigure"><a id="BABFFCHG"></a>Figure 6-2 Transformation During Capture by a Synchronous Capture</p>
<img width="240" height="423" src="img/strms059.gif" alt="Description of Figure 6-2 follows"/><br/>
<a id="sthref354" href="img_text/strms059.htm">Description of &#34;Figure 6-2 Transformation During Capture by a Synchronous Capture&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>For example, if a row LCR is transformed during capture by a synchronous capture, then the transformed row LCR is enqueued into the queue used by the synchronous capture. Therefore, if such a captured LCR is propagated from the <code dir="ltr">dbs1.example.com</code> database to the <code dir="ltr">dbs2.example.com</code> and the <code dir="ltr">dbs3.example.com</code> databases, then the queues at <code dir="ltr">dbs2.example.com</code> and <code dir="ltr">dbs3.example.com</code> will contain the transformed row LCR after propagation.</p>
<p>The advantages of performing transformations during capture by a synchronous capture are the following:</p>
<ul>
<li>
<p>Security can be improved if the transformation removes or changes private information, because this private information does not appear in the <a href="strms_glossary.htm#CHDCGACA"><span class="xrefglossterm">source queue</span></a> and is not propagated to any <a href="strms_glossary.htm#CHDHJHJD"><span class="xrefglossterm">destination queue</span></a>.</p>
</li>
<li>
<p>Space consumption can be reduced, depending on the type of transformation performed. For example, a transformation that reduces the amount of data results in less data to enqueue, propagate, and apply.</p>
</li>
<li>
<p>Transformation overhead is reduced when there are multiple destinations for a transformed row LCR, because the transformation is performed only once at the source, not at multiple destinations.</p>
</li>
</ul>
<p>The possible disadvantages of performing transformations during capture by a synchronous capture are the following:</p>
<ul>
<li>
<p>The transformation overhead occurs in the <a href="strms_glossary.htm#CHDHFBJG"><span class="xrefglossterm">source database</span></a>.</p>
</li>
<li>
<p>All sites receive the transformed LCR.</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
A rule-based transformation cannot be used with a synchronous capture to modify or remove a column of a data type that is not supported by Oracle Streams.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="strms_capture.htm#CACFEDIE">&#34;Data Types Captured by Synchronous Capture&#34;</a>.</div>
<div id="STRMS452" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref355"></a>
<h4 class="sect3">Rule-Based Transformations and Errors During Capture by a Synchronous Capture</h4>
<p>If an error occurs when the transformation is run during capture by a synchronous capture, then the error is returned to the synchronous capture. The behavior of the synchronous capture depends on the type of transformation being performed and the type of error encountered. The following synchronous capture behaviors are possible:</p>
<ul>
<li>
<p>If the transformation is a declarative rule-based transformation, and the synchronous capture can ignore the error, then the synchronous capture performs the transformation and captures the change. For example, if a synchronous capture tries to perform a <code dir="ltr">DELETE_COLUMN</code> declarative rule-based transformation, and the column specified for deletion does not exist in the row LCR, then the synchronous capture captures the change.</p>
</li>
<li>
<p>If the transformation is a declarative rule-based transformation, and the synchronous capture cannot ignore the error, then the change is not captured, and the DML operation aborts. For example, if a synchronous capture tries to perform an <code dir="ltr">ADD_COLUMN</code> declarative rule-based transformation, and the column specified for addition already exists in the row LCR, then the change is not captured, and the DML aborts.</p>
</li>
<li>
<p>Whenever an error is encountered in a custom rule-based transformation, the change is not captured, and the DML aborts.</p>
</li>
</ul>
<p>If the DML aborts because of a rule-based transformation, then you must either change or remove the rule-based transformation to perform the DML operation.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1017932"></a>
<div id="STRMS453" class="sect2">
<h3 class="sect2">Rule-Based Transformations and Propagation<a id="sthref356"></a><a id="sthref357"></a>s</h3>
<p>For a transformation to be performed during propagation, a <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a> that is associated with a rule-based transformation in the <a href="strms_glossary.htm#CHDEEDIJ"><span class="xrefglossterm">positive rule set</span></a> for the <a href="strms_glossary.htm#CHDEICIC"><span class="xrefglossterm">propagation</span></a> must evaluate to <code dir="ltr">TRUE</code> for a <a href="strms_glossary.htm#CHDFHHGJ"><span class="xrefglossterm">message</span></a> in the <a href="strms_glossary.htm#CHDCGACA"><span class="xrefglossterm">source queue</span></a> for the propagation. This message can be a <a href="strms_glossary.htm#CHDCHEJI"><span class="xrefglossterm">captured LCR</span></a>, <a href="strms_glossary.htm#CBABHDGA"><span class="xrefglossterm">buffered LCR</span></a>, <a href="strms_glossary.htm#CBAGGFJH"><span class="xrefglossterm">buffered user message</span></a>, <a href="strms_glossary.htm#CBAGDEIH"><span class="xrefglossterm">persistent LCR</span></a>, and <a href="strms_glossary.htm#CBAGGIDA"><span class="xrefglossterm">persistent user message</span></a>.</p>
<p>If the transformation is a <a href="strms_glossary.htm#CHDBDEJG"><span class="xrefglossterm">declarative rule-based transformation</span></a>, then Oracle transforms the message internally when the rule in a positive rule set evaluates to <code dir="ltr">TRUE</code> for the message. If the transformation is a <a href="strms_glossary.htm#CHDDGIFE"><span class="xrefglossterm">custom rule-based transformation</span></a>, then an <a href="strms_glossary.htm#CBACHAJI"><span class="xrefglossterm">action context</span></a> containing a name-value pair with the name <code dir="ltr">STREAMS$_TRANSFORM_FUNCTION</code> is returned to the propagation when the rule in a positive rule set evaluates to <code dir="ltr">TRUE</code> for the message.</p>
<p>The propagation completes the following steps to perform a rule-based transformation:</p>
<ol>
<li>
<p>Starts dequeuing the message from the source queue.</p>
</li>
<li>
<p>Transforms the message. If the transformation is a declarative rule-based transformation, then Oracle transforms the message internally based on the specifications of the declarative transformation. If the transformation is a custom rule-based transformation, then the source queue owner runs the PL/SQL function in the name-value pair to transform the message.</p>
</li>
<li>
<p>Completes dequeuing the transformed message.</p>
</li>
<li>
<p>Propagates the transformed message to the <a href="strms_glossary.htm#CHDHJHJD"><span class="xrefglossterm">destination queue</span></a>.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="strms_apply.htm#i1006172">&#34;Ways to Consume Information with Oracle Streams&#34;</a></div>
<p><a href="#i1007273">Figure 6-3</a> shows a transformation during propagation.</p>
<div id="STRMS454" class="figure">
<p class="titleinfigure"><a id="i1007273"></a>Figure 6-3 Transformation During Propagation</p>
<img width="552" height="282" src="img/strms019.gif" alt="Description of Figure 6-3 follows"/><br/>
<a id="sthref358" href="img_text/strms019.htm">Description of &#34;Figure 6-3 Transformation During Propagation&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>For example, suppose you use a rule-based transformation for a propagation that propagates messages from the <code dir="ltr">dbs1.example.com</code> database to the <code dir="ltr">dbs2.example.com</code> database, but you do not use a rule-based transformation for a propagation that propagates messages from the <code dir="ltr">dbs1.example.com</code> database to the <code dir="ltr">dbs3.example.com</code> database.</p>
<p>In this case, a message in the queue at <code dir="ltr">dbs1.example.com</code> can be transformed before it is propagated to <code dir="ltr">dbs2.example.com</code>, but the same message can remain in its original form when it is propagated to <code dir="ltr">dbs3.example.com</code>. In this case, after propagation, the queue at <code dir="ltr">dbs2.example.com</code> contains the transformed message, and the queue at <code dir="ltr">dbs3.example.com</code> contains the original message.</p>
<p>The advantages of performing transformations during propagation are the following:</p>
<ul>
<li>
<p>Security can be improved if the transformation removes or changes private information before messages are propagated.</p>
</li>
<li>
<p>Some destination queues can receive a transformed message, while other destination queues can receive the original message.</p>
</li>
<li>
<p>Different destinations can receive different variations of the same transformed message.</p>
</li>
</ul>
<p>The possible disadvantages of performing transformations during propagation are the following:</p>
<ul>
<li>
<p>Once a message is transformed, any database to which it is propagated after the first propagation receives the transformed message. For example, if <code dir="ltr">dbs2.example.com</code> propagates the message to <code dir="ltr">dbs4.example.com</code>, then <code dir="ltr">dbs4.example.com</code> receives the transformed message.</p>
</li>
<li>
<p>When the first propagation in a <a href="strms_glossary.htm#CHDECDHJ"><span class="xrefglossterm">directed network</span></a> performs the transformation, and a local <a href="strms_glossary.htm#CHDBHECD"><span class="xrefglossterm">capture process</span></a> captured the message, the transformation overhead occurs on the <a href="strms_glossary.htm#CHDHFBJG"><span class="xrefglossterm">source database</span></a>. However, if the capture process is a <a href="strms_glossary.htm#CHDHEBHD"><span class="xrefglossterm">downstream capture process</span></a>, then this overhead occurs at the <a href="strms_glossary.htm#CHDBJECA"><span class="xrefglossterm">downstream database</span></a>, not at the source database.</p>
</li>
<li>
<p>When the first propagation in a <a href="strms_glossary.htm#CHDECDHJ"><span class="xrefglossterm">directed network</span></a> performs the transformation, and a <a href="strms_glossary.htm#CBACHEDJ"><span class="xrefglossterm">synchronous capture</span></a> captured the message, the transformation overhead occurs on the <a href="strms_glossary.htm#CHDHFBJG"><span class="xrefglossterm">source database</span></a>.</p>
</li>
<li>
<p>The same transformation can be done multiple times on a message when different propagations send the message to multiple <a href="strms_glossary.htm#CHDGCAJA"><span class="xrefglossterm">destination database</span></a>s.</p>
</li>
</ul>
<a id="BABEEECF"></a>
<div id="STRMS455" class="sect3">
<h4 class="sect3">Rule-Based Transformation Errors During Propagation<a id="sthref359"></a></h4>
<p>If an error occurs during the transformation, then the message that caused the error is not dequeued or propagated, and the error is returned to the propagation. Before the message can be propagated, you must change or remove the rule-based transformation to avoid the error.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1017933"></a>
<div id="STRMS456" class="sect2">
<h3 class="sect2">Rule-Based Transformations and an Apply Process<a id="sthref360"></a><a id="sthref361"></a></h3>
<p>For a transformation to be performed during apply, a <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a> that is associated with a rule-based transformation in the <a href="strms_glossary.htm#CHDEEDIJ"><span class="xrefglossterm">positive rule set</span></a> for the <a href="strms_glossary.htm#CHDJBHJC"><span class="xrefglossterm">apply process</span></a> must evaluate to <code dir="ltr">TRUE</code> for a <a href="strms_glossary.htm#CHDFHHGJ"><span class="xrefglossterm">message</span></a> in the <a href="strms_glossary.htm#CHDIDCDI"><span class="xrefglossterm">queue</span></a> for the apply process. This message can be a <a href="strms_glossary.htm#CHDCHEJI"><span class="xrefglossterm">captured LCR</span></a>, a <a href="strms_glossary.htm#CBAGDEIH"><span class="xrefglossterm">persistent LCR</span></a>, or a <a href="strms_glossary.htm#CBAGGIDA"><span class="xrefglossterm">persistent user message</span></a>.</p>
<p>If the transformation is a <a href="strms_glossary.htm#CHDBDEJG"><span class="xrefglossterm">declarative rule-based transformation</span></a>, then Oracle transforms the message internally when the rule in a positive rule set evaluates to <code dir="ltr">TRUE</code> for the message. If the transformation is a <a href="strms_glossary.htm#CHDDGIFE"><span class="xrefglossterm">custom rule-based transformation</span></a>, then an <a href="strms_glossary.htm#CBACHAJI"><span class="xrefglossterm">action context</span></a> containing a name-value pair with the name <code dir="ltr">STREAMS$_TRANSFORM_FUNCTION</code> is returned to the apply process when the rule in a positive rule set evaluates to <code dir="ltr">TRUE</code> for the message.</p>
<p>The apply process completes the following steps to perform a rule-based transformation:</p>
<ol>
<li>
<p>Starts to dequeue the message from the queue.</p>
</li>
<li>
<p>Transforms the message. If the transformation is a declarative rule-based transformation, then Oracle transforms the message internally based on the specifications of the declarative transformation. If the transformation is a custom rule-based transformation, then the <a href="strms_glossary.htm#CHDGCCIF"><span class="xrefglossterm">apply user</span></a> runs the PL/SQL function in the name-value pair to transform the message.</p>
</li>
<li>
<p>Completes dequeuing the transformed message.</p>
</li>
<li>
<p>Applies the transformed message, which can entail changing database objects at the <a href="strms_glossary.htm#CHDGCAJA"><span class="xrefglossterm">destination database</span></a> or sending the transformed message to an <a href="strms_glossary.htm#CHDCJAED"><span class="xrefglossterm">apply handler</span></a>.</p>
</li>
</ol>
<p>All actions are performed by the apply user.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="strms_apply.htm#i1006172">&#34;Ways to Consume Information with Oracle Streams&#34;</a></div>
<p><a href="#i1007317">Figure 6-4</a> shows a transformation during apply.</p>
<div id="STRMS457" class="figure">
<p class="titleinfigure"><a id="i1007317"></a>Figure 6-4 Transformation During Apply</p>
<img width="509" height="239" src="img/strms044.gif" alt="Description of Figure 6-4 follows"/><br/>
<a id="sthref362" href="img_text/strms044.htm">Description of &#34;Figure 6-4 Transformation During Apply&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>For example, suppose a message is propagated from the <code dir="ltr">dbs1.example.com</code> database to the <code dir="ltr">dbs2.example.com</code> database in its original form. When the apply process dequeues the message at <code dir="ltr">dbs2.example.com</code>, the message is transformed.</p>
<p>The possible advantages of performing transformations during apply are the following:</p>
<ul>
<li>
<p>Any database to which the message is propagated after the first propagation can receive the message in its original form. For example, if <code dir="ltr">dbs2.example.com</code> propagates the message to <code dir="ltr">dbs4.example.com</code>, then <code dir="ltr">dbs4.example.com</code> can receive the original message.</p>
</li>
<li>
<p>The transformation overhead does not occur on the <a href="strms_glossary.htm#CHDHFBJG"><span class="xrefglossterm">source database</span></a> when the source and destination database are different.</p>
</li>
</ul>
<p>The possible disadvantages of performing transformations during apply are the following:</p>
<ul>
<li>
<p>Security might be a concern if the messages contain private information, because all databases to which the messages are propagated receive the original messages.</p>
</li>
<li>
<p>The same transformation can be done multiple times when multiple destination databases need the same transformation.</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
Before modifying one or more rules for an apply process, you should stop the apply process.</div>
<a id="BABEBHHB"></a>
<div id="STRMS458" class="sect3">
<h4 class="sect3">Rule-Based Transformation Errors During Apply Process Dequeue<a id="sthref363"></a></h4>
<p>If an error occurs when the transformation function is run during apply process dequeue, then the message that caused the error is not dequeued, the transaction containing the message is not applied, the error is returned to the apply process, and the apply process is disabled. Before the apply process can be enabled, you must change or remove the rule-based transformation to avoid the error.</p>
</div>
<!-- class="sect3" -->
<a id="BABCJIIE"></a>
<div id="STRMS459" class="sect3">
<h4 class="sect3">Apply Errors on Transformed Messages</h4>
<p>If an apply error occurs for a transaction in which some of the messages have been transformed by a rule-based transformation, then the transformed messages are moved to the error queue with all of the other messages in the transaction. If you use the <code dir="ltr">EXECUTE_ERROR</code> procedure in the <code dir="ltr">DBMS_APPLY_ADM</code> package to reexecute a transaction in the error queue that contains transformed messages, then the transformation is not performed on the messages again because the apply process rule set containing the rule is not evaluated again.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1017934"></a>
<div id="STRMS460" class="sect2">
<h3 class="sect2">Rule-Based Transformations and a Messaging Client<a id="sthref364"></a><a id="sthref365"></a></h3>
<p>For a transformation to be performed during dequeue by a <a href="strms_glossary.htm#CHDDGHHB"><span class="xrefglossterm">messaging client</span></a>, a <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a> that is associated with a rule-based transformation in the <a href="strms_glossary.htm#CHDEEDIJ"><span class="xrefglossterm">positive rule set</span></a> for the messaging client must evaluate to <code dir="ltr">TRUE</code> for a <a href="strms_glossary.htm#CHDFHHGJ"><span class="xrefglossterm">message</span></a> in the <a href="strms_glossary.htm#CHDIDCDI"><span class="xrefglossterm">queue</span></a> for the messaging client.</p>
<p>If the transformation is a <a href="strms_glossary.htm#CHDBDEJG"><span class="xrefglossterm">declarative rule-based transformation</span></a>, then Oracle transforms the message internally when the rule in a positive rule set evaluates to <code dir="ltr">TRUE</code> for the message. If the transformation is a <a href="strms_glossary.htm#CHDDGIFE"><span class="xrefglossterm">custom rule-based transformation</span></a>, then an <a href="strms_glossary.htm#CBACHAJI"><span class="xrefglossterm">action context</span></a> containing a name-value pair with the name <code dir="ltr">STREAMS$_TRANSFORM_FUNCTION</code> is returned to the messaging client when the rule in a positive rule set evaluates to <code dir="ltr">TRUE</code> for the message.</p>
<p>The messaging client completes the following steps to perform a rule-based transformation:</p>
<ol>
<li>
<p>Starts to dequeue the message from the queue.</p>
</li>
<li>
<p>Transforms the message. If the transformation is a declarative rule-based transformation, then the message must be a <a href="strms_glossary.htm#CBAGDEIH"><span class="xrefglossterm">persistent LCR</span></a>, and Oracle transforms the row LCR internally based on the specifications of the declarative transformation. If the transformation is a <a href="strms_glossary.htm#CHDDGIFE"><span class="xrefglossterm">custom rule-based transformation</span></a>, then the message can be a persistent LCR or a <a href="strms_glossary.htm#CBAGGIDA"><span class="xrefglossterm">persistent user message</span></a>. The user who invokes the messaging client runs the PL/SQL function in the name-value pair to transform the message during dequeue.</p>
</li>
<li>
<p>Completes dequeuing the transformed message.</p>
</li>
</ol>
<p>All actions are performed by the user who invokes the messaging client.</p>
<p><a href="#i1017765">Figure 6-5</a> shows a transformation during messaging client dequeue.</p>
<div id="STRMS461" class="figure">
<p class="titleinfigure"><a id="i1017765"></a>Figure 6-5 Transformation During Messaging Client Dequeue</p>
<img width="320" height="168" src="img/strms043.gif" alt="Description of Figure 6-5 follows"/><br/>
<a id="sthref366" href="img_text/strms043.htm">Description of &#34;Figure 6-5 Transformation During Messaging Client Dequeue&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>For example, suppose a message is propagated from the <code dir="ltr">dbs1.example.com</code> database to the <code dir="ltr">dbs2.example.com</code> database in its original form. When the messaging client dequeues the message at <code dir="ltr">dbs2.example.com</code>, the message is transformed.</p>
<p>One possible advantage of performing transformations during dequeue in a messaging environment is that any database to which the message is propagated after the first propagation can receive the message in its original form. For example, if <code dir="ltr">dbs2.example.com</code> propagates the message to <code dir="ltr">dbs4.example.com</code>, then <code dir="ltr">dbs4.example.com</code> can receive the original message.</p>
<p>The possible disadvantages of performing transformations during dequeue in a messaging environment are the following:</p>
<ul>
<li>
<p>Security might be a concern if the messages contain private information, because all databases to which the messages are propagated receive the original messages.</p>
</li>
<li>
<p>The same transformation can be done multiple times when multiple <a href="strms_glossary.htm#CHDGCAJA"><span class="xrefglossterm">destination database</span></a>s need the same transformation.</p>
</li>
</ul>
<a id="BABIDGFJ"></a>
<div id="STRMS462" class="sect3">
<h4 class="sect3">Rule-Based Transformation Errors During Messaging Client Dequeue<a id="sthref367"></a></h4>
<p>If an error occurs when the transformation function is run during messaging client dequeue, then the message that caused the error is not dequeued, and the error is returned to the messaging client. Before the message can be dequeued by the messaging client, you must change or remove the rule-based transformation to avoid the error.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1017960"></a>
<div id="STRMS463" class="sect2">
<h3 class="sect2">Multiple Rule-Based Transformations<a id="sthref368"></a></h3>
<p>You can transform a message during capture, propagation, apply, or dequeue, or during any combination of capture, propagation, apply, and dequeue. For example, if you want to hide sensitive data from all recipients, then you can transform a message during capture. If some recipients require additional custom transformations, then you can transform the previously transformed message during propagation, apply, or dequeue.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CACFFFIH"></a>
<div id="STRMS145" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Transformation Ordering<a id="sthref369"></a></h2>
<p>In addition to <a href="strms_glossary.htm#CHDBDEJG"><span class="xrefglossterm">declarative rule-based transformation</span></a>s and <a href="strms_glossary.htm#CHDDGIFE"><span class="xrefglossterm">custom rule-based transformation</span></a>s, a <a href="strms_glossary.htm#CHDJICJC"><span class="xrefglossterm">row migration</span></a> is an internal transformation that takes place when a <a href="strms_glossary.htm#CHDBCGAG"><span class="xrefglossterm">subset rule</span></a> evaluates to <code dir="ltr">TRUE</code>. If all three types of transformations are specified for a single <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a>, then Oracle Database performs the transformations in the following order when the rule evaluates to <code dir="ltr">TRUE</code>:</p>
<ol>
<li>
<p>Row migration</p>
</li>
<li>
<p>Declarative rule-based transformation</p>
</li>
<li>
<p>Custom rule-based transformation</p>
</li>
</ol>
<a id="BABCECHE"></a>
<div id="STRMS464" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Declarative Rule-Based Transformation Ordering<a id="sthref370"></a></h3>
<p>If more than one <a href="strms_glossary.htm#CHDBDEJG"><span class="xrefglossterm">declarative rule-based transformation</span></a> is specified for a single <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a>, then Oracle must perform the transformations in a particular order. You can use the default ordering for declarative transformations, or you can specify the order.</p>
<p>This section contains the following topics:</p>
<ul>
<li>
<p><a href="#CJADCABA">Default Declarative Transformation Ordering</a></p>
</li>
<li>
<p><a href="#BABFCJCA">User-Specified Declarative Transformation Ordering</a></p>
</li>
</ul>
<a id="CJADCABA"></a>
<div id="STRMS465" class="sect3">
<h4 class="sect3">Default Declarative Transformation Ordering</h4>
<p>By default, Oracle Database performs declarative transformations in the following order when the rule evaluates to <code dir="ltr">TRUE</code>:</p>
<ol>
<li>
<p>Keep columns</p>
</li>
<li>
<p>Delete column</p>
</li>
<li>
<p>Rename column</p>
</li>
<li>
<p>Add column</p>
</li>
<li>
<p>Rename table</p>
</li>
<li>
<p>Rename schema</p>
</li>
</ol>
<p>The results of a declarative transformation are used in each subsequent declarative transformation. For example, suppose the following declarative transformations are specified for a single rule:</p>
<ul>
<li>
<p>Delete column <code dir="ltr">address</code></p>
</li>
<li>
<p>Add column <code dir="ltr">address</code></p>
</li>
</ul>
<p>Assuming column <code dir="ltr">address</code> exists in a row LCR, both declarative transformations should be performed in this case because column <code dir="ltr">address</code> is deleted from the row LCR before column <code dir="ltr">address</code> is added back to the row LCR. The following table shows the transformation ordering for this example.</p>
<div class="inftblruleinformal">
<table class="cellalignment5973" title="Transformation ordering example" summary="Transformation ordering for delete column transformation and add column transformation" dir="ltr">
<thead>
<tr class="cellalignment5964">
<th class="cellalignment5974" id="r1c1-t15">Step Number</th>
<th class="cellalignment5974" id="r1c2-t15">Transformation Type</th>
<th class="cellalignment5974" id="r1c3-t15">Transformation Details</th>
<th class="cellalignment5974" id="r1c4-t15">Transformation Performed?</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment5964">
<td class="cellalignment5970" id="r2c1-t15" headers="r1c1-t15">1</td>
<td class="cellalignment5970" headers="r2c1-t15 r1c2-t15">Keep columns</td>
<td class="cellalignment5970" headers="r2c1-t15 r1c3-t15">-</td>
<td class="cellalignment5970" headers="r2c1-t15 r1c4-t15">-</td>
</tr>
<tr class="cellalignment5964">
<td class="cellalignment5970" id="r3c1-t15" headers="r1c1-t15">2</td>
<td class="cellalignment5970" headers="r3c1-t15 r1c2-t15">Delete column</td>
<td class="cellalignment5970" headers="r3c1-t15 r1c3-t15">Delete column <code dir="ltr">address</code> from row LCR</td>
<td class="cellalignment5970" headers="r3c1-t15 r1c4-t15">Yes</td>
</tr>
<tr class="cellalignment5964">
<td class="cellalignment5970" id="r4c1-t15" headers="r1c1-t15">3</td>
<td class="cellalignment5970" headers="r4c1-t15 r1c2-t15">Rename column</td>
<td class="cellalignment5970" headers="r4c1-t15 r1c3-t15">-</td>
<td class="cellalignment5970" headers="r4c1-t15 r1c4-t15">-</td>
</tr>
<tr class="cellalignment5964">
<td class="cellalignment5970" id="r5c1-t15" headers="r1c1-t15">4</td>
<td class="cellalignment5970" headers="r5c1-t15 r1c2-t15">Add column</td>
<td class="cellalignment5970" headers="r5c1-t15 r1c3-t15">Add column <code dir="ltr">address</code> to row LCR</td>
<td class="cellalignment5970" headers="r5c1-t15 r1c4-t15">Yes</td>
</tr>
<tr class="cellalignment5964">
<td class="cellalignment5970" id="r6c1-t15" headers="r1c1-t15">5</td>
<td class="cellalignment5970" headers="r6c1-t15 r1c2-t15">Rename table</td>
<td class="cellalignment5970" headers="r6c1-t15 r1c3-t15">-</td>
<td class="cellalignment5970" headers="r6c1-t15 r1c4-t15">-</td>
</tr>
<tr class="cellalignment5964">
<td class="cellalignment5970" id="r7c1-t15" headers="r1c1-t15">6</td>
<td class="cellalignment5970" headers="r7c1-t15 r1c2-t15">Rename schema</td>
<td class="cellalignment5970" headers="r7c1-t15 r1c3-t15">-</td>
<td class="cellalignment5970" headers="r7c1-t15 r1c4-t15">-</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Another scenario might rename a table and then rename a schema. For example, suppose the following declarative transformations are specified for a single rule:</p>
<ul>
<li>
<p>Rename table <code dir="ltr">john.customers</code> to <code dir="ltr">sue.clients</code></p>
</li>
<li>
<p>Rename schema <code dir="ltr">sue</code> to <code dir="ltr">mary</code></p>
</li>
</ul>
<p>Notice that the rename table transformation also renames the schema for the table. In this case, both transformations should be performed and, after both transformations, the table name becomes <code dir="ltr">mary.clients</code>. The following table shows the transformation ordering for this example.</p>
<div class="inftblruleinformal">
<table class="cellalignment5973" title="Transformation ordering example" summary="Transformation ordering for rename table transformation and rename schema transformation where both transformations are performed" dir="ltr">
<thead>
<tr class="cellalignment5964">
<th class="cellalignment5974" id="r1c1-t16">Step Number</th>
<th class="cellalignment5974" id="r1c2-t16">Transformation Type</th>
<th class="cellalignment5974" id="r1c3-t16">Transformation Details</th>
<th class="cellalignment5974" id="r1c4-t16">Transformation Performed?</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment5964">
<td class="cellalignment5970" id="r2c1-t16" headers="r1c1-t16">1</td>
<td class="cellalignment5970" headers="r2c1-t16 r1c2-t16">Keep columns</td>
<td class="cellalignment5970" headers="r2c1-t16 r1c3-t16">-</td>
<td class="cellalignment5970" headers="r2c1-t16 r1c4-t16">-</td>
</tr>
<tr class="cellalignment5964">
<td class="cellalignment5970" id="r3c1-t16" headers="r1c1-t16">2</td>
<td class="cellalignment5970" headers="r3c1-t16 r1c2-t16">Delete column</td>
<td class="cellalignment5970" headers="r3c1-t16 r1c3-t16">-</td>
<td class="cellalignment5970" headers="r3c1-t16 r1c4-t16">-</td>
</tr>
<tr class="cellalignment5964">
<td class="cellalignment5970" id="r4c1-t16" headers="r1c1-t16">3</td>
<td class="cellalignment5970" headers="r4c1-t16 r1c2-t16">Rename column</td>
<td class="cellalignment5970" headers="r4c1-t16 r1c3-t16">-</td>
<td class="cellalignment5970" headers="r4c1-t16 r1c4-t16">-</td>
</tr>
<tr class="cellalignment5964">
<td class="cellalignment5970" id="r5c1-t16" headers="r1c1-t16">4</td>
<td class="cellalignment5970" headers="r5c1-t16 r1c2-t16">Add column</td>
<td class="cellalignment5970" headers="r5c1-t16 r1c3-t16">-</td>
<td class="cellalignment5970" headers="r5c1-t16 r1c4-t16">-</td>
</tr>
<tr class="cellalignment5964">
<td class="cellalignment5970" id="r6c1-t16" headers="r1c1-t16">5</td>
<td class="cellalignment5970" headers="r6c1-t16 r1c2-t16">Rename table</td>
<td class="cellalignment5970" headers="r6c1-t16 r1c3-t16">Rename table <code dir="ltr">john.customers</code> to <code dir="ltr">sue.clients</code></td>
<td class="cellalignment5970" headers="r6c1-t16 r1c4-t16">Yes</td>
</tr>
<tr class="cellalignment5964">
<td class="cellalignment5970" id="r7c1-t16" headers="r1c1-t16">6</td>
<td class="cellalignment5970" headers="r7c1-t16 r1c2-t16">Rename schema</td>
<td class="cellalignment5970" headers="r7c1-t16 r1c3-t16">Rename schema <code dir="ltr">sue</code> to <code dir="ltr">mary</code></td>
<td class="cellalignment5970" headers="r7c1-t16 r1c4-t16">Yes</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Consider a similar scenario in which the following declarative transformations are specified for a single rule:</p>
<ul>
<li>
<p>Rename table <code dir="ltr">john.customers</code> to <code dir="ltr">sue.clients</code></p>
</li>
<li>
<p>Rename schema <code dir="ltr">john</code> to <code dir="ltr">mary</code></p>
</li>
</ul>
<p>In this case, the first transformation is performed, but the second one is not. After the first transformation, the table name is <code dir="ltr">sue.clients</code>. The second transformation is not performed because the schema of the table is now <code dir="ltr">sue</code>, not <code dir="ltr">john</code>. The following table shows the transformation ordering for this example.</p>
<div class="inftblruleinformal">
<table class="cellalignment5973" title="Transformation ordering example" summary="Transformation ordering for rename table transformation and rename schema transformation where only the rename table transformation is performed" dir="ltr">
<thead>
<tr class="cellalignment5964">
<th class="cellalignment5974" id="r1c1-t17">Step Number</th>
<th class="cellalignment5974" id="r1c2-t17">Transformation Type</th>
<th class="cellalignment5974" id="r1c3-t17">Transformation Details</th>
<th class="cellalignment5974" id="r1c4-t17">Transformation Performed?</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment5964">
<td class="cellalignment5970" id="r2c1-t17" headers="r1c1-t17">1</td>
<td class="cellalignment5970" headers="r2c1-t17 r1c2-t17">Keep columns</td>
<td class="cellalignment5970" headers="r2c1-t17 r1c3-t17">-</td>
<td class="cellalignment5970" headers="r2c1-t17 r1c4-t17">-</td>
</tr>
<tr class="cellalignment5964">
<td class="cellalignment5970" id="r3c1-t17" headers="r1c1-t17">2</td>
<td class="cellalignment5970" headers="r3c1-t17 r1c2-t17">Delete column</td>
<td class="cellalignment5970" headers="r3c1-t17 r1c3-t17">-</td>
<td class="cellalignment5970" headers="r3c1-t17 r1c4-t17">-</td>
</tr>
<tr class="cellalignment5964">
<td class="cellalignment5970" id="r4c1-t17" headers="r1c1-t17">3</td>
<td class="cellalignment5970" headers="r4c1-t17 r1c2-t17">Rename column</td>
<td class="cellalignment5970" headers="r4c1-t17 r1c3-t17">-</td>
<td class="cellalignment5970" headers="r4c1-t17 r1c4-t17">-</td>
</tr>
<tr class="cellalignment5964">
<td class="cellalignment5970" id="r5c1-t17" headers="r1c1-t17">4</td>
<td class="cellalignment5970" headers="r5c1-t17 r1c2-t17">Add column</td>
<td class="cellalignment5970" headers="r5c1-t17 r1c3-t17">-</td>
<td class="cellalignment5970" headers="r5c1-t17 r1c4-t17">-</td>
</tr>
<tr class="cellalignment5964">
<td class="cellalignment5970" id="r6c1-t17" headers="r1c1-t17">5</td>
<td class="cellalignment5970" headers="r6c1-t17 r1c2-t17">Rename table</td>
<td class="cellalignment5970" headers="r6c1-t17 r1c3-t17">Rename table <code dir="ltr">john.customers</code> to <code dir="ltr">sue.clients</code></td>
<td class="cellalignment5970" headers="r6c1-t17 r1c4-t17">Yes</td>
</tr>
<tr class="cellalignment5964">
<td class="cellalignment5970" id="r7c1-t17" headers="r1c1-t17">6</td>
<td class="cellalignment5970" headers="r7c1-t17 r1c2-t17">Rename schema</td>
<td class="cellalignment5970" headers="r7c1-t17 r1c3-t17">Rename schema <code dir="ltr">john</code> to <code dir="ltr">mary</code></td>
<td class="cellalignment5970" headers="r7c1-t17 r1c4-t17">No</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>The rename schema transformation is not performed, but it does not result in an error. In this case, the row LCR is transformed by the rename table transformation, and a row LCR with the table name <code dir="ltr">sue.clients</code> is returned.</p>
</div>
<!-- class="sect3" -->
<a id="BABFCJCA"></a>
<div id="STRMS466" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">User-Specified Declarative Transformation Ordering</h4>
<p>If you do not want to use the default declarative rule-based transformation ordering for a particular rule, then you can specify step numbers for each declarative transformation specified for the rule. If you specify a step number for one or more declarative transformations for a particular rule, then the declarative transformations for the rule behave in the following way:</p>
<ul>
<li>
<p>Declarative transformations are performed in order of increasing step number.</p>
</li>
<li>
<p>The default step number for a declarative transformation is <code dir="ltr">0</code> (zero). A declarative transformation uses this default if no step number is specified for it explicitly.</p>
</li>
<li>
<p>If two or more declarative transformations have the same step number, then these declarative transformations follow the default ordering described in <a href="#CJADCABA">&#34;Default Declarative Transformation Ordering&#34;</a>.</p>
</li>
</ul>
<p>For example, you can reverse the default ordering for declarative transformations by specifying the following step numbers for transformations associated with a particular rule:</p>
<ul>
<li>
<p>Keep columns with step number 6</p>
</li>
<li>
<p>Delete column with step number 5</p>
</li>
<li>
<p>Rename column with step number 4</p>
</li>
<li>
<p>Add column with step number 3</p>
</li>
<li>
<p>Rename table with step number 2</p>
</li>
<li>
<p>Rename schema with step number 1</p>
</li>
</ul>
<p>With this ordering specified, rename schema transformations are performed first, and delete column transformations are performed last.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CJAIJIFG"></a>
<div id="STRMS467" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Considerations for Rule-Based Transformations</h2>
<p>The following considerations apply to both <a href="strms_glossary.htm#CHDBDEJG"><span class="xrefglossterm">declarative rule-based transformation</span></a>s and <a href="strms_glossary.htm#CHDDGIFE"><span class="xrefglossterm">custom rule-based transformation</span></a>s:</p>
<ul>
<li>
<p>For a rule-based transformation to be performed by an <a href="strms_glossary.htm#CHDDDJGJ"><span class="xrefglossterm">Oracle Streams client</span></a>, the <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a> must be in the <a href="strms_glossary.htm#CHDEEDIJ"><span class="xrefglossterm">positive rule set</span></a> for the Oracle Streams client. If the rule is in the <a href="strms_glossary.htm#CHDBHJHI"><span class="xrefglossterm">negative rule set</span></a> for the Oracle Streams client, then the Oracle Streams client ignores the rule-based transformation.</p>
</li>
<li>
<p>Rule-based transformations are different from transformations performed using the <code dir="ltr">DBMS_TRANSFORM</code> package. This document does not discuss transformations performed with the <code dir="ltr">DBMS_TRANSFORM</code> package.</p>
</li>
<li>
<p>If a large percentage of row LCRs will be transformed in your environment, or if you must make expensive transformations on row LCRs, then consider making these modifications within a <a href="strms_glossary.htm#CHDEIDID"><span class="xrefglossterm">DML handler</span></a> instead, because DML handlers can execute in parallel when apply parallelism is greater than 1.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADQUE0800" href="../ADQUE/aq_admin.htm#ADQUE0800"><span class="italic">Oracle Database Advanced Queuing User&#39;s Guide</span></a> and <a class="olink ARPLS061" href="../ARPLS/d_transf.htm#ARPLS061"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information about the <code dir="ltr">DBMS_TRANSFORM</code> package</div>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5963">
<tr>
<td class="cellalignment5970">
<table class="cellalignment5968">
<tr>
<td class="cellalignment5967"><a href="strms_rules.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5967"><a href="pt_adconcepts.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2002, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5972">
<table class="cellalignment5966">
<tr>
<td class="cellalignment5967"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5967"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5967"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5967"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5967"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5967"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>