<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-104485"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Troubleshooting%20Rules%20and%20Rule-Based%20Transformations"></a><title>Troubleshooting Rules and Rule-Based Transformations</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1032"/>
<meta name="dcterms.created" content="2014-12-23T13:28:8Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Streams Concepts and Administration"/>
<meta name="dcterms.identifier" content="E53116-02"/>
<meta name="dcterms.isVersionOf" content="STRMS"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2002, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="strms_glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="strms_trapply.htm" title="Previous" type="text/html"/>
<link rel="Next" href="pt_infprv.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E53116-02.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">45/57</span> <!-- End Header -->
<div id="STRMS1075" class="chapter"><a id="BABEHCCE"></a>
<h1 class="chapter"><span class="secnum">34</span> Troubleshooting Rules and Rule-Based Transformations</h1>
<p><a id="sthref1418"></a><a id="sthref1419"></a>When a <a href="strms_glossary.htm#CHDBHECD"><span class="xrefglossterm">capture process</span></a>, <a href="strms_glossary.htm#CBACHEDJ"><span class="xrefglossterm">synchronous capture</span></a>, <a href="strms_glossary.htm#CHDEICIC"><span class="xrefglossterm">propagation</span></a>, <a href="strms_glossary.htm#CHDJBHJC"><span class="xrefglossterm">apply process</span></a>, or <a href="strms_glossary.htm#CHDDGHHB"><span class="xrefglossterm">messaging client</span></a> is not behaving as expected, the problem might be that <a href="strms_glossary.htm#CHDCHGGB"><span class="xrefglossterm">rule set</span></a>s, <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a>s, or <a href="strms_glossary.htm#CHDGHJDE"><span class="xrefglossterm">rule-based transformation</span></a>s for the <a href="strms_glossary.htm#CHDDDJGJ"><span class="xrefglossterm">Oracle Streams client</span></a> are not configured properly. Use the following sections to identify and resolve problems with rule sets, rules, and rule-based transformations:</p>
<p><a id="sthref1420"></a><a id="sthref1421"></a>The following topics describe identifying and resolving common problems with rules and rule-based transformations in an Oracle Streams environment:</p>
<ul>
<li>
<p><a href="#i1006919">Are Rules Configured Properly for the Oracle Streams Client?</a></p>
</li>
<li>
<p><a href="#CACCIJFJ">Are Declarative Rule-Based Transformations Configured Properly?</a></p>
</li>
<li>
<p><a href="#i1007146">Are the Custom Rule-Based Transformations Configured Properly?</a></p>
</li>
<li>
<p><a href="#CACFFHEF">Are Incorrectly Transformed LCRs in the Error Queue?</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_rules.htm#g1049257">Chapter 5, &#34;How Rules Are Used in Oracle Streams&#34;</a></p>
</li>
<li>
<p><a href="strms_adrules.htm#BABEBHGC">Chapter 11, &#34;Advanced Rule Concepts&#34;</a></p>
</li>
<li>
<p><a href="strms_mrules.htm#BABBBAIA">Chapter 18, &#34;Managing Rules&#34;</a></p>
</li>
<li>
<p><a href="strms_rumon.htm#CFFJECBJ">Chapter 27, &#34;Monitoring Rules&#34;</a></p>
</li>
</ul>
</div>
<a id="i1006919"></a>
<div id="STRMS1076" class="sect1">
<h2 class="sect1">Are Rules Configured Properly for the Oracle Streams Client?<a id="sthref1422"></a></h2>
<p>If a <a href="strms_glossary.htm#CHDBHECD"><span class="xrefglossterm">capture process</span></a>, <a href="strms_glossary.htm#CBACHEDJ"><span class="xrefglossterm">synchronous capture</span></a>, <a href="strms_glossary.htm#CHDEICIC"><span class="xrefglossterm">propagation</span></a>, <a href="strms_glossary.htm#CHDJBHJC"><span class="xrefglossterm">apply process</span></a>, or <a href="strms_glossary.htm#CHDDGHHB"><span class="xrefglossterm">messaging client</span></a> is behaving in an unexpected way, then the problem might be that the <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a>s in one or more of the <a href="strms_glossary.htm#CHDCHGGB"><span class="xrefglossterm">rule set</span></a>s for the <a href="strms_glossary.htm#CHDDDJGJ"><span class="xrefglossterm">Oracle Streams client</span></a> are not configured properly. For example, if you expect a capture process to capture changes made to a particular table, but the capture process is not capturing these changes, then the cause might be that the rules in the rule sets used by the capture process do not instruct the capture process to capture changes to the table.</p>
<p>You can check the rules for a particular Oracle Streams client by querying the <code dir="ltr">DBA_STREAMS_RULES</code> data dictionary view. If you use both <a href="strms_glossary.htm#CHDEEDIJ"><span class="xrefglossterm">positive rule set</span></a>s and <a href="strms_glossary.htm#CHDBHJHI"><span class="xrefglossterm">negative rule set</span></a>s in your Oracle Streams environment, then it is important to know whether a rule returned by this view is in the positive or negative rule set for a particular Oracle Streams client.</p>
<p>An Oracle Streams client performs an action, such as capture, propagation, apply, or dequeue, for messages that satisfy its rule sets. In general, a message satisfies the rule sets for an Oracle Streams client if <span class="italic">no rules</span> in the negative rule set evaluate to <code dir="ltr">TRUE</code> for the message, and <span class="italic">at least one rule</span> in the positive rule set evaluates to <code dir="ltr">TRUE</code> for the message.</p>
<p><a href="strms_rules.htm#i1010575">&#34;Rule Sets and Rule Evaluation of Messages&#34;</a> contains more detailed information about how a message satisfies the rule sets for an Oracle Streams client, including information about Oracle Streams client behavior when one or more rule sets are not specified.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_rules.htm#i1010575">&#34;Rule Sets and Rule Evaluation of Messages&#34;</a></p>
</li>
</ul>
</div>
<p>This section includes the following subsections:</p>
<ul>
<li>
<p><a href="#i1008599">Checking Schema and Global Rules</a></p>
</li>
<li>
<p><a href="#i1006972">Checking Table Rules</a></p>
</li>
<li>
<p><a href="#i1007597">Checking Subset Rules</a></p>
</li>
<li>
<p><a href="#i1008994">Checking for Message Rules</a></p>
</li>
<li>
<p><a href="#i1007079">Resolving Problems with Rules</a></p>
</li>
</ul>
<a id="i1008599"></a>
<div id="STRMS1077" class="sect2">
<h3 class="sect2">Checking Schema and Global Rules</h3>
<p>Schema and <a href="strms_glossary.htm#CHDEJCHD"><span class="xrefglossterm">global rule</span></a>s in the positive rule set for an Oracle Streams client instruct the Oracle Streams client to perform its task for all of the messages relating to a particular schema or database, respectively. Schema and global rules in the negative rule set for an Oracle Streams client instruct the Oracle Streams client to discard all of the messages relating to a particular schema or database, respectively. If an Oracle Streams client is not behaving as expected, then it might be because schema or global rules are not configured properly for the Oracle Streams client.</p>
<p>For example, suppose a database is running an apply process named <code dir="ltr">strm01_apply</code>, and you want this apply process to apply LCRs containing changes to the <code dir="ltr">hr</code> schema. If the apply process uses a negative rule set, then ensure that there are no <a href="strms_glossary.htm#CHDFAGCF"><span class="xrefglossterm">schema rule</span></a>s that evaluate to <code dir="ltr">TRUE</code> for this schema in the negative rule set. Such rules cause the apply process to discard LCRs containing changes to the schema. <a href="strms_rumon.htm#i1017753">&#34;Displaying the Rules in the Negative Rule Set for an Oracle Streams Client&#34;</a> contains an example of a query that shows such rules.</p>
<p>If the query returns any such rules, then the rules returned might be causing the apply process to discard changes to the schema. If this query returns no rows, then ensure that there are schema rules in the positive rule set for the apply process that evaluate to <code dir="ltr">TRUE</code> for the schema. <a href="strms_rumon.htm#i1017754">&#34;Displaying the Rules in the Positive Rule Set for an Oracle Streams Client&#34;</a> contains an example of a query that shows such rules.</p>
</div>
<!-- class="sect2" -->
<a id="i1006972"></a>
<div id="STRMS1078" class="sect2">
<h3 class="sect2">Checking Table Rules</h3>
<p>Table rules in the positive rule set for an Oracle Streams client instruct the Oracle Streams client to perform its task for the messages relating to one or more particular tables. Table rules in the negative rule set for an Oracle Streams client instruct the Oracle Streams client to discard the messages relating to one or more particular tables.</p>
<p>If an Oracle Streams client is not behaving as expected for a particular table, then it might be for one of the following reasons:</p>
<ul>
<li>
<p>One or more global rules in the rule sets for the Oracle Streams client instruct the Oracle Streams client to behave in a particular way for messages relating to the table because the table is in a specific database. That is, a global rule in the negative rule set for the Oracle Streams client might instruct the Oracle Streams client to discard all messages from the <a href="strms_glossary.htm#CHDHFBJG"><span class="xrefglossterm">source database</span></a> that contains the table, or a global rule in the positive rule set for the Oracle Streams client might instruct the Oracle Streams client to perform its task for all messages from the source database that contains the table.</p>
</li>
<li>
<p>One or more schema rules in the rule sets for the Oracle Streams client instruct the Oracle Streams client to behave in a particular way for messages relating to the table because the table is in a specific schema. That is, a schema rule in the negative rule set for the Oracle Streams client might instruct the Oracle Streams client to discard all messages relating to database objects in the schema, or a schema rule in the positive rule set for the Oracle Streams client might instruct the Oracle Streams client to perform its task for all messages relating to database objects in the schema.</p>
</li>
<li>
<p>One or more <a href="strms_glossary.htm#CHDEGGGH"><span class="xrefglossterm">table rule</span></a>s in the rule sets for the Oracle Streams client instruct the Oracle Streams client to behave in a particular way for messages relating to the table.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#i1008599">&#34;Checking Schema and Global Rules&#34;</a></div>
<p>If you are sure that no global or schema rules are causing the unexpected behavior, then you can check for table rules in the rule sets for an Oracle Streams client. For example, if you expect a capture process to capture changes to a particular table, but the capture process is not capturing these changes, then the cause might be that the rules in the positive and negative rule sets for the capture process do not instruct it to capture changes to the table.</p>
<p>Suppose a database is running a capture process named <code dir="ltr">strm01_capture</code>, and you want this capture process to capture changes to the <code dir="ltr">hr.departments</code> table. If the capture process uses a negative rule set, then ensure that there are no table rules that evaluate to <code dir="ltr">TRUE</code> for this table in the negative rule set. Such rules cause the capture process to discard changes to the table. <a href="strms_rumon.htm#i1017753">&#34;Displaying the Rules in the Negative Rule Set for an Oracle Streams Client&#34;</a> contains an example of a query that shows rules in a negative rule set.</p>
<p>If that query returns any such rules, then the rules returned might be causing the capture process to discard changes to the table. If that query returns no rules, then ensure that there are one or more table rules in the positive rule set for the capture process that evaluate to <code dir="ltr">TRUE</code> for the table. <a href="strms_rumon.htm#i1017754">&#34;Displaying the Rules in the Positive Rule Set for an Oracle Streams Client&#34;</a> contains an example of a query that shows rules in a positive rule set.</p>
<p>You can also determine which rules have a particular pattern in their rule condition. <a href="strms_rumon.htm#i1008442">&#34;Listing Each Rule that Contains a Specified Pattern in Its Condition&#34;</a>. For example, you can find all of the rules with the string &#34;departments&#34; in their rule condition, and you can ensure that these rules are in the correct rule sets.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="strms_rules.htm#i1008680">&#34;Table Rules Example&#34;</a> for more information about specifying table rules</div>
</div>
<!-- class="sect2" -->
<a id="i1007597"></a>
<div id="STRMS1079" class="sect2">
<h3 class="sect2">Checking Subset Rules</h3>
<p>A <a href="strms_glossary.htm#CHDBCGAG"><span class="xrefglossterm">subset rule</span></a> can be in the rule set used by a capture process, synchronous capture, propagation, apply process, or messaging client. A subset rule evaluates to <code dir="ltr">TRUE</code> only if a DML operation contains a change to a particular subset of rows in the table. For example, to check for table rules that evaluate to <code dir="ltr">TRUE</code> for an apply process named <code dir="ltr">strm01_apply</code> when there are changes to the <code dir="ltr">hr.departments</code> table, run the following query:</p>
<pre dir="ltr">COLUMN RULE_NAME HEADING &#39;Rule Name&#39; FORMAT A20
COLUMN RULE_TYPE HEADING &#39;Rule Type&#39; FORMAT A20
COLUMN DML_CONDITION HEADING &#39;Subset Condition&#39; FORMAT A30

SELECT RULE_NAME, RULE_TYPE, DML_CONDITION
  FROM DBA_STREAMS_RULES
  WHERE STREAMS_NAME   = &#39;STRM01_APPLY&#39; AND 
        STREAMS_TYPE   = &#39;APPLY&#39; AND
        SCHEMA_NAME    = &#39;HR&#39; AND
        OBJECT_NAME    = &#39;DEPARTMENTS&#39;;
</pre>
<pre dir="ltr">Rule Name            Rule Type            Subset Condition
-------------------- -------------------- ------------------------------
DEPARTMENTS5         DML                  location_id=1700
DEPARTMENTS6         DML                  location_id=1700
DEPARTMENTS7         DML                  location_id=1700
</pre>
<p>Notice that this query returns any subset condition for the table in the <code dir="ltr">DML_CONDITION</code> column, which is labeled &#34;Subset Condition&#34; in the output. In this example, subset rules are specified for the <code dir="ltr">hr.departments</code> table. These subset rules evaluate to <code dir="ltr">TRUE</code> only if an LCR contains a change that involves a row where the <code dir="ltr">location_id</code> is <code dir="ltr">1700</code>. So, if you expected the apply process to apply all changes to the table, then these subset rules cause the apply process to discard changes that involve rows where the <code dir="ltr">location_id</code> is&nbsp;not&nbsp;<code dir="ltr">1700</code>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Subset rules must reside only in positive rule sets.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_rules.htm#i1008680">&#34;Table Rules Example&#34;</a> for more information about specifying subset rules</p>
</li>
<li>
<p><a href="strms_rules.htm#i1007704">&#34;Row Migration and Subset Rules&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="i1008994"></a>
<div id="STRMS1080" class="sect2">
<h3 class="sect2">Checking for Message Rules</h3>
<p>A message rule can be in the rule set used by a propagation, apply process, or messaging client. Message rules pertain only to <a href="strms_glossary.htm#CHDDIHEC"><span class="xrefglossterm">user message</span></a>s of a specific message type, not to <a href="strms_glossary.htm#CHDCHEJI"><span class="xrefglossterm">captured LCR</span></a>s. A message rule evaluates to <code dir="ltr">TRUE</code> if a user message in a <a href="strms_glossary.htm#CHDIDCDI"><span class="xrefglossterm">queue</span></a> is of the type specified in the message rule and satisfies the <a href="strms_glossary.htm#CHDGDCFJ"><span class="xrefglossterm">rule condition</span></a> of the message rule.</p>
<p>If you expect a propagation, apply process, or messaging client to perform its task for some user messages, but the Oracle Streams client is not performing its task for these messages, then the cause might be that the rules in the positive and negative rule sets for the Oracle Streams client do not instruct it to perform its task for these messages. Similarly, if you expect a propagation, apply process, or messaging client to discard some user messages, but the Oracle Streams client is not discarding these messages, then the cause might be that the rules in the positive and negative rule sets for the Oracle Streams client do not instruct it to discard these messages.</p>
<p>For example, suppose you want a messaging client named <code dir="ltr">oe</code> to dequeue messages of type <code dir="ltr">oe.user_msg</code> that satisfy the following condition:</p>
<pre dir="ltr">:&#34;VAR$_2&#34;.OBJECT_OWNER = &#39;OE&#39; AND  :&#34;VAR$_2&#34;.OBJECT_NAME = &#39;ORDERS&#39;
</pre>
<p>If the messaging client uses a negative rule set, then ensure that there are no message rules that evaluate to <code dir="ltr">TRUE</code> for this message type in the negative rule set. Such rules cause the messaging client to discard these messages. For example, to determine whether there are any such rules in the negative rule set for the messaging client, run the following query:</p>
<pre dir="ltr">COLUMN RULE_NAME HEADING &#39;Rule Name&#39; FORMAT A30
COLUMN RULE_CONDITION HEADING &#39;Rule Condition&#39; FORMAT A30

SELECT RULE_NAME, RULE_CONDITION 
  FROM DBA_STREAMS_RULES
  WHERE STREAMS_NAME       = &#39;OE&#39; AND
        MESSAGE_TYPE_OWNER = &#39;OE&#39; AND
        MESSAGE_TYPE_NAME  = &#39;USER_MSG&#39; AND
        RULE_SET_TYPE      = &#39;NEGATIVE&#39;;
</pre>
<p>If this query returns any rules, then the rules returned might be causing the messaging client to discard messages. Examine the rule condition of the returned rules to determine whether these rules are causing the messaging client to discard the messages that it should be dequeuing. If this query returns no rules, then ensure that there are message rules in the positive rule set for the messaging client that evaluate to <code dir="ltr">TRUE</code> for this message type and condition.</p>
<p>For example, to determine whether any message rules evaluate to <code dir="ltr">TRUE</code> for this message type in the positive rule set for the messaging client, run the following query:</p>
<pre dir="ltr">COLUMN RULE_NAME HEADING &#39;Rule Name&#39; FORMAT A35
COLUMN RULE_CONDITION HEADING &#39;Rule Condition&#39; FORMAT A35

SELECT RULE_NAME, RULE_CONDITION 
  FROM DBA_STREAMS_RULES 
  WHERE STREAMS_NAME       = &#39;OE&#39; AND
        MESSAGE_TYPE_OWNER = &#39;OE&#39; AND
        MESSAGE_TYPE_NAME  = &#39;USER_MSG&#39; AND
        RULE_SET_TYPE      = &#39;POSITIVE&#39;;
</pre>
<p>If you have message rules that evaluate to <code dir="ltr">TRUE</code> for this message type in the positive rule set for the messaging client, then these rules are returned. In this case, your output looks similar to the following:</p>
<pre dir="ltr">Rule Name                           Rule Condition
----------------------------------- -----------------------------------
RULE$_3                             :&#34;VAR$_2&#34;.OBJECT_OWNER = &#39;OE&#39; AND
                                    :&#34;VAR$_2&#34;.OBJECT_NAME = &#39;ORDERS&#39;
</pre>
<p>Examine the rule condition for the rules returned to determine whether they instruct the messaging client to dequeue the proper messages. Based on these results, the messaging client named <code dir="ltr">oe</code> should dequeue messages of <code dir="ltr">oe.user_msg</code> type that satisfy condition shown in the output. In other words, no rule in the negative messaging client rule set discards these messages, and a rule exists in the positive messaging client rule set that evaluates to <code dir="ltr">TRUE</code> when the messaging client finds a message in its queue of the <code dir="ltr">oe.user_msg</code> type that satisfies the rule condition.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_rules.htm#i1016439">&#34;Message Rule Example&#34;</a> for more information about specifying message rules</p>
</li>
<li>
<p><a class="olink ADQUE" href="../ADQUE/toc.htm"><span class="italic">Oracle Database Advanced Queuing User&#39;s Guide</span></a> for detailed information about messaging</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="i1007079"></a>
<div id="STRMS1081" class="sect2">
<h3 class="sect2">Resolving Problems with Rules<a id="sthref1423"></a><a id="sthref1424"></a></h3>
<p>If you determine that an Oracle Streams capture process, synchronous capture, propagation, apply process, or messaging client is not behaving as expected because one or more rules must be added to the rule set for the Oracle Streams client, then you can use one of the following procedures in the <code dir="ltr">DBMS_STREAMS_ADM</code> package to add appropriate rules:</p>
<ul>
<li>
<p><code dir="ltr">ADD_GLOBAL_PROPAGATION_RULES</code></p>
</li>
<li>
<p><code dir="ltr">ADD_GLOBAL_RULES</code></p>
</li>
<li>
<p><code dir="ltr">ADD_SCHEMA_PROPAGATION_RULES</code></p>
</li>
<li>
<p><code dir="ltr">ADD_SCHEMA_RULES</code></p>
</li>
<li>
<p><code dir="ltr">ADD_SUBSET_PROPAGATION_RULES</code></p>
</li>
<li>
<p><code dir="ltr">ADD_SUBSET_RULES</code></p>
</li>
<li>
<p><code dir="ltr">ADD_TABLE_PROPAGATION_RULES</code></p>
</li>
<li>
<p><code dir="ltr">ADD_TABLE_RULES</code></p>
</li>
<li>
<p><code dir="ltr">ADD_MESSAGE_PROPAGATION_RULE</code></p>
</li>
<li>
<p><code dir="ltr">ADD_MESSAGE_RULE</code></p>
</li>
</ul>
<p>You can use the <code dir="ltr">DBMS_RULE_ADM</code> package to add customized rules, if necessary.</p>
<p>It is also possible that the Oracle Streams capture process, synchronous capture, propagation, apply process, or messaging client is not behaving as expected because one or more rules should be altered or removed from a rule set.</p>
<p>If you have the correct rules, and the relevant messages are still filtered out by an Oracle Streams capture process, propagation, or apply process, then check your trace files and alert log for a warning about a missing &#34;multi-version data dictionary&#34;, which is an <a href="strms_glossary.htm#CBAGCBCJ"><span class="xrefglossterm">Oracle Streams data dictionary</span></a>. The following information might be included in such warning messages:</p>
<ul>
<li>
<p><code dir="ltr">gdbnm</code>: Global name of the source database of the missing object</p>
</li>
<li>
<p><code dir="ltr">scn</code>: SCN for the transaction that has been missed</p>
</li>
</ul>
<p>If you find such messages, and you are using custom capture process rules or reusing existing capture process rules for a new <a href="strms_glossary.htm#CHDGCAJA"><span class="xrefglossterm">destination database</span></a>, then ensure that you run the appropriate procedure to prepare for <a href="strms_glossary.htm#CHDCCEJE"><span class="xrefglossterm">instantiation</span></a>:</p>
<ul>
<li>
<p><code dir="ltr">PREPARE_TABLE_INSTANTIATION</code></p>
</li>
<li>
<p><code dir="ltr">PREPARE_SCHEMA_INSTANTIATION</code></p>
</li>
<li>
<p><code dir="ltr">PREPARE_GLOBAL_INSTANTIATION</code></p>
</li>
</ul>
<p>Also, ensure that propagation is working from the source database to the destination database. Oracle Streams data dictionary information is propagated to the destination database and loaded into the dictionary at the destination database.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_mrules.htm#i1006320">&#34;Altering a Rule&#34;</a></p>
</li>
<li>
<p><a href="strms_mrules.htm#i1006384">&#34;Removing a Rule from a Rule Set&#34;</a></p>
</li>
<li>
<p><a class="olink STREP114" href="../STREP/instant.htm#STREP114"><span class="italic">Oracle Streams Replication Administrator&#39;s Guide</span></a> for more information about preparing database objects for instantiation</p>
</li>
<li>
<p><a href="strms_adcapture.htm#i1010145">&#34;The Oracle Streams Data Dictionary&#34;</a> for more information about the Oracle Streams data dictionary</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CACCIJFJ"></a>
<div id="STRMS1082" class="sect1">
<h2 class="sect1">Are Declarative Rule-Based Transformations Configured Properly?<a id="sthref1425"></a><a id="sthref1426"></a></h2>
<p>A <a href="strms_glossary.htm#CHDBDEJG"><span class="xrefglossterm">declarative rule-based transformation</span></a> is a rule-based transformation that covers one of a common set of transformation scenarios for row LCRs. Declarative rule-based transformations are run internally without using PL/SQL. If an Oracle Streams <a href="strms_glossary.htm#CHDBHECD"><span class="xrefglossterm">capture process</span></a>, <a href="strms_glossary.htm#CBACHEDJ"><span class="xrefglossterm">synchronous capture</span></a>, <a href="strms_glossary.htm#CHDEICIC"><span class="xrefglossterm">propagation</span></a>, <a href="strms_glossary.htm#CHDJBHJC"><span class="xrefglossterm">apply process</span></a>, or <a href="strms_glossary.htm#CHDDGHHB"><span class="xrefglossterm">messaging client</span></a> is not behaving as expected, then check the declarative rule-based transformations specified for the <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a>s used by the Oracle Streams client and correct any mistakes.</p>
<p>The most common problems with declarative rule-based transformations are:</p>
<ul>
<li>
<p>The declarative rule-based transformation is specified for a table or involves columns in a table, but the schema either was not specified or was incorrectly specified when the transformation was created. If the schema is not correct in a declarative rule-based transformation, then the transformation will not be run on the appropriate LCRs. You should specify the owning schema for a table when you create a declarative rule-based transformation. If the schema is not specified when a declarative rule-based transformation is created, then the user who creates the transformation is specified for the schema by default.</p>
<p>If the schema is not correct for a declarative rule-based transformation, then, to correct the problem, remove the transformation and re-create it, specifying the correct schema for each table.</p>
</li>
<li>
<p>If more than one declarative rule-based transformation is specified for a particular rule, then ensure that the ordering is correct for execution of these transformations. Incorrect ordering of declarative rule-based transformations can result in errors or inconsistent data.</p>
<p>If the ordering is not correct for the declarative rule-based transformation specified on a single rule, then, to correct the problem, remove the transformations and re-create them with the correct ordering.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_trmon.htm#CHDCDFJE">&#34;Displaying Declarative Rule-Based Transformations&#34;</a></p>
</li>
<li>
<p><a href="strms_mtransform.htm#BABDFDEA">&#34;Managing Declarative Rule-Based Transformations&#34;</a></p>
</li>
<li>
<p><a href="strms_transform.htm#CACFFFIH">&#34;Transformation Ordering&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="i1007146"></a>
<div id="STRMS1083" class="sect1">
<h2 class="sect1">Are the Custom Rule-Based Transformations Configured Properly?<a id="sthref1427"></a><a id="sthref1428"></a></h2>
<p>A <a href="strms_glossary.htm#CHDDGIFE"><span class="xrefglossterm">custom rule-based transformation</span></a> is any modification by a user-defined function to a message when a <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a> evaluates to <code dir="ltr">TRUE</code>. A custom rule-based transformation is specified in the <a href="strms_glossary.htm#CBACHAJI"><span class="xrefglossterm">action context</span></a> of a rule, and these action contexts contain a name-value pair with <code dir="ltr">STREAMS$_TRANSFORM_FUNCTION</code> for the name and a user-created function name for the value. This user-created function performs the transformation. If the user-created function contains any flaws, then unexpected behavior can result.</p>
<p>If an Oracle Streams <a href="strms_glossary.htm#CHDBHECD"><span class="xrefglossterm">capture process</span></a>, <a href="strms_glossary.htm#CBACHEDJ"><span class="xrefglossterm">synchronous capture</span></a>, <a href="strms_glossary.htm#CHDEICIC"><span class="xrefglossterm">propagation</span></a>, <a href="strms_glossary.htm#CHDJBHJC"><span class="xrefglossterm">apply process</span></a>, or <a href="strms_glossary.htm#CHDDGHHB"><span class="xrefglossterm">messaging client</span></a> is not behaving as expected, then check the custom rule-based transformation functions specified for the rules used by the <a href="strms_glossary.htm#CHDDDJGJ"><span class="xrefglossterm">Oracle Streams client</span></a> and correct any flaws. You can find the names of these functions by querying the <code dir="ltr">DBA_STREAMS_TRANSFORM_FUNCTION</code> data dictionary view. You might need to modify a transformation function or remove a custom rule-based transformation to correct the problem. Also, ensure that the name of the function is spelled correctly when you specify the transformation for a rule.</p>
<p>An error caused by a custom rule-based transformation might cause a capture process, synchronous capture, propagation, apply process, or messaging client to abort. In this case, you might need to correct the transformation before the Oracle Streams client can be restarted or invoked.</p>
<p>Rule evaluation is done before a custom rule-based transformation. For example, if you have a transformation that changes the name of a table from <code dir="ltr">emps</code> to <code dir="ltr">employees</code>, then ensure that each rule using the transformation specifies the table name <code dir="ltr">emps</code>, rather than <code dir="ltr">employees</code>, in its <a href="strms_glossary.htm#CHDGDCFJ"><span class="xrefglossterm">rule condition</span></a>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_transform.htm#CACIIJHJ">&#34;Rule-Based Transformations&#34;</a></p>
</li>
<li>
<p><a href="strms_mtransform.htm#BABDDFEC">&#34;Managing Custom Rule-Based Transformations&#34;</a></p>
</li>
<li>
<p><a href="strms_trmon.htm#CHDGIBBG">&#34;Displaying Custom Rule-Based Transformations&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="CACFFHEF"></a>
<div id="STRMS1084" class="sect1">
<h2 class="sect1">Are Incorrectly Transformed LCRs in the Error Queue?</h2>
<p>In some cases, incorrectly transformed LCRs might have been moved to the error queue by an <a href="strms_glossary.htm#CHDJBHJC"><span class="xrefglossterm">apply process</span></a>. When this occurs, you should examine the transaction in the error queue to analyze the feasibility of reexecuting the transaction successfully. If an abnormality is found in the transaction, then you might be able to configure a <a href="strms_glossary.htm#CHDEAFJH"><span class="xrefglossterm">procedure DML handler</span></a> to correct the problem. The DML handler will run when you reexecute the error transaction. When a DML handler is used to correct a problem in an error transaction, the apply process that uses the DML handler should be stopped to prevent the DML handler from acting on LCRs that are not involved with the error transaction. After successful reexecution, if the DML handler is no longer needed, then remove it. Also, correct the <a href="strms_glossary.htm#CHDGHJDE"><span class="xrefglossterm">rule-based transformation</span></a> to avoid future errors.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_apply.htm#i1008918">&#34;The Error Queue&#34;</a></p>
</li>
<li>
<p><a href="strms_apmon.htm#i1007797">&#34;Checking for Apply Errors&#34;</a></p>
</li>
<li>
<p><a href="strms_apmon.htm#i1007852">&#34;Displaying Detailed Information About Apply Errors&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5963">
<tr>
<td class="cellalignment5970">
<table class="cellalignment5968">
<tr>
<td class="cellalignment5967"><a href="strms_trapply.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5967"><a href="pt_infprv.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2002, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5972">
<table class="cellalignment5966">
<tr>
<td class="cellalignment5967"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5967"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5967"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5967"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5967"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5967"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>