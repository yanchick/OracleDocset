<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-4958"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/How%20to%20Complete%20Preinstallation%20Tasks%20Manually"></a><title>How to Complete Preinstallation Tasks Manually</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1093"/>
<meta name="dcterms.created" content="2017-07-11T4:23:40Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Grid Infrastructure Installation Guide"/>
<meta name="dcterms.identifier" content="E48914-22"/>
<meta name="dcterms.isVersionOf" content="CWLIN"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2013, 2017,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="concepts.htm" title="Previous" type="text/html"/>
<link rel="Next" href="index.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E48914-22.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">21/22</span> <!-- End Header -->
<div id="CWLIN515" class="appendix"><a id="CJAFCEBB"></a>
<h1 class="appendix"><span class="secnum">F</span> How to Complete Preinstallation Tasks Manually</h1>
<p>This appendix provides instructions to complete configuration tasks manually that Cluster Verification Utility (CVU) and Oracle Universal Installer (OUI) normally complete during installation using Fixup scripts. Use this appendix as a guide if you cannot use Fixup scripts.</p>
<p>This appendix contains the following information:</p>
<ul>
<li>
<p><a href="#BABJBAEB">Configuring SSH Manually on All Cluster Nodes</a></p>
</li>
<li>
<p><a href="#BABCHAED">Configuring Kernel Parameters</a></p>
</li>
<li>
<p><a href="#CEGIEGAJ">Setting UDP and TCP Kernel Parameters Manually</a></p>
</li>
<li>
<p><a href="#BABFAEFE">Configuring Storage Paths and Disk Devices</a></p>
</li>
<li>
<p><a href="#BABHJJIF">Checking OCFS2 Version Manually</a></p>
</li>
</ul>
<a id="BABJBAEB"></a>
<div id="CWLIN407" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">F.1</span> Configuring SSH Manually on All Cluster Nodes<a id="sthref871"></a></h2>
<p>Passwordless SSH configuration is a mandatory installation requirement. SSH is used during installation to configure cluster member nodes, and SSH is used after installation by configuration assistants, Oracle Enterprise Manager, Opatch, and other features.</p>
<p>Automatic Passwordless SSH configuration using OUI creates RSA encryption keys on all nodes of the cluster. If you have system restrictions that require you to set up SSH manually, such as using DSA keys, then use this procedure as a guide to set up passwordless SSH.</p>
<p>In the examples that follow, the Oracle software owner listed is the <code dir="ltr">grid</code> user.</p>
<p>If SSH is not available, then OUI attempts to use rsh and rcp instead. However, these services are disabled by default on most Linux systems.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<a id="sthref872"></a>The supported version of SSH for Linux distributions is OpenSSH.</div>
<p>This section contains the following:</p>
<ul>
<li>
<p><a href="#BABDAIGB">Checking Existing SSH Configuration on the System</a></p>
</li>
<li>
<p><a href="#BABFIDDD">Configuring SSH on Cluster Nodes</a></p>
</li>
<li>
<p><a href="#BABHDEIC">Enabling SSH User Equivalency on Cluster Nodes</a></p>
</li>
</ul>
<a id="BABDAIGB"></a>
<div id="CWLIN408" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">F.1.1</span> Checking Existing SSH Configuration on the System<a id="sthref873"></a><a id="sthref874"></a></h3>
<p>To determine if SSH is running, enter the following command:</p>
<pre dir="ltr">$ pgrep sshd
</pre>
<p>If SSH is running, then the response to this command is one or more process ID numbers. In the home directory of the installation software owner (<code dir="ltr">grid</code>, <code dir="ltr">oracle</code>), use the command <code dir="ltr">ls -al</code> to ensure that the <code dir="ltr">.ssh</code> directory is owned and writable only by the user.</p>
<p>You need either an RSA or a DSA key for the SSH protocol. RSA is used with the SSH 1.5 protocol, while DSA is the default for the SSH 2.0 protocol. With OpenSSH, you can use either RSA or DSA. The instructions that follow are for SSH1. If you have an SSH2 installation, and you cannot use SSH1, then refer to your SSH distribution documentation to configure SSH1 compatibility or to configure SSH2 with DSA.</p>
</div>
<!-- class="sect2" -->
<a id="BABFIDDD"></a>
<div id="CWLIN409" class="sect2">
<h3 class="sect2"><span class="secnum">F.1.2</span> Configuring SSH on Cluster Nodes</h3>
<p>To configure SSH, you must first create RSA or DSA keys on each cluster node, and then copy all the keys generated on all cluster node members into an authorized keys file that is identical on each node. Note that the SSH files must be readable only by <code dir="ltr">root</code> and by the software installation user (<code dir="ltr">oracle</code>, <code dir="ltr">grid</code>), as SSH ignores a private key file if it is accessible by others. In the examples that follow, the DSA key is used.</p>
<p>You must configure SSH separately for each Oracle software installation owner that you intend to use for installation.</p>
<p>To configure SSH, complete the following:</p>
<div id="CWLIN410" class="sect3"><a id="sthref875"></a>
<h4 class="sect3"><span class="secnum">F.1.2.1</span> Create SSH Directory, and Create SSH Keys On Each Node</h4>
<p>Complete the following steps on each node:</p>
<ol>
<li>
<p>Log in as the software owner (in this example, the <code dir="ltr">grid</code> user).</p>
</li>
<li>
<p>To ensure that you are logged in as <code dir="ltr">grid</code>, and to verify that the user ID matches the expected user ID you have assigned to the <code dir="ltr">grid</code> user, enter the commands <code dir="ltr">id</code> and <code dir="ltr">id grid</code>. Ensure that Oracle user group and user and the user terminal window process you are using have group and user IDs are identical. For example:</p>
<pre dir="ltr">$ id 
uid=1100(grid) gid=1000(oinstall) groups=1000(oinstall)
1100(grid,asmadmin,asmdba)
$ id grid
uid=1100(grid) gid=1000(oinstall) groups=1000(oinstall),
1100(grid,asmadmin,asmdba)
</pre></li>
<li>
<p>If necessary, create the <code dir="ltr">.ssh</code> directory in the <code dir="ltr">grid</code> user&#39;s home directory, and set permissions on it to ensure that only the <code dir="ltr">oracle</code> user has read and write permissions:</p>
<pre dir="ltr">$ mkdir ~/.ssh
$ chmod 700 ~/.ssh
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
<a id="sthref876"></a>SSH configuration will fail if the permissions are not set to 700.</div>
</li>
<li>
<p>Enter the following command:</p>
<pre dir="ltr">$ /usr/bin/ssh-keygen -t dsa
</pre>
<p>At the prompts, accept the default location for the key file (press <span class="bold">Enter</span>).</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
SSH with passphrase is not supported for Oracle Clusterware 11<span class="italic">g</span> Release 2 and later releases.</div>
<p>This command writes the DSA public key to the <code dir="ltr">~/.ssh/id_dsa.pub</code> file and the private key to the <code dir="ltr">~/.ssh/id_dsa</code> file.</p>
<p>Never distribute the private key to anyone not authorized to perform Oracle software installations.</p>
</li>
<li>
<p>Repeat steps 1 through 4 on each node that you intend to make a member of the cluster, using the DSA key.</p>
</li>
</ol>
</div>
<!-- class="sect3" -->
<div id="CWLIN411" class="sect3"><a id="sthref877"></a>
<h4 class="sect3"><span class="secnum">F.1.2.2</span> Add All Keys to a Common authorized_keys File</h4>
<p>Complete the following steps:</p>
<ol>
<li>
<p>On the local node, change directories to the <code dir="ltr">.ssh</code> directory in the Oracle Grid Infrastructure owner&#39;s home directory (typically, either <code dir="ltr">grid</code> or <code dir="ltr">oracle</code>).</p>
<p>Then, add the DSA key to the <code dir="ltr">authorized_keys</code> file using the following commands:</p>
<pre dir="ltr">$ cat id_dsa.pub &gt;&gt; authorized_keys
$ ls
</pre>
<p>In the SSH directory, you should see the <code dir="ltr">id_dsa.pub</code> keys that you have created, and the file <code dir="ltr">authorized_keys</code>.</p>
</li>
<li id="BABJHBEF">
<p>On the local node, use SCP (Secure Copy) or SFTP (Secure FTP) to copy the <code dir="ltr">authorized_keys</code> file to the <code dir="ltr">oracle</code> user <code dir="ltr">.ssh</code> directory on a remote node. The following example is with SCP, on a node called node2, with the Oracle Grid Infrastructure owner <code dir="ltr">grid</code>, where the <code dir="ltr">grid</code> user path is <code dir="ltr">/home/grid</code>:</p>
<pre dir="ltr">[grid@node1 .ssh]$ scp authorized_keys node2:/home/grid/.ssh/
</pre>
<p>You are prompted to accept a DSA key. Enter Yes, and you see that the node you are copying to is added to the <code dir="ltr">known_hosts</code> file.</p>
<p>When prompted, provide the password for the Grid user, which should be the same on all nodes in the cluster. The <code dir="ltr">authorized_keys</code> file is copied to the remote node.</p>
<p>Your output should be similar to the following, where <code dir="ltr">xxx</code> represents parts of a valid IP address:</p>
<pre dir="ltr">[grid@node1 .ssh]$ scp authorized_keys node2:/home/grid/.ssh/
The authenticity of host &#39;node2 (xxx.xxx.173.152) can&#39;t be established.
DSA key fingerprint is 7e:60:60:ae:40:40:d1:a6:f7:4e:zz:me:a7:48:ae:f6:7e.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added &#39;node1,xxx.xxx.173.152&#39; (dsa) to the list
of known hosts
grid@node2&#39;s password:
authorized_keys       100%             828             7.5MB/s      00:00
</pre></li>
<li id="BABCIEDC">
<p>Using SSH, log in to the node where you copied the <code dir="ltr">authorized_keys</code> file. Then change to the <code dir="ltr">.ssh</code> directory, and using the <code dir="ltr">cat</code> command, add the DSA keys for the second node to the <code dir="ltr">authorized_keys</code> file, clicking <span class="bold">Enter</span> when you are prompted for a password, so that passwordless SSH is set up:</p>
<pre dir="ltr">[grid@node1 .ssh]$ ssh node2
[grid@node2 grid]$ cd .ssh
[grid@node2 ssh]$ cat id_dsa.pub  &gt;&gt; authorized_keys
</pre>
<p>Repeat steps 2 and 3 from each node to each other member node in the cluster.</p>
<p>When you have added keys from each cluster node member to the <code dir="ltr">authorized_keys</code> file on the last node you want to have as a cluster node member, then use <code dir="ltr">scp</code> to copy the <code dir="ltr">authorized_keys</code> file with the keys from all nodes back to each cluster node member, overwriting the existing version on the other nodes.</p>
<p>To confirm that you have all nodes in the <code dir="ltr">authorized_keys</code> file, enter the command <code dir="ltr">more authorized_keys</code>, and determine if there is a DSA key for each member node. The file lists the type of key (<code dir="ltr">ssh-dsa</code>), followed by the key, and then followed by the user and server. For example:</p>
<pre dir="ltr">ssh-dsa AAAABBBB . . . = grid@node1
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
The <code dir="ltr">grid</code> user&#39;s <code dir="ltr">/.ssh/authorized_keys</code> file on every node must contain the contents from all of the <code dir="ltr">/.ssh/id_dsa.pub</code> files that you generated on all cluster nodes.</div>
</li>
</ol>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="BABHDEIC"></a>
<div id="CWLIN412" class="sect2">
<h3 class="sect2"><span class="secnum">F.1.3</span> Enabling SSH User Equivalency on Cluster Nodes</h3>
<p>After you have copied the <code dir="ltr">authorized_keys</code> file that contains all keys to each node in the cluster, complete the following procedure, in the order listed. In this example, the Oracle Grid Infrastructure software owner is named <code dir="ltr">grid</code>:</p>
<ol>
<li>
<p>On the system where you want to run OUI, log in as the <code dir="ltr">grid</code> user.</p>
</li>
<li id="BABDDIEI">
<p>Use the following command syntax, where <code dir="ltr"><span class="codeinlineitalic">hostname1</span></code>, <code dir="ltr"><span class="codeinlineitalic">hostname2</span></code>, and so on, are the public host names (alias and fully qualified domain name) of nodes in the cluster to run SSH from the local node to each node, including from the local node to itself, and from each node to each other node:</p>
<pre dir="ltr">[grid@<span class="italic">nodename</span>]$ ssh <span class="italic">hostname1</span> date
[grid@<span class="italic">nodename</span>]$ ssh <span class="italic">hostname2</span> date
    .
    .
    .
</pre>
<p>For example:</p>
<pre dir="ltr">[grid@node1 grid]$ ssh node1 date
The authenticity of host &#39;node1 (xxx.xxx.100.101)&#39; can&#39;t be established.
DSA key fingerprint is 7z:60:60:zz:48:48:z1:a0:f7:4e.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added &#39;node1,xxx.xxx.100.101&#39; (DSA) to the list of
known hosts.
Mon Dec 4 11:08:13 PST 2006
[grid@node1 grid]$ ssh node1.example.com date
The authenticity of host &#39;node1.example.com (xxx.xxx.100.101)&#39; can&#39;t be
established.
DSA key fingerprint is 7z:60:60:zz:48:48:z1:a0:f7:4e.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added &#39;node1.example.com,xxx.xxx.100.101&#39; (DSA) to the
list of known hosts.
Mon Dec 4 11:08:13 PST 2006
[grid@node1 grid]$ ssh node2 date
Mon Dec 4 11:08:35 PST 2006
.
.
.
</pre>
<p>At the end of this process, the public host name for each member node should be registered in the <code dir="ltr">known_hosts</code> file for all other cluster nodes.</p>
<p>If you are using a remote client to connect to the local node, and you see a message similar to &#34;Warning: No xauth data; using fake authentication data for <a id="sthref878"></a><a id="sthref879"></a>X11 forwarding,&#34; then this means that your authorized keys file is configured correctly, but your SSH configuration has X11 forwarding enabled. To correct this issue, proceed to <a href="usrgrps.htm#BABDFDJI">Section 6.2.4, &#34;Setting Remote Display and X11 Forwarding Configuration.&#34;</a></p>
</li>
<li>
<p>Repeat step 2 on each cluster node member.</p>
</li>
</ol>
<p>If you have configured SSH correctly, then you can now use the <code dir="ltr">ssh</code> or <code dir="ltr">scp</code> commands without being prompted for a password. For example:</p>
<pre dir="ltr">[grid@node1 ~]$ ssh node2 date
Mon Feb 26 23:34:42 UTC 2009
[grid@node1 ~]$ ssh node1 date
Mon Feb 26 23:34:48 UTC 2009
</pre>
<p>If any node prompts for a password, then verify that the <code dir="ltr">~/.ssh/authorized_keys</code> file on that node contains the correct public keys, and that you have created an Oracle software owner with identical group membership and IDs.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABCHAED"></a>
<div id="CWLIN413" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">F.2</span> Configuring Kernel Parameters<a id="sthref880"></a><a id="sthref881"></a></h2>
<p>This section contains the following:</p>
<ul>
<li>
<p><a href="#BABEAABC">Minimum Parameter Settings for Installation</a></p>
</li>
<li>
<p><a href="#BABJDCDH">Additional Parameter and Kernel Settings for SUSE Linux Enterprise Server</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
The kernel parameter and shell limit values shown in the following section are recommended values only. For production database systems, Oracle recommends that you tune these values to optimize the performance of the system. Refer to your operating system documentation for more information about tuning kernel parameters.</div>
<a id="BABEAABC"></a>
<div id="CWLIN414" class="sect2">
<h3 class="sect2"><span class="secnum">F.2.1</span> Minimum Parameter Settings for Installation</h3>
<p>During installation, or when you run the Cluster Verification Utility (cluvfy) with the flag <code dir="ltr">-fixup</code>, a fixup script is generated. This script updates required kernel parameters if necessary to minimum values.</p>
<p>If you cannot use the fixup scripts, then review <a href="#CJADEEFJ">Table F-1</a> to set values manually:</p>
<div class="tblhruleformalwide">
<p class="titleintable"><a id="sthref882"></a><a id="CJADEEFJ"></a>Table F-1 Minimum Operating System Parameter Settings for Installation on Linux</p>
<table class="cellalignment617" title="Minimum Operating System Parameter Settings for Installation on Linux" summary="This table shows the recommended values for kernel parameters on Linux" dir="ltr">
<thead>
<tr class="cellalignment606">
<th class="cellalignment618" id="r1c1-t7">Parameter</th>
<th class="cellalignment618" id="r1c2-t7">Value</th>
<th class="cellalignment618" id="r1c3-t7">File</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment606">
<td class="cellalignment612" id="r2c1-t7" headers="r1c1-t7"><br/>
<code dir="ltr">semmsl</code><a id="sthref883"></a><br/>
<code dir="ltr">semmns</code><a id="sthref884"></a><br/>
<code dir="ltr"><a id="sthref885"></a>semopm</code><br/>
<a id="sthref886"></a><code dir="ltr">semmni</code></td>
<td class="cellalignment612" headers="r2c1-t7 r1c2-t7"><br/>
250<br/>
32000<br/>
100<br/>
128</td>
<td class="cellalignment612" headers="r2c1-t7 r1c3-t7">
<p><code dir="ltr"><a id="sthref887"></a>/proc/sys/kernel/<a id="sthref888"></a>sem</code></p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r3c1-t7" headers="r1c1-t7">
<p><code dir="ltr">shmall</code></p>
</td>
<td class="cellalignment612" headers="r3c1-t7 r1c2-t7">
<p>40 percent of the size of physical memory in pages.</p>
<p>If the server supports multiple databases, or uses a large SGA, then set this parameter to a value that is equal to the total amount of shared memory, in 4K pages, that the system can use at one time.</p>
</td>
<td class="cellalignment612" headers="r3c1-t7 r1c3-t7">
<p><code dir="ltr"><a id="sthref889"></a>/proc/sys/kernel/<a id="sthref890"></a><a id="sthref891"></a>shmall</code></p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r4c1-t7" headers="r1c1-t7">
<p><code dir="ltr">shmmax</code></p>
</td>
<td class="cellalignment612" headers="r4c1-t7 r1c2-t7">
<p>Half the size of physical memory in bytes</p>
<p>See My Oracle Support Note 567506.1 for additional information about configuring <code dir="ltr">shmmax</code>.</p>
</td>
<td class="cellalignment612" headers="r4c1-t7 r1c3-t7">
<p><code dir="ltr">/proc/sys/kernel/<a id="sthref892"></a><a id="sthref893"></a>shmmax</code></p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r5c1-t7" headers="r1c1-t7">
<p><code dir="ltr">shmmni</code></p>
</td>
<td class="cellalignment612" headers="r5c1-t7 r1c2-t7">
<p>4096</p>
</td>
<td class="cellalignment612" headers="r5c1-t7 r1c3-t7">
<p><code dir="ltr"><a id="sthref894"></a>/proc/sys/kernel/<a id="sthref895"></a><a id="sthref896"></a>shmmni</code></p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r6c1-t7" headers="r1c1-t7">
<p><code dir="ltr">file-max</code></p>
</td>
<td class="cellalignment612" headers="r6c1-t7 r1c2-t7">
<p>6815744</p>
</td>
<td class="cellalignment612" headers="r6c1-t7 r1c3-t7">
<p><code dir="ltr"><a id="sthref897"></a>/proc/sys/fs/<a id="sthref898"></a>file-max</code></p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r7c1-t7" headers="r1c1-t7">
<p><code dir="ltr">aio-max-nr</code></p>
</td>
<td class="cellalignment612" headers="r7c1-t7 r1c2-t7">
<p>1048576</p>
<p><span class="bold">Note</span>: This value limits concurrent outstanding requests and should be set to avoid I/O subsystem failures.</p>
</td>
<td class="cellalignment612" headers="r7c1-t7 r1c3-t7">
<p><a id="sthref899"></a><code dir="ltr">/proc/sys/fs/<a id="sthref900"></a>aio-max-nr</code></p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r8c1-t7" headers="r1c1-t7">
<p><code dir="ltr">ip_local_port_range</code></p>
</td>
<td class="cellalignment612" headers="r8c1-t7 r1c2-t7">
<p>Minimum: 9000</p>
<p>Maximum: 65500</p>
</td>
<td class="cellalignment612" headers="r8c1-t7 r1c3-t7">
<p><code dir="ltr"><a id="sthref901"></a>/proc/sys/net/ipv4/<a id="sthref902"></a>ip_local_port_range</code></p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r9c1-t7" headers="r1c1-t7">
<p><code dir="ltr">rmem_default</code></p>
</td>
<td class="cellalignment612" headers="r9c1-t7 r1c2-t7">
<p>262144</p>
</td>
<td class="cellalignment612" headers="r9c1-t7 r1c3-t7">
<p><code dir="ltr"><a id="sthref903"></a>/proc/sys/net/core/<a id="sthref904"></a>rmem_default</code></p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r10c1-t7" headers="r1c1-t7">
<p><code dir="ltr">rmem_max</code></p>
</td>
<td class="cellalignment612" headers="r10c1-t7 r1c2-t7">
<p>4194304</p>
</td>
<td class="cellalignment612" headers="r10c1-t7 r1c3-t7">
<p><code dir="ltr"><a id="sthref905"></a>/proc/sys/net/core/<a id="sthref906"></a>rmem_max</code></p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r11c1-t7" headers="r1c1-t7">
<p><code dir="ltr">wmem_default</code></p>
</td>
<td class="cellalignment612" headers="r11c1-t7 r1c2-t7">
<p>262144</p>
</td>
<td class="cellalignment612" headers="r11c1-t7 r1c3-t7">
<p><code dir="ltr"><a id="sthref907"></a>/proc/sys/net/core/<a id="sthref908"></a>wmem_default</code></p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r12c1-t7" headers="r1c1-t7">
<p><code dir="ltr">wmem_max</code></p>
</td>
<td class="cellalignment612" headers="r12c1-t7 r1c2-t7">
<p>1048576</p>
</td>
<td class="cellalignment612" headers="r12c1-t7 r1c3-t7">
<p><code dir="ltr"><a id="sthref909"></a>/proc/sys/net/core/<a id="sthref910"></a>wmem_max</code></p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r13c1-t7" headers="r1c1-t7">
<p><code dir="ltr">panic_on_oops</code></p>
</td>
<td class="cellalignment612" headers="r13c1-t7 r1c2-t7">
<p>1</p>
</td>
<td class="cellalignment612" headers="r13c1-t7 r1c3-t7">
<p><code dir="ltr">/proc/sys/kernel/panic_on_oops</code></p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblhruleformalwide" -->
<div class="infobox-note">
<p class="notep1">Note:</p>
If you intend to install Oracle Databases or Oracle RAC databases on the cluster, be aware that the size of the <code dir="ltr">/dev/shm</code> mount area on each server must be greater than the system global area (SGA) and the program global area (PGA) of the databases on the servers. Review expected SGA and PGA sizes with database administrators to ensure that you do not have to increase <code dir="ltr">/dev/shm</code> after databases are installed on the cluster.</div>
</div>
<!-- class="sect2" -->
<a id="BABJDCDH"></a>
<div id="CWLIN415" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">F.2.2</span> Additional Parameter and Kernel Settings for SUSE Linux Enterprise Server</h3>
<p>On SUSE Linux Enterprise Server systems only, complete the following steps as needed:</p>
<ol>
<li>
<p>Enter the following command to cause the system to read the <code dir="ltr">/etc/sysctl.conf</code> file when it restarts:</p>
<pre dir="ltr"># /sbin/chkconfig boot.sysctl on
</pre></li>
<li>
<p>Enter the GID of the <code dir="ltr">oinstall</code> group as the value for the parameter <code dir="ltr">/proc/sys/vm/hugetlb_shm_group</code>. Doing this grants members of <code dir="ltr">oinstall</code> a group permission to create shared memory segments.</p>
<p>For example, where the oinstall group GID is 1000:</p>
<pre dir="ltr"># echo 1000 &gt; /proc/sys/vm/hugetlb_shm_group
</pre>
<p>After running this command, use <code dir="ltr">vi</code> to add the following text to <code dir="ltr">/etc/sysctl.conf</code>, and enable the <code dir="ltr">boot.sysctl</code> script to run on system restart:</p>
<pre dir="ltr">vm.hugetlb_shm_group=1000
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
Only one group can be defined as the <code dir="ltr">vm.hugetlb_shm_group</code>.</div>
</li>
<li>
<p>Repeat steps 1 through 3 on all other nodes in the cluster.</p>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CEGIEGAJ"></a>
<div id="CWLIN472" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">F.3</span> <a id="sthref911"></a><a id="sthref912"></a><a id="sthref913"></a><a id="sthref914"></a><a id="sthref915"></a>Setting UDP and TCP Kernel Parameters Manually</h2>
<p>If you do not use a Fixup script or CVU to set ephemeral ports, then set TCP/IP ephemeral port range parameters manually to provide enough ephemeral ports for the anticipated server workload. Ensure that the lower range is set to at least 9000 or higher, to avoid Well Known ports, and to avoid ports in the Registered Ports range commonly used by Oracle and other server ports. Set the port range high enough to avoid reserved ports for any applications you may intend to use. If the lower value of the range you have is greater than 9000, and the range is large enough for your anticipated workload, then you can ignore OUI warnings regarding the ephemeral port range.</p>
<p>For example, with IPv4, use the following command to check your current range for ephemeral ports:</p>
<pre dir="ltr">$ cat /proc/sys/net/ipv4/ip_local_port_range
32768 61000
</pre>
<p>In the preceding example, the lowest port (32768) and the highest port (61000) are set to the default range.</p>
<p>If necessary, update the UDP and TCP ephemeral port range to a range high enough for anticipated system workloads, and to ensure that the ephemeral port range starts at 9000 and above. For example:</p>
<pre dir="ltr"># echo 9000 65500 &gt; /proc/sys/net/ipv4/ip_local_port_range
</pre>
<p>Oracle recommends that you make these settings permanent. For example, as <code dir="ltr">root</code>, use a text editor to open <code dir="ltr">/etc/sysctl.conf</code>, and add or change to the following: <code dir="ltr">net.ipv4.ip_local_port_range = 9000 65500</code>, and then restart the network (<code dir="ltr"># /etc/rc.d/init.d/network restart</code>). Refer to your Linux distribution system administration documentation for detailed information about how to automate this ephemeral port range alteration on system restarts.</p>
</div>
<!-- class="sect1" -->
<a id="BABFAEFE"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">F.4</span> Configuring Storage Paths and Disk Devices</h2>
<p>For persistent device naming, you can configure ASMLIB or set <code dir="ltr">udev</code> rules.</p>
<p>This section consists of the following:</p>
<ul>
<li>
<p><a href="#BABBCABD">Configuring Storage Device Path Persistence Using Oracle ASMLIB</a></p>
</li>
<li>
<p><a href="#BABIIGFD">Configuring Disk Devices Manually for Oracle ASM</a></p>
</li>
</ul>
<a id="BABBCABD"></a>
<div class="sect2">
<h3 class="sect2"><span class="secnum">F.4.1</span> Configuring Storage Device Path Persistence Using Oracle ASMLIB</h3>
<p>Oracle recommends that you use Oracle ASM Filter Driver (ASMFD) to maintain device persistence. However, you can choose to use ASMLIB for device persistence.</p>
<p>Review the following section to configure Oracle ASMLIB:</p>
<ul>
<li>
<p><a href="#BABGICGB">About Oracle ASM with Oracle ASMLIB</a></p>
</li>
<li>
<p><a href="#BABDDBIG">Configuring Oracle ASMLIB to Maintain Block Devices</a></p>
</li>
<li>
<p><a href="#BABJHCBF">Configuring Oracle ASMLIB for Multipath Disks</a></p>
</li>
<li>
<p><a href="#BABGAICH">Deinstalling Oracle ASMLIB</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle ASMLIB is not supported on IBM:Linux on System z.</div>
<a id="BABGICGB"></a>
<div class="sect3">
<h4 class="sect3"><span class="secnum">F.4.1.1</span> About Oracle ASM with Oracle ASMLIB</h4>
<p>The Oracle Automatic Storage Management (Oracle ASM) library driver (ASMLIB) simplifies the configuration and management of block disk devices by eliminating the need to rebind block disk devices used with Oracle ASM each time the system is restarted.</p>
<p>With ASMLIB, you define the range of disks you want to have made available as Oracle ASM disks. ASMLIB maintains permissions and disk labels that are persistent on the storage device, so that label is available even after an operating system upgrade. You can update storage paths on all cluster member nodes by running one <code dir="ltr">oracleasm</code> command on each node, without the need to modify the <code dir="ltr">udev</code> file manually to provide permissions and path persistence.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you configure disks using ASMLIB, then you must change the disk discovery string to ORCL:*. If the disk string is set to ORCL:*, or is left empty (&#34;&#34;), then the installer discovers these disks.</div>
</div>
<!-- class="sect3" -->
<a id="BABDDBIG"></a>
<div class="sect3">
<h4 class="sect3"><span class="secnum">F.4.1.2</span> Configuring Oracle ASMLIB to Maintain Block Devices</h4>
<p>To use the Oracle Automatic Storage Management Library Driver (ASMLIB) to configure Oracle ASM devices, complete the following tasks.</p>
<ul>
<li>
<p><a href="#BABDEEFH">Installing and Configuring the Oracle ASM Library Driver Software</a></p>
</li>
<li>
<p><a href="#BABDBEBG">Configuring Disk Devices to Use Oracle ASM Library Driver on x86 Systems</a></p>
</li>
<li>
<p><a href="#BABHIBHC">Administering the Oracle ASM Library Driver and Disks</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
To create a database during the installation using the Oracle ASM library driver, you must choose an installation method that runs ASMCA in interactive mode. You must also change the default disk discovery string to <code dir="ltr">ORCL:*.</code></div>
<a id="BABDEEFH"></a>
<div class="sect4">
<h5 class="sect4"><span class="secnum">F.4.1.2.1</span> Installing and Configuring the Oracle ASM Library Driver Software<a id="sthref916"></a><a id="sthref917"></a></h5>
<p><a id="sthref918"></a><a id="sthref919"></a>ASMLIB is already included with Oracle Linux packages, and with SUSE Linux Enterprise Server. If you are a member of the Unbreakable Linux Network, then you can install the ASMLIB RPMs by subscribing to the Oracle Linux channel, and using <code dir="ltr">yum</code> to retrieve the most current package for your system and kernel. For additional information, see the following URL:</p>
<pre dir="ltr"><a href="http://www.oracle.com/technetwork/topics/linux/asmlib/index-101839.html">http://www.oracle.com/technetwork/topics/linux/asmlib/index-101839.html</a>
</pre>
<p>To install and configure the ASMLIB driver software manually, follow these steps:</p>
<ol>
<li>
<p>Enter the following command to determine the kernel version and architecture of the system:<a id="sthref920"></a></p>
<pre dir="ltr"># uname -rm
</pre></li>
<li>
<p>Download the required ASMLIB packages from the Oracle Technology Network website:</p>
<pre dir="ltr"><a href="http://www.oracle.com/technetwork/server-storage/linux/downloads/index-088143.html">http://www.oracle.com/technetwork/server-storage/linux/downloads/index-088143.html</a>
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
You must install <code dir="ltr">oracleasm-support</code> package version 2.0.1 or later to use ASMLIB on Red Hat Enterprise Linux 5 Advanced Server. ASMLIB is already included with SUSE Linux Enterprise Server distributions.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
My Oracle Support Note 1089399.1 for information about ASMLIB support with Red Hat distributions:
<p><code dir="ltr"><a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1089399.1">https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1089399.1</a></code></p>
</div>
</li>
<li>
<p>Switch user to the <code dir="ltr">root</code> user:</p>
<pre dir="ltr">$ su -
</pre></li>
<li>
<p>Install the following packages in sequence, where <code dir="ltr"><span class="codeinlineitalic">version</span></code> is the version of the ASMLIB driver, <code dir="ltr"><span class="codeinlineitalic">arch</span></code> is the system architecture, and <code dir="ltr"><span class="codeinlineitalic">kernel</span></code> is the version of the kernel that you are using:</p>
<pre dir="ltr">oracleasm-support-<span class="italic">version</span>.<span class="italic">arch</span>.rpm
oracleasm-<span class="italic">kernel</span>-<span class="italic">version</span>.<span class="italic">arch</span>.rpm
oracleasmlib-<span class="italic">version</span>.<span class="italic">arch</span>.rpm
</pre>
<p>Enter a command similar to the following to install the packages:</p>
<pre dir="ltr"># rpm -ivh oracleasm-support-<span class="italic">version</span>.<span class="italic">arch</span>.rpm \
           oracleasm-<span class="italic">kernel</span>-<span class="italic">version</span>.<span class="italic">arch</span>.rpm \
           oracleasmlib-<span class="italic">version</span>.<span class="italic">arch</span>.rpm
</pre>
<p>For example, if you are using the Red Hat Enterprise Linux 5 AS kernel on an AMD64 system, then enter a command similar to the following:</p>
<pre dir="ltr"># rpm -ivh oracleasm-support-2.1.3-1.el5.x86_64.rpm \
     oracleasm-2.6.18-194.26.1.el5xen-2.0.5-1.el5.x86_64.rpm \
     oracleasmlib-2.0.4-1.el5.x86_64.rpm
</pre></li>
<li>
<p><a id="sthref921"></a><a id="sthref922"></a>Enter the following command to run the <code dir="ltr">oracleasm</code> initialization script with the <code dir="ltr">configure</code> option:</p>
<pre dir="ltr"># /usr/sbin/oracleasm configure -i
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
The <code dir="ltr">oracleasm</code> command in <code dir="ltr">/usr/sbin</code> is the command you should use. The <code dir="ltr">/etc/init.d</code> path is not deprecated, but the <code dir="ltr">oracleasm</code> binary in that path is now used typically for internal commands.</div>
</li>
<li>
<p><a id="sthref923"></a>Enter the following information in response to the prompts that the script displays:</p>
<div class="tblformal">
<p class="titleintable"><a id="sthref924"></a><a id="sthref925"></a>Table F-2 ORACLEASM Configure Prompts and Responses</p>
<table class="cellalignment619" title="ORACLEASM Configure Prompts and Responses" summary="ASMLIB configuration interview questions and suggested responses" dir="ltr">
<thead>
<tr class="cellalignment606">
<th class="cellalignment618" id="r1c1-t16">Prompt</th>
<th class="cellalignment618" id="r1c2-t16">Suggested Response</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment606">
<td class="cellalignment612" id="r2c1-t16" headers="r1c1-t16">
<p>Default user to own the driver interface:</p>
</td>
<td class="cellalignment612" headers="r2c1-t16 r1c2-t16">
<p><span class="bold">Standard groups and users configuration</span>: Specify the Oracle software owner user (for example, <code dir="ltr">oracle</code>).</p>
<p><span class="bold">Job role separation groups and users configuration:</span> Specify the Oracle Grid Infrastructure software owner user (for example, <code dir="ltr">grid</code>).</p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r3c1-t16" headers="r1c1-t16">
<p>Default group to own the driver interface:</p>
</td>
<td class="cellalignment612" headers="r3c1-t16 r1c2-t16">
<p><span class="bold">Standard groups and users configuration</span>: Specify the OSDBA group for the database (for example, <code dir="ltr">dba</code>).</p>
<p><span class="bold">Job role separation groups and users configuration:</span> Specify the OSASM group for storage administration (for example, <code dir="ltr">asmadmin</code>).</p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r4c1-t16" headers="r1c1-t16">
<p>Start Oracle ASM Library driver on boot (y/n):</p>
</td>
<td class="cellalignment612" headers="r4c1-t16 r1c2-t16">
<p>Enter <code dir="ltr">y</code> to start the Oracle Automatic Storage Management library driver when the system starts.</p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r5c1-t16" headers="r1c1-t16">
<p>Scan for Oracle ASM disks on boot (y/n)</p>
</td>
<td class="cellalignment612" headers="r5c1-t16 r1c2-t16">
<p>Enter <code dir="ltr">y</code> to scan for Oracle ASM disks when the system starts.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<p>The script completes the following tasks:</p>
<ul>
<li>
<p>Creates the <code dir="ltr">/etc/sysconfig/oracleasm</code> configuration file</p>
</li>
<li>
<p>Creates the <code dir="ltr">/dev/oracleasm</code> mount point</p>
</li>
<li>
<p>Mounts the ASMLIB driver file system</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The ASMLIB driver file system is not a regular file system. It is used only by the Oracle ASM library to communicate with the Oracle ASM driver.</div>
</li>
</ul>
</li>
<li>
<p>Enter the following command to load the <code dir="ltr">oracleasm</code> kernel module:</p>
<pre dir="ltr"># /usr/sbin/oracleasm init
</pre></li>
<li>
<p>Repeat this procedure on all nodes in the cluster where you want to install Oracle RAC.</p>
</li>
</ol>
</div>
<!-- class="sect4" -->
<a id="BABDBEBG"></a>
<div class="sect4">
<h5 class="sect4"><span class="secnum">F.4.1.2.2</span> Configuring Disk Devices to Use Oracle ASM Library Driver on x86 Systems</h5>
<p>To configure the disk devices to use in an Oracle ASM disk group, follow these steps:</p>
<ol>
<li>
<p>If you intend to use IDE, SCSI, or RAID devices in the Oracle ASM disk group, then follow these steps:</p>
<ol>
<li>
<p>If necessary, install or configure the shared disk devices that you intend to use for the disk group and restart the system.<a id="sthref926"></a></p>
</li>
<li>
<p>Enter the following command to identify the device name for the disks to use, enter the following command:<a id="sthref927"></a><a id="sthref928"></a><a id="sthref929"></a><a id="sthref930"></a><a id="sthref931"></a><a id="sthref932"></a><a id="sthref933"></a><a id="sthref934"></a></p>
<pre dir="ltr"># /sbin/fdisk -l
</pre>
<p>Depending on the type of disk, the device name can vary. <a href="#BABEBFCD">Table F-3</a> describes some types of disk paths:<a id="sthref935"></a></p>
<div class="tblformal">
<p class="titleintable"><a id="sthref936"></a><a id="BABEBFCD"></a>Table F-3 Types of Linux Storage Disk Paths</p>
<table class="cellalignment619" title="Types of Linux Storage Disk Paths" summary="This table shows the format of Linux disk device names" dir="ltr">
<thead>
<tr class="cellalignment606">
<th class="cellalignment618" id="r1c1-t18">Disk Type</th>
<th class="cellalignment618" id="r1c2-t18">Device Name Format</th>
<th class="cellalignment618" id="r1c3-t18">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment606">
<td class="cellalignment612" id="r2c1-t18" headers="r1c1-t18">
<p><a id="sthref937"></a><a id="sthref938"></a>IDE disk</p>
</td>
<td class="cellalignment612" headers="r2c1-t18 r1c2-t18">
<pre dir="ltr">/dev/hd<span class="italic">xn</span>
</pre></td>
<td class="cellalignment612" headers="r2c1-t18 r1c3-t18">
<p>In this example, <code dir="ltr"><span class="codeinlineitalic">x</span></code> is a letter that identifies the IDE disk and <code dir="ltr"><span class="codeinlineitalic">n</span></code> is the partition number. For example, <code dir="ltr">/dev/hda</code> is the first disk on the first IDE bus.</p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r3c1-t18" headers="r1c1-t18">
<p><a id="sthref939"></a><a id="sthref940"></a>SCSI disk</p>
</td>
<td class="cellalignment612" headers="r3c1-t18 r1c2-t18">
<pre dir="ltr">/dev/sd<span class="italic">xn</span>
</pre></td>
<td class="cellalignment612" headers="r3c1-t18 r1c3-t18">
<p>In this example, <code dir="ltr"><span class="codeinlineitalic">x</span></code> is a letter that identifies the SCSI disk and <code dir="ltr"><span class="codeinlineitalic">n</span></code> is the partition number. For example, <code dir="ltr">/dev/sda</code> is the first disk on the first SCSI bus.</p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r4c1-t18" headers="r1c1-t18">
<p><a id="sthref941"></a><a id="sthref942"></a>RAID disk</p>
</td>
<td class="cellalignment612" headers="r4c1-t18 r1c2-t18">
<pre dir="ltr">/dev/rd/c<span class="italic">x</span>d<span class="italic">y</span>p<span class="italic">z</span>
/dev/ida/c<span class="italic">x</span>d<span class="italic">y</span>p<span class="italic">z</span>
</pre></td>
<td class="cellalignment612" headers="r4c1-t18 r1c3-t18">
<p>Depending on the RAID controller, RAID devices can have different device names. In the examples shown, <code dir="ltr"><span class="codeinlineitalic">x</span></code> is a number that identifies the controller, <code dir="ltr"><span class="codeinlineitalic">y</span></code> is a number that identifies the disk, and <code dir="ltr"><span class="codeinlineitalic">z</span></code> is a number that identifies the partition. For example, <code dir="ltr">/dev/ida/c0d1</code> is the second logical drive on the first controller.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<p><a id="sthref943"></a><a id="sthref944"></a>To include devices in a disk group, you can specify either whole-drive device names or partition device names.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle recommends that you create a single whole-disk partition on each disk.</div>
</li>
<li>
<p>Use either <code dir="ltr">fdisk</code> or <code dir="ltr">parted</code> to create a single whole-disk partition on the disk devices.</p>
</li>
</ol>
</li>
<li>
<p>Enter a command similar to the following to mark a disk as an Oracle ASM disk:</p>
<pre dir="ltr"># /usr/sbin/oracleasm createdisk DISK1 /dev/sdb1
</pre>
<p>In this example, <code dir="ltr">DISK1</code> is the name you assign to the disk.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The disk names that you specify can contain uppercase letters, numbers, and the underscore character. They must start with an uppercase letter.
<p>If you are using a multi-pathing disk driver with Oracle ASM, then make sure that you specify the correct logical device name for the disk.</p>
</div>
</li>
<li>
<p>To make the disk available on the other nodes in the cluster, enter the following command as <code dir="ltr">root</code> on each node:</p>
<pre dir="ltr"># /usr/sbin/oracleasm scandisks
</pre>
<p>This command identifies shared disks attached to the node that are marked as Oracle ASM disks.</p>
</li>
</ol>
</div>
<!-- class="sect4" -->
<a id="CHDBHJIF"></a>
<div id="CWLIN296" class="sect4">
<h5 class="sect4"><span class="secnum">F.4.1.2.3</span> Configuring Disk Devices to Use ASM Library Driver on IBM zSeries Systems</h5>
<ol>
<li>
<p>If you formatted the DASD with the compatible disk layout, then enter a command similar to the following to create a single whole-disk partition on the device:</p>
<pre dir="ltr"># /sbin/fdasd -a /dev/dasdxxxx
</pre></li>
<li>
<p>Enter a command similar to the following to mark a disk as an ASM disk:</p>
<pre dir="ltr"># /etc/init.d/oracleasm createdisk DISK1 /dev/dasdxxxx
</pre>
<p>In this example, <code dir="ltr">DISK1</code> is a name that you want to assign to the disk.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The disk names that you specify can contain uppercase letters, numbers, and the underscore character. They must start with an uppercase letter.
<p>If you are using a multi-pathing disk driver with ASM, then make sure that you specify the correct logical device name for the disk.</p>
</div>
</li>
<li>
<p>To make the disk available on the other cluster nodes, enter the following command as root on each node:</p>
<pre dir="ltr"># /etc/init.d/oracleasm scandisks
</pre>
<p>This command identifies shared disks attached to the node that are marked as ASM disks.</p>
</li>
</ol>
</div>
<!-- class="sect4" -->
<a id="BABHIBHC"></a>
<div class="sect4">
<h5 class="sect4"><span class="secnum">F.4.1.2.4</span> Administering the Oracle ASM Library Driver and Disks</h5>
<p>To administer the Oracle Automatic Storage Management library driver (ASMLIB) and disks, use the <code dir="ltr">/usr/sbin/oracleasm</code> initialization script with different options, as described in <a href="#BABCHAIE">Table F-4</a>:</p>
<div class="tblhruleformalwide">
<p class="titleintable"><a id="sthref945"></a><a id="BABCHAIE"></a>Table F-4 Disk Management Tasks Using ORACLEASM</p>
<table class="cellalignment617" title="Disk Management Tasks Using ORACLEASM" summary="Options for oracleasm command to administer disks managed by ASMLIB" dir="ltr">
<thead>
<tr class="cellalignment606">
<th class="cellalignment618" id="r1c1-t22">Task</th>
<th class="cellalignment618" id="r1c2-t22">Command Example</th>
<th class="cellalignment618" id="r1c3-t22">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment606">
<td class="cellalignment612" id="r2c1-t22" headers="r1c1-t22">
<p>Configure or reconfigure ASMLIB</p>
</td>
<td class="cellalignment612" headers="r2c1-t22 r1c2-t22">
<pre dir="ltr">oracleasm configure -i
</pre></td>
<td class="cellalignment612" headers="r2c1-t22 r1c3-t22">
<p>Use the <code dir="ltr">configure</code> option to reconfigure the Oracle Automatic Storage Management library driver, if necessary.</p>
<p>To see command options, enter <code dir="ltr">oracleasm configure</code> without the <code dir="ltr">-i</code> flag.</p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r3c1-t22" headers="r1c1-t22">
<p>Change system restart load options for ASMLIB</p>
</td>
<td class="cellalignment612" headers="r3c1-t22 r1c2-t22">
<pre dir="ltr">oracleasm enable
</pre></td>
<td class="cellalignment612" headers="r3c1-t22 r1c3-t22">
<p>Options are <code dir="ltr">disable</code> and <code dir="ltr">enable</code>.</p>
<p>Use the <code dir="ltr">disable</code> and <code dir="ltr">enable</code> options to change the actions of the Oracle Automatic Storage Management library driver when the system starts. The <code dir="ltr">enable</code> option causes the Oracle Automatic Storage Management library driver to load when the system starts</p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r4c1-t22" headers="r1c1-t22">
<p>Load or unload ASMLIB without restarting the system</p>
</td>
<td class="cellalignment612" headers="r4c1-t22 r1c2-t22">
<pre dir="ltr">oracleasm restart
</pre></td>
<td class="cellalignment612" headers="r4c1-t22 r1c3-t22">
<p>Options are <code dir="ltr">start</code>, <code dir="ltr">stop</code> and <code dir="ltr">restart</code>.</p>
<p>Use the <code dir="ltr">start</code>, <code dir="ltr">stop</code>, and <code dir="ltr">restart</code> options to load or unload the Oracle Automatic Storage Management library driver without restarting the system.</p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r5c1-t22" headers="r1c1-t22">
<p>Mark a disk for use with ASMLIB</p>
</td>
<td class="cellalignment612" headers="r5c1-t22 r1c2-t22">
<pre dir="ltr">oracleasm createdisk VOL1 /dev/sda1
</pre></td>
<td class="cellalignment612" headers="r5c1-t22 r1c3-t22">
<p>Use the <code dir="ltr">createdisk</code> option to mark a disk device for use with the Oracle Automatic Storage Management library driver and give it a name, where <span class="italic">labelname</span> is the name you want to use to mark the device, and <span class="italic">devicepath</span> is the path to the device:</p>
<p>oracleasm createdisk <span class="italic">labelname</span> <span class="italic">devicepath</span></p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r6c1-t22" headers="r1c1-t22">
<p>Unmark a named disk device</p>
</td>
<td class="cellalignment612" headers="r6c1-t22 r1c2-t22">
<pre dir="ltr">oracleasm deletedisk VOL1
</pre></td>
<td class="cellalignment612" headers="r6c1-t22 r1c3-t22">
<p>Use the <code dir="ltr">deletedisk</code> option to unmark a named disk device, where <span class="italic">diskname</span> is the name of the disk:</p>
<p>oracleasm deletedisk <span class="italic">diskname</span></p>
<p><span class="bold">Caution:</span> Do not use this command to unmark disks that are being used by an Oracle Automatic Storage Management disk group. You must delete the disk from the Oracle Automatic Storage Management disk group before you unmark it.</p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r7c1-t22" headers="r1c1-t22">
<p>Determine if ASMLIB is using a disk device</p>
</td>
<td class="cellalignment612" headers="r7c1-t22 r1c2-t22">
<pre dir="ltr">oracleasm querydisk
</pre></td>
<td class="cellalignment612" headers="r7c1-t22 r1c3-t22">
<p>Use the <code dir="ltr">querydisk</code> option to determine if a disk device or disk name is being used by the Oracle Automatic Storage Management library driver, where diskname_devicename is the name of the disk or device that you want to query:</p>
<p>oracleasm querydisk <span class="italic">diskname_devicename</span></p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r8c1-t22" headers="r1c1-t22">
<p>List Oracle ASMLIB disks</p>
</td>
<td class="cellalignment612" headers="r8c1-t22 r1c2-t22">
<pre dir="ltr">oracleasm listdisks
</pre></td>
<td class="cellalignment612" headers="r8c1-t22 r1c3-t22">
<p>Use the <code dir="ltr">listdisks</code> option to list the disk names of marked ASMLIB disks.</p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r9c1-t22" headers="r1c1-t22">
<p>Identify disks marked as ASMLIB disks</p>
</td>
<td class="cellalignment612" headers="r9c1-t22 r1c2-t22">
<pre dir="ltr">oracleasm scandisks
</pre></td>
<td class="cellalignment612" headers="r9c1-t22 r1c3-t22">
<p>Use the <code dir="ltr">scandisks</code> option to enable cluster nodes to identify which shared disks have been marked as ASMLIB disks on another node.</p>
</td>
</tr>
<tr class="cellalignment606">
<td class="cellalignment612" id="r10c1-t22" headers="r1c1-t22">
<p>Rename ASMLIB disks</p>
</td>
<td class="cellalignment612" headers="r10c1-t22 r1c2-t22">
<pre dir="ltr">oracleasm renamedisk VOL1 VOL2
</pre></td>
<td class="cellalignment612" headers="r10c1-t22 r1c3-t22">
<p>Use the <code dir="ltr">renamedisk</code> option to change the label of an Oracle ASM library driver disk or device by using the following syntax, where <span class="italic">manager</span> specifies the manager device, <span class="italic">label_device</span> specifies the disk you intend to rename, as specified either by OracleASM label name or by the device path, and <span class="italic">new_label</span> specifies the new label you want to use for the disk:</p>
<p><code dir="ltr">oracleasm renamedisk</code> [<code dir="ltr">-l</code> <span class="italic">manager</span>] [<code dir="ltr">-v</code>] <span class="italic">label_device</span> <span class="italic">new_label</span></p>
<p>Use the <code dir="ltr">-v</code> flag to provide a verbose output for debugging.</p>
<p><span class="bold">Caution</span>: You must ensure that all Oracle Database and Oracle ASM instances have ceased using the disk before you relabel the disk. If you do not do this, then you may lose data.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblhruleformalwide" --></div>
<!-- class="sect4" --></div>
<!-- class="sect3" -->
<a id="BABJHCBF"></a>
<div class="sect3">
<h4 class="sect3"><span class="secnum">F.4.1.3</span> Configuring Oracle ASMLIB for Multipath Disks</h4>
<p>Additional configuration is required to use the Oracle Automatic Storage Management library Driver (ASMLIB) with third party vendor multipath disks.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
My Oracle Support site for updates to supported storage options:
<pre dir="ltr"><a href="https://support.oracle.com/">https://support.oracle.com/</a>
</pre></div>
<div class="sect4"><a id="sthref946"></a>
<h5 class="sect4"><span class="secnum">F.4.1.3.1</span> About Using Oracle ASM with Multipath Disks</h5>
<p>Oracle ASM requires that each disk is uniquely identified. If the same disk appears under multiple paths, then it causes errors. In a multipath disk configuration, the same disk can appear three times:</p>
<ol>
<li>
<p>The initial path to the disk</p>
</li>
<li>
<p>The second path to the disk</p>
</li>
<li>
<p>The multipath disk access point</p>
</li>
</ol>
<p>For example: If you have one local disk, <code dir="ltr">/dev/sda</code>, and one disk attached with external storage, then your server shows two connections, or paths, to that external storage. The Linux SCSI driver shows both paths. They appear as <code dir="ltr">/dev/sdb</code> and <code dir="ltr">/dev/sdc</code>. The system may access either <code dir="ltr">/dev/sdb</code> or <code dir="ltr">/dev/sdc</code>, but the access is to the same disk.</p>
<p>If you enable multipathing, then you have a multipath disk (for example, <code dir="ltr">/dev/multipatha</code>), which can access both <code dir="ltr">/dev/sdb</code> and <code dir="ltr">/dev sdc</code>; any I/O to <code dir="ltr">multipatha</code> can use either the <code dir="ltr">sdb</code> or <code dir="ltr">sdc</code> path. If a system is using the <code dir="ltr">/dev/sdb</code> path, and that cable is unplugged, then the system shows an error. But the multipath disk will switch from the <code dir="ltr">/dev/sdb</code> path to the <code dir="ltr">/dev/sdc</code> path.</p>
<p>Most system software is unaware of multipath configurations. They can use any paths (<code dir="ltr">sdb</code>, <code dir="ltr">sdc</code> or <code dir="ltr">multipatha</code>). ASMLIB also is unaware of multipath configurations.</p>
<p>By default, ASMLIB recognizes the first disk path that Linux reports to it, but because it imprints an identity on that disk, it recognizes that disk only under one path. Depending on your storage driver, it may recognize the multipath disk, or it may recognize one of the single disk paths.</p>
<p>Instead of relying on the default, you should configure Oracle ASM to recognize the multipath disk.</p>
</div>
<!-- class="sect4" -->
<div class="sect4"><a id="sthref947"></a>
<h5 class="sect4"><span class="secnum">F.4.1.3.2</span> Disk Scan Ordering</h5>
<p>The <a id="sthref948"></a>ASMLIB configuration file is located in the path <code dir="ltr">/etc/sysconfig/oracleasm</code>. It contains all the startup configuration you specified with the command <code dir="ltr">/etc/init.d/oracleasm configure</code>. That command cannot configure scan ordering.</p>
<p>The configuration file contains many configuration variables. The <code dir="ltr">ORACLEASM_SCANORDER</code> variable specifies disks to be scanned first. The <code dir="ltr">ORACLEASM_SCANEXCLUDE</code> variable specifies the disks that are to be ignored.</p>
<p>Configure values for <code dir="ltr">ORACLEASM_SCANORDER</code> using space-delimited prefix strings. A <span class="italic">prefix string</span> is the common string associated with a type of disk. For example, if you use the prefix string <code dir="ltr">sd</code>, then this string matches all SCSI devices, including <code dir="ltr">/dev/sda</code>, <code dir="ltr">/dev/sdb</code>, <code dir="ltr">/dev/sdc</code> and so on. Note that these are not globs. They do not use wild cards. They are simple prefixes. Also note that the path is not a part of the prefix. For example, the <code dir="ltr">/dev/</code> path is not part of the prefix for SCSI disks that are in the path <code dir="ltr">/dev/sd</code>*.</p>
<p>For Oracle Linux and Red Hat Enterprise Linux version 5, when scanning, the kernel sees the devices as <code dir="ltr">/dev/mapper/</code><code dir="ltr"><span class="codeinlineitalic">XXX</span></code> entries. By default, the device file naming scheme <code dir="ltr">udev</code> creates the <code dir="ltr">/dev/mapper/</code><code dir="ltr"><span class="codeinlineitalic">XXX</span></code> names for human readability. Any configuration using <code dir="ltr">ORACLEASM_SCANORDER</code> should use the <code dir="ltr">/dev/mapper/</code><code dir="ltr"><span class="codeinlineitalic">XXX</span></code> entries.</p>
</div>
<!-- class="sect4" -->
<div class="sect4"><a id="sthref949"></a>
<h5 class="sect4"><span class="secnum">F.4.1.3.3</span> Configuring Disk Scan Ordering to Select Multipath Disks</h5>
<p>To configure ASMLIB to select multipath disks first, complete the following procedure:</p>
<ol>
<li>
<p>Using a text editor, open the ASMLIB configuration file <code dir="ltr">/etc/sysconfig/oracleasm</code>.</p>
</li>
<li>
<p>Edit the ORACLEASM_SCANORDER variable to provide the prefix path of the multipath disks. For example, if the multipath disks use the prefix <code dir="ltr">multipath</code> (<code dir="ltr">/dev/mapper/multipatha</code>, <code dir="ltr">/dev/mapper/multipathb</code> and so on), and the multipath disks mount SCSI disks, then provide a prefix path similar to the following:</p>
<pre dir="ltr">ORACLEASM_SCANORDER=&#34;multipath sd&#34;
</pre></li>
<li>
<p>Save the file.</p>
</li>
</ol>
<p>When you have completed this procedure, then when ASMLIB scans disks, it first scans all disks with the prefix string multipath, and labels these disks as Oracle ASM disks using the <code dir="ltr">/dev/mapper/multipath</code><code dir="ltr"><span class="codeinlineitalic">X</span></code> value. It then scans all disks with the prefix string <code dir="ltr">sd</code>. However, because ASMLIB recognizes that these disks have already been labeled with the <code dir="ltr">/dev/mapper/multipath</code> string values, it ignores these disks. After scanning for the prefix strings <code dir="ltr">multipath</code> and <code dir="ltr">sd</code>, Oracle ASM then scans for any other disks that do not match the scan order.</p>
<p>In the example in step 2, the key word multipath is actually the alias for multipath devices configured in <code dir="ltr">/etc/multipath.conf</code> under the <code dir="ltr">multipaths</code> section. For example:</p>
<pre dir="ltr">multipaths {
       multipath {
               wwid                    3600508b4000156d700012000000b0000
               alias                   multipath
               ...
       }
       multipath {
               ...
               alias                   mympath
               ...
       }
       ...
}
</pre>
<p>The default device name is in the format /dev/mapper/mpath* (or a similar path).</p>
</div>
<!-- class="sect4" -->
<div class="sect4"><a id="sthref950"></a>
<h5 class="sect4"><span class="secnum">F.4.1.3.4</span> Configuring Disk Order Scan to Exclude Single Path Disks</h5>
<p>To configure ASMLIB to exclude particular single path disks, complete the following procedure:</p>
<ol>
<li>
<p>Using a text editor, open the ASMLIB configuration file <code dir="ltr">/etc/sysconfig/oracleasm</code>.</p>
</li>
<li>
<p>Edit the <code dir="ltr">ORACLEASM_SCANEXCLUDE</code> variable to provide the prefix path of the single path disks. For example, if you want to exclude the single path disks <code dir="ltr">/dev sdb</code> and <code dir="ltr">/dev/sdc</code>, then provide a prefix path similar to the following:</p>
<pre dir="ltr">ORACLEASM_SCANEXCLUDE=&#34;sdb sdc&#34;
</pre></li>
<li>
<p>Save the file.</p>
</li>
</ol>
<p>When you have completed this procedure, then when ASMLIB scans disks, it scans all disks except for the disks with the <code dir="ltr">sdb</code> and <code dir="ltr">sdc</code> prefixes, so that it ignores <code dir="ltr">/dev/sdb</code> and <code dir="ltr">/dev/sdc</code>. It does not ignore other SCSI disks, nor multipath disks. If you have a multipath disk (for example, <code dir="ltr">/dev/multipatha</code>), which accesses both <code dir="ltr">/dev/sdb</code> and <code dir="ltr">/dev/sdc</code>, but you have configured ASMLIB to ignore <code dir="ltr">sdb</code> and <code dir="ltr">sdc</code>, then ASMLIB ignores these disks and instead marks only the multipath disk as an Oracle ASM disk.</p>
</div>
<!-- class="sect4" --></div>
<!-- class="sect3" -->
<a id="BABGAICH"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">F.4.1.4</span> Deinstalling Oracle ASMLIB</h4>
<p>If you have Oracle ASMLIB installed but do not use it for storage persistence, you can deinstall it in rolling mode, one node at a time, as follows:</p>
<ol>
<li>
<p>Login as <code dir="ltr">root</code>.</p>
</li>
<li>
<p>Stop Oracle ASM and any running database instance on the node:</p>
<pre dir="ltr">srvctl stop asm -node <span class="codeinlineitalic">node_name</span>
srvctl stop instance -d <span class="codeinlineitalic">db_unique_name</span> -node <span class="codeinlineitalic">node_name</span>
</pre>
<p>To stop the last Oracle Flex ASM instance on the node, stop the Oracle Clusterware stack:</p>
<pre dir="ltr"><span class="codeinlineitalic">Grid_home</span>/bin/crsctl stop crs
</pre></li>
<li>
<p>Stop Oracle ASMLIB:</p>
<pre dir="ltr">/etc/init.d/oracleasm disable
</pre></li>
<li>
<p>Remove <code dir="ltr">oracleasm</code> library and tools RPMs:</p>
<pre dir="ltr">rpm -e oracleasm-support
rpm -e oracleasmlib
</pre></li>
<li>
<p>Remove any <code dir="ltr">oracleasm</code> kernel driver RPMs provided by vendors:</p>
<pre dir="ltr">rpm -e oracleasm
</pre></li>
<li>
<p>Check if any <code dir="ltr">oracleasm</code> RPMs remain:</p>
<pre dir="ltr">rpm -qa| grep oracleasm
</pre></li>
<li>
<p>If any <code dir="ltr">oracleasm</code> configuration files remain, remove them:</p>
<pre dir="ltr">rpm -qa| grep oracleasm | xargs rpm -e
</pre>
<p>Oracle ASMLIB and the associated RPMs are removed.</p>
</li>
<li>
<p>Start the Oracle Clusterware stack. Optionally, you can install and configure Oracle ASM Filter Driver (Oracle ASMFD) before starting the Oracle Clusterware stack.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink OSTMG95729" href="../OSTMG/GUID-2F5E344F-AFC2-4768-8C00-6F3C56302123.htm#OSTMG95729"><span class="italic">Oracle Automatic Storage Management Administrator&#39;s Guide</span></a> for more information about configuring storage device path persistence using Oracle ASM Filter Driver</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="BABIIGFD"></a>
<div class="sect2">
<h3 class="sect2"><span class="secnum">F.4.2</span> Configuring Disk Devices Manually for Oracle ASM<a id="sthref951"></a><a id="sthref952"></a><a id="sthref953"></a></h3>
<p>This section contains the following information about preparing disk devices for use by Oracle ASM:</p>
<ul>
<li>
<p><a href="#BABGDAJE">About Device File Names and Ownership for Linux</a></p>
</li>
<li>
<p><a href="#BABGICJI">Configuring a Permissions File for Disk Devices for Oracle ASM</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
The operation of <code dir="ltr">udev</code> depends on the Linux version, vendor, and storage configuration.</div>
<a id="BABGDAJE"></a>
<div class="sect3">
<h4 class="sect3"><span class="secnum">F.4.2.1</span> About Device File Names and Ownership for Linux</h4>
<p>By default, the device file naming scheme <code dir="ltr">udev</code> dynamically creates device file names when the server is started, and assigns ownership of them to <code dir="ltr">root</code>. If <code dir="ltr">udev</code> applies default settings, then it changes device file names and owners for voting files or Oracle Cluster Registry partitions, making them inaccessible when the server is restarted. For example, a voting file on a device named <code dir="ltr">/dev/sdd</code> owned by the user <code dir="ltr">grid</code> may be on a device named <code dir="ltr">/dev/sdf</code> owned by <code dir="ltr">root</code> after restarting the server.</p>
<p>If you use ASMFD, then you do not need to ensure permissions and device path persistency in <code dir="ltr">udev</code>.</p>
<p>If you do not use ASMFD, then you must create a custom rules file. When <code dir="ltr">udev</code> is started, it sequentially carries out rules (configuration directives) defined in rules files. These files are in the path <code dir="ltr">/etc/udev/rules.d/</code>. Rules files are read in lexical order. For example, rules in the file <code dir="ltr">10-wacom.rules</code> are parsed and carried out before rules in the rules file <code dir="ltr">90-ib.rules</code>.</p>
<p>When specifying the device information in the UDEV rules file, ensure that the OWNER, GROUP and MODE are specified before all other characteristics in the order shown. For example, if you want to include the characteristic ACTION on the UDEV line, then specify ACTION after OWNER, GROUP, and MODE.</p>
<p>Where rules files describe the same devices, on the supported Linux kernel versions, the last file read is the one that is applied.</p>
</div>
<!-- class="sect3" -->
<a id="BABGICJI"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">F.4.2.2</span> Configuring a Permissions File for Disk Devices for Oracle ASM</h4>
<p>To configure a permissions file for disk devices for Oracle ASM, complete the following tasks:</p>
<ol>
<li>
<p>To obtain information about existing block devices, run the command <code dir="ltr">scsi_id</code> (<code dir="ltr">/sbin/scsi_id</code>) on storage devices from one cluster node to obtain their unique device identifiers. When running the <code dir="ltr">scsi_id</code> command with the <code dir="ltr">-s</code> argument, the device path and name passed should be that relative to the <code dir="ltr">sysfs</code> directory <code dir="ltr">/sys</code> (for example, <code dir="ltr">/block/device</code>) when referring to <code dir="ltr">/sys/block/device</code>. For example:</p>
<pre dir="ltr"># /sbin/scsi_id -g -s /block/sdb/sdb1
360a98000686f6959684a453333524174
 
# /sbin/scsi_id -g -s /block/sde/sde1
360a98000686f6959684a453333524179
</pre>
<p>Record the unique SCSI identifiers of clusterware devices, so you can provide them when required.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The command <code dir="ltr">scsi_id</code> should return the same device identifier value for a given device, regardless of which node the command is run from.</div>
</li>
<li>
<p>Configure SCSI devices as trusted devices (white listed), by editing the <code dir="ltr">/etc/scsi_id.config</code> file and adding <code dir="ltr">options=-g</code> to the file. For example:</p>
<pre dir="ltr"># cat &gt; /etc/scsi_id.config
vendor=&#34;ATA&#34;,options=-p 0x80
options=-g
</pre></li>
<li>
<p>Using a text editor, create a UDEV rules file for the Oracle ASM devices, setting permissions to 0660 for the installation owner and the group whose members are administrators of the Oracle Grid Infrastructure software. For example, on Oracle Linux, to create a role-based configuration rules.d file where the installation owner is <code dir="ltr">grid</code> and the OSASM group <code dir="ltr">asmadmin</code>, enter commands similar to the following:</p>
<pre dir="ltr"># vi /etc/udev/rules.d/99-oracle-asmdevices.rules
 
KERNEL==&#34;sd?1&#34;, OWNER=&#34;grid&#34;, GROUP=&#34;asmadmin&#34;, MODE=&#34;0660&#34;, 
BUS==&#34;scsi&#34;, PROGRAM==&#34;/sbin/scsi_id&#34;, RESULT==&#34;14f70656e66696c00000000&#34;
KERNEL==&#34;sd?2&#34;, OWNER=&#34;grid&#34;, GROUP=&#34;asmadmin&#34;, MODE=&#34;0660&#34;,
BUS==&#34;scsi&#34;, PROGRAM==&#34;/sbin/scsi_id&#34;, RESULT==&#34;14f70656e66696c00000001&#34;
KERNEL==&#34;sd?3&#34;, OWNER=&#34;grid&#34;, GROUP=&#34;asmadmin&#34;, MODE=&#34;0660&#34;,
BUS==&#34;scsi&#34;, PROGRAM==&#34;/sbin/scsi_id&#34;, RESULT==&#34;14f70656e66696c00000002&#34;
</pre></li>
<li>
<p>Copy the <code dir="ltr">rules.d</code> file to all other nodes on the cluster. For example:</p>
<pre dir="ltr"># scp 99-oracle-asmdevices.rules root@node2:/etc/udev/rules.d/99-oracle-asmdevices.rules
</pre></li>
<li>
<p>Load updated block device partition tables on all member nodes of the cluster, using <code dir="ltr">/sbin/partprobe</code> <code dir="ltr"><span class="codeinlineitalic">devicename</span></code>.<a id="sthref954"></a> You must do this as <code dir="ltr">root</code>.</p>
</li>
<li>
<p>Run the command <code dir="ltr">udevtest</code> (<code dir="ltr">/sbin/udevtest</code>) to test the UDEV rules configuration you have created. The output should indicate that the devices are available and the rules are applied as expected. For example:</p>
<pre dir="ltr"># udevtest /block/sdb/sdb1
main: looking at device &#39;/block/sdb/sdb1&#39; from subsystem &#39;block&#39;
udev_rules_get_name: add symlink
&#39;disk/by-id/scsi-360a98000686f6959684a453333524174-part1&#39;
udev_rules_get_name: add symlink
&#39;disk/by-path/ip-192.168.1.1:3260-iscsi-iqn.1992-08.com.netapp:sn.887085-part1&#39;
udev_node_mknod: preserve file &#39;/dev/.tmp-8-17&#39;, because it has correct dev_t
run_program: &#39;/lib/udev/vol_id --export /dev/.tmp-8-17&#39;
run_program: &#39;/lib/udev/vol_id&#39; returned with status 4
run_program: &#39;/sbin/scsi_id&#39;
run_program: &#39;/sbin/scsi_id&#39; (stdout) &#39;360a98000686f6959684a453333524174&#39;
run_program: &#39;/sbin/scsi_id&#39; returned with status 0
udev_rules_get_name: rule applied, &#39;sdb1&#39; becomes &#39;data1&#39;
udev_device_event: device &#39;/block/sdb/sdb1&#39; validate currently present symlinks
udev_node_add: creating device node &#39;/dev/data1&#39;, major = &#39;8&#39;, minor = &#39;17&#39;, 
mode = &#39;0640&#39;, uid = &#39;0&#39;, gid = &#39;500&#39;
udev_node_add: creating symlink
&#39;/dev/disk/by-id/scsi-360a98000686f6959684a453333524174-part1&#39; to &#39;../../data1&#39;
udev_node_add: creating symlink
&#39;/dev/disk/by-path/ip-192.168.1.1:3260-iscsi-iqn.1992-08.com.netapp:sn.84187085
-part1&#39; to &#39;../../data1&#39;
main: run: &#39;socket:/org/kernel/udev/monitor&#39;
main: run: &#39;/lib/udev/udev_run_devd&#39;
main: run: &#39;socket:/org/freedesktop/hal/udev_event&#39;
main: run: &#39;/sbin/pam_console_apply /dev/data1
/dev/disk/by-id/scsi-360a98000686f6959684a453333524174-part1
/dev/disk/by-path/ip-192.168.1.1:3260-iscsi-iqn.1992-08.com.netapp:sn.84187085-
part1&#39;
</pre>
<p>In the example output, note that applying the rules renames OCR device <code dir="ltr">/dev/sdb1</code> to <code dir="ltr">/dev/data1</code>.</p>
</li>
<li>
<p>Enter the command to restart the UDEV service.</p>
<p>On Oracle Linux and Red Hat Enterprise Linux, the commands are:</p>
<pre dir="ltr"># /sbin/udevcontrol reload_rules
# /sbin/start_udev
</pre>
<p>On SUSE Linux Enterprise Server, the command is:</p>
<pre dir="ltr"># /etc/init.d boot.udev restart
</pre></li>
</ol>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABHJJIF"></a>
<div id="CWLIN416" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">F.5</span> Checking OCFS2 Version Manually</h2>
<p>To check your OCFS2 version manually, enter the following commands:</p>
<pre dir="ltr">modinfo ocfs2
<a id="sthref955"></a>rpm -qa |grep ocfs2
</pre>
<p>Ensure that <code dir="ltr">ocfs2console</code> and <code dir="ltr">ocfs2-tools</code> are at least version 1.2.7, and that the other OCFS2 components correspond to the pattern ocfs2-<span class="italic">kernel_version</span>-1.2.7 or greater. If you want to install Oracle RAC on a shared home, then the OCFS2 version must be 1.4.1 or greater.</p>
<p>For information about OCFS2, refer to the following website:</p>
<pre dir="ltr"><a href="http://oss.oracle.com/projects/ocfs2/">http://oss.oracle.com/projects/ocfs2/</a>
</pre></div>
<!-- class="sect1" --></div>
<!-- class="appendix" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment605">
<tr>
<td class="cellalignment612">
<table class="cellalignment610">
<tr>
<td class="cellalignment609"><a href="concepts.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment609"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2013, 2017,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment614">
<table class="cellalignment608">
<tr>
<td class="cellalignment609"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment609"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment609"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment609"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment609"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment609"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>