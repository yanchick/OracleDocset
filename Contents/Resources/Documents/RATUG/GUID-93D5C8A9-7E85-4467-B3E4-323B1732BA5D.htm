<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-88051"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Creating%20a%20Pre-Change%20SQL%20Trial%20Using%20APIs"></a><title>Creating a Pre-Change SQL Trial Using APIs</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="dcterms.created" content="2017-01-24T11:32:44Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Testing Guide"/>
<meta name="dcterms.identifier" content="E55028-05"/>
<meta name="dcterms.isVersionOf" content="RATUG"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2008, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="GUID-377E9D3B-3B20-4C18-A631-C04D164891FD.htm" title="Previous" type="text/html"/>
<link rel="Next" href="GUID-CE3A1060-2BD8-4EA9-81F8-E101CD9AD9D5.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E55028-05.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-93D5C8A9-7E85-4467-B3E4-323B1732BA5D"></a> <span id="PAGE" style="display:none;">33/309</span> <!-- End Header -->
<a id="RATUG182"></a>
<h1 id="RATUG-GUID-93D5C8A9-7E85-4467-B3E4-323B1732BA5D" class="sect1"><span class="enumeration_section">4.2</span> Creating a Pre-Change SQL Trial Using APIs</h1>
<div>
<div class="section">
<p>This section describes how to build the <a id="d8541e77" class="indexterm-anchor"></a>pre-change performance data by using the <code>DBMS_SQLPA</code> package.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead1">To create a pre-change SQL trial:</p>
<ul style="list-style-type: disc;">
<li>
<p>Call the <a id="d8541e92" class="indexterm-anchor"></a><code>EXECUTE_ANALYSIS_TASK</code> procedure using the following parameters:</p>
<ul style="list-style-type: disc;">
<li>
<p>Set the <code>task_name</code> parameter to the name of the SQL Performance Analyzer task that you want to execute.</p>
</li>
<li>
<p>Set the <code>execution_type</code> parameter in one of the following ways:</p>
<ul style="list-style-type: disc;">
<li>
<p>Set to <code>EXPLAIN PLAN</code> to generate execution plans for all SQL statements in the SQL tuning set without executing them.</p>
</li>
<li>
<p>Set to <code>TEST EXECUTE</code> (recommended) to execute all statements in the SQL tuning set and generate their execution plans and statistics. When <code>TEST EXECUTE</code> is specified, the procedure generates execution plans and execution statistics. The execution statistics enable SQL Performance Analyzer to identify SQL statements that have improved or regressed. Collecting execution statistics in addition to generating execution plans provides greater accuracy in the performance analysis, but takes longer.</p>
</li>
<li>
<p>Set to <code>CONVERT SQLSET</code> to refer to a SQL tuning set for the execution statistics and plans for the SQL trial. Values for the execution parameters <code>SQLSET_NAME</code> and <code>SQLSET_OWNER</code> should also be specified.</p>
</li>
</ul>
</li>
<li>
<p>Specify a name to identify the execution using the <code>execution_name</code> parameter. If not specified, then SQL Performance Analyzer automatically generates a name for the task execution.</p>
</li>
<li>
<p>Specify execution parameters using the <code>execution_params</code> parameters. The <code>execution_params</code> parameters are specified as (<span class="italic">name</span>, <span class="italic">value</span>) pairs for the specified execution. For example, you can set the following execution parameters:</p>
<ul style="list-style-type: disc;">
<li>
<p>The <code>time_limit</code> parameter specifies the global time limit to process all SQL statements in a SQL tuning set before timing out.</p>
</li>
<li>
<p>The <code>local_time_limit</code> parameter specifies the time limit to process each SQL statement in a SQL tuning set before timing out.</p>
</li>
<li>
<p>To perform a remote test execute, set the <code>DATABASE_LINK</code> task parameter to the global name of a public database link connecting to a user with the <code>EXECUTE</code> privilege for the <code>DBMS_SQLPA</code> package and the <code>ADVISOR</code> privilege on the test system.</p>
</li>
<li>
<p>To fully execute DML statements&mdash;including acquiring row locks and modifying row&mdash;set the <code>EXECUTE_FULLDML</code> parameter to <code>TRUE</code>. SQL Performance Analyzer will issue a rollback after executing the DML statements to prevent persistent changes from being made. The default value for this parameter is <code>FALSE</code>, which executes only the query portion of the DML statement without modifying the data.</p>
</li>
<li>
<p>To restore the relevant captured <code>init.ora</code> settings during a test execute, set the <code>APPLY_CAPTURED_COMPILENV</code> parameter to <code>TRUE</code>. This is not the default behavior because typically you are running SQL trials to test changes when changing the environment. However, this method may be used in cases when the <code>init.ora</code> settings are not being changed (such as creating an index). This method is not supported for remote SQL trials.</p>
</li>
</ul>
</li>
</ul>
<p>The following example illustrates a function call made <span class="italic">before</span> a system change:</p>
<pre dir="ltr">EXEC DBMS_SQLPA.EXECUTE_ANALYSIS_TASK(task_name =&gt; &#39;my_spa_task&#39;, -
       execution_type =&gt; &#39;TEST EXECUTE&#39;, - 
       execution_name =&gt; &#39;my_exec_BEFORE_change&#39;);
</pre></li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p>Once the pre-change performance data is built, you can make the system change and build the post-change performance data by re-executing the SQL statements in the SQL tuning set on the post-change test system, as described in <a href="GUID-CE3A1060-2BD8-4EA9-81F8-E101CD9AD9D5.htm">Creating a Post-Change SQL Trial</a> .</p>
<div class="infoboxnotealso" id="GUID-93D5C8A9-7E85-4467-B3E4-323B1732BA5D__GUID-51D252BF-5FFB-4C79-964B-70F9048FBD58">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink ARPLS229" target="_blank" href="../ARPLS/d_sqlpa.htm#ARPLS229"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> to learn about the <code>DBMS_SQLPA.EXECUTE_ANALYSIS_TASK</code> function</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2747">
<tr>
<td class="cellalignment2754">
<table class="cellalignment2752">
<tr>
<td class="cellalignment2751"><a href="GUID-377E9D3B-3B20-4C18-A631-C04D164891FD.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2751"><a href="GUID-CE3A1060-2BD8-4EA9-81F8-E101CD9AD9D5.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2008, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2756">
<table class="cellalignment2750">
<tr>
<td class="cellalignment2751"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2751"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2751"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2751"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2751"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2751"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>