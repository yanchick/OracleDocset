<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-88002"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Creating%20a%20Data%20Subset%20Definition"></a><title>Creating a Data Subset Definition</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="dcterms.created" content="2017-01-24T11:32:44Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Testing Guide"/>
<meta name="dcterms.identifier" content="E55028-05"/>
<meta name="dcterms.isVersionOf" content="RATUG"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2008, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="GUID-8D0655CF-84FD-4B4D-B0C7-DB6A50B71B27.htm" title="Previous" type="text/html"/>
<link rel="Next" href="GUID-575C8900-41D9-460B-9D42-0A6000B82E0B.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E55028-05.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E"></a> <span id="PAGE" style="display:none;">256/309</span> <!-- End Header -->
<a id="RATUG4053"></a>
<h1 id="RATUG-GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E" class="sect1"><span class="enumeration_section">18.1</span> Creating a Data Subset Definition</h1>
<div>
<div class="section">
<p><a id="d44131e76" class="indexterm-anchor"></a><a id="d44131e80" class="indexterm-anchor"></a>The procedure described in this section enables you to create a subset database, after which you can perform other tasks, such as editing the properties of the subset definition or exporting a subset definition.</p>
<p>The interface also allows you to perform inline, or at the source, masking while creating the subset definition.</p>
<p><a id="d44131e88" class="indexterm-anchor"></a><a id="d44131e92" class="indexterm-anchor"></a>Before proceeding, ensure that you have the following privileges:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><code>EM_ALL_OPERATOR</code> for Enterprise Manager Cloud Control users</p>
</li>
<li>
<p><code>SELECT_CATALOG_ROLE</code> for database users</p>
</li>
<li>
<p><code>SELECT_ANY_DICTIONARY</code> privilege for database users</p>
</li>
<li>
<p>Additionally, to perform an in-place delete operation, the DBA user must be granted the <code>EXECUTE_ANY_TYPE</code> privilege</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead1">To create a data subset definition:</p>
<ol>
<li>
<p>From the Enterprise menu, select <span class="bold">Quality Management</span>, then <span class="bold">Data Subset Definitions</span>.</p>
</li>
<li>
<p>Open the <span class="bold">Actions</span> menu in the Data Subset Definitions page, then select <span class="bold">Create</span>, or just click the <span class="bold">Create</span> icon.</p>
</li>
<li>
<p>Define the data subset definition properties:</p>
<ol>
<li>
<p>Provide the requisite information in the General pop-up that appears, then click <span class="bold">Continue</span>.</p>
<p>You can select any source database associated with the Application Data Model.</p>
<p>If you are performing masking within the subset definition, you must select the same ADM and target used in creating the masking definition.</p>
</li>
<li>
<p>Provide a job name, credentials, and specify a schedule in the Schedule Application Detail Collection pop-up that appears, then click <span class="bold">Submit</span>.</p>
<p>If you want to use new credentials, choose the New Credentials option. Otherwise, choose the Preferred Credentials or Named Credentials option.</p>
</li>
</ol>
<p>The space estimate collection job runs, and then displays the Data Subset Definitions page. Your definition appears in the table, and the Most Recent Job Status column should indicate Scheduled, Running, or Succeeded, depending on the schedule option selected and time required to complete the job.</p>
</li>
<li>
<p>Select the definition within the table, open the <span class="bold">Actions</span> menu, then select <span class="bold">Edit</span>.</p>
<p>The Database Login page appears.</p>
</li>
<li>
<p>Select either Named Credentials or New Credentials if you have not already set preferred credentials, then click <span class="bold">Login</span>.</p>
</li>
<li>
<p>In the Applications subpage of the Edit page, move applications from the Available list to the Selected list as follows:</p>
<ul style="list-style-type: disc;">
<li>
<p>If you intend only to mask the data (no subsetting), select all applications.</p>
</li>
<li>
<p>If you intend only to subset the data (no masking), select specific applications as appropriate.</p>
</li>
<li>
<p>If you intend both to subset and mask the data, the applications selected must include those that the masking definitions require.</p>
</li>
</ul>
<p>The names of application suites, applications, or application modules are maintained in the Application Data Model.</p>
</li>
<li>
<p>Click the <span class="bold">Table Rules</span> tab.</p>
<div class="infobox-note" id="GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E__GUID-DF6174C5-FA49-4E62-B748-B39D5607EB54">
<p class="notep1">Note:</p>
<p>If you are masking only, set the Default Table Rules option to include all rows and skip to Step <a href="GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E.htm#GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E__CHDGBFDI">13</a>. The <span class="bold">Column Rules</span> tab, <span class="bold">Rule Parameters</span> tab, and additional features on the <span class="bold">Table Rules</span> tab pertain specifically to subsetting.</p>
</div>
<p>You can add rules here to define the data to include in the subset.</p>
</li>
<li>
<p>Select <span class="bold">Actions</span>, then <span class="bold">Create</span> to display the Table Rule pop-up, or just click the <span class="bold">Create</span> icon.</p>
<ol>
<li>
<p><a id="d44131e239" class="indexterm-anchor"></a>Select the application for which you want to provide a rule.</p>
<p>Associate the rule with all tables, a specific table, or a category of tables.</p>
</li>
<li>
<p>In the Rows to Include section, select the option that best suits your needs for a representative sample of production data. If you do not want to include all rows, you can include some rows by specifying a percentage portion of the rows. For finer granularity, you could specify a Where clause, such as where region_id=6.</p>
<p>For more information on specifying Where clauses, see Step <a href="GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E.htm#GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E__BCGFDBEI">8.e</a>.</p>
</li>
<li>
<p>In the Include Related Rows section, do one of the following:</p>
<ul style="list-style-type: disc;">
<li>
<p><a id="d44131e260" class="indexterm-anchor"></a>Select <span class="bold">Ancestor and Descendant Tables</span></p>
<p>This rule impacts the parent and child columns, and ensures that referential integrity is maintained, and that child columns are also selected as part of the subset.</p>
</li>
<li>
<p>Select <a id="d44131e272" class="indexterm-anchor"></a><span class="bold">Ancestor Tables Only</span></p>
<p>This rule only impacts the parent columns, and ensures that referential integrity is maintained.</p>
</li>
</ul>
<p>If you disable the Include Related Rows check box, referential integrity may not be maintained. However, you can subsequently provide additional rules to restore referential integrity. You can disable this check box whether or not you specify a Where clause.</p>
</li>
<li>
<p>If you want to specify a Where clause, go to the next step. Otherwise, skip to Step <a href="GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E.htm#GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E__BCGECEIA">9</a>.</p>
</li>
<li id="GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E__BCGFDBEI">
<p><a id="d44131e290" class="indexterm-anchor"></a><a id="d44131e294" class="indexterm-anchor"></a>Provide a rule parameter, if desired, for the clause.</p>
<p>For instance, if you specify a particular value for an employee ID as employee_id=:emp_id, you could enter query values for the default of 100:</p>
<ul style="list-style-type: disc;">
<li>
<p>Select the Rows Where button and enter employee_id=:emp_id.</p>
</li>
<li>
<p>Click <span class="bold">OK</span> to save the rule and return to the Table Rules tab.</p>
<p>If this is a new rule, a warning appears stating that &#34;Rule parameters corresponding to the bind variables &#39;emp_id&#39; should be created before generating subset.&#34;</p>
</li>
<li>
<p>Select the table rule, click the <span class="bold">Rule Parameters</span> tab, then click <span class="bold">Create</span>.</p>
<p>The Rule Parameter Properties pop-up appears.</p>
</li>
<li>
<p>Enter emp_id for the Name and 100 for the Value.</p>
<div class="infobox-note" id="GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E__GUID-A6EAA93D-EDC9-4800-956F-42FD5913632E">
<p class="notep1">Note:</p>
<p>The colon ( : ) preceding emp_id is only present in the Where clause, and not required when creating a new rule parameter.</p>
</div>
</li>
<li>
<p>Click <span class="bold">OK</span> to save the properties, which now appear in the <span class="bold">Rule Parameters</span> tab.</p>
</li>
<li>
<p>Skip to Step <a href="GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E.htm#GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E__CHDHBCIG">10</a>.</p>
</li>
</ul>
</li>
</ol>
</li>
<li id="GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E__BCGECEIA">
<p>Click <span class="bold">OK</span> to save the rule and return to the <span class="bold">Table Rules</span> tab.</p>
<p>The new rule is displayed in the list. The related tables are displayed in the table below. Related rows from the tables are included in the subset to provide referential integrity in the subset database.</p>
</li>
<li id="GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E__CHDHBCIG">
<p>In the Related Tables section of the <span class="bold">Table Rules</span> tab, you can manage the size of the subset by controlling the levels of ancestors and descendants within the subset. Notice that each node in the table has a check box. By default, all nodes are included in the subset, as indicated by the check mark. Deselect the check box to exclude a node from the subset. The deselection option is disabled for parent rows (the join columns to the right identify parent and child rows). In addition, you can make these other refinements to subset content:</p>
<ul style="list-style-type: disc;">
<li>
<p>Click <span class="bold">Allow Excluding Parent Tables</span>. This enables the check marks that were grayed out. You can now selectively exclude parent rows from the subset by deselecting the check box.</p>
</li>
<li>
<p>Select a node within the table and click <span class="bold">Add Descendants</span> to include related rows. In the dialog that opens, make appropriate selections and click <span class="bold">OK</span>.</p>
</li>
</ul>
<p>As you make these refinements, columns on the right reflect the effect on space estimates for the subset. The Related Tables section also denotes the processing order of the ancestor and descendant tables, including the detailed impact of including each table. When you are done with the refinements, go to the <span class="bold">Space Estimates</span> tab to see a finer granularity of the impact on the overall size of the subset.</p>
</li>
<li>
<p>In the Default Table Rows section of the <span class="bold">Table Rules</span> tab, choose whether you want to include or exclude the tables not affected by the defined rules in the subset.</p>
<p>When you select the Include All Rows option, all of the rows for the table are selected as part of the subset.</p>
<p>This is a global rule and applies to the entire subset. You can only select the Include All Rows option when all of the rules have a scope of None. A scope of None is established when you uncheck the Include Related Rows option in the Table Rule pop-up.</p>
<div class="infobox-note" id="GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E__GUID-4AC485E6-856F-4495-9DC3-54CC4BFD083B">
<p class="notep1">Note:</p>
<p>For a subset definition that has column rules (see Step <a href="GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E.htm#GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E__CHDDBADD">12</a>), be sure to use table rules to include the corresponding tables. You can use the Default Table Rules option to include all tables not affected by table rules, if required.</p>
</div>
</li>
<li id="GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E__CHDDBADD">
<p><span class="italic">Optional</span>: Click the <span class="bold">Column Rules</span> tab to perform inline masking as part of the subset definition.</p>
<ol>
<li>
<p>Click <span class="bold">Create</span> and enter search criteria to filter on columns within the schema. These would typically be vertical columns such as CLOB AND BLOB columns.</p>
<div class="infobox-note" id="GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E__GUID-C86B711F-EC24-4482-8B91-80AEFE3FA504">
<p class="notep1">Note:</p>
<p>If you are using column rules instead of masking definitions (see Step <a href="GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E.htm#GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E__CHDGBFDI">13</a>), you can select no more than 10 columns in a given table. This restriction applies to the export method but not to the in-place delete method.</p>
</div>
<p>Click <span class="bold">OK</span>.</p>
</li>
<li>
<p>Select a row or rows in the column search results and click <span class="bold">Manage Masking Formats</span>.</p>
</li>
<li>
<p>In the pop-up dialog, select a masking format and value to apply to the columns. For multiselection, the same format must be appropriate for all columns. If you select multiple columns, ensure that the column rule format you choose is applicable to the selected columns. Use the columns (flags) <span class="bold">not null</span> and <span class="bold">unique</span> to enforce compliance.</p>
<p>Click <span class="bold">OK</span> to apply the masking format to the columns.</p>
</li>
</ol>
</li>
<li id="GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E__CHDGBFDI">
<p><span class="italic">Optional</span>: Click the <span class="bold">Data Masking</span> tab to include masking definitions as part of the subsetting operation or to perform at the source data masking only.</p>
<ol>
<li>
<p>Click <span class="bold">Add</span>.</p>
</li>
<li>
<p>In the pop-up dialog, enter search criteria to retrieve appropriate definitions. Be sure to select the desired radio button (All or Any). All formats except compound masking are supported for inline masking.</p>
<div class="infobox-note" id="GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E__GUID-7CB5690B-9740-4A50-95BC-CA9B5F00C55C">
<p class="notep1">Note:</p>
<p>No single table within a masking definition can have more than 10 masked columns if you are using the export method. The restriction does not apply to the in-place delete method.</p>
</div>
<p>Click <span class="bold">OK</span>.</p>
</li>
</ol>
<p>The search results appear in the data masking table.</p>
</li>
<li>
<p>Click the <span class="bold">Space Estimates</span> tab.</p>
<ul style="list-style-type: disc;">
<li>
<p><a id="d44131e481" class="indexterm-anchor"></a>Note the value in the Estimated Subset Size MB column. The space estimates depend on optimizer statistics, and the actual distribution of data can only be calculated if histogram statistics are present.</p>
</li>
<li>
<p>Whenever you add new rules, recheck the space estimates for updated values.</p>
</li>
<li>
<p>Data in the Space Estimates subpage is sorted with the largest applications appearing at the top.</p>
</li>
</ul>
<div class="infobox-note" id="GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E__GUID-B01EA839-BBA6-4470-8B3A-64CEF2D10CF7">
<p class="notep1">Note:</p>
<p>Space estimates do not reflect the effect of data masking, if used.</p>
</div>
<p>If you provide a Where clause and subsequent rule parameter properties, the Space Estimates subpage is updated with the value contained in the <span class="bold">Rule Parameters</span> tab.</p>
</li>
<li>
<p><span class="italic">Optional</span>: click the <span class="bold">Pre/Post Subset Scripts</span> tab.</p>
<ul style="list-style-type: disc;">
<li>
<p>You can specify a pre-subset script to run on the subset database before you select subset data.</p>
</li>
<li>
<p>You can specify a post-subset script to run on the subset database after you assemble the subset data.</p>
</li>
<li>
<p>Either script type runs on the source database.</p>
</li>
</ul>
</li>
<li>
<p>Click <span class="bold">Return</span>.</p>
<p>The definition is complete and displayed in the Data Subset Definitions table.</p>
</li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<p>You can now proceed with script generation. Alternatively, you may want to save the script for future use. In either case, you must decide whether to export data to a dump file or delete data from a target database.</p>
<div class="infoboxnotealso" id="GUID-68E917AE-D22A-42FC-BB99-BD6ED6D99C3E__GUID-A4D41F1C-A6E2-431E-85A1-4106DF5B00F7">
<p class="notep1">Tip:</p>
<p>If you have a very large database of 4 terabytes, for instance, and you want to export a small percentage of the rows, such as 10%, it is more advantageous to use the export method. Using the in-place delete method would require 3.6 terabytes of data, which would not perform as quickly as the export method.</p>
<p>The in-place delete method is recommended when the amount of data being deleted is a small percentage of the overall data size.</p>
<p>There is an EMCLI verb if you want to perform an in-place delete remotely or script it.</p>
</div>
<ul style="list-style-type: disc;">
<li>
<p><a href="GUID-575C8900-41D9-460B-9D42-0A6000B82E0B.htm">Generating a Subset Script</a></p>
</li>
<li>
<p><a href="GUID-0E445E35-B047-4A6F-B348-B9FC8D4CF00A.htm">Saving a Subset Script</a></p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2747">
<tr>
<td class="cellalignment2754">
<table class="cellalignment2752">
<tr>
<td class="cellalignment2751"><a href="GUID-8D0655CF-84FD-4B4D-B0C7-DB6A50B71B27.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2751"><a href="GUID-575C8900-41D9-460B-9D42-0A6000B82E0B.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2008, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2756">
<table class="cellalignment2750">
<tr>
<td class="cellalignment2751"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2751"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2751"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2751"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2751"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2751"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>