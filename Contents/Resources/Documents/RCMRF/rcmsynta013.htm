<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-88419"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/CREATE%20SCRIPT"></a><title>CREATE SCRIPT</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="scripts, creating in recovery catalog, recovery catalogs, creating stored scripts, CREATE SCRIPT command"/>
<meta name="dcterms.created" content="2017-06-08T22:24:36Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Backup and Recovery Reference"/>
<meta name="dcterms.identifier" content="E50791-08"/>
<meta name="dcterms.isVersionOf" content="RCMRF"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="rcmsynta012.htm" title="Previous" type="text/html"/>
<link rel="Next" href="rcmsynta014.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E50791-08.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946"></a> <span id="PAGE" style="display:none;">19/152</span> <!-- End Header -->
<a id="RCMRF90121"></a><a id="RCMRF90122"></a><a id="RCMRF90123"></a><a id="RCMRF90124"></a><a id="RCMRF90125"></a><a id="RCMRF118"></a>
<h1 class="sect1">CREATE SCRIPT</h1>
<div>
<div class="section">
<p class="subhead1">Purpose</p>
<p>Use the <code class="codeph">CREATE SCRIPT</code> command to create a stored script in the recovery catalog. A stored script is a sequence of RMAN commands that is given a name and stored in the recovery catalog for later execution.</p>
<div class="infoboxnotealso" id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946__GUID-F80C9D71-C597-4462-AB68-C3CAC7B4A7A0">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink BRADV182" target="_blank" href="../BRADV/rcmcatdb.htm#BRADV182"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> to learn how to use stored scripts</p>
</li>
<li>
<p><code class="codeph"><a href="rcmsynta2005.htm#GUID-2C86EDA9-63BE-4F21-9138-AF75597D5ADF">REPLACE SCRIPT</a></code> to learn how to update a stored script</p>
</li>
</ul>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead1">Prerequisites</p>
<p>Execute <code class="codeph">CREATE SCRIPT</code> only at the RMAN prompt. RMAN must be connected to a target database and a recovery catalog. The recovery catalog database must be open.</p>
<p>If <code class="codeph">GLOBAL</code> is specified, then a global script with this name must not already exist in the recovery catalog. If <code class="codeph">GLOBAL</code> is not specified, then a local script must not already exist with the same name for the same target database. In you do not meet these prerequisites, then RMAN returns error <code class="codeph">RMAN-20401</code>.</p>
</div>
<!-- class="section" -->
<div class="section" id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946__CHDBJHHH">
<p class="subhead1">Usage Notes</p>
<p><a id="d37504e139" class="indexterm-anchor"></a>A stored script may be local or global. A local script is created for the current target database only, whereas a global script is available for use with any database registered in the recovery catalog.</p>
<p>It is permissible to create a global script with the same name as a local script, or a local script with the same name as a global script.</p>
<p><span class="bold">Substitution Variables in Stored Scripts</span></p>
<p><a id="d37504e148" class="indexterm-anchor"></a><a id="d37504e152" class="indexterm-anchor"></a><a id="d37504e156" class="indexterm-anchor"></a><a id="d37504e158" class="indexterm-anchor"></a>RMAN supports the use of substitution variables in a stored script. <code class="codeph">&amp;1</code> indicates where to place the first value, <code class="codeph">&amp;2</code> indicate where to place the second value, and so on. Special characters must be quoted.</p>
<p>The substitution variable syntax is <code class="codeph">&amp;</code><span class="italic"><code class="codeph">integer</code></span> followed by an optional period, for example, <code class="codeph">&amp;1.3</code>. The optional period is part of the variable and replaced with the value, thus enabling the substitution text to be immediately followed by another integer. For example, if you pass the value <code class="codeph">mybackup</code> to a command file that contains the substitution variable <code class="codeph">&amp;1.3</code>, then the result of the substitution is <code class="codeph">mybackup3</code>. To create the result <code class="codeph">mybackup.3</code>, use two periods in the syntax <code class="codeph">&amp;1..3</code>.</p>
<p>When you create a stored script with substitution variables, you must provide example values at create time. You can provide these values with the <code class="codeph">USING</code> clause when starting RMAN (see <code class="codeph"><a href="rcmsynta2011.htm#GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7">RMAN</a></code>) or enter them when prompted (see <a href="rcmsynta013.htm#GUID-4741C1E1-C365-4597-BF2F-8679145B4946__CHDBBABA">Example 2-72</a>).</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead1">Syntax</p>
<p><span class="bold"><span class="italic">createScript</span>::=</span></p>
<div class="figure" id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946__GUID-137B88F2-81A6-44B3-9469-FE7B9B2E60BF"><img width="583" height="206" src="img/GUID-8ADB0E0C-4997-44B1-A70E-83730279D0D9-default.gif" alt="Description of GUID-8ADB0E0C-4997-44B1-A70E-83730279D0D9-print.eps follows" title="Description of GUID-8ADB0E0C-4997-44B1-A70E-83730279D0D9-print.eps follows"/><br/>
<a href="img_text/GUID-8ADB0E0C-4997-44B1-A70E-83730279D0D9-print.htm">Description of the illustration GUID-8ADB0E0C-4997-44B1-A70E-83730279D0D9-print.eps</a></div>
<!-- class="figure" -->
<p><span class="italic"><a href="rcmsynta2012.htm#GUID-88250EEF-DC49-42A9-822C-4011B1345C7B__CHDIDAJB">backupCommands::=</a></span>, <span class="italic"><a href="rcmsynta2012.htm#GUID-88250EEF-DC49-42A9-822C-4011B1345C7B__CHDHAGID">maintenanceCommands::=</a></span>, <span class="italic"><a href="rcmsynta2012.htm#GUID-88250EEF-DC49-42A9-822C-4011B1345C7B__CHDJFJFH">miscellaneousCommands::=</a></span>, <span class="italic"><a href="rcmsynta2012.htm#GUID-88250EEF-DC49-42A9-822C-4011B1345C7B__CHDIFJGG">restoreCommands::=</a></span>)</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead1">Semantics</p>
<div class="tblformalwide" id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946__GUID-C30BB26E-F2E4-4A51-BBB8-39ACF3435EB0">
<table class="cellalignment1044" summary="Describes CREATE SCRIPT command parameters">
<thead>
<tr class="cellalignment1038">
<th class="cellalignment1045" id="d37504e245">Syntax Element</th>
<th class="cellalignment1052" id="d37504e248">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d37504e253" headers="d37504e245">
<p><code class="codeph">GLOBAL</code></p>
</td>
<td class="cellalignment1053" headers="d37504e253 d37504e248">
<p>Identifies the script as global.</p>
<p><span class="bold">Note:</span> A virtual private catalog has read-only access to global scripts. Creating or updating global scripts must be done while connected to the base recovery catalog.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d37504e265" headers="d37504e245">
<p><code class="codeph">SCRIPT</code> <span class="italic"><code class="codeph">script_name</code></span></p>
</td>
<td class="cellalignment1053" headers="d37504e265 d37504e248">
<p>Specifies the name of the script. Quotes must be used around the script name when the name contains either spaces or reserved words.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d37504e276" headers="d37504e245">
<p><code class="codeph">&nbsp;&nbsp;&nbsp;COMMENT</code> <code class="codeph">&#39;</code><span class="italic"><code class="codeph">comment</code></span><code class="codeph">&#39;</code></p>
</td>
<td class="cellalignment1053" headers="d37504e276 d37504e248">
<p>Associates an explanatory comment with the stored script in the recovery catalog. The comment is used in the output of <code class="codeph"><a href="rcmsynta027.htm#GUID-2BAB704C-A3C9-4F76-8D96-4BD961FBEF2E">LIST</a></code> <code class="codeph">SCRIPT NAMES</code>.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d37504e299" headers="d37504e245">
<p><span class="italic"><code class="codeph">backupCommands</code></span></p>
<p><span class="italic"><code class="codeph">maintenanceCommands</code></span></p>
<p><span class="italic"><code class="codeph">miscellaneousCommands</code></span></p>
<p><span class="italic"><code class="codeph">restoreCommands</code></span></p>
</td>
<td class="cellalignment1053" headers="d37504e299 d37504e248">
<p>Specifies commands to include in the stored script. The commands allowable within the brackets of the <code class="codeph">CREATE SCRIPT</code> <code class="codeph">&#39;</code><span class="italic"><code class="codeph">script_name</code></span><code class="codeph">&#39;</code> <code class="codeph">{</code><code class="codeph">...</code><code class="codeph">}</code> command are the same commands supported within a <code class="codeph"><a href="rcmsynta2012.htm#GUID-88250EEF-DC49-42A9-822C-4011B1345C7B">RUN</a></code> command. Any command that is valid within a <code class="codeph">RUN</code> command is permitted in the stored script. The following commands are not valid within stored scripts: <code class="codeph"><a href="rcmsynta2012.htm#GUID-88250EEF-DC49-42A9-822C-4011B1345C7B">RUN</a></code>, <code class="codeph"><a href="rcmsynta001.htm#GUID-7A3919FE-140B-4F50-BA2F-3CEE3285E771">@ (at sign)</a></code>, and <code class="codeph"><a href="rcmsynta002.htm#GUID-E2B8B99B-73CB-4D4E-8065-0B9F44AF8A52">@@ (double at sign)</a></code>.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d37504e362" headers="d37504e245">
<p><code class="codeph">FROM&nbsp;FILE &#39;</code><span class="italic"><code class="codeph">filename</code></span><code class="codeph">&#39;</code></p>
</td>
<td class="cellalignment1053" headers="d37504e362 d37504e248">
<p>Reads the sequence of commands to define the script from the specified file.</p>
<p>The file looks like the body of a valid stored script. The first line of the file must be a left brace (<code class="codeph">{</code>) and the last line must contain a right brace (<code class="codeph">}</code>). The RMAN commands in the file must be valid in a stored script.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
<!-- class="section" -->
<div class="section">
<p class="subhead1">Examples</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946__GUID-7478E03D-5943-4397-B276-6E03DE9F586B">
<p class="titleinexample">Example 2-70 Creating a Local Stored Script</p>
<p>Assume that you want to create a local stored script for backing up database <code class="codeph">prod</code>. You start RMAN, connect to <code class="codeph">prod</code> as <code class="codeph">TARGET</code>, and connect to a recovery catalog. You create a stored script called <code class="codeph">backup_whole</code> and then use <code class="codeph"><a href="rcmsynta021.htm#GUID-553B5C55-0BA6-4B47-86A9-0BCF839CCE04">EXECUTE SCRIPT</a></code> to run it as follows:</p>
<pre dir="ltr">CREATE SCRIPT backup_whole 
COMMENT &#34;backup whole database and archived redo log files&#34;
{
    BACKUP 
      INCREMENTAL LEVEL 0 TAG backup_whole
      FORMAT &#34;/disk2/backup/%U&#34;
      DATABASE PLUS ARCHIVELOG;
}
RUN { EXECUTE SCRIPT backup_whole; }
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946__CHDFABFG">
<p class="titleinexample">Example 2-71 Creating a Global Stored Script</p>
<p>This example connects RMAN to target database <code class="codeph">prod</code> and recovery catalog database <code class="codeph">catdb</code> as catalog user <code class="codeph">rco</code>. The example creates a global script called <code class="codeph">global_backup_db</code> that backs up the database and archived redo log files:</p>
<pre dir="ltr">RMAN&gt; CONNECT TARGET &#34;sbu@prod AS SYSBACKUP&#34;

target database Password: <span class="italic">password</span>
connected to target database: PROD (DBID=39525561)

RMAN&gt; CONNECT CATALOG rco@catdb

recovery catalog database Password: <span class="italic">password</span>
connected to recovery catalog database

RMAN&gt; CREATE GLOBAL SCRIPT global_backup_db { BACKUP DATABASE PLUS ARCHIVELOG; }
RMAN&gt; EXIT;
</pre>
<p>You can now connect RMAN to a different target database such as <code class="codeph">prod2</code> and run the global stored script:</p>
<pre dir="ltr">RMAN&gt; CONNECT TARGET &#34;sbu@prod2 AS SYSBACKUP&#34;

target database Password: <span class="italic">password</span>
connected to target database: PROD2 (DBID=36508508)

RMAN&gt; CONNECT CATALOG rco@catdb

recovery catalog database Password: <span class="italic">password</span>
connected to recovery catalog database

RMAN&gt; RUN { EXECUTE SCRIPT global_backup_db; }
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946__CHDBBABA">
<p class="titleinexample">Example 2-72 Creating a Stored Script That Uses Substitution Variables</p>
<p>The following example connects RMAN to a target database and recovery catalog and uses <code class="codeph"><a href="rcmsynta013.htm#GUID-4741C1E1-C365-4597-BF2F-8679145B4946">CREATE SCRIPT</a></code> to create a backup script that includes three substitution variables. RMAN prompts you to enter initial values for the variables (user input is shown in bold).</p>
<pre dir="ltr">RMAN&gt; CONNECT TARGET /
RMAN&gt; CONNECT CATALOG rco@catdb

recovery catalog database Password: <span class="italic">password</span>
connected to recovery catalog database

RMAN&gt; CREATE SCRIPT backup_df 
2&gt; { BACKUP DATAFILE &amp;1 TAG &amp;2.1 FORMAT &#39;/disk1/&amp;3_%U&#39;; }
 Enter value for 1: <span class="bold">1</span>
 
Enter value for 2: <span class="bold">df1_backup</span>
 
Enter value for 3: <span class="bold">df1</span>

starting full resync of recovery catalog
full resync complete
created script backup_df
 
</pre>
<p>When you run <code class="codeph"><a href="rcmsynta021.htm#GUID-553B5C55-0BA6-4B47-86A9-0BCF839CCE04">EXECUTE SCRIPT</a></code>, you can pass different values to the script. The following example passes the values <code class="codeph">3</code>, <code class="codeph">test_backup</code>, and <code class="codeph">test</code> to the substitution variables in the stored script:</p>
<pre dir="ltr">RMAN&gt; RUN { EXECUTE SCRIPT backup_df USING 3 test_backup df3; }
</pre>
<p>After the values are substituted, the script executes as follows:</p>
<pre dir="ltr">BACKUP DATAFILE 3 TAG test_backup1 FORMAT &#39;/disk1/df3_%U&#39;;
</pre></div>
<!-- class="example" --></div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1037">
<tr>
<td class="cellalignment1049">
<table class="cellalignment1042">
<tr>
<td class="cellalignment1041"><a href="rcmsynta012.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1041"><a href="rcmsynta014.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1051">
<table class="cellalignment1040">
<tr>
<td class="cellalignment1041"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1041"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1041"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1041"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1041"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1041"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>