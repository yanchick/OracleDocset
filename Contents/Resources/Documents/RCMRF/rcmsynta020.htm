<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-88426"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/DUPLICATE"></a><title>DUPLICATE</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="databases, copying, source databases, standby databases, primary databases, DBIDs, of standby databases, DUPLICATE command, duplicate clause, parameter descriptions, dupOptionList subclause, setParameter subclause, logSpec subclause"/>
<meta name="dcterms.created" content="2017-06-08T22:24:36Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Backup and Recovery Reference"/>
<meta name="dcterms.identifier" content="E50791-08"/>
<meta name="dcterms.isVersionOf" content="RCMRF"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="rcmsynta019.htm" title="Previous" type="text/html"/>
<link rel="Next" href="rcmsynta021.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E50791-08.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4"></a> <span id="PAGE" style="display:none;">26/152</span> <!-- End Header -->
<a id="RCMRF90149"></a><a id="RCMRF90150"></a><a id="RCMRF90151"></a><a id="RCMRF90152"></a><a id="RCMRF90153"></a><a id="RCMRF90154"></a><a id="RCMRF90155"></a><a id="RCMRF90156"></a><a id="RCMRF90611"></a><a id="RCMRF90157"></a><a id="RCMRF90158"></a><a id="RCMRF90159"></a><a id="RCMRF90160"></a><a id="RCMRF90162"></a><a id="RCMRF90163"></a><a id="RCMRF90164"></a><a id="RCMRF90165"></a><a id="RCMRF90166"></a><a id="RCMRF90167"></a><a id="RCMRF90168"></a><a id="RCMRF90169"></a><a id="RCMRF90170"></a><a id="RCMRF90171"></a><a id="RCMRF89957"></a><a id="RCMRF89958"></a><a id="RCMRF90172"></a><a id="RCMRF90173"></a><a id="RCMRF90507"></a><a id="RCMRF90508"></a><a id="RCMRF90612"></a><a id="RCMRF126"></a>
<h1 class="sect1">DUPLICATE</h1>
<div>
<div class="section">
<p class="subhead1">Purpose</p>
<p>Use the <code class="codeph">DUPLICATE</code> command to create a copy of a <span class="bold">source database</span>. RMAN can create either of the following types of databases:</p>
<ul style="list-style-type: disc;">
<li>
<p>A <strong class="term">duplicate database</strong>, which is a copy of the source database (or a subset of the source database) with a unique DBID. Because a duplicate database has a unique DBID, it is independent of the source database and can be registered in the same recovery catalog. Typically, duplicate databases are used for testing.</p>
</li>
<li>
<p>A <strong class="term">standby database</strong>, which is a special copy of the source database (called a <span class="bold">primary database</span> in a Data Guard environment) that is updated by applying redo data from the primary database. A standby database is not assigned a new DBID.</p>
</li>
</ul>
<p>RMAN can perform the duplication in any of the following supported modes:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Active duplication</span></p>
<p>RMAN duplicates the files directly from either an open or mounted database.</p>
<p>Active duplication can use image copies or backup sets. Backup sets offer several advantages, including unused block compression and encryption.</p>
</li>
<li>
<p><span class="bold">Backup-based duplication</span> <span class="bold">without a target connection</span></p>
<p>RMAN creates duplicate files from pre-existing RMAN backups and copies. The <code class="codeph">DUPLICATE</code> command must have been issued with the <code class="codeph">DATABASE</code> clause. This form requires a connection to an auxiliary instance and a recovery catalog.</p>
<p>This mode is useful when the target database is not available or a connection to it is not desirable (as mandated by security policy restrictions or a firewall).</p>
</li>
<li>
<p><span class="bold">Backup-based duplication</span> <span class="bold">with a target connection</span></p>
<p>RMAN creates duplicate files from pre-existing RMAN backups and copies.</p>
</li>
<li>
<p><span class="bold">Backup-based duplication without a connection to target or a recovery catalog</span></p>
<p>RMAN creates duplicate files from RMAN backups and copies that were placed in a designated <code class="codeph">BACKUP LOCATION.</code></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__GUID-AC041076-26AC-4A67-A46C-81C07DA69A29">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink BRADV010" target="_blank" href="../BRADV/rcmdupdb.htm#BRADV010"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> to learn how to create a duplicate database with the <code class="codeph">DUPLICATE</code> command</p>
</li>
<li>
<p><a class="olink SBYDB00200" target="_blank" href="../SBYDB/create_ps.htm#SBYDB00200"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> to learn how to create, manage, and back up a standby database</p>
</li>
</ul>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead1">Additional Topics</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDEDFFH">Prerequisites</a></p>
</li>
<li>
<p><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDHJJGI">Usage Notes</a></p>
</li>
<li>
<p><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDFIGHC">Syntax</a></p>
</li>
<li>
<p><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDEHIGF">Semantics</a></p>
</li>
<li>
<p><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__I104404">Examples</a></p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDEDFFH">
<p class="subhead1">Prerequisites</p>
<p>The prerequisites vary depending on the type of duplication.</p>
<p><span class="bold">Prerequisites Common to All Forms of Duplication</span></p>
<p>RMAN must be connected as <code class="codeph">AUXILIARY</code> to the instance of the duplicate database. The instance of the duplicate database is called the <span class="bold">auxiliary instance</span>. The auxiliary instance must be started with the <code class="codeph">NOMOUNT</code> option.</p>
<p>The <span class="bold">source host</span> is the database on which the source database resides. The <span class="bold">destination host</span> is the host on which you intend to create the duplicate database. If you intend to create the duplicate database on the source host, then set the <a id="d41648e308" class="indexterm-anchor"></a><a id="d41648e310" class="indexterm-anchor"></a><code class="codeph">CONTROL_FILES</code> initialization parameter appropriately so that the <code class="codeph">DUPLICATE</code> command does not generate an error because the source control file is in use. Also, set all *<code class="codeph">_DEST</code> or other related initialization parameters appropriately so that the source database files are not overwritten by the duplicate database files.</p>
<p><a id="d41648e325" class="indexterm-anchor"></a><a id="d41648e329" class="indexterm-anchor"></a>Typically, the source and duplicate databases must be on the same platform; however some cross-platform duplication is supported. For <code class="codeph">DUPLICATE</code>, 32-bit and 64-bit versions of the same platform are considered the same platform. For example, Linux IA (32-bit) is considered the same platform as Linux IA (64-bit). However, after duplicating a database between 32-bit and 64-bit platforms, you must run the <a id="d41648e337" class="indexterm-anchor"></a><a id="d41648e339" class="indexterm-anchor"></a><code class="codeph">utlirp.sql</code> script to convert the PL/SQL code to the new format. This script is located in <span class="italic"><code class="codeph">ORACLE_HOME</code></span><code class="codeph">/rdbms/admin</code> on Linux and UNIX platforms.</p>
<div class="infobox-note" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__GUID-8F62BC2C-E086-48D0-B23D-05E8686A935E">
<p class="notep1">Note:</p>
<p>In certain cases, the source and duplicate databases can be on different platforms. For more information about mixed platform support for the <code class="codeph">DUPLICATE</code> command, refer to the My Support Note 1079563.1 at <a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1079563.1" target="_blank"><code class="codeph">https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1079563.1</code></a></p>
</div>
<p>The <code class="codeph">DUPLICATE</code> command requires one or more auxiliary channels. These channels perform the work of the duplication on the auxiliary database instance. In the following circumstances, RMAN uses the channel configuration from the source database for auxiliary channels:</p>
<ul style="list-style-type: disc;">
<li>
<p>You have not used <code class="codeph"><a href="rcmsynta004.htm#GUID-9320BFF7-0728-4B3D-85B9-2184557ECDCE">ALLOCATE CHANNEL</a></code> to manually allocate auxiliary channels.</p>
</li>
<li>
<p>You have not used <code class="codeph"><a href="rcmsynta009.htm#GUID-B5094E73-C26C-4FED-AE39-8C2E9540050A">CONFIGURE</a></code> to configure auxiliary channels.</p>
</li>
</ul>
<p>If you have configured automatic target channels to use <code class="codeph">CONNECT</code> strings, then RMAN attempts to replicate the channel allocation on the auxiliary instance. However, if you must control or vary the channel allocation for duplication, you manually allocate auxiliary channels.</p>
<p>If the <a id="d41648e389" class="indexterm-anchor"></a><a id="d41648e391" class="indexterm-anchor"></a><code class="codeph">COMPATIBLE</code> initialization parameter is set greater than or equal to 11.0.0, then by default RMAN duplicates transportable tablespaces that were not made read/write after being transported. Otherwise, RMAN cannot duplicate <a id="d41648e398" class="indexterm-anchor"></a>transportable tablespaces unless they have been made read/write after being transported.</p>
<p><a id="d41648e405" class="indexterm-anchor"></a><a id="d41648e409" class="indexterm-anchor"></a><a id="d41648e411" class="indexterm-anchor"></a><a id="d41648e413" class="indexterm-anchor"></a><a id="d41648e415" class="indexterm-anchor"></a>The following database encryption features both use the Oracle software keystore: Transparent Data Encryption (TDE), which functions at the column level, and tablespace encryption. If you are duplicating an encrypted tablespace, then you must manually copy the keystore to the duplicate database. If the keystore is not an auto login (SSO) keystore, then you must convert it to an auto login keystore at the duplicate database.</p>
<div class="infoboxnotealso" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__GUID-A566D8FF-4B0C-4A77-9711-2ED7B1891A43">
<p class="notep1">See Also:</p>
<p><a class="olink ASOAG10139" target="_blank" href="../ASOAG/introduction-to-transparent-data-encryption.htm#ASOAG10139"><span class="italic">Oracle Database Advanced Security Guide</span></a> to learn about TDE</p>
</div>
<p><span class="bold">Prerequisites Specific to Backup-Based Duplication</span></p>
<p>As shown in <a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__BABEDFJI" title="Requirements for Two Modes of Backup-Based Duplication">Table 2-6</a>, the prerequisites for backup-based duplication depend on whether RMAN is connected as <code class="codeph">TARGET</code> to the source database.</p>
<div class="tblformalwide" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__BABEDFJI">
<p class="titleintable">Table 2-6 Prerequisites for Three Modes of Backup-Based Duplication</p>
<table class="cellalignment1044" title="Prerequisites for Three Modes of Backup-Based Duplication" summary="Requirements for Two Modes of Backup-Based Duplication">
<thead>
<tr class="cellalignment1038">
<th class="cellalignment1063" id="d41648e450">Prerequisite</th>
<th class="cellalignment1062" id="d41648e453">No Target and No Recovery Connection</th>
<th class="cellalignment1062" id="d41648e456">No Target Connection</th>
<th class="cellalignment1062" id="d41648e459">Target Connection</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1038">
<td class="cellalignment1065" id="d41648e464" headers="d41648e450">
<p>RMAN requires a connection to a recovery catalog.</p>
</td>
<td class="cellalignment1064" headers="d41648e464 d41648e453">
<p>No</p>
</td>
<td class="cellalignment1064" headers="d41648e464 d41648e456">
<p>Yes</p>
</td>
<td class="cellalignment1064" headers="d41648e464 d41648e459">
<p>No</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1065" id="d41648e477" headers="d41648e450">
<p>All backups and archived redo log files used for creating and recovering the duplicate database must be accessible by the server session on the destination host.</p>
</td>
<td class="cellalignment1064" headers="d41648e477 d41648e453">
<p>Yes</p>
</td>
<td class="cellalignment1064" headers="d41648e477 d41648e456">
<p>Yes</p>
</td>
<td class="cellalignment1064" headers="d41648e477 d41648e459">
<p>Yes</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1065" id="d41648e490" headers="d41648e450">
<p>If the destination host is different from the source host, then you must make backups on disk on the source host available to the destination host with the same full path name as in the source database.</p>
</td>
<td class="cellalignment1064" headers="d41648e490 d41648e453">
<p>No</p>
</td>
<td class="cellalignment1064" headers="d41648e490 d41648e456">
<p>Yes</p>
</td>
<td class="cellalignment1064" headers="d41648e490 d41648e459">
<p>Yes</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1065" id="d41648e503" headers="d41648e450">
<p>You must provide the name of the source database with the <code class="codeph">DATABASE</code> clause. If the name of the source database is not unique in the recovery catalog, then you must also provide the database ID (DBID) in the <code class="codeph">DATABASE</code> clause.</p>
</td>
<td class="cellalignment1064" headers="d41648e503 d41648e453">
<p>No if <code class="codeph">BACKUP LOCATION</code> does not have backups from multiple databases.</p>
</td>
<td class="cellalignment1064" headers="d41648e503 d41648e456">
<p>Yes</p>
</td>
<td class="cellalignment1064" headers="d41648e503 d41648e459">
<p>No</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1065" id="d41648e525" headers="d41648e450">
<p><code class="codeph">UNTIL</code> clause must be specified in the current incarnation.</p>
</td>
<td class="cellalignment1064" headers="d41648e525 d41648e453">
<p>Not applicable</p>
</td>
<td class="cellalignment1064" headers="d41648e525 d41648e456">
<p>No</p>
</td>
<td class="cellalignment1064" headers="d41648e525 d41648e459">
<p>Yes</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1065" id="d41648e540" headers="d41648e450">
<p><code class="codeph">NOREDO</code> must be specified when RMAN must prevent application of archived redo log files to the backups (see description of <code class="codeph">NOREDO</code> for more information).</p>
</td>
<td class="cellalignment1064" headers="d41648e540 d41648e453">
<p>Yes</p>
</td>
<td class="cellalignment1064" headers="d41648e540 d41648e456">
<p>Yes</p>
</td>
<td class="cellalignment1064" headers="d41648e540 d41648e459">
<p>Yes</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1065" id="d41648e558" headers="d41648e450">
<p>If you duplicate a subset of tablespaces, and if the source database is not open, then any duplicated tablespaces with undo segments must be listed in the <code class="codeph">UNDO TABLESPACE</code> clause.</p>
</td>
<td class="cellalignment1064" headers="d41648e558 d41648e453">
<p>Yes</p>
</td>
<td class="cellalignment1064" headers="d41648e558 d41648e456">
<p>No</p>
</td>
<td class="cellalignment1064" headers="d41648e558 d41648e459">
<p>Yes (if no catalog used and target is not open)</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1065" id="d41648e574" headers="d41648e450">
<p>RMAN automatically enforces the rule that the set of tablespaces must be self-contained and must not contain database objects owned by <code class="codeph">SYS</code>.</p>
</td>
<td class="cellalignment1064" headers="d41648e574 d41648e453">
<p>No</p>
</td>
<td class="cellalignment1064" headers="d41648e574 d41648e456">
<p>No</p>
</td>
<td class="cellalignment1064" headers="d41648e574 d41648e459">
<p>Yes</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDBCJFA"><span class="bold">Prerequisites Specific to Active Database Duplication</span></p>
<p>When you execute <code class="codeph">DUPLICATE</code> with <code class="codeph">FROM ACTIVE DATABASE</code>, at least one normal target channel and at least one <code class="codeph">AUXILIARY</code> channel are required. If you do not configure or preallocate channels, RMAN allocates the necessary channels by default. If you configure or manually allocate channels for active duplication with backup sets, ensure that the number of auxiliary channels is greater then or equal to the number of target channels.</p>
<p>When you connect RMAN to the source database as <code class="codeph">TARGET</code>, you must specify a user name and password, even if RMAN uses operating system authentication. The source database must be mounted or open. If the source database is open, then archiving must be enabled. If the source database is not open, then it must have been shut down consistently.</p>
<p>When you connect RMAN to the auxiliary instance, the following rules apply:</p>
<ul style="list-style-type: disc;">
<li>
<p>When running RMAN on the same host as the auxiliary instance, you can connect locally without a net service name, provided that you connect using a user name and password, and provided that your <code class="codeph">DUPLICATE</code> command does not <code class="codeph">include</code> the <code class="codeph">PASSWORD FILE</code> clause. The connecting user must have the <code class="codeph">SYSDBA</code> or SYSBACKUP privilege.</p>
</li>
<li>
<p>When connecting remotely, or when using the <code class="codeph">PASSWORD FILE</code> clause in the <code class="codeph">DUPLICATE</code> command, you must connect using a net service name. You must first create a password file for the auxiliary instance.</p>
</li>
</ul>
<p>The source database and auxiliary instances must use the same <code class="codeph">SYS</code> and <a id="d41648e640" class="indexterm-anchor"></a><code class="codeph">SYSBACKUP</code> password, which means that both instances must have password files. The password file must contain at least two passwords, for the <code class="codeph">SYS</code> and <code class="codeph">SYSBACKUP</code> users. You can start the auxiliary instance and enable the source database to connect to it.</p>
<p>The <code class="codeph">DUPLICATE</code> behavior for <a id="d41648e659" class="indexterm-anchor"></a><a id="d41648e663" class="indexterm-anchor"></a>password files varies depending on whether your duplicate database will act as a standby database. If you create a duplicate database that is not a standby database, then RMAN does not copy the password file by default. You can specify the <code class="codeph">PASSWORD FILE</code> option to indicate that RMAN can overwrite the existing password file on the auxiliary instance. If you create a standby database, then RMAN copies the password file to the standby host by default, overwriting the existing password file. In this case, the <code class="codeph">PASSWORD FILE</code> clause is not necessary.</p>
<p>You cannot use the <code class="codeph">UNTIL</code> clause when performing active database duplication. RMAN chooses a time based on when the online data files have been completely copied, so that the data files can be recovered to a consistent point in time.</p>
<div class="infoboxnotealso" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__GUID-94B7AF61-B794-473E-84AC-2F177F71E8FA">
<p class="notep1">See Also:</p>
<p><a class="olink DBSEG0032" target="_blank" href="../DBSEG/authentication.htm#DBSEG0032"><span class="italic">Oracle Database Security Guide</span></a> to learn about password protection</p>
</div>
</div>
<!-- class="section" -->
<div class="section" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDHJJGI">
<p class="subhead1">Usage Notes</p>
<p>When you duplicate a whole multitenant container database (CDB) or one or more pluggable databases (PDBs), you must create the auxiliary instance as a CDB and must connect to the root of both the target and auxiliary instances. To create the auxiliary instance as a CDB, include the declaration <code class="codeph">enable_pluggable_database=TRUE</code> in the initialization parameter file.</p>
<p><a id="d41648e695" class="indexterm-anchor"></a><a id="d41648e699" class="indexterm-anchor"></a><a id="d41648e703" class="indexterm-anchor"></a>Active database duplication with image copies uses the auxiliary net service name to copy the source database over the network to the auxiliary instance on the destination host. Conversely, in active database duplication with backup sets, the auxiliary instance uses the target instance net service name to retrieve the source database files over the network. Backup-based duplication uses pre-existing RMAN backups and copies.</p>
<p><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDIJJHJ" title="Identifies source database files that are duplicated">Table 2-7</a> shows which files from the source database are duplicated.</p>
<div class="tblformal" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDIJJHJ">
<p class="titleintable">Table 2-7 Duplicated Files</p>
<table class="cellalignment1067" title="Duplicated Files" summary="Identifies source database files that are duplicated">
<thead>
<tr class="cellalignment1038">
<th class="cellalignment1068" id="d41648e725">Source Database Files</th>
<th class="cellalignment1068" id="d41648e728">Active Database</th>
<th class="cellalignment1068" id="d41648e731">Backup-Based</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1038">
<td class="cellalignment1070" id="d41648e736" headers="d41648e725">
<p>Control files</p>
</td>
<td class="cellalignment1070" headers="d41648e736 d41648e728">
<p>Copied from source database when <code class="codeph">FOR STANDBY</code> specified; otherwise re-created</p>
</td>
<td class="cellalignment1070" headers="d41648e736 d41648e731">
<p>Restored from backups</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1070" id="d41648e749" headers="d41648e725">
<p>Data files</p>
</td>
<td class="cellalignment1070" headers="d41648e749 d41648e728">
<p>Copied from source database (unless excluded with a <code class="codeph">SKIP</code> option)</p>
</td>
<td class="cellalignment1070" headers="d41648e749 d41648e731">
<p>Restored from backups (unless excluded with a <code class="codeph">SKIP</code> option)</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1070" id="d41648e765" headers="d41648e725">
<p>Tempfiles</p>
</td>
<td class="cellalignment1070" headers="d41648e765 d41648e728">
<p>Re-created (see <span class="q">&#34;<a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDHHBIA">Temp File Re-Creation</a>&#34;</span>)</p>
</td>
<td class="cellalignment1070" headers="d41648e765 d41648e731">
<p>Re-created (see <span class="q">&#34;<a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDHHBIA">Temp File Re-Creation</a>&#34;</span>)</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1070" id="d41648e783" headers="d41648e725">
<p>Online redo log files</p>
</td>
<td class="cellalignment1070" headers="d41648e783 d41648e728">
<p>Re-created</p>
</td>
<td class="cellalignment1070" headers="d41648e783 d41648e731">
<p>Re-created</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1070" id="d41648e793" headers="d41648e725">
<p>Standby redo log files</p>
</td>
<td class="cellalignment1070" headers="d41648e793 d41648e728">
<p>Re-created when <code class="codeph">FOR STANDBY</code> specified and defined on primary database</p>
</td>
<td class="cellalignment1070" headers="d41648e793 d41648e731">
<p>Re-created when <code class="codeph">FOR STANDBY</code> specified and defined on primary database</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1070" id="d41648e809" headers="d41648e725">
<p>Archived redo log files</p>
</td>
<td class="cellalignment1070" headers="d41648e809 d41648e728">
<p>Copied from source database, but only if needed for the duplication</p>
</td>
<td class="cellalignment1070" headers="d41648e809 d41648e731">
<p>Obtained from backups or cataloged copies, but only if needed for the duplication</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1070" id="d41648e819" headers="d41648e725">
<p>Server parameter file</p>
</td>
<td class="cellalignment1070" headers="d41648e819 d41648e728">
<p>Copied from source database (see <code class="codeph">SPFILE</code> clause in <span class="italic"><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__I1011578">dupOptionList</a></span>)</p>
</td>
<td class="cellalignment1070" headers="d41648e819 d41648e731">
<p>Restored from backup if <code class="codeph">SPFILE</code> clause is specified (see <span class="italic"><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__I1011578">dupOptionList</a></span>)</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1070" id="d41648e843" headers="d41648e725">
<p>Flashback log files</p>
</td>
<td class="cellalignment1070" headers="d41648e843 d41648e728">
<p>Not re-created</p>
</td>
<td class="cellalignment1070" headers="d41648e843 d41648e731">
<p>Not re-created</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1070" id="d41648e853" headers="d41648e725">
<p>Block change tracking file</p>
</td>
<td class="cellalignment1070" headers="d41648e853 d41648e728">
<p>Not re-created</p>
</td>
<td class="cellalignment1070" headers="d41648e853 d41648e731">
<p>Not re-created</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1070" id="d41648e863" headers="d41648e725">
<p>Password file</p>
</td>
<td class="cellalignment1070" headers="d41648e863 d41648e728">
<p>Copied by default for standby databases; for nonstandby databases, copied only if <code class="codeph">PASSWORD FILE</code> option is specified</p>
</td>
<td class="cellalignment1070" headers="d41648e863 d41648e731">
<p>Not re-created</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1070" id="d41648e876" headers="d41648e725">
<p>Backups and other files in fast recovery area</p>
</td>
<td class="cellalignment1070" headers="d41648e876 d41648e728">
<p>Not copied</p>
</td>
<td class="cellalignment1070" headers="d41648e876 d41648e731">
<p>Not copied</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>All data files are included in the duplicate database unless they are offline clean or excluded. You can exclude tablespaces with the <code class="codeph">SKIP</code> clause, or by including only a subset of tablespaces with <code class="codeph">DUPLICATE ... TABLESPACE</code>.</p>
<p>The <a id="d41648e895" class="indexterm-anchor"></a><a id="d41648e899" class="indexterm-anchor"></a>fast recovery area is defined on the duplicate or standby database if you explicitly define it. Also, if a fast recovery area was defined on the source database, and if the auxiliary instance uses a server parameter file that was copied or restored with the <code class="codeph">DUPLICATE</code> command, then a fast recovery area is defined on the duplicate or standby database.</p>
<p>If you use active database duplication, then see the <code class="codeph">FROM ACTIVE DATABASE</code> description in <span class="italic"><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__I1011578">dupOptionList</a></span> for usage notes.</p>
<p><span class="bold">Backup-Based Duplication</span></p>
<p><a id="d41648e920" class="indexterm-anchor"></a>In backup-based duplication of databases with a connection to the target database and in <a id="d41648e925" class="indexterm-anchor"></a><code class="codeph">NOARCHIVELOG</code> mode, media recovery uses the <code class="codeph">NOREDO</code> option. Thus, if incremental backups exist, RMAN applies only these incremental backups to the restored files during recovery.</p>
<p>For backup-based duplication of databases in <a id="d41648e935" class="indexterm-anchor"></a><code class="codeph">ARCHIVELOG</code> mode, RMAN recovers by default up to the last archived redo log generated at the time the command was executed, or until a time specified with a <code class="codeph"><a href="rcmsynta2014.htm#GUID-BC501B5C-4CD0-485D-AA18-27E2894024C3">SET</a></code> <code class="codeph">UNTIL</code> clause.</p>
<p>For backup-based duplication of databases without a connection to the target database, RMAN cannot determine whether the source database was in <code class="codeph">NOARCHIVELOG</code> mode. Therefore, you must use the <code class="codeph">NOREDO</code> option when the source database was in <code class="codeph">NOARCHIVELOG</code> mode when the backups were taken. You can also use the <code class="codeph">NOREDO</code> option when you do not want to apply archived redo log files to a consistent backup.</p>
<p>If you are using backup-based duplication, and if the source database and auxiliary instances reside on different hosts, then you must decide how to make the backups of the source database available to the auxiliary instance. For more information on how to do this with <code class="codeph">BACKUP LOCATION</code>, review the options described in the section <a class="olink BRADV99993" target="_blank" href="../BRADV/rcmdupdb.htm#BRADV99993"><span class="italic">Making Disk Backups Accessible to the Auxiliary Instance</span></a> in the <span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span>.</p>
<p>If the target database does not use a recovery area in ASM storage, then perform one of the following tasks before executing the <code class="codeph">DUPLICATE</code> command:</p>
<ul style="list-style-type: disc;">
<li>
<p>If you are using SBT backups, then make the tapes with the backups accessible to the destination host.</p>
</li>
<li>
<p>If you are using disk backups, and if you can use the same backup directory names on the destination host as the source host, then do one of the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>Manually transfer the backups and copies from the source host to the destination host to an identical path.</p>
</li>
<li>
<p>Use NFS or shared disks and ensure that the same path is accessible in the destination host.</p>
</li>
</ul>
</li>
<li>
<p>If you are using disk backups, and if you <span class="italic">cannot</span> use the same backup directory names on the destination host as the source host, then use of the techniques described in <a class="olink BRADV99993" target="_blank" href="../BRADV/rcmdupdb.htm#BRADV99993"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a>.</p>
</li>
</ul>
<p>If the source database uses a recovery area in <a id="d41648e1008" class="indexterm-anchor"></a>ASM storage, then perform one of the following tasks before executing the <code class="codeph">DUPLICATE</code> command:</p>
<ul style="list-style-type: disc;">
<li>
<p>Make a database backup to a location outside the fast recovery area. You can make this backup accessible in the following ways:</p>
<ul style="list-style-type: disc;">
<li>
<p>Use NFS to mount the backup on the destination host with the same name.</p>
</li>
<li>
<p>Use NFS to mount the backup on the destination host with a different name, and then <code class="codeph"><a href="rcmsynta007.htm#GUID-6E337759-9860-463A-BF7C-8512B272B8E1">CATALOG</a></code> the backup while RMAN is connected as <code class="codeph">TARGET</code> to the source database.</p>
</li>
</ul>
</li>
<li>
<p>Back up the fast recovery area to tape and use it for duplication.</p>
</li>
</ul>
<p id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDECBFJ"><span class="bold">Duplication with Oracle Managed Files</span></p>
<p>If the source database files are in the <a id="d41648e1043" class="indexterm-anchor"></a><a id="d41648e1045" class="indexterm-anchor"></a>Oracle Managed Files (OMF) format, then you cannot use the <a id="d41648e1048" class="indexterm-anchor"></a><a id="d41648e1050" class="indexterm-anchor"></a><code class="codeph">DB_FILE_NAME_CONVERT</code> and <code class="codeph">LOG_FILE_NAME_CONVERT</code><a id="d41648e1059" class="indexterm-anchor"></a><a id="d41648e1061" class="indexterm-anchor"></a> initialization parameters or the <span class="italic"><code class="codeph"><span class="codeinlineitalic"><a href="rcmsubcl008.htm#GUID-486FE88C-2B48-40C7-B29A-8AC669F29FA3">fileNameConversionSpec</a></span></code></span> clause to generate new OMF file names for the duplicate database. If you do not follow this rule, the new OMF files generated from these three methods can cause problems. For more information on OMF names, see the &#34;Considerations When Renaming OMF Auxiliary Set Files in TSPITR&#34; in the <span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></p>
<p>The only exception to this rule is when changing only an ASM disk group name. Assume that source data files and online redo log files are stored in ASM disk group <code class="codeph">+SOURCEDSK</code>. You want to store the duplicate database files in ASM disk group <code class="codeph">+DUPDSK</code>. In this case, you can set the initialization parameters as follows:</p>
<pre dir="ltr">DB_FILE_NAME_CONVERT = (&#34;+SOURCEDSK&#34;,&#34;+DUPDSK&#34;)
LOG_FILE_NAME_CONVERT = (&#34;+SOURCEDSK&#34;,&#34;+DUPDSK&#34;)
</pre>
<p>RMAN uses <code class="codeph">DB_FILE_NAME_CONVERT</code> or <code class="codeph">LOG_FILE_NAME_CONVERT</code> to convert the disk group name, and then generates a new, valid file name based on the converted disk group name.</p>
<p>You have the following other supported options for naming data files when the source files are in the Oracle Managed Files format:</p>
<ul style="list-style-type: disc;">
<li>
<p>Use <code class="codeph"><a href="rcmsynta2014.htm#GUID-BC501B5C-4CD0-485D-AA18-27E2894024C3">SET</a></code> <code class="codeph">NEWNAME</code> to specify names for individual data files.</p>
</li>
<li>
<p>Set <code class="codeph">DB_FILE_CREATE_DEST</code> to make all data files of the new database Oracle-managed files, except the files for which <code class="codeph">SET NEWNAME</code> is used. Do not set <code class="codeph">DB_FILE_NAME_CONVERT</code> if you set <code class="codeph">DB_FILE_CREATE_DEST</code>.</p>
</li>
</ul>
<p>Supported options for naming online redo logs duplicated from Oracle-managed files are <code class="codeph">DB_CREATE_FILE_DEST</code>, <code class="codeph">DB_RECOVERY_FILE_DEST</code>, or <code class="codeph">DB_CREATE_ONLINE_LOG_DEST_</code><span class="italic"><code class="codeph">n</code></span>.</p>
<p id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDHHBIA"><span class="bold">Temp File Re-Creation</span></p>
<p>The <code class="codeph">DB_FILE_NAME_CONVERT</code> parameter can convert the temp file names for the new database that are not Oracle-managed files (OMF). The only exception to this restriction are Automatic Storage Management (ASM) OMF names where you can change only the name of the disk group.</p>
<p>The other method for converting temp file names for the new database is to use <code class="codeph">SET NEWNAME FOR TEMPFILE TO&#39;filename&#39;</code> or <code class="codeph">TO NEW</code>. With this latter method, it does not matter if the data files are OMF or non-OMF, the temp files are re-created in the <code class="codeph">DB_CREATE_FILE_DEST</code> directory location when the database is opened.</p>
<p><a id="d41648e1158" class="indexterm-anchor"></a>To specify different file names for the temp files, see the discussion of <code class="codeph"><a href="rcmsynta2021.htm#GUID-BEA73581-C6F4-4346-A61B-B6C19513BF1C">SWITCH</a></code> <code class="codeph">TEMPFILE</code> .</p>
<p><span class="bold">Duplication with CDBs and PDBs</span></p>
<p>The <code class="codeph">DUPLICATE</code> command enables you to duplicate CDBs, the root, and one or more PDBs. The process is similar to that of duplicating non-CDBs. The differences are that you must connect to the root as a user who is granted the <code class="codeph">SYSBACKUP</code> or <code class="codeph">SYSDBA</code> privilege and the auxiliary instance must be created as a CDB. To duplicate PDBs, use the <code class="codeph">DUPLICATE</code> command with the <code class="codeph">PLUGGABLE DATABASE</code> option.</p>
<div class="infoboxnotealso" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__GUID-AAF89FD2-80B6-4E64-81D5-B848D21E51DF">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="rcmsynta010.htm#GUID-64ECF1B8-4F70-413E-BEBE-1D5E8CD48B67">CONNECT</a>&#34;</span></p>
</li>
<li>
<p><a class="olink BRADV" target="_blank" href="../BRADV/toc.htm"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> for information about duplicating CDBs and PDBs</p>
</li>
</ul>
</div>
</div>
<!-- class="section" -->
<div class="section" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDFIGHC">
<p class="subhead1">Syntax</p>
<p id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDICDAE"><a id="d41648e1209" class="indexterm-anchor"></a><a id="d41648e1213" class="indexterm-anchor"></a><span class="bold"><span class="italic">duplicate</span>::=</span></p>
<div class="figure" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__GUID-1EAE04BF-BE5B-4547-8A84-2F7E7A909671"><img width="735" height="182" src="img/GUID-F05092DF-341F-4829-A706-6D4ADF8F6D9D-default.gif" alt="Description of GUID-F05092DF-341F-4829-A706-6D4ADF8F6D9D-print.eps follows" title="Description of GUID-F05092DF-341F-4829-A706-6D4ADF8F6D9D-print.eps follows"/><br/>
<a href="img_text/GUID-F05092DF-341F-4829-A706-6D4ADF8F6D9D-print.htm">Description of the illustration GUID-F05092DF-341F-4829-A706-6D4ADF8F6D9D-print.eps</a></div>
<!-- class="figure" -->
<p>(<span class="italic"><span class="bold"><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDHECDG">dupOptionList::=</a></span></span>)</p>
<p id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDHECDG"><a id="d41648e1232" class="indexterm-anchor"></a><a id="d41648e1236" class="indexterm-anchor"></a><span class="bold"><span class="italic">dupOptionList</span>::=</span></p>
<div class="figure" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__GUID-9E4B7775-A057-41FA-838D-7B54BABF6092"><img width="746" height="1004" src="img/GUID-BDE5B9DB-F769-4FFF-9512-4A0E8785DB6C-default.gif" alt="Description of GUID-BDE5B9DB-F769-4FFF-9512-4A0E8785DB6C-print.eps follows" title="Description of GUID-BDE5B9DB-F769-4FFF-9512-4A0E8785DB6C-print.eps follows"/><br/>
<a href="img_text/GUID-BDE5B9DB-F769-4FFF-9512-4A0E8785DB6C-print.htm">Description of the illustration GUID-BDE5B9DB-F769-4FFF-9512-4A0E8785DB6C-print.eps</a></div>
<!-- class="figure" -->
<p>(<span class="italic"><a href="rcmsubcl007.htm#GUID-F653748D-4AB5-4A0E-B6E5-D891A000ADAC__BABDEJAC">deviceSpecifier::=</a></span>, <span class="italic"><a href="rcmsubcl008.htm#GUID-486FE88C-2B48-40C7-B29A-8AC669F29FA3__BABBJGBH">fileNameConversionSpec::=</a></span>, <span class="italic"><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDIGIJD">logSpec::=</a></span>, <span class="italic"><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDIGEDI">setParameter::=</a></span>, <span class="italic"><a href="rcmsubcl019.htm#GUID-146EDBEE-BCED-4BD4-A720-8E51AA8DC577__BABHAICB">sizeSpec::=</a></span>, <span class="italic"><a href="rcmsubcl022.htm#GUID-6A6C502A-6E21-4673-9FC9-C075D1E2F97A__BABEDABD">untilClause::=</a></span>)</p>
<p id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDIGEDI"><a id="d41648e1275" class="indexterm-anchor"></a><a id="d41648e1279" class="indexterm-anchor"></a><span class="bold"><span class="italic">setParameter</span>::=</span></p>
<div class="figure" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__GUID-109DF395-3D9F-485D-B285-989E41F6FE11"><img width="414" height="112" src="img/GUID-568CC54E-F737-4375-9075-6EB558F0AF6C-default.gif" alt="Description of GUID-568CC54E-F737-4375-9075-6EB558F0AF6C-print.eps follows" title="Description of GUID-568CC54E-F737-4375-9075-6EB558F0AF6C-print.eps follows"/><br/>
<a href="img_text/GUID-568CC54E-F737-4375-9075-6EB558F0AF6C-print.htm">Description of the illustration GUID-568CC54E-F737-4375-9075-6EB558F0AF6C-print.eps</a></div>
<!-- class="figure" -->
<p id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDIGIJD"><a id="d41648e1291" class="indexterm-anchor"></a><a id="d41648e1295" class="indexterm-anchor"></a><span class="bold"><span class="italic">logSpec</span>::=</span></p>
<div class="figure" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__GUID-6A126C38-2FE1-454C-8D07-119C82B95F85"><img width="471" height="88" src="img/GUID-56A5206D-8439-4256-8EF2-650C485B325A-default.gif" alt="Description of GUID-56A5206D-8439-4256-8EF2-650C485B325A-print.eps follows" title="Description of GUID-56A5206D-8439-4256-8EF2-650C485B325A-print.eps follows"/><br/>
<a href="img_text/GUID-56A5206D-8439-4256-8EF2-650C485B325A-print.htm">Description of the illustration GUID-56A5206D-8439-4256-8EF2-650C485B325A-print.eps</a></div>
<!-- class="figure" -->
<p>(<span class="italic"><a href="rcmsubcl019.htm#GUID-146EDBEE-BCED-4BD4-A720-8E51AA8DC577__BABHAICB">sizeSpec::=</a></span>)</p>
</div>
<!-- class="section" -->
<div class="section" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDEHIGF">
<p class="subhead1">Semantics</p>
<p id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__I1018642"><span class="bold"><span class="italic">duplicate</span></span></p>
<p>This clause enables you to duplicate a database or tablespace. Refer to the <span class="italic"><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDICDAE">duplicate::=</a></span> diagram for the syntax.</p>
<div class="tblformalwide" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__GUID-F425BC06-C9C6-4971-B664-528D236F86A1">
<table class="cellalignment1044" summary="Describes DUPLICATE command parameters">
<thead>
<tr class="cellalignment1038">
<th class="cellalignment1045" id="d41648e1334">Syntax Element</th>
<th class="cellalignment1052" id="d41648e1337">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e1342" headers="d41648e1334">
<p><code class="codeph">TARGET DATABASE</code></p>
</td>
<td class="cellalignment1053" headers="d41648e1342 d41648e1337">
<p>Specifies the source database, which is the database you want to duplicate. Starting with Oracle Database 11<span class="italic">g</span> Release 2 the <code class="codeph">TARGET</code> keyword is optional.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e1356" headers="d41648e1334">
<p><code class="codeph">DATABASE</code></p>
</td>
<td class="cellalignment1053" headers="d41648e1356 d41648e1337">
<p>Specifies the source database.</p>
<p>In a CDB, <a id="d41648e1365" class="indexterm-anchor"></a><a id="d41648e1369" class="indexterm-anchor"></a>specifies the whole CDB. Specifies the PDB when connected to a PDB.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e1375" headers="d41648e1334">
<p><span class="italic"><code class="codeph">&nbsp;&nbsp;&nbsp;&#39;database_name&#39;</code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e1375 d41648e1337">
<p>Specifies the name of the source database, which is the database to duplicate.</p>
<p>This clause can be used instead of <code class="codeph">TARGET DATABASE</code> when RMAN is connected as <code class="codeph">TARGET</code> to the source database. When performing duplicate with a target connection, then you must specify the currently connected database and not use the <code class="codeph">INCARNATION</code> subclause.</p>
<p>For backup-based duplication without a target connection, you must either specify the database name or run the <code class="codeph">SET DATABASE</code> <span class="italic">&#39;database_name&#39;</span> command.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e1403" headers="d41648e1334">
<p><code class="codeph">&nbsp;&nbsp;&nbsp;DBID</code> <span class="italic"><code class="codeph">integer</code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e1403 d41648e1337">
<p>Specifies the database ID (DBID) of the source database.</p>
<p>The <code class="codeph">DBID</code> parameter is required when you duplicate without a <code class="codeph">TARGET</code> connection to the source database and the database name in the recovery catalog is not unique. Another option is to use the <code class="codeph">SET DBID</code> command.</p>
<p>When RMAN duplicates the database while connected to the source database as <code class="codeph">TARGET</code>, the <code class="codeph">DBID</code> parameter is not needed. If you specify <code class="codeph">DBID</code>, then set the value to match the <code class="codeph">DBID</code> of the source database.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e1439" headers="d41648e1334">
<p><a id="d41648e1441" class="indexterm-anchor"></a><code class="codeph">&nbsp;INCARNATION</code> <span class="italic"><code class="codeph">primaryKey</code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e1439 d41648e1337">
<p>Specifies an orphan incarnation.</p>
<p>By default, the <code class="codeph">DUPLICATE</code> command with the <code class="codeph">UNTIL</code> clause refers to a point in time in the current database incarnation or the direct ancestor of the current incarnation. This clause enables you to designate an incarnation not in the current incarnation path, known as an orphan incarnation. It is invalid to specify <code class="codeph">INCARNATION</code> when connected to a target database or when using <code class="codeph">BACKUP LOCATION</code>.</p>
<p>Another option is to use the <code class="codeph">SET INCARNATION</code> command.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e1475" headers="d41648e1334">
<p><code class="codeph">FOR&nbsp;STANDBY</code></p>
</td>
<td class="cellalignment1053" headers="d41648e1475 d41648e1337">
<p>Designates the database being duplicated as a standby database (see <a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDDFDGH">Example 2-91</a>).</p>
<p>To create a standby database with the <code class="codeph">DUPLICATE</code> command you must specify the <code class="codeph">FOR STANDBY</code> option. The <code class="codeph">DUPLICATE ... FOR STANDBY</code> command creates the standby database by restoring a standby control file and mounting the standby control file. If you specify <code class="codeph">FROM ACTIVE DATABASE</code>, then RMAN copies the data files from the primary to standby database. Otherwise, RMAN restores backups of the source database data files to the standby database. RMAN restores the most recent files, unless <code class="codeph"><a href="rcmsynta2014.htm#GUID-BC501B5C-4CD0-485D-AA18-27E2894024C3">SET</a></code> <code class="codeph">UNTIL</code> is specified.</p>
<p>If you are duplicating the SPFILE, then specify a unique <code class="codeph">DB_UNIQUE_NAME</code> in the <code class="codeph">SPFILE</code> clause. If not, then manually set this parameter to a unique value in the PFILE or SPFILE of the auxiliary instance.</p>
<p>You cannot use <code class="codeph">TO</code> <span class="italic"><code class="codeph">database_name</code></span> for a standby database.</p>
<p>If you specify <code class="codeph">DORECOVER</code>, then RMAN also recovers the database. The standby database remains mounted after duplication is complete.</p>
<p>You cannot use <code class="codeph">SET NEWNAME</code> or <code class="codeph"><a href="rcmsynta009.htm#GUID-B5094E73-C26C-4FED-AE39-8C2E9540050A">CONFIGURE</a></code> <code class="codeph">AUXNAME</code> to transform the file names for the online redo logs on the standby database.</p>
<p>You cannot <code class="codeph"><a href="rcmsynta010.htm#GUID-64ECF1B8-4F70-413E-BEBE-1D5E8CD48B67">CONNECT</a></code> RMAN to the standby database and then use <code class="codeph">DUPLICATE ... FOR STANDBY</code> to create an additional standby database. To create additional standby databases, connect RMAN to the original primary database and run <code class="codeph">DUPLICATE ... FOR STANDBY</code>.</p>
<p><span class="bold">Note:</span> You cannot use <code class="codeph">SKIP TABLESPACE</code> while creating a standby database.</p>
<p><span class="bold">Note:</span> Although you can use the <code class="codeph">DUPLICATE</code> command to create a standby database, you cannot use this command to activate a standby database.</p>
<p>When you connect RMAN to the standby database and the recovery catalog in which the primary database is registered, RMAN recognizes the standby database and implicitly registers it. Do not attempt to use the <code class="codeph">REGISTER</code> command for the standby database.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e1575" headers="d41648e1334">
<p><code class="codeph">TO</code> <span class="italic"><code class="codeph">database_name</code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e1575 d41648e1337">
<p>Specifies the name of the duplicate database. This duplicate database is not a standby database, so this clause cannot be used with <code class="codeph">FOR STANDBY</code>.</p>
<p>If you do not specify the <code class="codeph">SPFILE</code> clause, then the specified database name must match the name in the initialization parameter file of the duplicate database instance, which is the instance to which RMAN is connected as <code class="codeph">AUXILIARY</code>. Otherwise, the database signals an error.</p>
<p>You cannot use the same database name for the source database and duplicate database when the duplicate database resides in the same Oracle home as the source database. However, if the duplicate database resides in a different Oracle home from the source database, then its database name just has to differ from other database names in its Oracle home. To simplify administration of duplicate database, Oracle recommends that you use different names for the source and duplicate databases.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e1599" headers="d41648e1334">
<p><code class="codeph">&nbsp;&nbsp;&nbsp;</code><span class="italic"><code class="codeph"><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__I1011578">dupOptionList</a></code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e1599 d41648e1337">
<p>Specifies options for creating a duplicate or standby database. See <span class="italic"><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__I1011578">dupOptionList</a></span>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__I1011578"><span class="bold"><span class="italic">dupOptionList</span></span></p>
<p>This subclause includes options that control aspects of duplication such as naming the files and determining an end point for the duplication. Refer to the <span class="italic"><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDHECDG">dupOptionList::=</a></span> diagram for the syntax.</p>
<p>Specify new file names or convert source database file names for the data files and online redo logs when the file names of the duplicate database must be different from the file names of the source database (as when the destination host and source host are the same). If you do not specify file names for the online redo logs and data files of the duplicate database, then RMAN uses the data file names from the source database.</p>
<div class="tblformalwide" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__GUID-897244A7-1611-4811-9126-C7A6643DE3C5">
<table class="cellalignment1044" summary="Describes DUPLICATE command dupOptionList parameters">
<thead>
<tr class="cellalignment1038">
<th class="cellalignment1045" id="d41648e1634">Syntax Element</th>
<th class="cellalignment1052" id="d41648e1637">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e1642" headers="d41648e1634">
<p><code class="codeph">BACKUP LOCATION</code> <span class="italic">backup_location</span></p>
</td>
<td class="cellalignment1053" headers="d41648e1642 d41648e1637">
<p>Specifies the backup location on disk where the backups and copies of the database to be duplicated have been placed. This option is valid for duplication without a target or a recovery catalog connection.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e1652" headers="d41648e1634">
<p><code class="codeph">DEVICE&nbsp;TYPE</code> <span class="italic"><code class="codeph"><a href="rcmsubcl007.htm#GUID-F653748D-4AB5-4A0E-B6E5-D891A000ADAC">deviceSpecifier</a></code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e1652 d41648e1637">
<p>Allocates automatic channels for the specified device only (for example, <code class="codeph">DISK</code> or <code class="codeph">sbt</code>).</p>
<p>This option is valid only if you have configured automatic channels and have <span class="italic">not</span> manually allocated channels. For example, if you <code class="codeph"><a href="rcmsynta009.htm#GUID-B5094E73-C26C-4FED-AE39-8C2E9540050A">CONFIGURE</a></code> automatic disk and tape channels, and if you run <code class="codeph">DUPLICATE...DEVICE TYPE DISK</code>, then RMAN allocates only disk channels.</p>
<p><span class="bold">See Also:</span> <span class="italic"><code class="codeph"><a href="rcmsubcl007.htm#GUID-F653748D-4AB5-4A0E-B6E5-D891A000ADAC">deviceSpecifier</a></code></span></p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e1694" headers="d41648e1634">
<p><code class="codeph">DORECOVER</code></p>
</td>
<td class="cellalignment1053" headers="d41648e1694 d41648e1637">
<p>Recovers the standby database after creating it. If you specify an <span class="italic"><code class="codeph"><a href="rcmsubcl022.htm#GUID-6A6C502A-6E21-4673-9FC9-C075D1E2F97A">untilClause</a></code></span>, then RMAN recovers to the specified SCN or time and leaves the database mounted.</p>
<p>RMAN leaves the standby database mounted after media recovery is complete, but does not place the standby database in manual or managed recovery mode. After RMAN creates the standby database, you must resolve any gap sequence before placing it in manual or managed recovery mode, or opening it in read-only mode.</p>
<p>The checkpoint SCN of the control file must be included in an archived redo log that is either available at the standby site or included in an RMAN backup. For example, assume that you create the standby control file and then immediately afterward archive the current log, which has a sequence of 100. In this case, you must recover the standby database up to at least log sequence 100, or the database signals an <a id="d41648e1711" class="indexterm-anchor"></a><a id="d41648e1713" class="indexterm-anchor"></a><code class="codeph">ORA-1152</code> error message because the standby control file backup was taken after the point in time.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e1721" headers="d41648e1634">
<p><span class="italic"><code class="codeph"><a href="rcmsubcl008.htm#GUID-486FE88C-2B48-40C7-B29A-8AC669F29FA3">fileNameConversionSpec</a></code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e1721 d41648e1637">
<p>Specifies one or more patterns to map source database file names to duplicate database file names (see <a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDCHBGC">Example 2-85</a>).</p>
<p><a id="d41648e1734" class="indexterm-anchor"></a><a id="d41648e1736" class="indexterm-anchor"></a><code class="codeph">DB_FILE_NAME_CONVERT</code> set on the <code class="codeph">DUPLICATE</code> command overrides the initialization parameter <code class="codeph">DB_FILE_NAME_CONVERT</code> (if set). For example, if the initialization parameter file setting is <code class="codeph">DB_FILE_NAME_CONVERT=(&#39;disk1&#39;,&#39;disk2&#39;)</code>, but you execute <code class="codeph">DUPLICATE ... DB_FILE_NAME_CONVERT (&#39;disk1&#39;,&#39;disk3&#39;)</code>, then RMAN does not convert the <code class="codeph">disk1</code> substring to <code class="codeph">disk2</code>. Instead, RMAN converts the <code class="codeph">disk1</code> substring to <code class="codeph">disk3</code>.</p>
<p>If a file in the specification list is not affected by the conversion parameter in <code class="codeph">DUPLICATE</code>, then you must rename it by other means, such as <code class="codeph">SET NEWNAME</code>.</p>
<p><span class="bold">Note:</span> If you specify the <a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDEAJCC">SPFILE</a> clause, then <code class="codeph">DUPLICATE ... DB_FILE_NAME_CONVERT</code> overrides any conversion parameter specified in the <code class="codeph">SPFILE</code> syntax. For example, if you specify <code class="codeph">DB_FILE_NAME_CONVERT</code> twice in the <code class="codeph">DUPLICATE</code> command, both in the <code class="codeph">SPFILE</code> clause and outside of the <code class="codeph">SPFILE</code> clause, then the setting outside of the <code class="codeph">SPFILE</code> clause takes precedence.</p>
<p><span class="bold">See Also:</span> <span class="italic"><code class="codeph"><a href="rcmsubcl008.htm#GUID-486FE88C-2B48-40C7-B29A-8AC669F29FA3">fileNameConversionSpec</a></code></span></p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e1815" headers="d41648e1634">
<p><code class="codeph">FROM&nbsp;ACTIVE&nbsp;DATABASE</code></p>
</td>
<td class="cellalignment1053" headers="d41648e1815 d41648e1637">
<p>Provides the files for the duplicate database directly from the source database and not from a backup of the source database (see <a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDJGCFC">Example 2-82</a>).</p>
<p><span class="bold">See Also:</span> <span class="q">&#34;<a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDBCJFA">Prerequisites Specific to Active Database Duplication</a>&#34;</span> for command prerequisites</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e1833" headers="d41648e1634">
<p><code class="codeph">LOGFILE</code></p>
</td>
<td class="cellalignment1053" headers="d41648e1833 d41648e1637">
<p>Specifies options for creating online redo logs when creating a duplicate database that is not a standby database (see <a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDCHBGC">Example 2-85</a>).</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e1843" headers="d41648e1634">
<p><code class="codeph">&nbsp;&nbsp;&nbsp;INSTANCE</code><code class="codeph">&nbsp;&#39;</code><span class="italic"><code class="codeph">inst_name</code></span><code class="codeph">&#39;</code></p>
</td>
<td class="cellalignment1053" headers="d41648e1843 d41648e1637">
<p><a id="d41648e1856" class="indexterm-anchor"></a><a id="d41648e1860" class="indexterm-anchor"></a><a id="d41648e1864" class="indexterm-anchor"></a>Creates online redo logs for the specified instance in a Real Applications Cluster (Oracle RAC) database. The instance name is a string of up to 80 characters.</p>
<p>RMAN automatically uses the thread mapped to the specified instance. If no <code class="codeph">INSTANCE</code> name is specified, then the log files are for the default instance.</p>
<p>This clause is relevant when you use <code class="codeph">DUPLICATE TARGET DATABASE</code> to duplicate an Oracle RAC database to a single-instance database. Otherwise, you do not need to use <code class="codeph">INSTANCE</code>. If you use the <code class="codeph">LOGFILE</code> clause, then use <code class="codeph">INSTANCE</code> to specify the name of the Oracle RAC instance for each thread that was open during the database backup (for backup-based duplication) or during the <code class="codeph">UNTIL TIME</code> (for active database duplication).</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e1892" headers="d41648e1634">
<p><code class="codeph">&nbsp;&nbsp;&nbsp;</code><span class="italic"><code class="codeph"><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__BGBIHEHG">logSpec</a></code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e1892 d41648e1637">
<p>Specifies the file names and groups for the online redo log files.</p>
<p><span class="bold">See Also:</span> <span class="italic"><code class="codeph"><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__BGBIHEHG">logSpec</a></code></span> for the valid options</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e1913" headers="d41648e1634">
<p><code class="codeph">NOCHECK</code></p>
</td>
<td class="cellalignment1053" headers="d41648e1913 d41648e1637">
<p>Disables the RMAN ability to check that a set of tablespaces must be self-contained. This check is performed automatically by RMAN when backup based duplication with a target connection is performed.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e1921" headers="d41648e1634">
<p><code class="codeph">NOFILENAMECHECK</code></p>
</td>
<td class="cellalignment1053" headers="d41648e1921 d41648e1637">
<p>Prevents RMAN from checking whether the data files and online redo logs files of the source database are in use when the source database files share the same names as the duplicate database files. You are responsible for determining that the duplicate operation does not overwrite useful data.</p>
<p>This option is necessary when you are creating a duplicate database in a different host that has the same disk configuration, directory structure, and file names as the host of the source database. For example, assume that you have a small database located in the <code class="codeph">/dbs</code> directory of <code class="codeph">srchost</code>:</p>
<pre dir="ltr">/oracle/dbs/system_prod1.dbf
/oracle/dbs/users_prod1.dbf
/oracle/dbs/rbs_prod1.dbf
</pre>
<p>Assume that you want to duplicate this database to <code class="codeph">desthost</code>, which has the same file system <code class="codeph">/oracle/dbs/</code><code class="codeph">*</code>, and you want to use the same file names in the duplicate database as in the source database. In this case, specify the <code class="codeph">NOFILENAMECHECK</code> option to avoid an error message. Because RMAN is not aware of the different hosts, RMAN cannot determine automatically that it need not check the file names.</p>
<p>If duplicating a database on the same host as the source database, then ensure that <code class="codeph">NOFILENAMECHECK</code> is not set. Otherwise, RMAN can potentially overwrite and corrupt the target database data files, temp files, or online logs. It may also signal the following error:</p>
<pre dir="ltr"><a id="d41648e1957" class="indexterm-anchor"></a><a id="d41648e1959" class="indexterm-anchor"></a><a id="d41648e1963" class="indexterm-anchor"></a><a id="d41648e1965" class="indexterm-anchor"></a><a id="d41648e1969" class="indexterm-anchor"></a><a id="d41648e1971" class="indexterm-anchor"></a><a id="d41648e1975" class="indexterm-anchor"></a><a id="d41648e1977" class="indexterm-anchor"></a>RMAN-10035: exception raised in RPC: <a id="d41648e1982" class="indexterm-anchor"></a><a id="d41648e1984" class="indexterm-anchor"></a>ORA-19504: failed to create 
            file &#34;/oracle/dbs/tbs_01.f&#34; 
ORA-27086: skgfglk: unable to lock file - already in use 
SVR4 Error: 11: Resource temporarily unavailable 
Additional information: 8 
RMAN-10031: ORA-19624 occurred during call to 
DBMS_BACKUP_RESTORE.RESTOREBACKUPPIECE
</pre></td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e1990" headers="d41648e1634">
<p><code class="codeph">NOOPEN</code></p>
</td>
<td class="cellalignment1053" headers="d41648e1990 d41648e1637">
<p>Specifies that the duplicate database must not be opened after it is created.</p>
<p>By default, RMAN creates a duplicate database and then opens it in <code class="codeph">RESETLOGS</code> mode.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2004" headers="d41648e1634">
<p><code class="codeph">NOREDO</code></p>
</td>
<td class="cellalignment1053" headers="d41648e2004 d41648e1637">
<p>Applies no archived redo log files when recovering a consistent backup in any of the following scenarios:</p>
<ul style="list-style-type: disc;">
<li>
<p>You do not want to apply archived redo log files to the consistent backup even though the archived redo log files are available.</p>
</li>
<li>
<p>The source database was running in <code class="codeph">NOARCHIVELOG</code> mode at backup time and <code class="codeph">DUPLICATE</code> is not connected to the target database.</p>
</li>
<li>
<p>The source database is currently running in <code class="codeph">ARCHIVELOG</code> mode but the backup was taken when the database was in <code class="codeph">NOARCHIVELOG</code> mode.</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2034" headers="d41648e1634">
<p><code class="codeph">NORESUME</code></p>
</td>
<td class="cellalignment1053" headers="d41648e2034 d41648e1637">
<p>Disables the ability for RMAN to automatically recover from a failed duplication operation. Using <code class="codeph">NORESUME</code> in the first invocation of duplicate permanently prevents any subsequent duplicate command for the new database from using this automatic optimization.</p>
<p><span class="bold">See Also:</span> <span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span> to learn more about the automated recovery from a failed <code class="codeph">DUPLICATE</code> operation.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2055" headers="d41648e1634">
<p><code class="codeph">OPEN&nbsp;RESTRICTED</code></p>
</td>
<td class="cellalignment1053" headers="d41648e2055 d41648e1637">
<p>Enables a restricted session in the duplicate database by issuing the following SQL statement: <code class="codeph">ALTER SYSTEM ENABLE RESTRICTED SESSION</code>. RMAN issues this statement immediately before the duplicate database is opened.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2066" headers="d41648e1634">
<p><code class="codeph">PASSWORD&nbsp;FILE</code></p>
</td>
<td class="cellalignment1053" headers="d41648e2066 d41648e1637">
<p>Uses the password file on the source database to overwrite the password file currently used by the auxiliary instance (see <a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDJGCFC">Example 2-82</a>). This option is only valid when <code class="codeph">FROM ACTIVE DATABASE</code> is specified; otherwise, RMAN signals an error.</p>
<p>If <code class="codeph">FOR STANDBY</code> is specified, then RMAN copies the password file by default; if not specified, then RMAN does not copy the password file by default. You can use <code class="codeph">PASSWORD FILE</code> to request that RMAN overwrite the existing password file with the password file from the source database. If you want the duplicate database to contain all the passwords available on your production database, then use the <code class="codeph">PASSWORD FILE</code> option.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2090" headers="d41648e1634">
<p><code class="codeph">PLUGGABLE DATABASE</code> <span class="italic"><code class="codeph">pdb_name</code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e2090 d41648e1637">
<p>Duplicates one or more PDBs specified in a comma-delimited list. To duplicate PDBs, you must connect to the <code class="codeph">root</code> as described in <span class="q">&#34;<a href="rcmsynta010.htm#GUID-64ECF1B8-4F70-413E-BEBE-1D5E8CD48B67__BGBGAIGG">Connecting to CDBs and PDBs</a>&#34;</span>.</p>
<p>By default, RMAN duplicates the <code class="codeph">root</code> and the seed database of the CDB that contains the listed PDBs.</p>
<p>See <a class="olink BRADV760" target="_blank" href="../BRADV/rcmdupdb.htm#BRADV760"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> for examples about duplicating PDBs.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2120" headers="d41648e1634">
<p><code class="codeph">PFILE</code> <span class="italic"><code class="codeph">filename</code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e2120 d41648e1637">
<p><a id="d41648e2130" class="indexterm-anchor"></a><a id="d41648e2134" class="indexterm-anchor"></a><a id="d41648e2138" class="indexterm-anchor"></a>Specifies a text-based initialization parameter file used by the auxiliary instance (see <a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDCHBGC">Example 2-85</a>). RMAN automatically shuts down and restarts the auxiliary instance during duplication. If the auxiliary does not use a server parameter file in the default location, then you must specify the text-based initialization parameter file that RMAN uses when starting the auxiliary instance. The initialization parameter file must reside on the same host as the RMAN client used to perform the duplication.</p>
<p>If the auxiliary instance uses a server parameter file in the default location, then you do not need to specify <code class="codeph">PFILE</code>.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2151" headers="d41648e1634">
<p><code class="codeph">SECTION SIZE</code> <span class="italic"><code class="codeph">sizeSpec</code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e2151 d41648e1637">
<p>Specifies the size of each backup section produced during the data transfer phase of the active duplicate operation. When this option is used, RMAN uses active duplication with backup sets by default. Therefore, ensure that prerequisites for this type of duplication are met.</p>
<p>See <a href="rcmsynta006.htm#GUID-73642FF2-43C5-48B2-9969-99001C52EB50__BGBJCAHI">SECTION&nbsp;SIZE sizeSpec</a>.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2168" headers="d41648e1634">
<p><code class="codeph">SKIP&nbsp;READONLY</code></p>
</td>
<td class="cellalignment1053" headers="d41648e2168 d41648e1637">
<p>Excludes data files in current read-only tablespaces from the duplicate database. By default RMAN duplicates current read-only tablespaces.</p>
<p>If a tablespace is currently read/write, but you use <span class="italic"><code class="codeph"><a href="rcmsubcl022.htm#GUID-6A6C502A-6E21-4673-9FC9-C075D1E2F97A">untilClause</a></code></span> to duplicate the database to an SCN at which the tablespace was read-only, then RMAN does not include the tablespace in the duplicate database. Tablespaces that were previously read-only are considered offline tablespaces and so are not included in the duplication.</p>
<p><span class="bold">Note:</span> The read-only tablespaces must be self-contained for the <code class="codeph">DUPLICATE</code> command to succeed with this option.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2191" headers="d41648e1634">
<p><code class="codeph">SKIP PLUGGABLE DATABASE</code> <span class="italic"><code class="codeph">pdb_name</code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e2191 d41648e1637">
<p>Duplicates all the PDBs within the CDB, except the ones specified in the comma-separated list <span class="italic"><code class="codeph">pdb_name</code></span>. To duplicate PDBs, you must connect to the <code class="codeph">root</code> as described in <span class="q">&#34;<a href="rcmsynta010.htm#GUID-64ECF1B8-4F70-413E-BEBE-1D5E8CD48B67__BGBGAIGG">Connecting to CDBs and PDBs</a>&#34;</span>.</p>
<p>By default, RMAN duplicates the <code class="codeph">root</code> and the seed database of the CDB.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2218" headers="d41648e1634">
<p><code class="codeph">SKIP&nbsp;TABLESPACE</code> <span class="italic"><code class="codeph">tablespace_name</code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e2218 d41648e1637">
<p>Excludes the specified tablespace from the duplicate database (see <a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDCHBGC">Example 2-85</a>).</p>
<p><span class="bold">Note:</span> This clause cannot be used when creating a standby database using <code class="codeph">DUPLICATE ... FOR STANDBY</code>.</p>
<p><span class="bold">Note:</span> You must not exclude <code class="codeph">SYS</code>-owned objects or tablespaces with rollback segments, nor tablespaces containing materialized views. The set of tablespaces to be duplicated must be self-contained.</p>
<p>If you must duplicate a database when some backups of the source database do not exist, then <code class="codeph">SKIP TABLESPACE</code> is required. If you do not specify <code class="codeph">SKIP TABLESPACE</code>, then RMAN attempts to duplicate the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>All data files in online tablespaces, whether or not the data files are online.</p>
</li>
<li>
<p>All tablespaces taken offline with an option <span class="italic">other than</span> <code class="codeph">NORMAL</code>. For example, RMAN attempts to duplicate tablespaces taken offline with the <code class="codeph">IMMEDIATE</code> option. You cannot duplicate <code class="codeph">OFFLINE NORMAL</code> tablespaces, although you can add these tablespaces manually after duplication.</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2273" headers="d41648e1634">
<p><code class="codeph">SKIP TABLESPACE</code> <span class="italic"><code class="codeph">pdb-name</code></span><code class="codeph">:</code><span class="italic"><code class="codeph">tablespace_name</code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e2273 d41648e1637">
<p>The name of the tablespace in a CDB. Multiple databases can have tablespaces with the same name, so a qualifier before the name uniquely identifies the tablespace. <span class="italic"><code class="codeph">pdb-name</code></span> is the name of a PDB.</p>
<p>See the previous description of <code class="codeph">SKIP TABLESPACE</code> for general information about excluding tablespaces from a duplicate database.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2299" headers="d41648e1634">
<p><code class="codeph" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDEAJCC">SPFILE</code></p>
</td>
<td class="cellalignment1053" headers="d41648e2299 d41648e1637">
<p>Copies the server parameter file from the source database to the duplicate database. No initialization parameters previously set in the duplicate database are used.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2307" headers="d41648e1634">
<p><code class="codeph">&nbsp;&nbsp;&nbsp;</code><span class="italic"><code class="codeph"><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDHAJGD">setParameter</a></code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e2307 d41648e1637">
<p>Sets the specified initialization parameters to the specified values. Refer to <span class="italic"><code class="codeph"><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDHAJGD">setParameter</a></code></span>.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2324" headers="d41648e1634"><code class="codeph">&nbsp;&nbsp;&nbsp;PARAMETER_VALUE_CONVERT</code> <span class="italic"><code class="codeph">string_pattern</code></span> <code class="codeph">&nbsp;&nbsp;&nbsp;[</code><span class="italic"><code class="codeph"><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDHAJGD">setParameter</a></code></span><code class="codeph">]</code></td>
<td class="cellalignment1053" headers="d41648e2324 d41648e1637">
<p>Replaces the first string with the second string in all matching initialization parameter values. Refer to the description of <code class="codeph">PARAMETER_VALUE_CONVERT</code> in <span class="italic"><code class="codeph"><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__I1011578">dupOptionList</a></code></span>.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2352" headers="d41648e1634">
<p><code class="codeph">TABLESPACE</code> <span class="italic"><code class="codeph">tablespace_name</code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e2352 d41648e1637">
<p>Specifies which tablespaces are included in the specified database.</p>
<p>Unlike <code class="codeph">SKIP TABLESPACE</code>, which specifies which tablespaces are <span class="italic">excluded</span> from the duplicate database, this option specifies which tablespaces are included and then skips the remaining tablespaces.</p>
<p><span class="bold">Note:</span> RMAN automatically includes the <code class="codeph">SYSTEM</code>, <code class="codeph">SYSAUX</code>, and undo tablespaces in the duplicate database. These tablespaces cannot be skipped and the set of tablespaces that you want to duplicate must be self-contained.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2382" headers="d41648e1634">
<p><code class="codeph">TABLESPACE</code> <span class="italic"><code class="codeph">pdb-name</code></span><code class="codeph">:</code><span class="italic"><code class="codeph">tablespace_name</code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e2382 d41648e1637">
<p>The name of the tablespace in a CDB. Multiple databases can have tablespaces with the same name. A qualifier before the name uniquely identifies the tablespace. <span class="italic"><code class="codeph">pdb-name</code></span> is the name of a PDB.</p>
<p>See the previous descriptions of <code class="codeph">TABLESPACE</code> and <code class="codeph">UNDO TABLESPACE</code> for general information about these parameters.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2410" headers="d41648e1634">
<p><code class="codeph">UNDO TABLESPACE</code> <span class="italic"><code class="codeph">tablespace_name</code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e2410 d41648e1637">
<p>Specifies the names of the tablespaces with undo segments. This option is only required when a subset of tablespaces are being duplicated with the <code class="codeph">SKIP TABLESPACE</code> and <code class="codeph">TABLESPACE</code> clauses. You must provide the list of tablespaces with undo segments in the following cases:</p>
<ul style="list-style-type: disc;">
<li>
<p>No connection to the target database or the recovery catalog</p>
</li>
<li>
<p>No connection to a recovery catalog, a connection to the target but the target database is not open.</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2435" headers="d41648e1634"><code class="codeph">TO&nbsp;RESTORE&nbsp;POINT</code> <span class="italic"><code class="codeph">restore_point_name</code></span></td>
<td class="cellalignment1053" headers="d41648e2435 d41648e1637">
<p>Specifies a restore point for backup-based duplication, with the SCN at which the restore point was created as the upper, inclusive limit. Because the limit is inclusive, RMAN selects only files that it can use to duplicate a database up to <span class="italic">and including</span> the corresponding SCN.</p>
<p><span class="bold">Note:</span> The same restrictions that apply to <span class="italic"><code class="codeph"><a href="rcmsubcl022.htm#GUID-6A6C502A-6E21-4673-9FC9-C075D1E2F97A">untilClause</a></code></span> also apply to <code class="codeph">TO RESTORE POINT</code>.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2462" headers="d41648e1634">
<p><span class="italic"><code class="codeph"><a href="rcmsubcl022.htm#GUID-6A6C502A-6E21-4673-9FC9-C075D1E2F97A">untilClause</a></code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e2462 d41648e1637">
<p><a id="d41648e2471" class="indexterm-anchor"></a><a id="d41648e2473" class="indexterm-anchor"></a><a id="d41648e2475" class="indexterm-anchor"></a><a id="d41648e2479" class="indexterm-anchor"></a>Sets the end time, SCN, or log sequence number for point-in-time recovery in backup-based duplication (see <a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDCHBGC">Example 2-85</a>). The <code class="codeph">UNTIL</code> clause is not supported in active database duplication.</p>
<p>You can achieve the same result by running <code class="codeph"><a href="rcmsynta2014.htm#GUID-BC501B5C-4CD0-485D-AA18-27E2894024C3">SET</a></code> <code class="codeph">UNTIL</code> before the <code class="codeph">DUPLICATE</code> command. If you specify the <code class="codeph">UNTIL</code> clause for duplication, then the following restrictions apply:</p>
<ul style="list-style-type: disc;">
<li>
<p>RMAN determines whether to use <a id="d41648e2509" class="indexterm-anchor"></a><code class="codeph">NOREDO</code> based on the current state of the database. If the database was in an archiving mode at the specified <code class="codeph">UNTIL</code> time or SCN that is different from the current archiving mode, then RMAN does not use <code class="codeph">NOREDO</code>.</p>
</li>
<li>
<p>The end point for a <code class="codeph">DUPLICATE</code> command cannot be before the SCN of the most recent <code class="codeph">ALTER DATABASE OPEN RESETLOGS</code>. Duplication with a connection to a target does not support previous database incarnations. However, you can specify previous incarnations if you are duplicating without a connection to a target database.</p>
</li>
<li>
<p>You cannot recover the duplicate database to the current point in time, that is, the most recent SCN. RMAN recovers the duplicate database up to or before the most recent available archived log, but cannot recover into the online redo logs.</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2535" headers="d41648e1634">
<p><code class="codeph">USING BACKUPSET</code></p>
</td>
<td class="cellalignment1053" headers="d41648e2535 d41648e1637">
<p>Performs active database duplication by copying all or a subset of data from the source database to the destination database using backup sets.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2543" headers="d41648e1634">
<p><code class="codeph">USING COMPRESSED BACKUPSET</code></p>
</td>
<td class="cellalignment1053" headers="d41648e2543 d41648e1637">
<p>Enables binary compression of the data transfer from the source database to the auxiliary database, thereby reducing the network bandwidth consumption.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDHAJGD"><span class="bold"><span class="italic">setParameter</span></span></p>
<p>This subclause specifies server parameter file values.</p>
<div class="tblformalwide" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__GUID-98AF7A1E-6C36-4A14-86FD-6C296749088B">
<table class="cellalignment1044" summary="Describes DUPLICATE command setParameter parameters">
<thead>
<tr class="cellalignment1038">
<th class="cellalignment1045" id="d41648e2564">Syntax Element</th>
<th class="cellalignment1052" id="d41648e2567">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2572" headers="d41648e2564">
<p><code class="codeph">SET</code> <span class="italic"><code class="codeph">identifier&nbsp;string</code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e2572 d41648e2567">
<p>Sets the specified initialization parameters to the specified values (see <a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDCBDHI">Example 2-83</a>). You can use <code class="codeph">SET</code> to adjust for differences in memory, turn off replication options, and set other options for the duplicate database.</p>
<p>This <code class="codeph">SET</code> functionality is equivalent to pausing the duplication after restoring the server parameter file and issuing <code class="codeph">ALTER SYSTEM SET</code> statements to change the initialization parameter file.</p>
<p>RMAN processes <code class="codeph">SET</code> after <a id="d41648e2601" class="indexterm-anchor"></a><code class="codeph">PARAMETER_VALUE_CONVERT</code>. If <code class="codeph">PARAMETER_VALUE_CONVERT</code> sets the file name specified by a parameter, and if <code class="codeph">SET</code> sets the file name specified by the same parameter, then the <code class="codeph">SET</code> value overrides the <code class="codeph">PARAMETER_VALUE_CONVERT</code> setting.</p>
<p><span class="bold">Note:</span> If <a id="d41648e2625" class="indexterm-anchor"></a><a id="d41648e2627" class="indexterm-anchor"></a><code class="codeph">DB_FILE_NAME_CONVERT</code> is specified on the <code class="codeph">DUPLICATE</code> command, then its file name settings override competing settings specified by <code class="codeph">SPFILE SET</code>.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2639" headers="d41648e2564">
<p><code class="codeph">&nbsp;&nbsp;&nbsp;COMMENT</code> <code class="codeph">&#39;</code><span class="italic"><code class="codeph">string</code></span><code class="codeph">&#39;</code></p>
</td>
<td class="cellalignment1053" headers="d41648e2639 d41648e2567">
<p>Specifies an optional comment for the parameter setting.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2655" headers="d41648e2564">
<p><code class="codeph">RESET</code> <span class="italic"><code class="codeph">identifier&nbsp;string</code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e2655 d41648e2567">
<p>Deletes specified initialization parameters from the parameter file. You can use <code class="codeph">RESET</code> to remove unneeded initialization parameters.</p>
<p>This <code class="codeph">RESET</code> functionality is equivalent to pausing the duplication after restoring the server parameter file and issuing <code class="codeph">ALTER SYSTEM RESET</code> statements to change the initialization parameter file.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__BGBIHEHG"><span class="bold"><span class="italic">logSpec</span></span></p>
<p><a id="d41648e2683" class="indexterm-anchor"></a>This subclause specifies the online redo logs when creating a duplicate database that is not a standby database. Refer to the <span class="italic"><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDIGIJD">logSpec::=</a></span> diagram for the syntax diagram.</p>
<p>If you do not specify <code class="codeph">LOGFILE</code>, then RMAN first checks whether any of the following initialization parameters are set: <code class="codeph">LOG_FILE_NAME_CONVERT,DB_CREATE_FILE_DEST, DB_RECOVERY_FILE_DEST</code> or <code class="codeph">DB_CREATE_ONLINE_LOG_DEST_n</code>. If these parameters are set, RMAN directs duplicate database online redo log files to Oracle managed storage based on these parameter settings. If none if these initialization parameters are set, then RMAN uses the original redo log file names of the source database for redo log files of the duplicate database. You must specify the <a id="d41648e2703" class="indexterm-anchor"></a><code class="codeph">NOFILENAMECHECK</code> option in this case.</p>
<div class="tblformalwide" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__GUID-9819993D-05D3-4EF6-8D22-A3035136E10A">
<table class="cellalignment1044" summary="Describes DUPLICATE command logSpec parameters">
<thead>
<tr class="cellalignment1038">
<th class="cellalignment1045" id="d41648e2716">Syntax Element</th>
<th class="cellalignment1052" id="d41648e2719">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2724" headers="d41648e2716">
<p><code class="codeph">&#39;</code><span class="italic"><code class="codeph">filename</code></span><code class="codeph">&#39;</code> <code class="codeph">SIZE&nbsp;</code><span class="italic"><code class="codeph">sizeSpec</code></span></p>
</td>
<td class="cellalignment1053" headers="d41648e2724 d41648e2719">
<p>Specifies the file name of the online redo log member and the size of the file in kilobytes (<code class="codeph">K</code>) or megabytes (<code class="codeph">M</code>). The default is in bytes.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2748" headers="d41648e2716">
<p><code class="codeph">&nbsp;&nbsp;&nbsp;REUSE</code></p>
</td>
<td class="cellalignment1053" headers="d41648e2748 d41648e2719">
<p>Allows the database to reuse an existing file. If the file exists, then the database verifies that its size matches the value of the <code class="codeph">SIZE</code> parameter. If the file does not exist, then it is created.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2759" headers="d41648e2716"><code class="codeph">GROUP</code> <span class="italic"><code class="codeph">integer</code></span> <code class="codeph">(&#39;</code><span class="italic"><code class="codeph">filename</code></span><code class="codeph">&#39;, ...)</code> <code class="codeph">SIZE</code>&nbsp;<span class="italic"><code class="codeph">sizeSpec</code></span></td>
<td class="cellalignment1053" headers="d41648e2759 d41648e2719">
<p>Specifies the group containing the online redo log members, the file name of the online redo log member, and the size of the file in kilobytes (<code class="codeph">K</code>) or megabytes (<code class="codeph">M</code>). The default is in bytes.</p>
</td>
</tr>
<tr class="cellalignment1038">
<td class="cellalignment1047" id="d41648e2791" headers="d41648e2716">
<p><code class="codeph">&nbsp;&nbsp;&nbsp;REUSE</code></p>
</td>
<td class="cellalignment1053" headers="d41648e2791 d41648e2719">
<p>Allows the database to reuse an existing log.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
<!-- class="section" -->
<div class="section" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__I104404">
<p class="subhead1">Examples</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDJGCFC">
<p class="titleinexample">Example 2-82 Duplicating from an Active Database to a Host with the Same Directory Structure</p>
<p>Assume that you want to create a test database from database <code class="codeph">prod1</code> on a new host. The new host has the same directory structure as the source host, so the files in the duplicate database can use the same names as the files in the source database. You want to create the database without using RMAN backups and allow <code class="codeph">prod1</code> to remain open during the duplication.</p>
<p>If <code class="codeph">prod1</code> uses a server parameter file, then you can create an initialization parameter file on the destination host that contains only the <code class="codeph">DB_NAME</code> parameter set to a new value and the <code class="codeph">DB_DOMAIN</code> parameter set to the appropriate domain. Setting <code class="codeph">DB_DOMAIN</code> enables you to connect with RMAN to the default database service. Before starting the auxiliary instance, create a password file that has the same <code class="codeph">SYS</code> and <code class="codeph">SYSBACKUP</code> password as the source database. Afterward, start the auxiliary instance using an spfile, if available. If you start the auxiliary instance with a pfile, then RMAN creates an spfile in the default location, possibly overwriting any spfile residing there.</p>
<p>By default, RMAN does not duplicate the password file when creating a duplicate database that is not a standby database. The <code class="codeph">PASSWORD FILE</code> option copies the password file to the destination host. If you want the duplicate database to contain all the passwords available on your source database, then use the <code class="codeph">PASSWORD FILE</code> option.</p>
<p>You do not need to change your source database channel configuration or configure auxiliary channels. Start the RMAN client, connect to the source and auxiliary database instances with net service names, and duplicate the database as follows:</p>
<pre dir="ltr">% rman
RMAN&gt; CONNECT TARGET &#34;sbu@prod1 AS SYSBACKUP&#34;

target database Password: <span class="italic">password</span>
connected to target database: PROD1 (DBID=39525561)

RMAN&gt; CONNECT AUXILIARY &#34;sbu@dup1 AS SYSBACKUP&#34;

auxiliary database Password: <span class="italic">password</span>
connected to auxiliary database: DUP1 (not mounted)

RMAN&gt; DUPLICATE TARGET DATABASE TO dup1
2&gt; FROM ACTIVE DATABASE
3&gt; NOFILENAMECHECK
4&gt; PASSWORD FILE
5&gt; SPFILE;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDCBDHI">
<p class="titleinexample">Example 2-83 Copying the Server Parameter File in Active Database Duplication</p>
<p>Assume that you want to create a standby database from database <code class="codeph">prod1</code> on a new host. The destination host has a different directory structure from the source host, so the standby database files are stored in <code class="codeph">/disk2</code> rather than <code class="codeph">/disk1</code>. You want to create the standby database without using RMAN backups and let <code class="codeph">prod1</code> remain open during the duplication.</p>
<p>Your first step is to create a minimal initialization parameter file for the standby database and then start the standby instance. This parameter file is minimal because when you use the <code class="codeph"><a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDEAJCC">SPFILE</a></code> option, RMAN copies the server parameter file to the new host and sets various parameters to the new values provided.</p>
<p>Start the RMAN client, <code class="codeph"><a href="rcmsynta010.htm#GUID-64ECF1B8-4F70-413E-BEBE-1D5E8CD48B67">CONNECT</a></code> to the source database as <code class="codeph">TARGET</code> and connect to the auxiliary instance. Allocate multiple channels to the target instance and a channel to the auxiliary instance as shown here:</p>
<pre dir="ltr">ALLOCATE CHANNEL tgt10 TYPE DISK; 
ALLOCATE CHANNEL tgt20 TYPE DISK; 
ALLOCATE CHANNEL tgt30 TYPE DISK; 
ALLOCATE CHANNEL tgt40 TYPE DISK; 
ALLOCATE AUXILIARY CHANNEL dup1 TYPE DISK;
</pre>
<p>You can then enter the following command:</p>
<pre dir="ltr">DUPLICATE TARGET DATABASE
  FOR STANDBY
  FROM ACTIVE DATABASE
  PASSWORD FILE
  SPFILE 
    PARAMETER_VALUE_CONVERT &#39;/disk1&#39;, &#39;/disk2&#39;
    SET DB_FILE_NAME_CONVERT &#39;/disk1&#39;,&#39;/disk2&#39;
    SET LOG_FILE_NAME_CONVERT &#39;/disk1&#39;,&#39;/disk2&#39;
    SET DB_UNIQUE_NAME &#39;dup1&#39;
    SET SGA_MAX_SIZE 200M
    SET SGA_TARGET 125M;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__GUID-53D10CD6-73A4-4EDD-A221-84F99598104F">
<p class="titleinexample">Example 2-84 Duplicating a Database Without a Target Connection to a Host with the Same Directory Structure</p>
<p>Assume that you want to duplicate source database <code class="codeph">prod</code> using backups and do not want to connect RMAN as <code class="codeph">TARGET</code> to this database because it is shut down for maintenance. A description of the environment follows:</p>
<ul style="list-style-type: disc;">
<li>
<p>The source and destination hosts have identical directory structures. The data file and online redo log names in the duplicate database are identical to the names in the source database.</p>
</li>
<li>
<p>The same number of online redo log files are used in the duplicate database.</p>
</li>
<li>
<p>A recovery catalog is available. The source database name <code class="codeph">prod</code> is unique in the recovery catalog.</p>
</li>
<li>
<p>Auxiliary channels have been configured with the <code class="codeph">CONFIGURE CHANNEL</code> command.</p>
</li>
</ul>
<p>The following commands create a duplicate database named <code class="codeph">DUPDB</code>:</p>
<pre dir="ltr">% rman 

RMAN&gt; <span class="bold">CONNECT CATALOG rco@catdb;</span>
 
recovery catalog database Password: <span class="italic"><span class="bold">password</span></span>
connected to recovery catalog database

RMAN&gt; <span class="bold">CONNECT AUXILIARY &#34;sbu@dupdb AS SYSBACKUP&#34;;</span>

auxiliary database Password: <span class="italic"><span class="bold">password</span></span>
connected to auxiliary database: DUPDB (not mounted)

RMAN&gt; <span class="bold">DUPLICATE DATABASE &#39;PROD&#39; TO &#39;DUPDB&#39; NOFILENAMECHECK;</span>
</pre>
<p>Assume a different scenario in which the database name <code class="codeph">prod</code> is not unique in the recovery catalog. The following <code class="codeph">DUPLICATE</code> command uses the <code class="codeph">DBID</code> parameter to uniquely identify the source database:</p>
<pre dir="ltr">RMAN&gt; <span class="bold">DUPLICATE DATABASE &#39;PROD&#39; DBID 39525561 TO &#39;DUPDB&#39; NOFILENAMECHECK;</span>
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDCHBGC">
<p class="titleinexample">Example 2-85 Setting New File Names in the DUPLICATE Command</p>
<p>Assume that you want to use tape backups to duplicate the source database <code class="codeph">prod</code> on <code class="codeph">srchost</code> to <code class="codeph">newdb</code> on <code class="codeph">desthost</code>.</p>
<p>In this scenario, the source database does not use a server parameter file. You create a text-based initialization parameter file on <code class="codeph">desthost</code> and use it to start the database instance. Thus, backup-based duplication must use a target connection (see <a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__BABEDFJI" title="Requirements for Two Modes of Backup-Based Duplication">Table 2-6</a>).</p>
<p>When executing <code class="codeph">DUPLICATE</code> on <code class="codeph">desthost</code>, you must use the <code class="codeph">PFILE</code> parameter to specify the location of the initialization parameter file. You must use the RMAN client on the same host as the initialization parameter file for the duplicate database.</p>
<p>You do not want the tablespaces <code class="codeph">example</code> and <code class="codeph">history</code> to be included in the duplicate database, so you specify <code class="codeph">DUPLICATE ... SKIP TABLESPACE</code> for these tablespaces. Also, you want the duplicate database to be in the state that the production database was in 24 hours ago, so you use <code class="codeph">DUPLICATE ... UNTIL TIME</code>.</p>
<p>This example assumes that the data files of the source database are on <code class="codeph">srchost</code> in directory <code class="codeph">/h1/oracle/dbs/trgt</code>. You intend to duplicate the data files to the directory <code class="codeph">/h2/oracle/oradata/newdb</code>, so you specify <code class="codeph">DUPLICATE ... DB_FILE_NAME_CONVERT</code> to generate the names for the duplicate data files. You use <code class="codeph">DUPLICATE ... LOGFILE</code> to specify names for the online redo log files in the duplicate database.</p>
<p>Start the RMAN client on <code class="codeph">desthost</code>, <code class="codeph"><a href="rcmsynta010.htm#GUID-64ECF1B8-4F70-413E-BEBE-1D5E8CD48B67">CONNECT</a></code> to the source database as <code class="codeph">TARGET</code>, and connect to the auxiliary instance. You can then enter the following <code class="codeph">RUN</code> command:</p>
<pre dir="ltr">RUN
{  
  ALLOCATE AUXILIARY CHANNEL newdb DEVICE TYPE sbt; 
  DUPLICATE TARGET DATABASE TO newdb
    PFILE ?/dbs/initNEWDB.ora
    UNTIL TIME &#39;SYSDATE-1&#39;  # specifies incomplete recovery
    SKIP TABLESPACE example, history   # skip desired tablespaces
    DB_FILE_NAME_CONVERT (&#39;/h1/oracle/dbs/trgt/&#39;,&#39;/h2/oracle/oradata/newdb/&#39;)
    LOGFILE
      GROUP 1 (&#39;/h2/oradata/newdb/redo01_1.f&#39;,
               &#39;/h2/oradata/newdb/redo01_2.f&#39;) SIZE 4M,
      GROUP 2 (&#39;/h2/oradata/newdb/redo02_1.f&#39;,
               &#39;/h2/oradata/newdb/redo02_2.f&#39;) SIZE 4M,
      GROUP 3 (&#39;/h2/oradata/newdb/redo03_1.f&#39;,
               &#39;/h2/oradata/newdb/redo03_2.f&#39;) SIZE 4M REUSE;
}
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__BGBGEHCG">
<p class="titleinexample">Example 2-86 Using SET NEWNAME FOR DATABASE to Name Duplicate Files</p>
<p>In this scenario, you intend to use backup-based duplication without a target connection.</p>
<p>The source database <code class="codeph">prod</code> contains eight data files spread out over multiple directories. The data files are not Oracle Managed Files. You want to duplicate the source database to <code class="codeph">dupdb</code> on destination host <code class="codeph">desthost</code>.</p>
<p>In this scenario, <code class="codeph">srchost</code> and <code class="codeph">desthost</code> have different directory structures. You want to store the data files in <code class="codeph">desthost</code> in the <code class="codeph">/oradata1</code> subdirectory, so you use <code class="codeph">SET NEWNAME FOR DATABASE</code> to specify the file names stripped of directory paths. For example, if a source data file has the name <code class="codeph">&#39;/oradata/prod/financial.dbf&#39;</code>, then <code class="codeph">%b</code> results in <code class="codeph">&#39;financial.dbf&#39;</code>.</p>
<p>The source database does not use a server parameter file, so you cannot use the <code class="codeph">SPFILE</code> technique to specify names for the duplicate data files. You decide to use the <code class="codeph">SET NEWNAME DATABASE</code> command because you want all duplicate data files in the same directory on the destination host.</p>
<p>You want to create two online redo log groups, each with two members of size 200 KB, in the directory <code class="codeph">/duplogs</code> on the destination host. Assume that <code class="codeph">srchost</code> and <code class="codeph">desthost</code> cannot mount each other&#39;s file systems by any means such as NFS.</p>
<p>You have disk copies or backup sets stored on disk for all the data files and archived redo log files in the source database, and you have manually copied them to <code class="codeph">desthost</code> with an operating system utility. These backups and copies exist in the same location on <code class="codeph">desthost</code> as they do in <code class="codeph">srchost</code>.</p>
<p>You use an operating system utility to copy the initialization parameter file from <code class="codeph">srchost</code> to an appropriate location in <code class="codeph">desthost</code>. You have reset all initialization parameters that end in <code class="codeph">_DEST</code> and specify a path name. You do not set <code class="codeph">DB_FILE_NAME_CONVERT</code> and <code class="codeph">LOG_FILE_NAME_CONVERT</code> because you are specifying names for data files and online logs in the <code class="codeph">RUN</code> command itself. The auxiliary instance uses a server-side initialization parameter file in the default location so the <code class="codeph">PFILE</code> parameter is not necessary on the <code class="codeph">DUPLICATE</code> command.</p>
<p>The following sample script creates the duplicate database. A <code class="codeph">RUN</code> command is necessary because you can only execute <code class="codeph">SET NEWNAME</code> within <code class="codeph">RUN</code>.</p>
<pre dir="ltr">RUN
{
  SET NEWNAME FOR DATABASE TO &#39;/oradata1/%b&#39;; 
  DUPLICATE TARGET DATABASE TO dupdb
    LOGFILE
      GROUP 1 (&#39;/duplogs/redo01a.log&#39;, 
               &#39;/duplogs/redo01b.log&#39;) SIZE 4M REUSE,
      GROUP 2 (&#39;/duplogs/redo02a.log&#39;,
               &#39;/duplogs/redo02b.log&#39;) SIZE 4M REUSE;
}
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__BGBFADEH">
<p class="titleinexample">Example 2-87 Using SET NEWNAME FOR DATAFILE and SET NEWNAME FOR TABLESPACE to Name Duplicate Files</p>
<p>In this scenario, you intend to duplicate database by using backup-based duplication.</p>
<p>Assume that the source database <code class="codeph">PROD</code> is on <code class="codeph">SRCHOST</code> and contains nine data files, which are spread out over multiple directories. You want to duplicate the source database to database <code class="codeph">DUPDB</code> on remote host <code class="codeph">DESTHOST</code>. The <code class="codeph">DUPDB</code> database excludes tablespace <code class="codeph">TOOLS</code>, but keeps all of the other tablespaces.</p>
<p>The source database does not use a server parameter file, so you cannot use the <code class="codeph">SPFILE</code> technique to specify names for the duplicate data files. You decide to use <code class="codeph">SET NEWNAME</code> commands to specify the file names because the duplicate data files will be spread across several directories.</p>
<p>In this scenario, <code class="codeph">srchost</code> and <code class="codeph">desthost</code> have different directory structures. You want to store the data files in <code class="codeph">desthost</code> in the <code class="codeph">/oradata1</code> through <code class="codeph">/oradata7</code> subdirectories. You want to place each data file in a different directory, except the <code class="codeph">USERS</code> tablespace, which contains two data files that you intend to duplicate to <code class="codeph">/oradata7</code>.</p>
<p>You want to create two online redo log groups, each with two members of size 200 KB, in the directory <code class="codeph">/duplogs</code> on the destination host. Assume that <code class="codeph">srchost</code> and <code class="codeph">desthost</code> cannot mount each other&#39;s file systems by any means such as NFS.</p>
<p>You have disk copies or backup sets stored on disk for all the data files and archived redo log files in the source database, and you have manually copied them to <code class="codeph">desthost</code> with an operating system utility. These backups and copies exist in the same location on <code class="codeph">desthost</code> as they do in <code class="codeph">srchost</code>.</p>
<p>You use an operating system utility to copy the initialization parameter file from <code class="codeph">srchost</code> to an appropriate location in <code class="codeph">desthost</code>. You have reset all initialization parameters that end in <code class="codeph">_DEST</code> and specify a path name. You do not set <code class="codeph">DB_FILE_NAME_CONVERT</code> and <code class="codeph">LOG_FILE_NAME_CONVERT</code> because you are specifying names for data files and online logs in the <code class="codeph">RUN</code> command itself. The auxiliary instance uses a server-side initialization parameter file in the default location so the <code class="codeph">PFILE</code> parameter is not necessary on the <code class="codeph">DUPLICATE</code> command.</p>
<p>The following sample scripts creates the duplicate database. A <code class="codeph">RUN</code> command is necessary because you can only execute <code class="codeph">SET NEWNAME</code> within <code class="codeph">RUN</code>.</p>
<pre dir="ltr">RUN
{
  SET NEWNAME FOR DATAFILE 1 TO &#39;/oradata1/system01.dbf&#39;; 
  SET NEWNAME FOR DATAFILE 2 TO &#39;/oradata2/undotbs01.dbf&#39;;
  SET NEWNAME FOR DATAFILE 3 TO &#39;/oradata3/cwmlite01.dbf&#39;; 
  SET NEWNAME FOR DATAFILE 4 TO &#39;/oradata4/drsys01&#39;; 
  SET NEWNAME FOR DATAFILE 5 TO &#39;/oradata5/example01.dbf&#39;; 
  # because the users tablespace contains 2 data files, the following command
  # generates unique names for both data files, placing them in /oradata7
  SET NEWNAME FOR TABLESPACE users TO &#39;/oradata7/users%b.dbf&#39;;
  DUPLICATE TARGET DATABASE TO dupdb
    SKIP TABLESPACE tools
    LOGFILE
      GROUP 1 (&#39;/duplogs/redo01a.log&#39;, 
               &#39;/duplogs/redo01b.log&#39;) SIZE 4M REUSE, 
      GROUP 2 (&#39;/duplogs/redo02a.log&#39;, 
               &#39;/duplogs/redo02b.log&#39;) SIZE 4M REUSE;
}
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__BGBCEBDI">
<p class="titleinexample">Example 2-88 Using SET NEWNAME FOR DATAFILE to Name Oracle-Managed Files</p>
<p>There are two ways to store specific data files or temp files in an Oracle-managed files destination that is independent of the locations of the rest of the database files.</p>
<ol>
<li>
<p>Set the parameter <code class="codeph">DB_CREATE_FILE_DEST</code> in the initialization parameter file of the auxiliary instance to the desired location</p>
</li>
<li>
<p>Set the initialization parameters <code class="codeph">DB_CREATE_FILE_DEST</code> and <code class="codeph">DB_FILE_NAME_CONVERT</code>. At this point, you can use the <code class="codeph">SET NEWNAME</code> command for those data files that you do not want to be converted by <code class="codeph">DB_FILE_NAME_CONVERT</code>.</p>
</li>
</ol>
<p>The specified data files or temp files are created with Oracle-managed file names in the location specified by <code class="codeph">DB_CREATE_FILE_DEST</code>.</p>
<p>As shown in the following sample script, you can also use <code class="codeph">SET</code> <code class="codeph">NEWNAME</code> to direct individual data files or temp files to a specific ASM disk group.</p>
<pre dir="ltr">RUN
{
   SET NEWNAME FOR DATAFILE 1 TO &#34;+DGROUP1&#34;;
   SET NEWNAME FOR DATAFILE 2 TO &#34;+DGROUP2&#34;;
   .
   .
   .
   DUPLICATE TARGET DATABASE 
     TO dupdb
     FROM ACTIVE DATABASE
     SPFILE SET DB_CREATE_FILE_DEST +DGROUP3;
}
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__GUID-A48906FB-3F3E-42AF-A668-20C28FDD6FAB">
<p class="titleinexample">Example 2-89 Using CONFIGURE AUXNAME to Name Duplicate Files</p>
<p><a id="d41648e3326" class="indexterm-anchor"></a>This section assumes the same circumstances described in <a href="rcmsynta020.htm#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__BGBFADEH">Example 2-87</a>. This example is a variation that uses <code class="codeph">CONFIGURE AUXNAME</code> instead of <code class="codeph">SET NEWNAME</code> to specify the new data file names. These new file names are recorded in the control file and used every time you perform the duplication in the future.</p>
<p>This example also uses automatic channels and a client-side initialization parameter file for the database duplication, and uses the <code class="codeph">LOGFILE</code> clause to specify names and sizes for the online redo logs. In this case the <code class="codeph">RUN</code> command is not necessary because you are not using <code class="codeph">SET NEWNAME</code>.</p>
<pre dir="ltr">CONFIGURE AUXNAME FOR DATAFILE 1 TO &#39;/oradata1/system01.dbf&#39;; 
CONFIGURE AUXNAME FOR DATAFILE 2 TO &#39;/oradata2/undotbs01.dbf&#39;;
CONFIGURE AUXNAME FOR DATAFILE 3 TO &#39;/oradata3/cwmlite01.dbf&#39;; 
CONFIGURE AUXNAME FOR DATAFILE 4 TO &#39;/oradata4/drsys01&#39;; 
CONFIGURE AUXNAME FOR DATAFILE 5 TO &#39;/oradata5/example01.dbf&#39;; 
CONFIGURE AUXNAME FOR DATAFILE 6 TO &#39;/oradata6/indx01.dbf&#39;;
DUPLICATE TARGET DATABASE
  TO dupdb
  SKIP TABLESPACE tools
  LOGFILE
    GROUP 1 (&#39;/duplogs/redo01a.log&#39;,
             &#39;/duplogs/redo01b.log&#39;) SIZE 4M REUSE,
    GROUP 2 (&#39;/duplogs/redo02a.log&#39;,
             &#39;/duplogs/redo02b.log&#39;) SIZE 4M REUSE;
</pre>
<p>RMAN uses all incremental backups, archived redo log backups, and archived redo log files to perform incomplete recovery and then opens the database with the <code class="codeph">RESETLOGS</code> option to create the online redo logs.</p>
<p>After the duplication is complete, you can clear the configured auxiliary names for the data files in the duplicate database, so that they are not overwritten by future operations. For example, enter the following commands:</p>
<pre dir="ltr">CONFIGURE AUXNAME FOR DATAFILE 1 CLEAR; 
CONFIGURE AUXNAME FOR DATAFILE 2 CLEAR; 
CONFIGURE AUXNAME FOR DATAFILE 3 CLEAR;
CONFIGURE AUXNAME FOR DATAFILE 4 CLEAR;
CONFIGURE AUXNAME FOR DATAFILE 5 CLEAR;
CONFIGURE AUXNAME FOR DATAFILE 6 CLEAR;
</pre>
<p>Alternatively, you may want to periodically synchronize a duplicate database with the original database that was duplicated. In this case, you can run the <code class="codeph">DUPLICATE</code> command again, essentially re-creating the duplicate database. This technique requires making complete copies of the data files of the duplicate database. Run the following script whenever you want to synchronize the duplicate with the source database. For example, you might run the script daily or weekly.</p>
<pre dir="ltr">DUPLICATE TARGET DATABASE TO dupdb
SKIP TABLESPACE tools
  LOGFILE
    GROUP 1 (&#39;/duplogs/redo01a.log&#39;,
             &#39;/duplogs/redo01b.log&#39;) SIZE 4M REUSE,
    GROUP 2 (&#39;/duplogs/redo02a.log&#39;,
             &#39;/duplogs/redo02b.log&#39;) SIZE 4M REUSE;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__GUID-148EFBC3-B1C4-4FD7-B06A-A0D8D99F14DF">
<p class="titleinexample">Example 2-90 Creating a Standby Database with the Same Directory Structure</p>
<p>Assume that you want to use RMAN backups to create a standby database on a remote host with the same directory structure as the source host. The source database is called <code class="codeph">prod1</code> and is the primary database in the Data Guard environment.</p>
<p>First, start the RMAN client, <code class="codeph"><a href="rcmsynta010.htm#GUID-64ECF1B8-4F70-413E-BEBE-1D5E8CD48B67">CONNECT</a></code> to the source database <code class="codeph">prod1</code> as <code class="codeph">TARGET</code>, and connect to the auxiliary instance. You can then <code class="codeph"><a href="rcmsynta009.htm#GUID-B5094E73-C26C-4FED-AE39-8C2E9540050A">CONFIGURE</a></code> the default device type to <code class="codeph">sbt</code> for a standby database with the <code class="codeph">DB_UNIQUE_NAME</code> of <code class="codeph">standby1</code>:</p>
<pre dir="ltr">CONFIGURE DEFAULT DEVICE TYPE sbt FOR DB_UNIQUE_NAME standby1;
CONFIGURE DEVICE TYPE sbt PARALLELISM 2 FOR DB_UNIQUE_NAME standby1;
</pre>
<p>Assume all backups needed to create the standby database are on tape. In the standby database initialization parameter file, you set <code class="codeph">DB_UNIQUE_NAME</code> to <code class="codeph">standby1</code>.</p>
<p>The default initialization parameter file location is in use on the standby database. After starting the standby instance <code class="codeph">NOMOUNT</code>, you start the RMAN client, <code class="codeph"><a href="rcmsynta010.htm#GUID-64ECF1B8-4F70-413E-BEBE-1D5E8CD48B67">CONNECT</a></code> to the source database as <code class="codeph">TARGET</code>, and connect to the auxiliary instance and recovery catalog. You run the following <code class="codeph">DUPLICATE</code> command, specifying the <code class="codeph">NOFILENAMECHECK</code> option because the standby and primary data files and online redo log files have the same names:</p>
<pre dir="ltr">DUPLICATE TARGET DATABASE FOR STANDBY
  NOFILENAMECHECK;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__CHDDFDGH">
<p class="titleinexample">Example 2-91 Creating a Standby Database in OMF and ASM</p>
<p><a id="d41648e3441" class="indexterm-anchor"></a><a id="d41648e3445" class="indexterm-anchor"></a>Assume that you want to use RMAN backups to create a standby database on a host that uses OMF and ASM. The source database is called <code class="codeph">prod1</code> and is the primary database in the Data Guard environment.</p>
<p>First, start the RMAN client, <code class="codeph"><a href="rcmsynta010.htm#GUID-64ECF1B8-4F70-413E-BEBE-1D5E8CD48B67">CONNECT</a></code> to database <code class="codeph">prod1</code> as <code class="codeph">TARGET</code>, and connect to the recovery catalog. Run the following commands to <code class="codeph"><a href="rcmsynta009.htm#GUID-B5094E73-C26C-4FED-AE39-8C2E9540050A">CONFIGURE</a></code> the default device type to <code class="codeph">sbt</code> for a standby database with the <code class="codeph">DB_UNIQUE_NAME</code> of <code class="codeph">standby1</code> and the net service name <code class="codeph">sby1</code>.</p>
<pre dir="ltr">CONFIGURE CONNECT IDENTIFIER &#34;sby1&#34; FOR DB_UNIQUE_NAME standby1;
CONFIGURE DEFAULT DEVICE TYPE TO sbt FOR DB_UNIQUE_NAME standby1;
CONFIGURE DEVICE TYPE sbt PARALLELISM 2 FOR DB_UNIQUE_NAME standby1;
</pre>
<p>Assume all backups needed to create the standby database are stored on tape. You set the following parameters in the initialization parameter file for database <code class="codeph">standby1</code>:</p>
<ul style="list-style-type: disc;">
<li>
<p>Set <code class="codeph">DB_UNIQUE_NAME</code> to the value <code class="codeph">standby1</code>.</p>
</li>
<li>
<p>Set <code class="codeph">DB_CREATE_FILE_DEST</code> and <code class="codeph">DB_RECOVERY_FILE_DEST</code> to the desired ASM disk groups on the standby host. For example, set <code class="codeph">DB_CREATE_FILE_DEST</code> to <code class="codeph">+DATAFILE</code> and <code class="codeph">DB_RECOVERY_FILE_DEST</code> to <code class="codeph">+FLASH_REC_AREA</code>.</p>
</li>
</ul>
<p>Ensure that the standby instance is in <code class="codeph">NOMOUNT</code> mode. Start the RMAN client, <code class="codeph"><a href="rcmsynta010.htm#GUID-64ECF1B8-4F70-413E-BEBE-1D5E8CD48B67">CONNECT</a></code> to database <code class="codeph">prod1</code> as <code class="codeph">TARGET</code>, connect to the <code class="codeph">standby1</code> instance as <code class="codeph">AUXILIARY</code>, and connect to the recovery catalog. Enter the following command to create the standby database:</p>
<pre dir="ltr">DUPLICATE TARGET DATABASE FOR STANDBY;
</pre>
<p>RMAN automatically generates new OMF/ASM data file names for the restored data files.</p>
</div>
<!-- class="example" -->
<div class="example" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__GUID-03A90CCC-D820-40DE-8E92-CFF69A24F5E2">
<p class="titleinexample">Example 2-92 Duplicating a Database Without Connection to Target Database and Recovery Catalog</p>
<p>In this example, all the necessary backups of data files, controlfile and archived logs of database <code class="codeph">prod</code> can be accessed from the location: <code class="codeph">/net/prod/backups</code>. This location is where only backups of database <code class="codeph">prod</code> reside. The only connection is to the new instance as <code class="codeph">AUXILIARY</code>.</p>
<p>Enter the following command to create a test database when there is no connection to the recovery catalog or target database:</p>
<pre dir="ltr">DUPLICATE DATABASE TO &#39;TEST&#39; BACKUP LOCATION &#39;/net/prod/backups&#39; NOFILENAMECHECK;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__GUID-D370FB02-059B-4B18-8D07-E521DA73B688">
<p class="titleinexample">Example 2-93 Selecting a Specific Database When Duplicating Without Connection to Target Database and Recovery Catalog</p>
<p>In this example, <code class="codeph">/backups</code> contains backups from several databases, including more than two databases with the name <code class="codeph">PROD</code>. In this case, you must specify the <code class="codeph">DBNAME</code> and the <code class="codeph">DBID</code> of the database to duplicate. The only connection is to the auxiliary instance.</p>
<pre dir="ltr">DUPLICATE DATABASE &#39;PROD&#39; dbid 8675309 to &#39;TEST&#39;
  UNTIL TIME &#34;to_date(&#39;11/01/2013&#39;, &#39;MM/DD/YYYY&#39;)&#34;
  BACKUP LOCATION &#39;/backups&#39; NOFILENAMECHECK
  PFILE=&#39;?/dbs/inittest.ora&#39; db_file_name_convert=&#39;prod&#39;,&#39;test&#39;;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4__GUID-B7DE1167-97EF-4F9D-83D1-D4F4B81D104A">
<p class="titleinexample">Example 2-94 Duplicating PDBs and Specific Tablespaces in a PDB</p>
<p>In this example, the PDBs <code class="codeph">pdb1</code>, <code class="codeph">pdb5</code>, and the <code class="codeph">users</code> tablespace in PDB <code class="codeph">pdb2</code> are duplicated. By default, RMAN also duplicates the <code class="codeph">root</code> and the seed database in the CDB. The auxiliary instance must have been started with an initialization parameter file that contains the declaration <code class="codeph">enable_pluggable_database=TRUE</code>. You are connected to the root as a user with the common <code class="codeph">SYSBACKUP</code> privilege.</p>
<pre dir="ltr">DUPLICATE TARGET DATABASE TO cdb 
   PLUGGABLE DATABASE pdb1,pdb5
   TABLESPACE pdb2:users;
</pre></div>
<!-- class="example" --></div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1037">
<tr>
<td class="cellalignment1049">
<table class="cellalignment1042">
<tr>
<td class="cellalignment1041"><a href="rcmsynta019.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1041"><a href="rcmsynta021.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1051">
<table class="cellalignment1040">
<tr>
<td class="cellalignment1041"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1041"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1041"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1041"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1041"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1041"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>