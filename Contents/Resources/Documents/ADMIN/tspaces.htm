<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-338"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Managing%20Tablespaces"></a><title>Managing Tablespaces</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="description" content="A tablespace is a database storage unit that groups related logical structures together. The database data files are stored in tablespaces."/>
<meta name="keywords" content="tablespaces, guidelines for managing, using multiple, assigning user quotas, quotas, assigning, quotas, tablespace, users, assigning tablespace quotas, SYSTEM, SYSTEM tablespace, when created, SYSAUX, SYSAUX tablespace, privileges, creating tablespaces, locally managed, locally managed tablespaces, automatic segment space management in, automatic segment space management, single-file tablespaces, description, bigfile tablespaces, bigfile, single-file, creating, CREATE BIGFILE TABLESPACE statement, dictionary managed, compression, compressed, encrypted, encryption, Transparent Data Encryption, keystore, V$ENCRYPTED_TABLESPACES view, temporary, temporary tablespaces, temp files, temp files in locally managed, temporary, creating, locally managed temporary, CREATE TEMPORARY TABLESPACE statement, CREATE BIGFILE TEMPORARY TABLESPACE statement, creating temporary, temporary bigfile, groups, multiple temporary tablespaces, specifying nonstandard block sizes, BLOCKSIZE clause, of CREATE TABLESPACE, CREATE TABLESPACE statement, BLOCKSIZE CLAUSE, using, DB_nK_CACHE_SIZE initialization parameter, specifying multiple block sizes, initialization parameters, DB_nK_CACHE_SIZE, DB_BLOCK_SIZE initialization parameter, and nonstandard block sizes, DB_BLOCK_SIZE, redo records, LOGGING and NOLOGGING, LOGGING clause, CREATE TABLESPACE, NOLOGGING clause, FORCE LOGGING clause, FORCE LOGGING clause, using, offline tablespaces, taking offline, priorities, taking offline normal, taking tablespaces offline, taking offline temporarily, ALTER TABLESPACE statement, ONLINE clause, example, read-only, read-only tablespaces, making read-only, READ ONLY clause, making writable, on a WORM device, WORM devices, and read-only tablespaces, delaying opening of data files, renaming, increasing size, autoextending, altering, shrinking, locally managed, shrinking, temporary, cannot rename, data file headers when rename, data file headers, when renaming tablespaces, data files, headers when renaming tablespaces, default temporary tablespace, renaming default, undo tablespaces, deleting, dropping, DROP TABLESPACE statement, integrity constraints, dropping tablespaces and, SYSAUX, managing, monitoring occupants, moving occupants, diagnosing and repairing problems in locally managed, DBMS_SPACE_ADMIN package, detecting and repairing defects, migrating SYSTEM from dictionary-managed, dictionary-managed tablespaces, migrating SYSTEM to locally managed, views, data dictionary, for tablespaces, data dictionary views reference, checking default storage parameters, listing files of, checking associated tablespaces, listing free space in, free space, tablespaces and"/>
<meta name="dcterms.created" content="2017-07-10T12:24:11Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Administrator&rsquo;s Guide"/>
<meta name="dcterms.identifier" content="E41484-15"/>
<meta name="dcterms.isVersionOf" content="ADMIN"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2001, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="archredo.htm" title="Previous" type="text/html"/>
<link rel="Next" href="dfiles.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41484-15.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-1C162C60-6698-44F2-B2A9-F3E2D2958D88"></a> <span id="PAGE" style="display:none;">19/59</span> <!-- End Header -->
<a id="ADMIN011"></a>
<h1 id="ADMIN-GUID-1C162C60-6698-44F2-B2A9-F3E2D2958D88" class="sect1"><span class="enumeration_chapter">13</span> Managing Tablespaces</h1>
<div>
<p>A tablespace is a database storage unit that groups related logical structures together. The database data files are stored in tablespaces.</p>
<div class="infoboxnotealso" id="GUID-1C162C60-6698-44F2-B2A9-F3E2D2958D88__GUID-9297AE43-CE92-450C-A543-ADC9FBB8C311">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink CNCPT402" target="_blank" href="../CNCPT/logical.htm#CNCPT402"><span class="italic">Oracle Database Concepts</span></a></p>
</li>
<li>
<p><a href="omf.htm#GUID-4A3C4616-0D81-4BBA-8EAD-FCAA8AD5C15A" title="Oracle Database can manage the files that comprise the database.">Using Oracle Managed Files</a> for information about creating data files and temp files that are both created and managed by the Oracle Database server</p>
</li>
<li>
<p><span class="q">&#34;<a href="transport.htm#GUID-F7B2B591-AA88-4D16-8DCF-712763923FFB" title="You can transport tablespaces between databases.">Transporting Tablespaces Between Databases</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
<a id="ADMIN11356"></a>
<div class="props_rev_3"><a id="GUID-5E395CA6-A7AF-4E05-B9C1-E85DE0EA235A"></a>
<h2 id="ADMIN-GUID-5E395CA6-A7AF-4E05-B9C1-E85DE0EA235A" class="sect2"><span class="enumeration_section">13.1</span> Guidelines for Managing Tablespaces</h2>
<p>You can follow guidelines for working with tablespaces.</p>
<a id="ADMIN11357"></a>
<div class="props_rev_3"><a id="GUID-5FA9D7BD-3B35-40AE-8B7F-95570987A972"></a>
<h3 id="ADMIN-GUID-5FA9D7BD-3B35-40AE-8B7F-95570987A972" class="sect3"><span class="enumeration_section">13.1.1</span> Use Multiple Tablespaces</h3>
<div>
<p>Using multiple tablespaces allows you more flexibility in performing database operations.</p>
<p>When a database has multiple tablespaces, you can:</p>
<ul style="list-style-type: disc;">
<li>
<p>Separate user data from data dictionary data to reduce I/O contention.</p>
</li>
<li>
<p>Separate data of one application from the data of another to prevent multiple applications from being affected if a tablespace must be taken offline.</p>
</li>
<li>
<p>Store the data files of different tablespaces on different disk drives to reduce I/O contention.</p>
</li>
<li>
<p>Take individual tablespaces offline while others remain online, providing better overall availability.</p>
</li>
<li>
<p>Optimizing tablespace use by reserving a tablespace for a particular type of database use, such as high update activity, read-only activity, or temporary segment storage.</p>
</li>
<li>
<p>Back up individual tablespaces.</p>
</li>
</ul>
<p>Some operating systems set a limit on the number of files that can be open simultaneously. Such limits can affect the number of tablespaces that can be simultaneously online. To avoid exceeding your operating system limit, plan your tablespaces efficiently. Create only enough tablespaces to fulfill your needs, and create these tablespaces with as few files as possible. If you must increase the size of a tablespace, then add one or two large data files, or create data files with autoextension enabled, rather than creating many small data files.</p>
<p>Review your data in light of these factors and decide how many tablespaces you need for your database design.</p>
</div>
</div>
<a id="ADMIN11358"></a>
<div class="props_rev_3"><a id="GUID-83B788D2-B621-4FCF-9A26-7AF7557A6E3A"></a>
<h3 id="ADMIN-GUID-83B788D2-B621-4FCF-9A26-7AF7557A6E3A" class="sect3"><span class="enumeration_section">13.1.2</span> Assign Tablespace Quotas to Users</h3>
<div>
<p>Grant to users who will be creating tables, clusters, materialized views, indexes, and other objects the privilege to create the object and a <span class="bold">quota</span> (space allowance or limit) in the tablespace intended to hold the object segment.</p>
<div class="infobox-note" id="GUID-83B788D2-B621-4FCF-9A26-7AF7557A6E3A__GUID-ED825F69-574A-49CA-BE81-8AA5AC14439B">
<p class="notep1">Note:</p>
<p>For PL/SQL objects such as packages, procedures, and functions, users only need the privileges to create the objects. No explicit tablespace quota is required to create these PL/SQL objects.</p>
</div>
<div class="infoboxnotealso" id="GUID-83B788D2-B621-4FCF-9A26-7AF7557A6E3A__GUID-3114A5DE-FC34-402A-AF1B-60585117BA81">
<p class="notep1">See Also:</p>
<p><a class="olink DBSEG002" target="_blank" href="../DBSEG/users.htm#DBSEG002"><span class="italic">Oracle Database Security Guide</span></a> for information about creating users and assigning tablespace quotas.</p>
</div>
</div>
</div>
</div>
<div class="sect2"><a id="GUID-9A3CE861-80FE-4813-B496-287B69A79C46"></a>
<h2 id="ADMIN-GUID-9A3CE861-80FE-4813-B496-287B69A79C46" class="sect2"><span class="enumeration_section">13.2</span> Creating Tablespaces</h2>
<p>You create a tablespace to group related logical structures, such as tables and indexes, together. The database data files are stored in tablespaces.</p>
<a id="ADMIN11359"></a>
<div class="props_rev_3"><a id="GUID-B8369BAD-892E-440B-95F0-0E9F3622CA3F"></a>
<h3 id="ADMIN-GUID-B8369BAD-892E-440B-95F0-0E9F3622CA3F" class="sect3"><span class="enumeration_section">13.2.1</span> About Creating Tablespaces</h3>
<div>
<p>To create a new tablespace, use the SQL statement <code class="codeph">CREATE TABLESPACE</code> or <code class="codeph">CREATE TEMPORARY TABLESPACE</code>. You must have the <code class="codeph">CREATE TABLESPACE</code> system privilege to create a tablespace.</p>
<p>Before you can create a tablespace, you must create a database to contain it. The primary tablespace in any database is the <code class="codeph">SYSTEM</code> tablespace, which contains information basic to the functioning of the database server, such as the data dictionary and the system rollback segment. The <code class="codeph">SYSTEM</code> tablespace is the first tablespace created at database creation. It is managed as any other tablespace, but requires a higher level of privilege and is restricted in some ways. For example, you cannot rename or drop the <code class="codeph">SYSTEM</code> tablespace or take it offline.</p>
<p>The <code class="codeph">SYSAUX</code> tablespace, which acts as an auxiliary tablespace to the <code class="codeph">SYSTEM</code> tablespace, is also always created when you create a database. It contains the schemas used by various Oracle products and features, so that those products do not require their own tablespaces. As for the <code class="codeph">SYSTEM</code> tablespace, management of the <code class="codeph">SYSAUX</code> tablespace requires a higher level of security and you cannot rename or drop it. The management of the <code class="codeph">SYSAUX</code> tablespace is discussed separately in <span class="q">&#34;<a href="tspaces.htm#GUID-30942290-88DD-4D62-816F-F7EDCE661710" title="The SYSAUX tablespace was installed as an auxiliary tablespace to the SYSTEM tablespace when you created your database. Some database components that formerly created and used separate tablespaces now occupy the SYSAUX tablespace.">Managing the SYSAUX Tablespace</a>&#34;</span>.</p>
<p>The steps for creating tablespaces vary by operating system, but the first step is always to use your operating system to create a directory structure in which your data files will be allocated. On most operating systems, you specify the size and fully specified file names of data files when you create a new tablespace or alter an existing tablespace by adding data files. Whether you are creating a new tablespace or modifying an existing one, the database automatically allocates and formats the data files as specified.</p>
<p>You can also use the <code class="codeph">CREATE UNDO TABLESPACE</code> statement to create a special type of tablespace called an <span class="bold">undo tablespace</span>, which is specifically designed to contain undo records. These are records generated by the database that are used to roll back, or undo, changes to the database for recovery, read consistency, or as requested by a <code class="codeph">ROLLBACK</code> statement. Creating and managing undo tablespaces is the subject of <a href="undo.htm#GUID-2C865CF9-A8B5-4BF1-A451-E8C08D3611F0" title="For a default installation, Oracle Database automatically manages undo. There is typically no need for DBA intervention. However, if your installation uses Oracle Flashback operations, you may need to perform some undo management tasks to ensure the success of these operations.">Managing Undo</a> .</p>
<p>You can use the <code class="codeph">ALTER TABLESPACE</code> or <code class="codeph">ALTER DATABASE</code> statements to alter the tablespace. You must have the <code class="codeph">ALTER TABLESPACE</code> or <code class="codeph">ALTER DATABASE</code> system privilege, correspondingly.</p>
<div class="infoboxnotealso" id="GUID-B8369BAD-892E-440B-95F0-0E9F3622CA3F__GUID-DF9F1118-D8AE-47E3-88B0-9B60B9111BA1">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="create.htm#GUID-807DE711-C82C-4BB2-8C31-5EE89CA71349" title="After you plan your database, you can create the database with a graphical tool or a SQL command.">Creating and Configuring an Oracle Database</a>&#34;</span> and your Oracle Database installation documentation for your operating system for information about tablespaces that are created at database creation</p>
</li>
<li>
<p><a class="olink SQLRF" target="_blank" href="../SQLRF/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about the syntax and semantics of the <code class="codeph">CREATE TABLESPACE</code>, <code class="codeph">CREATE TEMPORARY TABLESPACE</code>, <code class="codeph">ALTER TABLESPACE</code>, and <code class="codeph">ALTER DATABASE</code> statements.</p>
</li>
<li>
<p><span class="q">&#34;<a href="create.htm#GUID-55124C2D-98FF-4305-8F25-58245C9BEC1E" title="The DB_BLOCK_SIZE initialization parameter specifies the standard block size for the database.">Specifying Database Block Sizes</a>&#34;</span> for information about initialization parameters necessary to create tablespaces with nonstandard block sizes</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3"><a id="GUID-6387DF1B-F29C-4EDF-925C-202DEEFE9E1A"></a>
<h3 id="ADMIN-GUID-6387DF1B-F29C-4EDF-925C-202DEEFE9E1A" class="sect3"><span class="enumeration_section">13.2.2</span> Locally Managed Tablespaces</h3>
<p>A locally managed tablespace uses a bitmap stored in each data file to manage the extents.</p>
<a id="ADMIN11360"></a>
<div class="props_rev_3"><a id="GUID-66D4E07A-E88C-4111-96DB-9D42B532D51E"></a>
<h4 id="ADMIN-GUID-66D4E07A-E88C-4111-96DB-9D42B532D51E" class="sect4"><span class="enumeration_section">13.2.2.1</span> About Locally Managed Tablespaces</h4>
<div>
<p>Locally managed tablespaces track all extent information in the tablespace itself by using bitmaps.</p>
<p>Locally managed tablespaces provide the following benefits:</p>
<ul style="list-style-type: disc;">
<li>
<p>Fast, concurrent space operations. Space allocations and deallocations modify locally managed resources (bitmaps stored in header files).</p>
</li>
<li>
<p>Enhanced performance</p>
</li>
<li>
<p>Readable standby databases are allowed, because locally managed temporary tablespaces do not generate any undo or redo.</p>
</li>
<li>
<p>Space allocation is simplified, because when the <code class="codeph">AUTOALLOCATE</code> clause is specified, the database automatically selects the appropriate extent size.</p>
</li>
<li>
<p>User reliance on the data dictionary is reduced, because the necessary information is stored in file headers and bitmap blocks.</p>
</li>
<li>
<p>Coalescing free extents is unnecessary for locally managed tablespaces.</p>
</li>
</ul>
<p>All tablespaces, including the <a id="d108609e752" class="indexterm-anchor"></a><code class="codeph">SYSTEM</code> tablespace, can be locally managed.</p>
<p>The <code class="codeph">DBMS_SPACE_ADMIN</code> package provides maintenance procedures for locally managed tablespaces.</p>
<div class="infoboxnotealso" id="GUID-66D4E07A-E88C-4111-96DB-9D42B532D51E__GUID-F79DC454-1AEA-476C-BBF9-0B62EA18729C">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="create.htm#GUID-D8061728-6A13-4F30-AA91-EBE52F276AC3" title="During database creation, create a locally managed SYSTEM tablespace. A locally managed tablespace uses a bitmap stored in each data file to manage the extents.">Creating a Locally Managed SYSTEM Tablespace</a>&#34;</span>, <span class="q">&#34;<a href="tspaces.htm#GUID-C961302C-E712-48C2-A938-2509DB4404ED" title="Use the DBMS_SPACE_ADMIN.TABLESPACE_MIGRATE_TO_LOCAL procedure to migrate the SYSTEM tablespace from dictionary-managed to locally managed.">Migrating the SYSTEM Tablespace to a Locally Managed Tablespace</a>&#34;</span>, and <span class="q">&#34;<a href="tspaces.htm#GUID-40027632-7D50-4F15-B482-3D38A1C8A0A4" title="Oracle Database includes the DBMS_SPACE_ADMIN package, which is a collection of aids for diagnosing and repairing problems in locally managed tablespaces.">Diagnosing and Repairing Locally Managed Tablespace Problems</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="tspaces.htm#GUID-7E376766-D99D-4274-BF00-8DC1E6FC5063" title="A bigfile tablespace is a tablespace with a single, but potentially very large (up to 4G blocks) data file. Traditional smallfile tablespaces, in contrast, can contain multiple data files, but the files cannot be as large.">Bigfile Tablespaces</a>&#34;</span> for information about creating another type of locally managed tablespace that contains only a single data file or temp file.</p>
</li>
<li>
<p><a class="olink ARPLS057" target="_blank" href="../ARPLS/d_spadmn.htm#ARPLS057"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information on the <code class="codeph">DBMS_SPACE_ADMIN</code> package</p>
</li>
</ul>
</div>
</div>
</div>
<a id="ADMIN11361"></a>
<div class="props_rev_3"><a id="GUID-9DCE43A6-0D58-40C9-AA80-F87BB6B1577C"></a>
<h4 id="ADMIN-GUID-9DCE43A6-0D58-40C9-AA80-F87BB6B1577C" class="sect4"><span class="enumeration_section">13.2.2.2</span> Creating a Locally Managed Tablespace</h4>
<div>
<p>Create a locally managed tablespace by specifying <code class="codeph">LOCAL</code> in the <code class="codeph">EXTENT MANAGEMENT</code> clause of the <code class="codeph">CREATE TABLESPACE</code> statement.</p>
<div class="section">
<p>This is the default for new permanent tablespaces, but you must specify the <code class="codeph">EXTENT</code> <code class="codeph">MANAGEMENT</code> <code class="codeph">LOCAL</code> clause to specify either the <code class="codeph">AUTOALLOCATE</code> clause or the <code class="codeph">UNIFORM</code> clause. You can have the database manage extents for you automatically with the <code class="codeph">AUTOALLOCATE</code> clause (the default), or you can specify that the tablespace is managed with uniform extents of a specific size (<code class="codeph">UNIFORM</code>).</p>
<p>If you expect the tablespace to contain objects of varying sizes requiring many extents with different extent sizes, then <code class="codeph">AUTOALLOCATE</code> is the best choice. <code class="codeph">AUTOALLOCATE</code> is also a good choice if it is not important for you to have a lot of control over space allocation and deallocation, because it simplifies tablespace management. Some space may be wasted with this setting, but the benefit of having Oracle Database manage your space most likely outweighs this drawback.</p>
<p>If you want exact control over unused space, and you can predict exactly the space to be allocated for an object or objects and the number and size of extents, then <code class="codeph">UNIFORM</code> is a good choice. This setting ensures that you will never have unusable space in your tablespace.</p>
<p>When you do not explicitly specify the type of extent management, Oracle Database determines extent management as follows:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>If the <code class="codeph">CREATE TABLESPACE</code> statement omits the <code class="codeph">DEFAULT</code> storage clause, then the database creates a locally managed autoallocated tablespace.</p>
</li>
<li>
<p>If the <code class="codeph">CREATE TABLESPACE</code> statement includes a <code class="codeph">DEFAULT</code> storage clause, then the database considers the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>If you specified the <code class="codeph">MINIMUM EXTENT</code> clause, the database evaluates whether the values of <code class="codeph">MINIMUM EXTENT</code>, <code class="codeph">INITIAL</code>, and <code class="codeph">NEXT</code> are equal and the value of <code class="codeph">PCTINCREASE</code> is 0. If so, the database creates a locally managed uniform tablespace with extent size = <code class="codeph">INITIAL</code>. If the <code class="codeph">MINIMUM EXTENT</code>, <code class="codeph">INITIAL</code>, and <code class="codeph">NEXT</code> parameters are not equal, or if <code class="codeph">PCTINCREASE</code> is not 0, then the database ignores any extent storage parameters you may specify and creates a locally managed, autoallocated tablespace.</p>
</li>
<li>
<p>If you did not specify <code class="codeph">MINIMUM EXTENT</code> clause, then the database evaluates only whether the storage values of <code class="codeph">INITIAL</code> and <code class="codeph">NEXT</code> are equal and <code class="codeph">PCTINCREASE</code> is 0. If so, the tablespace is locally managed and uniform. Otherwise, the tablespace is locally managed and autoallocated.</p>
</li>
</ul>
</li>
</ul>
<p>For example, the following statement creates a locally managed tablespace named <code class="codeph">lmtbsb</code> and specifies <code class="codeph">AUTOALLOCATE</code>:</p>
<pre dir="ltr">CREATE TABLESPACE lmtbsb DATAFILE &#39;/u02/oracle/data/lmtbsb01.dbf&#39; SIZE 50M
    EXTENT MANAGEMENT LOCAL AUTOALLOCATE;
</pre>
<p><code class="codeph">AUTOALLOCATE</code> causes the tablespace to be system managed with a minimum extent size of 64K.</p>
<p>The alternative to <code class="codeph">AUTOALLOCATE</code> is <code class="codeph">UNIFORM</code>. which specifies that the tablespace is managed with extents of uniform size. You can specify that size in the <code class="codeph">SIZE</code> clause of <code class="codeph">UNIFORM</code>. If you omit <code class="codeph">SIZE</code>, then the default size is 1M.</p>
<p>The following example creates a tablespace with uniform 128K extents. (In a database with 2K blocks, each extent would be equivalent to 64 database blocks). Each 128K extent is represented by a bit in the extent bitmap for this file.</p>
<pre dir="ltr">CREATE TABLESPACE lmtbsb DATAFILE &#39;/u02/oracle/data/lmtbsb01.dbf&#39; SIZE 50M
    EXTENT MANAGEMENT LOCAL UNIFORM SIZE 128K;
</pre>
<p>You cannot specify the <code class="codeph">DEFAULT</code> storage clause, <code class="codeph">MINIMUM EXTENT</code>, or <code class="codeph">TEMPORARY</code> when you explicitly specify <code class="codeph">EXTENT MANAGEMENT LOCAL</code>. To create a temporary locally managed tablespace, use the <code class="codeph">CREATE TEMPORARY TABLESPACE</code> statement.</p>
<div class="infobox-note" id="GUID-9DCE43A6-0D58-40C9-AA80-F87BB6B1577C__GUID-0DFF4747-A0BC-4F38-B103-1D9088BEA6B2">
<p class="notep1">Note:</p>
<p>When you allocate a data file for a locally managed tablespace, you should allow space for metadata used for space management (the extent bitmap or space header segment) which are part of user space. For example, if you specify the <code class="codeph">UNIFORM</code> clause in the extent management clause but you omit the <code class="codeph">SIZE</code> parameter, then the default extent size is 1MB. In that case, the size specified for the data file must be larger (at least one block plus space for the bitmap) than 1MB.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN10065"></a>
<div class="props_rev_3"><a id="GUID-5254F3ED-DDFA-4797-B09C-A49DC62E80B0"></a>
<h4 id="ADMIN-GUID-5254F3ED-DDFA-4797-B09C-A49DC62E80B0" class="sect4"><span class="enumeration_section">13.2.2.3</span> Specifying Segment Space Management in Locally Managed Tablespaces</h4>
<div>
<p>In a locally managed tablespace, there are two methods that Oracle Database can use to manage segment space: automatic and manual.</p>
<div class="section">
<p>Manual segment space management uses linked lists called &#34;freelists&#34; to manage free space in the segment, while automatic segment space management uses bitmaps. Automatic segment space management is the more efficient method, and is the default for all new permanent, locally managed tablespaces.</p>
<p>Automatic segment space management delivers better space utilization than manual segment space management. It is also self-tuning, in that it scales with increasing number of users or instances. In an Oracle Real Application Clusters environment, automatic segment space management allows for a dynamic affinity of space to instances. In addition, for many standard workloads, application performance with automatic segment space management is better than the performance of a well-tuned application using manual segment space management.</p>
<p>Although automatic segment space management is the default for all new permanent, locally managed tablespaces, you can explicitly enable it with the <code class="codeph">SEGMENT SPACE MANAGEMENT AUTO</code> clause.</p>
<p>For example, the following statement creates tablespace <code class="codeph">lmtbsb</code> with automatic segment space management:</p>
<pre dir="ltr">CREATE TABLESPACE lmtbsb DATAFILE &#39;/u02/oracle/data/lmtbsb01.dbf&#39; SIZE 50M
    EXTENT MANAGEMENT LOCAL 
    SEGMENT SPACE MANAGEMENT AUTO;
</pre>
<p>The <code class="codeph">SEGMENT SPACE MANAGEMENT MANUAL</code> clause disables automatic segment space management.</p>
<p>The segment space management that you specify at tablespace creation time applies to all segments subsequently created in the tablespace. You cannot change the segment space management mode of a tablespace.</p>
<div class="infobox-note" id="GUID-5254F3ED-DDFA-4797-B09C-A49DC62E80B0__GUID-DB172C01-69AA-43B4-AED9-0F08AC0271A7">
<p class="notep1">Note:</p>
<ul style="list-style-type: disc;">
<li>
<p>If you set extent management to <code class="codeph">LOCAL</code> <code class="codeph">UNIFORM</code>, then you must ensure that each extent contains at least 5 database blocks.</p>
</li>
<li>
<p>If you set extent management to <code class="codeph">LOCAL</code> <code class="codeph">AUTOALLOCATE</code>, and if the database block size is 16K or greater, then Oracle manages segment space by creating extents with a minimum size of 5 blocks rounded up to 64K.</p>
</li>
<li>
<p>You cannot specify automatic segment space management for the <code class="codeph">SYSTEM</code> tablespace.</p>
</li>
</ul>
</div>
<p>Locally managed tablespaces using automatic segment space management can be created as single-file or bigfile tablespaces, as described in <span class="q">&#34;<a href="tspaces.htm#GUID-7E376766-D99D-4274-BF00-8DC1E6FC5063" title="A bigfile tablespace is a tablespace with a single, but potentially very large (up to 4G blocks) data file. Traditional smallfile tablespaces, in contrast, can contain multiple data files, but the files cannot be as large.">Bigfile Tablespaces</a>&#34;</span>.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<div class="sect3"><a id="GUID-5C916922-25BD-4140-A76D-08F3C0E68426"></a>
<h3 id="ADMIN-GUID-5C916922-25BD-4140-A76D-08F3C0E68426" class="sect3"><span class="enumeration_section">13.2.3</span> Bigfile Tablespaces</h3>
<p>Bigfile tablespaces can increase the storage capacity of a database and reduce the burden of managing many data files and temp files.</p>
<a id="ADMIN01102"></a>
<div class="props_rev_3"><a id="GUID-7E376766-D99D-4274-BF00-8DC1E6FC5063"></a>
<h4 id="ADMIN-GUID-7E376766-D99D-4274-BF00-8DC1E6FC5063" class="sect4"><span class="enumeration_section">13.2.3.1</span> About Bigfile Tablespaces</h4>
<div>
<p>A <span class="bold">bigfile tablespace</span> is a tablespace with a single, but potentially very large (up to 4G blocks) data file. Traditional smallfile tablespaces, in contrast, can contain multiple data files, but the files cannot be as large.</p>
<p>The benefits of bigfile tablespaces are the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>A bigfile tablespace with 8K blocks can contain a 32 terabyte data file. A bigfile tablespace with 32K blocks can contain a 128 terabyte data file. The maximum number of data files in an Oracle Database is limited (usually to 64K files). Therefore, bigfile tablespaces can significantly enhance the storage capacity of an Oracle Database.</p>
</li>
<li>
<p>Bigfile tablespaces can reduce the number of data files needed for a database. An additional benefit is that the <code class="codeph">DB_FILES</code> initialization parameter and <code class="codeph">MAXDATAFILES</code> parameter of the <code class="codeph">CREATE DATABASE</code> and <code class="codeph">CREATE CONTROLFILE</code> statements can be adjusted to reduce the amount of SGA space required for data file information and the size of the control file.</p>
</li>
<li>
<p>Bigfile tablespaces simplify database management by providing data file transparency. SQL syntax for the <code class="codeph">ALTER</code> <code class="codeph">TABLESPACE</code> statement lets you perform operations on tablespaces, rather than the underlying individual data files.</p>
</li>
</ul>
<p>Bigfile tablespaces are supported only for locally managed tablespaces with automatic segment space management, with three exceptions: locally managed undo tablespaces, temporary tablespaces, and the <code class="codeph">SYSTEM</code> tablespace.</p>
<div class="infobox-note" id="GUID-7E376766-D99D-4274-BF00-8DC1E6FC5063__GUID-DBB8C542-5581-4899-9CE0-BBF40AA11BF3">
<p class="notep1">Note:</p>
<ul style="list-style-type: disc;">
<li>
<p>Bigfile tablespaces are intended to be used with Automatic Storage Management (Oracle ASM) or other logical volume managers that supports striping or RAID, and dynamically extensible logical volumes.</p>
</li>
<li>
<p>Avoid creating bigfile tablespaces on a system that does not support striping because of negative implications for parallel query execution and RMAN backup parallelization.</p>
</li>
<li>
<p>Using bigfile tablespaces on platforms that do not support large file sizes is not recommended and can limit tablespace capacity. See your operating system specific documentation for information about maximum supported file sizes.</p>
</li>
</ul>
</div>
</div>
</div>
<a id="ADMIN11363"></a>
<div class="props_rev_3"><a id="GUID-2736AECE-1AA1-4353-AE11-914A382165A9"></a>
<h4 id="ADMIN-GUID-2736AECE-1AA1-4353-AE11-914A382165A9" class="sect4"><span class="enumeration_section">13.2.3.2</span> Creating a Bigfile Tablespace</h4>
<div>
<p>To create a bigfile tablespace, specify the <code class="codeph">BIGFILE</code> keyword of the <code class="codeph">CREATE</code> <code class="codeph">TABLESPACE</code> statement (<code class="codeph">CREATE</code> <code class="codeph">BIGFILE</code> <code class="codeph">TABLESPACE</code> ...).</p>
<div class="section">
<p>Oracle Database automatically creates a locally managed tablespace with automatic segment space management. You can, but need not, specify <code class="codeph">EXTENT</code> <code class="codeph">MANAGEMENT</code> <code class="codeph">LOCAL</code> and <code class="codeph">SEGMENT</code> <code class="codeph">SPACE</code> <code class="codeph">MANAGEMENT</code> <code class="codeph">AUTO</code> in this statement. However, the database returns an error if you specify <code class="codeph">EXTENT</code> <code class="codeph">MANAGEMENT</code> <code class="codeph">DICTIONARY</code> or <code class="codeph">SEGMENT</code> <code class="codeph">SPACE</code> <code class="codeph">MANAGEMENT</code> <code class="codeph">MANUAL</code>. The remaining syntax of the statement is the same as for the <code class="codeph">CREATE TABLESPACE</code> statement, but you can only specify one data file. For example:</p>
<pre dir="ltr">CREATE BIGFILE TABLESPACE bigtbs 
    DATAFILE &#39;/u02/oracle/data/bigtbs01.dbf&#39; SIZE 50G
...
</pre>
<p>You can specify <code class="codeph">SIZE</code> in kilobytes (K), megabytes (M), gigabytes (G), or terabytes (T).</p>
<p>If the default tablespace type was set to <code class="codeph">BIGFILE</code> at database creation, you need not specify the keyword <code class="codeph">BIGFILE</code> in the <code class="codeph">CREATE TABLESPACE</code> statement. A bigfile tablespace is created by default.</p>
<p>If the default tablespace type was set to <code class="codeph">BIGFILE</code> at database creation, but you want to create a traditional (smallfile) tablespace, then specify a <code class="codeph">CREATE</code> <code class="codeph">SMALLFILE</code> <code class="codeph">TABLESPACE</code> statement to override the default tablespace type for the tablespace that you are creating.</p>
<div class="infoboxnotealso" id="GUID-2736AECE-1AA1-4353-AE11-914A382165A9__GUID-856C678F-0669-4716-98B1-410A4F283DA6">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="create.htm#GUID-35A12594-29EB-4545-A6AD-63B9AC3A5671" title="Oracle Database simplifies management of tablespaces and enables support for extremely large databases by letting you create bigfile tablespaces.">Supporting Bigfile Tablespaces During Database Creation</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11365"></a>
<div class="props_rev_3"><a id="GUID-F083CFBF-955B-4994-875E-3298B140AD1B"></a>
<h4 id="ADMIN-GUID-F083CFBF-955B-4994-875E-3298B140AD1B" class="sect4"><span class="enumeration_section">13.2.3.3</span> Identifying a Bigfile Tablespace</h4>
<div>
<p>You can query a set of data dictionary views for information about bigfile tablespaces.</p>
<div class="section">
<p>The following views contain a <code class="codeph">BIGFILE</code> column that identifies a tablespace as a bigfile tablespace:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">DBA_TABLESPACES</code></p>
</li>
<li>
<p><code class="codeph">USER_TABLESPACES</code></p>
</li>
<li>
<p><code class="codeph">V$TABLESPACE</code></p>
</li>
</ul>
<p>Query these views for information about bigfile tablespaces.</p>
<p>You can also identify a bigfile tablespace by the relative file number of its single data file. That number is 1024 on most platforms, but 4096 on OS/390.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<div class="sect3"><a id="GUID-207D9DF2-ED00-4A40-AC7B-49A4EAD061E6"></a>
<h3 id="ADMIN-GUID-207D9DF2-ED00-4A40-AC7B-49A4EAD061E6" class="sect3"><span class="enumeration_section">13.2.4</span> Compressed Tablespaces</h3>
<p>When you create a tablespace, you can specify that all tables created in a tablespace are compressed by default.</p>
<a id="ADMIN13316"></a>
<div class="props_rev_3"><a id="GUID-556AFD6F-E0DA-4694-AB75-A3F8BA43EB03"></a>
<h4 id="ADMIN-GUID-556AFD6F-E0DA-4694-AB75-A3F8BA43EB03" class="sect4"><span class="enumeration_section">13.2.4.1</span> About Compressed Tablespaces</h4>
<div>
<p>When you create a tablespace, you can specify the default compression of data for all tables created in the tablespace. Compressing table data can reduce disk use.</p>
</div>
</div>
<div class="sect4"><a id="GUID-B50C5A01-E22F-4721-97C7-DAF3FF269E06"></a>
<h4 id="ADMIN-GUID-B50C5A01-E22F-4721-97C7-DAF3FF269E06" class="sect4"><span class="enumeration_section">13.2.4.2</span> Creating Compressed Tablespaces</h4>
<div>
<p>When you create a compressed tablespace, you specify the type of table compression using the <code class="codeph">DEFAULT</code> keyword, followed by one of the compression type clauses used when creating a table.</p>
<div class="section">
<p>The following statement indicates that all tables created in the tablespace are to use advanced row compression, unless otherwise specified:</p>
<pre dir="ltr">CREATE TABLESPACE ... DEFAULT ROW STORE COMPRESS ADVANCED ... ;
</pre>
<p>You can override the default tablespace compression specification when you create a table in that tablespace.</p>
<div class="infoboxnotealso" id="GUID-B50C5A01-E22F-4721-97C7-DAF3FF269E06__GUID-83B45F93-DA44-4F2A-A419-CDA03119131E">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="tables.htm#GUID-ED833867-4B7F-442E-A70C-9C19DAA8F445" title="Compression saves disk space, reduces memory use in the database buffer cache, and can significantly speed query execution during reads.">Consider Using Table Compression</a>&#34;</span> for information about the various types of table compression</p>
</li>
<li>
<p><a class="olink SQLRF01403" target="_blank" href="../SQLRF/statements_7003.htm#SQLRF01403"><span class="italic">Oracle Database SQL Language Reference</span></a> for the exact syntax to use when creating a tablespace with a default compression type</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<div class="sect3"><a id="GUID-996E01D0-3679-45FE-BEBB-CE941B6989DB"></a>
<h3 id="ADMIN-GUID-996E01D0-3679-45FE-BEBB-CE941B6989DB" class="sect3"><span class="enumeration_section">13.2.5</span> Encrypted Tablespaces</h3>
<p>You can encrypt any permanent tablespace to protect sensitive data.</p>
<a id="ADMIN12597"></a><a id="ADMIN12598"></a><a id="ADMIN12599"></a><a id="ADMIN12327"></a>
<div class="props_rev_3"><a id="GUID-42F231F3-306D-4680-A02E-078683F4C578"></a>
<h4 id="ADMIN-GUID-42F231F3-306D-4680-A02E-078683F4C578" class="sect4"><span class="enumeration_section">13.2.5.1</span> About Encrypted Tablespaces</h4>
<div>
<p>Encrypted tablespaces primarily protect your data from unauthorized access by means other than through the database. For example, when encrypted tablespaces are written to backup media for travel from one Oracle database to another or for travel to an off-site facility for storage, they remain encrypted.</p>
<p>Also, encrypted tablespaces protect data from users who try to circumvent the security features of the database and access database files directly through the operating system file system. Tablespace encryption is completely transparent to your applications, so no application modification is necessary.</p>
<p>Tablespace encryption does not address all security issues. It does not, for example, provide access control from within the database. Any user who is granted privileges on objects stored in an encrypted tablespace can access those objects without providing any kind of additional password or key.</p>
<p>When you encrypt a tablespace, all tablespace blocks are encrypted. All segment types are supported for encryption, including tables, clusters, indexes, LOBs (<code class="codeph">BASICFILE</code> and <code class="codeph">SECUREFILE</code>), table and index partitions, and so on.</p>
<div class="infobox-note" id="GUID-42F231F3-306D-4680-A02E-078683F4C578__GUID-79B56557-1FFC-4296-8E13-0468BE52A2BE">
<p class="notep1">Note:</p>
<p>There is no need to use LOB encryption on <code class="codeph">SECUREFILE</code> LOBs stored in an encrypted tablespace.</p>
</div>
<p>To maximize security, data from an encrypted tablespace is automatically encrypted when written to the undo tablespace, to the redo logs, and to any temporary tablespace. There is no need to explicitly create encrypted undo or temporary tablespaces, and in fact, you cannot specify encryption for those tablespace types.</p>
<p>For partitioned tables and indexes that have different partitions in different tablespaces, it is permitted to use both encrypted and non-encrypted tablespaces in the same table or index.</p>
<p>Tablespace encryption uses the Transparent Data Encryption feature of Oracle Database, which requires that you create a keystore to store the master encryption key for the database. The keystore must be open before you can create the encrypted tablespace and before you can store or retrieve encrypted data. When you open the keystore, it is available to all session, and it remains open until you explicitly close it or until the database is shut down.</p>
<p>Transparent Data Encryption supports industry-standard encryption algorithms, including the following Advanced Encryption Standard (AES) and Triple Data Encryption Standard (3DES) algorithms:</p>
<ul style="list-style-type: disc;">
<li>
<p>AES256</p>
</li>
<li>
<p>AES192</p>
</li>
<li>
<p>AES128</p>
</li>
<li>
<p>3DES168</p>
</li>
</ul>
<p>The encryption key length is implied by the algorithm name. For example, the AES128 algorithm uses 128-bit keys. You specify the algorithm to use when you create the tablespace, and different tablespaces can use different algorithms. Although longer key lengths theoretically provide greater security, there is a trade-off in CPU overhead. If you do not specify the algorithm in your <code class="codeph">CREATE</code> <code class="codeph">TABLESPACE</code> statement, AES128 is the default. There is no disk space overhead for encrypting a tablespace.</p>
<div class="section">
<p class="subhead3">Restrictions</p>
</div>
<!-- class="section" -->
<div class="section">
<p>The following are restrictions for encrypted tablespaces:</p>
<ul style="list-style-type: disc;">
<li>
<p>You cannot encrypt an existing tablespace with an <code class="codeph">ALTER</code> <code class="codeph">TABLESPACE</code> statement. However, you can use Data Pump or SQL statements such as <code class="codeph">CREATE</code> <code class="codeph">TABLE</code> <code class="codeph">AS</code> <code class="codeph">SELECT</code> or <code class="codeph">ALTER</code> <code class="codeph">TABLE</code> <code class="codeph">MOVE</code> to move existing table data into an encrypted tablespace.</p>
</li>
<li>
<p>Encrypted tablespaces are subject to restrictions when transporting to another database. See <span class="q">&#34;<a href="transport.htm#GUID-28800719-6CB9-4A71-95DD-4B61AA603173" title="There are general limitations on transporting data. There are also limitations that are specific to full transportable export/import, transportable tablespaces, or transportable tables.">General Limitations on Transporting Data</a>&#34;</span>.</p>
</li>
<li>
<p>When recovering a database with encrypted tablespaces (for example after a <code class="codeph">SHUTDOWN</code> <code class="codeph">ABORT</code> or a catastrophic error that brings down the database instance), you must open the keystore after database mount and before database open, so the recovery process can decrypt data blocks and redo.</p>
</li>
</ul>
<p>In addition, see <a class="olink ASOAG9518" target="_blank" href="../ASOAG/configuring-transparent-data-encryption.htm#ASOAG9518"><span class="italic">Oracle Database Advanced Security Guide</span></a> for general restrictions for Transparent Data Encryption.</p>
<div class="infoboxnotealso" id="GUID-42F231F3-306D-4680-A02E-078683F4C578__GUID-9F8751C1-5DEB-4F2D-9B38-21AD704690F2">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink TDPSG94440" target="_blank" href="../TDPSG/GUID-61259237-5514-4531-AFB4-CF716F93F1E5.htm#TDPSG94440"><span class="italic">Oracle Database 2 Day + Security Guide</span></a> for more information about Transparent Data Encryption and for instructions for creating and opening keystores</p>
</li>
<li>
<p><span class="q">&#34;<a href="tables.htm#GUID-F9D38568-4F95-4053-B21F-F318077C29E5" title="You can encrypt individual table columns that contain sensitive data. Examples of sensitive data include social security numbers, credit card numbers, and medical records. Column encryption is transparent to your applications, with some restrictions.">Consider Encrypting Columns That Contain Sensitive Data</a>&#34;</span> for an alternative to encrypting an entire tablespace</p>
</li>
<li>
<p><a class="olink RACAD510" target="_blank" href="../RACAD/GUID-D583DE16-C0D0-4B7E-8EB9-496AA0406E46.htm#RACAD510"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for information on using a keystore in an Oracle Real Application Clusters environment</p>
</li>
<li>
<p><a class="olink SQLRF01403" target="_blank" href="../SQLRF/statements_7003.htm#SQLRF01403"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about the <code class="codeph">CREATE</code> <code class="codeph">TABLESPACE</code> statement</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<div class="sect4"><a id="GUID-88E85939-7360-4D30-9904-7C32343C293F"></a>
<h4 id="ADMIN-GUID-88E85939-7360-4D30-9904-7C32343C293F" class="sect4"><span class="enumeration_section">13.2.5.2</span> Creating Encrypted Tablespaces</h4>
<div>
<p>You can create encrypted tablespaces to protect your data from unauthorized access.</p>
<div class="section">
<p>To encrypt a tablespace, you must open the database with the <code class="codeph">COMPATIBLE</code> initialization parameter set to <code class="codeph">11.1.0</code> or higher. Any user who can create a tablespace can create an encrypted tablespace.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Examples</p>
<p>To create an encrypted tablespace:</p>
<ul style="list-style-type: disc;">
<li>
<p>Run a <code class="codeph">CREATE TABLESPACE</code> statement with an <code class="codeph">ENCRYPTION</code> clause.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p>The following statement creates an encrypted tablespace with the default encryption algorithm:</p>
<pre dir="ltr">CREATE TABLESPACE securespace
DATAFILE &#39;/u01/app/oracle/oradata/orcl/secure01.dbf&#39; SIZE 100M
ENCRYPTION
DEFAULT STORAGE(ENCRYPT);
</pre>
<p>The following statement creates the same tablespace with the AES256 algorithm:</p>
<pre dir="ltr">CREATE TABLESPACE securespace
DATAFILE &#39;/u01/app/oracle/oradata/orcl/secure01.dbf&#39; SIZE 100M
ENCRYPTION USING &#39;AES256&#39;
DEFAULT STORAGE(ENCRYPT);
</pre></div>
<!-- class="section" --></div>
</div>
<div class="sect4"><a id="GUID-EC92CA07-9679-4A83-B834-E5FEDBCDE2E8"></a>
<h4 id="ADMIN-GUID-EC92CA07-9679-4A83-B834-E5FEDBCDE2E8" class="sect4"><span class="enumeration_section">13.2.5.3</span> Viewing Information About Encrypted Tablespaces</h4>
<div>
<p>You can query the <code class="codeph">DBA_TABLESPACES</code> and <code class="codeph">USER_TABLESPACES</code> data dictionary views for information about encrypted tablespaces.</p>
<div class="section">
<p>The <code class="codeph">DBA_TABLESPACES</code> and <code class="codeph">USER_TABLESPACES</code> data dictionary views include a column named <code class="codeph">ENCRYPTED</code>. This column contains <code class="codeph">YES</code> for encrypted tablespaces.</p>
<p>The view <code class="codeph">V$ENCRYPTED_TABLESPACES</code> lists all currently encrypted tablespaces. The following query displays the name and encryption algorithm of encrypted tablespaces:</p>
<pre dir="ltr">SELECT t.name, e.encryptionalg algorithm 
FROM  v$tablespace t, v$encrypted_tablespaces e
WHERE t.ts# = e.ts#;
 
NAME                           ALGORITHM 
------------------------------ --------- 
SECURESPACE                    AES256  
</pre></div>
<!-- class="section" --></div>
</div>
</div>
<div class="sect3"><a id="GUID-6B941DE0-D109-4AD5-A13C-753AD37335DC"></a>
<h3 id="ADMIN-GUID-6B941DE0-D109-4AD5-A13C-753AD37335DC" class="sect3"><span class="enumeration_section">13.2.6</span> Temporary Tablespaces</h3>
<div>
<p>Temporary tablespaces can improve the concurrency of multiple sort operations that do not fit in memory. These tablespaces also improve the efficiency of space management operations during sorts.</p>
</div>
<a id="ADMIN12600"></a><a id="ADMIN12601"></a><a id="ADMIN11366"></a>
<div class="props_rev_3"><a id="GUID-9B6544CD-BFF3-4EA8-B06B-0CBC5A91EA45"></a>
<h4 id="ADMIN-GUID-9B6544CD-BFF3-4EA8-B06B-0CBC5A91EA45" class="sect4"><span class="enumeration_section">13.2.6.1</span> About Temporary Tablespaces</h4>
<div>
<p>A <span class="bold">temporary tablespace</span> contains transient data that persists only for the duration of the session. Temporary tablespaces can improve the concurrency of multiple sort operations that do not fit in memory and can improve the efficiency of space management operations during sorts.</p>
<p>Temporary tablespaces are used to store the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>Intermediate sort results</p>
</li>
<li>
<p>Temporary tables and temporary indexes</p>
</li>
<li>
<p>Temporary LOBs</p>
</li>
<li>
<p>Temporary B-trees</p>
</li>
</ul>
<p>Within a temporary tablespace, all sort operations for a particular instance share a single <span class="italic">sort segment</span>, and sort segments exist for every instance that performs sort operations that require temporary space. A sort segment is created by the first statement after startup that uses the temporary tablespace for sorting, and is released only at shutdown.</p>
<p>By default, a single temporary tablespace named <code class="codeph">TEMP</code> is created for each new Oracle Database installation. You can create additional temporary tablespaces with the <code class="codeph">CREATE</code> <code class="codeph">TABLESPACE</code> statement. You can assign a temporary tablespace to each database user with the <code class="codeph">CREATE USER</code> or <code class="codeph">ALTER USER</code> statement. A single temporary tablespace can be shared by multiple users.</p>
<p>You cannot explicitly create objects in a temporary tablespace.</p>
<div class="infobox-note" id="GUID-9B6544CD-BFF3-4EA8-B06B-0CBC5A91EA45__GUID-02FE7A5E-4A37-435C-AF45-F954C1E9A1F9">
<p class="notep1">Note:</p>
<p>The exception to the preceding statement is a temporary table. When you create a temporary table, its rows are stored in your default temporary tablespace, unless you create the table in a new temporary tablespace. See <span class="q">&#34;<a href="tables.htm#GUID-A48CB362-FC15-4A26-8386-906A55F6788E" title="Temporary tables are useful in applications where a result set is to be buffered (temporarily persisted), perhaps because it is constructed by running multiple DML operations.">Creating a Temporary Table</a>&#34;</span> for more information.</p>
</div>
<div class="section">
<p class="subhead3">Default Temporary Tablespace</p>
</div>
<!-- class="section" -->
<div class="section">
<p>Users who are not explicitly assigned a temporary tablespace use the database default temporary tablespace, which for new installations is <code class="codeph">TEMP</code>. You can change the default temporary tablespace for the database with the following command:</p>
<pre dir="ltr">ALTER DATABASE DEFAULT TEMPORARY TABLESPACE <span class="italic">tablespace_name</span>;
</pre>
<p>To determine the current default temporary tablespace for the database, run the following query:</p>
<pre dir="ltr">SELECT PROPERTY_NAME, PROPERTY_VALUE FROM DATABASE_PROPERTIES WHERE
   PROPERTY_NAME=&#39;DEFAULT_TEMP_TABLESPACE&#39;;

PROPERTY_NAME              PROPERTY_VALUE
-------------------------- ------------------------------
DEFAULT_TEMP_TABLESPACE    TEMP
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Space Allocation in a Temporary Tablespace</p>
</div>
<!-- class="section" -->
<div class="section">
<p>You can view the allocation and deallocation of space in a temporary tablespace sort segment using the <code class="codeph">V$SORT_SEGMENT</code> view. The <code class="codeph">V$TEMPSEG_USAGE</code> view identifies the current sort users in those segments.</p>
<p>When a sort operation that uses temporary space completes, allocated extents in the sort segment are not deallocated; they are just marked as free and available for reuse. The <code class="codeph">DBA_TEMP_FREE_SPACE</code> view displays the total allocated and free space in each temporary tablespace. See <span class="q">&#34;<a href="tspaces.htm#GUID-474A7F1C-CD48-48EF-9E3F-61F3D057CCD8" title="The DBA_TEMP_FREE_SPACE dictionary view contains information about space usage for each temporary tablespace.">Viewing Space Usage for Temporary Tablespaces</a>&#34;</span> for more information. You can manually shrink a locally managed temporary tablespace that has a large amount of unused space. See <span class="q">&#34;<a href="tspaces.htm#GUID-CF57ECCF-0032-4C64-9B37-489F538D0AA7" title="You can shrink locally managed temporary tablespaces and release unused space.">Shrinking a Locally Managed Temporary Tablespace</a>&#34;</span> for details.</p>
<div class="infoboxnotealso" id="GUID-9B6544CD-BFF3-4EA8-B06B-0CBC5A91EA45__GUID-866030B0-E90B-4276-9894-7EE6E5D9549D">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink DBSEG002" target="_blank" href="../DBSEG/users.htm#DBSEG002"><span class="italic">Oracle Database Security Guide</span></a> for information about creating users and assigning temporary tablespaces</p>
</li>
<li>
<p><a class="olink CNCPT1092" target="_blank" href="../CNCPT/logical.htm#CNCPT1092"><span class="italic">Oracle Database Concepts</span></a> for more information about the default temporary tablespace</p>
</li>
<li>
<p><a class="olink REFRN" target="_blank" href="../REFRN/toc.htm"><span class="italic">Oracle Database Reference</span></a> for more information about the <code class="codeph">V$SORT_SEGMENT</code>, <code class="codeph">V$TEMPSEG_USAGE</code>, and <code class="codeph">DBA_TEMP_FREE_SPACE</code> views</p>
</li>
<li>
<p><a class="olink TGDBA346" target="_blank" href="../TGDBA/tune_pga.htm#TGDBA346"><span class="italic">Oracle Database Performance Tuning Guide</span></a> for a discussion on tuning sorts</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11367"></a>
<div class="props_rev_3"><a id="GUID-03CCF8D4-9DAA-451A-B9F8-836F8262B43D"></a>
<h4 id="ADMIN-GUID-03CCF8D4-9DAA-451A-B9F8-836F8262B43D" class="sect4"><span class="enumeration_section">13.2.6.2</span> Creating a Locally Managed Temporary Tablespace</h4>
<div>
<p>Because space management is much simpler and more efficient in locally managed tablespaces, they are ideally suited for temporary tablespaces.</p>
<div class="section">
<p>Locally managed temporary tablespaces use <span class="bold">temp files</span>, which do not modify data outside of the temporary tablespace or generate any redo for temporary tablespace data. Because of this, they enable you to perform on-disk sorting operations in a read-only or standby database.</p>
<p>You also use different views for viewing information about temp files than you would for data files. The <code class="codeph">V$TEMPFILE</code> and <code class="codeph">DBA_TEMP_FILES</code> views are analogous to the <code class="codeph">V$DATAFILE</code> and <code class="codeph">DBA_DATA_FILES</code> views.</p>
<p>To create a locally managed temporary tablespace, you use the <code class="codeph">CREATE TEMPORARY TABLESPACE</code> statement, which requires that you have the <code class="codeph">CREATE TABLESPACE</code> system privilege.</p>
<p>The following statement creates a temporary tablespace in which each extent is 16M. Each 16M extent (which is the equivalent of 8000 blocks when the standard block size is 2K) is represented by a bit in the bitmap for the file.</p>
<pre dir="ltr">CREATE TEMPORARY TABLESPACE lmtemp TEMPFILE &#39;/u02/oracle/data/lmtemp01.dbf&#39; 
     SIZE 20M REUSE
     EXTENT MANAGEMENT LOCAL UNIFORM SIZE 16M;
</pre>
<p>The extent management clause is optional for temporary tablespaces because all temporary tablespaces are created with locally managed extents of a uniform size. If an extent size is specified in the <code class="codeph">EXTENT SIZE</code> clause, then it is used. If it is not specified, then, Oracle Database uses the tablespace size and file sizes to determine the default extent size.</p>
<div class="infobox-note" id="GUID-03CCF8D4-9DAA-451A-B9F8-836F8262B43D__GUID-B09AE3C0-8BEC-4724-84AD-3A249FE2753C">
<p class="notep1">Note:</p>
<p>On some operating systems, the database does not allocate space for the temp file until the temp file blocks are actually accessed. This delay in space allocation results in faster creation and resizing of temp files, but it requires that sufficient disk space is available when the temp files are later used. See your operating system documentation to determine whether the database allocates temp file space in this way on your system.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11368"></a>
<div class="props_rev_3"><a id="GUID-429AC4EC-980C-4132-9805-6126B2778B94"></a>
<h4 id="ADMIN-GUID-429AC4EC-980C-4132-9805-6126B2778B94" class="sect4"><span class="enumeration_section">13.2.6.3</span> Creating a Bigfile Temporary Tablespace</h4>
<div>
<p>Just as for regular tablespaces, you can create single-file (bigfile) temporary tablespaces.</p>
<div class="section">
<p>To create a bigfile temporary tablespace:</p>
<ul style="list-style-type: disc;">
<li>
<p>Run the <code class="codeph">CREATE BIGFILE TEMPORARY TABLESPACE</code> statement to create a single-temp file tablespace.</p>
</li>
</ul>
<p>See the sections <span class="q">&#34;<a href="tspaces.htm#GUID-2736AECE-1AA1-4353-AE11-914A382165A9" title="To create a bigfile tablespace, specify the BIGFILE keyword of the CREATE TABLESPACE statement (CREATE BIGFILE TABLESPACE ...).">Creating a Bigfile Tablespace</a>&#34;</span> and <span class="q">&#34;<a href="tspaces.htm#GUID-3060B641-E131-404D-B415-1A319222ED2A" title="You can resize or autoextend a bigfile tablespace.">Altering a Bigfile Tablespace</a>&#34;</span> for information about bigfile tablespaces, but consider that you are creating temporary tablespaces that use temp files instead of data files.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN12315"></a>
<div class="props_rev_3"><a id="GUID-474A7F1C-CD48-48EF-9E3F-61F3D057CCD8"></a>
<h4 id="ADMIN-GUID-474A7F1C-CD48-48EF-9E3F-61F3D057CCD8" class="sect4"><span class="enumeration_section">13.2.6.4</span> Viewing Space Usage for Temporary Tablespaces</h4>
<div>
<p>The <code class="codeph">DBA_TEMP_FREE_SPACE</code> dictionary view contains information about space usage for each temporary tablespace.</p>
<div class="section">
<p>The information includes the space allocated and the free space. You can query this view for these statistics using the following statement:</p>
<pre dir="ltr">SELECT * from DBA_TEMP_FREE_SPACE;
 
TABLESPACE_NAME                     TABLESPACE_SIZE ALLOCATED_SPACE FREE_SPACE
----------------------------------- --------------- --------------- ----------
TEMP                                250609664       250609664       249561088
</pre></div>
<!-- class="section" --></div>
</div>
</div>
<div class="sect3"><a id="GUID-55A6AE10-6875-4B73-9A5C-CB4965AD5AFE"></a>
<h3 id="ADMIN-GUID-55A6AE10-6875-4B73-9A5C-CB4965AD5AFE" class="sect3"><span class="enumeration_section">13.2.7</span> Temporary Tablespace Groups</h3>
<p>A temporary tablespace group is a tablespace group that is assigned as the default temporary tablespace for the database.</p>
<a id="ADMIN01103"></a>
<div class="props_rev_3"><a id="GUID-A90A82C7-E06D-416F-842E-704A95FF2AB5"></a>
<h4 id="ADMIN-GUID-A90A82C7-E06D-416F-842E-704A95FF2AB5" class="sect4"><span class="enumeration_section">13.2.7.1</span> Multiple Temporary Tablespaces: Using Tablespace Groups</h4>
<div>
<p>A <span class="bold">tablespace group</span> enables a user to consume temporary space from multiple tablespaces. Using a tablespace group, rather than a single temporary tablespace, can alleviate problems caused where one tablespace is inadequate to hold the results of a sort, particularly on a table that has many partitions. A tablespace group enables parallel execution servers in a single parallel operation to use multiple temporary tablespaces.</p>
<p>A tablespace group has the following characteristics:</p>
<ul style="list-style-type: disc;">
<li>
<p>It contains at least one tablespace. There is no explicit limit on the maximum number of tablespaces that are contained in a group.</p>
</li>
<li>
<p>It shares the namespace of tablespaces, so its name cannot be the same as any tablespace.</p>
</li>
<li>
<p>You can specify a tablespace group name wherever a tablespace name would appear when you assign a default temporary tablespace for the database or a temporary tablespace for a user.</p>
</li>
</ul>
<p>You do not explicitly create a tablespace group. Rather, it is created implicitly when you assign the first temporary tablespace to the group. The group is deleted when the last temporary tablespace it contains is removed from it.</p>
<p>The view <code class="codeph">DBA_TABLESPACE_GROUPS</code> lists tablespace groups and their member tablespaces.</p>
<div class="infoboxnotealso" id="GUID-A90A82C7-E06D-416F-842E-704A95FF2AB5__GUID-40B7B6FE-4E9A-47D5-8DB7-17C56106C11F">
<p class="notep1">See Also:</p>
<p><a class="olink DBSEG10240" target="_blank" href="../DBSEG/users.htm#DBSEG10240"><span class="italic">Oracle Database Security Guide</span></a> for more information about assigning a temporary tablespace or tablespace group to a user</p>
</div>
</div>
</div>
<a id="ADMIN11370"></a>
<div class="props_rev_3"><a id="GUID-B885556A-C400-4245-9A6D-539A5F4A573F"></a>
<h4 id="ADMIN-GUID-B885556A-C400-4245-9A6D-539A5F4A573F" class="sect4"><span class="enumeration_section">13.2.7.2</span> Creating a Tablespace Group</h4>
<div>
<p>You create a tablespace group implicitly when you include the <code class="codeph">TABLESPACE GROUP</code> clause in the <code class="codeph">CREATE TEMPORARY TABLESPACE</code> or <code class="codeph">ALTER TABLESPACE</code> statement and the specified tablespace group does not currently exist.</p>
<div class="section">
<p>For example, if neither <code class="codeph">group1</code> nor <code class="codeph">group2</code> exists, then the following statements create those groups, each of which has only the specified tablespace as a member:</p>
<pre dir="ltr">CREATE TEMPORARY TABLESPACE lmtemp2 TEMPFILE &#39;/u02/oracle/data/lmtemp201.dbf&#39;
     SIZE 50M
     TABLESPACE GROUP group1;

ALTER TABLESPACE lmtemp TABLESPACE GROUP group2;
</pre></div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11371"></a>
<div class="props_rev_3"><a id="GUID-957E8D32-3B84-4584-A79E-D78886408D54"></a>
<h4 id="ADMIN-GUID-957E8D32-3B84-4584-A79E-D78886408D54" class="sect4"><span class="enumeration_section">13.2.7.3</span> Changing Members of a Tablespace Group</h4>
<div>
<p>You can add a tablespace to an existing tablespace group by specifying the existing group name in the <code class="codeph">TABLESPACE GROUP</code> clause of the <code class="codeph">CREATE TEMPORARY TABLESPACE</code> or <code class="codeph">ALTER TABLESPACE</code> statement.</p>
<div class="section">
<p>For example, the following statement adds a tablespace to an existing group. It creates and adds tablespace <code class="codeph">lmtemp3</code> to <code class="codeph">group1</code>, so that <code class="codeph">group1</code> contains tablespaces <code class="codeph">lmtemp2</code> and <code class="codeph">lmtemp3</code>.</p>
<pre dir="ltr">CREATE TEMPORARY TABLESPACE lmtemp3 TEMPFILE &#39;/u02/oracle/data/lmtemp301.dbf&#39;
     SIZE 25M
     TABLESPACE GROUP group1;
</pre>
<p>The following statement also adds a tablespace to an existing group, but in this case because tablespace <code class="codeph">lmtemp2</code> already belongs to <code class="codeph">group1</code>, it is in effect moved from <code class="codeph">group1</code> to <code class="codeph">group2</code>:</p>
<pre dir="ltr">ALTER TABLESPACE lmtemp2 TABLESPACE GROUP group2;
</pre>
<p>Now <code class="codeph">group2</code> contains both <code class="codeph">lmtemp</code> and <code class="codeph">lmtemp2</code>, while <code class="codeph">group1</code> consists of only <code class="codeph">tmtemp3</code>.</p>
<p>You can remove a tablespace from a group as shown in the following statement:</p>
<pre dir="ltr">ALTER TABLESPACE lmtemp3 TABLESPACE GROUP &#39;&#39;;
</pre>
<p>Tablespace <code class="codeph">lmtemp3</code> no longer belongs to any group. Further, since there are no longer any members of <code class="codeph">group1</code>, this results in the implicit deletion of <code class="codeph">group1</code>.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11372"></a>
<div class="props_rev_3"><a id="GUID-A023C39E-ABDA-48FA-AE76-9FAAE2881F45"></a>
<h4 id="ADMIN-GUID-A023C39E-ABDA-48FA-AE76-9FAAE2881F45" class="sect4"><span class="enumeration_section">13.2.7.4</span> Assigning a Tablespace Group as the Default Temporary Tablespace</h4>
<div>
<p>Use the <code class="codeph">ALTER DATABASE...DEFAULT</code> <code class="codeph">TEMPORARY</code> <code class="codeph">TABLESPACE</code> statement to assign a tablespace group as the default temporary tablespace for the database.</p>
<div class="section">
<p>For example:</p>
<pre dir="ltr">ALTER DATABASE DEFAULT TEMPORARY TABLESPACE group2;
</pre>
<p>Any user who has not explicitly been assigned a temporary tablespace will now use tablespaces <code class="codeph">lmtemp</code> and <code class="codeph">lmtemp2</code>.</p>
<p>If a tablespace group is specified as the default temporary tablespace, you cannot drop any of its member tablespaces. You must first remove the tablespace from the tablespace group. Likewise, you cannot drop a single temporary tablespace as long as it is the default temporary tablespace.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<a id="ADMIN14233"></a>
<div class="props_rev_3"><a id="GUID-6880021F-F8C3-4DE5-AA62-8536186B7016"></a>
<h2 id="ADMIN-GUID-6880021F-F8C3-4DE5-AA62-8536186B7016" class="sect2"><span class="enumeration_section">13.3</span> Consider Storing Tablespaces in the In-Memory Column Store</h2>
<div>
<p>You can enable a tablespace for the In-Memory Column Store during tablespace creation or by altering a tablespace. When this enable a tablespace for the In-Memory Column Store, all tables in the tablespace are enabled for the In-Memory Column Store by default.</p>
<div class="infobox-note" id="GUID-6880021F-F8C3-4DE5-AA62-8536186B7016__GUID-8122DD85-B71F-4C65-8ADE-A78AC9CF54F4">
<p class="notep1">Note:</p>
<p>This feature is available starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2).</p>
</div>
<p>The In-Memory Column Store is an optional portion of the system global area (SGA) that stores copies of tables, table partitions, and other database objects that is optimized for rapid scans. In the In-Memory Column Store, table data is stored by column rather than row in the SGA.</p>
<div class="infoboxnotealso" id="GUID-6880021F-F8C3-4DE5-AA62-8536186B7016__GUID-00828EA3-6AF1-40EE-B878-6825A0BCDEBD">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="memory.htm#GUID-636A1675-838D-4004-9CDB-70783DC72C6B" title="You can enable or disable tablespaces for the IM column store.">Enabling and Disabling Tablespaces for the IM Column Store</a>&#34;</span></p>
</div>
</div>
</div>
<a id="ADMIN11373"></a>
<div class="props_rev_3"><a id="GUID-A789CECE-226C-4280-8BC4-39F064036965"></a>
<h2 id="ADMIN-GUID-A789CECE-226C-4280-8BC4-39F064036965" class="sect2"><span class="enumeration_section">13.4</span> Specifying Nonstandard Block Sizes for Tablespaces</h2>
<div>
<p>You can create tablespaces with block sizes different from the standard database block size, which is specified by the <code class="codeph">DB_BLOCK_SIZE</code> initialization parameter. This feature lets you transport tablespaces with unlike block sizes between databases.</p>
<div class="section">
<p>To create a tablespace with a block size different from the database standard block size:</p>
<ul style="list-style-type: disc;">
<li>
<p>Use the <code class="codeph">BLOCKSIZE</code> clause of the <code class="codeph">CREATE TABLESPACE</code> statement.</p>
</li>
</ul>
<p>In order for the <code class="codeph">BLOCKSIZE</code> clause to succeed, you must have already set the <a id="d108609e3598" class="indexterm-anchor"></a><a id="d108609e3602" class="indexterm-anchor"></a><code class="codeph">DB_CACHE_SIZE</code> and at least one <code class="codeph">DB_nK_CACHE_SIZE</code> initialization parameter. Further, and the integer you specify in the <code class="codeph">BLOCKSIZE</code> clause must correspond with the setting of one <code class="codeph">DB_nK_CACHE_SIZE</code> parameter setting. Although redundant, specifying a <code class="codeph">BLOCKSIZE</code> equal to the standard block size, as specified by the <code class="codeph">DB_BLOCK_SIZE</code> initialization parameter, is allowed.</p>
<p>The following statement creates tablespace <code class="codeph">lmtbsb</code>, but specifies a block size that differs from the standard database block size (as specified by the <code class="codeph">DB_BLOCK_SIZE</code> initialization parameter):</p>
<pre dir="ltr">CREATE TABLESPACE lmtbsb DATAFILE &#39;/u02/oracle/data/lmtbsb01.dbf&#39; SIZE 50M
    EXTENT MANAGEMENT LOCAL UNIFORM SIZE 128K
    BLOCKSIZE 8K; 
</pre>
<div class="infoboxnotealso" id="GUID-A789CECE-226C-4280-8BC4-39F064036965__GUID-105DD05C-907B-45DB-A2AC-59CFBD8DD348">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="create.htm#GUID-55124C2D-98FF-4305-8F25-58245C9BEC1E" title="The DB_BLOCK_SIZE initialization parameter specifies the standard block size for the database.">Specifying Database Block Sizes</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="memory.htm#GUID-CEF55C3D-298C-406A-9D97-BB5279CDCE1E" title="The buffer cache initialization parameters determine the size of the buffer cache component of the SGA.">Setting the Buffer Cache Initialization Parameters</a>&#34;</span> for information about the <code class="codeph">DB_CACHE_SIZE</code> and <code class="codeph">DB_nK_CACHE_SIZE</code> parameter settings</p>
</li>
<li>
<p><span class="q">&#34;<a href="transport.htm#GUID-F7B2B591-AA88-4D16-8DCF-712763923FFB" title="You can transport tablespaces between databases.">Transporting Tablespaces Between Databases</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11374"></a>
<div class="props_rev_3"><a id="GUID-A1939693-60AC-4009-B37C-A1D8D1360D49"></a>
<h2 id="ADMIN-GUID-A1939693-60AC-4009-B37C-A1D8D1360D49" class="sect2"><span class="enumeration_section">13.5</span> Controlling the Writing of Redo Records</h2>
<div>
<p>For some database operations, you can control whether the database generates redo records.</p>
<div class="section">
<p>Without redo, no media recovery is possible. However, suppressing redo generation can improve performance, and may be appropriate for easily recoverable operations. An example of such an operation is a <code class="codeph">CREATE TABLE...AS SELECT</code> statement, which can be repeated in case of database or instance failure.</p>
<p>To suppress redo when these operations are performed for objects within the tablespace:</p>
<ul style="list-style-type: disc;">
<li>
<p>Specify the <code class="codeph">NOLOGGING</code> clause in the <code class="codeph">CREATE TABLESPACE</code> statement.</p>
</li>
</ul>
<p>If you do not include this clause, or if you specify <code class="codeph">LOGGING</code> instead, then the database generates redo when changes are made to objects in the tablespace. Redo is never generated for temporary segments or in temporary tablespaces, regardless of the logging attribute.</p>
<p>The logging attribute specified at the tablespace level is the default attribute for objects created within the tablespace. You can override this default logging attribute by specifying <code class="codeph">LOGGING</code> or <code class="codeph">NOLOGGING</code> at the schema object level--for example, in a <code class="codeph">CREATE TABLE</code> statement.</p>
<p>If you have a standby database, <code class="codeph">NOLOGGING</code> mode causes problems with the availability and accuracy of the standby database. To overcome this problem, you can specify <code class="codeph">FORCE LOGGING</code> mode. When you include the <code class="codeph">FORCE LOGGING</code> clause in the <code class="codeph">CREATE TABLESPACE</code> statement, you force the generation of redo records for all operations that make changes to objects in a tablespace. This overrides any specification made at the object level.</p>
<p>If you transport a tablespace that is in <code class="codeph">FORCE LOGGING</code> mode to another database, the new tablespace will not maintain the <code class="codeph">FORCE LOGGING</code> mode.</p>
<div class="infoboxnotealso" id="GUID-A1939693-60AC-4009-B37C-A1D8D1360D49__GUID-07BA0E38-158F-4DF3-A85D-E841B9A1B714">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink SQLRF30009" target="_blank" href="../SQLRF/clauses005.htm#SQLRF30009"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about operations that can be done in <code class="codeph">NOLOGGING</code> mode</p>
</li>
<li>
<p><span class="q">&#34;<a href="create.htm#GUID-ACEA5B83-D70F-4F30-A85B-3030248F597B" title="Some data definition language statements (such as CREATE TABLE) allow the NOLOGGING clause, which causes some database operations not to generate redo records in the database redo log. The NOLOGGING setting can speed up operations that can be easily recovered outside of the database recovery mechanisms, but it can negatively affect media recovery and standby databases.">Specifying FORCE LOGGING Mode</a>&#34;</span> for more information about <code class="codeph">FORCE LOGGING</code> mode and for information about the effects of the <code class="codeph">FORCE LOGGING</code> clause used with the <code class="codeph">CREATE DATABASE</code> statement</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11375"></a>
<div class="props_rev_3"><a id="GUID-B1D83CF4-9404-4689-8716-A0E2918ACE91"></a>
<h2 id="ADMIN-GUID-B1D83CF4-9404-4689-8716-A0E2918ACE91" class="sect2"><span class="enumeration_section">13.6</span> Altering Tablespace Availability</h2>
<div>
<p>You can take an online tablespace offline so that it is temporarily unavailable for general use. The rest of the database remains open and available for users to access data. Conversely, you can bring an offline tablespace online to make the schema objects within the tablespace available to database users. The database must be open to alter the availability of a tablespace.</p>
<p>To alter the availability of a tablespace, use the <code class="codeph">ALTER TABLESPACE</code> statement. You must have the <code class="codeph">ALTER TABLESPACE</code> or <code class="codeph">MANAGE TABLESPACE</code> system privilege.</p>
<div class="infoboxnotealso" id="GUID-B1D83CF4-9404-4689-8716-A0E2918ACE91__GUID-3D2149F0-F83A-47D4-8DBF-EC7FD123985C">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="dfiles.htm#GUID-B6AD08B7-675E-48FA-B8DA-0C8496F44B28" title="You can alter the availability of individual data files or temp files by taking them offline or bringing them online. Offline data files are unavailable to the database and cannot be accessed until they are brought back online.">Altering Data File Availability</a>&#34;</span> for information about altering the availability of individual data files within a tablespace</p>
</div>
</div>
<a id="ADMIN11376"></a>
<div class="props_rev_3"><a id="GUID-6EDD3FE0-D302-43F5-AA61-F96DBCF68E0D"></a>
<h3 id="ADMIN-GUID-6EDD3FE0-D302-43F5-AA61-F96DBCF68E0D" class="sect3"><span class="enumeration_section">13.6.1</span> Taking Tablespaces Offline</h3>
<div>
<p>Taking a tablespace offline makes it unavailable for normal access.</p>
<div class="section">
<p>You may want to take a tablespace offline for any of the following reasons:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>To make a portion of the database unavailable while allowing normal access to the remainder of the database</p>
</li>
<li>
<p>To perform an offline tablespace backup (even though a tablespace can be backed up while online and in use)</p>
</li>
<li>
<p>To make an application and its group of tables temporarily unavailable while updating or maintaining the application</p>
</li>
<li>
<p>To rename or relocate tablespace data files</p>
<p>See <span class="q">&#34;<a href="dfiles.htm#GUID-B0CB3536-EB2D-4319-9563-D698905E67D4" title="You can rename online or offline data files to either change their names or relocate them.">Renaming and Relocating Data Files</a>&#34;</span> for details.</p>
</li>
</ul>
<p>To take a tablespace offline:</p>
<ul style="list-style-type: disc;">
<li>
<p>Run an <code class="codeph">ALTER TABLESPACE</code> statement with the <code class="codeph">OFFLINE</code> clause.</p>
</li>
</ul>
<p>When a tablespace is taken offline, the database takes all the associated files offline.</p>
<p>You cannot take the following tablespaces offline:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">SYSTEM</code></p>
</li>
<li>
<p>The undo tablespace</p>
</li>
<li>
<p>Temporary tablespaces</p>
</li>
</ul>
<p>Before taking a tablespace offline, consider altering the tablespace allocation of any users who have been assigned the tablespace as a default tablespace. Doing so is advisable because those users will not be able to access objects in the tablespace while it is offline.</p>
<p>You can specify any of the following parameters as part of the <code class="codeph">ALTER TABLESPACE...OFFLINE</code> statement:</p>
<div class="tblformal" id="GUID-6EDD3FE0-D302-43F5-AA61-F96DBCF68E0D__GUID-33695882-4578-4FA2-8750-0626A0E18A0D">
<table class="cellalignment1849" summary="Column 1 lists the clauses that can be specified when taking a tablespace offline. Column 2 explains the meaning of the clause.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1863" id="d108609e4089">Clause</th>
<th class="cellalignment1959" id="d108609e4092">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1865" id="d108609e4097" headers="d108609e4089">
<p><code class="codeph">NORMAL</code></p>
</td>
<td class="cellalignment1960" headers="d108609e4097 d108609e4092">
<p>A tablespace can be taken offline normally if no error conditions exist for any of the data files of the tablespace. No data file in the tablespace can be currently offline as the result of a write error. When you specify <code class="codeph">OFFLINE NORMAL</code>, the database takes a checkpoint for all data files of the tablespace as it takes them offline. <code class="codeph">NORMAL</code> is the default.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1865" id="d108609e4111" headers="d108609e4089">
<p><code class="codeph">TEMPORARY</code></p>
</td>
<td class="cellalignment1960" headers="d108609e4111 d108609e4092">
<p>A tablespace can be taken offline temporarily, even if there are error conditions for one or more files of the tablespace. When you specify <code class="codeph">OFFLINE TEMPORARY</code>, the database takes offline the data files that are not already offline, checkpointing them as it does so.</p>
<p>If no files are offline, but you use the temporary clause, media recovery is not required to bring the tablespace back online. However, if one or more files of the tablespace are offline because of write errors, and you take the tablespace offline temporarily, the tablespace requires recovery before you can bring it back online.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1865" id="d108609e4124" headers="d108609e4089">
<p><code class="codeph">IMMEDIATE</code></p>
</td>
<td class="cellalignment1960" headers="d108609e4124 d108609e4092">
<p>A tablespace can be taken offline immediately, without the database taking a checkpoint on any of the data files. When you specify <code class="codeph">OFFLINE IMMEDIATE</code>, media recovery for the tablespace is required before the tablespace can be brought online. You cannot take a tablespace offline immediately if the database is running in <code class="codeph">NOARCHIVELOG</code> mode.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="infobox-note" id="GUID-6EDD3FE0-D302-43F5-AA61-F96DBCF68E0D__GUID-842CAB26-E51E-4875-9FFC-5304C4A66C36">
<p class="notep1">Note:</p>
<p>If you must take a tablespace offline, use the <code class="codeph">NORMAL</code> clause (the default) if possible. This setting guarantees that the tablespace will not require recovery to come back online, even if after incomplete recovery you reset the redo log sequence using an <code class="codeph">ALTER DATABASE OPEN RESETLOGS</code> statement.</p>
</div>
<p>Specify <code class="codeph">TEMPORARY</code> only when you cannot take the tablespace offline normally. In this case, only the files taken offline because of errors need to be recovered before the tablespace can be brought online. Specify <code class="codeph">IMMEDIATE</code> only after trying both the normal and temporary settings.</p>
<p>The following example takes the <code class="codeph">users</code> tablespace offline normally:</p>
<pre dir="ltr">ALTER TABLESPACE users OFFLINE NORMAL;
</pre></div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11377"></a>
<div class="props_rev_3"><a id="GUID-2F283784-527B-451A-A94F-2823720E1BC4"></a>
<h3 id="ADMIN-GUID-2F283784-527B-451A-A94F-2823720E1BC4" class="sect3"><span class="enumeration_section">13.6.2</span> Bringing Tablespaces Online</h3>
<div>
<p>You can bring any tablespace in an Oracle Database online whenever the database is open. A tablespace is normally online so that the data contained within it is available to database users.</p>
<div class="section">
<p>To bring a tablespace online:</p>
<ul style="list-style-type: disc;">
<li>
<p>Run an <code class="codeph">ALTER TABLESPACE</code> statement with the <code class="codeph">ONLINE</code> clause.</p>
</li>
</ul>
<p>If a tablespace to be brought online was not taken offline &#34;cleanly&#34; (that is, using the <code class="codeph">NORMAL</code> clause of the <code class="codeph">ALTER TABLESPACE OFFLINE</code> statement), you must first perform media recovery on the tablespace before bringing it online. Otherwise, the database returns an error and the tablespace remains offline.</p>
<p>For example, the following statement brings the <code class="codeph">users</code> tablespace online:</p>
<pre dir="ltr">ALTER TABLESPACE users ONLINE;
</pre>
<div class="infoboxnotealso" id="GUID-2F283784-527B-451A-A94F-2823720E1BC4__GUID-9B446D05-4ECD-4F5C-B7A0-9BA3193AA884">
<p class="notep1">See Also:</p>
<p><a class="olink BRADV" target="_blank" href="../BRADV/toc.htm"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> for information about performing media recovery</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<div class="sect2"><a id="GUID-4E714569-F95D-4742-8CEF-3A12769C870F"></a>
<h2 id="ADMIN-GUID-4E714569-F95D-4742-8CEF-3A12769C870F" class="sect2"><span class="enumeration_section">13.7</span> Using Read-Only Tablespaces</h2>
<p>A tablespace can be put into read-only mode. This prevents any data stored in it from being updated.</p>
<a id="ADMIN11378"></a>
<div class="props_rev_3"><a id="GUID-F9840816-246E-46DF-9B85-A0BFB3E0E0D8"></a>
<h3 id="ADMIN-GUID-F9840816-246E-46DF-9B85-A0BFB3E0E0D8" class="sect3"><span class="enumeration_section">13.7.1</span> About Read-Only Tablespaces</h3>
<div>
<p>Making a tablespace read-only prevents write operations on the data files in the tablespace.</p>
<p>The primary purpose of read-only tablespaces is to eliminate the need to perform backup and recovery of large, static portions of a database. Read-only tablespaces also provide a way to protecting historical data so that users cannot modify it. Making a tablespace read-only prevents updates on all tables in the tablespace, regardless of a user&#39;s update privilege level.</p>
<div class="infobox-note" id="GUID-F9840816-246E-46DF-9B85-A0BFB3E0E0D8__GUID-8DE9D259-7470-4431-A85D-528F01F51043">
<p class="notep1">Note:</p>
<p>Making a tablespace read-only cannot in itself be used to satisfy archiving or data publishing requirements, because the tablespace can only be brought online in the database in which it was created. However, you can meet such requirements by using the transportable tablespace feature, as described in <span class="q">&#34;<a href="transport.htm#GUID-F7B2B591-AA88-4D16-8DCF-712763923FFB" title="You can transport tablespaces between databases.">Transporting Tablespaces Between Databases</a>&#34;</span>.</p>
</div>
<p>You can drop items, such as tables or indexes, from a read-only tablespace, but you cannot create or alter objects in a read-only tablespace. You can execute statements that update the file description in the data dictionary, such as <code class="codeph">ALTER TABLE...ADD</code> or <code class="codeph">ALTER TABLE...MODIFY</code>, but you will not be able to use the new description until the tablespace is made read/write.</p>
<p>Read-only tablespaces can be transported to other databases. And, since read-only tablespaces can never be updated, they can reside on CD-ROM or WORM (Write Once-Read Many) devices.</p>
<div class="infoboxnotealso" id="GUID-F9840816-246E-46DF-9B85-A0BFB3E0E0D8__GUID-EDD0B79C-FDB8-4468-B3C7-403526909A1F">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="transport.htm#GUID-F7B2B591-AA88-4D16-8DCF-712763923FFB" title="You can transport tablespaces between databases.">Transporting Tablespaces Between Databases</a>&#34;</span></p>
</div>
</div>
</div>
<a id="ADMIN11379"></a>
<div class="props_rev_3"><a id="GUID-2A8D6E99-184C-490A-855A-CAB0E61880BD"></a>
<h3 id="ADMIN-GUID-2A8D6E99-184C-490A-855A-CAB0E61880BD" class="sect3"><span class="enumeration_section">13.7.2</span> Making a Tablespace Read-Only</h3>
<div>
<p>You can make a tablespace read-only using the <code class="codeph">ALTER TABLESPACE</code> statement with the <code class="codeph">READ ONLY</code> clause.</p>
<div class="section">
<p>All tablespaces are initially created as read/write. You must have the <code class="codeph">ALTER TABLESPACE</code> or <code class="codeph">MANAGE TABLESPACE</code> system privilege.</p>
<p>Before you can make a tablespace read-only, the following conditions must be met.</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>The tablespace must be online. This is necessary to ensure that there is no undo information that must be applied to the tablespace.</p>
</li>
<li>
<p>The tablespace cannot be the active undo tablespace or <code class="codeph">SYSTEM</code> tablespace.</p>
</li>
<li>
<p>The tablespace must not currently be involved in an online backup, because the end of a backup updates the header file of all data files in the tablespace.</p>
</li>
<li>
<p>The tablespace cannot be a temporary tablespace.</p>
</li>
</ul>
<p>To change a tablespace to read-only:</p>
<ul style="list-style-type: disc;">
<li>
<p>Use the <code class="codeph">READ ONLY</code> clause in the <code class="codeph">ALTER TABLESPACE</code> statement.</p>
</li>
</ul>
<p>For example the following statement makes the <code class="codeph">flights</code> tablespace read-only:</p>
<pre dir="ltr">ALTER TABLESPACE flights READ ONLY;
</pre>
<p>For better performance while accessing data in a read-only tablespace, you can issue a query that accesses all of the blocks of the tables in the tablespace just before making it read-only. A simple query, such as <code class="codeph">SELECT COUNT (*)</code>, executed against each table ensures that the data blocks in the tablespace can be subsequently accessed most efficiently. This eliminates the need for the database to check the status of the transactions that most recently modified the blocks.</p>
<p>You can issue the <code class="codeph">ALTER TABLESPACE...READ ONLY</code> statement while the database is processing transactions. After the statement is issued, the tablespace is put into a transitional read-only mode, and the <code class="codeph">ALTER</code> command waits for existing transactions to complete by committing or by rolling back. No further DML operations are allowed to the tablespace, and if a DML statement attempts further changes, then an error is returned.</p>
<p>The <code class="codeph">ALTER TABLESPACE...READ ONLY</code> statement waits for the following transactions to either commit or roll back before returning: transactions that have pending or uncommitted changes to the tablespace and that were started before you issued the statement. If a transaction started before the statement remains active, but rolls back to a savepoint, rolling back its changes to the tablespace, then the statement no longer waits for this active transaction.</p>
<p>If you find it is taking a long time for the <code class="codeph">ALTER TABLESPACE</code> statement to complete, then you can identify the transactions that are preventing the read-only state from taking effect. You can then notify the owners of those transactions and decide whether to terminate the transactions, if necessary.</p>
<p>The following example identifies the transaction entry for the <code class="codeph">ALTER TABLESPACE...READ ONLY</code> statement and displays its session address (<code class="codeph">saddr</code>):</p>
<pre dir="ltr">SELECT SQL_TEXT, SADDR 
    FROM V$SQLAREA,V$SESSION
    WHERE V$SQLAREA.ADDRESS = V$SESSION.SQL_ADDRESS    
        AND SQL_TEXT LIKE &#39;alter tablespace%&#39;; 

SQL_TEXT                                 SADDR   
---------------------------------------- --------
alter tablespace tbs1 read only          80034AF0
</pre>
<p>The start SCN of each active transaction is stored in the <code class="codeph">V$TRANSACTION</code> view. Displaying this view sorted by ascending start SCN lists the transactions in execution order. From the preceding example, you already know the session address of the transaction entry for the read-only statement, and you can now locate it in the <code class="codeph">V$TRANSACTION</code> view. All transactions with smaller start SCN, which indicates an earlier execution, can potentially hold up the quiesce and subsequent read-only state of the tablespace.</p>
<pre dir="ltr">SELECT SES_ADDR, START_SCNB 
    FROM V$TRANSACTION
    ORDER BY START_SCNB;

SES_ADDR START_SCNB
-------- ----------
800352A0       3621   --&gt; waiting on this txn
80035A50       3623   --&gt; waiting on this txn
80034AF0       3628   --&gt; this is the ALTER TABLESPACE statement
80037910       3629   --&gt; don&#39;t care about this txn
</pre>
<p>You can now find the owners of the blocking transactions.</p>
<pre dir="ltr">SELECT T.SES_ADDR, S.USERNAME, S.MACHINE
   FROM V$SESSION S, V$TRANSACTION T
   WHERE T.SES_ADDR = S.SADDR
   ORDER BY T.SES_ADDR

SES_ADDR USERNAME             MACHINE
-------- -------------------- --------------------
800352A0 DAVIDB               DAVIDBLAP             --&gt; Contact this user
80035A50 MIKEL                LAB61                 --&gt; Contact this user
80034AF0 DBA01                STEVEFLAP           
80037910 NICKD                NICKDLAP
</pre>
<p>After making the tablespace read-only, it is advisable to back it up immediately. As long as the tablespace remains read-only, no further backups of the tablespace are necessary, because no changes can be made to it.</p>
<div class="infoboxnotealso" id="GUID-2A8D6E99-184C-490A-855A-CAB0E61880BD__GUID-52AB2557-48B6-458F-A912-3406C2CB9C0B">
<p class="notep1">See Also:</p>
<p><a class="olink BRADV002" target="_blank" href="../BRADV/rcmcncpt.htm#BRADV002"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11380"></a>
<div class="props_rev_3"><a id="GUID-4CD9317E-7B1A-4C7E-B4EA-7754187F4641"></a>
<h3 id="ADMIN-GUID-4CD9317E-7B1A-4C7E-B4EA-7754187F4641" class="sect3"><span class="enumeration_section">13.7.3</span> Making a Read-Only Tablespace Writable</h3>
<div>
<p>Making a read-only tablespace writable allows write operations on the data files in the tablespace.</p>
<div class="section">
<p>You must have the <code class="codeph">ALTER TABLESPACE</code> or <code class="codeph">MANAGE TABLESPACE</code> system privilege.</p>
<p>To change a tablespace to allow write operations:</p>
<ul style="list-style-type: disc;">
<li>
<p>Use the <code class="codeph">READ WRITE</code> keywords in the <code class="codeph">ALTER TABLESPACE</code> statement</p>
</li>
</ul>
<p>A prerequisite to making the tablespace read/write is that all of the data files in the tablespace, as well as the tablespace itself, must be online. Use the <code class="codeph">DATAFILE...ONLINE</code> clause of the <code class="codeph">ALTER DATABASE</code> statement to bring a data file online. The <code class="codeph">V$DATAFILE</code> view lists the current status of data files.</p>
<p>For example, the following statement makes the <code class="codeph">flights</code> tablespace writable:</p>
<pre dir="ltr">ALTER TABLESPACE flights READ WRITE;
</pre>
<p>Making a read-only tablespace writable updates the control file entry for the data files, so that you can use the read-only version of the data files as a starting point for recovery.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11381"></a>
<div class="props_rev_3"><a id="GUID-E2C4AE3B-1986-44F3-9DA6-42ED0D5149BD"></a>
<h3 id="ADMIN-GUID-E2C4AE3B-1986-44F3-9DA6-42ED0D5149BD" class="sect3"><span class="enumeration_section">13.7.4</span> Creating a Read-Only Tablespace on a WORM Device</h3>
<div>
<p>You can create a read-only tablespace on a CD-ROM or WORM (Write Once-Read Many) device.</p>
<div class="section">
<p>Follow these steps to create a read-only tablespace on a CD-ROM or WORM device.</p>
</div>
<!-- class="section" -->
<ol>
<li><span>Create a writable tablespace on another device. Create the objects that belong in the tablespace and insert your data.</span></li>
<li><span>Alter the tablespace to make it read-only.</span></li>
<li><span>Copy the data files of the tablespace onto the WORM device. Use operating system commands to copy the files.</span></li>
<li><span>Take the tablespace offline.</span></li>
<li><span>Rename the data files to coincide with the names of the data files you copied onto your WORM device. Use <code class="codeph">ALTER TABLESPACE</code> with the <code class="codeph">RENAME DATAFILE</code> clause. Renaming the data files changes their names in the control file.</span></li>
<li><span>Bring the tablespace back online.</span></li>
</ol>
</div>
</div>
<a id="ADMIN11382"></a>
<div class="props_rev_3"><a id="GUID-48620168-E32E-4C5B-9D96-8A3AA6CEAE9D"></a>
<h3 id="ADMIN-GUID-48620168-E32E-4C5B-9D96-8A3AA6CEAE9D" class="sect3"><span class="enumeration_section">13.7.5</span> Delaying the Opening of Data Files in Read-Only Tablespaces</h3>
<div>
<p>You can delay the opening of data files for read-only tablespaces until there is an attempt to access them.</p>
<div class="section">
<p>When substantial portions of a very large database are stored in read-only tablespaces that are located on slow-access devices or hierarchical storage, you should consider setting the <code class="codeph">READ_ONLY_OPEN_DELAYED</code> initialization parameter to <code class="codeph">TRUE</code>. This speeds certain operations, primarily opening the database, by causing data files in read-only tablespaces to be accessed for the first time only when an attempt is made to read data stored within them.</p>
<p>Setting <code class="codeph">READ_ONLY_OPEN_DELAYED=TRUE</code> has the following side-effects:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>A missing or bad read-only file is not detected at open time. It is only discovered when there is an attempt to access it.</p>
</li>
<li>
<p><code class="codeph">ALTER SYSTEM CHECK DATAFILES</code> does not check read-only files.</p>
</li>
<li>
<p><code class="codeph">ALTER TABLESPACE...ONLINE</code> and <code class="codeph">ALTER DATABASE</code> <code class="codeph">DATAFILE...ONLINE</code> do not check read-only files. They are checked only upon the first access.</p>
</li>
<li>
<p><code class="codeph">V$RECOVER_FILE</code>, <code class="codeph">V$BACKUP</code>, and <code class="codeph">V$DATAFILE_HEADER</code> do not access read-only files. Read-only files are indicated in the results list with the error &#34;<code class="codeph">DELAYED OPEN</code>&#34;, with zeroes for the values of other columns.</p>
</li>
<li>
<p><code class="codeph">V$DATAFILE</code> does not access read-only files. Read-only files have a size of &#34;0&#34; listed.</p>
</li>
<li>
<p><code class="codeph">V$RECOVERY_LOG</code> does not access read-only files. Logs they could need for recovery are not added to the list.</p>
</li>
<li>
<p><code class="codeph">ALTER DATABASE NOARCHIVELOG</code> does not access read-only files. It proceeds even if there is a read-only file that requires recovery.</p>
<div class="infobox-note" id="GUID-48620168-E32E-4C5B-9D96-8A3AA6CEAE9D__GUID-6195C908-54B3-43C1-A249-98E35CFFD535">
<p class="notep1">Note:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">RECOVER DATABASE</code> and <code class="codeph">ALTER DATABASE OPEN RESETLOGS</code> continue to access all read-only data files regardless of the parameter value. To avoid accessing read-only files for these operations, take those files offline.</p>
</li>
<li>
<p>If a backup control file is used, the read-only status of some files may be inaccurate. This can cause some of these operations to return unexpected results. Care should be taken in this situation.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="ADMIN12490"></a>
<div class="props_rev_3"><a id="GUID-C207AC96-0F99-4F05-B3DD-E4A4FA17F98C"></a>
<h2 id="ADMIN-GUID-C207AC96-0F99-4F05-B3DD-E4A4FA17F98C" class="sect2"><span class="enumeration_section">13.8</span> Altering and Maintaining Tablespaces</h2>
<p>You can alter and maintain tablespaces by performing such tasks as adding data files and temp files to them.</p>
<a id="ADMIN13453"></a>
<div class="props_rev_3"><a id="GUID-8F37D598-B406-4259-B3A9-E6CE6B9D0207"></a>
<h3 id="ADMIN-GUID-8F37D598-B406-4259-B3A9-E6CE6B9D0207" class="sect3"><span class="enumeration_section">13.8.1</span> Increasing the Size of a Tablespace</h3>
<div>
<p>You can increase the size of a tablespace by either increasing the size of a data file in the tablespace or adding one.</p>
<div class="section">
<p>See <span class="q">&#34;<a href="dfiles.htm#GUID-8E7A9714-85CB-45F3-8384-00D68EAC3E58" title="You can alter the size of a data file. For example, you can increase the size of one or more data files when more space is needed in the database.">Changing Data File Size</a>&#34;</span> and <span class="q">&#34;<a href="dfiles.htm#GUID-814D8847-5327-41A3-8959-444C40093B46" title="You can create data files and associate them with a tablespace using several different SQL statements.">Creating Data Files and Adding Data Files to a Tablespace</a> &#34;</span> for more information.</p>
<p>Additionally, you can enable automatic file extension (<code class="codeph">AUTOEXTEND</code>) to data files and bigfile tablespaces. See <span class="q">&#34;<a href="dfiles.htm#GUID-C633A6CC-F1A9-415A-B153-5C2053BBB7E6" title="You can create data files or alter existing data files so that they automatically increase in size when more space is needed in the database. The file size increases in specified increments up to a specified maximum.">Enabling and Disabling Automatic Extension for a Data File</a>&#34;</span>.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11362"></a>
<div class="props_rev_3"><a id="GUID-FB734C25-BA3A-45E8-BDCE-77C668140B67"></a>
<h3 id="ADMIN-GUID-FB734C25-BA3A-45E8-BDCE-77C668140B67" class="sect3"><span class="enumeration_section">13.8.2</span> Altering a Locally Managed Tablespace</h3>
<div>
<p>You can add a data file to a locally managed tablespace, alter its availability, make it read-only or read/write, rename it, or enable/disable autoextension.</p>
<div class="section">
<p>You cannot alter a locally managed tablespace to a locally managed temporary tablespace, nor can you change its method of segment space management. Coalescing free extents is unnecessary for locally managed tablespaces. However, you can use the <code class="codeph">ALTER TABLESPACE</code> statement on locally managed tablespaces for some operations, including the following:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Adding a data file. For example:</p>
<pre dir="ltr">ALTER TABLESPACE lmtbsb
   ADD DATAFILE &#39;/u02/oracle/data/lmtbsb02.dbf&#39; SIZE 1M;
</pre></li>
<li>
<p>Altering tablespace availability (<code class="codeph">ONLINE</code>/<code class="codeph">OFFLINE</code>). See <span class="q">&#34;<a href="tspaces.htm#GUID-B1D83CF4-9404-4689-8716-A0E2918ACE91" title="You can take an online tablespace offline so that it is temporarily unavailable for general use. The rest of the database remains open and available for users to access data. Conversely, you can bring an offline tablespace online to make the schema objects within the tablespace available to database users. The database must be open to alter the availability of a tablespace.">Altering Tablespace Availability</a> &#34;</span>.</p>
</li>
<li>
<p>Making a tablespace read-only or read/write. See <span class="q">&#34;<a href="tspaces.htm#GUID-F9840816-246E-46DF-9B85-A0BFB3E0E0D8" title="Making a tablespace read-only prevents write operations on the data files in the tablespace.">Using Read-Only Tablespaces</a>&#34;</span>.</p>
</li>
<li>
<p>Renaming a data file, or enabling or disabling the autoextension of the size of a data file in the tablespace. See <a href="dfiles.htm#GUID-501A8889-3C18-4F99-B0B7-9095E981B970" title="You can manage data files and temp files by performing tasks such as creating them, altering them, and dropping them.">Managing Data Files and Temp Files</a>.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11364"></a>
<div class="props_rev_3"><a id="GUID-3060B641-E131-404D-B415-1A319222ED2A"></a>
<h3 id="ADMIN-GUID-3060B641-E131-404D-B415-1A319222ED2A" class="sect3"><span class="enumeration_section">13.8.3</span> Altering a Bigfile Tablespace</h3>
<div>
<p>You can resize or autoextend a bigfile tablespace.</p>
<div class="section">
<p>Two clauses of the <code class="codeph">ALTER TABLESPACE</code> statement support data file transparency when you are using bigfile tablespaces:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">RESIZE</code>: The <code class="codeph">RESIZE</code> clause lets you resize the single data file in a bigfile tablespace to an absolute size, without referring to the data file. For example:</p>
<pre dir="ltr">ALTER TABLESPACE bigtbs RESIZE 80G;
</pre></li>
<li>
<p><code class="codeph">AUTOEXTEND</code> (used outside of the <code class="codeph">ADD</code> <code class="codeph">DATAFILE</code> clause):</p>
<p>With a bigfile tablespace, you can use the <code class="codeph">AUTOEXTEND</code> clause outside of the <code class="codeph">ADD</code> <code class="codeph">DATAFILE</code> clause. For example:</p>
<pre dir="ltr">ALTER TABLESPACE bigtbs AUTOEXTEND ON NEXT 20G;
</pre></li>
</ul>
<p>An error is raised if you specify an <code class="codeph">ADD</code> <code class="codeph">DATAFILE</code> clause for a bigfile tablespace<a id="d108609e5340" class="indexterm-anchor"></a>.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11369"></a>
<div class="props_rev_3"><a id="GUID-18750D59-2CE2-4D7B-9E5A-C52F89814D90"></a>
<h3 id="ADMIN-GUID-18750D59-2CE2-4D7B-9E5A-C52F89814D90" class="sect3"><span class="enumeration_section">13.8.4</span> Altering a Locally Managed Temporary Tablespace</h3>
<div>
<p>You can alter a locally managed temporary tablespace to add a temp file, take a temp file offline, or bring a temp file online.</p>
<div class="section">
<div class="infobox-note" id="GUID-18750D59-2CE2-4D7B-9E5A-C52F89814D90__GUID-16957C26-C8EB-402A-8EBF-7C3492512117">
<p class="notep1">Note:</p>
<p>You cannot use the <code class="codeph">ALTER TABLESPACE</code> statement, with the <code class="codeph">TEMPORARY</code> keyword, to change a locally managed permanent tablespace into a locally managed temporary tablespace. You must use the <code class="codeph">CREATE TEMPORARY TABLESPACE</code> statement to create a locally managed temporary tablespace.</p>
</div>
<p>You can use <code class="codeph">ALTER TABLESPACE</code> to add a temp file, take a temp file offline, or bring a temp file online, as illustrated in the following examples:</p>
<pre dir="ltr">ALTER TABLESPACE lmtemp
   ADD TEMPFILE &#39;/u02/oracle/data/lmtemp02.dbf&#39; SIZE 18M REUSE;

ALTER TABLESPACE lmtemp TEMPFILE OFFLINE;
ALTER TABLESPACE lmtemp TEMPFILE ONLINE;
</pre>
<div class="infobox-note" id="GUID-18750D59-2CE2-4D7B-9E5A-C52F89814D90__GUID-F953DF16-6374-4C0D-A898-4EF9F05FDD47">
<p class="notep1">Note:</p>
<p>You cannot take a temporary tablespace offline. Instead, you take its temp file offline. The view <code class="codeph">V$TEMPFILE</code> displays online status for a temp file.</p>
</div>
<p>The <code class="codeph">ALTER DATABASE</code> statement can be used to alter temp files.</p>
<p>The following statements take offline and bring online temp files. They behave identically to the last two <code class="codeph">ALTER</code> <code class="codeph">TABLESPACE</code> statements in the previous example.</p>
<pre dir="ltr">ALTER DATABASE TEMPFILE &#39;/u02/oracle/data/lmtemp02.dbf&#39; OFFLINE;
ALTER DATABASE TEMPFILE &#39;/u02/oracle/data/lmtemp02.dbf&#39; ONLINE;
</pre>
<p>The following statement resizes a temp file:</p>
<pre dir="ltr">ALTER DATABASE TEMPFILE &#39;/u02/oracle/data/lmtemp02.dbf&#39; RESIZE 18M;
</pre>
<p>The following statement drops a temp file and deletes its operating system file:</p>
<pre dir="ltr">ALTER DATABASE TEMPFILE &#39;/u02/oracle/data/lmtemp02.dbf&#39; DROP
    INCLUDING DATAFILES;
</pre>
<p>The tablespace to which this temp file belonged remains. A message is written to the alert log for the temp file that was deleted. If an operating system error prevents the deletion of the file, the statement still succeeds, but a message describing the error is written to the alert log.</p>
<p>It is also possible to use the <code class="codeph">ALTER DATABASE</code> statement to enable or disable the automatic extension of an existing temp file, and to rename a temp file. See <a class="olink SQLRF00802" target="_blank" href="../SQLRF/statements_1006.htm#SQLRF00802"><span class="italic">Oracle Database SQL Language Reference</span></a> for the required syntax.</p>
<div class="infobox-note" id="GUID-18750D59-2CE2-4D7B-9E5A-C52F89814D90__GUID-D3583621-3A34-4F47-AECC-86BAE6CA7A15">
<p class="notep1">Note:</p>
<p>To rename a temp file, you take the temp file offline, use operating system commands to rename or relocate the temp file, and then use the <code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> <code class="codeph">RENAME</code> <code class="codeph">FILE</code> command to update the database control files.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN12353"></a>
<div class="props_rev_3"><a id="GUID-CF57ECCF-0032-4C64-9B37-489F538D0AA7"></a>
<h3 id="ADMIN-GUID-CF57ECCF-0032-4C64-9B37-489F538D0AA7" class="sect3"><span class="enumeration_section">13.8.5</span> Shrinking a Locally Managed Temporary Tablespace</h3>
<div>
<p>You can shrink locally managed temporary tablespaces and release unused space.</p>
<div class="section">
<p>Large sort operations performed by the database may result in a temporary tablespace growing and occupying a considerable amount of disk space. After the sort operation completes, the extra space is not released; it is just marked as free and available for reuse. Therefore, a single large sort operation might result in a large amount of allocated temporary space that remains unused after the sort operation is complete. For this reason, the database enables you to shrink locally managed temporary tablespaces and release unused space.</p>
<p>To shrink a temporary tablespace:</p>
<ul style="list-style-type: disc;">
<li>
<p>Use the <code class="codeph">SHRINK SPACE</code> clause of the <code class="codeph">ALTER TABLESPACE</code> statement.</p>
</li>
</ul>
<p>To shrink a specific temp file of a temporary tablespace:</p>
<ul style="list-style-type: disc;">
<li>
<p>Use the <code class="codeph">SHRINK TEMPFILE</code> clause of the <code class="codeph">ALTER TABLESPACE</code> statement .</p>
</li>
</ul>
<p>Shrinking frees as much space as possible while maintaining the other attributes of the tablespace or temp file. The optional <code class="codeph">KEEP</code> clause defines a minimum size for the tablespace or temp file.</p>
<p>Shrinking is an online operation, which means that user sessions can continue to allocate sort extents if needed, and already-running queries are not affected.</p>
<p>The following example shrinks the locally managed temporary tablespace <code class="codeph">lmtmp1</code> while ensuring a minimum size of 20M.</p>
<pre dir="ltr">ALTER TABLESPACE lmtemp1 SHRINK SPACE KEEP 20M;
</pre>
<p>The following example shrinks the temp file <code class="codeph">lmtemp02.dbf</code> of the locally managed temporary tablespace <code class="codeph">lmtmp2</code>. Because the <code class="codeph">KEEP</code> clause is omitted, the database attempts to shrink the temp file to the minimum possible size.</p>
<pre dir="ltr">ALTER TABLESPACE lmtemp2 SHRINK TEMPFILE &#39;/u02/oracle/data/lmtemp02.dbf&#39;;
</pre></div>
<!-- class="section" --></div>
</div>
</div>
<a id="ADMIN01104"></a>
<div class="props_rev_3"><a id="GUID-C0FEF3C9-3877-40F4-97C8-592A3BAEE522"></a>
<h2 id="ADMIN-GUID-C0FEF3C9-3877-40F4-97C8-592A3BAEE522" class="sect2"><span class="enumeration_section">13.9</span> Renaming Tablespaces</h2>
<div>
<p>Using the <code class="codeph">RENAME TO</code> clause of the <code class="codeph">ALTER TABLESPACE</code>, you can rename a permanent or temporary tablespace.</p>
<div class="section">
<p>For example, the following statement renames the <code class="codeph">users</code> tablespace:</p>
<pre dir="ltr">ALTER TABLESPACE users RENAME TO usersts;
</pre>
<p>When you rename a tablespace the database updates all references to the tablespace name in the data dictionary, control file, and (online) data file headers. The database does not change the tablespace ID so if this tablespace were, for example, the default tablespace for a user, then the renamed tablespace would show as the default tablespace for the user in the <code class="codeph">DBA_USERS</code> view.</p>
<p>The following affect the operation of this statement:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>If the tablespace being renamed is the <code class="codeph">SYSTEM</code> tablespace or the <code class="codeph">SYSAUX</code> tablespace, then it will not be renamed and an error is raised.</p>
</li>
<li>
<p>If any data file in the tablespace is offline, or if the tablespace is offline, then the tablespace is not renamed and an error is raised.</p>
</li>
<li>
<p>If the tablespace is read only, then data file headers are not updated. This should not be regarded as corruption; instead, it causes a message to be written to the alert log indicating that data file headers have not been renamed. The data dictionary and control file are updated.</p>
</li>
<li>
<p>If the tablespace is the default temporary tablespace, then the corresponding entry in the database properties table is updated and the <code class="codeph">DATABASE_PROPERTIES</code> view shows the new name.</p>
</li>
<li>
<p>If the tablespace is an undo tablespace and if the following conditions are met, then the tablespace name is changed to the new tablespace name in the server parameter file (<code class="codeph">SPFILE</code>).</p>
<ul style="list-style-type: disc;">
<li>
<p>The server parameter file was used to start up the database.</p>
</li>
<li>
<p>The tablespace name is specified as the <code class="codeph">UNDO_TABLESPACE</code> for any instance.</p>
</li>
</ul>
<p>If a traditional initialization parameter file (<code class="codeph">PFILE</code>) is being used then a message is written to the alert log stating that the initialization parameter file must be manually changed.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11383"></a>
<div class="props_rev_3"><a id="GUID-4EB483A2-2E04-4047-8885-F5396876D0EB"></a>
<h2 id="ADMIN-GUID-4EB483A2-2E04-4047-8885-F5396876D0EB" class="sect2"><span class="enumeration_section">13.10</span> Dropping Tablespaces</h2>
<div>
<p>You can drop a tablespace and its contents (the segments contained in the tablespace) from the database if the tablespace and its contents are no longer required.</p>
<div class="section">
<p>You must have the <code class="codeph">DROP</code> <code class="codeph">TABLESPACE</code> system privilege to drop a tablespace.</p>
<div class="infobox-note" id="GUID-4EB483A2-2E04-4047-8885-F5396876D0EB__GUID-55A47466-E07F-4C3E-9B29-D89B5BDB69EC">
<p class="notep1">Note:</p>
<p>Once a tablespace has been dropped, the data in the tablespace is not recoverable. Therefore, ensure that all data contained in a tablespace to be dropped will not be required in the future. Also, immediately before and after dropping a tablespace from a database, back up the database completely. This is <span class="italic">strongly recommended</span> so that you can recover the database if you mistakenly drop a tablespace, or if the database experiences a problem in the future after the tablespace has been dropped.</p>
</div>
<p>When you drop a tablespace, the file pointers in the control file of the associated database are removed. You can optionally direct Oracle Database to delete the operating system files (data files) that constituted the dropped tablespace. If you do not direct the database to delete the data files at the same time that it deletes the tablespace, you must later use the appropriate commands of your operating system to delete them.</p>
<p>You cannot drop a tablespace that contains any active segments. For example, if a table in the tablespace is currently being used or the tablespace contains undo data needed to roll back uncommitted transactions, you cannot drop the tablespace. The tablespace can be online or offline, but it is best to take the tablespace offline before dropping it.</p>
<p>To drop a tablespace:</p>
<ul style="list-style-type: disc;">
<li>
<p>Use the <code class="codeph">DROP TABLESPACE</code> statement.</p>
</li>
</ul>
<p>The following statement drops the <code class="codeph">users</code> tablespace, including the segments in the tablespace:</p>
<pre dir="ltr">DROP TABLESPACE users INCLUDING CONTENTS;
</pre>
<p>If the tablespace is empty (does not contain any tables, views, or other structures), you do not need to specify the <code class="codeph">INCLUDING CONTENTS</code> clause. Use the <code class="codeph">CASCADE CONSTRAINTS</code> clause to drop all referential integrity constraints from tables outside the tablespace that refer to primary and unique keys of tables inside the tablespace.</p>
<p>To delete the data files associated with a tablespace at the same time that the tablespace is dropped, use the <code class="codeph">INCLUDING CONTENTS AND DATAFILES</code> clause. The following statement drops the <code class="codeph">users</code> tablespace and its associated data files:</p>
<pre dir="ltr">DROP TABLESPACE users INCLUDING CONTENTS AND DATAFILES;
</pre>
<p>A message is written to the alert log for each data file that is deleted. If an operating system error prevents the deletion of a file, the <code class="codeph">DROP TABLESPACE</code> statement still succeeds, but a message describing the error is written to the alert log.</p>
<div class="infoboxnotealso" id="GUID-4EB483A2-2E04-4047-8885-F5396876D0EB__GUID-EC9B1FB1-2A77-464A-9698-D9E192AA7DC7">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="dfiles.htm#GUID-35078A43-B11C-4E9B-9404-9D4BF0EB7C77" title="You use the DROP DATAFILE and DROP TEMPFILE clauses of the ALTER TABLESPACE statement to drop a single data file or temp file.">Dropping Data Files</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11384"></a>
<div class="props_rev_3"><a id="GUID-30942290-88DD-4D62-816F-F7EDCE661710"></a>
<h2 id="ADMIN-GUID-30942290-88DD-4D62-816F-F7EDCE661710" class="sect2"><span class="enumeration_section">13.11</span> Managing the SYSAUX Tablespace</h2>
<div>
<p>The <code class="codeph">SYSAUX</code> tablespace was installed as an auxiliary tablespace to the <code class="codeph">SYSTEM</code> tablespace when you created your database. Some database components that formerly created and used separate tablespaces now occupy the <code class="codeph">SYSAUX</code> tablespace.</p>
<p>If the <code class="codeph">SYSAUX</code> tablespace becomes unavailable, core database functionality will remain operational. The database features that use the <code class="codeph">SYSAUX</code> tablespace could fail, or function with limited capability.</p>
</div>
<a id="ADMIN11385"></a>
<div class="props_rev_3"><a id="GUID-7B9613A0-1B17-48A3-B61E-728D875A2560"></a>
<h3 id="ADMIN-GUID-7B9613A0-1B17-48A3-B61E-728D875A2560" class="sect3"><span class="enumeration_section">13.11.1</span> Monitoring Occupants of the SYSAUX Tablespace</h3>
<div>
<p>You can monitor the occupants of the <code class="codeph">SYSAUX</code> tablespace.</p>
<div class="section">
<p>The list of registered occupants of the <code class="codeph">SYSAUX</code> tablespace are discussed in <span class="q">&#34;<a href="create.htm#GUID-C70E0886-7D9A-4B0D-BA0B-DF71AB5A2154" title="The SYSAUX tablespace is always created at database creation. The SYSAUX tablespace serves as an auxiliary tablespace to the SYSTEM tablespace. Because it is the default tablespace for many Oracle Database features and products that previously required their own tablespaces, it reduces the number of tablespaces required by the database. It also reduces the load on the SYSTEM tablespace.">About the SYSAUX Tablespace</a>&#34;</span>. These components can use the <code class="codeph">SYSAUX</code> tablespace, and their installation provides the means of establishing their occupancy of the <code class="codeph">SYSAUX</code> tablespace.</p>
<p>To monitor the occupants of the <code class="codeph">SYSAUX</code> tablespace:</p>
<ul style="list-style-type: disc;">
<li>
<p>Query the <code class="codeph">V$SYSAUX_OCCUPANTS</code> view.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p>This view lists the following information about the occupants of the <code class="codeph">SYSAUX</code> tablespace:</p>
<ul style="list-style-type: disc;">
<li>
<p>Name of the occupant</p>
</li>
<li>
<p>Occupant description</p>
</li>
<li>
<p>Schema name</p>
</li>
<li>
<p>Move procedure</p>
</li>
<li>
<p>Current space usage</p>
</li>
</ul>
<p>View information is maintained by the occupants.</p>
<div class="infoboxnotealso" id="GUID-7B9613A0-1B17-48A3-B61E-728D875A2560__GUID-4BC7BA6F-4A70-4E64-831E-779A29CDECED">
<p class="notep1">See Also:</p>
<p><a class="olink REFRN30271" target="_blank" href="../REFRN/GUID-B51B594E-08D9-4042-A2BB-F6321721D8F9.htm#REFRN30271"><span class="italic">Oracle Database Reference</span></a> for a detailed description of the <code class="codeph">V$SYSAUX_OCCUPANTS</code> view</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11386"></a>
<div class="props_rev_3"><a id="GUID-C0E5C7A8-8220-48DF-B632-E43D4AE4FA1A"></a>
<h3 id="ADMIN-GUID-C0E5C7A8-8220-48DF-B632-E43D4AE4FA1A" class="sect3"><span class="enumeration_section">13.11.2</span> Moving Occupants Out Of or Into the SYSAUX Tablespace</h3>
<div>
<p>The <code class="codeph">V$SYSAUX_OCCUPANTS</code> view provides a move procedure for each occupant of the <code class="codeph">SYSAUX</code> tablespace.</p>
<div class="section">
<p>You will have an option at component install time to specify that you do not want the component to reside in <code class="codeph">SYSAUX</code>. Also, if you later decide that the component should be relocated to a designated tablespace, you can use the move procedure for that component, as specified in the <code class="codeph">V$SYSAUX_OCCUPANTS</code> view, to perform the move.</p>
<p>The move procedure also lets you move a component from another tablespace into the <code class="codeph">SYSAUX</code> tablespace.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11387"></a>
<div class="props_rev_3"><a id="GUID-B5C0C299-CFDE-4F98-A205-AA20C33EA671"></a>
<h3 id="ADMIN-GUID-B5C0C299-CFDE-4F98-A205-AA20C33EA671" class="sect3"><span class="enumeration_section">13.11.3</span> Controlling the Size of the SYSAUX Tablespace</h3>
<div>
<p>The <code class="codeph">SYSAUX</code> tablespace is occupied by several database components, and its total size is governed by the space consumed by those components. The space consumed by the components, in turn, depends on which features or functionality are being used and on the nature of the database workload.</p>
<div class="section">
<p>The largest portion of the <code class="codeph">SYSAUX</code> tablespace is occupied by the Automatic Workload Repository (AWR). The space consumed by the AWR is determined by several factors, including the number of active sessions in the system at any given time, the snapshot interval, and the historical data retention period. A typical system with an average of 10 concurrent active sessions may require approximately 200 to 300 MB of space for its AWR data.</p>
<p>The following table provides guidelines on sizing the <code class="codeph">SYSAUX</code> tablespace based on the system configuration and expected load.</p>
<div class="tblformal" id="GUID-B5C0C299-CFDE-4F98-A205-AA20C33EA671__GUID-9627AD4E-BC0C-4CEA-978A-1ED7EA6C519D">
<table class="cellalignment1849" summary="This table has 4 rows and 4 columns. It should be read one row at a time. Columns are: Parameter/Recommendation, Small, Medium, and Large.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1935" id="d108609e6343">Parameter/Recommendation</th>
<th class="cellalignment1857" id="d108609e6346">Small</th>
<th class="cellalignment1857" id="d108609e6349">Medium</th>
<th class="cellalignment1857" id="d108609e6352">Large</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1937" id="d108609e6357" headers="d108609e6343">
<p>Number of CPUs</p>
</td>
<td class="cellalignment1860" headers="d108609e6357 d108609e6346">
<p>2</p>
</td>
<td class="cellalignment1860" headers="d108609e6357 d108609e6349">
<p>8</p>
</td>
<td class="cellalignment1860" headers="d108609e6357 d108609e6352">
<p>32</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1937" id="d108609e6370" headers="d108609e6343">
<p>Number of concurrently active sessions</p>
</td>
<td class="cellalignment1860" headers="d108609e6370 d108609e6346">
<p>10</p>
</td>
<td class="cellalignment1860" headers="d108609e6370 d108609e6349">
<p>20</p>
</td>
<td class="cellalignment1860" headers="d108609e6370 d108609e6352">
<p>100</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1937" id="d108609e6383" headers="d108609e6343">
<p>Number of user objects: tables and indexes</p>
</td>
<td class="cellalignment1860" headers="d108609e6383 d108609e6346">
<p>500</p>
</td>
<td class="cellalignment1860" headers="d108609e6383 d108609e6349">
<p>5,000</p>
</td>
<td class="cellalignment1860" headers="d108609e6383 d108609e6352">
<p>50,000</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1937" id="d108609e6396" headers="d108609e6343">
<p>Estimated <code class="codeph">SYSAUX</code> size at steady state with default configuration</p>
</td>
<td class="cellalignment1860" headers="d108609e6396 d108609e6346">
<p>500 MB</p>
</td>
<td class="cellalignment1860" headers="d108609e6396 d108609e6349">
<p>2 GB</p>
</td>
<td class="cellalignment1860" headers="d108609e6396 d108609e6352">
<p>5 GB</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>You can control the size of the AWR by changing the snapshot interval and historical data retention period. For more information on managing the AWR snapshot interval and retention period, see <a class="olink TGDBA169" target="_blank" href="../TGDBA/gather_stats.htm#TGDBA169"><span class="italic">Oracle Database Performance Tuning Guide</span></a>.</p>
<p>Another major occupant of the <code class="codeph">SYSAUX</code> tablespace is the embedded Oracle Enterprise Manager Cloud Control repository. This repository is used by Cloud Control to store its metadata. The size of this repository depends on database activity and on configuration-related information stored in the repository.</p>
<p>Other database components in the <code class="codeph">SYSAUX</code> tablespace will grow in size only if their associated features (for example, Oracle Text and Oracle Streams) are in use. If the features are not used, then these components do not have any significant effect on the size of the <code class="codeph">SYSAUX</code> tablespace.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<div class="sect2"><a id="GUID-D6D25640-D278-4379-A502-6BCA3FC7C12D"></a>
<h2 id="ADMIN-GUID-D6D25640-D278-4379-A502-6BCA3FC7C12D" class="sect2"><span class="enumeration_section">13.12</span> Correcting Problems with Locally Managed Tablespaces</h2>
<p>Oracle Database includes aids for correcting problems with locally managed tablespaces.</p>
<a id="ADMIN12602"></a><a id="ADMIN10066"></a>
<div class="props_rev_3"><a id="GUID-40027632-7D50-4F15-B482-3D38A1C8A0A4"></a>
<h3 id="ADMIN-GUID-40027632-7D50-4F15-B482-3D38A1C8A0A4" class="sect3"><span class="enumeration_section">13.12.1</span> Diagnosing and Repairing Locally Managed Tablespace Problems</h3>
<div>
<p>Oracle Database includes the <code class="codeph">DBMS_SPACE_ADMIN</code> package, which is a collection of aids for diagnosing and repairing problems in locally managed tablespaces.</p>
<div class="section">
<p class="subhead3">DBMS_SPACE_ADMIN Package Procedures</p>
</div>
<!-- class="section" -->
<div class="section">
<p>The following table lists the <code class="codeph">DBMS_SPACE_ADMIN</code> package procedures. See <a class="olink ARPLS057" target="_blank" href="../ARPLS/d_spadmn.htm#ARPLS057"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for details on each procedure.</p>
<div class="tblformal" id="GUID-40027632-7D50-4F15-B482-3D38A1C8A0A4__GUID-2EE8DCDA-24DD-445B-A074-1E0B83CC8A95">
<table class="cellalignment1849" summary="Column 1 lists the procedures contained in the DBMS_SPACE_ADMIN package. Column 2 provides the description of each procedure.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1935" id="d108609e6596">Procedure</th>
<th class="cellalignment1936" id="d108609e6599">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1937" id="d108609e6604" headers="d108609e6596">
<p><code class="codeph">ASSM_SEGMENT_VERIFY</code></p>
</td>
<td class="cellalignment1938" headers="d108609e6604 d108609e6599">
<p>Verifies the integrity of segments created in tablespaces that have automatic segment space management enabled. Outputs a dump file named <span class="italic"><code class="codeph">sid</code></span><code class="codeph">_ora_</code><span class="italic"><code class="codeph">process_id</code></span>.<code class="codeph">trc</code> to the location that corresponds to the <code class="codeph">Diag</code> <code class="codeph">Trace</code> entry in the <code class="codeph">V$DIAG_INFO</code> view.</p>
<p>Use <code class="codeph">SEGMENT_VERIFY</code> for tablespaces with manual segment space management.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1937" id="d108609e6639" headers="d108609e6596">
<p><code class="codeph">ASSM_TABLESPACE_VERIFY</code></p>
</td>
<td class="cellalignment1938" headers="d108609e6639 d108609e6599">
<p>Verifies the integrity of tablespaces that have automatic segment space management enabled. Outputs a dump file named <span class="italic"><code class="codeph">sid</code></span><code class="codeph">_ora_</code><span class="italic"><code class="codeph">process_id</code></span>.<code class="codeph">trc</code> to the location that corresponds to the <code class="codeph">Diag</code> <code class="codeph">Trace</code> entry in the <code class="codeph">V$DIAG_INFO</code> view.</p>
<p>Use <code class="codeph">TABLESPACE_VERIFY</code> for tablespaces with manual segment space management.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1937" id="d108609e6674" headers="d108609e6596">
<p><code class="codeph">DROP_EMPTY_SEGMENTS</code></p>
</td>
<td class="cellalignment1938" headers="d108609e6674 d108609e6599">
<p>Drops segments from empty tables or table partitions and dependent objects</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1937" id="d108609e6682" headers="d108609e6596">
<p><code class="codeph">MATERIALIZE_DEFERRED_SEGMENTS</code></p>
</td>
<td class="cellalignment1938" headers="d108609e6682 d108609e6599">
<p>Materializes segments for tables and table partitions with deferred segment creation and their dependent objects.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1937" id="d108609e6690" headers="d108609e6596">
<p><code class="codeph">SEGMENT_CORRUPT</code></p>
</td>
<td class="cellalignment1938" headers="d108609e6690 d108609e6599">
<p>Marks the segment corrupt or valid so that appropriate error recovery can be done</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1937" id="d108609e6698" headers="d108609e6596">
<p><code class="codeph">SEGMENT_DROP_CORRUPT</code></p>
</td>
<td class="cellalignment1938" headers="d108609e6698 d108609e6599">
<p>Drops a segment currently marked corrupt (without reclaiming space)</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1937" id="d108609e6706" headers="d108609e6596">
<p><code class="codeph">SEGMENT_DUMP</code></p>
</td>
<td class="cellalignment1938" headers="d108609e6706 d108609e6599">
<p>Dumps the segment header and bitmap blocks of a specific segment to a dump file named <span class="italic"><code class="codeph">sid</code></span><code class="codeph">_ora_</code><span class="italic"><code class="codeph">process_id</code></span>.<code class="codeph">trc</code> in the location that corresponds to the <code class="codeph">Diag</code> <code class="codeph">Trace</code> entry in the <code class="codeph">V$DIAG_INFO</code> view. Provides an option to select a slightly abbreviated dump, which includes segment header and includes bitmap block summaries, without percent-free states of each block.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1937" id="d108609e6736" headers="d108609e6596">
<p><code class="codeph">SEGMENT_VERIFY</code></p>
</td>
<td class="cellalignment1938" headers="d108609e6736 d108609e6599">
<p>Verifies the consistency of the extent map of the segment</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1937" id="d108609e6744" headers="d108609e6596">
<p><code class="codeph">TABLESPACE_FIX_BITMAPS</code></p>
</td>
<td class="cellalignment1938" headers="d108609e6744 d108609e6599">
<p>Marks the appropriate DBA range (extent) as free or used in bitmap</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1937" id="d108609e6752" headers="d108609e6596">
<p><code class="codeph">TABLESPACE_FIX_SEGMENT_STATES</code></p>
</td>
<td class="cellalignment1938" headers="d108609e6752 d108609e6599">
<p>Fixes the state of the segments in a tablespace in which migration was stopped</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1937" id="d108609e6760" headers="d108609e6596">
<p><code class="codeph">TABLESPACE_MIGRATE_FROM_LOCAL</code></p>
</td>
<td class="cellalignment1938" headers="d108609e6760 d108609e6599">
<p>Migrates a locally managed tablespace to dictionary-managed tablespace</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1937" id="d108609e6769" headers="d108609e6596">
<p><code class="codeph">TABLESPACE_MIGRATE_TO_LOCAL</code></p>
</td>
<td class="cellalignment1938" headers="d108609e6769 d108609e6599">
<p>Migrates a dictionary-managed tablespace to a locally managed tablespace</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1937" id="d108609e6777" headers="d108609e6596">
<p><code class="codeph">TABLESPACE_REBUILD_BITMAPS</code></p>
</td>
<td class="cellalignment1938" headers="d108609e6777 d108609e6599">
<p>Rebuilds the appropriate bitmaps</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1937" id="d108609e6785" headers="d108609e6596">
<p><code class="codeph">TABLESPACE_REBUILD_QUOTAS</code></p>
</td>
<td class="cellalignment1938" headers="d108609e6785 d108609e6599">
<p>Rebuilds quotas for a specific tablespace</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1937" id="d108609e6793" headers="d108609e6596">
<p><code class="codeph">TABLESPACE_RELOCATE_BITMAPS</code></p>
</td>
<td class="cellalignment1938" headers="d108609e6793 d108609e6599">
<p>Relocates the bitmaps to the specified destination</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1937" id="d108609e6801" headers="d108609e6596">
<p><code class="codeph">TABLESPACE_VERIFY</code></p>
</td>
<td class="cellalignment1938" headers="d108609e6801 d108609e6599">
<p>Verifies that the bitmaps and extent maps for the segments in the tablespace are synchronized</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>The following scenarios describe typical situations in which you can use the <code class="codeph">DBMS_SPACE_ADMIN</code> package to diagnose and resolve problems.</p>
<div class="infobox-note" id="GUID-40027632-7D50-4F15-B482-3D38A1C8A0A4__GUID-07D2DD79-CC83-464F-96D9-D88A60CE3E7E">
<p class="notep1">Note:</p>
<p>Some of these procedures can result in lost and unrecoverable data if not used properly. You should work with Oracle Support Services if you have doubts about these procedures.</p>
</div>
<div class="infoboxnotealso" id="GUID-40027632-7D50-4F15-B482-3D38A1C8A0A4__GUID-F9A6AC97-2C9C-46DD-BBFB-17519CE2E1B6">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink ARPLS057" target="_blank" href="../ARPLS/d_spadmn.htm#ARPLS057"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for details about the <code class="codeph">DBMS_SPACE_ADMIN</code> package</p>
</li>
<li>
<p><span class="q">&#34;<a href="diag.htm#GUID-951A06EE-DDF7-4C2A-B0BB-B24418BB2E33__CHDJBHBJ">Viewing ADR Locations with the V$DIAG_INFO View</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11388"></a>
<div class="props_rev_3"><a id="GUID-49F5ECE9-5170-4268-97A2-E2EDA54B73CA"></a>
<h3 id="ADMIN-GUID-49F5ECE9-5170-4268-97A2-E2EDA54B73CA" class="sect3"><span class="enumeration_section">13.12.2</span> Scenario 1: Fixing Bitmap When Allocated Blocks are Marked Free (No Overlap)</h3>
<div>
<p>The <code class="codeph">TABLESPACE_VERIFY</code> procedure discovers that a segment has allocated blocks that are marked free in the bitmap, but no overlap between segments is reported.</p>
<div class="section">
<p>In this scenario, perform the following tasks:</p>
</div>
<!-- class="section" -->
<ol>
<li><span>Call the <code class="codeph">SEGMENT_DUMP</code> procedure to dump the ranges that the administrator allocated to the segment.</span></li>
<li><span>For each range, call the <code class="codeph">TABLESPACE_FIX_BITMAPS</code> procedure with the <code class="codeph">TABLESPACE_EXTENT_MAKE_USED</code> option to mark the space as used.</span></li>
<li><span>Call <code class="codeph">TABLESPACE_REBUILD_QUOTAS</code> to rebuild quotas.</span></li>
</ol>
</div>
</div>
<a id="ADMIN11389"></a>
<div class="props_rev_3"><a id="GUID-8DC6F205-9D98-4F68-8218-0846554C8CC9"></a>
<h3 id="ADMIN-GUID-8DC6F205-9D98-4F68-8218-0846554C8CC9" class="sect3"><span class="enumeration_section">13.12.3</span> Scenario 2: Dropping a Corrupted Segment</h3>
<div>
<p>You cannot drop a segment because the bitmap has segment blocks marked &#34;free&#34;. The system has automatically marked the segment corrupted.</p>
<div class="section">
<p>In this scenario, perform the following tasks:</p>
</div>
<!-- class="section" -->
<ol>
<li><span>Call the <code class="codeph">SEGMENT_VERIFY</code> procedure with the <code class="codeph">SEGMENT_VERIFY_EXTENTS_GLOBAL</code> option. If no overlaps are reported, then proceed with steps 2 through 5.</span></li>
<li><span>Call the <code class="codeph">SEGMENT_DUMP</code> procedure to dump the DBA ranges allocated to the segment.</span></li>
<li><span>For each range, call <code class="codeph">TABLESPACE_FIX_BITMAPS</code> with the <code class="codeph">TABLESPACE_EXTENT_MAKE_FREE</code> option to mark the space as free.</span></li>
<li><span>Call <code class="codeph">SEGMENT_DROP_CORRUPT</code> to drop the <code class="codeph">SEG$</code> entry.</span></li>
<li><span>Call <code class="codeph">TABLESPACE_REBUILD_QUOTAS</code> to rebuild quotas.</span></li>
</ol>
</div>
</div>
<a id="ADMIN11390"></a>
<div class="props_rev_3"><a id="GUID-08FF03F2-B2CA-4FA9-925B-2FF8900447A2"></a>
<h3 id="ADMIN-GUID-08FF03F2-B2CA-4FA9-925B-2FF8900447A2" class="sect3"><span class="enumeration_section">13.12.4</span> Scenario 3: Fixing Bitmap Where Overlap is Reported</h3>
<div>
<p>The <code class="codeph">TABLESPACE_VERIFY</code> procedure reports some overlapping. Some of the real data must be sacrificed based on previous internal errors.</p>
<div class="section">
<p>After choosing the object to be sacrificed, in this case say, table <code class="codeph">t1</code>, perform the following tasks:</p>
</div>
<!-- class="section" -->
<ol>
<li><span>Make a list of all objects that <code class="codeph">t1</code> overlaps.</span></li>
<li><span>Drop table <code class="codeph">t1</code>. If necessary, follow up by calling the <code class="codeph">SEGMENT_DROP_CORRUPT</code> procedure.</span></li>
<li><span>Call the <code class="codeph">SEGMENT_VERIFY</code> procedure on all objects that <code class="codeph">t1</code> overlapped. If necessary, call the <code class="codeph">TABLESPACE_FIX_BITMAPS</code> procedure to mark appropriate bitmap blocks as used.</span></li>
<li><span>Rerun the <code class="codeph">TABLESPACE_VERIFY</code> procedure to verify that the problem is resolved.</span></li>
</ol>
</div>
</div>
<a id="ADMIN11391"></a>
<div class="props_rev_3"><a id="GUID-C201EA55-11F9-40D6-8A7E-DE0A4980E076"></a>
<h3 id="ADMIN-GUID-C201EA55-11F9-40D6-8A7E-DE0A4980E076" class="sect3"><span class="enumeration_section">13.12.5</span> Scenario 4: Correcting Media Corruption of Bitmap Blocks</h3>
<div>
<p>A set of bitmap blocks has media corruption.</p>
<div class="section">
<p>In this scenario, perform the following tasks:</p>
</div>
<!-- class="section" -->
<ol>
<li><span>Call the <code class="codeph">TABLESPACE_REBUILD_BITMAPS</code> procedure, either on all bitmap blocks, or on a single block if only one is corrupt.</span></li>
<li><span>Call the <code class="codeph">TABLESPACE_REBUILD_QUOTAS</code> procedure to rebuild quotas.</span></li>
<li><span>Call the <code class="codeph">TABLESPACE_VERIFY</code> procedure to verify that the bitmaps are consistent.</span></li>
</ol>
</div>
</div>
<a id="ADMIN11392"></a>
<div class="props_rev_3"><a id="GUID-CA21AB80-6F6C-412E-807B-03899E4EAE09"></a>
<h3 id="ADMIN-GUID-CA21AB80-6F6C-412E-807B-03899E4EAE09" class="sect3"><span class="enumeration_section">13.12.6</span> Scenario 5: Migrating from a Dictionary-Managed to a Locally Managed Tablespace</h3>
<div>
<p>Use the <code class="codeph">TABLESPACE_MIGRATE_TO_LOCAL</code> procedure to migrate a dictionary-managed tablespace to a locally managed tablespace.</p>
<div class="section">
<p>This operation is done online, but space management operations are blocked until the migration has been completed. Therefore, you can read or modify data while the migration is in progress, but if you are loading a large amount of data that requires the allocation of additional extents, then the operation may be blocked.</p>
<p>Assume that the database block size is 2K and the existing extent sizes in tablespace <code class="codeph">tbs_1</code> are 10, 50, and 10,000 blocks (used, used, and free). The <code class="codeph">MINIMUM EXTENT</code> value is 20K (10 blocks). Allow the system to choose the bitmap allocation unit. The value of 10 blocks is chosen, because it is the highest common denominator and does not exceed <code class="codeph">MINIMUM EXTENT</code>.</p>
<p>The statement to convert <code class="codeph">tbs_1</code> to a locally managed tablespace is as follows:</p>
<pre dir="ltr">EXEC DBMS_SPACE_ADMIN.TABLESPACE_MIGRATE_TO_LOCAL (&#39;tbs_1&#39;);
</pre>
<p>If you choose to specify an allocation unit size, it must be a factor of the unit size calculated by the system.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="ADMIN11393"></a>
<div class="props_rev_3"><a id="GUID-C961302C-E712-48C2-A938-2509DB4404ED"></a>
<h2 id="ADMIN-GUID-C961302C-E712-48C2-A938-2509DB4404ED" class="sect2"><span class="enumeration_section">13.13</span> Migrating the SYSTEM Tablespace to a Locally Managed Tablespace</h2>
<div>
<p>Use the <code class="codeph">DBMS_SPACE_ADMIN.TABLESPACE_MIGRATE_TO_LOCAL</code> procedure to migrate the <code class="codeph">SYSTEM</code> tablespace from dictionary-managed to locally managed.</p>
<div class="section">
<p>Before performing the migration the following conditions must be met:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>The database has a default temporary tablespace that is not <code class="codeph">SYSTEM.</code></p>
</li>
<li>
<p>There are no rollback segments in the dictionary-managed tablespace.</p>
</li>
<li>
<p>There is at least one online rollback segment in a locally managed tablespace, or if using automatic undo management, an undo tablespace is online.</p>
</li>
<li>
<p>All tablespaces other than the tablespace containing the undo space (that is, the tablespace containing the rollback segment or the undo tablespace) are in read-only mode.</p>
</li>
<li>
<p>The <code class="codeph">SYSAUX</code> tablespace is offline.</p>
</li>
<li>
<p>The system is in restricted mode.</p>
</li>
<li>
<p>There is a cold backup of the database.</p>
</li>
</ul>
<p>All of these conditions, except for the cold backup, are enforced by the <code class="codeph">TABLESPACE_MIGRATE_TO_LOCAL</code> procedure.</p>
<p>The following statement performs the migration:</p>
<pre dir="ltr">SQL&gt; EXECUTE DBMS_SPACE_ADMIN.TABLESPACE_MIGRATE_TO_LOCAL(&#39;SYSTEM&#39;);
</pre>
<div class="infobox-note" id="GUID-C961302C-E712-48C2-A938-2509DB4404ED__GUID-3602ADE7-36CC-43AA-9911-9966AD732683">
<p class="notep1">Note:</p>
<p>After the <code class="codeph">SYSTEM</code> tablespace is migrated to locally managed, any dictionary-managed tablespaces in the database cannot be made read/write. If you want to use the dictionary-managed tablespaces in read/write mode, then Oracle recommends that you first migrate these tablespaces to locally managed before migrating the <code class="codeph">SYSTEM</code> tablespace.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<div class="sect2"><a id="GUID-638D5411-5C88-40C8-A888-3D9B21A551D1"></a>
<h2 id="ADMIN-GUID-638D5411-5C88-40C8-A888-3D9B21A551D1" class="sect2"><span class="enumeration_section">13.14</span> Viewing Information About Tablespaces</h2>
<p>Oracle Database includes data dictionary views that you can query for information about tablespaces.</p>
<a id="ADMIN11410"></a>
<div class="props_rev_3"><a id="GUID-BA500061-FEFF-4904-994B-89C015A80E7B"></a>
<h3 id="ADMIN-GUID-BA500061-FEFF-4904-994B-89C015A80E7B" class="sect3"><span class="enumeration_section">13.14.1</span> Tablespace Data Dictionary Views</h3>
<div>
<p>The following data dictionary and dynamic performance views provide useful information about the tablespaces of a database.</p>
<div class="section"></div>
<!-- class="section" -->
<div class="tblformal" id="GUID-BA500061-FEFF-4904-994B-89C015A80E7B__GUID-9E32DF55-838E-4910-9CE1-B21E92C64743">
<table class="cellalignment1849" summary="Column 1 lists the views that are used to contain information about the tablespaces of the database. Column 1 lists the view, column 2 describes each view.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1873" id="d108609e7565">View</th>
<th class="cellalignment1961" id="d108609e7568">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1876" id="d108609e7573" headers="d108609e7565">
<p><code class="codeph">V$TABLESPACE</code></p>
</td>
<td class="cellalignment1962" headers="d108609e7573 d108609e7568">
<p>Name and number of all tablespaces from the control file.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1876" id="d108609e7582" headers="d108609e7565">
<p><code class="codeph">V$ENCRYPTED_TABLESPACES</code></p>
</td>
<td class="cellalignment1962" headers="d108609e7582 d108609e7568">
<p>Name and encryption algorithm of all encrypted tablespaces.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1876" id="d108609e7590" headers="d108609e7565">
<p><code class="codeph">DBA_TABLESPACES</code>, <code class="codeph">USER_TABLESPACES</code></p>
</td>
<td class="cellalignment1962" headers="d108609e7590 d108609e7568">
<p>Descriptions of all (or user accessible) tablespaces.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1876" id="d108609e7602" headers="d108609e7565">
<p><code class="codeph">DBA_TABLESPACE_GROUPS</code></p>
</td>
<td class="cellalignment1962" headers="d108609e7602 d108609e7568">
<p>Displays the tablespace groups and the tablespaces that belong to them.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1876" id="d108609e7611" headers="d108609e7565">
<p><code class="codeph">DBA_SEGMENTS</code>, <code class="codeph">USER_SEGMENTS</code></p>
</td>
<td class="cellalignment1962" headers="d108609e7611 d108609e7568">
<p>Information about segments within all (or user accessible) tablespaces.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1876" id="d108609e7623" headers="d108609e7565">
<p><code class="codeph">DBA_EXTENTS</code>, <code class="codeph">USER_EXTENTS</code></p>
</td>
<td class="cellalignment1962" headers="d108609e7623 d108609e7568">
<p>Information about data extents within all (or user accessible) tablespaces.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1876" id="d108609e7635" headers="d108609e7565">
<p><code class="codeph">DBA_FREE_SPACE</code>, <code class="codeph">USER_FREE_SPACE</code></p>
</td>
<td class="cellalignment1962" headers="d108609e7635 d108609e7568">
<p>Information about free extents within all (or user accessible) tablespaces.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1876" id="d108609e7647" headers="d108609e7565">
<p><code class="codeph">DBA_TEMP_FREE_SPACE</code></p>
</td>
<td class="cellalignment1962" headers="d108609e7647 d108609e7568">
<p>Displays the total allocated and free space in each temporary tablespace.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1876" id="d108609e7655" headers="d108609e7565">
<p><code class="codeph">V$DATAFILE</code></p>
</td>
<td class="cellalignment1962" headers="d108609e7655 d108609e7568">
<p>Information about all data files, including tablespace number of owning tablespace.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1876" id="d108609e7664" headers="d108609e7565">
<p><code class="codeph">V$TEMPFILE</code></p>
</td>
<td class="cellalignment1962" headers="d108609e7664 d108609e7568">
<p>Information about all temp files, including tablespace number of owning tablespace.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1876" id="d108609e7673" headers="d108609e7565">
<p><code class="codeph">DBA_DATA_FILES</code></p>
</td>
<td class="cellalignment1962" headers="d108609e7673 d108609e7568">
<p>Shows files (data files) belonging to tablespaces.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1876" id="d108609e7683" headers="d108609e7565">
<p><code class="codeph">DBA_TEMP_FILES</code></p>
</td>
<td class="cellalignment1962" headers="d108609e7683 d108609e7568">
<p>Shows files (temp files) belonging to temporary tablespaces.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1876" id="d108609e7692" headers="d108609e7565">
<p><code class="codeph">V$TEMP_EXTENT_MAP</code></p>
</td>
<td class="cellalignment1962" headers="d108609e7692 d108609e7568">
<p>Information for all extents in all locally managed temporary tablespaces.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1876" id="d108609e7701" headers="d108609e7565">
<p><code class="codeph">V$TEMP_EXTENT_POOL</code></p>
</td>
<td class="cellalignment1962" headers="d108609e7701 d108609e7568">
<p>For locally managed temporary tablespaces: the state of temporary space cached and used for by each instance.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1876" id="d108609e7710" headers="d108609e7565">
<p><code class="codeph">V$TEMP_SPACE_HEADER</code></p>
</td>
<td class="cellalignment1962" headers="d108609e7710 d108609e7568">
<p>Shows space used/free for each temp file.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1876" id="d108609e7719" headers="d108609e7565">
<p><code class="codeph">DBA_USERS</code></p>
</td>
<td class="cellalignment1962" headers="d108609e7719 d108609e7568">
<p>Default and temporary tablespaces for all users.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1876" id="d108609e7727" headers="d108609e7565">
<p><code class="codeph">DBA_TS_QUOTAS</code></p>
</td>
<td class="cellalignment1962" headers="d108609e7727 d108609e7568">
<p>Lists tablespace quotas for all users.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1876" id="d108609e7736" headers="d108609e7565">
<p><code class="codeph">V$SORT_SEGMENT</code></p>
</td>
<td class="cellalignment1962" headers="d108609e7736 d108609e7568">
<p>Information about every sort segment in a given instance. The view is only updated when the tablespace is of the <code class="codeph">TEMPORARY</code> type.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1876" id="d108609e7748" headers="d108609e7565">
<p><code class="codeph">V$TEMPSEG_USAGE</code></p>
</td>
<td class="cellalignment1962" headers="d108609e7748 d108609e7568">
<p>Describes temporary (sort) segment usage by user for temporary or permanent tablespaces.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<p>The following are just a few examples of using some of these views.</p>
<div class="infoboxnotealso" id="GUID-BA500061-FEFF-4904-994B-89C015A80E7B__GUID-FEA56D73-740C-4ED0-B39D-EA45EF91DA7F">
<p class="notep1">See Also:</p>
<p><a class="olink REFRN" target="_blank" href="../REFRN/toc.htm"><span class="italic">Oracle Database Reference</span></a> for complete description of these views</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11411"></a>
<div class="props_rev_3"><a id="GUID-11CA5E21-97FE-4083-96A9-8F63C28FC526"></a>
<h3 id="ADMIN-GUID-11CA5E21-97FE-4083-96A9-8F63C28FC526" class="sect3"><span class="enumeration_section">13.14.2</span> Example 1: Listing Tablespaces and Default Storage Parameters</h3>
<div>
<p>You can query the <code class="codeph">DBA_TABLESPACES</code> view to list the names and default storage parameters.</p>
<div class="section">
<p>To list the names and default storage parameters of all tablespaces in a database, use the following query on the <code class="codeph">DBA_TABLESPACES</code> view:</p>
<pre dir="ltr">SELECT TABLESPACE_NAME &#34;TABLESPACE&#34;,
   INITIAL_EXTENT &#34;INITIAL_EXT&#34;,
   NEXT_EXTENT &#34;NEXT_EXT&#34;,
   MIN_EXTENTS &#34;MIN_EXT&#34;,
   MAX_EXTENTS &#34;MAX_EXT&#34;,
   PCT_INCREASE
   FROM DBA_TABLESPACES;

TABLESPACE  INITIAL_EXT  NEXT_EXT  MIN_EXT   MAX_EXT    PCT_INCREASE  
----------  -----------  --------  -------   -------    ------------ 
RBS             1048576   1048576        2        40               0
SYSTEM           106496    106496        1        99               1
TEMP             106496    106496        1        99               0
TESTTBS           57344     16384        2        10               1
USERS             57344     57344        1        99               1
</pre></div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11412"></a>
<div class="props_rev_3"><a id="GUID-26CA2E22-55F3-4FCA-AAB6-53BAA38BB695"></a>
<h3 id="ADMIN-GUID-26CA2E22-55F3-4FCA-AAB6-53BAA38BB695" class="sect3"><span class="enumeration_section">13.14.3</span> Example 2: Listing the Data Files and Associated Tablespaces of a Database</h3>
<div>
<p>You can query the <code class="codeph">DBA_DATA_FILES</code> view to list the names, sizes, and associated tablespaces of a database.</p>
<div class="section">
<p>To list the names, sizes, and associated tablespaces of a database, enter the following query on the <code class="codeph">DBA_DATA_FILES</code> view:</p>
<pre dir="ltr">SELECT  FILE_NAME, BLOCKS, TABLESPACE_NAME
   FROM DBA_DATA_FILES;

FILE_NAME                                      BLOCKS  TABLESPACE_NAME
------------                               ----------  -------------------
/U02/ORACLE/IDDB3/DBF/RBS01.DBF                  1536  RBS
/U02/ORACLE/IDDB3/DBF/SYSTEM01.DBF               6586  SYSTEM
/U02/ORACLE/IDDB3/DBF/TEMP01.DBF                 6400  TEMP
/U02/ORACLE/IDDB3/DBF/TESTTBS01.DBF              6400  TESTTBS
/U02/ORACLE/IDDB3/DBF/USERS01.DBF                 384  USERS
</pre></div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11413"></a>
<div class="props_rev_3"><a id="GUID-668EAC02-F586-4B92-9768-605F71A93461"></a>
<h3 id="ADMIN-GUID-668EAC02-F586-4B92-9768-605F71A93461" class="sect3"><span class="enumeration_section">13.14.4</span> Example 3: Displaying Statistics for Free Space (Extents) of Each Tablespace</h3>
<div>
<p>You can query the <code class="codeph">DBA_FREE_SPACE</code> view to display statistics about free extents and coalescing activity for each tablespace in the database.</p>
<div class="section">
<p>To produce statistics about free extents and coalescing activity for each tablespace in the database, enter the following query:</p>
<pre dir="ltr">SELECT TABLESPACE_NAME &#34;TABLESPACE&#34;, FILE_ID,
   COUNT(*)    &#34;PIECES&#34;,
   MAX(blocks) &#34;MAXIMUM&#34;,
   MIN(blocks) &#34;MINIMUM&#34;,
   AVG(blocks) &#34;AVERAGE&#34;,
   SUM(blocks) &#34;TOTAL&#34;
   FROM DBA_FREE_SPACE
GROUP BY TABLESPACE_NAME, FILE_ID;

TABLESPACE    FILE_ID  PIECES   MAXIMUM    MINIMUM  AVERAGE    TOTAL
----------    -------  ------   -------    -------  -------   ------
RBS                 2       1       955        955      955      955
SYSTEM              1       1       119        119      119      119
TEMP                4       1      6399       6399     6399     6399
TESTTBS             5       5      6364          3     1278     6390
USERS               3       1       363        363      363      363
</pre>
<p><code class="codeph">PIECES</code> shows the number of free space extents in the tablespace file, <code class="codeph">MAXIMUM</code> and <code class="codeph">MINIMUM</code> show the largest and smallest contiguous area of space in database blocks, <code class="codeph">AVERAGE</code> shows the average size in blocks of a free space extent, and <code class="codeph">TOTAL</code> shows the amount of free space in each tablespace file in blocks. This query is useful when you are going to create a new object or you know that a segment is about to extend, and you want to ensure that there is enough space in the containing tablespace.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1842">
<tr>
<td class="cellalignment1854">
<table class="cellalignment1847">
<tr>
<td class="cellalignment1846"><a href="archredo.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1846"><a href="dfiles.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2001, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1856">
<table class="cellalignment1845">
<tr>
<td class="cellalignment1846"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1846"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1846"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1846"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1846"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1846"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>