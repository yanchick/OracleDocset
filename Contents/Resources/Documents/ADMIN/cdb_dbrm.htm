<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-171"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Using%20Oracle%20Resource%20Manager%20for%20PDBs%20with%20SQL%2APlus"></a><title>Using Oracle Resource Manager for PDBs with SQL*Plus</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="description" content="You can use PL/SQL package procedures to administer Oracle Resource Manager (Resource Manager) to allocate resources to pluggable databases (PDBs) in a multitenant container database (CDB)."/>
<meta name="keywords" content="Database Resource Manager, PDBs, CDBs, CDB resource plans, resource plans, CDB, shares, utilization limits, directives, PDB resource plans, PDB, creating, enabling, disabling, CREATE_SIMPLE_PLAN procedure, PDBs resource plans, managing, modifying, viewing information about"/>
<meta name="dcterms.created" content="2017-07-10T12:24:11Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Administrator&rsquo;s Guide"/>
<meta name="dcterms.identifier" content="E41484-15"/>
<meta name="dcterms.isVersionOf" content="ADMIN"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2001, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="cdb_mon.htm" title="Previous" type="text/html"/>
<link rel="Next" href="cdb_dbrm_em.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41484-15.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-2708E76D-E18B-4586-920A-BD4B904AE14D"></a> <span id="PAGE" style="display:none;">54/59</span> <!-- End Header -->
<a id="ADMIN13774"></a>
<h1 id="ADMIN-GUID-2708E76D-E18B-4586-920A-BD4B904AE14D" class="sect1"><span class="enumeration_chapter">44</span> Using Oracle Resource Manager for PDBs with SQL*Plus</h1>
<div>
<p>You can use PL/SQL package procedures to administer Oracle Resource Manager (Resource Manager) to allocate resources to pluggable databases (PDBs) in a multitenant container database (CDB).</p>
<p>Before using Resource Manager for PDBs, meet the following requirements:</p>
<ul style="list-style-type: disc;">
<li>
<p>You understand how to configure and manage a CDB. See <a href="part_cdb.htm#GUID-93F1E584-D309-4301-82E0-AD0E60D4977C" title="You can manage a multitenant environment.">Managing a Multitenant Environment</a> for information.</p>
</li>
<li>
<p>You understand how to use Oracle Resource Manager to allocate resources in a non-CDB. See <a href="dbrm.htm#GUID-2BEF5482-CF97-4A85-BD90-9195E41E74EF" title="Oracle Database Resource Manager (Resource Manager) enables you to manage resource allocation for a database.">Managing Resources with Oracle Database Resource Manager</a> for information.</p>
</li>
</ul>
<div class="infobox-note" id="GUID-2708E76D-E18B-4586-920A-BD4B904AE14D__GUID-141F2F04-BAAB-4972-91E2-BD4940193274">
<p class="notep1">Note:</p>
<p>You can also administer the Resource Manager with the graphical user interface of Oracle Enterprise Manager Cloud Control (Cloud Control). For instructions about administering Resource Manager in a CDB with Cloud Control, see <a href="cdb_dbrm_em.htm#GUID-D9A5EBE6-6E45-463A-92E0-B9FEBAD50A54" title="You can use Oracle Resource Manage for a multitenant environment with Oracle Enterprise Manager Cloud Control.">Using Oracle Resource Manager for PDBs with Cloud Control</a> and the Cloud Control online help.</p>
</div>
</div>
<div class="sect2"><a id="GUID-9D3899E5-4C1D-435C-A45D-C6C2C815E657"></a>
<h2 id="ADMIN-GUID-9D3899E5-4C1D-435C-A45D-C6C2C815E657" class="sect2"><span class="enumeration_section">44.1</span> About Using Oracle Resource Manager with CDBs and PDBs</h2>
<p>You can create CDB resource plans and PDB resource plans to manage resources for CDBs and PDBs.</p>
<a id="ADMIN13775"></a>
<div class="props_rev_3"><a id="GUID-B9B8468F-F0CC-40EF-9407-A43E36A0D1E6"></a>
<h3 id="ADMIN-GUID-B9B8468F-F0CC-40EF-9407-A43E36A0D1E6" class="sect3"><span class="enumeration_section">44.1.1</span> About Managing Resources at the CDB Level and PDB Level</h3>
<div>
<p>In a non-CDB, you can use Resource Manager to manage multiple workloads that are contending for system and database resources. However, in a CDB, you can have multiple workloads within multiple PDBs competing for system and CDB resources.</p>
<p>In a CDB, Resource Manager can manage resources on two basic levels:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">CDB level -</span> Resource Manager can manage the workloads for multiple PDBs that are contending for system and CDB resources. You can specify how resources are allocated to PDBs, and you can limit the resource utilization of specific PDBs.</p>
</li>
<li>
<p><span class="bold">PDB level -</span> Resource Manager can manage the workloads within each PDB.</p>
</li>
</ul>
<p>Resource Manager allocates the resources in two steps:</p>
<ol>
<li id="GUID-B9B8468F-F0CC-40EF-9407-A43E36A0D1E6__CACEABFF">
<p>It allocates a portion of the system&#39;s resources to each PDB.</p>
</li>
<li>
<p>In a specific PDB, it allocates a portion of system resources obtained in Step <a href="cdb_dbrm.htm#GUID-B9B8468F-F0CC-40EF-9407-A43E36A0D1E6__CACEABFF">1</a> to each session connected to the PDB.</p>
</li>
</ol>
<div class="infobox-note" id="GUID-B9B8468F-F0CC-40EF-9407-A43E36A0D1E6__GUID-FA5AA2CE-D6E7-4215-A904-637065B50156">
<p class="notep1">Note:</p>
<p>All activity in the root is automatically managed by Resource Manager.</p>
</div>
</div>
</div>
<a id="ADMIN13776"></a>
<div class="props_rev_3"><a id="GUID-F8A64114-9440-43DD-8788-79B3B9E68BE1"></a>
<h3 id="ADMIN-GUID-F8A64114-9440-43DD-8788-79B3B9E68BE1" class="sect3"><span class="enumeration_section">44.1.2</span> What Solutions Does Resource Manager Provide for a CDB?</h3>
<div>
<p>Resource Manager can provide more efficient use of resources for a CDB.</p>
<p>When resource allocation decisions for a CDB are left to the operating system, you may encounter the following problems with workload management:</p>
<ul style="list-style-type: disc;">
<li>
<p>Inappropriate allocation of resources among PDBs</p>
<p>The operating system distributes resources equally among all active processes and cannot prioritize one task over another. Therefore, one or more PDBs might use an inordinate amount of the system resources, leaving the other PDBs starved for resources.</p>
</li>
<li>
<p>Inappropriate allocation of resources within a single PDB</p>
<p>One or more sessions connected to a single PDB might use an inordinate amount of the system resources, leaving other sessions connected to the same PDB starved for resources.</p>
</li>
<li>
<p>Inconsistent performance of PDBs</p>
<p>A single PDB might perform inconsistently when other PDBs are competing for more system resources or less system resources at various times.</p>
</li>
<li>
<p>Lack of resource usage data for PDBs</p>
<p>Resource usage data is critical for monitoring and tuning PDBs. It might be possible to use operating system monitoring tools to gather the resource usage data for a non-CDB if it is the only database running on the system. However, in a CDB, operating system monitoring tools are no longer as useful because there are multiple PDBs running on the system.</p>
</li>
</ul>
<p>Resource Manager helps to overcome these problems by allowing the CDB more control over how hardware resources are allocated among the PDBs and within PDBs.</p>
<p>In a CDB with multiple PDBs, some PDBs typically are more important than others. The Resource Manager enables you to prioritize and limit the resource usage of specific PDBs.</p>
<p>With the Resource Manager, you can:</p>
<ul style="list-style-type: disc;">
<li>
<p>Specify that different PDBs should receive different shares of the system resources so that more resources are allocated to the more important PDBs</p>
</li>
<li>
<p>Limit the CPU usage of a particular PDB</p>
</li>
<li>
<p>Limit the number of parallel execution servers that a particular PDB can use</p>
</li>
<li>
<p>Limit the resource usage of different sessions connected to a single PDB</p>
</li>
<li>
<p>Monitor the resource usage of PDBs</p>
</li>
</ul>
</div>
</div>
<a id="ADMIN13777"></a>
<div class="props_rev_3"><a id="GUID-075BDB11-8B9D-4061-98F6-8D4F07E3AB6D"></a>
<h3 id="ADMIN-GUID-075BDB11-8B9D-4061-98F6-8D4F07E3AB6D" class="sect3"><span class="enumeration_section">44.1.3</span> CDB Resource Plans</h3>
<p>In a CDB, PDBs might have different levels of priority. You can create CDB resource plans to distribute resources to different PDBs based on these priorities.</p>
<a id="ADMIN13778"></a>
<div class="props_rev_3"><a id="GUID-19400E80-882F-424F-A19A-9FEB54F83577"></a>
<h4 id="ADMIN-GUID-19400E80-882F-424F-A19A-9FEB54F83577" class="sect4"><span class="enumeration_section">44.1.3.1</span> About CDB Resource Plans</h4>
<div>
<p>A CDB resource plan allocates resources to its PDBs according to its set of resource plan directives (directives).</p>
<p>There is a parent-child relationship between a CDB resource plan and its directives. Each directive references one PDB, and no two directives for the currently active plan can reference the same PDB.</p>
<p>The directives control allocation of the following resources to the PDBs:</p>
<ul style="list-style-type: disc;">
<li>
<p>CPU</p>
</li>
<li>
<p>Parallel execution servers</p>
</li>
</ul>
<p>A directive can control the allocation of resources to PDBs based on the share value that you specify for each PDB. A higher share value for a PDB results in more resources for that PDB. For example, you can specify that one PDB is allocated double the resources allocated to a second PDB by setting the share value for the first PDB twice as high as the share value for the second PDB.</p>
<p>You can also specify utilization limits for PDBs. The utilization limit for a PDB limits resource allocation to the PDB. For example, it can control how much CPU the PDB gets as a percentage of the total CPU available to the CDB.</p>
<p>You can use both shares and utilization limits together for precise control over the resources allocated to each PDB in a CDB. The following sections provide more information about shares and utilization limits.</p>
</div>
</div>
<a id="ADMIN13943"></a><a id="ADMIN13781"></a><a id="ADMIN13779"></a>
<div class="props_rev_3"><a id="GUID-8FFC859A-A8CD-44C9-AE37-19F6F2E623A2"></a>
<h4 id="ADMIN-GUID-8FFC859A-A8CD-44C9-AE37-19F6F2E623A2" class="sect4"><span class="enumeration_section">44.1.3.2</span> Shares for Allocating Resources to PDBs</h4>
<div>
<p>To allocate resources among PDBs, you assign a share value to each PDB. A higher share value results in more guaranteed resources for a PDB.</p>
<p>You specify a share value for a PDB using the <code class="codeph">CREATE_CDB_PLAN_DIRECTIVE</code> procedure in the <code class="codeph">DBMS_RESOURCE_MANAGER</code> package. The <code class="codeph">shares</code> parameter in this procedure specifies the share value for the PDB.</p>
<p><a href="cdb_dbrm.htm#GUID-8FFC859A-A8CD-44C9-AE37-19F6F2E623A2__CACCDGEE">Figure 44-1</a> shows an example of three PDBs with share values specified for them in a CDB resource plan.</p>
<div class="figure" id="GUID-8FFC859A-A8CD-44C9-AE37-19F6F2E623A2__CACCDGEE">
<p class="titleinfigure">Figure 44-1 Shares in a CDB Resource Plan</p>
<img width="477" height="216" src="img/GUID-6B975C6A-1FAA-4CCB-99FD-D624B0787A85-default.png" alt="Description of Figure 44-1 follows" title="Description of Figure 44-1 follows"/><br/>
<a href="img_text/GUID-6B975C6A-1FAA-4CCB-99FD-D624B0787A85-print.htm">Description of &#34;Figure 44-1 Shares in a CDB Resource Plan&#34;</a></div>
<!-- class="figure" -->
<p><a href="cdb_dbrm.htm#GUID-8FFC859A-A8CD-44C9-AE37-19F6F2E623A2__CACCDGEE">Figure 44-1</a> shows that the total number of shares is seven (3+3+1). The <code class="codeph">salespdb</code> and the <code class="codeph">servicespdb</code> PDB are each guaranteed 3/7th of the resources, while the <code class="codeph">hrpdb</code> PDB is guaranteed 1/7th of the resources. However, any PDB can use more than the guaranteed amount of a resource if there is no resource contention.</p>
<p><a href="cdb_dbrm.htm#GUID-8FFC859A-A8CD-44C9-AE37-19F6F2E623A2__CACDBDCG" title="This table lists system resources and describes how the resources are allocated to the sample pluggable databases.">Table 44-1</a> shows the resources allocation to the PDBs in <a href="cdb_dbrm.htm#GUID-8FFC859A-A8CD-44C9-AE37-19F6F2E623A2__CACCDGEE">Figure 44-1</a> based on the share values, assuming that loads of the PDBs consume all of the system resources allocated.</p>
<div class="tblformal" id="GUID-8FFC859A-A8CD-44C9-AE37-19F6F2E623A2__CACDBDCG">
<p class="titleintable">Table 44-1 Resource Allocation for Sample PDBs</p>
<table class="cellalignment1849" title="Resource Allocation for Sample PDBs" summary="This table lists system resources and describes how the resources are allocated to the sample pluggable databases.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1949" id="d303086e628">Resource</th>
<th class="cellalignment1950" id="d303086e631">Resource Allocation</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1951" id="d303086e636" headers="d303086e628">
<p>CPU</p>
</td>
<td class="cellalignment1952" headers="d303086e636 d303086e631">
<p>The <code class="codeph">salespdb</code> and <code class="codeph">servicespdb</code> PDBs can consume the same amount of CPU resources. The <code class="codeph">salespdb</code> and <code class="codeph">servicespdb</code> PDBs are each guaranteed three times more CPU resource than the <code class="codeph">hrpdb</code> PDB.</p>
<p>See <span class="q">&#34;<a href="dbrm.htm#GUID-514BDECF-BE80-4CCA-A00D-EF37C2CFC435" title="To manage CPU resources, Resource Manager allocates resources among consumer groups and redistributes CPU resources that were allocated but were not used. You can also set a limit on the amount of CPU resources that can be allocated to a particular consumer group.">CPU</a>&#34;</span> for more information about this resource.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1951" id="d303086e668" headers="d303086e628">
<p>Parallel execution servers</p>
</td>
<td class="cellalignment1952" headers="d303086e668 d303086e631">
<p>Queued parallel queries from the <code class="codeph">salespdb</code> and <code class="codeph">servicespdb</code> PDBs are selected equally. Queued parallel queries from the <code class="codeph">salespdb</code> and <code class="codeph">servicespdb</code> PDBs are selected three times as often as queued parallel queries from the <code class="codeph">hrpdb</code> PDB.</p>
<p>See <span class="q">&#34;<a href="dbrm.htm#GUID-15685C9E-AD79-4342-BFA9-18D478915267" title="You can limit the maximum degree of parallelism for any operation within a consumer group. Use the PARALLEL_DEGREE_LIMIT_P1 directive attribute to specify the degree of parallelism for a consumer group.">Degree of Parallelism Limit</a>&#34;</span> for more information about this resource.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="ADMIN13783"></a><a id="ADMIN13944"></a><a id="ADMIN13782"></a>
<div class="props_rev_3"><a id="GUID-1BE505F7-5D27-442D-9A9C-ACA56A7EE569"></a>
<h4 id="ADMIN-GUID-1BE505F7-5D27-442D-9A9C-ACA56A7EE569" class="sect4"><span class="enumeration_section">44.1.3.3</span> Utilization Limits for PDBs</h4>
<div>
<p>A utilization limit restrains the system resource usage of a specific PDB. You can specify utilization limits for CPU and parallel execution servers.</p>
<p><a href="cdb_dbrm.htm#GUID-1BE505F7-5D27-442D-9A9C-ACA56A7EE569__CACECBGJ" title="This table lists each resource, the resource usage limit for each resource, and the Resource Manager action when a limit is reached.">Table 44-2</a> describes utilization limits for PDBs and the Resource Manager action taken when a PDB reaches a utilization limit.</p>
<div class="tblformalwide" id="GUID-1BE505F7-5D27-442D-9A9C-ACA56A7EE569__CACECBGJ">
<p class="titleintable">Table 44-2 Utilization Limits for PDBs</p>
<table class="cellalignment1880" title="Utilization Limits for PDBs" summary="This table lists each resource, the resource usage limit for each resource, and the Resource Manager action when a limit is reached.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1897" id="d303086e790">Resource</th>
<th class="cellalignment1943" id="d303086e793">Resource Utilization Limit</th>
<th class="cellalignment1872" id="d303086e796">Resource Manager Action</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1899" id="d303086e801" headers="d303086e790">
<p>CPU</p>
</td>
<td class="cellalignment1944" headers="d303086e801 d303086e793">
<p>The sessions connected to a PDB reach the CPU utilization limit for the PDB.</p>
<p>This utilization limit for CPU is set by the <code class="codeph">utilization_limit</code> parameter in the <code class="codeph">CREATE_CDB_PLAN_DIRECTIVE</code> procedure of the <code class="codeph">DBMS_RESOURCE_MANAGER</code> package. The <code class="codeph">utilization_limit</code> parameter specifies the percentage of the system resources that a PDB can use. The value ranges from 0 to 100.</p>
</td>
<td class="cellalignment1875" headers="d303086e801 d303086e796">
<p>Resource Manager throttles the PDB sessions so that the CPU utilization for the PDB does not exceed the utilization limit.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1899" id="d303086e825" headers="d303086e790">
<p>Parallel execution servers</p>
</td>
<td class="cellalignment1944" headers="d303086e825 d303086e793">
<p>A PDB uses more than the value of the <code class="codeph">PARALLEL_SERVERS_TARGET</code> initialization parameter multiplied by the value of the <code class="codeph">parallel_server_limit</code> parameter in the <code class="codeph">CREATE_CDB_PLAN_DIRECTIVE</code> procedure.</p>
<p>For example, if the <code class="codeph">PARALLEL_SERVERS_TARGET</code> initialization parameter is set to 200 and the <code class="codeph">parallel_server_limit</code> parameter for a PDB is set to 10%, then utilization limit for the PDB is 20 parallel execution servers (200 X .10).</p>
</td>
<td class="cellalignment1875" headers="d303086e825 d303086e796">
<p>Resource Manager queues parallel queries if the number of parallel execution servers used by the PDB would exceed the limit specified by the <code class="codeph">PARALLEL_SERVERS_TARGET</code> initialization parameter value multiplied by the value of the <code class="codeph">parallel_server_limit</code> parameter in the <code class="codeph">CREATE_CDB_PLAN_DIRECTIVE</code> procedure.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p><a href="cdb_dbrm.htm#GUID-1BE505F7-5D27-442D-9A9C-ACA56A7EE569__CACJBEJH">Figure 44-2</a> shows an example of three PDBs with shares and utilization limits specified for them in a CDB resource plan.</p>
<div class="figure" id="GUID-1BE505F7-5D27-442D-9A9C-ACA56A7EE569__CACJBEJH">
<p class="titleinfigure">Figure 44-2 Shares and Utilization Limits in a CDB Resource Plan</p>
<img width="477" height="231" src="img/GUID-8984FA05-C7DE-476F-9B44-B717BFD7214F-default.png" alt="Description of Figure 44-2 follows" title="Description of Figure 44-2 follows"/><br/>
<a href="img_text/GUID-8984FA05-C7DE-476F-9B44-B717BFD7214F-print.htm">Description of &#34;Figure 44-2 Shares and Utilization Limits in a CDB Resource Plan&#34;</a></div>
<!-- class="figure" -->
<p><a href="cdb_dbrm.htm#GUID-1BE505F7-5D27-442D-9A9C-ACA56A7EE569__CACJBEJH">Figure 44-2</a> shows that there are no utilization limits on the <code class="codeph">salespdb</code> and <code class="codeph">servicespdb</code> PDBs because <code class="codeph">utilization_limit</code> and <code class="codeph">parallel_server_limit</code> are both set to 100% for them. However, the <code class="codeph">hrpdb</code> PDB is limited to 70% of the applicable system resources because <code class="codeph">utilization_limit</code> and <code class="codeph">parallel_server_limit</code> are both set to 70%.</p>
</div>
</div>
<a id="ADMIN13785"></a><a id="ADMIN13945"></a><a id="ADMIN13784"></a>
<div class="props_rev_3"><a id="GUID-3E84009E-5CD6-46B8-84D3-BE775D58D9AA"></a>
<h4 id="ADMIN-GUID-3E84009E-5CD6-46B8-84D3-BE775D58D9AA" class="sect4"><span class="enumeration_section">44.1.3.4</span> The Default Directive for PDBs</h4>
<div>
<p>When you do not explicitly define directives for a PDB, the PDB uses the default directive for PDBs.</p>
<p><a href="cdb_dbrm.htm#GUID-3E84009E-5CD6-46B8-84D3-BE775D58D9AA__CACGHHJA" title="This table shows each default directive and its value.">Table 44-3</a> shows the attributes of the initial default directive for PDBs.</p>
<div class="tblformal" id="GUID-3E84009E-5CD6-46B8-84D3-BE775D58D9AA__CACGHHJA">
<p class="titleintable">Table 44-3 Initial Default Directive Attributes for PDBs</p>
<table class="cellalignment1849" title="Initial Default Directive Attributes for PDBs" summary="This table shows each default directive and its value.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1883" id="d303086e979">Directive Attribute</th>
<th class="cellalignment1883" id="d303086e982">Value</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1886" id="d303086e987" headers="d303086e979">
<p><code class="codeph">shares</code></p>
</td>
<td class="cellalignment1886" headers="d303086e987 d303086e982">
<p>1</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1886" id="d303086e995" headers="d303086e979">
<p><code class="codeph">utilization_limit</code></p>
</td>
<td class="cellalignment1886" headers="d303086e995 d303086e982">
<p>100</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1886" id="d303086e1003" headers="d303086e979">
<p><code class="codeph">parallel_server_limit</code></p>
</td>
<td class="cellalignment1886" headers="d303086e1003 d303086e982">
<p>100</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>When a PDB is plugged into a CDB and no directive is defined for it, the PDB uses the default directive for PDBs.</p>
<p>You can create new directives for the new PDB. You can also change the default directive attribute values for PDBs by using the <code class="codeph">UPDATE_CDB_DEFAULT_DIRECTIVE</code> procedure in the <code class="codeph">DBMS_RESOURCE_MANAGER</code> package.</p>
<p>When a PDB is unplugged from a CDB, the directive for the PDB is retained. If the same PDB is plugged back into the CDB, then it uses the directive defined for it if the directive was not deleted manually.</p>
<p><a href="cdb_dbrm.htm#GUID-3E84009E-5CD6-46B8-84D3-BE775D58D9AA__CACFGAEJ">Figure 44-3</a> shows an example of the default directive in a CDB resource plan.</p>
<div class="figure" id="GUID-3E84009E-5CD6-46B8-84D3-BE775D58D9AA__CACFGAEJ">
<p class="titleinfigure">Figure 44-3 Default Directive in a CDB Resource Plan</p>
<img width="477" height="426" src="img/GUID-CDC277E6-4D4E-493B-A6F7-6DF2043680A6-default.png" alt="Description of Figure 44-3 follows" title="Description of Figure 44-3 follows"/><br/>
<a href="img_text/GUID-CDC277E6-4D4E-493B-A6F7-6DF2043680A6-print.htm">Description of &#34;Figure 44-3 Default Directive in a CDB Resource Plan&#34;</a></div>
<!-- class="figure" -->
<p><a href="cdb_dbrm.htm#GUID-3E84009E-5CD6-46B8-84D3-BE775D58D9AA__CACFGAEJ">Figure 44-3</a> shows that the default PDB directive specifies that the <code class="codeph">share</code> is 1, the <code class="codeph">utilization_limit</code> is 50%, and the <code class="codeph">parallel_server_limit</code> is 50%. Any PDB that is part of the CDB and does not have directives defined for it uses the default PDB directive. <a href="cdb_dbrm.htm#GUID-3E84009E-5CD6-46B8-84D3-BE775D58D9AA__CACFGAEJ">Figure 44-3</a> shows the PDBs <code class="codeph">marketingpdb</code> and <code class="codeph">testingpdb</code> using the default PDB directive. Therefore, <code class="codeph">marketingpdb</code> and <code class="codeph">testingpdb</code> each get 1 share and a utilization limit of 50.</p>
<div class="infoboxnotealso" id="GUID-3E84009E-5CD6-46B8-84D3-BE775D58D9AA__GUID-4D81CAFE-2132-4F3D-BF23-916FDBE5FA4A">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="cdb_dbrm.htm#GUID-07A4546E-A0D1-46AE-BFA2-D28C3915906D" title="When you create a PDB in a CDB, you can create a CDB resource plan directive for the PDB using the CREATE_CDB_PLAN_DIRECTIVE procedure. The directive specifies how resources are allocated to the new PDB.">Creating New CDB Resource Plan Directives for a PDB</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="cdb_dbrm.htm#GUID-98B4BC74-D86C-4084-9436-BE4440ED15DD" title="You can update the default directive for PDBs in a CDB resource plan using the UPDATE_CDB_DEFAULT_DIRECTIVE procedure. The default directive applies to PDBs for which specific directives have not been defined.">Updating the Default Directive for PDBs in a CDB Resource Plan</a>&#34;</span></p>
</li>
<li>
<p><a href="cdb_plug.htm#GUID-9A250D93-5B3B-4643-BE85-F32CC7B0E413" title="You can create PDBs in several different ways, including using the seed, cloning an existing PDB or non-CDB, and plugging in an unplugged PDB. You can also remove PDBs from a CDB.">Creating and Removing PDBs with SQL*Plus</a></p>
</li>
<li>
<p><span class="q">&#34;<a href="cdb_plug.htm#GUID-893E1D67-BD95-4757-B862-03AD13AFF722" title="You can unplug a PDB from a CDB.">Unplugging a PDB from a CDB</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="dbrm.htm#GUID-CDF30CA7-5A14-4C17-8C32-746F0763A7C9" title="Use the PARALLEL_SERVER_LIMIT directive attribute to specify the maximum percentage of the parallel execution server pool that a particular consumer group can use. The number of parallel execution servers used by a particular consumer group is counted as the sum of the parallel execution servers used by all sessions in that consumer group.">Parallel Server Limit</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<a id="ADMIN13787"></a><a id="ADMIN13946"></a><a id="ADMIN13786"></a>
<div class="props_rev_3"><a id="GUID-A6BA104E-5B27-4957-AF8B-11FDCEC5DB17"></a>
<h3 id="ADMIN-GUID-A6BA104E-5B27-4957-AF8B-11FDCEC5DB17" class="sect3"><span class="enumeration_section">44.1.4</span> PDB Resource Plans</h3>
<div>
<p>A CDB resource plan determines the amount of resources allocated to each PDB. A PDB resource plan determines how the resources allocated to a specific PDB are allocated to consumer groups within that PDB.</p>
<p>A PDB resource plan is similar to a resource plan for a non-CDB. Specifically, a PDB resource plan allocates resource among the consumer groups within a PDB. You can use a PDB resource plan to allocate the resources described in <span class="q">&#34;<a href="dbrm.htm#GUID-4BBE0B17-3B05-49FA-979A-C649A9EE6DD9" title="Resource plan directives specify how resources are allocated to resource consumer groups or subplans. Each directive can specify several different methods for allocating resources to its consumer group or subplan.">The Types of Resources Managed by the Resource Manager</a>&#34;</span>.</p>
<p>When you create one or more PDB resource plans, the CDB resource plan for the PDB&#39;s CDB should meet certain requirements. <a href="cdb_dbrm.htm#GUID-A6BA104E-5B27-4957-AF8B-11FDCEC5DB17__CACDAFEA" title="This table lists each resource, the consolidation plan requirements for the resource, and the results if the requirements are not met.">Table 44-4</a> describes the requirements for the CDB resource plan and the results when the requirements are not met.</p>
<p>You create directives for a CDB resource plan by using the <code class="codeph">CREATE_CDB_PLAN_DIRECTIVE</code> procedure in the <code class="codeph">DBMS_RESOURCE_MANAGER</code> package. You create directives for a PDB resource plan using the <code class="codeph">CREATE_PLAN_DIRECTIVE</code> procedure in the same package. When you create one or more PDB resource plans and there is no CDB resource plan, the CDB uses the <code class="codeph">DEFAULT_CDB_PLAN</code> that is supplied with Oracle Database.</p>
<div class="infobox-note" id="GUID-A6BA104E-5B27-4957-AF8B-11FDCEC5DB17__GUID-065A02C6-A247-40C8-A6EA-AF1993FCCD70">
<p class="notep1">Note:</p>
<p><a href="cdb_dbrm.htm#GUID-A6BA104E-5B27-4957-AF8B-11FDCEC5DB17__CACDAFEA" title="This table lists each resource, the consolidation plan requirements for the resource, and the results if the requirements are not met.">Table 44-4</a> describes parameter values for PL/SQL procedures. The parameter values described in the &#34;CDB Resource Plan Requirements&#34; column are for the <code class="codeph">CREATE_CDB_PLAN_DIRECTIVE</code> procedure. The parameter values described in the &#34;Results When Requirements Are Not Met&#34; column are for the <code class="codeph">CREATE_PLAN_DIRECTIVE</code> procedure.</p>
</div>
<div class="tblformalwide" id="GUID-A6BA104E-5B27-4957-AF8B-11FDCEC5DB17__CACDAFEA">
<p class="titleintable">Table 44-4 CDB Resource Plan Requirements for PDB Resource Plans</p>
<table class="cellalignment1880" title="CDB Resource Plan Requirements for PDB Resource Plans" summary="This table lists each resource, the consolidation plan requirements for the resource, and the results if the requirements are not met.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1987" id="d303086e1246">Resource</th>
<th class="cellalignment1871" id="d303086e1249">CDB Resource Plan Requirements</th>
<th class="cellalignment1864" id="d303086e1252">Results When Requirements Are Not Met</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1989" id="d303086e1257" headers="d303086e1246">
<p>CPU</p>
</td>
<td class="cellalignment1874" headers="d303086e1257 d303086e1249">
<p>One of the following requirements must be met:</p>
<ul style="list-style-type: disc;">
<li>
<p>A share value must be specified for the PDB using the <code class="codeph">shares</code> parameter.</p>
</li>
<li>
<p>A utilization limit for CPU below 100 must be specified for the PDB using the <code class="codeph">utilization_limit</code> parameter.</p>
</li>
</ul>
<p>These values can be set in a directive for the specific PDB or in a default directive.</p>
</td>
<td class="cellalignment1866" headers="d303086e1257 d303086e1252">
<p>The CPU allocation policy of the PDB resource plan is not enforced.</p>
<p>The CPU limit specified by the <code class="codeph">utilization_limit</code> parameter in the PDB resource plan is not enforced.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1989" id="d303086e1287" headers="d303086e1246">
<p>Parallel execution servers</p>
</td>
<td class="cellalignment1874" headers="d303086e1287 d303086e1249">
<p>One of the following requirements must be met:</p>
<ul style="list-style-type: disc;">
<li>
<p>A share value must be specified for the PDB using the <code class="codeph">shares</code> parameter.</p>
</li>
<li>
<p>A utilization limit for CPU below 100 must be specified for the PDB using the <code class="codeph">utilization_limit</code> parameter.</p>
</li>
<li>
<p>A parallel server limit below 100 must be specified for the PDB using the <code class="codeph">parallel_server_limit</code> parameter.</p>
</li>
</ul>
<p>These values can be set in a directive for the specific PDB or in a default directive.</p>
</td>
<td class="cellalignment1866" headers="d303086e1287 d303086e1252">
<p>The parallel execution server allocation policy of the PDB resource plan is not enforced.</p>
<p>The parallel server limit specified by the <code class="codeph">parallel_server_limit</code> parameter in the PDB resource plan is not enforced.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p><a href="cdb_dbrm.htm#GUID-A6BA104E-5B27-4957-AF8B-11FDCEC5DB17__CACGGGJG">Figure 44-4</a> shows an example of a CDB resource plan and a PDB resource plan.</p>
<div class="figure" id="GUID-A6BA104E-5B27-4957-AF8B-11FDCEC5DB17__CACGGGJG">
<p class="titleinfigure">Figure 44-4 A CDB Resource Plan and a PDB Resource Plan</p>
<img width="477" height="504" src="img/GUID-2D9C6956-4173-41AF-8F8E-FC1835610F70-default.png" alt="Description of Figure 44-4 follows" title="Description of Figure 44-4 follows"/><br/>
<a href="img_text/GUID-2D9C6956-4173-41AF-8F8E-FC1835610F70-print.htm">Description of &#34;Figure 44-4 A CDB Resource Plan and a PDB Resource Plan&#34;</a></div>
<!-- class="figure" -->
<p><a href="cdb_dbrm.htm#GUID-A6BA104E-5B27-4957-AF8B-11FDCEC5DB17__CACGGGJG">Figure 44-4</a> shows some of the directives in a PDB resource plan for the <code class="codeph">servicespdb</code> PDB. Other PDBs in the CDB can also have PDB resource plans.</p>
<p>In a CDB, the following restrictions apply to PDB resource plans:</p>
<ul style="list-style-type: disc;">
<li>
<p>A PDB resource plan cannot have subplans.</p>
</li>
<li>
<p>A PDB resource plan can have a maximum of eight consumer groups.</p>
</li>
<li>
<p>A PDB resource plan cannot have a multiple-level scheduling policy.</p>
</li>
</ul>
<p>If you create a PDB using a non-CDB, and the non-CDB contains resource plans, then these resource plans might not conform to these restrictions. In this case, Oracle Database automatically transforms these resource plans into equivalent PDB resource plans that meet these requirements. The original resource plans and directives are recorded in the <code class="codeph">DBA_RSRC_PLANS</code> and <code class="codeph">DBA_RSRC_PLAN_DIRECTIVES</code> views with the <code class="codeph">LEGACY</code> status.</p>
<div class="infoboxnotealso" id="GUID-A6BA104E-5B27-4957-AF8B-11FDCEC5DB17__GUID-8538DA05-AF23-44A3-9F6E-5BB3E8E7249B">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="cdb_dbrm.htm#GUID-075BDB11-8B9D-4061-98F6-8D4F07E3AB6D" title="In a CDB, PDBs might have different levels of priority. You can create CDB resource plans to distribute resources to different PDBs based on these priorities.">CDB Resource Plans</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="cdb_plug.htm#GUID-F68E6FE9-919B-4665-95F7-785E69E07264" title="You can move a non-CDB into a PDB.">Creating a PDB Using a Non-CDB</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
</div>
<a id="ADMIN13788"></a>
<div class="props_rev_3"><a id="GUID-4D6AC64F-5871-4D1F-815B-1035D90A8BD2"></a>
<h3 id="ADMIN-GUID-4D6AC64F-5871-4D1F-815B-1035D90A8BD2" class="sect3"><span class="enumeration_section">44.1.5</span> Background and Administrative Tasks and Consumer Groups</h3>
<div>
<p>In a CDB, background and administrative tasks are mapped to the Resource Manager consumer groups that run them optimally.</p>
<p>Resource Manager uses the following rules to map a task to a consumer group:</p>
<ul style="list-style-type: disc;">
<li>
<p>A task is mapped to a consumer group in the container that starts the task. If a task starts in the root, then the task is mapped to a consumer group in the root. If the task starts in a PDB, then the task is mapped to a consumer group in the PDB.</p>
</li>
</ul>
<ul style="list-style-type: disc;">
<li>
<p>When a task is started by an internal client using an internal API, the internal API determines the consumer group to which the task is mapped.</p>
<p>For example, a backup task uses an internal Oracle function. When <code class="codeph">SYS</code> starts a backup task in the root, the backup task is mapped based on the Oracle function to the <code class="codeph">SYS_GROUP</code> consumer group in the root.</p>
</li>
<li>
<p>When a task is started without using an internal API, the task is mapped to a consumer group based on the user-defined mapping rules.</p>
<p>For example, when <code class="codeph">SYS</code> is mapped to the <code class="codeph">SYS_GROUP</code> consumer group, a task started by <code class="codeph">SYS</code> is mapped to the <code class="codeph">SYS_GROUP</code> consumer group.</p>
</li>
</ul>
<p>The following background and administrative tasks follow these rules:</p>
<ul style="list-style-type: disc;">
<li>
<p>Backup and recovery</p>
</li>
<li>
<p>Auditing</p>
</li>
<li>
<p>Replication and Advanced Queuing</p>
</li>
<li>
<p>Unplugging a PDB</p>
</li>
<li>
<p>Maintenance windows</p>
</li>
</ul>
</div>
</div>
</div>
<a id="ADMIN13789"></a>
<div class="props_rev_3"><a id="GUID-5BBC8793-8180-4EA4-8AA3-E213D070FB5B"></a>
<h2 id="ADMIN-GUID-5BBC8793-8180-4EA4-8AA3-E213D070FB5B" class="sect2"><span class="enumeration_section">44.2</span> Prerequisites for Using Resource Manager with a CDB</h2>
<div>
<p>You must meet prerequisites before using Resource Manager with a CDB.</p>
<p>Before you can use Resource Manager with a CDB, the following prerequisites must be met:</p>
<ul style="list-style-type: disc;">
<li>
<p>The CDB must exist and must contain PDBs.</p>
<p>See <a href="cdb_create.htm#GUID-77D4BBA7-2A64-46D9-A2B8-C56060772215" title="Creating and configuring a &nbsp;multitenant container database (CDB) includes tasks such as planning for CDB creation, creating the CDB, and optionally configuring EM Express for the CDB.">Creating and Configuring a CDB</a> and <a href="cdb_plug.htm#GUID-9A250D93-5B3B-4643-BE85-F32CC7B0E413" title="You can create PDBs in several different ways, including using the seed, cloning an existing PDB or non-CDB, and plugging in an unplugged PDB. You can also remove PDBs from a CDB.">Creating and Removing PDBs with SQL*Plus</a>.</p>
</li>
<li>
<p>To complete a task that uses the <code class="codeph">DBMS_RESOURCE_MANAGER</code> package, a user must have <code class="codeph">ADMINISTER_RESOURCE_MANAGER</code> system privilege.</p>
<p>See <span class="q">&#34;<a href="dbrm.htm#GUID-1A627E9A-0138-4DA8-B2E3-E98D3C4AA65D" title="You must have the required privileges to administer the Resource Manager.">About Resource Manager Administration Privileges</a>&#34;</span>.</p>
</li>
</ul>
</div>
</div>
<a id="ADMIN13790"></a>
<div class="props_rev_3"><a id="GUID-F1DD75FE-18CC-46A9-B19B-68F7833A2594"></a>
<h2 id="ADMIN-GUID-F1DD75FE-18CC-46A9-B19B-68F7833A2594" class="sect2"><span class="enumeration_section">44.3</span> Creating a CDB Resource Plan</h2>
<div>
<p>You use the <code class="codeph">DBMS_RESOURCE_MANAGER</code> package to create a CDB resource plan and define the directives for the plan.</p>
<div class="section">
<p>The general steps for creating a CDB resource plan are the following:</p>
</div>
<!-- class="section" -->
<ol>
<li><span>Create the pending area using the <code class="codeph">CREATE_PENDING_AREA</code> procedure.</span></li>
<li><span>Create the CDB resource plan using the <code class="codeph">CREATE_CDB_PLAN</code> procedure.</span></li>
<li><span>Create directives for the PDBs using the <code class="codeph">CREATE_CDB_PLAN_DIRECTIVE</code> procedure.</span></li>
<li><span>(Optional) Update the default PDB directive using the <code class="codeph">UPDATE_CDB_DEFAULT_DIRECTIVE</code> procedure.</span></li>
<li><span>(Optional) Update the default autotask directive using the <code class="codeph">UPDATE_CDB_AUTOTASK_DIRECTIVE</code> procedure.</span></li>
<li><span>Validate the pending area using the <code class="codeph">VALIDATE_PENDING_AREA</code> procedure.</span></li>
<li><span>Submit the pending area using the <code class="codeph">SUBMIT_PENDING_AREA</code> procedure.</span></li>
</ol>
</div>
<a id="ADMIN13792"></a><a id="ADMIN13793"></a><a id="ADMIN13795"></a><a id="ADMIN13796"></a><a id="ADMIN13797"></a><a id="ADMIN13798"></a><a id="ADMIN13799"></a><a id="ADMIN13800"></a><a id="ADMIN13801"></a><a id="ADMIN13791"></a>
<div class="props_rev_3"><a id="GUID-36E58D2B-2873-4ED1-B042-624DB42A5C8E"></a>
<h3 id="ADMIN-GUID-36E58D2B-2873-4ED1-B042-624DB42A5C8E" class="sect3"><span class="enumeration_section">44.3.1</span> Creating a CDB Resource Plan: A Scenario</h3>
<div>
<p>A scenario illustrates each of the steps involved in creating a CDB resource plan.</p>
<div class="section">
<p>The scenario assumes that you want to create a CDB resource plan for a CDB named <code class="codeph">newcdb</code>. The plan includes a directive for each PDB. In this scenario, you also update the default directive and the autotask directive.</p>
<p>The directives are defined using various procedures in the <code class="codeph">DBMS_RESOURCE_MANAGER</code> package. The attributes of each directive are defined using parameters in these procedures. <a href="cdb_dbrm.htm#GUID-36E58D2B-2873-4ED1-B042-624DB42A5C8E__CACJAEDB" title="This table lists each directive parameter and provides a description of each directive parameter.">Table 44-5</a> describes the types of directives in the plan.</p>
<div class="tblformal" id="GUID-36E58D2B-2873-4ED1-B042-624DB42A5C8E__CACJAEDB">
<p class="titleintable">Table 44-5 Attributes for PDB Directives in a CDB Resource Plan</p>
<table class="cellalignment1849" title="Attributes for PDB Directives in a CDB Resource Plan" summary="This table lists each directive parameter and provides a description of each directive parameter.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1949" id="d303086e1806">Directive Attribute</th>
<th class="cellalignment1950" id="d303086e1809">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1951" id="d303086e1814" headers="d303086e1806">
<p><code class="codeph">shares</code></p>
</td>
<td class="cellalignment1952" headers="d303086e1814 d303086e1809">
<p>Resource allocation share for CPU and parallel execution server resources. See <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-8FFC859A-A8CD-44C9-AE37-19F6F2E623A2" title="To allocate resources among PDBs, you assign a share value to each PDB. A higher share value results in more guaranteed resources for a PDB.">Shares for Allocating Resources to PDBs</a>&#34;</span>.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1951" id="d303086e1830" headers="d303086e1806">
<p><code class="codeph">utilization_limit</code></p>
</td>
<td class="cellalignment1952" headers="d303086e1830 d303086e1809">
<p>Resource utilization limit for CPU. See <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-1BE505F7-5D27-442D-9A9C-ACA56A7EE569" title="A utilization limit restrains the system resource usage of a specific PDB. You can specify utilization limits for CPU and parallel execution servers.">Utilization Limits for PDBs</a>&#34;</span>.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1951" id="d303086e1846" headers="d303086e1806">
<p><code class="codeph">parallel_server_limit</code></p>
</td>
<td class="cellalignment1952" headers="d303086e1846 d303086e1809">
<p>Maximum percentage of parallel execution servers that a PDB can use.</p>
<p>When the <code class="codeph">parallel_server_limit</code> directive is specified for a PDB, the limit is the value of the <code class="codeph">PARALLEL_SERVERS_TARGET</code> initialization parameter multiplied by the value of the <code class="codeph">parallel_server_limit</code> parameter in the <code class="codeph">CREATE_CDB_PLAN_DIRECTIVE</code> procedure. See <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-1BE505F7-5D27-442D-9A9C-ACA56A7EE569" title="A utilization limit restrains the system resource usage of a specific PDB. You can specify utilization limits for CPU and parallel execution servers.">Utilization Limits for PDBs</a>&#34;</span>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p><a href="cdb_dbrm.htm#GUID-36E58D2B-2873-4ED1-B042-624DB42A5C8E__CACBBBCF" title="This table lists each pluggable database and shows the value of the following directives for each pluggable database: mgmt_p1, utilization_limit, and parallel_server_limit.">Table 44-6</a> describes how the CDB resource plan allocates resources to its PDBs using the directive attributes described in <a href="cdb_dbrm.htm#GUID-36E58D2B-2873-4ED1-B042-624DB42A5C8E__CACJAEDB" title="This table lists each directive parameter and provides a description of each directive parameter.">Table 44-5</a>.</p>
<div class="tblformalwide" id="GUID-36E58D2B-2873-4ED1-B042-624DB42A5C8E__CACBBBCF">
<p class="titleintable">Table 44-6 Sample Directives for PDBs in a CDB Resource Plan</p>
<table class="cellalignment1880" title="Sample Directives for PDBs in a CDB Resource Plan" summary="This table lists each pluggable database and shows the value of the following directives for each pluggable database: mgmt_p1, utilization_limit, and parallel_server_limit.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1881" id="d303086e1898">PDB</th>
<th class="cellalignment1863" id="d303086e1901">shares Directive</th>
<th class="cellalignment1863" id="d303086e1904">utilization_limit Directive</th>
<th class="cellalignment1863" id="d303086e1907">parallel_server_limit Directive</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1884" id="d303086e1912" headers="d303086e1898">
<p><code class="codeph">salespdb</code></p>
</td>
<td class="cellalignment1865" headers="d303086e1912 d303086e1901">
<p>3</p>
</td>
<td class="cellalignment1865" headers="d303086e1912 d303086e1904">
<p>Unlimited</p>
</td>
<td class="cellalignment1865" headers="d303086e1912 d303086e1907">
<p>Unlimited</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1884" id="d303086e1926" headers="d303086e1898">
<p><code class="codeph">servicespdb</code></p>
</td>
<td class="cellalignment1865" headers="d303086e1926 d303086e1901">
<p>3</p>
</td>
<td class="cellalignment1865" headers="d303086e1926 d303086e1904">
<p>Unlimited</p>
</td>
<td class="cellalignment1865" headers="d303086e1926 d303086e1907">
<p>Unlimited</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1884" id="d303086e1940" headers="d303086e1898">
<p><code class="codeph">hrpdb</code></p>
</td>
<td class="cellalignment1865" headers="d303086e1940 d303086e1901">
<p>1</p>
</td>
<td class="cellalignment1865" headers="d303086e1940 d303086e1904">
<p>70</p>
</td>
<td class="cellalignment1865" headers="d303086e1940 d303086e1907">
<p>70</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1884" id="d303086e1954" headers="d303086e1898">
<p>Default</p>
</td>
<td class="cellalignment1865" headers="d303086e1954 d303086e1901">
<p>1</p>
</td>
<td class="cellalignment1865" headers="d303086e1954 d303086e1904">
<p>50</p>
</td>
<td class="cellalignment1865" headers="d303086e1954 d303086e1907">
<p>50</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1884" id="d303086e1967" headers="d303086e1898">
<p>Autotask</p>
</td>
<td class="cellalignment1865" headers="d303086e1967 d303086e1901">
<p>1</p>
</td>
<td class="cellalignment1865" headers="d303086e1967 d303086e1904">
<p>75</p>
</td>
<td class="cellalignment1865" headers="d303086e1967 d303086e1907">
<p>75</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>The <code class="codeph">salespdb</code> and <code class="codeph">servicespdb</code> PDBs are more important than the other PDBs in the CDB. Therefore, they get a higher share (3), unlimited CPU utilization resource, and unlimited parallel execution server resource.</p>
<p>The default directive applies to PDBs for which specific directives have not been defined. For this scenario, assume that the CDB has several PDBs that use the default directive. This scenario updates the default directive.</p>
<p>In addition, this scenario updates the autotask directive. The autotask directive applies to automatic maintenance tasks that are run in the root maintenance window.</p>
<p>The following tasks use the <code class="codeph">DBMS_RESOURCE_MANAGER</code> package to create the CDB resource plan and update the default and autotask directives for this scenario:</p>
<ol>
<li>
<p>Create a pending area using the <code class="codeph">CREATE_PENDING_AREA</code> procedure:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.CREATE_PENDING_AREA();
</pre></li>
<li>
<p>Create a CDB resource plan named <code class="codeph">newcdb_plan</code> using the <code class="codeph">CREATE_CDB_PLAN</code> procedure:</p>
<pre dir="ltr">BEGIN
  DBMS_RESOURCE_MANAGER.CREATE_CDB_PLAN(
    plan    =&gt; &#39;newcdb_plan&#39;,
    comment =&gt; &#39;CDB resource plan for newcdb&#39;);
END;
/
</pre></li>
<li>
<p>Create the CDB resource plan directives for the PDBs using the <code class="codeph">CREATE_CDB_PLAN_DIRECTIVE</code> procedure. Each directive specifies how resources are allocated to a specific PDB.</p>
<p><a href="cdb_dbrm.htm#GUID-36E58D2B-2873-4ED1-B042-624DB42A5C8E__CACBBBCF" title="This table lists each pluggable database and shows the value of the following directives for each pluggable database: mgmt_p1, utilization_limit, and parallel_server_limit.">Table 44-6</a> describes the directives for the <code class="codeph">salespdb</code>, <code class="codeph">servicespdb</code>, and <code class="codeph">hrpdb</code> PDBs in this scenario. Run the following procedures to create these directives:</p>
<pre dir="ltr">BEGIN
  DBMS_RESOURCE_MANAGER.CREATE_CDB_PLAN_DIRECTIVE(
    plan                  =&gt; &#39;newcdb_plan&#39;, 
    pluggable_database    =&gt; &#39;salespdb&#39;, 
    shares                =&gt; 3, 
    utilization_limit     =&gt; 100,
    parallel_server_limit =&gt; 100);
END;
/

BEGIN
  DBMS_RESOURCE_MANAGER.CREATE_CDB_PLAN_DIRECTIVE(
    plan                  =&gt; &#39;newcdb_plan&#39;, 
    pluggable_database    =&gt; &#39;servicespdb&#39;, 
    shares                =&gt; 3, 
    utilization_limit     =&gt; 100,
    parallel_server_limit =&gt; 100);
END;
/

BEGIN
  DBMS_RESOURCE_MANAGER.CREATE_CDB_PLAN_DIRECTIVE(
    plan                  =&gt; &#39;newcdb_plan&#39;, 
    pluggable_database    =&gt; &#39;hrpdb&#39;, 
    shares                =&gt; 1, 
    utilization_limit     =&gt; 70,
    parallel_server_limit =&gt; 70);
END;
/
</pre>
<p>All other PDBs in this CDB use the default PDB directive.</p>
</li>
<li>
<p>If the current default CDB resource plan directive for PDBs does not meet your requirements, then update the directive using the <code class="codeph">UPDATE_CDB_DEFAULT_DIRECTIVE</code> procedure.</p>
<p>The default directive applies to PDBs for which specific directives have not been defined. See <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-3E84009E-5CD6-46B8-84D3-BE775D58D9AA" title="When you do not explicitly define directives for a PDB, the PDB uses the default directive for PDBs.">The Default Directive for PDBs</a>&#34;</span> for more information.</p>
<p><a href="cdb_dbrm.htm#GUID-36E58D2B-2873-4ED1-B042-624DB42A5C8E__CACBBBCF" title="This table lists each pluggable database and shows the value of the following directives for each pluggable database: mgmt_p1, utilization_limit, and parallel_server_limit.">Table 44-6</a> describes the default directive that PDBs use in this scenario. Run the following procedure to update the default directive:</p>
<pre dir="ltr">BEGIN
  DBMS_RESOURCE_MANAGER.UPDATE_CDB_DEFAULT_DIRECTIVE(
    plan                      =&gt; &#39;newcdb_plan&#39;, 
    new_shares                =&gt; 1, 
    new_utilization_limit     =&gt; 50,
    new_parallel_server_limit =&gt; 50);
END;
/
</pre></li>
<li>
<p>If the current autotask CDB resource plan directive does not meet your requirements, then update the directive using the <code class="codeph">UPDATE_CDB_AUTOTASK_DIRECTIVE</code> procedure.</p>
<p>The autotask directive applies to automatic maintenance tasks that are run in the root maintenance window.</p>
<p><a href="cdb_dbrm.htm#GUID-36E58D2B-2873-4ED1-B042-624DB42A5C8E__CACBBBCF" title="This table lists each pluggable database and shows the value of the following directives for each pluggable database: mgmt_p1, utilization_limit, and parallel_server_limit.">Table 44-6</a> describes the autotask directive in this scenario. Run the following procedure to update the autotask directive:</p>
<pre dir="ltr">BEGIN
  DBMS_RESOURCE_MANAGER.UPDATE_CDB_AUTOTASK_DIRECTIVE(
    plan                      =&gt; &#39;newcdb_plan&#39;, 
    new_shares                =&gt; 1, 
    new_utilization_limit     =&gt; 75,
    new_parallel_server_limit =&gt; 75);
END;
/
</pre></li>
<li>
<p>Validate the pending area using the <code class="codeph">VALIDATE_PENDING_AREA</code> procedure:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.VALIDATE_PENDING_AREA();
</pre></li>
<li>
<p>Submit the pending area using the <code class="codeph">SUBMIT_PENDING_AREA</code> procedure:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.SUBMIT_PENDING_AREA();
</pre></li>
</ol>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="ADMIN13802"></a>
<div class="props_rev_3"><a id="GUID-53C544B1-8767-4E7C-B57B-71CD63B98201"></a>
<h2 id="ADMIN-GUID-53C544B1-8767-4E7C-B57B-71CD63B98201" class="sect2"><span class="enumeration_section">44.4</span> Enabling and Disabling a CDB Resource Plan</h2>
<p>A CDB resource plan manages the workloads for multiple PDBs that are contending for system and CDB resources. You can enable or disable a CDB resource plan.</p>
<a id="ADMIN13803"></a>
<div class="props_rev_3"><a id="GUID-3E05500C-C8C0-4E99-B753-133515175437"></a>
<h3 id="ADMIN-GUID-3E05500C-C8C0-4E99-B753-133515175437" class="sect3"><span class="enumeration_section">44.4.1</span> Enabling a CDB Resource Plan</h3>
<div>
<p>You enable the Resource Manager for a CDB by setting the <code class="codeph">RESOURCE_MANAGER_PLAN</code> initialization parameter in the root.</p>
<div class="section">
<p>This parameter specifies the top plan, which is the plan to be used for the current CDB instance. If no plan is specified with this parameter, then the Resource Manager is not enabled.</p>
<p>Before enabling a CDB resource plan, complete the prerequisites described in <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-5BBC8793-8180-4EA4-8AA3-E213D070FB5B" title="You must meet prerequisites before using Resource Manager with a CDB.">Prerequisites for Using Resource Manager with a CDB</a>&#34;</span>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To enable a CDB resource plan:</p>
<ol>
<li>
<p>In SQL*Plus, ensure that the current container is the root.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Perform one of the following actions:</p>
<ul style="list-style-type: disc;">
<li>
<p>Use an <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> statement to set the <code class="codeph">RESOURCE_MANAGER_PLAN</code> initialization parameter to the CDB resource plan.</p>
<p>The following example sets the CDB resource plan to <code class="codeph">newcdb_plan</code> using an <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> statement:</p>
<pre dir="ltr">ALTER SYSTEM SET RESOURCE_MANAGER_PLAN = &#39;newcdb_plan&#39;;
</pre></li>
<li>
<p>In a text initialization parameter file, set the <code class="codeph">RESOURCE_MANAGER_PLAN</code> initialization parameter to the CDB resource plan, and restart the CDB.</p>
<p>The following example sets the CDB resource plan to <code class="codeph">newcdb_plan</code> in an initialization parameter file:</p>
<pre dir="ltr">RESOURCE_MANAGER_PLAN = &#39;newcdb_plan&#39;
</pre></li>
</ul>
</li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<p>You can also schedule a CDB resource plan change with Oracle Scheduler. See <span class="q">&#34;<a href="dbrm.htm#GUID-E8FABE8D-A781-49BB-B623-98F096DED239" title="You enable Oracle Database Resource Manager (the Resource Manager) by setting the RESOURCE_MANAGER_PLAN initialization parameter. This parameter specifies the top plan, identifying the plan to be used for the current instance. If no plan is specified with this parameter, the Resource Manager is not enabled.">Enabling Oracle Database Resource Manager and Switching Plans</a>&#34;</span> and <a href="schedover.htm#GUID-6B8C0335-D36B-44D3-95BC-82FA2141D967" title="You can schedule tasks with Oracle Scheduler.">Oracle Scheduler Concepts</a> for more information.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN13805"></a>
<div class="props_rev_3"><a id="GUID-F15E72CD-97A0-4AA8-B5B3-BDDE3F92F386"></a>
<h3 id="ADMIN-GUID-F15E72CD-97A0-4AA8-B5B3-BDDE3F92F386" class="sect3"><span class="enumeration_section">44.4.2</span> Disabling a CDB Resource Plan</h3>
<div>
<p>You disable the Resource Manager for a CDB by unsetting the <code class="codeph">RESOURCE_MANAGER_PLAN</code> initialization parameter in the root.</p>
<div class="section">
<p>If you disable a CDB resource plan, then some directives in PDB resource plans become disabled. See <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-A6BA104E-5B27-4957-AF8B-11FDCEC5DB17" title="A CDB resource plan determines the amount of resources allocated to each PDB. A PDB resource plan determines how the resources allocated to a specific PDB are allocated to consumer groups within that PDB.">PDB Resource Plans</a>&#34;</span> for information about the CDB resource plan requirements for PDB resource plans.</p>
<p>Before disabling a CDB resource plan, complete the prerequisites described in <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-5BBC8793-8180-4EA4-8AA3-E213D070FB5B" title="You must meet prerequisites before using Resource Manager with a CDB.">Prerequisites for Using Resource Manager with a CDB</a>&#34;</span>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To disable a CDB resource plan:</p>
<ol>
<li>
<p>In SQL*Plus, ensure that the current container is the root.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Perform one of the following actions:</p>
<ul style="list-style-type: disc;">
<li>
<p>Use an <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> statement to unset the <code class="codeph">RESOURCE_MANAGER_PLAN</code> initialization parameter for the CDB.</p>
<p>The following example unsets the <code class="codeph">RESOURCE_MANAGER_PLAN</code> initialization parameter using an <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> statement:</p>
<pre dir="ltr">ALTER SYSTEM SET RESOURCE_MANAGER_PLAN = &#39;&#39;;
</pre></li>
<li>
<p>In an initialization parameter file, unset the <code class="codeph">RESOURCE_MANAGER_PLAN</code> initialization parameter, and restart the CDB.</p>
<p>The following example unsets the <code class="codeph">RESOURCE_MANAGER_PLAN</code> initialization parameter in an initialization parameter file:</p>
<pre dir="ltr">RESOURCE_MANAGER_PLAN = 
</pre>
<p>To shut down and restart a CDB, see <span class="q">&#34;<a href="cdb_admin.htm#GUID-B2AC2F0B-F55E-40CD-AF37-A09E31BAA732" title="You can shut down a CDB instance in the same way that you shut down a non-CDB instance.">Shutting Down a CDB Instance</a>&#34;</span> and <span class="q">&#34;<a href="start.htm#GUID-203404B5-5157-4F29-A241-B8ABC4753819" title="When you start up a database, you create an instance of that database and you determine the state of the database. Normally, you start up an instance by mounting and opening the database. Doing so makes the database available for any valid user to connect to and perform typical data access operations.">Starting Up a Database</a>&#34;</span>.</p>
</li>
</ul>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="ADMIN13807"></a>
<div class="props_rev_3"><a id="GUID-2A0C60A0-C558-4837-B97C-A8380FB19E3A"></a>
<h2 id="ADMIN-GUID-2A0C60A0-C558-4837-B97C-A8380FB19E3A" class="sect2"><span class="enumeration_section">44.5</span> Creating a PDB Resource Plan</h2>
<div>
<p>You create a PDB resource plan in the same way that you create a resource plan for a non-CDB. You use procedures in the <code class="codeph">DBMS_RESOURCE_MANAGER</code> PL/SQL package to create the plan.</p>
<div class="section">
<p>A CDB resource plan allocates a portion of the system&#39;s resources to a PDB. A PDB resource plan determines how this portion is allocated within the PDB.</p>
<p>The following is a summary of the steps required to create a PDB resource plan:</p>
</div>
<!-- class="section" -->
<ol>
<li><span>In SQL*Plus, ensure that the current container is a PDB.</span></li>
<li><span>Create a pending area using the <code class="codeph">CREATE_PENDING_AREA</code> procedure.</span></li>
<li><span>Create, modify, or delete consumer groups using the <code class="codeph">CREATE_CONSUMER_GROUP</code> procedure.</span></li>
<li><span>Map sessions to consumer groups using the <code class="codeph">SET_CONSUMER_GROUP_MAPPING</code> procedure.</span></li>
<li><span>Create the PDB resource plan using the <code class="codeph">CREATE_PLAN</code> procedure.</span></li>
<li><span>Create PDB resource plan directives using the <code class="codeph">CREATE_PLAN_DIRECTIVE</code> procedure.</span></li>
<li><span>Validate the pending area using the <code class="codeph">VALIDATE_PENDING_AREA</code> procedure.</span></li>
<li><span>Submit the pending area using the <code class="codeph">SUBMIT_PENDING_AREA</code> procedure.</span></li>
</ol>
<div class="section">
<p>Ensure that the current container is a PDB and that the user has the required privileges when you complete these steps. See <span class="q">&#34;<a href="dbrm.htm#GUID-4816CA07-1376-45FD-82D4-F9E332936683" title="When your situation calls for a more complex resource plan, you must create the plan, with its directives and consumer groups, in a staging area called the pending area, and then validate the plan before storing it in the data dictionary.">Creating a Complex Resource Plan</a>&#34;</span> for detailed information about completing these steps.</p>
<p>You also have the option of creating a simple resource plan that is adequate for many situations using the <code class="codeph">CREATE_SIMPLE_PLAN</code> procedure. See <span class="q">&#34;<a href="dbrm.htm#GUID-EFC4517C-6C4D-44F8-A652-2266D6FB49EB" title="You can quickly create a simple resource plan that is adequate for many situations using the CREATE_SIMPLE_PLAN procedure.">Creating a Simple Resource Plan</a> &#34;</span>.</p>
<div class="infobox-note" id="GUID-2A0C60A0-C558-4837-B97C-A8380FB19E3A__GUID-A68BB797-4DE8-4A29-A2C0-90E55C170A25">
<p class="notep1">Note:</p>
<p>Some restrictions apply to PDB resource plans. See <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-A6BA104E-5B27-4957-AF8B-11FDCEC5DB17" title="A CDB resource plan determines the amount of resources allocated to each PDB. A PDB resource plan determines how the resources allocated to a specific PDB are allocated to consumer groups within that PDB.">PDB Resource Plans</a>&#34;</span> for information.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN13808"></a>
<div class="props_rev_3"><a id="GUID-B03DAA59-E508-4714-9246-C9F707A5FB61"></a>
<h2 id="ADMIN-GUID-B03DAA59-E508-4714-9246-C9F707A5FB61" class="sect2"><span class="enumeration_section">44.6</span> Enabling and Disabling a PDB Resource Plan</h2>
<p>A PDB resource plan manages the workloads within a single PDB. You can enable or disable a PDB resource plan.</p>
<a id="ADMIN13811"></a><a id="ADMIN13809"></a>
<div class="props_rev_3"><a id="GUID-57DC99C7-1C35-4AC9-A688-05F7B984D8F1"></a>
<h3 id="ADMIN-GUID-57DC99C7-1C35-4AC9-A688-05F7B984D8F1" class="sect3"><span class="enumeration_section">44.6.1</span> Enabling a PDB Resource Plan</h3>
<div>
<p>You enable a PDB resource plan by setting the <code class="codeph">RESOURCE_MANAGER_PLAN</code> initialization parameter to the plan with an <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> statement when the current container is the PDB.</p>
<div class="section">
<p>If no plan is specified with this parameter, then no PDB resource plan is enabled for the PDB.</p>
<p>Before enabling a PDB resource plan, complete the prerequisites described in <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-5BBC8793-8180-4EA4-8AA3-E213D070FB5B" title="You must meet prerequisites before using Resource Manager with a CDB.">Prerequisites for Using Resource Manager with a CDB</a>&#34;</span>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To enable a PDB resource plan:</p>
<ol>
<li>
<p>In SQL*Plus, ensure that the current container is a PDB.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Use an <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> statement to set the <code class="codeph">RESOURCE_MANAGER_PLAN</code> initialization parameter to the PDB resource plan.</p>
</li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<p>You can also schedule a PDB resource plan change with Oracle Scheduler. See <span class="q">&#34;<a href="dbrm.htm#GUID-E8FABE8D-A781-49BB-B623-98F096DED239" title="You enable Oracle Database Resource Manager (the Resource Manager) by setting the RESOURCE_MANAGER_PLAN initialization parameter. This parameter specifies the top plan, identifying the plan to be used for the current instance. If no plan is specified with this parameter, the Resource Manager is not enabled.">Enabling Oracle Database Resource Manager and Switching Plans</a>&#34;</span> and <a href="schedover.htm#GUID-6B8C0335-D36B-44D3-95BC-82FA2141D967" title="You can schedule tasks with Oracle Scheduler.">Oracle Scheduler Concepts</a> for more information.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-57DC99C7-1C35-4AC9-A688-05F7B984D8F1__GUID-71001B10-3B10-405F-89A3-A77BF885FD0F">
<p class="titleinexample">Example 44-1 Enabling a PDB Resource Plan</p>
<p>The following example sets the PDB resource plan to <code class="codeph">salespdb_plan</code>.</p>
<pre dir="ltr">ALTER SYSTEM SET RESOURCE_MANAGER_PLAN = &#39;salespdb_plan&#39;;
</pre>
<div class="infoboxnotealso" id="GUID-57DC99C7-1C35-4AC9-A688-05F7B984D8F1__GUID-A0783E44-4F15-48BF-9F55-ED1CAA4A7D6F">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="cdb_pdb_admin.htm#GUID-3AAA613B-C52C-4080-B0C3-7212859E3A2F" title="You can use the ALTER SYSTEM statement to modify a PDB.">Using the ALTER SYSTEM Statement to Modify a PDB</a>&#34;</span></p>
</div>
</div>
<!-- class="example" --></div>
</div>
<a id="ADMIN13814"></a><a id="ADMIN13812"></a>
<div class="props_rev_3"><a id="GUID-8E0172B0-D9F3-4CA4-92FA-73EC39EE0D1E"></a>
<h3 id="ADMIN-GUID-8E0172B0-D9F3-4CA4-92FA-73EC39EE0D1E" class="sect3"><span class="enumeration_section">44.6.2</span> Disabling a PDB Resource Plan</h3>
<div>
<p>You disable a PDB resource plan by unsetting the <code class="codeph">RESOURCE_MANAGER_PLAN</code> initialization parameter in the PDB.</p>
<div class="section">
<p>Before disabling a PDB resource plan, complete the prerequisites described in <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-5BBC8793-8180-4EA4-8AA3-E213D070FB5B" title="You must meet prerequisites before using Resource Manager with a CDB.">Prerequisites for Using Resource Manager with a CDB</a>&#34;</span>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To disable a PDB resource plan:</p>
<ol>
<li>
<p>In SQL*Plus, ensure that the current container is a PDB.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Use an <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> statement to unset the <code class="codeph">RESOURCE_MANAGER_PLAN</code> initialization parameter for the PDB.</p>
</li>
</ol>
</div>
<!-- class="section" -->
<div class="section"></div>
<!-- class="section" -->
<div class="example" id="GUID-8E0172B0-D9F3-4CA4-92FA-73EC39EE0D1E__GUID-352DCF99-414B-45A3-862C-CFB3BC3E1AAA">
<p class="titleinexample">Example 44-2 Disabling a PDB Resource Plan</p>
<p>The following example disables the PDB resource plan.</p>
<pre dir="ltr">ALTER SYSTEM SET RESOURCE_MANAGER_PLAN = &#39;&#39;;
</pre>
<div class="infoboxnotealso" id="GUID-8E0172B0-D9F3-4CA4-92FA-73EC39EE0D1E__GUID-7E83A43E-BB6B-4C3D-911D-E38C59C5B5CB">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="cdb_pdb_admin.htm#GUID-3AAA613B-C52C-4080-B0C3-7212859E3A2F" title="You can use the ALTER SYSTEM statement to modify a PDB.">Using the ALTER SYSTEM Statement to Modify a PDB</a>&#34;</span></p>
</div>
</div>
<!-- class="example" --></div>
</div>
</div>
<a id="ADMIN13815"></a>
<div class="props_rev_3"><a id="GUID-B3FED12D-DA2A-4A19-9C45-93FC32690822"></a>
<h2 id="ADMIN-GUID-B3FED12D-DA2A-4A19-9C45-93FC32690822" class="sect2"><span class="enumeration_section">44.7</span> Maintaining Plans and Directives in a CDB</h2>
<p>This section provides instructions for maintaining CDB resource plans, the default directive for PDBs, the autotask directive, and PDB resource plans. You perform maintenance tasks using the <code class="codeph">DBMS_RESOURCE_MANAGER</code> PL/SQL package.</p>
<a id="ADMIN13816"></a>
<div class="props_rev_3"><a id="GUID-DDEA2C3E-DE9E-4EAA-9C3B-998B1E440697"></a>
<h3 id="ADMIN-GUID-DDEA2C3E-DE9E-4EAA-9C3B-998B1E440697" class="sect3"><span class="enumeration_section">44.7.1</span> Managing a CDB Resource Plan</h3>
<p>Managing a CDB resource plan includes tasks such as updating the plan, creating, updating, or deleting plan directives for PDBs, and updating default directives.</p>
<a id="ADMIN13817"></a>
<div class="props_rev_3"><a id="GUID-548307C2-72BE-436E-B843-4419CD77540D"></a>
<h4 id="ADMIN-GUID-548307C2-72BE-436E-B843-4419CD77540D" class="sect4"><span class="enumeration_section">44.7.1.1</span> Updating a CDB Resource Plan</h4>
<div>
<p>You can update a CDB resource plan to change its comment using the <code class="codeph">UPDATE_CDB_PLAN</code> procedure.</p>
<div class="section">
<p>Before updating a CDB resource plan, complete the prerequisites described in <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-5BBC8793-8180-4EA4-8AA3-E213D070FB5B" title="You must meet prerequisites before using Resource Manager with a CDB.">Prerequisites for Using Resource Manager with a CDB</a>&#34;</span>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p>To update a CDB resource plan:</p>
<ol>
<li>
<p>In SQL*Plus, ensure that the current container is the root.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Create a pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.CREATE_PENDING_AREA();
</pre></li>
<li>
<p>Run the <code class="codeph">UPDATE_CDB_PLAN</code> procedure, and enter a new comment in the <code class="codeph">new_comment</code> parameter.</p>
<p>For example, the following procedure changes the comment for the <code class="codeph">newcdb_plan</code> CDB resource plan:</p>
<pre dir="ltr">BEGIN
  DBMS_RESOURCE_MANAGER.UPDATE_CDB_PLAN(
    plan        =&gt; &#39;newcdb_plan&#39;,
    new_comment =&gt; &#39;CDB plan for PDBs in newcdb&#39;);
END;
/
</pre></li>
<li>
<p>Validate the pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.VALIDATE_PENDING_AREA();
</pre></li>
<li>
<p>Submit the pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.SUBMIT_PENDING_AREA();
</pre></li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-548307C2-72BE-436E-B843-4419CD77540D__GUID-D9FFF20D-39F2-489C-8529-5912B530D2DF">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="cdb_dbrm.htm#GUID-075BDB11-8B9D-4061-98F6-8D4F07E3AB6D" title="In a CDB, PDBs might have different levels of priority. You can create CDB resource plans to distribute resources to different PDBs based on these priorities.">CDB Resource Plans</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN13819"></a>
<div class="props_rev_3"><a id="GUID-07A4546E-A0D1-46AE-BFA2-D28C3915906D"></a>
<h4 id="ADMIN-GUID-07A4546E-A0D1-46AE-BFA2-D28C3915906D" class="sect4"><span class="enumeration_section">44.7.1.2</span> Creating New CDB Resource Plan Directives for a PDB</h4>
<div>
<p>When you create a PDB in a CDB, you can create a CDB resource plan directive for the PDB using the <code class="codeph">CREATE_CDB_PLAN_DIRECTIVE</code> procedure. The directive specifies how resources are allocated to the new PDB.</p>
<div class="section">
<p>Before creating a new CDB resource plan directive for a PDB, complete the prerequisites described in <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-5BBC8793-8180-4EA4-8AA3-E213D070FB5B" title="You must meet prerequisites before using Resource Manager with a CDB.">Prerequisites for Using Resource Manager with a CDB</a>&#34;</span>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p>To create a new CDB resource plan directive for a PDB:</p>
<ol>
<li>
<p>In SQL*Plus, ensure that the current container is the root.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Create a pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.CREATE_PENDING_AREA();
</pre></li>
<li>
<p>Run the <code class="codeph">CREATE_CDB_PLAN_DIRECTIVE</code> procedure, and specify the appropriate values for the new PDB.</p>
<p>For example, the following procedure allocates resources to a PDB named <code class="codeph">operpdb</code> in the <code class="codeph">newcdb_plan</code> CDB resource plan:</p>
<pre dir="ltr">BEGIN
  DBMS_RESOURCE_MANAGER.CREATE_CDB_PLAN_DIRECTIVE(
    plan                  =&gt; &#39;newcdb_plan&#39;, 
    pluggable_database    =&gt; &#39;operpdb&#39;, 
    shares                =&gt; 1, 
    utilization_limit     =&gt; 20,
    parallel_server_limit =&gt; 30);
END;
/
</pre></li>
<li>
<p>Validate the pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.VALIDATE_PENDING_AREA();
</pre></li>
<li>
<p>Submit the pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.SUBMIT_PENDING_AREA();
</pre></li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-07A4546E-A0D1-46AE-BFA2-D28C3915906D__GUID-99D4A9C7-DEAF-4FEE-A287-7D0E7B7E8454">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="cdb_dbrm.htm#GUID-075BDB11-8B9D-4061-98F6-8D4F07E3AB6D" title="In a CDB, PDBs might have different levels of priority. You can create CDB resource plans to distribute resources to different PDBs based on these priorities.">CDB Resource Plans</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN13821"></a>
<div class="props_rev_3"><a id="GUID-FF00B9A0-293F-4544-9121-104E53F898B9"></a>
<h4 id="ADMIN-GUID-FF00B9A0-293F-4544-9121-104E53F898B9" class="sect4"><span class="enumeration_section">44.7.1.3</span> Updating CDB Resource Plan Directives for a PDB</h4>
<div>
<p>You can update the CDB resource plan directive for a PDB using the <code class="codeph">UPDATE_CDB_PLAN_DIRECTIVE</code> procedure. The directive specifies how resources are allocated to the PDB.</p>
<div class="section">
<p>Before updating a CDB resource plan directive for a PDB, complete the prerequisites described in <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-5BBC8793-8180-4EA4-8AA3-E213D070FB5B" title="You must meet prerequisites before using Resource Manager with a CDB.">Prerequisites for Using Resource Manager with a CDB</a>&#34;</span>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p>To update a CDB resource plan directive for a PDB:</p>
<ol>
<li>
<p>In SQL*Plus, ensure that the current container is the root.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Create a pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.CREATE_PENDING_AREA();
</pre></li>
<li>
<p>Run the <code class="codeph">UPDATE_CDB_PLAN_DIRECTIVE</code> procedure, and specify the new resource allocation values for the PDB.</p>
<p>For example, the following procedure updates the resource allocation to a PDB named <code class="codeph">operpdb</code> in the <code class="codeph">newcdb_plan</code> CDB resource plan:</p>
<pre dir="ltr">BEGIN
  DBMS_RESOURCE_MANAGER.UPDATE_CDB_PLAN_DIRECTIVE(
    plan                      =&gt; &#39;newcdb_plan&#39;, 
    pluggable_database        =&gt; &#39;operpdb&#39;, 
    new_shares                =&gt; 1, 
    new_utilization_limit     =&gt; 10,
    new_parallel_server_limit =&gt; 20);
END;
/
</pre></li>
<li>
<p>Validate the pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.VALIDATE_PENDING_AREA();
</pre></li>
<li>
<p>Submit the pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.SUBMIT_PENDING_AREA();
</pre></li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-FF00B9A0-293F-4544-9121-104E53F898B9__GUID-01B9F722-B565-4FE4-93DC-6C9BDFDAB931">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="cdb_dbrm.htm#GUID-075BDB11-8B9D-4061-98F6-8D4F07E3AB6D" title="In a CDB, PDBs might have different levels of priority. You can create CDB resource plans to distribute resources to different PDBs based on these priorities.">CDB Resource Plans</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN13823"></a>
<div class="props_rev_3"><a id="GUID-F88B5D61-87AC-4662-B5B6-A6A616F90119"></a>
<h4 id="ADMIN-GUID-F88B5D61-87AC-4662-B5B6-A6A616F90119" class="sect4"><span class="enumeration_section">44.7.1.4</span> Deleting CDB Resource Plan Directives for a PDB</h4>
<div>
<p>You can delete the CDB resource plan directive for a PDB using the <code class="codeph">DELETE_CDB_PLAN_DIRECTIVE</code> procedure.</p>
<div class="section">
<p>You might delete the directive for a PDB if you unplug or drop the PDB. However, you can retain the directive, and if the PDB is plugged into the CDB in the future, the existing directive applies to the PDB.</p>
<p>Before deleting a CDB resource plan directive for a PDB, complete the prerequisites described in <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-5BBC8793-8180-4EA4-8AA3-E213D070FB5B" title="You must meet prerequisites before using Resource Manager with a CDB.">Prerequisites for Using Resource Manager with a CDB</a>&#34;</span>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To delete a CDB resource plan directive for a PDB:</p>
<ol>
<li>
<p>In SQL*Plus, ensure that the current container is the root.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Create a pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.CREATE_PENDING_AREA();
</pre></li>
<li>
<p>Run the <code class="codeph">DELETE_CDB_PLAN_DIRECTIVE</code> procedure, and specify the CDB resource plan and the PDB.</p>
<p>For example, the following procedure deletes the directive for a PDB named <code class="codeph">operpdb</code> in the <code class="codeph">newcdb_plan</code> CDB resource plan:</p>
<pre dir="ltr">BEGIN
  DBMS_RESOURCE_MANAGER.DELETE_CDB_PLAN_DIRECTIVE(
    plan               =&gt; &#39;newcdb_plan&#39;, 
    pluggable_database =&gt; &#39;operpdb&#39;);
END;
/
</pre></li>
<li>
<p>Validate the pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.VALIDATE_PENDING_AREA();
</pre></li>
<li>
<p>Submit the pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.SUBMIT_PENDING_AREA();
</pre></li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-F88B5D61-87AC-4662-B5B6-A6A616F90119__GUID-2DAC6ADA-8ECC-4B7E-9800-3CC6A3823AF5">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="cdb_dbrm.htm#GUID-075BDB11-8B9D-4061-98F6-8D4F07E3AB6D" title="In a CDB, PDBs might have different levels of priority. You can create CDB resource plans to distribute resources to different PDBs based on these priorities.">CDB Resource Plans</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN13827"></a>
<div class="props_rev_3"><a id="GUID-98B4BC74-D86C-4084-9436-BE4440ED15DD"></a>
<h4 id="ADMIN-GUID-98B4BC74-D86C-4084-9436-BE4440ED15DD" class="sect4"><span class="enumeration_section">44.7.1.5</span> Updating the Default Directive for PDBs in a CDB Resource Plan</h4>
<div>
<p>You can update the default directive for PDBs in a CDB resource plan using the <code class="codeph">UPDATE_CDB_DEFAULT_DIRECTIVE</code> procedure. The default directive applies to PDBs for which specific directives have not been defined.</p>
<div class="section">
<p>See <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-3E84009E-5CD6-46B8-84D3-BE775D58D9AA" title="When you do not explicitly define directives for a PDB, the PDB uses the default directive for PDBs.">The Default Directive for PDBs</a>&#34;</span> for more information.</p>
<p>Before updating the default directive for PDBs in a CDB resource plan, complete the prerequisites described in <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-5BBC8793-8180-4EA4-8AA3-E213D070FB5B" title="You must meet prerequisites before using Resource Manager with a CDB.">Prerequisites for Using Resource Manager with a CDB</a>&#34;</span>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To update the default directive for PDBs in a CDB resource plan:</p>
<ol>
<li>
<p>In SQL*Plus, ensure that the current container is the root.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Create a pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.CREATE_PENDING_AREA();
</pre></li>
<li>
<p>Run the <code class="codeph">UPDATE_CDB_DEFAULT_DIRECTIVE</code> procedure, and specify the appropriate default resource allocation values.</p>
<p>For example, the following procedure updates the default directive for PDBs in the <code class="codeph">newcdb_plan</code> CDB resource plan:</p>
<pre dir="ltr">BEGIN
  DBMS_RESOURCE_MANAGER.UPDATE_CDB_DEFAULT_DIRECTIVE(
    plan                  =&gt; &#39;newcdb_plan&#39;, 
    new_shares            =&gt; 2, 
    new_utilization_limit =&gt; 40);
END;
/
</pre></li>
<li>
<p>Validate the pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.VALIDATE_PENDING_AREA();
</pre></li>
<li>
<p>Submit the pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.SUBMIT_PENDING_AREA();
</pre></li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-98B4BC74-D86C-4084-9436-BE4440ED15DD__GUID-89D30DBF-2D08-4785-AAA6-6C834A6C071B">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="cdb_dbrm.htm#GUID-075BDB11-8B9D-4061-98F6-8D4F07E3AB6D" title="In a CDB, PDBs might have different levels of priority. You can create CDB resource plans to distribute resources to different PDBs based on these priorities.">CDB Resource Plans</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN13829"></a>
<div class="props_rev_3"><a id="GUID-F848B54D-46BE-4F39-8C30-0B47EC34C4B0"></a>
<h4 id="ADMIN-GUID-F848B54D-46BE-4F39-8C30-0B47EC34C4B0" class="sect4"><span class="enumeration_section">44.7.1.6</span> Updating the Default Directive for Maintenance Tasks in a CDB Resource Plan</h4>
<div>
<p>You can update the autotask directive in a CDB resource plan using the <code class="codeph">UPDATE_CDB_AUTOTASK_DIRECTIVE</code> procedure. The autotask directive applies to automatic maintenance tasks that are run in the root maintenance window.</p>
<div class="section">
<p>Before updating the default directive for maintenance tasks in a CDB resource plan, complete the prerequisites described in <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-5BBC8793-8180-4EA4-8AA3-E213D070FB5B" title="You must meet prerequisites before using Resource Manager with a CDB.">Prerequisites for Using Resource Manager with a CDB</a>&#34;</span>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To update the autotask directive for maintenance tasks in a CDB resource plan:</p>
<ol>
<li>
<p>In SQL*Plus, ensure that the current container is the root.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Create a pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.CREATE_PENDING_AREA();
</pre></li>
<li>
<p>Run the <code class="codeph">UPDATE_CDB_AUTOTASK_DIRECTIVE</code> procedure, and specify the appropriate autotask resource allocation values.</p>
<p>For example, the following procedure updates the autotask directive for maintenance tasks in the <code class="codeph">newcdb_plan</code> CDB resource plan:</p>
<pre dir="ltr">BEGIN
  DBMS_RESOURCE_MANAGER.UPDATE_CDB_AUTOTASK_DIRECTIVE(
    plan                  =&gt; &#39;newcdb_plan&#39;, 
    new_shares            =&gt; 2, 
    new_utilization_limit =&gt; 60);
END;
/
</pre></li>
<li>
<p>Validate the pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.VALIDATE_PENDING_AREA();
</pre></li>
<li>
<p>Submit the pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.SUBMIT_PENDING_AREA();
</pre></li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-F848B54D-46BE-4F39-8C30-0B47EC34C4B0__GUID-97E3869B-F4C9-41C6-9652-13FACF286525">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="cdb_dbrm.htm#GUID-075BDB11-8B9D-4061-98F6-8D4F07E3AB6D" title="In a CDB, PDBs might have different levels of priority. You can create CDB resource plans to distribute resources to different PDBs based on these priorities.">CDB Resource Plans</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN13825"></a>
<div class="props_rev_3"><a id="GUID-5BBA5044-5BD8-4C79-9D3E-1168F90E68CB"></a>
<h4 id="ADMIN-GUID-5BBA5044-5BD8-4C79-9D3E-1168F90E68CB" class="sect4"><span class="enumeration_section">44.7.1.7</span> Deleting a CDB Resource Plan</h4>
<div>
<p>You can delete a CDB resource plan using the <code class="codeph">DELETE_CDB_PLAN</code> procedure.</p>
<div class="section">
<p>The resource plan must be disabled. You might delete a CDB resource plan if the plan is no longer needed. You can enable a different CDB resource plan, or you can disable Resource Manager for the CDB.</p>
<p>Before deleting a CDB resource plan, complete the prerequisites described in <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-5BBC8793-8180-4EA4-8AA3-E213D070FB5B" title="You must meet prerequisites before using Resource Manager with a CDB.">Prerequisites for Using Resource Manager with a CDB</a>&#34;</span>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To delete a CDB resource plan:</p>
<ol>
<li>
<p>In SQL*Plus, ensure that the current container is the root.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Create a pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.CREATE_PENDING_AREA();
</pre></li>
<li>
<p>Run the <code class="codeph">DELETE_CDB_PLAN</code> procedure, and specify the CDB resource plan.</p>
<p>For example, the following procedure deletes the <code class="codeph">newcdb_plan</code> CDB resource plan:</p>
<pre dir="ltr">BEGIN
  DBMS_RESOURCE_MANAGER.DELETE_CDB_PLAN(
    plan =&gt; &#39;newcdb_plan&#39;);
END;
/
</pre></li>
<li>
<p>Validate the pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.VALIDATE_PENDING_AREA();
</pre></li>
<li>
<p>Submit the pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.SUBMIT_PENDING_AREA();
</pre></li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-5BBA5044-5BD8-4C79-9D3E-1168F90E68CB__GUID-784F2FE3-7890-472F-AF92-C51B9C9DDDA7">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="cdb_dbrm.htm#GUID-075BDB11-8B9D-4061-98F6-8D4F07E3AB6D" title="In a CDB, PDBs might have different levels of priority. You can create CDB resource plans to distribute resources to different PDBs based on these priorities.">CDB Resource Plans</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="cdb_dbrm.htm#GUID-3E05500C-C8C0-4E99-B753-133515175437" title="You enable the Resource Manager for a CDB by setting the RESOURCE_MANAGER_PLAN initialization parameter in the root.">Enabling a CDB Resource Plan</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="cdb_dbrm.htm#GUID-F15E72CD-97A0-4AA8-B5B3-BDDE3F92F386" title="You disable the Resource Manager for a CDB by unsetting the RESOURCE_MANAGER_PLAN initialization parameter in the root.">Disabling a CDB Resource Plan</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="ADMIN13831"></a>
<div class="props_rev_3"><a id="GUID-ACF0635C-2642-48C3-8484-245826F16F31"></a>
<h3 id="ADMIN-GUID-ACF0635C-2642-48C3-8484-245826F16F31" class="sect3"><span class="enumeration_section">44.7.2</span> Modifying a PDB Resource Plan</h3>
<div>
<p>You can use the <code class="codeph">DBMS_RESOURCE_MANAGER</code> package to modify a PDB resource plan in the same way you would modify the resource plan for a non-CDB.</p>
<div class="section">
<p>Before modifying a PDB resource plan, complete the prerequisites described in <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-5BBC8793-8180-4EA4-8AA3-E213D070FB5B" title="You must meet prerequisites before using Resource Manager with a CDB.">Prerequisites for Using Resource Manager with a CDB</a>&#34;</span>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To modify a PDB resource plan:</p>
<ol>
<li>
<p>In SQL*Plus, ensure that the current container is a PDB.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">About Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Create a pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.CREATE_PENDING_AREA();
</pre></li>
<li>
<p>Modify the PDB resource plan by completing one or more of the following tasks:</p>
<ul style="list-style-type: disc;">
<li>
<p>Update a consumer group using the <code class="codeph">UPDATE_CONSUMER_GROUP</code> procedure.</p>
</li>
<li>
<p>Delete a consumer group using the <code class="codeph">DELETE_CONSUMER_GROUP</code> procedure.</p>
</li>
<li>
<p>Update a resource plan using the <code class="codeph">UPDATE_PLAN</code> procedure.</p>
</li>
<li>
<p>Delete a resource plan using the <code class="codeph">DELETE_PLAN</code> procedure.</p>
</li>
<li>
<p>Update a resource plan directive using the <code class="codeph">UPDATE_PLAN_DIRECTIVE</code> procedure.</p>
</li>
<li>
<p>Delete a resource plan directive using the <code class="codeph">DELETE_PLAN_DIRECTIVE</code> procedure.</p>
</li>
</ul>
<p>See <span class="q">&#34;<a href="dbrm.htm#GUID-86F4CE3C-3B5C-41D6-A50D-E965E13C1408" title="You can maintain consumer groups, resource plans, and resource plan directives for Oracle Database Resource Manager (the Resource Manager). You perform maintenance tasks using the DBMS_RESOURCE_MANAGER PL/SQL package.">Maintaining Consumer Groups, Plans, and Directives</a>&#34;</span> for instructions about completing these tasks.</p>
</li>
<li>
<p>Validate the pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.VALIDATE_PENDING_AREA();
</pre></li>
<li>
<p>Submit the pending area:</p>
<pre dir="ltr">exec DBMS_RESOURCE_MANAGER.SUBMIT_PENDING_AREA();
</pre></li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-ACF0635C-2642-48C3-8484-245826F16F31__GUID-2FD844FB-F79F-428E-B02D-BCA15329DBCC">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="cdb_dbrm.htm#GUID-A6BA104E-5B27-4957-AF8B-11FDCEC5DB17" title="A CDB resource plan determines the amount of resources allocated to each PDB. A PDB resource plan determines how the resources allocated to a specific PDB are allocated to consumer groups within that PDB.">PDB Resource Plans</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="ADMIN13833"></a>
<div class="props_rev_3"><a id="GUID-56FC5591-F114-40CC-ADE9-D4562F4B1172"></a>
<h2 id="ADMIN-GUID-56FC5591-F114-40CC-ADE9-D4562F4B1172" class="sect2"><span class="enumeration_section">44.8</span> Viewing Information About Plans and Directives in a CDB</h2>
<div>
<p>You can view information about CDB resource plans, CDB resource plan directives, and predefined resource plans in a CDB.</p>
<div class="infoboxnotealso" id="GUID-56FC5591-F114-40CC-ADE9-D4562F4B1172__GUID-E5A9CF45-8772-45D3-B46A-3DFE5DC35800">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="dbrm.htm#GUID-9CF57A7E-CCE3-4F80-9E21-29AF9B2283F0" title="A set of dynamic performance views enable you to monitor the results of your Oracle Database Resource Manager settings.">Monitoring Oracle Database Resource Manager</a>&#34;</span></p>
</div>
</div>
<a id="ADMIN13834"></a>
<div class="props_rev_3"><a id="GUID-D9CBC576-4C49-4C47-9328-937E81409C0D"></a>
<h3 id="ADMIN-GUID-D9CBC576-4C49-4C47-9328-937E81409C0D" class="sect3"><span class="enumeration_section">44.8.1</span> Viewing CDB Resource Plans</h3>
<div>
<p>An example illustrates using the <code class="codeph">DBA_CDB_RSRC_PLANS</code> view to display all of the CDB resource plans defined in the CDB.</p>
<div class="section">
<p>Run the following query in the root:</p>
<pre dir="ltr">COLUMN PLAN FORMAT A30
COLUMN STATUS FORMAT A10
COLUMN COMMENTS FORMAT A35
 
SELECT PLAN, STATUS, COMMENTS FROM DBA_CDB_RSRC_PLANS ORDER BY PLAN;
</pre>
<p>Your output looks similar to the following:</p>
<pre dir="ltr">PLAN                           STATUS     COMMENTS
------------------------------ ---------- -----------------------------------
DEFAULT_CDB_PLAN                          Default CDB plan
DEFAULT_MAINTENANCE_PLAN                  Default CDB maintenance plan
NEWCDB_PLAN                               CDB plan for PDBs in newcdb
ORA$INTERNAL_CDB_PLAN                     Internal CDB plan
</pre>
<p>The <code class="codeph">DEFAULT_CDB_PLAN</code> is a default CDB plan that is supplied with Oracle Database. You can use this default plan if it meets your requirements.</p>
<div class="infobox-note" id="GUID-D9CBC576-4C49-4C47-9328-937E81409C0D__GUID-9EC6EFBA-B90B-42B9-8376-0D38D88BD4F2">
<p class="notep1">Note:</p>
<p>Plans in the pending area have a status of <code class="codeph">PENDING</code>. Plans in the pending area are being edited. Any plan that is not in the pending area has a <code class="codeph">NULL</code> status.</p>
</div>
<div class="infoboxnotealso" id="GUID-D9CBC576-4C49-4C47-9328-937E81409C0D__GUID-81E80ABD-1851-4811-8538-830AB6439030">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="cdb_dbrm.htm#GUID-075BDB11-8B9D-4061-98F6-8D4F07E3AB6D" title="In a CDB, PDBs might have different levels of priority. You can create CDB resource plans to distribute resources to different PDBs based on these priorities.">CDB Resource Plans</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN13835"></a>
<div class="props_rev_3"><a id="GUID-E89C4503-9DAB-4600-B406-01AAC01F4734"></a>
<h3 id="ADMIN-GUID-E89C4503-9DAB-4600-B406-01AAC01F4734" class="sect3"><span class="enumeration_section">44.8.2</span> Viewing CDB Resource Plan Directives</h3>
<div>
<p>An example illustrates using the <code class="codeph">DBA_CDB_RSRC_PLAN_DIRECTIVES</code> view to display all of the directives defined in all of the CDB resource plans in the CDB.</p>
<div class="section">
<p>Run the following query in the root:</p>
<pre dir="ltr">COLUMN PLAN HEADING &#39;Plan&#39; FORMAT A26
COLUMN PLUGGABLE_DATABASE HEADING &#39;Pluggable|Database&#39; FORMAT A25
COLUMN SHARES HEADING &#39;Shares&#39; FORMAT 999
COLUMN UTILIZATION_LIMIT HEADING &#39;Utilization|Limit&#39; FORMAT 999
COLUMN PARALLEL_SERVER_LIMIT HEADING &#39;Parallel|Server|Limit&#39; FORMAT 999
 
SELECT PLAN, 
       PLUGGABLE_DATABASE, 
       SHARES, 
       UTILIZATION_LIMIT,
       PARALLEL_SERVER_LIMIT
  FROM DBA_CDB_RSRC_PLAN_DIRECTIVES
  ORDER BY PLAN;
</pre>
<p>Your output looks similar to the following:</p>
<pre dir="ltr">                                                                        Parallel
                           Pluggable                        Utilization   Server
Plan                       Database                  Shares       Limit    Limit
-------------------------- ------------------------- ------ ----------- --------
DEFAULT_CDB_PLAN           ORA$DEFAULT_PDB_DIRECTIVE      1         100      100
DEFAULT_CDB_PLAN           ORA$AUTOTASK                              90      100
DEFAULT_MAINTENANCE_PLAN   ORA$DEFAULT_PDB_DIRECTIVE      1         100      100
DEFAULT_MAINTENANCE_PLAN   ORA$AUTOTASK                              90      100
NEWCDB_PLAN                SALESPDB                       3
NEWCDB_PLAN                HRPDB                          1          70       70
NEWCDB_PLAN                ORA$DEFAULT_PDB_DIRECTIVE      2          40       50
NEWCDB_PLAN                ORA$AUTOTASK                   2          60       75
NEWCDB_PLAN                SERVICESPDB                    3
ORA$INTERNAL_CDB_PLAN      ORA$DEFAULT_PDB_DIRECTIVE
ORA$INTERNAL_CDB_PLAN      ORA$AUTOTASK
</pre>
<p>The <code class="codeph">DEFAULT_CDB_PLAN</code> is a default CDB plan that is supplied with Oracle Database. You can use this default plan if it meets your requirements.</p>
<p>This output shows the directives for the <code class="codeph">newcdb_plan</code> created in <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-36E58D2B-2873-4ED1-B042-624DB42A5C8E" title="A scenario illustrates each of the steps involved in creating a CDB resource plan.">Creating a CDB Resource Plan: A Scenario</a>&#34;</span> and modified in <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-DDEA2C3E-DE9E-4EAA-9C3B-998B1E440697" title="Managing a CDB resource plan includes tasks such as updating the plan, creating, updating, or deleting plan directives for PDBs, and updating default directives.">Managing a CDB Resource Plan</a>&#34;</span>.</p>
<div class="infobox-note" id="GUID-E89C4503-9DAB-4600-B406-01AAC01F4734__GUID-FCC91CFC-47DA-4618-862B-6F748C840CB2">
<p class="notep1">Note:</p>
<p>The <code class="codeph">ORA$DEFAULT_PDB_DIRECTIVE</code> is the default directive for PDBs. See <span class="q">&#34;<a href="cdb_dbrm.htm#GUID-3E84009E-5CD6-46B8-84D3-BE775D58D9AA" title="When you do not explicitly define directives for a PDB, the PDB uses the default directive for PDBs.">The Default Directive for PDBs</a>&#34;</span>.</p>
</div>
<div class="infoboxnotealso" id="GUID-E89C4503-9DAB-4600-B406-01AAC01F4734__GUID-6B8D4EEE-5B1E-408F-BD76-089A6C113F90">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="cdb_dbrm.htm#GUID-075BDB11-8B9D-4061-98F6-8D4F07E3AB6D" title="In a CDB, PDBs might have different levels of priority. You can create CDB resource plans to distribute resources to different PDBs based on these priorities.">CDB Resource Plans</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1842">
<tr>
<td class="cellalignment1854">
<table class="cellalignment1847">
<tr>
<td class="cellalignment1846"><a href="cdb_mon.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1846"><a href="cdb_dbrm_em.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2001, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1856">
<table class="cellalignment1845">
<tr>
<td class="cellalignment1846"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1846"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1846"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1846"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1846"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1846"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>