<html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-195"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Managing%20Data%20Files%20and%20Temp%20Files"></a><title>Managing Data Files and Temp Files</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="description" content="You can manage data files and temp files by performing tasks such as creating them, altering them, and dropping them."/>
<meta name="keywords" content="data files, guidelines for managing, definition, file numbers, minimum number of, DB_FILES initialization parameter, determining value for, initialization parameters, DB_FILES, size of, tablespaces, location, performance, location of data files and, storing separately from redo log files, redo log files, storing separately from data files, adding to a tablespace, statements to create, creating data files, creating, adding data files, reusing, fully specifying file names, default directory, automatic file extension, AUTOEXTEND clause, bringing online and offline, SYSTEM tablespace, restrictions on taking offline, ARCHIVELOG mode, taking data files offline and online in, NOARCHIVELOG mode, taking data files offline in, ALTER DATABASE statement, DATAFILE...OFFLINE DROP clause, dropping, dropping data files, online, relocating, renaming, offline, operating systems, renaming and relocating files, ALTER TABLESPACE statement, RENAME DATAFILE clause, RENAME FILE clause, temp files, checksums, for data blocks, verifying data blocks, data blocks, verifying, DB_BLOCK_CHECKSUM initialization parameter, DB_BLOCK_CHECKSUM, DBMS_FILE_TRANSFER package, copying data files, packages, DBMS_FILE_TRANSFER, database writer process, calculating checksums for data blocks, copying using database, mapping files to physical devices, logical volume managers, storage subsystems, file mapping, overview, how it works, FMON background process, background processes, FMON, structures, how to use, DBMS_STORAGE_MAP, views, file mapping views, examples, data dictionary, for data files, data dictionary views reference"/>
<meta name="dcterms.created" content="2017-07-10T12:24:11Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Administrator&rsquo;s Guide"/>
<meta name="dcterms.identifier" content="E41484-15"/>
<meta name="dcterms.isVersionOf" content="ADMIN"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2001, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="tspaces.htm" title="Previous" type="text/html"/>
<link rel="Next" href="transport.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41484-15.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-501A8889-3C18-4F99-B0B7-9095E981B970"></a> <span id="PAGE" style="display:none;">20/59</span> <!-- End Header -->
<a id="ADMIN012"></a>
<h1 id="ADMIN-GUID-501A8889-3C18-4F99-B0B7-9095E981B970" class="sect1"><span class="enumeration_chapter">14</span> Managing Data Files and Temp Files</h1>
<div>
<p>You can manage data files and temp files by performing tasks such as creating them, altering them, and dropping them.</p>
<div class="infobox-note" id="GUID-501A8889-3C18-4F99-B0B7-9095E981B970__GUID-2090C387-52B5-4F26-BA36-45FDA54CE013">
<p class="notep1">Note:</p>
<p>Temp files are a special class of data files that are associated only with temporary tablespaces. Information in this chapter applies to both data files and temp files except where differences are noted. Temp files are further described in <span class="q">&#34;<a href="tspaces.htm#GUID-03CCF8D4-9DAA-451A-B9F8-836F8262B43D" title="Because space management is much simpler and more efficient in locally managed tablespaces, they are ideally suited for temporary tablespaces.">Creating a Locally Managed Temporary Tablespace</a>&#34;</span></p>
</div>
<div class="infoboxnotealso" id="GUID-501A8889-3C18-4F99-B0B7-9095E981B970__GUID-80813556-4353-43EA-81BF-576D2D3DED11">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="omf.htm#GUID-4A3C4616-0D81-4BBA-8EAD-FCAA8AD5C15A" title="Oracle Database can manage the files that comprise the database.">Using Oracle Managed Files</a> for information about creating data files and temp files that are both created and managed by the Oracle Database server</p>
</li>
<li>
<p><a class="olink CNCPT403" target="_blank" href="../CNCPT/physical.htm#CNCPT403"><span class="italic">Oracle Database Concepts</span></a></p>
</li>
</ul>
</div>
</div>
<div class="sect2"><a id="GUID-BB7D8910-FCAE-4DAD-BDE5-B5EE35C69C6B"></a>
<h2 id="ADMIN-GUID-BB7D8910-FCAE-4DAD-BDE5-B5EE35C69C6B" class="sect2"><span class="enumeration_section">14.1</span> Guidelines for Managing Data Files</h2>
<p>You can follow guidelines for managing data files.</p>
<a id="ADMIN11414"></a>
<div class="props_rev_3"><a id="GUID-B1805034-94ED-4887-94B4-369FB8AAE416"></a>
<h3 id="ADMIN-GUID-B1805034-94ED-4887-94B4-369FB8AAE416" class="sect3"><span class="enumeration_section">14.1.1</span> About Data Files</h3>
<div>
<p>Data files are physical files of the operating system that store the data of all logical structures in the database. They must be explicitly created for each tablespace.</p>
<p>Oracle Database assigns each data file two associated file numbers, an absolute file number and a relative file number, that are used to uniquely identify it. These numbers are described in the following table:</p>
<div class="tblformal" id="GUID-B1805034-94ED-4887-94B4-369FB8AAE416__GUID-FF72C648-AE70-4A61-ADE1-758FC5AFCEC5">
<table class="cellalignment1849" summary="Column 1 lists the two different types of file numbers, column 2 contains a description of each type.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1891" id="d115800e226">Type of File Number</th>
<th class="cellalignment1968" id="d115800e229">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1894" id="d115800e234" headers="d115800e226">
<p>Absolute</p>
</td>
<td class="cellalignment1969" headers="d115800e234 d115800e229">
<p>Uniquely identifies a data file <span class="italic">in the database</span>. This file number can be used in many SQL statements that reference data files in place of using the file name. The absolute file number can be found in the <code class="codeph">FILE#</code> column of the <code class="codeph">V$DATAFILE</code> or <code class="codeph">V$TEMPFILE</code> view, or in the <code class="codeph">FILE_ID</code> column of the <code class="codeph">DBA_DATA_FILES</code> or <code class="codeph">DBA_TEMP_FILES</code> view.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1894" id="d115800e263" headers="d115800e226">
<p>Relative</p>
</td>
<td class="cellalignment1969" headers="d115800e263 d115800e229">
<p>Uniquely identifies a data file <span class="italic">within a tablespace</span>. For small and medium size databases, relative file numbers usually have the same value as the absolute file number. However, when the number of data files in a database exceeds a threshold (typically 1023), the relative file number differs from the absolute file number. In a bigfile tablespace, the relative file number is always 1024 (4096 on OS/390 platform).</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<div class="sect3"><a id="GUID-0047F4DF-FCAB-4409-ADB8-2B29A7AC06CA"></a>
<h3 id="ADMIN-GUID-0047F4DF-FCAB-4409-ADB8-2B29A7AC06CA" class="sect3"><span class="enumeration_section">14.1.2</span> Determine the Number of Data Files</h3>
<p>You must determine the number of data files for your database.</p>
<a id="ADMIN11415"></a>
<div class="props_rev_3"><a id="GUID-27232DAB-0B9E-47C1-8F5F-FEACB4714387"></a>
<h4 id="ADMIN-GUID-27232DAB-0B9E-47C1-8F5F-FEACB4714387" class="sect4"><span class="enumeration_section">14.1.2.1</span> About Determining the Number of Data Files</h4>
<div>
<p>At least one data file is required for the <code class="codeph">SYSTEM</code> and <code class="codeph">SYSAUX</code> tablespaces of a database. Your database should contain several other tablespaces with their associated data files or temp files. The number of data files that you anticipate creating for your database can affect the settings of initialization parameters and the specification of <code class="codeph">CREATE</code> <code class="codeph">DATABASE</code> statement clauses.</p>
<p>Be aware that your operating system might impose limits on the number of data files contained in your Oracle Database. Also consider that the number of data files, and how and where they are allocated can affect the performance of your database.</p>
<div class="infobox-note" id="GUID-27232DAB-0B9E-47C1-8F5F-FEACB4714387__GUID-DD908C94-15DA-46C3-ADE4-C91CAAF78EB8">
<p class="notep1">Note:</p>
<p>One means of controlling the number of data files in your database and simplifying their management is to use bigfile tablespaces. Bigfile tablespaces comprise a single, very large data file and are especially useful in ultra large databases and where a logical volume manager is used for managing operating system files. Bigfile tablespaces are discussed in <span class="q">&#34;<a href="tspaces.htm#GUID-7E376766-D99D-4274-BF00-8DC1E6FC5063" title="A bigfile tablespace is a tablespace with a single, but potentially very large (up to 4G blocks) data file. Traditional smallfile tablespaces, in contrast, can contain multiple data files, but the files cannot be as large.">Bigfile Tablespaces</a>&#34;</span>.</p>
</div>
<p>Consider the following guidelines when determining the number of data files for your database.</p>
</div>
</div>
<a id="ADMIN11416"></a>
<div class="props_rev_3"><a id="GUID-CAC446B4-7E44-419B-9A4C-306677CD95E0"></a>
<h4 id="ADMIN-GUID-CAC446B4-7E44-419B-9A4C-306677CD95E0" class="sect4"><span class="enumeration_section">14.1.2.2</span> Determine a Value for the DB_FILES Initialization Parameter</h4>
<div>
<p>When starting an Oracle Database instance, the <code class="codeph">DB_FILES</code> initialization parameter indicates the amount of SGA space to reserve for data file information and thus, the maximum number of data files that can be created for the instance.</p>
<p>This limit applies for the life of the instance. You can change the value of <code class="codeph">DB_FILES</code> (by changing the initialization parameter setting), but the new value does not take effect until you shut down and restart the instance.</p>
<p>When determining a value for <code class="codeph">DB_FILES</code>, take the following into consideration:</p>
<ul style="list-style-type: disc;">
<li>
<p>If the value of <code class="codeph">DB_FILES</code> is too low, you cannot add data files beyond the <code class="codeph">DB_FILES</code> limit without first shutting down the database.</p>
</li>
<li>
<p>If the value of <code class="codeph">DB_FILES</code> is too high, memory is unnecessarily consumed.</p>
</li>
</ul>
</div>
</div>
<a id="ADMIN11417"></a>
<div class="props_rev_3"><a id="GUID-2C546AA6-6CDF-404B-8820-1541BC1EB6BD"></a>
<h4 id="ADMIN-GUID-2C546AA6-6CDF-404B-8820-1541BC1EB6BD" class="sect4"><span class="enumeration_section">14.1.2.3</span> Consider Possible Limitations When Adding Data Files to a Tablespace</h4>
<div>
<p>There are some limitations to consider when adding data files to a tablespace.</p>
<p>You can add data files to traditional smallfile tablespaces, subject to the following limitations:</p>
<ul style="list-style-type: disc;">
<li>
<p>Operating systems often impose a limit on the number of files a process can open simultaneously. More data files cannot be created when the operating system limit of open files is reached.</p>
</li>
<li>
<p>Operating systems impose limits on the number and size of data files.</p>
</li>
<li>
<p>The database imposes a maximum limit on the number of data files for any Oracle Database opened by any instance. This limit is operating system specific.</p>
</li>
<li>
<p>You cannot exceed the number of data files specified by the <code class="codeph">DB_FILES</code> initialization parameter.</p>
</li>
<li>
<p>When you issue <code class="codeph">CREATE DATABASE</code> or <code class="codeph">CREATE CONTROLFILE</code> statements, the <code class="codeph">MAXDATAFILES</code> parameter specifies an initial size of the data file portion of the control file. However, if you attempt to add a new file whose number is greater than <code class="codeph">MAXDATAFILES</code>, but less than or equal to <code class="codeph">DB_FILES</code>, the control file will expand automatically so that the data files section can accommodate more files.</p>
</li>
</ul>
</div>
</div>
<a id="ADMIN11418"></a>
<div class="props_rev_3"><a id="GUID-39EC0366-A838-4CD7-841F-7692EE47746C"></a>
<h4 id="ADMIN-GUID-39EC0366-A838-4CD7-841F-7692EE47746C" class="sect4"><span class="enumeration_section">14.1.2.4</span> Consider the Performance Impact of the Number of Data Files</h4>
<div>
<p>The number of data files contained in a tablespace, and ultimately the database, can have an impact upon performance.</p>
<p>Oracle Database allows more data files in the database than the operating system defined limit. The database DBW<span class="italic">n</span> processes can open all online data files. Oracle Database is capable of treating open file descriptors as a cache, automatically closing files when the number of open file descriptors reaches the operating system-defined limit. This can have a negative performance impact. When possible, adjust the operating system limit on open file descriptors so that it is larger than the number of online data files in the database.</p>
<div class="infoboxnotealso" id="GUID-39EC0366-A838-4CD7-841F-7692EE47746C__GUID-34F0E578-2D53-4A74-843B-E8BB50BFA0B9">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p>Your operating system specific Oracle documentation for more information on operating system limits</p>
</li>
<li>
<p><a class="olink SQLRF012" target="_blank" href="../SQLRF/statements_5.htm#SQLRF012"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about the <code class="codeph">MAXDATAFILES</code> parameter of the <code class="codeph">CREATE DATABASE</code> or <code class="codeph">CREATE CONTROLFILE</code> statement</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<a id="ADMIN11419"></a>
<div class="props_rev_3"><a id="GUID-663CC3C9-8466-4314-9178-8478EEED67C9"></a>
<h3 id="ADMIN-GUID-663CC3C9-8466-4314-9178-8478EEED67C9" class="sect3"><span class="enumeration_section">14.1.3</span> Determine the Size of Data Files</h3>
<div>
<p>When creating a tablespace, you should estimate the potential size of database objects and create sufficient data files.</p>
<p>Later, if needed, you can create additional data files and add them to a tablespace to increase the total amount of disk space allocated to it, and consequently the database. Preferably, place data files on multiple devices to ensure that data is spread evenly across all devices.</p>
</div>
</div>
<a id="ADMIN11420"></a>
<div class="props_rev_3"><a id="GUID-FA39D253-1FCE-466D-B686-24357AA3DAC9"></a>
<h3 id="ADMIN-GUID-FA39D253-1FCE-466D-B686-24357AA3DAC9" class="sect3"><span class="enumeration_section">14.1.4</span> Place Data Files Appropriately</h3>
<div>
<p>Tablespace location is determined by the physical location of the data files that constitute that tablespace. Use the hardware resources of your computer appropriately.</p>
<p>For example, if several disk drives are available to store the database, consider placing potentially contending data files on separate disks. This way, when users query information, both disk drives can work simultaneously, retrieving data at the same time.</p>
<div class="infoboxnotealso" id="GUID-FA39D253-1FCE-466D-B686-24357AA3DAC9__GUID-80EF0474-32D4-4B9C-8CE6-93AF4C98E0D1">
<p class="notep1">See Also:</p>
<p><a class="olink TGDBA015" target="_blank" href="../TGDBA/pfgrf_iodesign.htm#TGDBA015"><span class="italic">Oracle Database Performance Tuning Guide</span></a> for information about I/O and the placement of data files</p>
</div>
</div>
</div>
<a id="ADMIN11421"></a>
<div class="props_rev_3"><a id="GUID-1535933A-8602-46BA-8A32-C1DF495E1E56"></a>
<h3 id="ADMIN-GUID-1535933A-8602-46BA-8A32-C1DF495E1E56" class="sect3"><span class="enumeration_section">14.1.5</span> Store Data Files Separate from Redo Log Files</h3>
<div>
<p>Data files should not be stored on the same disk drive that stores the database redo log files. If the data files and redo log files are stored on the same disk drive and that disk drive fails, the files cannot be used in your database recovery procedures.</p>
<p>If you multiplex your redo log files, then the likelihood of losing all of your redo log files is low, so you can store data files on the same drive as some redo log files.</p>
</div>
</div>
</div>
<a id="ADMIN11422"></a>
<div class="props_rev_3"><a id="GUID-814D8847-5327-41A3-8959-444C40093B46"></a>
<h2 id="ADMIN-GUID-814D8847-5327-41A3-8959-444C40093B46" class="sect2"><span class="enumeration_section">14.2</span> Creating Data Files and Adding Data Files to a Tablespace</h2>
<div>
<p>You can create data files and associate them with a tablespace using several different SQL statements.</p>
<div class="section">
<p>In all cases, you can either specify the file specifications for the data files being created, or you can use the Oracle Managed Files feature to create files that are created and managed by the database server. The table includes a brief description of the statement, as used to create data files, and references the section of this book where use of the statement is specifically described:</p>
</div>
<!-- class="section" -->
<div class="tblformalwide" id="GUID-814D8847-5327-41A3-8959-444C40093B46__GUID-FB84878F-3D92-4878-9D71-2104FB6ECF76">
<table class="cellalignment1880" summary="Column 1 lists the various SQL statements that can be used to create or add datafiles to a tablespace. Column 2 describes the use of the statement and column 3 points to additional information.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1893" id="d115800e1035">SQL Statement</th>
<th class="cellalignment1858" id="d115800e1038">Description</th>
<th class="cellalignment1891" id="d115800e1041">Additional Information</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1896" id="d115800e1046" headers="d115800e1035">
<p><code class="codeph">CREATE TABLESPACE</code></p>
</td>
<td class="cellalignment1861" headers="d115800e1046 d115800e1038">
<p>Creates a tablespace and the data files that comprise it</p>
</td>
<td class="cellalignment1894" headers="d115800e1046 d115800e1041">
<p><span class="q">&#34;<a href="tspaces.htm#GUID-B8369BAD-892E-440B-95F0-0E9F3622CA3F" title="To create a new tablespace, use the SQL statement CREATE TABLESPACE or CREATE TEMPORARY TABLESPACE. You must have the CREATE TABLESPACE system privilege to create a tablespace.">Creating Tablespaces</a>&#34;</span></p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1896" id="d115800e1072" headers="d115800e1035">
<p><code class="codeph">CREATE TEMPORARY TABLESPACE</code></p>
</td>
<td class="cellalignment1861" headers="d115800e1072 d115800e1038">
<p>Creates a locally-managed temporary tablespace and the <span class="italic">tempfiles</span> (temp files are a special kind of data file) that comprise it</p>
</td>
<td class="cellalignment1894" headers="d115800e1072 d115800e1041">
<p><span class="q">&#34;<a href="tspaces.htm#GUID-03CCF8D4-9DAA-451A-B9F8-836F8262B43D" title="Because space management is much simpler and more efficient in locally managed tablespaces, they are ideally suited for temporary tablespaces.">Creating a Locally Managed Temporary Tablespace</a>&#34;</span></p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1896" id="d115800e1093" headers="d115800e1035">
<p><code class="codeph">ALTER TABLESPACE ... ADD DATAFILE</code></p>
</td>
<td class="cellalignment1861" headers="d115800e1093 d115800e1038">
<p>Creates and adds a data file to a tablespace</p>
</td>
<td class="cellalignment1894" headers="d115800e1093 d115800e1041">
<p><span class="q">&#34;<a href="tspaces.htm#GUID-FB734C25-BA3A-45E8-BDCE-77C668140B67" title="You can add a data file to a locally managed tablespace, alter its availability, make it read-only or read/write, rename it, or enable/disable autoextension.">Altering a Locally Managed Tablespace</a>&#34;</span></p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1896" id="d115800e1111" headers="d115800e1035">
<p><code class="codeph">ALTER TABLESPACE ... ADD TEMPFILE</code></p>
</td>
<td class="cellalignment1861" headers="d115800e1111 d115800e1038">
<p>Creates and adds a temp file to a temporary tablespace</p>
</td>
<td class="cellalignment1894" headers="d115800e1111 d115800e1041">
<p><span class="q">&#34;<a href="tspaces.htm#GUID-18750D59-2CE2-4D7B-9E5A-C52F89814D90" title="You can alter a locally managed temporary tablespace to add a temp file, take a temp file offline, or bring a temp file online.">Altering a Locally Managed Temporary Tablespace</a>&#34;</span></p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1896" id="d115800e1129" headers="d115800e1035">
<p><code class="codeph">CREATE DATABASE</code></p>
</td>
<td class="cellalignment1861" headers="d115800e1129 d115800e1038">
<p>Creates a database and associated data files</p>
</td>
<td class="cellalignment1894" headers="d115800e1129 d115800e1041">
<p><span class="q">&#34;<a href="create.htm#GUID-0306126A-D63C-41E0-8D6E-48020FC18697" title="When you use the CREATE DATABASE statement, you must complete additional actions before you have an operational database. These actions include building views on the data dictionary tables and installing standard PL/SQL packages. You perform these actions by running the supplied scripts.">Creating a Database with the CREATE DATABASE Statement</a>&#34;</span></p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1896" id="d115800e1150" headers="d115800e1035">
<p><code class="codeph">ALTER DATABASE ... CREATE DATAFILE</code></p>
</td>
<td class="cellalignment1861" headers="d115800e1150 d115800e1038">
<p>Creates a new empty data file in place of an old one--useful to re-create a data file that was lost with no backup.</p>
</td>
<td class="cellalignment1894" headers="d115800e1150 d115800e1041">
<p>See <a class="olink BRADV224" target="_blank" href="../BRADV/osadvsce.htm#BRADV224"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<p>If you add new data files to a tablespace and do not fully specify the file names, the database creates the data files in the default database directory or the current directory, depending upon your operating system. Oracle recommends you always specify a fully qualified name for a data file. Unless you want to reuse existing files, make sure the new file names do not conflict with other files. Old files that have been previously dropped will be overwritten.</p>
<p>If a statement that creates a data file fails, the database removes any created operating system files. However, because of the large number of potential errors that can occur with file systems and storage subsystems, there can be situations where you must manually remove the files using operating system commands.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11423"></a>
<div class="props_rev_3"><a id="GUID-8E7A9714-85CB-45F3-8384-00D68EAC3E58"></a>
<h2 id="ADMIN-GUID-8E7A9714-85CB-45F3-8384-00D68EAC3E58" class="sect2"><span class="enumeration_section">14.3</span> Changing Data File Size</h2>
<p>You can alter the size of a data file. For example, you can increase the size of one or more data files when more space is needed in the database.</p>
<a id="ADMIN11424"></a>
<div class="props_rev_3"><a id="GUID-C633A6CC-F1A9-415A-B153-5C2053BBB7E6"></a>
<h3 id="ADMIN-GUID-C633A6CC-F1A9-415A-B153-5C2053BBB7E6" class="sect3"><span class="enumeration_section">14.3.1</span> Enabling and Disabling Automatic Extension for a Data File</h3>
<div>
<p>You can create data files or alter existing data files so that they automatically increase in size when more space is needed in the database. The file size increases in specified increments up to a specified maximum.</p>
<div class="section">
<p>Setting your data files to extend automatically provides these advantages:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Reduces the need for immediate intervention when a tablespace runs out of space</p>
</li>
<li>
<p>Ensures applications will not halt or be suspended because of failures to allocate extents</p>
</li>
</ul>
<p>You can specify automatic file extension by specifying an <code class="codeph">AUTOEXTEND ON</code> clause when you create data files using the following SQL statements:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">CREATE</code> <code class="codeph">DATABASE</code></p>
</li>
<li>
<p><code class="codeph">ALTER</code> <code class="codeph">DATABASE</code></p>
</li>
<li>
<p><code class="codeph">CREATE</code> <code class="codeph">TABLESPACE</code></p>
</li>
<li>
<p><code class="codeph">ALTER</code> <code class="codeph">TABLESPACE</code></p>
</li>
</ul>
<p>To enable or disable automatic extension for a data file:</p>
<ol>
<li>
<p>Determine whether a data file is auto-extensible by querying the <code class="codeph">DBA_DATA_FILES</code> view and examining the <code class="codeph">AUTOEXTENSIBLE</code> column.</p>
</li>
<li>
<p>Enable or disable automatic file extension for existing data files, or manually resize a data file, using the <code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> statement with the <code class="codeph">AUTOEXTEND</code> clause. For a bigfile tablespace, use the <code class="codeph">ALTER</code> <code class="codeph">TABLESPACE</code> statement with the <code class="codeph">AUTOEXTEND</code> clause.</p>
</li>
</ol>
<p>The following example enables automatic extension for a data file added to the <code class="codeph">users</code> tablespace:</p>
<pre dir="ltr">ALTER TABLESPACE users
    ADD DATAFILE &#39;/u02/oracle/rbdb1/users03.dbf&#39; SIZE 10M
      AUTOEXTEND ON
      NEXT 512K
      MAXSIZE 250M;
</pre>
<p>The value of <code class="codeph">NEXT</code> is the minimum size of the increments added to the file when it extends. The value of <code class="codeph">MAXSIZE</code> is the maximum size to which the file can automatically extend.</p>
<p>The next example disables the automatic extension for the data file.</p>
<pre dir="ltr">ALTER DATABASE DATAFILE &#39;/u02/oracle/rbdb1/users03.dbf&#39; 
    AUTOEXTEND OFF;
</pre>
<div class="infoboxnotealso" id="GUID-C633A6CC-F1A9-415A-B153-5C2053BBB7E6__GUID-0FB77CFA-52E7-49DD-B6B0-539E0F89E6DB">
<p class="notep1">See Also:</p>
<p><a class="olink SQLRF" target="_blank" href="../SQLRF/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about the SQL statements for creating or altering data files</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11425"></a>
<div class="props_rev_3"><a id="GUID-DF13C755-D423-49F1-9B53-F36B642D2A81"></a>
<h3 id="ADMIN-GUID-DF13C755-D423-49F1-9B53-F36B642D2A81" class="sect3"><span class="enumeration_section">14.3.2</span> Manually Resizing a Data File</h3>
<div>
<p>You can manually increase or decrease the size of a data file using the <code class="codeph">ALTER DATABASE</code> statement.</p>
<div class="section">
<p>Therefore, you can add more space to your database without adding more data files. This is beneficial if you are concerned about reaching the maximum number of data files allowed in your database.</p>
<p>For a bigfile tablespace, you can use the <code class="codeph">ALTER</code> <code class="codeph">TABLESPACE</code> statement to resize a data file. You are not allowed to add a data file to a bigfile tablespace.</p>
<p>Manually reducing the sizes of data files enables you to reclaim unused space in the database. This is useful for correcting errors in estimates of space requirements.</p>
<p>In the following example, assume that the data file <code class="codeph">/u02/oracle/rbdb1/stuff01.dbf</code> has extended up to 250M. However, because its tablespace now stores smaller objects, the data file can be reduced in size.</p>
<p>The following statement decreases the size of data file <code class="codeph">/u02/oracle/rbdb1/stuff01.dbf</code>:</p>
<pre dir="ltr">ALTER DATABASE DATAFILE &#39;/u02/oracle/rbdb1/stuff01.dbf&#39;
   RESIZE 100M;
</pre>
<div class="infobox-note" id="GUID-DF13C755-D423-49F1-9B53-F36B642D2A81__GUID-1A31F866-A1BF-4FE0-A651-47BFAB3B6B1A">
<p class="notep1">Note:</p>
<p>It is not always possible to decrease the size of a file to a specific value. It could be that the file contains data beyond the specified decreased size, in which case the database will return an error.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<div class="sect2"><a id="GUID-4FD1D7DF-913B-4D86-8467-291ECBCEEAEB"></a>
<h2 id="ADMIN-GUID-4FD1D7DF-913B-4D86-8467-291ECBCEEAEB" class="sect2"><span class="enumeration_section">14.4</span> Altering Data File Availability</h2>
<p>You must alter data file availability to perform certain tasks, such as performing an offline backup of a data file or relocating an offline data file.</p>
<a id="ADMIN11426"></a>
<div class="props_rev_3"><a id="GUID-B6AD08B7-675E-48FA-B8DA-0C8496F44B28"></a>
<h3 id="ADMIN-GUID-B6AD08B7-675E-48FA-B8DA-0C8496F44B28" class="sect3"><span class="enumeration_section">14.4.1</span> About Altering Data File Availability</h3>
<div>
<p>You can alter the availability of individual data files or temp files by taking them offline or bringing them online. Offline data files are unavailable to the database and cannot be accessed until they are brought back online.</p>
<p>Reasons for altering data file availability include the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>You want to perform an offline backup of a data file.</p>
</li>
<li>
<p>You want to rename or relocate an offline data file. You can first take the data file offline or take the tablespace offline.</p>
</li>
<li>
<p>The database has problems writing to a data file and automatically takes the data file offline. Later, after resolving the problem, you can bring the data file back online manually.</p>
</li>
<li>
<p>A data file becomes missing or corrupted. You must take it offline before you can open the database.</p>
</li>
</ul>
<p>The data files of a read-only tablespace can be taken offline or brought online, but bringing a file online does not affect the read-only status of the tablespace. You cannot write to the data file until the tablespace is returned to the read/write state.</p>
<div class="infobox-note" id="GUID-B6AD08B7-675E-48FA-B8DA-0C8496F44B28__GUID-677533BB-30D0-4732-8257-82ECA573162A">
<p class="notep1">Note:</p>
<p>You can make all data files of a tablespace temporarily unavailable by taking the tablespace itself offline. You <span class="italic">must</span> leave these files in the tablespace to bring the tablespace back online, although you can relocate or rename them following procedures similar to those shown in <span class="q">&#34;<a href="dfiles.htm#GUID-B0CB3536-EB2D-4319-9563-D698905E67D4" title="You can rename online or offline data files to either change their names or relocate them.">Renaming and Relocating Data Files</a>&#34;</span>.</p>
<p>For more information, see <span class="q">&#34;<a href="tspaces.htm#GUID-6EDD3FE0-D302-43F5-AA61-F96DBCF68E0D" title="Taking a tablespace offline makes it unavailable for normal access.">Taking Tablespaces Offline</a>&#34;</span>.</p>
</div>
<p>To take a data file offline or bring it online, you must have the <code class="codeph">ALTER DATABASE</code> system privilege. To take all data files or temp files offline using the <code class="codeph">ALTER TABLESPACE</code> statement, you must have the <code class="codeph">ALTER TABLESPACE</code> or <code class="codeph">MANAGE TABLESPACE</code> system privilege. In an Oracle Real Application Clusters environment, the database must be open in exclusive mode.</p>
</div>
</div>
<a id="ADMIN11427"></a>
<div class="props_rev_3"><a id="GUID-D82767AC-3AAC-40D2-9E29-9D01AFED9D6A"></a>
<h3 id="ADMIN-GUID-D82767AC-3AAC-40D2-9E29-9D01AFED9D6A" class="sect3"><span class="enumeration_section">14.4.2</span> Bringing Data Files Online or Taking Offline in ARCHIVELOG Mode</h3>
<div>
<p>To bring an individual data file online or take an individual data file offline, issue the <code class="codeph">ALTER DATABASE</code> statement and include the <code class="codeph">DATAFILE</code> clause.</p>
<div class="section">
<p>The following statement brings the specified data file online:</p>
<pre dir="ltr">ALTER DATABASE DATAFILE &#39;/u02/oracle/rbdb1/stuff01.dbf&#39; ONLINE;
</pre>
<p>To take the same file offline, issue the following statement:</p>
<pre dir="ltr">ALTER DATABASE DATAFILE &#39;/u02/oracle/rbdb1/stuff01.dbf&#39; OFFLINE;
</pre>
<div class="infobox-note" id="GUID-D82767AC-3AAC-40D2-9E29-9D01AFED9D6A__GUID-8AA222A5-DE03-47EE-97AF-62B811EF36F0">
<p class="notep1">Note:</p>
<p>To use this form of the <code class="codeph">ALTER DATABASE</code> statement, the database must be in <code class="codeph">ARCHIVELOG</code> mode. This requirement prevents you from accidentally losing the data file, since taking the data file offline while in <code class="codeph">NOARCHIVELOG</code> mode is likely to result in losing the file.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11428"></a>
<div class="props_rev_3"><a id="GUID-983A304D-539F-4182-978C-E2B8AA68C45D"></a>
<h3 id="ADMIN-GUID-983A304D-539F-4182-978C-E2B8AA68C45D" class="sect3"><span class="enumeration_section">14.4.3</span> Taking Data Files Offline in NOARCHIVELOG Mode</h3>
<div>
<p>To take a data file offline when the database is in <code class="codeph">NOARCHIVELOG</code> mode, use the <code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> statement with both the <code class="codeph">DATAFILE</code> and <code class="codeph">OFFLINE</code> <code class="codeph">FOR</code> <code class="codeph">DROP</code> clauses.</p>
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>The <code class="codeph">OFFLINE</code> keyword causes the database to mark the data file <code class="codeph">OFFLINE</code>, whether or not it is corrupted, so that you can open the database.</p>
</li>
<li>
<p>The <code class="codeph">FOR</code> <code class="codeph">DROP</code> keywords mark the data file for subsequent dropping. Such a data file can no longer be brought back online.</p>
<div class="infobox-note" id="GUID-983A304D-539F-4182-978C-E2B8AA68C45D__GUID-234AF0D3-8B9E-4178-BF63-3A4F7AC9EB8D">
<p class="notep1">Note:</p>
<p>This operation does not actually drop the data file. It remains in the data dictionary, and you must drop it yourself using one of the following methods:</p>
<ul style="list-style-type: disc;">
<li>
<p>An <code class="codeph">ALTER</code> <code class="codeph">TABLESPACE</code> ... <code class="codeph">DROP</code> <code class="codeph">DATAFILE</code> statement.</p>
<p>After an <code class="codeph">OFFLINE</code> <code class="codeph">FOR</code> <code class="codeph">DROP</code>, this method works for dictionary managed tablespaces only.</p>
</li>
<li>
<p>A <code class="codeph">DROP</code> <code class="codeph">TABLESPACE</code> ... <code class="codeph">INCLUDING</code> <code class="codeph">CONTENTS</code> <code class="codeph">AND</code> <code class="codeph">DATAFILES</code> statement</p>
</li>
<li>
<p>If the preceding methods fail, an operating system command to delete the data file. This is the least desirable method, as it leaves references to the data file in the data dictionary and control files.</p>
</li>
</ul>
</div>
</li>
</ul>
<p>The following statement takes the specified data file offline and marks it to be dropped:</p>
<pre dir="ltr">ALTER DATABASE DATAFILE &#39;/u02/oracle/rbdb1/users03.dbf&#39; OFFLINE FOR DROP;
</pre></div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11429"></a>
<div class="props_rev_3"><a id="GUID-1D65232E-1F21-4ED7-A6ED-189F556748BC"></a>
<h3 id="ADMIN-GUID-1D65232E-1F21-4ED7-A6ED-189F556748BC" class="sect3"><span class="enumeration_section">14.4.4</span> Altering the Availability of All Data Files or Temp Files in a Tablespace</h3>
<div>
<p>Clauses of the <code class="codeph">ALTER TABLESPACE</code> statement allow you to change the online or offline status of all of the data files or temp files within a tablespace.</p>
<div class="section">
<p>Specifically, the statements that affect online/offline status are:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">ALTER</code> <code class="codeph">TABLESPACE</code> ... <code class="codeph">DATAFILE</code> {<code class="codeph">ONLINE</code>|<code class="codeph">OFFLINE</code>}</p>
</li>
<li>
<p><code class="codeph">ALTER</code> <code class="codeph">TABLESPACE</code> ... <code class="codeph">TEMPFILE</code> {<code class="codeph">ONLINE</code>|<code class="codeph">OFFLINE</code>}</p>
</li>
</ul>
<p>You are required only to enter the tablespace name, not the individual data files or temp files. All of the data files or temp files are affected, but the online/offline status of the tablespace itself is not changed.</p>
<p>In most cases the preceding <code class="codeph">ALTER TABLESPACE</code> statements can be issued whenever the database is mounted, even if it is not open. However, the database <span class="italic">must not</span> be open if the tablespace is the <code class="codeph">SYSTEM</code> tablespace, an undo tablespace, or the default temporary tablespace. The <code class="codeph">ALTER DATABASE DATAFILE</code> and <code class="codeph">ALTER DATABASE TEMPFILE</code> statements also have <code class="codeph">ONLINE/OFFLINE</code> clauses, however in those statements you must enter all of the file names for the tablespace.</p>
<p>The syntax is different from the <code class="codeph">ALTER TABLESPACE...ONLINE|OFFLINE</code> statement that alters tablespace availability, because that is a different operation. The <code class="codeph">ALTER TABLESPACE</code> statement takes data files offline as well as the tablespace, but it cannot be used to alter the status of a temporary tablespace or its temp file(s).</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="ADMIN11430"></a>
<div class="props_rev_3"><a id="GUID-B0CB3536-EB2D-4319-9563-D698905E67D4"></a>
<h2 id="ADMIN-GUID-B0CB3536-EB2D-4319-9563-D698905E67D4" class="sect2"><span class="enumeration_section">14.5</span> Renaming and Relocating Data Files</h2>
<div>
<p>You can rename online or offline data files to either change their names or relocate them.</p>
</div>
<a id="ADMIN13838"></a><a id="ADMIN13839"></a><a id="ADMIN13840"></a><a id="ADMIN13841"></a><a id="ADMIN13842"></a><a id="ADMIN13843"></a><a id="ADMIN13947"></a><a id="ADMIN13837"></a>
<div class="props_rev_3"><a id="GUID-E4CA8427-D8AE-45AC-A209-554D555758DE"></a>
<h3 id="ADMIN-GUID-E4CA8427-D8AE-45AC-A209-554D555758DE" class="sect3"><span class="enumeration_section">14.5.1</span> Renaming and Relocating Online Data Files</h3>
<div>
<p>You can use the <code class="codeph">ALTER DATABASE MOVE DATAFILE</code> SQL statement to rename or relocate online data files. This statement enables you to rename or relocate a data file while the database is open and users are accessing the data file.</p>
<div class="section">
<p>When you rename or relocate online data files, the pointers to the data files, as recorded in the database control file, are changed. The files are also physically renamed or relocated at the operating system level.</p>
<p>You might rename or relocate online data files because you want to allow users to access the data files when you perform one of the following tasks:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Move the data files from one type of storage to another</p>
</li>
<li>
<p>Move data files that are accessed infrequently to lower cost storage</p>
</li>
<li>
<p>Make a tablespace read-only and move its data files to write-once storage</p>
</li>
<li>
<p>Move a database into Oracle Automatic Storage Management (Oracle ASM)</p>
</li>
</ul>
<p>When you run the <code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> <code class="codeph">MOVE</code> <code class="codeph">DATAFILE</code> statement and a file with the same name exists in the destination location, you can specify the <code class="codeph">REUSE</code> option to overwrite the existing file. When <code class="codeph">REUSE</code> is not specified, and a file with the same name exists in the destination location, the existing file is not overwritten, and the statement returns an error.</p>
<p>By default, when you run the <code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> <code class="codeph">MOVE</code> <code class="codeph">DATAFILE</code> statement and specify a new location for a data file, the statement moves the data file. However, you can specify the <code class="codeph">KEEP</code> option to retain the data file in the old location and copy it to the new location. In this case, the database only uses the data file in the new location when the statement completes successfully.</p>
<p>When you rename or relocate a data file with <code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> <code class="codeph">MOVE</code> <code class="codeph">DATAFILE</code> statement, Oracle Database creates a copy of the data file when it is performing the operation. Ensure that there is adequate disk space for the original data file and the copy during the operation.</p>
<p>You can view the name, location, and online status of each data file by querying the <code class="codeph">DBA_DATA_FILES</code> view.</p>
<div class="video-box">
<div xmlns="" id="6406" class="video-container"></div>
</div>
<div class="infobox-note" id="GUID-E4CA8427-D8AE-45AC-A209-554D555758DE__GUID-727112C1-C0C1-4A2E-A3B6-50CDF4DC4AC5">
<p class="notep1">Note:</p>
<ul style="list-style-type: disc;">
<li>
<p>The <code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> <code class="codeph">MOVE</code> <code class="codeph">DATAFILE</code> statement raises an error if the specified data file is offline.</p>
</li>
<li>
<p>If you are using a standby database, then you can perform an online move data file operation independently on the primary and on the standby (either physical or logical). The standby is not affected when a data file is moved on the primary, and vice versa. See <a class="olink SBYDB5158" target="_blank" href="../SBYDB/standby.htm#SBYDB5158"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> for more information.</p>
</li>
<li>
<p>A flashback operation does not relocate a moved data file to its previous location. If you move a data file online from one location to another and later flash back the database to a point in time before the move, then the data file remains in the new location, but the contents of the data file are changed to the contents at the time specified in the flashback. See <a class="olink BRADV71000" target="_blank" href="../BRADV/flashdb.htm#BRADV71000"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> for more information about flashback database operations.</p>
</li>
<li>
<p>When you relocate a data file on the Windows platform, the original data file might be retained in the old location, even when the <code class="codeph">KEEP</code> option is omitted. In this case, the database only uses the data file in the new location when the statement completes successfully. You can delete the old data file manually after the operation completes if necessary.</p>
</li>
</ul>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To rename or relocate online data files:</p>
<ol>
<li>
<p>In SQL*Plus, connect to the database as a user with <code class="codeph">ALTER DATABASE</code> system privilege.</p>
<p>See <span class="q">&#34;<a href="start.htm#GUID-01B654E4-6FDD-4655-A5B1-3906B5CDF1AA" title="You can start a SQL*Plus session, connect to Oracle Database with administrator privileges, and then issue the STARTUP command. Using SQL*Plus in this way is the only method described in detail in this book.">Starting Up a Database Using SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Issue the <code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> <code class="codeph">MOVE</code> <code class="codeph">DATAFILE</code> statement and specify the data file.</p>
</li>
</ol>
</div>
<!-- class="section" -->
<div class="example" id="GUID-E4CA8427-D8AE-45AC-A209-554D555758DE__BABEHJAG">
<p class="titleinexample">Example 14-1 Renaming an Online Data File</p>
<p>This example renames the data file <code class="codeph">user1.dbf</code> to <code class="codeph">user01.dbf</code> while keeping the data file in the same location.</p>
<pre dir="ltr">ALTER DATABASE MOVE DATAFILE &#39;/u01/oracle/rbdb1/user1.dbf&#39; 
  TO &#39;/u01/oracle/rbdb1/user01.dbf&#39;;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-E4CA8427-D8AE-45AC-A209-554D555758DE__BABJGDCD">
<p class="titleinexample">Example 14-2 Relocating an Online Data File</p>
<p>This example moves the data file <code class="codeph">user1.dbf</code> from the /u01/oracle/rbdb1/ directory to the /u02/oracle/rbdb1/ directory. After the operation, the file is no longer in the /u01/oracle/rbdb1/ directory.</p>
<pre dir="ltr">ALTER DATABASE MOVE DATAFILE &#39;/u01/oracle/rbdb1/user1.dbf&#39; 
  TO &#39;/u02/oracle/rbdb1/user1.dbf&#39;;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-E4CA8427-D8AE-45AC-A209-554D555758DE__BABFIIDI">
<p class="titleinexample">Example 14-3 Copying an Online Data File</p>
<p>This example copies the data file <code class="codeph">user1.dbf</code> from the /u01/oracle/rbdb1/ directory to the /u02/oracle/rbdb1/ directory. After the operation, the old file is retained in the /u01/oracle/rbdb1/ directory.</p>
<pre dir="ltr">ALTER DATABASE MOVE DATAFILE &#39;/u01/oracle/rbdb1/user1.dbf&#39; 
  TO &#39;/u02/oracle/rbdb1/user1.dbf&#39; KEEP;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-E4CA8427-D8AE-45AC-A209-554D555758DE__BABECHGB">
<p class="titleinexample">Example 14-4 Relocating an Online Data File and Overwriting an Existing File</p>
<p>This example moves the data file <code class="codeph">user1.dbf</code> from the /u01/oracle/rbdb1/ directory to the /u02/oracle/rbdb1/ directory. If a file with the same name exists in the /u02/oracle/rbdb1/ directory, then the statement overwrites the file.</p>
<pre dir="ltr">ALTER DATABASE MOVE DATAFILE &#39;/u01/oracle/rbdb1/user1.dbf&#39; 
  TO &#39;/u02/oracle/rbdb1/user1.dbf&#39; REUSE;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-E4CA8427-D8AE-45AC-A209-554D555758DE__BABGBIDH">
<p class="titleinexample">Example 14-5 Relocating an Online Data File to Oracle ASM</p>
<p>This example moves the data file <code class="codeph">user1.dbf</code> from the /u01/oracle/rbdb1/ directory to an Oracle ASM location.</p>
<pre dir="ltr">ALTER DATABASE MOVE DATAFILE &#39;/u01/oracle/rbdb1/user1.dbf&#39; 
  TO &#39;+dgroup_01/data/orcl/datafile/user1.dbf&#39;;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-E4CA8427-D8AE-45AC-A209-554D555758DE__GUID-A29F4173-4E83-49A0-89B4-3BE0E2A2BB0F">
<p class="titleinexample">Example 14-6 Moving a File from One ASM Location to Another ASM Location</p>
<p>This example moves the data file from one Oracle ASM location to another Oracle ASM location.</p>
<pre dir="ltr">ALTER DATABASE MOVE DATAFILE &#39;+dgroup_01/data/orcl/datafile/user1.dbf&#39; 
  TO &#39;+dgroup_02/data/orcl/datafile/user1.dbf&#39;;
</pre>
<p>You also can move an online data file with Oracle ASM by mirroring the data file and then removing the original file location from the mirror. The online data file move operation might be faster when you use Oracle ASM to move the file instead of the <code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> <code class="codeph">MOVE</code> <code class="codeph">DATAFILE</code> statement.</p>
<div class="infoboxnotealso" id="GUID-E4CA8427-D8AE-45AC-A209-554D555758DE__GUID-8B0EECF6-5B2D-47CC-8FF4-FAA96B846361">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink SQLRF00802" target="_blank" href="../SQLRF/statements_1006.htm#SQLRF00802"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about the <code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> statement</p>
</li>
<li>
<p><a class="olink OSTMG" target="_blank" href="../OSTMG/toc.htm"><span class="italic">Oracle Automatic Storage Management Administrator&#39;s Guide</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="example" --></div>
</div>
<a id="ADMIN13844"></a>
<div class="props_rev_3"><a id="GUID-27526948-4F55-4052-AB34-B4FD5F82C414"></a>
<h3 id="ADMIN-GUID-27526948-4F55-4052-AB34-B4FD5F82C414" class="sect3"><span class="enumeration_section">14.5.2</span> Renaming and Relocating Offline Data Files</h3>
<div>
<p>You can rename and relocate offline data files.</p>
<p>When you rename and relocate offline data files, only the pointers to the data files, as recorded in the database control file, are changed. Files are not physically renamed, and they are not copied at the operating system level.</p>
</div>
<a id="ADMIN11431"></a>
<div class="props_rev_3"><a id="GUID-69BC78D7-3BE1-4CF2-B595-6244E0163EE7"></a>
<h4 id="ADMIN-GUID-69BC78D7-3BE1-4CF2-B595-6244E0163EE7" class="sect4"><span class="enumeration_section">14.5.2.1</span> Procedures for Renaming and Relocating Offline Data Files in a Single Tablespace</h4>
<div>
<p>You can rename and relocate offline data files that can be used for a single tablespace. You must have <code class="codeph">ALTER TABLESPACE</code> system privilege to perform these procedures.</p>
<div class="infoboxnotealso" id="GUID-69BC78D7-3BE1-4CF2-B595-6244E0163EE7__GUID-6AA1815E-77D7-4E77-A827-71EA3D55FD2B">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="tspaces.htm#GUID-6EDD3FE0-D302-43F5-AA61-F96DBCF68E0D" title="Taking a tablespace offline makes it unavailable for normal access.">Taking Tablespaces Offline</a>&#34;</span> for more information about taking tablespaces offline in preparation for renaming or relocating data files</p>
</div>
</div>
<a id="ADMIN11432"></a>
<div class="props_rev_3"><a id="GUID-3675062B-5018-4D83-A5E9-996CA4A6A5BB"></a>
<h5 id="ADMIN-GUID-3675062B-5018-4D83-A5E9-996CA4A6A5BB" class="sect5"><span class="enumeration_section">14.5.2.1.1</span> Renaming Offline Data Files in a Single Tablespace</h5>
<div>
<p>You can rename offline data files in a single tablespace.</p>
<div class="section">
<p>To rename offline data files in a single tablespace, complete the following steps:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Take the tablespace that contains the data files offline. The database must be open.</span>
<div>
<p>For example:</p>
<pre dir="ltr">ALTER TABLESPACE users OFFLINE NORMAL;
</pre></div>
</li>
<li class="stepexpand"><span>Rename the data files using the operating system.</span></li>
<li class="stepexpand"><span>Use the <code class="codeph">ALTER TABLESPACE</code> statement with the <code class="codeph">RENAME DATAFILE</code> clause to change the file names within the database.</span>
<div>
<p>For example, the following statement renames the data files <code class="codeph">/u02/oracle/rbdb1/user1.dbf</code> and <code class="codeph">/u02/oracle/rbdb1/user2.dbf</code> to<code class="codeph">/u02/oracle/rbdb1/users01.dbf</code> and <code class="codeph">/u02/oracle/rbdb1/users02.dbf</code>, respectively:</p>
<pre dir="ltr">ALTER TABLESPACE users
    RENAME DATAFILE &#39;/u02/oracle/rbdb1/user1.dbf&#39;,
                    &#39;/u02/oracle/rbdb1/user2.dbf&#39;
                 TO &#39;/u02/oracle/rbdb1/users01.dbf&#39;, 
                    &#39;/u02/oracle/rbdb1/users02.dbf&#39;;
</pre>
<p>Always provide complete file names (including their paths) to properly identify the old and new data files. In particular, specify the old data file name exactly as it appears in the <code class="codeph">DBA_DATA_FILES</code> view of the data dictionary.</p>
</div>
</li>
<li class="stepexpand"><span>Back up the database. After making any structural changes to a database, always perform an immediate and complete backup.</span></li>
<li class="stepexpand"><span>Bring the tablespace back online using an <code class="codeph">ALTER</code> <code class="codeph">TABLESPACE</code> statement with the <code class="codeph">ONLINE</code> clause:</span>
<div>
<pre dir="ltr">ALTER TABLESPACE users ONLINE
</pre></div>
</li>
</ol>
</div>
</div>
<a id="ADMIN11433"></a>
<div class="props_rev_3"><a id="GUID-5DD821C6-F4C6-4F32-A5AA-5574BC91AC6D"></a>
<h5 id="ADMIN-GUID-5DD821C6-F4C6-4F32-A5AA-5574BC91AC6D" class="sect5"><span class="enumeration_section">14.5.2.1.2</span> Relocating Offline Data Files in a Single Tablespace</h5>
<div>
<p>You can relocate offline data files in a single tablespace.</p>
<div class="section">
<p>Here is a sample procedure for relocating an offline data file.</p>
<p>Assume the following conditions:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>An open database has a tablespace named <code class="codeph">users</code> that is made up of data files all located on the same disk.</p>
</li>
<li>
<p>The data files of the <code class="codeph">users</code> tablespace are to be relocated to different and separate disk drives.</p>
</li>
<li>
<p>You are currently connected with administrator privileges to the open database.</p>
</li>
<li>
<p>You have a current backup of the database.</p>
</li>
</ul>
<p>Complete the following steps:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>If you do not know the specific file names or sizes, you can obtain this information by issuing the following query of the data dictionary view <code class="codeph">DBA_DATA_FILES</code>:<a id="d115800e2869" class="indexterm-anchor"></a></span>
<div>
<pre dir="ltr">SQL&gt; SELECT FILE_NAME, BYTES FROM DBA_DATA_FILES
  2&gt; WHERE TABLESPACE_NAME = &#39;USERS&#39;;

FILE_NAME                                  BYTES
------------------------------------------ ----------------
/u02/oracle/rbdb1/users01.dbf              102400000
/u02/oracle/rbdb1/users02.dbf              102400000
</pre></div>
</li>
<li class="stepexpand"><span>Take the tablespace containing the data files offline:</span>
<div>
<pre dir="ltr">ALTER TABLESPACE users OFFLINE NORMAL;
</pre></div>
</li>
<li class="stepexpand"><span>Copy the data files to their new locations and rename them using the operating system. You can copy the files using the <code class="codeph">DBMS_FILE_TRANSFER</code> package discussed in <span class="q">&#34;<a href="dfiles.htm#GUID-411B0545-DD04-4223-80F0-3CE2A550D7B6" title="You do not necessarily have to use the operating system to copy a file within a database, or transfer a file between databases as you would do when using the transportable tablespace feature.">Copying Files Using the Database Server</a>&#34;</span>.</span>
<div>
<div class="infobox-note" id="GUID-5DD821C6-F4C6-4F32-A5AA-5574BC91AC6D__GUID-037C46CC-E862-473C-8783-1DB7DB5E1093">
<p class="notep1">Note:</p>
<p>You can temporarily exit SQL*Plus to execute an operating system command to copy a file by using the SQL*Plus <code class="codeph">HOST</code> command.</p>
</div>
</div>
</li>
<li class="stepexpand"><span>Rename the data files within the database.</span>
<div>
<p>The data file pointers for the files that comprise the <code class="codeph">users</code> tablespace, recorded in the control file of the associated database, must now be changed from the old names to the new names.</p>
<p>Use the <code class="codeph">ALTER TABLESPACE...RENAME DATAFILE</code> statement.</p>
<pre dir="ltr">ALTER TABLESPACE users
    RENAME DATAFILE &#39;/u02/oracle/rbdb1/users01.dbf&#39;,
                    &#39;/u02/oracle/rbdb1/users02.dbf&#39;
                 TO &#39;/u03/oracle/rbdb1/users01.dbf&#39;, 
                    &#39;/u04/oracle/rbdb1/users02.dbf&#39;;
</pre></div>
</li>
<li class="stepexpand"><span>Back up the database. After making any structural changes to a database, always perform an immediate and complete backup.</span></li>
<li class="stepexpand"><span>Bring the tablespace back online using an <code class="codeph">ALTER</code> <code class="codeph">TABLESPACE</code> statement with the <code class="codeph">ONLINE</code> clause:</span>
<div>
<pre dir="ltr">ALTER TABLESPACE users ONLINE
</pre></div>
</li>
</ol>
</div>
</div>
</div>
<a id="ADMIN11434"></a>
<div class="props_rev_3"><a id="GUID-FAF9CA12-1538-42FE-809B-8C865C210491"></a>
<h4 id="ADMIN-GUID-FAF9CA12-1538-42FE-809B-8C865C210491" class="sect4"><span class="enumeration_section">14.5.2.2</span> Renaming and Relocating Offline Data Files in Multiple Tablespaces</h4>
<div>
<p>You can rename and relocate data files in one or more tablespaces using the <code class="codeph">ALTER DATABASE RENAME FILE</code> statement.</p>
<div class="section">
<p>This method is the only choice if you want to rename or relocate data files of several tablespaces in one operation. You must have the <code class="codeph">ALTER DATABASE</code> system privilege.</p>
<div class="infobox-note" id="GUID-FAF9CA12-1538-42FE-809B-8C865C210491__GUID-7E1381AD-AC16-4F8D-80BB-0768B4295259">
<p class="notep1">Note:</p>
<p>To rename or relocate data files of the <code class="codeph">SYSTEM</code> tablespace, the default temporary tablespace, or the active undo tablespace you must use this <code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> method because you cannot take these tablespaces offline.</p>
</div>
<p>To rename data files in multiple tablespaces, follow these steps.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Ensure that the database is mounted but closed.</span>
<div>
<div class="infobox-note" id="GUID-FAF9CA12-1538-42FE-809B-8C865C210491__GUID-1E8782F0-B212-4AF2-9E2D-19D925F32E49">
<p class="notep1">Note:</p>
<p>Optionally, the database does not have to be closed, but the data files (or temp files) must be offline.</p>
</div>
</div>
</li>
<li class="stepexpand"><span>Copy the data files to be renamed to their new locations and new names, using the operating system. You can copy the files using the <code class="codeph">DBMS_FILE_TRANSFER</code> package discussed in <span class="q">&#34;<a href="dfiles.htm#GUID-411B0545-DD04-4223-80F0-3CE2A550D7B6" title="You do not necessarily have to use the operating system to copy a file within a database, or transfer a file between databases as you would do when using the transportable tablespace feature.">Copying Files Using the Database Server</a>&#34;</span>.</span></li>
<li class="stepexpand"><span>Use <code class="codeph">ALTER DATABASE</code> to rename the file pointers in the database control file.</span>
<div>
<p>For example, the following statement renames the data files<code class="codeph">/u02/oracle/rbdb1/sort01.dbf</code> and <code class="codeph">/u02/oracle/rbdb1/user3.dbf</code> to <code class="codeph">/u02/oracle/rbdb1/temp01.dbf</code> and <code class="codeph">/u02/oracle/rbdb1/users03.dbf</code>, respectively:</p>
<pre dir="ltr">ALTER DATABASE
    RENAME FILE &#39;/u02/oracle/rbdb1/sort01.dbf&#39;,
                &#39;/u02/oracle/rbdb1/user3.dbf&#39;
             TO &#39;/u02/oracle/rbdb1/temp01.dbf&#39;,
                &#39;/u02/oracle/rbdb1/users03.dbf&#39;;
</pre>
<p>Always provide complete file names (including their paths) to properly identify the old and new data files. In particular, specify the old data file names exactly as they appear in the <code class="codeph">DBA_DATA_FILES</code> view.</p>
</div>
</li>
<li class="stepexpand"><span>Back up the database. After making any structural changes to a database, always perform an immediate and complete backup.</span></li>
</ol>
</div>
</div>
</div>
</div>
<a id="ADMIN12608"></a><a id="ADMIN11435"></a>
<div class="props_rev_3"><a id="GUID-35078A43-B11C-4E9B-9404-9D4BF0EB7C77"></a>
<h2 id="ADMIN-GUID-35078A43-B11C-4E9B-9404-9D4BF0EB7C77" class="sect2"><span class="enumeration_section">14.6</span> Dropping Data Files</h2>
<div>
<p>You use the <code class="codeph">DROP</code> <code class="codeph">DATAFILE</code> and <code class="codeph">DROP</code> <code class="codeph">TEMPFILE</code> clauses of the <code class="codeph">ALTER</code> <code class="codeph">TABLESPACE</code> statement to drop a single data file or temp file.</p>
<div class="section">
<p>The data file must be empty. (A data file is considered to be empty when no extents remain allocated from it.) When you drop a data file or temp file, references to the data file or temp file are removed from the data dictionary and control files, and the physical file is deleted from the file system or Oracle Automatic Storage Management (Oracle ASM) disk group.</p>
<p>The following example drops the data file identified by the alias <code class="codeph">example_df3.f</code> in the Oracle ASM disk group <code class="codeph">DGROUP1</code>. The data file belongs to the <code class="codeph">example</code> tablespace.</p>
<pre dir="ltr">ALTER TABLESPACE example DROP DATAFILE &#39;+DGROUP1/example_df3.f&#39;;
</pre>
<p>The next example drops the temp file <code class="codeph">lmtemp02.dbf</code>, which belongs to the <code class="codeph">lmtemp</code> tablespace.</p>
<pre dir="ltr">ALTER TABLESPACE lmtemp DROP TEMPFILE &#39;/u02/oracle/data/lmtemp02.dbf&#39;;
</pre>
<p>This is equivalent to the following statement:</p>
<pre dir="ltr">ALTER DATABASE TEMPFILE &#39;/u02/oracle/data/lmtemp02.dbf&#39; DROP 
     INCLUDING DATAFILES;
</pre>
<div class="infobox-note" id="GUID-35078A43-B11C-4E9B-9404-9D4BF0EB7C77__GUID-F5533A05-4E30-44C1-9A2C-048CFF342D69">
<p class="notep1">Note:</p>
<p>If there are sessions using a temp file, and you attempt to drop the temp file, then an error is returned, and the temp file is not dropped. In this case, the temp file is taken offline, and queries that attempt to use the temp file will fail while the temp file is offline.</p>
</div>
<p>See <a class="olink SQLRF53561" target="_blank" href="../SQLRF/statements_3002.htm#SQLRF53561"><span class="italic">Oracle Database SQL Language Reference</span></a> for <code class="codeph">ALTER</code> <code class="codeph">TABLESPACE</code> syntax details.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Restrictions for Dropping Data Files</p>
</div>
<!-- class="section" -->
<div class="section">
<p>The following are restrictions for dropping data files and temp files:</p>
<ul style="list-style-type: disc;">
<li>
<p>The database must be open.</p>
</li>
<li>
<p>If a data file is not empty, it cannot be dropped.</p>
<p>If you must remove a data file that is not empty and that cannot be made empty by dropping schema objects, you must drop the tablespace that contains the data file.</p>
</li>
<li>
<p>You cannot drop the first or only data file in a tablespace.</p>
<p>Therefore, <code class="codeph">DROP</code> <code class="codeph">DATAFILE</code> cannot be used with a bigfile tablespace.</p>
</li>
<li>
<p>You cannot drop data files in a read-only tablespace that was migrated from dictionary managed to locally managed. Dropping a data file from all other read-only tablespaces is supported.</p>
</li>
<li>
<p>You cannot drop data files in the <code class="codeph">SYSTEM</code> tablespace.</p>
</li>
<li>
<p>If a data file in a locally managed tablespace is offline, it cannot be dropped.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-35078A43-B11C-4E9B-9404-9D4BF0EB7C77__GUID-09ED9AB2-453B-4A4B-A85A-F2D56346A6DF">
<p class="notep1">See Also:</p>
<p><a href="tspaces.htm#GUID-4EB483A2-2E04-4047-8885-F5396876D0EB" title="You can drop a tablespace and its contents (the segments contained in the tablespace) from the database if the tablespace and its contents are no longer required.">Dropping Tablespaces</a></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11436"></a>
<div class="props_rev_3"><a id="GUID-4BDCA667-6FBA-48A1-8320-F79AA0BB106A"></a>
<h2 id="ADMIN-GUID-4BDCA667-6FBA-48A1-8320-F79AA0BB106A" class="sect2"><span class="enumeration_section">14.7</span> Verifying Data Blocks in Data Files</h2>
<div>
<p>To configure the database to use checksums to verify data blocks, set the initialization parameter <code class="codeph">DB_BLOCK_CHECKSUM</code> to <code class="codeph">TYPICAL</code> (the default).</p>
<div class="section">
<p>This setting causes the DBW<span class="italic">n</span> process and the direct loader to calculate a checksum for each block and to store the checksum in the block header when writing the block to disk.</p>
<p>The checksum is verified when the block is read, but only if <code class="codeph">DB_BLOCK_CHECKSUM</code> is <code class="codeph">TRUE</code> and the last write of the block stored a checksum. If corruption is detected, the database returns message <code class="codeph">ORA-01578</code> and writes information about the corruption to the alert log.</p>
<p>The value of the <code class="codeph">DB_BLOCK_CHECKSUM</code> parameter can be changed dynamically using the <code class="codeph">ALTER SYSTEM</code> statement. Regardless of the setting of this parameter, checksums are always used to verify data blocks in the <code class="codeph">SYSTEM</code> tablespace.</p>
<div class="infoboxnotealso" id="GUID-4BDCA667-6FBA-48A1-8320-F79AA0BB106A__GUID-E3140172-0F9A-43D9-B751-E76E8FE7ED3A">
<p class="notep1">See Also:</p>
<p><a class="olink REFRN10030" target="_blank" href="../REFRN/GUID-A0F72B65-BC1C-441B-824E-03ADCE66063A.htm#REFRN10030"><span class="italic">Oracle Database Reference</span></a> for more information about the <code class="codeph">DB_BLOCK_CHECKSUM</code> initialization parameter</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<div class="sect2"><a id="GUID-502FB75F-81D1-4090-A2B1-8AB8320910D8"></a>
<h2 id="ADMIN-GUID-502FB75F-81D1-4090-A2B1-8AB8320910D8" class="sect2"><span class="enumeration_section">14.8</span> Copying Files Using the Database Server</h2>
<p>You can use the <code class="codeph">DBMS_FILE_TRANSFER</code> package to copy a file within a database or transfer a file between databases.</p>
<a id="ADMIN01201"></a>
<div class="props_rev_3"><a id="GUID-411B0545-DD04-4223-80F0-3CE2A550D7B6"></a>
<h3 id="ADMIN-GUID-411B0545-DD04-4223-80F0-3CE2A550D7B6" class="sect3"><span class="enumeration_section">14.8.1</span> About Copying Files Using the Database Server</h3>
<div>
<p>You do not necessarily have to use the operating system to copy a file within a database, or transfer a file between databases as you would do when using the transportable tablespace feature.</p>
<p>You can use the <a class="olink ARPLS095" target="_blank" href="../ARPLS/d_ftran.htm#ARPLS095"><code class="codeph">DBMS_FILE_TRANSFER</code></a> package, or you can use Streams propagation. Using Streams is not discussed in this book, but an example of using the <code class="codeph">DBMS_FILE_TRANSFER</code> package is shown in <span class="q">&#34;<a href="dfiles.htm#GUID-34497E70-78DA-4E68-832C-28FB7B73E630" title="You can use the COPY_FILE procedure in the DBMS_FILE_TRANSFER package to copy a file on a local file system.">Copying a File on a Local File System</a>&#34;</span>.</p>
<p>The <code class="codeph">DBMS_FILE_TRANSFER</code> package can use a local file system or an Oracle Automatic Storage Management (Oracle ASM) disk group as the source or destination for a file transfer. Only Oracle database files (data files, temp files, control files, and so on) can be involved in transfers to and from Oracle ASM.</p>
<div class="infobox-note" id="GUID-411B0545-DD04-4223-80F0-3CE2A550D7B6__GUID-33A4EF1F-34C3-4B2A-AF52-961994971FAA">
<p class="notep1">Caution:</p>
<p>Do not use the <code class="codeph">DBMS_FILE_TRANSFER</code> package to copy or transfer a file that is being modified by a database because doing so may result in an inconsistent file.</p>
</div>
<p>On UNIX systems, the owner of a file created by the <a class="olink ARPLS095" target="_blank" href="../ARPLS/d_ftran.htm#ARPLS095"><code class="codeph">DBMS_FILE_TRANSFER</code></a> package is the owner of the shadow process running the instance. Normally, this owner is <code class="codeph">ORACLE</code>. A file created using <code class="codeph">DBMS_FILE_TRANSFER</code> is always writable and readable by all processes in the database, but non privileged users who need to read or write such a file directly may need access from a system administrator.</p>
<div class="infoboxnotealso" id="GUID-411B0545-DD04-4223-80F0-3CE2A550D7B6__GUID-51AC6440-0C2C-42D4-AC72-FC09D59E497F">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink STRMS003" target="_blank" href="../STRMS/strms_prop.htm#STRMS003"><span class="italic">Oracle Streams Concepts and Administration</span></a></p>
</li>
<li>
<p><span class="q">&#34;<a href="transport.htm#GUID-F7B2B591-AA88-4D16-8DCF-712763923FFB" title="You can transport tablespaces between databases.">Transporting Tablespaces Between Databases</a>&#34;</span></p>
</li>
<li>
<p><a class="olink ARPLS095" target="_blank" href="../ARPLS/d_ftran.htm#ARPLS095"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for a description of the <code class="codeph">DBMS_FILE_TRANSFER</code> package.</p>
</li>
</ul>
</div>
</div>
</div>
<a id="ADMIN11437"></a>
<div class="props_rev_3"><a id="GUID-34497E70-78DA-4E68-832C-28FB7B73E630"></a>
<h3 id="ADMIN-GUID-34497E70-78DA-4E68-832C-28FB7B73E630" class="sect3"><span class="enumeration_section">14.8.2</span> Copying a File on a Local File System</h3>
<div>
<p>You can use the <code class="codeph">COPY_FILE</code> procedure in the <code class="codeph">DBMS_FILE_TRANSFER</code> package to copy a file on a local file system.</p>
<div class="section">
<p>The following example illustrates using the <code class="codeph">COPY_FILE</code> procedure in the <code class="codeph">DBMS_FILE_TRANSFER</code> package to copy a file on a local file system. The example copies a binary file named <code class="codeph">db1.dat</code> from the <code class="codeph">/usr/admin/source</code> directory to the <code class="codeph">/usr/admin/destination</code> directory as <code class="codeph">db1_copy.dat</code> on a local file system:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>In SQL*Plus, connect as an administrative user who can grant privileges and create directory objects using SQL.</span></li>
<li class="stepexpand"><span>Use the SQL command <code class="codeph">CREATE DIRECTORY</code> to create a directory object for the directory from which you want to copy the file. A directory object is similar to an alias for the directory. For example, to create a directory object called <code class="codeph">SOURCE_DIR</code> for the <code class="codeph">/usr/admin/source</code> directory on your computer system, execute the following statement:</span>
<div>
<pre dir="ltr">CREATE DIRECTORY SOURCE_DIR AS &#39;/usr/admin/source&#39;;
</pre></div>
</li>
<li class="stepexpand"><span>Use the SQL command <code class="codeph">CREATE</code> <code class="codeph">DIRECTORY</code> to create a directory object for the directory into which you want to copy the binary file. For example, to create a directory object called <code class="codeph">DEST_DIR</code> for the <code class="codeph">/usr/admin/destination</code> directory on your computer system, execute the following statement:</span>
<div>
<pre dir="ltr">CREATE DIRECTORY DEST_DIR AS &#39;/usr/admin/destination&#39;;
</pre></div>
</li>
<li class="stepexpand"><span>Grant the required privileges to the user who will run the <code class="codeph">COPY_FILE</code> procedure. In this example, the <code class="codeph">strmadmin</code> user runs the procedure.</span>
<div>
<pre dir="ltr">GRANT EXECUTE ON DBMS_FILE_TRANSFER TO strmadmin;

GRANT READ ON DIRECTORY source_dir TO strmadmin;

GRANT WRITE ON DIRECTORY dest_dir TO strmadmin;
</pre></div>
</li>
<li class="stepexpand"><span>Connect as <code class="codeph">strmadmin</code> user and provide the user password when prompted:</span>
<div>
<pre dir="ltr">CONNECT strmadmin
</pre></div>
</li>
<li class="stepexpand"><span>Run the <code class="codeph">COPY_FILE</code> procedure to copy the file:</span>
<div>
<pre dir="ltr">BEGIN
  DBMS_FILE_TRANSFER.COPY_FILE(
        source_directory_object       =&gt;  &#39;SOURCE_DIR&#39;,
        source_file_name              =&gt;  &#39;db1.dat&#39;,
        destination_directory_object  =&gt;  &#39;DEST_DIR&#39;,
        destination_file_name         =&gt;  &#39;db1_copy.dat&#39;);
END;
/
</pre></div>
</li>
</ol>
<div class="section">
<div class="infobox-note" id="GUID-34497E70-78DA-4E68-832C-28FB7B73E630__GUID-04A1D644-2C04-4895-8DD5-FBA11B4C56CA">
<p class="notep1">Caution:</p>
<p>Do not use the <code class="codeph">DBMS_FILE_TRANSFER</code> package to copy or transfer a file that is being modified by a database because doing so may result in an inconsistent file.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11438"></a>
<div class="props_rev_3"><a id="GUID-F0A823D4-1E71-4C70-9E3A-EB5EDECBC10F"></a>
<h3 id="ADMIN-GUID-F0A823D4-1E71-4C70-9E3A-EB5EDECBC10F" class="sect3"><span class="enumeration_section">14.8.3</span> Third-Party File Transfer</h3>
<div>
<p>Although the procedures in the <code class="codeph">DBMS_FILE_TRANSFER</code> package typically are invoked as local procedure calls, they can also be invoked as remote procedure calls. A remote procedure call lets you copy a file within a database even when you are connected to a different database.</p>
<div class="section">
<p>For example, you can make a copy of a file on database <code class="codeph">DB</code>, even if you are connected to another database, by executing the following remote procedure call:</p>
<pre dir="ltr">DBMS_FILE_TRANSFER.COPY_FILE@DB(...)
</pre>
<p>Using remote procedure calls enables you to copy a file between two databases, even if you are not connected to either database. For example, you can connect to database <code class="codeph">A</code> and then transfer a file from database <code class="codeph">B</code> to database <code class="codeph">C</code>. In this example, database <code class="codeph">A</code> is the third party because it is neither the source of nor the destination for the transferred file.</p>
<p>A third-party file transfer can both push and pull a file. Continuing with the previous example, you can perform a third-party file transfer if you have a database link from <code class="codeph">A</code> to either <code class="codeph">B</code> or <code class="codeph">C</code>, and that database has a database link to the other database. Database <code class="codeph">A</code> does not need a database link to both <code class="codeph">B</code> and <code class="codeph">C</code>.</p>
<p>For example, if you have a database link from <code class="codeph">A</code> to <code class="codeph">B</code>, and another database link from <code class="codeph">B</code> to <code class="codeph">C</code>, then you can run the following procedure at <code class="codeph">A</code> to transfer a file from <code class="codeph">B</code> to <code class="codeph">C</code>:</p>
<pre dir="ltr">DBMS_FILE_TRANSFER.PUT_FILE@B(...) 
</pre>
<p>This configuration pushes the file.</p>
<p>Alternatively, if you have a database link from <code class="codeph">A</code> to <code class="codeph">C</code>, and another database link from <code class="codeph">C</code> to <code class="codeph">B</code>, then you can run the following procedure at database <code class="codeph">A</code> to transfer a file from <code class="codeph">B</code> to <code class="codeph">C</code>:</p>
<pre dir="ltr">DBMS_FILE_TRANSFER.GET_FILE@C(...)
</pre>
<p>This configuration pulls the file.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11440"></a>
<div class="props_rev_3"><a id="GUID-CF6F960B-93BD-4C93-9C8F-38932CC293AA"></a>
<h3 id="ADMIN-GUID-CF6F960B-93BD-4C93-9C8F-38932CC293AA" class="sect3"><span class="enumeration_section">14.8.4</span> Advanced File Transfer Mechanisms</h3>
<div>
<p>You can create more sophisticated file transfer mechanisms using both the <code class="codeph">DBMS_FILE_TRANSFER</code> package and the <code class="codeph">DBMS_SCHEDULER</code> package.</p>
<p>For example, when several databases have a copy of the file you want to transfer, you can consider factors such as source availability, source load, and communication bandwidth to the destination database when deciding which source database to contact first and which source databases to try if failures occur. In this case, the information about these factors must be available to you, and you must create the mechanism that considers these factors.</p>
<p>As another example, when early completion time is more important than load, you can submit several Scheduler jobs to transfer files in parallel. As a final example, knowing something about file layout on the source and destination databases enables you to minimize disk contention by performing or scheduling simultaneous transfers only if they use different I/O devices.</p>
</div>
</div>
<a id="ADMIN11439"></a>
<div class="props_rev_3"><a id="GUID-1C792711-AF78-49CF-BDB2-6D737C92FA09"></a>
<h3 id="ADMIN-GUID-1C792711-AF78-49CF-BDB2-6D737C92FA09" class="sect3"><span class="enumeration_section">14.8.5</span> File Transfer and the DBMS_SCHEDULER Package</h3>
<div>
<p>You can use the <code class="codeph">DBMS_SCHEDULER</code> package to transfer files automatically within a single database and between databases.</p>
<p>Third-party file transfers are also supported by the <code class="codeph">DBMS_SCHEDULER</code> package. You can monitor a long-running file transfer done by the Scheduler using the <code class="codeph">V$SESSION_LONGOPS</code> dynamic performance view at the databases reading or writing the file. Any database links used by a Scheduler job must be fixed user database links.</p>
<p>You can use a restartable Scheduler job to improve the reliability of file transfers automatically, especially if there are intermittent failures. If a file transfer fails before the destination file is closed, then you can restart the file transfer from the beginning once the database has removed any partially written destination file. Hence you should consider using a restartable Scheduler job to transfer a file if the rest of the job is restartable. See <a href="scheduse.htm#GUID-D41660D0-D88F-4D9F-8CC8-63D040EDC4E6" title="You can create, run, and manage jobs with Oracle Scheduler.">Scheduling Jobs with Oracle Scheduler</a> for more information on Scheduler jobs.</p>
<div class="infobox-note" id="GUID-1C792711-AF78-49CF-BDB2-6D737C92FA09__GUID-F81E649B-E417-415D-94AE-D8ACB03ED71D">
<p class="notep1">Note:</p>
<p>If a single restartable job transfers several files, then you should consider restart scenarios in which some of the files have been transferred already and some have not been transferred yet.</p>
</div>
</div>
</div>
</div>
<a id="ADMIN11441"></a>
<div class="props_rev_3"><a id="GUID-3348410C-246D-4100-A41E-814E1BD9C541"></a>
<h2 id="ADMIN-GUID-3348410C-246D-4100-A41E-814E1BD9C541" class="sect2"><span class="enumeration_section">14.9</span> Mapping Files to Physical Devices</h2>
<div>
<p>In an environment where data files are file system files, it is relatively straight forward to see the association between a tablespace and the underlying device. Oracle Database provides views, such as <code class="codeph">DBA_TABLESPACES</code>, <code class="codeph">DBA_DATA_FILES</code>, and <code class="codeph">V$DATAFILE</code>, that provide a mapping of files onto devices. These mappings, along with device statistics can be used to evaluate I/O performance.</p>
<p>However, with the introduction of host based Logical Volume Managers (LVM), and sophisticated storage subsystems that provide RAID (Redundant Array of Inexpensive Disks) features, it is not easy to determine file to device mapping. This poses a problem because it becomes difficult to determine your &#34;hottest&#34; files when they are hidden behind a &#34;black box&#34;. This section presents the Oracle Database approach to resolving this problem.</p>
<div class="infobox-note" id="GUID-3348410C-246D-4100-A41E-814E1BD9C541__GUID-F77DF1AE-1B52-400B-A0A4-A84282A878EB">
<p class="notep1">Note:</p>
<p>This section presents an overview of the Oracle Database file mapping interface and explains how to use the <code class="codeph">DBMS_STORAGE_MAP</code> package and dynamic performance views to expose the mapping of files onto physical devices. You can more easily access this functionality through the Oracle Enterprise Manager Cloud Control. It provides an easy to use graphical interface for mapping files to physical devices. See the Cloud Control online help for more information.</p>
</div>
</div>
<a id="ADMIN11442"></a>
<div class="props_rev_3"><a id="GUID-17690011-5226-4F9A-BF59-73B2A76CF4C1"></a>
<h3 id="ADMIN-GUID-17690011-5226-4F9A-BF59-73B2A76CF4C1" class="sect3"><span class="enumeration_section">14.9.1</span> Overview of Oracle Database File Mapping Interface</h3>
<div>
<p>To acquire an understanding of I/O performance, one must have detailed knowledge of the storage hierarchy in which files reside.</p>
<p>Oracle Database provides a mechanism to show a complete mapping of a file to intermediate layers of logical volumes to actual physical devices. This is accomplished though a set of dynamic performance views (<code class="codeph">V$</code> views). Using these views, you can locate the exact disk on which any block of a file resides.</p>
<p>To build these views, storage vendors must provide mapping libraries that are responsible for mapping their particular I/O stack elements. The database communicates with these libraries through an external non-Oracle Database process that is spawned by a background process called FMON. FMON is responsible for managing the mapping information. Oracle provides a PL/SQL package, <code class="codeph">DBMS_STORAGE_MAP</code>, that you use to invoke mapping operations that populate the mapping views.</p>
<div class="infobox-note" id="GUID-17690011-5226-4F9A-BF59-73B2A76CF4C1__GUID-7F5A1018-0484-4DC7-BA50-E885BC14D8DC">
<p class="notep1">Note:</p>
<p>If you are not using Oracle Automatic Storage Management, then the file mapping interface is not available on Windows platforms. If you are using Oracle Automatic Storage Management, then the file mapping interface is available on all platforms.</p>
</div>
<div class="infoboxnotealso" id="GUID-17690011-5226-4F9A-BF59-73B2A76CF4C1__GUID-6EA79ACE-3129-45F2-82AC-2205F7CEC72C">
<p class="notep1">See Also:</p>
<p><a class="olink OSTMG95752" target="_blank" href="../OSTMG/GUID-346E8F7D-2A29-44D2-A47A-BE5A8032284C.htm#OSTMG95752"><span class="italic">Oracle Automatic Storage Management Administrator&#39;s Guide</span></a> for information about using file mapping with Oracle ASM</p>
</div>
</div>
</div>
<a id="ADMIN11443"></a>
<div class="props_rev_3"><a id="GUID-4D16DC92-92C9-4013-B443-EC5E512CF3DC"></a>
<h3 id="ADMIN-GUID-4D16DC92-92C9-4013-B443-EC5E512CF3DC" class="sect3"><span class="enumeration_section">14.9.2</span> How the Oracle Database File Mapping Interface Works</h3>
<p>Oracle Database file mapping includes the following components: the FMON is a background process, the FMPUTL process, and mapping libraries.</p>
<a id="ADMIN13047"></a><a id="ADMIN11444"></a>
<div class="props_rev_3"><a id="GUID-18612772-FCD1-44A4-930D-96BDE305C693"></a>
<h4 id="ADMIN-GUID-18612772-FCD1-44A4-930D-96BDE305C693" class="sect4"><span class="enumeration_section">14.9.2.1</span> Components of File Mapping</h4>
<div>
<p>The file mapping mechanism includes several components.</p>
<p>The following figure shows the components of the file mapping mechanism.</p>
<div class="figure" id="GUID-18612772-FCD1-44A4-930D-96BDE305C693__GUID-FDB5183E-8458-4E82-8E2B-75377D2C2444">
<p class="titleinfigure">Figure 14-1 Components of File Mapping</p>
<img width="438" height="178" src="img/GUID-3ED27081-759E-4C61-A0EA-0627845E93E7-default.gif" alt="Description of Figure 14-1 follows" title="Description of Figure 14-1 follows"/><br/>
<a href="img_text/GUID-3ED27081-759E-4C61-A0EA-0627845E93E7-print.htm">Description of &#34;Figure 14-1 Components of File Mapping&#34;</a></div>
<!-- class="figure" -->
<div class="infobox-note" id="GUID-18612772-FCD1-44A4-930D-96BDE305C693__GUID-C6BA70EA-975A-4894-9CD3-020C59E1282D">
<p class="notep1">Note:</p>
<p>Starting with Oracle Database 12<span class="italic">c</span>, the <code class="codeph">FILE_MAPPING</code> initialization parameter, the <code class="codeph">FMPUTL</code> process, and the mapping libraries are deprecated.</p>
</div>
</div>
<a id="ADMIN11445"></a>
<div class="props_rev_3"><a id="GUID-F81D32CB-0D24-4568-9D3B-D6F98870085B"></a>
<h5 id="ADMIN-GUID-F81D32CB-0D24-4568-9D3B-D6F98870085B" class="sect5"><span class="enumeration_section">14.9.2.1.1</span> FMON</h5>
<div>
<p>FMON is a background process started by the database whenever the <code class="codeph">FILE_MAPPING</code> initialization parameter is set to <code class="codeph">true</code>. FMON builds map information and refreshing mapping information when a change occurs.</p>
<p>FMON is responsible for:</p>
<ul style="list-style-type: disc;">
<li>
<p>Building mapping information, which is stored in the SGA. This information is composed of the following structures:</p>
<ul style="list-style-type: disc;">
<li>
<p>Files</p>
</li>
<li>
<p>File system extents</p>
</li>
<li>
<p>Elements</p>
</li>
<li>
<p>Subelements</p>
</li>
</ul>
<p>These structures are explained in <span class="q">&#34;<a href="dfiles.htm#GUID-A05D8B3C-1DD7-4EA5-89DB-AA787462B3C1" title="You must understand mapping structures and the Oracle Database representation of these structures to interpret the information in the mapping views.">Mapping Structures</a>&#34;</span>.</p>
</li>
<li>
<p>Refreshing mapping information when a change occurs because of:</p>
<ul style="list-style-type: disc;">
<li>
<p>Changes to data files (size)</p>
</li>
<li>
<p>Addition or deletion of data files</p>
</li>
<li>
<p>Changes to the storage configuration (not frequent)</p>
</li>
</ul>
</li>
<li>
<p>Saving mapping information in the data dictionary to maintain a view of the information that is persistent across startup and shutdown operations</p>
</li>
<li>
<p>Restoring mapping information into the SGA at instance startup. This avoids the need for a potentially expensive complete rebuild of the mapping information on every instance startup.</p>
</li>
</ul>
<p>You help control this mapping using procedures that are invoked with the <code class="codeph">DBMS_STORAGE_MAP</code> package.</p>
</div>
</div>
<a id="ADMIN11446"></a>
<div class="props_rev_3"><a id="GUID-96BE6925-8C6D-4895-AEF5-207924CB1423"></a>
<h5 id="ADMIN-GUID-96BE6925-8C6D-4895-AEF5-207924CB1423" class="sect5"><span class="enumeration_section">14.9.2.1.2</span> External Process (FMPUTL)</h5>
<div>
<p>FMON spawns an external non-Oracle Database process called <code class="codeph">FMPUTL</code>, that communicates directly with the vendor supplied mapping libraries.</p>
<p>This process obtains the mapping information through all levels of the I/O stack, assuming that mapping libraries exist for all levels. On some platforms the external process requires that the <code class="codeph">SETUID</code> bit is set to <code class="codeph">ON</code> because root privileges are needed to map through all levels of the I/O mapping stack.</p>
<p>The external process is responsible for discovering the mapping libraries and dynamically loading them into its address space.</p>
</div>
</div>
<a id="ADMIN11447"></a>
<div class="props_rev_3"><a id="GUID-064ADCDE-1AFD-41AC-8472-7EDA5FBF169E"></a>
<h5 id="ADMIN-GUID-064ADCDE-1AFD-41AC-8472-7EDA5FBF169E" class="sect5"><span class="enumeration_section">14.9.2.1.3</span> Mapping Libraries</h5>
<div>
<p>Oracle Database uses mapping libraries to discover mapping information for the elements that are owned by a particular mapping library.</p>
<p>Through these mapping libraries information about individual I/O stack elements is communicated. This information is used to populate dynamic performance views that can be queried by users.</p>
<p>Mapping libraries need to exist for all levels of the stack for the mapping to be complete, and different libraries may own their own parts of the I/O mapping stack. For example, a VERITAS VxVM library would own the stack elements related to the VERITAS Volume Manager, and an EMC library would own all EMC storage specific layers of the I/O mapping stack.</p>
<p>Mapping libraries are vendor supplied. However, Oracle currently supplies a mapping library for EMC storage. The mapping libraries available to a database server are identified in a special file named filemap.ora.</p>
</div>
</div>
</div>
<a id="ADMIN11448"></a>
<div class="props_rev_3"><a id="GUID-A05D8B3C-1DD7-4EA5-89DB-AA787462B3C1"></a>
<h4 id="ADMIN-GUID-A05D8B3C-1DD7-4EA5-89DB-AA787462B3C1" class="sect4"><span class="enumeration_section">14.9.2.2</span> Mapping Structures</h4>
<div>
<p>You must understand mapping structures and the Oracle Database representation of these structures to interpret the information in the mapping views.</p>
<p>The following are the primary structures that compose the mapping information:</p>
<ul style="list-style-type: disc;">
<li>
<p>Files</p>
<p>A file mapping structure provides a set of attributes for a file, including file size, number of file system extents that the file is composed of, and the file type.</p>
</li>
<li>
<p>File system extents</p>
<p>A file system extent mapping structure describes a contiguous chunk of blocks residing on one element. This includes the device offset, the extent size, the file offset, the type (data or parity), and the name of the element where the extent resides.</p>
<div class="infobox-note" id="GUID-A05D8B3C-1DD7-4EA5-89DB-AA787462B3C1__GUID-161E5BC6-679B-4EF4-ABF1-C2114DF5C5F9">
<p class="notep1">Note:</p>
<p>File system extents are different from Oracle Database extents. File system extents are physical contiguous blocks of data written to a device as managed by the file system. Oracle Database extents are logical structures managed by the database, such as tablespace extents.</p>
</div>
</li>
<li>
<p>Elements</p>
<p>An element mapping structure is the abstract mapping structure that describes a storage component within the I/O stack. Elements may be mirrors, stripes, partitions, RAID5, concatenated elements, and disks. These structures are the mapping building blocks.</p>
</li>
<li>
<p>Subelements</p>
<p>A subelement mapping structure describes the link between an element and the next elements in the I/O mapping stack. This structure contains the subelement number, size, the element name where the subelement exists, and the element offset.</p>
</li>
</ul>
<p>All of these mapping structures are illustrated in the following example.</p>
</div>
</div>
<a id="ADMIN13048"></a><a id="ADMIN11449"></a>
<div class="props_rev_3"><a id="GUID-4B6A1F46-28BF-40E5-9320-C3A5D5EBB173"></a>
<h4 id="ADMIN-GUID-4B6A1F46-28BF-40E5-9320-C3A5D5EBB173" class="sect4"><span class="enumeration_section">14.9.2.3</span> Example of Mapping Structures</h4>
<div>
<p>An example illustrates mapping structures.</p>
<p>Consider an Oracle Database which is composed of two data files X and Y. Both files X and Y reside on a file system mounted on volume A. File X is composed of two extents while file Y is composed of only one extent.</p>
<p>The two extents of File X and the one extent of File Y both map to Element A. Element A is striped to Elements B and C. Element A maps to Elements B and C by way of Subelements B0 and C1, respectively.</p>
<p>Element B is a partition of Element D (a physical disk), and is mapped to Element D by way of subelement D0.</p>
<p>Element C is mirrored over Elements E and F (both physical disks), and is mirrored to those physical disks by way of Subelements E0 and F1, respectively.</p>
<p>All of the mapping structures are illustrated in <a href="dfiles.htm#GUID-4B6A1F46-28BF-40E5-9320-C3A5D5EBB173__i1006737">Figure 14-2</a>.</p>
<div class="figure" id="GUID-4B6A1F46-28BF-40E5-9320-C3A5D5EBB173__i1006737">
<p class="titleinfigure">Figure 14-2 Illustration of Mapping Structures</p>
<img width="585" height="419" src="img/GUID-FAFB58EA-4084-4067-ADEB-48FF4AAD1853-default.gif" alt="Description of Figure 14-2 follows" title="Description of Figure 14-2 follows"/><br/>
<a href="img_text/GUID-FAFB58EA-4084-4067-ADEB-48FF4AAD1853-print.htm">Description of &#34;Figure 14-2 Illustration of Mapping Structures&#34;</a></div>
<!-- class="figure" -->
<p>Note that the mapping structures represented are sufficient to describe the entire mapping information for the Oracle Database instance and consequently to map every logical block within the file into a (element name, element offset) tuple (or more in case of mirroring) at each level within the I/O stack.</p>
</div>
</div>
<a id="ADMIN11450"></a>
<div class="props_rev_3"><a id="GUID-A5B2943B-1272-4333-9F86-FF4430DE6161"></a>
<h4 id="ADMIN-GUID-A5B2943B-1272-4333-9F86-FF4430DE6161" class="sect4"><span class="enumeration_section">14.9.2.4</span> Configuration ID</h4>
<div>
<p>The configuration ID captures the version information associated with elements or files.</p>
<p>The vendor library provides the configuration ID and updates it whenever a change occurs. Without a configuration ID, there is no way for the database to tell whether the mapping has changed.</p>
<p>There are two kinds of configuration IDs:</p>
<ul style="list-style-type: disc;">
<li>
<p>Persistent</p>
<p>These configuration IDs are persistent across instance shutdown</p>
</li>
<li>
<p>Non-persistent</p>
<p>The configuration IDs are not persistent across instance shutdown. The database is only capable of refreshing the mapping information while the instance is up.</p>
</li>
</ul>
</div>
</div>
</div>
<a id="ADMIN11451"></a>
<div class="props_rev_3"><a id="GUID-4760C767-140C-45EF-AC12-C963522A4835"></a>
<h3 id="ADMIN-GUID-4760C767-140C-45EF-AC12-C963522A4835" class="sect3"><span class="enumeration_section">14.9.3</span> Using the Oracle Database File Mapping Interface</h3>
<p>You can use the Oracle Database file mapping interface to enable file mapping and obtain information about file mapping in a set of views.</p>
<a id="ADMIN11452"></a>
<div class="props_rev_3"><a id="GUID-F38819F9-10BD-4CDA-B022-20822A0C3E09"></a>
<h4 id="ADMIN-GUID-F38819F9-10BD-4CDA-B022-20822A0C3E09" class="sect4"><span class="enumeration_section">14.9.3.1</span> Enabling File Mapping</h4>
<div>
<p>You can enable file mapping.</p>
<div class="section">
<p>To enable file mapping:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Ensure that a valid filemap.ora file exists in the /opt/ORCLfmap/prot1_32/etc directory for 32-bit platforms, or in the /opt/ORCLfmap/prot1_64/etc directory for 64-bit platforms.</span>
<div>
<div class="infobox-note" id="GUID-F38819F9-10BD-4CDA-B022-20822A0C3E09__GUID-7CDCF5BB-7D07-4162-8BEA-74DEFBAEC32D">
<p class="notep1">Note:</p>
<p>While the format and content of the filemap.ora file is discussed here, it is for informational reasons only. The filemap.ora file is created by the database when your system is installed. Until such time that vendors supply their own libraries, there will be only one entry in the filemap.ora file, and that is the Oracle-supplied EMC library. This file should be modified manually by uncommenting this entry <span class="italic">only</span> if an EMC Symmetrix array is available.</p>
</div>
<p>The filemap.ora file is the configuration file that describes all of the available mapping libraries. FMON requires that a filemap.ora file exists and that it points to a valid path to mapping libraries. Otherwise, it will not start successfully.</p>
<p>The following row must be included in filemap.ora for each library:</p>
<p><code class="codeph">lib</code>=<span class="italic"><code class="codeph">vendor_name:mapping_library_path</code></span></p>
<p>where:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="italic">vendor_name</span> should be <code class="codeph">Oracle</code> for the EMC Symmetric library</p>
</li>
<li>
<p><span class="italic">mapping_library_path</span> is the full path of the mapping library</p>
</li>
</ul>
<p>Note that the ordering of the libraries in this file is extremely important. The libraries are queried based on their order in the configuration file.</p>
<p>The file mapping service can be started even if no mapping libraries are available. The filemap.ora file still must be present even though it is empty. In this case, the mapping service is constrained in the sense that new mapping information cannot be discovered. Only restore and drop operations are allowed in such a configuration.</p>
</div>
</li>
<li class="stepexpand"><span>Set the <code class="codeph">FILE_MAPPING</code> initialization parameter to <code class="codeph">TRUE</code>.</span>
<div>
<p>The instance does not have to be shut down to set this parameter. You can set it using the following <code class="codeph">ALTER SYSTEM</code> statement:</p>
<pre dir="ltr">ALTER SYSTEM SET FILE_MAPPING=TRUE;
</pre></div>
</li>
<li class="stepexpand"><span>Invoke the appropriate <code class="codeph">DBMS_STORAGE_MAP</code> mapping procedure. You have two options:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p>In a cold startup scenario, the Oracle Database is just started and no mapping operation has been invoked yet. You execute the <code class="codeph">DBMS_STORAGE_MAP.MAP_ALL</code> procedure to build the mapping information for the entire I/O subsystem associated with the database.</p>
</li>
<li>
<p>In a warm start scenario where the mapping information is already built, you have the option to invoke the <code class="codeph">DBMS_STORAGE_MAP.MAP_SAVE</code> procedure to save the mapping information in the data dictionary. (Note that this procedure is invoked in <code class="codeph">DBMS_STORAGE_MAP.MAP_ALL()</code> by default.) This forces all of the mapping information in the SGA to be flushed to disk.</p>
<p>Once you restart the database, use <code class="codeph">DBMS_STORAGE_MAP.RESTORE()</code> to restore the mapping information into the SGA. If needed, <code class="codeph">DBMS_STORAGE_MAP.MAP_ALL()</code> can be called to refresh the mapping information.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<a id="ADMIN11453"></a>
<div class="props_rev_3"><a id="GUID-22F15595-3A4C-446B-B10B-E94F003D0A7F"></a>
<h4 id="ADMIN-GUID-22F15595-3A4C-446B-B10B-E94F003D0A7F" class="sect4"><span class="enumeration_section">14.9.3.2</span> Using the DBMS_STORAGE_MAP Package</h4>
<div>
<p>The <code class="codeph">DBMS_STORAGE_MAP</code> package enables you to control the mapping operations.</p>
<div class="section">
<p>The various procedures available to you are described in the following table.</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-22F15595-3A4C-446B-B10B-E94F003D0A7F__GUID-B67BB403-0DE3-4BAC-97BD-30C58AD1F544">
<table class="cellalignment1849" summary="Column 1 lists the various procedures of the DBMS_STORAGE_MAP package. Column 2 describes their use.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1863" id="d115800e5218">Procedure</th>
<th class="cellalignment1959" id="d115800e5221">Use to:</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1865" id="d115800e5226" headers="d115800e5218">
<p><code class="codeph">MAP_OBJECT</code></p>
</td>
<td class="cellalignment1960" headers="d115800e5226 d115800e5221">
<p>Build the mapping information for the database object identified by object name, owner, and type</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1865" id="d115800e5235" headers="d115800e5218">
<p><code class="codeph">MAP_ELEMENT</code></p>
</td>
<td class="cellalignment1960" headers="d115800e5235 d115800e5221">
<p>Build mapping information for the specified element</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1865" id="d115800e5244" headers="d115800e5218">
<p><code class="codeph">MAP_FILE</code></p>
</td>
<td class="cellalignment1960" headers="d115800e5244 d115800e5221">
<p>Build mapping information for the specified file name</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1865" id="d115800e5253" headers="d115800e5218">
<p><code class="codeph">MAP_ALL</code></p>
</td>
<td class="cellalignment1960" headers="d115800e5253 d115800e5221">
<p>Build entire mapping information for all types of database files (excluding archive logs)</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1865" id="d115800e5262" headers="d115800e5218">
<p><code class="codeph">DROP_ELEMENT</code></p>
</td>
<td class="cellalignment1960" headers="d115800e5262 d115800e5221">
<p>Drop the mapping information for a specified element</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1865" id="d115800e5271" headers="d115800e5218">
<p><code class="codeph">DROP_FILE</code></p>
</td>
<td class="cellalignment1960" headers="d115800e5271 d115800e5221">
<p>Drop the file mapping information for the specified file name</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1865" id="d115800e5280" headers="d115800e5218">
<p><code class="codeph">DROP_ALL</code></p>
</td>
<td class="cellalignment1960" headers="d115800e5280 d115800e5221">
<p>Drop all mapping information in the SGA for this instance</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1865" id="d115800e5289" headers="d115800e5218">
<p><code class="codeph">SAVE</code></p>
</td>
<td class="cellalignment1960" headers="d115800e5289 d115800e5221">
<p>Save into the data dictionary the required information needed to regenerate the entire mapping</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1865" id="d115800e5298" headers="d115800e5218">
<p><code class="codeph">RESTORE</code></p>
</td>
<td class="cellalignment1960" headers="d115800e5298 d115800e5221">
<p>Load the entire mapping information from the data dictionary into the shared memory of the instance</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1865" id="d115800e5307" headers="d115800e5218">
<p><code class="codeph">LOCK_MAP</code></p>
</td>
<td class="cellalignment1960" headers="d115800e5307 d115800e5221">
<p>Lock the mapping information in the SGA for this instance</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1865" id="d115800e5316" headers="d115800e5218">
<p><code class="codeph">UNLOCK_MAP</code></p>
</td>
<td class="cellalignment1960" headers="d115800e5316 d115800e5221">
<p>Unlock the mapping information in the SGA for this instance</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-22F15595-3A4C-446B-B10B-E94F003D0A7F__GUID-52E92C67-B84D-4A51-90F8-D7502EF0E308">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink ARPLS137" target="_blank" href="../ARPLS/d_stmap.htm#ARPLS137"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for a description of the <code class="codeph">DBMS_STORAGE_MAP</code> package</p>
</li>
<li>
<p><span class="q">&#34;<a href="dfiles.htm#GUID-B4499D4F-A737-4A05-8BF4-65C55D029310" title="Examples illustrates some of the powerful capabilities of the Oracle Database file mapping feature.">File Mapping Examples</a>&#34;</span> for an example of using the <code class="codeph">DBMS_STORAGE_MAP</code> package</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11454"></a>
<div class="props_rev_3"><a id="GUID-4EBD5314-5EE2-4FB2-B759-FE9E932DA524"></a>
<h4 id="ADMIN-GUID-4EBD5314-5EE2-4FB2-B759-FE9E932DA524" class="sect4"><span class="enumeration_section">14.9.3.3</span> Obtaining Information from the File Mapping Views</h4>
<div>
<p>Mapping information generated by <code class="codeph">DBMS_STORAGE_MAP</code> package is captured in dynamic performance views.</p>
<div class="section">
<p>Brief descriptions of these views are presented here.</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-4EBD5314-5EE2-4FB2-B759-FE9E932DA524__GUID-647B93D9-EF45-465A-85FC-9414C27BF820">
<table class="cellalignment1849" summary="This table lists the file mapping views where information is captured from use of the DBMS_STORAGE_MAP package. Column 1 lists the view, column 2 contains a description of each view..">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1919" id="d115800e5436">View</th>
<th class="cellalignment1920" id="d115800e5439">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1921" id="d115800e5444" headers="d115800e5436">
<p><code class="codeph">V$MAP_LIBRARY</code></p>
</td>
<td class="cellalignment1922" headers="d115800e5444 d115800e5439">
<p>Contains a list of all mapping libraries that have been dynamically loaded by the external process</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1921" id="d115800e5453" headers="d115800e5436">
<p><code class="codeph">V$MAP_FILE</code></p>
</td>
<td class="cellalignment1922" headers="d115800e5453 d115800e5439">
<p>Contains a list of all file mapping structures in the shared memory of the instance</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1921" id="d115800e5462" headers="d115800e5436">
<p><code class="codeph">V$MAP_FILE_EXTENT</code></p>
</td>
<td class="cellalignment1922" headers="d115800e5462 d115800e5439">
<p>Contains a list of all file system extent mapping structures in the shared memory of the instance</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1921" id="d115800e5471" headers="d115800e5436">
<p><code class="codeph">V$MAP_ELEMENT</code></p>
</td>
<td class="cellalignment1922" headers="d115800e5471 d115800e5439">
<p>Contains a list of all element mapping structures in the SGA of the instance</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1921" id="d115800e5480" headers="d115800e5436">
<p><code class="codeph">V$MAP_EXT_ELEMENT</code></p>
</td>
<td class="cellalignment1922" headers="d115800e5480 d115800e5439">
<p>Contains supplementary information for all element mapping</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1921" id="d115800e5489" headers="d115800e5436">
<p><code class="codeph">V$MAP_SUBELEMENT</code></p>
</td>
<td class="cellalignment1922" headers="d115800e5489 d115800e5439">
<p>Contains a list of all subelement mapping structures in the shared memory of the instance</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1921" id="d115800e5498" headers="d115800e5436">
<p><code class="codeph">V$MAP_COMP_LIST</code></p>
</td>
<td class="cellalignment1922" headers="d115800e5498 d115800e5439">
<p>Contains supplementary information for all element mapping structures.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1921" id="d115800e5507" headers="d115800e5436">
<p><code class="codeph">V$MAP_FILE_IO_STACK</code></p>
</td>
<td class="cellalignment1922" headers="d115800e5507 d115800e5439">
<p>The hierarchical arrangement of storage containers for the file displayed as a series of rows. Each row represents a level in the hierarchy.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-4EBD5314-5EE2-4FB2-B759-FE9E932DA524__GUID-5FC99275-0ED6-4E2F-96BB-16777D3AB11A">
<p class="notep1">See Also:</p>
<p><a class="olink REFRN" target="_blank" href="../REFRN/toc.htm"><span class="italic">Oracle Database Reference</span></a> for a complete description of the dynamic performance views</p>
</div>
<p>However, the information generated by the <code class="codeph">DBMS_STORAGE_MAP.MAP_OBJECT</code> procedure is captured in a global temporary table named <code class="codeph">MAP_OBJECT</code>. This table displays the hierarchical arrangement of storage containers for objects. Each row in the table represents a level in the hierarchy. A description of the <code class="codeph">MAP_OBJECT</code> table follows.</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-4EBD5314-5EE2-4FB2-B759-FE9E932DA524__GUID-D7EC9577-6DB1-4AA1-8313-B22A4BA98277">
<table class="cellalignment1849" summary="This table describes the MAP_OBJECT table. Column 1 lists the column name, column 2 lists its datatype, and column 3 describes the column.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1867" id="d115800e5543">Column</th>
<th class="cellalignment1867" id="d115800e5546">Data Type</th>
<th class="cellalignment1868" id="d115800e5549">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d115800e5554" headers="d115800e5543">
<p><code class="codeph">OBJECT_NAME</code></p>
</td>
<td class="cellalignment1869" headers="d115800e5554 d115800e5546">
<p><code class="codeph">VARCHAR2(2000)</code></p>
</td>
<td class="cellalignment1870" headers="d115800e5554 d115800e5549">
<p>Name of the object</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d115800e5568" headers="d115800e5543">
<p><code class="codeph">OBJECT_OWNER</code></p>
</td>
<td class="cellalignment1869" headers="d115800e5568 d115800e5546">
<p><code class="codeph">VARCHAR2(2000)</code></p>
</td>
<td class="cellalignment1870" headers="d115800e5568 d115800e5549">
<p>Owner of the object</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d115800e5582" headers="d115800e5543">
<p><code class="codeph">OBJECT_TYPE</code></p>
</td>
<td class="cellalignment1869" headers="d115800e5582 d115800e5546">
<p><code class="codeph">VARCHAR2(2000)</code></p>
</td>
<td class="cellalignment1870" headers="d115800e5582 d115800e5549">
<p>Object type</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d115800e5596" headers="d115800e5543">
<p><code class="codeph">FILE_MAP_IDX</code></p>
</td>
<td class="cellalignment1869" headers="d115800e5596 d115800e5546">
<p><code class="codeph">NUMBER</code></p>
</td>
<td class="cellalignment1870" headers="d115800e5596 d115800e5549">
<p>File index (corresponds to <code class="codeph">FILE_MAP_IDX</code> in <code class="codeph">V$MAP_FILE</code>)</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d115800e5616" headers="d115800e5543">
<p><code class="codeph">DEPTH</code></p>
</td>
<td class="cellalignment1869" headers="d115800e5616 d115800e5546">
<p><code class="codeph">NUMBER</code></p>
</td>
<td class="cellalignment1870" headers="d115800e5616 d115800e5549">
<p>Element depth within the I/O stack</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d115800e5630" headers="d115800e5543">
<p><code class="codeph">ELEM_IDX</code></p>
</td>
<td class="cellalignment1869" headers="d115800e5630 d115800e5546">
<p><code class="codeph">NUMBER</code></p>
</td>
<td class="cellalignment1870" headers="d115800e5630 d115800e5549">
<p>Index corresponding to element</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d115800e5644" headers="d115800e5543">
<p><code class="codeph">CU_SIZE</code></p>
</td>
<td class="cellalignment1869" headers="d115800e5644 d115800e5546">
<p><code class="codeph">NUMBER</code></p>
</td>
<td class="cellalignment1870" headers="d115800e5644 d115800e5549">
<p>Contiguous set of logical blocks of the file, in HKB (half KB) units, that is resident contiguously on the element</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d115800e5658" headers="d115800e5543">
<p><code class="codeph">STRIDE</code></p>
</td>
<td class="cellalignment1869" headers="d115800e5658 d115800e5546">
<p><code class="codeph">NUMBER</code></p>
</td>
<td class="cellalignment1870" headers="d115800e5658 d115800e5549">
<p>Number of HKB between contiguous units (CU) in the file that are contiguous on this element. Used in RAID5 and striped files.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d115800e5672" headers="d115800e5543">
<p><code class="codeph">NUM_CU</code></p>
</td>
<td class="cellalignment1869" headers="d115800e5672 d115800e5546">
<p><code class="codeph">NUMBER</code></p>
</td>
<td class="cellalignment1870" headers="d115800e5672 d115800e5549">
<p>Number of contiguous units that are adjacent to each other on this element that are separated by <code class="codeph">STRIDE</code> HKB in the file. In RAID5, the number of contiguous units also include the parity stripes.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d115800e5689" headers="d115800e5543">
<p><code class="codeph">ELEM_OFFSET</code></p>
</td>
<td class="cellalignment1869" headers="d115800e5689 d115800e5546">
<p><code class="codeph">NUMBER</code></p>
</td>
<td class="cellalignment1870" headers="d115800e5689 d115800e5549">
<p>Element offset in HKB units</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d115800e5703" headers="d115800e5543">
<p><code class="codeph">FILE_OFFSET</code></p>
</td>
<td class="cellalignment1869" headers="d115800e5703 d115800e5546">
<p><code class="codeph">NUMBER</code></p>
</td>
<td class="cellalignment1870" headers="d115800e5703 d115800e5549">
<p>Offset in HKB units from the start of the file to the first byte of the contiguous units</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d115800e5718" headers="d115800e5543">
<p><code class="codeph">DATA_TYPE</code></p>
</td>
<td class="cellalignment1869" headers="d115800e5718 d115800e5546">
<p><code class="codeph">VARCHAR2(2000)</code></p>
</td>
<td class="cellalignment1870" headers="d115800e5718 d115800e5549">
<p>Data type (<code class="codeph">DATA</code>, <code class="codeph">PARITY</code>, or <code class="codeph">DATA AND PARITY</code>)</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d115800e5741" headers="d115800e5543">
<p><code class="codeph">PARITY_POS</code></p>
</td>
<td class="cellalignment1869" headers="d115800e5741 d115800e5546">
<p><code class="codeph">NUMBER</code></p>
</td>
<td class="cellalignment1870" headers="d115800e5741 d115800e5549">
<p>Position of the parity. Only for RAID5. This field is needed to distinguish the parity from the data part.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d115800e5755" headers="d115800e5543">
<p><code class="codeph">PARITY_PERIOD</code></p>
</td>
<td class="cellalignment1869" headers="d115800e5755 d115800e5546">
<p><code class="codeph">NUMBER</code></p>
</td>
<td class="cellalignment1870" headers="d115800e5755 d115800e5549">
<p>Parity period. Only for RAID5.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
</div>
<a id="ADMIN11455"></a>
<div class="props_rev_3"><a id="GUID-B4499D4F-A737-4A05-8BF4-65C55D029310"></a>
<h3 id="ADMIN-GUID-B4499D4F-A737-4A05-8BF4-65C55D029310" class="sect3"><span class="enumeration_section">14.9.4</span> File Mapping Examples</h3>
<div>
<p>Examples illustrates some of the powerful capabilities of the Oracle Database file mapping feature.</p>
<p>These capabilities include:</p>
<ul style="list-style-type: disc;">
<li>
<p>The ability to map all the database files that span a particular device</p>
</li>
<li>
<p>The ability to map a particular file into its corresponding devices</p>
</li>
<li>
<p>The ability to map a particular database object, including its block distribution at all levels within the I/O stack</p>
</li>
</ul>
<p>Consider an Oracle Database instance which is composed of two data files:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">t_db1.f</code></p>
</li>
<li>
<p><code class="codeph">t_db2.f</code></p>
</li>
</ul>
<p>These files are created on a Solaris UFS file system mounted on a VERITAS VxVM host based striped volume, <code class="codeph">/dev/vx/dsk/ipfdg/ipf-vol1</code>, that consists of the following host devices as externalized from an EMC Symmetrix array:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">/dev/vx/rdmp/c2t1d0s2</code></p>
</li>
<li>
<p><code class="codeph">/dev/vx/rdmp/c2t1d1s2</code></p>
</li>
</ul>
<p>Note that the following examples require the execution of a <code class="codeph">MAP_ALL()</code> operation.</p>
</div>
<a id="ADMIN11456"></a>
<div class="props_rev_3"><a id="GUID-57646CFC-CE89-493B-8980-1F0147C6898D"></a>
<h4 id="ADMIN-GUID-57646CFC-CE89-493B-8980-1F0147C6898D" class="sect4"><span class="enumeration_section">14.9.4.1</span> Example 1: Map All Database Files that Span a Device</h4>
<div>
<p>An example illustrates returning all Oracle Database files associated with a host device.</p>
<div class="section">
<p>The following query returns all Oracle Database files associated with the <code class="codeph">/dev/vx/rdmp/c2t1d1s2</code> host device:</p>
<pre dir="ltr">SELECT UNIQUE me.ELEM_NAME, mf.FILE_NAME
   FROM V$MAP_FILE_IO_STACK fs, V$MAP_FILE mf, V$MAP_ELEMENT me
   WHERE mf.FILE_MAP_IDX = fs.FILE_MAP_IDX
   AND me.ELEM_IDX = fs.ELEM_IDX
   AND me.ELEM_NAME = &#39;/dev/vx/rdmp/c2t1d1s2&#39;;
 
</pre>
<p>The query results are:</p>
<pre dir="ltr">ELEM_NAME                 FILE_NAME
------------------------  --------------------------------
/dev/vx/rdmp/c2t1d1s2     /oracle/dbs/t_db1.f
/dev/vx/rdmp/c2t1d1s2     /oracle/dbs/t_db2.f
</pre></div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11457"></a>
<div class="props_rev_3"><a id="GUID-424A4E93-0E7E-41C3-9D74-E2322E7C86F8"></a>
<h4 id="ADMIN-GUID-424A4E93-0E7E-41C3-9D74-E2322E7C86F8" class="sect4"><span class="enumeration_section">14.9.4.2</span> Example 2: Map a File Into Its Corresponding Devices</h4>
<div>
<p>An example displays a topological graph of a data file.</p>
<div class="section">
<p>The following query displays a topological graph of the <code class="codeph">/oracle/dbs/t_db1.f</code> data file:</p>
<pre dir="ltr">WITH fv AS 
  (SELECT FILE_MAP_IDX, FILE_NAME FROM V$MAP_FILE 
   WHERE FILE_NAME = &#39;/oracle/dbs/t_db1.f&#39;)
SELECT fv.FILE_NAME, LPAD(&#39; &#39;, 4 * (LEVEL - 1)) || el.ELEM_NAME ELEM_NAME 
   FROM V$MAP_SUBELEMENT sb, V$MAP_ELEMENT el, fv, 
     (SELECT UNIQUE ELEM_IDX FROM V$MAP_FILE_IO_STACK io, fv 
      WHERE io.FILE_MAP_IDX = fv.FILE_MAP_IDX) fs
   WHERE el.ELEM_IDX = sb.CHILD_IDX
   AND fs.ELEM_IDX = el.ELEM_IDX
   START WITH sb.PARENT_IDX IN
     (SELECT DISTINCT ELEM_IDX 
      FROM V$MAP_FILE_EXTENT fe, fv
      WHERE fv.FILE_MAP_IDX = fe.FILE_MAP_IDX)
   CONNECT BY PRIOR sb.CHILD_IDX = sb.PARENT_IDX;
</pre>
<p>The resulting topological graph is:</p>
<pre dir="ltr">FILE_NAME                    ELEM_NAME
-----------------------      -------------------------------------------------
/oracle/dbs/t_db1.f          _sym_plex_/dev/vx/rdsk/ipfdg/ipf-vol1_-1_-1
/oracle/dbs/t_db1.f              _sym_subdisk_/dev/vx/rdsk/ipfdg/ipf-vol1_0_0_0
/oracle/dbs/t_db1.f                  /dev/vx/rdmp/c2t1d0s2
/oracle/dbs/t_db1.f                      _sym_symdev_000183600407_00C
/oracle/dbs/t_db1.f                          _sym_hyper_000183600407_00C_0
/oracle/dbs/t_db1.f                          _sym_hyper_000183600407_00C_1
/oracle/dbs/t_db1.f              _sym_subdisk_/dev/vx/rdsk/ipfdg/ipf-vol1_0_1_0
/oracle/dbs/t_db1.f                  /dev/vx/rdmp/c2t1d1s2
/oracle/dbs/t_db1.f                      _sym_symdev_000183600407_00D
/oracle/dbs/t_db1.f                          _sym_hyper_000183600407_00D_0
/oracle/dbs/t_db1.f                          _sym_hyper_000183600407_00D_1
</pre></div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11458"></a>
<div class="props_rev_3"><a id="GUID-0E677EC8-BEAE-4752-B093-B2C9412B9571"></a>
<h4 id="ADMIN-GUID-0E677EC8-BEAE-4752-B093-B2C9412B9571" class="sect4"><span class="enumeration_section">14.9.4.3</span> Example 3: Map a Database Object</h4>
<div>
<p>An example displays the block distribution at all levels within the I/O stack for a table.</p>
<div class="section">
<p>This example displays the block distribution at all levels within the I/O stack for the <code class="codeph">scott.bonus</code> table.</p>
<p>A <code class="codeph">MAP_OBJECT()</code> operation must first be executed as follows:</p>
<pre dir="ltr">EXECUTE DBMS_STORAGE_MAP.MAP_OBJECT(&#39;BONUS&#39;,&#39;SCOTT&#39;,&#39;TABLE&#39;);
</pre>
<p>The query is as follows:</p>
<pre dir="ltr">SELECT io.OBJECT_NAME o_name, io.OBJECT_OWNER o_owner, io.OBJECT_TYPE o_type,
       mf.FILE_NAME, me.ELEM_NAME, io.DEPTH,
      (SUM(io.CU_SIZE * (io.NUM_CU - DECODE(io.PARITY_PERIOD, 0, 0, 
                         TRUNC(io.NUM_CU / io.PARITY_PERIOD)))) / 2) o_size
   FROM MAP_OBJECT io, V$MAP_ELEMENT me, V$MAP_FILE mf
   WHERE io.OBJECT_NAME =  &#39;BONUS&#39;
   AND   io.OBJECT_OWNER = &#39;SCOTT&#39;
   AND   io.OBJECT_TYPE =  &#39;TABLE&#39;
   AND   me.ELEM_IDX = io.ELEM_IDX
   AND   mf.FILE_MAP_IDX = io.FILE_MAP_IDX
   GROUP BY io.ELEM_IDX, io.FILE_MAP_IDX, me.ELEM_NAME, mf.FILE_NAME, io.DEPTH,
         io.OBJECT_NAME, io.OBJECT_OWNER, io.OBJECT_TYPE
   ORDER BY io.DEPTH;
</pre>
<p>The following is the result of the query. Note that the <code class="codeph">o_size</code> column is expressed in KB.</p>
<pre dir="ltr">O_NAME O_OWNER O_TYPE  FILE_NAME            ELEM_NAME                      DEPTH   O_SIZE
------ ------- ------  -------------------  -----------------------------  ------  ------
BONUS  SCOTT   TABLE   /oracle/dbs/t_db1.f  /dev/vx/dsk/ipfdg/ipf-vol1          0      20
BONUS  SCOTT   TABLE   /oracle/dbs/t_db1.f  _sym_plex_/dev/vx/rdsk/ipf          1      20
                                            pdg/if-vol1_-1_-1
BONUS  SCOTT   TABLE   /oracle/dbs/t_db1.f  _sym_subdisk_/dev/vx/rdsk/          2      12
                                            ipfdg/ipf-vol1_0_1_0
BONUS  SCOTT   TABLE   /oracle/dbs/t_db1.f  _sym_subdisk_/dev/vx/rdsk/ipf       2       8
                                            dg/ipf-vol1_0_2_0 
BONUS  SCOTT   TABLE   /oracle/dbs/t_db1.f  /dev/vx/rdmp/c2t1d1s2               3      12
BONUS  SCOTT   TABLE   /oracle/dbs/t_db1.f  /dev/vx/rdmp/c2t1d2s2               3       8
BONUS  SCOTT   TABLE   /oracle/dbs/t_db1.f  _sym_symdev_000183600407_00D        4      12
BONUS  SCOTT   TABLE   /oracle/dbs/t_db1.f  _sym_symdev_000183600407_00E        4       8
BONUS  SCOTT   TABLE   /oracle/dbs/t_db1.f  _sym_hyper_000183600407_00D_0       5      12
BONUS  SCOTT   TABLE   /oracle/dbs/t_db1.f  _sym_hyper_000183600407_00D_1       5      12
BONUS  SCOTT   TABLE   /oracle/dbs/t_db1.f  _sym_hyper_000183600407_00E_0       6       8
BONUS  SCOTT   TABLE   /oracle/dbs/t_db1.f  _sym_hyper_000183600407_00E_1       6       8
</pre></div>
<!-- class="section" --></div>
</div>
</div>
</div>
<a id="ADMIN11459"></a>
<div class="props_rev_3"><a id="GUID-8873DB8E-71AF-4793-A4F7-2694FD4E10F9"></a>
<h2 id="ADMIN-GUID-8873DB8E-71AF-4793-A4F7-2694FD4E10F9" class="sect2"><span class="enumeration_section">14.10</span> Data Files Data Dictionary Views</h2>
<div>
<p>A set of data dictionary views provides useful information about the data files of a database.</p>
<div class="tblformal" id="GUID-8873DB8E-71AF-4793-A4F7-2694FD4E10F9__GUID-500734A2-AFF9-4ADB-BB43-374B04757B8E">
<table class="cellalignment1849" summary="Column 1 contains the names of views containing information about datafiles in the database. Column 2 describes each view.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1939" id="d115800e6197">View</th>
<th class="cellalignment1940" id="d115800e6200">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1941" id="d115800e6205" headers="d115800e6197">
<p><code class="codeph">DBA_DATA_FILES</code></p>
</td>
<td class="cellalignment1942" headers="d115800e6205 d115800e6200">
<p>Provides descriptive information about each data file, including the tablespace to which it belongs and the file ID. The file ID can be used to join with other views for detail information.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1941" id="d115800e6214" headers="d115800e6197">
<p><code class="codeph">DBA_EXTENTS</code></p>
<p><code class="codeph">USER_EXTENTS</code></p>
</td>
<td class="cellalignment1942" headers="d115800e6214 d115800e6200">
<p><code class="codeph">DBA</code> view describes the extents comprising all segments in the database. Contains the file ID of the data file containing the extent. <code class="codeph">USER</code> view describes extents of the segments belonging to objects owned by the current user.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1941" id="d115800e6232" headers="d115800e6197">
<p><code class="codeph">DBA_FREE_SPACE</code></p>
<p><code class="codeph">USER_FREE_SPACE</code></p>
</td>
<td class="cellalignment1942" headers="d115800e6232 d115800e6200">
<p><code class="codeph">DBA</code> view lists the free extents in all tablespaces. Includes the file ID of the data file containing the extent. <code class="codeph">USER</code> view lists the free extents in the tablespaces accessible to the current user.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1941" id="d115800e6250" headers="d115800e6197">
<p><code class="codeph">V$DATAFILE</code></p>
</td>
<td class="cellalignment1942" headers="d115800e6250 d115800e6200">
<p>Contains data file information from the control file</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1941" id="d115800e6259" headers="d115800e6197">
<p><code class="codeph">V$DATAFILE_HEADER</code></p>
</td>
<td class="cellalignment1942" headers="d115800e6259 d115800e6200">
<p>Contains information from data file headers</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<p>This example illustrates the use of one of these views, <code class="codeph">V$DATAFILE</code>.</p>
<pre dir="ltr">SELECT NAME,
    FILE#,
    STATUS,
    CHECKPOINT_CHANGE# &#34;CHECKPOINT&#34;   
  FROM   V$DATAFILE;

NAME                                      FILE#     STATUS       CHECKPOINT
--------------------------------          -----     -------       ----------
/u01/oracle/rbdb1/system01.dbf                1     SYSTEM              3839
/u02/oracle/rbdb1/temp01.dbf                  2     ONLINE              3782
/u02/oracle/rbdb1/users03.dbf                 3     OFFLINE             3782
</pre>
<p><code class="codeph">FILE#</code> lists the file number of each data file; the first data file in the <code class="codeph">SYSTEM</code> tablespace created with the database is always file 1. <code class="codeph">STATUS</code> lists other information about a data file. If a data file is part of the <code class="codeph">SYSTEM</code> tablespace, its status is <code class="codeph">SYSTEM</code> (unless it requires recovery). If a data file in a non-<code class="codeph">SYSTEM</code> tablespace is online, its status is <code class="codeph">ONLINE</code>. If a data file in a non-<code class="codeph">SYSTEM</code> tablespace is offline, its status can be either <code class="codeph">OFFLINE</code> or <code class="codeph">RECOVER</code>. <code class="codeph">CHECKPOINT</code> lists the final <a id="d115800e6310" class="indexterm-anchor"></a>SCN<a id="d115800e6316" class="indexterm-anchor"></a> (system change number) written for the most recent checkpoint of a data file.</p>
<div class="infoboxnotealso" id="GUID-8873DB8E-71AF-4793-A4F7-2694FD4E10F9__GUID-418AFB9B-CBB5-4FC7-9D72-306074E0317B">
<p class="notep1">See Also:</p>
<p><a class="olink REFRN" target="_blank" href="../REFRN/toc.htm"><span class="italic">Oracle Database Reference</span></a> for complete descriptions of these views</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1842">
<tr>
<td class="cellalignment1854">
<table class="cellalignment1847">
<tr>
<td class="cellalignment1846"><a href="tspaces.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1846"><a href="transport.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2001, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1856">
<table class="cellalignment1845">
<tr>
<td class="cellalignment1846"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1846"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1846"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1846"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1846"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1846"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>