<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-180"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Managing%20Control%20Files"></a><title>Managing Control Files</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="description" content="You can create, back up, and drop control files."/>
<meta name="keywords" content="control files, requirement of one, creating, names, CONTROL_FILES initialization parameter, specifying file names, initialization parameters, CONTROL_FILES, mirroring, mirrored files, multiplexed control files, importance of, multiplexed, multiplexing, importance of multiplexed, number of, location of, size of, initial creation, when creating a database, CREATE DATABASE statement, CONTROLFILE REUSE clause, default name, changing size, adding, renaming, renaming control files, relocating, relocating control files, moving, moving control files, CREATE CONTROLFILE statement, about, recovery, creating new control files, databases, MAXLOGFILES parameter, changing, MAXLOGMEMBERS parameter, MAXLOGHISTORY parameter, MAXDATAFILES parameter, MAXINSTANCES, RESETLOGS clause, NORESETLOGS clause, renaming, troubleshooting, conflicts with data dictionary, checking for inconsistencies, data dictionary, conflicts with control files, data files, MISSING, MISSING data files, errors, ORA-01173, ORA-01176, ORA-01177, ORA-01215, ORA-01216, errors during creation, when creating control file, dropping, data dictionary views reference, views, for control files"/>
<meta name="dcterms.created" content="2017-07-10T12:24:11Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Administrator&rsquo;s Guide"/>
<meta name="dcterms.identifier" content="E41484-15"/>
<meta name="dcterms.isVersionOf" content="ADMIN"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2001, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="part2.htm" title="Previous" type="text/html"/>
<link rel="Next" href="onlineredo.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41484-15.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-5F6F9382-6921-4992-9789-E63B18E99C5F"></a> <span id="PAGE" style="display:none;">16/59</span> <!-- End Header -->
<a id="ADMIN006"></a>
<h1 id="ADMIN-GUID-5F6F9382-6921-4992-9789-E63B18E99C5F" class="sect1"><span class="enumeration_chapter">10</span> Managing Control Files</h1>
<div>
<p>You can create, back up, and drop control files.</p>
<div class="infoboxnotealso" id="GUID-5F6F9382-6921-4992-9789-E63B18E99C5F__GUID-12F2DF64-FAAF-4DE5-ADC8-BD80E99B2313">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink CNCPT404" target="_blank" href="../CNCPT/physical.htm#CNCPT404"><span class="italic">Oracle Database Concepts</span></a> for an overview of control files</p>
</li>
<li>
<p><a href="omf.htm#GUID-4A3C4616-0D81-4BBA-8EAD-FCAA8AD5C15A" title="Oracle Database can manage the files that comprise the database.">Using Oracle Managed Files</a> for information about creating control files that are both created and managed by the Oracle Database server</p>
</li>
</ul>
</div>
</div>
<a id="ADMIN11281"></a>
<div class="props_rev_3"><a id="GUID-98A05D29-DD80-4D87-9615-76CBCF8FE694"></a>
<h2 id="ADMIN-GUID-98A05D29-DD80-4D87-9615-76CBCF8FE694" class="sect2"><span class="enumeration_section">10.1</span> What Is a Control File?</h2>
<div>
<p>Every Oracle Database has a <span class="bold">control file</span>, which is a small binary file that records the physical structure of the database.</p>
<p>The control file includes:</p>
<ul style="list-style-type: disc;">
<li>
<p>The database name</p>
</li>
<li>
<p>Names and locations of associated data files and redo log files</p>
</li>
<li>
<p>The timestamp of the database creation</p>
</li>
<li>
<p>The current log sequence number</p>
</li>
<li>
<p>Checkpoint information</p>
</li>
</ul>
<p>The control file must be available for writing by the Oracle Database server whenever the database is open. Without the control file, the database cannot be mounted and recovery is difficult.</p>
<p>The control file of an Oracle Database is created at the same time as the database. By default, at least one copy of the control file is created during database creation. On some operating systems the default is to create multiple copies. You should create two or more copies of the control file during database creation. You can also create control files later, if you lose control files or want to change particular settings in the control files.</p>
</div>
</div>
<a id="ADMIN11282"></a>
<div class="props_rev_3"><a id="GUID-737B0C7F-CED8-4B00-8428-DA11B35F9E9B"></a>
<h2 id="ADMIN-GUID-737B0C7F-CED8-4B00-8428-DA11B35F9E9B" class="sect2"><span class="enumeration_section">10.2</span> Guidelines for Control Files</h2>
<p>You can follow guidelines to manage the control files for a database.</p>
<a id="ADMIN11283"></a>
<div class="props_rev_3"><a id="GUID-BAC5CCC4-A5E4-488E-AC8E-5162FDF1C0F2"></a>
<h3 id="ADMIN-GUID-BAC5CCC4-A5E4-488E-AC8E-5162FDF1C0F2" class="sect3"><span class="enumeration_section">10.2.1</span> Provide File Names for the Control Files</h3>
<div>
<p>You specify control file names using the <code class="codeph">CONTROL_FILES</code> initialization parameter in the database initialization parameter file. The instance recognizes and opens all the listed file during startup, and the instance writes to and maintains all listed control files during database operation.</p>
<p>If you do not specify files for <code class="codeph">CONTROL_FILES</code> before database creation:</p>
<ul style="list-style-type: disc;">
<li>
<p>If you are not using Oracle Managed Files, then the database creates a control file and uses a default file name. The default name is operating system specific.</p>
</li>
<li>
<p>If you are using Oracle Managed Files, then the initialization parameters you set to enable that feature determine the name and location of the control files.</p>
</li>
<li>
<p>If you are using Oracle Automatic Storage Management (Oracle ASM), you can place incomplete Oracle ASM file names in the <code class="codeph">DB_CREATE_FILE_DEST</code> and <code class="codeph">DB_RECOVERY_FILE_DEST</code> initialization parameters. Oracle ASM then automatically creates control files in the appropriate places.</p>
</li>
</ul>
</div>
<div>
<div class="relinfo">
<p><strong>Related Topics</strong></p>
<ul>
<li><a href="control.htm#GUID-325C997D-2EE9-4577-8A9C-BA28F6907799" title="The initial control files of an Oracle Database are created when you issue the CREATE DATABASE statement.">Creating Initial Control Files</a></li>
<li><a href="omf.htm#GUID-4A3C4616-0D81-4BBA-8EAD-FCAA8AD5C15A" title="Oracle Database can manage the files that comprise the database.">Using Oracle Managed Files</a></li>
<li><a class="olink OSTMG94061" target="_blank" href="../OSTMG/GUID-24A04857-F691-433D-AC74-F7C999BE87B1.htm#OSTMG94061"><span class="italic">Oracle Automatic Storage Management Administrator&#39;s Guide</span></a></li>
</ul>
</div>
</div>
</div>
<a id="ADMIN11284"></a>
<div class="props_rev_3"><a id="GUID-A3BC34A1-20A2-46E6-AF52-7E25845EFDC3"></a>
<h3 id="ADMIN-GUID-A3BC34A1-20A2-46E6-AF52-7E25845EFDC3" class="sect3"><span class="enumeration_section">10.2.2</span> Multiplex Control Files on Different Disks</h3>
<div>
<p>Every Oracle Database should have at least two control files, each stored on a different physical disk.</p>
<p>If a control file is damaged due to a disk failure, the associated instance must be shut down. Once the disk drive is repaired, the damaged control file can be restored using the intact copy of the control file from the other disk and the instance can be restarted. In this case, no media recovery is required.</p>
<p>The behavior of multiplexed control files is this:</p>
<ul style="list-style-type: disc;">
<li>
<p>The database writes to all file names listed for the initialization parameter <code class="codeph">CONTROL_FILES</code> in the database initialization parameter file.</p>
</li>
<li>
<p>The database reads only the first file listed in the <code class="codeph">CONTROL_FILES</code> parameter during database operation.</p>
</li>
<li>
<p>If any of the control files become unavailable during database operation, the instance becomes inoperable and should be aborted.</p>
<div class="infobox-note" id="GUID-A3BC34A1-20A2-46E6-AF52-7E25845EFDC3__GUID-3A84AD22-22CA-4E25-8BA9-B1589FBF0AD5">
<p class="notep1">Note:</p>
<p>Oracle strongly recommends that your database has a minimum of two control files and that they are located on separate physical disks.</p>
</div>
</li>
</ul>
<p>One way to multiplex control files is to store a control file copy on every disk drive that stores members of redo log groups, if the redo log is multiplexed. By storing control files in these locations, you minimize the risk that all control files and all groups of the redo log will be lost in a single disk failure.</p>
</div>
</div>
<a id="ADMIN11285"></a>
<div class="props_rev_3"><a id="GUID-BF439503-839A-4F50-A1E9-04754D1AEFBF"></a>
<h3 id="ADMIN-GUID-BF439503-839A-4F50-A1E9-04754D1AEFBF" class="sect3"><span class="enumeration_section">10.2.3</span> Back Up Control Files</h3>
<div>
<p>It is very important that you back up your control files. This is true initially, and every time you change the physical structure of your database.</p>
<p>Such structural changes include:</p>
<ul style="list-style-type: disc;">
<li>
<p>Adding, dropping, or renaming data files</p>
</li>
<li>
<p>Adding or dropping a tablespace, or altering the read/write state of the tablespace</p>
</li>
<li>
<p>Adding or dropping redo log files or groups</p>
</li>
</ul>
<p>The methods for backing up control files are discussed in <span class="q">&#34;<a href="control.htm#GUID-204AF8CF-6C51-4D0F-ADE2-BA804352EA93" title="Use the ALTER DATABASE BACKUP CONTROLFILE statement to back up your control files.">Backing Up Control Files</a>&#34;</span>.</p>
</div>
</div>
<a id="ADMIN11286"></a>
<div class="props_rev_3"><a id="GUID-5A44AEB4-9606-46F2-AF8E-3020B8746E2E"></a>
<h3 id="ADMIN-GUID-5A44AEB4-9606-46F2-AF8E-3020B8746E2E" class="sect3"><span class="enumeration_section">10.2.4</span> Manage the Size of Control Files</h3>
<div>
<p>The main determinants of the size of a control file are the values set for the <code class="codeph">MAXDATAFILES</code>, <code class="codeph">MAXLOGFILES</code>, <code class="codeph">MAXLOGMEMBERS</code>, <code class="codeph">MAXLOGHISTORY</code>, and <code class="codeph">MAXINSTANCES</code> parameters in the <code class="codeph">CREATE DATABASE</code> statement that created the associated database.</p>
<p>Increasing the values of these parameters increases the size of a control file of the associated database.</p>
<div class="infoboxnotealso" id="GUID-5A44AEB4-9606-46F2-AF8E-3020B8746E2E__GUID-644ECE52-7D5F-4A21-AABF-895F0F2548C5">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p>Your operating system specific Oracle documentation contains more information about the maximum control file size.</p>
</li>
<li>
<p><a class="olink SQLRF01204" target="_blank" href="../SQLRF/statements_5005.htm#SQLRF01204"><span class="italic">Oracle Database SQL Language Reference</span></a> for a description of the <code class="codeph">CREATE DATABASE</code> statement</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<a id="ADMIN10064"></a>
<div class="props_rev_3"><a id="GUID-9CBB8320-E2F6-4BDB-9B1C-A7B801F97F73"></a>
<h2 id="ADMIN-GUID-9CBB8320-E2F6-4BDB-9B1C-A7B801F97F73" class="sect2"><span class="enumeration_section">10.3</span> Creating Control Files</h2>
<p>You can create, copy, rename, and relocate control files.</p>
<a id="ADMIN11287"></a>
<div class="props_rev_3"><a id="GUID-325C997D-2EE9-4577-8A9C-BA28F6907799"></a>
<h3 id="ADMIN-GUID-325C997D-2EE9-4577-8A9C-BA28F6907799" class="sect3"><span class="enumeration_section">10.3.1</span> Creating Initial Control Files</h3>
<div>
<p>The initial control files of an Oracle Database are created when you issue the <code class="codeph">CREATE DATABASE</code> statement.</p>
<div class="section">
<p>The names of the control files are specified by the <code class="codeph">CONTROL_FILES</code> parameter in the initialization parameter file used during database creation. The file names specified in <code class="codeph">CONTROL_FILES</code> should be fully specified and are operating system specific. The following is an example of a <code class="codeph">CONTROL_FILES</code> initialization parameter:</p>
<pre dir="ltr">CONTROL_FILES = (/u01/oracle/prod/control01.ctl,
                 /u02/oracle/prod/control02.ctl, 
                 /u03/oracle/prod/control03.ctl)
</pre>
<p>If files with the specified names currently exist at the time of database creation, you must specify the <code class="codeph">CONTROLFILE REUSE</code> clause in the <code class="codeph">CREATE DATABASE</code> statement, or else an error occurs. Also, if the size of the old control file differs from the <code class="codeph">SIZE</code> parameter of the new one, you cannot use the <code class="codeph">REUSE</code> clause.</p>
<p>The size of the control file changes between some releases of Oracle Database, as well as when the number of files specified in the control file changes. Configuration parameters such as <code class="codeph">MAXLOGFILES</code>, <code class="codeph">MAXLOGMEMBERS</code>, <code class="codeph">MAXLOGHISTORY</code>, <code class="codeph">MAXDATAFILES</code>, and <code class="codeph">MAXINSTANCES</code> affect control file size.</p>
<p>You can subsequently change the value of the <code class="codeph">CONTROL_FILES</code> initialization parameter to add more control files or to change the names or locations of existing control files.</p>
<div class="infoboxnotealso" id="GUID-325C997D-2EE9-4577-8A9C-BA28F6907799__GUID-E3B9779B-2045-428C-926F-47D8D1392C66">
<p class="notep1">See Also:</p>
<p>Your operating system specific Oracle documentation contains more information about specifying control files.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11288"></a>
<div class="props_rev_3"><a id="GUID-9C41ADFB-5A26-4FFB-8582-41A33B2F5C53"></a>
<h3 id="ADMIN-GUID-9C41ADFB-5A26-4FFB-8582-41A33B2F5C53" class="sect3"><span class="enumeration_section">10.3.2</span> Creating Additional Copies, Renaming, and Relocating Control Files</h3>
<div>
<p>You can create an additional control file copy for multiplexing by copying an existing control file to a new location and adding the file name to the list of control files.</p>
<div class="section">
<p>Similarly, you rename an existing control file by copying the file to its new name or location, and changing the file name in the control file list. In both cases, to guarantee that control files do not change during the procedure, shut down the database before copying the control file.</p>
<p>To add a multiplexed copy of the current control file or to rename a control file:</p>
</div>
<!-- class="section" -->
<ol>
<li><span>Shut down the database.</span></li>
<li><span>Copy an existing control file to a new location, using operating system commands.</span></li>
<li><span>Edit the <code class="codeph">CONTROL_FILES</code> parameter in the database initialization parameter file to add the new control file name, or to change the existing control file name.</span></li>
<li><span>Restart the database.</span></li>
</ol>
</div>
</div>
<a id="ADMIN11289"></a>
<div class="props_rev_3"><a id="GUID-9B2E206A-C7E0-4409-9EE2-7501F2BDB696"></a>
<h3 id="ADMIN-GUID-9B2E206A-C7E0-4409-9EE2-7501F2BDB696" class="sect3"><span class="enumeration_section">10.3.3</span> Creating New Control Files</h3>
<p>You can create new control files when all of the control files for the database have been permanently damaged and you do not have a control file backup or when you want to change the database name.</p>
<a id="ADMIN11290"></a>
<div class="props_rev_3"><a id="GUID-553F209C-EE30-4637-8344-BB26FE3AA088"></a>
<h4 id="ADMIN-GUID-553F209C-EE30-4637-8344-BB26FE3AA088" class="sect4"><span class="enumeration_section">10.3.3.1</span> When to Create New Control Files</h4>
<div>
<p>You must create new control files in certain situations.</p>
<p>It is necessary for you to create new control files in the following situations:</p>
<ul style="list-style-type: disc;">
<li>
<p>All control files for the database have been permanently damaged and you do not have a control file backup.</p>
</li>
<li>
<p>You want to change the database name.</p>
<p>For example, you would change a database name if it conflicted with another database name in a distributed environment.</p>
<div class="infobox-note" id="GUID-553F209C-EE30-4637-8344-BB26FE3AA088__GUID-4780F592-87EC-476C-9248-48D6904796AF">
<p class="notep1">Note:</p>
<p>You can change the database name and DBID (internal database identifier) using the DBNEWID utility. See <a class="olink SUTIL014" target="_blank" href="../SUTIL/GUID-D138A757-6A2A-41A2-B722-A98708C5F5AD.htm#SUTIL014"><span class="italic">Oracle Database Utilities</span></a> for information about using this utility.</p>
</div>
</li>
</ul>
</div>
</div>
<a id="ADMIN11291"></a>
<div class="props_rev_3"><a id="GUID-E4677C95-CDBE-4FB5-9A9E-A227B3547FAE"></a>
<h4 id="ADMIN-GUID-E4677C95-CDBE-4FB5-9A9E-A227B3547FAE" class="sect4"><span class="enumeration_section">10.3.3.2</span> The CREATE CONTROLFILE Statement</h4>
<div>
<p>You can create a new control file for a database using the <code class="codeph">CREATE CONTROLFILE</code> statement.</p>
<p>The following statement creates a new control file for the <code class="codeph">prod</code> database (a database that formerly used a different database name):</p>
<pre dir="ltr">CREATE CONTROLFILE
   SET DATABASE prod
   LOGFILE GROUP 1 (&#39;/u01/oracle/prod/redo01_01.log&#39;, 
                    &#39;/u01/oracle/prod/redo01_02.log&#39;),
           GROUP 2 (&#39;/u01/oracle/prod/redo02_01.log&#39;, 
                    &#39;/u01/oracle/prod/redo02_02.log&#39;),
           GROUP 3 (&#39;/u01/oracle/prod/redo03_01.log&#39;, 
                    &#39;/u01/oracle/prod/redo03_02.log&#39;) 
   RESETLOGS
   DATAFILE &#39;/u01/oracle/prod/system01.dbf&#39; SIZE 3M,
            &#39;/u01/oracle/prod/rbs01.dbs&#39; SIZE 5M,
            &#39;/u01/oracle/prod/users01.dbs&#39; SIZE 5M,
            &#39;/u01/oracle/prod/temp01.dbs&#39; SIZE 5M
   MAXLOGFILES 50
   MAXLOGMEMBERS 3
   MAXLOGHISTORY 400
   MAXDATAFILES 200
   MAXINSTANCES 6
   ARCHIVELOG;
</pre>
<div class="infobox-note" id="GUID-E4677C95-CDBE-4FB5-9A9E-A227B3547FAE__GUID-BC3E24FA-0E90-4B4F-BEFD-899B87FEC7FA">
<p class="notep1">Note:</p>
<ul style="list-style-type: disc;">
<li>
<p>The <code class="codeph">CREATE CONTROLFILE</code> statement can potentially damage specified data files and redo log files. Omitting a file name can cause loss of the data in that file, or loss of access to the entire database. Use caution when issuing this statement and be sure to follow the instructions in <span class="q">&#34;<a href="control.htm#GUID-3F2B3E3B-F53C-41C9-A902-3CABFCF4EB40" title="You can create new control files for your database.">Creating New Control Files</a>&#34;</span>.</p>
</li>
<li>
<p>If the database had forced logging enabled before creating the new control file, and you want it to continue to be enabled, then you must specify the <code class="codeph">FORCE LOGGING</code> clause in the <code class="codeph">CREATE CONTROLFILE</code> statement. See <span class="q">&#34;<a href="create.htm#GUID-ACEA5B83-D70F-4F30-A85B-3030248F597B" title="Some data definition language statements (such as CREATE TABLE) allow the NOLOGGING clause, which causes some database operations not to generate redo records in the database redo log. The NOLOGGING setting can speed up operations that can be easily recovered outside of the database recovery mechanisms, but it can negatively affect media recovery and standby databases.">Specifying FORCE LOGGING Mode</a>&#34;</span>.</p>
</li>
</ul>
</div>
<div class="infoboxnotealso" id="GUID-E4677C95-CDBE-4FB5-9A9E-A227B3547FAE__GUID-FFD0F74A-EED9-42D4-8989-6257436AA6CC">
<p class="notep1">See Also:</p>
<p><a class="olink SQLRF01203" target="_blank" href="../SQLRF/statements_5004.htm#SQLRF01203"><span class="italic">Oracle Database SQL Language Reference</span></a> describes the complete syntax of the <code class="codeph">CREATE CONTROLFILE</code> statement</p>
</div>
</div>
</div>
<a id="ADMIN11292"></a>
<div class="props_rev_3"><a id="GUID-3F2B3E3B-F53C-41C9-A902-3CABFCF4EB40"></a>
<h4 id="ADMIN-GUID-3F2B3E3B-F53C-41C9-A902-3CABFCF4EB40" class="sect4"><span class="enumeration_section">10.3.3.3</span> Creating New Control Files</h4>
<div>
<p>You can create new control files for your database.</p>
<div class="section">
<p>Complete the following steps to create a new control file.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Make a list of all data files and redo log files of the database.</span>
<div>
<p>If you follow recommendations for control file backups as discussed in <span class="q">&#34;<a href="control.htm#GUID-204AF8CF-6C51-4D0F-ADE2-BA804352EA93" title="Use the ALTER DATABASE BACKUP CONTROLFILE statement to back up your control files.">Backing Up Control Files</a>&#34;</span> , you will already have a list of data files and redo log files that reflect the current structure of the database. However, if you have no such list, executing the following statements will produce one.</p>
<pre dir="ltr">SELECT MEMBER FROM V$LOGFILE;
SELECT NAME FROM V$DATAFILE; 
SELECT VALUE FROM V$PARAMETER WHERE NAME = &#39;control_files&#39;;
</pre>
<p>If you have no such lists and your control file has been damaged so that the database cannot be opened, try to locate all of the data files and redo log files that constitute the database. Any files not specified in step <a href="control.htm#GUID-3F2B3E3B-F53C-41C9-A902-3CABFCF4EB40__i1006387">5</a> are not recoverable once a new control file has been created. Moreover, if you omit any of the files that comprise the <code class="codeph">SYSTEM</code> tablespace, you might not be able to recover the database.</p>
</div>
</li>
<li class="stepexpand"><span>Shut down the database.</span>
<div>
<p>If the database is open, shut down the database normally if possible. Use the <code class="codeph">IMMEDIATE</code> or <code class="codeph">ABORT</code> clauses only as a last resort.</p>
</div>
</li>
<li class="stepexpand" id="GUID-3F2B3E3B-F53C-41C9-A902-3CABFCF4EB40__i1006381"><span>Back up all data files and redo log files of the database.</span></li>
<li class="stepexpand" id="GUID-3F2B3E3B-F53C-41C9-A902-3CABFCF4EB40__i1006383"><span>Start up a new instance, but do not mount or open the database:</span>
<div>
<pre dir="ltr">STARTUP NOMOUNT
</pre></div>
</li>
<li class="stepexpand" id="GUID-3F2B3E3B-F53C-41C9-A902-3CABFCF4EB40__i1006387"><span>Create a new control file for the database using the <code class="codeph">CREATE CONTROLFILE</code> statement.</span>
<div>
<p>When creating a new control file, specify the <code class="codeph">RESETLOGS</code> clause if you have lost any redo log groups in addition to control files. In this case, you will need to recover from the loss of the redo logs (step <a href="control.htm#GUID-3F2B3E3B-F53C-41C9-A902-3CABFCF4EB40__i1006408">8</a>). You must specify the <code class="codeph">RESETLOGS</code> clause if you have renamed the database. Otherwise, select the <code class="codeph">NORESETLOGS</code> clause.</p>
</div>
</li>
<li class="stepexpand"><span>Store a backup of the new control file on an offline storage device. See <span class="q">&#34;<a href="control.htm#GUID-204AF8CF-6C51-4D0F-ADE2-BA804352EA93" title="Use the ALTER DATABASE BACKUP CONTROLFILE statement to back up your control files.">Backing Up Control Files</a>&#34;</span> for instructions for creating a backup.</span></li>
<li class="stepexpand"><span>Edit the <code class="codeph">CONTROL_FILES</code> initialization parameter for the database to indicate all of the control files now part of your database as created in step <a href="control.htm#GUID-3F2B3E3B-F53C-41C9-A902-3CABFCF4EB40__i1006387">5</a> (not including the backup control file). If you are renaming the database, edit the <code class="codeph">DB_NAME</code> parameter in your instance parameter file to specify the new name.</span></li>
<li class="stepexpand" id="GUID-3F2B3E3B-F53C-41C9-A902-3CABFCF4EB40__i1006408"><span>Recover the database if necessary. If you are not recovering the database, skip to step <a href="control.htm#GUID-3F2B3E3B-F53C-41C9-A902-3CABFCF4EB40__i1006418">9</a>.</span>
<div>
<p>If you are creating the control file as part of recovery, recover the database. If the new control file was created using the <code class="codeph">NORESETLOGS</code> clause, you can recover the database with complete, closed database recovery.</p>
<p>If the new control file was created using the <code class="codeph">RESETLOGS</code> clause, you must specify <code class="codeph">USING BACKUP CONTROL FILE</code>. If you have lost online redo logs, archived redo log files, or data files, use the procedures for recovering those files.</p>
<div class="infoboxnotealso" id="GUID-3F2B3E3B-F53C-41C9-A902-3CABFCF4EB40__GUID-6517F008-0197-4109-AC4E-46552D36574A">
<p class="notep1">See Also:</p>
<p><a class="olink BRADV" target="_blank" href="../BRADV/toc.htm"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> for information about recovering your database and methods of recovering a lost control file</p>
</div>
</div>
</li>
<li class="stepexpand" id="GUID-3F2B3E3B-F53C-41C9-A902-3CABFCF4EB40__i1006418"><span>Open the database using one of the following methods:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p>If you did not perform recovery, or you performed complete, closed database recovery in step <a href="control.htm#GUID-3F2B3E3B-F53C-41C9-A902-3CABFCF4EB40__i1006408">8</a>, open the database normally.</p>
<pre dir="ltr">ALTER DATABASE OPEN; 
</pre></li>
<li>
<p>If you specified <code class="codeph">RESETLOGS</code> when creating the control file, use the <code class="codeph">ALTER DATABASE</code> statement, indicating <code class="codeph">RESETLOGS</code>.</p>
<pre dir="ltr">ALTER DATABASE OPEN RESETLOGS;
</pre></li>
</ul>
</div>
</li>
</ol>
<div class="section">
<p>The database is now open and available for use.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<a id="ADMIN11293"></a>
<div class="props_rev_3"><a id="GUID-4D4D22BE-1619-46BD-B22C-7409B35923AA"></a>
<h2 id="ADMIN-GUID-4D4D22BE-1619-46BD-B22C-7409B35923AA" class="sect2"><span class="enumeration_section">10.4</span> Troubleshooting After Creating Control Files</h2>
<p>After issuing the <code class="codeph">CREATE CONTROLFILE</code> statement, you may encounter some errors.</p>
<a id="ADMIN11294"></a>
<div class="props_rev_3"><a id="GUID-5414BE14-EC3C-47C6-ABAA-8130F482DD35"></a>
<h3 id="ADMIN-GUID-5414BE14-EC3C-47C6-ABAA-8130F482DD35" class="sect3"><span class="enumeration_section">10.4.1</span> Checking for Missing or Extra Files</h3>
<div>
<p>After creating a new control file and using it to open the database, check the alert log to see if the database has detected inconsistencies between the data dictionary and the control file, such as a data file in the data dictionary includes that the control file does not list.</p>
<div class="section">
<p>If a data file exists in the data dictionary but not in the new control file, the database creates a placeholder entry in the control file under the name <code class="codeph">MISSING</code><span class="italic"><code class="codeph">nnnn</code></span>, where <span class="italic"><code class="codeph">nnnn</code></span> is the file number in decimal. <code class="codeph">MISSING</code><span class="italic"><code class="codeph">nnnn</code></span> is flagged in the control file as being offline and requiring media recovery.</p>
<p>If the actual data file corresponding to <code class="codeph">MISSING</code><span class="italic"><code class="codeph">nnnn</code></span> is read-only or offline normal, then you can make the data file accessible by renaming <code class="codeph">MISSING</code><span class="italic"><code class="codeph">nnnn</code></span> to the name of the actual data file. If <code class="codeph">MISSING</code><span class="italic"><code class="codeph">nnnn</code></span> corresponds to a data file that was not read-only or offline normal, then you cannot use the rename operation to make the data file accessible, because the data file requires media recovery that is precluded by the results of <code class="codeph">RESETLOGS</code>. In this case, you must drop the tablespace containing the data file.</p>
<p>Conversely, if a data file listed in the control file is not present in the data dictionary, then the database removes references to it from the new control file. In both cases, the database includes an explanatory message in the alert log to let you know what was found.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11295"></a>
<div class="props_rev_3"><a id="GUID-61DB4CED-65B5-41AF-8ECD-DDFDA0771B08"></a>
<h3 id="ADMIN-GUID-61DB4CED-65B5-41AF-8ECD-DDFDA0771B08" class="sect3"><span class="enumeration_section">10.4.2</span> Handling Errors During CREATE CONTROLFILE</h3>
<div>
<p>If Oracle Database sends you an error when you attempt to mount and open the database after creating a new control file, the most likely cause is that you omitted a file from the <code class="codeph">CREATE CONTROLFILE</code> statement or included one that should not have been listed.</p>
<div class="section">
<p>Typically, the error is <code class="codeph">ORA-01173</code>, <code class="codeph">ORA-01176</code>, <code class="codeph">ORA-01177</code>, <code class="codeph">ORA-01215</code>, or <code class="codeph">ORA-01216</code>. In this case, you should restore the files you backed up in <span class="q">&#34;<a href="control.htm#GUID-3F2B3E3B-F53C-41C9-A902-3CABFCF4EB40" title="You can create new control files for your database.">Creating New Control Files</a>&#34;</span> and repeat the procedure in that task, using the correct file names.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="ADMIN11296"></a>
<div class="props_rev_3"><a id="GUID-204AF8CF-6C51-4D0F-ADE2-BA804352EA93"></a>
<h2 id="ADMIN-GUID-204AF8CF-6C51-4D0F-ADE2-BA804352EA93" class="sect2"><span class="enumeration_section">10.5</span> Backing Up Control Files</h2>
<div>
<p>Use the <code class="codeph">ALTER DATABASE BACKUP CONTROLFILE</code> statement to back up your control files.</p>
<div class="section">
<p>You have two options:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Back up the control file to a binary file (duplicate of existing control file) using the following statement:</p>
<pre dir="ltr">ALTER DATABASE BACKUP CONTROLFILE TO &#39;/oracle/backup/control.bkp&#39;;
</pre></li>
<li>
<p>Produce SQL statements that can later be used to re-create your control file:</p>
<pre dir="ltr">ALTER DATABASE BACKUP CONTROLFILE TO TRACE;
</pre>
<p>This command writes a SQL script to a trace file where it can be captured and edited to reproduce the control file. View the alert log to determine the name and location of the trace file.</p>
<div class="infoboxnotealso" id="GUID-204AF8CF-6C51-4D0F-ADE2-BA804352EA93__GUID-71BA9E7D-632D-4D09-9177-46591148CE5F">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink BRADV89517" target="_blank" href="../BRADV/rcmbckba.htm#BRADV89517"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> for more information on backing up your control files</p>
</li>
<li>
<p><span class="q">&#34;<a href="diag.htm#GUID-D6512D97-FFC3-4BF0-BF50-1F77D150C922" title="You can view the alert log with a text editor, with Cloud Control, or with the ADRCI utility.">Viewing the Alert Log</a>&#34;</span></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11297"></a>
<div class="props_rev_3"><a id="GUID-D6662264-5149-4394-BE10-28C3047A8343"></a>
<h2 id="ADMIN-GUID-D6662264-5149-4394-BE10-28C3047A8343" class="sect2"><span class="enumeration_section">10.6</span> Recovering a Control File Using a Current Copy</h2>
<p>You can recover your control file from a current backup or from a multiplexed copy.</p>
<a id="ADMIN11298"></a>
<div class="props_rev_3"><a id="GUID-EF0BDE73-74D7-48E7-89E1-9CA09000C58E"></a>
<h3 id="ADMIN-GUID-EF0BDE73-74D7-48E7-89E1-9CA09000C58E" class="sect3"><span class="enumeration_section">10.6.1</span> Recovering from Control File Corruption Using a Control File Copy</h3>
<div>
<p>If a control file becomes corrupted, then you can recover it using a control file copy.</p>
<div class="section">
<p>This method assumes that one of the control files specified in the <code class="codeph">CONTROL_FILES</code> parameter is corrupted, that the control file directory is still accessible, and that you have a multiplexed copy of the control file.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>With the instance shut down, use an operating system command to overwrite the bad control file with a good copy:</span>
<div>
<pre dir="ltr">% cp /u03/oracle/prod/control03.ctl  /u02/oracle/prod/control02.ctl
</pre></div>
</li>
<li class="stepexpand"><span>Start SQL*Plus and open the database:</span>
<div>
<pre dir="ltr">SQL&gt; STARTUP
</pre></div>
</li>
</ol>
</div>
</div>
<a id="ADMIN11299"></a>
<div class="props_rev_3"><a id="GUID-1D5E1025-2FD5-4A72-B250-1F99CE36AAA8"></a>
<h3 id="ADMIN-GUID-1D5E1025-2FD5-4A72-B250-1F99CE36AAA8" class="sect3"><span class="enumeration_section">10.6.2</span> Recovering from Permanent Media Failure Using a Control File Copy</h3>
<div>
<p>If there is permanent media failure, then you can recover by using a control file copy.</p>
<div class="section">
<p>This method assumes that one of the control files specified in the <code class="codeph">CONTROL_FILES</code> parameter is inaccessible due to a permanent media failure and that you have a multiplexed copy of the control file.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>With the instance shut down, use an operating system command to copy the current copy of the control file to a new, accessible location:</span>
<div>
<pre dir="ltr">% cp /u01/oracle/prod/control01.ctl  /u04/oracle/prod/control03.ctl
</pre></div>
</li>
<li class="stepexpand"><span>Edit the <code class="codeph">CONTROL_FILES</code> parameter in the initialization parameter file to replace the bad location with the new location:</span>
<div>
<pre dir="ltr">CONTROL_FILES = (/u01/oracle/prod/control01.ctl,
                 /u02/oracle/prod/control02.ctl, 
                 /u04/oracle/prod/control03.ctl)
</pre></div>
</li>
<li class="stepexpand"><span>Start SQL*Plus and open the database:</span>
<div>
<pre dir="ltr">SQL&gt; STARTUP
</pre></div>
</li>
</ol>
<div class="section">
<p>If you have multiplexed control files, you can get the database started up quickly by editing the <code class="codeph">CONTROL_FILES</code> initialization parameter. Remove the bad control file from <code class="codeph">CONTROL_FILES</code> setting and you can restart the database immediately. Then you can perform the reconstruction of the bad control file and at some later time shut down and restart the database after editing the <code class="codeph">CONTROL_FILES</code> initialization parameter to include the recovered control file.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="ADMIN11300"></a>
<div class="props_rev_3"><a id="GUID-AB003834-2392-4B99-ADBD-497636A2E096"></a>
<h2 id="ADMIN-GUID-AB003834-2392-4B99-ADBD-497636A2E096" class="sect2"><span class="enumeration_section">10.7</span> Dropping Control Files</h2>
<div>
<p>You can drop control files, but the database should have at least two control files at all times.</p>
<div class="section">
<p>You want to drop control files from the database, for example, if the location of a control file is no longer appropriate.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Shut down the database.</span></li>
<li class="stepexpand"><span>Edit the <code class="codeph">CONTROL_FILES</code> parameter in the database initialization parameter file to delete the old control file name.</span></li>
<li class="stepexpand"><span>Restart the database.</span>
<div>
<div class="infobox-note" id="GUID-AB003834-2392-4B99-ADBD-497636A2E096__GUID-4FFA5680-6F59-4A66-A0C0-8B1F45BA674C">
<p class="notep1">Note:</p>
<p>This operation does not physically delete the unwanted control file from the disk. Use operating system commands to delete the unnecessary file after you have dropped the control file from the database.</p>
</div>
</div>
</li>
</ol>
</div>
</div>
<a id="ADMIN11301"></a>
<div class="props_rev_3"><a id="GUID-B0AB9343-301E-45C8-AACC-5BC9C85CB2CD"></a>
<h2 id="ADMIN-GUID-B0AB9343-301E-45C8-AACC-5BC9C85CB2CD" class="sect2"><span class="enumeration_section">10.8</span> Control Files Data Dictionary Views</h2>
<div>
<p>You can query a set of data dictionary views for information about control files.</p>
<div class="section">
<p>The following views display information about control files:</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-B0AB9343-301E-45C8-AACC-5BC9C85CB2CD__GUID-694149CE-7943-4477-8C11-F12B23E509CC">
<table class="cellalignment1849" summary="The first column lists views that display information about control files. The second column describes each view.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1917" id="d99685e2323">View</th>
<th class="cellalignment1947" id="d99685e2326">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1918" id="d99685e2331" headers="d99685e2323">
<p><code class="codeph">V$DATABASE</code></p>
</td>
<td class="cellalignment1948" headers="d99685e2331 d99685e2326">
<p>Displays database information from the control file</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1918" id="d99685e2340" headers="d99685e2323">
<p><code class="codeph">V$CONTROLFILE</code></p>
</td>
<td class="cellalignment1948" headers="d99685e2340 d99685e2326">
<p>Lists the names of control files</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1918" id="d99685e2348" headers="d99685e2323">
<p><code class="codeph">V$CONTROLFILE_RECORD_SECTION</code></p>
</td>
<td class="cellalignment1948" headers="d99685e2348 d99685e2326">
<p>Displays information about control file record sections</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1918" id="d99685e2356" headers="d99685e2323">
<p><code class="codeph">V$PARAMETER</code></p>
</td>
<td class="cellalignment1948" headers="d99685e2356 d99685e2326">
<p>Displays the names of control files as specified in the <code class="codeph">CONTROL_FILES</code> initialization parameter</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<p>This example lists the names of the control files.</p>
<pre dir="ltr">SQL&gt; SELECT NAME FROM V$CONTROLFILE;

NAME
-------------------------------------
/u01/oracle/prod/control01.ctl
/u02/oracle/prod/control02.ctl 
/u03/oracle/prod/control03.ctl
</pre></div>
<!-- class="section" --></div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1842">
<tr>
<td class="cellalignment1854">
<table class="cellalignment1847">
<tr>
<td class="cellalignment1846"><a href="part2.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1846"><a href="onlineredo.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2001, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1856">
<table class="cellalignment1845">
<tr>
<td class="cellalignment1846"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1846"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1846"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1846"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1846"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1846"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>