<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-176"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Creating%20and%20Removing%20PDBs%20with%20SQL%2APlus"></a><title>Creating and Removing PDBs with SQL*Plus</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="description" content="You can create PDBs in several different ways, including using the seed, cloning an existing PDB or non-CDB, and plugging in an unplugged PDB. You can also remove PDBs from a CDB."/>
<meta name="keywords" content="CDBs, plugging in PDBs, methods for, PDBs, plugging in, CREATE PLUGGABLE DATABASE statement, STORAGE clause, file locations, PATH_PREFIX clause, source file locations, SOURCE_FILE_NAME_CONVERT clause, SOURCE_FILE_DIRECTORY clause, SERVICE_NAME_CONVERT clause, USER_TABLESPACES clause, logging_clause, STANDBYS clause, NO DATA clause, preparing for, creating using the seed, cloning, non-CDBs, cloning as PDBs, SNAPSHOT COPY clause, CLONEDB parameter, moving non-CDBs into, moving to PDBs, DESCRIBE procedure, unplugging PDBs, unplugging, ALTER PLUGGABLE DATABASE statement, UNPLUG INTO clause, dropping, DROP PLUGGABLE DATABASE statement"/>
<meta name="dcterms.created" content="2017-07-10T12:24:11Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Administrator&rsquo;s Guide"/>
<meta name="dcterms.identifier" content="E41484-15"/>
<meta name="dcterms.isVersionOf" content="ADMIN"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2001, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="cdb_create.htm" title="Previous" type="text/html"/>
<link rel="Next" href="cdb_plug_em.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41484-15.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-9A250D93-5B3B-4643-BE85-F32CC7B0E413"></a> <span id="PAGE" style="display:none;">48/59</span> <!-- End Header -->
<a id="ADMIN13549"></a>
<h1 id="ADMIN-GUID-9A250D93-5B3B-4643-BE85-F32CC7B0E413" class="sect1"><span class="enumeration_chapter">38</span> Creating and Removing PDBs with SQL*Plus</h1>
<p>You can create PDBs in several different ways, including using the seed, cloning an existing PDB or non-CDB, and plugging in an unplugged PDB. You can also remove PDBs from a CDB.</p>
<a id="ADMIN13550"></a>
<div class="props_rev_3"><a id="GUID-F6C4F50C-E31C-450A-A2F4-8903515DDEFE"></a>
<h2 id="ADMIN-GUID-F6C4F50C-E31C-450A-A2F4-8903515DDEFE" class="sect2"><span class="enumeration_section">38.1</span> About Creating and Removing PDBs</h2>
<div>
<p>You can create a pluggable database (PDB) in a multitenant container database (CDB) by using the seed, cloning an existing PDB or non-CDB, plugging an unplugged PDB into a CDB, or using a non-CDB. You can remove a PDB from a CDB by unplugging the PDB or dropping the PDB.</p>
<div class="infobox-note" id="GUID-F6C4F50C-E31C-450A-A2F4-8903515DDEFE__GUID-0B734A59-1BD7-4F82-95F9-05BAAA34FDF5">
<p class="notep1">Note:</p>
<ul style="list-style-type: disc;">
<li>
<p>This chapter discusses using SQL statements to create and remove PDBs. An easier way to create and remove PDBs is with the graphical user interface of Database Configuration Assistant (DBCA).</p>
</li>
<li>
<p>In Oracle Database 12<span class="italic">c</span> Release 1 (12.1), a CDB can contain up to 253 PDBs, including the seed.</p>
</li>
</ul>
</div>
<div class="infoboxnotealso" id="GUID-F6C4F50C-E31C-450A-A2F4-8903515DDEFE__GUID-96A816C7-F8A0-4CC1-9F60-98D3953F4250">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="cdb_intro.htm#GUID-A1F3A63E-3BE5-4B80-A053-46D9EF71D45E" title="You can use the Oracle Multitenant option to configure and manage a multitenant environment. The multitenant architecture enables an Oracle database to function as a multitenant container database (CDB) that includes zero, one, or many customer-created pluggable databases (PDBs). A PDB is a portable collection of schemas, schema objects, and nonschema objects that appears to an Oracle Net client as a non-CDB. All Oracle databases before Oracle Database 12c were non-CDBs.">About a Multitenant Environment</a>&#34;</span></p>
</li>
<li>
<p><a class="olink ADMQS023" target="_blank" href="../ADMQS/GUID-2A1B1AF2-CC36-405A-89EB-72E7A33F7E2B.htm#ADMQS023"><span class="italic">Oracle Database 2 Day DBA</span></a> and the DBCA online help for more information about DBCA</p>
</li>
</ul>
</div>
</div>
<a id="ADMIN13849"></a><a id="ADMIN14085"></a><a id="ADMIN13551"></a>
<div class="props_rev_3"><a id="GUID-BAD70A3D-0C46-4392-BCC9-B17413A0BA21"></a>
<h3 id="ADMIN-GUID-BAD70A3D-0C46-4392-BCC9-B17413A0BA21" class="sect3"><span class="enumeration_section">38.1.1</span> Techniques for Creating a PDB</h3>
<div>
<p>You can use various techniques to create a PDB.</p>
<p>Creating a PDB is the process of associating the PDB with a CDB. You create a PDB when you want to use the PDB as part of the CDB.</p>
<p><a href="cdb_plug.htm#GUID-BAD70A3D-0C46-4392-BCC9-B17413A0BA21__CEGEGFCB" title="This table decsribes each technique for plugging in a pluggable database and provides a link for more information about each technique.">Table 38-1</a> describes the techniques that you can use to create a PDB.</p>
<div class="tblformalwide" id="GUID-BAD70A3D-0C46-4392-BCC9-B17413A0BA21__CEGEGFCB">
<p class="titleintable">Table 38-1 Techniques for Creating a PDB</p>
<table class="cellalignment1880" title="Techniques for Creating a PDB" summary="This table decsribes each technique for plugging in a pluggable database and provides a link for more information about each technique.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1897" id="d264795e244">Technique</th>
<th class="cellalignment1898" id="d264795e247">Description</th>
<th class="cellalignment1897" id="d264795e250">More Information</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1899" id="d264795e255" headers="d264795e244">
<p>Create a PDB by using the seed</p>
</td>
<td class="cellalignment1900" headers="d264795e255 d264795e247">
<p>Create a PDB in a CDB using the files of the seed. This technique copies the files associated with the seed to a new location and associates the copied files with the new PDB.</p>
</td>
<td class="cellalignment1899" headers="d264795e255 d264795e250">
<p><span class="q">&#34;<a href="cdb_plug.htm#GUID-CCA938BD-52BE-422C-86AF-576D3E02B96B" title="You can use the CREATE PLUGGABLE DATABASE statement to create a PDB in a CDB using the files of the seed.">Creating a PDB Using the Seed</a>&#34;</span></p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1899" id="d264795e280" headers="d264795e244">
<p>Create a PDB by cloning an existing PDB or non-CDB</p>
</td>
<td class="cellalignment1900" headers="d264795e280 d264795e247">
<p>Create a PDB by cloning a source PDB or non-CDB and plugging the clone into the CDB. A source can be a PDB in the local CDB, a PDB in a remote CDB, or a non-CDB. This technique copies the files associated with the source to a new location and associates the copied files with the new PDB.</p>
</td>
<td class="cellalignment1899" headers="d264795e280 d264795e250">
<p><span class="q">&#34;<a href="cdb_plug.htm#GUID-05702CEB-A43C-452C-8081-4CA68DDA8007" title="You can create a PDB by cloning a local PDB, a remote PDB, or a non-CDB.">Creating a PDB by Cloning an Existing PDB or Non-CDB</a>&#34;</span></p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1899" id="d264795e296" headers="d264795e244">
<p>Create a PDB by plugging an unplugged PDB into a CDB</p>
</td>
<td class="cellalignment1900" headers="d264795e296 d264795e247">
<p>Create a PDB by using the XML metadata file that describes the PDB and the files associated with the PDB to plug it into the CDB.</p>
</td>
<td class="cellalignment1899" headers="d264795e296 d264795e250">
<p><span class="q">&#34;<a href="cdb_plug.htm#GUID-3132C4E5-8734-458B-8B0C-EFC77A45FFA3" title="You can create a PDB by plugging an unplugged PDB into a CDB.">Creating a PDB by Plugging an Unplugged PDB into a CDB</a>&#34;</span></p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1899" id="d264795e312" headers="d264795e244">
<p>Create a PDB by using a non-CDB</p>
</td>
<td class="cellalignment1900" headers="d264795e312 d264795e247">
<p>Create a PDB by moving a non-CDB into a PDB. You can use the <code class="codeph">DBMS_PDB</code> package to create an unplugged PDB from an Oracle Database 12<span class="italic">c</span> non-CDB. You can then plug the unplugged PDB into the CDB.</p>
</td>
<td class="cellalignment1899" headers="d264795e312 d264795e250">
<p><span class="q">&#34;<a href="cdb_plug.htm#GUID-F68E6FE9-919B-4665-95F7-785E69E07264" title="You can move a non-CDB into a PDB.">Creating a PDB Using a Non-CDB</a>&#34;</span></p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>All of the techniques described in <a href="cdb_plug.htm#GUID-BAD70A3D-0C46-4392-BCC9-B17413A0BA21__CEGEGFCB" title="This table decsribes each technique for plugging in a pluggable database and provides a link for more information about each technique.">Table 38-1</a> use the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement to create a PDB. These techniques fall into two main categories: copying and plugging in. <a href="cdb_plug.htm#GUID-BAD70A3D-0C46-4392-BCC9-B17413A0BA21__CEGBEGGJ">Figure 38-1</a> depicts the options for creating a PDB:</p>
<div class="figure" id="GUID-BAD70A3D-0C46-4392-BCC9-B17413A0BA21__CEGBEGGJ">
<p class="titleinfigure">Figure 38-1 Options for Creating a PDB</p>
<img width="564" height="272" src="img/GUID-36B25E2A-C8B2-48FE-9E9C-EDA39D0883B4-default.png" alt="Description of Figure 38-1 follows" title="Description of Figure 38-1 follows"/><br/>
<a href="img_text/GUID-36B25E2A-C8B2-48FE-9E9C-EDA39D0883B4-print.htm">Description of &#34;Figure 38-1 Options for Creating a PDB&#34;</a></div>
<!-- class="figure" -->
<p>You can unplug a PDB when you want to plug it into a different CDB. You can unplug or drop a PDB when you no longer need it. An unplugged PDB is not usable until it is plugged into a CDB.</p>
<div class="infobox-note" id="GUID-BAD70A3D-0C46-4392-BCC9-B17413A0BA21__GUID-9C69528B-F9FA-4634-B45F-04726CF60899">
<p class="notep1">Note:</p>
<p>Creating a PDB by cloning a non-CDB is available starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2).</p>
</div>
<div class="infoboxnotealso" id="GUID-BAD70A3D-0C46-4392-BCC9-B17413A0BA21__GUID-90682480-518C-4E28-93A4-4D898E8784BC">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="cdb_plug.htm#GUID-893E1D67-BD95-4757-B862-03AD13AFF722" title="You can unplug a PDB from a CDB.">Unplugging a PDB from a CDB</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="cdb_plug.htm#GUID-6EEAC62B-E7DD-47BA-A62B-1F34B3D9D02E" title="The DROP PLUGGABLE DATABASE statement drops a PDB. You can drop a PDB when you want to move the PDB from one CDB to another or when you no longer need the PDB.">Dropping a PDB</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
</div>
<a id="ADMIN13556"></a>
<div class="props_rev_3"><a id="GUID-59F42929-7237-4371-8934-921B46DB6F31"></a>
<h3 id="ADMIN-GUID-59F42929-7237-4371-8934-921B46DB6F31" class="sect3"><span class="enumeration_section">38.1.2</span> The CREATE PLUGGABLE DATABASE Statement</h3>
<div>
<p>You use the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement to create a PDB. To use this statement, you must understand the clauses for the statement and when to use each clause.</p>
<p>All of the techniques described in <a href="cdb_plug.htm#GUID-BAD70A3D-0C46-4392-BCC9-B17413A0BA21__CEGEGFCB" title="This table decsribes each technique for plugging in a pluggable database and provides a link for more information about each technique.">Table 38-1</a> use this statement.</p>
<div class="infoboxnotealso" id="GUID-59F42929-7237-4371-8934-921B46DB6F31__GUID-0C1DE93B-A23C-49E1-9AC1-B08FFA2DF7AE">
<p class="notep1">See Also:</p>
<p><a class="olink SQLRF55686" target="_blank" href="../SQLRF/statements_6010.htm#SQLRF55686"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement</p>
</div>
</div>
<a id="ADMIN14182"></a><a id="ADMIN14183"></a><a id="ADMIN13560"></a><a id="ADMIN13557"></a>
<div class="props_rev_3"><a id="GUID-55EFBF80-25CF-4C80-8E96-C6BB4134A637"></a>
<h4 id="ADMIN-GUID-55EFBF80-25CF-4C80-8E96-C6BB4134A637" class="sect4"><span class="enumeration_section">38.1.2.1</span> Storage Limits</h4>
<div>
<p>The optional <code class="codeph">STORAGE</code> clause of the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement specifies storage limits for PDBs.</p>
<p>The <code class="codeph">STORAGE</code> clause specifies the amount of storage that can be used by all tablespaces that belong to the PDB. Use <code class="codeph">MAXSIZE</code> and a size clause to specify a limit, or set <code class="codeph">MAXSIZE</code> to <code class="codeph">UNLIMITED</code> to indicate no limit.</p>
<p>If <code class="codeph">STORAGE</code> <code class="codeph">UNLIMITED</code> is set, or if there is no <code class="codeph">STORAGE</code> clause, then there are no storage limits for the PDB.</p>
<p>The following are examples that use the <code class="codeph">STORAGE</code> clause.</p>
<div class="example" id="GUID-55EFBF80-25CF-4C80-8E96-C6BB4134A637__CEGBDDCG">
<p class="titleinexample">Example 38-1 STORAGE Clause That Specifies Storage Limits</p>
<p>This <code class="codeph">STORAGE</code> clause specifies that the storage used by all tablespaces that belong to the PDB must not exceed 2 gigabytes.</p>
<pre dir="ltr">STORAGE (MAXSIZE 2G)
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-55EFBF80-25CF-4C80-8E96-C6BB4134A637__CEGJBFHG">
<p class="titleinexample">Example 38-2 STORAGE Clause That Specifies Unlimited Storage</p>
<p>This <code class="codeph">STORAGE</code> clause specifies unlimited storage for all tablespaces that belong to the PDB.</p>
<pre dir="ltr">STORAGE (MAXSIZE UNLIMITED)
</pre>
<div class="infoboxnotealso" id="GUID-55EFBF80-25CF-4C80-8E96-C6BB4134A637__GUID-2FFC8633-8544-4BB0-9755-9BF6E0FDD169">
<p class="notep1">See Also:</p>
<p><a class="olink SQLRF55694" target="_blank" href="../SQLRF/statements_6010.htm#SQLRF55694"><span class="italic">Oracle Database SQL Language Reference</span></a> for the syntax of the <code class="codeph">STORAGE</code> clause</p>
</div>
</div>
<!-- class="example" --></div>
</div>
<a id="ADMIN13966"></a>
<div class="props_rev_3"><a id="GUID-39D2F826-7460-4439-B410-29E16C0CA0B1"></a>
<h4 id="ADMIN-GUID-39D2F826-7460-4439-B410-29E16C0CA0B1" class="sect4"><span class="enumeration_section">38.1.2.2</span> File Location of the New PDB</h4>
<div>
<p>In the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement, you can specify the locations of files used by the new PDB.</p>
<p>The term &#34;file name&#34; means both the name and the location of a file. The <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement has the following clauses that indicate the file names of the new PDB being created:</p>
<ul style="list-style-type: disc;">
<li>
<p>The <code class="codeph">FILE_NAME_CONVERT</code> clause specifies the names of the PDB&#39;s files after the PDB is created.</p>
<p>Use this clause when the files are not yet at their ultimate destination, and you want to copy or move them during PDB creation. You can use this clause in any <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement.</p>
</li>
<li>
<p>Starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2), the <code class="codeph">CREATE_FILE_DEST</code> clause specifies the default Oracle Managed Files file system directory or Oracle ASM disk group for the PDB&#39;s files.</p>
<p>Use this clause to enable Oracle Managed Files for the new PDB, independent of any Oracle Managed Files default location specified in the root for the CDB. You can use this clause in any <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement.</p>
</li>
</ul>
<p>When necessary, you can use both of these clauses in the same <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement. In addition, the following initialization parameters can control the location of the new PDB&#39;s files:</p>
<ul style="list-style-type: disc;">
<li>
<p>The <code class="codeph">DB_CREATE_FILE_DEST</code> initialization parameter set in the root</p>
<p>This initialization parameter specifies the default location for Oracle Managed Files for the CDB. When this parameter is set in a PDB, it specifies the default location for Oracle Managed Files for the PDB.</p>
</li>
<li>
<p>The <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter</p>
<p>This initialization parameter maps names of existing files to new file names when processing a <code class="codeph">CREATE PLUGGABLE DATABASE</code> statement.</p>
</li>
</ul>
<p>The following table shows the precedence order when both clauses are used in the same <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement, and both initialization parameters are set. For each clause and initialization parameter, the table also shows whether the files created by the <code class="codeph">CREATE PLUGGABLE DATABASE</code> statement will use Oracle Managed Files or not.</p>
<div class="tblformal" id="GUID-39D2F826-7460-4439-B410-29E16C0CA0B1__GUID-D1C01B5C-19ED-4124-9C21-6415055443EE">
<p class="titleintable">Table 38-2 Summary of File Location Clauses and Initialization Parameters</p>
<table class="cellalignment1980" title="Summary of File Location Clauses and Initialization Parameters" summary="This table lists each clause and initialization parameter, the precedence order of each, and whether the files will use Oracle Managed Files for each.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1967" id="d264795e827">Clause or Initialization Parameter</th>
<th class="cellalignment1967" id="d264795e829">Precedence Order</th>
<th class="cellalignment1967" id="d264795e831">Will the Files Created by CREATE PLUGGABLE DATABASE Use Oracle Managed Files?</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1843" id="d264795e835" headers="d264795e827"><code class="codeph">FILE_NAME_CONVERT</code> clause</td>
<td class="cellalignment1843" headers="d264795e835 d264795e829">1</td>
<td class="cellalignment1843" headers="d264795e835 d264795e831">No</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1843" id="d264795e844" headers="d264795e827"><code class="codeph">CREATE_FILE_DEST</code> clause</td>
<td class="cellalignment1843" headers="d264795e844 d264795e829">2</td>
<td class="cellalignment1843" headers="d264795e844 d264795e831">Yes</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1843" id="d264795e853" headers="d264795e827"><code class="codeph">DB_CREATE_FILE_DEST</code> initialization parameter</td>
<td class="cellalignment1843" headers="d264795e853 d264795e829">3</td>
<td class="cellalignment1843" headers="d264795e853 d264795e831">Yes</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1843" id="d264795e862" headers="d264795e827"><code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter</td>
<td class="cellalignment1843" headers="d264795e862 d264795e829">4</td>
<td class="cellalignment1843" headers="d264795e862 d264795e831">No</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>Regarding the use of Oracle Managed Files, the table only applies to files created by the <code class="codeph">CREATE PLUGGABLE DATABASE</code> statement. Files created for the PDB after the PDB has been created might or might not use Oracle Managed Files.</p>
<p>In addition, if <code class="codeph">FILE_NAME_CONVERT</code> and <code class="codeph">CREATE_FILE_DEST</code> are both specified in the <code class="codeph">CREATE PLUGGABLE DATABASE</code> statement, then the <code class="codeph">FILE_NAME_CONVERT</code> setting is used for the files being placed during PDB creation, and the <code class="codeph">CREATE_FILE_DEST</code> setting is used to set the <code class="codeph">DB_CREATE_FILE_DEST</code> initialization parameter in the PDB. In this case, Oracle Managed Files controls the location of the files for the PDB after PDB creation.</p>
<div class="infobox-note" id="GUID-39D2F826-7460-4439-B410-29E16C0CA0B1__GUID-14C2A794-9F27-4778-901F-1494F6E96BD2">
<p class="notep1">Note:</p>
The <code class="codeph">PATH_PREFIX</code>&nbsp;clause does not affect files created by Oracle Managed Files.</div>
<div class="infoboxnotealso" id="GUID-39D2F826-7460-4439-B410-29E16C0CA0B1__GUID-236BADB2-97D0-4E4D-93D5-46205C2F9040">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink REFRN10034" target="_blank" href="../REFRN/GUID-8E6EE3CE-0F39-4A6C-BF3C-F7C07902678D.htm#REFRN10034"><span class="italic">Oracle Database Reference</span></a> for more information about the <code class="codeph">DB_CREATE_FILE_DEST</code> initialization parameter</p>
</li>
<li>
<p><a class="olink REFRN10322" target="_blank" href="../REFRN/GUID-074F8896-D565-4139-BCDB-C81C9D741941.htm#REFRN10322"><span class="italic">Oracle Database Reference</span></a> for more information about the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter</p>
</li>
</ul>
</div>
</div>
<a id="ADMIN13562"></a><a id="ADMIN13561"></a>
<div class="props_rev_3"><a id="GUID-F782A53E-8056-44DC-9C6F-280AA5ADFC1B"></a>
<h5 id="ADMIN-GUID-F782A53E-8056-44DC-9C6F-280AA5ADFC1B" class="sect5"><span class="enumeration_section">38.1.2.2.1</span> FILE_NAME_CONVERT Clause</h5>
<div>
<p>If the PDB will not use Oracle Managed Files, then the <code class="codeph">FILE_NAME_CONVERT</code> clause of the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement specifies how to generate the names of files (such as data files) using the names of existing files.</p>
<p>You can use this clause to specify one of the following options:</p>
<ul style="list-style-type: disc;">
<li>
<p>One or more file name patterns and replacement file name patterns, in the following form:</p>
<pre dir="ltr">&#39;<span class="italic">string1</span>&#39; , &#39;<span class="italic">string2</span>&#39; , &#39;<span class="italic">string3</span>&#39; , &#39;<span class="italic">string4</span>&#39; , ...
</pre>
<p>The <span class="italic">string2</span> file name pattern replaces the <span class="italic">string1</span> file name pattern, and the <span class="italic">string4</span> file name pattern replaces the <span class="italic">string3</span> file name pattern. You can use as many pairs of file name pattern and replacement file name pattern strings as required.</p>
<p>If you specify an odd number of strings (the last string has no corresponding replacement string), then an error is returned. Do not specify more than one pattern/replace string that matches a single file name or directory.</p>
</li>
<li>
<p><code class="codeph">NONE</code> when no files should be copied or moved during PDB creation. Omitting the <code class="codeph">FILE_NAME_CONVERT</code> clause is the same as specifying <code class="codeph">NONE</code>.</p>
</li>
</ul>
<p>You can use the <code class="codeph">FILE_NAME_CONVERT</code> clause in any <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement.</p>
<p>When the <code class="codeph">FILE_NAME_CONVERT</code> clause is not specified in a <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement, either Oracle Managed Files or the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter specifies how to generate the names of the files. If you use both Oracle Managed Files and the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter, then Oracle Managed Files takes precedence. The <code class="codeph">FILE_NAME_CONVERT</code> clause takes precedence when it is specified.</p>
<p>File name patterns specified in the <code class="codeph">FILE_NAME_CONVERT</code> clause cannot match files or directories managed by Oracle Managed Files.</p>
<div class="example" id="GUID-F782A53E-8056-44DC-9C6F-280AA5ADFC1B__GUID-079577AE-60A8-409A-A503-1287C2734DB3">
<p class="titleinexample">Example 38-3 FILE_NAME_CONVERT Clause</p>
<p>This <code class="codeph">FILE_NAME_CONVERT</code> clause generates file names for the new PDB in the /oracle/pdb5 directory using file names in the /oracle/dbs directory.</p>
<pre dir="ltr">FILE_NAME_CONVERT = (&#39;/oracle/dbs/&#39;, &#39;/oracle/pdb5/&#39;)
</pre>
<div class="infoboxnotealso" id="GUID-F782A53E-8056-44DC-9C6F-280AA5ADFC1B__GUID-CFBC0780-996F-4428-9553-6B38405CCA92">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink SQLRF55786" target="_blank" href="../SQLRF/statements_6010.htm#SQLRF55786"><span class="italic">Oracle Database SQL Language Reference</span></a> for the syntax of the <code class="codeph">FILE_NAME_CONVERT</code> clause</p>
</li>
<li>
<p><a href="cdb_mon.htm#GUID-1DED3127-84E4-4967-BEB3-D0ADEC622643__CHDHDICB">Example 43-7</a></p>
</li>
<li>
<p><a href="omf.htm#GUID-4A3C4616-0D81-4BBA-8EAD-FCAA8AD5C15A" title="Oracle Database can manage the files that comprise the database.">Using Oracle Managed Files</a></p>
</li>
<li>
<p><a class="olink REFRN10322" target="_blank" href="../REFRN/GUID-074F8896-D565-4139-BCDB-C81C9D741941.htm#REFRN10322"><span class="italic">Oracle Database Reference</span></a> for information about the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter</p>
</li>
</ul>
</div>
</div>
<!-- class="example" --></div>
</div>
<a id="ADMIN14291"></a><a id="ADMIN14290"></a>
<div class="props_rev_3"><a id="GUID-0F4FA719-3C06-4980-A270-0D776CC4D46B"></a>
<h5 id="ADMIN-GUID-0F4FA719-3C06-4980-A270-0D776CC4D46B" class="sect5"><span class="enumeration_section">38.1.2.2.2</span> CREATE_FILE_DEST Clause</h5>
<div>
<p>The <code class="codeph">CREATE_FILE_DEST</code> clause of the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement enables Oracle Managed Files for the PDB and specifies the default file system directory or Oracle ASM disk group for the PDB&#39;s files. The PDB&rsquo;s data files and temp files are restricted to the specified directory and its subdirectories.</p>
<p>If a file system directory is specified as the default location in this clause, then the directory must exist. Also, the user who runs the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement must have the appropriate privileges to create files in the specified directory. Alternatively, you can specify the name of a directory object that exists in the CDB root (<code class="codeph">CDB$ROOT</code>). The directory object points to the file system directory used by <code class="codeph">CREATE_FILE_DEST</code>.</p>
<p>If there is a default Oracle Managed Files location for the CDB set in the CDB root, then the <code class="codeph">CREATE_FILE_DEST</code> setting overrides the CDB root&rsquo;s setting, and the specified <code class="codeph">CREATE_FILE_DEST</code> setting is used for the PDB.</p>
<p>If <code class="codeph">CREATE_FILE_DEST=NONE</code> is specified, then Oracle Managed Files is disabled for the PDB.</p>
<p>When the <code class="codeph">CREATE_FILE_DEST</code> clause is set to a value other than <code class="codeph">NONE</code>, the <code class="codeph">DB_CREATE_FILE_DEST</code> initialization parameter is set implicitly in the PDB with <code class="codeph">SCOPE=SPFILE</code>.</p>
<p>If the CDB root uses Oracle Managed Files, and this clause is not specified, then the PDB inherits the Oracle Managed Files default location from the CDB root.</p>
<div class="infobox-note" id="GUID-0F4FA719-3C06-4980-A270-0D776CC4D46B__GUID-23D6D081-7349-47EF-A944-AE15ECC4E525">
<p class="notep1">Note:</p>
<p>This feature is available starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2).</p>
</div>
<div class="example" id="GUID-0F4FA719-3C06-4980-A270-0D776CC4D46B__GUID-30B5456B-EDF3-410B-8E04-88E3BD83AE46">
<p class="titleinexample">Example 38-4 CREATE_FILE_DEST Clause</p>
<p>This <code class="codeph">CREATE_FILE_DEST</code> clause specifies /oracle/pdb2/ as the default Oracle Managed Files file system directory for the new PDB.</p>
<pre dir="ltr">CREATE_FILE_DEST = &#39;/oracle/pdb2/&#39;
</pre>
<div class="infoboxnotealso" id="GUID-0F4FA719-3C06-4980-A270-0D776CC4D46B__GUID-FE56E999-A290-44CE-9823-DA4E7BE7F869">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="omf.htm#GUID-4A3C4616-0D81-4BBA-8EAD-FCAA8AD5C15A" title="Oracle Database can manage the files that comprise the database.">Using Oracle Managed Files</a>&#34;</span></p>
</div>
</div>
<!-- class="example" --></div>
</div>
</div>
<a id="ADMIN14087"></a><a id="ADMIN14086"></a>
<div class="props_rev_3"><a id="GUID-7AC4C851-4E5E-4622-9B29-31D5A1C98426"></a>
<h4 id="ADMIN-GUID-7AC4C851-4E5E-4622-9B29-31D5A1C98426" class="sect4"><span class="enumeration_section">38.1.2.3</span> Restrictions on PDB File Locations</h4>
<div>
<p>The <code class="codeph">PATH_PREFIX</code> clause of the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement ensures that all relative directory object paths associated with the PDB are restricted to the specified directory or its subdirectories.</p>
<p>Use this clause when you want to ensure that a PDB&#39;s files reside in a specific directory and its subdirectories when relative paths are used for directory objects.</p>
<p>You can use this clause to specify one of the following options:</p>
<ul style="list-style-type: disc;">
<li>
<p>An absolute path that is used as a prefix for all relative directory object paths associated with the PDB.</p>
</li>
<li>
<p><code class="codeph">NONE</code> to indicate that paths associated with directory objects are treated as absolute paths. Omitting the <code class="codeph">PATH_PREFIX</code> clause is the same as specifying <code class="codeph">NONE</code>.</p>
</li>
</ul>
<p>After a PDB is created, its <code class="codeph">PATH_PREFIX</code> setting cannot be modified.</p>
<p>You can use the <code class="codeph">PATH_PREFIX</code> clause in any <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement.</p>
<p>The <code class="codeph">PATH_PREFIX</code> clause is ignored when absolute paths are used for directory objects.</p>
<p>The <code class="codeph">PATH_PREFIX</code> clause does not affect files created by Oracle Managed Files.</p>
<div class="example" id="GUID-7AC4C851-4E5E-4622-9B29-31D5A1C98426__GUID-E5F6A0A0-9D96-47F8-9B9A-B9FBE81691F4">
<p class="titleinexample">Example 38-5 PATH_PREFIX Clause</p>
<p>This <code class="codeph">PATH_PREFIX</code> clause ensures that all relative directory object paths associated with the PDB are relative to the /disk1/oracle/dbs/salespdb directory.</p>
<pre dir="ltr">PATH_PREFIX = &#39;/disk1/oracle/dbs/salespdb/&#39;
</pre>
<p>Be sure to specify the path name so that it is properly formed when file names are appended to it. For example, on UNIX systems, be sure to end the path name with a forward slash (/).</p>
<div class="infoboxnotealso" id="GUID-7AC4C851-4E5E-4622-9B29-31D5A1C98426__GUID-D75885C2-686C-4932-A535-BE2BC5A1CEF4">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="cdb_intro.htm#GUID-A1F3A63E-3BE5-4B80-A053-46D9EF71D45E" title="You can use the Oracle Multitenant option to configure and manage a multitenant environment. The multitenant architecture enables an Oracle database to function as a multitenant container database (CDB) that includes zero, one, or many customer-created pluggable databases (PDBs). A PDB is a portable collection of schemas, schema objects, and nonschema objects that appears to an Oracle Net client as a non-CDB. All Oracle databases before Oracle Database 12c were non-CDBs.">About a Multitenant Environment</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="cdb_mon.htm#GUID-08173CF3-1F01-41D5-8EAF-363FDA1A601E" title="The V$CONTAINERS view provides information about all of the containers in a CDB, including the root and all PDBs.">Viewing Information About the Containers in a CDB</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
<!-- class="example" --></div>
</div>
<a id="ADMIN13564"></a><a id="ADMIN13563"></a>
<div class="props_rev_3"><a id="GUID-1691A7A2-372E-4E51-8A4F-15DAC6AB0FC3"></a>
<h4 id="ADMIN-GUID-1691A7A2-372E-4E51-8A4F-15DAC6AB0FC3" class="sect4"><span class="enumeration_section">38.1.2.4</span> Source File Locations When Plugging In an Unplugged PDB</h4>
<div>
<p>When you plug an unplugged PDB into a CDB, the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> <code class="codeph">...</code> <code class="codeph">USING</code> statement must be able to identify the PDB&#39;s files.</p>
<p>An XML file describes the names of an unplugged PDB&#39;s source files. The XML file might not describe the names of these files accurately if you transported the unplugged files from one storage system to a different one. The files are in a new location, but the file paths in the XML file still indicate the old location. In this case, use this clause to specify the accurate names of the files. Use this clause only when you are plugging in an unplugged PDB with a <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> <code class="codeph">...</code> <code class="codeph">USING</code> statement.</p>
<p>The <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement has the following clauses that indicate location of the source files for the new PDB being created:</p>
<ul style="list-style-type: disc;">
<li>
<p>The <code class="codeph">SOURCE_FILE_NAME_CONVERT</code> clause specifies how to locate files (such as data files) listed in an XML file describing a PDB if they reside in a location different from that specified in the XML file. The clause contains information about each file listed in the XML file.</p>
</li>
<li>
<p>Starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2), the <code class="codeph">SOURCE_FILE_DIRECTORY</code> clause specifies the source directory of the files that will be used to create the new PDB. The clause specifies a directory that contains all of the files listed in the XML file. Using this clause is convenient when you have a large number of data files and specifying a <code class="codeph">SOURCE_FILE_NAME_CONVERT</code> pattern for each file is not feasible.</p>
</li>
</ul>
<p>These clauses are mutually exclusive. You cannot use both clauses in a single <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement.</p>
<p>You can use these clauses only when you are plugging in an unplugged PDB with the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code><code class="codeph">...</code> <code class="codeph">USING</code> statement.</p>
</div>
<div class="sect5"><a id="GUID-CD341EDB-8B27-484B-9C55-CF206E2983DD"></a>
<h5 id="ADMIN-GUID-CD341EDB-8B27-484B-9C55-CF206E2983DD" class="sect5"><span class="enumeration_section">38.1.2.4.1</span> SOURCE_FILE_NAME_CONVERT Clause</h5>
<div>
<p>The <code class="codeph">SOURCE_FILE_NAME_CONVERT</code> clause of the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> <code class="codeph">...</code> <code class="codeph">USING</code> statement specifies how to locate files (such as data files) listed in an XML file describing a PDB if they reside in a location different from that specified in the XML file.</p>
<p>You can use this clause to specify one of the following options:</p>
<ul style="list-style-type: disc;">
<li>
<p>One or more file name patterns and replacement file name patterns, in the following form:</p>
<pre dir="ltr">&#39;<span class="italic">string1</span>&#39; , &#39;<span class="italic">string2</span>&#39; , &#39;<span class="italic">string3</span>&#39; , &#39;<span class="italic">string4</span>&#39; , ...
</pre>
<p>The <span class="italic">string2</span> file name pattern replaces the <span class="italic">string1</span> file name pattern, and the <span class="italic">string4</span> file name pattern replaces the <span class="italic">string3</span> file name pattern. You can use as many pairs of file name pattern and replacement file name pattern strings as required.</p>
<p>When you use this clause, ensure that the files you want to use for the PDB reside in the replacement file name patterns. Move or copy the files to these locations if necessary.</p>
</li>
<li>
<p><code class="codeph">NONE</code> when no file names need to be located because the PDB&#39;s XML file describes the file names accurately. Omitting the <code class="codeph">SOURCE_FILE_NAME_CONVERT</code> clause is the same as specifying <code class="codeph">NONE</code>.</p>
</li>
</ul>
<p>You can use the <code class="codeph">SOURCE_FILE_NAME_CONVERT</code> clause only in a <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement with a <code class="codeph">USING</code> clause. Therefore, you can use this clause only when you are plugging in an unplugged PDB.</p>
<div class="example" id="GUID-CD341EDB-8B27-484B-9C55-CF206E2983DD__GUID-72F60ACF-4573-4252-9993-AC08E183F617">
<p class="titleinexample">Example 38-6 SOURCE_FILE_NAME_CONVERT Clause</p>
<p>This <code class="codeph">SOURCE_FILE_NAME_CONVERT</code> clause uses the files in the /disk2/oracle/pdb7 directory instead of the /disk1/oracle/pdb7 directory. In this case, the XML file describing a PDB specifies the /disk1/oracle/pdb7 directory, but the PDB should use the files in the /disk2/oracle/pdb7 directory.</p>
<pre dir="ltr">SOURCE_FILE_NAME_CONVERT = (&#39;/disk1/oracle/pdb7/&#39;, &#39;/disk2/oracle/pdb7/&#39;)
</pre>
<div class="infoboxnotealso" id="GUID-CD341EDB-8B27-484B-9C55-CF206E2983DD__GUID-36424435-B7BE-4778-85F8-CF6EEE8C55F6">
<p class="notep1">See Also:</p>
<p><a class="olink SQLRF55794" target="_blank" href="../SQLRF/statements_6010.htm#SQLRF55794"><span class="italic">Oracle Database SQL Language Reference</span></a> for the syntax of the <code class="codeph">SOURCE_FILE_NAME_CONVERT</code> clause</p>
</div>
</div>
<!-- class="example" --></div>
</div>
<div class="props_rev_3"><a id="GUID-57A111DC-5D82-47D3-9239-9B8F604528FC"></a>
<h5 id="ADMIN-GUID-57A111DC-5D82-47D3-9239-9B8F604528FC" class="sect5"><span class="enumeration_section">38.1.2.4.2</span> SOURCE_FILE_DIRECTORY Clause</h5>
<div>
<p>The <code class="codeph">SOURCE_FILE_DIRECTORY</code> clause of the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement specifies the source directory of the files that will be used to create the new PDB. The clause specifies a directory that contains all of the files listed in the XML file for the unplugged PDB.</p>
<p>When you plug in a PDB, if the source files are all present in a single directory, then you can specify the directory name in this clause. The directory is scanned to find the appropriate files based on the unplugged PDB&rsquo;s XML file.</p>
<p>You can use this clause to specify one of the following options:</p>
<ul style="list-style-type: disc;">
<li>
<p>The absolute path of the source file directory.</p>
</li>
<li>
<p><code class="codeph">NONE</code> when no files should be copied or moved during PDB creation. Omitting the <code class="codeph">SOURCE_FILE_DIRECTORY</code> clause is the same as specifying <code class="codeph">NONE</code>.</p>
</li>
</ul>
<p>You can use the <code class="codeph">SOURCE_FILE_DIRECTORY</code> clause only in a <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement with a <code class="codeph">USING</code> clause. Therefore, you can use this clause only when you are plugging in an unplugged PDB.</p>
<p>You can specify this clause for configurations that use Oracle Managed Files and for configurations that do not use Oracle Managed Files.</p>
<div class="example" id="GUID-57A111DC-5D82-47D3-9239-9B8F604528FC__GUID-079577AE-60A8-409A-A503-1287C2734DB3">
<p class="titleinexample">Example 38-7 SOURCE_FILE_DIRECTORY Clause</p>
<p>This <code class="codeph">SOURCE_FILE_DIRECTORY</code> clause generates file names for the new PDB by using the source files in the /oracle/pdb5/ directory.</p>
<pre dir="ltr">SOURCE_FILE_DIRECTORY = &#39;/oracle/pdb5/&#39;
</pre>
<div class="infoboxnotealso" id="GUID-57A111DC-5D82-47D3-9239-9B8F604528FC__GUID-36424435-B7BE-4778-85F8-CF6EEE8C55F6">
<p class="notep1">See Also:</p>
<p><a class="olink SQLRF57048" target="_blank" href="../SQLRF/statements_6010.htm#SQLRF57048"><span class="italic">Oracle Database SQL Language Reference</span></a> for the syntax of the <code class="codeph">SOURCE_FILE_DIRECTORY</code> clause</p>
</div>
</div>
<!-- class="example" --></div>
</div>
</div>
<div class="sect4"><a id="GUID-6B1CE78D-A6BC-44F7-A74E-61A8E469334E"></a>
<h4 id="ADMIN-GUID-6B1CE78D-A6BC-44F7-A74E-61A8E469334E" class="sect4"><span class="enumeration_section">38.1.2.5</span> SERVICE_NAME_CONVERT Clause</h4>
<div>
<p>The <code class="codeph">SERVICE_NAME_CONVERT</code> clause of the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement renames the user-defined services of the new PDB based on the service names of the source PDB.</p>
<p>When the service name of a new PDB conflicts with an existing service name in the CDB, plug-in violations can result. Use the <code class="codeph">SERVICE_NAME_CONVERT</code> clause to rename services and avoid these violations.</p>
<p>You can use this clause to specify one of the following options:</p>
<ul style="list-style-type: disc;">
<li>
<p>One or more service names and replacement service names, in the following form:</p>
<pre dir="ltr">&#39;<span class="italic">string1</span>&#39; , &#39;<span class="italic">string2</span>&#39; , &#39;<span class="italic">string3</span>&#39; , &#39;<span class="italic">string4</span>&#39; , ...
</pre>
<p>The <span class="italic">string2</span> service name replaces the <span class="italic">string1</span> service name, and the <span class="italic">string4</span> service name replaces the <span class="italic">string3</span> service name. You can use as many pairs of service names and replacement service names as required.</p>
<p>If you specify an odd number of strings (the last string has no corresponding replacement string), then an error is returned.</p>
</li>
<li>
<p><code class="codeph">NONE</code> when no service names need to be renamed. Omitting the <code class="codeph">SERVICE_NAME_CONVERT</code> clause is the same as specifying <code class="codeph">NONE</code>.</p>
</li>
</ul>
<p>You can use the <code class="codeph">SERVICE_NAME_CONVERT</code> clause in any <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement, except for a <code class="codeph">CREATE PLUGGABLE DATABASE</code> statement that creates a PDB from the seed. The seed cannot have user-defined services.</p>
<div class="infobox-note" id="GUID-6B1CE78D-A6BC-44F7-A74E-61A8E469334E__GUID-DDF618CC-7E93-47AA-B6FA-9E1FF53D47C8">
<p class="notep1">Note:</p>
This clause does not apply to the default service for the PDB. The default service has the same name as the PDB.</div>
<div class="example" id="GUID-6B1CE78D-A6BC-44F7-A74E-61A8E469334E__GUID-72F60ACF-4573-4252-9993-AC08E183F617">
<p class="titleinexample">Example 38-8 SERVICE_NAME_CONVERT Clause</p>
<p>This <code class="codeph">SERVICE_NAME_CONVERT</code> clause uses renames the <code class="codeph">salesrep</code> service to <code class="codeph">salesperson</code>.</p>
<pre dir="ltr">SERVICE_NAME_CONVERT = (&#39;salesrep&#39;,&#39;salesperson&#39;)
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ADMIN14165"></a><a id="ADMIN14164"></a>
<div class="props_rev_3"><a id="GUID-EC6BFAB6-F44D-45CF-9565-E899B60B5E35"></a>
<h4 id="ADMIN-GUID-EC6BFAB6-F44D-45CF-9565-E899B60B5E35" class="sect4"><span class="enumeration_section">38.1.2.6</span> Temp File Reuse</h4>
<div>
<p>The <code class="codeph">TEMPFILE REUSE</code> clause of the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement specifies that an existing temp file in the target location is reused.</p>
<p>When you specify this clause, Oracle Database formats the temp file and reuses it. The previous contents of the file are lost. If this clause is specified, and there is no temp file in the target location, then Oracle Database creates a new temp file for the PDB.</p>
<p>If you do not specify this clause, then the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement creates a new temp file for the PDB. If a file exists with the same name as the new temp file in the target location, then an error is returned, and the PDB is not created. Therefore, if you do not specify the <code class="codeph">TEMPFILE REUSE</code> clause, then ensure that such a temp file does not exist in the target location.</p>
<div class="example" id="GUID-EC6BFAB6-F44D-45CF-9565-E899B60B5E35__GUID-8E8FB0BB-E7AA-4FD2-87E4-F8BA3C48D38A">
<p class="titleinexample">Example 38-9 TEMPFILE REUSE Clause</p>
<pre dir="ltr">TEMPFILE REUSE
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ADMIN14242"></a><a id="ADMIN14243"></a><a id="ADMIN14244"></a><a id="ADMIN14241"></a>
<div class="props_rev_3"><a id="GUID-1C47D543-8376-48AE-A1AE-632316731D59"></a>
<h4 id="ADMIN-GUID-1C47D543-8376-48AE-A1AE-632316731D59" class="sect4"><span class="enumeration_section">38.1.2.7</span> User Tablespaces</h4>
<div>
<p>The <code class="codeph">USER_TABLESPACES</code> clause of the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement specifies which tablespaces are available in the new PDB.</p>
<div class="infobox-note" id="GUID-1C47D543-8376-48AE-A1AE-632316731D59__GUID-601D5CAC-E908-499C-B7AF-97E4AAE40796">
<p class="notep1">Note:</p>
<p>This feature is available starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2).</p>
</div>
<p>You can use this clause to separate the data for multiple schemas into different PDBs. For example, when you move a non-CDB to a PDB, and the non-CDB had a number of schemas that each supported a different application, you can use this clause to separate the data belonging to each schema into a separate PDB, assuming that each schema used a separate tablespace in the non-CDB.</p>
<p>You can use this clause to specify one of the following options:</p>
<ul style="list-style-type: disc;">
<li>
<p>List one or more tablespaces to include.</p>
</li>
<li>
<p>Specify <code class="codeph">ALL</code>, the default, to include all of the tablespaces.</p>
</li>
<li>
<p>Specify <code class="codeph">ALL</code> <code class="codeph">EXCEPT</code> to include all of the tablespaces, except for the tablespaces listed.</p>
</li>
<li>
<p>Specify <code class="codeph">NONE</code> to exclude all of the tablespaces.</p>
</li>
</ul>
<p>The tablespaces that are excluded by this clause are offline in the new PDB, and all data files that belong to these tablespaces are unnamed and offline.</p>
<p>This clause does not apply to the <code class="codeph">SYSTEM</code>, <code class="codeph">SYSAUX</code>, or <code class="codeph">TEMP</code> tablespaces. Do not include these tablespaces in a tablespace list for this clause.</p>
<p>The following are examples that use the <code class="codeph">USER_TABLESPACES</code> clause.</p>
<div class="example" id="GUID-1C47D543-8376-48AE-A1AE-632316731D59__CEGBGECI">
<p class="titleinexample">Example 38-10 USER_TABLESPACES Clause That Includes One Tablespace</p>
<p>Assume that the non-CDB or PDB from which a PDB is being created includes the following tablespaces: <code class="codeph">tbs1</code>, <code class="codeph">tbs2</code>, and <code class="codeph">tbs3</code>. This <code class="codeph">USER_TABLESPACES</code> clause includes the <code class="codeph">tbs2</code> tablespace, but excludes the <code class="codeph">tbs1</code> and <code class="codeph">tbs3</code> tablespaces.</p>
<pre dir="ltr">USER_TABLESPACES=(&#39;tbs2&#39;);
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-1C47D543-8376-48AE-A1AE-632316731D59__CEGGABAC">
<p class="titleinexample">Example 38-11 USER_TABLESPACES Clause That Includes a List of Tablespaces</p>
<p>Assume that the non-CDB or PDB from which a PDB is being created includes the following tablespaces: <code class="codeph">tbs1</code>, <code class="codeph">tbs2</code>, <code class="codeph">tbs3</code>, <code class="codeph">tbs4</code>, and <code class="codeph">tbs5</code>. This <code class="codeph">USER_TABLESPACES</code> clause includes the <code class="codeph">tbs1</code>, <code class="codeph">tbs4</code>, and <code class="codeph">tbs5</code> tablespaces, but excludes the <code class="codeph">tbs2</code> and <code class="codeph">tbs3</code> tablespaces.</p>
<pre dir="ltr">USER_TABLESPACES=(&#39;tbs1&#39;,&#39;tbs4&#39;,&#39;tbs5&#39;);
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-1C47D543-8376-48AE-A1AE-632316731D59__CEGJFEHH">
<p class="titleinexample">Example 38-12 USER_TABLESPACES Clause That Includes All Tablespaces Except for Listed Ones</p>
<p>Assume that the non-CDB or PDB from which a PDB is being created includes the following tablespaces: <code class="codeph">tbs1</code>, <code class="codeph">tbs2</code>, <code class="codeph">tbs3</code>, <code class="codeph">tbs4</code>, and <code class="codeph">tbs5</code>. This <code class="codeph">USER_TABLESPACES</code> clause includes the <code class="codeph">tbs2</code> and <code class="codeph">tbs3</code> tablespaces, but excludes the <code class="codeph">tbs1</code>, <code class="codeph">tbs4</code>, and <code class="codeph">tbs5</code> tablespaces.</p>
<pre dir="ltr">USER_TABLESPACES=ALL EXCEPT(&#39;tbs1&#39;,&#39;tbs4&#39;,&#39;tbs5&#39;);
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ADMIN14246"></a><a id="ADMIN14247"></a><a id="ADMIN14245"></a>
<div class="props_rev_3"><a id="GUID-ADD3198D-7D05-4026-A30A-F3972A89F779"></a>
<h4 id="ADMIN-GUID-ADD3198D-7D05-4026-A30A-F3972A89F779" class="sect4"><span class="enumeration_section">38.1.2.8</span> PDB Tablespace Logging</h4>
<div>
<p>The <span class="italic">logging_clause</span> of the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement specifies the logging attribute of the PDB. The logging attribute controls whether certain DML operations are logged in the redo log file (<code class="codeph">LOGGING</code>) or not (<code class="codeph">NOLOGGING</code>).</p>
<div class="infobox-note" id="GUID-ADD3198D-7D05-4026-A30A-F3972A89F779__GUID-07F8A135-33EF-476C-BA00-1A69AEA105B8">
<p class="notep1">Note:</p>
<p>This feature is available starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2).</p>
</div>
<p>You can use this clause to specify one of the following attributes:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">LOGGING</code>, the default, indicates that any future tablespaces created within the PDB will be created with the <code class="codeph">LOGGING</code> attribute by default.</p>
</li>
<li>
<p><code class="codeph">NOLOGGING</code> indicates that any future tablespaces created within the PDB will be created with the <code class="codeph">NOLOGGING</code> attribute by default.</p>
</li>
</ul>
<p>You can override the default logging attribute by specifying either <code class="codeph">LOGGING</code> or <code class="codeph">NOLOGGING</code> at the schema object level--for example, in a <code class="codeph">CREATE TABLE</code> statement.</p>
<p>The specified attribute is used to establish the logging attribute of tablespaces created within the PDB if the <span class="italic">logging_clause</span> is not specified in the <code class="codeph">CREATE TABLESPACE</code> statement.</p>
<p>The <code class="codeph">DBA_PDBS</code> view shows the current logging attribute for a PDB.</p>
<div class="example" id="GUID-ADD3198D-7D05-4026-A30A-F3972A89F779__GUID-3BD305DE-812C-438E-82AA-A8D83EFC37E1">
<p class="titleinexample">Example 38-13 Specifying the LOGGING Attribute for the PDB</p>
<pre dir="ltr">LOGGING
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-ADD3198D-7D05-4026-A30A-F3972A89F779__GUID-BCADD99C-308D-4D96-B55C-854F1E38098E">
<p class="titleinexample">Example 38-14 Specifying the NOLOGGING Attribute for the PDB</p>
<pre dir="ltr">NOLOGGING
</pre>
<div class="infoboxnotealso" id="GUID-ADD3198D-7D05-4026-A30A-F3972A89F779__GUID-226D7C25-AEFC-4FF4-B0EE-C3786FBEC596">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="tspaces.htm#GUID-A1939693-60AC-4009-B37C-A1D8D1360D49" title="For some database operations, you can control whether the database generates redo records.">Controlling the Writing of Redo Records</a>&#34;</span></p>
</li>
<li>
<p><a class="olink SQLRF30009" target="_blank" href="../SQLRF/clauses005.htm#SQLRF30009"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about the logging attribute</p>
</li>
</ul>
</div>
</div>
<!-- class="example" --></div>
</div>
<a id="ADMIN14249"></a><a id="ADMIN14250"></a><a id="ADMIN14248"></a>
<div class="props_rev_3"><a id="GUID-93484655-B6C5-487B-B89A-5957A26309BE"></a>
<h4 id="ADMIN-GUID-93484655-B6C5-487B-B89A-5957A26309BE" class="sect4"><span class="enumeration_section">38.1.2.9</span> PDB Inclusion in Standby CDBs</h4>
<div>
<p>The <code class="codeph">STANDBYS</code> clause of the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement specifies whether the new PDB is included in standby CDBs.</p>
<div class="infobox-note" id="GUID-93484655-B6C5-487B-B89A-5957A26309BE__GUID-2572FDBF-86B1-44FE-9F7E-AEC00C5644E2">
<p class="notep1">Note:</p>
<p>This feature is available starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2).</p>
</div>
<p>You can specify one of the following values for the <code class="codeph">STANDBYS</code> clause:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">ALL</code> includes the new PDB in all of the standby CDBs.</p>
</li>
<li>
<p><code class="codeph">NONE</code> excludes the new PDB from all of the standby CDBs.</p>
</li>
</ul>
<p>When a PDB is not included in any of the standby CDBs, the PDB&#39;s data files are offline and marked as unnamed on all of the standby CDBs. Any new standby CDBs that are instantiated after the PDB has been created must disable the PDB for recovery explicitly to exclude it from the standby CDB. It is possible to enable a PDB on a standby CDB after it was excluded on that standby CDB.</p>
<div class="example" id="GUID-93484655-B6C5-487B-B89A-5957A26309BE__GUID-97D3A442-42A6-4A25-BE12-DF3EB7E9CE13">
<p class="titleinexample">Example 38-15 STANDBYS Clause That Includes the New PDB on All Standby CDBs</p>
<pre dir="ltr">STANDBYS=ALL
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-93484655-B6C5-487B-B89A-5957A26309BE__GUID-235CE4E2-C66C-49BB-86DF-2B3F99C0DB7F">
<p class="titleinexample">Example 38-16 STANDBYS Clause That Excludes the New PDB from All Standby CDBs</p>
<pre dir="ltr">STANDBYS=NONE
</pre>
<div class="infoboxnotealso" id="GUID-93484655-B6C5-487B-B89A-5957A26309BE__GUID-24BA8525-B423-4F9F-9BD3-DD33476734EB">
<p class="notep1">See Also:</p>
<p><a class="olink SBYDB5260" target="_blank" href="../SBYDB/create_ps.htm#SBYDB5260"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> for more information about configuring PDBs on standby CDBs</p>
</div>
</div>
<!-- class="example" --></div>
</div>
<a id="ADMIN14330"></a><a id="ADMIN14329"></a>
<div class="props_rev_3"><a id="GUID-3BB463D5-D152-45FF-AB23-61856FB84C0B"></a>
<h4 id="ADMIN-GUID-3BB463D5-D152-45FF-AB23-61856FB84C0B" class="sect4"><span class="enumeration_section">38.1.2.10</span> Excluding Data When Cloning a PDB</h4>
<div>
<p>The <code class="codeph">NO DATA</code> clause of the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement specifies that a PDB&#39;s data model definition is cloned but not the PDB&#39;s data.</p>
<div class="infobox-note" id="GUID-3BB463D5-D152-45FF-AB23-61856FB84C0B__GUID-500057F6-ADC8-43D4-B738-9634AEC8B85B">
<p class="notep1">Note:</p>
<p>This feature is available starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2).</p>
</div>
<p>The dictionary data in the source PDB is cloned, but all user-created table and index data from the source PDB is discarded. This clause is useful for quickly creating clones of a PDB with only the object definitions and no data. Use this clause only when you are cloning a PDB with a <code class="codeph">CREATE PLUGGABLE DATABASE ... FROM</code> statement.</p>
<p>This clause does not apply to the <code class="codeph">SYSTEM</code> and <code class="codeph">SYSAUX</code> tablespaces. If user-created database objects in the source PDB are stored in one of these tablespaces, the database objects will contain data in the cloned PDB.</p>
<p>When the <code class="codeph">NO DATA</code> clause is included in the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement, the source PDB cannot contain the following types of tables:</p>
<ul style="list-style-type: disc;">
<li>
<p>Advanced Queue (AQ) tables</p>
</li>
<li>
<p>Clustered tables</p>
</li>
<li>
<p>Table clusters</p>
</li>
</ul>
<div class="example" id="GUID-3BB463D5-D152-45FF-AB23-61856FB84C0B__GUID-8FE2B3CE-1A75-4B6F-AA5F-9ECF459BBC1B">
<p class="titleinexample">Example 38-17 NO DATA Clause</p>
<pre dir="ltr">NO DATA
</pre>
<div class="infoboxnotealso" id="GUID-3BB463D5-D152-45FF-AB23-61856FB84C0B__GUID-97ABAF8B-D9F8-42B8-84DB-C55286E52832">
<p class="notep1">See Also:</p>
<p><a class="olink SQLRF57032" target="_blank" href="../SQLRF/statements_6010.htm#SQLRF57032"><span class="italic">Oracle Database SQL Language Reference</span></a></p>
</div>
</div>
<!-- class="example" --></div>
</div>
</div>
</div>
<a id="ADMIN13565"></a>
<div class="props_rev_3"><a id="GUID-B26D56E1-B958-444F-864C-8AFDFF1566A6"></a>
<h2 id="ADMIN-GUID-B26D56E1-B958-444F-864C-8AFDFF1566A6" class="sect2"><span class="enumeration_section">38.2</span> Preparing for PDBs</h2>
<div>
<p>Prerequisites must be met before creating a PDB.</p>
<div class="section">
<p>Ensure that the following prerequisites are met before creating a PDB:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>The CDB must exist.</p>
<p>See <a href="cdb_create.htm#GUID-77D4BBA7-2A64-46D9-A2B8-C56060772215" title="Creating and configuring a &nbsp;multitenant container database (CDB) includes tasks such as planning for CDB creation, creating the CDB, and optionally configuring EM Express for the CDB.">Creating and Configuring a CDB</a>.</p>
</li>
<li>
<p>The CDB must be in read/write mode.</p>
</li>
<li>
<p>The current user must be a common user whose current container is the root.</p>
</li>
<li>
<p>The current user must have the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> system privilege.</p>
</li>
<li>
<p>You must decide on a unique PDB name for each PDB. Each PDB name must be unique in a single CDB, and each PDB name must be unique within the scope of all the CDBs whose instances are reached through a specific listener.</p>
<p>The PDB name is used to distinguish a PDB from other PDBs in the CDB. PDB names follow the same rules as service names, which includes being case-insensitive. See <a class="olink NETRF175" target="_blank" href="../NETRF/syntax.htm#NETRF175"><span class="italic">Oracle Database Net Services Reference</span></a> for information about the rules for service names.</p>
</li>
<li>
<p>If you are creating a PDB in an Oracle Data Guard configuration with a physical standby database, then additional tasks must be completed before creating a PDB. See <a class="olink SBYDB5260" target="_blank" href="../SBYDB/create_ps.htm#SBYDB5260"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> for more information.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-B26D56E1-B958-444F-864C-8AFDFF1566A6__GUID-131F45BE-A227-4915-8F08-278BD2B69F72">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="cdb_admin.htm#GUID-E1BBCE0F-76CA-49F3-9A6B-AC6B13AB9AC5" title="The data dictionary in each container in a CDB is separate, and the current container is the container whose data dictionary is used for name resolution and for privilege authorization. The current container can be the root or a PDB. Each session has exactly one current container at any point in time, but it is possible for a session to switch from one container to another.">About the Current Container</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN13566"></a>
<div class="props_rev_3"><a id="GUID-CCA938BD-52BE-422C-86AF-576D3E02B96B"></a>
<h2 id="ADMIN-GUID-CCA938BD-52BE-422C-86AF-576D3E02B96B" class="sect2"><span class="enumeration_section">38.3</span> Creating a PDB Using the Seed</h2>
<div>
<p>You can use the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement to create a PDB in a CDB using the files of the seed.</p>
<div class="infoboxnotealso" id="GUID-CCA938BD-52BE-422C-86AF-576D3E02B96B__GUID-A1CEB6C9-32FA-4FCB-9419-ED0A7093DA90">
<p class="notep1">See Also:</p>
<p><a class="olink SQLRF55686" target="_blank" href="../SQLRF/statements_6010.htm#SQLRF55686"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement</p>
</div>
</div>
<a id="ADMIN13752"></a><a id="ADMIN13567"></a><a id="ADMIN13552"></a>
<div class="props_rev_3"><a id="GUID-534B3B1D-0ED7-4828-9CA4-B1757398801F"></a>
<h3 id="ADMIN-GUID-534B3B1D-0ED7-4828-9CA4-B1757398801F" class="sect3"><span class="enumeration_section">38.3.1</span> About Creating a PDB from the Seed</h3>
<div>
<p>You can use the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement to create a new PDB by using the files of the seed.</p>
<p>The statement copies these files to a new location and associates them with the new PDB. <a href="cdb_plug.htm#GUID-534B3B1D-0ED7-4828-9CA4-B1757398801F__CEGIEGHI">Figure 38-2</a> illustrates how this technique creates a new PDB.</p>
<div class="figure" id="GUID-534B3B1D-0ED7-4828-9CA4-B1757398801F__CEGIEGHI">
<p class="titleinfigure">Figure 38-2 Create a PDB Using the Seed Files</p>
<img width="561" height="390" src="img/GUID-6B82890A-1A3E-42A0-9A53-8E5632381FBB-default.png" alt="Description of Figure 38-2 follows" title="Description of Figure 38-2 follows"/><br/>
<a href="img_text/GUID-6B82890A-1A3E-42A0-9A53-8E5632381FBB-print.htm">Description of &#34;Figure 38-2 Create a PDB Using the Seed Files&#34;</a></div>
<!-- class="figure" -->
<div class="infoboxnotealso" id="GUID-534B3B1D-0ED7-4828-9CA4-B1757398801F__GUID-4A698E19-D3B9-4FE0-B052-16AD99D625B2">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="cdb_plug.htm#GUID-59F42929-7237-4371-8934-921B46DB6F31" title="You use the CREATE PLUGGABLE DATABASE statement to create a PDB. To use this statement, you must understand the clauses for the statement and when to use each clause.">The CREATE PLUGGABLE DATABASE Statement</a>&#34;</span></p>
</div>
<p>When you create a new PDB from the seed, you must specify an administrator for the PDB in the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement. The statement creates the administrator as a local user in the PDB and grants the <code class="codeph">PDB_DBA</code> role locally to the administrator.</p>
<p>When you create a PDB using the seed, you must address the questions in <a href="cdb_plug.htm#GUID-534B3B1D-0ED7-4828-9CA4-B1757398801F__CEGFCFDA" title="This table describes each clause and when to use each clause.">Table 38-3</a>. The table describes which <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> clauses you must specify based on different factors.</p>
<div class="tblformalwide" id="GUID-534B3B1D-0ED7-4828-9CA4-B1757398801F__CEGFCFDA">
<p class="titleintable">Table 38-3 Clauses for Creating a PDB From the Seed</p>
<table class="cellalignment1880" title="Clauses for Creating a PDB From the Seed" summary="This table describes each clause and when to use each clause.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1867" id="d264795e3206">Clause</th>
<th class="cellalignment1863" id="d264795e3209">Question</th>
<th class="cellalignment1863" id="d264795e3212">Yes</th>
<th class="cellalignment1872" id="d264795e3215">No</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d264795e3220" headers="d264795e3206">
<p><code class="codeph">STORAGE</code></p>
</td>
<td class="cellalignment1865" headers="d264795e3220 d264795e3209">
<p>Do you want to limit the amount of storage that the PDB can use?</p>
</td>
<td class="cellalignment1865" headers="d264795e3220 d264795e3212">
<p>Specify a <code class="codeph">STORAGE</code> clause with the appropriate limits.</p>
</td>
<td class="cellalignment1875" headers="d264795e3220 d264795e3215">
<p>Omit the <code class="codeph">STORAGE</code> clause, or specify unlimited storage using the <code class="codeph">STORAGE</code> clause.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d264795e3243" headers="d264795e3206">
<p><code class="codeph">DEFAULT</code> <code class="codeph">TABLESPACE</code></p>
</td>
<td class="cellalignment1865" headers="d264795e3243 d264795e3209">
<p>Do you want to specify a default permanent tablespace for the PDB?</p>
</td>
<td class="cellalignment1865" headers="d264795e3243 d264795e3212">
<p>Specify a <code class="codeph">DEFAULT</code> <code class="codeph">TABLESPACE</code> clause with the appropriate limits.</p>
<p>Oracle Database creates a smallfile tablespace and subsequently will assign to this tablespace any non-<code class="codeph">SYSTEM</code> users for whom you do not specify a different permanent tablespace.</p>
</td>
<td class="cellalignment1875" headers="d264795e3243 d264795e3215">
<p>Omit the <code class="codeph">DEFAULT</code> <code class="codeph">TABLESPACE</code> clause.</p>
<p>If you do not specify this clause, then the <code class="codeph">SYSTEM</code> tablespace is the default permanent tablespace for non-<code class="codeph">SYSTEM</code> users. Using the <code class="codeph">SYSTEM</code> tablespace for non-<code class="codeph">SYSTEM</code> users is not recommended.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d264795e3291" headers="d264795e3206">
<p><code class="codeph">PATH_PREFIX</code></p>
</td>
<td class="cellalignment1865" headers="d264795e3291 d264795e3209">
<p>Do you want to use a <code class="codeph">PATH_PREFIX</code> clause to ensure that all relative directory object paths associated with the PDB are treated as relative to the specified directory or its subdirectories?</p>
<p>The <code class="codeph">PATH_PREFIX</code> clause is ignored when absolute paths are used for directory objects.</p>
<p>The <code class="codeph">PATH_PREFIX</code> clause does not affect files created by Oracle Managed Files.</p>
</td>
<td class="cellalignment1865" headers="d264795e3291 d264795e3212">
<p>Include a <code class="codeph">PATH_PREFIX</code> clause that specifies an absolute path.</p>
</td>
<td class="cellalignment1875" headers="d264795e3291 d264795e3215">
<p>Set the <code class="codeph">PATH_PREFIX</code> clause to <code class="codeph">NONE</code> or omit it.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d264795e3327" headers="d264795e3206">
<p><code class="codeph">FILE_NAME_CONVERT</code></p>
</td>
<td class="cellalignment1865" headers="d264795e3327 d264795e3209">
<p>Do you want to use a <code class="codeph">FILE_NAME_CONVERT</code> clause to specify the target locations of the files?</p>
<p>The source files are the files associated with the seed.</p>
</td>
<td class="cellalignment1865" headers="d264795e3327 d264795e3212">
<p>Include a <code class="codeph">FILE_NAME_CONVERT</code> clause that specifies the target locations of the files based on the names of the source files.</p>
</td>
<td class="cellalignment1875" headers="d264795e3327 d264795e3215">
<p>Omit the <code class="codeph">FILE_NAME_CONVERT</code> clause.</p>
<p>Use one of these techniques to specify the target locations of the files:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">CREATE_FILE_DEST</code> clause</p>
</li>
<li>
<p>Enable Oracle Managed Files for the CDB for it to determine the target locations.</p>
</li>
<li>
<p>Specify the target locations in the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter.</p>
</li>
</ul>
<p>See <span class="q">&#34;<a href="cdb_plug.htm#GUID-39D2F826-7460-4439-B410-29E16C0CA0B1" title="In the CREATE PLUGGABLE DATABASE statement, you can specify the locations of files used by the new PDB.">File Location of the New PDB</a>&#34;</span>.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d264795e3388" headers="d264795e3206">
<p><code class="codeph">CREATE_FILE_DEST</code></p>
</td>
<td class="cellalignment1865" headers="d264795e3388 d264795e3209">
<p>Do you want to use a <code class="codeph">CREATE_FILE_DEST</code> clause to specify the Oracle Managed Files default location for the PDB&#39;s files?</p>
<p>The source files are the files associated with the seed.</p>
</td>
<td class="cellalignment1865" headers="d264795e3388 d264795e3212">
<p>Include a <code class="codeph">CREATE_FILE_DEST</code> clause that specifies the default file system directory or Oracle ASM disk group for the PDB&#39;s files.</p>
</td>
<td class="cellalignment1875" headers="d264795e3388 d264795e3215">
<p>Omit the <code class="codeph">CREATE_FILE_DEST</code> clause.</p>
<p>Use one of these techniques to specify the target locations of the files:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">FILE_NAME_CONVERT</code> clause</p>
</li>
<li>
<p>Enable Oracle Managed Files for the CDB for it to determine the target locations.</p>
</li>
<li>
<p>Specify the target locations in the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter.</p>
</li>
</ul>
<p>See <span class="q">&#34;<a href="cdb_plug.htm#GUID-39D2F826-7460-4439-B410-29E16C0CA0B1" title="In the CREATE PLUGGABLE DATABASE statement, you can specify the locations of files used by the new PDB.">File Location of the New PDB</a>&#34;</span>.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d264795e3449" headers="d264795e3206">
<p><code class="codeph">TEMPFILE REUSE</code></p>
</td>
<td class="cellalignment1865" headers="d264795e3449 d264795e3209">
<p>Do you want to reuse the temp file if a temp file exists in the target location?</p>
</td>
<td class="cellalignment1865" headers="d264795e3449 d264795e3212">
<p>Include the <code class="codeph">TEMPFILE REUSE</code> clause.</p>
</td>
<td class="cellalignment1875" headers="d264795e3449 d264795e3215">
<p>Omit the <code class="codeph">TEMPFILE REUSE</code> clause.</p>
<p>Ensure that there is no file with the same name as the new temp file in the target location.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d264795e3471" headers="d264795e3206">
<p><code class="codeph">USER_TABLESPACES</code></p>
</td>
<td class="cellalignment1865" headers="d264795e3471 d264795e3209">
<p>Do you want to specify which tablespaces are included in the new PDB and which tablespaces are excluded from the new PDB?</p>
<p>This feature is available starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2).</p>
</td>
<td class="cellalignment1865" headers="d264795e3471 d264795e3212">
<p>Include the <code class="codeph">USER_TABLESPACES</code> clause and specify the tablespaces that are included in the new PDB.</p>
</td>
<td class="cellalignment1875" headers="d264795e3471 d264795e3215">
<p>Omit the <code class="codeph">USER_TABLESPACES</code> clause.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d264795e3496" headers="d264795e3206">
<p><span class="italic">logging_clause</span></p>
</td>
<td class="cellalignment1865" headers="d264795e3496 d264795e3209">
<p>Do you want to specify the logging attribute of the tablespaces in the new PDB?</p>
<p>This feature is available starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2).</p>
</td>
<td class="cellalignment1865" headers="d264795e3496 d264795e3212">
<p>Include the <span class="italic">logging_clause</span>.</p>
</td>
<td class="cellalignment1875" headers="d264795e3496 d264795e3215">
<p>Omit the <span class="italic">logging_clause</span>.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d264795e3521" headers="d264795e3206">
<p><code class="codeph">ROLES</code></p>
</td>
<td class="cellalignment1865" headers="d264795e3521 d264795e3209">
<p>Do you want to grant predefined Oracle roles to the <code class="codeph">PDB_DBA</code> role locally in the PDB?</p>
<p>The new administrator for the PDB is granted the <code class="codeph">PDB_DBA</code> common role locally in the PDB. By default, the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement does not grant the administrator or the role any privileges.</p>
</td>
<td class="cellalignment1865" headers="d264795e3521 d264795e3212">
<p>Include the <code class="codeph">ROLES</code> clause and specify the predefined Oracle roles to grant to the <code class="codeph">PDB_DBA</code> role. The specified roles are granted to the <code class="codeph">PDB_DBA</code> role locally in the PDB. The user who runs the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement does not need to be granted the specified roles. See <a class="olink DBSEG4414" target="_blank" href="../DBSEG/authorization.htm#DBSEG4414"><span class="italic">Oracle Database Security Guide</span></a> for information about predefined Oracle roles.</p>
</td>
<td class="cellalignment1875" headers="d264795e3521 d264795e3215">
<p>Omit the <code class="codeph">ROLES</code> clause.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>The <code class="codeph">ROLES</code> clause can be used only when you are creating a PDB from the seed, but the other clauses described in <a href="cdb_plug.htm#GUID-534B3B1D-0ED7-4828-9CA4-B1757398801F__CEGFCFDA" title="This table describes each clause and when to use each clause.">Table 38-3</a> are general clauses. See <span class="q">&#34;<a href="cdb_plug.htm#GUID-59F42929-7237-4371-8934-921B46DB6F31" title="You use the CREATE PLUGGABLE DATABASE statement to create a PDB. To use this statement, you must understand the clauses for the statement and when to use each clause.">The CREATE PLUGGABLE DATABASE Statement</a>&#34;</span> for more information about the general clauses.</p>
</div>
</div>
<a id="ADMIN13569"></a><a id="ADMIN13570"></a><a id="ADMIN13967"></a><a id="ADMIN13571"></a><a id="ADMIN13850"></a>
<div class="props_rev_3"><a id="GUID-F462EB77-4D25-42E5-B919-42B283CE6CF0"></a>
<h3 id="ADMIN-GUID-F462EB77-4D25-42E5-B919-42B283CE6CF0" class="sect3"><span class="enumeration_section">38.3.2</span> Creating a PDB from the Seed</h3>
<div>
<p>You can create a PDB from the seed using the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement.</p>
<div class="section">
<p>Before creating a PDB from the seed, complete the prerequisites described in <span class="q">&#34;<a href="cdb_plug.htm#GUID-B26D56E1-B958-444F-864C-8AFDFF1566A6" title="Prerequisites must be met before creating a PDB.">Preparing for PDBs</a>&#34;</span>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To create a PDB from the seed:</p>
<ol>
<li>
<p>In SQL*Plus, ensure that the current container is the root.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-E1BBCE0F-76CA-49F3-9A6B-AC6B13AB9AC5" title="The data dictionary in each container in a CDB is separate, and the current container is the container whose data dictionary is used for name resolution and for privilege authorization. The current container can be the root or a PDB. Each session has exactly one current container at any point in time, but it is possible for a session to switch from one container to another.">About the Current Container</a>&#34;</span> and <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Run the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement, and specify a local administrator for the PDB. Specify other clauses when they are required.</p>
<p>See <span class="q">&#34;<a href="cdb_plug.htm#GUID-F462EB77-4D25-42E5-B919-42B283CE6CF0__CEGHJADJ">Examples of Creating a PDB from the Seed</a>&#34;</span>.</p>
<p>After you create the PDB, it is in mounted mode, and its status is <code class="codeph">NEW</code>. You can view the open mode of a PDB by querying the <code class="codeph">OPEN_MODE</code> column in the <code class="codeph">V$PDBS</code> view. You can view the status of a PDB by querying the <code class="codeph">STATUS</code> column of the <code class="codeph">CDB_PDBS</code> or <code class="codeph">DBA_PDBS</code> view.</p>
<p>A new default service is created for the PDB. The service has the same name as the PDB and can be used to access the PDB. Oracle Net Services must be configured properly for clients to access this service. See <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Open the new PDB in read/write mode.</p>
<p>You must open the new PDB in read/write mode for Oracle Database to complete the integration of the new PDB into the CDB. An error is returned if you attempt to open the PDB in read-only mode. After the PDB is opened in read/write mode, its status is <code class="codeph">NORMAL</code>.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-322C5C03-4C48-40CD-8230-0BA5F16BF96B" title="You can modify the open mode of a PDB by using the ALTER PLUGGABLE DATABASE SQL statement or the SQL*Plus STARTUP command.">Modifying the Open Mode of PDBs</a>&#34;</span> for more information.</p>
</li>
<li>
<p>Back up the PDB.</p>
<p>A PDB cannot be recovered unless it is backed up.</p>
<p><a class="olink BRADV428" target="_blank" href="../BRADV/rcmbckba.htm#BRADV428"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> for information about backing up a PDB.</p>
</li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<p>A local user with the name of the specified local administrator is created and granted the <code class="codeph">PDB_DBA</code> common role locally in the PDB. If this user was not granted administrator privileges during PDB creation, then use the <code class="codeph">SYS</code> and <code class="codeph">SYSTEM</code> common users to administer to the PDB.</p>
<div class="infobox-note" id="GUID-F462EB77-4D25-42E5-B919-42B283CE6CF0__GUID-28213FB2-1F59-4120-8E8F-F58453AA7D8D">
<p class="notep1">Note:</p>
<p>If an error is returned during PDB creation, then the PDB being created might be in an <code class="codeph">UNUSABLE</code> state. You can check a PDB&#39;s state by querying the <code class="codeph">CDB_PDBS</code> or <code class="codeph">DBA_PDBS</code> view, and you can learn more about PDB creation errors by checking the alert log. An unusable PDB can only be dropped, and it must be dropped before a PDB with the same name as the unusable PDB can be created.</p>
</div>
</div>
<!-- class="section" -->
<div class="section" id="GUID-F462EB77-4D25-42E5-B919-42B283CE6CF0__CEGHJADJ">
<p class="subhead3">Examples of Creating a PDB from the Seed</p>
</div>
<!-- class="section" -->
<div class="section">
<p>The following examples create a new PDB named <code class="codeph">salespdb</code> and a <code class="codeph">salesadm</code> local administrator given different factors.</p>
<p>In addition to creating the <code class="codeph">salespdb</code> PDB, this statement grants the <code class="codeph">PDB_DBA</code> role to the PDB administrator <code class="codeph">salesadm</code> and grants the specified predefined Oracle roles to the <code class="codeph">PDB_DBA</code> role locally in the PDB.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-F462EB77-4D25-42E5-B919-42B283CE6CF0__CEGEGBEE">
<p class="titleinexample">Example 38-18 Creating a PDB Using No Clauses</p>
<p>This example assumes the following factors:</p>
<ul style="list-style-type: disc;">
<li>
<p>Storage limits are not required for the PDB. Therefore, the <code class="codeph">STORAGE</code> clause is not required.</p>
</li>
<li>
<p>The PDB does not require a default tablespace.</p>
</li>
<li>
<p>The <code class="codeph">PATH_PREFIX</code> clause is not required.</p>
</li>
<li>
<p>The <code class="codeph">FILE_NAME_CONVERT</code> clause and the <code class="codeph">CREATE_FILE_DEST</code> clause are not required.</p>
<p>Either Oracle Managed Files is enabled for the CDB, or the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter is set. The files associated with the seed will be copied to a new location based on the Oracle Managed Files configuration or the initialization parameter setting.</p>
</li>
<li>
<p>There is no file with the same name as the new temp file that will be created in the target location. Therefore, the <code class="codeph">TEMPFILE REUSE</code> clause is not required.</p>
</li>
<li>
<p>No&nbsp;predefined Oracle roles need to be granted to the <code class="codeph">PDB_DBA</code> role.</p>
</li>
</ul>
<p>Given the preceding factors, the following statement creates the PDB:</p>
<pre dir="ltr">CREATE PLUGGABLE DATABASE salespdb ADMIN USER salesadm IDENTIFIED BY <span class="italic">password</span>;
</pre>
<div class="infoboxnotealso" id="GUID-F462EB77-4D25-42E5-B919-42B283CE6CF0__GUID-8A0A606A-1CD2-4DA4-A329-3362FBBB6664">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="omf.htm#GUID-4A3C4616-0D81-4BBA-8EAD-FCAA8AD5C15A" title="Oracle Database can manage the files that comprise the database.">Using Oracle Managed Files</a></p>
</li>
<li>
<p><a class="olink REFRN10322" target="_blank" href="../REFRN/GUID-074F8896-D565-4139-BCDB-C81C9D741941.htm#REFRN10322"><span class="italic">Oracle Database Reference</span></a> for information about the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter</p>
</li>
<li>
<p><a class="olink DBSEG33223" target="_blank" href="../DBSEG/authentication.htm#DBSEG33223"><span class="italic">Oracle Database Security Guide</span></a> for guidelines about choosing passwords</p>
</li>
</ul>
</div>
</div>
<!-- class="example" -->
<div class="example" id="GUID-F462EB77-4D25-42E5-B919-42B283CE6CF0__CEGJJIED">
<p class="titleinexample">Example 38-19 Creating a PDB and Granting Predefined Oracle Roles to the PDB Administrator</p>
<p>This example assumes the following factors:</p>
<ul style="list-style-type: disc;">
<li>
<p>Storage limits are not required for the PDB. Therefore, the <code class="codeph">STORAGE</code> clause is not required.</p>
</li>
<li>
<p>The PDB does not require a default tablespace.</p>
</li>
<li>
<p>The <code class="codeph">PATH_PREFIX</code> clause is not required.</p>
</li>
<li>
<p>The <code class="codeph">FILE_NAME_CONVERT</code> clause and the <code class="codeph">CREATE_FILE_DEST</code> clause are not required.</p>
<p>Either Oracle Managed Files is enabled, or the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter is set. The files associated with the seed will be copied to a new location based on the Oracle Managed Files configuration or the initialization parameter setting.</p>
</li>
<li>
<p>There is no file with the same name as the new temp file that will be created in the target location. Therefore, the <code class="codeph">TEMPFILE REUSE</code> clause is not required.</p>
</li>
<li>
<p>The <code class="codeph">PDB_DBA</code> role should be granted the following predefined Oracle role locally: <code class="codeph">DBA</code>.</p>
</li>
</ul>
<p>Given the preceding factors, the following statement creates the PDB:</p>
<pre dir="ltr">CREATE PLUGGABLE DATABASE salespdb ADMIN USER salesadm IDENTIFIED BY <span class="italic">password</span>
  ROLES=(DBA);
</pre>
<div class="infoboxnotealso" id="GUID-F462EB77-4D25-42E5-B919-42B283CE6CF0__GUID-B1D7FA5D-FF53-4CF6-A9EA-65C27C24A7CE">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="omf.htm#GUID-4A3C4616-0D81-4BBA-8EAD-FCAA8AD5C15A" title="Oracle Database can manage the files that comprise the database.">Using Oracle Managed Files</a></p>
</li>
<li>
<p><a class="olink REFRN10322" target="_blank" href="../REFRN/GUID-074F8896-D565-4139-BCDB-C81C9D741941.htm#REFRN10322"><span class="italic">Oracle Database Reference</span></a> for information about the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter</p>
</li>
<li>
<p><a class="olink DBSEG33223" target="_blank" href="../DBSEG/authentication.htm#DBSEG33223"><span class="italic">Oracle Database Security Guide</span></a> for guidelines about choosing passwords</p>
</li>
</ul>
</div>
</div>
<!-- class="example" -->
<div class="example" id="GUID-F462EB77-4D25-42E5-B919-42B283CE6CF0__CEGDIFGG">
<p class="titleinexample">Example 38-20 Creating a PDB Using the STORAGE, DEFAULT TABLESPACE, PATH_PREFIX, and FILE_NAME_CONVERT Clauses</p>
<p>This example assumes the following factors:</p>
<ul style="list-style-type: disc;">
<li>
<p>Storage limits must be enforced for the PDB. Therefore, the <code class="codeph">STORAGE</code> clause is required. Specifically, all tablespaces that belong to the PDB must not exceed 2 gigabytes.</p>
</li>
<li>
<p>A default permanent tablespace is required for any non-administrative users for which you do not specify a different permanent tablespace. Specifically, this example creates a default permanent tablespace named <code class="codeph">sales</code> with the following characteristics:</p>
<ul style="list-style-type: disc;">
<li>
<p>The single data file for the tablespace is <code class="codeph">sales01.dbf</code>, and the statement creates it in the /disk1/oracle/dbs/salespdb directory.</p>
</li>
<li>
<p>The <code class="codeph">SIZE</code> clause specifies that the initial size of the tablespace is 250 megabytes.</p>
</li>
<li>
<p>The <code class="codeph">AUTOEXTEND</code> clause enables automatic extension for the file.</p>
</li>
</ul>
</li>
<li>
<p>The PDB&#39;s relative directory object paths must be treated as relative to a specific directory. Therefore, the <code class="codeph">PATH_PREFIX</code> clause is required. In this example, the PDB&#39;s relative directory object paths must be treated as relative to the /disk1/oracle/dbs/salespdb directory.</p>
</li>
<li>
<p>The <code class="codeph">CREATE_FILE_DEST</code> clause will not be used, Oracle Managed Files is not enabled, and the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter is not set. Therefore, the <code class="codeph">FILE_NAME_CONVERT</code> clause is required. Specify the location of the data files for the seed on your system. In this example, Oracle Database copies the files from /disk1/oracle/dbs/pdbseed to /disk1/oracle/dbs/salespdb.</p>
<p>To view the location of the data files for the seed, run the query in <a href="cdb_mon.htm#GUID-1DED3127-84E4-4967-BEB3-D0ADEC622643__CHDHDICB">Example 43-7</a>.</p>
</li>
<li>
<p>There is no file with the same name as the new temp file that will be created in the target location. Therefore, the <code class="codeph">TEMPFILE REUSE</code> clause is not required.</p>
</li>
<li>
<p>No&nbsp;predefined Oracle roles need to be granted to the <code class="codeph">PDB_DBA</code> role.</p>
</li>
</ul>
<p>Given the preceding factors, the following statement creates the PDB:</p>
<pre dir="ltr">CREATE PLUGGABLE DATABASE salespdb ADMIN USER salesadm IDENTIFIED BY <span class="italic">password</span>
  STORAGE (MAXSIZE 2G)
  DEFAULT TABLESPACE sales 
    DATAFILE &#39;/disk1/oracle/dbs/salespdb/sales01.dbf&#39; SIZE 250M AUTOEXTEND ON
  PATH_PREFIX = &#39;/disk1/oracle/dbs/salespdb/&#39;
  FILE_NAME_CONVERT = (&#39;/disk1/oracle/dbs/pdbseed/&#39;, &#39;/disk1/oracle/dbs/salespdb/&#39;);
</pre>
<div class="infoboxnotealso" id="GUID-F462EB77-4D25-42E5-B919-42B283CE6CF0__GUID-83DD7E1C-C78F-44F4-8265-1FEE02E161FF">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink SQLRF53869" target="_blank" href="../SQLRF/statements_5005.htm#SQLRF53869"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about the <code class="codeph">DEFAULT</code> <code class="codeph">TABLESPACE</code> clause</p>
</li>
<li>
<p><a class="olink DBSEG33223" target="_blank" href="../DBSEG/authentication.htm#DBSEG33223"><span class="italic">Oracle Database Security Guide</span></a> for guidelines about choosing passwords</p>
</li>
</ul>
</div>
</div>
<!-- class="example" --></div>
</div>
</div>
<a id="ADMIN13583"></a>
<div class="props_rev_3"><a id="GUID-05702CEB-A43C-452C-8081-4CA68DDA8007"></a>
<h2 id="ADMIN-GUID-05702CEB-A43C-452C-8081-4CA68DDA8007" class="sect2"><span class="enumeration_section">38.4</span> Creating a PDB by Cloning an Existing PDB or Non-CDB</h2>
<div>
<p>You can create a PDB by cloning a local PDB, a remote PDB, or a non-CDB.</p>
<div class="infobox-note" id="GUID-05702CEB-A43C-452C-8081-4CA68DDA8007__GUID-6CEAF855-0324-4274-A807-9AFB5763448C">
<p class="notep1">Note:</p>
<p>Creating a PDB by cloning a non-CDB is available starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2).</p>
</div>
</div>
<a id="ADMIN13754"></a><a id="ADMIN13755"></a><a id="ADMIN14321"></a><a id="ADMIN13585"></a><a id="ADMIN14166"></a><a id="ADMIN13584"></a>
<div class="props_rev_3"><a id="GUID-8A6287A1-14E5-4B45-972F-FC2FB3CDCF8B"></a>
<h3 id="ADMIN-GUID-8A6287A1-14E5-4B45-972F-FC2FB3CDCF8B" class="sect3"><span class="enumeration_section">38.4.1</span> About Cloning a PDB</h3>
<div>
<p>You can use the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement to clone a PDB from a source PDB or from a non-CDB.</p>
<p>This technique clones a source PDB or non-CDB and plugs the clone into the CDB. To use this technique, you must include a <code class="codeph">FROM</code> clause that specifies the source.</p>
<p>The source is the existing PDB or non-CDB that is copied. The target PDB is the clone of the source. The source can be a PDB in the local CDB, a PDB in a remote CDB, or a non-CDB. The <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement copies the files associated with the source to a new location and associates the files with the target PDB.</p>
<p>One use of cloning is for testing. Cloning enables you to create one or more clones of a PDB or non-CDB and safely test them in isolation. For example, you might test a new or modified application on a cloned PDB before using the application with a production PDB.</p>
<p><a href="cdb_plug.htm#GUID-8A6287A1-14E5-4B45-972F-FC2FB3CDCF8B__CEGGCIDD">Figure 38-3</a> illustrates how this technique creates a new PDB when the source is a local PDB.</p>
<div class="figure" id="GUID-8A6287A1-14E5-4B45-972F-FC2FB3CDCF8B__CEGGCIDD">
<p class="titleinfigure">Figure 38-3 Clone a Local PDB</p>
<img width="546" height="402" src="img/GUID-ECAA2807-3A07-4F30-9F16-2B033DE63D95-default.png" alt="Description of Figure 38-3 follows" title="Description of Figure 38-3 follows"/><br/>
<a href="img_text/GUID-ECAA2807-3A07-4F30-9F16-2B033DE63D95-print.htm">Description of &#34;Figure 38-3 Clone a Local PDB&#34;</a></div>
<!-- class="figure" -->
<p>When the source is a PDB in a remote CDB, you must specify a database link to the remote CDB in the <code class="codeph">FROM</code> clause. The database link connects either to the root of the remote CDB or to the remote source PDB from the CDB that will contain the new PDB. <a href="cdb_plug.htm#GUID-8A6287A1-14E5-4B45-972F-FC2FB3CDCF8B__CEGHBGGJ">Figure 38-4</a> illustrates how this technique creates a new PDB when the source PDB is remote.</p>
<div class="figure" id="GUID-8A6287A1-14E5-4B45-972F-FC2FB3CDCF8B__CEGHBGGJ">
<p class="titleinfigure">Figure 38-4 Creating a PDB by Cloning a Remote PDB</p>
<img width="627" height="687" src="img/GUID-2F754CCE-5879-4882-8649-3F48B040672B-default.png" alt="Description of Figure 38-4 follows" title="Description of Figure 38-4 follows"/><br/>
<a href="img_text/GUID-2F754CCE-5879-4882-8649-3F48B040672B-print.htm">Description of &#34;Figure 38-4 Creating a PDB by Cloning a Remote PDB&#34;</a></div>
<!-- class="figure" -->
<p>When the source is a non-CDB, you must specify a database link to the non-CDB in the <code class="codeph">FROM</code> clause. <a href="cdb_plug.htm#GUID-8A6287A1-14E5-4B45-972F-FC2FB3CDCF8B__CEGJIEAI">Figure 38-5</a> illustrates how this technique creates a new PDB when the source is a remote non-CDB.</p>
<div class="figure" id="GUID-8A6287A1-14E5-4B45-972F-FC2FB3CDCF8B__CEGJIEAI">
<p class="titleinfigure">Figure 38-5 Creating a PDB by Cloning a Non-CDB</p>
<img width="638" height="570" src="img/GUID-95D7CEE8-CD67-48B0-8C88-9D3892C4A431-default.png" alt="Description of Figure 38-5 follows" title="Description of Figure 38-5 follows"/><br/>
<a href="img_text/GUID-95D7CEE8-CD67-48B0-8C88-9D3892C4A431-print.htm">Description of &#34;Figure 38-5 Creating a PDB by Cloning a Non-CDB&#34;</a></div>
<!-- class="figure" -->
<div class="infoboxnotealso" id="GUID-8A6287A1-14E5-4B45-972F-FC2FB3CDCF8B__GUID-0D128A0B-3EF1-4B66-A522-1DCAAA9B2408">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="cdb_plug.htm#GUID-59F42929-7237-4371-8934-921B46DB6F31" title="You use the CREATE PLUGGABLE DATABASE statement to create a PDB. To use this statement, you must understand the clauses for the statement and when to use each clause.">The CREATE PLUGGABLE DATABASE Statement</a>&#34;</span></p>
</div>
<div class="infobox-note" id="GUID-8A6287A1-14E5-4B45-972F-FC2FB3CDCF8B__GUID-5225366C-951D-4AE9-AD69-2BBEA3EC1A31">
<p class="notep1">Note:</p>
<p>You cannot use the <code class="codeph">FROM</code> clause in the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement to create a PDB from the seed (<code class="codeph">PDB$SEED</code>). See <span class="q">&#34;<a href="cdb_plug.htm#GUID-CCA938BD-52BE-422C-86AF-576D3E02B96B" title="You can use the CREATE PLUGGABLE DATABASE statement to create a PDB in a CDB using the files of the seed.">Creating a PDB Using the Seed</a>&#34;</span> for information about creating a PDB from the seed.</p>
</div>
<p>When you clone a PDB, you must address the questions in <a href="cdb_plug.htm#GUID-8A6287A1-14E5-4B45-972F-FC2FB3CDCF8B__CEGFDFJE" title="This table describes each clause and when to use each clause.">Table 38-4</a>. The table describes which <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> clauses you must specify based on different factors.</p>
<div class="tblformalwide" id="GUID-8A6287A1-14E5-4B45-972F-FC2FB3CDCF8B__CEGFDFJE">
<p class="titleintable">Table 38-4 Clauses for Cloning a PDB</p>
<table class="cellalignment1880" title="Clauses for Cloning a PDB" summary="This table describes each clause and when to use each clause.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1867" id="d264795e4446">Clause</th>
<th class="cellalignment1863" id="d264795e4449">Question</th>
<th class="cellalignment1863" id="d264795e4452">Yes</th>
<th class="cellalignment1872" id="d264795e4455">No</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d264795e4460" headers="d264795e4446">
<p><code class="codeph">PATH_PREFIX</code></p>
</td>
<td class="cellalignment1865" headers="d264795e4460 d264795e4449">
<p>Do you want to use a <code class="codeph">PATH_PREFIX</code> clause to ensure that all relative directory object paths associated with the PDB are treated as relative to the specified directory or its subdirectories?</p>
<p>The <code class="codeph">PATH_PREFIX</code> clause is ignored when absolute paths are used for directory objects.</p>
<p>The <code class="codeph">PATH_PREFIX</code> clause does not affect files created by Oracle Managed Files.</p>
</td>
<td class="cellalignment1865" headers="d264795e4460 d264795e4452">
<p>Include a <code class="codeph">PATH_PREFIX</code> clause that specifies an absolute path.</p>
</td>
<td class="cellalignment1875" headers="d264795e4460 d264795e4455">
<p>Set the <code class="codeph">PATH_PREFIX</code> clause to <code class="codeph">NONE</code> or omit it.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d264795e4496" headers="d264795e4446">
<p><code class="codeph">FILE_NAME_CONVERT</code></p>
</td>
<td class="cellalignment1865" headers="d264795e4496 d264795e4449">
<p>Do you want to use a <code class="codeph">FILE_NAME_CONVERT</code> clause to specify the target locations of the files?</p>
</td>
<td class="cellalignment1865" headers="d264795e4496 d264795e4452">
<p>Include a <code class="codeph">FILE_NAME_CONVERT</code> clause that specifies the target locations of the files based on the names of the source files.</p>
</td>
<td class="cellalignment1875" headers="d264795e4496 d264795e4455">
<p>Omit the <code class="codeph">FILE_NAME_CONVERT</code> clause.</p>
<p>Use one of these techniques to specify the target locations of the files:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">CREATE_FILE_DEST</code> clause</p>
</li>
<li>
<p>Enable Oracle Managed Files for the CDB for it to determine the target locations.</p>
</li>
<li>
<p>Specify the target locations in the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter.</p>
</li>
</ul>
<p>See <span class="q">&#34;<a href="cdb_plug.htm#GUID-39D2F826-7460-4439-B410-29E16C0CA0B1" title="In the CREATE PLUGGABLE DATABASE statement, you can specify the locations of files used by the new PDB.">File Location of the New PDB</a>&#34;</span>.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d264795e4555" headers="d264795e4446">
<p><code class="codeph">CREATE_FILE_DEST</code></p>
</td>
<td class="cellalignment1865" headers="d264795e4555 d264795e4449">
<p>Do you want to use a <code class="codeph">CREATE_FILE_DEST</code> clause to specify the Oracle Managed Files default location for the PDB&#39;s files?</p>
</td>
<td class="cellalignment1865" headers="d264795e4555 d264795e4452">
<p>Include a <code class="codeph">CREATE_FILE_DEST</code> clause that specifies the default file system directory or Oracle ASM disk group for the PDB&#39;s files.</p>
</td>
<td class="cellalignment1875" headers="d264795e4555 d264795e4455">
<p>Omit the <code class="codeph">CREATE_FILE_DEST</code> clause.</p>
<p>Use one of these techniques to specify the target locations of the files:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">FILE_NAME_CONVERT</code> clause</p>
</li>
<li>
<p>Enable Oracle Managed Files for the CDB for it to determine the target locations.</p>
</li>
<li>
<p>Specify the target locations in the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter.</p>
</li>
</ul>
<p>See <span class="q">&#34;<a href="cdb_plug.htm#GUID-39D2F826-7460-4439-B410-29E16C0CA0B1" title="In the CREATE PLUGGABLE DATABASE statement, you can specify the locations of files used by the new PDB.">File Location of the New PDB</a>&#34;</span>.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d264795e4614" headers="d264795e4446">
<p><code class="codeph">SERVICE_NAME_CONVERT</code></p>
</td>
<td class="cellalignment1865" headers="d264795e4614 d264795e4449">
<p>Do you want to use a <code class="codeph">SERVICE_NAME_CONVERT</code> clause to rename the user-defined services of the new PDB based on the service names of the source PDB?</p>
</td>
<td class="cellalignment1865" headers="d264795e4614 d264795e4452">
<p>Include a <code class="codeph">SERVICE_NAME_CONVERT</code> clause that specifies the new name of a service and the service name it is replacing. Specify multiple service names and replacement service names if necessary.</p>
</td>
<td class="cellalignment1875" headers="d264795e4614 d264795e4455">
<p>Omit the <code class="codeph">SERVICE_NAME_CONVERT</code> clause.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d264795e4637" headers="d264795e4446">
<p><code class="codeph">STORAGE</code></p>
</td>
<td class="cellalignment1865" headers="d264795e4637 d264795e4449">
<p>Do you want to limit the amount of storage that the PDB can use?</p>
</td>
<td class="cellalignment1865" headers="d264795e4637 d264795e4452">
<p>Specify a <code class="codeph">STORAGE</code> clause with the appropriate limits.</p>
</td>
<td class="cellalignment1875" headers="d264795e4637 d264795e4455">
<p>Omit the <code class="codeph">STORAGE</code> clause, or specify unlimited storage using the <code class="codeph">STORAGE</code> clause.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d264795e4660" headers="d264795e4446">
<p><code class="codeph">TEMPFILE REUSE</code></p>
</td>
<td class="cellalignment1865" headers="d264795e4660 d264795e4449">
<p>Do you want to reuse the temp file if a temp file exists in the target location?</p>
</td>
<td class="cellalignment1865" headers="d264795e4660 d264795e4452">
<p>Include the <code class="codeph">TEMPFILE REUSE</code> clause.</p>
</td>
<td class="cellalignment1875" headers="d264795e4660 d264795e4455">
<p>Omit the <code class="codeph">TEMPFILE REUSE</code> clause.</p>
<p>Ensure that there is no file with the same name as the new temp file in the target location.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d264795e4682" headers="d264795e4446">
<p><code class="codeph">USER_TABLESPACES</code></p>
</td>
<td class="cellalignment1865" headers="d264795e4682 d264795e4449">
<p>Do you want to specify which tablespaces are included in the new PDB and which tablespaces are excluded from the new PDB?</p>
<p>This feature is available starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2).</p>
</td>
<td class="cellalignment1865" headers="d264795e4682 d264795e4452">
<p>Include the <code class="codeph">USER_TABLESPACES</code> clause and specify the tablespaces that are included in the new PDB.</p>
</td>
<td class="cellalignment1875" headers="d264795e4682 d264795e4455">
<p>Omit the <code class="codeph">USER_TABLESPACES</code> clause.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d264795e4707" headers="d264795e4446">
<p><span class="italic">logging_clause</span></p>
</td>
<td class="cellalignment1865" headers="d264795e4707 d264795e4449">
<p>Do you want to specify the logging attribute of the tablespaces in the new PDB?</p>
<p>This feature is available starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2).</p>
</td>
<td class="cellalignment1865" headers="d264795e4707 d264795e4452">
<p>Include the <span class="italic">logging_clause</span>.</p>
</td>
<td class="cellalignment1875" headers="d264795e4707 d264795e4455">
<p>Omit the <span class="italic">logging_clause</span>.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d264795e4732" headers="d264795e4446">
<p><code class="codeph">NO DATA</code></p>
</td>
<td class="cellalignment1865" headers="d264795e4732 d264795e4449">
<p>Do you want to specify that the data model definition of the source PDB is cloned but not the data of the source PDB?</p>
<p>This feature is available starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2).</p>
</td>
<td class="cellalignment1865" headers="d264795e4732 d264795e4452">
<p>Include the <code class="codeph">NO DATA</code> clause.</p>
</td>
<td class="cellalignment1875" headers="d264795e4732 d264795e4455">
<p>Omit the <code class="codeph">NO DATA</code> clause.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1869" id="d264795e4757" headers="d264795e4446">
<p><code class="codeph">SNAPSHOT COPY</code></p>
</td>
<td class="cellalignment1865" headers="d264795e4757 d264795e4449">
<p>Do you want to clone a PDB using a storage snapshot?</p>
</td>
<td class="cellalignment1865" headers="d264795e4757 d264795e4452">
<p>Specify a <code class="codeph">SNAPSHOT COPY</code> clause to indicate that cloning is to be performed using storage snapshots.</p>
<p>Creating a PDB clone with storage snapshots makes creating a clone nearly instantaneous because it does not require copying the source PDB&#39;s data files. <code class="codeph">SNAPSHOT</code> <code class="codeph">COPY</code> is supported only if the underlying file system supports storage snapshots.</p>
</td>
<td class="cellalignment1875" headers="d264795e4757 d264795e4455">
<p>Omit the <code class="codeph">SNAPSHOT COPY</code> clause.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>Excluding the <code class="codeph">NO DATA</code> clause and the <code class="codeph">SNAPSHOT</code> <code class="codeph">COPY</code> clause, the clauses described in <a href="cdb_plug.htm#GUID-8A6287A1-14E5-4B45-972F-FC2FB3CDCF8B__CEGFDFJE" title="This table describes each clause and when to use each clause.">Table 38-4</a> are general clauses. See <span class="q">&#34;<a href="cdb_plug.htm#GUID-59F42929-7237-4371-8934-921B46DB6F31" title="You use the CREATE PLUGGABLE DATABASE statement to create a PDB. To use this statement, you must understand the clauses for the statement and when to use each clause.">The CREATE PLUGGABLE DATABASE Statement</a>&#34;</span> for more information about the general clauses.</p>
<div class="section" id="GUID-8A6287A1-14E5-4B45-972F-FC2FB3CDCF8B__CEGEECGG">
<p class="subhead3">The SNAPSHOT COPY Clause</p>
</div>
<!-- class="section" -->
<div class="section">
<p>When you use the <code class="codeph">SNAPSHOT</code> <code class="codeph">COPY</code> clause, all of the data files of the source PDB must be stored in the same storage type.</p>
<p>When you use the <code class="codeph">SNAPSHOT</code> <code class="codeph">COPY</code> clause to create a clone of a source PDB and the <code class="codeph">CLONEDB</code> initialization parameter is set to <code class="codeph">FALSE</code>, the underlying file system for the source PDB&#39;s files must support storage snapshots. Such file systems include Oracle Automatic Storage Management Cluster File System (Oracle ACFS) and Direct NFS Client storage.</p>
<p>When you use the <code class="codeph">SNAPSHOT</code> <code class="codeph">COPY</code> clause to create a clone of a source PDB and the <code class="codeph">CLONEDB</code> initialization parameter is set to <code class="codeph">TRUE</code>, the underlying file system for the source PDB&#39;s files can be any local file system, network file system (NFS), or clustered file system that has Direct NFS enabled. However, the source PDB must remain in open read-only mode as long as any clones exist.</p>
<p>Direct NFS Client enables an Oracle database to access network attached storage (NAS) devices directly, rather than using the operating system kernel NFS client. If the PDB&#39;s files are stored on Direct NFS Client storage, then the following additional requirements must be met:</p>
<ul style="list-style-type: disc;">
<li>
<p>The source PDB&#39;s files must be located on an NFS volume.</p>
</li>
<li>
<p>Storage credentials must be stored in a Transparent Data Encryption keystore.</p>
</li>
<li>
<p>The storage user must have the privileges required to create and destroy snapshots on the volume that hosts the source PDB&#39;s files.</p>
</li>
<li>
<p>Credentials must be stored in the keystore using an <code class="codeph">ADMINISTER</code> <code class="codeph">KEY</code> <code class="codeph">MANAGEMENT</code> <code class="codeph">ADD</code> <code class="codeph">SECRET</code> SQL statement.</p>
<p>The following example configures an Oracle Database secret in a software keystore:</p>
<pre dir="ltr">ADMINISTER KEY MANAGEMENT  
  ADD SECRET &#39;<span class="italic">secret</span>&#39; FOR CLIENT &#39;<span class="italic">client_name</span>&#39; 
  USING TAG &#39;<span class="italic">storage_user</span>&#39; 
  IDENTIFIED BY  <span class="italic">keystore_password</span>  WITH BACKUP;
</pre>
<p>Run this statement to add a separate entry for each storage server in the configuration. In the previous example, the following values must be specified:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="italic"><code class="codeph">secret</code></span> is the storage password.</p>
</li>
<li>
<p><span class="italic"><code class="codeph">client_name</code></span> is the storage server. On a Linux or UNIX platform, it is the name entered in /etc/hosts or the IP address of the storage server.</p>
</li>
<li>
<p><span class="italic"><code class="codeph">tag</code></span> is the username passed to the storage server.</p>
</li>
<li>
<p><span class="italic"><code class="codeph">keystore_password</code></span> is the password for the keystore.</p>
</li>
</ul>
<p>See <a class="olink ASOAG10475" target="_blank" href="../ASOAG/managing-keystore-and-tde-master-encryption-key.htm#ASOAG10475"><span class="italic">Oracle Database Advanced Security Guide</span></a> for more information about managing keystores and secrets.</p>
</li>
</ul>
<p>PDB clones created using the <code class="codeph">SNAPSHOT</code> <code class="codeph">COPY</code> clause cannot be unplugged. They can only be dropped. Attempting to unplug a clone created using the <code class="codeph">SNAPSHOT</code> <code class="codeph">COPY</code> clause results in an error.</p>
<p>For a PDB created using the <code class="codeph">SNAPSHOT</code> <code class="codeph">COPY</code> clause in an Oracle Real Application Clusters (Oracle RAC) environment, each node that must access the PDB&#39;s files must be mounted.</p>
<p>Storage clones are named and tagged using the destination PDB&#39;s GUID. You can query the <code class="codeph">CLONETAG</code> column of <code class="codeph">DBA_PDB_HISTORY</code> view to view clone tags for storage clones.</p>
<div class="infobox-note" id="GUID-8A6287A1-14E5-4B45-972F-FC2FB3CDCF8B__GUID-D92656F4-B158-40D1-94A6-BF80C80ECC5F">
<p class="notep1">Note:</p>
As long as any clones created from a source PDB with the <code class="codeph">SNAPSHOT</code> <code class="codeph">COPY</code> clause exist, do not drop the source PDB. When the source PDB is dropped, any such clones that are closed cannot be opened, and opened clones will raise errors.</div>
<div class="infoboxnotealso" id="GUID-8A6287A1-14E5-4B45-972F-FC2FB3CDCF8B__GUID-E5C87C2A-2F7C-4B03-A716-95BB3F3A5B05">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink OSTMG31000" target="_blank" href="../OSTMG/GUID-C91D3A8E-F329-44BE-97B7-8AB41897D8E1.htm#OSTMG31000"><span class="italic">Oracle Automatic Storage Management Administrator&#39;s Guide</span></a> for more information about Oracle ACFS</p>
</li>
<li>
<p><a class="olink CWGEN" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=CWGEN"><span class="italic">Oracle Grid Infrastructure Installation Guide</span></a> for your operating system for information about Direct NFS Client</p>
</li>
<li>
<p><a class="olink ASOAG600" target="_blank" href="../ASOAG/asopart1.htm#ASOAG600"><span class="italic">Oracle Database Advanced Security Guide</span></a> for more information about Transparent Data Encryption</p>
</li>
<li>
<p>My Oracle Support Note 1597027.1 for more information about supported platforms for snapshot cloning of PDBs:</p>
<pre dir="ltr"><a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1597027.1" target="_blank">https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1597027.1</a>
</pre></li>
<li>
<p><span class="q">&#34;<a href="cdb_mon.htm#GUID-626B9812-6938-4268-806A-DAF6D5B4F2E6" title="You can determine your current container ID or container name in a CDB.">Determining the Current Container ID or Name</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN13589"></a><a id="ADMIN13590"></a><a id="ADMIN13591"></a><a id="ADMIN13592"></a><a id="ADMIN14331"></a><a id="ADMIN13586"></a>
<div class="props_rev_3"><a id="GUID-B39552A6-9206-40FE-B168-962215C7E743"></a>
<h3 id="ADMIN-GUID-B39552A6-9206-40FE-B168-962215C7E743" class="sect3"><span class="enumeration_section">38.4.2</span> Cloning a Local PDB</h3>
<div>
<p>This section describes cloning a local PDB. After cloning a local PDB, the source and target PDBs are in the same CDB.</p>
<div class="section">
<p>The following prerequisites must be met:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Complete the prerequisites described in <span class="q">&#34;<a href="cdb_plug.htm#GUID-B26D56E1-B958-444F-864C-8AFDFF1566A6" title="Prerequisites must be met before creating a PDB.">Preparing for PDBs</a>&#34;</span>.</p>
</li>
<li>
<p>The current user must have the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> system privilege in both the root and the source PDB.</p>
</li>
<li>
<p>The source PDB must be in open read-only mode.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To clone a local PDB:</p>
<ol>
<li>
<p>In SQL*Plus, ensure that the current container is the root.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-E1BBCE0F-76CA-49F3-9A6B-AC6B13AB9AC5" title="The data dictionary in each container in a CDB is separate, and the current container is the container whose data dictionary is used for name resolution and for privilege authorization. The current container can be the root or a PDB. Each session has exactly one current container at any point in time, but it is possible for a session to switch from one container to another.">About the Current Container</a>&#34;</span> and <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Run the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement, and specify the source PDB in the <code class="codeph">FROM</code> clause. Specify other clauses when they are required.</p>
<p>See <span class="q">&#34;<a href="cdb_plug.htm#GUID-B39552A6-9206-40FE-B168-962215C7E743__CEGDJFJB">Examples of Cloning a Local PDB</a>&#34;</span>.</p>
<p>After you create the PDB, it is in mounted mode, and its status is <code class="codeph">NEW</code>. You can view the open mode of a PDB by querying the <code class="codeph">OPEN_MODE</code> column in the <code class="codeph">V$PDBS</code> view. You can view the status of a PDB by querying the <code class="codeph">STATUS</code> column of the <code class="codeph">CDB_PDBS</code> or <code class="codeph">DBA_PDBS</code> view.</p>
<p>A new default service is created for the PDB. The service has the same name as the PDB and can be used to access the PDB. Oracle Net Services must be configured properly for clients to access this service. See <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Open the new PDB in read/write mode.</p>
<p>You must open the new PDB in read/write mode for Oracle Database to complete the integration of the new PDB into the CDB. An error is returned if you attempt to open the PDB in read-only mode. After the PDB is opened in read/write mode, its status is <code class="codeph">NORMAL</code>.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-322C5C03-4C48-40CD-8230-0BA5F16BF96B" title="You can modify the open mode of a PDB by using the ALTER PLUGGABLE DATABASE SQL statement or the SQL*Plus STARTUP command.">Modifying the Open Mode of PDBs</a>&#34;</span> for more information.</p>
</li>
<li>
<p>Back up the PDB.</p>
<p>A PDB cannot be recovered unless it is backed up.</p>
<p><a class="olink BRADV428" target="_blank" href="../BRADV/rcmbckba.htm#BRADV428"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> for information about backing up a PDB.</p>
</li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infobox-note" id="GUID-B39552A6-9206-40FE-B168-962215C7E743__GUID-66D9D9B6-EA6A-406B-9FA0-84C33639E792">
<p class="notep1">Note:</p>
<p>If an error is returned during PDB creation, then the PDB being created might be in an <code class="codeph">UNUSABLE</code> state. You can check a PDB&#39;s state by querying the <code class="codeph">CDB_PDBS</code> or <code class="codeph">DBA_PDBS</code> view, and you can learn more about PDB creation errors by checking the alert log. An unusable PDB can only be dropped, and it must be dropped before a PDB with the same name as the unusable PDB can be created.</p>
</div>
</div>
<!-- class="section" -->
<div class="section" id="GUID-B39552A6-9206-40FE-B168-962215C7E743__CEGDJFJB">
<p class="subhead3">Examples of Cloning a Local PDB</p>
</div>
<!-- class="section" -->
<div class="section">
<p>The following examples clone a local source PDB named <code class="codeph">pdb1</code> to a target PDB named <code class="codeph">pdb2</code> given different factors.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-B39552A6-9206-40FE-B168-962215C7E743__CEGGGAGG">
<p class="titleinexample">Example 38-21 Cloning a Local PDB Using No Clauses</p>
<p>This example assumes the following factors:</p>
<ul style="list-style-type: disc;">
<li>
<p>The <code class="codeph">PATH_PREFIX</code> clause is not required.</p>
</li>
<li>
<p>The <code class="codeph">FILE_NAME_CONVERT</code> clause and the <code class="codeph">CREATE_FILE_DEST</code> clause are not required.</p>
<p>Either Oracle Managed Files is enabled, or the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter is set. Therefore, the <code class="codeph">FILE_NAME_CONVERT</code> clause is not required. The files will be copied to a new location based on the Oracle Managed Files configuration or the initialization parameter setting.</p>
</li>
<li>
<p>Storage limits are not required for the PDB. Therefore, the <code class="codeph">STORAGE</code> clause is not required.</p>
</li>
<li>
<p>There is no file with the same name as the new temp file that will be created in the target location. Therefore, the <code class="codeph">TEMPFILE REUSE</code> clause is not required.</p>
</li>
</ul>
<p>Given the preceding factors, the following statement clones the <code class="codeph">pdb2</code> PDB from the <code class="codeph">pdb1</code> PDB:</p>
<pre dir="ltr">CREATE PLUGGABLE DATABASE pdb2 FROM pdb1;
</pre>
<div class="infoboxnotealso" id="GUID-B39552A6-9206-40FE-B168-962215C7E743__GUID-99F70C52-970F-462D-8926-05F79107ED58">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="omf.htm#GUID-4A3C4616-0D81-4BBA-8EAD-FCAA8AD5C15A" title="Oracle Database can manage the files that comprise the database.">Using Oracle Managed Files</a></p>
</li>
<li>
<p><a class="olink REFRN10322" target="_blank" href="../REFRN/GUID-074F8896-D565-4139-BCDB-C81C9D741941.htm#REFRN10322"><span class="italic">Oracle Database Reference</span></a> for information about the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter</p>
</li>
</ul>
</div>
</div>
<!-- class="example" -->
<div class="example" id="GUID-B39552A6-9206-40FE-B168-962215C7E743__CEGHFCBB">
<p class="titleinexample">Example 38-22 Cloning a Local PDB With the PATH_PREFIX, FILE_NAME_CONVERT, and SERVICE_NAME_CONVERT Clauses</p>
<p>This example assumes the following factors:</p>
<ul style="list-style-type: disc;">
<li>
<p>The PDB&#39;s relative directory object paths must be treated as relative to a specific directory. Therefore, the <code class="codeph">PATH_PREFIX</code> clause is required. In this example, the PDB&#39;s relative directory object paths must be treated as relative to the /disk2/oracle/pdb2 directory and its subdirectories.</p>
</li>
<li>
<p>The <code class="codeph">FILE_NAME_CONVERT</code> clause is required to specify the target locations of the copied files. In this example, the files are copied from /disk1/oracle/pdb1 to /disk2/oracle/pdb2.</p>
<p>The <code class="codeph">CREATE_FILE_DEST</code> clause is not used, and neither Oracle Managed Files nor the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter is used to specify the target locations of the copied files.</p>
<p>To view the location of the data files for a PDB, run the query in <a href="cdb_mon.htm#GUID-1DED3127-84E4-4967-BEB3-D0ADEC622643__CHDHDICB">Example 43-7</a>.</p>
</li>
<li>
<p>Storage limits are not required for the PDB. Therefore, the <code class="codeph">STORAGE</code> clause is not required.</p>
</li>
<li>
<p>There is no file with the same name as the new temp file that will be created in the target location. Therefore, the <code class="codeph">TEMPFILE REUSE</code> clause is not required.</p>
</li>
<li>
<p>The PDB that is being cloned <code class="codeph">(pdb1</code>) has two user-defined services: <code class="codeph">salesrep</code> and <code class="codeph">orders</code>. To keep the service names in the CDB unique, these service names will be renamed to <code class="codeph">salesperson</code> and <code class="codeph">orderentry</code>, respectively, in the cloned PDB (<code class="codeph">pdb2</code>).</p>
</li>
<li>
<p>Future tablespaces created within the PDB will be created with the <code class="codeph">NOLOGGING</code> attribute by default. This feature is available starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2).</p>
</li>
</ul>
<p>Given the preceding factors, the following statement clones the <code class="codeph">pdb2</code> PDB from the <code class="codeph">pdb1</code> PDB:</p>
<pre dir="ltr">CREATE PLUGGABLE DATABASE pdb2 FROM pdb1 
  PATH_PREFIX = &#39;/disk2/oracle/pdb2&#39;
  FILE_NAME_CONVERT = (&#39;/disk1/oracle/pdb1/&#39;, &#39;/disk2/oracle/pdb2/&#39;)
  SERVICE_NAME_CONVERT = (&#39;salesrep&#39;,&#39;salesperson&#39;,&#39;orders&#39;,&#39;orderentry&#39;)
  NOLOGGING;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-B39552A6-9206-40FE-B168-962215C7E743__CEGCIDDB">
<p class="titleinexample">Example 38-23 Cloning a Local PDB Using the FILE_NAME_CONVERT, STORAGE, and SERVICE_NAME_CONVERT Clauses</p>
<p>This example assumes the following factors:</p>
<ul style="list-style-type: disc;">
<li>
<p>The <code class="codeph">PATH_PREFIX</code> clause is not required.</p>
</li>
<li>
<p>The <code class="codeph">FILE_NAME_CONVERT</code> clause is required to specify the target locations of the copied files. In this example, the files are copied from /disk1/oracle/pdb1 to /disk2/oracle/pdb2.</p>
<p>The <code class="codeph">CREATE_FILE_DEST</code> clause is not used, and neither Oracle Managed Files nor the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter is used to specify the target locations of the copied files.</p>
<p>To view the location of the data files for a PDB, run the query in <a href="cdb_mon.htm#GUID-1DED3127-84E4-4967-BEB3-D0ADEC622643__CHDHDICB">Example 43-7</a>.</p>
</li>
<li>
<p>Storage limits must be enforced for the PDB. Therefore, the <code class="codeph">STORAGE</code> clause is required. Specifically, all tablespaces that belong to the PDB must not exceed 2 gigabytes.</p>
</li>
<li>
<p>The PDB that is being cloned <code class="codeph">(pdb1</code>) has two user-defined services: <code class="codeph">salesrep</code> and <code class="codeph">orders</code>. To keep the service names in the CDB unique, these service names will be renamed to <code class="codeph">salesperson</code> and <code class="codeph">orderentry</code>, respectively, in the cloned PDB (<code class="codeph">pdb2</code>).</p>
</li>
<li>
<p>There is no file with the same name as the new temp file that will be created in the target location. Therefore, the <code class="codeph">TEMPFILE REUSE</code> clause is not required.</p>
</li>
</ul>
<p>Given the preceding factors, the following statement clones the <code class="codeph">pdb2</code> PDB from the <code class="codeph">pdb1</code> PDB:</p>
<pre dir="ltr">CREATE PLUGGABLE DATABASE pdb2 FROM pdb1 
  FILE_NAME_CONVERT = (&#39;/disk1/oracle/pdb1/&#39;, &#39;/disk2/oracle/pdb2/&#39;)
  STORAGE (MAXSIZE 2G)
  SERVICE_NAME_CONVERT = (&#39;salesrep&#39;,&#39;salesperson&#39;,&#39;orders&#39;,&#39;orderentry&#39;);
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-B39552A6-9206-40FE-B168-962215C7E743__GUID-E67C9C2A-5ED2-4124-8946-0219F209C6CF">
<p class="titleinexample">Example 38-24 Cloning a Local PDB Without Cloning Its Data</p>
<p>This example assumes the following factors:</p>
<ul style="list-style-type: disc;">
<li>
<p>The <code class="codeph">NO DATA</code> clause is required because the goal is to clone the data model definition of the source PDB without cloning its data.</p>
</li>
<li>
<p>The <code class="codeph">PATH_PREFIX</code> clause is not required.</p>
</li>
<li>
<p>The <code class="codeph">FILE_NAME_CONVERT</code> clause and the <code class="codeph">CREATE_FILE_DEST</code> clause are not required.</p>
<p>Either Oracle Managed Files is enabled, or the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter is set. Therefore, the <code class="codeph">FILE_NAME_CONVERT</code> clause is not required. The files will be copied to a new location based on the Oracle Managed Files configuration or the initialization parameter setting.</p>
</li>
<li>
<p>Storage limits are not required for the PDB. Therefore, the <code class="codeph">STORAGE</code> clause is not required.</p>
</li>
<li>
<p>There is no file with the same name as the new temp file that will be created in the target location. Therefore, the <code class="codeph">TEMPFILE REUSE</code> clause is not required.</p>
</li>
</ul>
<p>Assume that the source PDB <code class="codeph">pdb1</code> has a large amount of data. The following steps illustrate how the clone does not contain the source PDB&#39;s data when the operation is complete:</p>
<ol>
<li>
<p>With the source PDB <code class="codeph">pdb1</code> as the current container, query a table with a large amount of data:</p>
<pre dir="ltr">SELECT COUNT(*) FROM tpch.lineitem;

  COUNT(*)
----------
   6001215
</pre>
<p>The table has over six million rows.</p>
</li>
<li>
<p>With the root as the current container, change the source PDB to open read-only mode:</p>
<pre dir="ltr">ALTER PLUGGABLE DATABASE pdb1 OPEN READ ONLY;
</pre></li>
<li>
<p>Clone the source PDB with the <code class="codeph">NO DATA</code> clause:</p>
<pre dir="ltr">CREATE PLUGGABLE DATABASE pdb2 FROM pdb1 NO DATA;
</pre></li>
<li>
<p>Open the cloned PDB:</p>
<pre dir="ltr">ALTER PLUGGABLE DATABASE pdb2 OPEN;
</pre></li>
<li>
<p>With the cloned PDB <code class="codeph">pdb2</code> as the current container, query the table that has a large amount of data in the source PDB:</p>
<pre dir="ltr">SELECT COUNT(*) FROM tpch.lineitem;

  COUNT(*)
----------
         0
</pre>
<p>The table in the cloned PDB has no rows.</p>
</li>
</ol>
</div>
<!-- class="example" --></div>
</div>
<a id="ADMIN13596"></a><a id="ADMIN14322"></a><a id="ADMIN13593"></a>
<div class="props_rev_3"><a id="GUID-D4900E43-DF38-4629-9A1F-D1C11EC8EC8F"></a>
<h3 id="ADMIN-GUID-D4900E43-DF38-4629-9A1F-D1C11EC8EC8F" class="sect3"><span class="enumeration_section">38.4.3</span> Cloning a Remote PDB or Non-CDB</h3>
<div>
<p>You can create a PDB by cloning a remote source. The remote source can be a remote PDB or non-CDB. After the cloning operation is complete, the source and the target PDB are in different locations.</p>
<div class="section">
<p>The following prerequisites must be met:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Complete the prerequisites described in <span class="q">&#34;<a href="cdb_plug.htm#GUID-B26D56E1-B958-444F-864C-8AFDFF1566A6" title="Prerequisites must be met before creating a PDB.">Preparing for PDBs</a>&#34;</span>.</p>
</li>
<li>
<p>The current user must have the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> system privilege in the root of the CDB that will contain the target PDB.</p>
</li>
<li>
<p>The source PDB or source non-CDB must be in open read-only mode.</p>
</li>
<li>
<p>A database link must enable a connection from the CDB that will contain the target PDB to the remote source. If the source is a remote PDB, then the database link can connect to either the root of the remote CDB or to the remote source PDB.</p>
</li>
<li>
<p>The user that the database link connects with at the remote source must have the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> system privilege in the source PDB or in the non-CDB.</p>
</li>
<li>
<p>If the database link connects to the root in a remote CDB, then the user that the database link connects with must be a common user.</p>
</li>
<li>
<p>The source and target platforms must meet these requirements:</p>
<ul style="list-style-type: disc;">
<li>
<p>They must have the same endianness.</p>
</li>
<li>
<p>The database options installed on the source platform must be the same as, or a subset of, the database options installed on the target platform.</p>
</li>
</ul>
</li>
<li>
<p>The source and target must have compatible character sets and national character sets. To be compatible, the character sets and national character sets must meet all of the requirements specified in <a class="olink NLSPG1035" target="_blank" href="../NLSPG/ch2charset.htm#NLSPG1035"><span class="italic">Oracle Database Globalization Support Guide</span></a>.</p>
</li>
<li>
<p>If you are creating a PDB by cloning a non-CDB, then both the CDB and the non-CDB must be running Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2) or later.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To clone a remote PDB or non-CDB:</p>
<ol>
<li>
<p>In SQL*Plus, ensure that the current container is the root of the CDB that will contain the new PDB.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-E1BBCE0F-76CA-49F3-9A6B-AC6B13AB9AC5" title="The data dictionary in each container in a CDB is separate, and the current container is the container whose data dictionary is used for name resolution and for privilege authorization. The current container can be the root or a PDB. Each session has exactly one current container at any point in time, but it is possible for a session to switch from one container to another.">About the Current Container</a>&#34;</span> and <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Run the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement, and specify the source PDB or the source non-CDB in the <code class="codeph">FROM</code> clause. Specify other clauses when they are required.</p>
<p>See <a href="cdb_plug.htm#GUID-D4900E43-DF38-4629-9A1F-D1C11EC8EC8F__CEGHIBHC">Example 38-25</a>.</p>
<p>After you create the PDB, it is in mounted mode, and its status is <code class="codeph">NEW</code>. You can view the open mode of a PDB by querying the <code class="codeph">OPEN_MODE</code> column in the <code class="codeph">V$PDBS</code> view. You can view the status of a PDB by querying the <code class="codeph">STATUS</code> column of the <code class="codeph">CDB_PDBS</code> or <code class="codeph">DBA_PDBS</code> view.</p>
<p>A new default service is created for the PDB. The service has the same name as the PDB and can be used to access the PDB. Oracle Net Services must be configured properly for clients to access this service. See <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p><a id="d264795e5858" class="indexterm-anchor"></a>If you created the PDB from a non-CDB, then run the <span class="italic">ORACLE_HOME</span>/rdbms/admin/noncdb_to_pdb.sql script. This script must be run before the PDB can be opened for the first time.</p>
<p>If the PDB was not a non-CDB, then running the noncdb_to_pdb.sql script is not required.</p>
<p>To run the noncdb_to_pdb.sql script, complete the following steps:</p>
<ol>
<li>
<p>Access the PDB.</p>
<p>The current user must have <code class="codeph">SYSDBA</code> administrative privilege, and the privilege must be either commonly granted or locally granted in the PDB. The user must exercise the privilege using <code class="codeph">AS</code> <code class="codeph">SYSDBA</code> at connect time.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Run the noncdb_to_pdb.sql script:</p>
<pre dir="ltr">@$ORACLE_HOME/rdbms/admin/noncdb_to_pdb.sql
</pre></li>
</ol>
<p>The script opens the PDB, performs changes, and closes the PDB when the changes are complete.</p>
</li>
<li>
<p>Open the new PDB in read/write mode.</p>
<p>You must open the new PDB in read/write mode for Oracle Database to complete the integration of the new PDB into the CDB. An error is returned if you attempt to open the PDB in read-only mode. After the PDB is opened in read/write mode, its status is <code class="codeph">NORMAL</code>.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-322C5C03-4C48-40CD-8230-0BA5F16BF96B" title="You can modify the open mode of a PDB by using the ALTER PLUGGABLE DATABASE SQL statement or the SQL*Plus STARTUP command.">Modifying the Open Mode of PDBs</a>&#34;</span> for more information.</p>
</li>
<li>
<p>Back up the PDB.</p>
<p>A PDB cannot be recovered unless it is backed up.</p>
<p><a class="olink BRADV428" target="_blank" href="../BRADV/rcmbckba.htm#BRADV428"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> for information about backing up a PDB.</p>
</li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infobox-note" id="GUID-D4900E43-DF38-4629-9A1F-D1C11EC8EC8F__GUID-A9FFF8B4-5144-40E0-B701-6D2154BAD23D">
<p class="notep1">Note:</p>
<p>If an error is returned during PDB creation, then the PDB being created might be in an <code class="codeph">UNUSABLE</code> state. You can check a PDB&#39;s state by querying the <code class="codeph">CDB_PDBS</code> or <code class="codeph">DBA_PDBS</code> view, and you can learn more about PDB creation errors by checking the alert log. An unusable PDB can only be dropped, and it must be dropped before a PDB with the same name as the unusable PDB can be created.</p>
</div>
<p>When the source is a non-CDB, you can substitute <code class="codeph">NON$CDB</code> for the name of the non-CDB. For example, the following statement is equivalent to the previous example:</p>
<pre dir="ltr">CREATE PLUGGABLE DATABASE pdb2 FROM NON$CDB@mydb_link;
</pre></div>
<!-- class="section" -->
<div class="example" id="GUID-D4900E43-DF38-4629-9A1F-D1C11EC8EC8F__CEGHIBHC">
<p class="titleinexample">Example 38-25 Creating a PDB by Cloning a Remote PDB Using No Clauses</p>
<p>This example clones a remote source PDB named <code class="codeph">pdb1</code> to a target PDB named <code class="codeph">pdb2</code> given different factors. This example assumes the following factors:</p>
<ul style="list-style-type: disc;">
<li>
<p>The database link name to the remote PDB is <code class="codeph">pdb1_link</code>.</p>
</li>
<li>
<p>The <code class="codeph">PATH_PREFIX</code> clause is not required.</p>
</li>
<li>
<p>The <code class="codeph">FILE_NAME_CONVERT</code> clause and the <code class="codeph">CREATE_FILE_DEST</code> clause are not required.</p>
<p>Either Oracle Managed Files is enabled, or the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter is set. The files will be copied to a new location based on the Oracle Managed Files configuration or the initialization parameter setting.</p>
</li>
<li>
<p>Storage limits are not required for the PDB. Therefore, the <code class="codeph">STORAGE</code> clause is not required.</p>
</li>
<li>
<p>There is no file with the same name as the new temp file that will be created in the target location. Therefore, the <code class="codeph">TEMPFILE REUSE</code> clause is not required.</p>
</li>
</ul>
<p>Given the preceding factors, the following statement clones the <code class="codeph">pdb2</code> PDB from the <code class="codeph">pdb1</code> remote PDB:</p>
<pre dir="ltr">CREATE PLUGGABLE DATABASE pdb2 FROM pdb1@pdb1_link;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-D4900E43-DF38-4629-9A1F-D1C11EC8EC8F__GUID-55F57C7B-DEB5-4ED6-B68F-449176D7AF13">
<p class="titleinexample">Example 38-26 Creating a PDB by Cloning a Remote Non-CDB</p>
<p>This example creates a new PDB by cloning a remote source non-CDB named <code class="codeph">mydb</code> to a target PDB named <code class="codeph">pdb2</code> given different factors. This example assumes the following factors:</p>
<ul style="list-style-type: disc;">
<li>
<p>The database link name to the remote non-CDB is <code class="codeph">mydb_link</code>.</p>
</li>
<li>
<p>The <code class="codeph">PATH_PREFIX</code> clause is not required.</p>
</li>
<li>
<p>The <code class="codeph">FILE_NAME_CONVERT</code> clause and the <code class="codeph">CREATE_FILE_DEST</code> clause are not required.</p>
<p>Either Oracle Managed Files is enabled, or the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter is set. The files will be copied to a new location based on the Oracle Managed Files configuration or the initialization parameter setting.</p>
</li>
<li>
<p>Storage limits are not required for the PDB. Therefore, the <code class="codeph">STORAGE</code> clause is not required.</p>
</li>
<li>
<p>There is no file with the same name as the new temp file that will be created in the target location. Therefore, the <code class="codeph">TEMPFILE REUSE</code> clause is not required.</p>
</li>
</ul>
<p>Given the preceding factors, the following statement creates the <code class="codeph">pdb2</code> PDB from the remote non-CDB named <code class="codeph">mydb</code>:</p>
<pre dir="ltr">CREATE PLUGGABLE DATABASE pdb2 FROM mydb@mydb_link;
</pre>
<div class="infoboxnotealso" id="GUID-D4900E43-DF38-4629-9A1F-D1C11EC8EC8F__GUID-ECE588C2-4A53-4727-AC31-404D0E1D01B8">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="omf.htm#GUID-4A3C4616-0D81-4BBA-8EAD-FCAA8AD5C15A" title="Oracle Database can manage the files that comprise the database.">Using Oracle Managed Files</a></p>
</li>
<li>
<p><a class="olink REFRN10322" target="_blank" href="../REFRN/GUID-074F8896-D565-4139-BCDB-C81C9D741941.htm#REFRN10322"><span class="italic">Oracle Database Reference</span></a> for information about the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter</p>
</li>
</ul>
</div>
</div>
<!-- class="example" --></div>
</div>
<a id="ADMIN14167"></a>
<div class="props_rev_3"><a id="GUID-AF27B6CB-A1A9-4AFD-B45B-2DA92C972396"></a>
<h3 id="ADMIN-GUID-AF27B6CB-A1A9-4AFD-B45B-2DA92C972396" class="sect3"><span class="enumeration_section">38.4.4</span> After Cloning a PDB</h3>
<div>
<p>Certain rules regarding users and tablespaces apply after cloning a PDB.</p>
<p>The following applies after cloning a PDB:</p>
<ul style="list-style-type: disc;">
<li>
<p>Users in the PDB who used the default temporary tablespace of the source non-CDB or PDB use the default temporary tablespace of the cloned PDB. Users who used non-default temporary tablespaces in the non-CDB or PDB continue to use the same local temporary tablespaces in the cloned PDB. See <span class="q">&#34;<a href="cdb_admin.htm#GUID-B34BC55B-C734-4799-A54A-0BB04073D9D0" title="A tablespace is a logical storage container for database objects, such as tables and indexes, that consume storage space. At the physical level, a tablespace stores data in one or more data files or temp files. You can use the ALTER DATABASE statement to manage tablespaces in a CDB.">About Managing Tablespaces in a CDB</a>&#34;</span>.</p>
</li>
<li>
<p>When cloning a remote PDB, user-created common users that existed in the source CDB but not in the target CDB do not have any privileges granted commonly. However, if the target CDB has a common user with the same name as a common user in the PDB, the latter is linked to the former and has the privileges granted to this common user in the target CDB.</p>
<p>If the target CDB does not have a common user with the same name, then the user account is locked in the target PDB. You have the following options regarding each of these locked users:</p>
<ul style="list-style-type: disc;">
<li>
<p>Close the PDB, connect to the root, and create a common user with the same name. When the PDB is opened in read/write mode, differences in roles and privileges granted commonly to the user are resolved, and you can unlock the user. Privileges and roles granted locally to the user remain unchanged during this process.</p>
</li>
<li>
<p>You can create a new local user in the PDB and use Data Pump to export/import the locked user&#39;s data into the new local user&#39;s schema.</p>
</li>
<li>
<p>You can leave the user locked.</p>
</li>
<li>
<p>You can drop the user.</p>
</li>
</ul>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-AF27B6CB-A1A9-4AFD-B45B-2DA92C972396__GUID-6D44C122-8526-40B4-B99F-F1848E0AEB21">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="cdb_pdb_admin.htm#GUID-6FDBCEFC-29DF-4CBB-A000-B105A7328955" title="You can create, modify, or remove services for a PDB.">Managing Services Associated with PDBs</a>&#34;</span></p>
</li>
<li>
<p><a href="cdb_mon.htm#GUID-1DED3127-84E4-4967-BEB3-D0ADEC622643__CHDDHBAF">Example 43-9</a></p>
</li>
<li>
<p><a class="olink CNCPT89257" target="_blank" href="../CNCPT/cdblogic.htm#CNCPT89257"><span class="italic">Oracle Database Concepts</span></a> for information about common users and local users</p>
</li>
<li>
<p><a class="olink DBSEG832" target="_blank" href="../DBSEG/users.htm#DBSEG832"><span class="italic">Oracle Database Security Guide</span></a> for information about creating a local user</p>
</li>
<li>
<p><a class="olink SUTIL4334" target="_blank" href="../SUTIL/GUID-45B17B65-20F2-4128-9A39-B1B0F5E323BB.htm#SUTIL4334"><span class="italic">Oracle Database Utilities</span></a> for information about using Oracle Data Pump with a CDB</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<a id="ADMIN13572"></a>
<div class="props_rev_3"><a id="GUID-3132C4E5-8734-458B-8B0C-EFC77A45FFA3"></a>
<h2 id="ADMIN-GUID-3132C4E5-8734-458B-8B0C-EFC77A45FFA3" class="sect2"><span class="enumeration_section">38.5</span> Creating a PDB by Plugging an Unplugged PDB into a CDB</h2>
<p>You can create a PDB by plugging an unplugged PDB into a CDB.</p>
<a id="ADMIN13753"></a><a id="ADMIN13573"></a><a id="ADMIN13553"></a>
<div class="props_rev_3"><a id="GUID-157624D9-7D38-4758-9FF2-645EC55106A9"></a>
<h3 id="ADMIN-GUID-157624D9-7D38-4758-9FF2-645EC55106A9" class="sect3"><span class="enumeration_section">38.5.1</span> About Plugging In an Unplugged PDB</h3>
<div>
<p>This technique plugs in an unplugged PDB. This technique uses the XML metadata file that describes the PDB and the files associated with the PDB to plug it into the CDB.</p>
<p>The XML metadata file specifies the locations of the PDB&#39;s files, and the <code class="codeph">USING</code> clause of the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement specifies the XML metadata file. <a href="cdb_plug.htm#GUID-157624D9-7D38-4758-9FF2-645EC55106A9__CEGHDJHJ">Figure 38-6</a> illustrates how this technique creates a new PDB.</p>
<div class="figure" id="GUID-157624D9-7D38-4758-9FF2-645EC55106A9__CEGHDJHJ">
<p class="titleinfigure">Figure 38-6 Plug In an Unplugged PDB</p>
<img width="546" height="401" src="img/GUID-25D8CA8E-427D-41C2-B6C7-E10F1455DC31-default.png" alt="Description of Figure 38-6 follows" title="Description of Figure 38-6 follows"/><br/>
<a href="img_text/GUID-25D8CA8E-427D-41C2-B6C7-E10F1455DC31-print.htm">Description of &#34;Figure 38-6 Plug In an Unplugged PDB&#34;</a></div>
<!-- class="figure" -->
<div class="infoboxnotealso" id="GUID-157624D9-7D38-4758-9FF2-645EC55106A9__GUID-3A024ACB-F2F4-45C5-929B-8FACC2439410">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="cdb_plug.htm#GUID-59F42929-7237-4371-8934-921B46DB6F31" title="You use the CREATE PLUGGABLE DATABASE statement to create a PDB. To use this statement, you must understand the clauses for the statement and when to use each clause.">The CREATE PLUGGABLE DATABASE Statement</a>&#34;</span></p>
</div>
<p>An unplugged PDB consists of an XML file that describes the PDB and the PDB&#39;s files (such as the data files and wallet file). You can use the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement to plug in an unplugged PDB. To do so, you must include a <code class="codeph">USING</code> clause that specifies the XML file that describes the PDB.</p>
<p>The source CDB is the CDB from which the PDB was unplugged. The target CDB is the CDB into which you are plugging the PDB. The source CDB and target CDB can be the same CDB or different CDBs.</p>
<p>When you plug in an unplugged PDB, you must address the questions in <a href="cdb_plug.htm#GUID-157624D9-7D38-4758-9FF2-645EC55106A9__CEGJDJAD" title="This table describes each clause and when to use each clause.">Table 38-5</a>. The table describes which <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> clauses you must specify based on different factors.</p>
<div class="tblformalwide" id="GUID-157624D9-7D38-4758-9FF2-645EC55106A9__CEGJDJAD">
<p class="titleintable">Table 38-5 Clauses for Plugging In an Unplugged PDB</p>
<table class="cellalignment1880" title="Clauses for Plugging In an Unplugged PDB" summary="This table describes each clause and when to use each clause.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1881" id="d264795e6460">Clause</th>
<th class="cellalignment1863" id="d264795e6463">Question</th>
<th class="cellalignment1863" id="d264795e6466">Yes</th>
<th class="cellalignment1863" id="d264795e6469">No</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1884" id="d264795e6474" headers="d264795e6460">
<p><code class="codeph">AS</code> <code class="codeph">CLONE</code></p>
</td>
<td class="cellalignment1865" headers="d264795e6474 d264795e6463">
<p>Are you plugging a PDB into a CDB that contains one or more PDBs that were created by plugging in the same PDB?</p>
</td>
<td class="cellalignment1865" headers="d264795e6474 d264795e6466">
<p>Specify the <code class="codeph">AS</code> <code class="codeph">CLONE</code> clause to ensure that Oracle Database generates unique PDB DBID, GUID, and other identifiers expected for the new PDB. The PDB is plugged in as a clone of the unplugged PDB to ensure that all of its identifiers are unique.</p>
</td>
<td class="cellalignment1865" headers="d264795e6474 d264795e6469">
<p>Omit the <code class="codeph">AS</code> <code class="codeph">CLONE</code> clause.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1884" id="d264795e6503" headers="d264795e6460">
<p><code class="codeph">PATH_PREFIX</code></p>
</td>
<td class="cellalignment1865" headers="d264795e6503 d264795e6463">
<p>Do you want to use a <code class="codeph">PATH_PREFIX</code> clause to ensure that all relative directory object paths associated with the PDB are treated as relative to the specified directory or its subdirectories?</p>
<p>The <code class="codeph">PATH_PREFIX</code> clause is ignored when absolute paths are used for directory objects.</p>
<p>The <code class="codeph">PATH_PREFIX</code> clause does not affect files created by Oracle Managed Files.</p>
</td>
<td class="cellalignment1865" headers="d264795e6503 d264795e6466">
<p>Include a <code class="codeph">PATH_PREFIX</code> clause that specifies an absolute path.</p>
</td>
<td class="cellalignment1865" headers="d264795e6503 d264795e6469">
<p>Set the <code class="codeph">PATH_PREFIX</code> clause to <code class="codeph">NONE</code> or omit it.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1884" id="d264795e6539" headers="d264795e6460">
<p><code class="codeph">SERVICE_NAME_CONVERT</code></p>
</td>
<td class="cellalignment1865" headers="d264795e6539 d264795e6463">
<p>Do you want to use a <code class="codeph">SERVICE_NAME_CONVERT</code> clause to rename the user-defined services of the new PDB based on the service names of the source PDB?</p>
</td>
<td class="cellalignment1865" headers="d264795e6539 d264795e6466">
<p>Include a <code class="codeph">SERVICE_NAME_CONVERT</code> clause that specifies the new name of a service and the service name it is replacing. Specify multiple service names and replacement service names if necessary.</p>
</td>
<td class="cellalignment1865" headers="d264795e6539 d264795e6469">
<p>Omit the <code class="codeph">SERVICE_NAME_CONVERT</code> clause.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1884" id="d264795e6562" headers="d264795e6460">
<p><code class="codeph">SOURCE_FILE_NAME_CONVERT</code></p>
</td>
<td class="cellalignment1865" headers="d264795e6562 d264795e6463">
<p>Do the contents of the XML file accurately describe the locations of the source files?</p>
</td>
<td class="cellalignment1865" headers="d264795e6562 d264795e6466">
<p>Omit the <code class="codeph">SOURCE_FILE_NAME_CONVERT</code> clause.</p>
</td>
<td class="cellalignment1865" headers="d264795e6562 d264795e6469">
<p>Use the <code class="codeph">SOURCE_FILE_NAME_CONVERT</code> clause to specify the source file locations.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1884" id="d264795e6582" headers="d264795e6460">
<p><code class="codeph">SOURCE_FILE_DIRECTORY</code></p>
</td>
<td class="cellalignment1865" headers="d264795e6582 d264795e6463">
<p>Are all of the source files in a single directory with new file names that would require multiple <code class="codeph">SOURCE_FILE_NAME_CONVERT</code> entries?</p>
</td>
<td class="cellalignment1865" headers="d264795e6582 d264795e6466">
<p>Specify the <code class="codeph">SOURCE_FILE_DIRECTORY</code> with the full absolute path to the source files.</p>
</td>
<td class="cellalignment1865" headers="d264795e6582 d264795e6469">
<p>Omit the <code class="codeph">SOURCE_FILE_DIRECTORY</code> clause.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1884" id="d264795e6605" headers="d264795e6460">
<p><code class="codeph">NOCOPY</code>, <code class="codeph">COPY</code>, <code class="codeph">MOVE</code>, <code class="codeph">FILE_NAME_CONVERT</code>, <code class="codeph">CREATE_FILE_DEST</code></p>
</td>
<td class="cellalignment1865" headers="d264795e6605 d264795e6463">
<p>Do you want to copy or move the files to a new location?</p>
</td>
<td class="cellalignment1865" headers="d264795e6605 d264795e6466">
<p>Specify <code class="codeph">COPY</code> to copy the files to a new location. <code class="codeph">COPY</code> is the default.</p>
<p>Specify <code class="codeph">MOVE</code> to move the files to a new location.</p>
<p>Use one of these techniques to specify the target location:</p>
<ul style="list-style-type: disc;">
<li>
<p>In the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement, include a <code class="codeph">FILE_NAME_CONVERT</code> clause that specifies the target locations based on the names of the source files.</p>
</li>
<li>
<p>In the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement, include a <code class="codeph">CREATE_FILE_DEST</code> clause that specifies the Oracle Managed Files default location for the PDB&#39;s files.</p>
</li>
<li>
<p>Enable Oracle Managed Files for it to determine the target locations.</p>
</li>
<li>
<p>Specify the target locations in the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter.</p>
</li>
</ul>
<p>See <span class="q">&#34;<a href="cdb_plug.htm#GUID-39D2F826-7460-4439-B410-29E16C0CA0B1" title="In the CREATE PLUGGABLE DATABASE statement, you can specify the locations of files used by the new PDB.">File Location of the New PDB</a>&#34;</span>.</p>
</td>
<td class="cellalignment1865" headers="d264795e6605 d264795e6469">
<p>Specify <code class="codeph">NOCOPY</code>.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1884" id="d264795e6706" headers="d264795e6460">
<p><code class="codeph">STORAGE</code></p>
</td>
<td class="cellalignment1865" headers="d264795e6706 d264795e6463">
<p>Do you want to limit the amount of storage that the PDB can use?</p>
</td>
<td class="cellalignment1865" headers="d264795e6706 d264795e6466">
<p>Specify a <code class="codeph">STORAGE</code> clause with the appropriate limits.</p>
</td>
<td class="cellalignment1865" headers="d264795e6706 d264795e6469">
<p>Omit the <code class="codeph">STORAGE</code> clause, or specify unlimited storage using the <code class="codeph">STORAGE</code> clause.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1884" id="d264795e6729" headers="d264795e6460">
<p><code class="codeph">TEMPFILE REUSE</code></p>
</td>
<td class="cellalignment1865" headers="d264795e6729 d264795e6463">
<p>Do you want to reuse the temp file if a temp file exists in the target location?</p>
</td>
<td class="cellalignment1865" headers="d264795e6729 d264795e6466">
<p>Include the <code class="codeph">TEMPFILE REUSE</code> clause.</p>
</td>
<td class="cellalignment1865" headers="d264795e6729 d264795e6469">
<p>Omit the <code class="codeph">TEMPFILE REUSE</code> clause.</p>
<p>Ensure that there is no file with the same name as the new temp file in the target location.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1884" id="d264795e6751" headers="d264795e6460">
<p><code class="codeph">USER_TABLESPACES</code></p>
</td>
<td class="cellalignment1865" headers="d264795e6751 d264795e6463">
<p>Do you want to specify which tablespaces are included in the new PDB and which tablespaces are excluded from the new PDB?</p>
<p>This feature is available starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2).</p>
</td>
<td class="cellalignment1865" headers="d264795e6751 d264795e6466">
<p>Include the <code class="codeph">USER_TABLESPACES</code> clause and specify the tablespaces that are included in the new PDB.</p>
</td>
<td class="cellalignment1865" headers="d264795e6751 d264795e6469">
<p>Omit the <code class="codeph">USER_TABLESPACES</code> clause.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1884" id="d264795e6776" headers="d264795e6460">
<p><span class="italic">logging_clause</span></p>
</td>
<td class="cellalignment1865" headers="d264795e6776 d264795e6463">
<p>Do you want to specify the logging attribute of the tablespaces in the new PDB?</p>
<p>This feature is available starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2).</p>
</td>
<td class="cellalignment1865" headers="d264795e6776 d264795e6466">
<p>Include the <span class="italic">logging_clause</span>.</p>
</td>
<td class="cellalignment1865" headers="d264795e6776 d264795e6469">
<p>Omit the <span class="italic">logging_clause</span>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>You can use the <code class="codeph">AS</code> <code class="codeph">CLONE</code> clause and <code class="codeph">SOURCE_FILE_NAME_CONVERT</code> clause only when you are plugging in an unplugged PDB, but the other clauses described in <a href="cdb_plug.htm#GUID-157624D9-7D38-4758-9FF2-645EC55106A9__CEGJDJAD" title="This table describes each clause and when to use each clause.">Table 38-5</a> are general clauses. See <span class="q">&#34;<a href="cdb_plug.htm#GUID-59F42929-7237-4371-8934-921B46DB6F31" title="You use the CREATE PLUGGABLE DATABASE statement to create a PDB. To use this statement, you must understand the clauses for the statement and when to use each clause.">The CREATE PLUGGABLE DATABASE Statement</a>&#34;</span> for more information about the general clauses.</p>
</div>
</div>
<a id="ADMIN13576"></a><a id="ADMIN13577"></a><a id="ADMIN13578"></a><a id="ADMIN13579"></a><a id="ADMIN13580"></a><a id="ADMIN13582"></a><a id="ADMIN13855"></a>
<div class="props_rev_3"><a id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0"></a>
<h3 id="ADMIN-GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0" class="sect3"><span class="enumeration_section">38.5.2</span> Plugging In an Unplugged PDB</h3>
<div>
<p>You must meet prerequisites before plugging in an unplugged PDB.</p>
<div class="section">
<p>To plug in an unplugged PDB, the following prerequisites must be met:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Complete the prerequisites described in <span class="q">&#34;<a href="cdb_plug.htm#GUID-B26D56E1-B958-444F-864C-8AFDFF1566A6" title="Prerequisites must be met before creating a PDB.">Preparing for PDBs</a>&#34;</span>.</p>
</li>
<li>
<p>The XML file that describes the PDB must exist in a location that is accessible to the CDB.</p>
<p>The <code class="codeph">USING</code> clause must specify the XML file.</p>
<p>If the PDB&#39;s XML file is unusable or cannot be located, then you can use the <code class="codeph">DBMS_PDB.RECOVER</code> procedure to generate an XML file using the PDB&#39;s data files. See <a class="olink ARPLS73527" target="_blank" href="../ARPLS/d_pdb.htm#ARPLS73527"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information about this procedure.</p>
</li>
<li>
<p>The files associated with the PDB (such as the data files and wallet file) must exist in a location that is accessible to the CDB.</p>
</li>
<li>
<p>The source and target CDB platforms must meet the following requirements:</p>
<ul style="list-style-type: disc;">
<li>
<p>They must have the same endianness.</p>
</li>
<li>
<p>The database options installed on the source platform must be the same as, or a subset of, the database options installed on the target platform.</p>
</li>
</ul>
</li>
<li>
<p>The CDB that contained the unplugged PDB and the target CDB must have compatible character sets and national character sets. To be compatible, the character sets and national character sets must meet all of the requirements specified in <a class="olink NLSPG1035" target="_blank" href="../NLSPG/ch2charset.htm#NLSPG1035"><span class="italic">Oracle Database Globalization Support Guide</span></a>.</p>
</li>
</ul>
<p>You can use the <code class="codeph">DBMS_PDB.CHECK_PLUG_COMPATIBILITY</code> function to determine whether these requirements are met. Step <a href="cdb_plug.htm#GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__CEGCIJBE">2</a> in the following procedure describes using this function.</p>
<div class="infobox-note" id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__GUID-E6497B61-1260-452F-ABF1-DC3FA8B9C4E9">
<p class="notep1">Note:</p>
<ul style="list-style-type: disc;">
<li>
<p>If you are plugging in a PDB that includes data that was encrypted with Transparent Data Encryption, then follow the instructions in <a class="olink ASOAG10441" target="_blank" href="../ASOAG/using-transparent-data-encryption-with-other-oracle-features.htm#ASOAG10441"><span class="italic">Oracle Database Advanced Security Guide</span></a>.</p>
</li>
<li>
<p>If you are plugging in a Database Vault-enabled PDB, then follow the instructions in <a class="olink DVADM71354" target="_blank" href="../DVADM/dba.htm#DVADM71354"><span class="italic">Oracle Database Vault Administrator&#39;s Guide</span></a>.</p>
</li>
</ul>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To plug in a PDB:</p>
<ol>
<li>
<p>In SQL*Plus, ensure that the current container is the root of the CDB into which you want to plug the PDB.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-E1BBCE0F-76CA-49F3-9A6B-AC6B13AB9AC5" title="The data dictionary in each container in a CDB is separate, and the current container is the container whose data dictionary is used for name resolution and for privilege authorization. The current container can be the root or a PDB. Each session has exactly one current container at any point in time, but it is possible for a session to switch from one container to another.">About the Current Container</a>&#34;</span> and <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__CEGCIJBE">
<p>(Optional) Run the <code class="codeph">DBMS_PDB.CHECK_PLUG_COMPATIBILITY</code> function to determine whether the unplugged PDB is compatible with the CDB.</p>
<ol>
<li>
<p>If the PDB is not yet unplugged, then run the <code class="codeph">DBMS_PDB.DESCRIBE</code> procedure to produce an XML file that describes the PDB.</p>
<p>If the PDB is already unplugged, then proceed to Step <a href="cdb_plug.htm#GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__CEGDFAII">2.b</a>.</p>
<p>For example, to generate an XML file named <code class="codeph">salespdb.xml</code> in the /disk1/oracle directory, run the following procedure:</p>
<pre dir="ltr">BEGIN
  DBMS_PDB.DESCRIBE(
    pdb_descr_file =&gt; &#39;/disk1/oracle/salespdb.xml&#39;,
    pdb_name       =&gt; &#39;SALESPDB&#39;);
END;
/
</pre>
<p>If the PDB is in a remote CDB, then you can include <code class="codeph">@</code><span class="italic"><code class="codeph">database_link_name</code></span> in the <code class="codeph">pdb_name</code> parameter, where <span class="italic"><code class="codeph">database_link_name</code></span> is the name of a valid database link to the remote CDB or to the PDB. For example, if the database link name to the remote CDB is <code class="codeph">rcdb</code>, then set the <code class="codeph">pdb_name</code> value to <code class="codeph">SALESPDB@rcdb</code>.</p>
</li>
<li id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__CEGDFAII">
<p>Run the <code class="codeph">DBMS_PDB.CHECK_PLUG_COMPATIBILITY</code> function.</p>
<p>When you run the function, set the following parameters:</p>
<p>- <code class="codeph">pdb_descr_file</code> - Set this parameter to the full path to the XML file.</p>
<p>- <code class="codeph">pdb_name</code> - Specify the name of the new PDB. If this parameter is omitted, then the PDB name in the XML file is used.</p>
<p>For example, to determine whether a PDB described by the /disk1/usr/salespdb.xml file is compatible with the current CDB, run the following PL/SQL block:</p>
<pre dir="ltr">SET SERVEROUTPUT ON
DECLARE
  compatible CONSTANT VARCHAR2(3) := 
    CASE DBMS_PDB.CHECK_PLUG_COMPATIBILITY(
           pdb_descr_file =&gt; &#39;/disk1/usr/salespdb.xml&#39;,
           pdb_name       =&gt; &#39;SALESPDB&#39;)
    WHEN TRUE THEN &#39;YES&#39;
    ELSE &#39;NO&#39;
END;
BEGIN
  DBMS_OUTPUT.PUT_LINE(compatible);
END;
/
</pre>
<p>If the output is <code class="codeph">YES</code>, then the PDB is compatible, and you can continue with the next step.</p>
<p>If the output is <code class="codeph">NO</code>, then the PDB is not compatible, and you can check the <code class="codeph">PDB_PLUG_IN_VIOLATIONS</code> view to see why it is not compatible.</p>
</li>
</ol>
</li>
<li>
<p>If the PDB is not unplugged, then unplug it.</p>
<p>See <span class="q">&#34;<a href="cdb_plug.htm#GUID-893E1D67-BD95-4757-B862-03AD13AFF722" title="You can unplug a PDB from a CDB.">Unplugging a PDB from a CDB</a>&#34;</span>.</p>
</li>
<li>
<p>Run the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement, and specify the XML file in the <code class="codeph">USING</code> clause. Specify other clauses when they are required.</p>
<p>See <span class="q">&#34;<a href="cdb_plug.htm#GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__CEGHIEBE">Examples of Plugging In an Unplugged PDB</a>&#34;</span>.</p>
<p>After you create the PDB, it is in mounted mode, and its status is <code class="codeph">NEW</code>. You can view the open mode of a PDB by querying the <code class="codeph">OPEN_MODE</code> column in the <code class="codeph">V$PDBS</code> view. You can view the status of a PDB by querying the <code class="codeph">STATUS</code> column of the <code class="codeph">CDB_PDBS</code> or <code class="codeph">DBA_PDBS</code> view.</p>
<p>A new default service is created for the PDB. The service has the same name as the PDB and can be used to access the PDB. Oracle Net Services must be configured properly for clients to access this service. See <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Open the new PDB in read/write mode.</p>
<p>You must open the new PDB in read/write mode for Oracle Database to complete the integration of the new PDB into the CDB. An error is returned if you attempt to open the PDB in read-only mode. After the PDB is opened in read/write mode, its status is <code class="codeph">NORMAL</code>.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-322C5C03-4C48-40CD-8230-0BA5F16BF96B" title="You can modify the open mode of a PDB by using the ALTER PLUGGABLE DATABASE SQL statement or the SQL*Plus STARTUP command.">Modifying the Open Mode of PDBs</a>&#34;</span> for more information.</p>
</li>
<li>
<p>Back up the PDB.</p>
<p>A PDB cannot be recovered unless it is backed up.</p>
<p><a class="olink BRADV428" target="_blank" href="../BRADV/rcmbckba.htm#BRADV428"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> for information about backing up a PDB.</p>
</li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infobox-note" id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__GUID-FB02CD3A-80EE-4501-9DBC-385DB12AA1E7">
<p class="notep1">Note:</p>
<p>If an error is returned during PDB creation, then the PDB being created might be in an <code class="codeph">UNUSABLE</code> state. You can check a PDB&#39;s state by querying the <code class="codeph">CDB_PDBS</code> or <code class="codeph">DBA_PDBS</code> view, and you can learn more about PDB creation errors by checking the alert log. An unusable PDB can only be dropped, and it must be dropped before a PDB with the same name as the unusable PDB can be created.</p>
</div>
</div>
<!-- class="section" -->
<div class="section" id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__CEGHIEBE">
<p class="subhead3">Examples of Plugging In an Unplugged PDB</p>
</div>
<!-- class="section" -->
<div class="section">
<p>The following examples plug in an unplugged PDB named <code class="codeph">salespdb</code> using the /disk1/usr/salespdb.xml file given different factors.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__CEGHJJEF">
<p class="titleinexample">Example 38-27 Plugging In an Unplugged PDB Using the NOCOPY Clause</p>
<p>This example assumes the following factors:</p>
<ul style="list-style-type: disc;">
<li>
<p>The new PDB is not based on the same unplugged PDB that was used to create an existing PDB in the CDB. Therefore, the <code class="codeph">AS</code> <code class="codeph">CLONE</code> clause is not required.</p>
</li>
<li>
<p>The <code class="codeph">PATH_PREFIX</code> clause is not required.</p>
</li>
<li>
<p>The XML file accurately describes the current locations of the files. Therefore, the <code class="codeph">SOURCE_FILE_NAME_CONVERT</code> clause or <code class="codeph">SOURCE_FILE_DIRECTORY</code> clause is not required.</p>
</li>
<li>
<p>The files are in the correct location. Therefore, <code class="codeph">NOCOPY</code> is included.</p>
</li>
<li>
<p>Storage limits are not required for the PDB. Therefore, the <code class="codeph">STORAGE</code> clause is not required.</p>
</li>
<li>
<p>A file with the same name as the temp file specified in the XML file exists in the target location. Therefore, the <code class="codeph">TEMPFILE REUSE</code> clause is required.</p>
</li>
</ul>
<p>Given the preceding factors, the following statement plugs in the PDB:</p>
<pre dir="ltr">CREATE PLUGGABLE DATABASE salespdb USING &#39;/disk1/usr/salespdb.xml&#39; 
  NOCOPY 
  TEMPFILE REUSE;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__CEGHGABE">
<p class="titleinexample">Example 38-28 Plugging In an Unplugged PDB Using the AS CLONE and NOCOPY Clauses</p>
<p>This example assumes the following factors:</p>
<ul style="list-style-type: disc;">
<li>
<p>The new PDB is based on the same unplugged PDB that was used to create an existing PDB in the CDB. Therefore, the <code class="codeph">AS</code> <code class="codeph">CLONE</code> clause is required. The <code class="codeph">AS</code> <code class="codeph">CLONE</code> clause ensures that the new PDB has unique identifiers.</p>
</li>
<li>
<p>The <code class="codeph">PATH_PREFIX</code> clause is not required.</p>
</li>
<li>
<p>The XML file accurately describes the current locations of the files. Therefore, the <code class="codeph">SOURCE_FILE_NAME_CONVERT</code> clause or <code class="codeph">SOURCE_FILE_DIRECTORY</code> clause is not required.</p>
</li>
<li>
<p>The files are in the correct location. Therefore, <code class="codeph">NOCOPY</code> is included.</p>
</li>
<li>
<p>Storage limits are not required for the PDB. Therefore, the <code class="codeph">STORAGE</code> clause is not required.</p>
</li>
<li>
<p>A file with the same name as the temp file specified in the XML file exists in the target location. Therefore, the <code class="codeph">TEMPFILE REUSE</code> clause is required.</p>
</li>
</ul>
<p>Given the preceding factors, the following statement plugs in the PDB:</p>
<pre dir="ltr">CREATE PLUGGABLE DATABASE salespdb AS CLONE USING &#39;/disk1/usr/salespdb.xml&#39; 
  NOCOPY
  TEMPFILE REUSE;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__CEGIHHBF">
<p class="titleinexample">Example 38-29 Plugging In an Unplugged PDB Using the SOURCE_FILE_NAME_CONVERT, NOCOPY, and STORAGE Clauses</p>
<p>This example assumes the following factors:</p>
<ul style="list-style-type: disc;">
<li>
<p>The new PDB is not based on the same unplugged PDB that was used to create an existing PDB in the CDB. Therefore, the <code class="codeph">AS</code> <code class="codeph">CLONE</code> clause is not required.</p>
</li>
<li>
<p>The <code class="codeph">PATH_PREFIX</code> clause is not required.</p>
</li>
<li>
<p>The XML file does not accurately describe the current locations of the files. Therefore, the <code class="codeph">SOURCE_FILE_NAME_CONVERT</code> clause or <code class="codeph">SOURCE_FILE_DIRECTORY</code> clause is required. In this example, the XML file indicates that the files are in /disk1/oracle/sales, but the files are in /disk2/oracle/sales, and the <code class="codeph">SOURCE_FILE_NAME_CONVERT</code> clause is used.</p>
</li>
<li>
<p>The files are in the correct location. Therefore, <code class="codeph">NOCOPY</code> is included.</p>
</li>
<li>
<p>Storage limits must be enforced for the PDB. Therefore, the <code class="codeph">STORAGE</code> clause is required. Specifically, all tablespaces that belong to the PDB must not exceed 2 gigabytes.</p>
</li>
<li>
<p>A file with the same name as the temp file specified in the XML file exists in the target location. Therefore, the <code class="codeph">TEMPFILE REUSE</code> clause is required.</p>
</li>
</ul>
<p>Given the preceding factors, the following statement plugs in the PDB:</p>
<pre dir="ltr">CREATE PLUGGABLE DATABASE salespdb USING &#39;/disk1/usr/salespdb.xml&#39; 
  SOURCE_FILE_NAME_CONVERT = (&#39;/disk1/oracle/sales/&#39;, &#39;/disk2/oracle/sales/&#39;)
  NOCOPY
  STORAGE (MAXSIZE 2G)
  TEMPFILE REUSE;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__CEGBBHIF">
<p class="titleinexample">Example 38-30 Plugging In an Unplugged PDB With the COPY, PATH_PREFIX, and FILE_NAME_CONVERT Clauses</p>
<p>This example assumes the following factors:</p>
<ul style="list-style-type: disc;">
<li>
<p>The new PDB is not based on the same unplugged PDB that was used to create an existing PDB in the CDB. Therefore, the <code class="codeph">AS</code> <code class="codeph">CLONE</code> clause is not required.</p>
</li>
<li>
<p>The PDB&#39;s relative directory object paths must be treated as relative to a specific directory. Therefore, the <code class="codeph">PATH_PREFIX</code> clause is required. In this example, the PDB&#39;s relative directory object paths must be treated as relative to the /disk2/oracle/sales directory and its subdirectories.</p>
</li>
<li>
<p>The XML file accurately describes the current locations of the files. Therefore, the <code class="codeph">SOURCE_FILE_NAME_CONVERT</code> clause or <code class="codeph">SOURCE_FILE_DIRECTORY</code> clause is not required.</p>
</li>
<li>
<p>The files are not in the correct location. Therefore, <code class="codeph">COPY</code> or <code class="codeph">MOVE</code> must be included. In this example, the files are copied.</p>
<p>The <code class="codeph">CREATE_FILE_DEST</code> clause is not used, Oracle Managed Files is not enabled, and the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter is not set. Therefore, the <code class="codeph">FILE_NAME_CONVERT</code> clause is required. In this example, the files are copied from /disk1/oracle/sales to /disk2/oracle/sales.</p>
</li>
<li>
<p>Storage limits are not required for the PDB. Therefore, the <code class="codeph">STORAGE</code> clause is not required.</p>
</li>
<li>
<p>There is no file with the same name as the new temp file that will be created in the target location. Therefore, the <code class="codeph">TEMPFILE REUSE</code> clause is not required.</p>
</li>
</ul>
<p>Given the preceding factors, the following statement plugs in the PDB:</p>
<pre dir="ltr">CREATE PLUGGABLE DATABASE salespdb USING &#39;/disk1/usr/salespdb.xml&#39; 
  COPY
  PATH_PREFIX = &#39;/disk2/oracle/sales/&#39;
  FILE_NAME_CONVERT = (&#39;/disk1/oracle/sales/&#39;, &#39;/disk2/oracle/sales/&#39;);
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__CEGCFDEB">
<p class="titleinexample">Example 38-31 Plugging In an Unplugged PDB Using the SOURCE_FILE_NAME_CONVERT, MOVE, FILE_NAME_CONVERT, and STORAGE Clauses</p>
<p>This example assumes the following factors:</p>
<ul style="list-style-type: disc;">
<li>
<p>The new PDB is not based on the same unplugged PDB that was used to create an existing PDB in the CDB. Therefore, the <code class="codeph">AS</code> <code class="codeph">CLONE</code> clause is not required.</p>
</li>
<li>
<p>The <code class="codeph">PATH_PREFIX</code> clause is not required.</p>
</li>
<li>
<p>The XML file does not accurately describe the current locations of the files. Therefore, the <code class="codeph">SOURCE_FILE_NAME_CONVERT</code> clause or <code class="codeph">SOURCE_FILE_DIRECTORY</code> clause is required. In this example, the XML file indicates that the files are in /disk1/oracle/sales, but the files are in /disk2/oracle/sales, and the <code class="codeph">SOURCE_FILE_NAME_CONVERT</code> clause is used.</p>
</li>
<li>
<p>The files are not in the correct final location for the PDB. Therefore, <code class="codeph">COPY</code> or <code class="codeph">MOVE</code> must be included. In this example, <code class="codeph">MOVE</code> is specified to move the files.</p>
<p>The <code class="codeph">CREATE_FILE_DEST</code> clause is not used, Oracle Managed Files is not enabled, and the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter is not set. Therefore, the <code class="codeph">FILE_NAME_CONVERT</code> clause is required. In this example, the files are moved from /disk2/oracle/sales to /disk3/oracle/sales.</p>
</li>
<li>
<p>Storage limits must be enforced for the PDB. Therefore, the <code class="codeph">STORAGE</code> clause is required. Specifically, all tablespaces that belong to the PDB must not exceed 2 gigabytes.</p>
</li>
<li>
<p>There is no file with the same name as the new temp file that will be created in the target location. Therefore, the <code class="codeph">TEMPFILE REUSE</code> clause is not required.</p>
</li>
</ul>
<p>Given the preceding factors, the following statement plugs in the PDB:</p>
<pre dir="ltr">CREATE PLUGGABLE DATABASE salespdb USING &#39;/disk1/usr/salespdb.xml&#39; 
  SOURCE_FILE_NAME_CONVERT = (&#39;/disk1/oracle/sales/&#39;, &#39;/disk2/oracle/sales/&#39;)
  MOVE
  FILE_NAME_CONVERT = (&#39;/disk2/oracle/sales/&#39;, &#39;/disk3/oracle/sales/&#39;)
  STORAGE (MAXSIZE 2G);
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__GUID-25116949-7B46-4A58-8926-7F394CE495B6">
<p class="titleinexample">Example 38-32 Plugging In an Unplugged PDB Using the SOURCE_FILE_DIRECTORY, MOVE, FILE_NAME_CONVERT, and STORAGE Clauses</p>
<p>This example assumes the following factors:</p>
<ul style="list-style-type: disc;">
<li>
<p>The new PDB is not based on the same unplugged PDB that was used to create an existing PDB in the CDB. Therefore, the <code class="codeph">AS</code> <code class="codeph">CLONE</code> clause is not required.</p>
</li>
<li>
<p>The <code class="codeph">PATH_PREFIX</code> clause is not required.</p>
</li>
<li>
<p>The XML file does not accurately describe the current locations of the files. Therefore, the <code class="codeph">SOURCE_FILE_NAME_CONVERT</code> clause or <code class="codeph">SOURCE_FILE_DIRECTORY</code> clause is required. In this example, the XML file indicates that the files are in /disk1/oracle/sales, but the files are in /disk2/oracle/sales, and the <code class="codeph">SOURCE_FILE_DIRECTORY</code> clause is used.</p>
</li>
<li>
<p>The files are not in the correct final location for the PDB. Therefore, <code class="codeph">COPY</code> or <code class="codeph">MOVE</code> must be included. In this example, <code class="codeph">MOVE</code> is specified to move the files.</p>
<p>The <code class="codeph">CREATE_FILE_DEST</code> clause is not used, Oracle Managed Files is not enabled, and the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter is not set. Therefore, the <code class="codeph">FILE_NAME_CONVERT</code> clause is required. In this example, the files are moved from /disk2/oracle/sales to /disk3/oracle/sales.</p>
</li>
<li>
<p>Storage limits must be enforced for the PDB. Therefore, the <code class="codeph">STORAGE</code> clause is required. Specifically, all tablespaces that belong to the PDB must not exceed 2 gigabytes.</p>
</li>
<li>
<p>There is no file with the same name as the new temp file that will be created in the target location. Therefore, the <code class="codeph">TEMPFILE REUSE</code> clause is not required.</p>
</li>
</ul>
<p>Given the preceding factors, the following statement plugs in the PDB:</p>
<pre dir="ltr">CREATE PLUGGABLE DATABASE salespdb USING &#39;/disk1/usr/salespdb.xml&#39; 
  SOURCE_FILE_DIRECTORY = &#39;/disk2/oracle/sales/&#39;  
  MOVE
  FILE_NAME_CONVERT = (&#39;/disk2/oracle/sales/&#39;, &#39;/disk3/oracle/sales/&#39;)
  STORAGE (MAXSIZE 2G);
</pre>
<div class="infoboxnotealso" id="GUID-F23F5352-F456-48EE-AED7-71E3DEBAAED0__GUID-061C1910-9739-429B-9392-775DF147253C">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="omf.htm#GUID-4A3C4616-0D81-4BBA-8EAD-FCAA8AD5C15A" title="Oracle Database can manage the files that comprise the database.">Using Oracle Managed Files</a></p>
</li>
<li>
<p><a class="olink REFRN10322" target="_blank" href="../REFRN/GUID-074F8896-D565-4139-BCDB-C81C9D741941.htm#REFRN10322"><span class="italic">Oracle Database Reference</span></a> for information about the <code class="codeph">PDB_FILE_NAME_CONVERT</code> initialization parameter</p>
</li>
</ul>
</div>
</div>
<!-- class="example" --></div>
</div>
<a id="ADMIN14168"></a>
<div class="props_rev_3"><a id="GUID-E7122CD7-47CA-4A89-A419-8CDEE622AF70"></a>
<h3 id="ADMIN-GUID-E7122CD7-47CA-4A89-A419-8CDEE622AF70" class="sect3"><span class="enumeration_section">38.5.3</span> After Plugging in an Unplugged PDB</h3>
<div>
<p>Certain rules regarding users and tablespaces apply after plugging in an unplugged PDB.</p>
<p>The following applies after plugging in an unplugged PDB:</p>
<ul style="list-style-type: disc;">
<li>
<p>Users in the PDB who used the default temporary tablespace of the source PDB use the default temporary tablespace of the target PDB. Users who used non-default temporary tablespaces in the source PDB continue to use the same local temporary tablespaces in the target PDB. See <span class="q">&#34;<a href="cdb_admin.htm#GUID-B34BC55B-C734-4799-A54A-0BB04073D9D0" title="A tablespace is a logical storage container for database objects, such as tables and indexes, that consume storage space. At the physical level, a tablespace stores data in one or more data files or temp files. You can use the ALTER DATABASE statement to manage tablespaces in a CDB.">About Managing Tablespaces in a CDB</a>&#34;</span>.</p>
</li>
<li>
<p>User-created common users that existed in the source CDB but not in the target CDB do not have any privileges granted commonly. However, if the target CDB has a common user with the same name as a common user in the PDB, the latter is linked to the former and has the privileges granted to this common user in the target CDB.</p>
<p>If the target CDB does not have a common user with the same name, then the user account is locked in the target PDB. You have the following options regarding each of these locked users:</p>
<ul style="list-style-type: disc;">
<li>
<p>Close the PDB, connect to the root, and create a common user with the same name. When the PDB is opened in read/write mode, differences in roles and privileges granted commonly to the user are resolved, and you can unlock the user. Privileges and roles granted locally to the user remain unchanged during this process.</p>
</li>
<li>
<p>You can create a new local user in the PDB and use Data Pump to export/import the locked user&#39;s data into the new local user&#39;s schema.</p>
</li>
<li>
<p>You can leave the user locked.</p>
</li>
<li>
<p>You can drop the user.</p>
</li>
</ul>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-E7122CD7-47CA-4A89-A419-8CDEE622AF70__GUID-BB96C2B0-E059-4CBA-903B-E957AD15836E">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="cdb_pdb_admin.htm#GUID-6FDBCEFC-29DF-4CBB-A000-B105A7328955" title="You can create, modify, or remove services for a PDB.">Managing Services Associated with PDBs</a>&#34;</span></p>
</li>
<li>
<p><a href="cdb_mon.htm#GUID-1DED3127-84E4-4967-BEB3-D0ADEC622643__CHDDHBAF">Example 43-9</a></p>
</li>
<li>
<p><a class="olink CNCPT89257" target="_blank" href="../CNCPT/cdblogic.htm#CNCPT89257"><span class="italic">Oracle Database Concepts</span></a> for information about common users and local users</p>
</li>
<li>
<p><a class="olink DBSEG002" target="_blank" href="../DBSEG/users.htm#DBSEG002"><span class="italic">Oracle Database Security Guide</span></a> for information about creating common users and local users in a CDB</p>
</li>
<li>
<p><a class="olink SUTIL4334" target="_blank" href="../SUTIL/GUID-45B17B65-20F2-4128-9A39-B1B0F5E323BB.htm#SUTIL4334"><span class="italic">Oracle Database Utilities</span></a> for information about using Oracle Data Pump with a CDB</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2"><a id="GUID-60C23F96-6EF3-4BE3-B8CF-5AD6EC29954F"></a>
<h2 id="ADMIN-GUID-60C23F96-6EF3-4BE3-B8CF-5AD6EC29954F" class="sect2"><span class="enumeration_section">38.6</span> Creating a PDB Using a Non-CDB</h2>
<p>You can create a PDB using a non-CDB in different ways.</p>
<a id="ADMIN13597"></a>
<div class="props_rev_3"><a id="GUID-F68E6FE9-919B-4665-95F7-785E69E07264"></a>
<h3 id="ADMIN-GUID-F68E6FE9-919B-4665-95F7-785E69E07264" class="sect3"><span class="enumeration_section">38.6.1</span> About Creating a PDB Using a Non-CDB</h3>
<div>
<p>You can move a non-CDB into a PDB.</p>
<p>You can accomplish this task in the following ways:</p>
<ul style="list-style-type: disc;">
<li>
<p>Creating a PDB by cloning a non-CDB</p>
<p>Starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2), you can create a PDB by cloning a non-CDB. This method is the simplest way to create a PDB using a non-CDB, but it requires copying the files of the non-CDB to a new location.</p>
<p>See <span class="q">&#34;<a href="cdb_plug.htm#GUID-05702CEB-A43C-452C-8081-4CA68DDA8007" title="You can create a PDB by cloning a local PDB, a remote PDB, or a non-CDB.">Creating a PDB by Cloning an Existing PDB or Non-CDB</a>&#34;</span> for instructions.</p>
<p>Both the CDB and the non-CDB must be running Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2) or later. If your current non-CDB uses an Oracle Database release before Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2), then you must upgrade the non-CDB to Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2) to use this technique. See <a class="olink UPGRD" target="_blank" href="../UPGRD/toc.htm"><span class="italic">Oracle Database Upgrade Guide</span></a> for information about upgrading.</p>
</li>
<li>
<p>Use the <code class="codeph">DBMS_PDB</code> package to generate an XML metadata file.</p>
<p>The XML metadata file describes the database files of the non-CDB so that you can plug it into a CDB.</p>
<p>This method requires more steps than creating a PDB by cloning a non-CDB, but it enables you to create a PDB using a non-CDB without moving the non-CDB files in some situations.</p>
<p><span class="q">&#34;<a href="cdb_plug.htm#GUID-0507DF33-30D8-4EB6-9A24-F324E0087ECD" title="You can use the DBMS_PDB package on a non-CDB to enable you to plug the non-CDB into a CDB.">Using the DBMS_PDB Package on a Non-CDB</a>&#34;</span> describes using this technique.</p>
<p>To use this technique, the non-CDB must be an Oracle Database 12<span class="italic">c</span> non-CDB. If your current non-CDB uses an Oracle Database release before Oracle Database 12<span class="italic">c</span>, then you must upgrade the non-CDB to Oracle Database 12<span class="italic">c</span> to use this technique. See <a class="olink UPGRD" target="_blank" href="../UPGRD/toc.htm"><span class="italic">Oracle Database Upgrade Guide</span></a> for information about upgrading.</p>
</li>
<li>
<p>Use Oracle Data Pump export/import.</p>
<p>You export the data from the non-CDB and import it into a PDB.</p>
<p>When you import, specify the connect identifier for the PDB after the user name. For example, if the connect identifier for the PDB is <code class="codeph">hrpdb</code>, then enter the following when you run the Oracle Data Pump Import utility:</p>
<pre dir="ltr">impdp <span class="italic">user_name</span>@hrpdb ...
</pre>
<p>If the Oracle Database release of the non-CDB is Oracle Database 11<span class="italic">g</span> Release 2 (11.2.0.3) or later, then you can use full transportable export/import to move the data. When transporting a non-CDB from an Oracle Database 11<span class="italic">g</span> Release 2 (11.2.0.3) or later Oracle Database 11<span class="italic">g</span> database to Oracle Database 12<span class="italic">c</span>, the <code class="codeph">VERSION</code> Data Pump export parameter must be set to <code class="codeph">12.0.0.0.0</code> or higher.</p>
<p>If the Oracle Database release of the non-CDB is before Oracle Database 11<span class="italic">g</span> Release 2 (11.2.0.3), then you can use transportable tablespaces to move the data, or you can perform a full database export/import.</p>
<p>See <a href="transport.htm#GUID-1901E9C3-8FCE-4D4E-AB65-34D703474E52" title="Transporting data moves the data from one database to another.">Transporting Data</a>.</p>
</li>
<li>
<p>Use GoldenGate replication.</p>
<p>You replicate the data from the non-CDB to a PDB. When the PDB catches up with the non-CDB, you fail over to the PDB.</p>
<p>See the Oracle GoldenGate documentation.</p>
</li>
</ul>
</div>
</div>
<a id="ADMIN13598"></a>
<div class="props_rev_3"><a id="GUID-0507DF33-30D8-4EB6-9A24-F324E0087ECD"></a>
<h3 id="ADMIN-GUID-0507DF33-30D8-4EB6-9A24-F324E0087ECD" class="sect3"><span class="enumeration_section">38.6.2</span> Using the DBMS_PDB Package on a Non-CDB</h3>
<p>You can use the <code class="codeph">DBMS_PDB</code> package on a non-CDB to enable you to plug the non-CDB into a CDB.</p>
<a id="ADMIN13757"></a><a id="ADMIN13756"></a>
<div class="props_rev_3"><a id="GUID-FEB1F7ED-33EA-4582-8861-52B18BC74A61"></a>
<h4 id="ADMIN-GUID-FEB1F7ED-33EA-4582-8861-52B18BC74A61" class="sect4"><span class="enumeration_section">38.6.2.1</span> About Using the DBMS_PDB Package on a Non-CDB</h4>
<div>
<p>This technique creates a PDB from a non-CDB using the <code class="codeph">DBMS_PDB.DESCRIBE</code> procedure.</p>
<p>You run the <code class="codeph">DBMS_PDB.DESCRIBE</code> procedure on the non-CDB to generate the XML file that describes the database files of the non-CDB. After the XML file is generated, you can plug in the non-CDB in the same way that you can plug in an unplugged PDB. Specifically, you specify the <code class="codeph">USING</code> clause in the <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement. When the non-CDB is plugged in to a CDB, it is a PDB.</p>
<div class="figure" id="GUID-FEB1F7ED-33EA-4582-8861-52B18BC74A61__GUID-1B3EDBBB-C6FB-4B0C-B11C-8429309B56DA">
<p class="titleinfigure">Figure 38-7 Plug In a Non-CDB Using the DBMS_PDB.DESCRIBE Procedure</p>
<img width="558" height="614" src="img/GUID-ACF2D82D-4757-4A73-8938-1E6C0D2F08EC-default.png" alt="Description of Figure 38-7 follows" title="Description of Figure 38-7 follows"/><br/>
<a href="img_text/GUID-ACF2D82D-4757-4A73-8938-1E6C0D2F08EC-print.htm">Description of &#34;Figure 38-7 Plug In a Non-CDB Using the DBMS_PDB.DESCRIBE Procedure&#34;</a></div>
<!-- class="figure" -->
<div class="infobox-note" id="GUID-FEB1F7ED-33EA-4582-8861-52B18BC74A61__GUID-8B8734D6-E5DB-4503-9889-94A596C4A75B">
<p class="notep1">Note:</p>
<p>To use this technique, the non-CDB must be an Oracle Database 12<span class="italic">c</span> non-CDB.</p>
</div>
<div class="infoboxnotealso" id="GUID-FEB1F7ED-33EA-4582-8861-52B18BC74A61__GUID-71EA71C0-C6BB-4D56-87D3-C40B7A8BCE2B">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="cdb_plug.htm#GUID-3132C4E5-8734-458B-8B0C-EFC77A45FFA3" title="You can create a PDB by plugging an unplugged PDB into a CDB.">Creating a PDB by Plugging an Unplugged PDB into a CDB</a>&#34;</span></p>
</div>
</div>
</div>
<a id="ADMIN13851"></a>
<div class="props_rev_3"><a id="GUID-EE58804F-A999-4F7C-93DE-D641B3C1047B"></a>
<h4 id="ADMIN-GUID-EE58804F-A999-4F7C-93DE-D641B3C1047B" class="sect4"><span class="enumeration_section">38.6.2.2</span> Using the DBMS_PDB Package to Create an Unplugged PDB</h4>
<div>
<p>You can move a non-CDB into a PDB by using the <code class="codeph">DBMS_PDB.DESCRIBE</code> procedure.</p>
<div class="section">
<p class="subhead3">To move a non-CDB into a PDB using the <code class="codeph">DBMS_PDB</code> package:</p>
<ol>
<li>
<p>Create the CDB if it does not exist.</p>
<p>See <a href="cdb_create.htm#GUID-77D4BBA7-2A64-46D9-A2B8-C56060772215" title="Creating and configuring a &nbsp;multitenant container database (CDB) includes tasks such as planning for CDB creation, creating the CDB, and optionally configuring EM Express for the CDB.">Creating and Configuring a CDB</a>.</p>
</li>
<li>
<p>Ensure that the non-CDB is in a transactionally-consistent state and place it in read-only mode.</p>
<p>See <span class="q">&#34;<a href="start.htm#GUID-E346A6EB-6CAA-4A0F-AF0E-841B8C3D5B05" title="Opening a database in read-only mode enables you to query an open database while eliminating any potential for online data content changes.">Opening a Database in Read-Only Mode</a>&#34;</span>.</p>
</li>
<li>
<p>Connect to the non-CDB, and run the <code class="codeph">DBMS_PDB.DESCRIBE</code> procedure to construct an XML file that describes the non-CDB.</p>
<p>The current user must have <code class="codeph">SYSDBA</code> administrative privilege. The user must exercise the privilege using <code class="codeph">AS</code> <code class="codeph">SYSDBA</code> at connect time.</p>
<p>For example, to generate an XML file named <code class="codeph">ncdb.xml</code> in the /disk1/oracle directory, run the following procedure:</p>
<pre dir="ltr">BEGIN
  DBMS_PDB.DESCRIBE(
    pdb_descr_file =&gt; &#39;/disk1/oracle/ncdb.xml&#39;);
END;
/
</pre>
<p>After the procedure completes successfully, you can use the XML file and the non-CDB&#39;s database files to plug the non-CDB into a CDB.</p>
</li>
<li>
<p>Run the <code class="codeph">DBMS_PDB.CHECK_PLUG_COMPATIBILITY</code> function to determine whether the non-CDB is compatible with the CDB.</p>
<p>When you run the function, set the following parameters:</p>
<p>- <code class="codeph">pdb_descr_file</code> - Set this parameter to the full path to the XML file.</p>
<p>- <code class="codeph">pdb_name</code> - Specify the name of the new PDB. If this parameter is omitted, then the PDB name in the XML file is used.</p>
<p>For example, to determine whether a non-CDB described by the /disk1/oracle/ncdb.xml file is compatible with the current CDB, run the following PL/SQL block:</p>
<pre dir="ltr">SET SERVEROUTPUT ON
DECLARE
  compatible CONSTANT VARCHAR2(3) := 
    CASE DBMS_PDB.CHECK_PLUG_COMPATIBILITY(
           pdb_descr_file =&gt; &#39;/disk1/oracle/ncdb.xml&#39;,
           pdb_name       =&gt; &#39;NCDB&#39;)
    WHEN TRUE THEN &#39;YES&#39;
    ELSE &#39;NO&#39;
END;
BEGIN
  DBMS_OUTPUT.PUT_LINE(compatible);
END;
/
</pre>
<p>If the output is <code class="codeph">YES</code>, then the non-CDB is compatible, and you can continue with the next step.</p>
<p>If the output is <code class="codeph">NO</code>, then the non-CDB is not compatible, and you can check the <code class="codeph">PDB_PLUG_IN_VIOLATIONS</code> view to see why it is not compatible. All violations must be corrected before you continue. For example, any version or patch mismatches should be resolved by running an upgrade or the datapatch utility. After correcting the violations, run <code class="codeph">DBMS_PDB.CHECK_PLUG_COMPATIBILITY</code> again to ensure that the non-CDB is compatible with the CDB.</p>
</li>
<li>
<p>Shut down the non-CDB.</p>
<p>See <span class="q">&#34;<a href="start.htm#GUID-3661B282-5C34-4E32-BC6A-906A72712866" title="You can shut down a database with SQL*Plus or Oracle Restart.">Shutting Down a Database</a>&#34;</span>.</p>
</li>
<li>
<p>Plug in the non-CDB.</p>
<p>Follow the instructions in <span class="q">&#34;<a href="cdb_plug.htm#GUID-3132C4E5-8734-458B-8B0C-EFC77A45FFA3" title="You can create a PDB by plugging an unplugged PDB into a CDB.">Creating a PDB by Plugging an Unplugged PDB into a CDB</a>&#34;</span> to plug in the non-CDB.</p>
<p>For example, the following SQL statement plugs in a non-CDB, copies its files to a new location, and includes only the <code class="codeph">tbs3</code> user tablespace from the non-CDB:</p>
<pre dir="ltr">CREATE PLUGGABLE DATABASE ncdb USING &#39;/disk1/oracle/ncdb.xml&#39;
  COPY
  FILE_NAME_CONVERT = (&#39;/disk1/oracle/dbs/&#39;, &#39;/disk2/oracle/ncdb/&#39;)
  USER_TABLESPACES=(&#39;tbs3&#39;);
</pre>
<p>Do not open the new PDB. You will open it in step <a href="cdb_plug.htm#GUID-EE58804F-A999-4F7C-93DE-D641B3C1047B__CEGJHJGD">8</a>.</p>
<p>The <code class="codeph">USER_TABLESPACES</code> clause enables you to separate data that was used for multiple tenants in a non-CDB into different PDBs. You can use multiple <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statements with this clause to create other PDBs that include the data from other tablespaces that existed in the non-CDB.</p>
</li>
<li>
<p><a id="d264795e8425" class="indexterm-anchor"></a>Run the <span class="italic">ORACLE_HOME</span>/rdbms/admin/noncdb_to_pdb.sql script. This script must be run before the PDB can be opened for the first time. See <span class="q">&#34;<a href="cdb_plug.htm#GUID-F68E6FE9-919B-4665-95F7-785E69E07264" title="You can move a non-CDB into a PDB.">Creating a PDB Using a Non-CDB</a>&#34;</span>.</p>
<p>If the PDB was not a non-CDB, then running the noncdb_to_pdb.sql script is not required.</p>
<p>To run the noncdb_to_pdb.sql script, complete the following steps:</p>
<ol>
<li>
<p>Access the PDB.</p>
<p>The current user must have <code class="codeph">SYSDBA</code> administrative privilege, and the privilege must be either commonly granted or locally granted in the PDB. The user must exercise the privilege using <code class="codeph">AS</code> <code class="codeph">SYSDBA</code> at connect time.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Run the noncdb_to_pdb.sql script:</p>
<pre dir="ltr">@$ORACLE_HOME/rdbms/admin/noncdb_to_pdb.sql
</pre></li>
</ol>
<p>The script opens the PDB, performs changes, and closes the PDB when the changes are complete.</p>
</li>
<li id="GUID-EE58804F-A999-4F7C-93DE-D641B3C1047B__CEGJHJGD">
<p>Open the new PDB in read/write mode.</p>
<p>You must open the new PDB in read/write mode for Oracle Database to complete the integration of the new PDB into the CDB. An error is returned if you attempt to open the PDB in read-only mode. After the PDB is opened in read/write mode, its status is <code class="codeph">NORMAL</code>.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-322C5C03-4C48-40CD-8230-0BA5F16BF96B" title="You can modify the open mode of a PDB by using the ALTER PLUGGABLE DATABASE SQL statement or the SQL*Plus STARTUP command.">Modifying the Open Mode of PDBs</a>&#34;</span> for more information.</p>
</li>
<li>
<p>Back up the PDB.</p>
<p>A PDB cannot be recovered unless it is backed up.</p>
<p><a class="olink BRADV428" target="_blank" href="../BRADV/rcmbckba.htm#BRADV428"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> for information about backing up a PDB.</p>
</li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infobox-note" id="GUID-EE58804F-A999-4F7C-93DE-D641B3C1047B__GUID-E9DD002C-0C50-487B-B857-6AA13F0DC51F">
<p class="notep1">Note:</p>
<p>If an error is returned during PDB creation, then the PDB being created might be in an <code class="codeph">UNUSABLE</code> state. You can check a PDB&#39;s state by querying the <code class="codeph">CDB_PDBS</code> or <code class="codeph">DBA_PDBS</code> view, and you can learn more about PDB creation errors by checking the alert log. An unusable PDB can only be dropped, and it must be dropped before a PDB with the same name as the unusable PDB can be created.</p>
</div>
<div class="infoboxnotealso" id="GUID-EE58804F-A999-4F7C-93DE-D641B3C1047B__GUID-C3FE9C34-7F69-4047-A30A-BCDFB8C9B187">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="cdb_plug.htm#GUID-E7122CD7-47CA-4A89-A419-8CDEE622AF70" title="Certain rules regarding users and tablespaces apply after plugging in an unplugged PDB.">After Plugging in an Unplugged PDB</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<a id="ADMIN13623"></a>
<div class="props_rev_3"><a id="GUID-893E1D67-BD95-4757-B862-03AD13AFF722"></a>
<h2 id="ADMIN-GUID-893E1D67-BD95-4757-B862-03AD13AFF722" class="sect2"><span class="enumeration_section">38.7</span> Unplugging a PDB from a CDB</h2>
<p>You can unplug a PDB from a CDB.</p>
<a id="ADMIN13857"></a><a id="ADMIN13856"></a>
<div class="props_rev_3"><a id="GUID-3D9AA767-F03C-46EB-AF8E-6808AF1C9D9F"></a>
<h3 id="ADMIN-GUID-3D9AA767-F03C-46EB-AF8E-6808AF1C9D9F" class="sect3"><span class="enumeration_section">38.7.1</span> About Unplugging a PDB</h3>
<div>
<p>Unplugging a PDB disassociates the PDB from a CDB. You unplug a PDB when you want to move the PDB to a different CDB or when you no longer want the PDB to be available.</p>
<p>To unplug a PDB, connect to the root and use the <code class="codeph">ALTER</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement to specify an XML file that will contain metadata about the PDB after it is unplugged. The SQL statement creates the XML file, and it contains the required information to enable a <code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement on a target CDB to plug in the PDB.</p>
<div class="figure" id="GUID-3D9AA767-F03C-46EB-AF8E-6808AF1C9D9F__GUID-4038C386-77DE-44A4-A798-9542AF6DC7B3">
<p class="titleinfigure">Figure 38-8 Unplug a PDB</p>
<img width="555" height="405" src="img/GUID-565F40A1-9B85-4EBD-A7EB-AA1266912B59-default.png" alt="Description of Figure 38-8 follows" title="Description of Figure 38-8 follows"/><br/>
<a href="img_text/GUID-565F40A1-9B85-4EBD-A7EB-AA1266912B59-print.htm">Description of &#34;Figure 38-8 Unplug a PDB&#34;</a></div>
<!-- class="figure" -->
<p>The PDB must be closed before it can be unplugged. When you unplug a PDB from a CDB, the unplugged PDB is in mounted mode. The unplug operation makes some changes in the PDB&#39;s data files to record, for example, that the PDB was successfully unplugged. Because it is still part of the CDB, the unplugged PDB is included in an RMAN backup of the entire CDB. Such a backup provides a convenient way to archive the unplugged PDB in case it is needed in the future.</p>
<p>To completely remove the PDB from the CDB, you can drop the PDB. The only operation supported on an unplugged PDB is dropping the PDB. The PDB must be dropped from the CDB before it can be plugged back into the same CDB. A PDB is usable only when it is plugged into a CDB.</p>
<div class="infoboxnotealso" id="GUID-3D9AA767-F03C-46EB-AF8E-6808AF1C9D9F__GUID-C103D457-94FE-4488-92DC-C325C9223827">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="cdb_plug.htm#GUID-6EEAC62B-E7DD-47BA-A62B-1F34B3D9D02E" title="The DROP PLUGGABLE DATABASE statement drops a PDB. You can drop a PDB when you want to move the PDB from one CDB to another or when you no longer need the PDB.">Dropping a PDB</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="cdb_admin.htm#GUID-322C5C03-4C48-40CD-8230-0BA5F16BF96B" title="You can modify the open mode of a PDB by using the ALTER PLUGGABLE DATABASE SQL statement or the SQL*Plus STARTUP command.">Modifying the Open Mode of PDBs</a>&#34;</span> for information about closing a PDB</p>
</li>
<li>
<p><span class="q">&#34;<a href="cdb_pdb_admin.htm#GUID-3AAA613B-C52C-4080-B0C3-7212859E3A2F" title="You can use the ALTER SYSTEM statement to modify a PDB.">Using the ALTER SYSTEM Statement to Modify a PDB</a>&#34;</span> for information about initialization parameters and unplugged PDBs</p>
</li>
<li>
<p><a class="olink DBSEG573" target="_blank" href="../DBSEG/users.htm#DBSEG573"><span class="italic">Oracle Database Security Guide</span></a> for information about common users and local users</p>
</li>
</ul>
</div>
</div>
</div>
<a id="ADMIN13625"></a><a id="ADMIN13858"></a>
<div class="props_rev_3"><a id="GUID-75C46F1B-00D8-4FB9-A8E7-6F7FE3DE4CA0"></a>
<h3 id="ADMIN-GUID-75C46F1B-00D8-4FB9-A8E7-6F7FE3DE4CA0" class="sect3"><span class="enumeration_section">38.7.2</span> Unplugging a PDB</h3>
<div>
<p>You must meet prerequsites when unplugging a PDB.</p>
<div class="section">
<p>The following prerequisites must be met:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>The current user must have <code class="codeph">SYSDBA</code> or <code class="codeph">SYSOPER</code> administrative privilege, and the privilege must be either commonly granted or locally granted in the PDB. The user must exercise the privilege using <code class="codeph">AS</code> <code class="codeph">SYSDBA</code> or <code class="codeph">AS</code> <code class="codeph">SYSOPER</code> at connect time.</p>
</li>
<li>
<p>The PDB must have been opened at least once.</p>
</li>
<li>
<p>The PDB must be closed. In an Oracle Real Application Clusters (Oracle RAC) environment, the PDB must be closed on all instances.</p>
</li>
</ul>
<div class="infobox-note" id="GUID-75C46F1B-00D8-4FB9-A8E7-6F7FE3DE4CA0__GUID-3FBFA050-BFC2-4321-9E7B-24FCDF31B4BB">
<p class="notep1">Note:</p>
<p>If you are unplugging in a PDB that includes data that was encrypted with Transparent Data Encryption, then follow the instructions in <a class="olink ASOAG10441" target="_blank" href="../ASOAG/using-transparent-data-encryption-with-other-oracle-features.htm#ASOAG10441"><span class="italic">Oracle Database Advanced Security Guide</span></a>.</p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To unplug a PDB:</p>
<ol>
<li>
<p>In SQL*Plus, ensure that the current container is the root.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-E1BBCE0F-76CA-49F3-9A6B-AC6B13AB9AC5" title="The data dictionary in each container in a CDB is separate, and the current container is the container whose data dictionary is used for name resolution and for privilege authorization. The current container can be the root or a PDB. Each session has exactly one current container at any point in time, but it is possible for a session to switch from one container to another.">About the Current Container</a>&#34;</span> and <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Run the <code class="codeph">ALTER</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement with the <code class="codeph">UNPLUG</code> <code class="codeph">INTO</code> clause, and specify the PDB to unplug and the name and location of the PDB&#39;s XML metadata file.</p>
</li>
</ol>
</div>
<!-- class="section" -->
<div class="example" id="GUID-75C46F1B-00D8-4FB9-A8E7-6F7FE3DE4CA0__GUID-CCEEA9CE-A707-44CE-9385-F8813577D397">
<p class="titleinexample">Example 38-33 Unplugging PDB salespdb</p>
<p>This <code class="codeph">ALTER</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement unplugs the PDB <code class="codeph">salespdb</code> and creates the salespdb.xml metadata file in the /oracle/data/ directory:</p>
<pre dir="ltr">ALTER PLUGGABLE DATABASE salespdb UNPLUG INTO &#39;/oracle/data/salespdb.xml&#39;;
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<a id="ADMIN13660"></a><a id="ADMIN13969"></a><a id="ADMIN13658"></a>
<div class="props_rev_3"><a id="GUID-6EEAC62B-E7DD-47BA-A62B-1F34B3D9D02E"></a>
<h2 id="ADMIN-GUID-6EEAC62B-E7DD-47BA-A62B-1F34B3D9D02E" class="sect2"><span class="enumeration_section">38.8</span> Dropping a PDB</h2>
<div>
<p>The <code class="codeph">DROP</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement drops a PDB. You can drop a PDB when you want to move the PDB from one CDB to another or when you no longer need the PDB.</p>
<div class="section">
<p>When you drop a PDB, the control file of the CDB is modified to eliminate all references to the dropped PDB. Archived redo log files and backups associated with the PDB are not removed, but you can use Oracle Recovery Manager (RMAN) to remove them.</p>
<p>When dropping a PDB, you can either keep or delete the PDB&#39;s data files by using one of the following clauses:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">KEEP</code> <code class="codeph">DATAFILES</code>, the default, retains the data files.</p>
<p>The PDB&#39;s temp file is removed even when <code class="codeph">KEEP</code> <code class="codeph">DATAFILES</code> is specified because the temp file is no longer needed.</p>
<p>When <code class="codeph">KEEP</code> <code class="codeph">DATAFILES</code> is specified, the PDB must be unplugged.</p>
</li>
<li>
<p><code class="codeph">INCLUDING</code> <code class="codeph">DATAFILES</code> removes the data files from disk.</p>
<p>If a PDB was created with the <code class="codeph">SNAPSHOT</code> <code class="codeph">COPY</code> clause, then you must specify <code class="codeph">INCLUDING</code> <code class="codeph">DATAFILES</code> when you drop the PDB.</p>
</li>
</ul>
<p>The following prerequisites must be met:</p>
<ul style="list-style-type: disc;">
<li>
<p>The PDB must be in mounted mode, or it must be unplugged.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-322C5C03-4C48-40CD-8230-0BA5F16BF96B" title="You can modify the open mode of a PDB by using the ALTER PLUGGABLE DATABASE SQL statement or the SQL*Plus STARTUP command.">Modifying the Open Mode of PDBs</a>&#34;</span>.</p>
<p>See <span class="q">&#34;<a href="cdb_plug.htm#GUID-893E1D67-BD95-4757-B862-03AD13AFF722" title="You can unplug a PDB from a CDB.">Unplugging a PDB from a CDB</a>&#34;</span>.</p>
</li>
<li>
<p>The current user must have <code class="codeph">SYSDBA</code> or <code class="codeph">SYSOPER</code> administrative privilege, and the privilege must be either commonly granted or locally granted in the PDB. The user must exercise the privilege using <code class="codeph">AS</code> <code class="codeph">SYSDBA</code> or <code class="codeph">AS</code> <code class="codeph">SYSOPER</code> at connect time.</p>
</li>
</ul>
<div class="infobox-note" id="GUID-6EEAC62B-E7DD-47BA-A62B-1F34B3D9D02E__GUID-F34C4A60-2A7D-4B77-B935-F23C28170F6B">
<p class="notep1">Note:</p>
<p>This operation is destructive.</p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">To drop a PDB:</p>
<ol>
<li>
<p>In SQL*Plus, ensure that the current container is the root.</p>
<p>See <span class="q">&#34;<a href="cdb_admin.htm#GUID-E1BBCE0F-76CA-49F3-9A6B-AC6B13AB9AC5" title="The data dictionary in each container in a CDB is separate, and the current container is the container whose data dictionary is used for name resolution and for privilege authorization. The current container can be the root or a PDB. Each session has exactly one current container at any point in time, but it is possible for a session to switch from one container to another.">About the Current Container</a>&#34;</span> and <span class="q">&#34;<a href="cdb_admin.htm#GUID-D75CAF12-1073-40DB-B096-51B63E4C01E3" title="You can use SQL*Plus to access the root or a PDB in a CDB. You can connect to a container by using the SQL*Plus CONNECT command, or you can switch into a container with an ALTER SESSION SET CONTAINER SQL statement.">Accessing a Container in a CDB with SQL*Plus</a>&#34;</span>.</p>
</li>
<li>
<p>Run the <code class="codeph">DROP</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> statement and specify the PDB to drop.</p>
</li>
</ol>
</div>
<!-- class="section" -->
<div class="section"></div>
<!-- class="section" -->
<div class="example" id="GUID-6EEAC62B-E7DD-47BA-A62B-1F34B3D9D02E__GUID-FF7541EE-ACD7-4151-AEBB-1F9E9A944FA1">
<p class="titleinexample">Example 38-34 Dropping PDB salespdb While Keeping Its Data Files</p>
<pre dir="ltr">DROP PLUGGABLE DATABASE salespdb
  KEEP DATAFILES;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-6EEAC62B-E7DD-47BA-A62B-1F34B3D9D02E__GUID-8B29E38F-F7D2-476F-9A89-5593A3BA7E0B">
<p class="titleinexample">Example 38-35 Dropping PDB salespdb and Its Data Files</p>
<pre dir="ltr">DROP PLUGGABLE DATABASE salespdb
  INCLUDING DATAFILES;
</pre>
<div class="infoboxnotealso" id="GUID-6EEAC62B-E7DD-47BA-A62B-1F34B3D9D02E__GUID-BAE3500C-0E35-4B47-A0D5-A95A7C7E61F4">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="cdb_plug.htm#GUID-893E1D67-BD95-4757-B862-03AD13AFF722" title="You can unplug a PDB from a CDB.">Unplugging a PDB from a CDB</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="cdb_plug.htm#GUID-8A6287A1-14E5-4B45-972F-FC2FB3CDCF8B__CEGEECGG">The SNAPSHOT COPY Clause</a>&#34;</span></p>
</li>
<li>
<p><a class="olink SQLRF55699" target="_blank" href="../SQLRF/statements_8028.htm#SQLRF55699"><span class="italic">Oracle Database SQL Language Reference</span></a></p>
</li>
<li>
<p><a class="olink BRADV89346" target="_blank" href="../BRADV/rcmquick.htm#BRADV89346"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> for information about RMAN</p>
</li>
</ul>
</div>
</div>
<!-- class="example" --></div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1842">
<tr>
<td class="cellalignment1854">
<table class="cellalignment1847">
<tr>
<td class="cellalignment1846"><a href="cdb_create.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1846"><a href="cdb_plug_em.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2001, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1856">
<table class="cellalignment1845">
<tr>
<td class="cellalignment1846"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1846"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1846"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1846"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1846"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1846"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>