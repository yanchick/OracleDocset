<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-178"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Using%20Oracle%20Scheduler%20with%20a%20CDB"></a><title>Using Oracle Scheduler with a CDB</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="description" content="You can use Oracle Scheduler to schedule jobs in a multitenant container database (CDB)."/>
<meta name="keywords" content="Scheduler, invocations to CDB, CDB, using job coordinator in CDB, using slave processes in CDB, DBMS_JOB, using with PDB, closing a PDB, Views, new and changed"/>
<meta name="dcterms.created" content="2017-07-10T12:24:11Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Administrator&rsquo;s Guide"/>
<meta name="dcterms.identifier" content="E41484-15"/>
<meta name="dcterms.isVersionOf" content="ADMIN"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2001, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="cdb_dbrm_em.htm" title="Previous" type="text/html"/>
<link rel="Next" href="GUID-1C1C46B7-4686-43D8-AF22-554FF8C4AFBD.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41484-15.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-5BD1ACC9-D10D-4573-860F-5F8A65AE8554"></a> <span id="PAGE" style="display:none;">56/59</span> <!-- End Header -->
<a id="ADMIN13888"></a>
<h1 id="ADMIN-GUID-5BD1ACC9-D10D-4573-860F-5F8A65AE8554" class="sect1"><span class="enumeration_chapter">46</span> Using Oracle Scheduler with a CDB</h1>
<div>
<p>You can use Oracle Scheduler to schedule jobs in a multitenant container database (CDB).</p>
<p>Before using Oracle Scheduler with a CDB, meet the following requirements:</p>
<ul style="list-style-type: disc;">
<li>
<p>You understand how to configure and manage a CDB. See <a href="part_cdb.htm#GUID-93F1E584-D309-4301-82E0-AD0E60D4977C" title="You can manage a multitenant environment.">Managing a Multitenant Environment</a> for an overview and related information.</p>
</li>
<li>
<p>You understand how to use Oracle Scheduler to schedule jobs in a non-CDB. See <a href="schedover.htm#GUID-6B8C0335-D36B-44D3-95BC-82FA2141D967" title="You can schedule tasks with Oracle Scheduler.">Oracle Scheduler Concepts</a>, <a href="scheduse.htm#GUID-D41660D0-D88F-4D9F-8CC8-63D040EDC4E6" title="You can create, run, and manage jobs with Oracle Scheduler.">Scheduling Jobs with Oracle Scheduler</a>, and <a href="schedadmin.htm#GUID-5271609E-3476-4E4A-A28F-8E9776D2B20A" title="You can configure, manage, monitor, and troubleshoot Oracle Scheduler.">Administering Oracle Scheduler</a> for information.</p>
</li>
</ul>
</div>
<a id="ADMIN13889"></a>
<div class="props_rev_3"><a id="GUID-997A97BA-765B-46EA-90C1-0656E86C1967"></a>
<h2 id="ADMIN-GUID-997A97BA-765B-46EA-90C1-0656E86C1967" class="sect2"><span class="enumeration_section">46.1</span> DBMS_SCHEDULER Invocations in a CDB</h2>
<div>
<p>Most scheduler calls work exactly the same way as they did in non-CDBs, with the exception of two scheduler global attributes.</p>
<p>To limit job slaves, set the value of the <code class="codeph">job_queue_processes</code> initialization parameter.</p>
<p>For all other global attribute settings, you must be at the pluggable database (PDB) level only. For example, if you set the <code class="codeph">EMAIL_SENDER</code> attribute in the root database, it applies to the jobs that run in the root, not the jobs running in a specific PDB. If you want to pick a new <code class="codeph">EMAIL_SENDER</code> for a PDB, then you must set the global attribute in that PDB.</p>
</div>
</div>
<a id="ADMIN13890"></a>
<div class="props_rev_3"><a id="GUID-BB55E3D0-E9D0-4A47-A5FF-C9E6D4D195F9"></a>
<h2 id="ADMIN-GUID-BB55E3D0-E9D0-4A47-A5FF-C9E6D4D195F9" class="sect2"><span class="enumeration_section">46.2</span> Job Coordinator and Slave Processes in a CDB</h2>
<div>
<p>The major CDB-related changes are to the job coordinator process.</p>
<p>In a non-CDB, the coordinator looks at all jobs that are ready to run, picks a subset of them to run, and assigns them to job slaves. It also opens and closes windows, which changes the resource plan in effect for the database.</p>
<p>That is essentially what happens inside a CDB except for the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>Jobs are selected from all PDBs</p>
<p>The coordinator looks at the root database and all the child PDBs and selects jobs based on the job priority, the job scheduled start time, and the availability of resources to run the job. The latter criterion depends on the consumer group of the job and the resource plan currently in effect. The coordinator makes no attempt to be fair to every PDB. The only way to ensure that jobs from a PDB are not starved is to allocate enough resources to it.</p>
</li>
<li>
<p>Windows are open in the PDB and root database levels</p>
<p>In a non-CDB, only one window can be open at any given time. In a CDB, there are two levels of windows. At the PDB level, windows can be used to set resource plans that allocate resources among consumer groups belonging to that PDB. At the root database level, windows can be used to allocate resources to various different PDBs. Therefore, at any time, there can be a window open in the root database and one in each PDB.</p>
</li>
<li>
<p>Job slave switches to the specific PDB it belongs to</p>
<p>The job slaves are essentially the same as in a non-CDB, except that when a slave executes a job, it switches to the PDB that the job belongs to and then executes it. The rest of the code is essentially unchanged.</p>
</li>
</ul>
</div>
</div>
<a id="ADMIN13891"></a>
<div class="props_rev_3"><a id="GUID-1089C97D-A3BF-48FC-92F7-0992C632124F"></a>
<h2 id="ADMIN-GUID-1089C97D-A3BF-48FC-92F7-0992C632124F" class="sect2"><span class="enumeration_section">46.3</span> Using DBMS_JOB</h2>
<div>
<p>You can create a job using <code class="codeph">DBMS_JOB</code> within a PDB, and it will work as before. However, <code class="codeph">DBMS_JOB</code> has been desupported and using it is not recommended.</p>
<p>For the scheduler, the coordinator now selects jobs to run from every single PDB and not just a single database as was the case before. Also, for the scheduler, the slave will switch into a PDB before executing a job; otherwise, the code is essentially unchanged.</p>
<div class="infoboxnotealso" id="GUID-1089C97D-A3BF-48FC-92F7-0992C632124F__GUID-25E90CB0-D4B0-42A7-BB52-926103528BDB">
<p class="notep1">See Also:</p>
<p><a href="appendix_a.htm#GUID-CC42E8DA-7203-449E-BCEA-8187ECC4BCDF" title="Oracle Scheduler replaces the DBMS_JOB package.">Support for DBMS_JOB</a></p>
</div>
</div>
</div>
<a id="ADMIN13892"></a>
<div class="props_rev_3"><a id="GUID-4EABC5E2-765C-418E-B889-A59538118E9D"></a>
<h2 id="ADMIN-GUID-4EABC5E2-765C-418E-B889-A59538118E9D" class="sect2"><span class="enumeration_section">46.4</span> Processes to Close a PDB</h2>
<div>
<p>If a PDB is closed with the immediate option, then the coordinator terminates jobs running in the PDB, and the jobs must be recovered before they can run again.</p>
<p>In an Oracle RAC database, the coordinator can, in most cases, recover the jobs on another instance where that PDB is open. So, if the coordinator on the first instance can find another instance where the PDB is still open, it moves the jobs there. In certain cases, moving the jobs to another instance may not be possible. For example, if the PDB in question is not open anywhere else, the jobs cannot be moved. Also, moving a job to another instance is not possible when the job has the <code class="codeph">INSTANCE_ID</code> attribute set. In this case the job cannot run until the PDB on that instance is open again.</p>
<p>In a non-Oracle RAC case, the question of moving jobs does not arise. Terminated jobs can only be recovered after the PDB is opened again.</p>
</div>
</div>
<a id="ADMIN13893"></a>
<div class="props_rev_3"><a id="GUID-FD194174-7E62-4825-A988-EDB944F4D6CF"></a>
<h2 id="ADMIN-GUID-FD194174-7E62-4825-A988-EDB944F4D6CF" class="sect2"><span class="enumeration_section">46.5</span> New and Changed Views</h2>
<div>
<p>With the CDB, changes have been made to existing views and new views have been added.</p>
<p>See <span class="italic">Oracle Database Reference</span> for details.</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">V$</code> and <code class="codeph">GV</code>$ views now have an additional column (<code class="codeph">CON_ID</code>) which identifies a container whose data a given <code class="codeph">CDB_*</code> row represents. In non-CDBs, this column is <code class="codeph">NULL</code>.</p>
</li>
<li>
<p>There are <code class="codeph">CDB_*</code> views corresponding to all Scheduler <code class="codeph">DBA_*</code> views.</p>
<p>In a PDB, these views only show objects visible through a corresponding <code class="codeph">DBA_* view</code>, but all objects can be viewed by the root database. The <code class="codeph">CDB_*</code> view contains all columns found in a given <code class="codeph">DBA_*</code> view and the column (<code class="codeph">CON_ID</code>). In non-CDBs, this column is <code class="codeph">NULL</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1842">
<tr>
<td class="cellalignment1854">
<table class="cellalignment1847">
<tr>
<td class="cellalignment1846"><a href="cdb_dbrm_em.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1846"><a href="GUID-1C1C46B7-4686-43D8-AF22-554FF8C4AFBD.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2001, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1856">
<table class="cellalignment1845">
<tr>
<td class="cellalignment1846"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1846"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1846"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1846"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1846"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1846"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>