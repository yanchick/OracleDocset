<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-179"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Managing%20Clusters"></a><title>Managing Clusters</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="description" content="Using clusters can improve performance and reduce disk space requirements."/>
<meta name="keywords" content="clusters, about, clustered tables, data blocks, shared in clusters, cluster keys, keys, cluster, guidelines for managing, selecting tables, columns for cluster key, estimating space, location, creating, privileges, CREATE CLUSTER statement, creating clusters, index clusters, example, CREATE TABLE statement, CLUSTER clause, indexes, cluster indexes, CREATE INDEX statement, ON CLUSTER clause, altering, extents, allocating cluster extents, deallocating cluster extents, allocating extents, deallocating extents, Real Application Clusters, allocating extents for cluster, ALTER CLUSTER statement, ALLOCATE EXTENT clause, using for index clusters, dropping, DROP CLUSTER statement, dropping cluster, dropping cluster index, INCLUDING TABLES clause, CASCADE CONSTRAINTS clause, DROP TABLE statement, for clustered tables, data dictionary views reference, views, data dictionary, for clusters"/>
<meta name="dcterms.created" content="2017-07-10T12:24:11Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Administrator&rsquo;s Guide"/>
<meta name="dcterms.identifier" content="E41484-15"/>
<meta name="dcterms.isVersionOf" content="ADMIN"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2001, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="indexes.htm" title="Previous" type="text/html"/>
<link rel="Next" href="hash.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41484-15.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-2EB6D65C-3DD8-4C92-A8B4-C05197B6CF2D"></a> <span id="PAGE" style="display:none;">29/59</span> <!-- End Header -->
<a id="ADMIN018"></a>
<h1 id="ADMIN-GUID-2EB6D65C-3DD8-4C92-A8B4-C05197B6CF2D" class="sect1"><span class="enumeration_chapter">22</span> Managing Clusters</h1>
<p>Using clusters can improve performance and reduce disk space requirements.</p>
<a id="ADMIN13069"></a><a id="ADMIN11739"></a>
<div class="props_rev_3"><a id="GUID-36F7D8C6-9D25-4F34-8BA4-B348337FE0D2"></a>
<h2 id="ADMIN-GUID-36F7D8C6-9D25-4F34-8BA4-B348337FE0D2" class="sect2"><span class="enumeration_section">22.1</span> About Clusters</h2>
<div>
<p>A <span class="bold">cluster</span> provides an optional method of storing table data. A cluster is made up of a group of tables that share the same data blocks. The tables are grouped together because they share common columns and are often used together.</p>
<p>For example, the <code class="codeph">emp</code> and <code class="codeph">dept</code> table share the <code class="codeph">deptno</code> column. When you cluster the <code class="codeph">emp</code> and <code class="codeph">dept</code> tables (see <a href="clustrs.htm#GUID-36F7D8C6-9D25-4F34-8BA4-B348337FE0D2__i1006158">Figure 22-1</a>), Oracle Database physically stores all rows for each department from both the <code class="codeph">emp</code> and <code class="codeph">dept</code> tables in the same data blocks.</p>
<p>Because clusters store related rows of different tables together in the same data blocks, properly used clusters offer two primary benefits:</p>
<ul style="list-style-type: disc;">
<li>
<p>Disk I/O is reduced and access time improves for joins of clustered tables.</p>
</li>
<li>
<p>The <span class="bold">cluster key</span> is the column, or group of columns, that the clustered tables have in common. You specify the columns of the cluster key when creating the cluster. You subsequently specify the same columns when creating every table added to the cluster. Each cluster key value is stored only once each in the cluster and the cluster index, no matter how many rows of different tables contain the value.</p>
<p>Therefore, less storage might be required to store related table and index data in a cluster than is necessary in non-clustered table format. For example, in <a href="clustrs.htm#GUID-36F7D8C6-9D25-4F34-8BA4-B348337FE0D2__i1006158">Figure 22-1</a>, notice how each cluster key (each <code class="codeph">deptno</code>) is stored just once for many rows that contain the same value in both the <code class="codeph">emp</code> and <code class="codeph">dept</code> tables.</p>
</li>
</ul>
<p>After creating a cluster, you can create tables in the cluster. However, before any rows can be inserted into the clustered tables, a cluster index must be created. Using clusters does not affect the creation of additional indexes on the clustered tables; they can be created and dropped as usual.</p>
<p>You should not use clusters for tables that are frequently accessed individually.</p>
<div class="figure" id="GUID-36F7D8C6-9D25-4F34-8BA4-B348337FE0D2__i1006158">
<p class="titleinfigure">Figure 22-1 Clustered Table Data</p>
<img width="648" height="643" src="img/GUID-19AA5444-4659-4650-9167-547D4E64985E-default.gif" alt="Description of Figure 22-1 follows" title="Description of Figure 22-1 follows"/><br/>
<a href="img_text/GUID-19AA5444-4659-4650-9167-547D4E64985E-print.htm">Description of &#34;Figure 22-1 Clustered Table Data&#34;</a></div>
<!-- class="figure" -->
<div class="infoboxnotealso" id="GUID-36F7D8C6-9D25-4F34-8BA4-B348337FE0D2__GUID-71A5D21E-4C5A-481C-A5F0-7F929F463B1D">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="hash.htm#GUID-EC3F7A6F-3648-48AA-8737-FFCC6E4964CF" title="Hash clusters can improve the performance of data retrieval.">Managing Hash Clusters</a> for a description of another type of cluster: a hash cluster</p>
</li>
<li>
<p><a href="schema.htm#GUID-1950156D-DECC-4E76-84D9-2C2A3D8D6565" title="Managing space for schema objects involves tasks such as managing tablespace alerts and space allocation, reclaiming unused space, dropping unused object storage, monitoring space usage, and capacity planning.">Managing Space for Schema Objects</a> is recommended reading before attempting tasks described in this chapter</p>
</li>
</ul>
</div>
</div>
</div>
<a id="ADMIN11740"></a>
<div class="props_rev_3"><a id="GUID-A4315FEA-FDFF-4918-9320-FEEF593B34E5"></a>
<h2 id="ADMIN-GUID-A4315FEA-FDFF-4918-9320-FEEF593B34E5" class="sect2"><span class="enumeration_section">22.2</span> Guidelines for Managing Clusters</h2>
<div>
<p>You can follow guidelines for managing clusters.</p>
<div class="infoboxnotealso" id="GUID-A4315FEA-FDFF-4918-9320-FEEF593B34E5__GUID-05646BF3-2F02-4FC5-9452-46D17B747789">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink CNCPT608" target="_blank" href="../CNCPT/tablecls.htm#CNCPT608"><span class="italic">Oracle Database Concepts</span></a> for more information about clusters</p>
</li>
<li>
<p><a class="olink TGSQL850" target="_blank" href="../TGSQL/tgsql_indc.htm#TGSQL850"><span class="italic">Oracle Database SQL Tuning Guide</span></a> for guidelines on when to use clusters</p>
</li>
</ul>
</div>
</div>
<a id="ADMIN11741"></a>
<div class="props_rev_3"><a id="GUID-D2A6AE7C-1E40-4289-B311-D86834FBAA96"></a>
<h3 id="ADMIN-GUID-D2A6AE7C-1E40-4289-B311-D86834FBAA96" class="sect3"><span class="enumeration_section">22.2.1</span> Choose Appropriate Tables for the Cluster</h3>
<div>
<p>Use clusters for tables that are primarily queries and frequently queried together.</p>
<p>Use clusters for tables for which the following conditions are true:</p>
<ul style="list-style-type: disc;">
<li>
<p>The tables are primarily queried--that is, tables that are <span class="italic">not</span> predominantly inserted into or updated.</p>
</li>
<li>
<p>Records from the tables are frequently queried together or joined.</p>
</li>
</ul>
</div>
</div>
<a id="ADMIN11742"></a>
<div class="props_rev_3"><a id="GUID-EBCDEC9B-50C7-45E2-8066-9EA734A7831E"></a>
<h3 id="ADMIN-GUID-EBCDEC9B-50C7-45E2-8066-9EA734A7831E" class="sect3"><span class="enumeration_section">22.2.2</span> Choose Appropriate Columns for the Cluster Key</h3>
<div>
<p>Choose cluster key columns carefully. If multiple columns are used in queries that join the tables, make the cluster key a composite key. In general, the characteristics that indicate a good cluster index are the same as those for any index.</p>
<p>For information about characteristics of a good index, see <span class="q">&#34;<a href="indexes.htm#GUID-1C31FFD6-B826-4F13-9452-7C3B8B28F677" title="You can follow guidelines for managing indexes.">Guidelines for Managing Indexes</a>&#34;</span>.</p>
<p>A good cluster key has enough unique values so that the group of rows corresponding to each key value fills approximately one data block. Having too few rows for each cluster key value can waste space and result in negligible performance gains. Cluster keys that are so specific that only a few rows share a common value can cause wasted space in blocks, unless a small <code class="codeph">SIZE</code> was specified at cluster creation time (see <span class="q">&#34;<a href="clustrs.htm#GUID-2DCFC344-A2F0-4E2B-95F5-BE5C9C919503" title="The CREATE CLUSTER statement has an optional clause, SIZE, which is the estimated number of bytes required by an average cluster key and its associated rows.">Specify the Space Required by an Average Cluster Key and Its Associated Rows</a> &#34;</span>).</p>
<p>Too many rows for each cluster key value can cause extra searching to find rows for that key. Cluster keys on values that are too general (for example, <code class="codeph">male</code> and <code class="codeph">female</code>) result in excessive searching and can result in worse performance than with no clustering.</p>
<p>A cluster index cannot be unique or include a column defined as <code class="codeph">long</code>.</p>
</div>
</div>
<a id="ADMIN11743"></a>
<div class="props_rev_3"><a id="GUID-2DCFC344-A2F0-4E2B-95F5-BE5C9C919503"></a>
<h3 id="ADMIN-GUID-2DCFC344-A2F0-4E2B-95F5-BE5C9C919503" class="sect3"><span class="enumeration_section">22.2.3</span> Specify the Space Required by an Average Cluster Key and Its Associated Rows</h3>
<div>
<p>The <code class="codeph">CREATE CLUSTER</code> statement has an optional clause, <code class="codeph">SIZE</code>, which is the estimated number of bytes required by an average cluster key and its associated rows.</p>
<p>The database uses the <code class="codeph">SIZE</code> parameter when performing the following tasks:</p>
<ul style="list-style-type: disc;">
<li>
<p>Estimating the number of cluster keys (and associated rows) that can fit in a clustered data block</p>
</li>
<li>
<p>Limiting the number of cluster keys placed in a clustered data block. This maximizes the storage efficiency of keys within a cluster.</p>
</li>
</ul>
<p><code class="codeph">SIZE</code> does not limit the space that can be used by a given cluster key. For example, if <code class="codeph">SIZE</code> is set such that two cluster keys can fit in one data block, any amount of the available data block space can still be used by either of the cluster keys.</p>
<p>By default, the database stores only one cluster key and its associated rows in each data block of the cluster data segment. Although block size can vary from one operating system to the next, the rule of one key for each block is maintained as clustered tables are imported to other databases on other systems.</p>
<p>If all the rows for a given cluster key value cannot fit in one block, the blocks are chained together to speed access to all the values with the given key. The cluster index points to the beginning of the chain of blocks, each of which contains the cluster key value and associated rows. If the cluster <code class="codeph">SIZE</code> is such that multiple keys fit in a block, then blocks can belong to multiple chains.</p>
</div>
</div>
<a id="ADMIN11744"></a>
<div class="props_rev_3"><a id="GUID-17AA33EB-351D-4407-A595-921FE9E1D0FA"></a>
<h3 id="ADMIN-GUID-17AA33EB-351D-4407-A595-921FE9E1D0FA" class="sect3"><span class="enumeration_section">22.2.4</span> Specify the Location of Each Cluster and Cluster Index Rows</h3>
<div>
<p>Always specify the <code class="codeph">TABLESPACE</code> clause in a <code class="codeph">CREATE CLUSTER</code>/<code class="codeph">INDEX</code> statement to identify the tablespace to store the new cluster or index.</p>
<p>If you have the proper privileges and tablespace quota, you can create a new cluster and the associated cluster index in any tablespace that is currently online.</p>
<p>The cluster and its cluster index can be created in different tablespaces. In fact, creating a cluster and its index in different tablespaces that are stored on different storage devices allows table data and index data to be retrieved simultaneously with minimal disk contention.</p>
</div>
</div>
<a id="ADMIN11745"></a>
<div class="props_rev_3"><a id="GUID-6902FC1E-13F9-4174-BA1B-2CBB764C8323"></a>
<h3 id="ADMIN-GUID-6902FC1E-13F9-4174-BA1B-2CBB764C8323" class="sect3"><span class="enumeration_section">22.2.5</span> Estimate Cluster Size and Set Storage Parameters</h3>
<div>
<p>Before creating a cluster, estimate the cluster size and set the storage parameters for the data segments of a cluster.</p>
<p>The following are benefits of estimating cluster size before creating the cluster:</p>
<ul style="list-style-type: disc;">
<li>
<p>You can use the combined estimated size of clusters, along with estimates for indexes and redo log files, to determine the amount of disk space that is required to hold an intended database. From these estimates, you can make correct hardware purchases and other decisions.</p>
</li>
<li>
<p>You can use the estimated size of an individual cluster to better manage the disk space that the cluster will use. When a cluster is created, you can set appropriate storage parameters and improve I/O performance of applications that use the cluster.</p>
</li>
</ul>
<p>Set the storage parameters for the data segments of a cluster using the <code class="codeph">STORAGE</code> clause of the <code class="codeph">CREATE</code> <code class="codeph">CLUSTER</code> or <code class="codeph">ALTER</code> <code class="codeph">CLUSTER</code> statement, rather than the individual <code class="codeph">CREATE</code> or <code class="codeph">ALTER</code> statements that put tables into the cluster. Storage parameters specified when creating or altering a clustered table are ignored. The storage parameters set for the cluster override the table storage parameters.</p>
</div>
</div>
</div>
<div class="sect2"><a id="GUID-FA18571F-1EEA-4F25-BC7E-175CD264DC72"></a>
<h2 id="ADMIN-GUID-FA18571F-1EEA-4F25-BC7E-175CD264DC72" class="sect2"><span class="enumeration_section">22.3</span> Creating Clusters and Objects That Use Them</h2>
<p>You create a cluster using the <code class="codeph">CREATE CLUSTER</code> statement. You create clustered table using the <code class="codeph">CREATE TABLE</code> statement with the <code class="codeph">CLUSTER</code> clause. You create a cluster index using the <code class="codeph">CREATE INDEX</code> statement with the <code class="codeph">CLUSTER</code> clause.</p>
<a id="ADMIN11746"></a>
<div class="props_rev_3"><a id="GUID-31B04A43-57F4-4BA6-B7EA-21BB4776B678"></a>
<h3 id="ADMIN-GUID-31B04A43-57F4-4BA6-B7EA-21BB4776B678" class="sect3"><span class="enumeration_section">22.3.1</span> Creating Clusters</h3>
<div>
<p>You create a cluster using the <code class="codeph">CREATE CLUSTER</code> statement.</p>
<div class="section">
<p>To create a cluster in your schema, you must have the <code class="codeph">CREATE CLUSTER</code> system privilege and a quota for the tablespace intended to contain the cluster or the <code class="codeph">UNLIMITED TABLESPACE</code> system privilege.</p>
<p>To create a cluster in another user&#39;s schema you must have the <code class="codeph">CREATE ANY CLUSTER</code> system privilege, and the owner must have a quota for the tablespace intended to contain the cluster or the <code class="codeph">UNLIMITED TABLESPACE</code> system privilege.</p>
<p>The following statement creates a cluster named <code class="codeph">emp_dept</code>, which stores the <code class="codeph">emp</code> and <code class="codeph">dept</code> tables, clustered by the <code class="codeph">deptno</code> column:</p>
<pre dir="ltr">CREATE CLUSTER emp_dept (deptno NUMBER(3))
   SIZE 600
   TABLESPACE users
   STORAGE (INITIAL 200K
      NEXT 300K
      MINEXTENTS 2
      PCTINCREASE 33);
</pre>
<p>If no <code class="codeph">INDEX</code> keyword is specified, as is true in this example, an index cluster is created by default. You can also create a <code class="codeph">HASH</code> cluster, when hash parameters (<code class="codeph">HASHKEYS</code>, <code class="codeph">HASH IS</code>, or <code class="codeph">SINGLE TABLE HASHKEYS</code>) are specified. Hash clusters are described in <a href="hash.htm#GUID-EC3F7A6F-3648-48AA-8737-FFCC6E4964CF" title="Hash clusters can improve the performance of data retrieval.">Managing Hash Clusters</a>.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11747"></a>
<div class="props_rev_3"><a id="GUID-CEB2FA21-C639-4D91-BE3C-8FEA4776D274"></a>
<h3 id="ADMIN-GUID-CEB2FA21-C639-4D91-BE3C-8FEA4776D274" class="sect3"><span class="enumeration_section">22.3.2</span> Creating Clustered Tables</h3>
<div>
<p>You create a table in a cluster using the <code class="codeph">CREATE TABLE</code> statement with the <code class="codeph">CLUSTER</code> clause.</p>
<div class="section">
<p>To create a table in a cluster, you must have either the <code class="codeph">CREATE TABLE</code> or <code class="codeph">CREATE ANY TABLE</code> system privilege. You do not need a tablespace quota or the <code class="codeph">UNLIMITED TABLESPACE</code> system privilege to create a table in a cluster.</p>
<p>For example, the <code class="codeph">emp</code> and <code class="codeph">dept</code> tables can be created in the <code class="codeph">emp_dept</code> cluster using the following statements:</p>
<pre dir="ltr">CREATE TABLE emp (
   empno NUMBER(5) PRIMARY KEY,
   ename VARCHAR2(15) NOT NULL,
   . . .
   deptno NUMBER(3) REFERENCES dept)
   CLUSTER emp_dept (deptno);  

CREATE TABLE dept (
   deptno NUMBER(3) PRIMARY KEY, . . . )
   CLUSTER emp_dept (deptno);
</pre>
<div class="infobox-note" id="GUID-CEB2FA21-C639-4D91-BE3C-8FEA4776D274__GUID-1127334C-3D0B-42CB-91BA-644119D65598">
<p class="notep1">Note:</p>
<p>You can specify the schema for a clustered table in the <code class="codeph">CREATE TABLE</code> statement. A clustered table can be in a different schema than the schema containing the cluster. Also, the names of the columns are not required to match, but their structure must match.</p>
</div>
<div class="infoboxnotealso" id="GUID-CEB2FA21-C639-4D91-BE3C-8FEA4776D274__GUID-EB6A4F61-4563-4F73-9156-560E4C559AEE">
<p class="notep1">See Also:</p>
<p><a class="olink SQLRF01402" target="_blank" href="../SQLRF/statements_7002.htm#SQLRF01402"><span class="italic">Oracle Database SQL Language Reference</span></a> for syntax of the <code class="codeph">CREATE TABLE</code> statement for creating cluster tables</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11748"></a>
<div class="props_rev_3"><a id="GUID-6997F7D6-3236-41A8-A93C-3F0DBF1B214B"></a>
<h3 id="ADMIN-GUID-6997F7D6-3236-41A8-A93C-3F0DBF1B214B" class="sect3"><span class="enumeration_section">22.3.3</span> Creating Cluster Indexes</h3>
<div>
<p>A cluster index must be created before any rows can be inserted into any clustered table.</p>
<div class="section">
<p>To create a cluster index, one of the following conditions must be true:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Your schema contains the cluster.</p>
</li>
<li>
<p>You have the <code class="codeph">CREATE ANY INDEX</code> system privilege.</p>
</li>
</ul>
<p>In either case, you must also have either a quota for the tablespace intended to contain the cluster index, or the <code class="codeph">UNLIMITED TABLESPACE</code> system privilege.</p>
<p>The following statement creates a cluster index for the <code class="codeph">emp_dept</code> cluster:</p>
<pre dir="ltr">CREATE INDEX emp_dept_index
   ON CLUSTER emp_dept
   TABLESPACE users
   STORAGE (INITIAL 50K
      NEXT 50K
      MINEXTENTS 2
      MAXEXTENTS 10
      PCTINCREASE 33);
</pre>
<p>The cluster index clause (<code class="codeph">ON CLUSTER</code>) identifies the cluster, <code class="codeph">emp_dept</code>, for which the cluster index is being created. The statement also explicitly specifies several storage settings for the cluster and cluster index.</p>
<div class="infoboxnotealso" id="GUID-6997F7D6-3236-41A8-A93C-3F0DBF1B214B__GUID-53ED3C4A-28FA-4F92-89F0-E5987B434A5C">
<p class="notep1">See Also:</p>
<p><a class="olink SQLRF01209" target="_blank" href="../SQLRF/statements_5013.htm#SQLRF01209"><span class="italic">Oracle Database SQL Language Reference</span></a> for syntax of the <code class="codeph">CREATE INDEX</code> statement for creating cluster indexes</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<div class="sect2"><a id="GUID-92A797C1-221D-4FD5-899B-B9E5E98093CB"></a>
<h2 id="ADMIN-GUID-92A797C1-221D-4FD5-899B-B9E5E98093CB" class="sect2"><span class="enumeration_section">22.4</span> Altering Clusters and Objects That Use Them</h2>
<p>You can alter a cluster to change its physical attributes, size, and default degree of parallelism.</p>
<a id="ADMIN11749"></a>
<div class="props_rev_3"><a id="GUID-5EF6F303-F1AD-444F-9ADD-7436CB182AAB"></a>
<h3 id="ADMIN-GUID-5EF6F303-F1AD-444F-9ADD-7436CB182AAB" class="sect3"><span class="enumeration_section">22.4.1</span> Altering Clusters</h3>
<div>
<p>You alter a cluster using the <code class="codeph">ALTER CLUSTER</code> statement.</p>
<p>To alter a cluster, your schema must contain the cluster or you must have the <code class="codeph">ALTER ANY CLUSTER</code> system privilege. You can alter an existing cluster to change the following settings:</p>
<ul style="list-style-type: disc;">
<li>
<p>Physical attributes (<code class="codeph">INITRANS</code> and storage characteristics)</p>
</li>
<li>
<p>The average amount of space required to store all the rows for a cluster key value (<code class="codeph">SIZE</code>)</p>
</li>
<li>
<p>The default degree of parallelism</p>
</li>
</ul>
<p>Additionally, you can explicitly allocate a new extent for the cluster, or deallocate any unused extents at the end of the cluster. The database dynamically allocates additional extents for the data segment of a cluster as required. In some circumstances, however, you might want to explicitly allocate an additional extent for a cluster. For example, when using Real Application Clusters, you can allocate an extent of a cluster explicitly for a specific instance. You allocate a new extent for a cluster using the <code class="codeph">ALTER CLUSTER</code> statement with the <code class="codeph">ALLOCATE EXTENT</code> clause.</p>
<p>When you alter the cluster size parameter (<code class="codeph">SIZE</code>) of a cluster, the new settings apply to all data blocks used by the cluster, including blocks already allocated and blocks subsequently allocated for the cluster. Blocks already allocated for the table are reorganized when necessary (not immediately).</p>
<p>When you alter the transaction entry setting <code class="codeph">INITRANS</code> of a cluster, the new setting for <code class="codeph">INITRANS</code> applies only to data blocks subsequently allocated for the cluster.</p>
<p>The storage parameters <code class="codeph">INITIAL</code> and <code class="codeph">MINEXTENTS</code> cannot be altered. All new settings for the other storage parameters affect only extents subsequently allocated for the cluster.</p>
<p>To alter a cluster, use the <code class="codeph">ALTER CLUSTER</code> statement.</p>
<div class="infoboxnotealso" id="GUID-5EF6F303-F1AD-444F-9ADD-7436CB182AAB__GUID-0DD001E3-BB03-400F-87C8-8AA4835D2853">
<p class="notep1">See Also:</p>
<p><a class="olink SQLRF008" target="_blank" href="../SQLRF/statements_1.htm#SQLRF008"><span class="italic">Oracle Database SQL Language Reference</span></a> for syntax of the <code class="codeph">ALTER CLUSTER</code> statement</p>
</div>
</div>
</div>
<a id="ADMIN11750"></a>
<div class="props_rev_3"><a id="GUID-1F678551-83AB-4B7D-AAFB-CD82118D05CE"></a>
<h3 id="ADMIN-GUID-1F678551-83AB-4B7D-AAFB-CD82118D05CE" class="sect3"><span class="enumeration_section">22.4.2</span> Altering Clustered Tables</h3>
<div>
<p>You can alter clustered tables using the <code class="codeph">ALTER TABLE</code> statement, but some parameters of a clustered table cannot be set with the <code class="codeph">ALTER TABLE</code> statement.</p>
<div class="section">
<p>However, any data block space parameters, transaction entry parameters, or storage parameters you set in an <code class="codeph">ALTER TABLE</code> statement for a clustered table generate an error message (<code class="codeph">ORA-01771, illegal option for a clustered table</code>). The database uses the parameters of the cluster for all clustered tables. Therefore, you can use the <code class="codeph">ALTER TABLE</code> statement only to add or modify columns, drop non-cluster-key columns, or add, drop, enable, or disable integrity constraints or triggers for a clustered table. For information about altering tables, see <span class="q">&#34;<a href="tables.htm#GUID-D4AE1CF2-08F7-4AB2-9317-0DE20AC70D44" title="You alter a table using the ALTER TABLE statement. To alter a table, the table must be contained in your schema, or you must have either the ALTER object privilege for the table or the ALTER ANY TABLE system privilege.">Altering Tables</a>&#34;</span>.</p>
<div class="infoboxnotealso" id="GUID-1F678551-83AB-4B7D-AAFB-CD82118D05CE__GUID-97EFC9CC-A8B9-43E0-A45C-7F80BBE872F9">
<p class="notep1">See Also:</p>
<p><a class="olink SQLRF01001" target="_blank" href="../SQLRF/statements_3001.htm#SQLRF01001"><span class="italic">Oracle Database SQL Language Reference</span></a> for syntax of the <code class="codeph">ALTER TABLE</code> statement</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11751"></a>
<div class="props_rev_3"><a id="GUID-FC037AA0-AE15-412F-A0F4-AD07BEDB2157"></a>
<h3 id="ADMIN-GUID-FC037AA0-AE15-412F-A0F4-AD07BEDB2157" class="sect3"><span class="enumeration_section">22.4.3</span> Altering Cluster Indexes</h3>
<div>
<p>You alter cluster indexes exactly as you do other indexes.</p>
<div class="section">
<p>See <span class="q">&#34;<a href="indexes.htm#GUID-97B5C03C-3C3B-4A64-9E71-7838E6EC7DB3" title="To alter an index, your schema must contain the index, or you must have the ALTER ANY INDEX system privilege.">Altering Indexes</a>&#34;</span>.</p>
<div class="infobox-note" id="GUID-FC037AA0-AE15-412F-A0F4-AD07BEDB2157__GUID-795513B6-7CD7-4143-81A5-9E7FCECA187A">
<p class="notep1">Note:</p>
<p>When estimating the size of cluster indexes, remember that the index is on each cluster key, not the actual rows. Therefore, each key appears only once in the index.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<div class="sect2"><a id="GUID-4A2386D9-CC3D-4719-A6C6-983F82459220"></a>
<h2 id="ADMIN-GUID-4A2386D9-CC3D-4719-A6C6-983F82459220" class="sect2"><span class="enumeration_section">22.5</span> Dropping Clusters and Objects That Use Them</h2>
<p>You drop a cluster using the <code class="codeph">DROP CLUSTER</code> statement. You drop a clustered table using the <code class="codeph">DROP TABLE</code> statement. You drop a cluster index using the <code class="codeph">DROP INDEX</code> statement.</p>
<div class="sect3"><a id="GUID-3E027CE1-1056-4750-B4DC-29E4CB6D095D"></a>
<h3 id="ADMIN-GUID-3E027CE1-1056-4750-B4DC-29E4CB6D095D" class="sect3"><span class="enumeration_section">22.5.1</span> Dropping Clusters</h3>
<div>
<p>You can drop a cluster using the <code class="codeph">DROP CLUSTER</code> statement.</p>
<div class="section">
<p>A cluster can be dropped if the tables within the cluster are no longer needed. When a cluster is dropped, so are the tables within the cluster and the corresponding cluster index. All extents belonging to both the cluster data segment and the index segment of the cluster index are returned to the containing tablespace and become available for other segments within the tablespace.</p>
<p>To drop a cluster that contains no tables, and its cluster index, use the <code class="codeph">DROP CLUSTER</code> statement. For example, the following statement drops the empty cluster named <code class="codeph">emp_dept</code>:</p>
<pre dir="ltr">DROP CLUSTER emp_dept;
</pre>
<p>If the cluster contains one or more clustered tables and you intend to drop the tables as well, add the <code class="codeph">INCLUDING TABLES</code> clause of the <code class="codeph">DROP CLUSTER</code> statement, as follows:</p>
<pre dir="ltr">DROP CLUSTER emp_dept INCLUDING TABLES;
</pre>
<p>If the <code class="codeph">INCLUDING TABLES</code> clause is not included and the cluster contains tables, an error is returned.</p>
<p>If one or more tables in a cluster contain primary or unique keys that are referenced by <code class="codeph">FOREIGN KEY</code> constraints of tables outside the cluster, the cluster cannot be dropped unless the dependent <code class="codeph">FOREIGN KEY</code> constraints are also dropped. This can be easily done using the <code class="codeph">CASCADE CONSTRAINTS</code> clause of the <code class="codeph">DROP CLUSTER</code> statement, as shown in the following example:</p>
<pre dir="ltr">DROP CLUSTER emp_dept INCLUDING TABLES CASCADE CONSTRAINTS;
</pre>
<p>The database returns an error if you do not use the <code class="codeph">CASCADE CONSTRAINTS</code> clause and constraints exist.</p>
<div class="infoboxnotealso" id="GUID-3E027CE1-1056-4750-B4DC-29E4CB6D095D__GUID-BCBA36C1-765E-4585-9B2C-45C66A1C253D">
<p class="notep1">See Also:</p>
<p><a class="olink SQLRF01511" target="_blank" href="../SQLRF/statements_8008.htm#SQLRF01511"><span class="italic">Oracle Database SQL Language Reference</span></a> for syntax of the <code class="codeph">DROP CLUSTER</code> statement</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11753"></a>
<div class="props_rev_3"><a id="GUID-54CB6B06-400F-436F-9206-08A6F44B837D"></a>
<h3 id="ADMIN-GUID-54CB6B06-400F-436F-9206-08A6F44B837D" class="sect3"><span class="enumeration_section">22.5.2</span> Dropping Clustered Tables</h3>
<div>
<p>Clustered tables can be dropped individually without affecting the cluster, other clustered tables, or the cluster index. A clustered table is dropped just as a nonclustered table is dropped, with the <code class="codeph">DROP TABLE</code> statement.</p>
<div class="section">
<p>To drop a cluster, your schema must contain the cluster or you must have the <code class="codeph">DROP ANY CLUSTER</code> system privilege. You do not need additional privileges to drop a cluster that contains tables, even if the clustered tables are not owned by the owner of the cluster.</p>
<p>See <span class="q">&#34;<a href="tables.htm#GUID-29CA8FDC-55FB-4BEF-AE4A-5D1B4D2BE1E1" title="You can drop columns that are no longer needed from a table, including an index-organized table. This provides a convenient means to free space in a database, and avoids your having to export/import data then re-create indexes and constraints.">Dropping Table Columns</a> &#34;</span>.</p>
<div class="infobox-note" id="GUID-54CB6B06-400F-436F-9206-08A6F44B837D__GUID-07B71AAD-F375-4AA6-A236-2BC976725AF7">
<p class="notep1">Note:</p>
<p>When you drop a single table from a cluster, the database deletes each row of the table individually. To maximize efficiency when you intend to drop an entire cluster, drop the cluster including all tables by using the <code class="codeph">DROP CLUSTER</code> statement with the <code class="codeph">INCLUDING TABLES</code> clause. Drop an individual table from a cluster (using the <code class="codeph">DROP TABLE</code> statement) only if you want the rest of the cluster to remain.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMIN11754"></a>
<div class="props_rev_3"><a id="GUID-87498A29-644B-4EBF-AA62-3B90AC0574D1"></a>
<h3 id="ADMIN-GUID-87498A29-644B-4EBF-AA62-3B90AC0574D1" class="sect3"><span class="enumeration_section">22.5.3</span> Dropping Cluster Indexes</h3>
<div>
<p>A cluster index can be dropped without affecting the cluster or its clustered tables. However, clustered tables cannot be used if there is no cluster index; you must re-create the cluster index to allow access to the cluster.</p>
<div class="section">
<p>Cluster indexes are sometimes dropped as part of the procedure to rebuild a fragmented cluster index.</p>
<div class="infobox-note" id="GUID-87498A29-644B-4EBF-AA62-3B90AC0574D1__GUID-AC334748-3315-43AF-9C59-2EA26324636E">
<p class="notep1">Note:</p>
<p>Hash cluster indexes cannot be dropped.</p>
</div>
<div class="infoboxnotealso" id="GUID-87498A29-644B-4EBF-AA62-3B90AC0574D1__GUID-698FE1EC-FABB-4312-891A-F3F7FBB474B6">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="indexes.htm#GUID-670ACFFA-9002-4511-9345-C33C49811577" title="You can drop an index with the DROP INDEX statement.">Dropping Indexes</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="ADMIN11755"></a>
<div class="props_rev_3"><a id="GUID-F22DDA24-D0FA-4E50-96B3-BABD6626E1AE"></a>
<h2 id="ADMIN-GUID-F22DDA24-D0FA-4E50-96B3-BABD6626E1AE" class="sect2"><span class="enumeration_section">22.6</span> Clusters Data Dictionary Views</h2>
<div>
<p>You can query a set of data dictionary views for information about clusters.</p>
<div class="section">
<p>The following views display information about clusters:</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-F22DDA24-D0FA-4E50-96B3-BABD6626E1AE__GUID-78FCEBF1-B005-4006-82FD-6D74939DD025">
<table class="cellalignment1849" summary="Column 1 lists the names of views used to display information about clusters, column 2 describes each view.">
<thead>
<tr class="cellalignment1843">
<th class="cellalignment1949" id="d177772e2126">View</th>
<th class="cellalignment1950" id="d177772e2129">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1843">
<td class="cellalignment1951" id="d177772e2134" headers="d177772e2126">
<p><code class="codeph">DBA_CLUSTERS</code></p>
<p><code class="codeph">ALL_CLUSTERS</code></p>
<p><code class="codeph">USER_CLUSTERS</code></p>
</td>
<td class="cellalignment1952" headers="d177772e2134 d177772e2129">
<p><code class="codeph">DBA</code> view describes all clusters in the database. <code class="codeph">ALL</code> view describes all clusters accessible to the user. <code class="codeph">USER</code> view is restricted to clusters owned by the user. Some columns in these views contain statistics that are generated by the <code class="codeph">DBMS_STATS</code> package or <code class="codeph">ANALYZE</code> statement.</p>
</td>
</tr>
<tr class="cellalignment1843">
<td class="cellalignment1951" id="d177772e2165" headers="d177772e2126">
<p><code class="codeph">DBA_CLU_COLUMNS</code></p>
<p><code class="codeph">USER_CLU_COLUMNS</code></p>
</td>
<td class="cellalignment1952" headers="d177772e2165 d177772e2129">
<p>These views map table columns to cluster columns</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-F22DDA24-D0FA-4E50-96B3-BABD6626E1AE__GUID-A9E9D49A-BE79-483F-83F2-F8976D1F0488">
<p class="notep1">See Also:</p>
<p><a class="olink REFRN" target="_blank" href="../REFRN/toc.htm"><span class="italic">Oracle Database Reference</span></a> for complete descriptions of these views</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1842">
<tr>
<td class="cellalignment1854">
<table class="cellalignment1847">
<tr>
<td class="cellalignment1846"><a href="indexes.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1846"><a href="hash.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2001, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1856">
<table class="cellalignment1845">
<tr>
<td class="cellalignment1846"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1846"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1846"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1846"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1846"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1846"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>