<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-45873"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Raster%20Algebra%20and%20Analytics"></a><title>Raster Algebra and Analytics</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="raster algebra language, conditional queries, cell value-based, cell value-based conditional queries, cell-value based conditional updates, mathematical operations, classification operations, on-the-fly statistical analysis, statistical analysis, on-the-fly, raster data, scaling, scaling, raster data, offsetting, offsetting, casting, casting, cartographic modeling, modeling, cartographic"/>
<meta name="dcterms.created" content="2017-03-13T13:19:47Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Spatial and Graph GeoRaster Developer&#39;s Guide"/>
<meta name="dcterms.identifier" content="E49118-05"/>
<meta name="dcterms.isVersionOf" content="GEORS"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="basic-georaster-operations.htm" title="Previous" type="text/html"/>
<link rel="Next" href="geor_image_proc.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E49118-05.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-C75744C9-FA04-4391-96F2-59EF2EA212FF"></a> <span id="PAGE" style="display:none;">10/18</span> <!-- End Header -->
<a id="GEORS1215"></a>
<h1 id="GEORS-GUID-C75744C9-FA04-4391-96F2-59EF2EA212FF" class="sect1"><span class="enumeration_chapter">4</span> Raster Algebra and Analytics</h1>
<div>
<p>This chapter describes the raster algebra language (PL/SQL and algebraic expressions) and related raster operations, including conditional queries, cell value-based updates or edits, mathematical operations, classify, on-the-fly statistical analysis, and their applications in cartographic modeling.</p>
<p>This chapter contains the following major sections:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="geor_raster_algebra.htm#GUID-A6F087DC-1E7E-4426-B778-8554A25B3494">Raster Algebra Language</a></p>
</li>
<li>
<p><a href="geor_raster_algebra.htm#GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9">Cell Value-Based Conditional Queries</a></p>
</li>
<li>
<p><a href="geor_raster_algebra.htm#GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F">Cell Value-Based Conditional Updates (Edits)</a></p>
</li>
<li>
<p><a href="geor_raster_algebra.htm#GUID-C6250398-2364-4FEE-B06E-644B5F1251AB">Mathematical Operations</a></p>
</li>
<li>
<p><a href="geor_raster_algebra.htm#GUID-57DE5ACD-7DE9-4871-9DF0-CC685DF5114E">Classification Operations</a></p>
</li>
<li>
<p><a href="geor_raster_algebra.htm#GUID-9FF22F4B-19E8-45B2-9811-8ABA00268613">On-the-Fly Statistical Analysis</a></p>
</li>
<li>
<p><a href="geor_raster_algebra.htm#GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B">Raster Data Scaling and Offsetting</a></p>
</li>
<li>
<p><a href="geor_raster_algebra.htm#GUID-13B8293B-2AE1-4687-B98A-9463EF42AC27">Raster Data Casting</a></p>
</li>
<li>
<p><a href="geor_raster_algebra.htm#GUID-F2EBC84A-8BB8-484B-9F32-FC88D4E5F166">Cartographic Modeling</a></p>
</li>
</ul>
</div>
<a id="GEORS1216"></a>
<div class="props_rev_3"><a id="GUID-A6F087DC-1E7E-4426-B778-8554A25B3494"></a>
<h2 id="GEORS-GUID-A6F087DC-1E7E-4426-B778-8554A25B3494" class="sect2"><span class="enumeration_section">4.1</span> Raster Algebra Language</h2>
<div>
<p>Raster algebra is commonly used in raster data analysis and GIS modeling. In GeoRaster, raster algebra is supported by the GeoRaster raster algebra language.</p>
<p>The GeoRaster raster algebra language is an extension to the Oracle PL/SQL language. PL/SQL provides declarations of variables and constants, general mathematical expressions, basic functions, statements, and programming capabilities. GeoRaster provides a raster algebra expression language and a set of raster algebra functions for raster layer operations. The raster algebra expression language includes general arithmetic, casting, logical, and relational operators and allows any combination of them. The raster algebra functions enable the usage of the expressions and support cell value-based conditional queries, mathematical modeling, classify operations, and cell value-based updates or edits over one or many raster layers from one or many GeoRaster objects.</p>
<p>This combination of the PL/SQL language and GeoRaster algebraic expressions and functions provides an easy-to-use, powerful way to define raster analyses as algebraic expressions, so that users can easily apply algebraic functions on raster data to derive new results. For example, a simple raster operation can use two or more raster layers with the same dimension sizes to produce a new raster layer by using algebraic operations (addition, subtraction, and so on), or a sophisticated raster operation to generate a Normalized Difference Vegetation Index (NDVI) from multiple bands of satellite imagery.</p>
<p>GeoRaster supports raster algebra local operations, so the raster algebra operations work on individual raster cells, or pixels.</p>
<p>The following is the GeoRaster raster algebra expression language definition:</p>
<pre dir="ltr">arithmeticExpr:
                unaryArithmeticExpr
              | binaryArithmeticExpr
              | functionArithmeticExpr
              | booleanExpr
              | castingExpr
              | constantNumber
              | identifier
              | (arithmeticExpr)
booleanExpr:
                unaryBooleanExpr
              | binaryBooleanExpr
              | arithmeticExpr comparisonOp arithmeticExpr
              | (booleanExpr)
unaryArithmeticExpr:
                (arithmeticUnaryOp arithmeticExpr)
binaryArithmeticExpr:
                arithmeticExpr  arithmeticBinaryOp arithmeticExpr
functionArithmeticExpr:
                numericFunction (arithmeticExpr)
 
castingExpr:
              rangeType(arithmeticExpr)
unaryBooleanExpr:
                booleanUnaryOp booleanExpr
binaryBooleanExpr:
                booleanExpr booleanBinaryOp booleanExpr
arithmeticBinaryOp:
                +
              | -
              | *
              | /
comparisonOp:
                 =
              |  &lt;
              |  &gt;
              | &gt;=
              | &lt;=
              | !=
arithmeticUnaryOp:
                +
              | -
booleanBinaryOp:
                &amp;
              | |
booleanUnaryOp:
                !
rangeType:
               castint
              | castonebit
              | casttwobit
              | castfourbit
              | casteightbit
numericFunction:
                abs
              | sqrt
              | exp
              | log
              | ln
              | sin
              | cos
              | tan
              | sinh
              | cosh
              | tanh
              | arcsin
              | arccos
              | arctan
              | ceil
              | floor
constantNumber:
              double number
identifier:
             {ID,band}
              | {band}
ID:
             integer number
band:
             integer number
</pre>
<p>The precedence of the algebraic operators (+, -, *, /, and so on) in the expression language complies with general conventions. However, in any case where the expression might be misinterpreted, you should use parentheses to clarify which interpretation is intended.</p>
<p>The <code class="codeph">booleanExpr</code> can be used as <code class="codeph">arithmeticExpr</code>, as defined in the GeoRaster raster algebra expression language. In this case, the <code class="codeph">TRUE</code> and <code class="codeph">FALSE</code> evaluation results of <code class="codeph">booleanExpr</code> are cast to numeric values 1 and 0, respectively.</p>
<p>The <code class="codeph">identifier</code> in the expression refers to a raster layer of a GeoRaster object. It is either a single <code class="codeph">band</code> number if there is only one GeoRaster object involved, or a pair of (<code class="codeph">ID</code>, <code class="codeph">band</code>) where <code class="codeph">ID</code> refers to one of GeoRaster objects in the expression and band refers to a specific layer of that GeoRaster object. The <code class="codeph">band</code> number in this language refers to the ordinate number of a layer along the band dimension in the cell space, so it always starts with zero.</p>
<p>The following procedures provide the main support for raster algebra operations:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="geor_ra_ref.htm#GUID-BB7A762E-E615-43AD-9D74-5E917D29F333">SDO_GEOR_RA.rasterMathOp</a> takes <code class="codeph">arithmeticExpr</code> and performs mathematical operations or modeling.</p>
</li>
<li>
<p><a href="geor_ra_ref.htm#GUID-67FDA0FA-D055-4821-964F-600660861A72">SDO_GEOR_RA.findCells</a> searches/masks cells based on a <code class="codeph">booleanExpr</code> condition.</p>
</li>
<li>
<p><a href="geor_ra_ref.htm#GUID-D9DA6608-7D97-4428-B1B2-002C371846E9">SDO_GEOR_RA.classify</a> applies <code class="codeph">arithmeticExpr</code> to cells and then segments the raster.</p>
</li>
<li>
<p><a href="geor_ra_ref.htm#GUID-7F1A50AC-9595-4AC3-83E3-D7233C9FAF2E">SDO_GEOR_RA.rasterUpdate</a> updates cell values of a raster based on different <code class="codeph">booleanExpr</code> conditions.</p>
</li>
</ul>
<p>These raster algebra functions take many layers from one or many GeoRaster objects, apply <code class="codeph">booleanExpr</code> and/or <code class="codeph">arithmeticExpr</code> expressions over those layers, do the specific algebraic computation or modeling, and output a new GeoRaster object. The expressions can be defined in any way based on the syntax described earlier in this section.</p>
<p>All raster algebra functions require that the raster layers overlap each other and have the same dimension sizes and resolution if they are georeferenced, or have the same dimension sizes if they are not georeferenced. Before you apply raster algebra operations over two or more GeoRaster objects, you can use the <a href="geor_ra_ref.htm#GUID-B64A8557-B92D-4588-812D-2F767338EA68">SDO_GEOR_RA.isOverlap</a> function to determine if the GeoRaster objects are of the same size and cover the same ground area.</p>
<p>Raster and image databases are generally very large. Querying and manipulating such databases are computationally intensive operations. To improve performance, all GeoRaster raster algebra functions are parallelized. You should always consider applying parallel processing when using multi-CPU or multicore servers.</p>
</div>
<a id="GEORS1248"></a><a id="GEORS1249"></a><a id="GEORS1250"></a><a id="GEORS1247"></a>
<div class="props_rev_3"><a id="GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE"></a>
<h3 id="GEORS-GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE" class="sect3"><span class="enumeration_section">4.1.1</span> Examples of Raster Algebra Expressions</h3>
<div>
<p>This section contains examples showing how to define raster algebra expressions.</p>
<div class="example" id="GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE__BABCFFDB">
<p class="titleinexample">Example 4-1 Finding Pixels Based on a Comparison (&gt;)</p>
<p><a href="geor_raster_algebra.htm#GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE__BABCFFDB">Example 4-1</a> finds all pixels that meet the condition defined by algebra expression <code class="codeph">&#39;{1}&gt;200&#39;</code> , because there is only one GeoRaster object involved in the procedure, so <code class="codeph">{1}</code> refers to the cell value of second layer (<code class="codeph">{0}</code> would be for the first layer), and <code class="codeph">&#39;{1}&gt;200&#39;</code> means any pixels whose second layer value is greater than 200. The example assumes that the source GeoRaster object has at least two layers.</p>
<pre dir="ltr">DECLARE 
  geor       MDSYS.SDO_GEORASTER;
  geor1      MDSYS.SDO_GEORASTER;
BEGIN
  select georaster into geor from georaster_table where georid = 1;
  select georaster into geor1 from georaster_table where georid = 5 for update;
  sdo_geor_ra.findcells(geor, &#39;{1}&gt;200&#39;,&#39;blocking=true, blocksize=(256,256,3)&#39;,geor1);
  update georaster_table set georaster = geor1 where georid = 5;
  commit;
END;
/
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE__BABHIBDJ">
<p class="titleinexample">Example 4-2 Generating a GeoRaster Object Based on an Expressions Array</p>
<p><a href="geor_raster_algebra.htm#GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE__BABHIBDJ">Example 4-2</a> generates a new GeoRaster object <code class="codeph">geor2</code> from two input GeoRaster objects <code class="codeph">geor</code> and <code class="codeph">geor1</code> based on the algebra expressions array <code class="codeph">SDO_STRING2_ARRAY(&#39;{0,0}-0.5*{1,0}&#39;,&#39;{0,1}-0.5*{1,1}&#39;,&#39;{0,2}-0.5*{1,2}&#39;)</code>. The example assumes that both of the source GeoRaster objects are images with three bands.</p>
<pre dir="ltr">DECLARE
  geor       MDSYS.SDO_GEORASTER;
  geor1      MDSYS.SDO_GEORASTER;
  geor2      MDSYS.SDO_GEORASTER;
  geo_array  MDSYS.SDO_GEORASTER_ARRAY;
BEGIN
  select georaster into geor from georaster_table where georid = 1;
  select georaster into geor1 from georaster_table where georid = 2;
  insert into georaster_table values (17, sdo_geor.init(&#39;rdt_1&#39;, 17)) returning georaster into geor2;
  geo_array:=MDSYS.SDO_GEORASTER_ARRAY(geor,geor1);
  sdo_geor_ra.rasterMathOp(geo_array,<span class="bold">SDO_STRING2_ARRAY(&#39;{0,0}-0.5*{1,0}&#39;,&#39;{0,1}-0.5*{1,1}&#39;,&#39;{0,2}-0.5*{1,2}&#39;)</span>,null,geor2);
  update georaster_table set georaster = geor2 where georid = 17;
  commit;
END;
/
</pre>
<p>In the algebra expressions array in <a href="geor_raster_algebra.htm#GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE__BABHIBDJ">Example 4-2</a>:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">{0,0}</code> refers to the cell value of band 0 of the first input GeoRaster object <code class="codeph">geor</code>.</p>
</li>
<li>
<p><code class="codeph">{0,1}</code> refers to the cell value of band 1 of the first input GeoRaster object <code class="codeph">geor</code>.</p>
</li>
<li>
<p><code class="codeph">{0,2}</code> refers to the cell value of band 2 of the first input GeoRaster object <code class="codeph">geor</code>.</p>
</li>
<li>
<p><code class="codeph">{1,0}</code> refers to the cell value of band 0 of the second input GeoRaster object <code class="codeph">geor1</code>.</p>
</li>
<li>
<p><code class="codeph">{1,1}</code> refers to the cell value of band 1 of the second input GeoRaster object <code class="codeph">geor1</code>.</p>
</li>
<li>
<p><code class="codeph">{1,2}</code> refers to the cell value of band 2 of the second input GeoRaster object <code class="codeph">geor1</code>.</p>
</li>
</ul>
<p>In <a href="geor_raster_algebra.htm#GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE__BABHIBDJ">Example 4-2</a>, then, the target GeoRaster object <code class="codeph">geor2</code> will have three bands, and:</p>
<ul style="list-style-type: disc;">
<li>
<p>The cell value of band 0 of target GeoRaster object <code class="codeph">geor2</code> is: <code class="codeph">{0,0}-0.5*{1,0}</code></p>
</li>
<li>
<p>The cell value of band 1 of target GeoRaster object <code class="codeph">geor2</code> is: <code class="codeph">{0,1}-0.5*{1,1}</code></p>
</li>
<li>
<p>The cell value of band 2 of target GeoRaster object <code class="codeph">geor2</code> is: <code class="codeph">{0,2}-0.5*{1,2}</code></p>
</li>
</ul>
</div>
<!-- class="example" -->
<div class="example" id="GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE__BABEFCFH">
<p class="titleinexample">Example 4-3 Updating a GeoRaster Object Based on an Expressions Array</p>
<p><a href="geor_raster_algebra.htm#GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE__BABEFCFH">Example 4-3</a> updates cell values of the input GeoRaster object based on the algebra expression array <code class="codeph">SDO_STRING2_ARRAY(&#39;(abs({0}-{1})=48)&amp;({2}-{1}=-101)&#39;,&#39;2*{0}-{1}/3=108&#39;)</code>. The example assumes that the source GeoRaster object has three layers.</p>
<pre dir="ltr">DECLARE
  geor       MDSYS.SDO_GEORASTER;
  geor1      MDSYS.SDO_GEORASTER;
begin
  select georaster into geor from georaster_table where georid = 1;
  sdo_geor_ra.rasterUpdate(geor,0,<span class="bold">SDO_STRING2_ARRAY(&#39;(abs({0}-{1})=48)&amp;({2}-{1}=-101)&#39;,&#39;2*{0}-{1}/3=108&#39;),SDO_STRING2_ARRAYSET(SDO_STRING2_ARRAY(&#39;123&#39;,&#39;54&#39;,&#39;89&#39;),SDO_STRING2_ARRAY(&#39;98&#39;,&#39;56&#39;,&#39;123&#39;))</span>);
END;
/
</pre>
<p>In <a href="geor_raster_algebra.htm#GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE__BABEFCFH">Example 4-3</a>, for each pixel:</p>
<ul style="list-style-type: disc;">
<li>
<p>If <code class="codeph">(abs({0}-{1})=48)&amp;({2}-{1}=-101)</code> is true, then the cell values of the three layers will be updated to <code class="codeph">(&#39;123&#39;,&#39;54&#39;,&#39;89&#39;)</code>.</p>
</li>
<li>
<p>If <code class="codeph">2*{0}-{1}/3=108</code> is true, then the cell values of the three layers will be updated to <code class="codeph">(&#39;98&#39;,&#39;56&#39;,&#39;123&#39;)</code>.</p>
</li>
</ul>
</div>
<!-- class="example" --></div>
</div>
</div>
<a id="GEORS1252"></a><a id="GEORS1253"></a><a id="GEORS1254"></a><a id="GEORS1251"></a>
<div class="props_rev_3"><a id="GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9"></a>
<h2 id="GEORS-GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9" class="sect2"><span class="enumeration_section">4.2</span> Cell Value-Based Conditional Queries</h2>
<div>
<p>In addition to their use in space-based queries on rasters (such as with <a href="geor_ref.htm#GUID-CC66F0CA-96A9-4C4F-AB94-AEB5FE53C83D">SDO_GEOR.getRasterSubset</a>), cell value-based queries are particularly useful in analytics and application modeling. To perform cell value based conditional queries and generate a new GeoRaster object based on the specified condition, you can use the <a href="geor_ra_ref.htm#GUID-67FDA0FA-D055-4821-964F-600660861A72">SDO_GEOR_RA.findCells</a> procedure and specify an appropriate <code class="codeph">condition</code> parameter.</p>
<p>The <code class="codeph">condition</code> parameter must specify a valid <code class="codeph">booleanExpr</code> value (explained in <a href="geor_raster_algebra.htm#GUID-A6F087DC-1E7E-4426-B778-8554A25B3494">Raster Algebra Language</a>). The procedure computes the <code class="codeph">booleanExpr</code> against each cell in the source GeoRaster object. If the result is <code class="codeph">TRUE</code>, the original cell values are kept in the output GeoRaster object; if the result is <code class="codeph">FALSE</code>, the <code class="codeph">bgValues</code> are used to fill cell values in the output GeoRaster object. This can also be considered as a masking operation.</p>
<div class="example" id="GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9__BABDGJGJ">
<p class="titleinexample">Example 4-4 Conditional Query</p>
<p><a href="geor_raster_algebra.htm#GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9__BABDGJGJ">Example 4-4</a> calls the <a href="geor_ra_ref.htm#GUID-67FDA0FA-D055-4821-964F-600660861A72">SDO_GEOR_RA.findCells</a> procedure to find all pixels where the value of the second band is greater than 200. Because the bgValues parameter is not specified, the value 0 is used as the background value to fill all pixels that make the condition false. The example assumes that the source GeoRaster object is an image with more than two bands.</p>
<pre dir="ltr">DECLARE
  geor   SDO_GEORASTER;
  geor1  SDO_GEORASTER;
BEGIN
  SELECT georaster INTO geor FROM georaster_table WHERE georid = 1;
  INSERT into georaster_table values (5, sdo_geor.init(&#39;rdt_1&#39;, 5)) returning georaster into geor1;
  <span class="bold">sdo_geor_ra.findcells(geor, &#39;{ 1 }&gt;200&#39;,</span> &#39;blocking=true, blocksize=(256,256,3)&#39;, geor1);
  UPDATE georaster_table set georaster = geor1 WHERE georid = 5;
  COMMIT;
END;
/
 
<span class="bold">-- This pixel is set to (0,0,0) because the cell value of the</span>
<span class="bold">-- second band is 136, which is not greater than 200.</span>
SELECT sdo_geor.getcellvalue(georaster,0,30,30,&#39;&#39;) FROM georaster_table WHERE georid =1 OR georid=5 ORDER BY georid;
SDO_GEOR.GETCELLVALUE(GEORASTER,0,30,30,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(88, 136, 35)
SDO_NUMBER_ARRAY(0, 0, 0)
 
2 rows selected.
 
<span class="bold">-- This pixel keeps the original values because the cell value</span>
<span class="bold">-- of the second band is greater than 200.</span>
SELECT sdo_geor.getcellvalue(georaster,0,132,116,&#39;&#39;) FROM georaster_table WHERE georid =1 OR georid=5 ORDER BY georid;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,132,116,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(242, 225, 233)
SDO_NUMBER_ARRAY(242, 225, 233)
 
2 rows selected.
 
<span class="bold">-- This pixel keeps the original values because the cell value</span>
<span class="bold">-- of the second band is greater than 200.</span>
SELECT sdo_geor.getcellvalue(georaster,0,261,185,&#39;&#39;) FROM georaster_table WHERE georid =1 OR georid=5 ORDER BY georid;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,261,185,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(255, 214, 2)
SDO_NUMBER_ARRAY(255, 214, 2)
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9__BABEGDCE">
<p class="titleinexample">Example 4-5 Conditional Query with nodata Parameter</p>
<p><a href="geor_raster_algebra.htm#GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9__BABEGDCE">Example 4-5</a> is basically the same as <a href="geor_raster_algebra.htm#GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9__BABDGJGJ">Example 4-4</a>, except that the <code class="codeph">nodata</code> parameter value is set to <code class="codeph">&#39;TRUE&#39;</code>, so that all NODATA pixels keep their original values from the input GeoRaster object in the output GeoRaster object.</p>
<pre dir="ltr">DECLARE
  geor   SDO_GEORASTER;
  geor1  SDO_GEORASTER;
BEGIN
  SELECT georaster INTO geor FROM georaster_table WHERE georid = 1;
  INSERT into georaster_table values (5, sdo_geor.init(&#39;rdt_1&#39;, 5)) returning georaster into geor1;
  <span class="bold">sdo_geor_ra.findcells(geor, &#39;{ 1 }&gt;200&#39;,</span> null, geor1, null, <span class="bold">&#39;TRUE&#39;</span>);
  UPDATE georaster_table set georaster = geor1 WHERE georid = 5;
  COMMIT;
END;
/
 
SELECT sdo_geor.getcellvalue(georaster,0,30,30,&#39;&#39;) FROM georaster_table WHERE georid =1;
SDO_GEOR.GETCELLVALUE(GEORASTER,0,30,30,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(88, 136, 35)
 
1 row selected.
 
<span class="bold">-- This pixel keeps its original cell values because it is nodata, even though</span>
<span class="bold">-- the cell value of the second band is not greater than 200.</span>
SELECT sdo_geor.getcellvalue(georaster,0,30,30,&#39;&#39;) FROM georaster_table WHERE georid=5;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,30,30,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(88, 136, 35)
 
1 row selected.
 
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9__BABEDCHD">
<p class="titleinexample">Example 4-6 Conditional Query with parallelParam</p>
<p><a href="geor_raster_algebra.htm#GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9__BABEDCHD">Example 4-6</a> finds all pixels that meet all of the following conditions:</p>
<ul style="list-style-type: disc;">
<li>
<p>The cell value of the first band is between (100,200).</p>
</li>
<li>
<p>The cell value of the second band is between [50,250].</p>
</li>
<li>
<p>The cell value of the third band is greater than 100.</p>
</li>
</ul>
<p>In addition, because <code class="codeph">parallelParam</code> is specified as <code class="codeph">&#39;parallel=4&#39;</code>, the procedure in <a href="geor_raster_algebra.htm#GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9__BABEDCHD">Example 4-6</a> will run in parallel with four processes.</p>
<pre dir="ltr">DECLARE 
  geor   SDO_GEORASTER;
  geor1  SDO_GEORASTER;
BEGIN
   SELECT georaster INTO geor FROM georaster_table WHERE georid = 2;
   INSERT into georaster_table values (10, sdo_geor.init(&#39;rdt_1&#39;, 10)) returning georaster into geor1;
   <span class="bold">sdo_geor_ra.findcells(geor,&#39;({1}&gt;=50)&amp;({1}&lt;=250)&amp;({0}&gt;100)&amp;({0}&lt;200)&amp;{2}&gt;100) &#39;</span>,null,geor1,null,&#39;false&#39;,<span class="bold">&#39;parallel=4&#39;</span>);
   UPDATE georaster_table SET georaster = geor1 WHERE georid = 10;
   COMMIT;
END;
/
</pre></div>
<!-- class="example" --></div>
</div>
<a id="GEORS1256"></a><a id="GEORS1257"></a><a id="GEORS1255"></a>
<div class="props_rev_3"><a id="GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F"></a>
<h2 id="GEORS-GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F" class="sect2"><span class="enumeration_section">4.3</span> Cell Value-Based Conditional Updates (Edits)</h2>
<div>
<p>This section pertains to cell value-based raster updates and not space-based raster updates, both of which types of update are described in <a href="basic-georaster-operations.htm#GUID-D78B30EA-E592-4D34-94AC-AB2B1435D60E">Querying and Updating GeoRaster Cell Data</a>.</p>
<p>To update raster cell values based on conditions, you can use the <a href="geor_ra_ref.htm#GUID-7F1A50AC-9595-4AC3-83E3-D7233C9FAF2E">SDO_GEOR_RA.rasterUpdate</a> procedure and specify appropriate <code class="codeph">condition</code> and <code class="codeph">vals</code> parameters.</p>
<p>The <code class="codeph">condition</code> parameter specifies an array of Boolean expressions, and the <code class="codeph">vals</code> parameter specifies an array of arrays of math expressions. (See the raster algebra operation explanations in <a href="geor_raster_algebra.htm#GUID-A6F087DC-1E7E-4426-B778-8554A25B3494">Raster Algebra Language</a>). For each cell, if <code class="codeph">condition</code> is <code class="codeph">TRUE</code>, its cell value is updated to the result of the corresponding math expression in the <code class="codeph">vals</code> array.</p>
<div class="example" id="GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F__BABJEABJ">
<p class="titleinexample">Example 4-7 Cell Value-Based Update</p>
<p><a href="geor_raster_algebra.htm#GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F__BABJEABJ">Example 4-7</a> assumes that the GeoRaster object to be updated is an image with three bands, and it calls the <a href="geor_ra_ref.htm#GUID-7F1A50AC-9595-4AC3-83E3-D7233C9FAF2E">SDO_GEOR_RA.rasterUpdate</a> procedure to do the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>For any pixels if abs(first_band_value - second_band_value)=48 and (third_band_value - second_band_value=-101), then the three band values will be updated to (123,54,89), respectively.</p>
</li>
<li>
<p>For any pixels if (2*first_band_value - second_band_value/3)=108, then the three band values will be updated to (98,56,123), respectively.</p>
</li>
</ul>
<p><a href="geor_raster_algebra.htm#GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F__BABJEABJ">Example 4-7</a> also includes several calls to the <a href="geor_ref.htm#GUID-1E61D84B-F431-4532-B16E-E005596D4DAC">SDO_GEOR.getCellValue</a> function to show &#34;before&#34; and &#34;after&#34; values.</p>
<pre dir="ltr">SELECT sdo_geor.getcellvalue(georaster,0,30,30,&#39;&#39;) FROM georaster_table WHERE georid =1;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,30,30,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(88, 136, 35)
 
1 row selected.
 
SELECT sdo_geor.getcellvalue(georaster,0,130,130,&#39;&#39;) FROM georaster_table WHERE georid =1;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,130,130,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(64, 60, 48)
 
1 row selected.

SELECT sdo_geor.getcellvalue(georaster,0,230,230,&#39;&#39;) FROM georaster_table WHERE georid =1;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,230,230,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(11,11, 11)
 
1 row selected.
 
DECLARE
  geor   SDO_GEORASTER;
  geor1  SDO_GEORASTER;
BEGIN

  SELECT georaster into geor FROM georaster_table WHERE georid = 1;
  <span class="bold">sdo_geor_ra.rasterUpdate(geor,0,SDO_STRING2_ARRAY(&#39;(abs({0}-{1})=48)&amp;({2}-{1}=-101)&#39;,&#39;2*{0}-{1}/3=108&#39;),SDO_STRING2_ARRAYSET(SDO_STRING2_ARRAY(&#39;123&#39;,&#39;54&#39;,&#39;89&#39;),SDO_STRING2_ARRAY(&#39;98&#39;,&#39;56&#39;,&#39;123&#39;)));</span>
END;
/
 
PL/SQL procedure successfully completed.
 
show errors;
No errors.
 
<span class="bold">-- This pixel gets updated because it meets the first condition.</span>
SELECT sdo_geor.getcellvalue(georaster,0,30,30,&#39;&#39;) FROM georaster_table WHERE georid =1;

SDO_GEOR.GETCELLVALUE(GEORASTER,0,30,30,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(123, 54, 89)
 
1 row selected.
 
<span class="bold">--This pixel gets updated because it meets the second condition.</span>
SELECT sdo_geor.getcellvalue(georaster,0,130,130,&#39;&#39;) FROM georaster_table WHERE georid=1;

SDO_GEOR.GETCELLVALUE(GEORASTER,0,130,130,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(98, 56, 123)
 
1 row selected.

<span class="bold">-- This pixel keeps its original values because it does not meet any condition</span>
<span class="bold">-- in the &#34;condition&#34; array.</span>
SELECT sdo_geor.getcellvalue(georaster,0,230,230,&#39;&#39;) FROM georaster_table WHERE georid =1;
SDO_GEOR.GETCELLVALUE(GEORASTER,0,230,230,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(11,11, 11)
 
1 row selected.
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F__BABHCBGB">
<p class="titleinexample">Example 4-8 Cell Value-Based Update with nodata Parameter</p>
<p><a href="geor_raster_algebra.htm#GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F__BABHCBGB">Example 4-8</a> is basically the same as <a href="geor_raster_algebra.htm#GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F__BABJEABJ">Example 4-7</a>, except that the <code class="codeph">nodata</code> parameter value is set to <code class="codeph">&#39;TRUE&#39;</code>, so that all NODATA pixels keep their original values from the input GeoRaster object in the output GeoRaster object.</p>
<pre dir="ltr">SELECT sdo_geor.getcellvalue(georaster,0,30,30,&#39;&#39;) FROM georaster_table WHERE georid =1;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,30,30,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(88, 136, 35)
 
1 row selected.
 
SELECT sdo_geor.getcellvalue(georaster,0,130,130,&#39;&#39;) FROM georaster_table WHERE georid =1;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,130,130,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(64, 60, 48)
 
1 row selected.

SELECT sdo_geor.getcellvalue(georaster,0,230,230,&#39;&#39;) FROM georaster_table WHERE georid =1;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,230,230,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(11,11, 11)
 
1 row selected.
 
DECLARE
  geor   SDO_GEORASTER;
  geor1  SDO_GEORASTER;
BEGIN

  SELECT georaster into geor FROM georaster_table WHERE georid = 1;
  <span class="bold">sdo_geor.addNODATA(geor, 1,88);</span>
  <span class="bold">sdo_geor_ra.rasterUpdate</span>(geor,0,SDO_STRING2_ARRAY(&#39;(abs({0}-{1})=48)&amp;({2}-{1}=-101)&#39;,&#39;2*{0}-{1}/3=108&#39;),SDO_STRING2_ARRAYSET(SDO_STRING2_ARRAY(&#39;123&#39;,&#39;54&#39;,&#39;89&#39;),SDO_STRING2_ARRAY(&#39;98&#39;,&#39;56&#39;,&#39;123&#39;)),null,<span class="bold">&#39;true&#39;</span>);
END;
/
 
PL/SQL procedure successfully completed.

<span class="bold">-- This pixel keeps its original values because it is a NODATA pixel.</span>
SELECT sdo_geor.getcellvalue(georaster,0,30,30,&#39;&#39;) FROM georaster_table WHERE georid =1;

SDO_GEOR.GETCELLVALUE(GEORASTER,0,30,30,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(88, 136, 35)
 
1 row selected.
 
--This pixel gets updated because it meets the second condition.
SELECT sdo_geor.getcellvalue(georaster,0,130,130,&#39;&#39;) FROM georaster_table WHERE georid=1;

SDO_GEOR.GETCELLVALUE(GEORASTER,0,130,130,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(98, 56, 123)
 
1 row selected.
</pre></div>
<!-- class="example" --></div>
</div>
<a id="GEORS1259"></a><a id="GEORS1260"></a><a id="GEORS1261"></a><a id="GEORS1258"></a>
<div class="props_rev_3"><a id="GUID-C6250398-2364-4FEE-B06E-644B5F1251AB"></a>
<h2 id="GEORS-GUID-C6250398-2364-4FEE-B06E-644B5F1251AB" class="sect2"><span class="enumeration_section">4.4</span> Mathematical Operations</h2>
<div>
<p>A major use of raster algebra is to apply mathematical models to raster layers from different sources. To apply mathematical operations on one or multiple layers, which could be from one or more GeoRaster objects, to generate a new GeoRaster object, you can use the <a href="geor_ra_ref.htm#GUID-BB7A762E-E615-43AD-9D74-5E917D29F333">SDO_GEOR_RA.rasterMathOp</a> procedure.</p>
<p>For most formats of this procedure, the <code class="codeph">operation</code> parameter specifies an array of <code class="codeph">arithmeticExpr</code> strings used to calculate raster cell values in the output GeoRaster object. Each element of the array corresponds to a layer in the output GeoRaster object.</p>
<p>Note that <code class="codeph">booleanExpr</code> can be also used as <code class="codeph">arithmeticExpr</code>, as is done in <a href="geor_raster_algebra.htm#GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F__BABHCBGB">Example 4-8</a>.</p>
<div class="example" id="GUID-C6250398-2364-4FEE-B06E-644B5F1251AB__BABIEHFB">
<p class="titleinexample">Example 4-9 Mathematical Operations (1)</p>
<p><a href="geor_raster_algebra.htm#GUID-C6250398-2364-4FEE-B06E-644B5F1251AB__BABIEHFB">Example 4-9</a> calls the <a href="geor_ra_ref.htm#GUID-BB7A762E-E615-43AD-9D74-5E917D29F333">SDO_GEOR_RA.rasterMathOp</a> procedure to generate a new 6-layer GeoRaster object from a 3-layer source GeoRaster object, and follows these rules to calculate cell values of the target GeoRaster object:</p>
<ul style="list-style-type: disc;">
<li>
<p>The cell value of the first three layers of target GeoRaster object is equal to the value of the corresponding layer of source GeoRaster object, minus 10.</p>
</li>
<li>
<p>The cell value of the last three layers of target GeoRaster object is equal to the value of the first three layers of the source GeoRaster object, respectively.</p>
</li>
</ul>
<pre dir="ltr">DECLARE
  geor   SDO_GEORASTER;
  geor1  SDO_GEORASTER;
  geor2  SDO_GEORASTER;
BEGIN
  SELECT georaster INTO geor FROM georaster_table WHERE georid = 1;
  INSERT into georaster_table values (16, sdo_geor.init(&#39;rdt_1&#39;, 16)) returning georaster into geor1;
  <span class="bold">sdo_geor_ra.rasterMathOp(geor,SDO_STRING2_ARRAY(&#39;{0,0}-10&#39;,&#39;{0,1}-10&#39;,&#39;{0,2}-10&#39;,&#39;{0,0}&#39;,&#39;{0,1}&#39;,&#39;{0,2}&#39;),null,geor1);</span>
  UPDATE georaster_table SET georaster = geor1 WHERE georid = 16;
  COMMIT;
END;
/
 
PL/SQL procedure successfully completed.
 
SELECT sdo_geor.getcellvalue(georaster,0,100,100,&#39;&#39;) FROM georaster_table WHERE georid=1;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(181, 163, 159)
 
1 row selected.
 
<span class="bold">--  In the results of the next SELECT statement, note:</span>
<span class="bold">--  171=181-10</span>
<span class="bold">--  153=163-10</span>
<span class="bold">--  149=159-10</span>
<span class="bold">--  181=181</span>
<span class="bold">--  163=163</span>
<span class="bold">--  159=159</span>
SELECT sdo_geor.getcellvalue(georaster,0,100,100,&#39;&#39;) FROM georaster_table WHERE georid =16;
SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(171, 153, 149, 181, 163, 159)
 
1 row selected.
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-C6250398-2364-4FEE-B06E-644B5F1251AB__BABBCEJB">
<p class="titleinexample">Example 4-10 Mathematical Operations (2)</p>
<p><a href="geor_raster_algebra.htm#GUID-C6250398-2364-4FEE-B06E-644B5F1251AB__BABBCEJB">Example 4-10</a> applies an operation on a 2-element GeoRaster array (containing two 3-layer source GeoRaster objects) to generate a new 3-layer GeoRaster object.</p>
<pre dir="ltr">DECLARE
  geor       SDO_GEORASTER;
  geor1      SDO_GEORASTER;
  geor2      SDO_GEORASTER;
  geo_array  SDO_GEORASTER_ARRAY;
BEGIN
  SELECT georaster INTO geor FROM georaster_table WHERE georid = 1;
  SELECT georaster INTO geor2 FROM georaster_table WHERE georid = 2;
  INSERT into georaster_table values (17, sdo_geor.init(&#39;rdt_1&#39;, 17)) returning georaster into geor1;
  <span class="bold">geo_array:=SDO_GEORASTER_ARRAY(geor,geor2);</span>
  <span class="bold">sdo_geor_ra.rasterMathOp(geo_array,SDO_STRING2_ARRAY(&#39;{0,0}-0.5*{1,0}&#39;,&#39;{0,1}-0.5*{1,1}&#39;,&#39;{0,2}-0.5*{1,2}&#39;),null,geor1,&#39;false&#39;,null,&#39;parallel=4&#39;);</span>
  UPDATE georaster_table SET georaster = geor1 WHERE georid = 17;
  COMMIT;
END;
/
 
PL/SQL procedure successfully completed.
 
SELECT sdo_geor.getcellvalue(georaster,0,100,100,&#39;&#39;) FROM georaster_table WHERE georid=1 or georid=2;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(181, 163, 159)
SDO_NUMBER_ARRAY(60, 80, 90)
 
2 rows selected.
 
<span class="bold">-- In the results of the next SELECT statement, note:</span>
<span class="bold">-- 151=181-0.5*60</span>
<span class="bold">-- 123=163-0.5*80</span>
<span class="bold">-- 114=159-0.5*90</span>
SELECT sdo_geor.getcellvalue(georaster,0,100,100,&#39;&#39;) FROM georaster_table WHERE georid =17;

SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(151, 123 114)
 
1 row selected.
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-C6250398-2364-4FEE-B06E-644B5F1251AB__BABGBIIG">
<p class="titleinexample">Example 4-11 Mathematical Operations (3)</p>
<p><a href="geor_raster_algebra.htm#GUID-C6250398-2364-4FEE-B06E-644B5F1251AB__BABGBIIG">Example 4-11</a> applies a subtraction operation on two 3-layer input GeoRaster objects to generate a new GeoRaster object. The example also includes several calls to the <a href="geor_ref.htm#GUID-1E61D84B-F431-4532-B16E-E005596D4DAC">SDO_GEOR.getCellValue</a> function to show &#34;before&#34; and &#34;after&#34; values.</p>
<pre dir="ltr">SELECT sdo_geor.getcellvalue(georaster,0,10,10,&#39;0-2&#39;) FROM georaster_table WHERE georid=1 OR georid=5 ORDER BY georid;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,10,10,&#39;0-2&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(88, 137, 32)
SDO_NUMBER_ARRAY(98, 147, 42)
 
2 rows selected.
 
SELECT sdo_geor.getcellvalue(georaster,0,100,100,&#39;0-2&#39;) FROM georaster_table WHERE georid=1 OR georid=5 ORDER BY georid;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,&#39;0-2&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(181, 163, 159)
SDO_NUMBER_ARRAY(191, 173, 169)
 
2 rows selected.
 
DECLARE
  geor0  SDO_GEORASTER;
  geor   SDO_GEORASTER;
  geor1  SDO_GEORASTER;
BEGIN
  SELECT georaster INTO geor FROM georaster_table WHERE georid = 1;
  SELECT georaster INTO geor0 FROM georaster_table WHERE georid = 5;
  INSERT into georaster_table values (6, sdo_geor.init(&#39;rdt_1&#39;, 6)) returning georaster into geor1;
  sdo_geor_ra.rasterMathOp(geor0,geor,null,<span class="bold">sdo_geor_ra.OPERATOR_SUBTRACT</span>,null,geor1);
  UPDATE georaster_table SET georaster = geor1 WHERE georid = 6;
  COMMIT;
END;
/
 
PL/SQL procedure successfully completed.
 
SELECT sdo_geor.getcellvalue(georaster,0,10,10,&#39;0-2&#39;) FROM georaster_table WHERE georid=6;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,10,10,&#39;0-2&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(10, 10, 10)
 
1 row selected.
 
SELECT sdo_geor.getcellvalue(georaster,0,100,100,&#39;0-2&#39;) FROM georaster_table WHERE georid=6;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,&#39;0-2&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(10, 10, 10)
 
1 row selected.
</pre></div>
<!-- class="example" --></div>
</div>
<a id="GEORS1263"></a><a id="GEORS1264"></a><a id="GEORS1262"></a>
<div class="props_rev_3"><a id="GUID-57DE5ACD-7DE9-4871-9DF0-CC685DF5114E"></a>
<h2 id="GEORS-GUID-57DE5ACD-7DE9-4871-9DF0-CC685DF5114E" class="sect2"><span class="enumeration_section">4.5</span> Classification Operations</h2>
<div>
<p><a id="d18393e869" class="indexterm-anchor"></a>To apply simple classification operations on source GeoRaster objects and generate new GeoRaster objects based on your specifications, you can use the <a href="geor_ra_ref.htm#GUID-D9DA6608-7D97-4428-B1B2-002C371846E9">SDO_GEOR_RA.classify</a> procedure and specify the <code class="codeph">expression</code>, <code class="codeph">rangeArray</code>, and <code class="codeph">valueArray</code> parameters. This classification procedure is also called <span class="italic">segmentation</span>.</p>
<p>The <code class="codeph">expression</code> parameter is used to compute values that are used to map into the value ranges defined in the <code class="codeph">rangeArray</code> parameter. The <code class="codeph">rangeArray</code> parameter specifies a number array that defines ranges for classifying cell values, and this array must have at least one element. The <code class="codeph">valueArray</code> parameter is a number array that defines the target cell value for each range, and its length must be the length of <code class="codeph">rangeArray</code> plus one.</p>
<div class="example" id="GUID-57DE5ACD-7DE9-4871-9DF0-CC685DF5114E__BABDFCHH">
<p class="titleinexample">Example 4-12 Classification</p>
<p><a href="geor_raster_algebra.htm#GUID-57DE5ACD-7DE9-4871-9DF0-CC685DF5114E__BABDFCHH">Example 4-12</a> calls the <a href="geor_ra_ref.htm#GUID-D9DA6608-7D97-4428-B1B2-002C371846E9">SDO_GEOR_RA.classify</a> procedure to apply a segmentation operation on the value of the first band of the input GeoRaster object. The example assumes that the GeoRaster object is an image.</p>
<pre dir="ltr">DECLARE
  geor       SDO_GEORASTER;
  geor1      SDO_GEORASTER;
  rangeArray SDO_NUMBER_ARRAY;
  valueArray SDO_NUMBER_ARRAY;
BEGIN
  rangeArray:=sdo_number_array(70,80,90,100,110,120,130,140,150,160,170,180);
  valueArray:=sdo_number_array(70,80,90,100,110,120,130,140,150,160,170,180,190);
  SELECT georaster INTO geor FROM georaster_table WHERE georid = 1;
  INSERT into georaster_table values (5, sdo_geor.init(&#39;rdt_1&#39;, 5)) returning georaster into geor1;
  <span class="bold">sdo_geor_ra.classify(geor,&#39;{0}&#39;,rangeArray,valueArray,null,geor1);</span>
  UPDATE georaster_table SET georaster = geor1 WHERE georid = 5;
  COMMIT;
END;
/
 
PL/SQL procedure successfully completed.
 
<span class="bold">-- In the next statement, the target value is 90 because the value of the</span>
<span class="bold">-- first band of source GeoRaster object is 88, which is between 80 and 90.</span>
SELECT sdo_geor.getcellvalue(georaster,0,30,30,&#39;&#39;) FROM georaster_table WHERE georid =1 OR georid =5 ORDER BY georid;

SDO_GEOR.GETCELLVALUE(GEORASTER,0,30,30,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(88, 136, 35)
SDO_NUMBER_ARRAY(90)
 
2 rows selected.
 
<span class="bold">-- In the next statement, the target value is 190 because the value of the</span>
<span class="bold">-- first band of source GeoRaster object is 242, which is greater than 180.</span>
SELECT sdo_geor.getcellvalue(georaster,0,132,116,&#39;&#39;) FROM georaster_table WHERE georid =1 OR georid =5 ORDER BY georid;

SDO_GEOR.GETCELLVALUE(GEORASTER,0,132,116,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(242, 225, 233)
SDO_NUMBER_ARRAY(190)
 
2 rows selected.
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-57DE5ACD-7DE9-4871-9DF0-CC685DF5114E__BABDBHDC">
<p class="titleinexample">Example 4-13 Classification with nodata and nodataValue Parameters</p>
<p><a href="geor_raster_algebra.htm#GUID-57DE5ACD-7DE9-4871-9DF0-CC685DF5114E__BABDBHDC">Example 4-13</a> calls the <a href="geor_ra_ref.htm#GUID-D9DA6608-7D97-4428-B1B2-002C371846E9">SDO_GEOR_RA.classify</a> procedure to apply a segmentation operation on the value of the first layer of the source GeoRaster object, and to set the <code class="codeph">nodata</code> parameter to <code class="codeph">&#39;TRUE&#39;</code> and the <code class="codeph">nodataValue</code> parameter to 5, so that all NODATA pixels will be set with a NODATA value of 5 in the target GeoRaster object.</p>
<pre dir="ltr">DECLARE
  geor       SDO_GEORASTER;
  geor1      SDO_GEORASTER;
  rangeArray SDO_NUMEBR_ARRAY;
  valueArray SDO_NUMEBR_ARRAY;
BEGIN
  rangeArray:=sdo_number_array(70,80,90,100,110,120,130,140,150,160,170,180);
  valueArray:=sdo_number_array(70,80,90,100,110,120,130,140,150,160,170,180,190);
  SELECT georaster INTO geor FROM georaster_table WHERE georid = 1;
  <span class="bold">sdo_geor.addNODATA(geor, 2,136);</span>
  INSERT into georaster_table values (5, sdo_geor.init(&#39;rdt_1&#39;, 5)) returning georaster into geor1;
  sdo_geor_ra.classify(geor,&#39;{0}&#39;,rangeArray,valueArray,null,geor1,<span class="bold">&#39;true&#39;</span><span class="bold">,5</span>);
  UPDATE georaster_table SET georaster = geor1 WHERE georid = 5;
END;
/
 
PL/SQL procedure successfully completed.
 
<span class="bold">-- In the next statement, the target value of the cell is 5 because the value</span>
<span class="bold">-- of the second layer of the input GeoRaster object is 136, which is nodata.</span>
SELECT sdo_geor.getcellvalue(georaster,0,30,30,&#39;&#39;) FROM georaster_table WHERE georid =1 OR georid =5 ORDER BY georid;

SDO_GEOR.GETCELLVALUE(GEORASTER,0,30,30,&#39;&#39;)
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(88, 136, 35)
SDO_NUMBER_ARRAY(5)
 
2 rows selected.
</pre></div>
<!-- class="example" --></div>
</div>
<a id="GEORS1265"></a>
<div class="props_rev_3"><a id="GUID-9FF22F4B-19E8-45B2-9811-8ABA00268613"></a>
<h2 id="GEORS-GUID-9FF22F4B-19E8-45B2-9811-8ABA00268613" class="sect2"><span class="enumeration_section">4.6</span> On-the-Fly Statistical Analysis</h2>
<div>
<p>Many applications require statistical analysis. GeoRaster provides statistical analysis functions that dynamically (&#34;on the fly&#34;) compute complete statistical values for a GeoRaster object or the following individual statistical values: minimum, maximum, mean, median, mode, and standard deviation. You can do this without generating a histogram and updating the GeoRaster object metadata.</p>
<p>These subprograms support pyramids, band by band and the aggregation of specified band numbers. Each subprogram returns an SDO_NUMBER_ARRAY object or a number.</p>
<p>See the reference information for explanations and examples of these on-the-fly statistics computation subprograms:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="geor_ref.htm#GUID-96B2E47F-17E2-491D-9FF6-AC7BEFB434D7">SDO_GEOR.generateStatistics</a></p>
</li>
<li>
<p><a href="geor_ref.htm#GUID-FD88A636-A97B-456E-A07A-DE2D6AE54545">SDO_GEOR.generateStatisticsMax</a></p>
</li>
<li>
<p><a href="geor_ref.htm#GUID-CE118FEB-6F5D-4B42-9D95-2989355D7222">SDO_GEOR.generateStatisticsMean</a></p>
</li>
<li>
<p><a href="geor_ref.htm#GUID-5726F33E-CDE7-4793-9973-B0F779E629E8">SDO_GEOR.generateStatisticsMedian</a></p>
</li>
<li>
<p><a href="geor_ref.htm#GUID-963EB183-C710-471B-A1DA-9665D93FE2DC">SDO_GEOR.generateStatisticsMin</a></p>
</li>
<li>
<p><a href="geor_ref.htm#GUID-D36B7F54-FEF4-4111-AF3F-99A193BEC0D9">SDO_GEOR.generateStatisticsMode</a></p>
</li>
<li>
<p><a href="geor_ref.htm#GUID-453A78AC-CCDB-4E87-9A67-7C2C113B1C57">SDO_GEOR.generateStatisticsSTD</a></p>
</li>
</ul>
<p>These subprograms do not modify the metadata in the GeoRaster object, except for some formats of <a href="geor_ref.htm#GUID-96B2E47F-17E2-491D-9FF6-AC7BEFB434D7">SDO_GEOR.generateStatistics</a> that set statistical data in the GeoRaster object metadata and return a string value of <code class="codeph">TRUE</code> or <code class="codeph">FALSE</code> instead of an SDO_NUMBER_ARRAY object.</p>
<p>For an application using dynamically generated statistical data, see <a href="geor_image_proc.htm#GUID-1BFCB081-6C19-4727-B07E-1127515D75CD__CHDBFFDG">Example 5-11</a> in <a href="geor_image_proc.htm#GUID-1BFCB081-6C19-4727-B07E-1127515D75CD">Image Stretching</a>.</p>
</div>
</div>
<a id="GEORS1267"></a><a id="GEORS1268"></a><a id="GEORS1269"></a><a id="GEORS1266"></a>
<div class="props_rev_3"><a id="GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B"></a>
<h2 id="GEORS-GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B" class="sect2"><span class="enumeration_section">4.7</span> Raster Data Scaling and Offsetting</h2>
<div>
<p>Raster algebra has many applications, such as cartographic modeling (see <a href="geor_raster_algebra.htm#GUID-F2EBC84A-8BB8-484B-9F32-FC88D4E5F166">Cartographic Modeling</a>), linear image stretching (see <a href="geor_image_proc.htm#GUID-1BFCB081-6C19-4727-B07E-1127515D75CD">Image Stretching</a>), vegetation index computing (see <a href="geor_image_proc.htm#GUID-C2D99D00-071F-4BBC-A0A5-50C6F0FAF355">Vegetation Index Computation</a>), and tasseled cap transformation (see <a href="geor_image_proc.htm#GUID-2530F5D2-7386-4DD4-877A-F004F2109912">Tasseled Cap Transformation</a>). Sections in this chapter and in <a href="geor_image_proc.htm#GUID-EB60166B-6A52-4974-AF16-139CD6480EBC">Image Processing and Virtual Mosaic</a> describe a few sample applications of the GeoRaster raster algebra.</p>
<div class="example" id="GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B__BABFGGJJ">
<p class="titleinexample">Example 4-14 Converting DEM Data from Feet to Meters</p>
<p>The cell value of a GeoRaster object may represent a quantitative attribute of spatial objects, which could be in a specific unit. For example, the elevation data in a DEM GeoRaster object could be in the unit of feet. An application may require you to convert the elevations into another unit, such as meters, for georectification and other operations. You can use the raster algebra to scale the DEM data from feet into meters (that is, unit conversion), as shown in <a href="geor_raster_algebra.htm#GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B__BABFGGJJ">Example 4-14</a>.</p>
<pre dir="ltr">DECLARE 
  geor1    SDO_GEORASTER;
  geor2    SDO_GEORASTER;
BEGIN
  --Source GeoRaster object with a single DEM layer
  select georaster into geor1 from georaster_table where georid = 1;
  --To store the output DEM layer
  select georaster into geor2 from georaster_table where georid = 2 for update;
  --Scale elevation from feet to meters using the unit factor
  sdo_geor_ra.rasterMathOp(geor1,SDO_STRING2_ARRAY(&#39;{0} * 0.3048&#39;),null,geor2);
  --Commit changes to the output georaster object
  update georaster_table set georaster = geor2 where georid = 2;
  commit;
END;
/
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B__BABJHCFE">
<p class="titleinexample">Example 4-15 Offsetting DEM by Geoid Height</p>
<p>The cell data of a GeoRaster object may need to be offset by a constant for further processing. For example, a DEM layer may represent orthometric elevation instead of ellipsoidal elevation. To orthorectify a raw image georeferenced by an RPC model requires ellipsoidal elevation. <a href="geor_raster_algebra.htm#GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B__BABJHCFE">Example 4-15</a> offsets the orthometric DEM by the geoid height, resulting in an ellipsoidal DEM.</p>
<pre dir="ltr">DECLARE 
  geor1    SDO_GEORASTER;
  geor2    SDO_GEORASTER;
BEGIN
  --Source GeoRaster object with a single orthometric DEM layer
  select georaster into geor1 from georaster_table where georid = 1;
  --To store the output DEM layer
  select georaster into geor2 from georaster_table where georid = 2 for update;
  --Offset elevation by geoid height to get ellipsoidal elevation
  sdo_geor_ra.rasterMathOp(geor1,SDO_STRING2_ARRAY(&#39;{0} - 28.8&#39;),null,geor2);
  --Commit changes to the output GeoRaster object
  update georaster_table set georaster = geor2 where georid = 2;
  commit;
END;
/
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B__BABIFHIJ">
<p class="titleinexample">Example 4-16 Converting (Scaling) and Offsetting</p>
<p>You can combine the operations of <a href="geor_raster_algebra.htm#GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B__BABFGGJJ">Example 4-14</a> and <a href="geor_raster_algebra.htm#GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B__BABJHCFE">Example 4-15</a> into a single simple step, as shown in <a href="geor_raster_algebra.htm#GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B__BABIFHIJ">Example 4-16</a>.</p>
<pre dir="ltr">DECLARE 
  geor1    SDO_GEORASTER;
  geor2    SDO_GEORASTER;
BEGIN
  --Source GeoRaster object with a single DEM layer
  select georaster into geor1 from georaster_table where georid = 1;
  --To store the output DEM layer
  select georaster into geor2 from georaster_table where georid = 2 for update;
  --Scale elevation from feet to meters and offset elevation by geoid height
  sdo_geor_ra.rasterMathOp(geor1,SDO_STRING2_ARRAY(&#39;{0} * 0.3048 - 28.8&#39;),null,geor2);
  --Commit changes to the output georaster object
  update georaster_table set georaster = geor2 where georid = 2;
  commit;
END;
/
</pre></div>
<!-- class="example" --></div>
</div>
<a id="GEORS1271"></a><a id="GEORS1270"></a>
<div class="props_rev_3"><a id="GUID-13B8293B-2AE1-4687-B98A-9463EF42AC27"></a>
<h2 id="GEORS-GUID-13B8293B-2AE1-4687-B98A-9463EF42AC27" class="sect2"><span class="enumeration_section">4.8</span> Raster Data Casting</h2>
<div>
<p>Raster data casting maps cell values from one data type to another. In GeoRaster, there are two types of casting operations: one uses the <code class="codeph">cellDepth</code> keyword in the <code class="codeph">storageParam</code> parameter of operations, and the other uses the <code class="codeph">castingExpr</code> operation in the GeoRaster raster algebra. (<code class="codeph">castingExpr</code> is one of the <code class="codeph">arithmeticExpr</code> operations, as described in <a href="geor_raster_algebra.htm#GUID-A6F087DC-1E7E-4426-B778-8554A25B3494">Raster Algebra Language</a>.)</p>
<p>Whenever you apply an operation which stores the raster data result into a new GeoRaster object, you can use the <code class="codeph">cellDepth</code> keyword in the <code class="codeph">storageParam</code> parameter of that operation. (The <code class="codeph">cellDepth</code> keyword and its values are described in <a href="geor_intro.htm#GUID-4B5901B5-879D-4E5F-BE73-2242F3D7CF9D__CHDHJCBF" title="This 2 column table lists the storageParam Keywords for Raster Data. Column 1 is the keyword. Column 2 explains the keyword.">Table 1-1</a>.) If the <code class="codeph">cellDepth</code> is specified, the target GeoRaster object will be created using that <code class="codeph">cellDepth</code> value, and the raster cell data will be automatically cast to that <code class="codeph">cellDepth</code> value for storage. You can directly use <code class="codeph">cellDepth</code> in the <code class="codeph">storageParam</code> parameter to do the casting if the source data is in lower cell depth and the resulting data is in higher cell depth. In this case, the casting is transparent and fast.</p>
<p>However, if you specify a <span class="italic">lower</span> cell depth for data in higher cell depth, changing the cell depth using the <code class="codeph">cellDepth</code> keyword in the <code class="codeph">storageParam</code> parameter can cause loss or change of data and reduced precision or quality. To have better control of the precision and accuracy, you can use the Raster Algebra casting operator, <code class="codeph">castingExpr</code>.</p>
<p>For example, assume you have a raster with a cell depth of <code class="codeph">32BIT_REAL</code> and a value range in [0.0, 100.0). You can use <a href="geor_raster_algebra.htm#GUID-13B8293B-2AE1-4687-B98A-9463EF42AC27__BABGCGIG">Example 4-17</a> to perform linear segmentation of the raster into 10 different classes, each of which has a cell value that is a multiple of 10 (0, 10, 20, &hellip;, 90), using the <code class="codeph">castint</code> operator. This operation casts all cell values to their closest lower multiple of 10; for example, all numbers from 60 to 69 are cast to 60.</p>
<div class="example" id="GUID-13B8293B-2AE1-4687-B98A-9463EF42AC27__BABGCGIG">
<p class="titleinexample">Example 4-17 Linear Segmentation of a Raster</p>
<pre dir="ltr">DECLARE 
  geor1    SDO_GEORASTER;
  geor2    SDO_GEORASTER;
BEGIN
  --Source georaster object with cell value range [0.0,100.0) 
  select georaster into geor1 from georaster_table where georid = 1;
  --Target georaster object to store the output layer
  select georaster into geor2 from georaster_table where georid = 2 for update;
  --Linearly segment the source raster into 10 classes and store in 8BIT cell depth
  sdo_geor_ra.rasterMathOp(geor1,
    SDO_STRING2_ARRAY(&#39;(<span class="bold">castint({0}/10)*10</span>&#39;),
    &#39;<span class="bold">celldepth=8BIT</span>&#39;,
    geor2);
  --Commit changes to the output georaster object
  update georaster_table set georaster = geor2 where georid = 2;
  commit;
END;
/
</pre>
<p>As shown in <a href="geor_raster_algebra.htm#GUID-13B8293B-2AE1-4687-B98A-9463EF42AC27__BABGCGIG">Example 4-17</a>, you can combine the usage of the <code class="codeph">cellDepth</code> keyword in the <code class="codeph">storageParam</code> parameter with the raster algebra casting operator, so that the result can be calculated correctly as well as stored in an appropriate and concise way. In <a href="geor_raster_algebra.htm#GUID-13B8293B-2AE1-4687-B98A-9463EF42AC27__BABGCGIG">Example 4-17</a>, the output cell values are integers equal to or less than 90, so the resulting raster can be stored using <code class="codeph">8BIT</code> cell depth (instead of <code class="codeph">32BIT_REAL</code>), which saves storage space.</p>
</div>
<!-- class="example" --></div>
</div>
<a id="GEORS1273"></a><a id="GEORS1272"></a>
<div class="props_rev_3"><a id="GUID-F2EBC84A-8BB8-484B-9F32-FC88D4E5F166"></a>
<h2 id="GEORS-GUID-F2EBC84A-8BB8-484B-9F32-FC88D4E5F166" class="sect2"><span class="enumeration_section">4.9</span> Cartographic Modeling</h2>
<div>
<p>Raster algebra is widely used in cartographic modeling and is considered an essential component of GIS systems. Using the PL/SQL and the raster algebra expressions and functions, you can conduct cartographic modeling over a large number of rasters and images of virtually unlimited size.</p>
<p>For example, a cartographic modeling process for wildfire evaluation might retrieve the elevation, slope, aspect, temperature, wetness, and other information from a series of raster layers and then evaluate the cells one-by-one to create a resulting raster map, which can be further classified to create a thematic map. Change analysis, site selection, suitability analysis, climate modeling, and oil field evaluation using the raster layer overlay technique are other typical cartographic modeling processes. In those cases, arithmetic, relational, and logical operations may need to be combined.</p>
<p>Assume that a hypothetical cartographic model involves seven different raster layers and has an expression as follows. and that the modeling result is a raster map with 0 and 1 as cell values:</p>
<pre dir="ltr">output = 1 if ( (100 &lt; layer1 &lt;= 500) 
                &amp; (layer2 == 3 or layer2 == 10) 
                &amp; ( (layer3+layer4) * log(Layer5) / sqrt(layer5) ) &gt;= layer6) 
                || (layer7 != 1) ) 
                is TRUE and
         0 if otherwise
</pre>
<p><a href="geor_raster_algebra.htm#GUID-F2EBC84A-8BB8-484B-9F32-FC88D4E5F166__BABGEBDG">Example 4-18</a> shows how to run the preceding cartographic model in GeoRaster and store the result as a bitmap.</p>
<div class="example" id="GUID-F2EBC84A-8BB8-484B-9F32-FC88D4E5F166__BABGEBDG">
<p class="titleinexample">Example 4-18 Cartographic Modeling</p>
<pre dir="ltr">DECLARE 
  geor       SDO_GEORASTER;
  geor1      SDO_GEORASTER;
  mycursor   sys_refcursor;
  expr       varchar2(1024);
BEGIN
  --7 source GeoRaster objects, each of which contains one source layer in the order of 1 to 7
  OPEN mycursor FOR
    select georaster from georaster_table where georid &gt;0 and georid &lt;=7 order by georid;
  --Output GeoRaster object to contain the result
  insert into georaster_table (georid, georaster) values (8, sdo_geor.init(&#39;RDT_1&#39;,8))
    returning georaster into geor1;
  --Modeling using arithmeticExpr, booleanExpr, and rasterMathOp 
  expr := &#39;((100&lt;{0,0})&amp;({0,0}&lt;=500))&amp;(({1,0}=3)|({1,0}=10))&amp;(((({2,0}+{3,0})*log({4,0})/sqrt({4,0}))&gt;={5,0})|({6,0}!=1))&#39;;
  sdo_geor_ra.rasterMathOp(mycursor, sdo_string2_array(expr), 
                                               &#39;celldepth=1BIT&#39;, geor1, &#39;true&#39;, 0, &#39;parallel=4&#39;);
  update georaster_table set georaster = geor1 where georid = 8;
  commit;
END;
/
</pre>
<p>The process in <a href="geor_raster_algebra.htm#GUID-F2EBC84A-8BB8-484B-9F32-FC88D4E5F166__BABGEBDG">Example 4-18</a> considers NODATA and will assign 0 (zero) to any cell that is a NODATA cell in one or more source layers. It is also parallelized into four processes to leverage multiple CPUs of the database server to improve performance.</p>
</div>
<!-- class="example" --></div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment4336">
<tr>
<td class="cellalignment4343">
<table class="cellalignment4341">
<tr>
<td class="cellalignment4340"><a href="basic-georaster-operations.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment4340"><a href="geor_image_proc.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment4345">
<table class="cellalignment4339">
<tr>
<td class="cellalignment4340"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment4340"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment4340"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment4340"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment4340"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment4340"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>