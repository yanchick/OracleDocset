<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-91727"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Troubleshooting%20Replication%20Problems"></a><title>Troubleshooting Replication Problems</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1042"/>
<meta name="dcterms.created" content="2015-02-06T8:21:53Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Advanced Replication"/>
<meta name="dcterms.identifier" content="E53117-02"/>
<meta name="dcterms.isVersionOf" content="REPLN"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="repplan.htm" title="Previous" type="text/html"/>
<link rel="Next" href="repunicode.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E53117-02.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">13/15</span> <!-- End Header -->
<div id="REPLN008" class="appendix"><a id="CIAHJDEI"></a> <a id="i10333"></a>
<h1 class="appendix"><span class="secnum">A</span> Troubleshooting Replication Problems</h1>
<p><a id="sthref1100"></a><a id="sthref1101"></a><a id="sthref1102"></a>This appendix contains troubleshooting guidelines for managing a replication environment.</p>
<p>This appendix contains these topics:</p>
<ul>
<li>
<p><a href="#i8621">Diagnosing Problems with Database Links</a></p>
</li>
<li>
<p><a href="#i8422">Diagnosing Problems with Master Sites</a></p>
</li>
<li>
<p><a href="#i8479">Diagnosing Problems with the Deferred Transaction Queue</a></p>
</li>
<li>
<p><a href="#i11421">Diagnosing Problems with Materialized Views</a></p>
</li>
</ul>
<a id="i8621"></a>
<div id="REPLN547" class="sect1">
<h2 class="sect1">Diagnosing Problems with Database Links<a id="sthref1103"></a><a id="sthref1104"></a></h2>
<p>If you think a database link is not functioning properly, then you can drop and re-create it using Oracle Enterprise Manager Cloud Control, SQL*Plus, or another tool.</p>
<ul>
<li>
<p>Ensure that the database link name is the same as the global name of the target database.</p>
</li>
<li>
<p>Ensure that the scheduled interval is what you want.</p>
</li>
<li>
<p>Ensure that the scheduled interval is not shorter than the required execution time.</p>
</li>
</ul>
<p>If you used a connection qualifier in a database link to a given site, then the other sites that link to that site must have the same connection qualifier. For example, suppose you create a database link as follows:</p>
<pre dir="ltr">CREATE DATABASE LINK dbs1.example.com@myethernet CONNECT TO repadmin
  IDENTIFIED BY <span class="italic">password</span> USING &#39;<span class="italic">connect_string_myethernet</span>&#39;;
</pre>
<p>All the sites, whether masters or materialized views, associated with <code dir="ltr">dbs1.example.com@myethernet</code> must include <code dir="ltr">myethernet</code> as the connection qualifier.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADMIN02901" href="../ADMIN/ds_admin.htm#ADMIN02901"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for more information database links and connection qualifiers</div>
</div>
<!-- class="sect1" -->
<a id="i8422"></a>
<div id="REPLN548" class="sect1">
<h2 class="sect1">Diagnosing Problems with Master Sites<a id="sthref1105"></a></h2>
<p>Problems can arise in a multimaster replication system. The following sections discuss some problems and ways to solve them:</p>
<ul>
<li>
<p><a href="#i9450">Replicated Objects Not Created at New Master Site</a></p>
</li>
<li>
<p><a href="#i9455">DDL Changes Not Propagated to Master Site</a></p>
</li>
<li>
<p><a href="#i9460">DML Changes Not Asynchronously Propagated to Other Sites</a></p>
</li>
<li>
<p><a href="#i9465">DML Cannot be Applied to Replicated Table</a></p>
</li>
<li>
<p><a href="#i9470">Bulk Updates and Constraint Violations</a></p>
</li>
<li>
<p><a href="#i9475">Re-creating a Replicated Object</a></p>
</li>
<li>
<p><a href="#i9480">Unable to Generate Replication Support for a Table</a></p>
</li>
<li>
<p><a href="#i9485">Problems with Replicated Procedures or Triggers</a></p>
</li>
</ul>
<a id="i9450"></a>
<div id="REPLN549" class="sect2">
<h3 class="sect2">Replicated Objects Not Created at New Master Site<a id="sthref1106"></a></h3>
<p>If you add a new master site to a master group, and the appropriate objects are not created at the new site, then try the following:</p>
<ul>
<li>
<p>Ensure that the necessary private database links exist between the new master site and the existing master sites. If you used a configuration wizard in the Advanced Replication interface in Oracle Enterprise Manager Cloud Control to set up your sites, then you should not have any problems. You must have links both to the new site from each existing site, and from the new site to each existing site.</p>
</li>
<li>
<p>Ensure that the administrative requests at all sites have completed successfully. If requests have not been executed yet, then you can manually execute pending administrative requests to complete the operation immediately.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="i9455"></a>
<div id="REPLN550" class="sect2">
<h3 class="sect2">DDL Changes Not Propagated to Master Site<a id="sthref1107"></a><a id="sthref1108"></a></h3>
<p>If you create a master group object or alter the definition of a master group object at the master definition site and the modification is not propagated to a master site, then first ensure that the administrative requests at all sites have completed successfully. If requests are pending execution, then you can manually execute them to complete the operation immediately.</p>
<p>When you execute DDL statements through the replication API, Oracle executes the statements on behalf of the user who submits the DDL. When a DDL statement applies to an object in a schema other than the submitter&#39;s schema, the submitter needs appropriate privileges to execute the statement. In addition, the statement must explicitly name the schema. For example, assume that you supply the following as the <code dir="ltr">ddl_text</code> parameter to the <code dir="ltr">DBMS_REPCAT.CREATE_MASTER_ REPOBJECT</code> procedure:</p>
<pre dir="ltr">CREATE TABLE oe.new_employees AS SELECT * FROM hr.employees WHERE ...;
</pre>
<p>Because each table name contains a schema name, this statement works whether the replication administrator is <code dir="ltr">oe</code>, <code dir="ltr">hr</code>, or another user, if the administrator has the required privileges.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Qualify the name of every schema object with the appropriate schema.</div>
</div>
<!-- class="sect2" -->
<a id="i9460"></a>
<div id="REPLN551" class="sect2">
<h3 class="sect2">DML Changes Not Asynchronously Propagated to Other Sites<a id="sthref1109"></a><a id="sthref1110"></a></h3>
<p>If you make an update to your data at a master site, and that change is not asynchronously propagated to the other sites in your replication environment, then try the following:</p>
<ul>
<li>
<p>Use the Advanced Replication interface in Oracle Enterprise Manager Cloud Control to check whether the corresponding deferred transaction has been pushed to the destination. If not, then you can also check to see how much longer it will be before the scheduled link pushes the queue to the destination site. If you do not want to wait for the next scheduled push across a link, then you can execute deferred transaction manually.</p>
</li>
<li>
<p>If a scheduled link&#39;s interval has passed and corresponding deferred transactions have not been pushed, then check the corresponding job for the link.</p>
</li>
<li>
<p>Even after propagating a deferred transaction to a destination, it might not execute because of an error. Check the <code dir="ltr">DEFERROR</code> data dictionary view at the destination site for errors.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink REPMA109" href="../REPMA/rarmanage.htm#REPMA109"><span class="italic">Oracle Database Advanced Replication Management API Reference</span></a> for information about modifying tables without replicating the modifications, which might be necessary when you must manually synchronize the data in replicated tables</div>
</div>
<!-- class="sect2" -->
<a id="i9465"></a>
<div id="REPLN552" class="sect2">
<h3 class="sect2">DML Cannot be Applied to Replicated Table<a id="sthref1111"></a><a id="sthref1112"></a><a id="sthref1113"></a><a id="sthref1114"></a></h3>
<p>If you receive the <code dir="ltr">deferred_rpc_quiesce</code> exception when you attempt to modify a replicated table, then the master group to which your replicated object belongs is quiescing or quiesced. To proceed, your replication administrator must resume replication activity for the master group.</p>
</div>
<!-- class="sect2" -->
<a id="i9470"></a>
<div id="REPLN553" class="sect2">
<h3 class="sect2">Bulk Updates and Constraint Violations<a id="sthref1115"></a><a id="sthref1116"></a><a id="sthref1117"></a><a id="sthref1118"></a></h3>
<p>A single update statement applied to a replicated table can update zero or more rows. The update statement causes zero or more update requests to be queued for deferred execution, one for each row updated. This distinction is important when constraints are involved, because Oracle effectively performs constraint checking at the end of each statement. While a bulk update might not violate a uniqueness constraint, for example, some equivalent sequence of individual updates might violate uniqueness.</p>
<p>If the ordering of updates is important, then update one row at a time in an appropriate order. This lets you define the order of update requests in the deferred transactions queue.</p>
</div>
<!-- class="sect2" -->
<a id="i9475"></a>
<div id="REPLN554" class="sect2">
<h3 class="sect2">Re-creating a Replicated Object<a id="sthref1119"></a><a id="sthref1120"></a></h3>
<p>If you add an object such as a package, procedure, or view to a master group, then the status of the object must be valid. If the status of an object is invalid, then recompile the object or drop and re-create the object before adding it to a master group. Check the <code dir="ltr">DBA_REPOBJECT</code> data dictionary view for the status of replication objects.</p>
</div>
<!-- class="sect2" -->
<a id="i9480"></a>
<div id="REPLN555" class="sect2">
<h3 class="sect2">Unable to Generate Replication Support for a Table<a id="sthref1121"></a><a id="sthref1122"></a></h3>
<p>When you generate replication support for a table, Oracle activates an internal trigger at the local site. <code dir="ltr">EXECUTE</code> privileges for most of the packages involved with replication, such as <code dir="ltr">DBMS_REPCAT</code> and <code dir="ltr">DBMS_DEFER</code>, need to be granted to replication administrators and users that own replicated objects. The configuration wizards in the Advanced Replication interface in Oracle Enterprise Manager Cloud Control and the <code dir="ltr">DBMS_REPCAT_ADMIN</code> package both perform the grants needed by the replication administrators for many typical replication scenarios. When the owner of a replicated object is not a replication administrator, however, you must explicitly grant <code dir="ltr">EXECUTE</code> privilege on <code dir="ltr">DBMS_DEFER</code> to the object owner.</p>
</div>
<!-- class="sect2" -->
<a id="i9485"></a>
<div id="REPLN556" class="sect2">
<h3 class="sect2">Problems with Replicated Procedures or Triggers<a id="sthref1123"></a><a id="sthref1124"></a></h3>
<p>If you discover an unexpected unresolved conflict, and you were mixing procedural and row-level replication on a table, then carefully review the procedure to ensure that the replicated procedure did not cause the conflict. Complete the following checks:</p>
<ul>
<li>
<p>Ensure that ordering conflicts between procedural and row-level updates are not possible.</p>
</li>
<li>
<p>Check if the replicated procedure locks the table in <code dir="ltr">EXCLUSIVE</code> mode before performing updates or uses some other mechanism of avoiding conflicts with row-level updates.</p>
</li>
<li>
<p>Check that row-level replication is disabled at the start of the replicated procedure and reenabled at the end.</p>
</li>
<li>
<p>Ensure that row-level replication is reenabled even if exceptions occur when the procedure executes.</p>
</li>
<li>
<p>Check to ensure that the replicated procedure executed at all master sites.</p>
</li>
</ul>
<p>You should perform similar checks on any replicated triggers that you have defined on replicated tables.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i8479"></a>
<div id="REPLN557" class="sect1">
<h2 class="sect1">Diagnosing Problems with the Deferred Transaction Queue<a id="sthref1125"></a><a id="sthref1126"></a></h2>
<p>If deferred transactions at a site are not being pushed to their destinations, then the following sections explain some possible causes for the problem:</p>
<ul>
<li>
<p><a href="#i9495">Check Jobs for Scheduled Links</a></p>
</li>
<li>
<p><a href="#i9584">Distributed Transaction Problems with Synchronous Replication</a></p>
</li>
<li>
<p><a href="#i9589">Incomplete Database Link Specifications</a></p>
</li>
<li>
<p><a href="#i9594">Incorrect Replication Catalog Views</a></p>
</li>
</ul>
<a id="i9495"></a>
<div id="REPLN558" class="sect2">
<h3 class="sect2">Check Jobs for Scheduled Links<a id="sthref1127"></a></h3>
<p>When you create a scheduled link, Oracle adds a corresponding job to the site&#39;s job queue. If you have scheduled a link to push deferred transactions at a periodic interval, and you encounter a problem, then you should first be certain that you are not experiencing a problem with the job queue.</p>
</div>
<!-- class="sect2" -->
<a id="i9584"></a>
<div id="REPLN559" class="sect2">
<h3 class="sect2">Distributed Transaction Problems with Synchronous Replication<a id="sthref1128"></a></h3>
<p>When you use synchronous replication, Oracle uses a distributed transaction to ensure that the transaction has been properly committed at the remote site. Distributed transactions use two-phase commit. Asynchronous replication does not use two-phase commit.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADMIN032" href="../ADMIN/ds_txnman.htm#ADMIN032"><span class="variable">Oracle Database Administrator&#39;s Guide</span></a> for information about diagnosing problems with distributed transactions</div>
</div>
<!-- class="sect2" -->
<a id="i9589"></a>
<div id="REPLN560" class="sect2">
<h3 class="sect2">Incomplete Database Link Specifications<a id="sthref1129"></a></h3>
<p>If you notice that transactions are not being pushed to a given remote site, then you might have a problem with how you have specified the destination for the transaction. When you create a scheduled link, you must provide the full database link name.</p>
</div>
<!-- class="sect2" -->
<a id="i9594"></a>
<div id="REPLN561" class="sect2">
<h3 class="sect2">Incorrect Replication Catalog Views<a id="sthref1130"></a></h3>
<p>Having the wrong view definitions can lead to erroneous deferred transaction behavior. The <code dir="ltr">DEFCALLDEST</code> and <code dir="ltr">DEFTRANDEST</code> views are defined differently in <code dir="ltr">catdefer.sql</code> and <code dir="ltr">catrepc.sql</code>. The definitions in <code dir="ltr">catrepc.sql</code> should be used whenever replication is used. If <code dir="ltr">catdefer.sql</code> is ever (re)loaded, then ensure that the view definitions in <code dir="ltr">catrepc.sql</code> are subsequently loaded.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i11421"></a>
<div id="REPLN562" class="sect1">
<h2 class="sect1">Diagnosing Problems with Materialized Views<a id="sthref1131"></a></h2>
<p>There are several problems that might happen with materialized view sites in a replication system. The following sections discuss some problems and ways to troubleshoot them:</p>
<ul>
<li>
<p><a href="#i9601">Problems Creating Replicated Objects at Materialized View Site</a></p>
</li>
<li>
<p><a href="#i8519">Refresh Problems</a></p>
</li>
<li>
<p><a href="#i9614">Advanced Troubleshooting of Refresh Problems</a></p>
</li>
</ul>
<a id="i9601"></a>
<div id="REPLN563" class="sect2">
<h3 class="sect2">Problems Creating Replicated Objects at Materialized View Site<a id="sthref1132"></a></h3>
<p><a id="i8508"></a>If you unsuccessfully attempt to create an object at a materialized view site, then try the following:</p>
<ul>
<li>
<p>For an updatable materialized view, check that the associated master table or master materialized view has a materialized view log.</p>
</li>
<li>
<p>Ensure that you have the necessary privileges to create the object. For a materialized view, you need <code dir="ltr">SELECT</code> privilege on the master table or master materialized view and its materialized view log. See <a href="repplan.htm#i16527">&#34;Assign Privileges&#34;</a> for more information.</p>
</li>
<li>
<p>If you are trying to add an existing materialized view to a materialized view group, then try re-creating the materialized view when you add it to the group.</p>
</li>
<li>
<p>If you are trying to create a fast refresh primary key or subquery materialized view, then ensure that the materialized view log on the master table or master materialized view logs primary keys.</p>
</li>
<li>
<p>If you are trying to create a fast refresh rowid materialized view, then ensure that the materialized view log on the master table logs rowids.</p>
</li>
<li>
<p>Check if the materialized view log has the required columns added for subquery materialized views. See <a href="repplan.htm#i16640">&#34;Logging Columns in the Materialized View Log&#34;</a> for information.</p>
</li>
<li>
<p>Check if the materialized view log exists for all tables that are involved in a fast refresh materialized view. If the materialized view contains a subquery, then each table referenced in the subquery should have a materialized view log.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<div id="REPLN564" class="sect2"><a id="sthref1133"></a>
<h3 class="sect2">Problems Performing Offline Instantiation of a Deployment Template<a id="sthref1134"></a></h3>
<p>If you receive and error stating that Oracle is unable to initialize the extent in the temporary tablespace when you try to instantiate a deployment template offline, then you might need to adjust the data file for the temporary database so that it auto extends.</p>
<p>For example, issue the following statement to adjust the data file:</p>
<pre dir="ltr">ALTER DATABASE TEMPFILE &#39;/u02/oracle/rbdb1/temp.dbf&#39; 
    AUTOEXTEND ON
    NEXT 10M;
</pre>
<p>After you have made this adjustment, instantiate the deployment template offline at the materialized view site.</p>
</div>
<!-- class="sect2" -->
<a id="i8519"></a>
<div id="REPLN565" class="sect2">
<h3 class="sect2">Refresh Problems<a id="sthref1135"></a><a id="sthref1136"></a></h3>
<p>The following sections explain several common materialized view refresh problems.</p>
<div id="REPLN566" class="sect3"><a id="sthref1137"></a>
<h4 class="sect3">Common Refresh Problems</h4>
<p>Several common factors can prevent the automatic refresh of a group of materialized views:</p>
<ul>
<li>
<p>The lack of a job slave at the materialized view database</p>
</li>
<li>
<p>An intervening network or server failure</p>
</li>
<li>
<p>An intervening server shutdown</p>
</li>
</ul>
<p>When a materialized view refresh group is experiencing problems, ensure that none of the preceding situations is preventing Oracle from completing group refreshes.</p>
</div>
<!-- class="sect3" -->
<div id="REPLN567" class="sect3"><a id="sthref1138"></a>
<h4 class="sect3">Automatic Refresh Retries<a id="sthref1139"></a><a id="sthref1140"></a><a id="sthref1141"></a><a id="sthref1142"></a></h4>
<p>When Oracle fails to refresh a group automatically, the group remains due for its refresh to complete. Oracle will retry an automatic refresh of a group with the following behavior:</p>
<ul>
<li>
<p>Oracle retries the group refresh first one minute later, then two minutes later, four minutes later, and so on, with the retry interval doubling with each failed attempt to refresh the group.</p>
</li>
<li>
<p>Oracle does not allow the retry interval to exceed the refresh interval itself.</p>
</li>
<li>
<p>Oracle retries the automatic refresh up to sixteen times.</p>
</li>
</ul>
<p>If after 16 attempts to refresh a refresh group Oracle continues to encounter errors, then Oracle considers the group broken. The General page of the Refresh Group property sheet in Schema Manager indicates when a refresh group is broken. You can also query the <code dir="ltr">BROKEN</code> column of the <a id="sthref1143"></a><a id="sthref1144"></a><a id="sthref1145"></a><a id="sthref1146"></a><code dir="ltr">USER_REFRESH</code> and <code dir="ltr">USER_REFRESH_CHILDREN</code> data dictionary views to see the current status of a refresh group.</p>
<p><a id="sthref1147"></a><a id="sthref1148"></a>The errors causing Oracle to consider a materialized view refresh group broken are recorded in a trace file. After you correct the problems preventing a refresh group from refreshing successfully, you must refresh the group manually. Oracle then resets the broken flag so that automatic refreshes can happen again.</p>
<div class="infoboxnotealso">
<p class="notep1"><span class="bold">See Also</span>:</p>
The name of the materialized view trace file is of the form j<span class="italic">n</span>, where <span class="italic">n</span> is operating system specific. See the Oracle documentation for your operating system for the name on your system.</div>
</div>
<!-- class="sect3" -->
<div id="REPLN568" class="sect3"><a id="sthref1149"></a>
<h4 class="sect3">Fast Refresh Errors at New Materialized View Sites</h4>
<p>In some cases, a materialized view log for a master table or master materialized view might be purged during the creation of a materialized view at a new materialized view site. When this happens, you might encounter the following errors:</p>
<pre dir="ltr">ORA-12004 REFRESH FAST cannot be used for materialized view <span class="italic">materialized_view_name</span>
ORA-12034 materialized view log on <span class="italic">materialized_view_name</span> younger than last refresh
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="repplan.htm#i18389">&#34;Avoiding Problems When Adding a New Materialized View Site&#34;</a> for a complete description of how to avoid this problem.</div>
</div>
<!-- class="sect3" -->
<div id="REPLN569" class="sect3"><a id="sthref1150"></a>
<h4 class="sect3">Materialized Views Continually Refreshing<a id="sthref1151"></a></h4>
<p>If you encounter a situation where Oracle continually refreshes a group of materialized views, then check the group&#39;s refresh interval. Oracle evaluates a group&#39;s automatic refresh interval before starting the refresh. If a group&#39;s refresh interval is less than the amount of time it takes to refresh all materialized views in the group, then Oracle continually starts a group refresh each time the job slave checks the queue of outstanding jobs.</p>
</div>
<!-- class="sect3" -->
<div id="REPLN570" class="sect3"><a id="sthref1152"></a>
<h4 class="sect3">Materialized View Logs Growing Too Large<a id="sthref1153"></a></h4>
<p>If a materialized view log at a master site or master materialized view site is growing too large, then check to see whether a network or site failure has prevented the master site or master materialized view site from becoming aware that a materialized view has been dropped. You might need to purge part of the materialized view log or unregister the unused materialized view site.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink REPMA124" href="../REPMA/rarmanmv.htm#REPMA124"><span class="italic">Oracle Database Advanced Replication Management API Reference</span></a> for more information about managing materialized view logs</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i9614"></a>
<div id="REPLN571" class="sect2">
<h3 class="sect2">Advanced Troubleshooting of Refresh Problems</h3>
<p>If you have a problem refreshing a materialized view, then try the following:</p>
<ul>
<li>
<p><a id="sthref1154"></a>Check the <code dir="ltr">NEXT_DATE</code> value in the <code dir="ltr">DBA_REFRESH_CHILDREN</code> view to determine if the refresh has been scheduled.</p>
</li>
<li>
<p>If the refresh interval has passed, then check the <code dir="ltr">DBA_REFRESH</code> view for the associated job number for the materialized view refresh and then diagnose the problem with job queues.</p>
</li>
<li>
<p>Check if there are job slaves running. Check the <code dir="ltr">JOB_QUEUE_PROCESSES</code> initialization parameter, query the <code dir="ltr">DBA_JOBS_RUNNING</code> view, and use your operating system to check if the job slaves are still running.</p>
</li>
<li>
<p>You also might encounter an error if you attempt to define a master detail relationship between two materialized views. You should define master detail relationships only on the master tables by using declarative referential integrity constraints. The related materialized views should then be placed in the same refresh group to preserve this relationship. However, you can define deferred (or deferrable) constraints on materialized views.</p>
</li>
<li>
<p>If there are any outstanding conflicts recorded at the master site or master materialized view site for the materialized views, then you can only refresh the materialized views by setting the parameter <code dir="ltr">REFRESH_AFTER_ERRORS</code> to <code dir="ltr">TRUE</code>. This parameter can be set when you create or alter a materialized view refresh group. There is a corresponding parameter for the Advanced Replication interface in Oracle Enterprise Manager Cloud Control.</p>
</li>
<li>
<p><a id="sthref1155"></a>Materialized views in the same refresh groups have their rows updated in a single transaction. Such a transaction can be very large, requiring either a large rollback segment at the materialized view site, with the rollback segment specified to be used during refresh, or more frequent refreshes to reduce the transaction size.</p>
</li>
<li>
<p><a id="sthref1156"></a>If Oracle error <code dir="ltr">ORA-12004</code> occurs, then the master site or master materialized view site might have run out of rollback segments when trying to maintain the materialized view log, or the materialized view log might be out of date. For example, the materialized view log might have been purged or re-created.</p>
</li>
<li>
<p><a id="sthref1157"></a>Complete refreshes of a single materialized view internally use the <code dir="ltr">TRUNCATE</code> feature to increase speed and reduce rollback segment requirements. However, until the materialized view refresh is complete, users might temporarily see no data in the materialized view. Refreshes of multiple materialized views (for example, refresh groups) do not use the <code dir="ltr">TRUNCATE</code> feature.</p>
</li>
<li>
<p>Reorganization of the master table (for example, to reclaim system resources) should <code dir="ltr">TRUNCATE</code> the master table to force rowid materialized views to do complete refreshes. Otherwise, the materialized views have incorrect references to master table rowids. You use the <code dir="ltr">BEGIN_TABLE_REORGANIZATION</code> and <code dir="ltr">END_TABLE_REORGANIZATION</code> procedures in the <code dir="ltr">DBMS_MVIEW</code> package to reorganize a master table. See the <a class="olink REPMA101" href="../REPMA/rarmanmv.htm#REPMA101"><span class="italic">Oracle Database Advanced Replication Management API Reference</span></a> for more information.</p>
</li>
<li>
<p><a id="sthref1158"></a>If while refreshing you see an <code dir="ltr">ORA-00942</code> (table or view does not exist), then check your database links and ensure that you still have the required privileges on the master table or master materialized view and the materialized view log.</p>
</li>
<li>
<p>If a fast refresh was succeeding but then fails, then check whether:</p>
<ul>
<li>
<p>The materialized view log was truncated, purged, or dropped.</p>
</li>
<li>
<p>You still have the required privileges on the materialized view log.</p>
</li>
</ul>
</li>
<li>
<p>If a force refresh takes an inordinately long time, then check if the materialized view log used by the refresh has been dropped.</p>
</li>
<li>
<p><a id="sthref1159"></a>If the materialized view was created with <code dir="ltr">BUILD</code> <code dir="ltr">DEFERRED</code>, and its first fast refresh fails, then ensure that a previous complete refresh was done successfully before checking for other problems.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink REPMA124" href="../REPMA/rarmanmv.htm#REPMA124"><span class="italic">Oracle Database Advanced Replication Management API Reference</span></a> for information about managing materialized view logs</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="appendix" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5764">
<tr>
<td class="cellalignment5771">
<table class="cellalignment5769">
<tr>
<td class="cellalignment5768"><a href="repplan.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5768"><a href="repunicode.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5773">
<table class="cellalignment5767">
<tr>
<td class="cellalignment5768"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5768"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5768"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5768"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5768"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5768"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>