<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-87527"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Overview%20of%20Transaction%20Guard"></a><title>Overview of Transaction Guard</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="dcterms.created" content="2017-07-10T13:15:22Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Real Application Clusters Administration and Deployment Guide"/>
<meta name="dcterms.identifier" content="E48838-12"/>
<meta name="dcterms.isVersionOf" content="RACAD"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="GUID-097A5067-8CCF-4FF0-B97B-BF109DFA1841.htm" title="Previous" type="text/html"/>
<link rel="Next" href="GUID-E3DA6FA0-B139-4877-83A1-FDE559AD5DFE.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E48838-12.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-619E639B-6C8E-49B6-8CB6-49DB1B3A8CAA"></a> <span id="PAGE" style="display:none;">108/567</span> <!-- End Header -->
<a id="RACAD8917"></a>
<h1 id="RACAD-GUID-619E639B-6C8E-49B6-8CB6-49DB1B3A8CAA" class="sect1">Overview of Transaction Guard</h1>
<div>
<p><a id="d26517e130" class="indexterm-anchor"></a><a id="d26517e132" class="indexterm-anchor"></a>One of the fundamental problems for recovering applications after an outage is that the commit message that is sent back to the client is not durable. If there is a communication disruption between the client and the server, then the client receives an error message indicating that the communication failed (also called a <a href="GUID-C68EE4B9-60C8-4EEE-B7D0-4708526B128E.htm#GUID-EF113BDB-272C-4190-A5BD-E304B0724F12"><span class="xrefglossterm">recoverable error</span></a> ). This error does not inform the application whether the submission executed any commit operations; or if a procedural call ran to completion executing all expected commits and session state changes or failed part way through; or worse yet, is still running disconnected from the client.</p>
<p><a id="d26517e142" class="indexterm-anchor"></a><a id="d26517e144" class="indexterm-anchor"></a>Transaction Guard provides a generic protocol and API for applications to use for at-most-once execution in case of planned and unplanned outages and repeated submissions. Applications use a new concept called the logical transaction ID (LTXID) to determine the outcome of the last transaction open in a database session following an outage. Without using Transaction Guard, applications that attempt to retry operations following outages can cause logical corruption by committing duplicate transactions. Application Continuity uses this feature, and it is available to other applications to determine the last outcome on a failed session.</p>
<p>Without Transaction Guard, if a transaction has been started and a commit has been issued, the commit message that is sent back to the client is not durable. The client is left not knowing whether the transaction committed or not. The transaction cannot be validly resubmitted if the non-transactional state is incorrect or if it is committed. In the absence of guaranteed commit and completion information, resubmission can cause transactions to be applied more than once. Continuing to process a committed but not completed transaction can result in the application using a database session that is in the wrong state.</p>
<p><a id="d26517e150" class="indexterm-anchor"></a><a id="d26517e152" class="indexterm-anchor"></a><a id="d26517e154" class="indexterm-anchor"></a><a id="d26517e156" class="indexterm-anchor"></a>In Oracle Database 12<span class="italic">c</span>, Transaction Guard provides a new, fully integrated tool for applications to use to achieve idempotence automatically and transparently, and in a manner that scales. Transaction Guard uses <a id="d26517e162" class="indexterm-anchor"></a>Logical Transaction ID (LTXID) to avoid submitting duplicate transactions. This is referred to as <a id="d26517e165" class="indexterm-anchor"></a><span class="italic">transaction idempotence</span>. The LTXID persists on commit and is reused following a rollback. During normal runtime, a LTXID is automatically held in the session at both the client and server for each database transaction. At commit, the LTXID is persisted as part of committing the transaction and the next LTXID to use is returned to the client.</p>
<p>The following example describes how Application Continuity or a third-party application uses Transaction Guard:</p>
<ol>
<li>
<p>Client receives a FAN down event or a recoverable error.</p>
</li>
<li>
<p>When you are using FAN, the FAN driver automatically aborts the dead session.</p>
</li>
<li>
<p>If it is a recoverable error, then Application Continuity uses Transaction Guard to determine the outcome of the dead session:</p>
<ol>
<li>
<p>Get the last LTXID from the dead session using the APIs provided by the client drivers: <code class="codeph">getLTXID</code> for JDBC, <code class="codeph">OCI_ATTR_GET</code> with LTXID for Oracle Call Interface, and <code class="codeph">LogicalTransactionId</code> for ODP.NET.</p>
</li>
<li>
<p>Obtain a new session.</p>
</li>
<li>
<p>Call the PL/SQL procedure <code class="codeph">GET_LTXID_OUTCOME</code> with the last LTXID obtained from the failed session.</p>
</li>
<li>
<p>If the outcome of the transaction is COMMITTED and COMPLETED, then return the result of that transaction to the application.</p>
</li>
<li>
<p>If the outcome of the transaction is COMMITTED and NOT USER_CALL_COMPLETED, then return COMMITTED and a warning that the user call was not completed.</p>
</li>
<li>
<p>If the outcome of the transaction is not COMMITTED, then, if needed, cleanup any state left behind from the last request and resubmit the last request.</p>
</li>
</ol>
</li>
</ol>
<div class="infoboxnotealso" id="GUID-619E639B-6C8E-49B6-8CB6-49DB1B3A8CAA__GUID-2E429E11-9280-402A-9DC4-E8E44BAAD178">
<p class="notep1">See Also:</p>
<p><a class="olink ADFNS8000" target="_blank" href="../ADFNS/adfns_trans_idemp_guard.htm#ADFNS8000"><span class="italic">Oracle Database Development Guide</span></a> for more information about Transaction Guard</p>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2593">
<tr>
<td class="cellalignment2600">
<table class="cellalignment2598">
<tr>
<td class="cellalignment2597"><a href="GUID-097A5067-8CCF-4FF0-B97B-BF109DFA1841.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2597"><a href="GUID-E3DA6FA0-B139-4877-83A1-FDE559AD5DFE.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2602">
<table class="cellalignment2596">
<tr>
<td class="cellalignment2597"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2597"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2597"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2597"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2597"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2597"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>