<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-87500"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Measuring%20Performance%20by%20Service%20Using%20the%20Automatic%20Workload%20Repository"></a><title>Measuring Performance by Service Using the Automatic Workload Repository</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="Automatic Workload Repository"/>
<meta name="dcterms.created" content="2017-07-10T13:15:22Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Real Application Clusters Administration and Deployment Guide"/>
<meta name="dcterms.identifier" content="E48838-12"/>
<meta name="dcterms.isVersionOf" content="RACAD"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="GUID-C3CD2DCE-38BD-46BA-BC32-7A28CAC9A7FD.htm" title="Previous" type="text/html"/>
<link rel="Next" href="GUID-27E6E869-570C-4B01-BF49-C147744D0D7D.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E48838-12.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-559FB230-857B-4D97-B36A-F4F76C3A1D47"></a> <span id="PAGE" style="display:none;">143/567</span> <!-- End Header -->
<a id="RACAD7127"></a>
<h1 id="RACAD-GUID-559FB230-857B-4D97-B36A-F4F76C3A1D47" class="sect1">Measuring Performance by Service Using the Automatic Workload Repository</h1>
<div>
<p>Services add a new dimension for performance tuning. With services, workloads are visible and measurable, and therefore resource consumption and wait times are attributable by application. Tuning by using &#34;service and SQL&#34; replaces tuning by &#34;session and SQL&#34; in the majority of systems where all sessions are anonymous and shared.</p>
<p>The AWR maintains performance statistics that include information about response time, throughput, resource consumption, and wait events for all services and work that a database performs. Oracle Database also maintains metrics, statistics, wait events, wait classes, and SQL-level traces for services. You can optionally augment these statistics by defining modules within your application to monitor certain statistics. You can also define the actions within those modules that business critical transactions should execute in response to particular statistical values.</p>
<p>Enable module and action monitoring using the <code class="codeph">DBMS_MONITOR</code> PL/SQL package. For example, for connections that use the <code class="codeph">erp</code> service, the following command enables monitoring for the <code class="codeph">exceptions pay</code> action in the <code class="codeph">payroll</code> module:</p>
<pre dir="ltr">EXECUTE DBMS_MONITOR.SERV_MOD_ACT_STAT_ENABLE(SERVICE_NAME =&gt; &#39;ERP&#39;, 
MODULE_NAME=&gt; &#39;PAYROLL&#39;, ACTION_NAME =&gt; &#39;EXCEPTIONS PAY&#39;);
</pre>
<p>For connections that use the <code class="codeph">erp</code> service, the following command enables monitoring for all actions in the <code class="codeph">payroll</code> module:</p>
<pre dir="ltr">EXECUTE DBMS_MONITOR.SERV_MOD_ACT_STAT_ENABLE(SERVICE_NAME =&gt; &#39;ERP&#39;, 
MODULE_NAME=&gt; &#39;PAYROLL&#39;, ACTION_NAME =&gt; NULL);
</pre>
<p>Use the <code class="codeph">DBA_ENABLED_AGGREGATIONS</code> view to verify that you have enabled monitoring for application modules and actions.</p>
<p>Statistics aggregation and tracing by service are global in scope for Oracle RAC databases. In addition, these statistic aggregations are persistent across instance restarts and service relocations for both Oracle RAC and noncluster Oracle databases.</p>
<p>The service, module, and action names are visible in <code class="codeph">V$SESSION</code>, <code class="codeph">V$ACTIVE_SESSION_HISTORY</code>, and <code class="codeph">V$SQL</code> views. The call times and performance statistics are visible in <code class="codeph">V$SERVICE_STATS</code>, <code class="codeph">V$SERVICE_EVENT</code>, <code class="codeph">V$SERVICE_WAIT_CLASS</code>, <code class="codeph">V$SERVICEMETRIC</code>, and <code class="codeph">V$SERVICEMETRIC_HISTORY</code>. When you enable statistics collection for an important transaction, you can see the call speed for each service, module, and action name at each database instance using the <code class="codeph">V$SERV_MOD_ACT_STATS</code> view.</p>
<p>The following sample SQL*Plus script provides service quality statistics for a five second interval. You can use these service quality statistics to monitor the quality of a service, to direct work, and to balance services across Oracle RAC instances:</p>
<pre dir="ltr">SET PAGESIZE 60 COLSEP &#39;|&#39; NUMWIDTH 8 LINESIZE 132 VERIFY OFF FEEDBACK OFF
COLUMN service_name FORMAT A20 TRUNCATED HEADING &#39;Service&#39;
COLUMN begin_time HEADING &#39;Begin Time&#39; FORMAT A10
COLUMN end_time HEADING &#39;End Time&#39; FORMAT A10
COLUMN instance_name HEADING &#39;Instance&#39; FORMAT A10
COLUMN service_time HEADING &#39;Service Time|mSec/Call&#39; FORMAT 999999999
COLUMN throughput HEADING &#39;Calls/sec&#39;FORMAT 99.99 
BREAK ON service_name SKIP 1 
SELECT 
    service_name 
  , TO_CHAR(begin_time, &#39;HH:MI:SS&#39;) begin_time 
  , TO_CHAR(end_time, &#39;HH:MI:SS&#39;) end_time 
  , instance_name 
  , elapsedpercall  service_time
  ,  callspersec  throughput
FROM  
    gv$instance i     
  , gv$active_services s     
  , gv$servicemetric m 
WHERE s.inst_id = m.inst_id  
  AND s.name_hash = m.service_name_hash
  AND i.inst_id = m.inst_id
  AND m.group_id = 10
ORDER BY
   service_name
 , i.inst_id
 , begin_time ;
</pre></div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2593">
<tr>
<td class="cellalignment2600">
<table class="cellalignment2598">
<tr>
<td class="cellalignment2597"><a href="GUID-C3CD2DCE-38BD-46BA-BC32-7A28CAC9A7FD.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2597"><a href="GUID-27E6E869-570C-4B01-BF49-C147744D0D7D.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2602">
<table class="cellalignment2596">
<tr>
<td class="cellalignment2597"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2597"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2597"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2597"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2597"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2597"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>