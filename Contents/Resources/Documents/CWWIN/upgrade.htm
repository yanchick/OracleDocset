<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-5088"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/How%20to%20Upgrade%20to%20Oracle%20Grid%20Infrastructure%2012c%20Release%201"></a><title>How to Upgrade to Oracle Grid Infrastructure 12c Release 1</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="description" content="This appendix describes how to perform Oracle Clusterware and Oracle Automatic Storage Management (Oracle ASM) upgrades."/>
<meta name="keywords" content="recommendations, backing up Oracle software, Windows registry, backing up, upgrades, Oracle ASM, upgrading, OCFS for Windows, restrictions, checkdir error, errors using Opatch, Opatch, commands, crsctl, srvctl, Cluster Verification Utility (CVU), and upgrades, unsetting environment variables, unset installation owners environment variables, troubleshooting, installation owner environment variables and installation errors, groups of nodes, batches, batch upgrades, Oracle Enterprise Manager, updating configuration files after upgrade"/>
<meta name="dcterms.created" content="2017-07-05T01:57:42Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Oracle Grid Infrastructure Installation Guide"/>
<meta name="dcterms.identifier" content="E49041-08"/>
<meta name="dcterms.isVersionOf" content="CWWIN"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2012, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="concepts.htm" title="Previous" type="text/html"/>
<link rel="Next" href="index.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E49041-08.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-2E704542-1B46-4002-B2F0-08358D62ED99"></a> <span id="PAGE" style="display:none;">19/20</span> <!-- End Header -->
<h1 id="CWWIN-GUID-2E704542-1B46-4002-B2F0-08358D62ED99" class="sect1"><span class="enumeration_chapter">D</span> How to Upgrade to Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1</h1>
<div>
<p>This appendix describes how to perform Oracle Clusterware and Oracle Automatic Storage Management (Oracle ASM) upgrades.</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-92296F6E-7356-4185-BACD-2F9BB41C7933">Back Up the Oracle Software Before Upgrades</a></strong><br/>
Without a valid backup, you will not be able to restore the Oracle software to a working state if the upgrade of Oracle Grid Infrastructure or Oracle Database fails and you want to revert to the previous software installation.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-E26CDD04-F9F1-4300-A2D6-73BDB3B49ECC">About Oracle Grid Infrastructure and Oracle ASM Upgrade and Downgrade</a></strong><br/>
There are different methods you can use to upgrade the Oracle Grid Infrastructure software.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-50B211E0-BD30-4E51-8304-7E22D74C7E93">Options for Oracle Clusterware and Oracle ASM Upgrades and Downgrades</a></strong><br/>
There are different options for upgrading and dowgrading your installation, depending on which previous version of Oracle Grid Infrastructure you currently use.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-84A58462-CFAF-4317-B792-688ACC53A807">Restrictions and Guidelines for Oracle Grid Infrastructure Upgrades</a></strong><br/>
Oracle recommends that you use CVU to check if there are any patches required for upgrading your existing Oracle Grid Infrastructure 11<span class="italic">g</span> Release 2 or Oracle RAC 11<span class="italic">g</span> Release 2 installations.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-63A647F2-D6CD-4982-AF4B-15419A636A75">Understanding Out-of-Place and Rolling Upgrades</a></strong><br/>
All upgrades are out-of-place upgrades, meaning that the software binaries are placed in a different Grid home from the Grid home used for the prior release. You can also perform the upgrade in a rolling manner, which means there is always at least one cluster node operational during the upgrade.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-E7FD4A1F-EAB4-4BF5-942F-6CD50E44779C">Preparing to Upgrade an Existing Oracle Clusterware Installation</a></strong><br/>
If you have an existing Oracle Clusterware installation, then you upgrade your existing cluster by performing an out-of-place upgrade. You cannot perform an in-place upgrade.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-3C4FF02C-26B6-40BF-A8CC-843EA5CA232E">Using CVU to Validate Readiness for Oracle Clusterware Upgrades</a></strong><br/>
You can use Cluster Verification Utility (CVU) to assist you with system checks in preparation for starting an upgrade. CVU runs the appropriate system checks automatically, and prompts you to fix problems before proceeding with the upgrade.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-473F76FA-4909-4239-B05F-8E3D783C71A7">Understanding Rolling Upgrades Using Batches</a></strong><br/>
Instead of shutting down all nodes when applying patches, you can shut down some nodes while other nodes remaining running.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-739DD3C6-B845-4A5F-A3A9-00794F17961F">Performing Rolling Upgrades of Oracle Grid Infrastructure</a></strong><br/>
Review this information to perform rolling upgrade of Oracle Grid Infrastructure.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-95FFB620-167A-440A-AE32-9AA953971ABE">Performing Rolling Upgrades of Oracle ASM</a></strong><br/>
After you have completed the Oracle Clusterware portion of Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1) upgrade, you may need to upgrade Oracle ASM separately if the Oracle ASM portion of the Oracle Grid Infrastructure upgrade failed, or for some other reason Automatic Storage Management Configuration assistant (ASMCA) did not run.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-AA350A26-1D33-488B-8899-8677DE1EC5F5">Applying Patches to Oracle ASM</a></strong><br/>
After you have upgraded Oracle ASM with Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1, you can install individual patches for Oracle ASM by downloading them from My Oracle Support.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-D088CC2A-F91D-4EF6-981F-DB751E92ED49">Checking Cluster Health Monitor Repository Size After Upgrading</a></strong><br/>
If you are upgrading from a prior release using IPD/OS to Oracle Grid Infrastructure 11<span class="italic">g</span> Release 2 (11.2.0.2 and later), then you should review the Cluster Health Monitor repository size (the CHM repository).</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-89920A40-EE9D-4162-9326-C2509189534F">Downgrading Oracle Clusterware After an Upgrade</a></strong><br/>
After a successful or a failed upgrade to Oracle Clusterware 12<span class="italic">c</span> Release 1 (12.1), you can restore Oracle Clusterware to the earlier release.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-93A77770-6732-4760-9160-6069998852F1">Updating Oracle Enterprise Manager Cloud Control Target Parameters</a></strong><br/>
Because the Oracle Clusterware upgrade is an out-of-place upgrade, the upgraded software has a new location for the Grid home. The path for the Oracle Clusterware home in some Oracle Enterprise Manager parameter files must be changed.</li>
</ul>
</div>
<div class="sect2"><a id="GUID-92296F6E-7356-4185-BACD-2F9BB41C7933"></a>
<h2 id="CWWIN-GUID-92296F6E-7356-4185-BACD-2F9BB41C7933" class="sect2"><span class="enumeration_section">D.1</span> Back Up the Oracle Software Before Upgrades</h2>
<div>
<p>Without a valid backup, you will not be able to restore the Oracle software to a working state if the upgrade of Oracle Grid Infrastructure or Oracle Database fails and you want to revert to the previous software installation.</p>
<ul>
<li class="stepexpand"><span>Before you make any changes to the Oracle software, Oracle recommends that you create a backup of the Oracle software and databases.</span></li>
<li class="stepexpand"><span>For Oracle software running on Windows operating systems, you must also take a backup of the Windows registry.</span>
<div>Without a registry backup, you will not be able to restore the Oracle software to a working state if the upgrade of Oracle Grid Infrastructure or Oracle Database fails and you want to revert to the previous software installation.</div>
</li>
</ul>
</div>
</div>
<div class="sect2"><a id="GUID-E26CDD04-F9F1-4300-A2D6-73BDB3B49ECC"></a>
<h2 id="CWWIN-GUID-E26CDD04-F9F1-4300-A2D6-73BDB3B49ECC" class="sect2"><span class="enumeration_section">D.2</span> About Oracle Grid Infrastructure and Oracle ASM Upgrade and Downgrade</h2>
<div>
<p>There are different methods you can use to upgrade the Oracle Grid Infrastructure software.</p>
<p>You can upgrade Oracle Grid Infrastructure in any of the following ways:</p>
<ul style="list-style-type: disc;">
<li>
<p>Rolling Upgrade: Involves upgrading individual nodes without stopping Oracle Grid Infrastructure on other nodes in the cluster</p>
</li>
<li>
<p>Non-Rolling Upgrade: Involves bringing down all the nodes except one. A complete cluster outage occurs while the root script stops the old Oracle Clusterware stack and starts the new Oracle Clusterware stack on the node where you initiate the upgrade. After upgrade is completed, the new Oracle Clusterware is started on all the nodes.</p>
</li>
</ul>
<p>Note that some services are disabled when one or more nodes are in the process of being upgraded. All upgrades are <span class="bold">out-of-place upgrades</span>, meaning that the software binaries are placed in a different Grid home from the Grid home used for the prior release.</p>
<p>You can downgrade from Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1) to prior releases of Oracle Grid Infrastructure. Be aware that if you downgrade to a prior release, then your cluster must conform with the configuration requirements for that prior release, and the features available for the cluster consist only of the features available for that prior release of Oracle Clusterware and Oracle ASM.</p>
<p>If you have an existing Oracle ASM 11<span class="italic">g</span> Release 1 (11.1) or Oracle ASM 10<span class="italic">g</span> instance, with Oracle ASM in a separate home, then you can either upgrade it at the time that you install Oracle Grid Infrastructure, or you can upgrade it after the installation, using Oracle ASM Configuration Assistant (ASMCA). Note that a number of Oracle ASM features are disabled until you upgrade Oracle ASM. Also, Oracle Clusterware management of Oracle ASM does not function correctly until Oracle ASM is upgraded, because Oracle Clusterware only manages Oracle ASM when it is running in the Oracle Grid Infrastructure home. For this reason, Oracle recommends that if you do not upgrade Oracle ASM at the same time as you upgrade Oracle Clusterware, then you should upgrade Oracle ASM immediately afterward. This issue does not apply to Oracle ASM 11<span class="italic">g</span> Release 2 (11.2) and later releases, because the Oracle ASM executable files are stored in the Oracle Grid Infrastructure home for those releases.</p>
<p>You can perform out-of-place upgrades to an Oracle ASM instance using ASMCA. In addition to running ASMCA using the graphical user interface (GUI), you can run ASMCA in non-interactive (silent) mode.</p>
<div class="infobox-note" id="GUID-E26CDD04-F9F1-4300-A2D6-73BDB3B49ECC__GUID-3E361DD1-7DD1-4D5F-83B7-DDEBF292F9A9">
<p class="notep1">Note:</p>
If you are currently using OCFS for Windows as your shared storage, then you must migrate to using Oracle ASM during the upgrade of Oracle Database and Oracle Grid Infrastructure.</div>
<div class="infobox-note" id="GUID-E26CDD04-F9F1-4300-A2D6-73BDB3B49ECC__GUID-55494BA2-8891-4454-8F5A-8BD6CE578F1A">
<p class="notep1">Note:</p>
You must complete an upgrade before attempting to use cluster backup files. You cannot use backups for a cluster that has not completed the upgrade.</div>
<div class="infoboxnotealso" id="GUID-E26CDD04-F9F1-4300-A2D6-73BDB3B49ECC__GUID-44C9A16C-0308-4741-B272-59A02870A566">
<p class="notep1">See Also:</p>
<a class="olink UPGRD" target="_blank" href="../UPGRD/toc.htm"><span class="italic">Oracle Database Upgrade Guide</span></a> and <a class="olink OSTMG02400" target="_blank" href="../OSTMG/GUID-383A26A4-AB4E-458B-AF6A-C9DA5E15AD2A.htm#OSTMG02400"><span class="italic">Oracle Automatic Storage Management Administrator&#39;s Guide</span></a> for additional information about upgrading existing Oracle ASM installations</div>
</div>
</div>
<div class="sect2"><a id="GUID-50B211E0-BD30-4E51-8304-7E22D74C7E93"></a>
<h2 id="CWWIN-GUID-50B211E0-BD30-4E51-8304-7E22D74C7E93" class="sect2"><span class="enumeration_section">D.3</span> Options for Oracle Clusterware and Oracle ASM Upgrades and Downgrades</h2>
<div>
<p>There are different options for upgrading and dowgrading your installation, depending on which previous version of Oracle Grid Infrastructure you currently use.</p>
<div class="section">
<p class="subhead2">Upgrade Options from Oracle Grid Infrastructure 11<span class="italic">g</span> to Oracle Grid Infrastructure 12<span class="italic">c</span></p>
<p>Upgrade options from Oracle Grid Infrastructure 11<span class="italic">g</span> to Oracle Grid Infrastructure 12<span class="italic">c</span> include the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>Oracle Grid Infrastructure rolling upgrades, with OCR and voting files on Oracle ASM</p>
</li>
<li>
<p>Oracle Grid Infrastructure complete cluster (downtime, non-rolling), with OCR and voting files on Oracle ASM</p>
</li>
<li>
<p>Oracle Grid Infrastructure rolling upgrades with OCR and voting files on storage other than Oracle ASM</p>
</li>
<li>
<p>Oracle Grid Infrastructure complete cluster (downtime, non-rolling), with OCR and voting files on storage other than Oracle ASM</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Upgrade Options from Releases Before Oracle Grid Infrastructure 11<span class="italic">g</span> Release 2 (11.2)</p>
<p>Upgrade options from releases before Oracle Grid Infrastructure 11<span class="italic">g</span> Release 2 (11.2) to Oracle Grid Infrastructure 12<span class="italic">c</span> include the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>Oracle Grid Infrastructure rolling upgrades, with OCR and voting files on storage other than Oracle ASM</p>
</li>
<li>
<p>Oracle Grid Infrastructure complete cluster (downtime, non-rolling), with OCR and voting files on storage other than Oracle ASM</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Downgrade Options from Oracle Grid Infrastructure 12<span class="italic">c</span> to Earlier Releases</p>
<p>Downgrade options from Oracle Grid Infrastructure 12<span class="italic">c</span> to earlier releases include the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>Oracle Grid Infrastructure downgrade to Oracle Grid Infrastructure 11<span class="italic">g</span> Release 2 (11.2)</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<div class="sect2"><a id="GUID-84A58462-CFAF-4317-B792-688ACC53A807"></a>
<h2 id="CWWIN-GUID-84A58462-CFAF-4317-B792-688ACC53A807" class="sect2"><span class="enumeration_section">D.4</span> Restrictions and Guidelines for Oracle Grid Infrastructure Upgrades</h2>
<div>
<p>Oracle recommends that you use CVU to check if there are any patches required for upgrading your existing Oracle Grid Infrastructure 11<span class="italic">g</span> Release 2 or Oracle RAC 11<span class="italic">g</span> Release 2 installations.</p>
<div class="infoboxnotealso" id="GUID-84A58462-CFAF-4317-B792-688ACC53A807__GUID-168757C1-236A-4B46-8B22-08BC29A0F53D">
<p class="notep1">See Also:</p>
<span class="q">&#34;<a href="upgrade.htm#GUID-3C4FF02C-26B6-40BF-A8CC-843EA5CA232E" title="You can use Cluster Verification Utility (CVU) to assist you with system checks in preparation for starting an upgrade. CVU runs the appropriate system checks automatically, and prompts you to fix problems before proceeding with the upgrade.">Using CVU to Validate Readiness for Oracle Clusterware Upgrades</a>&#34;</span></div>
<p>Be aware of the following restrictions and changes for upgrades to Oracle Grid Infrastructure installations, which consists of Oracle Clusterware and Oracle ASM:</p>
<ul style="list-style-type: disc;">
<li>
<p>If the OCR and Voting File locations for your current installation are on raw devices, then you must migrate them to Oracle ASM disk groups or shared file systems before upgrading to Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1).</p>
</li>
<li>
<p>To upgrade existing Oracle Clusterware installations to Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1), your current release must be Oracle Grid Infrastructure 11<span class="italic">g</span> Release 2.</p>
</li>
<li>
<p>On the Windows platform, to upgrade Oracle Clusterware from releases 10.2.0.5 and 11.1.0.7 to Oracle Grid Infrastructure release 12.1, you must perform an interim upgrade to Oracle Grid Infrastructure 11<span class="italic">g</span> Release 2 for Oracle Clusterware. After upgrading Oracle Clusterware to Oracle Grid Infrastructure 11<span class="italic">g</span> Release 2, you must move the Oracle Cluster Registry (OCR) and voting files to Oracle ASM. You can then upgrade Oracle Grid Infrastructure 11<span class="italic">g</span> Release 2 to Oracle Grid Infrastructure release 12.1.</p>
</li>
<li>
<p>If you are upgrading an Oracle Database release 10.2.0.5 or Oracle Database release 11.1.0.7 environment that stores Oracle Clusterware files on OCFS for Windows or RAW devices, then you cannot directly upgrade to Oracle Database 12<span class="italic">c</span>. See <a class="olink UPGRD60021" target="_blank" href="../UPGRD/deprecated.htm#UPGRD60021"><span class="italic">Oracle Database Upgrade Guide</span></a>.</p>
</li>
<li>
<p>To upgrade existing Oracle ASM installations to Oracle Grid Infrastructure 12c Release 1 (12.1), in a Standard configuration, your release must be greater than or equal to 10.1.0.5, 10.2.0.3, 11.1.0.6, or 11.2.</p>
</li>
<li>
<p>To upgrade existing Oracle Grid Infrastructure installations to Oracle Grid Infrastructure, you must first verify if you need to apply any mandatory patches for upgrade to succeed. To upgrade Oracle Grid Infrastructure installations from 11.2.0.2 to a later release, you must install the latest bundle for the cumulative patches for Oracle Grid Infrastructure (Patch 11 bundle or higher). See <a href="upgrade.htm#GUID-3C4FF02C-26B6-40BF-A8CC-843EA5CA232E" title="You can use Cluster Verification Utility (CVU) to assist you with system checks in preparation for starting an upgrade. CVU runs the appropriate system checks automatically, and prompts you to fix problems before proceeding with the upgrade.">Using CVU to Validate Readiness for Oracle Clusterware Upgrades</a> for steps to check readiness.</p>
<div class="infoboxnotealso" id="GUID-84A58462-CFAF-4317-B792-688ACC53A807__GUID-CE6DF590-A53B-4689-ADAE-B3B0C36C561C">
<p class="notep1">See Also:</p>
<p>Oracle 12<span class="italic">c</span> Upgrade Companion (My Oracle Support Note 1462240.1): <a href="https://support.oracle.com/oip/faces/secure/km/DocumentDisplay.jspx?id=1462240.1" target="_blank">https://support.oracle.com/oip/faces/secure/km/DocumentDisplay.jspx?id=1462240.1</a></p>
</div>
</li>
<li>
<p>Do not delete directories in the Grid home. For example, do not delete <span class="variable">Grid_home</span>\Opatch. If you delete the directory, then the Oracle Installation User for Oracle Grid Infrastructure cannot use Opatch to patch the Grid home, and Opatch displays the error &#34;<samp class="msgph">checkdir error: cannot create <span class="variable">Grid_home</span>\OPatch</samp>&#34;</p>
</li>
<li>
<p>Oracle Clusterware and Oracle ASM upgrades are always out-of-place upgrades. With Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1), you cannot perform an in-place upgrade of Oracle Clusterware and Oracle ASM to existing homes.</p>
</li>
<li>
<p>With Oracle Clusterware 11<span class="italic">g</span> Release 2 (11.2) and later, you can perform upgrades on a shared Oracle Clusterware home.</p>
</li>
<li>
<p>You must use an Administrator user to perform the Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1) upgrade.</p>
</li>
<li>
<p>Oracle ASM and Oracle Clusterware both run in the Oracle Grid Infrastructure home.</p>
</li>
<li>
<p>During a major release upgrade to Oracle Clusterware 12<span class="italic">c</span> Release 1 (12.1), the software in the Grid home for Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1) is not fully functional until the upgrade is completed. Running the Server Control Utility (SRVCTL), crsctl, and other commands from the 12<span class="italic">c</span> Release 1 (12.1) Grid home is not supported until the upgrade is complete across all nodes.</p>
<p>To manage databases using earlier releases (release 10.x, 11.1, or 11.2) of Oracle Database software during the Oracle Grid Infrastructure upgrade, use SRVCTL in the existing database homes.</p>
</li>
<li>
<p>During Oracle Clusterware installation, if there is a single instance Oracle ASM release on the local node, then it is converted to a clustered Oracle ASM 12<span class="italic">c</span> Release 1 (12.1) installation, and Oracle ASM runs in the Oracle Grid Infrastructure home on all nodes.</p>
</li>
<li>
<p>If a single instance (non-clustered) Oracle ASM installation is on a remote node, which is a node other than the local node (the node on which the Oracle Grid Infrastructure installation is being performed), then it will remain a single instance Oracle ASM installation. However, during installation, if you select to place the Oracle Cluster Registry (OCR) and voting files on Oracle ASM, then a clustered Oracle ASM installation is created on all nodes in the cluster, and the single instance Oracle ASM installation on the remote node will become nonfunctional.</p>
</li>
<li>
<p>Before you can create an Oracle Database 12<span class="italic">c</span> release 1 (12.1.0.1) database that uses Oracle ASM release 12.1.0.2 for storage, you must apply the patch for bug 19168335.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-84A58462-CFAF-4317-B792-688ACC53A807__GUID-9078713B-FD7F-4BE5-99D3-5D6C46FA1D18">
<p class="notep1">See Also:</p>
<a class="olink UPGRD" target="_blank" href="../UPGRD/toc.htm"><span class="italic">Oracle Database Upgrade Guide</span></a></div>
</div>
</div>
<div class="sect2"><a id="GUID-63A647F2-D6CD-4982-AF4B-15419A636A75"></a>
<h2 id="CWWIN-GUID-63A647F2-D6CD-4982-AF4B-15419A636A75" class="sect2"><span class="enumeration_section">D.5</span> Understanding Out-of-Place and Rolling Upgrades</h2>
<div>
<p>All upgrades are out-of-place upgrades, meaning that the software binaries are placed in a different Grid home from the Grid home used for the prior release. You can also perform the upgrade in a rolling manner, which means there is always at least one cluster node operational during the upgrade.</p>
<div class="section">
<p class="subhead2">Rolling Upgrades</p>
<p>You can upgrade Oracle Grid Infrastructure either by bringing the cluster down and upgrading the complete cluster, or upgrading individual nodes without stopping Oracle Grid Infrastructure on other nodes in the cluster, which is called performing a rolling upgrade. If you upgrade a subset of nodes, then a software-only installation is performed on the existing cluster nodes that you do not select for upgrade. Rolling upgrades avoid downtime and ensure continuous availability while the software is upgraded to a new release.</p>
<div class="infobox-note" id="GUID-63A647F2-D6CD-4982-AF4B-15419A636A75__GUID-E49E8305-E011-4D76-A0ED-1A636A1CE1AE">
<p class="notep1">Note:</p>
In contrast with releases prior to Oracle Clusterware 11<span class="italic">g</span> Release 2, Oracle Universal Installer (OUI) always performs rolling upgrades, even if you select all nodes for the upgrade.</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Out-of-Place Upgrades</p>
<p>During an out-of-place upgrade, the installer installs the newer release in a separate Oracle Clusterware home. Both releases of Oracle Clusterware are on each cluster member node, but only one release is active. By contrast, an in-place upgrade overwrites the software in the current Oracle Clusterware home.</p>
<p>To perform an out-of-place upgrade, you must create new Oracle Grid Infrastructure homes on each node. Then you can perform an out-of-place rolling upgrade, so that some nodes run Oracle Clusterware from the original Oracle Clusterware home, and other nodes run Oracle Clusterware from the new Oracle Grid Infrastructure home.</p>
<p>If you have an existing Oracle Clusterware installation, then you upgrade your existing cluster by performing an out-of-place upgrade. An in-place upgrade of Oracle Clusterware is not supported.</p>
</div>
<!-- class="section" --></div>
<div>
<div class="relinfo">
<p><strong>Related Topics</strong></p>
<ul>
<li><a href="upgrade.htm#GUID-739DD3C6-B845-4A5F-A3A9-00794F17961F">Performing Rolling Upgrades of Oracle Grid Infrastructure</a></li>
</ul>
</div>
</div>
</div>
<div class="sect2"><a id="GUID-E7FD4A1F-EAB4-4BF5-942F-6CD50E44779C"></a>
<h2 id="CWWIN-GUID-E7FD4A1F-EAB4-4BF5-942F-6CD50E44779C" class="sect2"><span class="enumeration_section">D.6</span> Preparing to Upgrade an Existing Oracle Clusterware Installation</h2>
<div>
<p>If you have an existing Oracle Clusterware installation, then you upgrade your existing cluster by performing an out-of-place upgrade. You cannot perform an in-place upgrade.</p>
<p>Complete the following tasks before starting an upgrade:</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-6E2706A9-9AED-4B18-B093-226DDCA60132">Verify System Readiness for Patches and Upgrades</a></strong><br/>
Use the Release Notes and Cluster Verification Utility to make sure you are ready to patch or upgrade your software.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-3BC676CD-2854-4426-BC55-FADF1598DD1C">Gather the Necessary System Information</a></strong><br/>
Ensure that you have the information you will need when installing Oracle Grid Infrastructure into a new home directory.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-087BE6EC-A656-47E2-975C-018D9D59D9C6">Upgrade to the Minimum Required Oracle Clusterware Release</a></strong><br/>
If your current Oracle Clusterware installation is not currently running at least the minimum supported release, then a prerequisite check failure is reported. You must upgrade your current Oracle Clusterware installation to at least the minimum supported release before upgrading.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-83613042-4E0D-48FE-8FF6-63FDFD63E580">Unset Environment Variables Used By Oracle Software</a></strong><br/>
If you have had an existing installation on your system, and you are using the same user account to install Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1), then for the Oracle installation user you must unset environment variables that are connected with Oracle software homes.</li>
</ul>
</div>
<div class="sect3"><a id="GUID-6E2706A9-9AED-4B18-B093-226DDCA60132"></a>
<h3 id="CWWIN-GUID-6E2706A9-9AED-4B18-B093-226DDCA60132" class="sect3"><span class="enumeration_section">D.6.1</span> Verify System Readiness for Patches and Upgrades</h3>
<div>
<p>Use the Release Notes and Cluster Verification Utility to make sure you are ready to patch or upgrade your software.</p>
<ol>
<li class="stepexpand"><span>If you are completing a patch update of Oracle Clusterware or Oracle ASM, then after you download the patch software and before you start to patch or upgrade your software installation, review the Patch Set Release Notes that accompany the patch to determine if your system meets the system requirements for the operating system and the hardware.</span></li>
<li class="stepexpand"><span>Use the Cluster Verification Utility (CVU) to assist you with system checks in preparation for patching or upgrading.</span>
<div>You can run CVU before starting the upgrade, however, the installer runs the appropriate CVU checks automatically, and prompts you to fix problems before proceeding with the upgrade.</div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-6E2706A9-9AED-4B18-B093-226DDCA60132__GUID-8E849F12-AFB1-4BB5-A43F-4104099CAF63">
<p class="notep1">See Also:</p>
<a class="olink UPGRD" target="_blank" href="../UPGRD/toc.htm"><span class="italic">Oracle Database Upgrade Guide</span></a></div>
</div>
<!-- class="section" --></div>
</div>
<div class="sect3"><a id="GUID-3BC676CD-2854-4426-BC55-FADF1598DD1C"></a>
<h3 id="CWWIN-GUID-3BC676CD-2854-4426-BC55-FADF1598DD1C" class="sect3"><span class="enumeration_section">D.6.2</span> Gather the Necessary System Information</h3>
<div>
<p>Ensure that you have the information you will need when installing Oracle Grid Infrastructure into a new home directory.</p>
<ul>
<li class="stepexpand"><span>Gather the following information:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p>The Oracle base location for Oracle Clusterware</p>
</li>
<li>
<p>An Oracle Grid Infrastructure home location that is different from your existing Oracle Clusterware home (or Grid home) location</p>
</li>
<li>
<p>SCAN name and addresses, and other network addresses, as described in <span class="q">&#34;<a href="networks.htm#GUID-D2DBE962-555F-4577-BC16-CF15180E423C" title="Check that you have the networking hardware and internet protocol (IP) addresses required for an Oracle Grid Infrastructure for a cluster installation.">Configuring Networks for Oracle Grid Infrastructure and Oracle RAC</a>&#34;</span></p>
</li>
<li>
<p>Privileged user operating system groups to use, as described in <span class="q">&#34;<a href="usrgrps.htm#GUID-59B00D90-F2DE-4D52-AFA2-5889AA771EB0" title="To install Oracle Grid Infrastructure and Oracle RAC, you must have an installation user and optionally an Oracle Home User.">Creating Installation Groups and Users for Oracle Grid Infrastructure and Oracle RAC</a>&#34;</span></p>
</li>
<li>
<p>Local Administrator user access, or access as the user who performed the previous Oracle Clusterware installation</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3"><a id="GUID-087BE6EC-A656-47E2-975C-018D9D59D9C6"></a>
<h3 id="CWWIN-GUID-087BE6EC-A656-47E2-975C-018D9D59D9C6" class="sect3"><span class="enumeration_section">D.6.3</span> Upgrade to the Minimum Required Oracle Clusterware Release</h3>
<div>
<p>If your current Oracle Clusterware installation is not currently running at least the minimum supported release, then a prerequisite check failure is reported. You must upgrade your current Oracle Clusterware installation to at least the minimum supported release before upgrading.</p>
<div class="section">To upgrade existing Oracle Clusterware installations to a standard configuration Oracle Grid Infrastructure 12<span class="italic">c</span> cluster, your release must be greater than or equal to Oracle Clusterware 10<span class="italic">g</span> Release 1 (10.1.0.5), Oracle Clusterware 10<span class="italic">g</span> Release 2 (10.2.0.3), Oracle Grid Infrastructure 11<span class="italic">g</span> Release 1 (11.1.0.6), or Oracle Grid Infrastructure 11<span class="italic">g</span> Release 2 (11.2.0.2) or later.</div>
<!-- class="section" -->
<ul>
<li class="stepexpand"><span>Upgrade your current Oracle Clusterware installation to at least the minimum supported release before upgrading to Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1.</span>
<div>For example, if you plan to upgrade your Oracle Clusterware 11<span class="italic">g</span> Release 1 installation to Oracle Clusterware 12<span class="italic">c</span> Release 1 (12.1) and your current Oracle Clusterware installation is release 11.1.0.2, then you must upgrade your current Oracle Clusterware installation to release 11.1.0.6 or higher before starting the upgrade.</div>
</li>
</ul>
</div>
</div>
<div class="sect3"><a id="GUID-83613042-4E0D-48FE-8FF6-63FDFD63E580"></a>
<h3 id="CWWIN-GUID-83613042-4E0D-48FE-8FF6-63FDFD63E580" class="sect3"><span class="enumeration_section">D.6.4</span> Unset Environment Variables Used By Oracle Software</h3>
<div>
<p>If you have had an existing installation on your system, and you are using the same user account to install Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1), then for the Oracle installation user you must unset environment variables that are connected with Oracle software homes.</p>
<div class="section">
<p>Before upgrading, you must unset the following environment variables:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">ORACLE_BASE</code></p>
</li>
<li>
<p><code class="codeph">ORACLE_HOME</code></p>
</li>
<li>
<p><code class="codeph">ORACLE_SID</code></p>
</li>
<li>
<p><code class="codeph">ORA_NLS10</code></p>
</li>
<li>
<p><code class="codeph">TNS_ADMIN</code></p>
</li>
<li>
<p><code class="codeph">ORA_CRS_HOME</code></p>
</li>
</ul>
<p>If you have set <code class="codeph">ORA_CRS_HOME</code> as an environment variable, following instructions from Oracle Support, then unset it before starting an installation or upgrade. You should <span class="italic">never</span> use <code class="codeph">ORA_CRS_HOME</code> as an environment variable except under explicit direction from Oracle Support.</p>
</div>
<!-- class="section" -->
<ol>
<li><span>From the Start menu, right click <span class="bold">My Computer</span> and select <span class="bold">Properties</span>.</span></li>
<li><span>In the System Properties window, select <span class="bold">Advanced</span>, then click the <span class="bold">Environment Variables</span> button.</span></li>
<li><span>To unset an environment variable, select the variable then click <span class="bold">Delete</span>.</span></li>
<li><span>When finished unsetting the environment variables, click <span class="bold">OK</span>.</span></li>
<li><span>Check to ensure that the user profile for the Oracle Installation User does not set any of these environment variables.</span></li>
</ol>
</div>
</div>
</div>
<div class="sect2"><a id="GUID-3C4FF02C-26B6-40BF-A8CC-843EA5CA232E"></a>
<h2 id="CWWIN-GUID-3C4FF02C-26B6-40BF-A8CC-843EA5CA232E" class="sect2"><span class="enumeration_section">D.7</span> Using CVU to Validate Readiness for Oracle Clusterware Upgrades</h2>
<div>
<p>You can use Cluster Verification Utility (CVU) to assist you with system checks in preparation for starting an upgrade. CVU runs the appropriate system checks automatically, and prompts you to fix problems before proceeding with the upgrade.</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-B3DD12B3-F9E6-4172-A430-105E8B4A7062">About the CVU Grid Upgrade Validation Command Options</a></strong><br/>
You can use the Cluster Verification Utility (CVU) to validate your system readiness before upgrading.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-3B79AC65-D02B-4369-B679-3B641CDE3F6B">Example of Verifying System Upgrade Readiness for Grid Infrastructure</a></strong><br/>
You can use the <code class="codeph">runcluvfy.bat</code> command to check your system before upgrading.</li>
</ul>
<div class="infoboxnotealso" id="GUID-3C4FF02C-26B6-40BF-A8CC-843EA5CA232E__GUID-61627C9F-B8F9-44D5-824C-EECA983BD4F7">
<p class="notep1">See Also:</p>
<a class="olink UPGRD" target="_blank" href="../UPGRD/toc.htm"><span class="italic">Oracle Database Upgrade Guide</span></a></div>
</div>
<div class="sect3"><a id="GUID-B3DD12B3-F9E6-4172-A430-105E8B4A7062"></a>
<h3 id="CWWIN-GUID-B3DD12B3-F9E6-4172-A430-105E8B4A7062" class="sect3"><span class="enumeration_section">D.7.1</span> About the CVU Grid Upgrade Validation Command Options</h3>
<div>
<p>You can use the Cluster Verification Utility (CVU) to validate your system readiness before upgrading.</p>
<p>You can run upgrade validations in one of two ways:</p>
<ul style="list-style-type: disc;">
<li>
<p>Run OUI, and allow the CVU validation built into OUI to perform system checks</p>
</li>
<li>
<p>Run the CVU manual script <code class="codeph">cluvfy.bat</code> script to perform system checks</p>
</li>
</ul>
<p>To use OUI to perform pre-install checks, run the installation as you normally would. OUI starts CVU, and performs system checks as part of the installation process. Selecting OUI to perform these checks is particularly appropriate if you think you have completed preinstallation checks, and you want to confirm that your system configuration meets minimum requirements for installation.</p>
<p>To use the <code class="codeph">cluvfy.bat</code> command-line script for CVU, navigate to the staging area for the upgrade, where the <code class="codeph">runcluvfy.bat</code> command is located, and run the following command to check the readiness of your Oracle Clusterware installation for upgrades:</p>
<pre dir="ltr">runcluvfy.bat stage -pre crsinst -upgrade
</pre>
<p>Running <code class="codeph">runcluvfy.bat</code> with the <code class="codeph">-pre crsinst -upgrade</code> options performs system checks to confirm if the cluster is in a correct state for upgrading from an existing clusterware installation.</p>
<p>The <code class="codeph">runcluvfy</code> command uses the following syntax, where variable content is indicated by italics:</p>
<pre dir="ltr">runcluvfy.bat stage -pre crsinst -upgrade [-rolling] -src_crshome 
<span class="variable">src_Gridhome</span> -dest_crshome <span class="variable">dest_Gridhome</span> -dest_version <span class="variable">dest_release</span>
[-verbose]
</pre>
<p>The options are:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">-rolling</code></p>
<p>Use this option to verify readiness for rolling upgrades.</p>
</li>
<li>
<p><code class="codeph">-src_crshome <span class="variable">src_Gridhome</span></code></p>
<p>Use this option to indicate the location of the source Oracle Clusterware or Grid home that you are upgrading, where <span class="variable">src_Gridhome</span> is the path to the home to upgrade.</p>
</li>
<li>
<p><code class="codeph">-dest_crshome <span class="variable">dest_Gridhome</span></code></p>
<p>Use this option to indicate the location of the upgrade Grid home, where <span class="variable">dest_Gridhome</span> is the path to the Grid home.</p>
</li>
<li>
<p><code class="codeph">-dest_version <span class="variable">dest_release</span></code></p>
<p>Use the <code class="codeph">dest_version</code> option to indicate the release number of the upgrade, including any patchset. The release number must include the five digits designating the release to the level of the platform-specific patch. For example: 12.1.0.1.0.</p>
</li>
<li>
<p><code class="codeph">-verbose</code></p>
<p>Use the <code class="codeph">-verbose</code> option to produce detailed output of individual checks</p>
</li>
</ul>
</div>
</div>
<div class="sect3"><a id="GUID-3B79AC65-D02B-4369-B679-3B641CDE3F6B"></a>
<h3 id="CWWIN-GUID-3B79AC65-D02B-4369-B679-3B641CDE3F6B" class="sect3"><span class="enumeration_section">D.7.2</span> Example of Verifying System Upgrade Readiness for Grid Infrastructure</h3>
<div>
<p>You can use the <code class="codeph">runcluvfy.bat</code> command to check your system before upgrading.</p>
<div class="example" id="GUID-3B79AC65-D02B-4369-B679-3B641CDE3F6B__GUID-6B48F337-5361-4E48-BCB4-6428F9AF4F3F">
<p>Verify that the permissions required for installing Oracle Clusterware have been configured by running the following command:</p>
<pre dir="ltr">C:\&gt; runcluvfy.bat stage -pre crsinst -upgrade -rolling 
-src_crshome C:\app\11.2.0.3\grid -dest_crshome C:\app\12.1.0\grid
-dest_version 12.1.0.2.0 -verbose
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<div class="sect2"><a id="GUID-473F76FA-4909-4239-B05F-8E3D783C71A7"></a>
<h2 id="CWWIN-GUID-473F76FA-4909-4239-B05F-8E3D783C71A7" class="sect2"><span class="enumeration_section">D.8</span> Understanding Rolling Upgrades Using Batches</h2>
<div>
<p>Instead of shutting down all nodes when applying patches, you can shut down some nodes while other nodes remaining running.</p>
<p>Upgrades from earlier releases require that you upgrade the entire cluster. You cannot select or de-select individual nodes for upgrade. Oracle does not support attempting to add additional nodes to a cluster during a rolling upgrade.</p>
<p>Oracle recommends that you leave Oracle RAC instances running when upgrading Oracle Clusterware. When you start the upgrade process on each node, the upgrade scripts shut down the database instances and then start the instances again. If you upgrade from Oracle Grid Infrastructure 11<span class="italic">g</span> Release 11.2.0.2 and later to any later release of Oracle Grid Infrastructure, then all nodes are selected for upgrade by default.</p>
<p>When performing the upgrade, you can divide the nodes into groups, or batches, and start upgrades of these node batches. Between batches, you can move services from nodes running the earlier release to the upgraded nodes, so that services are not affected by the upgrade.</p>
</div>
</div>
<div class="sect2"><a id="GUID-739DD3C6-B845-4A5F-A3A9-00794F17961F"></a>
<h2 id="CWWIN-GUID-739DD3C6-B845-4A5F-A3A9-00794F17961F" class="sect2"><span class="enumeration_section">D.9</span> Performing Rolling Upgrades of Oracle Grid Infrastructure</h2>
<div>
<p>Review this information to perform rolling upgrade of Oracle Grid Infrastructure.</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-F85A1B32-8533-48A7-AC73-2F7B6EE46BB0">Performing a Standard Upgrade from an Earlier Release</a></strong><br/>
Use the following procedure to upgrade Oracle Clusterware or Oracle Automatic Storage Management (Oracle ASM) from an earlier release to a later release.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-6C6AEBFF-23A8-435A-B356-A0C41EBDD27C">Completing an Oracle Clusterware Upgrade when Nodes Become Unreachable</a></strong><br/>
If some nodes become unreachable in the middle of an upgrade, then you cannot complete the upgrade without user intervention.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-9EC16310-DF6A-47AA-8541-B37CCB5F4363">Completing the Upgrade of Inaccessible Nodes After Forcing an Upgrade</a></strong><br/>
Starting with Oracle Grid Infrastructure 12<span class="italic">c</span>, after you complete a force cluster upgrade command, you can join inaccessible nodes to the cluster as an alternative to deleting the nodes, which was required in earlier releases.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-A2A65B02-0B07-46C2-8230-46395ACF28A3">Changing the First Node for Install and Upgrade</a></strong><br/>
If the first node becomes inaccessible, you can force another node to be the first node for installation or upgrade.</li>
</ul>
</div>
<div class="sect3"><a id="GUID-F85A1B32-8533-48A7-AC73-2F7B6EE46BB0"></a>
<h3 id="CWWIN-GUID-F85A1B32-8533-48A7-AC73-2F7B6EE46BB0" class="sect3"><span class="enumeration_section">D.9.1</span> Performing a Standard Upgrade from an Earlier Release</h3>
<div>
<p>Use the following procedure to upgrade Oracle Clusterware or Oracle Automatic Storage Management (Oracle ASM) from an earlier release to a later release.</p>
<div class="section">
<div class="infobox-note" id="GUID-F85A1B32-8533-48A7-AC73-2F7B6EE46BB0__GUID-E44AD23E-2D2E-49A9-A35A-E39F4D90C080">
<p class="notep1">Note:</p>
When you upgrade to Oracle Clusterware 12<span class="italic">c</span> Release 1 (12.1), Oracle Automatic Storage Management (Oracle ASM) is installed in the same home as Oracle Clusterware. In Oracle documentation, this home is called the Oracle Grid Infrastructure home, or Grid home. Also note that Oracle does not support attempting to add additional nodes to a cluster during a rolling upgrade.</div>
<p>If you previously attempted to upgrade to a higher release of Oracle Grid Infrastructure, and that Grid home still exists, then instead of running the installer, run the config.bat script in the Grid_home\crs\config directory of the higher version Grid home. Select the Upgrade option to upgrade the existing Grid home to the later release.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>If there are non-clustered, or single-instance, Oracle databases that use Oracle ASM running on any of the nodes in the cluster, they must be shut down before you start the upgrade.</span>
<div>Listeners associated with those databases do not have to be shut down.
<div class="infobox-note" id="GUID-F85A1B32-8533-48A7-AC73-2F7B6EE46BB0__GUID-D91DD436-9F71-423D-A41A-969293E38F94">
<p class="notep1">Note:</p>
Oracle recommends that you leave Oracle Real Application Clusters (Oracle RAC) instances running during the Oracle Clusterware upgrade. During the upgrade process, the database instances on the node being upgraded are stopped and started automatically during the upgrade process.</div>
</div>
</li>
<li class="stepexpand"><span>Start the installer, and select the option to upgrade an existing Oracle Clusterware and Oracle ASM installation.</span></li>
<li class="stepexpand"><span>On the node selection page, select all nodes.</span>
<div>
<div class="infobox-note" id="GUID-F85A1B32-8533-48A7-AC73-2F7B6EE46BB0__GUID-283E6C50-9455-4E7E-BC0A-2CBEF800396C">
<p class="notep1">Note:</p>
In contrast with releases prior to Oracle Clusterware 11<span class="italic">g</span> Release 2, all upgrades are rolling upgrades, even if you select all nodes for the upgrade. If you are upgrading from Oracle Clusterware 11<span class="italic">g</span>, then all nodes are selected by default. You cannot select or de-select the nodes.</div>
</div>
</li>
<li class="stepexpand"><span>Select installation options as prompted.</span></li>
<li class="stepexpand"><span>Confirm your selections, and then the upgrade scripts are run automatically.</span>
<div>
<div class="infobox-note" id="GUID-F85A1B32-8533-48A7-AC73-2F7B6EE46BB0__GUID-D8B332E4-A061-4BA4-AE72-F23C9BA0263F">
<p class="notep1">Note:</p>
If you receive an error indicating the server must be restarted before the installation completes, see <span class="q">&#34;<a href="trouble.htm#GUID-4B6C5B13-A363-4198-B088-FCEF13C3F69F" title="If OUI exits on the node from which you started the installation (the first node), or the node reboots before you confirm that the rootupgrade.bat script was run on all cluster nodes, then the upgrade remains incomplete.">Completing Failed or Interrupted Installations and Upgrades</a>&#34;</span></div>
</div>
</li>
<li class="stepexpand"><span>Oracle recommends that you upgrade Oracle ASM at the same time that you upgrade Oracle Clusterware.</span>
<div>Until Oracle ASM is upgraded, Oracle databases that use Oracle ASM cannot be created and the Oracle ASM management tools in the Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1) home (for example, srvctl) do not work.
<ul style="list-style-type: disc;">
<li>
<p>After the Oracle Clusterware upgrade completes, if you are upgrading from a release earlier than Oracle ASM 11<span class="italic">g</span> Release 2 (11.2.0.2), and you left the check box for <span class="bold">ASM Configuration Assistant (ASMCA)</span> selected, as is the default, then the installer starts ASMCA to upgrade Oracle ASM. If you unchecked the box on the interview stage of the upgrade, then ASMCA is not run automatically.</p>
</li>
<li>
<p>If an earlier release of Oracle ASM is installed, then the installer starts ASMCA to upgrade Oracle ASM to 12<span class="italic">c</span> Release 1 (12.1). You can upgrade Oracle ASM at this time, or upgrade it later.</p>
</li>
</ul>
<div class="infobox-note" id="GUID-F85A1B32-8533-48A7-AC73-2F7B6EE46BB0__GUID-A2C45FE7-627B-424B-930A-0BD50F322B4A">
<p class="notep1">Note:</p>
<p>After the upgrade, if you set the Oracle Cluster Registry (OCR) backup location manually to the earlier release Oracle Clusterware home (CRS home), then you must change the OCR backup location to the Oracle Grid Infrastructure home (Grid home). If you did not set the OCR backup location manually, then this issue does not concern you.</p>
<p>Because upgrades of Oracle Clusterware are out-of-place upgrades, the Oracle Clusterware home for the earlier release cannot be the location of the OCR backups. Backups in the old Oracle Clusterware home could be deleted.</p>
</div>
</div>
</li>
<li class="stepexpand"><span>Because the Oracle Grid Infrastructure home is in a different location than the former Oracle Clusterware and Oracle ASM homes, update any scripts or applications that use utilities or other files that reside in the Oracle Clusterware and Oracle ASM homes.</span></li>
</ol>
</div>
<div>
<div class="relinfo">
<p><strong>Related Topics</strong></p>
<ul>
<li><a href="trouble.htm#GUID-47747AA7-C369-4AA0-9D06-19AF5B7F4428">Completing Failed or Incomplete Installations and Upgrades</a></li>
</ul>
</div>
</div>
</div>
<div class="sect3"><a id="GUID-6C6AEBFF-23A8-435A-B356-A0C41EBDD27C"></a>
<h3 id="CWWIN-GUID-6C6AEBFF-23A8-435A-B356-A0C41EBDD27C" class="sect3"><span class="enumeration_section">D.9.2</span> Completing an Oracle Clusterware Upgrade when Nodes Become Unreachable</h3>
<div>
<p>If some nodes become unreachable in the middle of an upgrade, then you cannot complete the upgrade without user intervention.</p>
<div class="section">
<p>Because the upgrade did not complete successfully on the unreachable nodes, the upgrade is incomplete. Oracle Clusterware remains in the earlier release.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Confirm that the upgrade is incomplete by entering the following command:</span>
<div>
<pre dir="ltr">crsctl query crs activeversion
</pre></div>
</li>
<li class="stepexpand"><span>To resolve the incomplete upgrade, run the <code class="codeph">rootupgrade.bat</code> command with the <code class="codeph">-force</code> option on any of the nodes where the <code class="codeph">rootupgrade.bat</code> script has already completed as follows:</span>
<div>
<pre dir="ltr"><span class="variable">Grid_home</span>/rootupgrade -force
</pre>
<p>For example, as the Oracle Installation User for Oracle Grid Infrastructure, run the following command:</p>
<pre dir="ltr">C:\&gt; C:\app\12.1.0\grid\rootupgrade -force
</pre></div>
<div>
<p>The force cluster upgrade has the following limitations:</p>
<ul style="list-style-type: disc;">
<li>
<p>All active nodes must be upgraded to the newer release</p>
</li>
<li>
<p>All inactive nodes (accessible or inaccessible) may be either upgraded or not upgraded</p>
</li>
<li>
<p>For inaccessible nodes, after patch set upgrades, you can delete the node from the cluster. If the node becomes accessible later, and the patch version upgrade path is supported, then you can upgrade it to the new patch version.</p>
</li>
</ul>
</div>
<div>This command forces the upgrade to complete.</div>
</li>
<li class="stepexpand"><span>Verify that the upgrade has completed by using the command <code class="codeph">crsctl query crs activeversion</code>.</span>
<div>The active release should be the upgrade release.</div>
</li>
</ol>
</div>
</div>
<div class="sect3"><a id="GUID-9EC16310-DF6A-47AA-8541-B37CCB5F4363"></a>
<h3 id="CWWIN-GUID-9EC16310-DF6A-47AA-8541-B37CCB5F4363" class="sect3"><span class="enumeration_section">D.9.3</span> Completing the Upgrade of Inaccessible Nodes After Forcing an Upgrade</h3>
<div>
<p>Starting with Oracle Grid Infrastructure 12<span class="italic">c</span>, after you complete a force cluster upgrade command, you can join inaccessible nodes to the cluster as an alternative to deleting the nodes, which was required in earlier releases.</p>
<div class="p">To use this option, Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1) software must already be installed on the nodes.</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Log in as the Oracle Installation User for Oracle Grid Infrastructure on one of the nodes that is a member of the cluster.</span></li>
<li class="stepexpand"><span>Change directory to the <code>crs\install</code> directory in the Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1) Grid home.</span>
<div>
<p>For example:</p>
<pre dir="ltr">C:\&gt; cd app\12.1.0\grid\crs\install
</pre></div>
</li>
<li class="stepexpand"><span>Run the following PERL command, where <span class="variable">upgraded_node</span> is the inaccessible or unreachable node that you want to join to the cluster:</span>
<div>
<pre dir="ltr">C:\&gt; rootupgrade.bat -join -existing_node <span class="variable">upgraded_node</span>
</pre></div>
<div>
<div class="infobox-note" id="GUID-9EC16310-DF6A-47AA-8541-B37CCB5F4363__GUID-55B96A60-2B39-4A76-ADB9-22B486C955EE">
<p class="notep1">Note:</p>
The <code class="codeph">-join</code> operation is not supported for Oracle Clusterware releases earlier than 11.2.0.2.0. In such cases, delete the node and add it to the cluster using the <code class="codeph">addNode</code> command.</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3"><a id="GUID-A2A65B02-0B07-46C2-8230-46395ACF28A3"></a>
<h3 id="CWWIN-GUID-A2A65B02-0B07-46C2-8230-46395ACF28A3" class="sect3"><span class="enumeration_section">D.9.4</span> Changing the First Node for Install and Upgrade</h3>
<div>
<p>If the first node becomes inaccessible, you can force another node to be the first node for installation or upgrade.</p>
<ul>
<li class="stepexpand"><span><span class="bold">Installation</span>: If <code class="codeph">gridonfig.bat</code> fails to complete on the first node, run the following command on another node using the <code class="codeph">-force</code> option:</span>
<div>
<pre dir="ltr"><span class="variable">Grid_home</span>\crs\config\gridconfig.bat -force -first
</pre></div>
</li>
<li class="stepexpand"><span><span class="bold">Upgrade</span>: If <code class="codeph">gridonfig.bat</code> fails to complete on the first node, run the following command on another node using the <code class="codeph">-force</code> option:</span>
<div>
<pre dir="ltr"><span class="variable">Grid_home</span>\crs\config\gridconfig.bat -upgrade -force -first
</pre></div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2"><a id="GUID-95FFB620-167A-440A-AE32-9AA953971ABE"></a>
<h2 id="CWWIN-GUID-95FFB620-167A-440A-AE32-9AA953971ABE" class="sect2"><span class="enumeration_section">D.10</span> Performing Rolling Upgrades of Oracle ASM</h2>
<div>
<p>After you have completed the Oracle Clusterware portion of Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1) upgrade, you may need to upgrade Oracle ASM separately if the Oracle ASM portion of the Oracle Grid Infrastructure upgrade failed, or for some other reason Automatic Storage Management Configuration assistant (ASMCA) did not run.</p>
<p>After you have upgraded Oracle ASM to Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1, you can install individual patches for Oracle ASM by downloading them from the Oracle Automated Release Update site. See <span class="q">&#34;<a href="upgrade.htm#GUID-3B804E88-4E19-49CB-B3DA-A034A044456B" title="If you must complete upgrade of Oracle ASM separately, then note these requirements.">Preparing to Upgrade Oracle ASM</a>&#34;</span>for steps to upgrade Oracle ASM separately from Oracle Grid Infrastructure.</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-3B804E88-4E19-49CB-B3DA-A034A044456B">Preparing to Upgrade Oracle ASM</a></strong><br/>
If you must complete upgrade of Oracle ASM separately, then note these requirements.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-C6146BAF-699A-49E0-AB35-BEFB7B4A5EAA">Upgrading Oracle ASM Separately from an Oracle Grid Infrastructure Upgrade</a></strong><br/>
Complete the following tasks if you must upgrade from an Oracle ASM release where Oracle ASM was installed in a separate Oracle home, or if the Oracle ASM portion of Oracle Grid Infrastructure upgrade failed to complete.</li>
</ul>
</div>
<div class="sect3"><a id="GUID-3B804E88-4E19-49CB-B3DA-A034A044456B"></a>
<h3 id="CWWIN-GUID-3B804E88-4E19-49CB-B3DA-A034A044456B" class="sect3"><span class="enumeration_section">D.10.1</span> Preparing to Upgrade Oracle ASM</h3>
<div>
<p>If you must complete upgrade of Oracle ASM separately, then note these requirements.</p>
<ul style="list-style-type: disc;">
<li>
<p>The active release of Oracle Clusterware must be 12<span class="italic">c</span> Release 1 (12.1). To determine the active release, enter the following command from the Grid home:</p>
<pre dir="ltr">crsctl query crs activeversion
</pre></li>
<li>
<p>You can upgrade a single instance Oracle ASM installation to a clustered Oracle ASM installation. However, you can only upgrade an existing single instance Oracle ASM installation if you run the installation from the node on which Oracle ASM is installed. You cannot upgrade a single instance Oracle ASM installation on a remote node.</p>
</li>
<li>
<p>You must ensure that any rebalance operations on your existing Oracle ASM installation are completed before starting the upgrade process.</p>
</li>
<li>
<p>During the upgrade process, you alter the state of the Oracle ASM instances to an upgrade state. Because this upgrade state limits Oracle ASM operations, you should complete the upgrade process soon after you begin. You can perform the following operations when an Oracle ASM instance is in the upgrade state:</p>
<ul style="list-style-type: disc;">
<li>
<p>Diskgroup mounts and dismounts</p>
</li>
<li>
<p>Opening, closing, resizing, or deleting database files</p>
</li>
<li>
<p>Recovering instances</p>
</li>
<li>
<p>Queries of fixed views and packages: Users are allowed to query fixed views and run anonymous PL/SQL blocks using fixed packages, such as <code class="codeph">DBMS_DISKGROUP</code>)</p>
</li>
</ul>
</li>
<li>
<p>You do not need to shut down database clients unless they are on Oracle ACFS.</p>
</li>
</ul>
</div>
</div>
<div class="sect3"><a id="GUID-C6146BAF-699A-49E0-AB35-BEFB7B4A5EAA"></a>
<h3 id="CWWIN-GUID-C6146BAF-699A-49E0-AB35-BEFB7B4A5EAA" class="sect3"><span class="enumeration_section">D.10.2</span> Upgrading Oracle ASM Separately from an Oracle Grid Infrastructure Upgrade</h3>
<div>
<p>Complete the following tasks if you must upgrade from an Oracle ASM release where Oracle ASM was installed in a separate Oracle home, or if the Oracle ASM portion of Oracle Grid Infrastructure upgrade failed to complete.</p>
<div class="section"></div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>On the node you plan to start the upgrade, set the environment variable <code class="codeph">ASMCA_ROLLING_UPGRADE</code> to <code class="codeph">true</code>.</span>
<div>For example:
<pre dir="ltr">C:\&gt; set ASMCA_ROLLING_UPGRADE=true
</pre></div>
</li>
<li class="stepexpand"><span>From the Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1) home, start ASMCA.</span>
<div>For example:
<pre dir="ltr">C:\&gt; cd app\12.1\grid\bin
C:\..bin&gt; asmca.bat
</pre></div>
<div>Oracle ASM Configuration Assistant (ASMCA) starts.</div>
</li>
<li class="stepexpand"><span>Select <span class="bold">Upgrade</span>.</span>
<div>ASMCA upgrades Oracle ASM in succession for all nodes in the cluster.</div>
</li>
<li class="stepexpand"><span>After you complete the upgrade, run the command to unset the <code class="codeph">ASMCA_ROLLING_UPGRADE</code> environment variable.</span>
<div>
<pre dir="ltr">C:\&gt; set ASMCA_ROLLING_UPGRADE=
</pre></div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-C6146BAF-699A-49E0-AB35-BEFB7B4A5EAA__GUID-6A1685D7-2371-402A-A291-EAA175D096B8">
<p class="notep1">See Also:</p>
<a class="olink UPGRD" target="_blank" href="../UPGRD/toc.htm"><span class="italic">Oracle Database Upgrade Guide</span></a> and <a class="olink OSTMG02400" target="_blank" href="../OSTMG/GUID-383A26A4-AB4E-458B-AF6A-C9DA5E15AD2A.htm#OSTMG02400"><span class="italic">Oracle Automatic Storage Management Administrator&#39;s Guide</span></a> for more information about preparing an upgrade plan for Oracle ASM, and for starting, completing, and stopping Oracle ASM upgrades</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<div class="sect2"><a id="GUID-AA350A26-1D33-488B-8899-8677DE1EC5F5"></a>
<h2 id="CWWIN-GUID-AA350A26-1D33-488B-8899-8677DE1EC5F5" class="sect2"><span class="enumeration_section">D.11</span> Applying Patches to Oracle ASM</h2>
<div>
<p>After you have upgraded Oracle ASM with Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1, you can install individual patches for Oracle ASM by downloading them from My Oracle Support.</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-BF917EA4-5368-4CB9-B01E-6564C69E486B">About Individual (One-Off) Oracle ASM Patches</a></strong><br/>
Individual patches are called <span class="bold">one-off</span> patches.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-66148F1A-7F15-4AEA-975F-EBDACBE8A360">About Oracle ASM Software Patch Levels</a></strong><br/>
Review this topic to understand how to apply patches for Oracle ASM and Oracle Grid Infrastructure.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-16985DEB-A8EF-45B8-A357-5C95AB773904">Patching Oracle ASM to a Software Patch Level</a></strong><br/>
Starting with Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1), a new cluster state called Rolling Patch is available.</li>
</ul>
</div>
<div class="sect3"><a id="GUID-BF917EA4-5368-4CB9-B01E-6564C69E486B"></a>
<h3 id="CWWIN-GUID-BF917EA4-5368-4CB9-B01E-6564C69E486B" class="sect3"><span class="enumeration_section">D.11.1</span> About Individual (One-Off) Oracle ASM Patches</h3>
<div>
<p>Individual patches are called <span class="bold">one-off</span> patches.</p>
<p>An Oracle ASM one-off patch is available for a specific release of Oracle ASM. If a patch you want is available, then you can download the patch and apply it to Oracle ASM using the OPatch Utility.</p>
<p>The OPatch inventory keeps track of the patches you have installed for your release of Oracle ASM. If there is a conflict between the patches you have installed and patches you want to apply, then the OPatch Utility advises you of these conflicts. See <span class="q">&#34;<a href="upgrade.htm#GUID-16985DEB-A8EF-45B8-A357-5C95AB773904" title="Starting with Oracle Grid Infrastructure 12c Release 1 (12.1), a new cluster state called Rolling Patch is available.">Patching Oracle ASM to a Software Patch Level</a>&#34;</span> for information about applying patches to Oracle ASM using the OPatch Utility.</p>
</div>
</div>
<div class="sect3"><a id="GUID-66148F1A-7F15-4AEA-975F-EBDACBE8A360"></a>
<h3 id="CWWIN-GUID-66148F1A-7F15-4AEA-975F-EBDACBE8A360" class="sect3"><span class="enumeration_section">D.11.2</span> About Oracle ASM Software Patch Levels</h3>
<div>
<p>Review this topic to understand how to apply patches for Oracle ASM and Oracle Grid Infrastructure.</p>
<p>The software patch level for Oracle Grid Infrastructure represents the set of all one-off patches applied to the Oracle Grid Infrastructure software release, including Oracle ASM. The release is the release number, in the format of major, minor, and patch set release number. For example, with the release number 12.1.0.1, the major release is 12, the minor release is 1, and 0.1 is the patch set number. With one-off patches, the major and minor release numbers remain the same, though the patch levels change each time you apply or roll back an interim patch.</p>
<p>As with standard upgrades to Oracle Grid Infrastructure, at any given point in time for normal operation of the cluster, all the nodes in the cluster must have the same software release and patch level. Because one-off patches can be applied as rolling upgrades, all possible patch levels on a particular software release are compatible with each other.</p>
<div class="infoboxnotealso" id="GUID-66148F1A-7F15-4AEA-975F-EBDACBE8A360__GUID-24A4945C-BCF9-4D8C-BBA0-1791C436F034">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="upgrade.htm#GUID-F85A1B32-8533-48A7-AC73-2F7B6EE46BB0" title="Use the following procedure to upgrade Oracle Clusterware or Oracle Automatic Storage Management (Oracle ASM) from an earlier release to a later release.">Performing a Standard Upgrade from an Earlier Release</a>&#34;</span> for information about upgrading Oracle Grid Infrastructure</p>
</li>
<li>
<p><span class="q">&#34;<a href="upgrade.htm#GUID-16985DEB-A8EF-45B8-A357-5C95AB773904" title="Starting with Oracle Grid Infrastructure 12c Release 1 (12.1), a new cluster state called Rolling Patch is available.">Patching Oracle ASM to a Software Patch Level</a>&#34;</span> for information about applying patches to Oracle ASM using the OPatch utility</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3"><a id="GUID-16985DEB-A8EF-45B8-A357-5C95AB773904"></a>
<h3 id="CWWIN-GUID-16985DEB-A8EF-45B8-A357-5C95AB773904" class="sect3"><span class="enumeration_section">D.11.3</span> Patching Oracle ASM to a Software Patch Level</h3>
<div>
<p>Starting with Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1), a new cluster state called Rolling Patch is available.</p>
<div class="section">
<p>Rolling Patch mode is similar to the existing Rolling Upgrade mode in terms of the Oracle ASM operations allowed in this quiesce state.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Download the patch you want to apply from My Oracle Support:</span>
<ol>
<li class="substepexpand"><span>Go to <a href="https://support.oracle.com/" target="_blank">https://support.oracle.com</a></span></li>
<li class="substepexpand"><span>Select the Patches and Updates tab to locate the patch.</span>
<div>
<p>To locate patch bundles, you can perform a <span class="bold">Product or Family (Advanced)</span> search for your platform and software release.</p>
Oracle recommends that you select <span class="bold">Recommended Patch Advisor</span>, and enter the product group, release, and platform for your software. My Oracle Support provides you with a list of the most recent patches and critical patch updates (CPUs).</div>
</li>
<li class="substepexpand"><span>Place the patch in an accessible directory, such as <code>C:\downloads</code>.</span></li>
</ol>
</li>
<li class="stepexpand"><span>Change directory to the <code class="codeph">opatch</code> directory in the Grid home.</span>
<div>
<p>For example:</p>
<pre dir="ltr">C:\&gt; cd app\12.1.0\grid\opatch
</pre></div>
</li>
<li class="stepexpand"><span>Review the patch documentation for the patch you want to apply, and complete all required steps before starting the patch upgrade.</span></li>
<li class="stepexpand"><span>Follow the instructions in the patch documentation to apply the patch.</span></li>
</ol>
</div>
</div>
</div>
<div class="sect2"><a id="GUID-D088CC2A-F91D-4EF6-981F-DB751E92ED49"></a>
<h2 id="CWWIN-GUID-D088CC2A-F91D-4EF6-981F-DB751E92ED49" class="sect2"><span class="enumeration_section">D.12</span> Checking Cluster Health Monitor Repository Size After Upgrading</h2>
<div>
<p>If you are upgrading from a prior release using IPD/OS to Oracle Grid Infrastructure 11<span class="italic">g</span> Release 2 (11.2.0.2 and later), then you should review the Cluster Health Monitor repository size (the CHM repository).</p>
<div class="section"></div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Review your CHM repository needs, and enlarge the repository size to maintain a larger CHM repository.</span>
<div>
<div class="infobox-note" id="GUID-D088CC2A-F91D-4EF6-981F-DB751E92ED49__GUID-A1EA3700-7ADF-4DBC-A2A0-C39DCBB4EAA5">
<p class="notep1">Note:</p>
Your previous IPD/OS repository is deleted when you install Oracle Grid Infrastructure.</div>
<p>By default, the CHM repository size is a minimum of either 1GB or 3600 seconds (1 hour), regardless of the size of the cluster.</p>
</div>
</li>
<li class="stepexpand"><span>To enlarge the CHM repository, use the following command syntax, where <span class="variable">RETENTION_TIME</span> is the size of CHM repository in number of seconds:</span>
<div>
<pre dir="ltr">oclumon manage -repos changeretentiontime <span class="variable">RETENTION_TIME</span>
</pre>
<p>For example, to set the repository size to four hours:</p>
<pre dir="ltr">C:\&gt; oclumon manage -repos changeretentiontime 14400
</pre></div>
<div>The value for <span class="variable">RETENTION_TIME</span> must be more than 3600 (one hour) and less than 259200 (three days). If you enlarge the CHM repository size, then you must ensure that there is local space available for the repository size you select on each node of the cluster. If there is not sufficient space available, then you can move the repository to shared storage.</div>
</li>
</ol>
</div>
</div>
<div class="sect2"><a id="GUID-89920A40-EE9D-4162-9326-C2509189534F"></a>
<h2 id="CWWIN-GUID-89920A40-EE9D-4162-9326-C2509189534F" class="sect2"><span class="enumeration_section">D.13</span> Downgrading Oracle Clusterware After an Upgrade</h2>
<div>
<p>After a successful or a failed upgrade to Oracle Clusterware 12<span class="italic">c</span> Release 1 (12.1), you can restore Oracle Clusterware to the earlier release.</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-CAB0ED47-8B27-4F97-8D2D-26B55C11ADA1">About Downgrading Oracle Clusterware After an Upgrade</a></strong><br/>
Downgrading Oracle Clusterware restores the Oracle Clusterware configuration to the state it was in before the Oracle Clusterware 12<span class="italic">c</span> Release 1 (12.1) upgrade. Any configuration changes you performed during or after the Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1) upgrade are removed and cannot be recovered.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-2DF19AFB-0E12-48E9-8AD6-9EE5C97D506C">Downgrading to Oracle Clusterware 11g Releases Prior to Release 11.2.0.2</a></strong><br/>
These steps describe how to restore Oracle Clusterware to the earlier release.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-B0317784-0476-4569-99E4-EE8D4FD41936">Downgrading to Oracle Clusterware 11g Release 2 (11.2.0.2) or Later Release</a></strong><br/>
Use these steps to restore Oracle Clusterware to the earlier release.</li>
</ul>
</div>
<div class="sect3"><a id="GUID-CAB0ED47-8B27-4F97-8D2D-26B55C11ADA1"></a>
<h3 id="CWWIN-GUID-CAB0ED47-8B27-4F97-8D2D-26B55C11ADA1" class="sect3"><span class="enumeration_section">D.13.1</span> About Downgrading Oracle Clusterware After an Upgrade</h3>
<div>
<p>Downgrading Oracle Clusterware restores the Oracle Clusterware configuration to the state it was in before the Oracle Clusterware 12<span class="italic">c</span> Release 1 (12.1) upgrade. Any configuration changes you performed during or after the Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1) upgrade are removed and cannot be recovered.</p>
<p>In the downgrade procedures, the following variables are used:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="italic">local node</span> is the first node on which you started the upgrade process.</p>
</li>
<li>
<p><span class="italic">remote nodes</span> are all other nodes where you started the upgrade process.</p>
</li>
</ul>
<p>To restore Oracle Clusterware to the earlier release, use the downgrade procedure for the release to which you want to downgrade.</p>
<div class="infobox-note" id="GUID-CAB0ED47-8B27-4F97-8D2D-26B55C11ADA1__GUID-7EB2F093-4CE0-446D-915F-568F3CE37B28">
<p class="notep1">Note:</p>
When downgrading after a failed upgrade, if the <code class="codeph">rootcrs.bat</code> file does not exist on a node, then instead of the executing the script <code class="codeph">rootcrs.bat</code> use the command <code class="codeph">perl rootcrs.pl</code> in the following sections. Use the perl interpreter located in the Oracle Home directory.</div>
</div>
</div>
<div class="sect3"><a id="GUID-2DF19AFB-0E12-48E9-8AD6-9EE5C97D506C"></a>
<h3 id="CWWIN-GUID-2DF19AFB-0E12-48E9-8AD6-9EE5C97D506C" class="sect3"><span class="enumeration_section">D.13.2</span> Downgrading to Oracle Clusterware 11<span class="italic">g</span> Releases Prior to Release 11.2.0.2</h3>
<div>
<p>These steps describe how to restore Oracle Clusterware to the earlier release.</p>
<ol>
<li class="stepexpand"><span>If the <code class="codeph">rootupgrade</code> script failed on a node other than the node on which you started the upgrade (the first node), then downgrade the node where the upgrade failed:</span>
<div>
<pre dir="ltr"><span class="variable">Grid_home</span>\crs\install\rootcrs.bat -downgrade
</pre></div>
</li>
<li class="stepexpand"><span>On all other nodes where the <code class="codeph">rootupgrade</code> script ran successfully, except the first node, as an Administrator user, use the following command:</span>
<div>
<pre dir="ltr"><span class="variable">Grid_home</span>\crs\install\rootcrs.bat -downgrade
</pre></div>
<div>This command stops the Oracle Clusterware 12<span class="italic">c</span> Release 1 (12.1) resources, and shuts down the Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1) stack.</div>
</li>
<li class="stepexpand"><span>After the <code class="codeph">rootcrs.bat -downgrade</code> script has completed on all non-first nodes, on the first node use the following command syntax:</span>
<div>
<pre dir="ltr"><span class="variable">Grid_home</span>\crs\install\rootcrs.bat -downgrade -lastnode
</pre>
<p>For example:</p>
<pre dir="ltr">C:\app\12.1.0\grid\crs\install&gt; rootcrs.bat -downgrade -lastnode
</pre></div>
<div>
<div class="infobox-note" id="GUID-2DF19AFB-0E12-48E9-8AD6-9EE5C97D506C__GUID-48FEF9CE-B37F-4B53-AC73-00B9ADA6722A">
<p class="notep1">Note:</p>
With Oracle Grid Infrastructure 12<span class="italic">c</span>, you no longer need to provide the location of the earlier release Grid home or release number.</div>
</div>
<div>Run this command from a directory that has write permissions for the Oracle Grid Infrastructure installation user.</div>
</li>
<li class="stepexpand"><span>On any of the cluster member nodes where the <code class="codeph">rootcrs</code> script has run successfully:</span>
<ol>
<li class="substepexpand"><span>Log in as the Oracle Grid Infrastructure installation owner.</span></li>
<li class="substepexpand"><span>Use the following command to start the installer, where <code>C:\app\12.1.0\grid</code> represents the location of the new (upgraded) Grid home:</span>
<div>
<pre dir="ltr">setup.exe -nowait -waitforcompletion -ignoreSysPrereqs -updateNodeList
  -silent CRS=false ORACLE_HOME=C:\app\12.1.0\grid
</pre></div>
<div>Add the option <code class="codeph">-cfs</code> if the Grid home is a shared home.</div>
</li>
</ol>
</li>
<li class="stepexpand"><span>On any of the cluster member nodes where the upgrade completed successfully:</span>
<ol>
<li class="substepexpand"><span>Log in as the Oracle Grid Infrastructure installation owner.</span></li>
<li class="substepexpand"><span>Use the following command to start the installer, where the path you provide for the option <code class="codeph">ORACLE_HOME</code> is the location of the home directory from the earlier Oracle Clusterware installation</span>
<div>
<p>For example, if the location of the earlier Oracle Clusterware installation is <code>C:\app\crs</code>, the you would use a command similar to the following:</p>
<pre dir="ltr">C:\&gt; cd C:\app\12.1.0\grid\oui\bin
C:\..bin&gt; setup.exe -nowait -waitforcompletion -ignoreSysPrereqs
   -updateNodeList -silent CRS=true ORACLE_HOME=C:\app\crs
</pre></div>
</li>
<li class="substepexpand"><span><span class="bold">For downgrades to 11.1 and earlier releases</span></span>
<div>
<p>If you are downgrading to Oracle Clusterware 11<span class="italic">g</span> Release 1 (11.1) or an earlier release, then you must run <code class="codeph">root.bat</code> manually from the earlier release Oracle Clusterware home to complete the downgrade after you complete step b.</p>
<p>OUI prompts you to run <code class="codeph">root.bat</code> manually from the earlier release Oracle Clusterware installation home in sequence on each member node of the cluster to complete the downgrade. After you complete this task, downgrade is completed.</p>
<p>Running <code class="codeph">root.bat</code> from the earlier release Oracle Clusterware installation home restarts the Oracle Clusterware stack, starts all the resources previously registered with Oracle Clusterware in the older release, and configures the old initialization scripts to run the earlier release Oracle Clusterware stack.</p>
</div>
</li>
</ol>
</li>
</ol>
<div class="section">
<p>The installer stops the Oracle Grid Infrastructure 12<span class="italic">c</span> software stack.</p>
<p>The Windows services used by Oracle Grid Infrastructure are recreated to refer to the Grid home for the older software release by one of the scripts during the downgrade process.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="sect3"><a id="GUID-B0317784-0476-4569-99E4-EE8D4FD41936"></a>
<h3 id="CWWIN-GUID-B0317784-0476-4569-99E4-EE8D4FD41936" class="sect3"><span class="enumeration_section">D.13.3</span> Downgrading to Oracle Clusterware 11<span class="italic">g</span> Release 2 (11.2.0.2) or Later Release</h3>
<div>
<p>Use these steps to restore Oracle Clusterware to the earlier release.</p>
<div class="section"></div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>On all remote nodes, as an Administrator user, use the command syntax <code class="codeph"><span class="variable">Grid_home</span>\crs\install\rootcrs.bat -downgrade [-force]</code> to stop the Oracle Clusterware 12<span class="italic">c</span> Release 1 (12.1) resources, and shut down the Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1) stack.</span>
<div>
<p>For example:</p>
<pre dir="ltr">C:\app\12.1.0\grid\crs\install&gt; rootcrs.bat -downgrade
</pre></div>
</li>
<li class="stepexpand"><span>After the <code class="codeph">rootcrs.bat -downgrade</code> script has completed on all remote nodes, on the local node use the following command syntax:</span>
<div>
<pre dir="ltr"><span class="variable">Grid_home</span>\crs\install\rootcrs.bat -downgrade -lastnode
</pre>
<p>For example:</p>
<pre dir="ltr">C:\app\12.1.0\grid\crs\install&gt; rootcrs.bat -downgrade -lastnode 
</pre></div>
<div>
<div class="infobox-note" id="GUID-B0317784-0476-4569-99E4-EE8D4FD41936__GUID-BC8418D5-44B3-4B26-AE65-A5ED0D296DCD">
<p class="notep1">Note:</p>
Starting with Oracle Grid Infrastructure 12<span class="italic">c</span>, you no longer need to provide the location of the earlier release Grid home or release number.</div>
<p>Run this command from a directory that has write permissions for the Oracle Grid Infrastructure installation user.</p>
</div>
</li>
<li class="stepexpand"><span>On each cluster member node where the upgrade to Oracle Grid Infrastructure 12<span class="italic">c</span> has completed successfully:</span>
<ol>
<li class="substepexpand"><span>Log in as an Administrator user or the Oracle Installation user.</span></li>
<li class="substepexpand"><span>Use the following command to start the installer, where <code>C:\app\12.1.0\grid</code> is the location of the new (upgraded) Grid home (12.1):</span>
<div>
<pre dir="ltr">setup.exe -updateNodeList -silent CRS=false ORACLE_HOME=C:\app\12.1.0\grid
</pre></div>
<div>Add the option <code class="codeph">-cfs</code> if the Grid home is a shared home.</div>
</li>
<li class="substepexpand"><span>Use the following command to start the installer from the Grid home (12.1), where the path you provide for the option <code class="codeph">ORACLE_HOME</code> is the location of the home directory from the earlier Oracle Clusterware installation, for example <code>C:\app\11.2.0.2\grid</code>:</span>
<div>
<pre dir="ltr">cd C:\app\12.1.0\grid\bin
setup.exe -updateNodeList -silent CRS=true ORACLE_HOME=C:\app\11.2.0.2\grid
</pre></div>
</li>
<li class="substepexpand"><span><span class="bold">For downgrades to 11.2.0.2</span></span>
<div>If you are downgrading to Oracle Clusterware 11<span class="italic">g</span> Release 1 (11.2.0.2), then you must start the Oracle Clusterware stack manually after you complete step c.
<p>On each node, start Oracle Clusterware from the earlier release Oracle Clusterware home using the command <code class="codeph">crsctl start crs</code>. For example, where the earlier release home is <code>C:\app\11.2.0.2\grid,</code> use the following command on each node:</p>
<pre dir="ltr">C:\app\11.2.0.2\grid\bin\crsctl start crs
</pre></div>
</li>
</ol>
</li>
<li class="stepexpand"><span><span class="bold">For downgrades to 12.1.0.1</span></span>
<div>
<p>If you are downgrading to Oracle Grid Infrastructure 12<span class="italic">c</span> Release 1 (12.1.0.1), then run the following commands to configure the Grid Management Database:</p>
</div>
<ol>
<li class="substepexpand"><span>Start the 12.1.0.1 Oracle Clusterware stack on all nodes.</span></li>
<li class="substepexpand"><span>On any node, remove the <code class="codeph">MGMTDB</code> resource as follows:</span>
<div>
<pre dir="ltr">C:\&gt; <span class="variable">12101_Grid_home</span>\bin\srvctl remove mgmtdb
</pre></div>
</li>
<li class="substepexpand"><span>Run DBCA in the silent mode from the Oracle Grid Infrastructure 12<span class="italic">c</span> home and create the Management Database as follows, where <span class="variable">ASM_DG_NAME</span> is the name of a valid Oracle ASM disk group:</span>
<div>
<pre dir="ltr"><span class="variable">12101_Grid_home</span>\bin\dbca -silent -createDatabase -templateName
 MGMTSeed_Database.dbc -sid &#34;-MGMTDB&#34; -gdbName _mgmtdb -storageType ASM
 -diskGroupName <span class="variable">ASM_DG_NAME</span> -characterset AL32UTF8 
 -datafileJarLocation <span class="variable">12101_Grid_home</span>/assistants/dbca/templates
 -autoGeneratePasswords
</pre></div>
</li>
<li class="substepexpand"><span>Configure the Management Database by running the Configuration Assistant from the location <code><span class="variable">12101_Grid_home</span>\bin\mgmtca</code>.</span></li>
</ol>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2"><a id="GUID-93A77770-6732-4760-9160-6069998852F1"></a>
<h2 id="CWWIN-GUID-93A77770-6732-4760-9160-6069998852F1" class="sect2"><span class="enumeration_section">D.14</span> Updating Oracle Enterprise Manager Cloud Control Target Parameters</h2>
<div>
<p>Because the Oracle Clusterware upgrade is an out-of-place upgrade, the upgraded software has a new location for the Grid home. The path for the Oracle Clusterware home in some Oracle Enterprise Manager parameter files must be changed.</p>
<p>If you do not change the CRS_HOME parameter, then you can encounter errors such as &#34;<samp class="msgph">cluster target broken</samp>&#34; on Oracle Enterprise Manager Cloud Control.</p>
<p>To resolve the issue, upgrade the Enterprise Manager Cloud Control target, and then update the Enterprise Manager Agent Base Directory on each cluster member node running an agent.</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-6647D9EE-C14C-4FDC-B66C-B30F4807A8D2">Updating the Enterprise Manager Cloud Control Target After Upgrades</a></strong><br/>
After upgrading Oracle Grid Control, you might need to update the targets in Oracle Enterprise Manager Cloud Control.</li>
<li class="ulchildlink"><strong><a href="upgrade.htm#GUID-18A60FF1-46E6-4BAF-8C36-8E8EE60F501B">Updating the Enterprise Manager Agent Base Directory After Upgrades</a></strong><br/>
The Agent Base Directory is a directory where the Management Agent home is created.</li>
</ul>
</div>
<div class="sect3"><a id="GUID-6647D9EE-C14C-4FDC-B66C-B30F4807A8D2"></a>
<h3 id="CWWIN-GUID-6647D9EE-C14C-4FDC-B66C-B30F4807A8D2" class="sect3"><span class="enumeration_section">D.14.1</span> Updating the Enterprise Manager Cloud Control Target After Upgrades</h3>
<div>
<p>After upgrading Oracle Grid Control, you might need to update the targets in Oracle Enterprise Manager Cloud Control.</p>
<ol>
<li><span>Log in to Enterprise Manager Cloud Control</span></li>
<li><span>Navigate to the <span class="bold">Targets</span> menu, and then to the <span class="bold">Cluster</span> page.</span></li>
<li><span>Click a cluster target that was upgraded.</span></li>
<li><span>Click <span class="bold">Cluster</span>, then <span class="bold">Target Setup</span>, and then <span class="bold">Monitoring Configuration</span> from the menu.</span></li>
<li><span>Update the value for <span class="bold">Oracle Home</span> with the new Grid home path.</span></li>
<li><span>Save the updates.</span></li>
</ol>
</div>
</div>
<div class="sect3"><a id="GUID-18A60FF1-46E6-4BAF-8C36-8E8EE60F501B"></a>
<h3 id="CWWIN-GUID-18A60FF1-46E6-4BAF-8C36-8E8EE60F501B" class="sect3"><span class="enumeration_section">D.14.2</span> Updating the Enterprise Manager Agent Base Directory After Upgrades</h3>
<div>
<p>The Agent Base Directory is a directory where the Management Agent home is created.</p>
<div class="section">
<p>The Management Agent home is in the path <span class="variable">Agent_Base_directory</span>\core\<span class="variable">EMAgent_Version</span>. For example, if the Agent Base Directory is <code>C:\app\emagent</code>, then Oracle creates the Management Agent home as <code>C:\app\emagent\core\12.1.0.1.0</code>.</p>
</div>
<!-- class="section" -->
<ol>
<li><span>Navigate to the <code class="codeph">bin</code> directory in the Management Agent home.</span></li>
<li><span>In the <code>C:\app\emagent\core\12.1.0.1.0\bin</code> directory, open the file <code class="codeph">emctl</code> with a text editor.</span></li>
<li><span>Locate the parameter <code class="codeph">CRS_HOME</code>, and update the parameter to the new Grid home path.</span></li>
<li><span>Repeat steps 1-3 on each node of the cluster with an Enterprise Manager agent.</span></li>
</ol>
</div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5120">
<tr>
<td class="cellalignment5127">
<table class="cellalignment5125">
<tr>
<td class="cellalignment5124"><a href="concepts.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5124"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2012, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5129">
<table class="cellalignment5123">
<tr>
<td class="cellalignment5124"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5124"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5124"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5124"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5124"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5124"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>