<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-5117"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Using%20Real%20Application%20Security%20in%20Java%20Applications"></a><title>Using Real Application Security in Java Applications</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="Java environment, initializing the middle tier, using getSessionManager method, privileges for the session manager, roles for the session manager, changing the middle-tier cache size, removing entries from the cache"/>
<meta name="dcterms.created" content="2017-02-17T18:31:46Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Real Application Security Administrator&#39;s and Developer&#39;s Guide"/>
<meta name="dcterms.identifier" content="E48189-13"/>
<meta name="dcterms.isVersionOf" content="DBFSG"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2012, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="data_security.htm" title="Previous" type="text/html"/>
<link rel="Next" href="external_roles.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E48189-13.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-2FCEEFB5-83DC-4D5A-982A-690C8DCC4181"></a> <span id="PAGE" style="display:none;">13/25</span> <!-- End Header -->
<a id="DBFSG99844"></a>
<h1 id="DBFSG-GUID-2FCEEFB5-83DC-4D5A-982A-690C8DCC4181" class="sect1"><span class="enumeration_chapter">6</span> Using Real Application Security in Java Applications</h1>
<div>
<div class="p">This chapter describes how to use Real Application Security in Java applications. This chapter contains the following sections:
<ul style="list-style-type: disc;">
<li>
<p><a href="midtierjava.htm#GUID-F003B955-1845-41BE-B818-02CDC6231EBA">About Initializing the Middle Tier</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-BC164147-DE1C-4E73-84B7-715540C5FC88">About Managing Real Application Security Sessions</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-FDF62B47-A13B-4CA1-AA9C-F2EF602FF60F">Authenticating Application Users Using Java APIs</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-A3A5BE47-E770-4206-8DA8-4A9D70FA89E3">About Authorizing Application Users Using ACLs</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-501B93E3-2673-4838-889E-AC1CAC9D9AD3">Human Resources Administration Use Case: Implementation in Java</a></p>
</li>
</ul>
</div>
</div>
<a id="DBFSG99845"></a>
<div class="props_rev_3"><a id="GUID-F003B955-1845-41BE-B818-02CDC6231EBA"></a>
<h2 id="DBFSG-GUID-F003B955-1845-41BE-B818-02CDC6231EBA" class="sect2">About Initializing the Middle Tier</h2>
<div>
<p>The <code class="codeph">XSSessionManager</code> class manages the life cycle of the session. It provides methods to create, attach, assign, detach, and destroy sessions. It also provides methods to perform cache activities.</p>
<div class="p">This section describes the following topics:
<ul style="list-style-type: disc;">
<li>
<p><a href="midtierjava.htm#GUID-2DA94DA8-FCA0-44CD-A59C-68CC2D42B315">About Mid-Tier Configuration Mode</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-565444BC-7235-4E94-9D67-B6640330B958">Using the getSessionManager Method</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-910C7955-080E-4DD2-9C6E-4B4FFF61FEEE">About Changing the Middle-Tier Cache Setting</a></p>
</li>
</ul>
</div>
</div>
<a id="DBFSG464"></a>
<div class="props_rev_3"><a id="GUID-2DA94DA8-FCA0-44CD-A59C-68CC2D42B315"></a>
<h3 id="DBFSG-GUID-2DA94DA8-FCA0-44CD-A59C-68CC2D42B315" class="sect3">About Mid-Tier Configuration Mode</h3>
<div>
<p>You can use <a id="d25928e359" class="indexterm-anchor"></a>one mid-tier configuration mode:</p>
<ul style="list-style-type: disc;">
<li>
<p>Dispatcher mode - get a session manager with dispatcher connections</p>
</li>
</ul>
<p>In dispatcher mode, the dispatcher user must have session administration and cache access privileges. The application user does not need any session or cache privilege. The two predefined database roles, <code class="codeph">xs_session_admin</code> and <code class="codeph">xs_cache_admin</code>, can be granted to the dispatcher.</p>
<p>For best security practices, the application user should be given the least amount of privilege, therefore dispatcher mode is the recommended mid-tier configuration.</p>
</div>
</div>
<a id="DBFSG462"></a><a id="DBFSG463"></a><a id="DBFSG99848"></a><a id="DBFSG99846"></a>
<div class="props_rev_3"><a id="GUID-565444BC-7235-4E94-9D67-B6640330B958"></a>
<h3 id="DBFSG-GUID-565444BC-7235-4E94-9D67-B6640330B958" class="sect3">Using the getSessionManager Method</h3>
<div>
<div class="section">
<p>There is one way to get a session manager following the mid-tier configuration mode described in <span class="q">&#34;<a href="midtierjava.htm#GUID-2DA94DA8-FCA0-44CD-A59C-68CC2D42B315">About Mid-Tier Configuration Mode</a>&#34;</span>:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Pass a connection or a pool of connections of the dispatcher user. In this way, the needed privileges are granted to the dispatcher. The two predefined roles, <code class="codeph">xs_session_admin</code> and <code class="codeph">xs_cache_admin</code>, should be granted to the dispatcher user. The dispatcher user is a direct logon Real Application Security user.</p>
</li>
</ul>
<p>Using the dispatcher mode, you can initiate the Real Application Security middle tier by getting an instance of the session manager (see <a href="midtierjava.htm#GUID-565444BC-7235-4E94-9D67-B6640330B958__BGBGGGIC">Example 6-1</a>). Use the <code class="codeph">getSessionManager</code> method (in bold typeface) of the <code class="codeph">XSSessionManager</code> class to get an instance of the session manager. This method initializes a Real Application Security session manager by using either a single connection or a pool of connections. The caller of the <code class="codeph">getSessionManager</code> method should have the Java Authentication and Authorization Service (JAAS) permission <code class="codeph">XSSecurityPermission(&#34;initSecurityManager&#34;)</code>.</p>
</div>
<!-- class="section" -->
<div class="section" id="GUID-565444BC-7235-4E94-9D67-B6640330B958__BGBJBIGB">
<p class="subhead3">Privileges for the Session Manager</p>
</div>
<!-- class="section" -->
<div class="section">
<p>Real Application Security session manager is initialized with a connection of a privileged user, who authorizes the session operations on behalf of the regular Real Application Security application users. If the session manager has the session operation privileges, then, each application user under the session manager does not need to have session operation privileges, and the application user&#39;s session operations can be performed as a trusted party. The session manager authorizes session operations for a connection, so you do not need to grant the <code class="codeph">createSession</code> and <code class="codeph">attachToSession</code> privileges directly to the regular Real Application Security application user. This session manager must have the following privileges:</p>
<ul style="list-style-type: disc;">
<li>
<p>Real Application Security database object privileges to manage cached data in the middle tier.</p>
</li>
<li>
<p>Session life cycle management privileges for the session manager to create or attach sessions on behalf of Real Application Security application user and external users.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Roles for the Session Manager</p>
</div>
<!-- class="section" -->
<div class="section">
<p>The session manager needs the following two roles to have the privileges mentioned in <span class="q">&#34;<a href="midtierjava.htm#GUID-565444BC-7235-4E94-9D67-B6640330B958__BGBJBIGB">Privileges for the Session Manager</a>&#34;</span>:</p>
<ul style="list-style-type: disc;">
<li>
<p>A database role <code class="codeph">xs_cache_admin</code> with the following privileges:</p>
<ul style="list-style-type: disc;">
<li>
<p>Privilege to query Real Application Security entities and to synchronize metadata</p>
</li>
<li>
<p>Privilege to execute code for the key exchange</p>
</li>
</ul>
</li>
<li>
<p>A Real Application Security role, <code class="codeph">xs_session_admin</code>, with <code class="codeph">ADMIN_SESSION</code> privilege</p>
</li>
</ul>
<p>These roles are predefined in the system.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-565444BC-7235-4E94-9D67-B6640330B958__BGBGGGIC">
<p class="titleinexample">Example 6-1 How to Get an Instance of the Session Manager in Java Using a Single Connection</p>
<pre dir="ltr">static XSSessionManager manager;
static Connection dispatcherConn = null;
int cacheMaxIdleTime=30;
int cacheMaxsize=2048000;
String host;
String port;
String sid;
...
dispatcherConn = DriverManager.getConnection(&#34;jdbc:oracle:thin:@&#34; + host + &#34;:&#34; + port + &#34;:&#34; + sid, dispatcherUser, dispatcherPassword);
...
<span class="bold">manager = XSSessionManager.getSessionManager(dispatcherConn, cacheMaxIdleTime, cacheMaxsize);</span>
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DBFSG99849"></a>
<div class="props_rev_3"><a id="GUID-910C7955-080E-4DD2-9C6E-4B4FFF61FEEE"></a>
<h3 id="DBFSG-GUID-910C7955-080E-4DD2-9C6E-4B4FFF61FEEE" class="sect3">About Changing the Middle-Tier Cache Setting</h3>
<div>
<p>Once the session manager is initialized, it starts to add some data like the ACL and Security class information to the cache. This cache data can be reused. The cache is initialized with its default settings that can be changed later.</p>
<div class="p">This section describes the following topics:
<ul style="list-style-type: disc;">
<li>
<p><a href="midtierjava.htm#GUID-7F9509F7-6BFF-449B-A817-95E7969CAB73">About Setting the Maximum Cache Idle Time</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-AA44F843-8DB3-470C-9BF6-B82B86E4666E">About Setting the Maximum Cache Size</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-52D7EF79-6554-4086-B62E-9AEBFD6F0C50">About Getting the Maximum Cache Idle Time</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-8692B1EC-5636-4D40-A16C-39FB49C02456">About Getting the Maximum Cache Size</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-5328F766-CB95-4B39-AA3B-7D95C611EE44">About Removing Entries from the Cache</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-8101F9C6-43ED-4209-AB56-F28DEB35FC9E">About Clearing the Cache</a></p>
</li>
</ul>
</div>
</div>
<a id="DBFSG99850"></a>
<div class="props_rev_3"><a id="GUID-7F9509F7-6BFF-449B-A817-95E7969CAB73"></a>
<h4 id="DBFSG-GUID-7F9509F7-6BFF-449B-A817-95E7969CAB73" class="sect4">About Setting the Maximum Cache Idle Time</h4>
<div>
<p>To set the <a id="d25928e848" class="indexterm-anchor"></a>maximum cache idle time, use the <code class="codeph">setCacheMaxIdleTime</code> method of the <code class="codeph">XSSessionManager</code> class. The <code class="codeph">setCacheMaxIdleTime</code> method sets the maximum number of minutes that the cache can go without updating.</p>
<p>If an attempt is made to fetch objects from the cache and the <code class="codeph">XSSessionManager</code> has not called the <code class="codeph">updateCache</code> method for a period of time equal to the value set by the <code class="codeph">setCacheMaxIdleTime</code> method, then, before returning any objects, the <code class="codeph">updateCache</code> method is invoked forcefully to check that all the cached objects are still valid. The caller of the <code class="codeph">setCacheMaxIdleTime</code> method must have the JAAS permission <code class="codeph">XSSecurityPermission(&#34;setCacheMaxIdleTime&#34;)</code>.</p>
</div>
</div>
<a id="DBFSG99851"></a>
<div class="props_rev_3"><a id="GUID-AA44F843-8DB3-470C-9BF6-B82B86E4666E"></a>
<h4 id="DBFSG-GUID-AA44F843-8DB3-470C-9BF6-B82B86E4666E" class="sect4">About Setting the Maximum Cache Size</h4>
<div>
<p>To set the <a id="d25928e990" class="indexterm-anchor"></a>maximum cache size, use the <code class="codeph">setCacheMaxSize</code> method of the <code class="codeph">XSSessionManager</code> class. This method sets the size of the cache on the middle tier.</p>
<p>The default size of the cache is 10MB. The minimum cache size is 1MB. The caller of the <code class="codeph">setCacheMaxSize</code> method must have the JAAS permission <code class="codeph">XSSecurityPermission(&#34;setCacheMaxSize&#34;)</code>.</p>
</div>
</div>
<a id="DBFSG99852"></a>
<div class="props_rev_3"><a id="GUID-52D7EF79-6554-4086-B62E-9AEBFD6F0C50"></a>
<h4 id="DBFSG-GUID-52D7EF79-6554-4086-B62E-9AEBFD6F0C50" class="sect4">About Getting the Maximum Cache Idle Time</h4>
<div>
<p>To get the <a id="d25928e1117" class="indexterm-anchor"></a>maximum cache idle time, use the <code class="codeph">getCacheMaxIdleTime</code> method of the <code class="codeph">XSSessionManager</code> class. This method returns the maximum number of minutes for which the cache does not have an <code class="codeph">updateCache</code> call to update the cache. The caller of the <code class="codeph">getCachemaxIdleTime</code> method must have the JAAS permission <code class="codeph">XSSecurityPermission(&#34;getCacheMaxIdleTime&#34;)</code>.</p>
</div>
</div>
<a id="DBFSG99853"></a>
<div class="props_rev_3"><a id="GUID-8692B1EC-5636-4D40-A16C-39FB49C02456"></a>
<h4 id="DBFSG-GUID-8692B1EC-5636-4D40-A16C-39FB49C02456" class="sect4">About Getting the Maximum Cache Size</h4>
<div>
<p>To get the <a id="d25928e1245" class="indexterm-anchor"></a>maximum cache size, use the <code class="codeph">getCacheMaxSize</code> method of the <code class="codeph">XSSessionManager</code> class. This method returns the maximum size of the cache in bytes. The caller of the <code class="codeph">getCacheMaxSize</code> method must have the JAAS permission XSSecurityPermission(&#34;getCacheMaxSize&#34;).</p>
</div>
</div>
<a id="DBFSG99854"></a>
<div class="props_rev_2"><a id="GUID-5328F766-CB95-4B39-AA3B-7D95C611EE44"></a>
<h4 id="DBFSG-GUID-5328F766-CB95-4B39-AA3B-7D95C611EE44" class="sect4">About Removing Entries from the Cache</h4>
<div>
<p>To remove entries from the cache, a cache eviction algorithm is used, along with watermark levels. A watermark level determines how long data should stay in memory cache before being removed. When the cache size reaches the high watermark, then the cache eviction algorithm removes entries until the cache size reaches the low watermark.</p>
<div class="p">This section describes the following activities for removing entries from the cache:
<ul style="list-style-type: disc;">
<li>
<p><a href="midtierjava.htm#GUID-2F0EB720-4ADB-40D7-8738-B7B95EBC2DB7">About Setting the WaterMark</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-0B74A41C-A241-42F5-9B25-92BB70C85578">About Getting the High WaterMark</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-B39AE5D8-E06F-4E5C-BC25-12151461A58D">About Getting the Low WaterMark</a></p>
</li>
</ul>
</div>
</div>
<a id="DBFSG99855"></a>
<div class="props_rev_3"><a id="GUID-2F0EB720-4ADB-40D7-8738-B7B95EBC2DB7"></a>
<h5 id="DBFSG-GUID-2F0EB720-4ADB-40D7-8738-B7B95EBC2DB7" class="sect5">About Setting the WaterMark</h5>
<div>
<p>To set the <a id="d25928e1495" class="indexterm-anchor"></a>watermark, use the <code class="codeph">setWaterMark</code> method from the <code class="codeph">XSSessionManager</code> class. The caller of the <code class="codeph">setWaterMark</code> method must have the JAAS permission <code class="codeph">XSSecurityPermission(&#34;setWaterMark&#34;)</code>.</p>
</div>
</div>
<a id="DBFSG99856"></a>
<div class="props_rev_3"><a id="GUID-0B74A41C-A241-42F5-9B25-92BB70C85578"></a>
<h5 id="DBFSG-GUID-0B74A41C-A241-42F5-9B25-92BB70C85578" class="sect5">About Getting the High WaterMark</h5>
<div>
<p>To get the <a id="d25928e1619" class="indexterm-anchor"></a>high watermark for cache, use the <code class="codeph">getHighWaterMark</code> method from the <code class="codeph">XSSessionManager</code> class.</p>
</div>
</div>
<a id="DBFSG99857"></a>
<div class="props_rev_3"><a id="GUID-B39AE5D8-E06F-4E5C-BC25-12151461A58D"></a>
<h5 id="DBFSG-GUID-B39AE5D8-E06F-4E5C-BC25-12151461A58D" class="sect5">About Getting the Low WaterMark</h5>
<div>
<p>To get the <a id="d25928e1738" class="indexterm-anchor"></a>low watermark for cache, use the <a id="d25928e1745" class="indexterm-anchor"></a><code class="codeph">getLowWaterMark</code> method from the <code class="codeph">XSSessionManager</code> class.</p>
</div>
</div>
</div>
<a id="DBFSG99858"></a>
<div class="props_rev_3"><a id="GUID-8101F9C6-43ED-4209-AB56-F28DEB35FC9E"></a>
<h4 id="DBFSG-GUID-8101F9C6-43ED-4209-AB56-F28DEB35FC9E" class="sect4">About Clearing the Cache</h4>
<div>
<p>To clear the cache<a id="d25928e1861" class="indexterm-anchor"></a> explicitly from the middle tier, use the <a id="d25928e1868" class="indexterm-anchor"></a><code class="codeph">clearCache</code> method of the <code class="codeph">XSSessionManager</code> class. This method explicitly clears the shared cache from the middle tier. The caller of the <code class="codeph">clearCache</code> method must have the JAAS permission <code class="codeph">XSSecurityPermission(&#34;clearCache&#34;)</code>.</p>
</div>
</div>
</div>
</div>
<a id="DBFSG99861"></a>
<div class="props_rev_3"><a id="GUID-BC164147-DE1C-4E73-84B7-715540C5FC88"></a>
<h2 id="DBFSG-GUID-BC164147-DE1C-4E73-84B7-715540C5FC88" class="sect2">About Managing Real Application Security Sessions</h2>
<div>
<p>This section describes the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="midtierjava.htm#GUID-583E51CC-E332-4649-A00F-B6ED09D4F27E">Creating A Real Application Security User Session</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-3C2EC26F-6493-41E2-BD52-B5923FEE8E8A">Attaching An Application Session</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-4D8AEEB1-29BF-4813-9023-4EA8FB21E5D9">Assigning or Switching an Application User</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-930E5B82-A24B-482C-BCB6-44113251D5C8">Enabling Real Application Security Application Roles</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-6ED38345-63A3-490E-84A6-037C42B3164F">About Performing Namespace Operations as Session User</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-1A982585-B7E7-4AB7-92F3-B5B07C240AF8">About Performing Miscellaneous Session-Related Activities</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-1644F4CF-90DE-40BE-AC5C-341372A0DB3B">Detaching an Application Session</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-6DACB579-26F2-4641-A4D5-E7DE2A1B0004">Destroying A Real Application Security Application Session</a></p>
</li>
</ul>
</div>
<a id="DBFSG99863"></a><a id="DBFSG99862"></a>
<div class="props_rev_3"><a id="GUID-583E51CC-E332-4649-A00F-B6ED09D4F27E"></a>
<h3 id="DBFSG-GUID-583E51CC-E332-4649-A00F-B6ED09D4F27E" class="sect3">Creating A Real Application Security User Session</h3>
<div>
<div class="section">
<p>To create a Real Application Security <a id="d25928e2138" class="indexterm-anchor"></a>user session, for example, <code class="codeph">lws</code>, for the application user <code class="codeph">lwuser</code>, use the <a id="d25928e2149" class="indexterm-anchor"></a><code class="codeph">createSession</code> method of the <code class="codeph">XSSessionManager</code> class (see <a href="midtierjava.htm#GUID-583E51CC-E332-4649-A00F-B6ED09D4F27E__BGBJJCCB">Example 6-2</a>). The <code class="codeph">createSession</code> method (in bold typeface). creates a session on the server with the specified parameters passed. A database round-trip is required to perform this operation.</p>
<p>To create an anonymous Real Application Security application session, use the <a id="d25928e2167" class="indexterm-anchor"></a><code class="codeph">createAnonymousSession</code> method of the <code class="codeph">XSSessionManager</code> class. The application user for this session is a predefined anonymous user, so no user parameter is passed in this method.</p>
<p>Both methods support using a cookie and a namespace.</p>
<p>The cookie, passed as the parameter, can be used to identify the newly created Real Application Security application session in future calls, until the cookie value is changed or the session is destroyed.</p>
<p>The namespace, passed as the parameter, can be used to create a namespace in the session. For details, see <span class="q">&#34;<a href="midtierjava.htm#GUID-6ED38345-63A3-490E-84A6-037C42B3164F">About Performing Namespace Operations as Session User</a>&#34;</span>.</p>
<p>It is possible to reassign a specific application user to take over this session. In this case, some of the state of the session for the anonymous user is still preserved. For details, see <span class="q">&#34;<a href="midtierjava.htm#GUID-4D8AEEB1-29BF-4813-9023-4EA8FB21E5D9">Assigning or Switching an Application User</a>&#34;</span>.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-583E51CC-E332-4649-A00F-B6ED09D4F27E__BGBJJCCB">
<p class="titleinexample">Example 6-2 How to Create a Real Application Security Session in Java</p>
<pre dir="ltr">Session lws = null;
static XSSessionManager manager;
static Connection lwsConn = null;
static String user = &#34;lwuser&#34;;
String cookie=&#34;nst&#34;;
...
<span class="bold">lws = manager.createSession(lwsConn, user, cookie, null);</span>
...
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DBFSG466"></a><a id="DBFSG467"></a><a id="DBFSG465"></a>
<div class="props_rev_3"><a id="GUID-3C2EC26F-6493-41E2-BD52-B5923FEE8E8A"></a>
<h3 id="DBFSG-GUID-3C2EC26F-6493-41E2-BD52-B5923FEE8E8A" class="sect3">Attaching An Application Session</h3>
<div>
<div class="section">
<p>To attach an application <a id="d25928e2312" class="indexterm-anchor"></a>session, use the <code class="codeph">attachSession</code> method of the <code class="codeph">XSSessionManager</code> class (see <a href="midtierjava.htm#GUID-3C2EC26F-6493-41E2-BD52-B5923FEE8E8A__BABJCJBI">Example 6-3</a>). The <code class="codeph">attachSession</code> method (in bold typeface) attaches the JDBC connection to the specified Real Application Security application session object. It also enables or disables the dynamic application roles, creates namespaces of the session, and sets the authentication time.</p>
<p>You can also attach to a session by using either ID or cookie as shown in <a href="midtierjava.htm#GUID-3C2EC26F-6493-41E2-BD52-B5923FEE8E8A__CHDIHFHI">Example 6-4</a>. See <a href="external_roles.htm#GUID-778E2431-6A9D-4566-8D17-DF95C2FB708D__CHDBGHHC">Example 7-2</a> for another example of attaching to a session by using a cookie.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-3C2EC26F-6493-41E2-BD52-B5923FEE8E8A__BABJCJBI">
<p class="titleinexample">Example 6-3 How to Attach a Real Application Security Session in Java</p>
<pre dir="ltr">Session lws = null;
static Connection lwsConn = null;
static XSSessionManager manager;
static String user = &#34;lwuser&#34;;
String cookie = &#34;lwscookie&#34;;
List &lt;String&gt; edynamicRoles = new ArrayList &lt;String&gt;();
edynamicRoles.add(&#34;EDYNROLE001&#34;);
edynamicRoles.add(&#34;EDYNROLE002&#34;);
List &lt;String&gt; ddynamicRoles = new ArrayList &lt;String&gt;();
ddynamicRoles.add(&#34;DDYNROLE001&#34;);
ddynamicRoles.add(&#34;DDYNROLE002&#34;);
...
lws = manager.createSession(lwsConn, user, cookie, null);
<span class="bold">manager.attachSession(lwsConn, lws, edynamicRoles, ddynamicRoles, null, new Timestamp(System.currentTimeMillis()));</span>
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-3C2EC26F-6493-41E2-BD52-B5923FEE8E8A__CHDIHFHI">
<p class="titleinexample">Example 6-4 How to Attach Using a Cookie</p>
<pre dir="ltr">Session lws = null;
static Connection lwsConn = null;
static XSSessionManager manager;
...
lws = manager.attachSessionByCookie(lwsConn, &#34;myCookie&#34;, null, null, null, null, null);
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DBFSG471"></a><a id="DBFSG472"></a><a id="DBFSG470"></a>
<div class="props_rev_3"><a id="GUID-4D8AEEB1-29BF-4813-9023-4EA8FB21E5D9"></a>
<h3 id="DBFSG-GUID-4D8AEEB1-29BF-4813-9023-4EA8FB21E5D9" class="sect3">Assigning or Switching an Application User</h3>
<div>
<div class="section">
<p>If you have an <a id="d25928e2457" class="indexterm-anchor"></a>anonymous session, you can reassign it to another application user later. Otherwise, if your session is assigned to an application user already, you can switch the session to another application user. In either case, the session must be attached first, before assigning or switching an application user.</p>
<p>To assign a name to a previously anonymous application user, use the <code class="codeph">assignUser</code> method of the <code class="codeph">XSSessionManager</code> class (see <a href="midtierjava.htm#GUID-4D8AEEB1-29BF-4813-9023-4EA8FB21E5D9__BABJABAB">Example 6-5</a>). The <code class="codeph">assignUser</code> method (in bold typeface) changes the session context (user and roles) to the given user, for example, <code class="codeph">lwuser</code>, but keeps the existing namespace. It can also change the session at the same time, by any given dynamic roles and namespace parameters, in the same way as the <code class="codeph">attachSession</code> method. The associated session attributes remain in effect unless they are removed through another call.</p>
<p>To change a session user from a named user (non-anonymous) to another named user, use the <code class="codeph">switchUser</code> method of the Session object.</p>
<p>Any request for retaining the dynamic application roles, which were assigned while attaching the session, is disabled. The dynamic application roles are retained for the new application user only when they are also included in the dynamic application roles list for the new application user. The associated session attributes remain in effect unless the session attributes list is reset.</p>
<p>This method changes the session context (user and roles) to the target user (see <span class="q">&#34;<a href="sessions.htm#GUID-CC76B226-1A50-4E2E-9569-8970B1EA2EF3">Switching Current Application User to Another Application User in Current Application Session</a>&#34;</span> for details about roles change), but <span class="italic">not</span> keeping the existing namespace by default. If you want to retain the existing namespace, you can use the <code class="codeph">switchUserKeepState</code> method of the Session object. It can also change the session at the same time, by any given dynamic roles and namespace parameters, in the same way as the <code class="codeph">attachSession</code> method.</p>
<p><a href="midtierjava.htm#GUID-4D8AEEB1-29BF-4813-9023-4EA8FB21E5D9__BABDIGAE">Example 6-6</a> demonstrates how to switch the application user from <code class="codeph">lwuser</code> to <code class="codeph">lwuser1</code>. The <code class="codeph">switchUser</code> method is in bold typeface.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-4D8AEEB1-29BF-4813-9023-4EA8FB21E5D9__BABJABAB">
<p class="titleinexample">Example 6-5 How to Assign an Application User to a Session in Java</p>
<pre dir="ltr">Session lws = null;
static XSSessionManager manager;
static String user = &#34;lwuser&#34;;
...
<span class="bold">manager.assignUser(lws, user, null, null, null, new Timestamp(System.currentTimeMillis()));</span>
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-4D8AEEB1-29BF-4813-9023-4EA8FB21E5D9__BABDIGAE">
<p class="titleinexample">Example 6-6 How to Switch an Application User in a Session in Java</p>
<pre dir="ltr">Session lws = null;
Vector&lt;String&gt; listOfNamespaces;
static String user = &#34;lwuser&#34;;
List&lt;String&gt; nslist1 = new ArrayList&lt;String&gt;();
...
manager.assignUser(lws, user, nslist1, nslist2, nslist3, new Timestamp(System.currentTimeMillis()));
...
<span class="bold">lws.switchUser(&#34;lwuser1&#34;,listOfNamespaces);</span>
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DBFSG473"></a>
<div class="props_rev_3"><a id="GUID-930E5B82-A24B-482C-BCB6-44113251D5C8"></a>
<h3 id="DBFSG-GUID-930E5B82-A24B-482C-BCB6-44113251D5C8" class="sect3">Enabling Real Application Security Application Roles</h3>
<div>
<div class="section">
<p>A Real Application Security <a id="d25928e2639" class="indexterm-anchor"></a>application role is a role that can be granted only to a Real Application Security application user or to another Real Application Security application role. Real Application Security application roles are granted database privileges through database roles. The database privileges are granted to a database role, which in turn is granted to a Real Application Security application role. For more information about Real Application Security application users and application roles, refer to <span class="q">&#34;<a href="intro.htm#GUID-75ECE2BF-08EE-451E-B303-43DB307382F6">Principals: Users and Roles</a>&#34;</span>.</p>
<p>This section describes the following operation associated with application roles:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><a href="midtierjava.htm#GUID-51C12565-C2CE-4406-8152-3D67D4001A9B">Enabling a Real Application Security Application Role</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-A56BB20C-9ED7-440E-8B44-3F7ECD55C4D9">Disabling a Real Application Security Application Role</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-52F935A4-BBFB-4EB7-81B9-8F4A02CE8FD7">Checking If a Real Application Security Application Role Is Enabled</a></p>
</li>
</ul>
</div>
<!-- class="section" --></div>
<a id="DBFSG475"></a><a id="DBFSG474"></a>
<div class="props_rev_3"><a id="GUID-51C12565-C2CE-4406-8152-3D67D4001A9B"></a>
<h4 id="DBFSG-GUID-51C12565-C2CE-4406-8152-3D67D4001A9B" class="sect4">Enabling a Real Application Security Application Role</h4>
<div>
<div class="section">
<p>To enable a Real Application Security application <a id="d25928e2776" class="indexterm-anchor"></a>role granted to the current application user for the session, use the <code class="codeph">enableRole</code> method of the <code class="codeph">Session</code> interface (see <a href="midtierjava.htm#GUID-51C12565-C2CE-4406-8152-3D67D4001A9B__BABIFEGI">Example 6-7</a>).</p>
<p>The <code class="codeph">enableRole</code> method (in bold typeface) has no effect if the particular application role is currently disabled. This operation requires a database round-trip.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-51C12565-C2CE-4406-8152-3D67D4001A9B__BABIFEGI">
<p class="titleinexample">Example 6-7 How to Enable a Real Application Security Application Role in Java</p>
<pre dir="ltr">static Session lws;
static Roles r1;
...
r1=new Role(&#34;HROLE1&#34;,null,0);
<span class="bold">lws.enableRole(r1);</span>
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DBFSG477"></a><a id="DBFSG476"></a>
<div class="props_rev_3"><a id="GUID-A56BB20C-9ED7-440E-8B44-3F7ECD55C4D9"></a>
<h4 id="DBFSG-GUID-A56BB20C-9ED7-440E-8B44-3F7ECD55C4D9" class="sect4">Disabling a Real Application Security Application Role</h4>
<div>
<div class="section">
<p>To disable a Real Application Security <a id="d25928e2910" class="indexterm-anchor"></a>application role granted to the current user for the session, use the <code class="codeph">disableRole</code> method of the <code class="codeph">Session</code> interface (see <a href="midtierjava.htm#GUID-A56BB20C-9ED7-440E-8B44-3F7ECD55C4D9__BABJJGHA">Example 6-8</a>). This operation requires a database round-trip. The <code class="codeph">disableRole</code> method is in bold typeface.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-A56BB20C-9ED7-440E-8B44-3F7ECD55C4D9__BABJJGHA">
<p class="titleinexample">Example 6-8 How to Disable a Real Application Security Application Role in Java</p>
<pre dir="ltr">static Session lws;
static Roles r1;
...
r1=new Role(&#34;HROLE1&#34;,null,0);
lws.enableRole(r1);
...
<span class="bold">lws.disableRole(r1);</span>
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DBFSG479"></a><a id="DBFSG478"></a>
<div class="props_rev_3"><a id="GUID-52F935A4-BBFB-4EB7-81B9-8F4A02CE8FD7"></a>
<h4 id="DBFSG-GUID-52F935A4-BBFB-4EB7-81B9-8F4A02CE8FD7" class="sect4">Checking If a Real Application Security Application Role Is Enabled</h4>
<div>
<div class="section">
<p>To test if the specified application <a id="d25928e3043" class="indexterm-anchor"></a>role is enabled in the Real Application Security application session, use the <a id="d25928e3048" class="indexterm-anchor"></a><code class="codeph">isRoleEnabled</code> method of the <code class="codeph">Session</code> interface (see <a href="midtierjava.htm#GUID-52F935A4-BBFB-4EB7-81B9-8F4A02CE8FD7__BABDCGIJ">Example 6-9</a>). The <code class="codeph">isRoleEnabled</code> method is in bold typeface.</p>
<p>This method does not have an associated database operation. You must have the <code class="codeph">administerSession</code> Real Application Security application privilege to call this method.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-52F935A4-BBFB-4EB7-81B9-8F4A02CE8FD7__BABDCGIJ">
<p class="titleinexample">Example 6-9 How to Test If a Real Application Security Application Role Is Enabled in Java</p>
<pre dir="ltr">static Session lws;
...
lws.enableRole(&#34;HROLE1&#34;);
...
<span class="bold">boolean b = lws.isRoleEnabled(&#34;HROLE1&#34;);</span>
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<a id="DBFSG99901"></a>
<div class="props_rev_3"><a id="GUID-6ED38345-63A3-490E-84A6-037C42B3164F"></a>
<h3 id="DBFSG-GUID-6ED38345-63A3-490E-84A6-037C42B3164F" class="sect3">About Performing Namespace Operations as Session User</h3>
<div>
<p>A namespace is a group of <a id="d25928e3181" class="indexterm-anchor"></a>additional attributes of the session context. An application uses a namespace to store application defined attribute-value pairs. The current session user should have <code class="codeph">MODIFY_NAMESPACE</code> (for namespace) and <code class="codeph">MODIFY_ATTRIBUTE</code> (for attribute) application privileges. For more information about namespaces, refer to <span class="q">&#34;<a href="sessions.htm#GUID-0B1ED666-0401-4050-BE4E-EF375752A39B">About Using Namespace Templates to Create Namespaces</a>&#34;</span>.</p>
<p>This section describes how to perform the following activities:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="midtierjava.htm#GUID-F96DD9EA-EF6D-41D9-B64C-4C3CEE69E304">Creating Namespaces</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-07954A29-1F53-4609-9F69-7A883972E6D0">Deleting Namespaces</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-FCF83764-6C46-4B38-97E1-92D01F7D16B2">Implicitly Creating Namespaces</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-D7FC21CA-68C1-4890-80BF-379C0D7445FC">About Using Namespace Attributes</a></p>
</li>
</ul>
</div>
<a id="DBFSG99903"></a><a id="DBFSG99902"></a>
<div class="props_rev_3"><a id="GUID-F96DD9EA-EF6D-41D9-B64C-4C3CEE69E304"></a>
<h4 id="DBFSG-GUID-F96DD9EA-EF6D-41D9-B64C-4C3CEE69E304" class="sect4">Creating Namespaces</h4>
<div>
<div class="section">
<p>To create a namespace in Java, use the <code class="codeph">createNamespace</code> method of the <code class="codeph">Session</code> interface (see <a href="midtierjava.htm#GUID-F96DD9EA-EF6D-41D9-B64C-4C3CEE69E304__BGBEFDHB">Example 6-10</a>). The <code class="codeph">createNamespace</code> method (in bold typeface) creates a new session namespace <a id="d25928e3339" class="indexterm-anchor"></a>using the namespace template document, whose name matches with the specified name. If an event handler is specified in the template document, then the specified event handler applies to all the namespaces created using that template.</p>
<div class="infobox-note" id="GUID-F96DD9EA-EF6D-41D9-B64C-4C3CEE69E304__GUID-ED2842BE-9C6F-4A3F-B52D-95EFEB92C2B9">
<p class="notep1">Note:</p>
<p>You can also create a namespace by passing a namespace name as a parameter with the <code class="codeph">createSession</code> and <code class="codeph">attachSession</code> methods discussed in the previous sections.</p>
</div>
</div>
<!-- class="section" -->
<div class="example" id="GUID-F96DD9EA-EF6D-41D9-B64C-4C3CEE69E304__BGBEFDHB">
<p class="titleinexample">Example 6-10 How to Create a Namespace in Java</p>
<pre dir="ltr">Session lws = null;
...
<span class="bold">SessionNamespace ns = lws.createNamespace(&#34;TESTNS1&#34;);</span>
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DBFSG99927"></a><a id="DBFSG99926"></a>
<div class="props_rev_3"><a id="GUID-07954A29-1F53-4609-9F69-7A883972E6D0"></a>
<h4 id="DBFSG-GUID-07954A29-1F53-4609-9F69-7A883972E6D0" class="sect4">Deleting Namespaces</h4>
<div>
<div class="section">
<p>To delete a <a id="d25928e3469" class="indexterm-anchor"></a>namespace in Java, use the <code class="codeph">deleteNamespace</code> method of the <code class="codeph">Session</code> interface (see <a href="midtierjava.htm#GUID-07954A29-1F53-4609-9F69-7A883972E6D0__BGBEIACD">Example 6-11</a>). The <code class="codeph">deleteNamespace</code> method (in bold typeface) removes a namespace from a session.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-07954A29-1F53-4609-9F69-7A883972E6D0__BGBEIACD">
<p class="titleinexample">Example 6-11 How to Delete a Namespace in Java</p>
<pre dir="ltr">Session lws = null;
...
SessionNamespace ns = lws.createNamespace(&#34;TESTNS1&#34;);
...
<span class="bold">lws.deleteNamespace(&#34;TESTNS1&#34;);</span>
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DBFSG99905"></a><a id="DBFSG99904"></a>
<div class="props_rev_3"><a id="GUID-FCF83764-6C46-4B38-97E1-92D01F7D16B2"></a>
<h4 id="DBFSG-GUID-FCF83764-6C46-4B38-97E1-92D01F7D16B2" class="sect4">Implicitly Creating Namespaces</h4>
<div>
<div class="section">
<p>To implicitly <a id="d25928e3602" class="indexterm-anchor"></a>create the namespace object to represents the session namespace, use the <code class="codeph">getNamespace</code> method of the <code class="codeph">Session</code> interface (see <a href="midtierjava.htm#GUID-FCF83764-6C46-4B38-97E1-92D01F7D16B2__BGBCDFGB">Example 6-12</a>). The <code class="codeph">getNamespace</code> method is in bold typeface. If the namespace specified already exists, an error is thrown.</p>
<p>To retrieve a String representation of the namespace, use the <a id="d25928e3620" class="indexterm-anchor"></a><code class="codeph">toString</code> method of the <code class="codeph">SessionNamespace</code> interface.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-FCF83764-6C46-4B38-97E1-92D01F7D16B2__BGBCDFGB">
<p class="titleinexample">Example 6-12 How to Implicitly Create the Namespace in Java</p>
<pre dir="ltr">Session lws = null;
...
<span class="bold">SessionNamespace ns2 = lws.getNamespace(&#34;TESTNS1&#34;);</span>
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DBFSG99909"></a>
<div class="props_rev_3"><a id="GUID-D7FC21CA-68C1-4890-80BF-379C0D7445FC"></a>
<h4 id="DBFSG-GUID-D7FC21CA-68C1-4890-80BF-379C0D7445FC" class="sect4">About Using Namespace Attributes</h4>
<div>
<p>A session namespace <a id="d25928e3743" class="indexterm-anchor"></a>manages the attributes that a single application module stores for the duration of the session. The session namespace stores the attributes in a single namespace, a single set of access control restrictions, or a single event handler procedure that dispatches the attribute change events for that namespace.</p>
<p>This section describes how to perform the following activities:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="midtierjava.htm#GUID-941BB32F-DCE5-42EE-AA1A-576BC0577E57">Creating a Session Namespace Attribute</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-BEF803A4-9CE4-4F82-B31A-FFC5C1C0E567">About Setting a Session Namespace Attributes</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-B1C5CF5C-A134-4FE8-922C-A64292895DB2">Getting a Session Namespace Attributes</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-29C27170-36F2-449C-82E4-9DD0687BFE6E">Listing Attributes</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-8873B2F2-80C5-4F88-8E3F-05471C94DE29">Resetting Attributes</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-4679C940-38C5-4013-997A-7A4D45184508">Deleting Attributes</a></p>
</li>
</ul>
</div>
<a id="DBFSG99911"></a><a id="DBFSG99910"></a>
<div class="props_rev_3"><a id="GUID-941BB32F-DCE5-42EE-AA1A-576BC0577E57"></a>
<h5 id="DBFSG-GUID-941BB32F-DCE5-42EE-AA1A-576BC0577E57" class="sect5">Creating a Session Namespace Attribute</h5>
<div>
<div class="section">
<p>To create a <a id="d25928e3889" class="indexterm-anchor"></a>session namespace attribute in Java, use the <code class="codeph">createAttribute</code> method of the <code class="codeph">SessionNamespace</code> interface (see <a href="midtierjava.htm#GUID-941BB32F-DCE5-42EE-AA1A-576BC0577E57__BGBGEEGH">Example 6-13</a>). The <code class="codeph">createAttribute</code> method (in bold typeface) creates a new attribute in the namespace.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-941BB32F-DCE5-42EE-AA1A-576BC0577E57__BGBGEEGH">
<p class="titleinexample">Example 6-13 How to Create a Session Namespace Attribute in Java</p>
<pre dir="ltr">String name1=&#34;empid&#39;;
String value1=&#34;JB007&#34;;
SessionNamespace ns;
...
<span class="bold">SessionNamespaceAttribute sa1=ns.createAttribute(name1,value1);</span>
...
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DBFSG480"></a>
<div class="props_rev_3"><a id="GUID-BEF803A4-9CE4-4F82-B31A-FFC5C1C0E567"></a>
<h5 id="DBFSG-GUID-BEF803A4-9CE4-4F82-B31A-FFC5C1C0E567" class="sect5">About Setting a Session Namespace Attributes</h5>
<div>
<p>To set a <a id="d25928e4018" class="indexterm-anchor"></a>session namespace attribute in Java, use the <code class="codeph">setAttribute</code> method of the <code class="codeph">SessionNamespace</code> interface.</p>
</div>
</div>
<a id="DBFSG99913"></a><a id="DBFSG99912"></a>
<div class="props_rev_3"><a id="GUID-B1C5CF5C-A134-4FE8-922C-A64292895DB2"></a>
<h5 id="DBFSG-GUID-B1C5CF5C-A134-4FE8-922C-A64292895DB2" class="sect5">Getting a Session Namespace Attributes</h5>
<div>
<div class="section">
<p>To retrieve <a id="d25928e4138" class="indexterm-anchor"></a>a session namespace attribute in Java, use the <code class="codeph">getAttribute</code> method of the <code class="codeph">SessionNamespace</code> interface (see <a href="midtierjava.htm#GUID-B1C5CF5C-A134-4FE8-922C-A64292895DB2__BGBFFFAD">Example 6-14</a>). The <code class="codeph">getAttribute</code> method (in bold typeface) returns the attribute whose name is specified as the parameter.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-B1C5CF5C-A134-4FE8-922C-A64292895DB2__BGBFFFAD">
<p class="titleinexample">Example 6-14 How to Retrieve a Session Namespace Attribute in Java</p>
<pre dir="ltr">String name=&#34;empid&#39;;
String value=&#34;JB007&#34;;
SessionNamespace ns;
...
SessionNamespaceAttribute sa=ns.createAttribute(name,value);
...
<span class="bold">String attrvalue =  ns.getAttribute(&#34;empid&#34;).getValue();</span>
<span class="bold">ns.getAttribute(&#34;empid&#34;).setValue(&#34;newValue&#34;);</span>
...
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DBFSG99921"></a><a id="DBFSG99920"></a>
<div class="props_rev_3"><a id="GUID-29C27170-36F2-449C-82E4-9DD0687BFE6E"></a>
<h5 id="DBFSG-GUID-29C27170-36F2-449C-82E4-9DD0687BFE6E" class="sect5">Listing Attributes</h5>
<div>
<div class="section">
<p>To list the attributes <a id="d25928e4273" class="indexterm-anchor"></a>in the namespace, use the <code class="codeph">listAttributes</code> method of the <code class="codeph">SessionNamespace</code> interface (see <a href="midtierjava.htm#GUID-29C27170-36F2-449C-82E4-9DD0687BFE6E__BGBFJEAC">Example 6-15</a>). The <code class="codeph">listAttributes</code> method (in bold typeface) returns a collection of the attribute names in the namespace</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-29C27170-36F2-449C-82E4-9DD0687BFE6E__BGBFJEAC">
<p class="titleinexample">Example 6-15 How to List Attributes in Java</p>
<pre dir="ltr">String name1=&#34;empid&#39;;
String value1=&#34;JB007&#34;;
SessionNamespace ns;
...
SessionNamespaceAttribute sa1=ns.createAttribute(name1,value1);
...
<span class="bold">for (Enumeration e = ns.listAttributes() ; e.hasMoreElements() ;)</span> {
 System.out.println(&#34;   -- &#34; + e.nextElement());
}
...
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DBFSG99923"></a><a id="DBFSG99922"></a>
<div class="props_rev_3"><a id="GUID-8873B2F2-80C5-4F88-8E3F-05471C94DE29"></a>
<h5 id="DBFSG-GUID-8873B2F2-80C5-4F88-8E3F-05471C94DE29" class="sect5">Resetting Attributes</h5>
<div>
<div class="section">
<p>To reset an <a id="d25928e4405" class="indexterm-anchor"></a>attribute in Java, use the <code class="codeph">resetAttribute</code> method of the <code class="codeph">SessionNamespace</code> interface (see <a href="midtierjava.htm#GUID-8873B2F2-80C5-4F88-8E3F-05471C94DE29__BGBIEIGE">Example 6-16</a>). The <code class="codeph">resetAttribute</code> method (in bold typeface) resets the attribute in the namespace to its default value.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-8873B2F2-80C5-4F88-8E3F-05471C94DE29__BGBIEIGE">
<p class="titleinexample">Example 6-16 How to Reset an Attribute in Java</p>
<pre dir="ltr">String name1=&#34;empid&#39;;
String value1=&#34;JB007&#34;;
SessionNamespace ns;
...
SessionNamespaceAttribute sa1=ns.createAttribute(name1,value1);
...
<span class="bold">ns.resetAttribute(&#34;empid&#34;);</span>
...
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DBFSG99925"></a><a id="DBFSG99924"></a>
<div class="props_rev_3"><a id="GUID-4679C940-38C5-4013-997A-7A4D45184508"></a>
<h5 id="DBFSG-GUID-4679C940-38C5-4013-997A-7A4D45184508" class="sect5">Deleting Attributes</h5>
<div>
<div class="section">
<p>To delete <a id="d25928e4538" class="indexterm-anchor"></a>an attribute in Java, use the <a id="d25928e4543" class="indexterm-anchor"></a><code class="codeph">deleteAttribute</code> method of the <code class="codeph">SessionNamespace</code> interface (see <a href="midtierjava.htm#GUID-4679C940-38C5-4013-997A-7A4D45184508__BGBHJDED">Example 6-17</a>). The <code class="codeph">deleteAttribute</code> method (in bold typeface) deletes the particular attribute in the namespace.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-4679C940-38C5-4013-997A-7A4D45184508__BGBHJDED">
<p class="titleinexample">Example 6-17 How to Delete an Attribute in Java</p>
<pre dir="ltr">String name1=&#34;empid&#39;;
String value1=&#34;JB007&#34;;
SessionNamespace ns;
...
SessionNamespaceAttribute sa1=ns.createAttribute(name1,value1);
...
<span class="bold">ns.deleteAttribute(&#34;empid&#34;);</span>
...
</pre></div>
<!-- class="example" --></div>
</div>
</div>
</div>
<a id="DBFSG682"></a>
<div class="props_rev_3"><a id="GUID-ED231373-C97C-436C-9EF1-BDC33D723B9D"></a>
<h3 id="DBFSG-GUID-ED231373-C97C-436C-9EF1-BDC33D723B9D" class="sect3">About Performing Namespace Operations as Session Manager</h3>
<div>
<p>Each namespace has <a id="d25928e4672" class="indexterm-anchor"></a>an associated ACL to determine who can manipulate the namespace and its attributes. If an application does not want the current session user to manipulate the namespace, but allows a session manager to do it, this can be done as session manager <code class="codeph">XSSessionManager</code>.</p>
<p><code class="codeph">XSSessionManager</code> has a set of overloaded methods as Session, to manage the namespace. The usage is similar to that described for session user in <span class="q">&#34;<a href="midtierjava.htm#GUID-6ED38345-63A3-490E-84A6-037C42B3164F">About Performing Namespace Operations as Session User</a>&#34;</span>.</p>
<p>Note that the session manager instance <code class="codeph">XSSessionManager</code> may not be available to the application code; only the trusted infrastructure layer can use the session manager to manipulate such a secured namespace.</p>
</div>
</div>
<a id="DBFSG481"></a>
<div class="props_rev_3"><a id="GUID-1A982585-B7E7-4AB7-92F3-B5B07C240AF8"></a>
<h3 id="DBFSG-GUID-1A982585-B7E7-4AB7-92F3-B5B07C240AF8" class="sect3">About Performing Miscellaneous Session-Related Activities</h3>
<div>
<p>This section describes the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="midtierjava.htm#GUID-1076C1C0-E2AB-42EE-BE5B-9E0D696ADC76">About Getting the Oracle Connection Associated with the Session</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-20026189-D342-40D1-8629-462020DD4D67">About Getting the Application User ID for the Session</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-121ABCE5-04D8-41DB-8A6D-21C8AAD73EF7">Getting the Session ID for the Session</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-27784741-9900-41B7-9D35-4D7866D26D4B">About Getting a String Representation of the Session</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-8E4A0C2D-1B6A-4C91-99A2-502397F154A6">Getting the Session Cookie</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-8481DB9B-7085-4F2B-8C96-27A81F18CEFA">Setting Session Inactivity Timeout as Session Manager</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-23E01854-C532-4A86-AB09-B4C10342410D">Setting the Session Cookie as Session Manager</a></p>
</li>
</ul>
</div>
<a id="DBFSG482"></a>
<div class="props_rev_3"><a id="GUID-1076C1C0-E2AB-42EE-BE5B-9E0D696ADC76"></a>
<h4 id="DBFSG-GUID-1076C1C0-E2AB-42EE-BE5B-9E0D696ADC76" class="sect4">About Getting the Oracle Connection Associated with the Session</h4>
<div>
<p>To get the Oracle connection <a id="d25928e4940" class="indexterm-anchor"></a>associated with the session, if it is currently bound to one, use the <code class="codeph">getConnection</code> method of the <code class="codeph">Session</code> interface.</p>
</div>
</div>
<a id="DBFSG483"></a>
<div class="props_rev_3"><a id="GUID-20026189-D342-40D1-8629-462020DD4D67"></a>
<h4 id="DBFSG-GUID-20026189-D342-40D1-8629-462020DD4D67" class="sect4">About Getting the Application User ID for the Session</h4>
<div>
<p>To get the application <a id="d25928e5056" class="indexterm-anchor"></a>user identifier (ID) for a particular session, use the <code class="codeph">getUserId</code> method of the <code class="codeph">Session</code> interface.</p>
<p>To check if the application user for the session is anonymous, use the <code class="codeph">isAnonymous</code> method of the <code class="codeph">Session</code> interface.</p>
</div>
</div>
<a id="DBFSG485"></a><a id="DBFSG484"></a>
<div class="props_rev_3"><a id="GUID-121ABCE5-04D8-41DB-8A6D-21C8AAD73EF7"></a>
<h4 id="DBFSG-GUID-121ABCE5-04D8-41DB-8A6D-21C8AAD73EF7" class="sect4">Getting the Session ID for the Session</h4>
<div>
<div class="section">
<p>To get the session <a id="d25928e5184" class="indexterm-anchor"></a>identifier (ID) for a particular session, use the <code class="codeph">getId</code> method of the <code class="codeph">Session</code> interface (see <a href="midtierjava.htm#GUID-121ABCE5-04D8-41DB-8A6D-21C8AAD73EF7__BABJIIIH">Example 6-18</a>). The <code class="codeph">getId</code> method is in bold typeface.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-121ABCE5-04D8-41DB-8A6D-21C8AAD73EF7__BABJIIIH">
<p class="titleinexample">Example 6-18 How to Get the Session ID for the Session in Java</p>
<pre dir="ltr">Session lws=null;
...
<span class="bold">System.out.println( &#34;The Session ID is&#34; +  lws.getId());</span>
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DBFSG488"></a>
<div class="props_rev_3"><a id="GUID-27784741-9900-41B7-9D35-4D7866D26D4B"></a>
<h4 id="DBFSG-GUID-27784741-9900-41B7-9D35-4D7866D26D4B" class="sect4">About Getting a String Representation of the Session</h4>
<div>
<p>To get a String representation of <a id="d25928e5313" class="indexterm-anchor"></a>the session, use the <code class="codeph">toString</code> method of the <code class="codeph">Session</code> interface.</p>
</div>
</div>
<a id="DBFSG493"></a><a id="DBFSG492"></a>
<div class="props_rev_3"><a id="GUID-8E4A0C2D-1B6A-4C91-99A2-502397F154A6"></a>
<h4 id="DBFSG-GUID-8E4A0C2D-1B6A-4C91-99A2-502397F154A6" class="sect4">Getting the Session Cookie</h4>
<div>
<div class="section">
<p>To get the secure session <a id="d25928e5432" class="indexterm-anchor"></a>cookie used for the session, use the <code class="codeph">getSessionCookie</code> method of the <code class="codeph">Session</code> interface (see <a href="midtierjava.htm#GUID-8E4A0C2D-1B6A-4C91-99A2-502397F154A6__BABBGHHH">Example 6-19</a>). The <code class="codeph">getSessionCookie</code> method is in bold typeface.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-8E4A0C2D-1B6A-4C91-99A2-502397F154A6__BABBGHHH">
<p class="titleinexample">Example 6-19 How to Get the Secure Session Cookie in Java</p>
<pre dir="ltr">static Session lws;
...
<span class="bold">System.out.println(lws.getSessionCookie())</span>;
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DBFSG489"></a>
<div class="props_rev_3"><a id="GUID-8481DB9B-7085-4F2B-8C96-27A81F18CEFA"></a>
<h4 id="DBFSG-GUID-8481DB9B-7085-4F2B-8C96-27A81F18CEFA" class="sect4">Setting Session Inactivity Timeout as Session Manager</h4>
<div>
<div class="section">
<p>To set the timeout on the <a id="d25928e5563" class="indexterm-anchor"></a>session, use the <a id="d25928e5568" class="indexterm-anchor"></a><code class="codeph">setInactivityTimeout</code> method of the <code class="codeph">SessionManager</code> interface. This method sets the session timeout in minutes.</p>
<p>The <code class="codeph">setInactivityTimeout</code> method overrides the normal session timeout configuration. The method is:</p>
<pre dir="ltr">sessionManager.setInactivityTimeout(Session session, int minutes);
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DBFSG491"></a><a id="DBFSG490"></a>
<div class="props_rev_3"><a id="GUID-23E01854-C532-4A86-AB09-B4C10342410D"></a>
<h4 id="DBFSG-GUID-23E01854-C532-4A86-AB09-B4C10342410D" class="sect4">Setting the Session Cookie as Session Manager</h4>
<div>
<div class="section">
<p>To set the secure <a id="d25928e5693" class="indexterm-anchor"></a>session cookie used for the session, use the <a id="d25928e5698" class="indexterm-anchor"></a><code class="codeph">setCookie</code> method of the <code class="codeph">SessionManager</code> interface (see <a href="midtierjava.htm#GUID-23E01854-C532-4A86-AB09-B4C10342410D__BABJJBHF">Example 6-20</a>). The <code class="codeph">setCookie</code> method (in bold typeface) returns the secure session cookie used for this session. The method is:</p>
<pre dir="ltr">sessionManager.setCookie(lws,&#34;newCookieValue&#34;);
</pre></div>
<!-- class="section" -->
<div class="example" id="GUID-23E01854-C532-4A86-AB09-B4C10342410D__BABJJBHF">
<p class="titleinexample">Example 6-20 How to Set the Secure Session Cookie in Java</p>
<pre dir="ltr">static XSSessionManager manager;
...
<span class="bold">manager.sessionManager.setCookie(lws,&#34;chocolate chip&#34;);</span>
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<a id="DBFSG469"></a><a id="DBFSG468"></a>
<div class="props_rev_3"><a id="GUID-1644F4CF-90DE-40BE-AC5C-341372A0DB3B"></a>
<h3 id="DBFSG-GUID-1644F4CF-90DE-40BE-AC5C-341372A0DB3B" class="sect3">Detaching an Application Session</h3>
<div>
<div class="section">
<p>To detach a Real Application Security <a id="d25928e5831" class="indexterm-anchor"></a>application session in Java, use the <code class="codeph">detachSession</code> method of the <code class="codeph">XSSessionManager</code> class (see <a href="midtierjava.htm#GUID-1644F4CF-90DE-40BE-AC5C-341372A0DB3B__BABJFIGH">Example 6-21</a>). The <code class="codeph">detachSession</code> method (in bold typeface) detaches the session whose object it accepts as a parameter. The <code class="codeph">detachSession</code> method call commits all changes in the request at the database level. A database round-trip is required to perform this operation.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-1644F4CF-90DE-40BE-AC5C-341372A0DB3B__BABJFIGH">
<p class="titleinexample">Example 6-21 How to Detach a Real Application Security Session in Java</p>
<pre dir="ltr">Session lws = null;
static XSSessionManager manager;
static Connection lwsConn = null;
static String user = &#34;lwuser&#34;;
String cookie;
...
lws = manager.createSession(lwsConn, user, cookie, null);
manager.attachSession(lwsConn, lws, null, null, null, new Timestamp(System.currentTimeMillis()));
...
<span class="bold">manager.detachSession(lws);</span>
...
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DBFSG99866"></a><a id="DBFSG99865"></a>
<div class="props_rev_3"><a id="GUID-6DACB579-26F2-4641-A4D5-E7DE2A1B0004"></a>
<h3 id="DBFSG-GUID-6DACB579-26F2-4641-A4D5-E7DE2A1B0004" class="sect3">Destroying A Real Application Security Application Session</h3>
<div>
<div class="section">
<p>To destroy <a id="d25928e5968" class="indexterm-anchor"></a>a Real Application Security application session in Java, use the <code class="codeph">destroySession</code> method of the <code class="codeph">XSSessionManager</code> class (see <a href="midtierjava.htm#GUID-6DACB579-26F2-4641-A4D5-E7DE2A1B0004__BGBIJIFH">Example 6-22</a>). The <code class="codeph">destroySession</code> method (in bold typeface) accepts the database connection object and a session object as parameters. After you call this method, the destroyed session can no longer be accessed from any JVM. A database round-trip is required to perform this operation and for create session as well.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-6DACB579-26F2-4641-A4D5-E7DE2A1B0004__BGBIJIFH">
<p class="titleinexample">Example 6-22 How to Destroy a Real Application Security Session in Java</p>
<pre dir="ltr">Session lws = null;
static Connection lwsConn = null;
static XSSessionManager manager;
static String user = &#34;lwuser&#34;;
String cookie;
...
lws = manager.createSession(lwsConn, user, cookie, null);
manager.attachSession(lwsConn, lws, null, null, null, new Timestamp(System.currentTimeMillis()));
...
manager.detachSession(lws);
<span class="bold">manager.destroySession(lwsConn, lws);</span>
...
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<a id="DBFSG99938"></a><a id="DBFSG99937"></a>
<div class="props_rev_3"><a id="GUID-FDF62B47-A13B-4CA1-AA9C-F2EF602FF60F"></a>
<h2 id="DBFSG-GUID-FDF62B47-A13B-4CA1-AA9C-F2EF602FF60F" class="sect2">Authenticating Application Users Using Java APIs</h2>
<div>
<div class="section">
<p>Authenticating application <a id="d25928e6101" class="indexterm-anchor"></a>users is a main security function needed by applications. The <code class="codeph">XSAuthenticationModule</code> class is used for authenticating application users. The <code class="codeph">authenticate</code> method of the <code class="codeph">XSAuthenticationModule</code> class is used to verify the application user credentials (see <a href="midtierjava.htm#GUID-FDF62B47-A13B-4CA1-AA9C-F2EF602FF60F__BGBJHDID">Example 6-23</a>). The <code class="codeph">authenticate</code> method is in bold typeface.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-FDF62B47-A13B-4CA1-AA9C-F2EF602FF60F__BGBJHDID">
<p class="titleinexample">Example 6-23 How to Authenticate Application Users in Java</p>
<pre dir="ltr">boolean authOk = false;
String dbUser;
String passwd;
String host;
String port;
String sid;
...
<span class="bold">authOk = XSAuthenticationModule.authenticate(host + &#34;:&#34; + port + &#34;:&#34; + sid, dbUser, passwd);</span>
...
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DBFSG99928"></a>
<div class="props_rev_3"><a id="GUID-A3A5BE47-E770-4206-8DA8-4A9D70FA89E3"></a>
<h2 id="DBFSG-GUID-A3A5BE47-E770-4206-8DA8-4A9D70FA89E3" class="sect2">About Authorizing Application Users Using ACLs</h2>
<div>
<p>Authorization is another <a id="d25928e6234" class="indexterm-anchor"></a>main security feature needed by applications. In Real Application Security, the authorization policy comprises of the Access Control Lists (ACLs) and the application privileges. They are defined in the Real Application Security database and managed in a cache in the middle tier. The application privileges are data privileges. Data privileges are used to define the access of a function or operation to data. Once a function attaches a connection to the session, any query passed through the connection is automatically enforced by the database server.</p>
<p>The <code class="codeph">AclId</code> class provides various methods to perform the following:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="midtierjava.htm#GUID-99DFC9BD-59D5-40A7-B876-5E0AB52059D1">Constructing an ACL Identifier</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-A6FCD53A-A13B-48BF-9A27-85E453B35747">Using the checkAcl Method</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-AF830025-6F45-4E53-9506-6F6260AF6F4B">About Getting Data Privileges Associated with a Specific ACL</a></p>
</li>
</ul>
</div>
<a id="DBFSG497"></a><a id="DBFSG99929"></a>
<div class="props_rev_3"><a id="GUID-99DFC9BD-59D5-40A7-B876-5E0AB52059D1"></a>
<h3 id="DBFSG-GUID-99DFC9BD-59D5-40A7-B876-5E0AB52059D1" class="sect3">Constructing an ACL Identifier</h3>
<div>
<div class="section">
<p>To construct an <a id="d25928e6368" class="indexterm-anchor"></a>Access Control List (ACL) identifier, use one of the overloaded parameterized constructors of the <code class="codeph">AclId</code> class (see <a href="midtierjava.htm#GUID-99DFC9BD-59D5-40A7-B876-5E0AB52059D1__BGBDEFAE">Example 6-24</a>). If you want to construct an ACL identifier from raw binary data, then use the following constructor:</p>
<pre dir="ltr">public AclId(byte[] raw)
</pre>
<p>When you invoke this constructor, an ACL identifier, using raw binary returned from the <code class="codeph">ora_get_aclids</code> operator of a query, is created.</p>
<p>If you want to construct an ACL identifier from internal ACL identifiers, then use the following constructor:</p>
<pre dir="ltr">public AclId(java.util.List&lt;java.lang.Long&gt; ids)
</pre>
<p>When you invoke this constructor, it creates an ACL identifier using internal ACL identifiers.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-99DFC9BD-59D5-40A7-B876-5E0AB52059D1__BGBDEFAE">
<p class="titleinexample">Example 6-24 How to Construct an ACL Identifier</p>
<pre dir="ltr">Session lws = null;
static byte[] aclRaw;
...
AclId id = new AclId(aclRaw);
boolean ret = lws.checkAcl(aclRaw, &#34;UPDATE_INFO&#34;);
...
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DBFSG498"></a><a id="DBFSG99934"></a>
<div class="props_rev_3"><a id="GUID-A6FCD53A-A13B-48BF-9A27-85E453B35747"></a>
<h3 id="DBFSG-GUID-A6FCD53A-A13B-48BF-9A27-85E453B35747" class="sect3">Using the checkAcl Method</h3>
<div>
<div class="section">
<p>To check one or more ACLs <a id="d25928e6504" class="indexterm-anchor"></a>for specified data privileges, use the <code class="codeph">checkAcl</code> method of the <code class="codeph">XSAccessController</code> class. The data privileges are checked against one or more ACLs defined in the <code class="codeph">AclId</code> object. The <code class="codeph">checkAcl</code> method returns <code class="codeph">true</code> only when all the data privileges are granted in the ACLs. It is important to note that all privileges need not be granted in a single ACL. A session is needed for using the <code class="codeph">checkAcl</code> method as <a href="midtierjava.htm#GUID-A6FCD53A-A13B-48BF-9A27-85E453B35747__BGBCBEIA">Example 6-25</a> indicates.</p>
<p><a href="midtierjava.htm#GUID-A6FCD53A-A13B-48BF-9A27-85E453B35747__BGBCBEIA">Example 6-25</a> demonstrates how to get the ACL associated with data privilege <code class="codeph">privileges22</code>.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-A6FCD53A-A13B-48BF-9A27-85E453B35747__BGBCBEIA">
<p class="titleinexample">Example 6-25 How to get an ACL for a Specified Data Privilege</p>
<pre dir="ltr">boolean ret;
Session lws = null;
AclId id2 = new AclId(ids);
List &lt;String&gt; privileges22 = new ArrayList&lt;String&gt;();
...
ret = XSAccessController.checkAcl(lws, id2, privileges22);
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DBFSG99936"></a>
<div class="props_rev_3"><a id="GUID-AF830025-6F45-4E53-9506-6F6260AF6F4B"></a>
<h3 id="DBFSG-GUID-AF830025-6F45-4E53-9506-6F6260AF6F4B" class="sect3">About Getting Data Privileges Associated with a Specific ACL</h3>
<div>
<p>To get a collection of data <a id="d25928e6647" class="indexterm-anchor"></a>privileges that are granted in the given ACL, for the given session, use the <code class="codeph">getPrivileges</code> method of the <code class="codeph">Session</code> class.</p>
<div class="infobox-note" id="GUID-AF830025-6F45-4E53-9506-6F6260AF6F4B__GUID-0C7C27E4-2FF8-4061-A52A-CCCC76047D49">
<p class="notep1">Note:</p>
<p>You use the <code class="codeph">checkAcl</code> method for data security and the <code class="codeph">checkPrivilege</code> method for function security.</p>
</div>
</div>
</div>
</div>
<a id="DBFSG456"></a><a id="DBFSG501"></a><a id="DBFSG502"></a><a id="DBFSG503"></a><a id="DBFSG504"></a><a id="DBFSG505"></a><a id="DBFSG506"></a><a id="DBFSG500"></a>
<div class="props_rev_3"><a id="GUID-501B93E3-2673-4838-889E-AC1CAC9D9AD3"></a>
<h2 id="DBFSG-GUID-501B93E3-2673-4838-889E-AC1CAC9D9AD3" class="sect2">Human Resources Administration Use Case: Implementation in Java</h2>
<div>
<div class="section">
<p>This section describes how to verify data security related application privileges at the middle tier. This Java<a id="d25928e6781" class="indexterm-anchor"></a> example is based on the Security Human Resources (HR) scenario described in <span class="q">&#34;<a href="data_security.htm#GUID-C6EF75C9-C167-4482-828E-065BD552E0B7">Real Application Security: Putting It All Together</a>&#34;</span>. It uses the <code class="codeph">EMPLOYEES</code> table in the sample <code class="codeph">HR</code> schema. The example uses two Real Application Security application users <code class="codeph">DAUSTIN</code> and <code class="codeph">SMAVRIS</code> to illustrate Real Application Security concepts. The example can be divided into the following modules:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><a href="midtierjava.htm#GUID-501B93E3-2673-4838-889E-AC1CAC9D9AD3__CHDGBCJB">Setting Up the Mid-Tier Related Configuration</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-501B93E3-2673-4838-889E-AC1CAC9D9AD3__CBBJCEEE">Setting up the Connection and Initializing the Middle Tier</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-501B93E3-2673-4838-889E-AC1CAC9D9AD3__CBBDHCEF">Setting up the Session and Authorizing with Middle-Tier API</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-501B93E3-2673-4838-889E-AC1CAC9D9AD3__CBBGGIID">Running a Query on the Database</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-501B93E3-2673-4838-889E-AC1CAC9D9AD3__CBBJCIGH">Performing Cleanup Operations</a></p>
</li>
<li>
<p><a href="midtierjava.htm#GUID-501B93E3-2673-4838-889E-AC1CAC9D9AD3__CBBCBIJJ">The main Method</a></p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section" id="GUID-501B93E3-2673-4838-889E-AC1CAC9D9AD3__CHDGBCJB">
<p class="subhead2">Setting Up the Mid-Tier Related Configuration</p>
</div>
<!-- class="section" -->
<div class="section">
<p>To set up the mid-tier configuration involves creating a <code class="codeph">DISPATCHER</code> user and password and granting this user the <code class="codeph">xscacfeadmin</code> and <code class="codeph">xsessionadmin</code> Real Application Security administrator privileges.</p>
<pre dir="ltr">exec xs_principal.create_user(name=&gt;&#39;dispatcher&#39;, schema=&gt;&#39;HR&#39;);
exec sys.xs_principal.set_password(&#39;dispatcher&#39;, &#39;<span class="italic">password</span>&#39;);

exec xs_principal.grant_roles(&#39;dispatcher&#39;, &#39;xscacheadmin&#39;);
exec xs_principal.grant_roles(&#39;dispatcher&#39;, &#39;xssessionadmin&#39;);
</pre></div>
<!-- class="section" -->
<div class="section" id="GUID-501B93E3-2673-4838-889E-AC1CAC9D9AD3__CBBJCEEE">
<p class="subhead2">Setting up the Connection and Initializing the Middle Tier</p>
</div>
<!-- class="section" -->
<div class="section">
<p>This example <a id="d25928e6856" class="indexterm-anchor"></a>uses the <code class="codeph">setupConnection</code> method to create the connection to the database. The <code class="codeph">setupConnection</code> method accepts a String array as argument, where:</p>
<p><code class="codeph">args[0]</code>=Database user</p>
<p><code class="codeph">args[1]</code>=Password</p>
<p><code class="codeph">args[2]</code>=Host</p>
<p>This method also initializes the middle tier by calling the <code class="codeph">getSessionManager</code> method of the <code class="codeph">oracle.security.xs.XSSecurityManager</code> class.</p>
<pre dir="ltr">  public static void setupConnection(String[] args) throws Exception {
    mgrConnection =
        DriverManager.getConnection(args[2], &#34;dispatcher&#34;, &#34;<span class="italic">password</span>&#34;);
 
    mgr = XSSessionManager.getSessionManager(mgrConnection, 30, 2048000);
   
    appConnection = DriverManager.getConnection(args[2], args[0], args[1]);
  }
</pre></div>
<!-- class="section" -->
<div class="section" id="GUID-501B93E3-2673-4838-889E-AC1CAC9D9AD3__CBBDHCEF">
<p class="subhead2">Setting up the Session and Authorizing with Middle-Tier API</p>
</div>
<!-- class="section" -->
<div class="section">
<p>This example <a id="d25928e6900" class="indexterm-anchor"></a><a id="d25928e6906" class="indexterm-anchor"></a>uses <code class="codeph">queryAsUser</code> method to set up the session and authorize with the middle-tier <code class="codeph">checkAcl</code> method. This example creates a session and attaches the session, and then calls the <code class="codeph">queryEmployees</code> method. The <code class="codeph">queryEmployees</code> method in <span class="q">&#34;<a href="midtierjava.htm#GUID-501B93E3-2673-4838-889E-AC1CAC9D9AD3__CBBGGIID">Running a Query on the Database</a>&#34;</span> checks the ACL for the <code class="codeph">UPDATE</code> privilege, and if <code class="codeph">TRUE</code>, it allows the update; it checks the ACL again for the <code class="codeph">VIEW_SALARY</code> application privilege, and if <code class="codeph">TRUE</code>, it allows access to the <code class="codeph">SALARY</code> column and displays all the employees records including the sensitive data in the <code class="codeph">SALARY</code> column. Then after displaying the employees records, it detaches the session, and destroys the session.</p>
<pre dir="ltr">  private static void queryAsUser(String user) throws SQLException {
   
    System.out.println(&#34;\nQuery HR.EMPLOYEES table as user \&#34;&#34; + user + &#34;\&#34;&#34;);
 
    try {
      Session lws = mgr.createSession(appConnection, user, null,null);
      mgr.attachSession(appConnection, lws, null, null, null, null, null);
 
      queryEmployees(lws);
  
      mgr.detachSession(lws);
      mgr.destroySession(appConnection, lws);
    } catch (Exception e) {
      e.printStackTrace();
    }
  }
</pre></div>
<!-- class="section" -->
<div class="section" id="GUID-501B93E3-2673-4838-889E-AC1CAC9D9AD3__CBBGGIID">
<p class="subhead2">Running a Query on the Database</p>
</div>
<!-- class="section" -->
<div class="section">
<p>This example <a id="d25928e6957" class="indexterm-anchor"></a>uses the <code class="codeph">queryEmployees</code> method to run a query on the HR database.</p>
<pre dir="ltr">  public static void queryEmployees(Session lws) throws SQLException {
 
    Connection conn = lws.getConnection();
    String query =
      &#34; select email, first_name, last_name, department_id, salary, ora_get_aclids(emp) from hr.employees emp where department_id in (40, 60, 100) order by email&#34;;
 
    Statement stmt = null;
    ResultSet rs = null;
 
    System.out.printf(&#34;  EMAIL  | FIRST_NAME | LAST_NAME  | DEPT | SALARY | UPDATE | VIEW_SALARY\n&#34;);
   
    try {
 
      stmt = conn.createStatement();
      rs = stmt.executeQuery(query);
      
      while (rs.next()) {
 
        String email = rs.getString(&#34;EMAIL&#34;);
        String first_name = rs.getString(&#34;FIRST_NAME&#34;);
        String last_name = rs.getString(&#34;LAST_NAME&#34;);
        String department_id = rs.getString(&#34;DEPARTMENT_ID&#34;);
        String salary;
        
        if (((OracleResultSet)rs).getAuthorizationIndicator(&#34;SALARY&#34;) == AuthorizationIndicator.NONE) {
          salary = rs.getString(&#34;SALARY&#34;);
        }
        else {
          salary = &#34;*****&#34;;
        }
 
        byte[] aclRaw = rs.getBytes(6);
        String update, viewSalary;
        if (XSAccessController.checkAcl(lws, aclRaw, &#34;UPDATE&#34;)) {
          update = &#34;true&#34;;
        }
        else {
          update = &#34;false&#34;;
        }
        
        if (XSAccessController.checkAcl(lws, aclRaw, &#34;VIEW_SALARY&#34;)) {
          viewSalary = &#34;true&#34;;
        }
        else {
          viewSalary = &#34;false&#34;;
        }
 
        System.out.printf(&#34;%9s|%12s|%12s|%6s|%8s|%8s|%8s\n&#34;, email, 
                          first_name, last_name, department_id, 
                          salary, update, viewSalary);
       }
    } catch (Exception e) {
      e.printStackTrace();
    } finally {
      try { if (rs != null) rs.close(); } catch (Exception e) {};
      try { if (stmt != null) stmt.close(); } catch (Exception e) {};
    }
  }
}
</pre>
<p>The <code class="codeph">queryEmployees</code> method is run for both application users <code class="codeph">DAUSTIN</code> and <code class="codeph">SMAVRIS</code>.</p>
</div>
<!-- class="section" -->
<div class="section" id="GUID-501B93E3-2673-4838-889E-AC1CAC9D9AD3__CBBJCIGH">
<p class="subhead2">Performing Cleanup Operations</p>
</div>
<!-- class="section" -->
<div class="section">
<p>This examples <a id="d25928e6987" class="indexterm-anchor"></a>uses the <code class="codeph">cleanup</code> method for system cleanup operations.</p>
<pre dir="ltr">  public static void cleanupConnection() throws Exception {
    mgrConnection.close();
    appConnection.close();
 
  }
</pre></div>
<!-- class="section" -->
<div class="section" id="GUID-501B93E3-2673-4838-889E-AC1CAC9D9AD3__CBBCBIJJ">
<p class="subhead2">The main Method</p>
</div>
<!-- class="section" -->
<div class="section">
<p>This section <a id="d25928e7005" class="indexterm-anchor"></a>contains the <code class="codeph">main</code> method for the Java example discussed. This section also contains the different packages that you must import to run the program.</p>
<pre dir="ltr">import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
 
 
import java.util.ArrayList;
import java.util.List;
import oracle.jdbc.OracleDriver;
import oracle.jdbc.OracleResultSet;
import oracle.jdbc.OracleResultSet.AuthorizationIndicator;
 
import oracle.security.xs.Role;
import oracle.security.xs.Session;
import oracle.security.xs.XSAccessController;
import oracle.security.xs.XSSessionManager;
 
/**
 * HR demo java version, check data security related privilege at mid-tier
 */
public class HRDemo {
 
  static Connection mgrConnection = null;
  static Connection appConnection = null;
  static XSSessionManager mgr = null;
  static String user = null;
 
  public static void main(String[] args)  {
 
    try {
      DriverManager.registerDriver(new OracleDriver());
 
 
      if (args.length &gt;=3) {
        user = args[0];
      } else {
        System.out.println(&#34;Usage HRDemo user pwd dbURL&#34;);
        System.exit(1);
      }
 
      setupConnection(args);
 
      queryAsUser(&#34;DAUSTIN&#34;);
      queryAsUser(&#34;SMAVRIS&#34;);
      
      cleanupConnection();
 
    } catch (Exception e1) {
      e1.printStackTrace();
    }
  }
 
</pre></div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Running the Security HR demo in Java assumes that the set up script described in <span class="q">&#34;<a href="security_hr_demo_tutorial.htm#GUID-487A921A-6D51-47C2-8D1E-EBD2C2B7A2A4">Setting Up the Security HR Demo Components</a>&#34;</span> has been run to set up the Real Application Security components.</span></li>
<li class="stepexpand"><span>Compile the Java code.</span>
<div>
<pre dir="ltr">$ORACLE_HOME/jdk6/bin/javac -classpath $ORACLE_HOME/rdbms_ho/jlib/xs.jar:$ORACLE_HOME/dbjava/lib/ojdbc6.jar HRdemo.java
</pre>
<div class="infobox-note" id="GUID-501B93E3-2673-4838-889E-AC1CAC9D9AD3__GUID-8BB95CE3-813F-42C6-8AD5-92F20979B559">
<p class="notep1">Note:</p>
<p>You must use JDK 6 with <code class="codeph">xs.jar</code> and <code class="codeph">ojdbc6.jar</code>, which are located in the Oracle home directory. Different jars and JDK may not work.</p>
</div>
</div>
</li>
<li class="stepexpand"><span>Run the Java code.</span>
<div>
<pre dir="ltr">$ORACLE_HOME/jdk6/bin/java -classpath $ORACLE_HOME/rdbms_ho/jlib/xs.jar:$ORACLE_HOME/dbjava/lib/ojdbc6.jar

HRdemo db_hr db_hr jdbc:oracle:thin:@myserver:myport:mysid
</pre></div>
</li>
</ol>
</div>
<div class="sect3"><a id="CHDDJHBI"></a>
<h3 id="DBFSG-CHDDJHBI" class="sect3">Output</h3>
<div>
<div class="section">
<p>Running the Security HR demo in Java assumes that the set up script described in <span class="q">&#34;<a href="security_hr_demo_tutorial.htm#GUID-487A921A-6D51-47C2-8D1E-EBD2C2B7A2A4">Setting Up the Security HR Demo Components</a>&#34;</span> has been run to set up the Real Application Security components. When you run the Security HR demo, results of two queries are returned.</p>
<p>The first query runs with application user <code class="codeph">DAUSTIN</code>, who has application roles <code class="codeph">EMP_ROLE</code> and <code class="codeph">IT_ROLE</code>, so he can view employee records in the IT department, but he cannot view the <code class="codeph">SALARY</code> column except for his own salary record. The results of the query are as follows:</p>
<pre dir="ltr">Query HR.EMPLOYEES table as user &#34;DAUSTIN&#34;
  EMAIL  | FIRST_NAME | LAST_NAME  | DEPT | SALARY | UPDATE | VIEW_SALARY
  AHUNOLD|   Alexander|      Hunold|    60|   *****|   false|   false
   BERNST|       Bruce|       Ernst|    60|   *****|   false|   false
  DAUSTIN|       David|      Austin|    60|    4800|   false|    true
 DLORENTZ|       Diana|     Lorentz|    60|   *****|   false|   false
 VPATABAL|       Valli|   Pataballa|    60|   *****|   false|   false
</pre>
<p>Note that application user <code class="codeph">DAUSTIN</code> can only view the <code class="codeph">SALARY</code> column data for his own record, and no others.</p>
<p>The second query runs with application user SMAVRIS, who has application roles <code class="codeph">EMP_ROLE</code> and <code class="codeph">HR_ROLE</code>, so she can view and update all the employee records. The results of the query are as follows:</p>
<pre dir="ltr">Query HR.EMPLOYEES table as user &#34;SMAVRIS&#34;
  EMAIL  | FIRST_NAME | LAST_NAME  | DEPT | SALARY | UPDATE | VIEW_SALARY
  AHUNOLD|   Alexander|      Hunold|    60|    9000|    true|    true
   BERNST|       Bruce|       Ernst|    60|    6000|    true|    true
  DAUSTIN|       David|      Austin|    60|    4800|    true|    true
  DFAVIET|      Daniel|      Faviet|   100|    9000|    true|    true
 DLORENTZ|       Diana|     Lorentz|    60|    4200|    true|    true
 ISCIARRA|      Ismael|     Sciarra|   100|    7700|    true|    true
    JCHEN|        John|        Chen|   100|    8200|    true|    true
  JMURMAN| Jose Manuel|       Urman|   100|    7800|    true|    true
    LPOPP|        Luis|        Popp|   100|    6900|    true|    true
 NGREENBE|       Nancy|   Greenberg|   100|   12008|    true|    true
  SMAVRIS|       Susan|      Mavris|    40|    6500|    true|    true
 VPATABAL|       Valli|   Pataballa|    60|    4800|    true|    true
</pre>
<p>Note that application user <code class="codeph">SMAVRIS</code> can view all the employee records, including all data in the <code class="codeph">SALARY</code> column.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5198">
<tr>
<td class="cellalignment5287">
<table class="cellalignment5203">
<tr>
<td class="cellalignment5202"><a href="data_security.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5202"><a href="external_roles.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2012, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5289">
<table class="cellalignment5201">
<tr>
<td class="cellalignment5202"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5202"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5202"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5202"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5202"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5202"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>