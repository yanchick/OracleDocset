<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-86485"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Auditing%20Under%20Oracle%20Label%20Security"></a><title>Auditing Under Oracle Label Security</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="description" content="You can use Oracle Label Security auditing if you have not configured your database to use unified auditing."/>
<meta name="keywords" content="auditing, audit trails, Oracle Label Security, SYSDBA privilege, initialization parameters, AUDIT_TRAIL, AUDIT_TRAIL parameter, systemwide, unified audit trail, strategy"/>
<meta name="dcterms.created" content="2017-03-14T13:38:49Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Label Security Administrator&#39;s Guide"/>
<meta name="dcterms.identifier" content="E48437-08"/>
<meta name="dcterms.isVersionOf" content="OLSAG"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2006, 2015, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="storproc.htm" title="Previous" type="text/html"/>
<link rel="Next" href="multiple.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E48437-08.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-29944AFB-9E18-487E-861C-78543303D814"></a> <span id="PAGE" style="display:none;">17/29</span> <!-- End Header -->
<a id="OLSAG073"></a>
<h1 id="OLSAG-GUID-29944AFB-9E18-487E-861C-78543303D814" class="sect1"><span class="enumeration_chapter">10</span> Auditing Under Oracle Label Security</h1>
<div>
<p>You can use Oracle Label Security auditing if you have not configured your database to use unified auditing.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="audit.htm#GUID-3F768C21-B841-4BA3-96EA-05094428C9CF" title="Oracle Label Security auditing supplements standard Oracle Database auditing by tracking use of its own administrative operations and policy privileges.">About Oracle Label Security Auditing</a></p>
</li>
<li>
<p><a href="audit.htm#GUID-73733435-DB2C-498B-8E4A-1A1200E74090" title="If you have not yet enabled unified auditing, for Oracle Label Security to generate audit records, you must first enable system-wide auditing.">Systemwide Auditing: AUDIT_TRAIL Initialization Parameter</a></p>
</li>
<li>
<p><a href="audit.htm#GUID-AF8D2211-E65D-4627-9497-4098993C486E" title="After you have enabled systemwide auditing, you can enable or disable Oracle Label Security auditing.">How Oracle Label Security Auditing Is Enabled or Disabled</a></p>
</li>
<li>
<p><a href="audit.htm#GUID-1050E8C0-3209-43C8-AC24-D84E8F927F24" title="Oracle Database uses the unified audit trail to capture information from various audit sources, including Oracle Label Security.">Oracle Label Security and Unified Auditing</a></p>
</li>
<li>
<p><a href="audit.htm#GUID-7C2BB514-2FBC-46E8-8983-6D03F06A2E47" title="Oracle provides a set of tips for auditing Oracle Label Security.">Oracle Label Security Auditing Tips</a></p>
</li>
</ul>
</div>
<a id="OLSAG074"></a>
<div class="props_rev_3"><a id="GUID-3F768C21-B841-4BA3-96EA-05094428C9CF"></a>
<h2 id="OLSAG-GUID-3F768C21-B841-4BA3-96EA-05094428C9CF" class="sect2">About Oracle Label Security Auditing</h2>
<div>
<p>Oracle Label Security auditing supplements standard Oracle Database auditing by tracking use of its own administrative operations and policy privileges.</p>
<p>You can use either the <code class="codeph">SA_AUDIT_ADMIN</code> package or Oracle Enterprise Manager to set and change the auditing options for an Oracle Label Security policy.</p>
<p>When you create a new policy, a label column for that policy is added to the database audit trail. The label column is created regardless of whether auditing is enabled or disabled, and independent of whether database auditing or operating system auditing is used. Whenever a record is written to the audit table, each policy provides a label for that record to indicate the session label. The administrator can create audit views to display these labels. Note that in the audit table, the label does not control access to the row, instead it only records the sensitivity of the row.</p>
<p>The auditing options that you specify apply only to subsequent sessions, not to the current session. You can specify audit options even if auditing is disabled. No overhead is created by making only these specifications. When you do enable Oracle Label Security auditing, the options come into effect, and overhead is created beyond that created by standard Oracle Database auditing.</p>
<p>Note that Oracle Label Security does not provide labels for audit data written to the operating system audit trial. All Oracle Label Security audit records are written directly to the database audit trail, even if operating system auditing is enabled. If auditing is disabled, then no Oracle Label Security audit records are generated.</p>
</div>
</div>
<a id="OLSAG3382"></a><a id="OLSAG075"></a>
<div class="props_rev_3"><a id="GUID-73733435-DB2C-498B-8E4A-1A1200E74090"></a>
<h2 id="OLSAG-GUID-73733435-DB2C-498B-8E4A-1A1200E74090" class="sect2">Systemwide Auditing: AUDIT_TRAIL Initialization Parameter</h2>
<div>
<p>If you have not yet enabled unified auditing, for Oracle Label Security to generate audit records, you must first enable system-wide auditing.</p>
<p>To enable system-wide auditing, you can set the Oracle Database <code class="codeph">AUDIT_TRAIL</code> initialization parameter in the database&#39;s parameter file.</p>
<p>You can set the <code class="codeph">AUDIT_TRAIL</code> parameter to one of the following values:</p>
<div class="tblformal" id="GUID-73733435-DB2C-498B-8E4A-1A1200E74090__GUID-164268DE-1B7A-4E13-9F3B-3F0F5BB3A891">
<p class="titleintable">Table 10-1 AUDIT_TRAIL Parameter Settings</p>
<table class="cellalignment3821" title="AUDIT_TRAIL Parameter Settings " summary="This table lists and explains the AUDIT_TRAIL parameter settings. Columns are Setting and Explanation.">
<thead>
<tr class="cellalignment3810">
<th class="cellalignment3941" id="d43450e226">Setting</th>
<th class="cellalignment3942" id="d43450e229">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment3810">
<td class="cellalignment3920" id="d43450e234" headers="d43450e226">
<p><code class="codeph">DB</code></p>
</td>
<td class="cellalignment3943" headers="d43450e234 d43450e229">
<p>Enables database auditing and directs all audit records to the database audit trail. This approach is recommended by Oracle.</p>
<p>Note that even with <code class="codeph">AUDIT_TRAIL</code> set to <code class="codeph">DB</code>, some records are always sent to the operating system audit trail. These include <code class="codeph">STARTUP</code> and <code class="codeph">SHUTDOWN</code> statements, as well as <code class="codeph">CONNECT</code> <code class="codeph">AS</code> <code class="codeph">SYSOPER</code> or <code class="codeph">SYSDBA</code>.</p>
</td>
</tr>
<tr class="cellalignment3810">
<td class="cellalignment3920" id="d43450e269" headers="d43450e226">
<p><code class="codeph">DB</code>, <code class="codeph">EXTENDED</code></p>
</td>
<td class="cellalignment3943" headers="d43450e269 d43450e229">
<p>Does all actions of <code class="codeph">AUDIT_TRAIL=DB</code> and also populates the <code class="codeph">SqlBind</code> and <code class="codeph">SqlText</code> <code class="codeph">CLOB</code>-type columns of the <code class="codeph">AUD$</code> table.</p>
</td>
</tr>
<tr class="cellalignment3810">
<td class="cellalignment3920" id="d43450e295" headers="d43450e226">
<p><code class="codeph">OS</code></p>
</td>
<td class="cellalignment3943" headers="d43450e295 d43450e229">
<p>Enables operating system auditing. This directs most of your Oracle Database audit records to the operating system, rather than to the database; the records will not contain Oracle Label Security labels. By contrast, any Oracle Label Security auditing will go to the database, with labels.</p>
<p>If you set <code class="codeph">AUDIT_TRAIL</code> to <code class="codeph">OS</code>, then the Oracle Label Security-specific audit records are written to the database audit trail and the other Oracle Database audit records are written to the operating system audit trail (with no policy column in the operating system data).</p>
</td>
</tr>
<tr class="cellalignment3810">
<td class="cellalignment3920" id="d43450e311" headers="d43450e226">
<p><code class="codeph">NONE</code></p>
</td>
<td class="cellalignment3943" headers="d43450e311 d43450e229">
<p>Disables auditing. This is the default.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>After you have edited the parameter file, restart the database instance to enable or disable database auditing as specified.</p>
<p>Set the <code class="codeph">AUDIT_TRAIL</code> parameter before you set audit options. If you do not set this parameter, then you are still able to set audit options. However, audit records are not written to the database until the parameter is set and the database instance is restarted.</p>
<div class="infoboxnotealso" id="GUID-73733435-DB2C-498B-8E4A-1A1200E74090__GUID-D42A11AF-3200-4356-A025-6B043E2925B0">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p>For information about enabling and disabling systemwide auditing, setting audit options, and managing the audit trail, refer to <a class="olink DBSEG006" target="_blank" href="../DBSEG/part_6.htm#DBSEG006"><span><cite>Oracle Database Security Guide</cite></span></a></p>
</li>
<li>
<p>For information about editing initialization parameters, refer to <a class="olink REFRN001" target="_blank" href="../REFRN/GUID-6F1C3203-0AA0-4AF1-921C-A027DD7CB6A9.htm#REFRN001"><span><cite>Oracle Database Reference</cite></span></a></p>
</li>
<li>
<p>For details about systemwide <code class="codeph">AUDIT</code> and <code class="codeph">NOAUDIT</code> functioning, see <a class="olink SQLRF01107" target="_blank" href="../SQLRF/statements_4007.htm#SQLRF01107"><span><cite>Oracle Database SQL Language Reference</cite></span></a></p>
</li>
</ul>
</div>
</div>
</div>
<a id="OLSAG3792"></a>
<div class="props_rev_3"><a id="GUID-AF8D2211-E65D-4627-9497-4098993C486E"></a>
<h2 id="OLSAG-GUID-AF8D2211-E65D-4627-9497-4098993C486E" class="sect2">How Oracle Label Security Auditing Is Enabled or Disabled</h2>
<div>
<p>After you have enabled systemwide auditing, you can enable or disable Oracle Label Security auditing.</p>
<p>To use Oracle Label Security auditing, you must have the <span class="italic"><code class="codeph">policy</code></span><code class="codeph">_DBA</code> role and use the <code class="codeph">SA_AUDIT_ADMIN</code> PL/SQL package procedures.</p>
<div class="infoboxnotealso" id="GUID-AF8D2211-E65D-4627-9497-4098993C486E__GUID-CC594C34-2C4D-469B-B312-DA4C804DB9D4">
<p class="notep1">See Also:</p>
<p><a href="packages.htm#GUID-C4FB5E20-D9B8-48A1-9DDB-1ACA4722846E" title="For a non-unified auditing environment, the SA_AUDIT_ADMIN PL/SQL package configures auditing that is specific to Oracle Label Security.">SA_AUDIT_ADMIN Oracle Label Security Auditing PL/SQL Package</a></p>
</div>
</div>
</div>
<a id="OLSAG3793"></a>
<div class="props_rev_3"><a id="GUID-1050E8C0-3209-43C8-AC24-D84E8F927F24"></a>
<h2 id="OLSAG-GUID-1050E8C0-3209-43C8-AC24-D84E8F927F24" class="sect2">Oracle Label Security and Unified Auditing</h2>
<div>
<p>Oracle Database uses the unified audit trail to capture information from various audit sources, including Oracle Label Security.</p>
<p>You can configure OLS auditing using audit policies. Oracle Label Security auditing in Oracle Database 12<span class="italic">c</span> release 1 (12.1) enables you to audit additional events such as enabling and disabling of OLS policies.</p>
<p>If you have upgraded your database to Oracle Database 12<span class="italic">c</span> release 1 (12.1), but have not configured it to use unified auditing, then you must use the pre-12<span class="italic">c</span> OLS auditing described in this chapter.</p>
<p>The Oracle Database audit facility lets you hold database users accountable for the operations they perform. It can track specific database objects, operations, users, and privileges. Oracle Label Security supplements this by tracking use of its own administrative operations and policy privileges. It provides the <code class="codeph">SA_AUDIT_ADMIN</code> package to set and change the policy auditing options.</p>
<div class="infoboxnotealso" id="GUID-1050E8C0-3209-43C8-AC24-D84E8F927F24__GUID-19448944-2724-42E2-8E49-827F2A9B6F7D">
<p class="notep1">See Also:</p>
<p><a class="olink UPGRD52810" target="_blank" href="../UPGRD/afterup.htm#UPGRD52810"><span><cite>Oracle Database Security Guide</cite></span></a> for instructions on configuring your upgraded database to use unified auditing. After migration, you can find the OLS unified audit information at <a class="olink DBSEG454" target="_blank" href="../DBSEG/audit_config.htm#DBSEG454"><span><cite>Oracle Database Security Guide</cite></span></a></p>
</div>
</div>
</div>
<a id="OLSAG079"></a>
<div class="props_rev_3"><a id="GUID-7C2BB514-2FBC-46E8-8983-6D03F06A2E47"></a>
<h2 id="OLSAG-GUID-7C2BB514-2FBC-46E8-8983-6D03F06A2E47" class="sect2">Oracle Label Security Auditing Tips</h2>
<div>
<p>Oracle provides a set of tips for auditing Oracle Label Security.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="audit.htm#GUID-743206E8-44C0-4D4A-B817-6A98FC4D0162" title="Before setting any audit options, you must devise an auditing strategy that monitors events of interest, without recording extraneous events.">Strategy for Setting SA_AUDIT_ADMIN Options</a></p>
</li>
<li>
<p><a href="audit.htm#GUID-B77EC426-2DFC-462C-BA89-ED5C98BFD9E1" title="Consider auditing any operations that require Oracle Label Security privileges.">Auditing of Privileged Operations</a></p>
</li>
</ul>
</div>
<a id="OLSAG3395"></a>
<div class="props_rev_3"><a id="GUID-743206E8-44C0-4D4A-B817-6A98FC4D0162"></a>
<h3 id="OLSAG-GUID-743206E8-44C0-4D4A-B817-6A98FC4D0162" class="sect3">Strategy for Setting SA_AUDIT_ADMIN Options</h3>
<div>
<p>Before setting any audit options, you must devise an auditing strategy that monitors events of interest, without recording extraneous events.</p>
<p>You should periodically review this strategy, because applications, user base, configurations, and other external factors can change.</p>
<p>The Oracle Label Security options, and those provided by the Oracle Database audit facility, might not directly address all of your specific or application-dependent auditing requirements. However, through use of database triggers, you can audit specific events and record specific information that you cannot audit and record using the more generic audit facility.</p>
<div class="infoboxnotealso" id="GUID-743206E8-44C0-4D4A-B817-6A98FC4D0162__GUID-07470C18-9177-4C83-9283-5565058A3A4A">
<p class="notep1">See Also:</p>
<p>For more information about using triggers for auditing, see <a class="olink CNCPT118" target="_blank" href="../CNCPT/srvrside.htm#CNCPT118"><span><cite>Oracle Database Concepts</cite></span></a></p>
</div>
</div>
</div>
<a id="OLSAG3396"></a>
<div class="props_rev_3"><a id="GUID-B77EC426-2DFC-462C-BA89-ED5C98BFD9E1"></a>
<h3 id="OLSAG-GUID-B77EC426-2DFC-462C-BA89-ED5C98BFD9E1" class="sect3">Auditing of Privileged Operations</h3>
<div>
<p>Consider auditing any operations that require Oracle Label Security privileges.</p>
<p>Because these privileges perform sensitive operations, and because their abuse could jeopardize security, you should closely monitor their dissemination and use.</p>
</div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment3809">
<tr>
<td class="cellalignment3826">
<table class="cellalignment3814">
<tr>
<td class="cellalignment3813"><a href="storproc.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment3813"><a href="multiple.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2006, 2015, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment3828">
<table class="cellalignment3812">
<tr>
<td class="cellalignment3813"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment3813"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment3813"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment3813"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment3813"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment3813"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>