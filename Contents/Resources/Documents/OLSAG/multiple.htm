<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-86523"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Using%20Oracle%20Label%20Security%20with%20a%20Distributed%20Database"></a><title>Using Oracle Label Security with a Distributed Database</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="description" content="You should understand the special considerations for using Oracle Label Security in a distributed configuration."/>
<meta name="keywords" content="distributed databases, Oracle Label Security configuration, database links, remote users, connecting to, SET_LABEL procedure, on remote database, row labels, in distributed environment, session labels, distributed database, remote session label, label components, label tags, distributed environment, replication, with Oracle Label Security, materialized views, materialized views (snapshots), REPADMIN account, replication administrator"/>
<meta name="dcterms.created" content="2017-03-14T13:38:49Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Label Security Administrator&#39;s Guide"/>
<meta name="dcterms.identifier" content="E48437-08"/>
<meta name="dcterms.isVersionOf" content="OLSAG"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2006, 2015, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="audit.htm" title="Previous" type="text/html"/>
<link rel="Next" href="utilities.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E48437-08.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-21087442-8EFA-4118-A5A5-A108249F7A9A"></a> <span id="PAGE" style="display:none;">18/29</span> <!-- End Header -->
<a id="OLSAG080"></a>
<h1 id="OLSAG-GUID-21087442-8EFA-4118-A5A5-A108249F7A9A" class="sect1"><span class="enumeration_chapter">11</span> Using Oracle Label Security with a Distributed Database</h1>
<div>
<p>You should understand the special considerations for using Oracle Label Security in a distributed configuration.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="multiple.htm#GUID-6861F1C9-4232-40E1-885D-FA46CF0B3A1F" title="In a network configuration that supports distributed databases, multiple Oracle Database (or other) servers can run on the same or different operating systems.">About the Oracle Label Security Distributed Configuration</a></p>
</li>
<li>
<p><a href="multiple.htm#GUID-202B86E6-4977-4D9D-AED8-A1961ECDCC9A" title="Distributed databases act in the standard way with Oracle Label Security: the local user ends up connected as a particular remote user.">How Connections to a Remote Database Under Oracle Label Security Work</a></p>
</li>
<li>
<p><a href="multiple.htm#GUID-39EC9824-59E3-4045-8028-13104E875E39" title="When connecting remotely, you can directly control the session label and row label in effect when you establish the connection.">Session Labels and Row Labels in Remote Sessions</a></p>
</li>
<li>
<p><a href="multiple.htm#GUID-8082D025-6375-4DE7-AE66-C062D5B103CE" title="You should use the same label component definitions and label tags on any database that is to be protected by the policy.">Labels in a Distributed Environment</a></p>
</li>
<li>
<p><a href="multiple.htm#GUID-285BD47E-9AB5-43C3-A35B-C7052F05371A" title="Oracle Label Security supports all standard Oracle Database distributed configurations.">Oracle Label Security Policies in a Distributed Environment</a></p>
</li>
<li>
<p><a href="multiple.htm#GUID-AFE7EC49-CA2E-4C81-99D9-B2EDE41EB302" title="You should understand how to use the replication option with tables protected by Oracle Label Security policies.">Replication with Oracle Label Security</a></p>
</li>
</ul>
</div>
<a id="OLSAG3397"></a><a id="OLSAG081"></a>
<div class="props_rev_3"><a id="GUID-6861F1C9-4232-40E1-885D-FA46CF0B3A1F"></a>
<h2 id="OLSAG-GUID-6861F1C9-4232-40E1-885D-FA46CF0B3A1F" class="sect2">About the Oracle Label Security Distributed Configuration</h2>
<div>
<p>In a network configuration that supports distributed databases, multiple Oracle Database (or other) servers can run on the same or different operating systems.</p>
<p>Each cooperative server in a distributed system communicates with other clients and servers over a network.</p>
<p><a href="multiple.htm#GUID-6861F1C9-4232-40E1-885D-FA46CF0B3A1F__CACBCAIF">Figure 11-1</a> illustrates a distributed database that includes clients and servers with and without Oracle Label Security. As described in this chapter, if you establish database links from the <code class="codeph">WESTERN_REGION</code> database to the <code class="codeph">EASTERN_REGION</code> database, then you can access data if your user ID on <code class="codeph">EASTERN_REGION</code> is authorized to see it, even if locally (on <code class="codeph">WESTERN_REGION</code>) you do not have this access.</p>
<div class="figure" id="GUID-6861F1C9-4232-40E1-885D-FA46CF0B3A1F__CACBCAIF">
<p class="titleinfigure">Figure 11-1 Using Oracle Label Security with a Distributed Database</p>
<img width="569" height="575" src="img/GUID-1DB80137-FE90-4934-853D-74FC0AA02FD9-default.gif" alt="Description of Figure 11-1 follows" title="Description of Figure 11-1 follows"/><br/>
<a href="img_text/GUID-1DB80137-FE90-4934-853D-74FC0AA02FD9-print.htm">Description of &#34;Figure 11-1 Using Oracle Label Security with a Distributed Database&#34;</a></div>
<!-- class="figure" --></div>
</div>
<a id="OLSAG082"></a>
<div class="props_rev_3"><a id="GUID-202B86E6-4977-4D9D-AED8-A1961ECDCC9A"></a>
<h2 id="OLSAG-GUID-202B86E6-4977-4D9D-AED8-A1961ECDCC9A" class="sect2">How Connections to a Remote Database Under Oracle Label Security Work</h2>
<div>
<p>Distributed databases act in the standard way with Oracle Label Security: the local user ends up connected as a particular remote user.</p>
<p>Oracle Label Security protects the labeled data, whether you connect locally or remotely. If the remote user has the proper labels, then you can access the data. If not, then you cannot access the data.</p>
<p>The database link sets up the connection to the remote database and identifies the user who will be associated with the remote session. Your Oracle Label Security authorizations on the remote database are based on those of the remote user identified in the database link.</p>
<p>For example, local user <code class="codeph">JANE</code> might connect as remote user <code class="codeph">AUSTEN</code>, in the database referenced by the connect string <code class="codeph">sales</code>, as follows:</p>
<pre dir="ltr">CREATE DATABASE LINK sales
  CONNECT TO austen IDENTIFIED BY pride
  USING &#39;sales&#39;
</pre>
<p>When <code class="codeph">JANE</code> connects, her authorizations are based on the labels and privileges of remote user <code class="codeph">AUSTEN</code>, because <code class="codeph">AUSTEN</code> is the user identified in the database link. When <code class="codeph">JANE</code> makes the first reference to the remote database, the remote session is actually established. For example, the remote session would be created if JANE enters:</p>
<pre dir="ltr">SELECT * FROM emp@sales
</pre>
<p>You need not be an Oracle Label Security policy user in the local database. If you connect as a policy user on the remote database, you can access protected data.</p>
</div>
</div>
<a id="OLSAG083"></a>
<div class="props_rev_3"><a id="GUID-39EC9824-59E3-4045-8028-13104E875E39"></a>
<h2 id="OLSAG-GUID-39EC9824-59E3-4045-8028-13104E875E39" class="sect2">Session Labels and Row Labels in Remote Sessions</h2>
<div>
<p>When connecting remotely, you can directly control the session label and row label in effect when you establish the connection.</p>
<p>When you connect, Oracle Label Security passes these values (for all policies) over to the remote database. Notice that:</p>
<ul style="list-style-type: disc;">
<li>
<p>The local session label and row label are used as the default for the remote session, if they are valid for the remote user.</p>
</li>
<li>
<p>The remote session is constrained by the minimum and maximum authorizations of the remote user.</p>
</li>
<li>
<p>Although the local user&#39;s session labels are passed to the remote database, the local user&#39;s privileges are not passed. The privileges for the remote session are those associated with the remote user.</p>
</li>
</ul>
<p>Consider a local user, <code class="codeph">Diana</code>, with a maximum level of <code class="codeph">HS</code>, and a session level of <code class="codeph">S</code>. On the remote database, the remote user identified in the database link has a maximum level of <code class="codeph">S</code>.</p>
<ul style="list-style-type: disc;">
<li>
<p>If Diana&#39;s session label is <code class="codeph">S</code> when the database link is established, then the <code class="codeph">S</code> label is passed over. This is a valid label. Diana can connect and read <code class="codeph">SENSITIVE</code> data.</p>
</li>
<li>
<p>If Diana&#39;s session label is <code class="codeph">HS</code> when the database link is established, then the <code class="codeph">HS</code> level is passed across, but it is not valid for the remote user. Diana will pick up the remote user&#39;s default label (<code class="codeph">S</code>).</p>
</li>
</ul>
<p>Be aware of the label at which you are running the first time you connect to the remote database. The first time you reference a database link, your local session labels are sent across to the remote system when a connection is made. Later, you can change the label, but to do so, you must run the <code class="codeph">SA_SESSION</code>.<code class="codeph">SET_LABEL</code> procedure on the remote database.</p>
<p>Diana can connect at level <code class="codeph">HS</code>, set the label to <code class="codeph">S</code>, and then perform a remote access. Connection is implicitly made when the database link is established. Her default label is S on the remote database.</p>
<p>On the local database, Diana can set her session label to her maximum level of <code class="codeph">HS</code>, but if the label of the remote user is set to <code class="codeph">S</code>, then she can only retrieve <code class="codeph">S</code> data from the remote database. If she performs a distributed query, then she will get <code class="codeph">HS</code> data from the local database, and <code class="codeph">S</code> data from the remote database.</p>
</div>
</div>
<a id="OLSAG084"></a>
<div class="props_rev_3"><a id="GUID-8082D025-6375-4DE7-AE66-C062D5B103CE"></a>
<h2 id="OLSAG-GUID-8082D025-6375-4DE7-AE66-C062D5B103CE" class="sect2">Labels in a Distributed Environment</h2>
<div>
<p>You should use the same label component definitions and label tags on any database that is to be protected by the policy.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="multiple.htm#GUID-2B80118A-CE90-443B-AB61-A04F3E05E9FE" title="In a distributed environment, you may choose to use the same label tags across multiple databases.">Label Tags in a Distributed Environment</a></p>
</li>
<li>
<p><a href="multiple.htm#GUID-9850945D-D9C3-4AFB-A743-DCDB736C8527" title="In a distributed environment, the same relative ranking of the numeric form of the level component ensures that the labels are properly sorted.">Numeric Form of Label Components in a Distributed Environment</a></p>
</li>
</ul>
</div>
<a id="OLSAG3399"></a><a id="OLSAG3398"></a>
<div class="props_rev_3"><a id="GUID-2B80118A-CE90-443B-AB61-A04F3E05E9FE"></a>
<h3 id="OLSAG-GUID-2B80118A-CE90-443B-AB61-A04F3E05E9FE" class="sect3">Label Tags in a Distributed Environment</h3>
<div>
<p>In a distributed environment, you may choose to use the same label tags across multiple databases.</p>
<p>However, if you choose <span class="italic">not</span> to use the same tags across multiple databases, then you should retrieve the character form of the label when performing remote operations. This will ensure that the labels are consistent.</p>
<p>In the following example, the character string representation of the label string is the same. However, the label tag does not match. If the retrieved label tag has a value of <code class="codeph">11</code> on the <code class="codeph">WESTERN_REGION</code> database but a tag of <code class="codeph">2001</code> on the <code class="codeph">EASTERN_REGION</code> database, then the tags have no meaning. Serious consequences can result.</p>
<div class="figure" id="GUID-2B80118A-CE90-443B-AB61-A04F3E05E9FE__GUID-2B828386-1C3B-4543-BDAE-CCA7B5DDA2D7">
<p class="titleinfigure">Figure 11-2 Label Tags in a Distributed Database</p>
<img width="496" height="112" src="img/GUID-A70329D9-02DA-461B-8630-8CD229828CF2-default.gif" alt="Description of Figure 11-2 follows" title="Description of Figure 11-2 follows"/><br/>
<a href="img_text/GUID-A70329D9-02DA-461B-8630-8CD229828CF2-print.htm">Description of &#34;Figure 11-2 Label Tags in a Distributed Database&#34;</a></div>
<!-- class="figure" -->
<p>When retrieving labels from a remote system, you should return the character string representation (rather than the numeric label tag), unless you are using the same numeric labels on both databases.</p>
<p>If you allow Oracle Label Security to automatically generate labels on different databases, then the label tags will not be identical. Character strings will have meaning, but the numeric values will not, unless you have predefined labels with the same label tags on both instances.</p>
<p>To avoid the complexities of label tags, you can convert labels to strings on retrieval (using <code class="codeph">LABEL_TO_CHAR</code>) and use <code class="codeph">CHAR_TO_LABEL</code> when you store labels. Operations will succeed as long as the component names are the same.</p>
</div>
</div>
<a id="OLSAG3401"></a><a id="OLSAG3400"></a>
<div class="props_rev_3"><a id="GUID-9850945D-D9C3-4AFB-A743-DCDB736C8527"></a>
<h3 id="OLSAG-GUID-9850945D-D9C3-4AFB-A743-DCDB736C8527" class="sect3">Numeric Form of Label Components in a Distributed Environment</h3>
<div>
<p>In a distributed environment, the same relative ranking of the numeric form of the level component ensures that the labels are properly sorted.</p>
<p>In the following example, the levels in the two databases are effectively the same. Although the numeric form is different, the relative ranking of the levels numeric form is the same. As long as the relative order of the components is the same, the labels are perceived as identical.</p>
<div class="figure" id="GUID-9850945D-D9C3-4AFB-A743-DCDB736C8527__GUID-1540573B-320E-45A4-A9A5-3F52A65B5B56">
<p class="titleinfigure">Figure 11-3 Label Components in a Distributed Database</p>
<img width="496" height="116" src="img/GUID-E4E7ABD6-CE60-43AB-841E-67033C4E3CBE-default.gif" alt="Description of Figure 11-3 follows" title="Description of Figure 11-3 follows"/><br/>
<a href="img_text/GUID-E4E7ABD6-CE60-43AB-841E-67033C4E3CBE-print.htm">Description of &#34;Figure 11-3 Label Components in a Distributed Database&#34;</a></div>
<!-- class="figure" --></div>
</div>
</div>
<a id="OLSAG085"></a>
<div class="props_rev_3"><a id="GUID-285BD47E-9AB5-43C3-A35B-C7052F05371A"></a>
<h2 id="OLSAG-GUID-285BD47E-9AB5-43C3-A35B-C7052F05371A" class="sect2">Oracle Label Security Policies in a Distributed Environment</h2>
<div>
<p>Oracle Label Security supports all standard Oracle Database distributed configurations.</p>
<p>Whether or not you can access protected data depends on the policies installed in each distributed database.</p>
<p>Be sure to take into account the relationships between databases in a distributed environment:</p>
<ul style="list-style-type: disc;">
<li>
<p>If the same application runs on two databases and you want them to have the same protection, then you must apply the same Oracle Label Security policy to both the local and the remote databases.</p>
</li>
<li>
<p>If the local and remote databases have a policy in common, then your local session label and row label will override the default labels for the remote user.</p>
</li>
<li>
<p>If the remote database has a different policy than the local database, then the remote policy can restrict access to the data independent of your local policies. On the other hand, when you make a connection as a remote user who has authorization on the remote policy, you can access any data to which the remote user has access to, regardless of your local authorizations.</p>
</li>
</ul>
<p>If the remote database has no policy applied to it, you can access its data just as you would with a standard distributed database.</p>
<p>Consider a situation in which three databases exist, with different Oracle Label Security policies in force:</p>
<ul class="simple">
<li>Database 1 has Policy A and Policy B</li>
<li>Database 2 has Policy A</li>
<li>Database 3 had Policy C</li>
</ul>
<p>Users authorized for Policy A can obtain protected data from Database 1 and Database 2. If the remote user is authorized for Policy C, then this user can obtain data from Database 3 as well.</p>
</div>
</div>
<a id="OLSAG086"></a>
<div class="props_rev_3"><a id="GUID-AFE7EC49-CA2E-4C81-99D9-B2EDE41EB302"></a>
<h2 id="OLSAG-GUID-AFE7EC49-CA2E-4C81-99D9-B2EDE41EB302" class="sect2">Replication with Oracle Label Security</h2>
<div>
<p>You should understand how to use the replication option with tables protected by Oracle Label Security policies.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="multiple.htm#GUID-FEB21DEF-0C31-4BCF-B14B-64B151667386" title="You can replicate data in Oracle Label Security.">About Replication Under Oracle Label Security</a></p>
</li>
<li>
<p><a href="multiple.htm#GUID-440E0AE0-2B79-4807-BA3A-BE24BEE9393C" title="Oracle Label Security can create materialized views.">Contents of a Materialized View</a></p>
</li>
<li>
<p><a href="multiple.htm#GUID-A5B0337B-DAAF-4B0C-8031-6ADFFE43C923" title="The requirements for creating a materialized view depend on the type of materialized view you are creating.">Requirements for Creating Materialized Views Under Oracle Label Security</a></p>
</li>
<li>
<p><a href="multiple.htm#GUID-F67385ED-5C85-4F78-871E-06C1CC59881E" title="If the contents or definition of a master table changes, then you should refresh the materialized view.">How to Refresh Materialized Views</a></p>
<div class="infoboxnotealso" id="GUID-AFE7EC49-CA2E-4C81-99D9-B2EDE41EB302__GUID-29DE05E3-870E-4CCF-94BD-CDBB8D8A28F1">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink REPLN" target="_blank" href="../REPLN/toc.htm"><span class="italic">Oracle Database Advanced Replication</span></a>for a complete explanation of replication in Oracle Database 12<span class="italic">c</span> and how to set up the replication environment</p>
</li>
<li>
<p><a class="olink CNCPT411" target="_blank" href="../CNCPT/schemaob.htm#CNCPT411"><span class="italic">Oracle Database Concepts</span></a> and <a class="olink DWHSG008" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=DWHSG008"><span class="italic">Oracle Database Data Warehousing Guide</span></a> for general information about using materialized views</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<a id="OLSAG3402"></a>
<div class="props_rev_3"><a id="GUID-FEB21DEF-0C31-4BCF-B14B-64B151667386"></a>
<h3 id="OLSAG-GUID-FEB21DEF-0C31-4BCF-B14B-64B151667386" class="sect3">About Replication Under Oracle Label Security</h3>
<div>
<p>You can replicate data in Oracle Label Security.</p>
</div>
<a id="OLSAG3404"></a><a id="OLSAG3403"></a>
<div class="props_rev_3"><a id="GUID-33DD8D62-6186-40E3-9A82-4F17CD9902B7"></a>
<h4 id="OLSAG-GUID-33DD8D62-6186-40E3-9A82-4F17CD9902B7" class="sect4">Replication Functionality Supported by Oracle Label Security</h4>
<div>
<p>Oracle Label Security supports replication using read-only materialized views (snapshots).</p>
<p>Oracle Database uses materialized views for replicating data. A <span class="italic">materialized view</span> is a local copy of a local or remote master table that reflects a recent state of the master table.</p>
<p>As illustrated in <a href="multiple.htm#GUID-33DD8D62-6186-40E3-9A82-4F17CD9902B7__I1012594">Figure 11-4</a>, a master table is a table you wish to replicate, on a node that you designate as the master node. Using a <code class="codeph">dblink</code> account, you can create a materialized view of the table in a different database. (This can also be done in the same database, and on the same system.) You can select rows from the remote master table, and copy them into the local materialized view. Here, <code class="codeph">mvEMP</code> represents the materialized view of table <code class="codeph">EMP</code>, and <code class="codeph">mlog$_EMP</code> represents the materialized view log.</p>
<div class="figure" id="GUID-33DD8D62-6186-40E3-9A82-4F17CD9902B7__I1012594">
<p class="titleinfigure">Figure 11-4 Use of Materialized Views for Replication</p>
<img width="496" height="112" src="img/GUID-92C71A02-F3CE-4921-B743-D072F6369A8C-default.gif" alt="Description of Figure 11-4 follows" title="Description of Figure 11-4 follows"/><br/>
<a href="img_text/GUID-92C71A02-F3CE-4921-B743-D072F6369A8C-print.htm">Description of &#34;Figure 11-4 Use of Materialized Views for Replication&#34;</a></div>
<!-- class="figure" -->
<p>In a distributed environment, a materialized view alleviates query traffic over the network and increases data availability when a node is not available.</p>
</div>
</div>
<a id="OLSAG3405"></a>
<div class="props_rev_3"><a id="GUID-83B99214-146F-465A-80B8-E644F05112D1"></a>
<h4 id="OLSAG-GUID-83B99214-146F-465A-80B8-E644F05112D1" class="sect4">Row-Level Security Restriction on Replication Under Oracle Label Security</h4>
<div>
<p>An Oracle Label Security policy applies Row Level Security (RLS) to a table if <code class="codeph">READ_CONTROL</code> is specified as one of the policy options.</p>
<p>Problems occur if <span class="italic">both</span> of the following conditions are true:</p>
<ul style="list-style-type: disc;">
<li>
<p>The Oracle Label Security policy is applied to any table relevant to replication (such as the master table, materialized view, or materialized view log), and</p>
</li>
<li>
<p>The policy returns a predicate in the <code class="codeph">WHERE</code> clause of <code class="codeph">SELECT</code> statements.</p>
</li>
</ul>
<p>To avoid the additional predicate (and therefore avoid this problem), the users involved in a replication environment should be given the necessary Oracle Label Security privileges. To be specific, the designated users in the database link (such as <code class="codeph">REPADMIN</code> and the materialized view owner) must have the <code class="codeph">READ</code> or the <code class="codeph">FULL</code> privilege. As a result, the queries used to perform the replication will not be modified by RLS.</p>
<div class="infoboxnotealso" id="GUID-83B99214-146F-465A-80B8-E644F05112D1__GUID-2F5D21C7-F796-42E8-A241-94D47DE41310">
<p class="notep1">See Also:</p>
<p><a class="olink TDPSG94446" target="_blank" href="../TDPSG/GUID-72D524FF-5A86-495A-9D12-14CB13819D42.htm#TDPSG94446"><span><cite>Oracle Database 2 Day + Security Guide</cite></span></a></p>
</div>
</div>
</div>
</div>
<a id="OLSAG3406"></a>
<div class="props_rev_3"><a id="GUID-440E0AE0-2B79-4807-BA3A-BE24BEE9393C"></a>
<h3 id="OLSAG-GUID-440E0AE0-2B79-4807-BA3A-BE24BEE9393C" class="sect3">Contents of a Materialized View</h3>
<div>
<p>Oracle Label Security can create materialized views.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="multiple.htm#GUID-8D60012D-D6D3-43C4-AFE0-E180E02A3121" title="Oracle Label Security performs a set steps when creating materialized views.">How Materialized View Contents Are Determined</a></p>
</li>
<li>
<p><a href="multiple.htm#GUID-429D221F-761C-441B-A72E-B61A6BCDD830" title="Oracle Label Security supports complete materialized views.">Complete Materialized Views</a></p>
</li>
<li>
<p><a href="multiple.htm#GUID-DF69B1EF-73F7-4449-A316-CA76D76C997B" title="A partial materialized view is created when you specify a WHERE clause in the materialized view definition.">Partial Materialized Views</a></p>
</li>
</ul>
</div>
<a id="OLSAG3407"></a>
<div class="props_rev_3"><a id="GUID-8D60012D-D6D3-43C4-AFE0-E180E02A3121"></a>
<h4 id="OLSAG-GUID-8D60012D-D6D3-43C4-AFE0-E180E02A3121" class="sect4">How Materialized View Contents Are Determined</h4>
<div>
<p>Oracle Label Security performs a set steps when creating materialized views.</p>
<p>The following steps determine the contents of the view:</p>
<ol>
<li>
<p>It reads the definition of the master table in the remote database.</p>
</li>
<li>
<p>It reads the rows in the master table that meet the conditions defined in the materialized view definition.</p>
</li>
<li>
<p>It writes these rows to the materialized view in the local database.</p>
</li>
</ol>
<p>Because Oracle Label Security writes only those rows to which you have write access in the local database, the contents of the materialized view vary according to:</p>
<ul style="list-style-type: disc;">
<li>
<p>The policy options in effect</p>
</li>
<li>
<p>The privileges you have defined in the local database</p>
</li>
<li>
<p>The session label</p>
</li>
</ul>
</div>
</div>
<a id="OLSAG3408"></a>
<div class="props_rev_3"><a id="GUID-429D221F-761C-441B-A72E-B61A6BCDD830"></a>
<h4 id="OLSAG-GUID-429D221F-761C-441B-A72E-B61A6BCDD830" class="sect4">Complete Materialized Views</h4>
<div>
<p>Oracle Label Security supports complete materialized views.</p>
<p>If you read all of the rows in the master table and have write access in the local database to each label in the materialized view, then the result is a complete materialized view of the master table. To ensure that the materialized view is complete, you should have read access to all of the data in the master table and write access in the local database to all labels at which data is stored in the master table.</p>
<div class="infobox-note" id="GUID-429D221F-761C-441B-A72E-B61A6BCDD830__GUID-60815FFE-FC41-4A02-870A-CF96B3C81569">
<p class="notep1">Note:</p>
<p>Never revoke privileges that you granted when you created the materialized view. If you do, then you may not be able to perform a replication refresh.</p>
</div>
</div>
</div>
<a id="OLSAG3409"></a>
<div class="props_rev_3"><a id="GUID-DF69B1EF-73F7-4449-A316-CA76D76C997B"></a>
<h4 id="OLSAG-GUID-DF69B1EF-73F7-4449-A316-CA76D76C997B" class="sect4">Partial Materialized Views</h4>
<div>
<p>A partial materialized view is created when you specify a <code class="codeph">WHERE</code> clause in the materialized view definition.</p>
<p>A partial materialized view is a convenient way to pass subsets of data to a remote database.</p>
<p>To create a partial materialized view, a user must have write access to all the rows being replicated. You can find the currently granted privileges for a user by querying the <span class="apiname">DBA_SA_USER_PRIVS</span> data dictionary view.</p>
</div>
</div>
</div>
<a id="OLSAG3410"></a>
<div class="props_rev_3"><a id="GUID-A5B0337B-DAAF-4B0C-8031-6ADFFE43C923"></a>
<h3 id="OLSAG-GUID-A5B0337B-DAAF-4B0C-8031-6ADFFE43C923" class="sect3">Requirements for Creating Materialized Views Under Oracle Label Security</h3>
<div>
<p>The requirements for creating a materialized view depend on the type of materialized view you are creating.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="multiple.htm#GUID-3B313E21-5104-43DF-8BF0-0FAD76C1D45D" title="Requirements for a replication administrator, typically using a REPADMIN account, vary depending on the configuration.">Requirements for a Replication Administrator</a></p>
</li>
<li>
<p><a href="multiple.htm#GUID-08AC43E9-4E0C-4F4A-9A17-08FFC59C723E" title="The privileges that belong to the owner of the materialized view are used during the refresh of the materialized view.">Requirements for the Owner of the Materialized View</a></p>
</li>
<li>
<p><a href="multiple.htm#GUID-0E84D3F4-BF6F-4A2D-A299-26314E1B278E" title="A partial materialized view can include only some of the rows in a remote master table that is protected by Oracle Label Security.">Requirements for Creating Partial Multilevel Materialized Views</a></p>
</li>
<li>
<p><a href="multiple.htm#GUID-6485AF41-D4CE-4742-8325-52001790686B" title="A complete materialized view can include every row in a remote master table that is protected by Oracle Label Security.">Requirements for Creating Complete Multilevel Materialized Views</a></p>
</li>
</ul>
</div>
<a id="OLSAG3411"></a>
<div class="props_rev_3"><a id="GUID-3B313E21-5104-43DF-8BF0-0FAD76C1D45D"></a>
<h4 id="OLSAG-GUID-3B313E21-5104-43DF-8BF0-0FAD76C1D45D" class="sect4">Requirements for a Replication Administrator</h4>
<div>
<p>Requirements for a replication administrator, typically using a <code class="codeph">REPADMIN</code> account, vary depending on the configuration.</p>
<p>In general, however, it should meet the following requirements:</p>
<ul style="list-style-type: disc;">
<li>
<p>It must have the <code class="codeph">FULL</code> Oracle Label Security privilege (mandatory for all configurations).</p>
</li>
<li>
<p>It must have the <code class="codeph">SELECT</code> privilege on the master table.</p>
</li>
<li>
<p>It must be the account that establishes the database link from the remote node to the database containing the master table.</p>
<div class="infoboxnotealso" id="GUID-3B313E21-5104-43DF-8BF0-0FAD76C1D45D__GUID-44915FE7-0854-49E2-A98C-67C1C82AC689">
<p class="notep1">See Also:</p>
<p><a class="olink REPLN196" target="_blank" href="../REPLN/repmaster.htm#REPLN196"><span class="italic">Oracle Database Advanced Replication</span></a> for further information about the replication administrator and <code class="codeph">REPADMIN</code> account</p>
</div>
</li>
</ul>
</div>
</div>
<a id="OLSAG3412"></a>
<div class="props_rev_3"><a id="GUID-08AC43E9-4E0C-4F4A-9A17-08FFC59C723E"></a>
<h4 id="OLSAG-GUID-08AC43E9-4E0C-4F4A-9A17-08FFC59C723E" class="sect4">Requirements for the Owner of the Materialized View</h4>
<div>
<p>The privileges that belong to the owner of the materialized view are used during the refresh of the materialized view.</p>
<p>If these privileges are not sufficient, then there are two options:</p>
<ul style="list-style-type: disc;">
<li>
<p>The materialized view can be created in the <code class="codeph">REPADMIN</code> account, or</p>
</li>
<li>
<p>Additional privileges must be granted to the owner of the materialized view.</p>
</li>
</ul>
<p>Consider, for example, the following materialized view created by user SCOTT:</p>
<pre dir="ltr">CREATE MATERIALIZED VIEW mvemp as
SELECT *
FROM EMP@link_to_master
WHERE label_to_char(sa_label) = &#39;HS&#39;;
</pre>
<p>Here, <code class="codeph">SCOTT</code> should have permission to insert records at the <code class="codeph">HS</code> level in the local database. If Oracle Label Security policies are applied on the materialized view, then <code class="codeph">SCOTT</code> must have the <code class="codeph">FULL</code> privilege to avoid the RLS restriction.</p>
<p>Different configurations can be set up depending on whether Oracle Label Security policies are applied on the materialized view, what privileges are granted to the owner of the materialized view, and so on. If Oracle Label Security policies are applied to the materialized view, but <code class="codeph">SCOTT</code> should not be granted the <code class="codeph">FULL</code> privilege, then the <code class="codeph">REPADMIN</code> account must be used to create the materialized view. <code class="codeph">SCOTT</code> can then be granted the <code class="codeph">SELECT</code> privilege on that table.</p>
<p>If no policies are applied to the materialized view, then the view can be created in <code class="codeph">SCOTT</code>&#39;s schema without any additional privileges. In this case, the materialized view should be created in such a way that a <code class="codeph">WHERE</code> condition limits the records to those which <code class="codeph">SCOTT</code> can read.</p>
<p>Finally, if <code class="codeph">SCOTT</code> can be granted the <code class="codeph">FULL</code> privilege, then the materialized view can be created in <code class="codeph">SCOTT</code>&#39;s schema, and Oracle Label Security policies can also be applied on the materialized view.</p>
<p>Note that the master table can have Oracle Label Security policies containing any set of policy options. If <code class="codeph">SCOTT</code> has the <code class="codeph">FULL</code> or the <code class="codeph">READ</code> privilege, he can select all rows, regardless of policy options.</p>
</div>
</div>
<a id="OLSAG3413"></a>
<div class="props_rev_3"><a id="GUID-0E84D3F4-BF6F-4A2D-A299-26314E1B278E"></a>
<h4 id="OLSAG-GUID-0E84D3F4-BF6F-4A2D-A299-26314E1B278E" class="sect4">Requirements for Creating Partial Multilevel Materialized Views</h4>
<div>
<p>A partial materialized view can include only some of the rows in a remote master table that is protected by Oracle Label Security.</p>
<p>If the partial materialized view is used in a table that Oracle Label Security protects, then you should ensure that you have sufficient privileges to <code class="codeph">WRITE</code> in the local database at every label retrieved by your query. You can find your currently granted privileges by querying the <span class="apiname">ALL_SA_USER_PRIVS</span> data dictionary view.</p>
</div>
</div>
<a id="OLSAG3414"></a>
<div class="props_rev_3"><a id="GUID-6485AF41-D4CE-4742-8325-52001790686B"></a>
<h4 id="OLSAG-GUID-6485AF41-D4CE-4742-8325-52001790686B" class="sect4">Requirements for Creating Complete Multilevel Materialized Views</h4>
<div>
<p>A complete materialized view can include every row in a remote master table that is protected by Oracle Label Security.</p>
<p>If the complete materialized view is used in a table that Oracle Label Security protects, then you must be able to have <code class="codeph">WRITE</code> access in the local database at the labels of all of the rows retrieved by the defined materialized view query. You can find your currently granted privileges by querying the <span class="apiname">ALL_SA_USER_PRIVS</span> data dictionary view.</p>
</div>
</div>
</div>
<a id="OLSAG3415"></a>
<div class="props_rev_3"><a id="GUID-F67385ED-5C85-4F78-871E-06C1CC59881E"></a>
<h3 id="OLSAG-GUID-F67385ED-5C85-4F78-871E-06C1CC59881E" class="sect3">How to Refresh Materialized Views</h3>
<div>
<p>If the contents or definition of a master table changes, then you should refresh the materialized view.</p>
<p>This ensures that the materialized view accurately reflects the contents of the master table.</p>
<p>To refresh a materialized view of a remote multilevel table, you must also have privileges to write in the local database at the labels of all of the rows that the materialized view query retrieves</p>
<div class="infoboxnotewarn" id="GUID-F67385ED-5C85-4F78-871E-06C1CC59881E__GUID-CEBCD660-EB88-44D8-A29D-CCA50AC97D24">
<p class="notep1">WARNING:</p>
<p>A materialized view can potentially contain outdated rows if you refresh a partial or full materialized view but do not have READ access to all the rows in the master table, and consequently do not overwrite the rows in the original materialized view with the updated rows from the master table.</p>
</div>
<p>To ensure an accurate materialized view refresh, you should use job queues to refresh the views automatically. These processes must have sufficient privileges both to read all of the rows in the master table and to write those rows to the materialized view, ensuring that the view is completely refreshed. Remember that the privileges used by these processes are those of the materialized view owner.</p>
<div class="infoboxnotealso" id="GUID-F67385ED-5C85-4F78-871E-06C1CC59881E__GUID-D63B826B-67A2-4C9D-98C7-591CC16A108D">
<p class="notep1">See Also:</p>
<p><a class="olink DWHSG8369" target="_blank" href="../DWHSG/refresh.htm#DWHSG8369"><span><cite>Oracle Database Data Warehousing Guide</cite></span></a> for information about job queues</p>
</div>
</div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment3809">
<tr>
<td class="cellalignment3826">
<table class="cellalignment3814">
<tr>
<td class="cellalignment3813"><a href="audit.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment3813"><a href="utilities.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2006, 2015, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment3828">
<table class="cellalignment3812">
<tr>
<td class="cellalignment3813"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment3813"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment3813"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment3813"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment3813"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment3813"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>