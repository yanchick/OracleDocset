<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-114092"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Troubleshooting%20Replication"></a><title>Troubleshooting Replication&nbsp;</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1023"/>
<meta name="dcterms.created" content="2014-10-07T19:55:1Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="TimesTen In-Memory Database Troubleshooting Guide"/>
<meta name="dcterms.identifier" content="E21636-11"/>
<meta name="dcterms.isVersionOf" content="TTTRB"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2011, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="cache_trouble.htm" title="Previous" type="text/html"/>
<link rel="Next" href="awt_trouble.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E21636-11.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">8/10</span> <!-- End Header -->
<div id="TTTRB283" class="chapter"><a id="g588894"></a><a id="i520044"></a>
<h1 class="chapter"><span class="secnum">4</span> Troubleshooting Replication&nbsp;</h1>
<p><a id="sthref257"></a><a id="sthref258"></a>The following sections in this chapter describe how to troubleshoot problems you may encounter when replicating databases:</p>
<ul>
<li>
<p><a href="#i537697">Unable to create a replication scheme</a></p>
</li>
<li>
<p><a href="#i538009">Unable to alter a replication scheme</a></p>
</li>
<li>
<p><a href="#i535997">Unable to start or stop replication agent</a></p>
</li>
<li>
<p><a href="#i529692">Using SNMP traps for notification of replication events</a></p>
</li>
<li>
<p><a href="#i507586">Replication does not work</a></p>
</li>
<li>
<p><a href="#i529345">Replication unresponsive, appears hung</a></p>
</li>
<li>
<p><a href="#i528938">Poor replication or XLA performance</a></p>
</li>
<li>
<p><a href="#i516053">Problems using ttRepAdmin</a></p>
</li>
<li>
<p><a href="#i509329">Problems with conflict checking</a></p>
</li>
<li>
<p><a href="#CACJFHFE">Problems with parallel replication</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
Error log messages from the replication agent daemon are designated by <code>REP</code> in the message, as shown in several examples in this chapter. These messages are enabled unless you disable the <code>REPLICATION</code> component of the <code>ttDaemonLog</code> utility. See <a class="olink TTREF338" href="../TTREF/util.htm#TTREF338">&#34;ttDaemonLog&#34;</a> in <span class="italic">Oracle TimesTen In-Memory Database Reference</span> for information about <code>ttDaemonLog</code> options for Windows and UNIX.</div>
<a id="i537697"></a>
<div id="TTTRB284" class="sect1">
<h2 class="sect1">Unable to create a replication scheme</h2>
<p>This section describes what to check if you are unable to use <code>CREATE REPLICATION</code> to create a replication scheme.</p>
<div class="inftblhruleinformal">
<table class="cellalignment2557" title="Problems creating a replication scheme" summary="This table lists possible causes for inability to create a replication scheme. It also provides possible solutions." dir="ltr">
<thead>
<tr class="cellalignment2551">
<th class="cellalignment2558" id="r1c1-t3">Possible cause</th>
<th class="cellalignment2558" id="r1c2-t3">What to do</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r2c1-t3" headers="r1c1-t3">User does not have <code>ADMIN</code> privilege.</td>
<td class="cellalignment2559" headers="r2c1-t3 r1c2-t3">You must have <code>ADMIN</code> privilege to use the <code>CREATE REPLICATION</code> or <code>DROP REPLICATION</code> statements.</td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r3c1-t3" headers="r1c1-t3">Database name, host name, or element name is incorrect.</td>
<td class="cellalignment2559" headers="r3c1-t3 r1c2-t3">
<ul>
<li>Check the <code>CREATE REPLICATION</code> statement for typographical errors.</li>
<li>
<p>See <a href="#i541111">&#34;Check host names&#34;</a>.</p>
</li>
<li>
<p>Use official host names instead of aliases.</p>
</li>
<li>
<p>The host name should match the value returned by the <code>hostname</code> command on your system and should be used consistently throughout the replication scheme.</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r4c1-t3" headers="r1c1-t3">The local host is not part of the replication scheme.</td>
<td class="cellalignment2559" headers="r4c1-t3 r1c2-t3">Create the replication scheme on a host that will be part of the replication scheme.</td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r5c1-t3" headers="r1c1-t3">Replication tables defined in the <code>CREATE REPLICATION</code> statement do not exist.</td>
<td class="cellalignment2559" headers="r5c1-t3 r1c2-t3">The name, owner, and column definitions of the tables participating in the replication scheme must be identical on both the master and subscriber databases. Use <code>CREATE TABLE</code> to create tables on the database, or use the <code>ttRepAdmin</code> <code>-duplicate</code> utility or the <code>ttRepDuplicateEx</code> C function to duplicate the entire database to be replicated.</td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r6c1-t3" headers="r1c1-t3">There are other problems.</td>
<td class="cellalignment2559" headers="r6c1-t3 r1c2-t3">Review the procedures and requirements described in <a class="olink TTREP306" href="../TTREP/design.htm#TTREP306">&#34;Defining Classic Replication Schemes&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span>.</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblhruleinformal" --></div>
<!-- class="sect1" -->
<a id="i538009"></a>
<div id="TTTRB285" class="sect1">
<h2 class="sect1">Unable to alter a replication scheme</h2>
<p>This <a id="sthref259"></a>section describes what to check if you are unable to use <code>ALTER REPLICATION</code> to alter a replication scheme.</p>
<div class="inftblhruleinformal">
<table class="cellalignment2557" title="Problems altering a replication scheme" summary="This table lists possible causes for inability to alter a replication scheme. It also provides possible solutions." dir="ltr">
<thead>
<tr class="cellalignment2551">
<th class="cellalignment2558" id="r1c1-t4">Possible cause</th>
<th class="cellalignment2558" id="r1c2-t4">What to do</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r2c1-t4" headers="r1c1-t4">User does not have <code>ADMIN</code> privilege.</td>
<td class="cellalignment2559" headers="r2c1-t4 r1c2-t4">You must have <code>ADMIN</code> privilege to use the <code>ALTER REPLICATION</code> statement.</td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r3c1-t4" headers="r1c1-t4">Replication agent is in Start state.</td>
<td class="cellalignment2559" headers="r3c1-t4 r1c2-t4">Most <code>ALTER REPLICATION</code> operations are supported only when the replication agent is stopped (<code>ttAdmin</code> <code>-repStop</code>). Stop the replication agents on both master and subscriber databases, alter the replication scheme on both master and subscriber databases, then restart both replication agents.</td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r4c1-t4" headers="r1c1-t4">Database name, host name, or element name is inconsistent.</td>
<td class="cellalignment2559" headers="r4c1-t4 r1c2-t4">
<ul>
<li>Check <code>ALTER REPLICATION</code> statement for typographical errors.</li>
<li>
<p>See <a href="#i541111">&#34;Check host names&#34;</a>.</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r5c1-t4" headers="r1c1-t4">Replication table defined in the <code>ALTER REPLICATION</code> statement does not exist.</td>
<td class="cellalignment2559" headers="r5c1-t4 r1c2-t4">Use <code>CREATE TABLE</code> to create a table on the database.</td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r6c1-t4" headers="r1c1-t4">There are other problems.</td>
<td class="cellalignment2559" headers="r6c1-t4 r1c2-t4">Review the procedures and requirements described in <a class="olink TTREP481" href="../TTREP/alter.htm#TTREP481">&#34;Altering a Classic Replication Scheme&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span>.</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblhruleinformal" --></div>
<!-- class="sect1" -->
<a id="i535997"></a>
<div id="TTTRB286" class="sect1">
<h2 class="sect1">Unable to start or stop replication agent</h2>
<p>This <a id="sthref260"></a>section describes what to check if you are unable to start or stop a replication agent.</p>
<div class="inftblhruleinformal">
<table class="cellalignment2557" title="Problems starting or stopping the replication agent" summary="This table lists possible causes for inability to start or stop the replication agent. It also provides solutions." dir="ltr">
<thead>
<tr class="cellalignment2551">
<th class="cellalignment2558" id="r1c1-t5">Possible cause</th>
<th class="cellalignment2558" id="r1c2-t5">What to do</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r2c1-t5" headers="r1c1-t5">User does not have <code>ADMIN</code> privileges.</td>
<td class="cellalignment2559" headers="r2c1-t5 r1c2-t5">You must have <code>ADMIN</code> privileges to use the <code>ttAdmin</code> utility or the <code>ttRepStart</code> or <code>ttRepStop</code> procedures to start or stop a replication agent.</td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r3c1-t5" headers="r1c1-t5">TimesTen daemon is not started.</td>
<td class="cellalignment2559" headers="r3c1-t5 r1c2-t5">Check the state of the TimesTen daemon, as described in <a href="datastore_trouble.htm#i1226406">&#34;Check the TimesTen user error log&#34;</a>. If necessary, start the TimesTen daemon as described in <a class="olink TTOPR211" href="../TTOPR/daemon.htm#TTOPR211">&#34;Working with the TimesTen Data Manager Daemon&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Operations Guide</span>.</td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r4c1-t5" headers="r1c1-t5">Database does not participate in a replication scheme.</td>
<td class="cellalignment2559" headers="r4c1-t5 r1c2-t5">If a database does not participate in a replication scheme, attempts to start a replication agent for that database will fail. Use <code>CREATE REPLICATION</code> to create a replication scheme for the database.</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblhruleinformal" --></div>
<!-- class="sect1" -->
<a id="i529692"></a>
<div id="TTTRB287" class="sect1">
<h2 class="sect1">Using SNMP traps for notification of replication events</h2>
<p>TimesTen can send SNMP traps for <a id="sthref261"></a>certain replication events to enable network management software to take immediate action. TimesTen can send the following traps for replication events:</p>
<ul>
<li>
<p><code>ttRepAgentExitingTrap</code></p>
</li>
<li>
<p><code>ttRepAgentDiedTrap</code></p>
</li>
<li>
<p><code>ttRepAgentStartingTrap</code></p>
</li>
<li>
<p><code>ttRepCatchupStartTrap</code></p>
</li>
<li>
<p><code>ttRepCatchupStopTrap</code></p>
</li>
<li>
<p><code>ttRepReturnTransitionTrap</code></p>
</li>
<li>
<p><code>ttRepSubscriberFailedTrap</code></p>
</li>
<li>
<p><code>ttRepUpdateFailedTrap</code></p>
</li>
</ul>
<p>These traps are described in <a class="olink TTERR138" href="../TTERR/snmp.htm#TTERR138">&#34;Diagnostics through SNMP Traps&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Error Messages and SNMP Traps</span>.</p>
</div>
<!-- class="sect1" -->
<a id="i507586"></a>
<div id="TTTRB288" class="sect1">
<h2 class="sect1">Replication does not work<a id="sthref262"></a></h2>
<p>If you are unable to get replication working between a master and subscriber database, the problem may be one or more of the following:</p>
<div class="inftblhruleinformal">
<table class="cellalignment2557" title="Possible causes if replication does not work" summary="This table lists possible causes for a replication scheme that does not work. It also provides references to more information." dir="ltr">
<thead>
<tr class="cellalignment2551">
<th class="cellalignment2558" id="r1c1-t6">Possible cause</th>
<th class="cellalignment2558" id="r1c2-t6">See...</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r2c1-t6" headers="r1c1-t6">TimesTen daemon or replication agents are not running.</td>
<td class="cellalignment2559" headers="r2c1-t6 r1c2-t6"><a href="#i577651">&#34;Check status of TimesTen daemon and replication agents&#34;</a>, below</td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r3c1-t6" headers="r1c1-t6">Master and subscriber agents are not communicating.</td>
<td class="cellalignment2559" headers="r3c1-t6 r1c2-t6"><a href="#i509561">&#34;Check that replication agents are communicating&#34;</a></td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r4c1-t6" headers="r1c1-t6">Replication is not in Start state.</td>
<td class="cellalignment2559" headers="r4c1-t6 r1c2-t6"><a href="#i528456">&#34;Check replication state&#34;</a></td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r5c1-t6" headers="r1c1-t6">There is an error in the replication scheme.</td>
<td class="cellalignment2559" headers="r5c1-t6 r1c2-t6"><a href="#i505137">&#34;Check replication scheme configuration&#34;</a></td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r6c1-t6" headers="r1c1-t6">Owner names for replication scheme and tables are inconsistent.</td>
<td class="cellalignment2559" headers="r6c1-t6 r1c2-t6"><a href="#i509595">&#34;Check owner names&#34;</a></td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r7c1-t6" headers="r1c1-t6">Replication tables are inconsistent.</td>
<td class="cellalignment2559" headers="r7c1-t6 r1c2-t6"><a href="#i528173">&#34;Check consistency between replicated tables&#34;</a></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblhruleinformal" -->
<a id="i577651"></a>
<div id="TTTRB289" class="sect2">
<h3 class="sect2">Check status of TimesTen daemon and replication agents</h3>
<p>Use the <code>ttStatus</code> utility to confirm the main TimesTen daemon is running and the replication agents are started for all of your master and subscriber databases. The output from a simple replication scheme using a single master and subscriber database should look like that shown in <a href="#i577018">Example 4-1</a>.</p>
<p>If the TimesTen daemon is running, but the replication agents are not, the output looks like that shown in <a href="#i510952">Example 4-2</a>. In this case, start the replication agents as described in <a class="olink TTREP428" href="../TTREP/setup.htm#TTREP428">&#34;Starting and stopping the replication agents&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span>.</p>
<p>If neither the TimesTen daemon or replication agents are running, the output looks like that shown in <a href="#i524792">Example 4-3</a>. In this case, confirm you have correctly installed TimesTen and the Data Manager service is started, as described in <a class="olink TTINS113" href="../TTINS/install.htm#TTINS113">&#34;TimesTen Installation&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Installation Guide</span>.</p>
<div id="TTTRB290" class="example">
<p class="titleinexample"><a id="i577018"></a>Example 4-1 ttStatus output for one master and one subscriber</p>
<pre>C:\&gt;ttStatus
TimesTen status report as of Mon Aug  6 22:07:53 2012
Daemon pid 5088 port 17000 instance MYINSTANCE
TimesTen server pid 4344 started on port 17002
------------------------------------------------------------------------
Data store c:\temp\subscriber1ds
There are 12 connections to the data store
Data store is in shared mode
Shared Memory KEY Global\DBI45b9471c.2.SHM.2 HANDLE 0x280
Type            PID     Context     Connection Name              ConnID
Process         1244    0x00d08fb0  subscriber1ds                     1
Replication     4548    0x00aed2f8  LOGFORCE                          4
Replication     4548    0x00b03470  TRANSMITTER                       5
Replication     4548    0x00b725a8  RECEIVER                          6
Replication     4548    0x00b82808  REPHOLD                           2
Replication     4548    0x00b98980  REPLISTENER                       3
Subdaemon       2752    0x00526768  Worker                         2042
Subdaemon       2752    0x0072a758  Flusher                        2043
Subdaemon       2752    0x007308c0  Checkpoint                     2044
Subdaemon       2752    0x00736a28  HistGC                         2046
Subdaemon       2752    0x067f02f8  Aging                          2045
Subdaemon       2752    0x068364a0  Monitor                        2047
Replication policy  : Manual
Replication agent is running.
Cache agent policy : Manual
------------------------------------------------------------------------
Data store c:\temp\masterds
There are 12 connections to the data store
Data store is in shared mode
Shared Memory KEY Global\DBI45b945d0.0.SHM.6 HANDLE 0x2bc
Type            PID     Context     Connection Name              ConnID
Process         5880    0x00d09008  masterds                          1
Replication     3728    0x00aed570  LOGFORCE                          4
Replication     3728    0x00b036e8  TRANSMITTER                       5
Replication     3728    0x00b168b8  REPHOLD                           3
Replication     3728    0x00b1ca20  REPLISTENER                       2
Replication     3728    0x00b22b88  RECEIVER                          6
Subdaemon       3220    0x00526768  Worker                         2042
Subdaemon       3220    0x0072e768  Flusher                        2043
Subdaemon       3220    0x007348d0  Checkpoint                     2044
Subdaemon       3220    0x067b0068  Aging                          2045
Subdaemon       3220    0x067c0040  Monitor                        2047
Subdaemon       3220    0x068404c8  HistGC                         2046
Replication policy  : Manual
Replication agent is running.
Cache agent policy : Manual
------------------------------------------------------------------------
Data store c:\temp\demo
There are no connections to the data store
Replication policy : Manual
Cache agent policy : Manual
------------------------------------------------------------------------
End of report
</pre></div>
<!-- class="example" -->
<div id="TTTRB291" class="example">
<p class="titleinexample"><a id="i510952"></a>Example 4-2 Replication agent is not running</p>
<pre>&gt; ttStatus
TimesTen status report as of Mon Aug  6 22:07:53 2012

Daemon pid 3396 port 15000 instance MYINSTANCE
TimesTen server pid 3436 started on port 15002
-----------------------------------------------------------------
Data store c:\temp\subscriberds
There are no connections to the data store
cache agent restart policy: manual
-----------------------------------------------------------------
Data store c:\temp\masterds
There are no connections to the data store
cache agent restart policy: manual
-----------------------------------------------------------------
End of report
</pre></div>
<!-- class="example" -->
<div id="TTTRB292" class="example">
<p class="titleinexample"><a id="i524792"></a>Example 4-3 TimesTen daemon and replication agent are not running</p>
<pre>&gt; ttStatus
ttStatus: Could not connect to TimesTen daemon: Connection refused
</pre></div>
<!-- class="example" --></div>
<!-- class="sect2" -->
<a id="i509561"></a>
<div id="TTTRB293" class="sect2">
<h3 class="sect2">Check that replication agents are communicating</h3>
<p>Use <code>ttRepAdmin</code> <code>-receiver -list</code> to see that the replication agents are communicating with each other. If the <code>masterds</code> database is replicating to <code>subscriberds</code>, the output should look similar to the following:</p>
<div id="TTTRB294" class="example">
<p class="titleinexample"><a id="sthref263"></a>Example 4-4 Check that the replication agents are communicating</p>
<pre>&gt; ttRepAdmin -receiver -list masterDSN
Peer name         Host name                 Port    State  Proto
----------------  ------------------------ ------  ------- -----
SUBSCRIBERDS      MYHOST                    Auto   Start       10

Last Msg Sent Last Msg Recv Latency TPS     RecordsPS Logs
------------- ------------- ------- ------- --------- ----
0:01:12       -               19.41       5        52    2
</pre></div>
<!-- class="example" --></div>
<!-- class="sect2" -->
<a id="i528456"></a>
<div id="TTTRB295" class="sect2">
<h3 class="sect2">Check replication state</h3>
<p>Use the <code>ttReplicationStatus</code> procedure to check the state of the subscriber database with respect to its master. If the subscriber is in the <code>Stop</code>, <code>Pause</code>, or <code>Failed</code> state, use the <code>ttReplicationStatus</code> procedure to reset the subscriber state to <code>Start</code>, as described in <a class="olink TTREP436" href="../TTREP/setup.htm#TTREP436">&#34;Setting the replication state of subscribers&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span>.</p>
<div id="TTTRB296" class="example">
<p class="titleinexample"><a id="sthref264"></a>Example 4-5 Obtain status of the subscriber database from the master database</p>
<p>Use <code>ttReplicationStatus</code> to obtain the status of the <code>subscriberds</code> database from its master database, <code>masterDSN</code>, enter:</p>
<pre>&gt; ttIsql masterDSN
Command&gt; CALL ttReplicationStatus (&#39;subscriberds&#39;);
&lt; SUBSCRIBERDS, MYHOST, 0, pause, 1, 10, REPSCHEME, REPL &gt;
1 row found.
</pre>
<p>To reset state to Start call the <code>ttRepSubscriberStateSet</code> procedure:</p>
<pre>Command&gt; CALL ttRepSubscriberStateSet(&#39;REPSCHEME&#39;, &#39;REPL&#39;, &#39;SUBSCRIBERDS&#39;, &#39;MYHOST&#39;, 0)
Command&gt; CALL ttReplicationStatus (&#39;subscriberds&#39;);
&lt; SUBSCRIBERDS, MYHOST, 0, start, 1, 152959, REPSCHEME, REPL &gt;
1 row found.
</pre></div>
<!-- class="example" --></div>
<!-- class="sect2" -->
<a id="i505137"></a>
<div id="TTTRB297" class="sect2">
<h3 class="sect2">Check replication scheme configuration</h3>
<p>This section describes some procedures you can use to confirm the correct configuration of the various components in your replicated system. The basic procedure categories are:</p>
<ul>
<li>
<p><a href="#i541091">Check ttRepAdmin -showconfig</a></p>
</li>
<li>
<p><a href="#i541110">Check the TTREP.TTSTORES table</a></p>
</li>
<li>
<p><a href="#i541111">Check host names</a></p>
</li>
</ul>
<a id="i541091"></a>
<div id="TTTRB298" class="sect3">
<h4 class="sect3">Check ttRepAdmin -showconfig</h4>
<p>Use <code>ttRepAdmin</code> <code>-showconfig</code> to confirm the configuration of your replication scheme.</p>
<p>What to look for:</p>
<ul>
<li>
<p>Are all of the subscriber agents started and reported to be in the Start state? If not, reset the agents to the Start state. See <a class="olink TTREP436" href="../TTREP/setup.htm#TTREP436">&#34;Setting the replication state of subscribers&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span>.</p>
</li>
<li>
<p>Do the reported Peer names match the names given in the <code>DataStore</code> attributes in the DSN definitions for the replicated databases? Replication does not work if you specified the names given for the Data Source <code>Name</code> attributes.</p>
</li>
<li>
<p>Is there anything under List of subscribers? If not, confirm the database names you specified in the DSN definition are consistent with those you specified in your replication scheme configuration file.</p>
</li>
<li>
<p>Are the Host names correct? If in doubt, see <a href="#i541111">&#34;Check host names&#34;</a>.</p>
</li>
<li>
<p>Are the correct table names displayed under Table details? If not, correct the table names in your replication scheme configuration file.</p>
</li>
</ul>
<div id="TTTRB299" class="example">
<p class="titleinexample"><a id="sthref265"></a>Example 4-6 Confirm the configuration of the replication scheme</p>
<pre>&gt; ttRepAdmin -showconfig masterDSN
Self host &#34;MYHOST&#34;, port auto, name &#34;MASTERDS&#34;, LSN 4/2970276, timeout 120, threshold 0
List of subscribers
-----------------
Peer name         Host name                 Port    State  Proto
----------------  ------------------------ ------  ------- -----
SUBSCRIBERDS      MYHOST                    Auto   Start      10
Last Msg Sent Last Msg Recv Latency TPS     RecordsPS Logs
------------- ------------- ------- ------- --------- ----
0:01:12       -               19.41       5        52    2
List of tables and subscriptions
--------------------------------
Table details
-------------
Table : REPL.TAB
Master Name               Subscriber Name
-----------               -------------
MASTERDS                  SUBSCRIBERDS
</pre></div>
<!-- class="example" --></div>
<!-- class="sect3" -->
<a id="i541110"></a>
<div id="TTTRB300" class="sect3">
<h4 class="sect3">Check the TTREP.TTSTORES table</h4>
<p>Check the <code>TTREP.TTSTORES</code> table to confirm that replication associates the replication scheme with the local database.</p>
<div id="TTTRB301" class="example">
<p class="titleinexample"><a id="sthref266"></a>Example 4-7 Confirm that the replication scheme is associated with the local database</p>
<p>Connect to the database and enter:</p>
<pre>SELECT * FROM ttrep.ttstores WHERE is_local_store &lt;&gt; 0x0;
</pre>
<pre>Command&gt; select * from ttrep.ttstores where is_local_store &lt;&gt; 0x0;
&lt; -5193371075573733683, MYHOST, MASTERDS, 01, 0, 0, 4, 0 &gt;
1 row found.
</pre>
<p>There should be exactly one row returned. If more than one row is returned, contact TimesTen technical support. If no rows are returned, then none of the hosts returned by the following statement is perceived to be a local system by TimesTen replication:</p>
<pre>SELECT DISTINCT <span class="codeinlineitalic">host_name</span> FROM ttrep.ttstores;
</pre>
<p>It may also be that none of the database names specified in your replication scheme match those specified in your DSN descriptions.</p>
</div>
<!-- class="example" --></div>
<!-- class="sect3" -->
<a id="i541111"></a>
<div id="TTTRB302" class="sect3">
<h4 class="sect3">Check host names</h4>
<p>Some hosts or IP addresses specified in a replication scheme cannot be resolved by the replication agent because:</p>
<ul>
<li>
<p>Host names or IP addresses specified in the replication scheme are wrong or misspelled.</p>
</li>
<li>
<p>Host names or IP addresses cannot be resolved or found by DNS or in the <code>/etc/hosts</code> file</p>
</li>
<li>
<p>Entries in the <code>/etc/hosts</code> file are incorrectly ordered in appearance. This error is most common when multiple NICs are used. You must have root privilege to make changes to the <code>/etc/hosts</code> files.</p>
</li>
</ul>
<p>See <a class="olink TTREP401" href="../TTREP/attrib.htm#TTREP401">&#34;Configuring the network&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span> for details on how to configure DNS and <code>/etc/hosts</code> files for host systems used for replication.</p>
<p>To check if a host name in the replication scheme matches the host name of the local system, write an application to perform these tasks:</p>
<a id="i541351"></a>
<ol>
<li>
<p>Use a <code>gethostname</code> operating system function call to determine the host name of the running host.</p>
</li>
<li id="i541380">
<p>Call <code>gethostbyname</code> with the output from Step 1.</p>
</li>
<li>
<p>Call <code>gethostbyname</code> with the host name specified in the replication scheme.</p>
</li>
<li>
<p>Compare output of Step 2 and Step 3. If there is a match, then the running host is involved in replication. Otherwise, it is not involved in replication.</p>
</li>
</ol>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i509595"></a>
<div id="TTTRB303" class="sect2">
<h3 class="sect2">Check owner names</h3>
<p>As described in <a class="olink TTREP413" href="../TTREP/design.htm#TTREP413">&#34;Table requirements and restrictions for classic replication schemes&#34;</a> and <a class="olink TTREP316" href="../TTREP/design.htm#TTREP316">&#34;Owner of the replication scheme and replicated objects&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span>, the owner names of your replication scheme and your replicated tables must be consistent across all participating databases. This indicates that the replication scheme owner must match in all databases and each table must be owned by the same user in each database.</p>
<div id="TTTRB304" class="sect3"><a id="sthref267"></a>
<h4 class="sect3">Checking replication owner</h4>
<p>Check the owner name assigned to your replication scheme by calling the <code>ttIsql</code> <code>repschemes</code> command or by listing the contents of the <code>TTREP.REPLICATIONS</code> table.</p>
<p><a href="#i508971">Example 4-8</a> shows that the replication scheme name, <code>REPSCHEME</code>, has a consistent owner name (<code>REPL</code>) in the databases on both <code>SYSTEM1</code> and <code>SYSTEM2</code>. <a href="#i508999">Example 4-9</a> shows the scheme name with inconsistent owner names. This can occur if you omit the owner name from the replication scheme definition and the system uses the Id of the replication scheme creator.</p>
<div id="TTTRB305" class="example">
<p class="titleinexample"><a id="i508971"></a>Example 4-8 Consistent owner names for replication scheme</p>
<p>On <code>SYSTEM1</code>:</p>
<pre>&gt; ttIsql masterDSN
Command&gt; select * from ttrep.replications;
&lt; REPSCHEME            , REPL                 , C, 0, 0, -1 &gt;
1 row found.
</pre>
<p>On <code>SYSTEM2</code>:</p>
<pre>&gt; ttIsql -connStr &#34;dsn=subscriberDSN&#34;
Command&gt; select * from ttrep.replications;
&lt; REPSCHEME            , REPL                 , C, 0, 0, -1 &gt;
1 row found.
</pre></div>
<!-- class="example" -->
<div id="TTTRB306" class="example">
<p class="titleinexample"><a id="i508999"></a>Example 4-9 Inconsistent owner names for replication scheme</p>
<p>On <code>SYSTEM1</code>:</p>
<pre>&gt; ttIsql masterDSN
Command&gt; select * from ttrep.replications;
&lt; REPSCHEME            , SYSTEM1               , C, 0, 0, -1 &gt;
1 row found.
</pre>
<p>On <code>SYSTEM2</code>:</p>
<pre>&gt; ttIsql -connStr &#34;dsn=subscriberDSN&#34;
Command&gt; select * from ttrep.replications;
&lt; REPSCHEME            , SYSTEM2               , C, 0, 0, -1 &gt;
1 row found.
</pre></div>
<!-- class="example" --></div>
<!-- class="sect3" -->
<a id="i528092"></a>
<div id="TTTRB307" class="sect3">
<h4 class="sect3">Checking table owner</h4>
<p>Check the owner names assigned to the tables in each database by using the <code>ttIsql</code> <code>tables</code> command.</p>
<div id="TTTRB308" class="example">
<p class="titleinexample"><a id="sthref268"></a>Example 4-10 Consistent table owner names</p>
<p>This example shows that the <code>TAB</code> table has a consistent owner name (<code>REPL</code>) in the databases on both <code>SYSTEM1</code> and <code>SYSTEM2</code>.</p>
</div>
<!-- class="example" -->
<div class="inftblhruleinformal">
<table class="cellalignment2557" title=" Title value required on InformallTable elements!!!" summary=" Summary value required!!!" dir="ltr">
<thead>
<tr class="cellalignment2551">
<th class="cellalignment2558" id="r1c1-t7">Output for SYSTEM1</th>
<th class="cellalignment2558" id="r1c2-t7">Output for SYSTEM2</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r2c1-t7" headers="r1c1-t7">
<pre>REPL.TAB
</pre></td>
<td class="cellalignment2559" headers="r2c1-t7 r1c2-t7">
<pre>REPL.TAB
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblhruleinformal" -->
<div id="TTTRB309" class="example">
<p class="titleinexample"><a id="i511190"></a>Example 4-11 Inconsistent table owner names</p>
<p>This example shows the <code>TAB</code> table with inconsistent owner names, which were automatically assigned for each host.</p>
</div>
<!-- class="example" -->
<div class="inftblhruleinformal">
<table class="cellalignment2557" title="Output for SYSTEM1 and SYSTEM2" summary="This table compares output for SYSTEM1 and and SYSTEM2. SYSTEM1.TAB and SYSTEM2.TAB are highlighted." dir="ltr">
<thead>
<tr class="cellalignment2551">
<th class="cellalignment2558" id="r1c1-t8">Output for SYSTEM1</th>
<th class="cellalignment2558" id="r1c2-t8">Output for SYSTEM2</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r2c1-t8" headers="r1c1-t8">
<pre>SYSTEM1.TAB
</pre></td>
<td class="cellalignment2559" headers="r2c1-t8 r1c2-t8">
<pre>SYSTEM2.TAB
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblhruleinformal" --></div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i528173"></a>
<div id="TTTRB310" class="sect2">
<h3 class="sect2">Check consistency between replicated tables</h3>
<p>By default, TimesTen creates a replication scheme with the <code>TABLE DEFINITION CHECKING RELAXED</code> attribute. The <code>TABLE DEFINITION CHECKING RELAXED</code> attribute does not require that the column definition of replicated tables be identical. Rather, the <code>RELAXED</code> attribute only requires that replicated tables have the same key definition, number of columns, column names, and column data types. If you define the replication scheme with the <code>TABLE</code> <code>DEFINITION</code> <code>CHECKING</code> <code>EXACT</code> clause, then the column definitions of replicated tables participating in the replication scheme must be identical on the master and subscriber databases. TimesTen recommends that you use <code>TABLE</code> <code>DEFINITION</code> <code>CHECKING</code> <code>RELAXED</code>. For more information, see <a class="olink TTREP770" href="../TTREP/attrib.htm#TTREP770">&#34;Column definition options for replicated tables&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span>.</p>
<div id="TTTRB311" class="example">
<p class="titleinexample"><a id="sthref269"></a>Example 4-12 Check consistency between replicated tables</p>
<p>This output from the user error log shows a mismatch on the number of columns for the subscriber table <code>TTUSER.MYDSN</code>.</p>
<pre>11:37:58.00 Info: REP:  9430: REP1:transmitter.c(4936): TT16136: Sending 
definition for table TTUSER.MYDSN (1 column)
11:37:58.00 Info: REP:  9412: REP2:receiver.c(5928): TT16193: Adding definition
for table: TTUSER.MYDSN
11:37:58.00 Info: REP:  9412: REP2:meta.c(5580):TTUSER.MYDSN ptn 0: srcoff 0, 
destoff 0, length 8
11:37:58.00 Info: REP:  9412: REP2:meta.c(5580):TTUSER.MYDSN ptn 1: srcoff 8, 
destoff 12, length 12
11:37:58.00 Err : REP:  9412: REP2:receiver.c(6203): TT16198: Table definition 
mismatch on number of columns for table TTUSER.MYDSN.  Local definition: 2; 
transmitting peer: 1
11:37:58.00 Err : REP:  9412: REP2:receiver.c(6380): TT16204: Table TTUSER.MYDSN 
marked invalid. Will not apply transactions received for it until a valid 
definition is received
11:37:58.00 Err : REP:  9412: REP2:receiver.c(7200): TT16078: Table definition 
for ID 637068 is invalid (Original failure 11:37:58
REP2:receiver.c(6203): TT16198: Table definition mismatch on number of columns 
for table TTUSER.MYDSN.  Local definition: 2; transmitting peer: 1)
11:37:58.00 Err : REP:  9412: REP2:receiver.c(5002): TT16187: Transaction 
1173958671/2; Error: transient 0, permanent 1
</pre></div>
<!-- class="example" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i529345"></a>
<div id="TTTRB312" class="sect1">
<h2 class="sect1">Replication unresponsive, appears hung</h2>
<p>Table summary is in the first heading cell.</p>
<div class="inftblhruleinformal">
<table class="cellalignment2557" title="Problems with unresponsive replication" summary="This table lists possible causes for unresponsive replication. It provides references to more information." dir="ltr">
<thead>
<tr class="cellalignment2551">
<th class="cellalignment2558" id="r1c1-t9">Possible cause</th>
<th class="cellalignment2558" id="r1c2-t9">See...</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r2c1-t9" headers="r1c1-t9">There is a failed subscriber.</td>
<td class="cellalignment2559" headers="r2c1-t9 r1c2-t9"><a href="#i529406">&#34;Check replication state&#34;</a>, below</td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r3c1-t9" headers="r1c1-t9">Return-receipt timeout period is too long.</td>
<td class="cellalignment2559" headers="r3c1-t9 r1c2-t9"><a href="#i529561">&#34;Check return receipt timeout setting&#34;</a>, below</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblhruleinformal" -->
<a id="i529406"></a>
<div id="TTTRB313" class="sect2">
<h3 class="sect2">Check replication state</h3>
<p>Use the <code>ttReplicationStatus</code> procedure to check state of the subscriber database with respect to its master. If the subscriber is in the <code>Failed</code> state, see <a class="olink TTREP651" href="../TTREP/failure.htm#TTREP651">&#34;Managing Database Failover and Recovery&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span> for information on how to deal with failed databases.</p>
<div id="TTTRB314" class="example">
<p class="titleinexample"><a id="sthref270"></a>Example 4-13 Check replication state</p>
<p>Use <code>ttReplicationStatus</code> to obtain the status of the <code>subscriberds</code> database from its master database, <code>masterDSN</code>, enter:</p>
<pre>&gt; ttIsql masterDSN
Command&gt; CALL ttReplicationStatus (&#39;subscriberds&#39;);
&lt; SUBSCRIBERDS, MYHOST, 0, failed, 1, 10, REPSCHEME, REPL &gt;
1 row found.
</pre></div>
<!-- class="example" --></div>
<!-- class="sect2" -->
<a id="i529561"></a>
<div id="TTTRB315" class="sect2">
<h3 class="sect2">Check return receipt timeout setting</h3>
<p>Use the <code>ttRepSyncGet</code> procedure to check the return receipt timeout setting. A value of -1 indicates the application is to wait until it receives an acknowledgment from the subscriber. Network latency or other issues might delay receipt of the subscriber acknowledgment. You either address these issues or use the <code>ttRepSyncGet</code> procedure to reset the return receipt timeout period.</p>
<p>See <a class="olink TTREP478" href="../TTREP/monitor.htm#TTREP478">&#34;Check the status of return service transactions&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span> for more information.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i528938"></a>
<div id="TTTRB316" class="sect1">
<h2 class="sect1">Poor replication or XLA performance</h2>
<p>Most of <a id="sthref271"></a><a id="sthref272"></a>this section addresses issues that may impact replication performance. Some issues, such as log buffer too small and reading from the transaction log files on disk, can impact the performance of both replication and XLA applications.</p>
<div class="inftblhruleinformal">
<table class="cellalignment2557" title="Poor performance of replication or XLA" summary="This table lists possible causes for poor performance of replication or XLA. It provides references to more information." dir="ltr">
<thead>
<tr class="cellalignment2551">
<th class="cellalignment2558" id="r1c1-t10">Possible cause</th>
<th class="cellalignment2558" id="r1c2-t10">See...</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r2c1-t10" headers="r1c1-t10">Network is slow.</td>
<td class="cellalignment2559" headers="r2c1-t10 r1c2-t10"><a href="#i528950">&#34;Check network bandwidth&#34;</a>, below</td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r3c1-t10" headers="r1c1-t10"><code>RETURN RECEIPT</code> is used.</td>
<td class="cellalignment2559" headers="r3c1-t10 r1c2-t10"><a href="#i528939">&#34;Check use of return receipt blocking&#34;</a>, below</td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r4c1-t10" headers="r1c1-t10">Replication scheme is inconsistent.</td>
<td class="cellalignment2559" headers="r4c1-t10 r1c2-t10"><a href="#i529006">&#34;Check replication configuration&#34;</a></td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r5c1-t10" headers="r1c1-t10">Log buffer is too small.</td>
<td class="cellalignment2559" headers="r5c1-t10 r1c2-t10"><a href="#i529119">&#34;Check size of log buffer&#34;</a></td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r6c1-t10" headers="r1c1-t10">There are frequent or inefficient disk writes.</td>
<td class="cellalignment2559" headers="r6c1-t10 r1c2-t10"><a href="#i529139">&#34;Check durability settings&#34;</a></td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r7c1-t10" headers="r1c1-t10">Reading from transaction log files on disk rather than the log buffer.</td>
<td class="cellalignment2559" headers="r7c1-t10 r1c2-t10"><a href="#i533087">&#34;Check for reads from transaction log files&#34;</a></td>
</tr>
<tr class="cellalignment2551">
<td class="cellalignment2559" id="r8c1-t10" headers="r1c1-t10">Rate of conflicts is high.</td>
<td class="cellalignment2559" headers="r8c1-t10 r1c2-t10"><a href="#i561667">&#34;Conflict reporting slows down replication&#34;</a></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblhruleinformal" -->
<a id="i528950"></a>
<div id="TTTRB317" class="sect2">
<h3 class="sect2">Check network bandwidth</h3>
<p>Replication agents typically communicate over some type of network connection. If replicating over a network slower than 10 MB per second (such as common with a 100 Base-T Ethernet typical in a LAN), you must be careful to match the transaction load to the available bandwidth of the network. see <a class="olink TTREP402" href="../TTREP/attrib.htm#TTREP402">&#34;Network bandwidth requirements&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span> for details.</p>
</div>
<!-- class="sect2" -->
<a id="i528939"></a>
<div id="TTTRB318" class="sect2">
<h3 class="sect2">Check use of return receipt blocking</h3>
<p>Unless you need receipt confirmation for all your transactions, disable <code>RETURN RECEIPT BLOCKING</code>. If you require receipt confirmation for some transactions, then set <code>RETURN RECEIPT BY REQUEST</code> and call the <code>ttRepSyncSet</code> procedure to enable the return receipt service for specific transactions. See <a class="olink TTREP185" href="../TTREP/attrib.htm#TTREP185">&#34;RETURN RECEIPT BY REQUEST&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span> for details.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The performance degradation caused by return-receipt becomes less of an issue when multiple applications (or threads) are updating the database. If you must use return-receipt in a transaction, you can improve the performance of your application by using multiple threads to update the database. Though each thread must block for receipt confirmation, the other threads are free to make updates.</div>
</div>
<!-- class="sect2" -->
<a id="i529006"></a>
<div id="TTTRB319" class="sect2">
<h3 class="sect2">Check replication configuration</h3>
<p>In addition to return-receipt setting described above, other factors related to the configuration of your replication scheme could impact replication performance. As described in <a class="olink TTREP312" href="../TTREP/design.htm#TTREP312">&#34;Making decisions about performance and recovery tradeoffs&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span>, you often have to weigh the ability to efficiently failover and recover a database against replication performance.</p>
<p>For more information about direct replication, see <a class="olink TTREP139" href="../TTREP/overview.htm#TTREP139">&#34;Direct replication or propagation&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span>.</p>
</div>
<!-- class="sect2" -->
<a id="i529119"></a>
<div id="TTTRB320" class="sect2">
<h3 class="sect2">Check size of log buffer</h3>
<p><a id="sthref273"></a><a id="sthref274"></a><a id="sthref275"></a>Setting your log buffer too small may impact replication performance. Instead, Set the <code><a id="sthref276"></a>LogBufMB</code> DSN attribute to a larger size. For more information on this DSN attribute, see <a class="olink TTREP421" href="../TTREP/setup.htm#TTREP421">&#34;Setting connection attributes for logging&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span></p>
</div>
<!-- class="sect2" -->
<a id="i529139"></a>
<div id="TTTRB321" class="sect2">
<h3 class="sect2">Check durability settings</h3>
<p>You can improve replication performance by setting <code>TRANSMIT NONDURABLE</code> on the replication <code>ELEMENT</code> to eliminate the flush-log-to-disk operation from the replication cycle. See <a class="olink TTREP323" href="../TTREP/design.htm#TTREP323">&#34;Setting transmit durability on DATASTORE element&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span> for details.</p>
<p>Enabling the <code>DURABLE COMMIT</code> option in your replication scheme also impacts performance. See <a class="olink TTREP198" href="../TTREP/attrib.htm#TTREP198">&#34;DURABLE COMMIT&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span> for more information.</p>
</div>
<!-- class="sect2" -->
<a id="i533087"></a>
<div id="TTTRB322" class="sect2">
<h3 class="sect2">Check for reads from transaction log files</h3>
<p>In some situations a &#34;log reader,&#34; such as a master replication agent &#39;transmitter&#39; thread or a <code>ttXlaNextUpdate</code> call in an XLA application, may not be able to keep up with the update rate of the applications writing to the database. Normally, replication and XLA readers get update records from the log buffer in memory. When the readers fall behind the application update rate, transaction log files can accumulate on the disk until the backlog can be cleared. This forces the readers to read transactions from the transaction log files on disk, which is much slower. Should you detect reads from the transaction log files, you may want to respond by decreasing the rate of application updates to that sustainable by the log readers.</p>
<p>Applications can monitor whether log readers are obtaining update records from transaction log files on disk rather than from the log buffer in memory by tracking the <code>SYS.MONITOR</code> table entry <code>LOG_FS_READS</code>. For example, you can check the value of <code>LOG_FS_READS</code> for the database, <code>MASTERDSN</code>, with the following <code>ttIsql</code> command.</p>
<pre>% ttIsql -v1 -e &#34;select log_fs_reads from monitor; quit;&#34; -connStr dsn=MASTERDSN
</pre>
<p>If the <code>LOG_FS_READS</code> counter is increasing, the log readers are falling behind or clearing out a backlog in the transaction log files.</p>
<p>For more complete monitoring of replication progress, create a simple shell script like the following:</p>
<pre>!/bin/sh
trap exit 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
DSN=$1

while [ 1 ] ; do
   date
   ttRepAdmin -receiver -list -connStr dsn=$DSN
   echo -n &#34;Log reads from disk: &#34;
   ttIsql -v1 -e &#34;select log_fs_reads from monitor; quit;&#34; -connStr dsn=$DSN
   echo
   ttRepAdmin -bookmark -connStr dsn=$DSN
sleep 15
done
</pre>
<div id="TTTRB323" class="example">
<p class="titleinexample"><a id="i533612"></a>Example 4-14 Check the status of the transaction log</p>
<p>For example, you name the above script <code>monitorLog</code> and your replication scheme replicates from the <code>MASTERDSN</code> database to the <code>SUBSCRIBER1DSN</code> database. You can then check the status of the transaction log by entering:</p>
<pre>$ monitorLog masterdsn
</pre>
<p>This generates output similar to the following:</p>
<pre>Mon Aug  2 10:44:40  2004
Peer name         Host name                 Port    State  Proto
----------------  ------------------------ ------  ------- -----
SUBSCRIBER1DSN    MYHOST                    Auto    Start   12

Last Msg Sent Last Msg Recv Latency TPS     RecordsPS Logs
------------- ------------- ------- ------- --------- ----
00:00:05      -               -1.00      -1        -1    1

Log reads from disk: &lt; 0 &gt;

Replication hold LSN ...... 10/2656136
Last written LSN .......... 10/4015824
Last LSN forced to disk ... 10/3970152
</pre>
<p>The output from the script displays an updated status every 15 seconds until you enter Ctrl-C to exit.</p>
<p>Following the date in the output in <a href="#i533612">Example 4-14</a> is the name of the subscriber, its host, and so on. Next is latency and rate information, as well as the number of transaction log files being retained on behalf of this subscriber. The specific meaning of each value is described in <a class="olink TTREP455" href="../TTREP/monitor.htm#TTREP455">&#34;Display subscriber status with the ttRepAdmin utility&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span>. The main interest here is the &#39;Last Msg Sent&#39; and &#39;Logs&#39; values. The &#39;Last Msg Sent&#39; value indicates the elapsed time since the last message was sent by the master to the subscriber and &#39;Logs&#39; indicates how many transaction log files behind the replication log reader is from the current log insertion point used by the writers (Last written LSN).</p>
<p>Normally the &#39;Logs&#39; value should be &#39;1&#39;, as shown in <a href="#i533612">Example 4-14</a>. A steadily increasing &#39;Logs&#39; value indicates latency is increasing and eventually log reads are satisfied from disk.</p>
</div>
<!-- class="example" -->
<div class="infobox-note">
<p class="notep1">Note:</p>
If the <code>LogBufMB</code> is larger than the <code>LogFileSize</code>, an increase in the &#39;Logs&#39; value does not necessarily mean the log readers are reading from the transaction log files. This is because the log manager does not allow more than one log file&#39;s worth of data to be outstanding before writing it to the file system. After the log manager writes the data, the data remains in the log buffer to be read directly by the log readers. So, when the <code>LogBufMB</code> is larger than the <code>LogFileSize</code>, the &#39;Logs&#34; value alone may not be the best measure of whether log readers are reading from memory or from disk.</div>
<p>The output from the following command displays the number of the transaction log files and the location of the bookmarks set by the log manager.</p>
<pre>ttRepAdmin -bookmark -connStr dsn=$DSN
</pre>
<p>For more information, see <a class="olink TTREP469" href="../TTREP/monitor.htm#TTREP469">&#34;Monitor replication with the ttRepAdmin utility&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span>. The difference between the Replication hold LSN and the last written LSN indicates the number of records in the transaction log that have not yet been transmitted to the subscribers. A steady increase in the difference between these values is another indication that replication latency is increasing and log file reads are likely to occur.</p>
<div id="TTTRB324" class="example">
<p class="titleinexample"><a id="sthref277"></a>Example 4-15 Log reader must read from transaction log files</p>
<p>In this example, assume the <code>LogBufMB</code> is 16MB and the <code>LogFileSize</code> is 8MB. The following output indicates the log reader is approximately 1.8 MB behind the capacity of the log buffer and must read from the transaction log files, 14 and 15.</p>
<pre>Peer name         Host name                Port    State   Proto
----------------  ------------------------ ------  ------- -----
SUBSCRIBER1DSN    MYHOST                   Auto    Start   12

Last Msg Sent Last Msg Recv Latency TPS     RecordsPS Logs
------------- ------------- ------- ------- --------- ----
00:00:03      -               -1.00      -1        -1    4

Log reads from disk: &lt;20&gt;

Replication hold LSN ...... 14/7007464
Last written LSN .......... 17/465336
Last LSN forced to disk ... 17/456152
</pre></div>
<!-- class="example" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i516053"></a>
<div id="TTTRB325" class="sect1">
<h2 class="sect1">Problems using <a id="sthref278"></a>ttRepAdmin</h2>
<p>This section includes the following topics:</p>
<ul>
<li>
<p><a href="#CACEDFFD">Problems when changing the state of a replication receiver</a></p>
</li>
<li>
<p><a href="#i507650">Problems using ttRepAdmin -duplicate</a></p>
</li>
<li>
<p><a href="#i507649">Returns &#39;Must specify -scheme&#39; error</a></p>
</li>
</ul>
<a id="CACEDFFD"></a>
<div id="TTTRB364" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Problems when changing the state of a replication receiver<a id="sthref279"></a><a id="sthref280"></a><a id="sthref281"></a><a id="sthref282"></a></h3>
<p>If you try to change the state of a replication receiver when replication has been configured to use a secondary IP address, a misconfiguration of the <code>/etc/hosts</code> file may cause <code>ttRepAdmin</code> to print the following error:</p>
<pre>Alter replication with &#39;ALTER REPLICATION...port 0&#39; failed: 
TT0907: Unique constraint (REPSTORESIX) violated. 
</pre>
<p>This error is caused by replication not recognizing the local database, which can be confirmed by the following query:</p>
<pre>SELECT * FROM ttrep.ttstores WHERE is_local_store &lt;&gt; 0x0;
</pre>
<p>If this query returns no rows, or returns a row with the main host name of the database set to the result of the hostname command rather than the host you specified, you have encountered a configuration problem with the <code>/etc/hosts</code> file.</p>
<p>To correct the problem, make sure that the special host name you are using is defined in the <code>/etc/hosts</code> file and that there is an IP address in common between your special host name and the result of the <code>hostname</code> command.</p>
<p>For example, if the <code>hostname</code> command returns <code>softswitch</code> and your system has two Ethernet cards with the addresses <code>10.10.15.136</code> and <code>192.168.15.136</code>, the IP addresses defined for <code>softswitch</code> should include both IP addresses.</p>
</div>
<!-- class="sect2" -->
<a id="i507650"></a>
<div id="TTTRB326" class="sect2">
<h3 class="sect2">Problems using ttRepAdmin -duplicate</h3>
<p>Make sure that Timesten is installed with the same instance administrator on both the source system and target system. If so, then <a id="sthref283"></a><a id="sthref284"></a><a id="sthref285"></a><a id="sthref286"></a>consider other causes:</p>
<ul>
<li>
<p><a href="#CACGHDEH">Database created before duplication</a></p>
</li>
<li>
<p><a href="#CACGAFIC">Wrong database or host name</a></p>
</li>
</ul>
<a id="CACGHDEH"></a>
<div id="TTTRB359" class="sect3">
<h4 class="sect3">Database created before duplication</h4>
<p>If you connected to your new subscriber DSN before running <code>ttRepAdmin</code> <code>-duplicate</code>, the database has already been created. In this situation, <code>-duplicate</code> returns:</p>
<pre>Error : Restore not done : The datastore already exists.
Unable to restore datastore locally
</pre>
<p>Confirm the existence of the database by running <code>ttStatus</code> and checking to see if the database is in the returned list. If the new subscriber database exists, destroy it and try <code>ttRepAdmin</code> <code>-duplicate</code> again.</p>
<pre>&gt; ttDestroy /tmp/newstore
&gt; ttRepAdmin -dsn newstoreDSN -duplicate -name newstore
-from masterds -host &#34;server1&#34;
</pre></div>
<!-- class="sect3" -->
<a id="CACGAFIC"></a>
<div id="TTTRB360" class="sect3">
<h4 class="sect3">Wrong database or host name</h4>
<p>If you have made an error entering the subscriber database name or host name in the replication scheme, you may see something like the following:</p>
<pre>Unable to swap datastore locally
No receiver NEWSTORE on SERVER2 found to swap with
</pre>
<p>If you provide an incorrect host name for a subscriber, you may receive this error:</p>
<pre>Problem: ttRepAdmin -duplicate command returns TimesTen error 12080: No 
subscriber found to swap with.
</pre>
<p>You also receive information about the subscriber that TimesTen is trying to locate. One common cause is providing an incorrect host name, which must be the exact same name as the host name provided when issuing the <code>CREATE ACTIVE STANDBY PAIR</code> statement. For example, if you created the subscriber with <code>myhost.oracle.com</code>, but only provided <code>myhost</code> in the <code>ttRepAdmin -duplicate</code>, the subscriber will not be found.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If <code>myhost</code> is the local host, use the <code>-localhost</code> argument. You typically need to use the <code>-localhost</code> argument if the local host name does not exactly match the host name provided when creating the replication scheme.</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i507649"></a>
<div id="TTTRB327" class="sect2">
<h3 class="sect2">Returns &#39;Must specify -scheme&#39; error</h3>
<p>If you have more than one scheme specified in your <code>TTREP.REPLICATIONS</code> table, some <code>ttRepAdmin</code> commands may return the error:</p>
<pre>Must specify -scheme to identify which replication scheme to use
</pre>
<p>To check the names of the replication schemes used by your database, use the <code>ttIsql</code> utility to connect, and enter:</p>
<pre>Command&gt; SELECT * from TTREP.REPLICATIONS;
</pre>
<div id="TTTRB328" class="example">
<p class="titleinexample"><a id="sthref287"></a>Example 4-16 Two replication schemes assigned to the database</p>
<p>This example shows that two replication schemes, <code>REPSCHEME1</code> and <code>REPSCHEME2</code>, are assigned to the database associated with <code>subDSN</code>. In this case, it is necessary to use the <code>ttRepAdmin</code> <code>-scheme</code> option.</p>
<pre>&gt; ttIsql -connStr &#34;dsn=subDSN&#34;
Command&gt; SELECT * from TTREP.REPLICATIONS;
&lt; REPSCHEME1      , REPL                , C, 0, 0, -1 &gt;
&lt; REPSCHEME2      , REPL                , C, 0, 0, -1 &gt;
2 rows found.
Command&gt; exit
&gt; ttRepAdmin -dsn subDSN -receiver -list -scheme REPSCHEME1
Peer name         Host name                 Port    State  Proto
----------------  ------------------------ ------  ------- -----
SUBSCRIBER1        MYHOST                   Auto   Start      10

Last Msg Sent Last Msg Recv Latency TPS     RecordsPS Logs
------------- ------------- ------- ------- --------- ----
0:01:12       -               19.41       5        52    2
</pre></div>
<!-- class="example" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i509329"></a>
<div id="TTTRB329" class="sect1">
<h2 class="sect1">Problems with conflict checking</h2>
<p>This section includes the following topics:</p>
<ul>
<li>
<p><a href="#i561645">Column cannot be used for replication timestamp</a></p>
</li>
<li>
<p><a href="#i561650">Timestamp does not exist</a></p>
</li>
<li>
<p><a href="#i561667">Conflict reporting slows down replication</a></p>
</li>
</ul>
<a id="i561645"></a>
<div id="TTTRB330" class="sect2">
<h3 class="sect2">Column cannot be used for replication timestamp</h3>
<p>When <a id="sthref288"></a>attempting to set <code>CHECK CONFLICTS</code> for an element in a <code>CREATE REPLICATION</code> statement, you may encounter an error similar to the following.</p>
<pre>8004: Column REPL.TABS.TS cannot be used for replication timestamp checking if 
in an index or added by ALTER TABLE; and must be binary(8) with NULL values allowed.
</pre>
<p>In this situation, check:</p>
<ul>
<li>
<p>That the timestamp column in the specified table is a nullable column of type <code>BINARY(8)</code>. In the above example, the TS column in the <code>REPL.TAB</code> table should have a type of <code>BINARY(8)</code>.</p>
</li>
<li>
<p>The timestamp column is defined in the original <code>CREATE TABLE</code> statement, rather than added later using <code>ALTER TABLE</code>.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="i561650"></a>
<div id="TTTRB331" class="sect2">
<h3 class="sect2">Timestamp does not exist</h3>
<p>You may <a id="sthref289"></a>receive an error similar to the following:</p>
<pre>2208: Column TS does not exist in table.
</pre>
<p>In this situation, confirm that you have specified the correct name for the timestamp column in the <code>CHECK CONFLICTS</code> clause and that it exists in the specified table.</p>
<p>Also, make sure the timestamp column is not part of a primary key or index.</p>
</div>
<!-- class="sect2" -->
<a id="i561667"></a>
<div id="TTTRB332" class="sect2">
<h3 class="sect2">Conflict reporting slows down replication</h3>
<p>If you have <a id="sthref290"></a><a id="sthref291"></a>configured replication to <code>CHECK CONFLICTS</code>, TimesTen sends reports to the local host. You can also configure a report file. See <a class="olink TTERR138" href="../TTERR/snmp.htm#TTERR138">&#34;Diagnostics through SNMP Traps&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Error Messages and SNMP Traps</span>.</p>
<p>If there are many conflicts in a short period of time, subscriber performance can slow down because of the reporting requirements. You can use store attributes in the <code>CREATE REPLICATION</code> or <code>ALTER REPLICATION</code> statements to suspend and resume conflict reporting at specified rates of conflict:</p>
<ul>
<li>
<p><code>CONFLICT REPORTING SUSPEND AT</code> <code><span class="codeinlineitalic">rate</span></code></p>
</li>
<li>
<p><code>CONFLICT REPORTING RESUME AT</code> <code><span class="codeinlineitalic">rate</span></code></p>
</li>
</ul>
<p>Information about conflicts that occur while reporting is suspended cannot be retrieved.</p>
<p>See <a class="olink TTREP629" href="../TTREP/conflict.htm#TTREP629">&#34;Reporting conflicts&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span>.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CACJFHFE"></a>
<div id="TTTRB372" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Problems with <a id="sthref292"></a>parallel replication</h2>
<p>If you have configured parallel replication, then you have additional TimesTen replication threads running on your system. Be sure that you have enough CPU cores to accommodate the increased number of replication threads.</p>
<p>If you have configured user-defined track based parallel replication (<code>ReplicationApplyOrdering</code> = 1 and <code>ReplicationParallelism</code> &gt; = 2), and you are seeing permanent errors on the receiver side that include constraint violations or row lookup failures, then possible causes include:</p>
<ul>
<li>
<p>Application defined dependencies are incorrect</p>
</li>
<li>
<p>Operations for the same keys or keys of tables in a constraint relationship are written to different tracks.</p>
</li>
</ul>
<p>Check the value of the general connection attribute, <code>ReplicationTrack</code>. All transactions executed by the connection are assigned to the track as defined in the <code>ReplicationTrack</code> attribute setting. Make sure the workload for each track is suitable. Use the <code>ALTER</code> <code>SESSION</code> statement to change the replication track. For more information, see &#34;<a class="olink TTSQL285" href="../TTSQL/state.htm#TTSQL285">ALTER SESSION</a>&#34; in the <span class="italic">Oracle TimesTen In-Memory Database SQL Reference</span>. For more information on configuring parallel replication, see &#34;<a class="olink TTREP423" href="../TTREP/setup.htm#TTREP423">Configuring parallel replication</a>&#34; in the <span class="italic">Oracle TimesTen In-Memory Database Replication Guide</span>.</p>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2550">
<tr>
<td class="cellalignment2559">
<table class="cellalignment2555">
<tr>
<td class="cellalignment2554"><a href="cache_trouble.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2554"><a href="awt_trouble.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2011, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2561">
<table class="cellalignment2553">
<tr>
<td class="cellalignment2554"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2554"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2554"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2554"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2554"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2554"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>