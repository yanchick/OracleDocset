<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-779"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Nonpersistent%20Queues"></a><title>Nonpersistent Queues</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1023"/>
<meta name="dcterms.created" content="2014-07-01T0:30:48Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Advanced Queuing User&#39;s Guide"/>
<meta name="dcterms.identifier" content="E17945-14"/>
<meta name="dcterms.isVersionOf" content="ADQUE"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="aq_demo.htm" title="Previous" type="text/html"/>
<link rel="Next" href="aperrors.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E17945-14.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">31/34</span> <!-- End Header -->
<div id="ADQUE2400" class="appendix"><a id="BCFGDJHG"></a>
<h1 class="appendix"><span class="secnum">A</span> Nonpersistent Queues</h1>
<p>This appendix describes nonpersistent queues, which are deprecated in Oracle Database Advanced Queuing 10<span class="italic">g</span> Release 2 (10.2). Oracle recommends that you use buffered messaging instead.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="aq_intro.htm#CHDGDCDA">&#34;Buffered Messaging&#34;</a></div>
<p>Oracle Database Advanced Queuing can deliver nonpersistent messages asynchronously to subscribers. These messages can be event-driven and do not persist beyond the failure of the system (or instance). The messages are stored in a system-created queue table. Oracle Database Advanced Queuing supports persistent and nonpersistent messages with a common <a href="glossary.htm#CBAIGGDE"><span class="xrefglossterm">API</span></a>.</p>
<p>Nonpersistent queues, which can be either single-consumer or multiconsumer, provide a mechanism for notification to all currently connected users. Subscribers can be added to multiconsumer nonpersistent queues, and nonpersistent queues can be destinations for propagation.</p>
<p>You use the enqueue interface to enqueue messages into a nonpersistent queue in the usual way. You can enqueue RAW and Oracle object type messages into a nonpersistent queue. OCI notifications are used to deliver such messages to users that are currently registered for notification.</p>
<p>This appendix contains these topics:</p>
<ul>
<li>
<p><a href="#BCFGGDHF">Creating Nonpersistent Queues</a></p>
</li>
<li>
<p><a href="#BCFEDJJG">Managing Nonpersistent Queues</a></p>
</li>
<li>
<p><a href="#BCFBEHFE">Compatibility of Nonpersistent Queues</a></p>
</li>
<li>
<p><a href="#BCFGFHEJ">Nonpersistent Queue Notification</a></p>
</li>
<li>
<p><a href="#BCFEJDFI">Restrictions on Nonpersistent Queues</a></p>
</li>
</ul>
<a id="BCFGGDHF"></a>
<div id="ADQUE3520" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><a id="sthref2106"></a><a id="sthref2107"></a><a id="sthref2108"></a><a id="sthref2109"></a>Creating Nonpersistent Queues</h2>
<pre>DBMS_AQADM.CREATE_NP_QUEUE ( 
   queue_name              IN        VARCHAR2, 
   multiple_consumers      IN        BOOLEAN  DEFAULT FALSE, 
   comment                 IN        VARCHAR2 DEFAULT NULL);
</pre>
<p>This procedure creates a <a href="glossary.htm#CBAFCHBG"><span class="xrefglossterm">nonpersistent</span></a> queue.</p>
<p>Only local recipients are supported for nonpersistent queues. The queue can be either single-consumer or multiconsumer. All queue names must be unique within a schema. The queues are created in an 8.1-compatible system-created queue table (<code>AQ$_MEM_SC</code> or <code>AQ$_MEM_MC</code>) in the same schema as that specified by the queue name. If the queue name does not specify a schema name, then the queue is created in the login user&#39;s schema.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Names of nonpersistent queues must not be longer than 24 characters. If you attempt to create a nonpersistent queue with a longer name, error ORA-24019 results.</div>
</div>
<!-- class="sect1" -->
<a id="BCFEDJJG"></a>
<div id="ADQUE3521" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><a id="sthref2110"></a><a id="sthref2111"></a><a id="sthref2112"></a>Managing Nonpersistent Queues</h2>
<p>Once a queue is created with <code>CREATE_NP_QUEUE</code>, it can be enabled by calling <code>START_QUEUE</code>. By default, the queue is created with both enqueue and dequeue disabled.</p>
<p>You can enqueue RAW and Oracle object type messages into a nonpersistent queue. You cannot dequeue from a nonpersistent queue. The only way to retrieve a message from a nonpersistent queue is by using the <a href="glossary.htm#CBAFBDDI"><span class="xrefglossterm">Oracle Call Interface</span></a> (OCI) notification mechanism. You cannot invoke the <code>listen</code> call on a nonpersistent queue.</p>
<p>A nonpersistent queue can be dropped only by its owner.</p>
</div>
<!-- class="sect1" -->
<a id="BCFBEHFE"></a>
<div id="ADQUE3522" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><a id="sthref2113"></a><a id="sthref2114"></a><a id="sthref2115"></a>Compatibility of Nonpersistent Queues</h2>
<p>For 8.1-style or higher queues, the <code>compatible</code> parameter of <code>init.ora</code> and the <code>compatible</code> parameter of the <a href="glossary.htm#CBAFHDDD"><span class="xrefglossterm">queue table</span></a> should be set to 8.1 or higher to use nonpersistent queues.</p>
</div>
<!-- class="sect1" -->
<a id="BCFGFHEJ"></a>
<div id="ADQUE3523" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><a id="sthref2116"></a><a id="sthref2117"></a><a id="sthref2118"></a>Nonpersistent Queue Notification</h2>
<p>For nonpersistent queues, the message is delivered as part of the notification. <a href="#g1009489">Table A-1</a> shows the actions performed for <a href="glossary.htm#CBAFCHBG"><span class="xrefglossterm">nonpersistent</span></a> queues for different notification mechanisms when RAW presentation is specified. <a href="#g1009470">Table A-2</a> shows the actions performed when XML presentation is specified.</p>
<div id="ADQUE3524" class="tblformalwide">
<p class="titleintable"><a id="sthref2119"></a><a id="g1009489"></a>Table A-1 Actions Performed for Nonpersistent Queues When RAW Presentation Specified</p>
<table class="cellalignment1000" title="Actions Performed for Nonpersistent Queues When RAW Presentation Specified" summary="Rows are queue payload types. For each payload type, the first column is its name. The second, third, and fourth columns describe the actions taken in OCI, E-mail, and PL/SQL respectively." dir="ltr">
<thead>
<tr class="cellalignment994">
<th class="cellalignment1001" id="r1c1-t4">Queue Payload Type</th>
<th class="cellalignment1001" id="r1c2-t4">OCI Callback</th>
<th class="cellalignment1001" id="r1c3-t4">E-mail</th>
<th class="cellalignment1001" id="r1c4-t4">PL/SQL Callback</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment994">
<td class="cellalignment1002" id="r2c1-t4" headers="r1c1-t4">
<p>RAW</p>
</td>
<td class="cellalignment1002" headers="r2c1-t4 r1c2-t4">
<p>OCI callback receives the RAW data in the payload.</p>
</td>
<td class="cellalignment1002" headers="r2c1-t4 r1c3-t4">
<p>Not supported</p>
</td>
<td class="cellalignment1002" headers="r2c1-t4 r1c4-t4">
<p>PL/SQL callback receives the RAW data in the payload.</p>
</td>
</tr>
<tr class="cellalignment994">
<td class="cellalignment1002" id="r3c1-t4" headers="r1c1-t4">
<p>Oracle object type</p>
</td>
<td class="cellalignment1002" headers="r3c1-t4 r1c2-t4">
<p>Not supported</p>
</td>
<td class="cellalignment1002" headers="r3c1-t4 r1c3-t4">
<p>Not supported</p>
</td>
<td class="cellalignment1002" headers="r3c1-t4 r1c4-t4">
<p>Not supported</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformalwide" -->
<div id="ADQUE3525" class="tblformalwide">
<p class="titleintable"><a id="sthref2120"></a><a id="g1009470"></a>Table A-2 Actions Performed for Nonpersistent Queues When XML Presentation Specified</p>
<table class="cellalignment1000" title="Actions Performed for Nonpersistent Queues When XML Presentation Specified" summary="Rows are queue payload types. For each payload type, the first column is its name. The second, third, and fourth columns describe the actions taken in OCI, E-mail, and PL/SQL respectively." dir="ltr">
<thead>
<tr class="cellalignment994">
<th class="cellalignment1001" id="r1c1-t5">Queue Payload Type</th>
<th class="cellalignment1001" id="r1c2-t5">OCI Callback</th>
<th class="cellalignment1001" id="r1c3-t5">E-mail</th>
<th class="cellalignment1001" id="r1c4-t5">PL/SQL Callback</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment994">
<td class="cellalignment1002" id="r2c1-t5" headers="r1c1-t5">
<p>RAW</p>
</td>
<td class="cellalignment1002" headers="r2c1-t5 r1c2-t5">
<p>OCI callback receives the XML data in the payload.</p>
</td>
<td class="cellalignment1002" headers="r2c1-t5 r1c3-t5">
<p>XML data is formatted as a SOAP message and e-mailed to the registered e-mail address.</p>
</td>
<td class="cellalignment1002" headers="r2c1-t5 r1c4-t5">
<p>PL/SQL callback receives the XML data in the payload.</p>
</td>
</tr>
<tr class="cellalignment994">
<td class="cellalignment1002" id="r3c1-t5" headers="r1c1-t5">
<p>Oracle object type</p>
</td>
<td class="cellalignment1002" headers="r3c1-t5 r1c2-t5">
<p>OCI callback receives the XML data in the payload.</p>
</td>
<td class="cellalignment1002" headers="r3c1-t5 r1c3-t5">
<p>XML data is formatted as a SOAP message and e-mailed to the registered e-mail address.</p>
</td>
<td class="cellalignment1002" headers="r3c1-t5 r1c4-t5">
<p>PL/SQL callback receives the XML data in the payload.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformalwide" --></div>
<!-- class="sect1" -->
<a id="BCFEJDFI"></a>
<div id="ADQUE3526" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><a id="sthref2121"></a><a id="sthref2122"></a><a id="sthref2123"></a>Restrictions on Nonpersistent Queues</h2>
<p>You can create nonpersistent queues of <code>RAW</code> and Oracle object type.You are limited to sending messages only to subscribers and explicitly specified recipients who are local. Propagation is not supported from nonpersistent queues. When retrieving messages, you cannot use the dequeue call, but must instead employ the asynchronous notification mechanism, registering for the notification by mean of <code>OCISubscriptionRegister</code>.</p>
<p>The <code>visibility</code> attribute of <code>enqueue_options</code> must be set to <code>IMMEDIATE</code> for nonpersistent messages.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="aq_opers.htm#CHDGBIHI">&#34;Enqueue Options&#34;</a></div>
</div>
<!-- class="sect1" --></div>
<!-- class="appendix" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment993">
<tr>
<td class="cellalignment1002">
<table class="cellalignment998">
<tr>
<td class="cellalignment997"><a href="aq_demo.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment997"><a href="aperrors.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1004">
<table class="cellalignment996">
<tr>
<td class="cellalignment997"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment997"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment997"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment997"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment997"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment997"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>