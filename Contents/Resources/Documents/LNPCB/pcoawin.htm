<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-77871"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Pro%2ACOBOL%20for%20Windows"></a><title>Pro*COBOL for Windows</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1023"/>
<meta name="dcterms.created" content="2014-07-06T20:24:8Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Pro*COBOL&reg; Programmer&#39;s Guide"/>
<meta name="dcterms.identifier" content="E53282-01"/>
<meta name="dcterms.isVersionOf" content="LNPCB"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="pcoafemb.htm" title="Previous" type="text/html"/>
<link rel="Next" href="index.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E53282-01.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">26/27</span> <!-- End Header -->
<div id="LNPCB1743" class="appendix"><a id="BABJFHAG"></a>
<h1 class="appendix"><span class="secnum">F</span> Pro*COBOL for Windows</h1>
<p>This section provides an overview of building Oracle database applications with Pro*COBOL for Windows operating systems.</p>
<p>This section contains these topics:</p>
<ul>
<li>
<p><a href="#CACIAFBB">Compiling and Linking Pro*COBOL Applications</a></p>
</li>
<li>
<p><a href="#CACIFIFD">Sample Programs</a></p>
</li>
</ul>
<a id="CACIAFBB"></a>
<div id="LNPCB1744" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Compiling and Linking Pro*COBOL Applications</h2>
<p>Pro*COBOL supports the MERANT Micro Focus NetExpress version 5.0 for 32-bit Windows. This section describes how to compile and link Pro*COBOL applications using the MERANT Micro Focus compiler.</p>
<p>You can build and execute a MERANT Micro Focus COBOL application in two ways:</p>
<ul>
<li>
<p><a href="#CACEAJIJ">How to Use the IDE</a> (using NetExpress only)</p>
</li>
<li>
<p><a href="#CACJFGAD">How to Use the Animator Products</a> (products other than NetExpress)</p>
</li>
<li>
<p><a href="#CACFEEEA">The COBOL and CBLLINK Commands</a> (all products)</p>
</li>
<li>
<p><a href="#CACHAHEE">The COBSQL Command</a></p>
</li>
</ul>
<p>In each of these the COBSQL utility may be used with the following advantages:</p>
<ul>
<li>
<p>Pro*COBOL is run by the MERANT Micro Focus compiler and does not need to be run as a separate step.</p>
</li>
<li>
<p>Animation is done using the .pco source file rather than the .cbl file produced by Pro*COBOL.</p>
</li>
<li>
<p>The MAKEYSYN directive is provided automatically and need not be specified manually.</p>
</li>
</ul>
<a id="CACEAJIJ"></a>
<div id="LNPCB1745" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">How to Use the IDE</h3>
<p><a id="sthref2381"></a><a id="sthref2382"></a><a id="sthref2383"></a><a id="sthref2384"></a>A program generated by Pro*COBOL can be compiled and executed from within the MERANT Micro Focus NetExpress IDE. Simply add the <code>.cbl</code> file generated by Pro*COBOL to a Net Express project. To avoid potential inconsistencies when calling routines in the Oracle libraries the program should be compiled using the directive:</p>
<pre>MAKESYN &#34;COMP-5&#34; = &#34;COMP&#34;
</pre>
<p>This directive can be specified in the build setting for the source file, the project settings or through a <code>$SET</code> line at the start of the source file. When you select <span class="bold">Rebuild</span> or <span class="bold">Rebuild All</span> the IDE generates an executable ready to Run or Animate.</p>
</div>
<!-- class="sect2" -->
<a id="CACJFGAD"></a>
<div id="LNPCB1746" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">How to Use the Animator Products</h3>
<p>Programs can be compiled and executed from within the MERANT Micro Focus COBOL debugger, Animator V2.</p>
<p>To avoid potential inconsistencies when calling routines in the Oracle libraries, select the menu option Compiler Directives, and enter:</p>
<p>This step is required because MERANT Micro Focus COBOL stores binary numbers in Big Endian format. Oracle libraries expect binary numbers to be stored in Little Endian format (machine format).</p>
<pre>MAKESYN &#34;COMP-5&#34; = &#34;COMP&#34;
</pre></div>
<!-- class="sect2" -->
<a id="CACFEEEA"></a>
<div id="LNPCB1747" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">The COBOL and CBLLINK Commands</h3>
<p><code>COBOL</code> and <code>CBLLINK</code> can be used to build programs in two ways, depending on whether the Pro*COBOL runtime is to be statically linked or accessed through a DLL at runtime.</p>
<p>For dynamic linking, the commands are:</p>
<pre> COBOL sample1 /MAKESYN&#34;COMP-5&#34;=&#34;COMP&#34;;
 CBLLINK sample1
</pre>
<p>For static linking, the commands are:</p>
<pre> COBOL sample1 /LITLINK /MAKESYN&#34;COMP-5&#34;=&#34;COMP&#34;;
 CBLLINK sample1 <span class="italic">ORACLE_BASE\ORACLE_HOME</span>\precomp\lib\orasql12.lib
</pre>
<p>The previous commands produce <code>sample1.exe</code>, which can be executed like any other Windows program.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
MERANT Micro Focus COBOL must be installed on the same system as Pro*COBOL to successfully execute the file.</div>
</div>
<!-- class="sect2" -->
<a id="CACHAHEE"></a>
<div id="LNPCB1748" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">The COBSQL Command</h3>
<p><code><a id="sthref2385"></a><a id="sthref2386"></a>COBSQL</code> can be used to simplify preprocessing and debugging. To use <code>COBSQL</code>, specify the following directive to the COBOL compiler:</p>
<pre>PREPROCESS(COBSQL) COBSQLTYPE=ORACLE8 ENDP
</pre>
<p>or the short form:</p>
<pre>P(COBSQL) CSQLT=ORA8 ENDP
</pre>
<p><code>COBSQLTYPE</code> should be set to <code>ORACLE</code> or <code>ORA</code> for versions of Pro*COBOL prior to release 8.0. The directive may be set with a <code>$SET</code> line at the start of the source file, on the COBOL command line, in program build settings or project settings for NetExpress, or with SQL compiler directives settings for Animator. At compile time, COBSQL runs Pro*COBOL as a background task and passes its output to the COBOL compiler together with additional information required to enable Animator to track execution using the <code>.pco</code> file rather than <code>.cbl</code> file.</p>
<p>When using <code>COBSQL</code> there is no need to deal directly with the <code>.cbl</code> file. Instead, add the <code>.pco</code> file to a NetExpress project, or open it with Animator.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CACIFIFD"></a>
<div id="LNPCB1749" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Sample Programs</h2>
<p>Oracle provides sample programs to demonstrate the use of Pro*COBOL with Oracle database features. See <a href="#CACHBIEB">&#34;Sample Files&#34;</a> for a listing of these programs.</p>
<p>This section describes how to use the basic precompiling, compiling, and linking commands to build the sample programs. This section also describes the preparations required for running the Pro*COBOL sample programs.</p>
<div id="LNPCB1750" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref2387"></a>
<h3 class="sect2">Building the Demonstration Table</h3>
<p>To run the Pro*COBOL sample programs, you must have a database account with the username <code>scott</code> and the password <code>tiger</code>. If this account does not exist on your database, create one before running the sample programs.</p>
<p>The scott account must contain the emp and dept tables. If the account does not contain these tables, use the demobld.sql script to create them.</p>
<p>To run the demobld.sql script:</p>
<ol>
<li>
<p>Start SQL*Plus.</p>
</li>
<li>
<p>Connect to the database as username scott with password <code>tiger</code>.</p>
</li>
<li>
<p>Run the demobld.sql script. For example:</p>
<pre>SQL&gt; @ORACLE_BASE\ORACLE_HOME\sqlplus\demo\demobld.sql
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<div id="LNPCB1751" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref2388"></a>
<h3 class="sect2">Building the Sample Programs</h3>
<p>Pro*COBOL supplies the makeit.bat file which is listed in the next section, for building a MERANT Micro Focus COBOL sample file:</p>
<p>The batch files are located in <code>ORACLE_BASE\ORACLE_HOME \precomp\demo\procob2</code>.</p>
<p>To build the sample programs:</p>
<ol>
<li>
<p>Run the batch files with any sample file. Do not include the file extension. For example:</p>
<pre>C:\ORACLE\ORA90\PRECOMP\DEMO\PROCOB2&gt; makeit sample1
</pre></li>
<li>
<p>Ensure that all paths and file names reflect the configuration of your system, if you encounter errors when building a sample program.</p>
</li>
</ol>
<p>The commands to run the sample programs assume that the following is the current working directory:</p>
<pre>ORACLE_BASE\ORACLE_HOME \precomp\demo\procob2
</pre>
<p>You may need to modify the sample link script to reflect the configuration of your system. See <a href="#CACIAFBB">&#34;Compiling and Linking Pro*COBOL Applications&#34;</a> for more information.</p>
<p>The makeit.bat contains the following:</p>
<pre>procob iname=%1.pco ireclen=132 
cobol %1 /anim /litlink makesyn &#34;COMP-5&#34; = &#34;COMP&#34;; 
cbllink %1 /M%1 ORACLE_BASE\ORACLE_HOME\precomp\lib\orasql12.lib
</pre></div>
<!-- class="sect2" -->
<a id="CACHBIEB"></a>
<div id="LNPCB1752" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Sample Files</h3>
<p>The Pro*COBOL sample files listed in <a href="#CHDCCIEH">Table F-1</a> are located in the <code>ORACLE_BASE\ORACLE_HOME\precomp\demo\procob2</code> directory. The SQL scripts are located in the <code>ORACLE_BASE\ORACLE_HOME\precomp\demo\sql</code> directory.</p>
<div id="LNPCB1753" class="tblformal">
<p class="titleintable"><a id="sthref2389"></a><a id="CHDCCIEH"></a>Table F-1 Pro*COBOL Sample Programs</p>
<table class="cellalignment4971" title="Pro*COBOL Sample Programs" summary="Sample programs" dir="ltr">
<thead>
<tr class="cellalignment4965">
<th class="cellalignment4972" id="r1c1-t3">Sample Program</th>
<th class="cellalignment4972" id="r1c2-t3">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4965">
<td class="cellalignment4973" id="r2c1-t3" headers="r1c1-t3">
<p><code>sample1.pco</code></p>
</td>
<td class="cellalignment4973" headers="r2c1-t3 r1c2-t3">
<p>Simple query</p>
</td>
</tr>
<tr class="cellalignment4965">
<td class="cellalignment4973" id="r3c1-t3" headers="r1c1-t3">
<p><code>sample2.pco</code></p>
</td>
<td class="cellalignment4973" headers="r3c1-t3 r1c2-t3">
<p>Cursor operations</p>
</td>
</tr>
<tr class="cellalignment4965">
<td class="cellalignment4973" id="r4c1-t3" headers="r1c1-t3">
<p><code>sample3.pco</code></p>
</td>
<td class="cellalignment4973" headers="r4c1-t3 r1c2-t3">
<p>Host tables</p>
</td>
</tr>
<tr class="cellalignment4965">
<td class="cellalignment4973" id="r5c1-t3" headers="r1c1-t3">
<p><code>sample4.pco</code></p>
</td>
<td class="cellalignment4973" headers="r5c1-t3 r1c2-t3">
<p>Datatype equivalence</p>
</td>
</tr>
<tr class="cellalignment4965">
<td class="cellalignment4973" id="r6c1-t3" headers="r1c1-t3">
<p><code>sample6.pco</code></p>
</td>
<td class="cellalignment4973" headers="r6c1-t3 r1c2-t3">
<p>Dynamic SQL Method 1</p>
</td>
</tr>
<tr class="cellalignment4965">
<td class="cellalignment4973" id="r7c1-t3" headers="r1c1-t3">
<p><code>sample7.pco</code></p>
</td>
<td class="cellalignment4973" headers="r7c1-t3 r1c2-t3">
<p>Dynamic SQL Method 2</p>
</td>
</tr>
<tr class="cellalignment4965">
<td class="cellalignment4973" id="r8c1-t3" headers="r1c1-t3">
<p><code>sample8.pco</code></p>
</td>
<td class="cellalignment4973" headers="r8c1-t3 r1c2-t3">
<p>Dynamic SQL Method 3</p>
</td>
</tr>
<tr class="cellalignment4965">
<td class="cellalignment4973" id="r9c1-t3" headers="r1c1-t3">
<p><code>sample9.pco</code></p>
</td>
<td class="cellalignment4973" headers="r9c1-t3 r1c2-t3">
<p>Stored procedure call</p>
</td>
</tr>
<tr class="cellalignment4965">
<td class="cellalignment4973" id="r10c1-t3" headers="r1c1-t3">
<p><code>calldemo.sql</code></p>
</td>
<td class="cellalignment4973" headers="r10c1-t3 r1c2-t3">
<p>Stored procedure call</p>
</td>
</tr>
<tr class="cellalignment4965">
<td class="cellalignment4973" id="r11c1-t3" headers="r1c1-t3">
<p><code>sample10.pco</code></p>
</td>
<td class="cellalignment4973" headers="r11c1-t3 r1c2-t3">
<p>Dynamic SQL Method 4</p>
</td>
</tr>
<tr class="cellalignment4965">
<td class="cellalignment4973" id="r12c1-t3" headers="r1c1-t3">
<p><code>sample11.pco</code></p>
</td>
<td class="cellalignment4973" headers="r12c1-t3 r1c2-t3">
<p>Cursor variable operations</p>
</td>
</tr>
<tr class="cellalignment4965">
<td class="cellalignment4973" id="r13c1-t3" headers="r1c1-t3">
<p><code>sample11.sql</code></p>
</td>
<td class="cellalignment4973" headers="r13c1-t3 r1c2-t3">
<p>Cursor variable operations</p>
</td>
</tr>
<tr class="cellalignment4965">
<td class="cellalignment4973" id="r14c1-t3" headers="r1c1-t3">
<p><code>sample12.pco</code></p>
</td>
<td class="cellalignment4973" headers="r14c1-t3 r1c2-t3">
<p>Dynamic SQL Method 4 using <a id="sthref2390"></a><a id="sthref2391"></a>ANSI dynamic SQL</p>
</td>
</tr>
<tr class="cellalignment4965">
<td class="cellalignment4973" id="r15c1-t3" headers="r1c1-t3">
<p><code>sample13.pco</code></p>
</td>
<td class="cellalignment4973" headers="r15c1-t3 r1c2-t3">
<p>Nested program</p>
</td>
</tr>
<tr class="cellalignment4965">
<td class="cellalignment4973" id="r16c1-t3" headers="r1c1-t3">
<p><code>sampleco.pco</code></p>
</td>
<td class="cellalignment4973" headers="r16c1-t3 r1c2-t3">
<p>Simple query and insert</p>
</td>
</tr>
<tr class="cellalignment4965">
<td class="cellalignment4973" id="r17c1-t3" headers="r1c1-t3">
<p><code>sample14.pco</code></p>
</td>
<td class="cellalignment4973" headers="r17c1-t3 r1c2-t3">
<p>Host table x</p>
</td>
</tr>
<tr class="cellalignment4965">
<td class="cellalignment4973" id="r18c1-t3" headers="r1c1-t3">
<p><code>lobdemo1.pco</code></p>
</td>
<td class="cellalignment4973" headers="r18c1-t3 r1c2-t3">
<p>LOB datatypes</p>
</td>
</tr>
<tr class="cellalignment4965">
<td class="cellalignment4973" id="r19c1-t3" headers="r1c1-t3">
<p><code>lobdemo1.sql</code></p>
</td>
<td class="cellalignment4973" headers="r19c1-t3 r1c2-t3">
<p>LOB datatypes</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="appendix" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment4964">
<tr>
<td class="cellalignment4973">
<table class="cellalignment4969">
<tr>
<td class="cellalignment4968"><a href="pcoafemb.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment4968"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment4976">
<table class="cellalignment4967">
<tr>
<td class="cellalignment4968"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment4968"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment4968"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment4968"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment4968"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment4968"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>