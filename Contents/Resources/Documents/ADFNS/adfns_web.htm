<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-88"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Developing%20PL%2FSQL%20Web%20Applications"></a><title>Developing PL/SQL Web Applications</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1080"/>
<meta name="dcterms.created" content="2016-05-05T16:23:34Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Development Guide"/>
<meta name="dcterms.identifier" content="E41452-07"/>
<meta name="dcterms.isVersionOf" content="ADFNS"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="adfns_profiler.htm" title="Previous" type="text/html"/>
<link rel="Next" href="adfns_cqn.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41452-07.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">24/38</span> <!-- End Header -->
<div id="ADFNS015" class="chapter"><a id="g1026380"></a>
<h1 class="chapter"><span class="secnum">14</span> Developing PL/SQL Web Applications</h1>
<div class="infobox-note">
<p class="notep1">Note:</p>
The use of the technologies described in this chapter is suitable for applications that require tight control of the HTTP communication and HTML generation. For others applications, you are encouraged to use Oracle Application Express, which provides more features and a convenient graphical interface to ease application development.
<p>For information about using Oracle Application Express, see <a class="olink TDPAX" href="../TDPAX/toc.htm"><span class="italic">Oracle Database 2 Day + Application Express Developer&#39;s Guide</span></a>.</p>
</div>
<p>This chapter explains how to develop PL/SQL web applications, which let you make your database available on the intranet.</p>
<p class="subhead2"><a id="ADFNS1346"></a>Topics:</p>
<ul>
<li>
<p><a href="#g2845237">Overview of PL/SQL Web Applications</a></p>
</li>
<li>
<p><a href="#CHDIEDIB">Implementing PL/SQL Web Applications</a></p>
</li>
<li>
<p><a href="#CHEIAHAE">Using mod_plsql Gateway to Map Client Requests to a PL/SQL Web Application</a></p>
</li>
<li>
<p><a href="#CHDFGFHB">Using Embedded PL/SQL Gateway</a></p>
</li>
<li>
<p><a href="#i1006207">Generating HTML Output with PL/SQL</a></p>
</li>
<li>
<p><a href="#i1006241">Passing Parameters to PL/SQL Web Applications</a></p>
</li>
<li>
<p><a href="#i1006349">Performing Network Operations in PL/SQL Subprograms</a></p>
</li>
</ul>
<a id="g2845237"></a>
<div id="ADFNS1101" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">14.1</span> Overview of PL/SQL Web Applications</h2>
<p><a id="sthref742"></a>Typically, a web application written in PL/SQL is a set of stored subprograms that interact with web browsers through HTTP. A set of interlinked, dynamically generated HTML pages forms the user interface of a web application.</p>
<p>The program flow of a PL/SQL web application is similar to that in a CGI PERL script. Developers often use CGI scripts to produce web pages dynamically, but such scripts are often not optimal for accessing the database. Delivering web content with PL/SQL stored subprograms provides the power and flexibility of database processing. For example, you can use data manipulation language (DML) statements, dynamic SQL statements, and cursors. You also eliminate the process overhead of forking a new CGI process to handle each HTTP request.</p>
<p><a href="#BGBHFAHI">Figure 14-1</a> illustrates the generic process for a PL/SQL web application.</p>
<div id="ADFNS1347" class="figure">
<p class="titleinfigure"><a id="BGBHFAHI"></a>Figure 14-1 PL/SQL Web Application</p>
<img width="422" height="279" src="img/adfns102.gif" alt="Description of Figure 14-1 follows"/><br/>
<a id="sthref743" href="img_text/adfns102.htm">Description of &#39;&#39;Figure 14-1 PL/SQL Web Application&#39;&#39;</a><br/>
<br/></div>
<!-- class="figure" --></div>
<!-- class="sect1" -->
<a id="CHDIEDIB"></a>
<div id="ADFNS1102" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">14.2</span> Implementing PL/SQL Web Applications</h2>
<p><a id="sthref744"></a>You can implement a web browser-based application entirely in PL/SQL with these Oracle Database components:</p>
<ul>
<li>
<p><a href="#CHDJDIII">PL/SQL Gateway</a></p>
</li>
<li>
<p><a href="#CHDFIIHB">PL/SQL Web Toolkit</a></p>
</li>
</ul>
<a id="CHDJDIII"></a>
<div id="ADFNS459" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">14.2.1</span> PL/SQL Gateway</h3>
<p><a id="sthref745"></a>The PL/SQL gateway enables a web browser to invoke a PL/SQL stored subprogram through an HTTP listener. The gateway is a platform on which PL/SQL users develop and deploy PL/SQL web applications.</p>
<div id="ADFNS1348" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref746"></a>
<h4 class="sect3"><span class="secnum">14.2.1.1</span> mod_plsql</h4>
<p><a id="sthref747"></a><code dir="ltr">mod_plsql</code> is one implementation of the PL/SQL gateway. The module is a plug-in of Oracle HTTP Server and enables web browsers to invoke PL/SQL stored subprograms. Oracle HTTP Server is a component of both Oracle Application Server and the database.</p>
<p>The <code dir="ltr">mod_plsql</code> plug-in enables you to use PL/SQL stored subprograms to process HTTP requests and generate responses. In this context, an HTTP request is a URL that includes parameter values to be passed to a stored subprogram. PL/SQL gateway translates the URL, invokes the stored subprogram with the parameters, and returns output (typically HTML) to the client.</p>
<p>Some advantages of using <code dir="ltr">mod_plsql</code> over the embedded form of the PL/SQL gateway are:</p>
<ul>
<li>
<p>You can run it in a firewall environment in which the Oracle HTTP Server runs on a firewall-facing host while the database is hosted behind a firewall. You cannot use this configuration with the embedded gateway.</p>
</li>
<li>
<p>The embedded gateway does not support <code dir="ltr">mod_plsql</code> features such as dynamic HTML caching, system monitoring, and logging in the Common Log Format.</p>
</li>
</ul>
</div>
<!-- class="sect3" -->
<div id="ADFNS461" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref748"></a>
<h4 class="sect3"><span class="secnum">14.2.1.2</span> Embedded PL/SQL Gateway</h4>
<p><a id="sthref749"></a>You can use an embedded version of the PL/SQL gateway that runs in the XML DB HTTP Listener in the database. It provides the core features of <code dir="ltr">mod_plsql</code> in the database but does not require the Oracle HTTP Server. You configure the embedded PL/SQL gateway with the <code dir="ltr">DBMS_EPG</code> package in the PL/SQL Web Toolkit.</p>
<p>Some advantages of using the embedded gateway instead of <code dir="ltr">mod_plsql</code> are:</p>
<ul>
<li>
<p>You can invoke PL/SQL web applications like Application Express without installing Oracle HTTP Server, thereby simplifying installation, configuration, and administration of PL/SQL based web applications.</p>
</li>
<li>
<p>You use the same configuration approach that is used to deliver content from Oracle XML DB in response to FTP and HTTP requests.</p>
</li>
</ul>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CHDFIIHB"></a>
<div id="ADFNS462" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">14.2.2</span> PL/SQL Web Toolkit</h3>
<p><a id="sthref750"></a>This set of PL/SQL packages is a generic interface that enables you to use stored subprograms invoked by <code dir="ltr">mod_plsql</code> at run time.</p>
<p>In response to a browser request, a PL/SQL subprogram updates or retrieves data from Oracle Database according to the user input. It then generates an HTTP response to the browser, typically in the form of a file download or HTML to be displayed. The PL/SQL Web Toolkit API enables stored subprograms to perform actions such as:</p>
<ul>
<li>
<p>Obtain information about an HTTP request</p>
</li>
<li>
<p>Generate HTTP headers such as content-type and mime-type</p>
</li>
<li>
<p>Set browser cookies</p>
</li>
<li>
<p>Generate HTML pages</p>
</li>
</ul>
<p><a href="#CHEBCGGF">Table 14-1</a> describes commonly used PL/SQL Web Toolkit packages.</p>
<div id="ADFNS463" class="tblformal">
<p class="titleintable"><a id="sthref751"></a><a id="CHEBCGGF"></a>Table 14-1 Commonly Used Packages in the PL/SQL Web Toolkit</p>
<table class="cellalignment293" title=" Commonly Used Packages in the PL/SQL Web Toolkit" summary="This table summarizes some of the commonly used packages in the PL/SQL Web Toolkit." dir="ltr">
<thead>
<tr class="cellalignment287">
<th class="cellalignment294" id="r1c1-t3">Package</th>
<th class="cellalignment294" id="r1c2-t3">Description of Contents</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment287">
<td class="cellalignment295" id="r2c1-t3" headers="r1c1-t3">
<p><a class="olink ARPLS390" href="../ARPLS/w_htf.htm#ARPLS390"><code dir="ltr">HTF</code></a></p>
</td>
<td class="cellalignment295" headers="r2c1-t3 r1c2-t3">
<p>Function versions of the subprograms in the <code dir="ltr">htp</code> package. The function versions do not directly generate output in a web page. Instead, they pass their output as return values to the statements that invoke them. Use these functions when you must nest function calls.</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r3c1-t3" headers="r1c1-t3">
<p><a class="olink ARPLS391" href="../ARPLS/w_htp.htm#ARPLS391"><code dir="ltr">HTP</code></a></p>
</td>
<td class="cellalignment295" headers="r3c1-t3 r1c2-t3">
<p>Subprograms that generate HTML tags. For example, the procedure <code dir="ltr">htp</code>.<code dir="ltr">anchor</code> generates the HTML anchor tag, <code dir="ltr">&lt;A&gt;</code>.</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r4c1-t3" headers="r1c1-t3">
<p><a class="olink ARPLS386" href="../ARPLS/w_cache.htm#ARPLS386"><code dir="ltr">OWA_CACHE</code></a></p>
</td>
<td class="cellalignment295" headers="r4c1-t3 r1c2-t3">
<p>Subprograms that enable the PL/SQL gateway cache feature to improve performance of your PL/SQL web application.</p>
<p>You can use this package to enable expires-based and validation-based caching with the PL/SQL gateway file system.</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r5c1-t3" headers="r1c1-t3">
<p><a class="olink ARPLS387" href="../ARPLS/w_cook.htm#ARPLS387"><code dir="ltr">OWA_COOKIE</code></a></p>
</td>
<td class="cellalignment295" headers="r5c1-t3 r1c2-t3">
<p>Subprograms that send and retrieve HTTP cookies to and from a client web browser. Cookies are strings a browser uses to maintain state between HTTP calls. State can be maintained throughout a client session or longer if a cookie expiration date is included.</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r6c1-t3" headers="r1c1-t3">
<p><a class="olink ARPLS388" href="../ARPLS/w_custom.htm#ARPLS388"><code dir="ltr">OWA_CUSTOM</code></a></p>
</td>
<td class="cellalignment295" headers="r6c1-t3 r1c2-t3">
<p>The authorize function used by cookies.</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r7c1-t3" headers="r1c1-t3">
<p><a class="olink ARPLS392" href="../ARPLS/w_image.htm#ARPLS392"><code dir="ltr">OWA_IMAGE</code></a></p>
</td>
<td class="cellalignment295" headers="r7c1-t3 r1c2-t3">
<p>Subprograms that obtain the coordinates where a user clicked an image. Use this package when you have an image map whose destination links invoke a PL/SQL gateway.</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r8c1-t3" headers="r1c1-t3">
<p><a class="olink ARPLS393" href="../ARPLS/w_optlock.htm#ARPLS393"><code dir="ltr">OWA_OPT_LOCK</code></a></p>
</td>
<td class="cellalignment295" headers="r8c1-t3 r1c2-t3">
<p>Subprograms that impose database optimistic locking strategies to prevent lost updates. Lost updates can otherwise occur if a user selects, and then attempts to update, a row whose values were changed in the meantime by another user.</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r9c1-t3" headers="r1c1-t3">
<p><a class="olink ARPLS398" href="../ARPLS/w_patt.htm#ARPLS398"><code dir="ltr">OWA_PATTERN</code></a></p>
</td>
<td class="cellalignment295" headers="r9c1-t3 r1c2-t3">
<p>Subprograms that perform string matching and string manipulation with regular expressions.</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r10c1-t3" headers="r1c1-t3">
<p><a class="olink ARPLS395" href="../ARPLS/w_sec.htm#ARPLS395"><code dir="ltr">OWA_SEC</code></a></p>
</td>
<td class="cellalignment295" headers="r10c1-t3 r1c2-t3">
<p>Subprograms used by the PL/SQL gateway for authenticating requests.</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r11c1-t3" headers="r1c1-t3">
<p><a class="olink ARPLS396" href="../ARPLS/w_text.htm#ARPLS396"><code dir="ltr">OWA_TEXT</code></a></p>
</td>
<td class="cellalignment295" headers="r11c1-t3 r1c2-t3">
<p>Subprograms used by package <code dir="ltr">OWA_PATTERN</code> for manipulating strings. You can also use them directly.</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r12c1-t3" headers="r1c1-t3">
<p><a class="olink ARPLS397" href="../ARPLS/w_util.htm#ARPLS397"><code dir="ltr">OWA_UTIL</code></a></p>
</td>
<td class="cellalignment295" headers="r12c1-t3 r1c2-t3">
<p>These types of utility subprograms:</p>
<ul>
<li>
<p>Dynamic SQL utilities to produce pages with dynamically generated SQL code.</p>
</li>
<li>
<p>HTML utilities to retrieve the values of CGI environment variables and perform URL redirects.</p>
</li>
<li>
<p>Date utilities for correct date-handling. Date values are simple strings in HTML, but must be properly treated as an Oracle Database data type.</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r13c1-t3" headers="r1c1-t3">
<p><a class="olink ARPLS200" href="../ARPLS/w_wdoclo.htm#ARPLS200"><code dir="ltr">WPG_DOCLOAD</code></a></p>
</td>
<td class="cellalignment295" headers="r13c1-t3 r1c2-t3">
<p>Subprograms that download documents from a document repository that you define using the DAD configuration.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ARPLS" href="../ARPLS/toc.htm"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for syntax, descriptions, and examples for the PL/SQL Web Toolkit packages</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHEIAHAE"></a>
<div id="ADFNS1103" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">14.3</span> Using mod_plsql Gateway to Map Client Requests to a PL/SQL Web Application</h2>
<p>As explained in detail in the <a class="olink YPMOD" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=YPMOD"><span class="italic">Oracle HTTP Server mod_plsql User&#39;s Guide</span></a>, <code dir="ltr">mod_plsql</code> maps web client requests to PL/SQL stored subprograms over HTTP. See this documentation for instructions.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink YPMOD" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=YPMOD"><span class="italic">Oracle HTTP Server mod_plsql User&#39;s Guide</span></a> to learn how to configure and use <code dir="ltr">mod_plsql</code></p>
</li>
<li>
<p><a class="olink HSADM767" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=HSADM767"><span class="italic">Oracle Fusion Middleware Administrator&#39;s Guide for Oracle HTTP Server</span></a> for information about the <code dir="ltr">mod_plsql</code> module</p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="CHDFGFHB"></a>
<div id="ADFNS0151" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">14.4</span> Using Embedded PL/SQL Gateway</h2>
<p><a id="sthref752"></a>The embedded gateway functions very similar to the <code dir="ltr">mod_plsql</code> gateway. Before using the embedded version of the gateway, familiarize yourself with the <a class="olink YPMOD" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=YPMOD"><span class="italic">Oracle HTTP Server mod_plsql User&#39;s Guide</span></a>. Much of the information is the same or similar.</p>
<p class="subhead2"><a id="ADFNS1349"></a>Topics:</p>
<ul>
<li>
<p><a href="#CHECCDEB">How Embedded PL/SQL Gateway Processes Client Requests</a></p>
</li>
<li>
<p><a href="#CHEDJACD">Installing Embedded PL/SQL Gateway</a></p>
</li>
<li>
<p><a href="#CHEIGJIG">Configuring Embedded PL/SQL Gateway</a></p>
</li>
<li>
<p><a href="#CHEICAAC">Invoking PL/SQL Stored Subprograms Through Embedded PL/SQL Gateway</a></p>
</li>
<li>
<p><a href="#CHEBAEFB">Securing Application Access with Embedded PL/SQL Gateway</a></p>
</li>
<li>
<p><a href="#CHEEGIED">Restrictions in Embedded PL/SQL Gateway</a></p>
</li>
<li>
<p><a href="#CHEHBJHI">Using Embedded PL/SQL Gateway: Scenario</a></p>
</li>
</ul>
<a id="CHECCDEB"></a>
<div id="ADFNS1350" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">14.4.1</span> How Embedded PL/SQL Gateway Processes Client Requests</h3>
<p><a href="#BGBBAEIG">Figure 14-2</a> illustrates the process by which the embedded gateway handles client HTTP requests.</p>
<div id="ADFNS1351" class="figure">
<p class="titleinfigure"><a id="BGBBAEIG"></a>Figure 14-2 Processing Client Requests with Embedded PL/SQL Gateway</p>
<img width="503" height="461" src="img/adfns101.gif" alt="Description of Figure 14-2 follows"/><br/>
<a id="sthref753" href="img_text/adfns101.htm">Description of &#39;&#39;Figure 14-2 Processing Client Requests with Embedded PL/SQL Gateway&#39;&#39;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>The explanation of the steps in <a href="#BGBBAEIG">Figure 14-2</a> is as follows:</p>
<ol>
<li>
<p>The Oracle XML DB HTTP Listener receives a request from a client browser to request to invoke a PL/SQL subprogram. The subprogram can either be written directly in PL/SQL or indirectly generated when a PL/SQL Server Page is uploaded to the database and compiled.</p>
</li>
<li>
<p>The XML DB HTTP Listener routes the request to the embedded PL/SQL gateway as specified in its virtual-path mapping configuration.</p>
</li>
<li>
<p>The embedded gateway uses the HTTP request information and the gateway configuration to determine which database account to use for authentication.</p>
</li>
<li>
<p>The embedded gateway prepares the call parameters and invokes the PL/SQL subprogram in the application.</p>
</li>
<li>
<p>The PL/SQL subprogram generates an HTML page out of relational data and the PL/SQL Web Toolkit accessed from the database.</p>
</li>
<li>
<p>The application sends the page to the embedded gateway.</p>
</li>
<li>
<p>The embedded gateway sends the page to the XML DB HTTP Listener.</p>
</li>
<li>
<p>The XML DB HTTP Listener sends the page to the client browser.</p>
</li>
</ol>
<p>Unlike <code dir="ltr">mod_plsql</code>, the embedded gateway processes HTTP requests with the Oracle XML DB Listener. This listener is the same server-side process as the Oracle Net Listener and supports Oracle Net Services, HTTP, and FTP.</p>
<p>Configure general HTTP listener settings through the XML DB interface (for instructions, see <a class="olink ADXDB2510" href="../ADXDB/xdb22pro.htm#ADXDB2510"><span class="italic">Oracle XML DB Developer&#39;s Guide</span></a>). Configure the HTTP listener either by using Oracle Enterprise Manager Cloud Control (Cloud Control) or by editing the <code dir="ltr">xdbconfig</code>.<code dir="ltr">xml</code> file. Use the <code dir="ltr">DBMS_EPG</code> package for all embedded PL/SQL gateway configuration, for example, creating or setting attributes for a DAD.</p>
</div>
<!-- class="sect2" -->
<a id="CHEDJACD"></a>
<div id="ADFNS1352" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">14.4.2</span> Installing Embedded PL/SQL Gateway</h3>
<p>The embedded gateway requires these components:</p>
<ul>
<li>
<p>XML DB HTTP Listener</p>
</li>
<li>
<p>PL/SQL Web Toolkit</p>
</li>
</ul>
<p>The embedded PL/SQL gateway is installed as part of Oracle XML DB. If you are using a preconfigured database created during an installation or by the Database Configuration Assistant (DBCA), then Oracle XML DB is installed and configured. For information about manually adding Oracle XML DB to an existing database, see <a class="olink ADXDB2700" href="../ADXDB/appaman.htm#ADXDB2700"><span class="italic">Oracle XML DB Developer&#39;s Guide</span></a>.</p>
<p>The PL/SQL Web Toolkit is part of the standard installation of the database, so no supplementary installation is necessary.</p>
</div>
<!-- class="sect2" -->
<a id="CHEIGJIG"></a>
<div id="ADFNS1353" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">14.4.3</span> Configuring Embedded PL/SQL Gateway</h3>
<p>You configure <code dir="ltr">mod_plsql</code> by editing the Oracle HTTP Server configuration files. Because the embedded gateway is installed as part of the Oracle XML DB HTTP Listener, you manage the embedded gateway as a servlet through the Oracle XML DB servlet management interface.</p>
<p>The configuration interface to the embedded gateway is the PL/SQL package <code dir="ltr">DBMS_EPG</code>. This package modifies the underlying <code dir="ltr">xdbconfig</code>.<code dir="ltr">xml</code> configuration file that XML DB uses. The default values of the embedded gateway configuration parameters are sufficient for most users.</p>
<p class="subhead2"><a id="ADFNS1052"></a>Topics:</p>
<ul>
<li>
<p><a href="#BGBJFDAJ">Configuring Embedded PL/SQL Gateway: Overview</a></p>
</li>
<li>
<p><a href="#CHEHDFFI">Configuring User Authentication for Embedded PL/SQL Gateway</a></p>
</li>
</ul>
<a id="BGBJFDAJ"></a>
<div id="ADFNS468" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">14.4.3.1</span> Configuring Embedded PL/SQL Gateway: Overview</h4>
<p>As in <code dir="ltr">mod_plsql</code>, each request for a PL/SQL stored subprogram is associated with a <span class="bold">Database Access Descriptor (DAD)</span>. A DAD is a set of configuration values used for database access. A DAD specifies information such as:</p>
<ul>
<li>
<p>The database account to use for authentication</p>
</li>
<li>
<p>The subprogram to use for uploading and downloading documents</p>
</li>
</ul>
<p>In the embedded PL/SQL gateway, a DAD is represented as a servlet in the XML DB HTTP Listener configuration. Each DAD attribute maps to an XML element in the configuration file <code dir="ltr">xdbconfig</code>.<code dir="ltr">xml</code>. The value of the DAD attribute corresponds to the element content. For example, the <code dir="ltr">database-username</code> DAD attribute corresponds to the <code dir="ltr">&lt;database-username&gt;</code> XML element; if the value of the DAD attribute is <code dir="ltr">HR</code> it corresponds to <code dir="ltr">&lt;database-username&gt;HR&lt;database-username&gt;</code>. DAD attribute names are case-sensitive.</p>
<p>Use the <code dir="ltr">DBMS_EPG</code> package to perform these embedded PL/SQL gateway configurations:</p>
<ol>
<li>
<p>Create a DAD with the <code dir="ltr">DBMS_EPG</code>.<code dir="ltr">CREATE_DAD</code> procedure.</p>
</li>
<li>
<p>Set DAD attributes with the <code dir="ltr">DBMS_EPG</code>.<code dir="ltr">SET_DAD_ATTRIBUTE</code> procedure.</p>
<p>All DAD attributes are optional. If you do not specify an attribute, it has its initial value.</p>
</li>
</ol>
<p><a href="#BGBBJIBB">Table 14-2</a> lists the embedded PL/SQL gateway attributes and the corresponding <code dir="ltr">mod_plsql</code> DAD parameters. Enumeration values in the &#34;Legal Values&#34; column are case-sensitive.</p>
<div id="ADFNS469" class="tblruleformalwidemax">
<p class="titleintable"><a id="sthref754"></a><a id="BGBBJIBB"></a>Table 14-2 Mapping Between mod_plsql and Embedded PL/SQL Gateway DAD Attributes</p>
<table class="cellalignment296" title="Mapping Between mod_plsql and Embedded PL/SQL Gateway DAD Attributes" summary="This table maps the mod_plsql DAD parameters to the DBMS_EPGC DAD elements." dir="ltr">
<thead>
<tr class="cellalignment287">
<th class="cellalignment294" id="r1c1-t6">mod_plsql DAD Attribute</th>
<th class="cellalignment294" id="r1c2-t6">Embedded PL/SQL Gateway DAD Attribute</th>
<th class="cellalignment294" id="r1c3-t6">Multiple Occurrences</th>
<th class="cellalignment294" id="r1c4-t6">Legal Values</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment287">
<td class="cellalignment295" id="r2c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlAfterProcedure</code></p>
</td>
<td class="cellalignment295" headers="r2c1-t6 r1c2-t6">
<p><code dir="ltr">after-procedure</code></p>
</td>
<td class="cellalignment295" headers="r2c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r2c1-t6 r1c4-t6">
<p>String</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r3c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlAlwaysDescribeProcedure</code></p>
</td>
<td class="cellalignment295" headers="r3c1-t6 r1c2-t6">
<p><code dir="ltr">always-describe-procedure</code></p>
</td>
<td class="cellalignment295" headers="r3c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r3c1-t6 r1c4-t6">
<p>Enumeration of On, Off</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r4c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlAuthenticationMode</code></p>
</td>
<td class="cellalignment295" headers="r4c1-t6 r1c2-t6">
<p><code dir="ltr">authentication-mode</code></p>
</td>
<td class="cellalignment295" headers="r4c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r4c1-t6 r1c4-t6">
<p>Enumeration of Basic, SingleSignOn, GlobalOwa, CustomOwa, PerPackageOwa</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r5c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlBeforeProcedure</code></p>
</td>
<td class="cellalignment295" headers="r5c1-t6 r1c2-t6">
<p><code dir="ltr">before-procedure</code></p>
</td>
<td class="cellalignment295" headers="r5c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r5c1-t6 r1c4-t6">
<p>String</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r6c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlBindBucketLengths</code></p>
</td>
<td class="cellalignment295" headers="r6c1-t6 r1c2-t6">
<p><code dir="ltr">bind-bucket-lengths</code></p>
</td>
<td class="cellalignment295" headers="r6c1-t6 r1c3-t6">
<p>Yes</p>
</td>
<td class="cellalignment295" headers="r6c1-t6 r1c4-t6">
<p>Unsigned integer</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r7c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlBindBucketWidths</code></p>
</td>
<td class="cellalignment295" headers="r7c1-t6 r1c2-t6">
<p><code dir="ltr">bind-bucket-widths</code></p>
</td>
<td class="cellalignment295" headers="r7c1-t6 r1c3-t6">
<p>Yes</p>
</td>
<td class="cellalignment295" headers="r7c1-t6 r1c4-t6">
<p>Unsigned integer</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r8c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlCGIEnvironmentList</code></p>
</td>
<td class="cellalignment295" headers="r8c1-t6 r1c2-t6">
<p><code dir="ltr">cgi-environment-list</code></p>
</td>
<td class="cellalignment295" headers="r8c1-t6 r1c3-t6">
<p>Yes</p>
</td>
<td class="cellalignment295" headers="r8c1-t6 r1c4-t6">
<p>String</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r9c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlCompatibilityMode</code></p>
</td>
<td class="cellalignment295" headers="r9c1-t6 r1c2-t6">
<p><code dir="ltr">compatibility-mode</code></p>
</td>
<td class="cellalignment295" headers="r9c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r9c1-t6 r1c4-t6">
<p>Unsigned integer</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r10c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlDatabaseUsername</code></p>
</td>
<td class="cellalignment295" headers="r10c1-t6 r1c2-t6">
<p><code dir="ltr">database-username</code></p>
</td>
<td class="cellalignment295" headers="r10c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r10c1-t6 r1c4-t6">
<p>String</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r11c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlDefaultPage</code></p>
</td>
<td class="cellalignment295" headers="r11c1-t6 r1c2-t6">
<p><code dir="ltr">default-page</code></p>
</td>
<td class="cellalignment295" headers="r11c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r11c1-t6 r1c4-t6">
<p>String</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r12c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlDocumentPath</code></p>
</td>
<td class="cellalignment295" headers="r12c1-t6 r1c2-t6">
<p><code dir="ltr">document-path</code></p>
</td>
<td class="cellalignment295" headers="r12c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r12c1-t6 r1c4-t6">
<p>String</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r13c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlDocumentProcedure</code></p>
</td>
<td class="cellalignment295" headers="r13c1-t6 r1c2-t6">
<p><code dir="ltr">document-procedure</code></p>
</td>
<td class="cellalignment295" headers="r13c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r13c1-t6 r1c4-t6">
<p>String</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r14c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlDocumentTablename</code></p>
</td>
<td class="cellalignment295" headers="r14c1-t6 r1c2-t6">
<p><code dir="ltr">document-table-name</code></p>
</td>
<td class="cellalignment295" headers="r14c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r14c1-t6 r1c4-t6">
<p>String</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r15c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlErrorStyle</code></p>
</td>
<td class="cellalignment295" headers="r15c1-t6 r1c2-t6">
<p><code dir="ltr">error-style</code></p>
</td>
<td class="cellalignment295" headers="r15c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r15c1-t6 r1c4-t6">
<p>Enumeration of ApacheStyle, ModplsqlStyle, DebugStyle</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r16c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlExclusionList</code></p>
</td>
<td class="cellalignment295" headers="r16c1-t6 r1c2-t6">
<p><code dir="ltr">exclusion-list</code></p>
</td>
<td class="cellalignment295" headers="r16c1-t6 r1c3-t6">
<p>Yes</p>
</td>
<td class="cellalignment295" headers="r16c1-t6 r1c4-t6">
<p>String</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r17c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlFetchBufferSize</code></p>
</td>
<td class="cellalignment295" headers="r17c1-t6 r1c2-t6">
<p><code dir="ltr">fetch-buffer-size</code></p>
</td>
<td class="cellalignment295" headers="r17c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r17c1-t6 r1c4-t6">
<p>Unsigned integer</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r18c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlInfoLogging</code></p>
</td>
<td class="cellalignment295" headers="r18c1-t6 r1c2-t6">
<p><code dir="ltr">info-logging</code></p>
</td>
<td class="cellalignment295" headers="r18c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r18c1-t6 r1c4-t6">
<p>Enumeration of InfoDebug</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r19c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlInputFilterEnable</code></p>
</td>
<td class="cellalignment295" headers="r19c1-t6 r1c2-t6">
<p><code dir="ltr">input-filter-enable</code></p>
</td>
<td class="cellalignment295" headers="r19c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r19c1-t6 r1c4-t6">
<p>String</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r20c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlMaxRequestsPerSession</code></p>
</td>
<td class="cellalignment295" headers="r20c1-t6 r1c2-t6">
<p><code dir="ltr">max-requests-per-session</code></p>
</td>
<td class="cellalignment295" headers="r20c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r20c1-t6 r1c4-t6">
<p>Unsigned integer</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r21c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlNLSLanguage</code></p>
</td>
<td class="cellalignment295" headers="r21c1-t6 r1c2-t6">
<p><code dir="ltr">nls-language</code></p>
</td>
<td class="cellalignment295" headers="r21c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r21c1-t6 r1c4-t6">
<p>String</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r22c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlOWADebugEnable</code></p>
</td>
<td class="cellalignment295" headers="r22c1-t6 r1c2-t6">
<p><code dir="ltr">owa-debug-enable</code></p>
</td>
<td class="cellalignment295" headers="r22c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r22c1-t6 r1c4-t6">
<p>Enumeration of On, Off</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r23c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlPathAlias</code></p>
</td>
<td class="cellalignment295" headers="r23c1-t6 r1c2-t6">
<p><code dir="ltr">path-alias</code></p>
</td>
<td class="cellalignment295" headers="r23c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r23c1-t6 r1c4-t6">
<p>String</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r24c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlPathAliasProcedure</code></p>
</td>
<td class="cellalignment295" headers="r24c1-t6 r1c2-t6">
<p><code dir="ltr">path-alias-procedure</code></p>
</td>
<td class="cellalignment295" headers="r24c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r24c1-t6 r1c4-t6">
<p>String</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r25c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlRequestValidationFunction</code></p>
</td>
<td class="cellalignment295" headers="r25c1-t6 r1c2-t6">
<p><code dir="ltr">request-validation-function</code></p>
</td>
<td class="cellalignment295" headers="r25c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r25c1-t6 r1c4-t6">
<p>String</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r26c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlSessionCookieName</code></p>
</td>
<td class="cellalignment295" headers="r26c1-t6 r1c2-t6">
<p><code dir="ltr">session-cookie-name</code></p>
</td>
<td class="cellalignment295" headers="r26c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r26c1-t6 r1c4-t6">
<p>String</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r27c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlSessionStateManagement</code></p>
</td>
<td class="cellalignment295" headers="r27c1-t6 r1c2-t6">
<p><code dir="ltr">session-state-management</code></p>
</td>
<td class="cellalignment295" headers="r27c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r27c1-t6 r1c4-t6">
<p>Enumeration of StatelessWithResetPackageState, StatelessWithFastRestPackageState, StatelessWithPreservePackageState</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r28c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlTransferMode</code></p>
</td>
<td class="cellalignment295" headers="r28c1-t6 r1c2-t6">
<p><code dir="ltr">transfer-mode</code></p>
</td>
<td class="cellalignment295" headers="r28c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r28c1-t6 r1c4-t6">
<p>Enumeration of Char, Raw</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r29c1-t6" headers="r1c1-t6">
<p><code dir="ltr">PlsqlUploadAsLongRaw</code></p>
</td>
<td class="cellalignment295" headers="r29c1-t6 r1c2-t6">
<p><code dir="ltr">upload-as-long-raw</code></p>
</td>
<td class="cellalignment295" headers="r29c1-t6 r1c3-t6">
<p>No</p>
</td>
<td class="cellalignment295" headers="r29c1-t6 r1c4-t6">
<p>String</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblruleformalwidemax" -->
<p>The default values of the DAD attributes are sufficient for most users of the embedded gateway. <code dir="ltr">mod_plsql</code> users do not need these attributes:</p>
<ul>
<li>
<p><code dir="ltr">PlsqlDatabasePassword</code></p>
</li>
<li>
<p><code dir="ltr">PlsqlDatabaseConnectString</code> (because the embedded gateway does not support logon to external databases)</p>
</li>
</ul>
<p>Like the DAD attributes, the global configuration parameters are optional. <a href="#CHEFIIBF">Table 14-3</a> describes the <code dir="ltr">DBMS_EPG</code> global attributes and the corresponding <code dir="ltr">mod_plsql</code> global parameters.</p>
<div id="ADFNS1354" class="tblruleformalwidemax">
<p class="titleintable"><a id="sthref755"></a><a id="CHEFIIBF"></a>Table 14-3 Mapping Between mod_plsql and Embedded PL/SQL Gateway Global Attributes</p>
<table class="cellalignment296" title="Mapping Between mod_plsql and Embedded PL/SQL Gateway Global Attributes" summary="This tables maps the mod_plsql DAD parameters to the DBMS_EPGC DAD elements." dir="ltr">
<thead>
<tr class="cellalignment287">
<th class="cellalignment294" id="r1c1-t7">mod_plsql DAD Attribute</th>
<th class="cellalignment294" id="r1c2-t7">Embedded PL/SQL Gateway DAD Attribute</th>
<th class="cellalignment294" id="r1c3-t7">Multiple Occurrences</th>
<th class="cellalignment294" id="r1c4-t7">Legal Values</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment287">
<td class="cellalignment295" id="r2c1-t7" headers="r1c1-t7">
<p><code dir="ltr">PlsqlLogLevel</code></p>
</td>
<td class="cellalignment295" headers="r2c1-t7 r1c2-t7">
<p><code dir="ltr">log-level</code></p>
</td>
<td class="cellalignment295" headers="r2c1-t7 r1c3-t7">
<p>No</p>
</td>
<td class="cellalignment295" headers="r2c1-t7 r1c4-t7">
<p>Unsigned integer</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r3c1-t7" headers="r1c1-t7">
<p><code dir="ltr">PlsqlMaxParameters</code></p>
</td>
<td class="cellalignment295" headers="r3c1-t7 r1c2-t7">
<p><code dir="ltr">max-parameters</code></p>
</td>
<td class="cellalignment295" headers="r3c1-t7 r1c3-t7">
<p>No</p>
</td>
<td class="cellalignment295" headers="r3c1-t7 r1c4-t7">
<p>Unsigned integer</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblruleformalwidemax" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink HSADM168" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=HSADM168"><span class="italic">Oracle Fusion Middleware Administrator&#39;s Guide for Oracle HTTP Server</span></a> for detailed descriptions of the <code dir="ltr">mod_plsql</code> DAD attributes. See this documentation for default values and usage notes.</p>
</li>
<li>
<p><a class="olink ARPLS193" href="../ARPLS/d_epg.htm#ARPLS193"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> to learn about the <code dir="ltr">DBMS_EPG</code> package</p>
</li>
<li>
<p><a class="olink ADXDB2700" href="../ADXDB/appaman.htm#ADXDB2700"><span class="italic">Oracle XML DB Developer&#39;s Guide</span></a> for an account of the <code dir="ltr">xdbconfig</code>.<code dir="ltr">xml</code> file</p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" -->
<a id="CHEHDFFI"></a>
<div id="ADFNS471" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">14.4.3.2</span> Configuring User Authentication for Embedded PL/SQL Gateway</h4>
<p>Because it uses the XML DB authentication schemes, the embedded gateway handles database authentication differently from <code dir="ltr">mod_plsql</code>. In particular, it does not store database passwords in a DAD.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
To serve a PL/SQL web application on the Internet but maintain the database behind a firewall, do not use the embedded PL/SQL gateway to run the application; use <code dir="ltr">mod_plsql</code>.</div>
<p>Use the <code dir="ltr">DBMS_EPG</code> package to configure database authentication.</p>
<p class="subhead2"><a id="ADFNS1355"></a>Topics:</p>
<ul>
<li>
<p><a href="#BGBCFIIB">Configuring Static Authentication with DBMS_EPG</a></p>
</li>
<li>
<p><a href="#BGBHJIBE">Configuring Dynamic Authentication with DBMS_EPG</a></p>
</li>
<li>
<p><a href="#CHEJCFHH">Configuring Anonymous Authentication with DBMS_EPG</a></p>
</li>
<li>
<p><a href="#CHEBBCGI">Determining the Authentication Mode of a DAD</a></p>
</li>
<li>
<p><a href="#CHEHIFGF">Creating and Configuring DADs: Examples</a></p>
</li>
<li>
<p><a href="#CHEDEJJD">Determining the Authentication Mode for a DAD: Example</a></p>
</li>
<li>
<p><a href="#CHEDDJCD">Determining the Authentication Mode for All DADs: Example</a></p>
</li>
<li>
<p><a href="#CHECCEFH">Showing DAD Authorizations that Are Not in Effect: Example</a></p>
</li>
<li>
<p><a href="#CHDDEFFC">Examining Embedded PL/SQL Gateway Configuration</a></p>
</li>
</ul>
<a id="BGBCFIIB"></a>
<div id="ADFNS1356" class="sect4"><!-- infolevel="all" infotype="General" -->
<h5 class="sect4"><span class="secnum">14.4.3.2.1</span> Configuring Static Authentication with DBMS_EPG</h5>
<p>Static authentication is for the <code dir="ltr">mod_plsql</code> user who stores database user names and passwords in the DAD so that the browser user is not required to enter database authentication information.</p>
<p>To configure static authentication, follow these steps:</p>
<ol>
<li>
<p>Log on to the database as an XML DB administrator (that is, a user with the <code dir="ltr">XDBADMIN</code> role assigned).</p>
</li>
<li>
<p>Create the DAD. For example, this procedure creates a DAD invoked <code dir="ltr">HR_DAD</code> and maps the virtual path to /<code dir="ltr">hrweb</code>/:</p>
<pre dir="ltr">EXEC DBMS_EPG.CREATE_DAD(&#39;HR_DAD&#39;, &#39;/hrweb/*&#39;);
</pre></li>
<li>
<p>For this step, you need the <code dir="ltr">ALTER</code> <code dir="ltr">ANY</code> <code dir="ltr">USER</code> system privilege. Set the DAD attribute <code dir="ltr">database-username</code> to the database account whose privileges must be used by the DAD. For example, this procedure specifies that the DAD named <code dir="ltr">HR_DAD</code> has the privileges of the <code dir="ltr">HR</code> account:</p>
<pre dir="ltr">EXEC DBMS_EPG.SET_DAD_ATTRIBUTE(&#39;HR_DAD&#39;, &#39;database-username&#39;, &#39;HR&#39;);
</pre>
<p>The DAD attribute <code dir="ltr">database-username</code> is case-sensitive.</p>
</li>
<li>
<p>Assign the DAD the privileges of the database user specified in the previous step. This authorization enables end users to invoke procedures and access document tables through the embedded PL/SQL gateway with the privileges of the authorized account. For example:</p>
<pre dir="ltr">EXEC DBMS_EPG.AUTHORIZE_DAD(&#39;HR_DAD&#39;, &#39;HR&#39;);
</pre>
<p>Alternatively, you can log off as the user with <code dir="ltr">XDBADMIN</code> privileges, log on as the database user whose privileges must be used by the DAD, and then use this command to assign these privileges to the DAD:</p>
<pre dir="ltr">EXEC DBMS_EPG.AUTHORIZE_DAD(&#39;HR_DAD&#39;);
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
Multiple users can authorize the same DAD. The <code dir="ltr">database-username</code> attribute setting of the DAD determines which user&#39;s privileges to use.</div>
</li>
</ol>
<p>Unlike <code dir="ltr">mod_plsql</code>, the embedded gateway connects to the database as the special user <code dir="ltr">ANONYMOUS</code>, but accesses database objects with the user privileges assigned to the DAD. The database rejects access if the browser user attempts to connect explicitly with the HTTP <code dir="ltr">Authorization</code> header.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The account <code dir="ltr">ANONYMOUS</code> is locked after XML DB installation. To use static authentication with the embedded PL/SQL gateway, first unlock this account.</div>
</div>
<!-- class="sect4" -->
<a id="BGBHJIBE"></a>
<div id="ADFNS1357" class="sect4"><!-- infolevel="all" infotype="General" -->
<h5 class="sect4"><span class="secnum">14.4.3.2.2</span> Configuring Dynamic Authentication with DBMS_EPG</h5>
<p>Dynamic authentication is for the <code dir="ltr">mod_plsql</code> user who does not store database user names and passwords in the DAD.</p>
<p>In dynamic authentication, a database user does not have to authorize the embedded gateway to use its privileges to access database objects. Instead, browser users must supply the database authentication information through the HTTP Basic Authentication scheme.</p>
<p>The action of the embedded gateway depends on whether the <code dir="ltr">database-username</code> attribute is set for the DAD. If the attribute is not set, then the embedded gateway connects to the database as the user supplied by the browser client. If the attribute is set, then the database restricts access to the user specified in the <code dir="ltr">database-username</code> attribute.</p>
<p>To set up dynamic authentication, follow these steps:</p>
<ol>
<li>
<p>Log on to the database as a an XML DB administrator (that is, a user with the <code dir="ltr">XDBADMIN</code> role).</p>
</li>
<li>
<p>Create the DAD. For example, this procedure creates a DAD invoked <code dir="ltr">DYNAMIC_DAD</code> and maps the virtual path to <code dir="ltr">/hrweb/</code>:</p>
<pre dir="ltr">EXEC DBMS_EPG.CREATE_DAD(&#39;DYNAMIC_DAD&#39;, &#39;/hrweb/*&#39;);
</pre></li>
<li>
<p>Optionally, set the DAD attribute <code dir="ltr">database-username</code> to the database account whose privileges must be used by the DAD. The browser prompts the user to enter the username and password for this account when accessing the DAD. For example, this procedure specifies that the DAD named <code dir="ltr">DYNAMIC_DAD</code> has the privileges of the <code dir="ltr">HR</code> account:</p>
<pre dir="ltr">EXEC DBMS_EPG.SET_DAD_ATTRIBUTE(&#39;DYNAMIC_DAD&#39;, &#39;database-username&#39;, &#39;HR&#39;);
</pre>
<p>The attribute <code dir="ltr">database-username</code> is case-sensitive.</p>
</li>
</ol>
<div class="infoboxnotewarn">
<p class="notep1">WARNING:</p>
<p class="warnsp">Passwords sent through the HTTP Basic Authentication scheme are not encrypted. Configure the embedded gateway to use the HTTPS protocol to protect the passwords sent by the browser clients.</p>
</div>
</div>
<!-- class="sect4" -->
<a id="CHEJCFHH"></a>
<div id="ADFNS1358" class="sect4"><!-- infolevel="all" infotype="General" -->
<h5 class="sect4"><span class="secnum">14.4.3.2.3</span> Configuring Anonymous Authentication with DBMS_EPG</h5>
<p>Anonymous authentication is for the <code dir="ltr">mod_plsql</code> user who creates a special DAD database user for database logon, but stores the application procedures and document tables in a different schema and grants access to the procedures and document tables to PUBLIC.</p>
<p>To set up anonymous authentication, follow these steps:</p>
<ol>
<li>
<p>Log on to the database as an XML DB administrator, that is, a user with the <code dir="ltr">XDBADMIN</code> role assigned.</p>
</li>
<li>
<p>Create the DAD. For example, this procedure creates a DAD invoked <code dir="ltr">HR_DAD</code> and maps the virtual path to <code dir="ltr">/hrweb/</code>:</p>
<pre dir="ltr">EXEC DBMS_EPG.CREATE_DAD(&#39;HR_DAD&#39;, &#39;/hrweb/*&#39;);
</pre></li>
<li>
<p>Set the DAD attribute <code dir="ltr">database-username</code> to <code dir="ltr">ANONYMOUS</code>. For example:</p>
<pre dir="ltr">EXEC DBMS_EPG.SET_DAD_ATTRIBUTE(&#39;HR_DAD&#39;, &#39;database-username&#39;, &#39;ANONYMOUS&#39;);
</pre>
<p>Both <code dir="ltr">database-username</code> and <code dir="ltr">ANONYMOUS</code> are case-sensitive.</p>
<p>You need not authorize the embedded gateway to use <code dir="ltr">ANONYMOUS</code> privileges to access database objects, because <code dir="ltr">ANONYMOUS</code> has no system privileges and owns no database objects.</p>
</li>
</ol>
</div>
<!-- class="sect4" -->
<a id="CHEBBCGI"></a>
<div id="ADFNS1359" class="sect4"><!-- infolevel="all" infotype="General" -->
<h5 class="sect4"><span class="secnum">14.4.3.2.4</span> Determining the Authentication Mode of a DAD</h5>
<p>If you know the name of a DAD, then the authentication mode for this DAD depends on these factors:</p>
<ul>
<li>
<p>Does the DAD exist?</p>
</li>
<li>
<p>Is the <code dir="ltr">database-username</code> attribute for the DAD set?</p>
</li>
<li>
<p>Is the DAD authorized to use the privilege of the <code dir="ltr">database-username</code> user?</p>
</li>
<li>
<p>Is the <code dir="ltr">database-username</code> attribute the one that the user authorized to use the DAD?</p>
</li>
</ul>
<p><a href="#CHEIJCAD">Table 14-4</a> shows how the answers to the preceding questions determine the authentication mode.</p>
<div id="ADFNS1360" class="tblformal">
<p class="titleintable"><a id="sthref756"></a><a id="CHEIJCAD"></a>Table 14-4 Authentication Possibilities for a DAD</p>
<table class="cellalignment293" title="Authentication Possibilities for a DAD" summary="This table shows how the following things determine the authentication mode of a DAD: whether the DAD exists, whether its database-username is set, and whether a particular user is authorized." dir="ltr">
<thead>
<tr class="cellalignment287">
<th class="cellalignment294" id="r1c1-t13">DAD Exists?</th>
<th class="cellalignment294" id="r1c2-t13">database-username set?</th>
<th class="cellalignment294" id="r1c3-t13">User authorized?</th>
<th class="cellalignment294" id="r1c4-t13">Mode</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment287">
<td class="cellalignment295" id="r2c1-t13" headers="r1c1-t13">
<p>Yes</p>
</td>
<td class="cellalignment295" headers="r2c1-t13 r1c2-t13">
<p>Yes</p>
</td>
<td class="cellalignment295" headers="r2c1-t13 r1c3-t13">
<p>Yes</p>
</td>
<td class="cellalignment295" headers="r2c1-t13 r1c4-t13">
<p>Static</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r3c1-t13" headers="r1c1-t13">
<p>Yes</p>
</td>
<td class="cellalignment295" headers="r3c1-t13 r1c2-t13">
<p>Yes</p>
</td>
<td class="cellalignment295" headers="r3c1-t13 r1c3-t13">
<p>No</p>
</td>
<td class="cellalignment295" headers="r3c1-t13 r1c4-t13">
<p>Dynamic restricted</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r4c1-t13" headers="r1c1-t13">
<p>Yes</p>
</td>
<td class="cellalignment295" headers="r4c1-t13 r1c2-t13">
<p>No</p>
</td>
<td class="cellalignment295" headers="r4c1-t13 r1c3-t13">
<p>Does not matter</p>
</td>
<td class="cellalignment295" headers="r4c1-t13 r1c4-t13">
<p>Dynamic</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r5c1-t13" headers="r1c1-t13">
<p>Yes</p>
</td>
<td class="cellalignment295" headers="r5c1-t13 r1c2-t13">
<p>Yes (to <code dir="ltr">ANONYMOUS</code>)</p>
</td>
<td class="cellalignment295" headers="r5c1-t13 r1c3-t13">
<p>Does not matter</p>
</td>
<td class="cellalignment295" headers="r5c1-t13 r1c4-t13">
<p>Anonymous</p>
</td>
</tr>
<tr class="cellalignment287">
<td class="cellalignment295" id="r6c1-t13" headers="r1c1-t13">
<p>No</p>
</td>
<td class="cellalignment295" headers="r6c1-t13 r1c2-t13">&nbsp;</td>
<td class="cellalignment295" headers="r6c1-t13 r1c3-t13">&nbsp;</td>
<td class="cellalignment295" headers="r6c1-t13 r1c4-t13">
<p>N/A</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<p>For example, assume that you create a DAD named <code dir="ltr">MY_DAD</code>. If the <code dir="ltr">database-username</code> attribute for <code dir="ltr">MY_DAD</code> is set to <code dir="ltr">HR</code>, but the <code dir="ltr">HR</code> user does not authorize <code dir="ltr">MY_DAD</code>, then the authentication mode for <code dir="ltr">MY_DAD</code> is dynamic and restricted. A browser user who attempts to run a PL/SQL subprogram through <code dir="ltr">MY_DAD</code> is prompted to enter the <code dir="ltr">HR</code> database username and password.</p>
<p>The <code dir="ltr">DBA_EPG_DAD_AUTHORIZATION</code> view shows which users have authorized use of a DAD. The <code dir="ltr">DAD_NAME</code> column displays the name of the DAD; the <code dir="ltr">USERNAME</code> column displays the user whose privileges are assigned to the DAD. The DAD authorized might not exist.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink REFRN23709" href="../REFRN/GUID-01FBC73B-B3CB-4913-8912-E906B9BAE523.htm#REFRN23709"><span class="italic">Oracle Database Reference</span></a> for more information about the <code dir="ltr">DBA_EPG_DAD_AUTHORIZATION</code> view</div>
</div>
<!-- class="sect4" -->
<a id="CHEHIFGF"></a>
<div id="ADFNS1361" class="sect4"><!-- infolevel="all" infotype="General" -->
<h5 class="sect4"><span class="secnum">14.4.3.2.5</span> Creating and Configuring DADs: Examples</h5>
<p><a href="#CHECAAGH">Example 14-1</a> does this:</p>
<ul>
<li>
<p>Creates a DAD with static authentication for database user <code dir="ltr">HR</code> and assigns it the privileges of the <code dir="ltr">HR</code> account, which then authorizes it.</p>
</li>
<li>
<p>Creates a DAD with dynamic authentication that is not restricted to any user.</p>
</li>
<li>
<p>Creates a DAD with dynamic authentication that is restricted to the <code dir="ltr">HR</code> account.</p>
</li>
</ul>
<div id="ADFNS1362" class="example">
<p class="titleinexample"><a id="CHECAAGH"></a>Example 14-1 Creating and Configuring DADs</p>
<pre dir="ltr">------------------------------------------------------------------------
--- DAD with static authentication
------------------------------------------------------------------------

CONNECT SYSTEM AS SYSDBA
PASSWORD: <span class="italic">password</span>
EXEC DBMS_EPG.CREATE_DAD(&#39;Static_Auth_DAD&#39;, &#39;/static/*&#39;);
EXEC DBMS_EPG.SET_DAD_ATTRIBUTE(&#39;Static_Auth_DAD&#39;, &#39;database-username&#39;, &#39;HR&#39;);
GRANT EXECUTE ON DBMS_EPG TO HR;

-- Authorization
CONNECT HR
PASSWORD: <span class="italic">password</span>
EXEC DBMS_EPG.AUTHORIZE_DAD(&#39;Static_Auth_DAD&#39;);

------------------------------------------------------------------------
-- DAD with dynamic authentication
------------------------------------------------------------------------

CONNECT SYSTEM AS SYSDBA
PASSWORD: <span class="italic">password</span>
EXEC DBMS_EPG.CREATE_DAD(&#39;Dynamic_Auth_DAD&#39;, &#39;/dynamic/*&#39;);

-------------------------------------------------------------------------
-- DAD with dynamic authentication restricted
-------------------------------------------------------------------------

EXEC DBMS_EPG.CREATE_DAD(&#39;Dynamic_Auth_DAD_Restricted&#39;, &#39;/dynamic/*&#39;);
EXEC DBMS_EPG.SET_DAD_ATTRIBUTE
  (&#39;Dynamic_Auth_DAD_Restricted&#39;, &#39;database-username&#39;, &#39;HR&#39;);
</pre></div>
<!-- class="example" -->
<p>The creation and authorization of a DAD are independent; therefore you can:</p>
<ul>
<li>
<p>Authorize a DAD that does not exist (it can be created later)</p>
</li>
<li>
<p>Authorize a DAD for which you are not the user (however, the authorization does not take effect until the DAD <code dir="ltr">database-user</code> attribute is changed to your username)</p>
</li>
</ul>
<p><a href="#CHECADJE">Example 14-2</a> creates a DAD with static authentication for database user <code dir="ltr">HR</code> and assigns it the privileges of the <code dir="ltr">HR</code> account. Then:</p>
<ul>
<li>
<p>Instead of authorizing that DAD, the database user <code dir="ltr">HR</code> authorizes a nonexistent DAD.</p>
<p>Although the user might have done this by mistake, no error occurs, because the nonexistent DAD might be created later.</p>
</li>
<li>
<p>The database user <code dir="ltr">OE</code> authorizes the DAD (whose <code dir="ltr">database-user</code> attribute is set to <code dir="ltr">HR</code>.</p>
<p>No error occurs, but the authorization does not take effect until the DAD <code dir="ltr">database-user</code> attribute is changed to <code dir="ltr">OE</code>.</p>
</li>
</ul>
<div id="ADFNS1363" class="example">
<p class="titleinexample"><a id="CHECADJE"></a>Example 14-2 Authorizing DADs to be Created or Changed Later</p>
<pre dir="ltr">REM Create DAD with static authentication for database user HR

CONNECT SYSTEM AS SYSDBA
PASSWORD: <span class="italic">password</span>
EXEC DBMS_EPG.CREATE_DAD(&#39;Static_Auth_DAD&#39;, &#39;/static/*&#39;);
EXEC DBMS_EPG.SET_DAD_ATTRIBUTE(&#39;Static_Auth_DAD&#39;, &#39;database-username&#39;, &#39;HR&#39;);
GRANT EXECUTE ON DBMS_EPG TO HR;

REM Database user HR authorizes DAD that does not exist

CONNECT HR
PASSWORD: <span class="italic">password</span>
EXEC DBMS_EPG.AUTHORIZE_DAD(&#39;Static_Auth_DAD_Typo&#39;);

REM Database user OE authorizes DAD with database-username &#39;HR&#39;

CONNECT OE
PASSWORD: <span class="italic">password</span>
EXEC DBMS_EPG.AUTHORIZE_DAD(&#39;Static_Auth_DAD&#39;);
</pre></div>
<!-- class="example" --></div>
<!-- class="sect4" -->
<a id="CHEDEJJD"></a>
<div id="ADFNS1364" class="sect4"><!-- infolevel="all" infotype="General" -->
<h5 class="sect4"><span class="secnum">14.4.3.2.6</span> Determining the Authentication Mode for a DAD: Example</h5>
<p><a href="#CHEJFABC">Example 14-3</a> creates a PL/SQL procedure, <code dir="ltr">show_dad_auth_status</code>, which accepts the name of a DAD and reports its authentication mode. If the specified DAD does not exist, the procedure exits with an error.</p>
<div id="ADFNS1365" class="example">
<p class="titleinexample"><a id="CHEJFABC"></a>Example 14-3 Determining the Authentication Mode for a DAD</p>
<pre dir="ltr">CREATE OR REPLACE PROCEDURE show_dad_auth_status (p_dadname VARCHAR2) IS
  v_daduser VARCHAR2(32);
  v_cnt     PLS_INTEGER;
BEGIN
  -- Determine DAD user
  v_daduser := DBMS_EPG.GET_DAD_ATTRIBUTE(p_dadname, &#39;database-username&#39;);

  -- Determine whether DAD authorization exists for DAD user
  SELECT COUNT(*)
    INTO v_cnt
      FROM DBA_EPG_DAD_AUTHORIZATION da
        WHERE da.DAD_NAME = p_dadname
          AND da.USERNAME = v_daduser;

  -- If DAD authorization exists for DAD user, authentication mode is static
  IF (v_cnt &gt; 0) THEN
    DBMS_OUTPUT.PUT_LINE (
      &#39;&#39;&#39;&#39; || p_dadname ||
      &#39;&#39;&#39; is set up for static authentication for user &#39;&#39;&#39; ||
      v_daduser || &#39;&#39;&#39;.&#39;);
    RETURN;
  END IF;

  -- If no DAD authorization exists for DAD user, authentication mode is dynamic

  -- Determine whether dynamic authentication is restricted to particular user
  IF (v_daduser IS NOT NULL) THEN
    DBMS_OUTPUT.PUT_LINE (
      &#39;&#39;&#39;&#39; || p_dadname ||
      &#39;&#39;&#39; is set up for dynamic authentication for user &#39;&#39;&#39; ||
      v_daduser || &#39;&#39;&#39; only.&#39;);
  ELSE
    DBMS_OUTPUT.PUT_LINE (
      &#39;&#39;&#39;&#39; || p_dadname ||
      &#39;&#39;&#39; is set up for dynamic authentication for any user.&#39;);
  END IF;
END;
/
</pre></div>
<!-- class="example" -->
<p>Assume that you have run the script in <a href="#CHECAAGH">Example 14-1</a> to create and configure various DADs. The output is:</p>
<pre dir="ltr">SET SERVEROUTPUT ON;
BEGIN
  show_dad_auth_status(&#39;Static_Auth_DAD&#39;);
END;
/
&#39;Static_Auth_DAD&#39; is set up for static authentication for user &#39;HR&#39;.
</pre></div>
<!-- class="sect4" -->
<a id="CHEDDJCD"></a>
<div id="ADFNS1366" class="sect4"><!-- infolevel="all" infotype="General" -->
<h5 class="sect4"><span class="secnum">14.4.3.2.7</span> Determining the Authentication Mode for All DADs: Example</h5>
<p>The anonymous block in <a href="#CHEJHDGI">Example 14-4</a> reports the authentication modes of all registered DADs. It invokes the <code dir="ltr">show_dad_auth_status</code> procedure from <a href="#CHEJFABC">Example 14-3</a>.</p>
<div id="ADFNS1367" class="example">
<p class="titleinexample"><a id="CHEJHDGI"></a>Example 14-4 Showing the Authentication Mode for All DADs</p>
<pre dir="ltr">DECLARE
  v_dad_names DBMS_EPG.VARCHAR2_TABLE;
BEGIN
  DBMS_OUTPUT.PUT_LINE
    (&#39;---------- Authorization Status for All DADs ----------&#39;);
  DBMS_EPG.GET_DAD_LIST(v_dad_names);

  FOR i IN 1..v_dad_names.count LOOP
    show_dad_auth_status(v_dad_names(i));
  END LOOP;
END;
/
</pre></div>
<!-- class="example" -->
<p>If you have run the script in <a href="#CHECAAGH">Example 14-1</a> to create and configure various DADs, the output of <a href="#CHEJHDGI">Example 14-4</a> is:</p>
<pre dir="ltr">---------- Authorization Status for All DADs ----------
&#39;Static_Auth_DAD&#39; is set up for static auth for user &#39;HR&#39;.
&#39;Dynamic_Auth_DAD&#39; is set up for dynamic auth for any user.
&#39;Dynamic_Auth_DAD_Restricted&#39; is set up for dynamic auth for user &#39;HR&#39; only.
</pre></div>
<!-- class="sect4" -->
<a id="CHECCEFH"></a>
<div id="ADFNS1368" class="sect4"><!-- infolevel="all" infotype="General" -->
<h5 class="sect4"><span class="secnum">14.4.3.2.8</span> Showing DAD Authorizations that Are Not in Effect: Example</h5>
<p>The anonymous block in <a href="#CHEJJIFD">Example 14-5</a> reports DAD authorizations that are <span class="italic">not</span> in effect. A DAD authorization is not in effect in either of these situations:</p>
<ul>
<li>
<p>The user who authorizes the DAD is not the user specified by the <code dir="ltr">database-username</code> attribute of the DAD</p>
</li>
<li>
<p>The user authorizes a DAD that does not exist</p>
</li>
</ul>
<div id="ADFNS1369" class="example">
<p class="titleinexample"><a id="CHEJJIFD"></a>Example 14-5 Showing DAD Authorizations that Are Not in Effect</p>
<pre dir="ltr">DECLARE
  v_dad_names DBMS_EPG.VARCHAR2_TABLE;
  v_dad_user  VARCHAR2(32);
  v_dad_found BOOLEAN;
BEGIN 
  DBMS_OUTPUT.PUT_LINE
    (&#39;---------- DAD Authorizations Not in Effect ----------&#39;);
  DBMS_EPG.GET_DAD_LIST(v_dad_names);

  FOR r IN (SELECT * FROM DBA_EPG_DAD_AUTHORIZATION) LOOP  -- Outer loop
    v_dad_found := FALSE;
    FOR i IN 1..v_dad_names.count LOOP  -- Inner loop
      IF (r.DAD_NAME = v_dad_names(i)) THEN
        v_dad_user :=
          DBMS_EPG.GET_DAD_ATTRIBUTE(r.DAD_NAME, &#39;database-username&#39;);

        -- Is database-username the user for whom DAD is authorized?
        IF (r.USERNAME &lt;&gt; v_dad_user) THEN
          DBMS_OUTPUT.PUT_LINE (
            &#39;DAD authorization of &#39;&#39;&#39; || r.dad_name ||
            &#39;&#39;&#39; by user &#39;&#39;&#39; || r.username || &#39;&#39;&#39;&#39; ||
            &#39; is not in effect because DAD user is &#39; ||
            &#39;&#39;&#39;&#39; || v_dad_user || &#39;&#39;&#39;.&#39;);
        END IF;
        v_dad_found := TRUE;
        EXIT;  -- Inner loop
      END IF;
    END LOOP;  -- Inner loop

    -- Does DAD exist?
    IF (NOT v_dad_found) THEN
      DBMS_OUTPUT.PUT_LINE (
       &#39;DAD authorization of &#39;&#39;&#39; || r.dad_name ||
       &#39;&#39;&#39; by user &#39;&#39;&#39; || r.username ||
       &#39;&#39;&#39; is not in effect because the DAD does not exist.&#39;);
    END IF;
  END LOOP;  -- Outer loop
END;
/
</pre></div>
<!-- class="example" -->
<p>If you have run the script in <a href="#CHECADJE">Example 14-2</a> to create and configure various DADs, the output of <a href="#CHEJJIFD">Example 14-5</a> (reformatted to fit on the page) is:</p>
<pre dir="ltr">---------- DAD Authorizations Not in Effect ----------
DAD authorization of &#39;Static_Auth_DAD&#39; by user &#39;OE&#39; is not in effect
  because DAD user is &#39;HR&#39;.
DAD authorization of &#39;Static_Auth_DAD_Typo&#39; by user &#39;HR&#39; is not in effect
  because DAD does not exist.
</pre></div>
<!-- class="sect4" -->
<a id="CHDDEFFC"></a>
<div id="ADFNS1370" class="sect4"><!-- infolevel="all" infotype="General" -->
<h5 class="sect4"><span class="secnum">14.4.3.2.9</span> Examining Embedded PL/SQL Gateway Configuration</h5>
<p>When you are connected to the database as a user with system privileges, this script helps you examine the configuration of the embedded PL/SQL gateway:</p>
<pre dir="ltr">$ORACLE_HOME/rdbms/admin/epgstat.sql
</pre>
<p><a href="#CHDCAICF">Example 14-6</a> shows the output of the <code dir="ltr">epgstat</code>.<code dir="ltr">sql</code> script for <a href="#CHECAAGH">Example 14-1</a> when the <code dir="ltr">ANONYMOUS</code> account is locked.</p>
<div id="ADFNS1371" class="example">
<p class="titleinexample"><a id="CHDCAICF"></a>Example 14-6 epgstat.sql Script Output for <a href="#CHECAAGH">Example 14-1</a></p>
<p>Command to run script:</p>
<pre dir="ltr">@$ORACLE_HOME/rdbms/admin/epgstat.sql
</pre>
<p>Result:</p>
<pre dir="ltr">+--------------------------------------+
| XDB protocol ports:                  |
|  XDB is listening for the protocol   |
|  when the protocol port is nonzero.  |
+--------------------------------------+

HTTP Port FTP Port
--------- --------
        0        0

1 row selected.

+---------------------------+
| DAD virtual-path mappings |
+---------------------------+

Virtual Path                     DAD Name
-------------------------------- --------------------------------
/dynamic/*                       Dynamic_Auth_DAD_Restricted
/static/*                        Static_Auth_DAD

2 rows selected.

+----------------+
| DAD attributes |
+----------------+

DAD Name        DAD Param             DAD Value
------------    --------------------- ----------------------------------------
Dynamic_Auth    database-username     HR
_DAD_Restric
ted

Static_Auth_    database-username     HR
DAD


2 rows selected.

+---------------------------------------------------+
| DAD authorization:                                |
|  To use static authentication of a user in a DAD, |
|  the DAD must be authorized for the user.         |
+---------------------------------------------------+

DAD Name                         User Name
-------------------------------- --------------------------------
Static_Auth_DAD                  HR
                                 OE
Static_Auth_DAD_Typo             HR

3 rows selected.

+----------------------------+
| DAD authentication schemes |
+----------------------------+

DAD Name             User Name                        Auth Scheme
-------------------- -------------------------------- ------------------
Dynamic_Auth_DAD                                      Dynamic
Dynamic_Auth_DAD_Res HR                               Dynamic Restricted
tricted

Static_Auth_DAD      HR                               Static

3 rows selected.

+--------------------------------------------------------+
| ANONYMOUS user status:                                 |
|  To use static or anonymous authentication in any DAD, |
|  the ANONYMOUS account must be unlocked.               |
+--------------------------------------------------------+

Database User   Status
--------------- --------------------
ANONYMOUS       EXPIRED &amp; LOCKED

1 row selected.

+-------------------------------------------------------------------+
| ANONYMOUS access to XDB repository:                               |
|  To allow public access to XDB repository without authentication, |
|  ANONYMOUS access to the repository must be allowed.              |
+-------------------------------------------------------------------+

Allow repository anonymous access?
----------------------------------
false

1 row selected.
</pre></div>
<!-- class="example" --></div>
<!-- class="sect4" --></div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CHEICAAC"></a>
<div id="ADFNS488" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">14.4.4</span> Invoking PL/SQL Stored Subprograms Through Embedded PL/SQL Gateway</h3>
<p><a id="sthref757"></a>The basic steps for invoking PL/SQL subprograms through the embedded PL/SQL gateway are the same as for the <code dir="ltr">mod_plsql</code> gateway. See <a class="olink YPMOD002" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=YPMOD002"><span class="italic">Oracle HTTP Server mod_plsql User&#39;s Guide</span></a> for instructions. You must adapt the <code dir="ltr">mod_plsql</code> instructions slightly for use with the embedded gateway. For example, invoke the embedded gateway in a browser by entering the URL in this format:</p>
<pre dir="ltr">protocol://hostname[:port]/virt-path/[[!][schema.][package.]proc_name[?query_str]]
</pre>
<p>The placeholder <code dir="ltr">virt-path</code> stands for the virtual path that you configured in <code dir="ltr">DBMS_EPG</code>.<code dir="ltr">CREATE_DAD</code>. The <code dir="ltr">mod_plsql</code> documentation uses <code dir="ltr">DAD_location</code> instead of <code dir="ltr">virt-path</code>.</p>
<p>These topics documented in <a class="olink YPMOD002" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=YPMOD002"><span class="italic">Oracle HTTP Server mod_plsql User&#39;s Guide</span></a> apply equally to the embedded gateway:</p>
<ul>
<li>
<p>Transaction mode</p>
</li>
<li>
<p>Supported data types</p>
</li>
<li>
<p>Parameter-passing scheme</p>
</li>
<li>
<p>File upload and download support</p>
</li>
<li>
<p>Path-aliasing</p>
</li>
<li>
<p>Common Gateway Interface (CGI) environment variables</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="CHEBAEFB"></a>
<div id="ADFNS1372" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">14.4.5</span> Securing Application Access with Embedded PL/SQL Gateway</h3>
<p>The embedded gateway shares the same protection mechanism with <code dir="ltr">mod_plsql</code>. See <a class="olink YPMOD003" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=YPMOD003"><span class="italic">Oracle HTTP Server mod_plsql User&#39;s Guide</span></a> for instructions.</p>
</div>
<!-- class="sect2" -->
<a id="CHEEGIED"></a>
<div id="ADFNS490" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">14.4.6</span> Restrictions in Embedded PL/SQL Gateway</h3>
<p>The <code dir="ltr">mod_plsql</code> restrictions documented in the first chapter of <a class="olink YPMOD414" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=YPMOD414"><span class="italic">Oracle HTTP Server mod_plsql User&#39;s Guide</span></a> apply equally to the embedded gateway. Also, the embedded version of the gateway does not support these features:</p>
<ul>
<li>
<p>Dynamic HTML caching</p>
</li>
<li>
<p>System monitoring</p>
</li>
<li>
<p>Authentication modes other than Basic</p>
<p>For information about authentication modes, see <a class="olink YPMOD331" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=YPMOD331"><span class="italic">Oracle HTTP Server mod_plsql User&#39;s Guide</span></a>.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="CHEHBJHI"></a>
<div id="ADFNS1373" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">14.4.7</span> Using Embedded PL/SQL Gateway: Scenario</h3>
<p>This section illustrates how to write a simple application that queries the <code dir="ltr">hr</code>.<code dir="ltr">employees</code> table and delivers HTML output to a web browser through the PL/SQL gateway. It assumes that you have both XML DB and the sample schemas installed.</p>
<p>To write and run the program follow these steps:</p>
<ol>
<li>
<p>Log on to the database as a user with <code dir="ltr">ALTER</code> <code dir="ltr">USER</code> privileges and ensure that the database account <code dir="ltr">ANONYMOUS</code> is unlocked. The <code dir="ltr">ANONYMOUS</code> account, which is locked by default, is required for static authentication. If the account is locked, then use this SQL statement to unlock it:</p>
<pre dir="ltr">ALTER USER anonymous ACCOUNT UNLOCK;
</pre></li>
<li>
<p>Log on to the database as an XML DB administrator, that is, a user with the <code dir="ltr">XDBADMIN</code> role.</p>
<p>To determine which users and roles were granted the <code dir="ltr">XDADMIN</code> role, query the data dictionary:</p>
<pre dir="ltr">SELECT *
FROM DBA_ROLE_PRIVS
WHERE GRANTED_ROLE = &#39;XDBADMIN&#39;;
</pre></li>
<li>
<p>Create the DAD. For example, this procedure creates a DAD invoked <code dir="ltr">HR_DAD</code> and maps the virtual path to <code dir="ltr">/plsql/</code>:</p>
<pre dir="ltr">EXEC DBMS_EPG.CREATE_DAD(&#39;HR_DAD&#39;, &#39;/plsql/*&#39;);
</pre></li>
<li>
<p>Set the DAD attribute <code dir="ltr">database-username</code> to the database user whose privileges must be used by the DAD. For example, this procedure specifies that the DAD <code dir="ltr">HR_DAD</code> accesses database objects with the privileges of user <code dir="ltr">HR</code>:</p>
<pre dir="ltr">EXEC DBMS_EPG.SET_DAD_ATTRIBUTE(&#39;HR_DAD&#39;, &#39;database-username&#39;, &#39;HR&#39;);
</pre>
<p>The attribute <code dir="ltr">database-username</code> is case-sensitive.</p>
</li>
<li>
<p>Grant <code dir="ltr">EXECUTE</code> privilege to the database user whose privileges must be used by the DAD (so that he or she can authorize the DAD). For example:</p>
<pre dir="ltr">GRANT EXECUTE ON DBMS_EPG TO HR;
</pre></li>
<li>
<p>Log off as the XML DB administrator and log on to the database as the database user whose privileges must be used by the DAD (for example, <code dir="ltr">HR</code>).</p>
</li>
<li>
<p>Authorize the embedded PL/SQL gateway to invoke procedures and access document tables through the DAD. For example:</p>
<pre dir="ltr">EXEC DBMS_EPG.AUTHORIZE_DAD(&#39;HR_DAD&#39;);
</pre></li>
<li>
<p>Create a sample PL/SQL stored procedure invoked <code dir="ltr">print_employees</code>. This program creates an HTML page that includes the result set of a query of <code dir="ltr">hr</code>.<code dir="ltr">employees</code>:</p>
<pre dir="ltr">CREATE OR REPLACE PROCEDURE print_employees IS
  CURSOR emp_cursor IS
    SELECT last_name, first_name
      FROM hr.employees
        ORDER BY last_name;
BEGIN
  HTP.PRINT(&#39;&lt;html&gt;&#39;);
  HTP.PRINT(&#39;&lt;head&gt;&#39;);
  HTP.PRINT(&#39;&lt;meta http-equiv=&#34;Content-Type&#34; content=&#34;text/html&#34;&gt;&#39;);
  HTP.PRINT(&#39;&lt;title&gt;List of Employees&lt;/title&gt;&#39;);
  HTP.PRINT(&#39;&lt;/head&gt;&#39;); 
  HTP.PRINT(&#39;&lt;body TEXT=&#34;#000000&#34; BGCOLOR=&#34;#FFFFFF&#34;&gt;&#39;);
  HTP.PRINT(&#39;&lt;h1&gt;List of Employees&lt;/h1&gt;&#39;);
  HTP.PRINT(&#39;&lt;table width=&#34;40%&#34; border=&#34;1&#34;&gt;&#39;);
  HTP.PRINT(&#39;&lt;tr&gt;&#39;);
  HTP.PRINT(&#39;&lt;th align=&#34;left&#34;&gt;Last Name&lt;/th&gt;&#39;);
  HTP.PRINT(&#39;&lt;th align=&#34;left&#34;&gt;First Name&lt;/th&gt;&#39;);
  HTP.PRINT(&#39;&lt;/tr&gt;&#39;);
  FOR emp_record IN emp_cursor LOOP
    HTP.PRINT(&#39;&lt;tr&gt;&#39;);
    HTP.PRINT(&#39;&lt;td&gt;&#39; || emp_record.last_name  || &#39;&lt;/td&gt;&#39;);
    HTP.PRINT(&#39;&lt;td&gt;&#39; || emp_record.first_name || &#39;&lt;/td&gt;&#39;);
  END LOOP;
  HTP.PRINT(&#39;&lt;/table&gt;&#39;);
  HTP.PRINT(&#39;&lt;/body&gt;&#39;);
  HTP.PRINT(&#39;&lt;/html&gt;&#39;);
END;
/
</pre></li>
<li>
<p>Ensure that the Oracle Net listener can accept HTTP requests. You can determine the status of the listener on Linux and UNIX by running this command at the system prompt:</p>
<pre dir="ltr">lsnrctl status | grep HTTP
</pre>
<p>Output (reformatted from a single line to multiple lines from page size constraints):</p>
<pre dir="ltr">(DESCRIPTION=
  (ADDRESS=(PROTOCOL=tcp)(HOST=example.com)(PORT=8080))
  (Presentation=HTTP)
  (Session=RAW)
)
</pre>
<p>If you do not see the HTTP service started, then you can add these lines to your initialization parameter file (replacing <code dir="ltr"><span class="codeinlineitalic">listener_name</span></code> with the name of your Oracle Net local listener), then restart the database and the listener:</p>
<pre dir="ltr">dispatchers=&#34;(PROTOCOL=TCP)&#34;
local_listener=<span class="italic">listener_name</span>
</pre></li>
<li>
<p>Run the <code dir="ltr">print_employees</code> program from your web browser. For example, you can use this URL, replacing <code dir="ltr"><span class="codeinlineitalic">host</span></code> with the name of your host computer and <code dir="ltr"><span class="codeinlineitalic">port</span></code> with the value of the <code dir="ltr">PORT</code> parameter in the previous step:</p>
<pre dir="ltr">http://<span class="italic">host</span>:<span class="italic">port</span>/plsql/print_employees
</pre>
<p>For example, if your host is <code dir="ltr">test</code>.<code dir="ltr">com</code> and your HTTP port is <code dir="ltr">8080</code>, then enter:</p>
<pre dir="ltr">http://example.com:8080/plsql/print_employees
</pre>
<p>The web browser returns an HTML page with a table that includes the first and last name of every employee in the <code dir="ltr">hr</code>.<code dir="ltr">employees</code> table.</p>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1006207"></a>
<div id="ADFNS1374" class="sect1">
<h2 class="sect1"><span class="secnum">14.5</span> Generating HTML Output with PL/SQL</h2>
<p>Traditionally, PL/SQL web applications use function calls to generate each HTML tag for output. These functions are part of the PL/SQL Web Toolkit packages that come with Oracle Database. <a href="#BGBHBBGJ">Example 14-7</a> shows how to generate a simple HTML page by calling the <code dir="ltr">HTP</code> functions that correspond to each HTML tag.</p>
<div id="ADFNS1375" class="example">
<p class="titleinexample"><a id="BGBHBBGJ"></a>Example 14-7 Using HTP Functions to Generate HTML Tags</p>
<pre dir="ltr">CREATE OR REPLACE PROCEDURE html_page IS
BEGIN
  HTP.HTMLOPEN;                            -- generates &lt;HTML&gt;
  HTP.HEADOPEN;                            -- generates &lt;HEAD&gt;
  HTP.TITLE(&#39;Title&#39;);                      -- generates &lt;TITLE&gt;Hello&lt;/TITLE&gt;
  HTP.HEADCLOSE;                           -- generates &lt;/HTML&gt; 

  -- generates &lt;BODY TEXT=&#34;#000000&#34; BGCOLOR=&#34;#FFFFFF&#34;&gt;
  HTP.BODYOPEN( cattributes =&gt; &#39;TEXT=&#34;#000000&#34; BGCOLOR=&#34;#FFFFFF&#34;&#39;);

  -- generates &lt;H1&gt;Heading in the HTML File&lt;/H1&gt;
  HTP.HEADER(1, &#39;Heading in the HTML File&#39;);

  HTP.PARA;                                 -- generates &lt;P&gt;        
  HTP.PRINT(&#39;Some text in the HTML file.&#39;); 
  HTP.BODYCLOSE;                            -- generates &lt;/BODY&gt;
  HTP.HTMLCLOSE;                            -- generates &lt;/HTML&gt;
END;
/
</pre></div>
<!-- class="example" -->
<p>An alternative to making function calls that correspond to each tag is to use the <code dir="ltr">HTP</code>.<code dir="ltr">PRINT</code> function to print both text and tags. <a href="#BGBBHAEC">Example 14-8</a> illustrates this technique.</p>
<div id="ADFNS1376" class="example">
<p class="titleinexample"><a id="BGBBHAEC"></a>Example 14-8 Using HTP.PRINT to Generate HTML Tags</p>
<pre dir="ltr">CREATE OR REPLACE PROCEDURE html_page2 IS
BEGIN
  HTP.PRINT(&#39;&lt;html&gt;&#39;);
  HTP.PRINT(&#39;&lt;head&gt;&#39;);
  HTP.PRINT(&#39;&lt;meta http-equiv=&#34;Content-Type&#34; content=&#34;text/html&#34;&gt;&#39;);
  HTP.PRINT(&#39;&lt;title&gt;Title of the HTML File&lt;/title&gt;&#39;);
  HTP.PRINT(&#39;&lt;/head&gt;&#39;);
  HTP.PRINT(&#39;&lt;body TEXT=&#34;#000000&#34; BGCOLOR=&#34;#FFFFFF&#34;&gt;&#39;);
  HTP.PRINT(&#39;&lt;h1&gt;Heading in the HTML File&lt;/h1&gt;&#39;);
  HTP.PRINT(&#39;&lt;p&gt;Some text in the HTML file.&#39;);
  HTP.PRINT(&#39;&lt;/body&gt;&#39;);
  HTP.PRINT(&#39;&lt;/html&gt;&#39;);
END;
/
</pre></div>
<!-- class="example" --></div>
<!-- class="sect1" -->
<a id="i1006241"></a>
<div id="ADFNS1009" class="sect1">
<h2 class="sect1"><span class="secnum">14.6</span> Passing Parameters to PL/SQL Web Applications</h2>
<p>To be useful in a wide variety of situations, a web application must be interactive enough to allow user choices. To keep the attention of impatient web surfers, streamline the interaction so that users can specify these choices very simply, without excessive decision-making or data entry.</p>
<p>The main methods of passing parameters to PL/SQL web applications are:</p>
<ul>
<li>
<p>Using HTML form tags. The user fills in a form on one web page, and all the data and choices are transmitted to a stored subprogram when the user clicks the <code dir="ltr">Submit</code> button on the page.</p>
</li>
<li>
<p>Hard-coded in the URL. The user clicks on a link, and a set of predefined parameters are transmitted to a stored subprogram. Typically, you include separate links on your web page for all the choices that the user might want.</p>
</li>
</ul>
<p class="subhead2"><a id="ADFNS1054"></a>Topics:</p>
<ul>
<li>
<p><a href="#CHEFAAID">Passing List and Dropdown-List Parameters from an HTML Form</a></p>
</li>
<li>
<p><a href="#CHEJIFDF">Passing Option and Check Box Parameters from an HTML Form</a></p>
</li>
<li>
<p><a href="#CHEEDDHB">Passing Entry-Field Parameters from an HTML Form</a></p>
</li>
<li>
<p><a href="#CHECAHEB">Passing Hidden Parameters from an HTML Form</a></p>
</li>
<li>
<p><a href="#CHEGBHII">Uploading a File from an HTML Form</a></p>
</li>
<li>
<p><a href="#CHEIAFEE">Submitting a Completed HTML Form</a></p>
</li>
<li>
<p><a href="#CHEHCIHC">Handling Missing Input from an HTML Form</a></p>
</li>
<li>
<p><a href="#CHEJBJFE">Maintaining State Information Between Web Pages</a></p>
</li>
</ul>
<a id="CHEFAAID"></a>
<div id="ADFNS1377" class="sect2">
<h3 class="sect2"><span class="secnum">14.6.1</span> Passing List and Dropdown-List Parameters from an HTML Form</h3>
<p>List boxes and drop-down lists are implemented with the HTML tag <code dir="ltr">&lt;SELECT&gt;</code>.</p>
<p>Use a list box for a large number of choices or to allow multiple selections. List boxes are good for showing items in alphabetical order so that users can find an item quickly without reading all the choices.</p>
<p>Use a drop-down list in these situations:</p>
<ul>
<li>
<p>There are a small number of choices</p>
</li>
<li>
<p>Screen space is limited.</p>
</li>
<li>
<p>Choices are in an unusual order.</p>
</li>
</ul>
<p>The drop-down captures the attention of first-time users and makes them read the items. If you keep the choices and order consistent, then users can memorize the motion of selecting an item from the drop-down list, allowing them to make selections quickly as they gain experience. <a href="#CHEJCAGD">Example 14-9</a> shows a simple drop-down list.</p>
<div id="ADFNS1378" class="example">
<p class="titleinexample"><a id="CHEJCAGD"></a>Example 14-9 HTML Drop-Down List</p>
<pre dir="ltr">&lt;form&gt;
&lt;select name=&#34;seasons&#34;&gt;
&lt;option value=&#34;winter&#34;&gt;Winter
&lt;option value=&#34;spring&#34;&gt;Spring
&lt;option value=&#34;summer&#34;&gt;Summer
&lt;option value=&#34;fall&#34;&gt;Fall
&lt;/select&gt;
</pre></div>
<!-- class="example" --></div>
<!-- class="sect2" -->
<a id="CHEJIFDF"></a>
<div id="ADFNS1379" class="sect2">
<h3 class="sect2"><span class="secnum">14.6.2</span> Passing Option and Check Box Parameters from an HTML Form</h3>
<p>Options pass either a null value (if none of the options in a group is checked), or the value specified on the option that is checked.</p>
<p>To specify a default value for a set of options, you can include the <code dir="ltr">CHECKED</code> attribute in an<code dir="ltr">INPUT</code> tag, or include a <code dir="ltr">DEFAULT</code> clause on the parameter within the stored subprogram. When setting up a group of options, be sure to include a choice that indicates &#34;no preference&#34;, because after selecting a option, the user can select a different one, but cannot clear the selection completely. For example, include a &#34;Don&#39;t Care&#34; or &#34;Don&#39;t Know&#34; selection along with &#34;Yes&#34; and &#34;No&#34; choices, in case someone makes a selection and then realizes it was wrong.</p>
<p>Check boxes need special handling, because your stored subprogram might receive a null value, a single value, or multiple values:</p>
<p>All the check boxes with the same <code dir="ltr">NAME</code> attribute comprise a check box group. If none of the check boxes in a group is checked, the stored subprogram receives a null value for the corresponding parameter.</p>
<p>If one check box in a group is checked, the stored subprogram receives a single <code dir="ltr">VARCHAR2</code> parameter.</p>
<p>If multiple check boxes in a group are checked, the stored subprogram receives a parameter with the PL/SQL type <code dir="ltr">TABLE</code> <code dir="ltr">OF</code> <code dir="ltr">VARCHAR2</code>. You must declare a type like <code dir="ltr">TABLE</code> <code dir="ltr">OF</code> <code dir="ltr">VARCHAR2</code>, or use a predefined one like <code dir="ltr">OWA_UTIL</code>.<code dir="ltr">IDENT_ARR</code>. To retrieve the values, use a loop:</p>
<pre dir="ltr">CREATE OR REPLACE PROCEDURE handle_checkboxes (
  checkboxes owa_util.ident_arr
) AS
BEGIN
  FOR i IN 1..checkboxes.count
  LOOP
    htp.print(&#39;&lt;p&gt;Check Box value: &#39; || checkboxes(i));
  END LOOP;
END;
/
</pre></div>
<!-- class="sect2" -->
<a id="CHEEDDHB"></a>
<div id="ADFNS1380" class="sect2">
<h3 class="sect2"><span class="secnum">14.6.3</span> Passing Entry-Field Parameters from an HTML Form</h3>
<p>Entry fields require the most validation, because a user might enter data in the wrong format, out of range, and so on. If possible, validate the data on the client side using a client-side JavaScript function, and format it correctly for the user or prompt them to enter it again.</p>
<p>For example:</p>
<ul>
<li>
<p>You might prevent the user from entering alphabetic characters in a numeric entry field, or from entering characters after reaching a length limit.</p>
</li>
<li>
<p>You might silently remove spaces and dashes from a credit card number if the stored subprogram expects the value in that format.</p>
</li>
<li>
<p>You might inform the user immediately when they type a number that is too large, so that they can retype it.</p>
</li>
</ul>
<p>Because you cannot rely on such validation to succeed, code the stored subprograms to deal with these cases anyway. Rather than forcing the user to use the <code dir="ltr">Back</code> button when they enter wrong data, display a single page with an error message and the original form with all the other values filled in.</p>
<p>For sensitive information such as passwords, a special form of the entry field, <code dir="ltr">&lt;INPUT TYPE=PASSWORD&gt;</code>, hides the text as it is typed in.</p>
<p>The procedure in <a href="#CHEEHHJA">Example 14-10</a> accepts two strings as input. The first time the procedure is invoked, the user sees a simple form prompting for the input values. When the user submits the information, the same procedure is invoked again to check if the input is correct. If the input is OK, the procedure processes it. If not, the procedure prompts for input, filling in the original values for the user.</p>
<div id="ADFNS1381" class="example">
<p class="titleinexample"><a id="CHEEHHJA"></a>Example 14-10 Passing Entry-Field Parameters from an HTML Form</p>
<pre dir="ltr">DROP TABLE name_zip_table;
CREATE TABLE name_zip_table (
  name     VARCHAR2(100),
  zipcode  NUMBER
);

-- Store a name and associated zip code in the database.

CREATE OR REPLACE PROCEDURE associate_name_with_zipcode
  (name VARCHAR2 := NULL,
   zip  VARCHAR2 := NULL)
AS
BEGIN
  -- Each entry field must contain a value. Zip code must be 6 characters.
  -- (In a real program you perform more extensive checking.)

  IF name IS NOT NULL AND zip IS NOT NULL AND length(zip) = 6 THEN
    INSERT INTO name_zip_table (name, zipcode) VALUES (name, zip);

    HTP.PRINT(&#39;&lt;p&gt;The person &#39; || HTP.ESCAPE_SC(name) ||
              &#39; has the zip code &#39; || HTP.ESCAPE_SC(zip) || &#39;.&#39;);

    -- If input was OK, stop here. User does not see form again.
    RETURN;
  END IF;

  -- If user entered incomplete or incorrect data, show error message.

  IF (name IS NULL AND zip IS NOT NULL)
    OR (name IS NOT NULL AND zip IS NULL)
      OR (zip IS NOT NULL AND length(zip) != 6)
  THEN
    HTP.PRINT(&#39;&lt;p&gt;&lt;b&gt;Please reenter data. Fill all fields,
               and use 6-digit zip code.&lt;/b&gt;&#39;);
  END IF;

  -- If user entered no data or incorrect data, show error message
  -- &amp; make form invoke same procedure to check input values.

  HTP.FORMOPEN(&#39;HR.associate_name_with_zipcode&#39;, &#39;GET&#39;);
  HTP.PRINT(&#39;&lt;p&gt;Enter your name:&lt;/td&gt;&#39;);

  HTP.PRINT(&#39;&lt;td valign=center&gt;&lt;input type=text name=name value=&#34;&#39; ||
            HTP.ESCAPE_SC(name) || &#39;&#34;&gt;&#39;);

  HTP.PRINT(&#39;&lt;p&gt;Enter your zip code:&lt;/td&gt;&#39;);

  HTP.PRINT(&#39;&lt;td valign=center&gt;&lt;input type=text name=zip value=&#34;&#39; ||
            HTP.ESCAPE_SC(zip) || &#39;&#34;&gt;&#39;);

  HTP.FORMSUBMIT(NULL, &#39;Submit&#39;);
  HTP.FORMCLOSE;
END;
/
</pre></div>
<!-- class="example" --></div>
<!-- class="sect2" -->
<a id="CHECAHEB"></a>
<div id="ADFNS1382" class="sect2">
<h3 class="sect2"><span class="secnum">14.6.4</span> Passing Hidden Parameters from an HTML Form</h3>
<p>One technique for passing information through a sequence of stored subprograms, without requiring the user to specify the same choices each time, is to include hidden parameters in the form that invokes a stored subprogram. The first stored subprogram places information, such as a user name, into the HTML form that it generates. The value of the hidden parameter is passed to the next stored subprogram, as if the user had entered it through a option or entry field.</p>
<p>Other techniques for passing information from one stored subprogram to another include:</p>
<ul>
<li>
<p>Sending a &#34;cookie&#34; containing the persistent information to the browser. The browser then sends this same information back to the server when accessing other web pages from the same site. Cookies are set and retrieved through the HTTP headers that are transferred between the browser and the web server before the HTML text of each web page.</p>
</li>
<li>
<p>Storing the information in the database itself, where later stored subprograms can retrieve it. This technique involves some extra overhead on the database server, and you must still find a way to keep track of each user as multiple users access the server at the same time.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="CHEGBHII"></a>
<div id="ADFNS1383" class="sect2">
<h3 class="sect2"><span class="secnum">14.6.5</span> Uploading a File from an HTML Form</h3>
<p>You can use an HTML form to choose a file on a client system, and transfer it to the server. A stored subprogram can insert the file into the database as a <code dir="ltr">CLOB</code>, <code dir="ltr">BLOB</code>, or other type that can hold large amounts of data.</p>
<p>The PL/SQL Web Toolkit and the PL/SQL gateway have the notion of a &#34;document table&#34; that holds uploaded files.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<span class="italic">mod_plsql User&#39;s Guide</span></div>
</div>
<!-- class="sect2" -->
<a id="CHEIAFEE"></a>
<div id="ADFNS1384" class="sect2">
<h3 class="sect2"><span class="secnum">14.6.6</span> Submitting a Completed HTML Form</h3>
<p>By default, an HTML form must have a <code dir="ltr">Submit</code> button, which transmits the data from the form to a stored subprogram or CGI program. You can label this button with text of your choice, such as &#34;Search&#34;, &#34;Register&#34;, and so on.</p>
<p>You can have multiple forms on the same page, each with its own form elements and <code dir="ltr">Submit</code> button. You can even have forms consisting entirely of hidden parameters, where the user makes no choice other than clicking the button.</p>
<p>Using JavaScript or other scripting languages, you can eliminate the Submit button and have the form submitted in response to some other action, such as selecting from a drop-down list. This technique is best when the user makes a single selection, and the confirmation step of the <code dir="ltr">Submit</code> button is not essential.</p>
</div>
<!-- class="sect2" -->
<a id="CHEHCIHC"></a>
<div id="ADFNS1385" class="sect2">
<h3 class="sect2"><span class="secnum">14.6.7</span> Handling Missing Input from an HTML Form</h3>
<p>When an HTML form is submitted, your stored subprogram receives null parameters for any form elements that are not filled in. For example, null parameters can result from an empty entry field, a set of check boxes, options, or list items with none checked, or a <code dir="ltr">VALUE</code> parameter of &#34;&#34; (empty quotation marks).</p>
<p>Regardless of any validation you do on the client side, use code stored subprograms to handle the possibility that some parameters are null:</p>
<ul>
<li>
<p>Specify an initial value in all parameter declarations, to prevent an exception when the stored subprogram is invoked with a missing form parameter. You can set the initial value to zero for numeric values (when that makes sense), and to <code dir="ltr">NULL</code> when you want to check whether the user specifies a value.</p>
</li>
<li>
<p>Before using an input parameter value that has the initial value <code dir="ltr">NULL</code>, check if it is null.</p>
</li>
<li>
<p>Make the subprogram generate sensible results even when not all input parameters are specified. You might leave some sections out of a report, or display a text string or image in a report to indicate where parameters were not specified.</p>
</li>
<li>
<p>Provide a way to fill in the missing values and run the stored subprogram again, directly from the results page. For example, include a link that invokes the same stored subprogram with an additional parameter, or display the original form with its values filled in as part of the output.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="CHEJBJFE"></a>
<div id="ADFNS1386" class="sect2">
<h3 class="sect2"><span class="secnum">14.6.8</span> Maintaining State Information Between Web Pages</h3>
<p>Web applications are particularly concerned with the idea of <a id="sthref758"></a><a id="sthref759"></a><span class="glossaryterm">state</span>, the set of data that is current at a particular moment in time. It is easy to lose state information when switching from one web page to another, which might result in asking the user to make the same choices repeatedly.</p>
<p>You can pass state information between dynamic web pages using HTML forms. The information is passed as a set of name-value pairs, which are turned into stored subprogram parameters for you.</p>
<p>If the user has to make multiple selections, or one selection from many choices, or it is important to avoid an accidental selection, use an HTML form. After the user makes and reviews all the choices, they confirm the choices with the <code dir="ltr">Submit</code> button. Subsequent pages can use forms with hidden parameters (<code dir="ltr">&lt;INPUT&nbsp;TYPE=HIDDEN&gt;</code> tags) to pass these choices from one page to the next.</p>
<p>If the user is considering one or two choices, or the decision points are scattered throughout the web page, you can save the user from hunting around for the <code dir="ltr">Submit</code> button by representing actions as hyperlinks and including any necessary name-value pairs in the query string (the part after the <code dir="ltr">?</code> within a URL).</p>
<p>An alternative way to main state information is to use Oracle Application Server and its <code dir="ltr">mod_ose</code> module. This approach lets you store state information in package variables that remain available as a user moves around a website.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
The Oracle Application Server documentation set at:
<pre dir="ltr"><a href="http://www.oracle.com/technetwork/indexes/documentation/index.html">http://www.oracle.com/technetwork/indexes/documentation/index.html</a>
</pre></div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1006349"></a>
<div id="ADFNS1387" class="sect1">
<h2 class="sect1"><span class="secnum">14.7</span> Performing Network Operations in PL/SQL Subprograms</h2>
<p>Oracle provides packages that allow PL/SQL subprograms to perform these network operations:</p>
<ul>
<li>
<p><a href="#CHEDDAAG">Sending E-Mail from PL/SQL</a></p>
</li>
<li>
<p><a href="#CHECJHHC">Getting a Host Name or Address from PL/SQL</a></p>
</li>
<li>
<p><a href="#CHEDDABC">Using TCP/IP Connections from PL/SQL</a></p>
</li>
<li>
<p><a href="#CHEFFBFD">Retrieving HTTP URL Contents from PL/SQL</a></p>
</li>
<li>
<p><a href="#CHEEFHAC">Using Tables, Image Maps, Cookies, and CGI Variables from PL/SQL</a></p>
</li>
</ul>
<p class="subhead1"><a id="ADFNS504"></a>Internet Protocol version 6 (IPv6) Support</p>
<p>As of Oracle Database 11<span class="italic">g</span> Release 2 (11.2.0.1), PL/SQL network utility packages support IPv6 addresses. The package interfaces have not changed: Any interface parameter that expects a network host accepts an IPv6 address in string form, and any interface that returns an IP address can return an IPv6 address.</p>
<p>However, applications that use network addresses might need small changes, and recompilation, to accommodate IPv6 addresses. An IPv6 address has 128 bits, while an IPv4 address has 32 bits. In a URL, an IPv6 address must be enclosed in brackets. For example:</p>
<pre dir="ltr">http://<span class="bold">[</span>2001:0db8:85a3:08d3:1319:8a2e:0370:7344<span class="bold">]</span>/
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink NETAG999" href="../NETAG/layers.htm#NETAG999"><span class="italic">Oracle Database Net Services Administrator&#39;s Guide</span></a> for detailed information about IPv6 support in Oracle Database</p>
</li>
<li>
<p><a class="olink ARPLS" href="../ARPLS/toc.htm"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about IPv6 support in specific PL/SQL network utility packages</p>
</li>
</ul>
</div>
<a id="CHEDDAAG"></a>
<div id="ADFNS1388" class="sect2">
<h3 class="sect2"><span class="secnum">14.7.1</span> Sending E-Mail from PL/SQL</h3>
<p>Using the <code dir="ltr">UTL_SMTP</code> package, a PL/SQL subprogram can send e-mail, as in <a href="#CHEDDHCC">Example 14-11</a>.</p>
<div id="ADFNS1389" class="example">
<p class="titleinexample"><a id="CHEDDHCC"></a>Example 14-11 Sending E-Mail from PL/SQL</p>
<pre dir="ltr">CREATE OR REPLACE PROCEDURE send_test_message
IS
  mailhost   VARCHAR2(64) := &#39;mailhost.example.com&#39;;
  sender     VARCHAR2(64) := &#39;me@example.com&#39;;
  recipient  VARCHAR2(64) := &#39;you@example.com&#39;;
  <span class="bold">mail_conn  UTL_SMTP.CONNECTION;</span>
BEGIN
  <span class="bold">mail_conn := UTL_SMTP.OPEN_CONNECTION(mailhost, 25); -- 25 is the port</span>
  <span class="bold">UTL_SMTP.HELO(mail_conn, mailhost);</span>
  <span class="bold">UTL_SMTP.MAIL(mail_conn, sender);</span>
  <span class="bold">UTL_SMTP.RCPT(mail_conn, recipient);</span>
 
  <span class="bold">UTL_SMTP.OPEN_DATA(mail_conn);</span>
  <span class="bold">UTL_SMTP.WRITE_DATA(mail_conn, &#39;This is a test message.&#39; || chr(13));</span>
  <span class="bold">UTL_SMTP.WRITE_DATA(mail_conn, &#39;This is line 2.&#39; || chr(13));</span>
  <span class="bold">UTL_SMTP.CLOSE_DATA(mail_conn);</span>
 
  /* If message were in single string, open_data(), write_data(),
     and close_data() could be in a single call to data(). */
 
  <span class="bold">UTL_SMTP.QUIT(mail_conn);</span>
EXCEPTION
  WHEN OTHERS THEN
   -- Insert error-handling code here
   RAISE;
END;
/
</pre></div>
<!-- class="example" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ARPLS074" href="../ARPLS/u_smtp.htm#ARPLS074"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for detailed information about the <code dir="ltr">UTL_SMTP</code> package</div>
</div>
<!-- class="sect2" -->
<a id="CHECJHHC"></a>
<div id="ADFNS1390" class="sect2">
<h3 class="sect2"><span class="secnum">14.7.2</span> Getting a Host Name or Address from PL/SQL</h3>
<p>Using the <code dir="ltr">UTL_INADDR</code> package, a PL/SQL subprogram can determine the host name of the local system or the IP address of a given host name.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ARPLS071" href="../ARPLS/u_inaddr.htm#ARPLS071"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for detailed information about the <code dir="ltr">UTL_INADDR</code> package</div>
</div>
<!-- class="sect2" -->
<a id="CHEDDABC"></a>
<div id="ADFNS1391" class="sect2">
<h3 class="sect2"><span class="secnum">14.7.3</span> Using TCP/IP Connections from PL/SQL</h3>
<p>Using the <code dir="ltr">UTL_TCP</code> package, a PL/SQL subprogram can open TCP/IP connections to systems on the network, and read or write to the corresponding sockets.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ARPLS075" href="../ARPLS/u_tcp.htm#ARPLS075"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for detailed information about the <code dir="ltr">UTL_TCP</code> package</div>
</div>
<!-- class="sect2" -->
<a id="CHEFFBFD"></a>
<div id="ADFNS1392" class="sect2">
<h3 class="sect2"><span class="secnum">14.7.4</span> Retrieving HTTP URL Contents from PL/SQL</h3>
<p>Using the <code dir="ltr">UTL_HTTP</code> package, a PL/SQL subprogram can:</p>
<ul>
<li>
<p>Retrieve the contents of an HTTP URL</p>
<p>The contents are usually in the form of HTML-tagged text, but might be any kind of file that can be downloaded from a web server (for example, plain text or a JPEG image).</p>
</li>
<li>
<p>Control HTTP session details (such as headers, cookies, redirects, proxy servers, IDs and passwords for protected sites, and CGI parameters)</p>
</li>
<li>
<p>Speed up multiple accesses to the same website, using HTTP 1.1 persistent connections</p>
</li>
</ul>
<p>A PL/SQL subprogram can construct and interpret URLs for use with the <code dir="ltr">UTL_HTTP</code> package by using the functions <code dir="ltr">UTL_URL</code>.<code dir="ltr">ESCAPE</code> and <code dir="ltr">UTL_URL</code>.<code dir="ltr">UNESCAPE</code>.</p>
<p>The PL/SQL procedure in <a href="#CHEFFGBA">Example 14-12</a> uses the <code dir="ltr">UTL_HTTP</code> package to retrieve the contents of an HTTP URL.</p>
<div id="ADFNS1393" class="example">
<p class="titleinexample"><a id="CHEFFGBA"></a>Example 14-12 Retrieving HTTP URL Contents from PL/SQL</p>
<pre dir="ltr">CREATE OR REPLACE PROCEDURE show_url
  (url      IN VARCHAR2,
  username IN VARCHAR2 := NULL,
  password IN VARCHAR2 := NULL)
AS
  <span class="bold">req        UTL_HTTP.REQ;</span>
  <span class="bold">resp       UTL_HTTP.RESP;</span>
  name_      VARCHAR2(256);
  value_     VARCHAR2(1024);
  data_      VARCHAR2(255);
  my_scheme  VARCHAR2(256);
  my_realm   VARCHAR2(256);
  my_proxy   BOOLEAN;
BEGIN
  -- When going through a firewall, pass requests through this host.
  -- Specify sites inside the firewall that do not need the proxy host.
 
  <span class="bold">UTL_HTTP.SET_PROXY(&#39;proxy.example.com&#39;, &#39;corp.example.com&#39;);</span>
 
  -- Ask UTL_HTTP not to raise an exception for 4xx and 5xx status codes,
  -- rather than just returning the text of the error page.
 
  <span class="bold">UTL_HTTP.SET_RESPONSE_ERROR_CHECK(FALSE);</span>
 
  -- Begin retrieving this web page.
 <span class="bold">req := UTL_HTTP.BEGIN_REQUEST(url);</span>
 
  -- Identify yourself.
  --  Some sites serve special pages for particular browsers.
  <span class="bold">UTL_HTTP.SET_HEADER(req, &#39;User-Agent&#39;, &#39;Mozilla/4.0&#39;);</span>
 
  -- Specify user ID and password for pages that require them.
  IF (username IS NOT NULL) THEN
    <span class="bold">UTL_HTTP.SET_AUTHENTICATION(req, username, password);</span>
  END IF;
 
  -- Start receiving the HTML text.
  <span class="bold">resp := UTL_HTTP.GET_RESPONSE(req);</span>
 
  -- Show status codes and reason phrase of response.
  DBMS_OUTPUT.PUT_LINE(&#39;HTTP response status code: &#39; || resp.status_code);
  DBMS_OUTPUT.PUT_LINE
    (&#39;HTTP response reason phrase: &#39; || resp.reason_phrase);
 
  -- Look for client-side error and report it.
  IF (resp.status_code &gt;= 400) AND (resp.status_code &lt;= 499) THEN
 
  -- Detect whether page is password protected
  -- and you didn&#39;t supply the right authorization.
 
  <span class="bold">IF (resp.status_code = UTL_HTTP.HTTP_UNAUTHORIZED) THEN</span>
  <span class="bold">UTL_HTTP.GET_AUTHENTICATION(resp, my_scheme, my_realm, my_proxy);</span>
  IF (my_proxy) THEN
    DBMS_OUTPUT.PUT_LINE(&#39;Web proxy server is protected.&#39;);
    DBMS_OUTPUT.PUT(&#39;Please supply the required &#39; || my_scheme ||
      &#39; authentication username for realm &#39; || my_realm ||
      &#39; for the proxy server.&#39;);
  ELSE
    DBMS_OUTPUT.PUT_LINE(&#39;Web page &#39; || url || &#39; is protected.&#39;);
    DBMS_OUTPUT.PUT(&#39;Please supplied the required &#39; || my_scheme ||
      &#39; authentication username for realm &#39; || my_realm ||
      &#39; for the web page.&#39;);
  END IF;
  ELSE
    DBMS_OUTPUT.PUT_LINE(&#39;Check the URL.&#39;);
  END IF;
 
  <span class="bold">UTL_HTTP.END_RESPONSE(resp);</span>
    RETURN;
 
  -- Look for server-side error and report it.
  ELSIF (resp.status_code &gt;= 500) AND (resp.status_code &lt;= 599) THEN
    DBMS_OUTPUT.PUT_LINE(&#39;Check if the website is up.&#39;);
    <span class="bold">UTL_HTTP.END_RESPONSE(resp);</span>
    RETURN;
  END IF;
 
  -- HTTP header lines contain information about cookies, character sets,
  -- and other data that client and server can use to customize each
  -- session.
 
  <span class="bold">FOR i IN 1..UTL_HTTP.GET_HEADER_COUNT(resp) LOOP</span>
    <span class="bold">UTL_HTTP.GET_HEADER(resp, i, name_, value_);</span>
    DBMS_OUTPUT.PUT_LINE(name_ || &#39;: &#39; || value_);
  END LOOP;
 
  -- Read lines until none are left and an exception is raised.
  LOOP
    <span class="bold">UTL_HTTP.READ_LINE(resp, value_);</span>
    DBMS_OUTPUT.PUT_LINE(value_);
  END LOOP;
EXCEPTION
  <span class="bold">WHEN UTL_HTTP.END_OF_BODY THEN</span>
  <span class="bold">UTL_HTTP.END_RESPONSE(resp);</span>
END;
/
</pre></div>
<!-- class="example" -->
<p>This block shows examples of calls to the procedure in <a href="#CHEFFGBA">Example 14-12</a>, but the URLs are for nonexistent pages. Substitute URLs from your own web server.</p>
<pre dir="ltr">BEGIN
  show_url(&#39;http://www.oracle.com/no-such-page.html&#39;);
  show_url(&#39;http://www.oracle.com/protected-page.html&#39;);
  show_url
    (&#39;http://www.oracle.com/protected-page.html&#39;,&#39;<span class="italic">username</span>&#39;,&#39;<span class="italic">password</span>&#39;);
END;
/
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink ARPLS070" href="../ARPLS/u_http.htm#ARPLS070"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for detailed information about the <code dir="ltr">UTL_HTTP</code> package</p>
</li>
<li>
<p><a class="olink ARPLS073" href="../ARPLS/u_url.htm#ARPLS073"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for detailed information about <code dir="ltr">UTL_URL</code>.<code dir="ltr">ESCAPE</code> and <code dir="ltr">UTL_URL</code>.<code dir="ltr">UNESCAPE</code></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CHEEFHAC"></a>
<div id="ADFNS1394" class="sect2">
<h3 class="sect2"><span class="secnum">14.7.5</span> Using Tables, Image Maps, Cookies, and CGI Variables from PL/SQL</h3>
<p>Using packages supplied by Oracle, and the <code dir="ltr">mod_plsql</code> plug-in of Oracle HTTP Server (OHS), a PL/SQL subprogram can format the results of a query in an HTML table, produce an image map, set and get HTTP cookies, check the values of CGI variables, and perform other typical web operations.</p>
<p>Documentation for these packages is not part of the database documentation library. The location of the documentation depends on your application server. To get started with these packages, look at their subprogram names and parameters using the SQL*Plus <code dir="ltr">DESCRIBE</code> statement:</p>
<pre dir="ltr">DESCRIBE HTP;
DESCRIBE HTF;
DESCRIBE OWA_UTIL;
</pre></div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment286">
<tr>
<td class="cellalignment295">
<table class="cellalignment291">
<tr>
<td class="cellalignment290"><a href="adfns_profiler.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment290"><a href="adfns_cqn.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment298">
<table class="cellalignment289">
<tr>
<td class="cellalignment290"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment290"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment290"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment290"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment290"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment290"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>