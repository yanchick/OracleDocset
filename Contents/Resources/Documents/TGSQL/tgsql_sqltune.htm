<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-106804"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Analyzing%20SQL%20with%20SQL%20Tuning%20Advisor"></a><title>Analyzing SQL with SQL Tuning Advisor</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="SQL Tuning Advisor, about, pluggable databases, pluggable databases and, architecture, controls, input sources, analyses, SQL profiles, Automatic Tuning Optimizer, administering with APIs, DBMS_SQLTUNE package, using, high-load SQL, tuning"/>
<meta name="dcterms.created" content="2017-07-24T09:35:46Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database SQL Tuning Guide"/>
<meta name="dcterms.identifier" content="E49106-14"/>
<meta name="dcterms.isVersionOf" content="TGSQL"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2013, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="tgsql_sts.htm" title="Previous" type="text/html"/>
<link rel="Next" href="tgsql_sqlaccess.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E49106-14.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-8E1A39CB-A491-4254-8B31-9B1DF7B52AA1"></a> <span id="PAGE" style="display:none;">32/40</span> <!-- End Header -->
<a id="TGSQL540"></a>
<h1 id="TGSQL-GUID-8E1A39CB-A491-4254-8B31-9B1DF7B52AA1" class="sect1"><span class="enumeration_chapter">20</span> Analyzing SQL with SQL Tuning Advisor</h1>
<div>
<p>This chapter explains the concepts and tasks relating to SQL Tuning Advisor.</p>
<p>This chapter contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="tgsql_sqltune.htm#GUID-EF47CEF3-E31A-4A2A-8BCE-19DC5F06F458" title="SQL Tuning Advisor is SQL diagnostic software in the Oracle Database Tuning Pack. You can submit one or more SQL statements as input to the advisor and receive advice or recommendations for how to tune the statements, along with a rationale and expected benefit.">About SQL Tuning Advisor</a></p>
</li>
<li>
<p><a href="tgsql_sqltune.htm#GUID-87D3AA10-60CE-4F5B-879B-B2E851874B83" title="By default, the Automatic SQL Tuning task runs for in a nightly maintenance window.Configuring automatic SQL tuning instead of tuning manually decreases cost and increases manageabilityOracle Scheduler uses the automated maintenance tasks infrastructure (known as AutoTask) to schedules tasks to run automatically.This section explains the basic tasks in running SQL Tuning Advisor as an automatic task. You can enable and disable all automatic maintenance tasks, including the Automatic SQL Tuning task, using Cloud Control.If you do not use Cloud Control to enable and disable the Automatic SQL Tuning task, then you must use the command line.You can enable and disable all automatic maintenance tasks, including the Automatic SQL Tuning task, using Cloud Control. You must perform the operation as SYS or have the EXECUTE privilege on the PL/SQL package DBMS_AUTO_SQLTUNE.">Managing the Automatic SQL Tuning Task</a></p>
</li>
<li>
<p><a href="tgsql_sqltune.htm#GUID-F5494CD1-52BB-478E-BB36-17104B36B0FE" title="Automatic Database Diagnostic Monitor (ADDM) automatically identifies high-load SQL statements. If ADDM identifies such statements, then click Schedule/Run SQL Tuning Advisor on the Recommendation Detail page to run SQL Tuning Advisor.This section explains the basic tasks in running SQL Tuning Advisor using the DBMS_SQLTUNE package. To change the parameters of a tuning task after it has been created, execute the DBMS_SQLTUNE.SET_TUNING_TASK_PARAMETER function.">Running SQL Tuning Advisor On Demand</a></p>
</li>
</ul>
</div>
<a id="TGSQL541"></a>
<div class="props_rev_3"><a id="GUID-EF47CEF3-E31A-4A2A-8BCE-19DC5F06F458"></a>
<h2 id="TGSQL-GUID-EF47CEF3-E31A-4A2A-8BCE-19DC5F06F458" class="sect2">About SQL Tuning Advisor</h2>
<div>
<p><span class="bold">SQL Tuning Advisor</span> is SQL diagnostic software in the Oracle Database Tuning Pack. You can submit one or more SQL statements as input to the advisor and receive advice or recommendations for how to tune the statements, along with a rationale and expected benefit.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="tgsql_sqltune.htm#GUID-73AB38C1-A7F6-401E-9010-B4476E173673" title="SQL Tuning Advisor is a mechanism for resolving problems related to suboptimally performing SQL statements.">Purpose of SQL Tuning Advisor</a></p>
</li>
<li>
<p><a href="tgsql_sqltune.htm#GUID-7FAEE001-6FB3-4FA9-93AC-5598F446A15F" title="Automatic Tuning Optimizer is the central tool used by SQL Tuning Advisor. The advisor can receive SQL statements as input from multiple sources, analyze these statements using the optimizer, and then make recommendations.">SQL Tuning Advisor Architecture</a></p>
</li>
<li>
<p><a href="tgsql_sqltune.htm#GUID-26FBDF7C-8A57-4F37-B6FC-5FE7EA65EB5D" title="In tuning mode, the optimizer has more time to consider options and gather statistics.">Automatic Tuning Optimizer Analyses</a></p>
</li>
</ul>
</div>
<a id="TGSQL542"></a>
<div class="props_rev_3"><a id="GUID-73AB38C1-A7F6-401E-9010-B4476E173673"></a>
<h3 id="TGSQL-GUID-73AB38C1-A7F6-401E-9010-B4476E173673" class="sect3">Purpose of SQL Tuning Advisor</h3>
<div>
<p>SQL Tuning Advisor is a mechanism for resolving problems related to suboptimally performing SQL statements.</p>
<p>Use SQL Tuning Advisor to obtain recommendations for improving performance of high-load SQL statements, and prevent regressions by only executing optimal plans.</p>
<p>Tuning recommendations include:</p>
<ul style="list-style-type: disc;">
<li>
<p>Collection of object statistics</p>
</li>
<li>
<p>Creation of indexes</p>
</li>
<li>
<p>Rewriting SQL statements</p>
</li>
<li>
<p>Creation of SQL profiles</p>
</li>
<li>
<p>Creation of SQL plan baselines</p>
</li>
</ul>
<p>The recommendations generated by SQL Tuning Advisor help you achieve the following specific goals:</p>
<ul style="list-style-type: disc;">
<li>
<p>Avoid labor-intensive manual tuning</p>
<p>Identifying and tuning high-load SQL statements is challenging even for an expert. SQL Tuning Advisor uses the optimizer to tune SQL for you.</p>
</li>
<li>
<p>Generate recommendations and implement SQL profiles automatically</p>
<p>You can configure an Automatic SQL Tuning task to run nightly in maintenance windows. When invoked in this way, the advisor can generate recommendations and also implement SQL profiles automatically.</p>
</li>
<li>
<p>Analyze database-generated statistics to achieve optimal plans</p>
<p>The database contains a vast amount of statistics about its own operations. SQL Tuning Advisor can perform deep mining and analysis of internal information to improve execution plans.</p>
</li>
<li>
<p>Enable developers to tune SQL on a test system instead of the production system</p>
<p>When suboptimally performing SQL statements occur on a production database, developers may not want to investigate and tune directly on the production database. The DBA can transport the problematic SQL statements to a test database where the developers can safely analyze and tune them.</p>
</li>
</ul>
<p>When tuning multiple statements, SQL Tuning Advisor does not recognize interdependencies between the statements. Instead, SQL Tuning Advisor offers a convenient way to get tuning recommendations for many statements.</p>
<div class="infobox-note" id="GUID-73AB38C1-A7F6-401E-9010-B4476E173673__GUID-71EFC740-5ED1-48C4-A786-76250A658E86">
<p class="notep1">Note:</p>
<p>Data visibility and privilege requirements may differ when using SQL Tuning Advisor with pluggable databases. The advisor can tune a query in the current pluggable database (PDB), and in other PDBs in which this query has been executed. In this way, a container database (CDB) administrator can tune the same query in many PDBs at the same time, whereas a PDB administrator can only tune a single PDB.</p>
</div>
<div class="infoboxnotealso" id="GUID-73AB38C1-A7F6-401E-9010-B4476E173673__GUID-2B6E48E4-B023-407B-A06C-3CB2DCA6CC35">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="tgsql_spm.htm#GUID-7024369A-F98D-48E4-921C-C899485C954F" title="You can manage SQL plan baselines using the DBMS_SPM package.">Managing SQL Plan Baselines</a>&#34;</span> to learn about SQL plan management</p>
</li>
<li>
<p><a class="olink ADMIN13885" target="_blank" href="../ADMIN/cdb_admin.htm#ADMIN13885"><span><cite>Oracle Database Administrator&rsquo;s Guide</cite></span></a> for a table that summarizes how manageability features work in a CDB</p>
</li>
</ul>
</div>
</div>
</div>
<a id="TGSQL544"></a><a id="TGSQL543"></a>
<div class="props_rev_3"><a id="GUID-7FAEE001-6FB3-4FA9-93AC-5598F446A15F"></a>
<h3 id="TGSQL-GUID-7FAEE001-6FB3-4FA9-93AC-5598F446A15F" class="sect3">SQL Tuning Advisor Architecture</h3>
<div>
<p><span class="bold">Automatic Tuning Optimizer</span> is the central tool used by SQL Tuning Advisor. The advisor can receive SQL statements as input from multiple sources, analyze these statements using the optimizer, and then make recommendations.</p>
<p>Invoking Automatic Tuning Optimizer for every <a href="glossary.htm#GUID-AB764C9E-2F03-49A9-BF8B-36A9FBD03BCE"><span class="xrefglossterm">hard parse</span></a> consumes significant time and resources. Tuning mode is meant for complex and high-load SQL statements that significantly affect database performance.</p>
<p>Manageability advisors such as SQL tuning advisor use a common infrastructure called the advisor framework. This framework provides a common schema and interface for storing task objects. An advisor schema is a set of tables to store the data from advisors. SQL Tuning Advisor receives tuning input, and then writes to the advisor schemas by means of the advisor framework. SQL Tuning Advisor reads data from advisor schema when it produces its reports.</p>
<p>The following figure shows the basic architecture of SQL Tuning Advisor.</p>
<div class="figure" id="GUID-7FAEE001-6FB3-4FA9-93AC-5598F446A15F__CBBFJHEH">
<p class="titleinfigure">Figure 20-1 SQL Tuning Advisor Architecture</p>
<img width="572" height="434" src="img/GUID-C68EB29D-C836-4100-9A51-740F4BAB3468-default.png" alt="Description of Figure 20-1 follows" title="Description of Figure 20-1 follows"/><br/>
<a href="img_text/GUID-C68EB29D-C836-4100-9A51-740F4BAB3468-print.htm">Description of &#34;Figure 20-1 SQL Tuning Advisor Architecture&#34;</a></div>
<!-- class="figure" -->
<div class="infoboxnotealso" id="GUID-7FAEE001-6FB3-4FA9-93AC-5598F446A15F__GUID-85F171DD-490B-4067-8CEC-08AE6EAC504F">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="tgsql_sqlproc.htm#GUID-8CF633B1-EAC4-47C7-9189-C479ADEF1FFA" title="The first stage of SQL processing is parsing.">SQL Parsing</a>&#34;</span></p>
</div>
</div>
<a id="TGSQL545"></a>
<div class="props_rev_3"><a id="GUID-142BD9EB-36B4-4EA6-A9C1-14B9F7D83573"></a>
<h4 id="TGSQL-GUID-142BD9EB-36B4-4EA6-A9C1-14B9F7D83573" class="sect4">Automatic and On-Demand SQL Tuning</h4>
<div>
<p>Configure SQL Tuning Advisor to run automatically using <code class="codeph">DBMS_AUTO_SQLTUNE</code>, or on demand using <code class="codeph">DBMS_SQLTUNE</code>.</p>
<p>The methods of invocation differ as follows:</p>
<ul style="list-style-type: disc;">
<li>
<p>Automatically</p>
<p>You can configure SQL Tuning Advisor to run during nightly system maintenance windows. When run by <code class="codeph">AUTOTASK</code>, the advisor is known as <a href="glossary.htm#GUID-0FCAD63A-F031-4BB5-AC88-0F2E66F34129"><span class="xrefglossterm">Automatic SQL Tuning Advisor</span></a> and performs <a href="glossary.htm#GUID-54B1FE89-3A61-4BB5-ABD0-2CF78FAB9935"><span class="xrefglossterm">automatic SQL tuning</span></a>.</p>
</li>
<li>
<p>On-Demand</p>
<p>In <a href="glossary.htm#GUID-AE3B47BA-428A-435E-8A0C-05E404478475"><span class="xrefglossterm">on-demand SQL tuning</span></a>, you manually invoke SQL Tuning Advisor to diagnose and fix SQL-related performance problems <span class="italic">after</span> they have been discovered. Oracle Enterprise Manager Cloud Control (Cloud Control) is the preferred interface for tuning SQL on demand, but you can also use the <code class="codeph">DBMS_SQLTUNE</code> PL/SQL package.</p>
</li>
</ul>
<p>SQL Tuning Advisor uses Automatic Tuning Optimizer to perform its analysis. This optimization is &#34;automatic&#34; because the optimizer analyzes the SQL instead of the user. Do not confuse Automatic Tuning Optimizer with automatic SQL tuning, which in this document refers <span class="italic">only</span> to the work performed by the Automatic SQL Tuning task.</p>
<div class="infoboxnotealso" id="GUID-142BD9EB-36B4-4EA6-A9C1-14B9F7D83573__GUID-6FB5A1F0-5F3B-4B17-8C1D-9253C8E23465">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="tgsql_sqltune.htm#GUID-F5494CD1-52BB-478E-BB36-17104B36B0FE" title="Automatic Database Diagnostic Monitor (ADDM) automatically identifies high-load SQL statements. If ADDM identifies such statements, then click Schedule/Run SQL Tuning Advisor on the Recommendation Detail page to run SQL Tuning Advisor.This section explains the basic tasks in running SQL Tuning Advisor using the DBMS_SQLTUNE package. To change the parameters of a tuning task after it has been created, execute the DBMS_SQLTUNE.SET_TUNING_TASK_PARAMETER function.">Running SQL Tuning Advisor On Demand</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="tgsql_sqltune.htm#GUID-87D3AA10-60CE-4F5B-879B-B2E851874B83" title="By default, the Automatic SQL Tuning task runs for in a nightly maintenance window.Configuring automatic SQL tuning instead of tuning manually decreases cost and increases manageabilityOracle Scheduler uses the automated maintenance tasks infrastructure (known as AutoTask) to schedules tasks to run automatically.This section explains the basic tasks in running SQL Tuning Advisor as an automatic task. You can enable and disable all automatic maintenance tasks, including the Automatic SQL Tuning task, using Cloud Control.If you do not use Cloud Control to enable and disable the Automatic SQL Tuning task, then you must use the command line.You can enable and disable all automatic maintenance tasks, including the Automatic SQL Tuning task, using Cloud Control. You must perform the operation as SYS or have the EXECUTE privilege on the PL/SQL package DBMS_AUTO_SQLTUNE.">Managing the Automatic SQL Tuning Task</a>&#34;</span></p>
</li>
<li>
<p><a class="olink ARPLS220" target="_blank" href="../ARPLS/d_sqltun.htm#ARPLS220"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about <code class="codeph">DBMS_SQLTUNE</code></p>
</li>
</ul>
</div>
</div>
</div>
<a id="TGSQL546"></a>
<div class="props_rev_3"><a id="GUID-A6419DB4-DBF5-43A3-89DF-F0DE74E58D4C"></a>
<h4 id="TGSQL-GUID-A6419DB4-DBF5-43A3-89DF-F0DE74E58D4C" class="sect4">Input to SQL Tuning Advisor</h4>
<div>
<p>Input for SQL Tuning Advisor can come from several sources, including ADDM, AWR, the shared SQL area, and SQL tuning sets.</p>
<p>SQL Tuning Advisor uses its input sources as follows:</p>
<ul style="list-style-type: disc;">
<li>
<p>Automatic Database Diagnostic Monitor (ADDM)</p>
<p>The primary input source for SQL Tuning Advisor is ADDM (pronounced <span class="italic">Adam</span>). By default, ADDM runs proactively once every hour. To identify performance problems involving high-load SQL statements, ADDM analyzes key statistics gathered by <a href="glossary.htm#GUID-91E88F5F-4220-4B1A-8578-CCFF27FBBCA9"><span class="xrefglossterm">Automatic Workload Repository (AWR)</span></a> over the last hour . If a high-load SQL statement is identified, then ADDM recommends running SQL Tuning Advisor on the SQL.</p>
</li>
<li>
<p>AWR</p>
<p>AWR takes regular snapshots of system activity, including high-load SQL statements ranked by relevant statistics, such as CPU consumption and wait time.</p>
<p>You can view the AWR and manually identify high-load SQL statements. You can run SQL Tuning Advisor on these statements, although Oracle Database automatically performs this work as part of automatic SQL tuning. By default, AWR retains data for the last eight days. You can locate and tune any high-load SQL that ran within the retention period of AWR using this technique.</p>
</li>
<li>
<p>Shared SQL area</p>
<p>The database uses the shared SQL area to tune recent SQL statements that have yet to be captured in AWR. The shared SQL area and AWR provide the capability to identify and tune high-load SQL statements from the current time going as far back as the AWR retention allows, which by default is at least 8 days.</p>
</li>
<li>
<p>SQL tuning set</p>
<p>A <a href="glossary.htm#GUID-52FB0AE5-7346-44E5-BE92-3C09385B1DDC"><span class="xrefglossterm">SQL tuning set (STS)</span></a> is a database object that stores SQL statements along with their execution context. An STS can include SQL statements that are yet to be deployed, with the goal of measuring their individual performance, or identifying the ones whose performance falls short of expectation. When a set of SQL statements serve as input, the database must first construct and use an STS.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-A6419DB4-DBF5-43A3-89DF-F0DE74E58D4C__GUID-4FC8865D-9D68-45E6-B971-6E611F0D1E38">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p>See <span class="q">&#34;<a href="tgsql_sts.htm#GUID-DD136837-9921-4C73-ABB8-9F1DC22542C5" title="A SQL tuning set (STS) is a database object that you can use as input to tuning tools.">About SQL Tuning Sets</a>&#34;</span></p>
</li>
<li>
<p>See <a class="olink TGDBA026" target="_blank" href="../TGDBA/pfgrf_diag.htm#TGDBA026"><span class="italic">Oracle Database Performance Tuning Guide</span></a> to learn about ADDM</p>
</li>
<li>
<p>See <a class="olink TGDBA169" target="_blank" href="../TGDBA/gather_stats.htm#TGDBA169"><span class="italic">Oracle Database Performance Tuning Guide</span></a> to learn about AWR</p>
</li>
<li>
<p>See <a class="olink CNCPT1228" target="_blank" href="../CNCPT/memory.htm#CNCPT1228"><span class="italic">Oracle Database Concepts</span></a> to learn about the shared SQL area</p>
</li>
</ul>
</div>
</div>
</div>
<a id="TGSQL547"></a>
<div class="props_rev_3"><a id="GUID-3EDB2F66-5AF9-4A49-9D16-06B9C626D11C"></a>
<h4 id="TGSQL-GUID-3EDB2F66-5AF9-4A49-9D16-06B9C626D11C" class="sect4">Output of SQL Tuning Advisor</h4>
<div>
<p>After analyzing the SQL statements, SQL Tuning Advisor publishes recommendations.</p>
<p>Specifically, SQL Tuning Advisor produces the following types of output:</p>
<ul style="list-style-type: disc;">
<li>
<p>Advice on optimizing the execution plan</p>
</li>
<li>
<p>Rationale for the proposed optimization</p>
</li>
<li>
<p>Estimated performance benefit</p>
</li>
<li>
<p>SQL statement to implement the advice</p>
</li>
</ul>
<p>The benefit percentage shown for each recommendation is calculated using the following formula:</p>
<pre dir="ltr">abnf% = (time_old - time_new)/(time_old)
</pre>
<p>For example, assume that before tuning the execution time was 100 seconds, and after implementing the recommendation the new execution time is expected to be 33 seconds. This benefit calculation for this performance improvement is as follows:</p>
<pre dir="ltr">67% = (100 - 33)/(100)
</pre>
<p>You choose whether to accept the recommendations to optimize the SQL statements. Depending on how it is configured, Automatic SQL Tuning Advisor can implement the SQL profile recommendations to tune the statement <span class="italic">without</span> user intervention. When invoked on demand, SQL Tuning Advisor can recommend that the user implement a SQL profile, but can never implement it automatically.</p>
</div>
</div>
</div>
<a id="TGSQL548"></a>
<div class="props_rev_3"><a id="GUID-26FBDF7C-8A57-4F37-B6FC-5FE7EA65EB5D"></a>
<h3 id="TGSQL-GUID-26FBDF7C-8A57-4F37-B6FC-5FE7EA65EB5D" class="sect3">Automatic Tuning Optimizer Analyses</h3>
<div>
<p>In tuning mode, the optimizer has more time to consider options and gather statistics.</p>
<p>For example, Automatic Tuning Optimizer can use <a href="glossary.htm#GUID-453737A7-931A-49D1-AA5C-AFB14D9837FB"><span class="xrefglossterm">dynamic statistics</span></a> and partial statement execution. The following graphic depicts different types of Automatic Tuning Optimizer analyses.</p>
<div class="figure" id="GUID-26FBDF7C-8A57-4F37-B6FC-5FE7EA65EB5D__GUID-9EE1283A-354E-4F46-B920-973103AB3D69">
<p class="titleinfigure">Figure 20-2 Automatic Tuning Optimizer</p>
<img width="338" height="422" src="img/GUID-B842E007-1E70-44D7-A468-685C7A3B4540-default.png" alt="Description of Figure 20-2 follows" title="Description of Figure 20-2 follows"/><br/>
<a href="img_text/GUID-B842E007-1E70-44D7-A468-685C7A3B4540-print.htm">Description of &#34;Figure 20-2 Automatic Tuning Optimizer&#34;</a></div>
<!-- class="figure" -->
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="tgsql_sqltune.htm#GUID-CB843CA1-6160-4918-BC71-86E36775EF15" title="The optimizer relies on object statistics to generate execution plans. If these statistics are stale or missing, then the optimizer can generate suboptimal plans. Automatic Tuning Optimizer checks each query object for missing or stale statistics, and recommends gathering fresh statistics if needed.">Statistical Analysis</a></p>
</li>
<li>
<p><a href="tgsql_sqltune.htm#GUID-93AEDB23-107C-4357-8D7E-2BDE3D1893DF" title="SQL profiling is the verification by the Automatic Tuning Optimizer of its own estimates.">SQL Profiling</a></p>
</li>
<li>
<p><a href="tgsql_sqltune.htm#GUID-6677340C-7DB3-4F0E-9921-46687E5EDC78" title="An access path is the means by which the database retrieves data.">Access Path Analysis</a></p>
</li>
<li>
<p><a href="tgsql_sqltune.htm#GUID-982EB0FC-AADD-4741-B0AA-79005C3AF657" title="During structural analysis, Automatic Tuning Optimizer tries to identify syntactic, semantic, or design problems that can lead to suboptimal performance. The goal is to identify poorly written SQL statements and to advise you how to restructure them.">SQL Structural Analysis</a></p>
</li>
<li>
<p><a href="tgsql_sqltune.htm#GUID-2ECAA5D1-A87A-4092-ABF1-575723AC904E" title="While tuning a SQL statement, SQL Tuning Advisor searches real-time and historical performance data for alternative execution plans for the statement.">Alternative Plan Analysis</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-26FBDF7C-8A57-4F37-B6FC-5FE7EA65EB5D__GUID-36D4F84E-2FF1-487C-920C-655DB94445A7">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="tgsql_optcncpt.htm#GUID-06129ACE-36B2-4534-AE68-EDFCAEBB3B5D" title="A solid understanding of the optimizer is essential for SQL tuning.">Query Optimizer Concepts</a>&#34;</span></p>
</div>
</div>
<a id="TGSQL550"></a><a id="TGSQL549"></a>
<div class="props_rev_3"><a id="GUID-CB843CA1-6160-4918-BC71-86E36775EF15"></a>
<h4 id="TGSQL-GUID-CB843CA1-6160-4918-BC71-86E36775EF15" class="sect4">Statistical Analysis</h4>
<div>
<p>The optimizer relies on object statistics to generate execution plans. If these statistics are stale or missing, then the optimizer can generate suboptimal plans. Automatic Tuning Optimizer checks each query object for missing or stale statistics, and recommends gathering fresh statistics if needed.</p>
<p>The following graphic depicts the process of statistical analysis.</p>
<div class="figure" id="GUID-CB843CA1-6160-4918-BC71-86E36775EF15__CBBEBDHJ">
<p class="titleinfigure">Figure 20-3 Statistical Analysis by Automatic Tuning Optimizer</p>
<img width="501" height="383" src="img/GUID-393CE047-E82A-4AAA-8CDF-B09012ECECF0-default.png" alt="Description of Figure 20-3 follows" title="Description of Figure 20-3 follows"/><br/>
<a href="img_text/GUID-393CE047-E82A-4AAA-8CDF-B09012ECECF0-print.htm">Description of &#34;Figure 20-3 Statistical Analysis by Automatic Tuning Optimizer&#34;</a></div>
<!-- class="figure" --></div>
</div>
<a id="TGSQL551"></a>
<div class="props_rev_3"><a id="GUID-93AEDB23-107C-4357-8D7E-2BDE3D1893DF"></a>
<h4 id="TGSQL-GUID-93AEDB23-107C-4357-8D7E-2BDE3D1893DF" class="sect4">SQL Profiling</h4>
<div>
<p><span class="bold">SQL profiling</span> is the verification by the Automatic Tuning Optimizer of its own estimates.</p>
<p>By reviewing execution history and testing the SQL, the optimizer can ensure that it has the most accurate information available to generate execution plans. SQL profiling is related to but distinct from the steps of generating SQL Tuning Advisor recommendations and implementing these recommendations.</p>
<p>The following graphic shows SQL Tuning Advisor recommending a SQL profile and automatically implementing it. After creating the profile, the optimizer can use it as additional input when generating execution plans.</p>
<div class="figure" id="GUID-93AEDB23-107C-4357-8D7E-2BDE3D1893DF__GUID-9BFFA2AA-0DAA-4815-8149-5D5415956A57">
<p class="titleinfigure">Figure 20-4 SQL Profile</p>
<img width="608" height="474" src="img/GUID-AEE97954-92F7-479F-946C-562DC0323B24-default.png" alt="Description of Figure 20-4 follows" title="Description of Figure 20-4 follows"/><br/>
<a href="img_text/GUID-AEE97954-92F7-479F-946C-562DC0323B24-print.htm">Description of &#34;Figure 20-4 SQL Profile&#34;</a></div>
<!-- class="figure" -->
<div class="infoboxnotealso" id="GUID-93AEDB23-107C-4357-8D7E-2BDE3D1893DF__GUID-22AA1584-9F53-4DB2-B427-3C9D3ADCED95">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="tgsql_profiles.htm#GUID-1AC3C45E-331A-4016-8FE8-7FEFFD8D7220" title="A SQL profile is a database object that contains auxiliary statistics specific to a SQL statement.">About SQL Profiles</a>&#34;</span></p>
</div>
</div>
<a id="TGSQL552"></a>
<div class="props_rev_3"><a id="GUID-B84B0C81-BE65-41B5-A526-F2305B8EB997"></a>
<h5 id="TGSQL-GUID-B84B0C81-BE65-41B5-A526-F2305B8EB997" class="sect5">How SQL Profiling Works</h5>
<div>
<p>The database can profile some DML and DDL statements.</p>
<p>Specifically, SQL Tuning Advisor can profile the following types of statement:</p>
<ul style="list-style-type: disc;">
<li>
<p>DML statements (<code class="codeph">SELECT</code>, <code class="codeph">INSERT</code> with a <code class="codeph">SELECT</code> clause, <code class="codeph">UPDATE</code>, <code class="codeph">DELETE</code>, and the update or insert operations of <code class="codeph">MERGE</code>)</p>
</li>
<li>
<p><code class="codeph">CREATE TABLE</code> statements (only with the <code class="codeph">AS SELECT</code> clause)</p>
</li>
</ul>
<p>After performing its analysis, SQL Tuning Advisor either recommends or does not recommend implementing a SQL profile.</p>
<p>The following graphic shows the SQL profiling process.</p>
<div class="figure" id="GUID-B84B0C81-BE65-41B5-A526-F2305B8EB997__GUID-088D128E-AF42-4770-A9C8-30EDF9E185AA">
<p class="titleinfigure">Figure 20-5 SQL Profiling</p>
<img width="438" height="417" src="img/GUID-45259453-0781-4448-B755-E37BB902D8CB-default.png" alt="Description of Figure 20-5 follows" title="Description of Figure 20-5 follows"/><br/>
<a href="img_text/GUID-45259453-0781-4448-B755-E37BB902D8CB-print.htm">Description of &#34;Figure 20-5 SQL Profiling&#34;</a></div>
<!-- class="figure" -->
<p>During SQL profiling, the optimizer verifies cost, <a href="glossary.htm#GUID-36E411B8-9558-4655-844A-B2EC45FDDFA7"><span class="xrefglossterm">selectivity</span></a>, and <a href="glossary.htm#GUID-FE541AF8-DCAB-4B00-8015-04BDCB295A85"><span class="xrefglossterm">cardinality</span></a> for a statement. The optimizer uses either of the following methods:</p>
<ul style="list-style-type: disc;">
<li>
<p>Samples the data and applies appropriate predicates to the sample</p>
<p>The optimizer compares the new estimate to the regular estimate and, if the difference is great enough, applies a correction factor.</p>
</li>
<li>
<p>Executes a fragment of the SQL statement</p>
<p>This method is more efficient than the sampling method when the predicates provide efficient access paths.</p>
</li>
</ul>
<p>The optimizer uses the past statement execution history to determine correct settings. For example, if the history indicates that a SQL statement is usually executed only partially, then the optimizer uses <code class="codeph">FIRST_ROWS</code> instead of <code class="codeph">ALL_ROWS</code> optimization.</p>
<div class="infoboxnotealso" id="GUID-B84B0C81-BE65-41B5-A526-F2305B8EB997__GUID-F82E1525-DC38-417D-8F00-588CEC171243">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="tgsql_influence.htm#GUID-2D3EEFD3-C4C6-4D2F-B24A-8DC0C1E1CBA1" title="The optimizer goal is the prioritization of resource usage by the optimizer.">Choosing an Optimizer Goal</a>&#34;</span></p>
</div>
</div>
</div>
<a id="TGSQL554"></a><a id="TGSQL553"></a>
<div class="props_rev_3"><a id="GUID-A32EACFC-71CD-4476-A7D5-F7CFDF2A842D"></a>
<h5 id="TGSQL-GUID-A32EACFC-71CD-4476-A7D5-F7CFDF2A842D" class="sect5">SQL Profile Implementation</h5>
<div>
<p>If the optimizer generates auxiliary information during statistical analysis or SQL profiling, then the optimizer recommends implementing a SQL profile.</p>
<p>As shown in <a href="tgsql_sqltune.htm#GUID-A32EACFC-71CD-4476-A7D5-F7CFDF2A842D__CBBFBIEC">Figure 20-6</a>, the following options are possible:</p>
<ul style="list-style-type: disc;">
<li>
<p>When SQL Tuning Advisor is run on demand, the user must choose whether to implement the SQL profile.</p>
</li>
<li>
<p>When the Automatic SQL Tuning task is configured to implement SQL profiles automatically, advisor behavior depends on the setting of the <code class="codeph">ACCEPT_SQL_PROFILE</code> tuning task parameter (see <span class="q">&#34;<a href="tgsql_sqltune.htm#GUID-8B77491E-9E9A-4E44-9F2A-DFA164C4B074">Configuring the Automatic SQL Tuning Task Using the Command Line</a>&#34;</span>):</p>
<ul style="list-style-type: disc;">
<li>
<p>If set to <code class="codeph">true</code>, then the advisor implements SQL profiles automatically.</p>
</li>
<li>
<p>If set to <code class="codeph">false</code>, then user intervention is required.</p>
</li>
<li>
<p>If set to <code class="codeph">AUTO</code> (default), then the setting is <code class="codeph">true</code> when at least one SQL statement exists with a SQL profile, and <code class="codeph">false</code> when this condition is not satisfied.</p>
</li>
</ul>
<div class="infobox-note" id="GUID-A32EACFC-71CD-4476-A7D5-F7CFDF2A842D__GUID-50132F40-1CEC-488A-908B-4559AF73C9A3">
<p class="notep1">Note:</p>
<p>The Automatic SQL Tuning task cannot automatically create SQL plan baselines or add plans to them (see <span class="q">&#34;<a href="tgsql_spm.htm#GUID-3AB2B2F2-A7CD-404C-A36D-8CB5AD5A78B4" title="In general, SQL plan evolution is the process by which the optimizer verifies new plans and adds them to an existing SQL plan baseline.">Plan Evolution</a>&#34;</span>).</p>
</div>
</li>
</ul>
<div class="figure" id="GUID-A32EACFC-71CD-4476-A7D5-F7CFDF2A842D__CBBFBIEC">
<p class="titleinfigure">Figure 20-6 Implementing SQL Profiles</p>
<img width="638" height="212" src="img/GUID-2BBF2805-74E5-4E66-ADB3-7A0FAB313367-default.png" alt="Description of Figure 20-6 follows" title="Description of Figure 20-6 follows"/><br/>
<a href="img_text/GUID-2BBF2805-74E5-4E66-ADB3-7A0FAB313367-print.htm">Description of &#34;Figure 20-6 Implementing SQL Profiles&#34;</a></div>
<!-- class="figure" -->
<p>At any time during or after automatic SQL tuning, you can view a report. This report describes in detail the SQL statements that were analyzed, the recommendations generated, and any SQL profiles that were automatically implemented.</p>
<div class="infoboxnotealso" id="GUID-A32EACFC-71CD-4476-A7D5-F7CFDF2A842D__GUID-A322DA20-8C69-482B-A92A-59851705FD90">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="tgsql_profiles.htm#GUID-1AC3C45E-331A-4016-8FE8-7FEFFD8D7220" title="A SQL profile is a database object that contains auxiliary statistics specific to a SQL statement.">About SQL Profiles</a>&#34;</span></p>
</div>
</div>
</div>
</div>
<a id="TGSQL555"></a>
<div class="props_rev_3"><a id="GUID-6677340C-7DB3-4F0E-9921-46687E5EDC78"></a>
<h4 id="TGSQL-GUID-6677340C-7DB3-4F0E-9921-46687E5EDC78" class="sect4">Access Path Analysis</h4>
<div>
<p>An <span class="bold">access path</span> is the means by which the database retrieves data.</p>
<p>For example, a query using an index and a query using a full table scan use different <span>access paths</span>. In some cases, indexes can greatly enhance the performance of a SQL statement by eliminating full table scans. The following graphic illustrates access path analysis.</p>
<div class="figure" id="GUID-6677340C-7DB3-4F0E-9921-46687E5EDC78__GUID-65AAECD4-F3BB-401F-998D-DBCE71F7FAA4">
<p class="titleinfigure">Figure 20-7 Access Path Analysis</p>
<img width="387" height="422" src="img/GUID-AC629762-3AD2-4CD1-AB90-BA6099EB0FF0-default.png" alt="Description of Figure 20-7 follows" title="Description of Figure 20-7 follows"/><br/>
<a href="img_text/GUID-AC629762-3AD2-4CD1-AB90-BA6099EB0FF0-print.htm">Description of &#34;Figure 20-7 Access Path Analysis&#34;</a></div>
<!-- class="figure" -->
<p>Automatic Tuning Optimizer explores whether a new index can significantly enhance query performance and recommends either of the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>Creating an index</p>
<p>Index recommendations are specific to the SQL statement processed by SQL Tuning Advisor. Sometimes a new index provides a quick solution to the performance problem associated with a single SQL statement.</p>
</li>
<li>
<p>Running SQL Access Advisor</p>
<p>Because the Automatic Tuning Optimizer does not analyze how its index recommendation can affect the entire SQL workload, it also recommends running SQL Access Advisor on the SQL statement along with a representative SQL workload. SQL Access Advisor examines the effect of creating an index on the SQL workload before making recommendations.</p>
</li>
</ul>
</div>
</div>
<a id="TGSQL557"></a><a id="TGSQL556"></a>
<div class="props_rev_3"><a id="GUID-982EB0FC-AADD-4741-B0AA-79005C3AF657"></a>
<h4 id="TGSQL-GUID-982EB0FC-AADD-4741-B0AA-79005C3AF657" class="sect4">SQL Structural Analysis</h4>
<div>
<p>During structural analysis, Automatic Tuning Optimizer tries to identify syntactic, semantic, or design problems that can lead to suboptimal performance. The goal is to identify poorly written SQL statements and to advise you how to restructure them.</p>
<p>The following graphic illustrates structural analysis.</p>
<div class="figure" id="GUID-982EB0FC-AADD-4741-B0AA-79005C3AF657__CBBCFECA">
<p class="titleinfigure">Figure 20-8 Structural Analysis</p>
<img width="383" height="357" src="img/GUID-E03096B3-C3CC-4785-90CA-C1A53A3E2BC0-default.png" alt="Description of Figure 20-8 follows" title="Description of Figure 20-8 follows"/><br/>
<a href="img_text/GUID-E03096B3-C3CC-4785-90CA-C1A53A3E2BC0-print.htm">Description of &#34;Figure 20-8 Structural Analysis&#34;</a></div>
<!-- class="figure" -->
<p>Some syntax variations negatively affect performance. In structural analysis, the automatic tuning optimizer evaluates statements against a set of rules, identifies inefficient coding techniques, and recommends an alternative statement if possible.</p>
<p>As shown in <a href="tgsql_sqltune.htm#GUID-982EB0FC-AADD-4741-B0AA-79005C3AF657__CBBCFECA">Figure 20-8</a>, Automatic Tuning Optimizer identifies the following categories of structural problems:</p>
<ul style="list-style-type: disc;">
<li>
<p>Inefficient use of SQL constructors</p>
<p>A suboptimally performing statement may be using <code class="codeph">NOT IN</code> instead of <code class="codeph">NOT EXISTS</code>, or <code class="codeph">UNION</code> instead of <code class="codeph">UNION ALL</code>. The <code class="codeph">UNION</code> operator, as opposed to the <code class="codeph">UNION ALL</code> operator, uses a unique sort to ensure that no duplicate rows are in the result set. If you know that two queries do not return duplicates, then use <code class="codeph">UNION ALL</code>.</p>
</li>
<li>
<p>Data type mismatches</p>
<p>If the indexed column and the compared value have a data type mismatch, then the database does not use the index because of the implicit data type conversion. Also, the database must expend additional resources converting data types, and some SQL statements may fail because data values do not convert correctly. Common mistakes include columns that contain numeric data but are never used for arithmetic operations: telephone numbers, credit card numbers, and check numbers. To avoid poor cardinality estimates, suboptimal plans, and <code class="codeph">ORA-01722</code> errors, developers must ensure that bind variables are type <code class="codeph">VARCHAR2</code> and not numbers.</p>
</li>
<li>
<p>Design mistakes</p>
<p>A classic example of a design mistake is a missing join condition. If <span class="italic">n</span> is the number of tables in a query block, then <span class="italic">n</span>-1 join conditions must exist to avoid a Cartesian product.</p>
</li>
</ul>
<p>In each case, Automatic Tuning Optimizer makes relevant suggestions to restructure the statements. The suggested alternative statement is similar, but not equivalent, to the original statement. For example, the suggested statement may use <code class="codeph">UNION ALL</code> instead of <code class="codeph">UNION</code>. You can then determine if the advice is sound.</p>
</div>
</div>
<a id="TGSQL559"></a><a id="TGSQL560"></a><a id="TGSQL558"></a>
<div class="props_rev_3"><a id="GUID-2ECAA5D1-A87A-4092-ABF1-575723AC904E"></a>
<h4 id="TGSQL-GUID-2ECAA5D1-A87A-4092-ABF1-575723AC904E" class="sect4">Alternative Plan Analysis</h4>
<div>
<p>While tuning a SQL statement, SQL Tuning Advisor searches real-time and historical performance data for <span class="bold">alternative execution plans</span> for the statement.</p>
<p>If plans other than the original plan exist, then SQL Tuning Advisor reports an alternative plan finding. The follow graphic shows SQL Tuning Advisor finding two alternative plans and generating an alternative plan finding.</p>
<div class="figure" id="GUID-2ECAA5D1-A87A-4092-ABF1-575723AC904E__GUID-2D699B7C-1885-43A1-B0EC-1CE795CD674E">
<p class="titleinfigure">Figure 20-9 Alternative Plan Analysis</p>
<img width="494" height="435" src="img/GUID-B6E7A33C-C4B7-4961-BA49-E9EE1025B78E-default.png" alt="Description of Figure 20-9 follows" title="Description of Figure 20-9 follows"/><br/>
<a href="img_text/GUID-B6E7A33C-C4B7-4961-BA49-E9EE1025B78E-print.htm">Description of &#34;Figure 20-9 Alternative Plan Analysis&#34;</a></div>
<!-- class="figure" -->
<p>SQL Tuning Advisor validates the alternative execution plans and notes any plans that are not reproducible. When reproducible alternative plans are found, you can create a SQL plan baseline to instruct the optimizer to choose these plans in the future.</p>
<div class="example" id="GUID-2ECAA5D1-A87A-4092-ABF1-575723AC904E__CBBDCGDH">
<p class="titleinexample">Example 20-1 Alternative Plan Finding</p>
<p>The following example shows an alternative plan finding for a <code class="codeph">SELECT</code> statement:</p>
<pre dir="ltr">2- Alternative Plan Finding
---------------------------
  Some alternative execution plans for this statement were found by searching
  the system&#39;s real-time and historical performance data.
 
  The following table lists these plans ranked by their average elapsed time.
  See section &#34;ALTERNATIVE PLANS SECTION&#34; for detailed information on each
  plan.
 
  id plan hash  last seen            elapsed (s)  origin          note
  -- ---------- -------------------- ------------ --------------- ----------------
   1 1378942017  2009-02-05/23:12:08        0.000 Cursor Cache    original plan
   2 2842999589  2009-02-05/23:12:08        0.002 STS
 
  Information
  -----------
  - The Original Plan appears to have the best performance, based on the
    elapsed time per execution.  However, if you know that one alternative
    plan is better than the Original Plan, you can create a SQL plan baseline
    for it. This will instruct the Oracle optimizer to pick it over any other
    choices in the future.
    execute dbms_sqltune.create_sql_plan_baseline(task_name =&gt; &#39;TASK_XXXXX&#39;,
            object_id =&gt; 2, task_owner =&gt; &#39;SYS&#39;, plan_hash =&gt; xxxxxxxx);
</pre>
<p>The preceding example shows that SQL Tuning Advisor found two plans, one in the shared SQL area and one in a SQL tuning set. The plan in the shared SQL area is the same as the original plan.</p>
<p>SQL Tuning Advisor only recommends an alternative plan if the elapsed time of the original plan is worse than alternative plans. In this case, SQL Tuning Advisor recommends that users create a SQL plan baseline on the plan with the best performance. In <a href="tgsql_sqltune.htm#GUID-2ECAA5D1-A87A-4092-ABF1-575723AC904E__CBBDCGDH">Example 20-1</a>, the alternative plan did not perform as well as the original plan, so SQL Tuning Advisor did not recommend using the alternative plan.</p>
</div>
<!-- class="example" -->
<div class="example" id="GUID-2ECAA5D1-A87A-4092-ABF1-575723AC904E__CBBBBDEB">
<p class="titleinexample">Example 20-2 Alternative Plans Section</p>
<p>In this example, the alternative plans section of the SQL Tuning Advisor output includes both the original and alternative plans and summarizes their performance. The most important statistic is elapsed time. The original plan used an index, whereas the alternative plan used a full table scan, increasing elapsed time by .002 seconds.</p>
<pre dir="ltr">Plan 1
------
 
  Plan Origin                 :Cursor Cache
  Plan Hash Value             :1378942017
  Executions                  :50
  Elapsed Time                :0.000 sec
  CPU Time                    :0.000 sec
  Buffer Gets                 :0
  Disk Reads                  :0
  Disk Writes                 :0
 
Notes:
  1. Statistics shown are averaged over multiple executions.
  2. The plan matches the original plan.
 
--------------------------------------------
| Id  | Operation            | Name        |
--------------------------------------------
|   0 | SELECT STATEMENT     |             |
|   1 |  SORT AGGREGATE      |             |
|   2 |   MERGE JOIN         |             |
|   3 |    INDEX FULL SCAN   | TEST1_INDEX |
|   4 |    SORT JOIN         |             |
|   5 |     TABLE ACCESS FULL| TEST        |
--------------------------------------------
 
Plan 2
------
 
  Plan Origin                 :STS
  Plan Hash Value             :2842999589
  Executions                  :10
  Elapsed Time                :0.002 sec
  CPU Time                    :0.002 sec
  Buffer Gets                 :3
  Disk Reads                  :0
  Disk Writes                 :0
 
Notes:
  1. Statistics shown are averaged over multiple executions.
 
-------------------------------------
| Id  | Operation           | Name  | 
-------------------------------------
|   0 | SELECT STATEMENT    |       |
|   1 |  SORT AGGREGATE     |       |
|   2 |   HASH JOIN         |       |
|   3 |    TABLE ACCESS FULL| TEST  |
|   4 |    TABLE ACCESS FULL| TEST1 |
-------------------------------------
</pre>
<p>To adopt an alternative plan regardless of whether SQL Tuning Advisor recommends it, call <code class="codeph">DBMS_SQLTUNE.CREATE_SQL_PLAN_BASELINE</code>. You can use this procedure to create a SQL plan baseline on any existing reproducible plan.</p>
<div class="infoboxnotealso" id="GUID-2ECAA5D1-A87A-4092-ABF1-575723AC904E__GUID-3320AAFD-4616-4E00-B733-6AFEBD9F5703">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="tgsql_spm.htm#GUID-27C85EB8-C4CE-40C5-B99C-F4ADDC09A617" title="Both SQL profiles and SQL plan baselines help improve the performance of SQL statements by ensuring that the optimizer uses only optimal plans.">Differences Between SQL Plan Baselines and SQL Profiles</a>&#34;</span></p>
</div>
</div>
<!-- class="example" --></div>
</div>
</div>
</div>
<a id="TGSQL561"></a>
<div class="props_rev_3"><a id="GUID-87D3AA10-60CE-4F5B-879B-B2E851874B83"></a>
<h2 id="TGSQL-GUID-87D3AA10-60CE-4F5B-879B-B2E851874B83" class="sect2">Managing the Automatic SQL Tuning Task</h2>
<div>
<p>When your goal is to identify SQL performance problems proactively, configuring SQL Tuning Advisor as an automated task is a simple solution. The task processes selected high-load SQL statements from AWR that qualify as tuning candidates.</p>
<p>This section explains how to manage the Automatic SQL Tuning task. This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="tgsql_sqltune.htm#GUID-B383AE33-81F0-4D6A-A48F-A97C06448A2F" title="By default, the Automatic SQL Tuning task runs for in a nightly maintenance window.">About the Automatic SQL Tuning Task</a></p>
</li>
<li>
<p><a href="tgsql_sqltune.htm#GUID-581888AA-B9EF-4471-ABDF-1FF9C0264412" title="You can enable and disable all automatic maintenance tasks, including the Automatic SQL Tuning task, using Cloud Control.If you do not use Cloud Control to enable and disable the Automatic SQL Tuning task, then you must use the command line.">Enabling and Disabling the Automatic SQL Tuning Task</a></p>
</li>
<li>
<p><a href="tgsql_sqltune.htm#GUID-E621B81C-844C-43A1-B81B-75BF0159FBEF" title="You can enable and disable all automatic maintenance tasks, including the Automatic SQL Tuning task, using Cloud Control. You must perform the operation as SYS or have the EXECUTE privilege on the PL/SQL package DBMS_AUTO_SQLTUNE.">Configuring the Automatic SQL Tuning Task</a></p>
</li>
<li>
<p><a href="tgsql_sqltune.htm#GUID-C8264D23-0A39-4E1F-9603-01137CCB91A8">Viewing Automatic SQL Tuning Reports</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-87D3AA10-60CE-4F5B-879B-B2E851874B83__GUID-FAD5E552-7B91-4E77-B42C-E255D1DDA134">
<p class="notep1">See Also:</p>
<p><a class="olink ADMIN12331" target="_blank" href="../ADMIN/tasks.htm#ADMIN12331"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> to learn more about automated maintenance tasks</p>
</div>
</div>
<a id="TGSQL562"></a>
<div class="props_rev_3"><a id="GUID-B383AE33-81F0-4D6A-A48F-A97C06448A2F"></a>
<h3 id="TGSQL-GUID-B383AE33-81F0-4D6A-A48F-A97C06448A2F" class="sect3">About the Automatic SQL Tuning Task</h3>
<div>
<p>By default, the Automatic SQL Tuning task runs for in a nightly maintenance window.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="tgsql_sqltune.htm#GUID-ECC5B582-2BF1-4CB8-83E9-BAF13213570B" title="Configuring automatic SQL tuning instead of tuning manually decreases cost and increases manageability">Purpose of Automatic SQL Tuning</a></p>
</li>
<li>
<p><a href="tgsql_sqltune.htm#GUID-9A30D6A4-D25D-4260-A74B-B822F7C523B4" title="Oracle Scheduler uses the automated maintenance tasks infrastructure (known as AutoTask) to schedules tasks to run automatically.">Automatic SQL Tuning Concepts</a></p>
</li>
<li>
<p><a href="tgsql_sqltune.htm#GUID-44044948-163C-479D-BE9A-A48D28C88651">Command-Line Interface to SQL Tuning Advisor</a></p>
</li>
<li>
<p><a href="tgsql_sqltune.htm#GUID-8FC77F49-A0F0-469E-A37D-71DCAF74E359" title="This section explains the basic tasks in running SQL Tuning Advisor as an automatic task.">Basic Tasks for Automatic SQL Tuning</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-B383AE33-81F0-4D6A-A48F-A97C06448A2F__GUID-64FF39E3-064D-4AD2-B7F0-DBCD59FCEDCB">
<p class="notep1">See Also:</p>
<p><a class="olink GUID-DF42C0D3-8968-4810-9327-9D176337D356" target="_blank" href="../ADMIN/cdb_admin.htm#GUID-DF42C0D3-8968-4810-9327-9D176337D356"><span><cite>Oracle Database Administrator&rsquo;s Guide</cite></span></a> to learn about SQL Tuning Advisor in a multitenant environment</p>
</div>
</div>
<a id="TGSQL563"></a>
<div class="props_rev_3"><a id="GUID-ECC5B582-2BF1-4CB8-83E9-BAF13213570B"></a>
<h4 id="TGSQL-GUID-ECC5B582-2BF1-4CB8-83E9-BAF13213570B" class="sect4">Purpose of Automatic SQL Tuning</h4>
<div>
<p>Configuring automatic SQL tuning instead of tuning manually decreases cost and increases manageability</p>
<p>Many DBAs do not have the time needed for the intensive analysis required for SQL tuning. Even when they do, SQL tuning involves several manual steps. Because several different SQL statements may be high load on any given day, DBAs may have to expend considerable effort to monitor and tune them. .</p>
<p>The automated SQL tuning task does <span class="italic">not</span> process the following types of SQL:</p>
<ul style="list-style-type: disc;">
<li>
<p>Ad hoc SQL statements or SQL statements that do not repeat within a week</p>
</li>
<li>
<p>Parallel queries</p>
</li>
<li>
<p>Queries that take too long to run after being SQL profiled, so that it is not practical for SQL Tuning Advisor to test execution</p>
</li>
<li>
<p>Recursive SQL</p>
</li>
</ul>
<p>You can run SQL Tuning Advisor on demand to tune the preceding types of SQL statements.</p>
</div>
</div>
<a id="TGSQL564"></a>
<div class="props_rev_3"><a id="GUID-9A30D6A4-D25D-4260-A74B-B822F7C523B4"></a>
<h4 id="TGSQL-GUID-9A30D6A4-D25D-4260-A74B-B822F7C523B4" class="sect4">Automatic SQL Tuning Concepts</h4>
<div>
<p>Oracle Scheduler uses the automated maintenance tasks infrastructure (known as <span class="italic">AutoTask</span>) to schedules tasks to run automatically.</p>
<p>By default, the Automatic SQL Tuning task runs for at most one hour in a nightly maintenance window. You can customize attributes of the maintenance windows, including start and end time, frequency, and days of the week.</p>
<div class="infoboxnotealso" id="GUID-9A30D6A4-D25D-4260-A74B-B822F7C523B4__GUID-AE64CB55-38FE-4E6B-AA21-A1F76E93D610">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink ADMIN033" target="_blank" href="../ADMIN/schedover.htm#ADMIN033"><span><cite>Oracle Database Administrator&rsquo;s Guide</cite></span></a> to learn about Oracle Scheduler</p>
</li>
<li>
<p><a class="olink ARPLS032" target="_blank" href="../ARPLS/d_autotaskadm.htm#ARPLS032"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about <code class="codeph">DBMS_AUTO_TASK_ADMIN</code></p>
</li>
</ul>
</div>
</div>
</div>
<a id="TGSQL566"></a><a id="TGSQL565"></a>
<div class="props_rev_3"><a id="GUID-44044948-163C-479D-BE9A-A48D28C88651"></a>
<h4 id="TGSQL-GUID-44044948-163C-479D-BE9A-A48D28C88651" class="sect4">Command-Line Interface to SQL Tuning Advisor</h4>
<div>
<div class="section">
<p>On the command line, you can use PL/SQL packages to perform SQL tuning tasks. <a href="tgsql_sqltune.htm#GUID-44044948-163C-479D-BE9A-A48D28C88651__CBBHHEAH" title="Tools for performing task">Table 20-1</a> describes the most relevant packages.</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-44044948-163C-479D-BE9A-A48D28C88651__CBBHHEAH">
<p class="titleintable">Table 20-1 SQL Tuning Advisor Packages</p>
<table class="cellalignment4808" title="SQL Tuning Advisor Packages" summary="Tools for performing task">
<thead>
<tr class="cellalignment4802">
<th class="cellalignment4810" id="d108452e2536">Package</th>
<th class="cellalignment4837" id="d108452e2539">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4802">
<td class="cellalignment4812" id="d108452e2544" headers="d108452e2536">
<p><code class="codeph">DBMS_AUTO_SQLTUNE</code></p>
</td>
<td class="cellalignment4838" headers="d108452e2544 d108452e2539">
<p>Enables you run SQL Tuning Advisor, manage SQL profiles, manage SQL tuning sets, and perform real-time SQL performance monitoring. To use this API, you must have the <code class="codeph">ADVISOR</code> privilege.</p>
</td>
</tr>
<tr class="cellalignment4802">
<td class="cellalignment4812" id="d108452e2555" headers="d108452e2536">
<p><code class="codeph">DBMS_AUTO_TASK_ADMIN</code></p>
</td>
<td class="cellalignment4838" headers="d108452e2555 d108452e2539">
<p>Provides an interface to <code class="codeph">AUTOTASK</code>. You can use this interface to enable and disable the Automatic SQL Tuning task.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-44044948-163C-479D-BE9A-A48D28C88651__GUID-ECE7DB02-0C9F-4837-8022-F848CD8DD4DD">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS150" target="_blank" href="../ARPLS/d_spm.htm#ARPLS150"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> to learn about <code class="codeph">DBMS_SQLTUNE</code> ad <code class="codeph">DBMS_AUTO_TASK_ADMIN</code></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="TGSQL568"></a><a id="TGSQL567"></a>
<div class="props_rev_3"><a id="GUID-8FC77F49-A0F0-469E-A37D-71DCAF74E359"></a>
<h4 id="TGSQL-GUID-8FC77F49-A0F0-469E-A37D-71DCAF74E359" class="sect4">Basic Tasks for Automatic SQL Tuning</h4>
<div>
<p>This section explains the basic tasks in running SQL Tuning Advisor as an automatic task.</p>
<p>The following graphic shows the basic workflow.</p>
<div class="figure" id="GUID-8FC77F49-A0F0-469E-A37D-71DCAF74E359__CBBEBDBC">
<p class="titleinfigure">Figure 20-10 Automatic SQL Tuning APIs</p>
<img width="500" height="389" src="img/GUID-DAC3EF7F-B7ED-4005-8E24-384A236683D2-default.png" alt="Description of Figure 20-10 follows" title="Description of Figure 20-10 follows"/><br/>
<a href="img_text/GUID-DAC3EF7F-B7ED-4005-8E24-384A236683D2-print.htm">Description of &#34;Figure 20-10 Automatic SQL Tuning APIs&#34;</a></div>
<!-- class="figure" -->
<p>As shown in <a href="tgsql_sqltune.htm#GUID-35C7B77F-5CB1-45EC-A48D-10C1E47CC7BE__CBBIFFBI">Figure 20-11</a>, the basic procedure is as follows:</p>
<ol>
<li>
<p>Enable the Automatic SQL Tuning task.</p>
<p>See <span class="q">&#34;<a href="tgsql_sqltune.htm#GUID-581888AA-B9EF-4471-ABDF-1FF9C0264412" title="You can enable and disable all automatic maintenance tasks, including the Automatic SQL Tuning task, using Cloud Control.If you do not use Cloud Control to enable and disable the Automatic SQL Tuning task, then you must use the command line.">Enabling and Disabling the Automatic SQL Tuning Task</a>&#34;</span>.</p>
</li>
<li>
<p>Optionally, configure the Automatic SQL Tuning task.</p>
<p>See <span class="q">&#34;<a href="tgsql_sqltune.htm#GUID-E621B81C-844C-43A1-B81B-75BF0159FBEF" title="You can enable and disable all automatic maintenance tasks, including the Automatic SQL Tuning task, using Cloud Control. You must perform the operation as SYS or have the EXECUTE privilege on the PL/SQL package DBMS_AUTO_SQLTUNE.">Configuring the Automatic SQL Tuning Task</a>&#34;</span>.</p>
</li>
<li>
<p>Display the results of the Automatic SQL Tuning task.</p>
<p><span class="q">&#34;<a href="tgsql_sqltune.htm#GUID-C8264D23-0A39-4E1F-9603-01137CCB91A8">Viewing Automatic SQL Tuning Reports</a>&#34;</span>.</p>
</li>
<li>
<p>Disable the Automatic SQL Tuning task.</p>
<p>See <span class="q">&#34;<a href="tgsql_sqltune.htm#GUID-581888AA-B9EF-4471-ABDF-1FF9C0264412" title="You can enable and disable all automatic maintenance tasks, including the Automatic SQL Tuning task, using Cloud Control.If you do not use Cloud Control to enable and disable the Automatic SQL Tuning task, then you must use the command line.">Enabling and Disabling the Automatic SQL Tuning Task</a>&#34;</span>.</p>
</li>
</ol>
</div>
</div>
</div>
<a id="TGSQL569"></a>
<div class="props_rev_3"><a id="GUID-581888AA-B9EF-4471-ABDF-1FF9C0264412"></a>
<h3 id="TGSQL-GUID-581888AA-B9EF-4471-ABDF-1FF9C0264412" class="sect3">Enabling and Disabling the Automatic SQL Tuning Task</h3>
<div>
<p>This section explains how to enable and disable the Automatic SQL Tuning task using Cloud Control (preferred) or a command-line interface.</p>
</div>
<a id="TGSQL570"></a>
<div class="props_rev_3"><a id="GUID-34539175-C00C-46C3-8F68-5A997A4E506C"></a>
<h4 id="TGSQL-GUID-34539175-C00C-46C3-8F68-5A997A4E506C" class="sect4">Enabling and Disabling the Automatic SQL Tuning Task Using Cloud Control</h4>
<div>
<p>You can enable and disable all automatic maintenance tasks, including the Automatic SQL Tuning task, using Cloud Control.</p>
<div class="section">
<p class="subhead3">To enable or disable the Automatic SQL Tuning task using Cloud Control:</p>
<ol>
<li>
<p>Access the Database Home page, as described in <span class="q">&#34;<a href="tgsql_stats.htm#GUID-15511441-3164-4233-A0F8-54A8DF44AC6D">Accessing the Database Home Page in Cloud Control</a>.&#34;</span></p>
</li>
<li>
<p>From the <span class="bold">Administration</span> menu, select <span class="bold">Oracle Scheduler</span>, then <span class="bold">Automated Maintenance Tasks</span>.</p>
<p>The Automated Maintenance Tasks page appears.</p>
<p>This page shows the predefined tasks. You access each task by clicking the corresponding link to get more information about the task.</p>
</li>
<li>
<p>Click <span class="bold">Automatic SQL Tuning</span>.</p>
<p>The Automatic SQL Tuning Result Summary page appears.</p>
<p>The Task Status section shows whether the Automatic SQL Tuning Task is enabled or disabled. In the following graphic, the task is disabled:</p>
<div class="figure" id="GUID-34539175-C00C-46C3-8F68-5A997A4E506C__GUID-60AB6FCD-DD7A-40A5-B220-984A52FB2CBB"><img width="691" height="113" src="img/GUID-A33197A6-1D2F-40F5-A5F5-5A336ECFCD13-default.gif" alt="Description of GUID-A33197A6-1D2F-40F5-A5F5-5A336ECFCD13-default.gif follows" title="Description of GUID-A33197A6-1D2F-40F5-A5F5-5A336ECFCD13-default.gif follows"/><br/>
<a href="img_text/GUID-A33197A6-1D2F-40F5-A5F5-5A336ECFCD13-default.htm">Description of the illustration GUID-A33197A6-1D2F-40F5-A5F5-5A336ECFCD13-default.gif</a></div>
<!-- class="figure" --></li>
<li>
<p>In Automatic SQL Tuning, click <span class="bold">Configure</span>.</p>
<p>The Automated Maintenance Tasks Configuration page appears.</p>
<div class="figure" id="GUID-34539175-C00C-46C3-8F68-5A997A4E506C__GUID-4C291300-A31D-4325-97CC-DE162013A2EA"><img width="842" height="300" src="img/GUID-6D4BD841-EB9C-421C-949A-BBC9238E308C-default.gif" alt="Description of GUID-6D4BD841-EB9C-421C-949A-BBC9238E308C-default.gif follows" title="Description of GUID-6D4BD841-EB9C-421C-949A-BBC9238E308C-default.gif follows"/><br/>
<a href="img_text/GUID-6D4BD841-EB9C-421C-949A-BBC9238E308C-default.htm">Description of the illustration GUID-6D4BD841-EB9C-421C-949A-BBC9238E308C-default.gif</a></div>
<!-- class="figure" -->
<p>By default, Automatic SQL Tuning executes in all predefined maintenance windows in <code class="codeph">MAINTENANCE_WINDOW_GROUP</code>.</p>
</li>
<li>
<p>Perform the following steps:</p>
<ol>
<li>
<p>In the Task Settings for Automatic SQL Tuning, select either <span class="bold">Enabled</span> or <span class="bold">Disabled</span> to enable or disable the automated task.</p>
</li>
<li>
<p>To disable Automatic SQL Tuning for specific days in the week, check the appropriate box next to the window name.</p>
</li>
<li>
<p>To change the characteristics of a window, click <span class="bold">Edit Window Group</span>.</p>
</li>
<li>
<p>Click <span class="bold">Apply</span>.</p>
</li>
</ol>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="TGSQL571"></a>
<div class="props_rev_3"><a id="GUID-1980AAEB-E975-46D7-A816-94BB4237E77E"></a>
<h4 id="TGSQL-GUID-1980AAEB-E975-46D7-A816-94BB4237E77E" class="sect4">Enabling and Disabling the Automatic SQL Tuning Task from the Command Line</h4>
<div>
<p>If you do not use Cloud Control to enable and disable the Automatic SQL Tuning task, then you must use the command line.</p>
<div class="section">
<p>You have the following options:</p>
<ul style="list-style-type: disc;">
<li>
<p>Run the <code class="codeph">ENABLE</code> or <code class="codeph">DISABLE</code> procedure in the <code class="codeph">DBMS_AUTO_TASK_ADMIN</code> PL/SQL package.</p>
<p>This package is the recommended command-line technique. For both the <code class="codeph">ENABLE</code> and <code class="codeph">DISABLE</code> procedures, you can specify a particular maintenance window with the <code class="codeph">window_name</code> parameter.</p>
</li>
<li>
<p>Set the <code class="codeph">STATISTICS_LEVEL</code> initialization parameter to <code class="codeph">BASIC</code> to disable collection of <span class="italic">all</span> advisories and statistics, including Automatic SQL Tuning Advisor.</p>
<p>Because monitoring and many automatic features are disabled, Oracle strongly recommends that you do not set <code class="codeph">STATISTICS_LEVEL</code> to <code class="codeph">BASIC</code>.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To enable or disable Automatic SQL Tuning using DBMS_AUTO_TASK_ADMIN:</p>
<ol>
<li>
<p>Connect SQL*Plus to the database with administrator privileges, and then do one of the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>To enable the automated task, execute the following PL/SQL block:</p>
<pre dir="ltr">BEGIN
  DBMS_AUTO_TASK_ADMIN.ENABLE (
    client_name =&gt; &#39;sql tuning advisor&#39;
,   operation   =&gt; NULL
,   window_name =&gt; NULL
);
END;
/
</pre></li>
<li>
<p>To disable the automated task, execute the following PL/SQL block:</p>
<pre dir="ltr">BEGIN
  DBMS_AUTO_TASK_ADMIN.DISABLE (
    client_name =&gt; &#39;sql tuning advisor&#39;
,   operation   =&gt; NULL
,   window_name =&gt; NULL
);
END;
/
</pre></li>
</ul>
</li>
<li>
<p>Query the data dictionary to confirm the change.</p>
<p>For example, query <code class="codeph">DBA_AUTOTASK_CLIENT</code> as follows (sample output included):</p>
<pre dir="ltr">COL CLIENT_NAME FORMAT a20

SELECT CLIENT_NAME, STATUS
FROM   DBA_AUTOTASK_CLIENT
WHERE  CLIENT_NAME = &#39;sql tuning advisor&#39;;
 
CLIENT_NAME          STATUS
-------------------- --------
sql tuning advisor   ENABLED
</pre></li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To disable collection of all advisories and statistics:</p>
<ol>
<li>
<p>Connect SQL*Plus to the database with administrator privileges, and then query the current statistics level setting.</p>
<p>The following SQL*Plus command shows that <code class="codeph">STATISTICS_LEVEL</code> is set to <code class="codeph">ALL</code>:</p>
<pre dir="ltr">sys@PROD&gt; SHOW PARAMETER statistics_level
 
NAME                                 TYPE        VALUE
------------------------------------ ----------- -----
statistics_level                     string      ALL
</pre></li>
<li>
<p>Set <code class="codeph">STATISTICS_LEVEL</code> to <code class="codeph">BASIC</code> as follows:</p>
<pre dir="ltr">sys@PROD&gt; ALTER SYSTEM SET STATISTICS_LEVEL =&#39;BASIC&#39;;
 
System altered.
</pre></li>
</ol>
<div class="infoboxnotealso" id="GUID-1980AAEB-E975-46D7-A816-94BB4237E77E__GUID-37386F75-34EE-4128-B6C7-5741B5973637">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS032" target="_blank" href="../ARPLS/d_autotaskadm.htm#ARPLS032"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for complete reference information</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="TGSQL572"></a>
<div class="props_rev_3"><a id="GUID-E621B81C-844C-43A1-B81B-75BF0159FBEF"></a>
<h3 id="TGSQL-GUID-E621B81C-844C-43A1-B81B-75BF0159FBEF" class="sect3">Configuring the Automatic SQL Tuning Task</h3>
<div>
<p>This section explains how to configure settings for the Automatic SQL Tuning task.</p>
</div>
<a id="TGSQL573"></a>
<div class="props_rev_3"><a id="GUID-E05C2B66-1F41-4647-B94F-8371E228DA90"></a>
<h4 id="TGSQL-GUID-E05C2B66-1F41-4647-B94F-8371E228DA90" class="sect4">Configuring the Automatic SQL Tuning Task Using Cloud Control</h4>
<div>
<p>You can enable and disable all automatic maintenance tasks, including the Automatic SQL Tuning task, using Cloud Control. You must perform the operation as <code class="codeph">SYS</code> or have the <code class="codeph">EXECUTE</code> privilege on the PL/SQL package <code class="codeph">DBMS_AUTO_SQLTUNE</code>.</p>
<div class="section">
<p class="subhead3">To configure the Automatic SQL Tuning task using Cloud Control:</p>
<ol>
<li>
<p>Access the Database Home page, as described in <span class="q">&#34;<a href="tgsql_stats.htm#GUID-15511441-3164-4233-A0F8-54A8DF44AC6D">Accessing the Database Home Page in Cloud Control</a>.&#34;</span></p>
</li>
<li>
<p>From the <span class="bold">Administration</span> menu, click <span class="bold">Oracle Scheduler</span>, then <span class="bold">Automated Maintenance Tasks</span>.</p>
<p>The Automated Maintenance Tasks page appears.</p>
<p>This page shows the predefined tasks. You access each task by clicking the corresponding link to get more information about the task itself.</p>
</li>
<li>
<p>Click <span class="bold">Automatic SQL Tuning</span>.</p>
<p>The Automatic SQL Tuning Result Summary page appears.</p>
</li>
<li>
<p>Under Task Settings, click <span class="bold">Configure</span> next to Automatic SQL Tuning (<code class="codeph">SYS_AUTO_SQL_TUNING_TASK</code>).</p>
<p>The Automated Maintenance Tasks Configuration page appears.</p>
</li>
<li>
<p>Under Task Settings, click <span class="bold">Configure</span> next to Automatic SQL Tuning.</p>
<p>The Automatic SQL Tuning Settings page appears.</p>
<div class="figure" id="GUID-E05C2B66-1F41-4647-B94F-8371E228DA90__GUID-C4EBCD8A-A15D-42E3-B9D2-C0D0C297EFDA"><img width="435" height="165" src="img/GUID-A0C9CCE6-087F-4779-924C-7EEF84E6F0B0-default.gif" alt="Description of GUID-A0C9CCE6-087F-4779-924C-7EEF84E6F0B0-default.gif follows" title="Description of GUID-A0C9CCE6-087F-4779-924C-7EEF84E6F0B0-default.gif follows"/><br/>
<a href="img_text/GUID-A0C9CCE6-087F-4779-924C-7EEF84E6F0B0-default.htm">Description of the illustration GUID-A0C9CCE6-087F-4779-924C-7EEF84E6F0B0-default.gif</a></div>
<!-- class="figure" --></li>
<li>
<p>Make the desired changes and click <span class="bold">Apply</span>.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="TGSQL94959"></a><a id="TGSQL94888"></a><a id="TGSQL574"></a>
<div class="props_rev_3"><a id="GUID-8B77491E-9E9A-4E44-9F2A-DFA164C4B074"></a>
<h4 id="TGSQL-GUID-8B77491E-9E9A-4E44-9F2A-DFA164C4B074" class="sect4">Configuring the Automatic SQL Tuning Task Using the Command Line</h4>
<div>
<div class="section">
<p>The <code class="codeph">DBMS_AUTO_SQLTUNE</code> package enables you to configure automatic SQL tuning by specifying the task parameters using the <code class="codeph">SET_AUTO_TUNING_TASK_PARAMETER</code> procedure. Because the task is owned by <code class="codeph">SYS</code>, only <code class="codeph">SYS</code> can set task parameters.</p>
<p>The <code class="codeph">ACCEPT_SQL_PROFILE</code> tuning task parameter specifies whether to implement SQL profiles automatically (<code class="codeph">true</code>) or require user intervention (<code class="codeph">false</code>). The default is <code class="codeph">AUTO</code>, which means <code class="codeph">true</code> if at least one SQL statement exists with a SQL profile and <code class="codeph">false</code> if this condition is not satisfied.</p>
<div class="infobox-note" id="GUID-8B77491E-9E9A-4E44-9F2A-DFA164C4B074__GUID-516E9278-B64C-4BF2-962D-E30A1D19CCE4">
<p class="notep1">Note:</p>
<p>When automatic implementation is enabled, the advisor only implements recommendations to create SQL profiles. Recommendations such as creating new indexes, gathering optimizer statistics, and creating SQL plan baselines are not automatically implemented.</p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Assumptions</p>
</div>
<!-- class="section" -->
<div class="section">
<p>This tutorial assumes the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>You want the database to implement SQL profiles automatically, but to implement no more than 50 SQL profiles per execution, and no more than 50 profiles total on the database.</p>
</li>
<li>
<p>You want the task to time out after 1200 seconds per execution.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To set Automatic SQL Tuning task parameters:</p>
<ol>
<li>
<p>Connect SQL*Plus to the database with the appropriate privileges, and then optionally query the current task settings.</p>
<p>For example, connect SQL*Plus to the database with administrator privileges and execute the following query:</p>
<pre dir="ltr">COL PARAMETER_NAME FORMAT a25 
COL VALUE FORMAT a10   

SELECT PARAMETER_NAME, PARAMETER_VALUE AS &#34;VALUE&#34;
FROM   DBA_ADVISOR_PARAMETERS
WHERE  ( (TASK_NAME = &#39;SYS_AUTO_SQL_TUNING_TASK&#39;) AND
         ( (PARAMETER_NAME LIKE &#39;%PROFILE%&#39;) OR 
           (PARAMETER_NAME = &#39;LOCAL_TIME_LIMIT&#39;) OR
           (PARAMETER_NAME = &#39;EXECUTION_DAYS_TO_EXPIRE&#39;) ) );
</pre>
<p>Sample output appears as follows:</p>
<pre dir="ltr">PARAMETER_NAME            VALUE
------------------------- ----------
EXECUTION_DAYS_TO_EXPIRE  30
LOCAL_TIME_LIMIT          1000
ACCEPT_SQL_PROFILES       FALSE
MAX_SQL_PROFILES_PER_EXEC 20
MAX_AUTO_SQL_PROFILES     10000
</pre></li>
<li>
<p>Set parameters using PL/SQL code of the following form:</p>
<pre dir="ltr">BEGIN
  DBMS_SQLTUNE.SET_TUNING_TASK_PARAMETER (
    task_name =&gt; &#39;SYS_AUTO_SQL_TUNING_TASK&#39;
,   parameter =&gt; <span class="italic">parameter_name</span>
,   value     =&gt; <span class="italic">value</span>
);
END;
/
</pre></li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-8B77491E-9E9A-4E44-9F2A-DFA164C4B074__GUID-996928BE-49B9-46C8-8756-F4E44694E648">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS68398" target="_blank" href="../ARPLS/d_sqltun.htm#ARPLS68398"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for complete reference information for <code class="codeph">DBMS_AUTO_SQLTUNE</code></p>
</div>
</div>
<!-- class="section" -->
<div class="example" id="GUID-8B77491E-9E9A-4E44-9F2A-DFA164C4B074__GUID-AEB6182C-2F7C-4060-8D87-6D1082635483">
<p class="titleinexample">Example 20-3 Setting SQL Tuning Task Parameters</p>
<p>The following PL/SQL block sets a time limit to 20 minutes, and also automatically implements SQL profiles and sets limits for these profiles:</p>
<pre dir="ltr">BEGIN
  DBMS_SQLTUNE.SET_TUNING_TASK_PARAMETER(&#39;SYS_AUTO_SQL_TUNING_TASK&#39;,
    &#39;LOCAL_TIME_LIMIT&#39;, 1200);
  DBMS_SQLTUNE.SET_TUNING_TASK_PARAMETER(&#39;SYS_AUTO_SQL_TUNING_TASK&#39;,
    &#39;ACCEPT_SQL_PROFILES&#39;, &#39;true&#39;);
  DBMS_SQLTUNE.SET_TUNING_TASK_PARAMETER(&#39;SYS_AUTO_SQL_TUNING_TASK&#39;,
    &#39;MAX_SQL_PROFILES_PER_EXEC&#39;, 50);
  DBMS_SQLTUNE.SET_TUNING_TASK_PARAMETER(&#39;SYS_AUTO_SQL_TUNING_TASK&#39;,
    &#39;MAX_AUTO_SQL_PROFILES&#39;, 10002);
END;
/
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<a id="TGSQL575"></a>
<div class="props_rev_3"><a id="GUID-C8264D23-0A39-4E1F-9603-01137CCB91A8"></a>
<h3 id="TGSQL-GUID-C8264D23-0A39-4E1F-9603-01137CCB91A8" class="sect3">Viewing Automatic SQL Tuning Reports</h3>
<div>
<div class="section">
<p>At any time during or after the running of the Automatic SQL Tuning task, you can view a tuning report. This report contains information about all executions of the automatic SQL tuning task.</p>
<p>Depending on the sections that were included in the report, you can view information in the following sections:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>General information</p>
<p>This section has a high-level description of the automatic SQL tuning task, including information about the inputs given for the report, the number of SQL statements tuned during the maintenance, and the number of SQL profiles created.</p>
</li>
<li>
<p>Summary</p>
<p>This section lists the SQL statements (by their SQL identifiers) that were tuned during the maintenance window and the estimated benefit of each SQL profile, or the execution statistics after performing a test execution of the SQL statement with the SQL profile.</p>
</li>
<li>
<p>Tuning findings</p>
<p>This section contains the following information about each SQL statement analyzed by SQL Tuning Advisor:</p>
<ul style="list-style-type: disc;">
<li>
<p>All findings associated with each SQL statement</p>
</li>
<li>
<p>Whether the profile was implemented on the database, and why</p>
</li>
<li>
<p>Whether the SQL profile is currently enabled on the database</p>
</li>
<li>
<p>Detailed execution statistics captured when testing the SQL profile</p>
</li>
</ul>
</li>
<li>
<p>Explain plans</p>
<p>This section shows the old and new explain plans used by each SQL statement analyzed by SQL Tuning Advisor.</p>
</li>
<li>
<p>Errors</p>
<p>This section lists all errors encountered by the automatic SQL tuning task.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
<a id="TGSQL94960"></a><a id="TGSQL576"></a>
<div class="props_rev_3"><a id="GUID-C5A11E6F-9A8E-4061-BFED-39EA51C92AF7"></a>
<h4 id="TGSQL-GUID-C5A11E6F-9A8E-4061-BFED-39EA51C92AF7" class="sect4">Viewing Automatic SQL Tuning Reports Using the Command Line</h4>
<div>
<div class="section">
<p>To generate a SQL tuning report as a <code class="codeph">CLOB</code>, execute the <code class="codeph">DBMS_SQLTUNE</code>.<code class="codeph">REPORT_AUTO_TUNING_TASK</code> function. You can store the <code class="codeph">CLOB</code> in a variable and then print the variable to view the report. See <a class="olink ARPLS73163" target="_blank" href="../ARPLS/d_autosta.htm#ARPLS73163"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for complete reference information.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Assumptions</p>
</div>
<!-- class="section" -->
<div class="section">
<p>This section assumes that you want to show all SQL statements that were analyzed in the most recent execution, including recommendations that were not implemented.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To create and access an Automatic SQL Tuning Advisor report:</p>
<ol>
<li>
<p>Connect SQL*Plus to the database with administrator privileges, and then execute the <code class="codeph">DBMS_SQLTUNE.REPORT_AUTO_TUNING_TASK</code> function.</p>
<p>The following example generates a text report to show all SQL statements that were analyzed in the most recent execution, including recommendations that were not implemented:</p>
<pre dir="ltr">VARIABLE my_rept CLOB;
BEGIN
  :my_rept :=DBMS_SQLTUNE.REPORT_AUTO_TUNING_TASK (
    begin_exec   =&gt; NULL
,   end_exec     =&gt; NULL
,   type         =&gt; &#39;TEXT&#39;
,   level        =&gt; &#39;TYPICAL&#39;
,   section      =&gt; &#39;ALL&#39;
,   object_id    =&gt; NULL
,   result_limit =&gt; NULL
);
END;
/

PRINT :my_rept
</pre></li>
<li>
<p>Read the general information section for an overview of the tuning execution.</p>
<p>The following sample shows the Automatic SQL Tuning task analyzed 17 SQL statements in just over 7 minutes:</p>
<pre dir="ltr">MY_REPT
---------------------------------------------------------------------------
GENERAL INFORMATION SECTION
---------------------------------------------------------------------------
Tuning Task Name                        : SYS_AUTO_SQL_TUNING_TASK
Tuning Task Owner                       : SYS
Workload Type                           : Automatic High-Load SQL Workload
Execution Count                         : 6
Current Execution                       : EXEC_170
Execution Type                          : TUNE SQL
Scope                                   : COMPREHENSIVE
Global Time Limit(seconds)              : 3600
Per-SQL Time Limit(seconds)             : 1200
Completion Status                       : COMPLETED
Started at                              : 04/16/2012 10:00:00
Completed at                            : 04/16/2012 10:07:11
Number of Candidate SQLs                : 17
Cumulative Elapsed Time of SQL (s)      : 8
</pre></li>
<li>
<p>Look for findings and recommendations.</p>
<p>If SQL Tuning Advisor makes a recommendation, then weigh the pros and cons of accepting it.</p>
<p>The following example shows that SQL Tuning Advisor found a plan for a statement that is potentially better than the existing plan. The advisor recommends implementing a SQL profile.</p>
<pre dir="ltr">---------------------------------------------------------------------------
   SQLs with Findings Ordered by Maximum (Profile/Index) Benefit, Object ID
---------------------------------------------------------------------------
ob ID  SQL ID        statistics profile(benefit) index(benefit) restructure
------ ------------- ---------- ---------------- -------------- -----------
    82 dqjcc345dd4ak                      58.03%
    72 51bbkcd9zwsjw                                                      2
    81 03rxjf8gb18jg
 
---------------------------------------------------------------------------
DETAILS SECTION
---------------------------------------------------------------------------
 Statements with Results Ordered by Max (Profile/Index) Benefit, Object ID
---------------------------------------------------------------------------
Object ID  : 82
Schema Name: DBA1
SQL ID     : dqjcc345dd4ak
SQL Text   : SELECT status FROM dba_autotask_client WHERE client_name=:1
 
---------------------------------------------------------------------------
FINDINGS SECTION (1 finding)
---------------------------------------------------------------------------
 
1- SQL Profile Finding (see explain plans section below)
--------------------------------------------------------
  A potentially better execution plan was found for this statement.
  The SQL profile was not automatically created because the verified
  benefit was too low.
 
  Recommendation (estimated benefit: 58.03%)
  ------------------------------------------
  - Consider accepting the recommended SQL profile.
    execute dbms_sqltune.accept_sql_profile(task_name =&gt;
            &#39;SYS_AUTO_SQL_TUNING_TASK&#39;, object_id =&gt; 82, replace =&gt; TRUE);
 
  Validation results
  ------------------
  The SQL profile was tested by executing both its plan and the original 
  plan and measuring their respective execution statistics. A plan 
  may have been only partially executed if the other could be run 
  to completion in less time.
 
                           Original Plan  With SQL Profile  % Improved
                           -------------  ----------------  ----------
  Completion Status:            COMPLETE          COMPLETE
  Elapsed Time(us):               26963              8829      67.25 %
  CPU Time(us):                   27000              9000      66.66 %
  User I/O Time(us):                 25                14         44 %
  Buffer Gets:                      905               380      58.01 %
  Physical Read Requests:             0                 0
  Physical Write Requests:            0                 0
  Physical Read Bytes:                0                 0
  Physical Write Bytes:            7372              7372          0 %
  Rows Processed:                     1                 1
  Fetches:                            1                 1
  Executions:                         1                 1
 
  Notes
  -----
  1. The original plan was first executed to warm the buffer cache.
  2. Statistics for original plan were averaged over next 9 executions.
  3. The SQL profile plan was first executed to warm the buffer cache.
  4. Statistics for the SQL profile plan were averaged over 
     next 9 executions.
</pre></li>
</ol>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<a id="TGSQL577"></a>
<div class="props_rev_3"><a id="GUID-F5494CD1-52BB-478E-BB36-17104B36B0FE"></a>
<h2 id="TGSQL-GUID-F5494CD1-52BB-478E-BB36-17104B36B0FE" class="sect2">Running SQL Tuning Advisor On Demand</h2>
<div>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="tgsql_sqltune.htm#GUID-85C2BEA4-4483-477F-88CD-ED6962075FAC" title="Automatic Database Diagnostic Monitor (ADDM) automatically identifies high-load SQL statements. If ADDM identifies such statements, then click Schedule/Run SQL Tuning Advisor on the Recommendation Detail page to run SQL Tuning Advisor.This section explains the basic tasks in running SQL Tuning Advisor using the DBMS_SQLTUNE package.">About On-Demand SQL Tuning</a></p>
</li>
<li>
<p><a href="tgsql_sqltune.htm#GUID-36E17A9F-7912-483D-A10F-7748BBB924E0">Creating a SQL Tuning Task</a></p>
</li>
<li>
<p><a href="tgsql_sqltune.htm#GUID-4CFA6019-BB0D-4CC7-A281-42E13FFABFD9" title="To change the parameters of a tuning task after it has been created, execute the DBMS_SQLTUNE.SET_TUNING_TASK_PARAMETER function.">Configuring a SQL Tuning Task</a></p>
</li>
<li>
<p><a href="tgsql_sqltune.htm#GUID-01A224F2-043E-4E0E-A3A1-5FF21E264C47">Executing a SQL Tuning Task</a></p>
</li>
<li>
<p><a href="tgsql_sqltune.htm#GUID-893679CA-9998-4A5F-B4E4-C32AB219CD46">Monitoring a SQL Tuning Task</a></p>
</li>
<li>
<p><a href="tgsql_sqltune.htm#GUID-F6C1B6A7-AE67-4FED-B376-F10F02924B0A">Displaying the Results of a SQL Tuning Task</a></p>
</li>
</ul>
</div>
<a id="TGSQL578"></a>
<div class="props_rev_3"><a id="GUID-85C2BEA4-4483-477F-88CD-ED6962075FAC"></a>
<h3 id="TGSQL-GUID-85C2BEA4-4483-477F-88CD-ED6962075FAC" class="sect3">About On-Demand SQL Tuning</h3>
<div>
<p>In this context, on-demand SQL tuning is defined as any invocation of SQL Tuning Advisor that does not result from the Automatic SQL Tuning task.</p>
</div>
<a id="TGSQL579"></a>
<div class="props_rev_3"><a id="GUID-E4679326-F34B-417E-A95B-2B79425581D8"></a>
<h4 id="TGSQL-GUID-E4679326-F34B-417E-A95B-2B79425581D8" class="sect4">Purpose of On-Demand SQL Tuning</h4>
<div>
<p>Typically, you invoke SQL Tuning Advisor on demand in the following situations:</p>
<ul style="list-style-type: disc;">
<li>
<p>You proactively run ADDM, which reports that some SQL statements do not meet your performance requirements.</p>
</li>
<li>
<p>You reactively tune SQL statement because users complain about suboptimal SQL performance.</p>
</li>
</ul>
<p>In both situations, running SQL Tuning Advisor is usually the quickest way to fix unexpected SQL performance problems.</p>
</div>
</div>
<a id="TGSQL580"></a>
<div class="props_rev_3"><a id="GUID-AC9AB5F2-9B62-4228-A7F2-11FF1EB75938"></a>
<h4 id="TGSQL-GUID-AC9AB5F2-9B62-4228-A7F2-11FF1EB75938" class="sect4">User Interfaces for On-Demand SQL Tuning</h4>
<div>
<p>The recommended user interface for running SQL Tuning Advisor manually is Cloud Control.</p>
</div>
<a id="TGSQL581"></a>
<div class="props_rev_3"><a id="GUID-B7352680-90B8-4DD9-B041-EBADC3CD4926"></a>
<h5 id="TGSQL-GUID-B7352680-90B8-4DD9-B041-EBADC3CD4926" class="sect5">Accessing the SQL Tuning Advisor Using Cloud Control</h5>
<div>
<p>Automatic Database Diagnostic Monitor (ADDM) automatically identifies high-load SQL statements. If ADDM identifies such statements, then click <span class="bold">Schedule/Run SQL Tuning Advisor</span> on the Recommendation Detail page to run SQL Tuning Advisor.</p>
<div class="section">
<p class="subhead3">To tune SQL statements manually using SQL Tuning Advisor:</p>
<ol>
<li>
<p>Log in to Cloud Control with the appropriate credentials.</p>
</li>
<li>
<p>Under the <span class="bold">Targets</span> menu, select <span class="bold">Databases</span>.</p>
</li>
<li>
<p>In the list of database targets, select the target for the Oracle Database instance that you want to administer.</p>
</li>
<li>
<p>If prompted for database credentials, then enter the minimum credentials necessary for the tasks you intend to perform.</p>
</li>
<li>
<p>From the <span class="bold">Performance</span> menu, click <span class="bold">SQL</span>, then <span class="bold">SQL Tuning Advisor</span>.</p>
<p>The Schedule SQL Tuning Advisor page appears.</p>
<div class="figure" id="GUID-B7352680-90B8-4DD9-B041-EBADC3CD4926__GUID-B404EF74-2F2E-4C60-94AA-225001C4D816"><img width="756" height="673" src="img/GUID-AF4E24FF-E02F-492A-9D12-E98790D1EA53-default.gif" alt="Description of GUID-AF4E24FF-E02F-492A-9D12-E98790D1EA53-default.gif follows" title="Description of GUID-AF4E24FF-E02F-492A-9D12-E98790D1EA53-default.gif follows"/><br/>
<a href="img_text/GUID-AF4E24FF-E02F-492A-9D12-E98790D1EA53-default.htm">Description of the illustration GUID-AF4E24FF-E02F-492A-9D12-E98790D1EA53-default.gif</a></div>
<!-- class="figure" --></li>
</ol>
<div class="infoboxnotealso" id="GUID-B7352680-90B8-4DD9-B041-EBADC3CD4926__GUID-D287B6CF-3856-4577-832F-0AFED2A5C8D5">
<p class="notep1">See Also:</p>
<p><a class="olink TDPPT161" target="_blank" href="../TDPPT/tdppt_sqltune.htm#TDPPT161"><span><cite>Oracle Database 2 Day + Performance Tuning Guide</cite></span></a> to learn how to configure and run SQL Tuning Advisor using Cloud Control.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="TGSQL582"></a>
<div class="props_rev_3"><a id="GUID-4BB11709-E6D9-496F-AF81-A4E4E2A70E24"></a>
<h5 id="TGSQL-GUID-4BB11709-E6D9-496F-AF81-A4E4E2A70E24" class="sect5">Command-Line Interface to On-Demand SQL Tuning</h5>
<div>
<div class="section">
<p>If Cloud Control is unavailable, then you can run SQL Tuning Advisor using procedures in the <code class="codeph">DBMS_SQLTUNE</code> package. To use the APIs, the user must have the <code class="codeph">ADVISOR</code> privilege.</p>
<div class="infoboxnotealso" id="GUID-4BB11709-E6D9-496F-AF81-A4E4E2A70E24__GUID-31C56DD0-1FD4-474E-B96C-01FAEB857691">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS220" target="_blank" href="../ARPLS/d_sqltun.htm#ARPLS220"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for complete reference information</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="TGSQL584"></a><a id="TGSQL583"></a>
<div class="props_rev_3"><a id="GUID-35C7B77F-5CB1-45EC-A48D-10C1E47CC7BE"></a>
<h4 id="TGSQL-GUID-35C7B77F-5CB1-45EC-A48D-10C1E47CC7BE" class="sect4">Basic Tasks in On-Demand SQL Tuning</h4>
<div>
<p>This section explains the basic tasks in running SQL Tuning Advisor using the <code class="codeph">DBMS_SQLTUNE</code> package.</p>
<p>The following graphic shows the basic workflow when using the PL/SQL APIs.</p>
<div class="figure" id="GUID-35C7B77F-5CB1-45EC-A48D-10C1E47CC7BE__CBBIFFBI">
<p class="titleinfigure">Figure 20-11 SQL Tuning Advisor APIs</p>
<img width="489" height="498" src="img/GUID-34497D81-D99E-438D-AD6D-83C03A94CA96-default.png" alt="Description of Figure 20-11 follows" title="Description of Figure 20-11 follows"/><br/>
<a href="img_text/GUID-34497D81-D99E-438D-AD6D-83C03A94CA96-print.htm">Description of &#34;Figure 20-11 SQL Tuning Advisor APIs&#34;</a></div>
<!-- class="figure" -->
<p>As shown in <a href="tgsql_sqltune.htm#GUID-35C7B77F-5CB1-45EC-A48D-10C1E47CC7BE__CBBIFFBI">Figure 20-11</a>, the basic procedure is as follows:</p>
<ol>
<li>
<p>Prepare or create the input to SQL Tuning Advisor. The input can be either:</p>
<ul style="list-style-type: disc;">
<li>
<p>The text of a single SQL statement</p>
</li>
<li>
<p>A SQL tuning set that contains one or more statements</p>
</li>
</ul>
</li>
<li>
<p>Create a SQL tuning task.</p>
<p>See <span class="q">&#34;<a href="tgsql_sqltune.htm#GUID-36E17A9F-7912-483D-A10F-7748BBB924E0">Creating a SQL Tuning Task</a>&#34;</span>.</p>
</li>
<li>
<p>Optionally, configure the SQL tuning task that you created.</p>
<p>See <span class="q">&#34;<a href="tgsql_sqltune.htm#GUID-4CFA6019-BB0D-4CC7-A281-42E13FFABFD9" title="To change the parameters of a tuning task after it has been created, execute the DBMS_SQLTUNE.SET_TUNING_TASK_PARAMETER function.">Configuring a SQL Tuning Task</a>&#34;</span>.</p>
</li>
<li>
<p>Execute a SQL tuning task.</p>
<p>See <span class="q">&#34;<a href="tgsql_sqltune.htm#GUID-01A224F2-043E-4E0E-A3A1-5FF21E264C47">Executing a SQL Tuning Task</a>&#34;</span>.</p>
</li>
<li>
<p>Optionally, check the status or progress of a SQL tuning task.</p>
<p><span class="q">&#34;<a href="tgsql_sqltune.htm#GUID-893679CA-9998-4A5F-B4E4-C32AB219CD46">Monitoring a SQL Tuning Task</a>&#34;</span>.</p>
</li>
<li>
<p>Display the results of a SQL tuning task.</p>
<p><span class="q">&#34;<a href="tgsql_sqltune.htm#GUID-F6C1B6A7-AE67-4FED-B376-F10F02924B0A">Displaying the Results of a SQL Tuning Task</a>&#34;</span>.</p>
</li>
<li>
<p>Implement recommendations as appropriate.</p>
</li>
</ol>
<div class="infoboxnotealso" id="GUID-35C7B77F-5CB1-45EC-A48D-10C1E47CC7BE__GUID-5620E95C-B8A4-4DC6-99AA-6760112433A1">
<p class="notep1">See Also:</p>
<p><a class="olink TDPPT161" target="_blank" href="../TDPPT/tdppt_sqltune.htm#TDPPT161"><span><cite>Oracle Database 2 Day + Performance Tuning Guide</cite></span></a> to learn how to tune SQL using Cloud Control</p>
</div>
</div>
</div>
</div>
<a id="TGSQL94961"></a><a id="TGSQL585"></a>
<div class="props_rev_3"><a id="GUID-36E17A9F-7912-483D-A10F-7748BBB924E0"></a>
<h3 id="TGSQL-GUID-36E17A9F-7912-483D-A10F-7748BBB924E0" class="sect3">Creating a SQL Tuning Task</h3>
<div>
<div class="section">
<p>To create a SQL tuning task execute the <code class="codeph">DBMS_SQLTUNE.CREATE_TUNING_TASK</code> function. You can create tuning tasks from any of the following:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>The text of a single SQL statement</p>
</li>
<li>
<p>A SQL tuning set containing multiple statements</p>
</li>
<li>
<p>A SQL statement selected by SQL identifier from the shared SQL area</p>
</li>
<li>
<p>A SQL statement selected by SQL identifier from AWR</p>
</li>
</ul>
<p>The <code class="codeph">scope</code> parameter is one of the most important for this function. You can set this parameter to the following values:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">LIMITED</code></p>
<p>SQL Tuning Advisor produces recommendations based on statistical checks, access path analysis, and SQL structure analysis. SQL profile recommendations are not generated.</p>
</li>
<li>
<p><code class="codeph">COMPREHENSIVE</code></p>
<p>SQL Tuning Advisor carries out all the analysis it performs under limited scope plus SQL profiling.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Assumptions</p>
</div>
<!-- class="section" -->
<div class="section">
<p>This tutorial assumes the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>You want to tune as user <code class="codeph">hr</code>, who has the <code class="codeph">ADVISOR</code> privilege.</p>
</li>
<li>
<p>You want to tune the following query:</p>
<pre dir="ltr">SELECT /*+ ORDERED */ * 
FROM   employees e, locations l, departments d
WHERE  e.department_id = d.department_id 
AND    l.location_id = d.location_id 
AND    e.employee_id &lt; :bnd;
</pre></li>
<li>
<p>You want to pass the bind variable <code class="codeph">100</code> to the preceding query.</p>
</li>
<li>
<p>You want SQL Tuning Advisor to perform SQL profiling.</p>
</li>
<li>
<p>You want the task to run no longer than 60 seconds.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To create a SQL tuning task:</p>
<ol>
<li>
<p>Connect SQL*Plus to the database with the appropriate privileges, and then run the <code class="codeph">DBMS_SQLTUNE.CREATE_TUNING_TASK</code> function.</p>
<p>For example, execute the following PL/SQL program:</p>
<pre dir="ltr">DECLARE
  my_task_name VARCHAR2(30);
  my_sqltext   CLOB;
BEGIN
  my_sqltext := &#39;SELECT /*+ ORDERED */ * &#39;                      ||
                &#39;FROM employees e, locations l, departments d &#39; ||
                &#39;WHERE e.department_id = d.department_id AND &#39;  ||
                      &#39;l.location_id = d.location_id AND &#39;      ||
                      &#39;e.employee_id &lt; :bnd&#39;;

  my_task_name := DBMS_SQLTUNE.CREATE_TUNING_TASK (
          sql_text    =&gt; my_sqltext
,         bind_list   =&gt; sql_binds(anydata.ConvertNumber(100))
,         user_name   =&gt; &#39;HR&#39;
,         scope       =&gt; &#39;COMPREHENSIVE&#39;
,         time_limit  =&gt; 60
,         task_name   =&gt; &#39;STA_SPECIFIC_EMP_TASK&#39;
,         description =&gt; &#39;Task to tune a query on a specified employee&#39;
);
END;
/
</pre></li>
<li>
<p>Optionally, query the status of the task.</p>
<p>The following example queries the status of all tasks owned by the current user, which in this example is <code class="codeph">hr</code>:</p>
<pre dir="ltr">COL TASK_ID FORMAT 999999
COL TASK_NAME FORMAT a25
COL STATUS_MESSAGE FORMAT a33

SELECT TASK_ID, TASK_NAME, STATUS, STATUS_MESSAGE
FROM   USER_ADVISOR_LOG;
</pre>
<p>Sample output appears below:</p>
<pre dir="ltr">TASK_ID TASK_NAME                 STATUS      STATUS_MESSAGE
------- ------------------------- ----------- --------------
    884 STA_SPECIFIC_EMP_TASK     INITIAL
</pre>
<p>In the preceding output, the <code class="codeph">INITIAL</code> status indicates that the task has not yet started execution.</p>
</li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-36E17A9F-7912-483D-A10F-7748BBB924E0__GUID-C60F3B45-4155-47D9-95A7-BF70E43A82AC">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS68414" target="_blank" href="../ARPLS/d_sqltun.htm#ARPLS68414"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> to learn about the <code class="codeph">DBMS_SQLTUNE.CREATE_TUNING_TASK</code> function</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="TGSQL94962"></a><a id="TGSQL586"></a>
<div class="props_rev_3"><a id="GUID-4CFA6019-BB0D-4CC7-A281-42E13FFABFD9"></a>
<h3 id="TGSQL-GUID-4CFA6019-BB0D-4CC7-A281-42E13FFABFD9" class="sect3">Configuring a SQL Tuning Task</h3>
<div>
<p>To change the parameters of a tuning task after it has been created, execute the <code class="codeph">DBMS_SQLTUNE.SET_TUNING_TASK_PARAMETER</code> function.</p>
<div class="section">
<p class="subhead3">Assumptions</p>
</div>
<!-- class="section" -->
<div class="section">
<p>This tutorial assumes the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>You want to tune as user <code class="codeph">hr</code>, who has the <code class="codeph">ADVISOR</code> privilege.</p>
</li>
<li>
<p>You want to tune the <code class="codeph">STA_SPECIFIC_EMP_TASK</code> created in <span class="q">&#34;<a href="tgsql_sqltune.htm#GUID-36E17A9F-7912-483D-A10F-7748BBB924E0">Creating a SQL Tuning Task</a>&#34;</span>.</p>
</li>
<li>
<p>You want to change the maximum time that the SQL tuning task can run to 300 seconds.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To configure a SQL tuning task:</p>
<ol>
<li>
<p>Connect SQL*Plus to the database with the appropriate privileges, and then run the <code class="codeph">DBMS_SQLTUNE.SET_TUNING_TASK_PARAMETER</code> function.</p>
<p>For example, execute the following PL/SQL program to change the time limit of the tuning task to 300 seconds:</p>
<pre dir="ltr">BEGIN
  DBMS_SQLTUNE.SET_TUNING_TASK_PARAMETER (
    task_name =&gt; &#39;STA_SPECIFIC_EMP_TASK&#39;
,   parameter =&gt; &#39;TIME_LIMIT&#39;
,   value     =&gt; 300
);
END;
/
</pre></li>
<li>
<p>Optionally, verify that the task parameter was changed.</p>
<p>The following example queries the values of all used parameters in task <code class="codeph">STA_SPECIFIC_EMP_TASK</code>:</p>
<pre dir="ltr">COL PARAMETER_NAME FORMAT a25 
COL VALUE FORMAT a15   

SELECT PARAMETER_NAME, PARAMETER_VALUE AS &#34;VALUE&#34;
FROM   USER_ADVISOR_PARAMETERS
WHERE  TASK_NAME = &#39;STA_SPECIFIC_EMP_TASK&#39;
AND    PARAMETER_VALUE != &#39;UNUSED&#39;
ORDER BY PARAMETER_NAME;
</pre>
<p>Sample output appears below:</p>
<pre dir="ltr">PARAMETER_NAME            VALUE
------------------------- ---------------
DAYS_TO_EXPIRE            30
DEFAULT_EXECUTION_TYPE    TUNE SQL
EXECUTION_DAYS_TO_EXPIRE  UNLIMITED
JOURNALING                INFORMATION
MODE                      COMPREHENSIVE
SQL_LIMIT                 -1
SQL_PERCENTAGE            1
TARGET_OBJECTS            1
TEST_EXECUTE              AUTO
TIME_LIMIT                300
</pre></li>
</ol>
<div class="infoboxnotealso" id="GUID-4CFA6019-BB0D-4CC7-A281-42E13FFABFD9__GUID-D47A6862-105C-4DB4-878C-01554C9E3BFF">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS68462" target="_blank" href="../ARPLS/d_sqltun.htm#ARPLS68462"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for complete reference information.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="TGSQL94963"></a><a id="TGSQL587"></a>
<div class="props_rev_3"><a id="GUID-01A224F2-043E-4E0E-A3A1-5FF21E264C47"></a>
<h3 id="TGSQL-GUID-01A224F2-043E-4E0E-A3A1-5FF21E264C47" class="sect3">Executing a SQL Tuning Task</h3>
<div>
<div class="section">
<p>To execute a SQL tuning task, use the <code class="codeph">DBMS_SQLTUNE.EXECUTE_TUNING_TASK</code> function. The most important parameter is <code class="codeph">task_name</code>.</p>
<div class="infobox-note" id="GUID-01A224F2-043E-4E0E-A3A1-5FF21E264C47__GUID-BD1FF202-4761-426A-B482-4303460CE0CE">
<p class="notep1">Note:</p>
<p>You can also execute the automatic tuning task <code class="codeph">SYS_AUTO_SQL_TUNING_TASK</code> using the <code class="codeph">EXECUTE_TUNING_TASK</code> API. SQL Tuning Advisor performs the same analysis and actions as it would when run automatically.</p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Assumptions</p>
</div>
<!-- class="section" -->
<div class="section">
<p>This tutorial assumes the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>You want to tune as user <code class="codeph">hr</code>, who has the <code class="codeph">ADVISOR</code> privilege.</p>
</li>
<li>
<p>You want to execute the <code class="codeph">STA_SPECIFIC_EMP_TASK</code> created in <span class="q">&#34;<a href="tgsql_sqltune.htm#GUID-36E17A9F-7912-483D-A10F-7748BBB924E0">Creating a SQL Tuning Task</a>&#34;</span>.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To execute a SQL tuning task:</p>
<ol>
<li>
<p>Connect SQL*Plus to the database with the appropriate privileges, and then run the <code class="codeph">DBMS_SQLTUNE.EXECUTE_TUNING_TASK</code> function.</p>
<p>For example, execute the following PL/SQL program:</p>
<pre dir="ltr">BEGIN
  DBMS_SQLTUNE.EXECUTE_TUNING_TASK(task_name=&gt;&#39;STA_SPECIFIC_EMP_TASK&#39;);
END;
/
</pre></li>
<li>
<p>Optionally, query the status of the task.</p>
<p>The following example queries the status of all tasks owned by the current user, which in this example is <code class="codeph">hr</code>:</p>
<pre dir="ltr">COL TASK_ID FORMAT 999999
COL TASK_NAME FORMAT a25
COL STATUS_MESSAGE FORMAT a33

SELECT TASK_ID, TASK_NAME, STATUS, STATUS_MESSAGE
FROM   USER_ADVISOR_LOG;
</pre>
<p>Sample output appears below:</p>
<pre dir="ltr">TASK_ID TASK_NAME                 STATUS      STATUS_MESSAGE
------- ------------------------- ----------- --------------
    884 STA_SPECIFIC_EMP_TASK     COMPLETED
</pre></li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-01A224F2-043E-4E0E-A3A1-5FF21E264C47__GUID-C07C53B8-DCA4-47EB-A085-9B3FC87AAA10">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS68424" target="_blank" href="../ARPLS/d_sqltun.htm#ARPLS68424"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for complete reference information about the <code class="codeph">DBMS_SQLTUNE.EXECUTE_TUNING_TASK</code> function</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="TGSQL589"></a><a id="TGSQL94964"></a><a id="TGSQL588"></a>
<div class="props_rev_3"><a id="GUID-893679CA-9998-4A5F-B4E4-C32AB219CD46"></a>
<h3 id="TGSQL-GUID-893679CA-9998-4A5F-B4E4-C32AB219CD46" class="sect3">Monitoring a SQL Tuning Task</h3>
<div>
<div class="section">
<p>When you create a SQL tuning task in Cloud Control, no separate monitoring step is necessary. Cloud Control displays the status page automatically.</p>
<p>If you do not use Cloud Control, then you can monitor currently executing SQL tuning tasks by querying the data dictionary and dynamic performance views. <a href="tgsql_sqltune.htm#GUID-893679CA-9998-4A5F-B4E4-C32AB219CD46__CBBCIIJD" title="initialization parameters for task">Table 20-2</a> describes the relevant views.</p>
<div class="tblformal" id="GUID-893679CA-9998-4A5F-B4E4-C32AB219CD46__CBBCIIJD">
<p class="titleintable">Table 20-2 DBMS_SQLTUNE.EXECUTE_TUNING_TASK Parameters</p>
<table class="cellalignment4808" title="DBMS_SQLTUNE.EXECUTE_TUNING_TASK Parameters" summary="initialization parameters for task">
<thead>
<tr class="cellalignment4802">
<th class="cellalignment4810" id="d108452e5180">View</th>
<th class="cellalignment4837" id="d108452e5183">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4802">
<td class="cellalignment4812" id="d108452e5188" headers="d108452e5180">
<p><code class="codeph">USER_ADVISOR_TASKS</code></p>
</td>
<td class="cellalignment4838" headers="d108452e5188 d108452e5183">
<p>Displays information about tasks owned by the current user. The view contains one row for each task. Each task has a name that is unique to the owner. Task names are just informational and no uniqueness is enforced within any other namespace.</p>
</td>
</tr>
<tr class="cellalignment4802">
<td class="cellalignment4812" id="d108452e5196" headers="d108452e5180">
<p><code class="codeph">V$ADVISOR_PROGRESS</code></p>
</td>
<td class="cellalignment4838" headers="d108452e5196 d108452e5183">
<p>Displays information about the progress of advisor execution.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Assumptions</p>
</div>
<!-- class="section" -->
<div class="section">
<p>This tutorial assumes the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>You tune as user <code class="codeph">hr</code>, who has the <code class="codeph">ADVISOR</code> privilege.</p>
</li>
<li>
<p>You monitor the <code class="codeph">STA_SPECIFIC_EMP_TASK</code> that you executed in <span class="q">&#34;<a href="tgsql_sqltune.htm#GUID-01A224F2-043E-4E0E-A3A1-5FF21E264C47">Executing a SQL Tuning Task</a>&#34;</span>.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To monitor a SQL tuning task:</p>
<ol>
<li>
<p>Connect SQL*Plus to the database with the appropriate privileges, and then determine whether the task is executing or completed.</p>
<p>For example, query the status of <code class="codeph">STA_SPECIFIC_EMP_TASK</code> as follows:</p>
<pre dir="ltr">SELECT STATUS 
FROM   USER_ADVISOR_TASKS
WHERE  TASK_NAME = &#39;STA_SPECIFIC_EMP_TASK&#39;;
</pre>
<p>The following output shows that the task has completed:</p>
<pre dir="ltr">STATUS
-----------
EXECUTING
</pre></li>
<li>
<p>Determine the progress of an executing task.</p>
<p>The following example queries the status of the task with task ID <code class="codeph">884</code>:</p>
<pre dir="ltr">VARIABLE my_tid NUMBER;  
EXEC :my_tid := 884
COL ADVISOR_NAME FORMAT a20
COL SOFAR FORMAT 999
COL TOTALWORK FORMAT 999

SELECT TASK_ID, ADVISOR_NAME, SOFAR, TOTALWORK, 
       ROUND(SOFAR/TOTALWORK*100,2) &#34;%_COMPLETE&#34;
FROM   V$ADVISOR_PROGRESS
WHERE  TASK_ID = :my_tid;
</pre>
<p>Sample output appears below:</p>
<pre dir="ltr">   TASK_ID ADVISOR_NAME         SOFAR TOTALWORK %_COMPLETE
---------- -------------------- ----- --------- ----------
       884 SQL Tuning Advisor       1         2         50
</pre></li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-893679CA-9998-4A5F-B4E4-C32AB219CD46__GUID-E2F60F0B-27D2-4DF8-B14C-E816761A4A89">
<p class="notep1">See Also:</p>
<p><a class="olink REFRN30327" target="_blank" href="../REFRN/GUID-9A17BA89-08F5-4F95-A065-4570E37D343C.htm#REFRN30327"><span class="italic">Oracle Database Reference</span></a> to learn about the <code class="codeph">V$ADVISOR_PROGRESS</code> view</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="TGSQL94965"></a><a id="TGSQL590"></a>
<div class="props_rev_3"><a id="GUID-F6C1B6A7-AE67-4FED-B376-F10F02924B0A"></a>
<h3 id="TGSQL-GUID-F6C1B6A7-AE67-4FED-B376-F10F02924B0A" class="sect3">Displaying the Results of a SQL Tuning Task</h3>
<div>
<div class="section">
<p>To report the results of a tuning task, use the <code class="codeph">DBMS_SQLTUNE.REPORT_TUNING_TASK</code> function. The report contains all the findings and recommendations of SQL Tuning Advisor. For each proposed recommendation, the report provides the rationale and benefit along with the SQL statements needed to implement the recommendation.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Assumptions</p>
</div>
<!-- class="section" -->
<div class="section">
<p>This tutorial assumes the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>You want to tune as user <code class="codeph">hr</code>, who has the <code class="codeph">ADVISOR</code> privilege.</p>
</li>
<li>
<p>You want to access the report for the <code class="codeph">STA_SPECIFIC_EMP_TASK</code> executed in <span class="q">&#34;<a href="tgsql_sqltune.htm#GUID-01A224F2-043E-4E0E-A3A1-5FF21E264C47">Executing a SQL Tuning Task</a>&#34;</span>.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To view the report for a SQL tuning task:</p>
<ol>
<li>
<p>Connect SQL*Plus to the database with the appropriate privileges, and then run the <code class="codeph">DBMS_SQLTUNE.REPORT_TUNING_TASK</code> function.</p>
<p>For example, you run the following statements:</p>
<pre dir="ltr">SET LONG 1000
SET LONGCHUNKSIZE 1000
SET LINESIZE 100
SELECT DBMS_SQLTUNE.REPORT_TUNING_TASK( &#39;STA_SPECIFIC_EMP_TASK&#39; )
FROM   DUAL;
</pre>
<p>Truncated sample output appears below:</p>
<pre dir="ltr">DBMS_SQLTUNE.REPORT_TUNING_TASK(&#39;STA_SPECIFIC_EMP_TASK&#39;)
---------------------------------------------------------------------------
GENERAL INFORMATION SECTION
---------------------------------------------------------------------------
Tuning Task Name   : STA_SPECIFIC_EMP_TASK
Tuning Task Owner  : HR
Workload Type      : Single SQL Statement
Execution Count    : 11
Current Execution  : EXEC_1057
Execution Type     : TUNE SQL
Scope              : COMPREHENSIVE
Time Limit(seconds): 300
Completion Status  : COMPLETED
Started at         : 04/22/2012 07:35:49
Completed at       : 04/22/2012 07:35:50
 
---------------------------------------------------------------------------
Schema Name: HR
SQL ID     : dg7nfaj0bdcvk
SQL Text   : SELECT /*+ ORDERED */ * FROM employees e, locations l,
             departments d WHERE e.department_id = d.department_id AND
             l.location_id = d.location_id AND e.employee_id &lt; :bnd
Bind Variables :
 1 -  (NUMBER):100
 
---------------------------------------------------------------------------
FINDINGS SECTION (4 findings)
-----------------------------------------------
</pre></li>
<li>
<p>Interpret the results, as described in <span class="q">&#34;<a href="tgsql_sqltune.htm#GUID-C5A11E6F-9A8E-4061-BFED-39EA51C92AF7">Viewing Automatic SQL Tuning Reports Using the Command Line</a>&#34;</span>.</p>
</li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-F6C1B6A7-AE67-4FED-B376-F10F02924B0A__GUID-CA4125F3-5C01-4A7D-85FD-1BE457824FA3">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS68446" target="_blank" href="../ARPLS/d_sqltun.htm#ARPLS68446"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for complete reference information</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment4801">
<tr>
<td class="cellalignment4834">
<table class="cellalignment4806">
<tr>
<td class="cellalignment4805"><a href="tgsql_sts.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment4805"><a href="tgsql_sqlaccess.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2013, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment4836">
<table class="cellalignment4804">
<tr>
<td class="cellalignment4805"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment4805"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment4805"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment4805"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment4805"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment4805"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>