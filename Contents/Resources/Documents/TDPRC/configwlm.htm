<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-106519"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Client%20High%20Availability%20with%20Services%2C%20FAN%2C%20FCF%2C%20and%20Application%20Continuity"></a><title>Client High Availability with Services, FAN, FCF, and Application Continuity</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="description" content="You can achieve client high availability and scalability in Oracle Real Application Clusters (Oracle RAC) using database services, Fast Application Notification (FAN), Fast Connection Failover (FCF), and Application Continuity. Older applications can use Transparent Application Failover (TAF)."/>
<meta name="keywords" content="workload management, services, definition of, use with workload management, preferred instance, available instance, failover, service, management policy, Database Resource Manager, resource manager, terminology, Oracle Real Application Clusters, high availability framework, Oracle Cluster Registry (OCR), usage in Oracle RAC, Fast Application Notification, event, UP and DOWN, FAN, events, Oracle Notification Service (ONS), use by FAN callouts, callouts, Transaction Guard, transaction failover, recoverable error, error, recoverable, logical transaction ID, LXTID, transaction idempotence, idempotence, Application Continuity, overview of, Load Balancing Advisory, integrated clients, FAN load balancing, Oracle Net, configuration, listener, description of, connect descriptor, tnsnames.ora file, using for database connections, connection load balancing, load balancing, definition of, cluster database, connecting to, client-side load balancing, client-side, and client-side load balancing, server-side load balancing, server-side, and server-side load balancing, goals, connection goals, Run-time Connection Load Balancing, run-time connection, connection pools, Universal Connection Pool (UCP), affinity, creating, DBMS_SERVICE, configuring service attributes, administration, Enterprise Manager, Cluster Managed Database Services page, checking status of, JDBC clients, configuring, configuring JDBC clients, disconnect session, terminate session, kill session, sessions, disconnect, terminate, kill, configuring JDBC-Thin clients, configuring OCI clients, transactional TAF, failover type, transactional"/>
<meta name="dcterms.created" content="2017-02-17T11:56:16Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database 2 Day + Real Application Clusters Guide"/>
<meta name="dcterms.identifier" content="E17616-18"/>
<meta name="dcterms.isVersionOf" content="TDPRC"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2006, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="adminoc.htm" title="Previous" type="text/html"/>
<link rel="Next" href="racbureco.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E17616-18.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-38E1B0C5-CF5F-482B-87DA-0F4D2BD8CDC4"></a> <span id="PAGE" style="display:none;">11/17</span> <!-- End Header -->
<a id="TDPRC289"></a>
<h1 id="TDPRC-GUID-38E1B0C5-CF5F-482B-87DA-0F4D2BD8CDC4" class="sect1"><span class="enumeration_chapter">6</span> Client High Availability with Services, FAN, FCF, and Application Continuity</h1>
<div>
<p>You can achieve client high availability and scalability in Oracle Real Application Clusters (Oracle RAC) using database services, Fast Application Notification (FAN), Fast Connection Failover (FCF), and Application Continuity. Older applications can use Transparent Application Failover (TAF).</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-05437C05-720F-477A-9533-EEB78357F784">About Continuous Service Availability with Database Services</a></strong><br/>
You can deploy Oracle RAC environments to achieve continuous service in many different ways.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-8F41DEAB-CE18-48E5-B57A-A4B4FA908217">Creating Services</a></strong><br/>
You can create a service using Oracle Enterprise Manager or the SRVCTL utility.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-A59315AA-8EBE-43CC-9FFF-95A4522908BA">Administering Services</a></strong><br/>
You can create and administer services using Enterprise Manager. You can also use the SRVCTL utility to perform most service management tasks.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-47706B7C-0CD3-4334-9436-98FD1C8C60B9">Configuring Clients for High Availability</a></strong><br/>
There are three central elements to consider when automating failover for application clients.</li>
</ul>
</div>
<a id="TDPRC290"></a>
<div class="props_rev_3"><a id="GUID-05437C05-720F-477A-9533-EEB78357F784"></a>
<h2 id="TDPRC-GUID-05437C05-720F-477A-9533-EEB78357F784" class="sect2">About Continuous Service Availability with Database Services</h2>
<div>
<p>You can deploy Oracle RAC environments to achieve continuous service in many different ways.</p>
<p>Applications using a clustered database generally want to load balance their workload across the cluster. Oracle Real Application Clusters (Oracle RAC) runs on Oracle Clusterware, which provides a highly available (HA) application framework. Oracle Clusterware provides the necessary service and integration points between Oracle RAC and custom enterprise applications using FAN. Across data centers Global Data Services (GDS) also provides these integration points for services and FAN.</p>
<p>Depending on the number of nodes and your environment&#39;s complexity and objectives, your choices for the optimal workload management and high availability configuration depend on a variety of considerations.</p>
<p>To implement continuous service for your applications using Oracle RAC database, use the following features:</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-6D2CEE13-1EEA-486E-A29A-0E69D7D762A7">About Oracle Services</a></strong><br/>
Services divide workloads into mutually disjoint groupings. Each service represents a workload with common attributes, service-level thresholds, and priorities.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-EFAC8C01-0EE7-41B9-81C1-1D7D7D917DB4">About the Database Resource Manager</a></strong><br/>
The Database Resource Manager is a database feature you can use to control the database resources allocated to users, applications, and services.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-FEAE3AA1-8785-432C-B7B3-B2B3AB0430A3">About Oracle RAC High Availability Framework</a></strong><br/>
The Oracle RAC high availability framework enables Oracle RAC to maintain the database, components, and applications in a running state always.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-C32436A0-3706-4E15-96FA-BB7F92007E55">About Fast Application Notification (FAN)</a></strong><br/>
Fast Application Notification (FAN) is a high availability notification mechanism that Oracle RAC uses to notify other processes about cluster configuration and service-level information, including status changes such as <code class="codeph">UP</code> or <code class="codeph">DOWN</code> events.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-3D8A5870-E734-48CF-8DA7-338523BE69EE">About FAN Callouts</a></strong><br/>
FAN callouts are server-side executable files that Oracle RAC runs immediately when high availability events occur.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-8EFF2003-F6EA-4C6A-96A2-8629720B4592">About Using Transaction Guard for Improving Client Failover</a></strong><br/>
Transaction Guard provides a generic tool for applications to use for at-most-once execution in case of planned and unplanned outages and repeated submissions.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-7F1CE7FC-8A75-4557-94E8-6FE5633986F5">About Application Continuity for Masking Outages</a></strong><br/>
Application Continuity can mask database outages for both planned and unplanned events.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-B49734B3-028E-4FA5-A0DB-046E8122DB75">About the Load Balancing Advisory</a></strong><br/>
The Load Balancing Advisory provides information to applications or clients about the current service levels that the Oracle RAC database instances are providing.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-15212171-34EF-4E27-883B-78D2A3842F7D">About Connection Load Balancing</a></strong><br/>
Oracle Net connection load balancing spreads user connections across all the instances that support the service used to connect to the database.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-15C02742-9B15-4EEB-985C-A656E310F3D7">About Run-time Connection Load Balancing</a></strong><br/>
Run-time Connection Load Balancing is a feature of Oracle connection pools that can distribute client work requests across the instances in an Oracle RAC database based on the Load Balancing Advisory information.</li>
</ul>
<div class="infoboxnotealso" id="GUID-05437C05-720F-477A-9533-EEB78357F784__GUID-8E6792C9-14C1-44D1-A819-29E2200B5A10">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-8F41DEAB-CE18-48E5-B57A-A4B4FA908217" title="You can create a service using Oracle Enterprise Manager or the SRVCTL utility.">Creating Services</a>&#34;</span></p>
</div>
</div>
<a id="TDPRC291"></a>
<div class="props_rev_3"><a id="GUID-6D2CEE13-1EEA-486E-A29A-0E69D7D762A7"></a>
<h3 id="TDPRC-GUID-6D2CEE13-1EEA-486E-A29A-0E69D7D762A7" class="sect3">About Oracle Services</h3>
<div>
<p>Services divide workloads into mutually disjoint groupings. Each service represents a workload with common attributes, service-level thresholds, and priorities.</p>
<p><span class="bold">Dynamic database services</span>, often referred to as simply services, are logical abstractions for managing workloads in Oracle Database.A single service can represent an application, multiple applications or a subset of a single application. For example, the Oracle E-Business suite defines a service for each responsibility, such as general ledger, accounts receivable, order entry, and so on. A single service can be associated with one or more instances of an Oracle RAC database, and a single instance can support multiple services.</p>
<div class="infobox-note" id="GUID-6D2CEE13-1EEA-486E-A29A-0E69D7D762A7__GUID-7D474AF1-F314-467E-9672-2F7FCE9745E8">
<p class="notep1">Note:</p>
<p>A database service can only be offered on a single network.</p>
</div>
<p>Services provide the following benefits:</p>
<ul style="list-style-type: disc;">
<li>
<p>Provide a single entity for managing applications that compete for the same resources</p>
</li>
<li>
<p>Enable each workload to be managed as a unit</p>
</li>
<li>
<p>Hide the complexity of the cluster from the client</p>
</li>
</ul>
<p>To manage workloads, you can define services that you assign to a particular application or to a subset of an application&#39;s operations. You can also use services to manage the workload for different types of work. For example, online users can use one service while batch processing can use a different service and reporting can use yet another service type.</p>
<p>Traditionally an Oracle database provided a single service and all users connected to the same service. A database always has this default database service that is the database name. This service cannot be modified. It should only be used for administrative tasks because it always enables you to connect to the database. The default database service should not be used for high availability because it cannot be disabled or relocated. Always use user-defined database services for your applications.</p>
<div class="infobox-note" id="GUID-6D2CEE13-1EEA-486E-A29A-0E69D7D762A7__GUID-35E9618A-9F0A-4717-BB58-4084D3B95415">
<p class="notep1">Note:</p>
<p>Do not use the default database service for application workloads because the default database service is for administration purposes and cannot be modified. The default database service has the same name as the <code>DB_NAME</code> or <code>DB_UNIQUE_NAME</code> database initialization parameter. Create at least one service as described in <span class="q">&#34;<a href="configwlm.htm#GUID-8F41DEAB-CE18-48E5-B57A-A4B4FA908217" title="You can create a service using Oracle Enterprise Manager or the SRVCTL utility.">Creating Services</a>&#34;</span>.</p>
</div>
<p>When a user or application connects to a database, Oracle recommends that you use a service for the connection. Oracle Database automatically creates one database service when the database is created. For basic or administrative connections, this may be all you need. However, for more flexibility in the management of the applications connecting to the database and their workload, you should create one or more application services and specify which database instances offer the services.</p>
<p>You can define services for both policy-managed and administrator-managed databases.</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Policy-managed database</span>: When you define services for a <a href="rac_glossary.htm#GUID-8DBAEFAB-9A98-452A-9BD4-CA1FDBE61076"><span class="xrefglossterm">policy-managed database</span></a>, you assign the service to a server pool where the database is running. You can define the service as either uniform (running on all instances in the server pool) or singleton (running on only one instance in the server pool).</p>
</li>
<li>
<p><span class="bold">Administrator-managed database</span>: When you define a service for an <a href="rac_glossary.htm#GUID-E4D6B9D8-37AC-4713-9F96-D1B2C1EB99F0"><span class="xrefglossterm">administrator-managed database</span></a>, you define which instances normally support that service.These are known as the <code class="codeph">PREFERRED</code> instances. You can also define other instances to support a service if the preferred instance fails. These are known as <code class="codeph">AVAILABLE</code> instances. A service that runs on an administrator-managed database must have at least one <code class="codeph">PREFERRED</code> instance.</p>
</li>
</ul>
<p>Services are integrated with the Database Resource Manager, which enables you to restrict the resources that a service uses within an instance. In addition, Oracle Scheduler jobs can run using a service, as opposed to using a specific instance.</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-11F2B6B1-42D8-46DA-ABE5-04A764CC184B">About Service Failover in Administrator-Managed Databases</a></strong><br/>
When configuring service failover in administrator-managed databases, you must configure preferred and available instances.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-7E65FA3D-9612-488D-AE8C-1C89F88AB036">About Service Failover in Policy-Managed Databases</a></strong><br/>
Service failover in policy-managed databases behaves differently if the service is UNIFORM or SINGLETON.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-66916219-FF6E-4CA0-B425-49C57A079C0F">About Automatic Starting of Services</a></strong><br/>
When you define a service, you can also define the management policy for that service.</li>
</ul>
<div class="infoboxnotealso" id="GUID-6D2CEE13-1EEA-486E-A29A-0E69D7D762A7__GUID-EA1140D7-246C-426E-A2B9-7F372054691B">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-A59315AA-8EBE-43CC-9FFF-95A4522908BA" title="You can create and administer services using Enterprise Manager. You can also use the SRVCTL utility to perform most service management tasks.">Administering Services</a>&#34;</span></p>
</li>
<li>
<p><a class="olink ADMQS12313" target="_blank" href="../ADMQS/GUID-9ED3270A-682A-42D5-A56A-90308E5C5030.htm#ADMQS12313"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information about client connections to the database</p>
</li>
</ul>
</div>
</div>
<a id="TDPRC292"></a>
<div class="props_rev_3"><a id="GUID-11F2B6B1-42D8-46DA-ABE5-04A764CC184B"></a>
<h4 id="TDPRC-GUID-11F2B6B1-42D8-46DA-ABE5-04A764CC184B" class="sect4">About Service Failover in Administrator-Managed Databases</h4>
<div>
<p>When configuring service failover in administrator-managed databases, you must configure preferred and available instances.</p>
<p>During normal operation a service can be running on any combination of the preferred and available instances, up to the cardinality of the service (the number of <code class="codeph">PREFERRED</code> instances defined). Only at initial startup of the service will Oracle Clusterware attempt to start the service on the <code class="codeph">PREFERRED</code> instances. If an instance fails, then the service fails over to one of the combined list of preferred and available instances that is not offering the service. You can also manually relocate the service to one of the instances in the combined list of preferred and available instances not offering the service.</p>
<p>If a service fails over to an available instance, then the service is not moved back to its preferred instance automatically. However, you can automate the relocation of a service to its preferred instance by using a FAN callout.</p>
<p>If you configure a preferred instance for a service, but do not specify at least one available instance for the service, then the service does not failover to another instance if the preferred instance fails.</p>
<p>Using Enterprise Manager, you can also specify an instance as Not Used. This setting means the service does not run on the instance, even if the preferred instance for the service fails.</p>
<div class="infoboxnotealso" id="GUID-11F2B6B1-42D8-46DA-ABE5-04A764CC184B__GUID-F0A48CD5-C58A-47B2-A3A5-BBCA6647A3A3">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-3D8A5870-E734-48CF-8DA7-338523BE69EE" title="FAN callouts are server-side executable files that Oracle RAC runs immediately when high availability events occur.">About FAN Callouts</a>&#34;</span></p>
</li>
<li>
<p><a href="http://www.oracle.com/technetwork/database/options/clustering/overview/fastapplicationnotification12c-2538999.pdf" target="_blank">FAST APPLICATION NOTIFICATION WITH ORACLE DATABASE 12C</a> white paper for an example of a callout script in the section &#34;Appendix D Sample Callout program&#34;</p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-8F41DEAB-CE18-48E5-B57A-A4B4FA908217" title="You can create a service using Oracle Enterprise Manager or the SRVCTL utility.">Creating Services</a>&#34;</span></p>
</li>
<li>
<p><a class="olink HAOVW128" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=HAOVW128"><span><cite>Oracle Database High Availability Overview</cite></span></a> for more information about the high availability products and features available for Oracle Database</p>
</li>
</ul>
</div>
</div>
</div>
<a id="TDPRC587"></a>
<div class="props_rev_3"><a id="GUID-7E65FA3D-9612-488D-AE8C-1C89F88AB036"></a>
<h4 id="TDPRC-GUID-7E65FA3D-9612-488D-AE8C-1C89F88AB036" class="sect4">About Service Failover in Policy-Managed Databases</h4>
<div>
<p>Service failover in policy-managed databases behaves differently if the service is UNIFORM or SINGLETON.</p>
<p>When you specify that a service is UNIFORM, Oracle Clusterware attempts to ensure that the service always runs on all the available instances for the specified server pool. If the instance fails, then the service is no longer available on that instance. If the cardinality of the server pool increases and an instance is added to the database, then the service is started on the new instance. You cannot manually relocate the service to a specific instance.</p>
<p>When you specify that a service is SINGLETON, Oracle Clusterware attempts to ensure that the service always runs on only one of the available instances for the specified server pool. If the instance fails, then the service fails over to a different instance in the server pool. You cannot specify which instance in the server pool the service should run on.</p>
<p>For SINGLETON services, if a service fails over to a new instance, then the service is not moved back to its original instance when that instance becomes available again.</p>
<div class="infoboxnotealso" id="GUID-7E65FA3D-9612-488D-AE8C-1C89F88AB036__GUID-FF17118D-195A-4EAE-BBDB-66CC645DA47A">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-8F41DEAB-CE18-48E5-B57A-A4B4FA908217" title="You can create a service using Oracle Enterprise Manager or the SRVCTL utility.">Creating Services</a>&#34;</span></p>
</li>
<li>
<p><a class="olink RACAD7276" target="_blank" href="../RACAD/GUID-75EE86C1-E690-4624-BA83-DFB83234156C.htm#RACAD7276"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for more information about automatic workload management using database services</p>
</li>
</ul>
</div>
</div>
</div>
<a id="TDPRC500"></a>
<div class="props_rev_3"><a id="GUID-66916219-FF6E-4CA0-B425-49C57A079C0F"></a>
<h4 id="TDPRC-GUID-66916219-FF6E-4CA0-B425-49C57A079C0F" class="sect4">About Automatic Starting of Services</h4>
<div>
<p>When you define a service, you can also define the management policy for that service.</p>
<p>You can choose either an automatic or manual management policy:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Automatic</span>: The service always starts when the database starts.</p>
</li>
<li>
<p><span class="bold">Manual</span>: Requires you to start the service manually after the database starts.</p>
</li>
</ul>
<div class="infobox-note" id="GUID-66916219-FF6E-4CA0-B425-49C57A079C0F__GUID-AABC24AA-0B38-4971-9DEE-177E64D15DA5">
<p class="notep1">Note:</p>
<p>When you use automatic services in an administrator-managed database, during planned database startup, services may start on the first instances that become available rather than their preferred instances.</p>
</div>
</div>
<div>
<div class="relinfo">
<p><strong>Related Topics</strong></p>
<ul>
<li><a href="configwlm.htm#GUID-8F41DEAB-CE18-48E5-B57A-A4B4FA908217">Creating Services</a></li>
</ul>
</div>
</div>
</div>
</div>
<a id="TDPRC660"></a><a id="TDPRC293"></a>
<div class="props_rev_3"><a id="GUID-EFAC8C01-0EE7-41B9-81C1-1D7D7D917DB4"></a>
<h3 id="TDPRC-GUID-EFAC8C01-0EE7-41B9-81C1-1D7D7D917DB4" class="sect3">About the Database Resource Manager</h3>
<div>
<p>The Database Resource Manager is a database feature you can use to control the database resources allocated to users, applications, and services.</p>
<p>The Database Resource Manager ensures that users, applications, and services receive their share of the available database resources. The Database Resource Manager enables an Oracle RAC database running on one or more nodes to support multiple applications and mixed workloads with optimal efficiency.</p>
<p>The Database Resource Manager provides the ability to prioritize work within an Oracle database or your Oracle RAC environment. For example, high priority users, such as online workers, would get more resources to minimize response time, while lower priority users, such as batch jobs or reports, would get fewer resources, and could take longer to run. Database Resource Manager enables more granular control over resources.</p>
<p>Resources are allocated to users according to a resource plan specified by the database administrator. The following terms are used in specifying a resource plan:</p>
<ul style="list-style-type: disc;">
<li>
<p>A <span class="bold">resource plan</span> specifies how the resources are to be distributed among various users based on resource consumer groups.</p>
</li>
<li>
<p><span class="bold">Resource consumer groups</span> enable the administrator to group user sessions by resource requirements. Resource consumer groups are different from user roles; one database user can have different sessions assigned to different resource consumer groups.</p>
</li>
<li>
<p><span class="bold">Resource allocation methods</span> are the methods or policies used by the Database Resource Manager when allocating for a particular resource. Resource consumer groups and resource plans use the resource allocation methods. The database provides the resource allocation methods that are available, but the DBA determines which method to use.</p>
</li>
<li>
<p><span class="bold">Resource plan directives</span> are a means of assigning consumer groups to particular plans and partitioning resources among consumer groups by specifying parameters for each resource allocation method.</p>
</li>
<li>
<p><span class="bold">Subplans</span>, which the DBA can create within a resource plan, enable further subdivision of resources among different users of an application.</p>
</li>
<li>
<p><span class="bold">Levels</span> provide a mechanism to specify distribution of unused resources among available users. Up to eight levels of resource allocation can be specified.</p>
</li>
</ul>
<p>The Database Resource Manager enables you to map a resource consumer group to a service so that users who connect using that service are members of the specified resource consumer group, and thus restricted to the resources available to that resource consumer group.</p>
<p>You can access a tutorial for Resource Manager in Enterprise Manager. Simply navigate to the Cluster Database Home page, then, from the <span class="bold">Administration</span> menu, select <span class="bold">Resource Manager</span>, and then <span class="bold">Getting Started</span>. See <a class="olink ADMQS033" target="_blank" href="../ADMQS/GUID-E2807CDE-1401-4A79-8131-EBC6D45C71B4.htm#ADMQS033"><span><cite>Oracle Database 2 Day DBA</cite></span></a> for details on logging in to Oracle Enterprise Manager.</p>
<div class="infoboxnotealso" id="GUID-EFAC8C01-0EE7-41B9-81C1-1D7D7D917DB4__GUID-8DC19CB4-6E07-41E7-803B-30686F81BC19">
<p class="notep1">See Also:</p>
<p><a class="olink ADMIN027" target="_blank" href="../ADMIN/dbrm.htm#ADMIN027"><span><cite>Oracle Database Administrator&rsquo;s Guide</cite></span></a> for more information about the Database Resource Manager</p>
</div>
</div>
</div>
<a id="TDPRC294"></a>
<div class="props_rev_3"><a id="GUID-FEAE3AA1-8785-432C-B7B3-B2B3AB0430A3"></a>
<h3 id="TDPRC-GUID-FEAE3AA1-8785-432C-B7B3-B2B3AB0430A3" class="sect3">About Oracle RAC High Availability Framework</h3>
<div>
<p>The Oracle RAC high availability framework enables Oracle RAC to maintain the database, components, and applications in a running state always.</p>
<p>If an instance, component, or application fails, then it can be automatically restarted to keep Oracle Database operating at full capacity.</p>
<p>Oracle Database focuses on maintaining service availability. In Oracle RAC, Oracle services are designed to be continuously available with workloads shared across one or more instances. The Oracle RAC high availability framework maintains service availability by storing the configuration information for each service in the Oracle Cluster Registry (OCR). Oracle Clusterware recovers and balances services across instances based on the service definition.</p>
<div class="infoboxnotealso" id="GUID-FEAE3AA1-8785-432C-B7B3-B2B3AB0430A3__GUID-86106B0B-D36D-41DF-8426-1D79DADCA9A9">
<p class="notep1">See Also:</p>
<p><a class="olink HAOVW002" target="_blank" href="../HAOVW/hadesign.htm#HAOVW002"><span class="italic">Oracle Database High Availability Overview</span></a> for information about determining the high availability requirements for your system</p>
</div>
</div>
</div>
<a id="TDPRC295"></a>
<div class="props_rev_3"><a id="GUID-C32436A0-3706-4E15-96FA-BB7F92007E55"></a>
<h3 id="TDPRC-GUID-C32436A0-3706-4E15-96FA-BB7F92007E55" class="sect3">About Fast Application Notification (FAN)</h3>
<div>
<p>Fast Application Notification (FAN) is a high availability notification mechanism that Oracle RAC uses to notify other processes about cluster configuration and service-level information, including status changes such as <code class="codeph">UP</code> or <code class="codeph">DOWN</code> events.</p>
<p>One of the main requirements of a highly available application is for it to be quickly notified when something happens to critical system components. Notification enables the application to execute event-handling programs. The timely execution of such programs minimizes the time it takes to react to cluster resource organizations and the impact of cluster component failures by avoiding costly connection time outs and application time outs.</p>
<p>FAN enables the automated recovery of applications when cluster components fail. For cluster configuration changes, the Oracle RAC high availability framework publishes a FAN event immediately after a change occurs regarding the state of the instances in the cluster. Instead of waiting for the application to query the database and detect a problem, applications can receive FAN events and react immediately.</p>
<p>FAN <code class="codeph">UP</code> and <code class="codeph">DOWN</code> events can apply to instances, services, and nodes. FAN also publishes Load Balancing Advisory events. FAN <code class="codeph">UP</code> and <code class="codeph">DOWN</code> events provide the following benefits:</p>
<ul style="list-style-type: disc;">
<li>
<p>For <code class="codeph">DOWN</code> events, the disruption to the application can be minimized because sessions that are connected to the failed instance or node can be terminated. Incomplete transactions can be terminated and the application user notified immediately. Application users who request connections are directed to instances that are started and are providing the requested service.</p>
</li>
<li>
<p>For <code class="codeph">UP</code> events, when services and instances are started, new connections can be created so that the application can immediately take advantage of the extra resources.</p>
</li>
</ul>
<p>Oracle Clusterware and Oracle RAC use Oracle Notification Service (ONS) to propagate FAN messages both within the Oracle cluster and to client or mid-tier machines. ONS is installed with Oracle Clusterware and the resources to manage the ONS daemons are created automatically during the installation process. ONS daemons run on each node of the cluster and send and receive messages from a configured list of nodes where other ONS daemons are active; this list of nodes can include nodes outside the cluster, such as application server tiers or client nodes.</p>
<p>FAN can also be used with Oracle Data Guard, Active Data Guard, Oracle WebLogic Server Active GridLink for RAC, Universal Connection Pool (UCP) clients, Global Data Services, and OCI-based clients including OCI/OCCI, ODP.NET and OCI Session Pool, among others.</p>
<div class="infoboxnotealso" id="GUID-C32436A0-3706-4E15-96FA-BB7F92007E55__GUID-3B162BD7-4059-4BB2-99B8-D6B94841C090">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-15212171-34EF-4E27-883B-78D2A3842F7D" title="Oracle Net connection load balancing spreads user connections across all the instances that support the service used to connect to the database.">About Connection Load Balancing</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-B49734B3-028E-4FA5-A0DB-046E8122DB75" title="The Load Balancing Advisory provides information to applications or clients about the current service levels that the Oracle RAC database instances are providing.">About the Load Balancing Advisory</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
</div>
<a id="TDPRC296"></a>
<div class="props_rev_3"><a id="GUID-3D8A5870-E734-48CF-8DA7-338523BE69EE"></a>
<h3 id="TDPRC-GUID-3D8A5870-E734-48CF-8DA7-338523BE69EE" class="sect3">About FAN Callouts</h3>
<div>
<p>FAN callouts are server-side executable files that Oracle RAC runs immediately when high availability events occur.</p>
<p>A callout is essentially a shell script or precompiled executable written in any programming language. Some examples of how you can use FAN callouts to automate the actions performed when events occur in a cluster configuration are as follows:</p>
<ul style="list-style-type: disc;">
<li>
<p>Starting and stopping server-side applications</p>
</li>
<li>
<p>Relocating low-priority services when high-priority services come online</p>
</li>
<li>
<p>Sending text or numeric messages to pagers</p>
</li>
</ul>
<p>The executable files for FAN callouts are stored in the <code><span class="variable">Grid_home</span>/racg/usrco</code> subdirectory. If this subdirectory does not exist in your Grid home, then you must create this directory with the same permissions and ownership as the <code><span class="variable">Grid_home</span>/racg/tmp</code> subdirectory.</p>
<p>All executables in the <code><span class="variable">Grid_home</span>/racg/usrco</code> subdirectory are executed immediately, in an asynchronous fashion, when a FAN event is received through the Oracle Notification Service (ONS). For most event types, the callout is executed on one node in the cluster (the node generating the event), thus a copy of the executable files used by FAN callouts should be available on every node that runs Oracle Clusterware. An example of a callout script can be found in the section &#34;Appendix D Sample Callout program (PERL based)&#34; in the following white paper, available on Oracle Technology Network: <code class="codeph"><a href="http://www.oracle.com/technetwork/database/options/clustering/overview/fastapplicationnotification12c-2980342.pdf" target="_blank">http://www.oracle.com/technetwork/database/options/clustering/overview/fastapplicationnotification12c-2980342.pdf</a></code></p>
<div class="infoboxnotealso" id="GUID-3D8A5870-E734-48CF-8DA7-338523BE69EE__GUID-07C9EF41-D93E-4E44-8B01-4DCE9202C6A9">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink ADMIN13186" target="_blank" href="../ADMIN/restart.htm#ADMIN13186"><span><cite>Oracle Database Administrator&rsquo;s Guide</cite></span></a> for more information about using FAN callouts</p>
</li>
<li>
<p><a class="olink RACAD7128" target="_blank" href="../RACAD/GUID-EB0E1525-D3B3-469C-BE22-A569C76864A6.htm#RACAD7128"><span><cite>Oracle Real Application Clusters Administration and Deployment Guide</cite></span></a> for more information about configuring Fast Application Notification and FAN callouts</p>
</li>
</ul>
</div>
</div>
</div>
<a id="TDPRC625"></a>
<div class="props_rev_3"><a id="GUID-8EFF2003-F6EA-4C6A-96A2-8629720B4592"></a>
<h3 id="TDPRC-GUID-8EFF2003-F6EA-4C6A-96A2-8629720B4592" class="sect3">About Using Transaction Guard for Improving Client Failover</h3>
<div>
<p>Transaction Guard provides a generic tool for applications to use for at-most-once execution in case of planned and unplanned outages and repeated submissions.</p>
<p>Starting with Oracle Database 12<span class="italic">c</span>, applications can use a <a href="rac_glossary.htm#GUID-4284B105-D45D-4C8A-B4E1-20E9A69A72B9"><span class="xrefglossterm">logical transaction ID</span></a> (LTXID) to determine the outcome of the last transaction open in a database session following an outage. Without using <a href="rac_glossary.htm#GUID-B12A2DA8-6A3E-4EF3-8B5F-1DFCB2CD7253"><span class="xrefglossterm">Transaction Guard</span></a>, applications that attempt to retry operations following outages can cause logical corruption by committing duplicate transactions.</p>
<p>Without Transaction Guard, one of the fundamental problems for recovering applications after an outage is that the commit message that is sent back to the client is not durable. If there is a break between the client and the server, the client sees an error message indicating that the communication failed (also called a <a href="rac_glossary.htm#GUID-EFD0254B-4CCA-46D0-B23B-59529B8C3674"><span class="xrefglossterm">recoverable error</span></a>). This error does not inform the application whether the submission executed any commit operations, or if a procedural call ran to completion while executing all expected commits. The error also does not indicate session state changes or intermittent failures. Worse yet, the application may still be running disconnected from the client.</p>
<p>These recoverable errors can cause end users or applications that have their own replay (instead of using Application Continuity) to issue duplicate transaction submissions, re-issue changes that are already committed in the database, and other forms of &#34;logical corruption.&#34; The transaction cannot be validly resubmitted if the non-transactional state is incorrect or if it is committed. Continuing to process a committed but not completed call can result in the application using a database session that is in the wrong state.</p>
<p>In Oracle Database 12<span class="italic">c</span> Release 1 (12.1), Transaction Guard provides new, integrated tools for applications to use to achieve idempotence automatically and transparently, and in a manner that scales. Transaction Guard uses the <a href="rac_glossary.htm#GUID-4284B105-D45D-4C8A-B4E1-20E9A69A72B9"><span class="xrefglossterm">logical transaction ID</span></a> (LTXID) to eliminate duplicate transactions, a process referred to as <a href="rac_glossary.htm#GUID-D7E55950-8CF6-403C-893F-5DFA24BCD579"><span class="xrefglossterm">transaction idempotence</span></a>. The logical transaction id persists on commit and is reused following a rollback. During normal runtime, a LTXID is automatically held in the session at both the client and server for each database transaction. At commit, the LTXID persists as part of committing the transaction and the database returns the next LTXID to use to the client.</p>
<div class="example" id="GUID-8EFF2003-F6EA-4C6A-96A2-8629720B4592__GUID-FD4A7BE9-7A76-4366-AE8D-085A55016C6D">
<p class="titleinexample">Example 6-1 How Application Continuity or an Application Uses Transaction Guard</p>
<ol>
<li>
<p>The Oracle Client driver receives a FAN down event.</p>
</li>
<li>
<p>FAN automatically aborts the terminated session.</p>
</li>
<li>
<p>If it is a <a href="rac_glossary.htm#GUID-EFD0254B-4CCA-46D0-B23B-59529B8C3674"><span class="xrefglossterm">recoverable error</span></a>, then:</p>
<ol>
<li>
<p>Get the last LTXID from the failed session using the APIs provided by the client driver: <code class="codeph">getLogicalTransactionId()</code> for JDBC, <a class="olink ODPNT858" target="_blank" href="../ODPNT/OracleConnectionClass.htm#ODPNT858"><code class="codeph">LogicalTransactionId</code></a> for ODP.NET, and <a class="olink LNOCI80673" target="_blank" href="../LNOCI/oci09adv.htm#LNOCI80673"><code class="codeph">OCI_ATTR_GET</code></a> for OCI.</p>
</li>
<li>
<p>Obtain a new session.</p>
</li>
<li>
<p>Call the PL/SQL procedure <code class="codeph">DBMS_APP_CONT.GET_LTXID_OUTCOME</code> with the last LTXID gotten from the failed session.</p>
<div class="infobox-note" id="GUID-8EFF2003-F6EA-4C6A-96A2-8629720B4592__GUID-F8A5999C-91C9-4D39-A445-1D5E5B803383">
<p class="notep1">Note:</p>
<p>You must grant the <code class="codeph">EXECUTE</code> privilege on the <a class="olink ARPLS73481" target="_blank" href="../ARPLS/d_app_cont.htm#ARPLS73481"><code class="codeph">DBMS_APP_CONT</code></a> package to the database users that use the package.</p>
</div>
</li>
<li>
<p>If the outcome of this transaction is COMMITTED and COMPLETED, then return the result of that transaction to the application.</p>
</li>
<li>
<p>If the outcome of the session state (such as messages or the PL/SQL block) is COMMITTED, but not COMPLETED, then return the result of that transaction to the application and a warning that the transaction was committed, but there may be additional states such as row counts preventing the application from continuing.</p>
<div class="infobox-note" id="GUID-8EFF2003-F6EA-4C6A-96A2-8629720B4592__GUID-12070D05-5A6D-4DCA-AC77-2E311148C4FD">
<p class="notep1">Note:</p>
<p>Most applications will not need these states. This is a consideration for those that do. For those that do not care about row counts or other states from the call, then return COMMITTED to the application.</p>
</div>
</li>
<li>
<p>If the outcome of the transaction is not COMMITTED, then, the user or application can chose to resubmit the last request.</p>
</li>
</ol>
</li>
</ol>
</div>
<!-- class="example" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-8EFF2003-F6EA-4C6A-96A2-8629720B4592__GUID-8B01D15C-2007-4B5B-81C7-3D1176439133">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink ADFNS963" target="_blank" href="../ADFNS/adfns_sqlproc.htm#ADFNS963"><span class="italic">Oracle Database Development Guide</span></a> for more information about Transaction Guard and idempotence</p>
</li>
<li>
<p><a class="olink RACAD8423" target="_blank" href="../RACAD/GUID-097A5067-8CCF-4FF0-B97B-BF109DFA1841.htm#RACAD8423"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for more information about Transaction Guard and client failover for Oracle RAC</p>
</li>
<li>
<p><a class="olink JJDBC29121" target="_blank" href="../JJDBC/transactionguard.htm#JJDBC29121"><span class="italic">Oracle Database JDBC Developer&#39;s Guide</span></a> about using Transaction Guard with Java applications</p>
</li>
<li>
<p><a class="olink ODPNT8183" target="_blank" href="../ODPNT/featTG.htm#ODPNT8183"><span class="italic">Oracle Data Provider for .NET Developer&#39;s Guide for Microsoft Windows</span></a> for information about Transaction Guard support for ODP.NET applications</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="TDPRC617"></a>
<div class="props_rev_3"><a id="GUID-7F1CE7FC-8A75-4557-94E8-6FE5633986F5"></a>
<h3 id="TDPRC-GUID-7F1CE7FC-8A75-4557-94E8-6FE5633986F5" class="sect3">About Application Continuity for Masking Outages</h3>
<div>
<p>Application Continuity can mask database outages for both planned and unplanned events.</p>
<p>Following planned and unplanned outages, <a href="rac_glossary.htm#GUID-4B0E85EB-DD77-4EEA-A9F8-A8868142B3A8"><span class="xrefglossterm">Application Continuity</span></a> attempts to mask the outage by rebuilding the database session, and resubmitting the pending work following recoverable errors that make the database session unavailable.</p>
<p>When Application Continuity is configured, an end-user request is replayed if it did not complete (if replay is enabled when the outage occurred); replay is started if the time has not exceeded the replay timeout attribute specified for the service. When a component fails or becomes unresponsive, Application Continuity attempts to restore the database sessions back to the current time. When replay succeeds, this feature masks applications from transient outages (such as session failure, instance or node outages, network failures and so on) and from planned outages such as repairs, configuration changes and patching the software.</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-D0BEE14C-BC1D-4532-9965-2543447862C9">Preparing to Use Application Continuity</a></strong><br/>
Before you can use Application Continuity, you must complete various checks.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-4E3BE2EB-4E80-49BD-8BD8-DA9858203F6E">Using Application Continuity for Planned Outages</a></strong><br/>
Application Continuity is recommended for planned outages combined with draining requests from Oracle connection pools.</li>
</ul>
</div>
<a id="TDPRC640"></a>
<div class="props_rev_3"><a id="GUID-D0BEE14C-BC1D-4532-9965-2543447862C9"></a>
<h4 id="TDPRC-GUID-D0BEE14C-BC1D-4532-9965-2543447862C9" class="sect4">Preparing to Use Application Continuity</h4>
<div>
<p>Before you can use Application Continuity, you must complete various checks.</p>
<div class="section">
<p>Before you can use Application Continuity, you must configure attributes for the <a href="rac_glossary.htm#GUID-494C3882-0525-4F50-AF11-A2F0582F788D"><span class="xrefglossterm">database services</span></a> used by the applications. The application may also need to be modified to borrow and return connections rather than pin connections. This is normally a property. Request boundaries need to be added if one of the integrated pools (UCP, WLS data source) is not being used. You may also need to mark request boundaries if not returning connections to the Oracle Connection Pool and a property is not available to unpin. With Oracle Database 12<span class="italic">c</span> Release 1 (12.1), Application Continuity for Java is available for general use with the JDBC-Thin Oracle driver, the JDBC Universal Connection Pool, and WebLogic Server Active Grid Link. It is also available with OCI 12<span class="italic">c</span> when using PeopleSoft Applications.</p>
<p>To use Application Continuity with an Oracle RAC database, use the following configuration checklist:</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Service Configuration Checks</p>
<ul style="list-style-type: disc;">
<li>
<p>Create a dynamic database service (also referred to as an <span class="italic">application service</span>) to connect to the database. Do not use the Oracle SID, instance name, or the default database service to connect to an Oracle RAC or Oracle Data Guard database.</p>
</li>
<li>
<p>For the service, set <code class="codeph">failovertype</code> to <code class="codeph">TRANSACTION</code>, <code class="codeph">commit_outcome</code> to <code class="codeph">TRUE</code> and <code class="codeph">notification</code> to <code class="codeph">TRUE</code>. Optionally, to find the best connections to use, set <code class="codeph">rlb_goa</code> to <code class="codeph">SERVICE_TIME</code> and <code class="codeph">clb_gloal</code> to <code class="codeph">SHORT</code>. See <span class="q">&#34;<a href="configwlm.htm#GUID-59430519-270F-4C9A-921D-03BC611B5CFE" title="SRVCTL is a command-line interface that you can use to create services and administer Oracle Database objects that Oracle Clusterware manages. For functionality that is not available with Oracle Enterprise Manager Database Express, you can use SRVCTL commands instead.">Creating Services Using SRVCTL</a>&#34;</span>.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Software Configuration Checks (Database and Middle-tier)</p>
<ul style="list-style-type: disc;">
<li>
<p>Use Oracle Database 12<span class="italic">c</span> Release 1 (12.1) or later.</p>
</li>
<li>
<p>Use the JDBC Universal Connection Pool (12.1) or WebLogic Active GridLink (12.1.2 or later) configured with the JDBC Replay data source. You can also use the JDBC Replay data source with your own JDBC connection pool.</p>
</li>
<li>
<p>If a statement cache at the application server level is enabled (for example, the WebLogic or third-party application server statement cache), then this <span class="italic">must</span> be disabled when the replay is used. Instead, configure the JDBC statement cache, which supports Application Continuity. The JDBC statement cache also performs better because it is optimized for JDBC and Oracle. Use <code class="codeph">oracle.jdbc.implicitstatementcachesize=</code><span class="italic"><code class="codeph">nnn</code></span>.</p>
</li>
<li>
<p>Use FAN and FCF for WebLogic Active GridLink Data Source, Universal Connection Pool, or, as an option, use simple JDBC FAN with third party pool.</p>
</li>
<li>
<p>Check the resource requirements; ensure there is sufficient CPU and memory at the middle tier.</p>
<p>Application Continuity is managed on the server-side, and uses hardware when available for CRCs. On the client side, additional CPU costs are incurred for garbage collection. The replay driver requires more memory than the base driver because the calls are retained until the end of a request. At the end of the request, the calls are released to the garbage collector. This action differs from the base driver that releases closed calls.</p>
<div class="infobox-note" id="GUID-D0BEE14C-BC1D-4532-9965-2543447862C9__GUID-060C0EA1-2128-467D-9180-75DD561CEDD7">
<p class="notep1">Note:</p>
<p>CPU overhead is reduced on the database side for platforms with current Intel and Sparc chips where validation is assisted by the hardware.</p>
</div>
</li>
<li>
<p>Determine whether the application can use <span class="bold"><a href="rac_glossary.htm#GUID-9112E6BC-D60A-43BC-878B-F59A01D5D13B"><span class="xrefglossterm">mutables</span></a></span>, or sequential data that might be different on a different instance. If so, then you configure the application to keep the original values for <code class="codeph">SYSDATE</code>, <code class="codeph">SYSTIMESTAMP</code>, <code class="codeph">SYS_GUID</code>, and sequences during failover.</p>
<p>See <a class="olink SQLRF01603" target="_blank" href="../SQLRF/statements_9014.htm#SQLRF01603"><span class="italic">Oracle Database SQL Language Reference</span></a> for information on issuing the <code class="codeph">GRANT</code> privilege to users for <code class="codeph">KEEP</code> <code class="codeph">[DATE TIME|SYSGUID|</code><span class="italic"><code class="codeph">Sequence</code></span><code class="codeph">]</code>.</p>
</li>
<li>
<p>Grant <code class="codeph">EXECUTE</code> on the DBMS_APP_CONT PL/SQL package to the users that will use Application Continuity.</p>
</li>
<li>
<p>After consulting the application certification, assign the <code class="codeph">GRANT</code> privilege for keeping mutables to the users that will use replay.</p>
</li>
<li>
<p>Check with the application developers to determine if any requests should not be replayed. The application must explicitly call an API to disable replay for those requests.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Application Code Checks (consult with the application developer)</p>
<ul style="list-style-type: disc;">
<li>
<p>Determine whether the application uses Oracle JDBC concrete classes. If it does, and if access is needed to Oracle proprietary APIs, then plan to replace these concrete classes with standard JDBC or Oracle JDBC interfaces. Refer to My Oracle Support Note 1364193.1 at :</p>
<p><a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1364193.1" target="_blank"><code class="codeph">https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1364193.1</code></a></p>
</li>
<li>
<p>Use a connection string that sets connection retries and a delay between these retries. For an example of configuring the connection properties using JDBC, see <span class="q">&#34;<a href="configwlm.htm#GUID-75AD3AFE-1FCD-4749-89B7-50E82F7A91E8" title="Follow these steps to configure JDBC Clients for Fast Connection Failover.">Configuring JDBC Clients for Fast Connection Failover</a>&#34;</span>.</p>
</li>
<li>
<p>Decide whether an optional callback will be used for initializing connections from the application to the database. When using Oracle WebLogic Server or the Universal Connection Pool, connection labeling is recommended. If registered, a callback will execute at runtime and replay.</p>
</li>
<li>
<p>Determine whether replay must be explicitly disabled for any code path in the application. In particular, review external PL/SQL calls such as messaging and callouts and server side Java. If these should not be replayed, then use the <code class="codeph">disableReplay</code> API.</p>
</li>
<li>
<p>Determine whether the application must have begin and end request API&#39;s added to the application&#39;s own connection pool to identify request boundaries or if the application borrows and returns connections from the WebLogic Server Pool or Universal Connection Pool for each request.</p>
<p>If the application borrows and returns connections from the WebLogic Server Pool or Universal Connection Pool for each request, then no change is needed.</p>
<p>If the application uses Oracle connection pools, and does not return connections between requests, see if there is a property to set to return connections to the pool. If there is no property to set, or if using the application&#39;s own connection pool, then you must add <code class="codeph">beginRequest</code> and <code class="codeph">endRequest</code> boundaries.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-D0BEE14C-BC1D-4532-9965-2543447862C9__GUID-5B7312E2-201B-4EC6-A91F-3F0999E2B73B">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink ADFNS314" target="_blank" href="../ADFNS/adfns_app_continuity.htm#ADFNS314"><span class="italic">Oracle Database Development Guide</span></a> for more information on how Application Continuity works, and how you can use it in applications</p>
</li>
<li>
<p><a class="olink CNCPT966" target="_blank" href="../CNCPT/intro.htm#CNCPT966"><span class="italic">Oracle Database Concepts</span></a> for more information about transactions</p>
</li>
<li>
<p><a class="olink JJDBC29059" target="_blank" href="../JJDBC/appcontnew.htm#JJDBC29059"><span class="italic">Oracle Database JDBC Developer&#39;s Guide</span></a> for more information about Application Continuity for Java applications</p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-8F41DEAB-CE18-48E5-B57A-A4B4FA908217" title="You can create a service using Oracle Enterprise Manager or the SRVCTL utility.">Creating Services</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="TDPRC641"></a>
<div class="props_rev_3"><a id="GUID-4E3BE2EB-4E80-49BD-8BD8-DA9858203F6E"></a>
<h4 id="TDPRC-GUID-4E3BE2EB-4E80-49BD-8BD8-DA9858203F6E" class="sect4">Using Application Continuity for Planned Outages</h4>
<div>
<p>Application Continuity is recommended for planned outages combined with draining requests from Oracle connection pools.</p>
<p>Using any FAN-aware pool with FAN configured (OCI, UCP, DRCP, WebLogic Server, or ODP.NET), the steps are as follows:</p>
<ol>
<li>
<p>Use the SRVCTL <code class="codeph">relocate</code> command to relocate the service from the instance being shut down without disrupting the sessions (do not use the <code class="codeph">-force</code> parameter). If relocating a uniform service, then use <code class="codeph">srvctl stop service</code> at the instance (do not use the <code class="codeph">-force</code> parameter).</p>
</li>
<li>
<p>The FAN event for the planned outage clears the idle sessions immediately and marks the active sessions to be released at <span class="bold">check in</span> (end of request). This drains the sessions from the instance without disrupting work.</p>
</li>
<li>
<p>All sessions should check in, but in reality this does not always happen. When sufficient time has elapsed for the sessions to check in, stop the instance using the <code class="codeph">ABORT</code> shutdown option. For Application Continuity enabled pools (UCP and WebLogic Server), Application Continuity attempts to recover those remaining sessions that did not check in.</p>
<p>This step applies for UCP and WLS, and any pool that adds <code class="codeph">beginRequest</code>/<code class="codeph">endRequest</code> on JDBC Thin Replay Driver.</p>
</li>
<li>
<p>Restart the instance and service. Run-time load balancing, if enabled, balances the sessions back to use the restored instance at the next request boundaries.</p>
</li>
</ol>
</div>
</div>
</div>
<a id="TDPRC297"></a>
<div class="props_rev_3"><a id="GUID-B49734B3-028E-4FA5-A0DB-046E8122DB75"></a>
<h3 id="TDPRC-GUID-B49734B3-028E-4FA5-A0DB-046E8122DB75" class="sect3">About the Load Balancing Advisory</h3>
<div>
<p>The Load Balancing Advisory provides information to applications or clients about the current service levels that the Oracle RAC database instances are providing.</p>
<p>Applications can take advantage of the load balancing Fast Application Notification (FAN) events to direct work requests to the instance in the cluster that provides the best performance based on the workload management directives that you have defined for that service. Also, when an instance is restarted, Oracle RAC uses FAN events to notify the application&#39;s connection pool so that the connection pool can create connections to the recently started instance and take advantage of the additional resources that this instance provides.</p>
<p>The load balancing advisory is integrated with the Automatic Workload Repository built into Oracle Database 12<span class="italic">c</span>. The Automatic Workload Repository measures response time and CPU consumption for each service.</p>
<p>The advice given by the Load Balancing Advisory takes into account the power of the server and the current workload of the service on the server. Enabling the Load Balancing Advisory helps improve the throughput of applications by not sending work to instances that are overworked, running slowly, not responding, or have failed.</p>
<p>Your application can take advantage of the Load Balancing Advisory without any programmatic changes if you use an integrated Oracle client, one that has the Run-time Connection Load Balancing feature. Due to the integration with FAN, Oracle integrated clients are more aware of the current status of an Oracle cluster. This prevents client connections from waiting or trying to connect to an instance that is no longer available. The integrated clients for FAN events include the Universal Connection Pool (UCP) used by Oracle Database 12<span class="italic">c</span> JDBC, Oracle Database 12<span class="italic">c</span> ODP.NET, and Oracle Database 12<span class="italic">c</span> Oracle Call Interface (OCI).</p>
<p>You configure your Oracle RAC environment to use the Load Balancing Advisory by defining service-level goals for each service used. Defining a service-level goal enables the Load Balancing Advisory for that service and enables the publication of FAN load balancing events. There are two types of service-level goals for Run-time Connection Load Balancing:</p>
<ul style="list-style-type: disc;">
<li>
<p>Service Time. The Load Balancing Advisory attempts to direct work requests to instances according to their response time. Load Balancing Advisory data is based on the elapsed time for work done by connections using the service, and the available bandwidth to the service. This goal is best suited for workloads that require varying lengths of time to complete, for example, an internet shopping system.</p>
</li>
<li>
<p>Throughput. The Load Balancing Advisory measures the percentage of the total response time that the CPU consumes for the service. This measures the efficiency of an instance, rather than the response time. This goal is best suited for workloads where each work request completes in a similar amount of time, for example, a trading system.</p>
</li>
</ul>
<p>If you do not select the Enable Load Balancing Advisory option, then the service-level goal is set to None, which disables load balancing for that service.</p>
<div class="infoboxnotealso" id="GUID-B49734B3-028E-4FA5-A0DB-046E8122DB75__GUID-2F288BA3-37F7-4880-B728-99E73583D057">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-C32436A0-3706-4E15-96FA-BB7F92007E55" title="Fast Application Notification (FAN) is a high availability notification mechanism that Oracle RAC uses to notify other processes about cluster configuration and service-level information, including status changes such as UP or DOWN events.">About Fast Application Notification (FAN)</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-47706B7C-0CD3-4334-9436-98FD1C8C60B9" title="There are three central elements to consider when automating failover for application clients.">Configuring Clients for High Availability</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-A59315AA-8EBE-43CC-9FFF-95A4522908BA" title="You can create and administer services using Enterprise Manager. You can also use the SRVCTL utility to perform most service management tasks.">Administering Services</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-05437C05-720F-477A-9533-EEB78357F784" title="You can deploy Oracle RAC environments to achieve continuous service in many different ways.">About Continuous Service Availability with Database Services</a>&#34;</span></p>
</li>
<li>
<p><a class="olink RACAD7134" target="_blank" href="../RACAD/GUID-074729CB-8A91-419C-A6E1-3B9E4FD8D869.htm#RACAD7134"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for more information about integrated Oracle clients</p>
</li>
</ul>
</div>
</div>
</div>
<a id="TDPRC298"></a>
<div class="props_rev_3"><a id="GUID-15212171-34EF-4E27-883B-78D2A3842F7D"></a>
<h3 id="TDPRC-GUID-15212171-34EF-4E27-883B-78D2A3842F7D" class="sect3">About Connection Load Balancing</h3>
<div>
<p>Oracle Net connection load balancing spreads user connections across all the instances that support the service used to connect to the database.</p>
<p>Oracle Net is a software component that resides on the client and on the Oracle database server. It establishes and maintains the connection between the client application and the server, and exchanges messages between them using industry standard protocols. For the client application and a database to communicate, the client application must specify location details for the database it wants to connect to, and the database must provide some sort of identification or address.</p>
<p>On the database server, the Oracle Net Listener, commonly known as the listener, is a process that listens for client connection requests. The configuration file for the listener is the <code class="codeph">listener.ora</code>.</p>
<p>Oracle Database 12<span class="italic">c</span> database clients use <a href="rac_glossary.htm#GUID-6236DFEE-5B13-4BEC-9587-17CFD3B594D4"><span class="xrefglossterm">SCAN</span></a> and the easy connect method to connect to the database. SCAN can resolve to multiple IP addresses, reflecting multiple listeners in the cluster handling public client connections. When using the easy connect method, you do not have to configure any client network files. You simply specify a connect identifier with the following format:</p>
<pre dir="ltr"><span class="italic">SCAN</span>[:<span class="italic">port</span>]/<span class="italic">service_name</span>
</pre>
<p><span class="italic">SCAN</span> represents the SCAN for your cluster. If you do not specify a port number, then the default value of 1521 is used for the TCP port identifier. The <span class="italic">service_name</span> is the name of a dynamic database service.</p>
<p>You can also use Net Configuration Assistant (NETCA) to create a <span class="bold"><a href="rac_glossary.htm#GUID-E0C6C8F3-3459-4BBF-9438-55E68247B173"><span class="xrefglossterm">net service name</span></a></span>. The net service name resolves to the <a href="rac_glossary.htm#GUID-F383954D-EF5A-4DA9-8AA5-7840AFC49251"><span class="xrefglossterm">connect descriptor</span></a>. The address portion of the connect descriptor is actually the protocol address of the <a href="rac_glossary.htm#GUID-B6C6FFD7-EA46-4EB9-BA1D-87D89FA3A94A"><span class="xrefglossterm">listener</span></a>. The client uses a connect descriptor to specify the database or instance to which the client wants to connect.</p>
<p>When a net service name is used, establishing a connection to a database instance takes place by first mapping the net service name to the connect descriptor. This mapped information is stored in one or more repositories of information that are accessed using naming methods. The most commonly used naming method is Local Naming, where the net service names and their connect descriptors are stored in a localized configuration file named <code class="codeph">tnsnames.ora</code>.</p>
<p>When the client connects to the cluster database using a service, you can use the Oracle Net connection load balancing feature to spread user connections across all the instances that are supporting that service. There are two types of load balancing that you can implement: client-side and server-side load balancing. In an Oracle RAC database, client connections should use both types of connection load balancing. When you create an Oracle RAC database using Oracle Database Configuration Assistant (DBCA), DBCA configures and enables server-side load balancing by default.</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-F3299C01-53C1-4035-9107-B34085C63E49">About Client-Side Load Balancing</a></strong><br/>
Client-side load balancing balances the connection requests across the listeners.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-6EC8C849-AF66-4878-8B40-23DC1C51D05F">About Server-Side Load Balancing</a></strong><br/>
With server-side load balancing, the listener directs a connection request to the best instance currently providing the service by using information from the Load Balancing Advisory.</li>
</ul>
<div class="infoboxnotealso" id="GUID-15212171-34EF-4E27-883B-78D2A3842F7D__GUID-531D058C-BF06-44BE-8D20-110624EB397B">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-05437C05-720F-477A-9533-EEB78357F784" title="You can deploy Oracle RAC environments to achieve continuous service in many different ways.">About Workload Management with Dynamic Database Services</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-5179D010-2D9A-4339-8C3B-C0B71D6F8ABA" title="By configuring and using a SCAN for your cluster, you no longer have to modify the network setup on each client. Using the lsnrctl utility you can verify that the new service is recognized by Oracle Net and available to the database clients.">Verifying Oracle Net Supports Newly Created Services</a>&#34;</span></p>
</li>
<li>
<p><a class="olink ADMQS041" target="_blank" href="../ADMQS/GUID-98E0E5CB-0D6F-4BCB-960B-9B96C6A9AD9B.htm#ADMQS041"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information about network configurations</p>
</li>
<li>
<p><a class="olink ADMQS12313" target="_blank" href="../ADMQS/GUID-9ED3270A-682A-42D5-A56A-90308E5C5030.htm#ADMQS12313"><span class="italic">Oracle Database 2 Day DBA</span></a></p>
</li>
<li>
<p><a class="olink ADMQS042" target="_blank" href="../ADMQS/GUID-3537A14F-BAA4-41D4-99AE-F33926FC637C.htm#ADMQS042"><span class="italic">Oracle Database 2 Day DBA</span></a></p>
</li>
</ul>
</div>
</div>
<a id="TDPRC299"></a>
<div class="props_rev_3"><a id="GUID-F3299C01-53C1-4035-9107-B34085C63E49"></a>
<h4 id="TDPRC-GUID-F3299C01-53C1-4035-9107-B34085C63E49" class="sect4">About Client-Side Load Balancing</h4>
<div>
<p>Client-side load balancing balances the connection requests across the listeners.</p>
<p>When the listener receives the connection request, the listener connects the user to an instance that the listener knows provides the requested service.</p>
<p>Client-side load balancing is defined in your client connection definition by setting the parameter <code class="codeph">LOAD_BALANCE=yes</code> in the <code class="codeph">tnsnames.ora</code> file. When you set this parameter to <code class="codeph">yes</code>, the Oracle client randomly selects an address from the address list, and connects to that node&#39;s listener. This balances client connections across the available listeners in the cluster.</p>
<p>When you create an Oracle RAC database using DBCA, the assistant creates a sample load balancing connection definition in the <code class="codeph">tnsnames.ora</code> file.</p>
<p>Client-side load balancing includes connection failover. With connection failover, if an error is returned from the chosen address, then Oracle Net Services tries the next address in the address list until either a successful connection is made or it has exhausted all the addresses in the list.</p>
<div class="infoboxnotealso" id="GUID-F3299C01-53C1-4035-9107-B34085C63E49__GUID-DB0522F5-141F-4546-80B3-8B80ACBB64BC">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-15212171-34EF-4E27-883B-78D2A3842F7D" title="Oracle Net connection load balancing spreads user connections across all the instances that support the service used to connect to the database.">About Connection Load Balancing</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-B49734B3-028E-4FA5-A0DB-046E8122DB75" title="The Load Balancing Advisory provides information to applications or clients about the current service levels that the Oracle RAC database instances are providing.">About the Load Balancing Advisory</a>&#34;</span></p>
</li>
<li>
<p><a class="olink ADMQS041" target="_blank" href="../ADMQS/GUID-98E0E5CB-0D6F-4BCB-960B-9B96C6A9AD9B.htm#ADMQS041"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information about network configurations</p>
</li>
<li>
<p><a class="olink ADMQS12313" target="_blank" href="../ADMQS/GUID-9ED3270A-682A-42D5-A56A-90308E5C5030.htm#ADMQS12313"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information about client connections</p>
</li>
<li>
<p><a class="olink ADMQS042" target="_blank" href="../ADMQS/GUID-3537A14F-BAA4-41D4-99AE-F33926FC637C.htm#ADMQS042"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information about the tools you can use for configuring the network</p>
</li>
</ul>
</div>
</div>
</div>
<a id="TDPRC300"></a>
<div class="props_rev_3"><a id="GUID-6EC8C849-AF66-4878-8B40-23DC1C51D05F"></a>
<h4 id="TDPRC-GUID-6EC8C849-AF66-4878-8B40-23DC1C51D05F" class="sect4">About Server-Side Load Balancing</h4>
<div>
<p>With server-side load balancing, the listener directs a connection request to the best instance currently providing the service by using information from the Load Balancing Advisory.</p>
<p>For each service, you can define the method the listener uses for load balancing by setting the connection load balancing goal. You can use a goal of either long or short for connection load balancing. These goals have the following characteristics:</p>
<ul style="list-style-type: disc;">
<li>
<p>Short&mdash;Connections are distributed across instances based on the best response time. Use the Short connection load balancing goal for applications that have connections of brief duration.</p>
</li>
<li>
<p>Long&mdash;Connections are distributed across instances based on the number of sessions in each instance, for each instance that supports the service. Use the Long connection load balancing goal for applications that have connections of long duration. This is typical for connection pools and SQL*Forms sessions. Long is the default connection load balancing goal.</p>
</li>
</ul>
<div class="infobox-note" id="GUID-6EC8C849-AF66-4878-8B40-23DC1C51D05F__GUID-B1161F97-1D8D-41FC-B70A-EBD97CA07883">
<p class="notep1">Note:</p>
<p>If you did not use DBCA to create your database, or if you are using listener ports other than the default of 1521, then you must configure the <code class="codeph">LOCAL_LISTENER</code> and <code class="codeph">REMOTE_LISTENER</code> database initialization parameters for your cluster database to point to <span class="italic"><code class="codeph">SCAN:port</code></span>.</p>
</div>
<div class="infoboxnotealso" id="GUID-6EC8C849-AF66-4878-8B40-23DC1C51D05F__GUID-21F59695-EF4B-4E83-938B-485AE9208001">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-15212171-34EF-4E27-883B-78D2A3842F7D" title="Oracle Net connection load balancing spreads user connections across all the instances that support the service used to connect to the database.">About Connection Load Balancing</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-B49734B3-028E-4FA5-A0DB-046E8122DB75" title="The Load Balancing Advisory provides information to applications or clients about the current service levels that the Oracle RAC database instances are providing.">About the Load Balancing Advisory</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<a id="TDPRC302"></a><a id="TDPRC301"></a>
<div class="props_rev_3"><a id="GUID-15C02742-9B15-4EEB-985C-A656E310F3D7"></a>
<h3 id="TDPRC-GUID-15C02742-9B15-4EEB-985C-A656E310F3D7" class="sect3">About Run-time Connection Load Balancing</h3>
<div>
<p>Run-time Connection Load Balancing is a feature of Oracle connection pools that can distribute client work requests across the instances in an Oracle RAC database based on the Load Balancing Advisory information.</p>
<p>The connection allocation is based on the current performance level provided by the database instances as indicated by the Load Balancing Advisory FAN events. This provides load balancing at the transaction level, instead of load balancing at the time of the initial database connection.</p>
<p>With Run-time Connection Load Balancing, applications use Load Balancing Advisory information to provide better performance to users. OCI Session pools and ODP.NET connection pools support Run-time Connection Load Balancing. For Java applications, Oracle recommends the Universal Connection Pool (UCP). The Universal Connection Pool is integrated to take advantage of Load Balancing Advisory information. UCP, introduced in Oracle Database 11<span class="italic">g</span> patch set 1 (11.1.0.7), can be used against Oracle Database 10<span class="italic">g</span>, Oracle Database 11<span class="italic">g</span>, or Oracle Database 12<span class="italic">c</span>.</p>
<p>You must enable the client data source for Run-time Connection Load Balancing with a service that has the following configuration:</p>
<ul style="list-style-type: disc;">
<li>
<p>The Load Balancing Advisory is enabled and the service-level goal is set to <code class="codeph">SERVICE_TIME</code>, <code class="codeph">THROUGHPUT</code> , or <code class="codeph">NONE</code>.</p>
</li>
<li>
<p>The service connection load balancing goal is set to Short.</p>
</li>
</ul>
<p>The illustration in the steps below illustrates Run-time Connection Load Balancing. In this illustration, the Oracle RAC database has three instances. Suppose that the Load Balancing Advisory indicates that Instance1 and Instance3 have the best performance, while Instance2 currently has less than optimal performance. When Run-time Connection Load Balancing is enabled for the Universal Connection Pool, the following process occurs:</p>
<ol>
<li>
<p>A client requests a connection from the connection pool.</p>
</li>
<li>
<p>Run-time Connection Load Balancing selects the connection that belongs to the most efficient (best) instance from the connection pool. In the illustration in the next step, there are three possible nodes to which the connection can be routed. Instance1, which has the least amount of CPU workload, is currently being assigned about 60 percent of the incoming connections. Instance2, which is currently overloaded, is only being assigned around 10 percent of the incoming connections. Instance3, which has a high workload, is being assigned around 30 percent of the incoming connections. The best instance to handle the connection request in this case would be Instance1.</p>
</li>
<li>
<p>The client receives the connection that would process the work request with the best response time.</p>
</li>
</ol>
<div class="figure" id="GUID-15C02742-9B15-4EEB-985C-A656E310F3D7__GUID-047A38B1-5B4D-42C8-84CA-20401C0F8C0A">
<p class="titleinfigure">Figure 6-1 Run-time Connection Load Balancing</p>
<img width="356" height="521" src="img/GUID-EBE62ACB-5F3A-4AB4-AA1E-71048C988FA3-default.gif" alt="Description of Figure 6-1 follows" title="Description of Figure 6-1 follows"/><br/>
<a href="img_text/GUID-EBE62ACB-5F3A-4AB4-AA1E-71048C988FA3-print.htm">Description of &#34;Figure 6-1 Run-time Connection Load Balancing&#34;</a></div>
<!-- class="figure" -->
<p>Starting with Oracle Database 11<span class="italic">g</span> you can use an additional flag in the load balancing advisory event called <strong class="term">affinity hint</strong>. The affinity hint is a flag that indicates if affinity is a benefit for a particular instance and service combination. Different instances offering the same service can have different settings for the affinity hint.</p>
<p>The affinity hint is automatic when the load balancing advisory is turned on through setting the goal on the service. This flag is for temporary affinity that lasts for the duration of a web session. Web conversations often connect and disconnect many times during the entire session. During each of these connects, it may access the same or similar data, for example, a shopping cart, Siebel, and so on. Affinity can improve buffer cache efficiency, which lowers CPU usage and transaction latency.</p>
<p>Applications using Oracle Database 12<span class="italic">c</span> and UCP can take advantage of this new affinity feature. If the affinity flag is turned on in the Load Balancing Advisory event, then UCP creates an Affinity Context for the web session such that when that session does a get connection from the pool, the pool always tries to give it a connection to the instance it connected to the first time it acquired a session. The choice of instance for the first connection is based on the current load balancing advisory information.</p>
</div>
<div>
<div class="relinfo">
<p><strong>Related Topics</strong></p>
<ul>
<li><a href="configwlm.htm#GUID-15212171-34EF-4E27-883B-78D2A3842F7D">About Connection Load Balancing</a></li>
<li><a href="configwlm.htm#GUID-B49734B3-028E-4FA5-A0DB-046E8122DB75">About the Load Balancing Advisory</a></li>
<li><a href="configwlm.htm#GUID-3D8A5870-E734-48CF-8DA7-338523BE69EE">About FAN Callouts</a></li>
</ul>
</div>
</div>
</div>
</div>
<a id="TDPRC303"></a>
<div class="props_rev_3"><a id="GUID-8F41DEAB-CE18-48E5-B57A-A4B4FA908217"></a>
<h2 id="TDPRC-GUID-8F41DEAB-CE18-48E5-B57A-A4B4FA908217" class="sect2">Creating Services</h2>
<div>
<p>You can create a service using Oracle Enterprise Manager or the SRVCTL utility.</p>
<div class="infobox-note" id="GUID-8F41DEAB-CE18-48E5-B57A-A4B4FA908217__GUID-2334FF94-0829-4168-B201-20B969A02465">
<p class="notep1">Note:</p>
The <code class="codeph">DBMS_SERVICE</code> package will create the database structures necessary to offer a service, but none of the Oracle Clusterware functionality is configured, such as service placement, failure characteristics and so on.</div>
<p>To manage workloads, you can define <a href="rac_glossary.htm#GUID-494C3882-0525-4F50-AF11-A2F0582F788D"><span class="xrefglossterm">database services</span></a> that you assign to a particular application or to a subset of an application&#39;s operations. You can also use services to manage the workload for different types of work.</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-51A2449B-4142-438A-8BC8-A446211DA85F">Creating Services Using Enterprise Manager</a></strong><br/>
You can use either Oracle Enterprise Manager Cloud Control or Oracle Enterprise Manager Database Express to create services.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-59430519-270F-4C9A-921D-03BC611B5CFE">Creating Services Using SRVCTL</a></strong><br/>
SRVCTL is a command-line interface that you can use to create services and administer Oracle Database objects that Oracle Clusterware manages. For functionality that is not available with Oracle Enterprise Manager Database Express, you can use SRVCTL commands instead.</li>
</ul>
</div>
<a id="TDPRC304"></a><a id="TDPRC631"></a>
<div class="props_rev_3"><a id="GUID-51A2449B-4142-438A-8BC8-A446211DA85F"></a>
<h3 id="TDPRC-GUID-51A2449B-4142-438A-8BC8-A446211DA85F" class="sect3">Creating Services Using Enterprise Manager</h3>
<div>
<p>You can use either Oracle Enterprise Manager Cloud Control or Oracle Enterprise Manager Database Express to create services.</p>
<div class="section">
<p class="subhead3">To create a service using Enterprise Manager:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>In Oracle Enterprise Manager, go to the Cluster Database Home page.</span>
<div>
<p>See <a class="olink ADMQS033" target="_blank" href="../ADMQS/GUID-E2807CDE-1401-4A79-8131-EBC6D45C71B4.htm#ADMQS033"><span class="italic">Oracle Database 2 Day DBA</span></a> for details on logging in to Oracle Enterprise Manager.</p>
</div>
</li>
<li class="stepexpand"><span>From the <span class="bold">Availability</span> menu, select <span class="bold">Cluster Managed Database Services</span>. Enter or confirm the credentials for the Oracle RAC database and host operating system and click <span class="bold">Continue</span>.</span>
<div>
<p>The Cluster Managed Database Services page appears.</p>
</div>
</li>
<li class="stepexpand"><span>Click <span class="bold">Create Service</span>.</span>
<div>
<p>The Create Service page appears.</p>
</div>
</li>
<li class="stepexpand"><span>Enter the name of your service in the Service Name field, for example, <code class="codeph">DEVUSERS</code>.</span></li>
<li class="stepexpand"><span>Select <span class="bold">Start Service after creation</span> if you want the service to be started after it is created. Select <span class="bold">Update local naming parameter (tnsnames.ora) file</span> if you want Oracle Enterprise Manager Cloud Control to add the new service to the local Oracle Net Services <code class="codeph">tnsnames.ora</code> file.</span>
<div>
<div class="figure" id="GUID-51A2449B-4142-438A-8BC8-A446211DA85F__GUID-B676C8FB-9897-448F-B04C-86BFF3C89A37"><img width="939" height="181" src="img/GUID-DA3D403A-3681-447C-A64E-1B6BA6F90743-default.gif" alt="Description of GUID-DA3D403A-3681-447C-A64E-1B6BA6F90743-default.gif follows" title="Description of GUID-DA3D403A-3681-447C-A64E-1B6BA6F90743-default.gif follows"/><br/>
<a href="img_text/GUID-DA3D403A-3681-447C-A64E-1B6BA6F90743-default.htm">Description of the illustration GUID-DA3D403A-3681-447C-A64E-1B6BA6F90743-default.gif</a></div>
<!-- class="figure" --></div>
</li>
<li class="stepexpand"><span>(Policy-managed databases only) For the service type, select <span class="bold">UNIFORM</span> or SINGLETON.</span>
<div>
<div class="figure" id="GUID-51A2449B-4142-438A-8BC8-A446211DA85F__GUID-AA1A0006-DA8B-43A5-8237-B29CD9DDD21F"><img width="747" height="131" src="img/GUID-A0550CAD-5146-41DD-A816-86C9A9AE15E1-default.gif" alt="Description of GUID-A0550CAD-5146-41DD-A816-86C9A9AE15E1-default.gif follows" title="Description of GUID-A0550CAD-5146-41DD-A816-86C9A9AE15E1-default.gif follows"/><br/>
<a href="img_text/GUID-A0550CAD-5146-41DD-A816-86C9A9AE15E1-default.htm">Description of the illustration GUID-A0550CAD-5146-41DD-A816-86C9A9AE15E1-default.gif</a></div>
<!-- class="figure" --></div>
</li>
<li class="stepexpand"><span>(Administrator-managed databases only) For each instance choose whether that instance is a Preferred instance or an Available instance. If you do not want the service to run on an instance under any circumstances, then set the Service Policy for that instance to Not Used.</span>
<div>
<div class="figure" id="GUID-51A2449B-4142-438A-8BC8-A446211DA85F__GUID-1441F27D-372C-46D7-B827-5DEE1AAEFB82"><img width="608" height="153" src="img/GUID-56F16C8C-66C0-42C0-9B9E-B8EF3AE615D5-default.gif" alt="Description of GUID-56F16C8C-66C0-42C0-9B9E-B8EF3AE615D5-default.gif follows" title="Description of GUID-56F16C8C-66C0-42C0-9B9E-B8EF3AE615D5-default.gif follows"/><br/>
<a href="img_text/GUID-56F16C8C-66C0-42C0-9B9E-B8EF3AE615D5-default.htm">Description of the illustration GUID-56F16C8C-66C0-42C0-9B9E-B8EF3AE615D5-default.gif</a></div>
<!-- class="figure" --></div>
</li>
<li class="stepexpand"><span>In the Service Properties section, select <span class="bold">Short</span> for Connection Load Balancing Goal to distribute the connection workload based on elapsed time instead of the overall number of connections. Otherwise, choose <span class="bold">Long</span>.</span></li>
<li class="stepexpand"><span>Select <span class="bold">Enable Load Balancing Advisory</span> under the sub-heading Notification Properties to enable the Load Balancing Advisory for this service, as shown in the following screenshot. Choose a service-level goal of either <span class="bold">Service Time</span> or <span class="bold">Throughput</span>.</span>
<div>
<div class="figure" id="GUID-51A2449B-4142-438A-8BC8-A446211DA85F__GUID-2E73220B-9CB4-4A6A-B91E-F336E4BEB2E0"><img width="930" height="608" src="img/GUID-23B78CCF-DA59-4C48-8896-0389FBBFCCB2-default.gif" alt="Description of GUID-23B78CCF-DA59-4C48-8896-0389FBBFCCB2-default.gif follows" title="Description of GUID-23B78CCF-DA59-4C48-8896-0389FBBFCCB2-default.gif follows"/><br/>
<a href="img_text/GUID-23B78CCF-DA59-4C48-8896-0389FBBFCCB2-default.htm">Description of the illustration GUID-23B78CCF-DA59-4C48-8896-0389FBBFCCB2-default.gif</a></div>
<!-- class="figure" --></div>
</li>
<li class="stepexpand"><span>Select <span class="bold">Enable Fast Application Notification</span> under the heading Notification Properties if an Oracle Call Interface (OCI) or ODP.NET application uses this service, and you want to enable FAN.</span></li>
<li class="stepexpand"><span>In the Service Threshold Levels section, you can optionally set the service-level thresholds by entering a value in milliseconds for Warning and Critical thresholds for the Elapsed Time and CPU Time metrics.</span></li>
<li class="stepexpand"><span>If you want to use a Resource Plan to control the resources used by this service, then select the name of the consumer group from the Consumer Group Mapping list in the Resource Management Properties section. For example, you might choose the <code class="codeph">LOW_GROUP</code> consumer group to give development users low priority to database resources.</span>
<div>
<div class="infobox-note" id="GUID-51A2449B-4142-438A-8BC8-A446211DA85F__GUID-C475582B-D8A5-438B-8606-576EAF51447D">
<p class="notep1">Note:</p>
<p>You cannot change the consumer group name for a service on the Edit Service page. This is because there may be several consumer groups associated with a given service. However, the Edit Service page contains a link to the Resource Consumer Group Mapping page, where you can modify the consumer group mapping for the service.</p>
</div>
</div>
</li>
<li class="stepexpand"><span>If a specific Oracle Scheduler job class uses this service, then you can specify the mapping by selecting the name from the Job Scheduler Mapping list in the Resource Management Properties.</span></li>
<li class="stepexpand"><span>Click <span class="bold">OK</span> to create the service.</span></li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-51A2449B-4142-438A-8BC8-A446211DA85F__GUID-7CBA6B17-B7FB-45EE-88F2-27811BA64FB2">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-05437C05-720F-477A-9533-EEB78357F784" title="You can deploy Oracle RAC environments to achieve continuous service in many different ways.">About Workload Management with Dynamic Database Services</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-15212171-34EF-4E27-883B-78D2A3842F7D" title="Oracle Net connection load balancing spreads user connections across all the instances that support the service used to connect to the database.">About Connection Load Balancing</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-B49734B3-028E-4FA5-A0DB-046E8122DB75" title="The Load Balancing Advisory provides information to applications or clients about the current service levels that the Oracle RAC database instances are providing.">About the Load Balancing Advisory</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-C32436A0-3706-4E15-96FA-BB7F92007E55" title="Fast Application Notification (FAN) is a high availability notification mechanism that Oracle RAC uses to notify other processes about cluster configuration and service-level information, including status changes such as UP or DOWN events.">About Fast Application Notification (FAN)</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-A59315AA-8EBE-43CC-9FFF-95A4522908BA" title="You can create and administer services using Enterprise Manager. You can also use the SRVCTL utility to perform most service management tasks.">Administering Services</a>&#34;</span></p>
</li>
<li>
<p><a class="olink ADMIN033" target="_blank" href="../ADMIN/schedover.htm#ADMIN033"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for more information about the Oracle Scheduler</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="TDPRC633"></a><a id="TDPRC632"></a>
<div class="props_rev_3"><a id="GUID-59430519-270F-4C9A-921D-03BC611B5CFE"></a>
<h3 id="TDPRC-GUID-59430519-270F-4C9A-921D-03BC611B5CFE" class="sect3">Creating Services Using SRVCTL</h3>
<div>
<div><span>SRVCTL is a command-line interface that you can use to create services and administer Oracle Database objects that Oracle Clusterware manages. For functionality that is not available with Oracle Enterprise Manager Database Express, you can use SRVCTL commands instead.</span> See <a class="olink RACAD005" target="_blank" href="../RACAD/GUID-3ED4DBCE-A148-462B-8A79-534A3F0D6E7D.htm#RACAD005"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for information about how to use the SRVCTL utility.</div>
<div class="section">
<p class="subhead3">To configure services for Application Continuity or Transaction Guard using SRVCTL:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>To configure services for Application Continuity, you must set the service attributes <code class="codeph">failovertype</code> to <code class="codeph">TRANSACTION</code>, <code class="codeph">commit_outcome</code> to <code class="codeph">TRUE</code>, and <code class="codeph">notification</code> to <code class="codeph">TRUE</code>. Additionally, you can set values for these other service attributes for Application Continuity and load balancing:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">replay_init_time</code>: Specifies the time in seconds after which replay will not be started; example settings are 60, 300, or 600 seconds; the recommended value is 900 seconds.</p>
</li>
<li>
<p><code class="codeph">retention</code>: Specifies the time (in seconds) that the commit outcome is retained for Transaction Guard. Recommended value is 86400 (24 hours).</p>
</li>
<li>
<p><code class="codeph">failoverretry</code>: Number of connection retries for each replay attempt; recommended value is 30.</p>
</li>
<li>
<p><code class="codeph">failoverdelay</code>: Delay in seconds between connection retries; recommended value is 10.</p>
</li>
<li>
<p><code class="codeph">clbgoal</code>: For connection load balancing, use <code class="codeph">SHORT</code> when using run-time load balancing.</p>
</li>
<li>
<p><code class="codeph">rlbgoal</code>: Set to <code class="codeph">SERVICE_TIME</code>.</p>
</li>
</ul>
<p>To use SRVCTL to modify the service attributes, use a command similar to the following, where <code class="codeph"><span class="variable">racdb</span></code> is the name of your Oracle RAC database, and <code class="codeph"><span class="variable">app1</span></code> is the name of the service you are modifying:</p>
<pre dir="ltr">srvctl modify service -db <span class="variable">racdb</span> -service <span class="variable">app1</span> -clbgoal SHORT 
-rlbgoal SERVICE_TIME -failoverretry 30 -failoverdelay 10 
-failovertype TRANSACTION -replay_init_time 1800 -retention 86400 
-notification TRUE commit_outcome TRUE
</pre></div>
</li>
<li class="stepexpand"><span>To create a service for Application Continuity for a policy-managed Oracle RAC database, use a command similar to the following, where <code class="codeph"><span class="variable">racdb</span></code> is the name of your Oracle RAC database, <code class="codeph"><span class="variable">app2</span></code> is the name of the service you are modifying, and <code class="codeph"><span class="variable">Svrpool1</span></code> is the name of the server pool in which the service is offered:</span>
<div>
<pre dir="ltr">srvctl modify service -db <span class="variable">racdb</span> -service <span class="variable">app2</span> -serverpool ora.<span class="variable">Srvpool1</span>
-clbgoal SHORT -rlbgoal SERVICE_TIME -failoverretry 30
-failoverdelay 10 -failovertype TRANSACTION -replay_init_time 1800 
-retention 86400 -notification TRUE -commit_outcome TRUE
</pre></div>
</li>
<li class="stepexpand"><span>To enable Transaction Guard, and but not Application Continuity, create the service with <code class="codeph">commit_outcome</code> = TRUE. You can also use the attribute <code class="codeph">retention</code> to specify how long in seconds to maintain the history. Additionally, it is recommended that you set the attribute <code class="codeph">notification</code> to TRUE, for FAN events.</span>
<div>
<p>To use SRVCTL to modify the service attributes, use a command similar to the following, where <code class="codeph"><span class="variable">racdb</span></code> is the name of your Oracle RAC database, and <code class="codeph"><span class="variable">app2</span></code> is the name of the service you are creating:</p>
<pre dir="ltr">srvctl modify service -db <span class="variable">racdb</span> -service <span class="variable">app2</span> -commit_outcome TRUE -retention 86400 -notification TRUE
</pre></div>
</li>
</ol>
</div>
</div>
</div>
<a id="TDPRC307"></a>
<div class="props_rev_3"><a id="GUID-A59315AA-8EBE-43CC-9FFF-95A4522908BA"></a>
<h2 id="TDPRC-GUID-A59315AA-8EBE-43CC-9FFF-95A4522908BA" class="sect2">Administering Services</h2>
<div>
<p>You can create and administer services using Enterprise Manager. You can also use the SRVCTL utility to perform most service management tasks.</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-68C8A269-BDB6-4FFC-A5CF-3FDDB84143BC">About Service Administration Using Enterprise Manager</a></strong><br/>
The Cluster Managed Database Services page is the master page for beginning all tasks related to services.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-31B667D0-5780-42C9-9588-7F768C22E5CE">Using the Cluster Managed Database Services Page</a></strong><br/>
When managing services using Enterprise Manager, you use the Cluster Managed Database Services page.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-5179D010-2D9A-4339-8C3B-C0B71D6F8ABA">Verifying Oracle Net Supports Newly Created Services</a></strong><br/>
By configuring and using a SCAN for your cluster, you no longer have to modify the network setup on each client. Using the <code class="codeph">lsnrctl</code> utility you can verify that the new service is recognized by Oracle Net and available to the database clients.</li>
</ul>
<div class="infoboxnotealso" id="GUID-A59315AA-8EBE-43CC-9FFF-95A4522908BA__GUID-FEA02A0A-C05B-41BB-BE84-8733BDF1D95B">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-6D2CEE13-1EEA-486E-A29A-0E69D7D762A7" title="Services divide workloads into mutually disjoint groupings. Each service represents a workload with common attributes, service-level thresholds, and priorities.">About Oracle Services</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-8F41DEAB-CE18-48E5-B57A-A4B4FA908217" title="You can create a service using Oracle Enterprise Manager or the SRVCTL utility.">Creating Services</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
<a id="TDPRC308"></a>
<div class="props_rev_3"><a id="GUID-68C8A269-BDB6-4FFC-A5CF-3FDDB84143BC"></a>
<h3 id="TDPRC-GUID-68C8A269-BDB6-4FFC-A5CF-3FDDB84143BC" class="sect3">About Service Administration Using Enterprise Manager</h3>
<div>
<p>The Cluster Managed Database Services page is the master page for beginning all tasks related to services.</p>
<p>To access this page, go to the Cluster Database Maintenance page, then click <span class="bold">Cluster Managed Database Services</span> in the Services section. You can use this page and links from this page to do the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>View a list of services for the cluster.</p>
</li>
<li>
<p>View the instances on which each service is currently running.</p>
</li>
<li>
<p>View the status for each service.</p>
</li>
<li>
<p>Create or edit a service.</p>
</li>
<li>
<p>Start or stop a service.</p>
</li>
<li>
<p>Enable or disable a service.</p>
</li>
<li>
<p>Perform instance-level tasks for a service.</p>
</li>
<li>
<p>Delete a service.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-68C8A269-BDB6-4FFC-A5CF-3FDDB84143BC__GUID-DA75B9FB-9DA7-4A35-8E52-4F1C1E96E68A">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-6D2CEE13-1EEA-486E-A29A-0E69D7D762A7" title="Services divide workloads into mutually disjoint groupings. Each service represents a workload with common attributes, service-level thresholds, and priorities.">About Oracle Services</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-8F41DEAB-CE18-48E5-B57A-A4B4FA908217" title="You can create a service using Oracle Enterprise Manager or the SRVCTL utility.">Creating Services</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
</div>
<a id="TDPRC310"></a><a id="TDPRC309"></a>
<div class="props_rev_3"><a id="GUID-31B667D0-5780-42C9-9588-7F768C22E5CE"></a>
<h3 id="TDPRC-GUID-31B667D0-5780-42C9-9588-7F768C22E5CE" class="sect3">Using the Cluster Managed Database Services Page</h3>
<div>
<p>When managing services using Enterprise Manager, you use the Cluster Managed Database Services page.</p>
<div class="section">
<p class="subhead3">To access the Cluster Managed Database Services page:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>In Oracle Enterprise Manager, go to the Cluster Database Home page.</span>
<div>
<p>See <a class="olink ADMQS033" target="_blank" href="../ADMQS/GUID-E2807CDE-1401-4A79-8131-EBC6D45C71B4.htm#ADMQS033"><span class="italic">Oracle Database 2 Day DBA</span></a> for details on logging in to Oracle Enterprise Manager.</p>
</div>
</li>
<li class="stepexpand"><span>From the <span class="bold">Availability</span> menu, select <span class="bold">Cluster Managed Database Services</span>. Enter or confirm the credentials for the Oracle RAC database and host operating system and click <span class="bold">Continue</span>.</span>
<div>
<p>The Cluster Managed Database Services page appears and displays the services that are available on the cluster database instances.</p>
</div>
</li>
<li class="stepexpand"><span>Perform any of the following tasks using this page:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p>View a list of services for the cluster, the instances on which each service is currently running, the status of each service, the server pool associated with the service, the responsiveness of the service, and any alerts or messages for that service.</p>
</li>
<li>
<p>Start or stop a service.</p>
</li>
<li>
<p>Test the connection for a service, or display the Oracle Net TNS strings being used.</p>
</li>
<li>
<p>Access the Create Service page.</p>
</li>
<li>
<p>Edit, delete, enable, or disable a service.</p>
</li>
<li>
<p>Access the Edit Server Pool page for the server pool associate with each service.</p>
</li>
</ul>
</div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-31B667D0-5780-42C9-9588-7F768C22E5CE__GUID-EFB83C0C-73AE-47BA-BF39-DD1273EC856A">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-68C8A269-BDB6-4FFC-A5CF-3FDDB84143BC" title="The Cluster Managed Database Services page is the master page for beginning all tasks related to services.">About Service Administration Using Enterprise Manager</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-6D2CEE13-1EEA-486E-A29A-0E69D7D762A7" title="Services divide workloads into mutually disjoint groupings. Each service represents a workload with common attributes, service-level thresholds, and priorities.">About Oracle Services</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-8F41DEAB-CE18-48E5-B57A-A4B4FA908217" title="You can create a service using Oracle Enterprise Manager or the SRVCTL utility.">Creating Services</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="TDPRC306"></a><a id="TDPRC305"></a>
<div class="props_rev_3"><a id="GUID-5179D010-2D9A-4339-8C3B-C0B71D6F8ABA"></a>
<h3 id="TDPRC-GUID-5179D010-2D9A-4339-8C3B-C0B71D6F8ABA" class="sect3">Verifying Oracle Net Supports Newly Created Services</h3>
<div>
<p>By configuring and using a SCAN for your cluster, you no longer have to modify the network setup on each client. Using the <code class="codeph">lsnrctl</code> utility you can verify that the new service is recognized by Oracle Net and available to the database clients.</p>
<div class="section">
<div class="infobox-note" id="GUID-5179D010-2D9A-4339-8C3B-C0B71D6F8ABA__GUID-6535EE9B-1F8C-4797-B734-27C557001184">
<p class="notep1">Note:</p>
<p>When using utilities to manage your cluster, databases, database instances, Oracle Automatic Storage Management (Oracle ASM), and listeners, use the appropriate binary that is in the home directory of the object or component you are managing. Also, set your <code class="codeph">ORACLE_HOME</code> environment variable to point to this directory.</p>
<p>For example, to use <code class="codeph">lsnrctl</code> to manage the SCAN listener, use the binaries located in the Grid home (where the listener is running), and set the <code class="codeph">ORACLE_HOME</code> environment variable to the location of the Grid home.</p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To verify Oracle Net Services supports the newly created service:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Determine if the listener on the local node recognizes the new service by using the following command:</span>
<div>
<pre dir="ltr"><kbd class="userinput">lsnrctl status LISTENER_SCAN1</kbd>
</pre></div>
<div>You should see a list for the new service, similar to the following:
<pre dir="ltr"><samp class="sysout">Services Summary...
Service &#34;DEVUSERS.example.com&#34; has 2 instance(s).
  Instance &#34;sales1&#34;, status READY, has 1 handler(s) for this service...
  Instance &#34;sales2&#34;, status READY, has 1 handler(s) for this service...
</samp>
</pre>
<p>The displayed name for your newly created service, for example <code class="codeph">DEVUSERS.example.com</code>, is the service name you use in your connection strings.</p>
</div>
</li>
<li class="stepexpand"><span>(Optional) Use a text editor to modify the <code class="codeph">tnsnames.ora</code> file in the <code class="codeph"><span class="codeinlineitalic">Oracle_home</span>/network/admin</code> directory on each node that contains an instance listed as a Preferred or Available instance for the service, and on each client that uses the service to connect to the database. Add an entry similar to the following, specifying the VIP address for each node:</span>
<div>
<pre dir="ltr">DEVUSERS = 
  (DESCRIPTION = 
    (ADDRESS_LIST = 
      (ADDRESS = (PROTOCOL = TCP)(HOST = docrac1-vip)(PORT = 1521))
      (ADDRESS = (PROTOCOL = TCP)(HOST = docrac2-vip)(PORT = 1521))
    (LOAD_BALANCE = yes)
    )
  (CONNECT_DATA = (SERVICE_NAME = DEVUSERS.oracle.com))
   )
</pre></div>
<div>
<p>In the previous example, the <code class="codeph">ADDRESS_LIST</code> parameter contains one <code class="codeph">ADDRESS</code> for each node that contains an instance configured as either Preferred or Available for the service.</p>
</div>
</li>
<li class="stepexpand"><span>Test the Oracle Net Services configuration by attempting to connect to the Oracle RAC database using SQL*Plus and the SCAN.</span>
<div>The connect identifier for easy connect naming has the following format:
<pre dir="ltr">&#34;[//]<span class="variable">SCAN</span>[:<span class="variable">port</span>]/<span class="variable">service_name</span>&#34;
</pre>
<p><span class="variable">SCAN</span> is the SCAN for your cluster, which defaults to <span class="variable">cluster_name</span>.<span class="variable">GNS_sub_domain</span>. The <span class="variable">service_name</span> is the name of the database service you want to use for connecting to the database. You can optionally specify the TCP port number on which the Oracle SCAN listener listens for connections.</p>
</div>
<div>
<p>For example, you might use the following commands to connect to the DEVUSERS service for Oracle RAC database in the <code class="codeph">docrac</code> cluster, which belongs to the <code class="codeph">example.com</code> domain:</p>
<pre dir="ltr">$ sqlplus system@\&#34;docrac.example.com/DEVUSERS.example.com\&#34;
Enter password: <span class="variable">password</span>
</pre></div>
<div>
<p>After you enter the password, you should see a message indicating you are successfully connected to the Oracle RAC database. If you get an error message, then examine the connect identifier and verify the user name, password, and service name were typed in correctly and all the information is correct for your Oracle RAC environment.</p>
</div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-5179D010-2D9A-4339-8C3B-C0B71D6F8ABA__GUID-623F618E-D58A-4315-A18C-C3D79EF8945E">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-15212171-34EF-4E27-883B-78D2A3842F7D" title="Oracle Net connection load balancing spreads user connections across all the instances that support the service used to connect to the database.">About Connection Load Balancing</a>&#34;</span></p>
</li>
<li>
<p><a class="olink ADMQS043" target="_blank" href="../ADMQS/GUID-83323247-58C9-4CC7-9816-C3511A88A6AF.htm#ADMQS043"><span><cite>Oracle Database 2 Day DBA</cite></span></a> for details on how to view the listener configuration</p>
</li>
<li>
<p><a class="olink ADMQS045" target="_blank" href="../ADMQS/GUID-1A15D322-B3AC-426A-86A1-EB7590930687.htm#ADMQS045"><span><cite>Oracle Database 2 Day DBA</cite></span></a> for details on how to connect to an Oracle database from a client computer</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="TDPRC311"></a>
<div class="props_rev_3"><a id="GUID-47706B7C-0CD3-4334-9436-98FD1C8C60B9"></a>
<h2 id="TDPRC-GUID-47706B7C-0CD3-4334-9436-98FD1C8C60B9" class="sect2">Configuring Clients for High Availability</h2>
<div>
<p>There are three central elements to consider when automating failover for application clients.</p>
<ul style="list-style-type: disc;">
<li>
<p>First, clients that are connected at the time of failure must be quickly and automatically notified that a failure has occurred to avoid waiting for TCP/IP network time-outs before attempting to connect to the new database instance (such time-outs range anywhere from eight minutes to two hours, depending on operating system). Oracle RAC configurations use Fast Application Notification (FAN) to notify JDBC clients, OCI clients, and ODP.NET clients. FAN event notifications and callouts enable automatic and fast redirection of clients after a site failure.</p>
</li>
<li>
<p>The second central element of client failover, is the redirection of new incoming requests to the new instance after a failure has occurred, which can be implemented using application services. When you create and activate application services on several instances of an Oracle RAC database, then if the service becomes unavailable on one instance, clients connections are redirected to other instances where the service is available. Applications need only provide the name of the database service in their connect strings&ndash;there is no need to specify an instance name because, using listener cross registration, SCAN listeners and other remote listeners in the cluster are aware of which instances are currently providing a service when a connection request comes in.</p>
</li>
<li>
<p>The third central element is masking the outage from the client and the application. Masking outages of the database session is a complex task for application development and, therefore, errors and timeouts are often exposed to the client. Application Continuity attempts to mask outages from applications by replaying incomplete application requests after unplanned and planned outages.</p>
</li>
</ul>
<p>For applications that are unable to take advantage of Application Continuity, two additional features are available: Transparent Application Failover (TAF) for OCI based applications and Transaction Guard. Transaction Guard enables applications to build their own masking of outages by knowing the outcome of the last in-flight transaction.</p>
<p>This section deals with configuring high availability for application clients.</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-175B39D9-FD92-4DA3-A98C-88594844EACE">Configuring Oracle Net Services Parameters For Highly Available Connections</a></strong><br/>
When using services to connect to a database, there are various parameters you can set to configure high availability.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-51D372E8-16C8-4222-882B-5BDF95E03F64">Configuring JDBC Clients for High Availability</a></strong><br/>
You can configure JDBC clients to use a connection pool, Application Continuity and Transaction Guard to make them highly available.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-82A53E48-9362-4FDA-ACB7-DDD181BD4961">Configuring OCI Clients for High Availability</a></strong><br/>
The Oracle Call Interface (OCI) provides integration with FAN and Load Balancing Advisory events. To take advantage of the Load Balancing Advisory, you must enable the OCI Session pool.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-5EE5B6E1-8F27-4F81-A4A1-BE67DEE4FA2F">Configuring ODP.NET Clients for High Availability</a></strong><br/>
Oracle Data Provider for .NET (ODP.NET) provides integration with Fast Application Notification (FAN), Run-time Connection Load Balancing, Transparent Application Failover (TAF), and Transaction Guard.</li>
</ul>
<div class="infoboxnotealso" id="GUID-47706B7C-0CD3-4334-9436-98FD1C8C60B9__GUID-5F341F08-1570-4F2E-89E9-08386061FE96">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-C32436A0-3706-4E15-96FA-BB7F92007E55" title="Fast Application Notification (FAN) is a high availability notification mechanism that Oracle RAC uses to notify other processes about cluster configuration and service-level information, including status changes such as UP or DOWN events.">About Fast Application Notification (FAN)</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-6D2CEE13-1EEA-486E-A29A-0E69D7D762A7" title="Services divide workloads into mutually disjoint groupings. Each service represents a workload with common attributes, service-level thresholds, and priorities.">About Oracle Services</a>&#34;</span></p>
</li>
<li>
<p><a class="olink RACAD8277" target="_blank" href="../RACAD/GUID-5129AD20-E50A-47D4-95D5-99A8DE72294E.htm#RACAD8277"><span><cite>Oracle Real Application Clusters Administration and Deployment Guide</cite></span></a> for information about client-side connection configuration</p>
</li>
</ul>
</div>
</div>
<a id="TDPRC642"></a>
<div class="props_rev_3"><a id="GUID-175B39D9-FD92-4DA3-A98C-88594844EACE"></a>
<h3 id="TDPRC-GUID-175B39D9-FD92-4DA3-A98C-88594844EACE" class="sect3">Configuring Oracle Net Services Parameters For Highly Available Connections</h3>
<div>
<p>When using services to connect to a database, there are various parameters you can set to configure high availability.</p>
<ul>
<li class="stepexpand"><span>For applications that need to connect to an Oracle Database, use the following Oracle Net Services parameters to minimize connection wait times:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">CONNECT_TIMEOUT</code>: controls the amount of time to wait when attempting to connect to an address</p>
</li>
<li>
<p><code class="codeph">RETRY_COUNT</code>: controls the number of times the application attempts to connect to the database</p>
</li>
<li>
<p><code class="codeph">TRANSPORT_CONNECT_TIME</code>: controls the amount of time allowed for a client to establish a TCP connection to the database</p>
</li>
</ul>
<p>You can specify these parameters in either the timeout section of the <code class="codeph">tnsnames.ora</code> file or at the <code class="codeph">DESCRIPTION</code> level of a connect string, for example:</p>
<pre dir="ltr"><span class="italic">net_service_name</span>=
 (DESCRIPTION= 
  (CONNECT_TIMEOUT=60)(RETRY_COUNT=3)(TRANSPORT_CONNECT_TIMEOUT=3
  (ADDRESS_LIST=
   (ADDRESS=(PROTOCOL=tcp)(HOST=docrac.example.com)(PORT=1521))
   (CONNECT_DATA=
   (SERVICE_NAME=racdb.example.com)))
</pre>
<div class="infobox-note" id="GUID-175B39D9-FD92-4DA3-A98C-88594844EACE__GUID-534CDE52-ECB3-4655-990F-FA30B386CE09">
<p class="notep1">Note:</p>
<ul style="list-style-type: disc;">
<li>
<p>The <code class="codeph">CONNECT_TIMEOUT</code> parameter is equivalent to the <code class="codeph">sqlnet.ora</code> parameter <code class="codeph">sqlnet</code>.<code class="codeph">OUTBOUND_CONNECT_TIMEOUT</code> and overrides it.</p>
</li>
<li>
<p>You should not configure the <code class="codeph">sqlnet.outbound_connection_timeout</code> parameter on the server <code class="codeph">sqlnet.ora</code> file, as this can impact Oracle Clusterware operations.</p>
</li>
<li>
<p>The <code class="codeph">TRANSPORT_CONNECT_TIMEOUT</code> parameter is equivalent to the <code class="codeph">sqlnet</code>.<code class="codeph">ora</code> parameter <code class="codeph">tcp</code>.<code class="codeph">CONNECT_TIMEOUT</code> and overrides it.</p>
</li>
</ul>
</div>
</div>
</li>
</ul>
<div class="section">
<div class="infoboxnotealso" id="GUID-175B39D9-FD92-4DA3-A98C-88594844EACE__GUID-2FB3E477-C6BB-4E27-B51A-6724A95B9DD9">
<p class="notep1">See Also:</p>
<p><a class="olink NETRF1434" target="_blank" href="../NETRF/tnsnames.htm#NETRF1434"><span class="italic">Oracle Database Net Services Reference</span></a> for more information about the timeout and retry parameters for Oracle Net Services</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="TDPRC312"></a>
<div class="props_rev_3"><a id="GUID-51D372E8-16C8-4222-882B-5BDF95E03F64"></a>
<h3 id="TDPRC-GUID-51D372E8-16C8-4222-882B-5BDF95E03F64" class="sect3">Configuring JDBC Clients for High Availability</h3>
<div>
<p>You can configure JDBC clients to use a connection pool, Application Continuity and Transaction Guard to make them highly available.</p>
<p>An application that uses JDBC connections should use a connection pool, so an existing connection can be used in the pool instead of making a new connection to the database every time you access data. The Universal Connection Pool (UCP) is a Java-based connection pool that supports any type of connection (JDBC, LDAP, JCA), to any type of database (Oracle or non-Oracle) with any middle tier (Oracle or non-Oracle). It also supports standalone deployments such as TopLink or BPEL. UCP also supports integration features of Oracle Database such as Fast Connection Failover, Run-time Connection Load Balancing, Web Affinity, Application Continuity, and Transaction Guard with Oracle RAC when using the JDBC Thin driver.</p>
<p>Without Fast Connection Failover, if a node or network goes down and the application attempts to connect to that instance, then the connection request might hang for several minutes waiting for the TCP time out to be reached. If you chose not to use a connection pool with the integrated FCF feature, then your application can still be notified of Oracle RAC high availability events by configuring the Connection Failure Notification feature.</p>
<p>Application Continuity provides a general purpose, application-independent infrastructure that enables recovery of work from an application perspective, after the occurrence of a planned or unplanned outage. The outage can be related to the system, communication, or hardware layer following a repair, a configuration change, or a patch application. Application Continuity restores the database session by replaying the non-transactional and transactional user calls to reconstruct the database session as if the outage had not occurred. Application Continuity performs this replay beneath the application so that the outage appears to the application as a delayed execution.</p>
<p>Transaction Guard is a reliable protocol and tool that returns the outcome of the last in-flight transaction after an outage makes the database session unavailable. Transaction Guard avoids the costs of ambiguous errors that lead to end user frustration, customer support calls, and lost opportunities.</p>
<div class="infobox-note" id="GUID-51D372E8-16C8-4222-882B-5BDF95E03F64__GUID-77E6BD83-999E-40D2-A6F5-2441BA629026">
<p class="notep1">Note:</p>
<ul style="list-style-type: disc;">
<li>
<p>Transaction Guard does not replay distributed or XA transactions.</p>
</li>
<li>
<p>When using the Universal Connection Pool (UCP), configure Fast Application Notification and, optionally, Application Continuity. Do not configure Connection Failure Notification (the <code class="codeph">ConnectionFailureNotification</code> connection property).</p>
</li>
</ul>
</div>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-75AD3AFE-1FCD-4749-89B7-50E82F7A91E8">Configuring JDBC Clients for Fast Connection Failover</a></strong><br/>
Follow these steps to configure JDBC Clients for Fast Connection Failover.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-A963EEB9-FF77-4146-93F1-5E577DE15100">Configuring Simple FAN for JDBC Thin Driver Non-Pooled Clients</a></strong><br/>
To configure simple FAN for non-pooled JDBC clients, you use the <code class="codeph">ConnectionFailureNotification</code> connection property.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-C803D6FD-B627-40EC-9B45-8E0A8E84FD0B">Configuring JDBC Clients for Application Continuity for Java</a></strong><br/>
A new Replay data source (<code class="codeph">oracle.jdbc.replay.OracleDataSource</code>) serves as the front-end for applications to obtain a connection when using Application Continuity for Java.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-AB96E23C-96D5-42EE-9DAF-52706221EA53">Configuring JDBC-Thin Clients to Use Transaction Guard</a></strong><br/>
Transaction Guard is a reliable protocol and tool that returns the outcome of the last in-flight transaction after an outage that makes the database session unavailable.</li>
</ul>
<div class="infoboxnotealso" id="GUID-51D372E8-16C8-4222-882B-5BDF95E03F64__GUID-14E17E42-0FD5-4C94-BE55-AD2F6C557F52">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-05437C05-720F-477A-9533-EEB78357F784" title="You can deploy Oracle RAC environments to achieve continuous service in many different ways.">About Workload Management with Dynamic Database Services</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-6D2CEE13-1EEA-486E-A29A-0E69D7D762A7" title="Services divide workloads into mutually disjoint groupings. Each service represents a workload with common attributes, service-level thresholds, and priorities.">About Oracle Services</a>&#34;</span></p>
</li>
<li>
<p><a class="olink RACAD7386" target="_blank" href="../RACAD/GUID-424BE157-18A3-4261-8A43-DF4D5E60C3D4.htm#RACAD7386"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for more information about deploying Oracle RAC for high availability</p>
</li>
<li>
<p><a class="olink JJUCP8109" target="_blank" href="../JJUCP/intro.htm#JJUCP8109"><span class="italic">Oracle Universal Connection Pool for JDBC Developer&#39;s Guide</span></a> for more information about the Universal Connection Pool for Java</p>
</li>
</ul>
</div>
</div>
<a id="TDPRC314"></a><a id="TDPRC313"></a>
<div class="props_rev_3"><a id="GUID-75AD3AFE-1FCD-4749-89B7-50E82F7A91E8"></a>
<h4 id="TDPRC-GUID-75AD3AFE-1FCD-4749-89B7-50E82F7A91E8" class="sect4">Configuring JDBC Clients for Fast Connection Failover</h4>
<div>
<p>Follow these steps to configure JDBC Clients for Fast Connection Failover.</p>
<div class="section">
<p>The Universal Connection Pool (UCP) subscribes to FAN when Oracle Notification Service is configured and the pool property <code class="codeph">setFastConnectionFailoverEnabled</code> is enabled.</p>
<p>UCP also subscribes to the FAN Load Balancing events if you configure the dynamic database service used in the connection for run-time load balancing. Instead of randomly assigning a free connection to a work request, the connection pool chooses the connection that gives the best service according to the latest information it has received. If a node becomes hung, then run-time load balancing quickly shifts connections from the hung node to other nodes in the cluster.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To configure JDBC clients for Fast Connection Failover:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Use the Cluster Managed Services page in Oracle Enterprise Manager Cloud Control to create new services. See <span class="q">&#34;<a href="configwlm.htm#GUID-8F41DEAB-CE18-48E5-B57A-A4B4FA908217" title="You can create a service using Oracle Enterprise Manager or the SRVCTL utility.">Creating Services</a>&#34;</span> for more information about creating services.</span></li>
<li class="stepexpand"><span>Enable fast connection failover for JDBC clients by setting the UCP DataSource property <code class="codeph">FastConnectionFailoverEnabled</code> to <code class="codeph">TRUE</code>. Also, configure a remote Oracle Notification Services (ONS) subscription within the JDBC application so that the Java Virtual Machine (JVM) can spawn the ONS when needed, as shown in the following example:</span>
<div>
<pre dir="ltr">PoolDataSource pds = PoolDataSourceFactory.getPoolDataSource();
Pds.setConnnectionPoolName(&#34;FCFSampleUCP&#34;);
<span class="bold">pds.setONSConfiguration(&#34;nodes=racnode1:4200,racnode2:4200&#34;);</span>
<span class="bold">pds.setFastConnectionFailoverEnabled(true);</span>
pds.setConnectionFactoryClassName(&#34;oracle.jdbc.pool.OracleDataSource&#34;);
</pre>
<p>The remote ONS subscription must contain every host that the client application can use for failover.</p>
</div>
</li>
<li class="stepexpand"><span>Set the <code class="codeph">oracle.net.ns.SQLnetDef.TCP_CONNTIMEOUT_STR</code> property to a nonzero value on the data source. When this property is set, if the JDBC client attempts to connect to a host that is unavailable, then the connection attempt is bounded to the time specified for <code class="codeph">oracle.net.ns.SQLnetDef.TCP_CONNTIMEOUT_STR</code>. After the specified time has elapsed and a successful connection has not been made, the client attempts to connect to the next host in the address list. Setting this property to a value of three seconds is sufficient for most installations.</span></li>
<li class="stepexpand"><span>Configure JDBC clients to use a connect descriptor that includes the SCAN and the service name, and the port that the SCAN listener listens on (if not using the default value of 1521), for example:</span>
<div>
<pre dir="ltr">@//docrac.example.com:1525/orcl_JDBC
</pre></div>
<div>
<div class="infobox-note" id="GUID-75AD3AFE-1FCD-4749-89B7-50E82F7A91E8__GUID-6D326566-77B3-4F84-B7E8-BADB90A602DE">
<p class="notep1">Note:</p>
<p>Do not configure Transparent Application Failover (TAF) with Fast Connection Failover for JDBC clients as TAF processing can interfere with FAN ONS processing.</p>
</div>
</div>
<div>
<p>For example, if the database initialization parameter <code class="codeph">remote_listener</code> is set to the SCAN listener addresses, then, in the JDBC application, you would connect to the database using a connect string similar to the following:</p>
<pre dir="ltr">pds.setURL(&#34;jdbc:oracle:thin:@(DESCRIPTION = 
 (TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(FAILOVER=ON)(CONNECT_TIMEOUT=60)
 (ADDRESS_LIST =(ADDRESS=(PROTOCOL=tcp)
 (HOST=docrac.example.com)(PORT=1521)) 
 (CONNECT_DATA=(SERVICE_NAME=<span class="italic">service_name</span>))) 
</pre></div>
<div>
<p>If you are using a JDBC driver, then you must include the complete connect descriptor in the URL because the JDBC Thin driver does not use Oracle Net.</p>
</div>
</li>
<li class="stepexpand"><span>Verify that both <code class="codeph">ucp.jar</code> and <code class="codeph">ons.jar</code> are in the application CLASSPATH.</span></li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-75AD3AFE-1FCD-4749-89B7-50E82F7A91E8__GUID-69104BB7-F44B-44AF-A7C2-12584C8BB313">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-8F41DEAB-CE18-48E5-B57A-A4B4FA908217" title="You can create a service using Oracle Enterprise Manager or the SRVCTL utility.">Creating Services</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-C32436A0-3706-4E15-96FA-BB7F92007E55" title="Fast Application Notification (FAN) is a high availability notification mechanism that Oracle RAC uses to notify other processes about cluster configuration and service-level information, including status changes such as UP or DOWN events.">About Fast Application Notification (FAN)</a>&#34;</span></p>
</li>
<li>
<p><a class="olink JJDBC27000" target="_blank" href="../JJDBC/ocitaf.htm#JJDBC27000"><span class="italic">Oracle Database JDBC Developer&#39;s Guide</span></a> for more information about installing and configuring Oracle RAC Fast Application Notification for Java</p>
</li>
<li>
<p><a class="olink JJUCP" target="_blank" href="../JJUCP/toc.htm"><span class="italic">Oracle Universal Connection Pool for JDBC Developer&#39;s Guide</span></a> for more information about using the Universal Connection Pool for database connections using Java</p>
</li>
<li>
<p><a class="olink TDPJD176" target="_blank" href="../TDPJD/querdata.htm#TDPJD176"><span class="italic">Oracle Database 2 Day + Java Developer&#39;s Guide</span></a> for information about creating a method to authenticate users</p>
</li>
<li>
<p><a class="olink RACAD7134" target="_blank" href="../RACAD/GUID-074729CB-8A91-419C-A6E1-3B9E4FD8D869.htm#RACAD7134"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for information about installing and configuring Oracle RAC Fast Application Notification</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="TDPRC588"></a><a id="TDPRC315"></a>
<div class="props_rev_3"><a id="GUID-A963EEB9-FF77-4146-93F1-5E577DE15100"></a>
<h4 id="TDPRC-GUID-A963EEB9-FF77-4146-93F1-5E577DE15100" class="sect4">Configuring Simple FAN for JDBC Thin Driver Non-Pooled Clients</h4>
<div>
<p>To configure simple FAN for non-pooled JDBC clients, you use the <code class="codeph">ConnectionFailureNotification</code> connection property.</p>
<div class="section">
<p>JDBC simple FAN enables standalone Oracle JDBC connections to quickly respond to node failures. This feature enables a standalone JDBC Thin Driver connection to listen for FAN events and respond to a node down event by marking the connection closed, permitting user applications to begin recovery quicker. It does not alter the behavior of the application, except that JDBC method calls throw exceptions more quickly after a node goes down.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To configure FAN for non-pooled JDBC Clients:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Set the Connection Failure Notification property either as a system property using the <code class="codeph">-D</code> option, or by including it in the connection properties argument when creating a connection.</span>
<div>
<p>To set it as a system property, use a command similar to the following:</p>
<pre dir="ltr">java -Doracle.jdbc.ConnectionFailureNotification=true
</pre>
<p>To set it within the connection properties argument, use code similar to the following:</p>
<pre dir="ltr">Properties props = new Properties();
props.put(&#34;ConnectionFailureNotification&#34;, &#34;true&#34;);
Connection = DriverManager.getConnection(url, props);
</pre></div>
</li>
<li class="stepexpand"><span>Configure the transport mechanism by which the node down events are received. If Oracle Notification Services (ONS) is the selected transport mechanism, then use the <code class="codeph">SetONSConfiguration</code> property, as demonstrated in the following code, where <code class="codeph">racnode1</code> and <code class="codeph">racnode2</code> represent nodes in the cluster that have ONS running on them:</span>
<div>
<pre dir="ltr">props.setONSConfiguration(&#34;nodes=racnode1:4200,racnode2:4200&#34;);
</pre></div>
</li>
<li class="stepexpand"><span>Verify that <code class="codeph">ons.jar</code> is in the application CLASSPATH.</span></li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-A963EEB9-FF77-4146-93F1-5E577DE15100__GUID-7D04CBAB-39E4-4BD3-B3C6-B2312DD4BD2B">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-FEAE3AA1-8785-432C-B7B3-B2B3AB0430A3" title="The Oracle RAC high availability framework enables Oracle RAC to maintain the database, components, and applications in a running state always.">About Oracle RAC High Availability Framework</a>&#34;</span></p>
</li>
<li>
<p><a class="olink JJDBC27000" target="_blank" href="../JJDBC/ocitaf.htm#JJDBC27000"><span class="italic">Oracle Database JDBC Developer&#39;s Guide</span></a> for information about installing and configuring Oracle RAC Fast Application Notification</p>
</li>
<li>
<p><a class="olink TDPJD176" target="_blank" href="../TDPJD/querdata.htm#TDPJD176"><span class="italic">Oracle Database 2 Day + Java Developer&#39;s Guide</span></a> for information about creating a method to authenticate users</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="TDPRC635"></a><a id="TDPRC634"></a>
<div class="props_rev_3"><a id="GUID-C803D6FD-B627-40EC-9B45-8E0A8E84FD0B"></a>
<h4 id="TDPRC-GUID-C803D6FD-B627-40EC-9B45-8E0A8E84FD0B" class="sect4">Configuring JDBC Clients for Application Continuity for Java</h4>
<div>
<p>A new Replay data source (<code class="codeph">oracle.jdbc.replay.OracleDataSource</code>) serves as the front-end for applications to obtain a connection when using Application Continuity for Java.</p>
<div class="section">The Replay data source serves as the connection factory that produces new physical JDBC connections, for both UCP and WebLogic Server Active GridLink data sources. In collaboration with Oracle Database, the JDBC replay driver maintains a history of calls during a client conversation with Oracle Database 12<span class="italic">c</span>, as instructed by the database. Following any outage of the session caused by a loss of database service, planned or unplanned, the JDBC replay driver attempts to rebuild the non-transactional and transactional database session states, so that the outage appears as a delayed execution.</div>
<!-- class="section" -->
<div class="p">To use Application Continuity for Java and the JDBC replay driver, you must use an Oracle Database 12<span class="italic">c</span> client and connect to an Oracle Database 12<span class="italic">c</span> database. Application Continuity for Java is supported in the following configurations:
<ul style="list-style-type: disc;">
<li>
<p>JDBC applications using Oracle JDBC Replay data source and using neither UCP or WebLogic Server Active GridLink&mdash;typical standalone JDBC cases</p>
</li>
<li>
<p>JDBC applications using UCP data sources&mdash;standalone or 3<sup>rd</sup> party application servers configured to use a UCP data source</p>
</li>
<li>
<p>JDBC applications using only WebLogic Server Active GridLink but not UCP data sources&mdash;typical WebLogic Server J2EE cases</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To configure JDBC clients to use the JDBC Replay Driver:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Verify you are using an application that has been certified for replay.</span></li>
<li class="stepexpand"><span>Use SRVCTL to create a service for use by the application, if one does not already exist. Set the <code class="codeph">FAILOVER_TYPE</code> attribute to <code class="codeph">TRANSACTION</code>, <code class="codeph">commit_outcome</code> attribute to <code class="codeph">TRUE</code>, and notification for FAN to <code class="codeph">TRUE</code> for this service..</span>
<div>
<p>See <span class="q">&#34;<a href="configwlm.htm#GUID-8F41DEAB-CE18-48E5-B57A-A4B4FA908217" title="You can create a service using Oracle Enterprise Manager or the SRVCTL utility.">Creating Services</a>&#34;</span> for more information about creating services.</p>
</div>
</li>
<li class="stepexpand"><span>Configure the connection element using the <code class="codeph">replayDataSource</code> object, as shown in the following example:</span>
<div>
<pre dir="ltr">replayDataSource rds = PoolDataSourceFactory.getreplayDataSource();
rds.setConnnectionPoolName(&#34;replayExample&#34;);
rds.setONSConfiguration(&#34;nodes=racnode1:4200,racnode2:4200&#34;);
rds.setFastConnectionFailoverEnabled(true);
rds.setConnectionFactoryClassName(&#34;oracle.jdbc.replay.OracleDataSourceImpl&#34;);

Connection conn = replayDataSource.getConnection();
</pre>
<p>Refer to the URL example in <span class="q">&#34;<a href="configwlm.htm#GUID-75AD3AFE-1FCD-4749-89B7-50E82F7A91E8" title="Follow these steps to configure JDBC Clients for Fast Connection Failover.">Configuring JDBC Clients for Fast Connection Failover</a>&#34;</span>.</p>
</div>
</li>
<li class="stepexpand"><span>When connecting to the database, use a URL that can access all instances offering the service. See <span class="q">&#34;<a href="configwlm.htm#GUID-175B39D9-FD92-4DA3-A98C-88594844EACE" title="When using services to connect to a database, there are various parameters you can set to configure high availability.">Configuring Oracle Net Services Parameters For Highly Available Connections</a>&#34;</span> for more information about creating highly available database connections.</span></li>
</ol>
<div class="section">
<div class="infobox-note" id="GUID-C803D6FD-B627-40EC-9B45-8E0A8E84FD0B__GUID-0E22ACB7-B7DE-44D5-8B37-66382A8AE33B">
<p class="notep1">Note:</p>
<p>If you disconnect or terminate a session that uses Application Continuity, then Application Continuity attempts to recover the session. To disconnect or terminate the session without replay, see <a class="olink ADFNS1426" target="_blank" href="../ADFNS/adfns_app_continuity.htm#ADFNS1426"><span><cite>Oracle Database Development Guide</cite></span></a>.</p>
</div>
<div class="infoboxnotealso" id="GUID-C803D6FD-B627-40EC-9B45-8E0A8E84FD0B__GUID-5821CC78-CC17-49E0-9198-B54F350EFC1A">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink JJDBC29073" target="_blank" href="../JJDBC/appcontnew.htm#JJDBC29073"><span><cite>Oracle Database JDBC Developer&rsquo;s Guide</cite></span></a> for information about configuring Oracle JDBC for Application Continuity for Java</p>
</li>
<li>
<p><a class="olink ADFNS1058" target="_blank" href="../ADFNS/adfns_app_continuity.htm#ADFNS1058"><span><cite>Oracle Database Development Guide</cite></span></a> for more information about using Application Continuity</p>
</li>
<li>
<p><a class="olink JJUCP8254" target="_blank" href="../JJUCP/app_cont.htm#JJUCP8254"><span><cite>Oracle Universal Connection Pool Developer&rsquo;s Guide</cite></span></a> for information about using Application Continuity with the Universal Connection Pool</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="TDPRC619"></a>
<div class="props_rev_3"><a id="GUID-AB96E23C-96D5-42EE-9DAF-52706221EA53"></a>
<h4 id="TDPRC-GUID-AB96E23C-96D5-42EE-9DAF-52706221EA53" class="sect4">Configuring JDBC-Thin Clients to Use Transaction Guard</h4>
<div>
<p>Transaction Guard is a reliable protocol and tool that returns the outcome of the last in-flight transaction after an outage that makes the database session unavailable.</p>
<p>Transaction Guard avoids the costs of ambiguous errors that lead to user frustration, customer support calls, and lost opportunities. Without Transaction Guard, applications and users who attempt to retry operations following an outage can cause logical corruption by committing duplicate transactions or committing transactions out of order.</p>
<div class="infoboxnotealso" id="GUID-AB96E23C-96D5-42EE-9DAF-52706221EA53__GUID-317AC7C1-A9E1-493A-9043-4F1A44CDFD98">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink JJDBC29121" target="_blank" href="../JJDBC/transactionguard.htm#JJDBC29121"><span class="italic">Oracle Database JDBC Developer&#39;s Guide</span></a> for information about configuring JDBC-Thin clients for use with Transaction Guard</p>
</li>
<li>
<p><a class="olink ADFNS8000" target="_blank" href="../ADFNS/adfns_trans_idemp_guard.htm#ADFNS8000"><span class="italic">Oracle Database Development Guide</span></a> for more information about using Transaction Guard</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<a id="TDPRC317"></a>
<div class="props_rev_3"><a id="GUID-82A53E48-9362-4FDA-ACB7-DDD181BD4961"></a>
<h3 id="TDPRC-GUID-82A53E48-9362-4FDA-ACB7-DDD181BD4961" class="sect3">Configuring OCI Clients for High Availability</h3>
<div>
<p>The Oracle Call Interface (OCI) provides integration with FAN and Load Balancing Advisory events. To take advantage of the Load Balancing Advisory, you must enable the OCI Session pool.</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-69054923-807A-4446-B9AD-051B41DA71F4">Configuring OCI Clients to Receive FAN Notifications</a></strong><br/>
Oracle Call Interface (OCI) clients can register to receive notifications about Oracle Real Application Clusters (Oracle RAC) high availability events and respond when events occur.</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-4AF0D3BD-A9A0-445E-A580-C1C3AB1C7D7F">Configuring OCI Clients to use Transaction Guard</a></strong><br/>
Oracle Call Interface (OCI) clients can use Transaction Guard to replay an in-flight transaction when a recoverable error occurs.</li>
</ul>
<div class="infoboxnotealso" id="GUID-82A53E48-9362-4FDA-ACB7-DDD181BD4961__GUID-F0E22E14-F190-4E68-AE94-E3EEAD26E243">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p>&#34;Using Transaction Guard&#34; in <a class="olink ADFNS8000" target="_blank" href="../ADFNS/adfns_trans_idemp_guard.htm#ADFNS8000"><span class="italic">Oracle Database Development Guide</span></a></p>
</li>
<li>
<p>&#34;Configuring Transparent Application Failover&#34; in <a class="olink LNOCI16680" target="_blank" href="../LNOCI/oci09adv.htm#LNOCI16680"><span class="italic">Oracle Call Interface Programmer&#39;s Guide</span></a></p>
</li>
</ul>
</div>
</div>
<a id="TDPRC318"></a><a id="TDPRC621"></a>
<div class="props_rev_3"><a id="GUID-69054923-807A-4446-B9AD-051B41DA71F4"></a>
<h4 id="TDPRC-GUID-69054923-807A-4446-B9AD-051B41DA71F4" class="sect4">Configuring OCI Clients to Receive FAN Notifications</h4>
<div>
<p>Oracle Call Interface (OCI) clients can register to receive notifications about Oracle Real Application Clusters (Oracle RAC) high availability events and respond when events occur.</p>
<div class="section">
<p>Registering to receive Fast Application Notification (FAN) events improves the connection failover response time in OCI and also removes terminated connections from connection and session pools. This feature works for all OCI client applications.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To configure OCI clients to receive FAN notifications:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Use the Cluster Managed Services page in Oracle Enterprise Cloud Control to a create services for the OCI clients.</span>
<div>
<p>You should configure the primary instance as preferred for that service. For Notification Properties, choose &#34;Enable Fast Application Notification for OCI and ODP.NET Applications&#34;.</p>
</div>
</li>
<li class="stepexpand"><span>Link the OCI client applications with thread library <code class="codeph">libthread</code> or <code class="codeph">libpthread</code>.</span></li>
<li class="stepexpand"><span>In your application, you must check if an event has occurred, using code similar to the following example:</span>
<div>
<pre dir="ltr">void evtcallback_fn(ha_ctx, eventhp)
...  
printf(&#34;HA Event received.\n&#34;);
  if (OCIHandleAlloc( (dvoid *)envhp, (dvoid **)&amp;errhp, (ub4) OCI_HTYPE_ERROR, 
                      (size_t) 0, (dvoid **) 0))
    return;
  if (retcode = OCIAttrGet(eventhp, OCT_HTYPE_EVENT, (dvoid *)&amp;srvhp, (ub4 *)0,
                           OCI_ATTR_HA_SRVFIRST, errhp))
    checkerr (errhp, (sword)retcode;
  else {
     printf(&#34;found first server handle.\n&#34;);
     /*get associated instance name */
     if (retcode = OCIAttrGet(srvhp, OCI_HTYPE_SERVER, (dvoid *)&amp;instname,
                           (ub4 *)&amp;sizep, OCI_ATTR_INSTNAME, errhp))
       checkerr (errhp, (sword)retcode);
     else
       printf(&#34;instance name is %s.\n&#34;, instname);
</pre></div>
</li>
<li class="stepexpand"><span>After a HA event is received, clients and applications can register a callback that is invoked whenever a high availability event occurs, as shown in the following example:</span>
<div>
<pre dir="ltr">/*Registering HA callback function */
  if (checkerr(errhp, OCIAttrSet(envhp, (ub4) OCI_HTYPE_ENV, 
                             (dvoid *)<span class="bold">evtcallback_fn</span>, (ub4) 0,
   <span class="bold">                          (ub4)OCI_ATTR_EVTCBK</span>, errhp)))
  {
    printf(&#34;Failed to set register EVENT callback.\n&#34;);
    return EX_FAILURE;
  }
  if (checkerr(errhp, OCIAttrSet(envhp, (ub4) OCI_HTYPE_ENV,
                                (dvoid *)<span class="bold">evtctx</span>, (ub4) 0, 
  <span class="bold">                              (ub4)OCI_ATTR_EVTCTX</span>, errhp)))
  {
    printf(&#34;Failed to set register EVENT callback context.\n&#34;);
    return EX_FAILURE;
  }
return EX_SUCCESS;
</pre>
<p>After registering an event callback and context, OCI calls the registered function once for each high availability event.</p>
</div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-69054923-807A-4446-B9AD-051B41DA71F4__GUID-B153AAFA-9F85-4AA5-980E-A933CAD7D501">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-8F41DEAB-CE18-48E5-B57A-A4B4FA908217" title="You can create a service using Oracle Enterprise Manager or the SRVCTL utility.">Creating Services</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-A59315AA-8EBE-43CC-9FFF-95A4522908BA" title="You can create and administer services using Enterprise Manager. You can also use the SRVCTL utility to perform most service management tasks.">Administering Services</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-C32436A0-3706-4E15-96FA-BB7F92007E55" title="Fast Application Notification (FAN) is a high availability notification mechanism that Oracle RAC uses to notify other processes about cluster configuration and service-level information, including status changes such as UP or DOWN events.">About Fast Application Notification (FAN)</a>&#34;</span></p>
</li>
<li>
<p><a class="olink LNOCI090" target="_blank" href="../LNOCI/oci09adv.htm#LNOCI090"><span><cite>Oracle Call Interface Programmer&#39;s Guide</cite></span></a> for more information about event notification and user-registered callbacks</p>
</li>
<li>
<p><a class="olink RACAD7134" target="_blank" href="../RACAD/GUID-074729CB-8A91-419C-A6E1-3B9E4FD8D869.htm#RACAD7134"><span><cite>Oracle Real Application Clusters Administration and Deployment Guide</cite></span></a> for more information about configuring fast application notification for OCI clients.</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-4AF0D3BD-A9A0-445E-A580-C1C3AB1C7D7F"></a>
<h4 id="TDPRC-GUID-4AF0D3BD-A9A0-445E-A580-C1C3AB1C7D7F" class="sect4">Configuring OCI Clients to use Transaction Guard</h4>
<div>
<p>Oracle Call Interface (OCI) clients can use Transaction Guard to replay an in-flight transaction when a recoverable error occurs.</p>
<div class="section">
<p>OCI supports Fast Application Notification (FAN) messages and Transparent Application Failover (TAF). FAN is designed to quickly notify an OCI-based application of outages at the node, database, instance, service, and public network levels. Once notified of the failure, an application can leverage TAF to re-establish the failed connection on a surviving instance. What is missing is the ability to reliably determine the outcome of the failed transaction and the ability to recover the current transaction after database connectivity has been restored. This section describes how to configure OCI to enable transactional TAF. <span class="bold">Transactional TAF</span> is the OCI driver&#39;s ability to replay a transaction that is active when a recoverable error occurs.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To configure OCI clients to use Transaction Guard:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Use the Cluster Managed Services page in Oracle Enterprise Manager Cloud Control to a create services for the OCI clients.</span>
<ol>
<li><span>Set the <code class="codeph">commit_outcome</code> attribute to <code class="codeph">TRUE</code>.</span></li>
<li><span>Set the failover type for the service to <code class="codeph">TRANSACTION</code>.</span></li>
</ol>
<div>
<p>If the OCI application issues database requests that contain more than one transaction, then you must also set the <code class="codeph">SESSION_STATE</code> service attribute to <code class="codeph">STATIC</code>. Setting <code class="codeph">SESSION_STATE</code> to <code class="codeph">static</code> enables the TAF callback to restore the non-transactional session state required for each database transaction, independent of the application request boundaries.</p>
</div>
</li>
<li class="stepexpand"><span>Perform the steps described in <span class="q">&#34;<a href="configwlm.htm#GUID-69054923-807A-4446-B9AD-051B41DA71F4" title="Oracle Call Interface (OCI) clients can register to receive notifications about Oracle Real Application Clusters (Oracle RAC) high availability events and respond when events occur.">Configuring OCI Clients to Receive FAN Notifications</a>&#34;</span> to enable FAN for OCI clients.</span></li>
<li class="stepexpand"><span>If you use a connection pool with your OCI application, then transaction recording begins at session check-out and is purged at session check-in.</span>
<div>
<p>If you do not use a connection pool, then, within the OCI application, mark the beginning and the end of an application request, as shown in the following example. The transaction history between the beginning and end of the application request is recorded for possible playback.</p>
</div>
<div>
<p>The following pseudo-code provides an example of how to configure an OCI client application to use Transaction Guard:</p>
<pre dir="ltr">Get_Connection();

Configure_Connection();

/* mark the beginning of an application request; purge session&#39;s 
recorded call history  */ 

state = OCI_SESSION_STATE_RESTORABLE; 
OCIAttrSet(usrhp, OCI_HTYPE_SESSION, &amp;state, 0,
           OCI_ATTR_SESSION_STATE, errhp); 
/* process an application request */ 

/* mark end of application request; purge session&#39;s recorded call history */
state = OCI_SESSION_STATELESS; 
OCIAttrSet(usrhp, OCI_HTYPE_SESSION, &amp;state, 0, 
           OCI_ATTR_SESSION_STATE, errhp); 

Release_connection();
</pre></div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-4AF0D3BD-A9A0-445E-A580-C1C3AB1C7D7F__GUID-E028B8B6-F74E-4203-B991-9E68B0835046">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-8F41DEAB-CE18-48E5-B57A-A4B4FA908217" title="You can create a service using Oracle Enterprise Manager or the SRVCTL utility.">Creating Services</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-A59315AA-8EBE-43CC-9FFF-95A4522908BA" title="You can create and administer services using Enterprise Manager. You can also use the SRVCTL utility to perform most service management tasks.">Administering Services</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-C32436A0-3706-4E15-96FA-BB7F92007E55" title="Fast Application Notification (FAN) is a high availability notification mechanism that Oracle RAC uses to notify other processes about cluster configuration and service-level information, including status changes such as UP or DOWN events.">About Fast Application Notification (FAN)</a>&#34;</span></p>
</li>
<li>
<p><a class="olink LNOCI090" target="_blank" href="../LNOCI/oci09adv.htm#LNOCI090"><span><cite>Oracle Call Interface Programmer&#39;s Guide</cite></span></a> for more information about event notification and user-registered callbacks</p>
</li>
<li>
<p><a class="olink RACAD7134" target="_blank" href="../RACAD/GUID-074729CB-8A91-419C-A6E1-3B9E4FD8D869.htm#RACAD7134"><span><cite>Oracle Real Application Clusters Administration and Deployment Guide</cite></span></a> for more information about configuring fast application notification for OCI clients.</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="TDPRC319"></a>
<div class="props_rev_3"><a id="GUID-5EE5B6E1-8F27-4F81-A4A1-BE67DEE4FA2F"></a>
<h3 id="TDPRC-GUID-5EE5B6E1-8F27-4F81-A4A1-BE67DEE4FA2F" class="sect3">Configuring ODP.NET Clients for High Availability</h3>
<div>
<p>Oracle Data Provider for .NET (ODP.NET) provides integration with Fast Application Notification (FAN), Run-time Connection Load Balancing, Transparent Application Failover (TAF), and Transaction Guard.</p>
<p>When a connection to an Oracle instance is unexpectedly severed, TAF seamlessly attempts to failover to another Oracle instance. Due to the delay that a failover can incur, the application may wish to be notified by a TAF callback. ODP.NET supports TAF callback through the Failover event of the <code class="codeph">OracleConnection</code> object. To receive TAF callbacks, an event handler function must be registered with the <code class="codeph">Failover</code> event of the <code class="codeph">OracleConnection</code> object. Also the connection parameter <code class="codeph">enlist</code> should be set to <code class="codeph">false</code> for TAF to work.</p>
<p>ODP.NET connection pools subscribe to FAN notifications from Oracle RAC that indicate when nodes are down and when services are up or down. Based on these notifications, the ODP.NET connection pool:</p>
<ul style="list-style-type: disc;">
<li>
<p>Interrupts active sessions so they do not wait on TCP/IP timeouts, and</p>
</li>
<li>
<p>Clears idle sessions previously connected to the down node or instance or network so they are not passed to user sessions</p>
</li>
<li>
<p>Creates new connections to healthy nodes, if possible</p>
</li>
</ul>
<p>ODP.NET provides Run-time Connection Load Balancing to provide enhanced load balancing of the application workload. Instead of randomly selecting an available connection from the connection pool, it chooses the connection that can provide the best service based on the current workload information.</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-8E8C943C-7782-4DDC-9957-93B4CB496395">Configuring ODP.NET Clients to Receive FAN Notifications</a></strong><br/>
The procedures for enabling ODP.NET are similar to the procedures for enabling JDBC in that you must set parameters in the connection string to enable Fast Connection Failover (FCF).</li>
<li class="ulchildlink"><strong><a href="configwlm.htm#GUID-2EFD2914-9FEB-4155-AB10-30C0A7348071">About ODP.NET Clients and Using Transaction Guard</a></strong><br/>
When an ODP.NET application submits a transaction commit request and some type of failure occurs, such as a node, network, or database failure, ODP.NET can now deterministically conclude whether the transaction committed or not.</li>
</ul>
</div>
<a id="TDPRC320"></a><a id="TDPRC636"></a>
<div class="props_rev_3"><a id="GUID-8E8C943C-7782-4DDC-9957-93B4CB496395"></a>
<h4 id="TDPRC-GUID-8E8C943C-7782-4DDC-9957-93B4CB496395" class="sect4">Configuring ODP.NET Clients to Receive FAN Notifications</h4>
<div>
<p>The procedures for enabling ODP.NET are similar to the procedures for enabling JDBC in that you must set parameters in the connection string to enable Fast Connection Failover (FCF).</p>
<div class="section">
<p class="subhead3">To configure ODP.NET clients to receive FAN notifications:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Use the Cluster Managed Services page in Oracle Enterprise Manager Cloud Control to a create services for the ODP.NET clients.</span>
<ol>
<li><span>For Notification Properties, choose <span class="bold">Enable Fast Application Notification for OCI and ODP.NET Applications</span>.</span></li>
<li><span>Set the <span class="bold">Connection Load Balancing Goal</span> to Long.</span></li>
</ol>
</li>
<li class="stepexpand"><span>Set the <code class="codeph">ha events</code> connection string attribute to <code class="codeph">true</code> either at connection time or in the data source definition to subscribe to FAN high availability events and enable Fast Connection Failover for ODP.NET connection pools.</span>
<div>
<p>Note that this only works if you are using connection pools (the <code class="codeph">pooling</code> attribute to <code class="codeph">true</code>).</p>
<p>You can also enable Run-time Connection Load Balancing by setting the run-time load balancing attribute for the service to <code class="codeph">SERVICE_TIME</code>.</p>
</div>
<div>
<p>Use code similar to the following, where <span class="variable">username</span> is the name of the database user that the application uses to connect to the database, <span class="variable">password</span> is the password for that database user, and the service name is <code class="codeph">odpserv</code>:</p>
<pre dir="ltr">// C#
using System;
using Oracle.DataAccess.Client;
class HAEventEnablingSample
{
  static void Main()
  {
    OracleConnection con = new OracleConnection();

    // Open a connection using ConnectionString attributes
    // Also, enable &#34;load balancing&#34;
    con.ConnectionString =
      &#34;User Id=<span class="italic">username</span>;Password=<span class="italic">password</span>;&#34; +
      &#34;Data Source=//docrac.example.com/odpserv;&#34; +
      &#34;Min Pool Size=10;Connection Lifetime=86400;Connection Timeout=60;&#34; +
      &#34;HA Events=true;Incr Pool Size=5;Decr Pool Size=2&#34;;

    con.Open();
    // Carry out work against the database here.
    con.Close();
    // Dispose OracleConnection object
    con.Dispose();
    }
 }
</pre></div>
</li>
<li class="stepexpand"><span>The run-time load balancing events are published as messages in the SYS.SYS$SERVICE_METRICS queue. You must grant dequeue permission on this queue to the database user that the application uses to connect to the database.</span>
<div>
<p>Use a command similar to the following, where <span class="variable">username</span> represents the database user that the .NET application uses to connect to the database:</p>
<pre dir="ltr">execute
dbms_aqadm.grant_queue_privilege(&#39;DEQUEUE&#39;,&#39;SYS.SYS$SERVICE_METRICS&#39;, <span class="variable">username</span>);
</pre></div>
<div>
<p>The <span class="variable">username</span> specified in this step equals the <span class="variable">username</span> used for the User Id argument in the previous step.</p>
</div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-8E8C943C-7782-4DDC-9957-93B4CB496395__GUID-F8D5A949-607D-4C2F-BF6F-34B880FC522B">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-8F41DEAB-CE18-48E5-B57A-A4B4FA908217" title="You can create a service using Oracle Enterprise Manager or the SRVCTL utility.">Creating Services</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-C32436A0-3706-4E15-96FA-BB7F92007E55" title="Fast Application Notification (FAN) is a high availability notification mechanism that Oracle RAC uses to notify other processes about cluster configuration and service-level information, including status changes such as UP or DOWN events.">About Fast Application Notification (FAN)</a>&#34;</span></p>
</li>
<li>
<p><a class="olink ODPNT0007" target="_blank" href="../ODPNT/features.htm#ODPNT0007"><span><cite>Oracle Data Provider for .NET Developer&#39;s Guide for Microsoft Windows</cite></span></a> for more information about event notification and user-registered callbacks</p>
</li>
<li>
<p><a class="olink RACAD7136" target="_blank" href="../RACAD/GUID-1A7346B1-AFE3-4B17-AD7E-E35FE628CDF9.htm#RACAD7136"><span><cite>Oracle Real Application Clusters Administration and Deployment Guide</cite></span></a> for more information about configuring fast application notification for ODP.NET clients.</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="TDPRC637"></a>
<div class="props_rev_3"><a id="GUID-2EFD2914-9FEB-4155-AB10-30C0A7348071"></a>
<h4 id="TDPRC-GUID-2EFD2914-9FEB-4155-AB10-30C0A7348071" class="sect4">About ODP.NET Clients and Using Transaction Guard</h4>
<div>
<p>When an ODP.NET application submits a transaction commit request and some type of failure occurs, such as a node, network, or database failure, ODP.NET can now deterministically conclude whether the transaction committed or not.</p>
<p>Starting with Oracle Database 12<span class="italic">c</span>, applications can use a logical transaction ID (LTXID) to determine the outcome of the last transaction open in a database session following an outage. Using Transaction Guard, the end user experience is vastly improved by returning to the application and user, following an outage, whether the last submission committed and completed or did not. A committed result stays committed. An uncommitted result stays uncommitted, and is a green light, for example, for the user or application to resubmit.</p>
<p>Without using Transaction Guard, applications that attempt to retry operations following outages can cause logical corruption by committing duplicate transactions.</p>
<div class="infoboxnotealso" id="GUID-2EFD2914-9FEB-4155-AB10-30C0A7348071__GUID-2A223C4A-9D1E-4D74-B807-2813D61AC581">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-8F41DEAB-CE18-48E5-B57A-A4B4FA908217" title="You can create a service using Oracle Enterprise Manager or the SRVCTL utility.">Creating Services</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-A59315AA-8EBE-43CC-9FFF-95A4522908BA" title="You can create and administer services using Enterprise Manager. You can also use the SRVCTL utility to perform most service management tasks.">Administering Services</a>&#34;</span></p>
</li>
<li>
<p><a class="olink ODPNT941" target="_blank" href="../ODPNT/OracleConnectionClass.htm#ODPNT941"><span><cite>Oracle Data Provider for .NET Developer&#39;s Guide for Microsoft Windows</cite></span></a> for an example of using Transaction Guard in an ODP.NET application</p>
</li>
<li>
<p><span class="q">&#34;<a href="configwlm.htm#GUID-C32436A0-3706-4E15-96FA-BB7F92007E55" title="Fast Application Notification (FAN) is a high availability notification mechanism that Oracle RAC uses to notify other processes about cluster configuration and service-level information, including status changes such as UP or DOWN events.">About Fast Application Notification (FAN)</a>&#34;</span></p>
</li>
<li>
<p><a class="olink RACAD7134" target="_blank" href="../RACAD/GUID-074729CB-8A91-419C-A6E1-3B9E4FD8D869.htm#RACAD7134"><span><cite>Oracle Real Application Clusters Administration and Deployment Guide</cite></span></a> for more information about configuring fast application notification for ODP.NET clients.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5060">
<tr>
<td class="cellalignment5074">
<table class="cellalignment5065">
<tr>
<td class="cellalignment5064"><a href="adminoc.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5064"><a href="racbureco.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2006, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5076">
<table class="cellalignment5063">
<tr>
<td class="cellalignment5064"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5064"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5064"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5064"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5064"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5064"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>