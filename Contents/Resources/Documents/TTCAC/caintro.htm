<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-107390"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Using%20the%20Cache%20Advisor"></a><title>Using the Cache Advisor</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 726"/>
<meta name="dcterms.created" content="2014-09-23T15:6:31Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="TimesTen Application-Tier Database Cache User&#39;s Guide"/>
<meta name="dcterms.identifier" content="E21634-12"/>
<meta name="dcterms.isVersionOf" content="TTCAC"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2012, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="cleanup.htm" title="Previous" type="text/html"/>
<link rel="Next" href="rac.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E21634-12.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">14/21</span> <!-- End Header -->
<div id="TTCAC502" class="chapter"><a id="BABHGIIB"></a>
<h1 class="chapter"><span class="secnum">10</span> Using the Cache Advisor<a id="sthref681"></a></h1>
<p>The following sections describe and demonstrate how to use the TimesTen Application-Tier Database Cache Advisor (TimesTen Cache Advisor):</p>
<ul>
<li>
<p><a href="#CHDEAIDH">Cache Advisor overview</a></p>
</li>
<li>
<p><a href="#BABDIGHD">Setting up the Oracle Database and TimesTen host systems</a></p>
</li>
<li>
<p><a href="#BABFEADJ">Running a SQL workload application</a></p>
</li>
<li>
<p><a href="#BABGBDIC">Running the Cache Advisor</a></p>
</li>
<li>
<p><a href="#BABBABHB">Viewing the Cache Advisor reports</a></p>
</li>
<li>
<p><a href="#BABIFEAB">Cleaning up the Oracle and TimesTen databases and host systems</a></p>
</li>
</ul>
<a id="CHDEAIDH"></a>
<div id="TTCAC476" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Cache Advisor overview<a id="sthref682"></a><a id="sthref683"></a></h2>
<p>The TimesTen Cache Advisor enables Oracle Database customers to determine whether the performance of an existing Oracle Database application can be improved if the application is used with TimesTen Cache, also referred to as a TimesTen database.</p>
<p>Cache Advisor generates recommendations of TimesTen cache group definitions based on the SQL usage in the Oracle Database application. It does this by evaluating either a captured SQL workload from the application or an existing SQL tuning set. Cache Advisor analyzes this information along with the schema definitions of the Oracle Database objects to determine table and column usage patterns. Cache Advisor also analyzes application performance for specified TimesTen Cache sizes, so the cache group recommendations may differ depending on the size of the specified cache. For information on SQL tuning sets, see <a class="olink TDPPT164" href="../TDPPT/tdppt_sqltune.htm#TDPPT164">&#34;Managing SQL Tuning Sets&#34;</a> in the <span class="italic">Oracle Database 2 Day + Performance Tuning Guide</span>.</p>
<p><a id="sthref684"></a><a id="sthref685"></a>When evaluating the captured SQL application workload or SQL tuning set, Cache Advisor recommends either using asynchronous writethrough (AWT) cache groups or read-only cache groups in the TimesTen application. It determines the type of cache groups to use based on the number of SQL statement executions in the Oracle Database application that change data values relative to the number of SQL <code>SELECT</code> statement executions.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Cache Advisor evaluates DML statements (<code>SELECT</code>, <code>INSERT</code>, <code>UPDATE</code> and <code>DELETE</code>) for execution porting issues, but evaluates only <code>SELECT</code> statements on both TimesTen and Oracle Database for the performance comparison.
<p>Cache Advisor evaluates each SQL statement in isolation from any other statement. If necessary, it performs a <code>ROLLBACK</code> after each statement completes to preserve data. If Cache Advisor were to commit all DML changes, then the data would change, which would alter the behavior of any subsequent Cache Advisor evaluations. For example, if Cache Advisor evaluates and commits a <code>DELETE</code> statement on Oracle Database, then when the Cache Advisor performs the evaluation again, there would be no rows to delete.</p>
</div>
<p><a id="sthref686"></a>After analyzing the application workload or SQL tuning set, and comparing its performance between Oracle Database and TimesTen Cache, Cache Advisor generates an HTML report that contains performance statistics comparing Oracle Database and TimesTen Cache, definitions of the recommended cache tables in the TimesTen cache group that the application accesses, and the SQL statements that reference the cache tables. The report also shows which statements from the workload or SQL tuning set can be executed in TimesTen Cache with no changes, and which statements require modification before they can be executed. See <a href="oracle_tt.htm#CHDJFAEA">Appendix C, &#34;Compatibility Between TimesTen and Oracle Databases&#34;</a> for information about differences that may be encountered.</p>
<p>Cache Advisor also generates a <code>ttIsql</code> script that can be used to implement the recommended cache group definitions. The user-editable script contains SQL statements such as <code>CREATE CACHE GROUP</code>, <code>LOAD CACHE GROUP</code>, <code>CREATE INDEX</code>, <code>CREATE SYNONYM</code>, and <code>CREATE VIEW</code>.</p>
<p>Cache Advisor requires the use of up to three databases:</p>
<ul>
<li>
<p>A target Oracle database on which the user application runs and where the application schema resides. This is where the SQL workload is captured. The workload executing on this database should be as close to the production database workload as possible. In addition, the Cache Advisor relies on statistics in the Oracle target database to calculate the table sizing in TimesTen. Users should ensure statistics in the target Oracle database are collected and are up to date.</p>
</li>
<li>
<p>A repository Oracle database where Cache Advisor performs analysis of the workload of SQL statements that are executed on the target Oracle database.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If the target database is part of a production system, place the Cache Advisor repository on a separate, non-production database. If the target database is part of a test system, place the Cache Advisor repository on the same database as the target to simplify setup and operation.</div>
</li>
<li>
<p>A TimesTen database, also referred to as an TimesTen Cache, where Cache Advisor defines and evaluates the recommended cache groups whose cache tables correspond to the tables in the target Oracle database that the application workload accesses.</p>
</li>
</ul>
<div id="TTCAC477" class="figure">
<p class="titleinfigure"><a id="sthref687"></a>Figure 10-1 Demonstration of the three databases used by the Cache Advisor</p>
<img width="447" height="326" src="img/cacheadvisordbs.gif" alt="Description of Figure 10-1 follows"/><br/>
<a id="sthref688" href="img_text/cacheadvisordbs.htm">Description of &#34;Figure 10-1 Demonstration of the three databases used by the Cache Advisor&#34;</a><br/>
<br/></div>
<!-- class="figure" --></div>
<!-- class="sect1" -->
<a id="BABDIGHD"></a>
<div id="TTCAC503" class="sect1">
<h2 class="sect1">Setting up the Oracle Database and TimesTen host systems<a id="sthref689"></a></h2>
<p>Before you can use Cache Advisor, you must first install TimesTen and then configure the Oracle Database and TimesTen systems.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
See the <a class="olink TTINS" href="../TTINS/toc.htm"><span class="italic">Oracle TimesTen In-Memory Database Installation Guide</span></a> for information about installing TimesTen.</div>
<p>The following sections provide an example to show how to configure each database and host in order to execute the Cache Advisor. This example uses one of the Quick Start sample programs as a demonstration for the application that executes the SQL workload.</p>
<p>To set up the Oracle Database and TimesTen hosts and databases, complete the following tasks:</p>
<ol>
<li>
<p><a href="#BABCEHDH">Configure the target Oracle database</a></p>
</li>
<li>
<p><a href="#BEIBJGJJ">Configure the repository Oracle database</a></p>
</li>
<li>
<p><a href="#BABJHHHC">Configure the TimesTen database</a></p>
</li>
</ol>
<p>See <a href="#BABJAAAI">&#34;Cache Advisor configuration options and usage guidelines&#34;</a> for details on the configuration options and usage guidelines when installing and configuring each host and database included in the Cache Advisor environment.</p>
<a id="BABCEHDH"></a>
<div id="TTCAC504" class="sect2">
<h3 class="sect2">Configure the target Oracle database<a id="sthref690"></a><a id="sthref691"></a></h3>
<p>The target Oracle database is where the application schema is defined. This is the database that the user application accesses. Cache Advisor requires that the version of the target database be Oracle Database Enterprise Edition 10<span class="italic">g</span> Release 2 (10.2.0.4) or later.</p>
<p>To set up the target database for use by TimesTen Cache, start SQL*Plus from an operating system shell on the TimesTen database system and connect to the target database as the Oracle Database <code>sys</code> user. In this example, the net service name of the target database is <code>targetdb</code>.</p>
<pre>% cd <span class="italic">TimesTen_install_dir</span>/oraclescripts
% sqlplus sys@targetdb as sysdba
Enter password: <span class="italic">password</span>
</pre>
<p>Use SQL*Plus to create a default tablespace that is be used by both the Oracle Database <code>timesten</code> user and the cache administration user. This tablespace must only be used to store objects for TimesTen Cache and should not be shared with other applications. In this example, the name of the default tablespace is <code>cachetblsp</code>. For more information about the <code>timesten</code> user, see <a href="gettingstarted.htm#CHDHAIJF">&#34;Create users in the Oracle database&#34;</a>.</p>
<p>Run the SQL*Plus script <code><span class="codeinlineitalic">TimesTen_install_dir</span></code><code>/oraclescripts/initCacheGlobalSchema.sql</code> to create the <code>timesten</code> user and its metadata tables and the <code>TT_CACHE_ADMIN_ROLE</code> role that defines privileges to be granted to this user. Pass the default tablespace as an argument to the <code>initCacheGlobalSchema.sql</code> script.</p>
<pre>SQL&gt; <a id="sthref692"></a><a id="sthref693"></a>CREATE TABLESPACE cachetblsp DATAFILE &#39;datfttuser.dbf&#39; SIZE 100M;
SQL&gt; <a id="sthref694"></a>@initCacheGlobalSchema &#34;cachetblsp&#34;
</pre>
<p>Next, use SQL*Plus to create a target Oracle Database user, if this user does not already exist.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Since this example is using the Quick Start sample program, the example creates <code>oratt</code> as the schema owner.</div>
<p>The target Oracle Database user owns the Oracle Database objects that are to be accessed by the SQL workload application and are candidates for caching in a TimesTen database. The target Oracle Database user is the same as the schema user that is described in <a href="gettingstarted.htm#CHDHAIJF">&#34;Create users in the Oracle database&#34;</a>.</p>
<p>Grant this user at least the minimum set of privileges required to create tables in the Oracle database to be cached in a TimesTen database. In this example, the target Oracle Database user is <code>oratt</code>.</p>
<pre>SQL&gt; <a id="sthref695"></a><a id="sthref696"></a>CREATE USER oratt IDENTIFIED BY oracle;
SQL&gt; GRANT CREATE SESSION, RESOURCE TO oratt;
</pre>
<p>Then use SQL*Plus to create a cache administration user. Run the SQL*Plus script <code><span class="codeinlineitalic">TimesTen_install_dir</span></code><code>/oraclescripts/<a id="sthref697"></a>grantCacheAdminPrivileges.sql</code> to grant the cache administration user the minimum set of privileges required to process cache group operations. For information on cache groups, see <a href="define.htm#CHDIGJJB">&#34;Cache groups and cache tables&#34;</a>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The target Oracle Database user and the cache administration user must be different users. In addition, when you create the repository Cache Advisor user, this user must also be a different user.</div>
<p>Pass the cache administration user name as an argument to the <code>grantCacheAdminPrivileges.sql</code> script. In this example, the cache administration user is <code>cacheuser</code> and the name of its default tablespace is <code>cachetblsp</code>. For more information about the cache administration user, see <a href="gettingstarted.htm#CHDHAIJF">&#34;Create users in the Oracle database&#34;</a>.</p>
<pre>SQL&gt; <a id="sthref698"></a>CREATE USER cacheuser IDENTIFIED BY oracache
   DEFAULT TABLESPACE cachetblsp QUOTA UNLIMITED ON cachetblsp;
SQL&gt; GRANT SELECT ANY TABLE, DELETE ANY TABLE,
   INSERT ANY TABLE, UPDATE ANY TABLE TO cacheuser;
SQL&gt; <a id="sthref699"></a>@grantCacheAdminPrivileges &#34;cacheuser&#34;
</pre>
<p>Run the SQL*Plus script <code><span class="codeinlineitalic">TimesTen_install_dir</span></code><code>/oraclescripts/ttca_setupTarget.sql</code> to perform the following operations:</p>
<ul>
<li>
<p>Create the <code>TTCA_TARGET_ROLE</code> role that defines privileges to be granted to the target Oracle Database user.</p>
</li>
<li>
<p>Create an Oracle directory object named <code>TTCA_DIRECTORY</code> that is used for file operations into and out of the target database. The <code>ttca_setupTarget.sql</code> script associates the <code>TTCA_DIRECTORY</code> directory object with the local directory that the target Cache Advisor user created earlier. See <a class="olink SQLRF01207" href="../SQLRF/statements_5008.htm#SQLRF01207">&#34;CREATE DIRECTORY&#34;</a> in the <span class="italic">Oracle Database SQL Language Reference</span> for information about Oracle Database directory objects.</p>
</li>
</ul>
<p>After running the <code>ttca_setupTarget.sql</code> script, exit the SQL*Plus session.</p>
<p>The following example shows the output when the <code>TTCA_DIRECTORY</code> object has not yet been created:</p>
<pre>SQL&gt; <a id="sthref700"></a><a id="sthref701"></a>@ttca_setupTarget

This script sets up your target Oracle database for use with the TimesTen
Cache Advisor.
 
The target Oracle database is the application database that you wish to cache
using TimesTen Application-Tier Database Cache.
 
This script performs the following actions:
1. Create the TTCA_TARGET_ROLE role, if it does not already exist
2. Create a new directory object on the target Oracle database,
   if directed by you to do so
3. Grant read and write access on a new or existing target Oracle database
   directory object to the TTCA_TARGET_ROLE role
4. Grant the TTCA_TARGET_ROLE role to the target Oracle database user
 
Run this script as SYSDBA on the target database.
 
(You will also need to configure a repository Oracle database that you set up
with the ttca_setupRepository.sql script.)
 
Please enter a target Oracle database user name to access the target database:
 oratt
 
The TimesTen Cache Advisor requires the use of a directory object on the
target Oracle database for DataPump and file operations.
 
An Oracle directory object is created with the CREATE DIRECTORY Oracle Data
Definition Language (DDL) statement. A directory object is identified by an
Oracle object name (up to 30 alphanumeric characters) and is associated with
a host-platform-specific directory path (up to 4000 characters).
 
********************************************************************************
*** Enter the directory path on the target system to use in the definition
*** of TTCA_DIRECTORY
********************************************************************************
? /mysystem/mydirectory/ttca_directory
 
 
Create TTCA_DIRECTORY directory object succeeded.
 
Grant READ and WRITE on TTCA_DIRECTORY directory object to TTCA_TARGET_ROLE role
succeeded.
 
Grant READ and WRITE on TTCA_DIRECTORY directory object to scott role succeeded.
To revoke privileges granted by this script:
REVOKE ttca_target_role FROM oratt;
DROP ROLE ttca_target_role;
REVOKE READ, WRITE ON DIRECTORY TTCA_DIRECTORY FROM oratt;
No errors.
 
*******************
**** All done! ****
*******************
</pre>
<p>If the <code>TTCA_DIRECTORY</code> object has already been created, the script notices and acknowledges that it already exists:</p>
<pre>*** The directory object used by cache Advisor (TTCA_DIRECTORY) already exists.
*** Please press ENTER to continue
********************************************************************************
?
</pre></div>
<!-- class="sect2" -->
<a id="BEIBJGJJ"></a>
<div id="TTCAC478" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Configure the repository Oracle database<a id="sthref702"></a></h3>
<p>The repository Oracle database is where Cache Advisor performs analysis of the SQL workload that is being run on the target Oracle database. Cache Advisor also does report and script generation in the repository database, as well as store tasks. A task is an object that contains information about the workload, performance results, and Cache Advisor options that are specified by the user.</p>
<ul>
<li>
<p>If the target database is part of a production system, place the Cache Advisor repository on a separate, non-production database. First install and configure a repository database of Oracle Database Enterprise Edition 10g Release 2 (10.2.0.4) or later. The version of the repository database must be the same or later than the version of the target Oracle database. Because the Cache Advisor copies schema definitions from the target database to the repository database when using separate target and repository databases, the separate repository database should be devoted to the Cache Advisor. When you are ready to clean up the Cache Advisor repository, simply drop the database.</p>
</li>
<li>
<p>If the target database is part of a test system, place the Cache Advisor repository on the same database as the target for simplification of setup and operation. When you are ready to clean up the Cache Advisor repository, execute the <code>DROP USER TTCACHEADVISOR CASCADE</code> statement.</p>
</li>
</ul>
<p>Start SQL*Plus from an operating system shell on the TimesTen database system and connect to the repository database as the Oracle Database <code>sys</code> user. In this example, the net service name of the repository database is <code>repositorydb</code>.</p>
<pre>% cd <span class="italic">TimesTen_install_dir</span>/oraclescripts
% sqlplus sys@repositorydb as sysdba
Enter password: <span class="italic">password</span>
</pre>
<p>You must connect to the repository database with the <code>SYSDBA</code> privilege.</p>
<p>Run the SQL*Plus script <code><span class="codeinlineitalic">TimesTen_install_dir</span></code><code>/oraclescripts/ttca_setupRepository.sql</code> to perform the following operations:</p>
<ul>
<li>
<p>Create a user that owns the objects in the repository database used to analyze the SQL workload run on the target Oracle database, and create the <code>ttca_ts</code> tablespace used to store these objects.</p>
</li>
<li>
<p>Create or specify an Oracle Database directory object used for file operations into and out of the repository database. The <code>ttca_setupRepository.sql</code> script associates the directory object with the local directory that the repository Cache Advisor user created earlier. See <a class="olink SQLRF01207" href="../SQLRF/statements_5008.htm#SQLRF01207">&#34;CREATE DIRECTORY&#34;</a> in <span class="italic">Oracle Database SQL Language Reference</span> for information about Oracle Database directory objects.</p>
</li>
</ul>
<p>After running the <code>ttca_setupRepository.sql</code> script, exit the SQL*Plus session.</p>
<pre>SQL&gt; <a id="sthref703"></a><a id="sthref704"></a><a id="sthref705"></a><a id="sthref706"></a>@ttca_setupRepository

This script sets up your repository Oracle database for use with the TimesTen
Cache Advisor.
 
The repository Oracle database is used by the TimesTen Cache Advisor as
an analytical workspace.
 
This script performs the following actions:
1. Create repository Oracle database user TTCACHEADVISOR (or other user name
   that you specify)
2. Grant read and write access on a new or existing repository Oracle database
   directory object to the repository database user
3. Create tablespace TTCA_TS, if it does not exist
4. Grant required privileges to the repository database user
5. Create required tables and views owned by the repository database user
 
Run this script as SYSDBA on the repository database.
 
(You will also be using a target Oracle database that you set up
with the ttca_setupTarget.sql script.)
 
Press ENTER to create the repository Oracle database user with
user name TTCACHEADVISOR, or enter an alternative user name for
the repository database user:
Please enter a password for the TTCACHEADVISOR user:
Please confirm the password for the TTCACHEADVISOR user:
 
The TimesTen Cache Advisor requires the use of a directory object on the
repository Oracle database for DataPump and file operations.
 
An Oracle directory object is created with the CREATE DIRECTORY Oracle Data
Definition Language (DDL) statement. A directory object is identified by an
Oracle object name (up to 30 alphanumeric characters) and is associated with
a host-platform-specific directory path (up to 4000 characters).
 
********************************************************************************
*** Enter the directory path on the repository system to use in the definition
*** of TTCA_DIRECTORY
********************************************************************************
? /mysystem/mydirectory/ttca_directory
 
Create TTCA_TS tablespace succeeded.
 
Create TTCACHEADVISOR user succeeded.
 
Create TTCA_DIRECTORY directory object succeeded.
 
*******************
**** All done! ****
*******************
 
To employ other directories as directory objects on the repository
database, grant READ,WRITE ON DIRECTORY &lt;directory_name&gt; TO TTCACHEADVISOR
</pre>
<p>If the <code>TTCA_DIRECTORY</code> object has already been created, the script notices and acknowledges that it already exists:</p>
<pre>*** The directory object used by cache Advisor (TTCA_DIRECTORY) already exists.
*** Please press ENTER to continue
********************************************************************************
?
</pre>
<p>If the <code>TT_CS</code> tablespace has already been created, the following statement does not appear in the output:</p>
<pre>Create TTCA_TS tablespace succeeded.
</pre></div>
<!-- class="sect2" -->
<a id="BABJHHHC"></a>
<div id="TTCAC505" class="sect2">
<h3 class="sect2">Configure the TimesTen database<a id="sthref707"></a></h3>
<p>The TimesTen database is where Cache Advisor defines and evaluates the recommended cache groups whose cache tables correspond to the tables in the target Oracle database. The TimesTen database is a test database to be used only by Cache Advisor and should not be shared with other applications.</p>
<p>In the following data source name (DSN) example, the net service name of the target Oracle database is <code>targetdb</code> and its database character set is <code>AL32UTF8</code>. The TimesTen database character set must match the database character set of the target Oracle database. <a id="sthref708"></a><a id="sthref709"></a><a id="sthref710"></a>You can determine the database character set of an Oracle database by executing the following query in SQL*Plus as any user:</p>
<pre>SQL&gt; SELECT value FROM nls_database_parameters 
 WHERE parameter=&#39;NLS_CHARACTERSET&#39;;
</pre>
<p>In the <code>.odbc.ini</code> file that resides in your home directory or the <code><span class="codeinlineitalic">TimesTen_install_dir</span></code><code>/info/sys.odbc.ini</code> file, create a TimesTen DSN <code>cacheadv</code> and set the following connection attributes:</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
In this example, Cache Advisor sets the <code>CacheGridEnable</code> attribute to 0, so that the user is not required to create a grid. For more details, see <a class="olink TTREF205" href="../TTREF/attribute.htm#TTREF205">&#34;CacheGridEnable&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Reference</span>.</div>
<pre><a id="sthref711"></a><a id="sthref712"></a>[cacheadv]
DataStore=/users/OracleCache/cacheadv
PermSize=64
OracleNetServiceName=targetdb
DatabaseCharacterSet=AL32UTF8
CacheGridEnable=0
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
<p>See <a href="prereqs.htm#BCFHIFAD">&#34;Define a DSN for the TimesTen database&#34;</a> for more information about defining a DSN for a TimesTen database that caches data from an Oracle database.</p>
<p>See <a class="olink TTOPR120" href="../TTOPR/using.htm#TTOPR120">&#34;Managing TimesTen Databases&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Operations Guide</span> for more information about TimesTen DSNs.</p>
</div>
<p>Set up the TimesTen database for use by TimesTen Cache. Start the <a id="sthref713"></a><code>ttIsql</code> utility on the TimesTen system from an operating system shell and connect to the <code>cacheadv</code> DSN as the TimesTen instance administrator user to create the TimesTen database that is to be used to cache data from the target Oracle database.</p>
<pre>% ttIsql cacheadv
</pre>
<p>Use <code>ttIsql</code> to create a <a id="sthref714"></a>cache manager user, where there is a companion Oracle Database user with the same name. <a id="sthref715"></a>Grant this user at least the minimum set of privileges required to create and perform operations on cache groups. In the following example, the cache manager user name is <code>cacheuser</code> and the cache administration user is acting as its companion Oracle Database user.</p>
<pre>Command&gt; CREATE USER cacheuser IDENTIFIED BY ttcache;
Command&gt; GRANT CREATE SESSION, CACHE_MANAGER, CREATE ANY TABLE TO cacheuser;
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
<p>For more information about the cache manager user, see <a href="prereqs.htm#BCFFABDH">&#34;Create the TimesTen users&#34;</a>.</p>
</div>
<p>Next, use <code>ttIsql</code> to call the <code><a id="sthref716"></a>ttCacheUidPwdSet</code> built-in procedure to set the cache administration user name and password. Then, exit the <code>ttIsql</code> session.</p>
<pre>Command&gt; call ttCacheUidPwdSet(&#39;cacheuser&#39;,&#39;oracache&#39;);
Command&gt; exit
</pre>
<p>The cache administration user name and password need to be set only once in a TimesTen database. See <a href="prereqs.htm#BCFFCGHH">&#34;Set the cache administration user name and password&#34;</a> for information about how this setting is used in the TimesTen database.</p>
</div>
<!-- class="sect2" -->
<a id="BABJAAAI"></a>
<div id="TTCAC482" class="sect2">
<h3 class="sect2">Cache Advisor configuration options and usage guidelines<a id="sthref717"></a><a id="sthref718"></a></h3>
<p>The following sections describe supported configuration options and guidelines for using the Cache Advisor:</p>
<ul>
<li>
<p><a href="#BABHICIJ">Supported configuration options for hosts and databases</a></p>
</li>
<li>
<p><a href="#BABJBGGE">Restrictions and assumptions</a></p>
</li>
</ul>
<a id="BABHICIJ"></a>
<div id="TTCAC483" class="sect3">
<h4 class="sect3">Supported configuration options for hosts and databases</h4>
<p>Cache Advisor supports the following configuration options for hosts and databases included in the Cache Advisor environment:</p>
<ul>
<li>
<p>A single Oracle database, which must be Oracle Database Enterprise Edition 10<span class="italic">g</span> Release 2 (10.2.0.4) or later, serves as both the target and repository databases. The target Oracle database must be a test database and not a production database.</p>
<p>The TimesTen database can reside either on a separate host system for a more accurate performance analysis or on the same host as the Oracle database for demonstration purposes.</p>
<p>This is the preferred configuration as it offers the simplest setup and operation.</p>
</li>
<li>
<p>A single Oracle database, which must be Oracle Database Enterprise Edition 10<span class="italic">g</span> Release 2 (10.2.0.4) or later, serves as the target database with no repository or TimesTen databases.</p>
<p>The target database can be part of a live, production system or part of a test system. This configuration is supported only with the <code>-export</code> command-line option.</p>
<p>This configuration can capture an application SQL workload and schema definitions with deferred analysis. Use the <code>-import</code> option with one of the other supported configurations to perform the deferred analysis.</p>
</li>
<li>
<p>The target Oracle database (which must be Oracle Database Enterprise Edition 10<span class="italic">g</span> Release 2 (10.2.0.4) or later), the repository Oracle database (which must be Oracle Database Enterprise Edition 10<span class="italic">g</span> Release 2 (10.2.0.4) or later), and the TimesTen database are all separate databases residing on the same or separate host systems.</p>
<p>The target Oracle database cannot be a version later than the repository Oracle database. For performance analysis with the <code>-evalSqlPerf</code> command-line option, the TimesTen database should reside on a separate host and the target Oracle database must be part of a test system, not a live production system. The repository database must be devoted to Cache Advisor in order to enable clean up.</p>
<p>This configuration offers flexibility in the allocation of resources.</p>
</li>
</ul>
</div>
<!-- class="sect3" -->
<a id="BABJBGGE"></a>
<div id="TTCAC484" class="sect3">
<h4 class="sect3">Restrictions and assumptions</h4>
<p>The design of the cache schema recommended by Cache Advisor assumes that the user application establishes a connection to the TimesTen database and a separate connection to the target Oracle database.</p>
<p>Cache Advisor supports most TimesTen DSN attribute settings. However, Cache Advisor does not support the following attribute settings:</p>
<ul>
<li>
<p><code>Temporary=1</code> (temporary or non-persistent TimesTen database)</p>
</li>
<li>
<p><code>TypeMode=1</code> (TimesTen data type mode)</p>
</li>
<li>
<p><code>DDLCommitBehavior=1</code> (do not automatically commit DDL statements)</p>
</li>
<li>
<p><code>DuplicateBindMode=1</code> (consider dynamic parameters with the same name as identical)</p>
</li>
<li>
<p><code>PLSQL=0</code> (disable the use of TimesTen PL/SQL)</p>
</li>
<li>
<p><code>DynamicLoadEnable=0</code> (disable dynamic loading of data from Oracle Database tables into TimesTen cache tables)</p>
</li>
</ul>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABFEADJ"></a>
<div id="TTCAC479" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Running a SQL workload application</h2>
<p>This example uses the OCI version of the throughput benchmark (<code>tptbmOCI</code>) to generate a SQL workload on the target Oracle database.</p>
<p>Build and run the demo program as any operating system user on the TimesTen system. The net service name of the target database is <code>targetdb</code>. The target Oracle Database user is <code>oratt</code>. The password of the <code>oratt</code> user is <code>oracle</code>. The application table is populated with 25<sup>2</sup> = 625 rows and the maximum number of SQL statements per transaction is 1000.</p>
<pre>% cd <span class="italic">TimesTen_install_dir</span>/quickstart/sample_code/oci
% make tptbmOCI
% tptbmOCI -service targetdb -user oratt -key 25 -max 1000
Enter password for oratt : <span class="italic">password</span>
...
Load the oratt.vpn_users table with 625 rows of data
Run 10000 txns with 1 process: 80% read, 20% update, 0% insert, 0% delete
</pre></div>
<!-- class="sect1" -->
<a id="BABGBDIC"></a>
<div id="TTCAC506" class="sect1">
<h2 class="sect1">Running the Cache Advisor<a id="sthref719"></a></h2>
<p>While the <code>tptbmOCI</code> workload application is running on the target Oracle database, in a separate window run the <a id="sthref720"></a><code>ttCacheAdvisor</code> utility on the TimesTen system from an operating system shell as the instance administrator user. Specify the target Oracle database, repository Oracle database, and TimesTen database involved in the evaluation.</p>
<pre>% ttCacheAdvisor -oraTarget -oraConn &#34;oratt@targetdb&#34; \
 -oraRepository -oraConn &#34;ttcacheadvisor@repositorydb&#34; \
 -ttConn &#34;DSN=cacheadv;UID=cacheuser&#34; \
 -report /home/ttuser/CAreport -task sampletask -captureCursorCache 10 \
 -evalSqlPerf

Enter password for Oracle user oratt@targetdb: <span class="italic">password</span>
31.16:21:03 Info: beginning Oracle batch operation checkAuthorization on 
oratt@targetdb
31.16:21:03 Info: Oracle batch operation checkAuthorization completed
Enter password for Oracle user ttcacheadvisor@repositorydb: <span class="italic">password</span>
31.16:21:05 Info: beginning Oracle batch operation checkAuthorization on 
ttcacheadvisor@repositorydb
31.16:21:06 Info: Oracle batch operation checkAuthorization completed
31.16:21:06 Info: beginning Oracle batch operation checkOraUser on 
oratt@targetdb
31.16:21:06 Info: Oracle batch operation checkOraUser completed
31.16:21:06 Info: beginning TimesTen batch operation checkUserExists on 
&#34;dsn=cacheadv;uid=cacheuser&#34;
31.16:21:07 Info: TimesTen batch operation checkUserExists completed

Enter password for TimesTen user cacheuser (dsn=cacheadv): <span class="italic">password</span>
31.16:21:10 Info: beginning TimesTen batch operation checkTTuserAuthorization 
on &#34;dsn=cacheadv;uid=cacheuser&#34;
31.16:21:11 Info: TimesTen batch operation checkTTuserAuthorization completed
Enter password for Oracle user cacheuser@targetdb: <span class="italic">password</span>
31.16:21:14 Info: beginning Oracle batch operation checkTToraclepwdAttribute 
on cacheuser@targetdb
31.16:21:14 Info: Oracle batch operation checkTToraclepwdAttribute completed
31.16:21:14 Info: beginning Oracle batch operation verifyTargetConfig on 
oratt@targetdb
31.16:21:25 Info: Oracle batch operation verifyTargetConfig completed
...
</pre>
<p>The previous example used the <code>ttCacheAdvisor</code> utility options as follows:</p>
<ul>
<li>
<p>The <code><a id="sthref721"></a><a id="sthref722"></a><a id="sthref723"></a><a id="sthref724"></a>-oraTarget</code> option identifies the target Oracle database. The <code>-oraConn</code> option for <code>-oraTarget</code> specifies the target Oracle Database user and the net service name of the target database in the connection string.</p>
</li>
<li>
<p>The <code>-oraRepository</code> option identifies the repository Oracle database. The <code>-oraConn</code> option for <code>-oraRepository</code> specifies the user that owns the objects in the repository database used to analyze the SQL workload run on the target Oracle database and the net service name of the repository database in the connection string.</p>
</li>
<li>
<p>The <code>-ttConn</code> option identifies the TimesTen database. Specify the DSN and the cache manager user in the connection string.</p>
</li>
<li>
<p>The <code>-report</code> option overrides the default directory location where the report files reside.</p>
</li>
<li>
<p>The <code>-task</code> option overrides the default task name.</p>
</li>
<li>
<p>The <code>-captureCursorCache</code> option specifies that the <code>ttCacheAdvisor</code> utility capture the SQL workload running on the target database for a capture window duration of 10 minutes. If a percentage of SQL statements escape capture, use a longer capture duration.</p>
</li>
<li>
<p>The <code>-evalSqlPerf</code> option is specified to generate a performance comparison between the workload run on the target Oracle database and on the TimesTen database.</p>
</li>
</ul>
<p>If the passwords are not specified in the connection strings for each database, the <code>ttCacheAdvisor</code> utility prompts for the passwords of each user connecting to the TimesTen and Oracle databases used in the Cache Advisor evaluation.</p>
<p>For this example, the following user passwords are requested:</p>
<ul>
<li>
<p>The password for the target Oracle database user. In this example, the password of <code>oratt@targetdb</code> is <code>oracle</code>.</p>
</li>
<li>
<p>The password for the user that owns the objects in the repository Oracle database used to analyze the SQL workload run on the target Oracle database. In this example, the password of <code>ttcacheadvisor@repositorydb</code> is <code>ttca</code>.</p>
</li>
<li>
<p>The password for the TimesTen cache manager user. In this example, the password of <code>cacheuser</code> is <code>ttcache</code>.</p>
</li>
<li>
<p>The password of the cache administration user. In this example, the password of <code>cacheuser@targetdb</code> is <code>oracache</code>. This password is requested because the <code>-evalSqlPerf</code> option is specified to generate a performance comparison between the workload run on the target Oracle database and on the TimesTen database.</p>
</li>
</ul>
<p>The <code>ttCacheAdvisor</code> utility generates periodic status messages as it analyzes the application workload running on the target database.</p>
<p>When <code>ttCacheAdvisor</code> completes, it creates an HTML report showing performance statistics as well as information such as which SQL statements from the workload can and cannot be executed in TimesTen. By default, the files that constitute the report reside in the <span class="italic">task-name</span> directory where the utility was invoked. In this example, the directory is specified with the <code>-report</code> option. To view the report, open the <code>index.htm</code> file in the report files directory from a web browser. The task name, by default, is <code><span class="codeinlineitalic">userName_hostName_timestamp</span></code>. In this example, the task name is overridden with the <code>-task</code> option.</p>
<p>The <code>ttCacheAdvisor</code> utility also generates an implementation script file named <code>ttCacheAdvisor_</code><code><span class="codeinlineitalic">taskName_timestamp</span></code><code>.sql</code> in the directory specified with the <code>-report</code> option. This script can be run with the <code>ttIsql</code> utility to create objects in the TimesTen database used to implement the caching of the Oracle Database objects that were accessed by the application.</p>
<pre>% ttIsql -f ttCacheAdvisor_sampletask_20120531164101.sql
 &#34;DSN=cacheadv;UID=cacheuser;OraclePWD=oracache&#34;
</pre>
<p>For more information about the report and implementation script, see <a href="#BABBABHB">&#34;Viewing the Cache Advisor reports&#34;</a>.</p>
<p>For information about the syntax for <code>ttCacheAdvisor</code>, see <a class="olink TTREF782" href="../TTREF/util.htm#TTREF782">&#34;ttCacheAdvisor&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Reference</span>.</p>
<div id="TTCAC523" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref725"></a>
<h3 class="sect2">Improve performance by using NFS or FTP for transferring data<a id="sthref726"></a><a id="sthref727"></a><a id="sthref728"></a><a id="sthref729"></a><a id="sthref730"></a><a id="sthref731"></a></h3>
<div class="infobox-note">
<p class="notep1">Note:</p>
For details on the options mentioned in this section, see <a class="olink TTREF782" href="../TTREF/util.htm#TTREF782">&#34;ttCacheAdvisor&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Reference</span>.</div>
<p>Cache Advisor moves data into or out of the database using DataPump. DataPump requires an Oracle directory object with an associated directory path that is local and not network mounted. By default, Cache Advisor uses the <code>TTCA_DIRECTORY</code> Oracle directory object, which is created with the setup scripts, with the <code>-export</code> and <code>-import</code> options to export and import information using DataPump. Also, by default, Cache Advisor uses the OCI connection specified with the <code>-oraConn</code> option to transfer files. While more convenient and easy to use, the mechanism that Cache Advisor uses to transfer files over the OCI connection can be approximately three times slower than NFS or <code>ftp</code>. File transfer performance is only affected with the <code>-export</code> option, <code>-import</code> option, or the <code>-captureCursorCache</code> option when the target and repository are on different databases.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Configuring data file transfer options with the <code>-oraDirNfs</code> or <code>-ftp</code> options are optional and only relevant if you want to improve file transfer performance.</div>
<p>To improve file transfer performance, you can optionally use the <code>-oraDirNfs</code> or <code>-ftp</code> options. The <code>TTCA_DIRECTORY</code> directory object is not configured for use with the <code>-oraDirNfs</code> or <code>-ftp</code> options. So, you must specify and configure an alternate directory object with the <code>-oraDirObject</code> option for use with the <code>-oraDirNfs</code> or <code>-ftp</code> options.</p>
<p>To configure the directory,</p>
<ol>
<li>
<p>Log onto the Oracle database and create a new directory object. To create a directory object, execute the following command:</p>
<pre>CREATE DIRECTORY dir_name AS /local_dir_path/subdir_path;
</pre>
<p>The directory path you specify must be a local directory and cannot be network mounted.</p>
</li>
<li>
<p>Log onto the host system where the target or repository Oracle database resides and create a directory that matches the directory path associated with the Oracle directory object. This directory can be created by any operating system user on the target system. The directory must be created on a device that is local to the host system and not network mounted.</p>
<p>The owner of the directory is referred to as the target Cache Advisor user. In the following example, the target Cache Advisor user is <code>ca_usr</code> and the directory is <code>/local/ca_usr/ca_dir</code>.</p>
<pre>% mkdir /local/ca_usr/ca_dir
</pre></li>
<li>
<p>Determine the file system that the directory resides on. On Linux systems, this information can be obtained by running the <code>df</code> operating system command. In this example, the file system that the <code>/local/ca_usr/ca_dir</code> directory resides on is <code>/dev/sda1</code>.</p>
</li>
<li>
<p>Cache Advisor must be able to access the contents of the DataPump dump files from the host system to perform its analysis. However, the permissions placed on those files by Data Pump prevent them from being accessed through NFS or transferred to the repository system using ftp. To access the dump files from the repository system, set an access control list (ACL) on the directory where the files will reside on the target system.</p>
<p>As the operating system root user, enable the setting of ACLs on the file system.</p>
<pre># mount -o remount,acl /dev/sda1
</pre></li>
<li>
<p>Change the permissions on the directory so that only the Cache Advisor user can read from and write to it. Then, set ACLs on the directory and any files created in the directory to read, write, and execute for the Cache Advisor user and the operating system user that is running the Oracle Database server on the host system (typically the <code>oracle</code> user). On Linux systems, ACLs can be set by running the operating system <code>setfacl</code> command.</p>
<pre>% chmod 700 /local/ca_usr/ca_dir
% setfacl -m u:ca_usr:rwx /local/ca_usr/ca_dir
% setfacl -m d:u:ca_usr:rwx /local/ca_usr/ca_dir
% setfacl -m u:oracle:rwx /local/ca_usr/ca_dir
% setfacl -m d:u:oracle:rwx /local/ca_usr/ca_dir
</pre></li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABBABHB"></a>
<div id="TTCAC485" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Viewing the Cache Advisor reports</h2>
<p>This section provides examples of the report pages generated by the Cache Advisor. The report can be viewed using the following Web browsers:</p>
<ul>
<li>
<p>Firefox 3.6 or later</p>
</li>
<li>
<p>Chrome 7 or later</p>
</li>
<li>
<p>Safari 4 or later</p>
</li>
</ul>
<p>To view the report, open the <code>index.htm</code> file in the report files directory from a Web browser.</p>
<p>If the <code>-evalSqlPerf</code> option was specified when the <code>ttCacheAdvisor</code> utility was executed, the report shows the average response time for the SQL <code>SELECT</code> statements that were executed in the target Oracle database. It also shows the average response time for these statements when executed in the TimesTen database with the user-specified cache size. The complete TimesTen Cache size is the minimum TimesTen database size required to cache all of the objects that were accessed by the SQL workload and can be supported by TimesTen.</p>
<div id="TTCAC486" class="figure">
<p class="titleinfigure"><a id="sthref732"></a>Figure 10-2 Cache Advisor report home page</p>
<img width="818" height="606" src="img/careporthome.jpg" alt="Description of Figure 10-2 follows"/><br/>
<a id="sthref733" href="img_text/careporthome.htm">Description of &#34;Figure 10-2 Cache Advisor report home page&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<div id="TTCAC487" class="figure">
<p class="titleinfigure"><a id="sthref734"></a>Figure 10-3 Cache Advisor findings and recommendations</p>
<img width="827" height="331" src="img/careporthome2.jpg" alt="Description of Figure 10-3 follows"/><br/>
<a id="sthref735" href="img_text/careporthome2.htm">Description of &#34;Figure 10-3 Cache Advisor findings and recommendations&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>You can view the SQL statements that were executed in the workload by clicking the link under the SQL Statements column on the home page that indicates the number of statements in the workload. In this case, click the link of the first 2 where it says &#34;2 of 2&#34;.</p>
<div id="TTCAC488" class="figure">
<p class="titleinfigure"><a id="sthref736"></a>Figure 10-4 Viewing the number of SQL statements executed in the workload</p>
<img width="836" height="399" src="img/careportsql.jpg" alt="Description of Figure 10-4 follows"/><br/>
<a id="sthref737" href="img_text/careportsql.htm">Description of &#34;Figure 10-4 Viewing the number of SQL statements executed in the workload&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>You can click an individual SQL statement to see the response time and other statistics for that statement. In this example, when you click the link of the second statement, you see the following information about the <code>SELECT</code> statement:</p>
<div id="TTCAC489" class="figure">
<p class="titleinfigure"><a id="sthref738"></a>Figure 10-5 Information for a specific SQL statement executed during Cache Advisor evaluation</p>
<img width="829" height="464" src="img/careportsqlstats.jpg" alt="Description of Figure 10-5 follows"/><br/>
<a id="sthref739" href="img_text/careportsqlstats.htm">Description of &#34;Figure 10-5 Information for a specific SQL statement executed during Cache Advisor evaluation&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>You can click the name of the cache group to see the definition of the cache group and its cache tables, as well as the SQL statements that referenced the cache group. In this example, the following report page appears when you click the <code>CG1_USERSPECCACHE</code> link:</p>
<div id="TTCAC490" class="figure">
<p class="titleinfigure"><a id="sthref740"></a>Figure 10-6 Cache group details</p>
<img width="849" height="795" src="img/careportcg.jpg" alt="Description of Figure 10-6 follows"/><br/>
<a id="sthref741" href="img_text/careportcg.htm">Description of &#34;Figure 10-6 Cache group details&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<div id="TTCAC491" class="figure">
<p class="titleinfigure"><a id="sthref742"></a>Figure 10-7 SQL statements used for cache group</p>
<img width="811" height="451" src="img/careportcg2.jpg" alt="Description of Figure 10-7 follows"/><br/>
<a id="sthref743" href="img_text/careportcg2.htm">Description of &#34;Figure 10-7 SQL statements used for cache group&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>From the home page, you can access the text of the implementation script by clicking the &#34;Configure an TimesTen Cache for your application&#34; link. Then, from the next page, click the &#34;Implementation Script&#34; link.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
For more details on the implementation script, see <a href="#BABGBDIC">&#34;Running the Cache Advisor&#34;</a>.</div>
<p>The following shows an example of an implementation script:</p>
<pre>SHOW ERRORS;
SET ECHO OFF;
SET DEFINE ON;
SET SERVEROUTPUT ON;
PROMPT Welcome to the TimesTen CacheAdvisor (ttCacheAdvisor).
PROMPT
PROMPT ttCacheAdvisor generated this script to implement its recommendations. 
PROMPT The first step is to create the necessary TimesTen user accounts to
PROMPT receive the recommended cache groups and associated indexes, views, 
PROMPT materialized views and sequences. This script will now prompt you for
PROMPT the password for each account to be created. Be sure to use the same 
PROMPT password for each TimesTen user account as on Oracle.
PROMPT
PROMPT NOTE: If an error occurs or for any reason, you can abort this script at
PROMPT any time by pressing the control and C keys (^C) simultaneously. 
PROMPT Sometimes it is necessary to press ^C multiple times followed by 
PROMPT pressing ENTER.
ACCEPT ORAUSER_pwd CHAR PROMPT &#39;Enter user ORAUSER password (use same password
as on Oracle)? &#39;HIDE
ACCEPT ORAUSER_pwd2 CHAR PROMPT &#39;Confirm user ORAUSER password? &#39; HIDE
COMMIT;
EXEC createUser (&#39;ORAUSER&#39;,&#39;&amp;&amp;ORAUSER_pwd&#39;,&#39;&amp;&amp;ORAUSER_pwd2&#39;);
COMMIT;
DROP PROCEDURE createUser;
ACCEPT answer CHAR PROMPT &#39;Press ENTER to continue, ^C to abort:&#39;
EXEC execImmediate (&#39;CALL ttCacheStart&#39;);
EXEC execImmediate (&#39;CALL ttRepStop&#39;);
EXEC execImmediate (&#39;DROP CACHE GROUP CG1_USERSPECCACHE&#39;);
COMMIT;
COMMIT;
CREATE ASYNCHRONOUS WRITETHROUGH CACHE GROUP CG1_USERSPECCACHE
 FROM ORAUSER.VPN_USERS
 ( VPN_ID NUMBER(5,0) NOT NULL,
   VPN_NB NUMBER(5,0) NOT NULL,
   DIRECTORY_NB CHAR(10 BYTE) NOT NULL,
   LAST_CALLING_PARTY CHAR(10 BYTE) NOT NULL,
   DESCR CHAR(100 BYTE) NOT NULL,
   PRIMARY KEY (VPN_ID, VPN_NB)
 );
COMMIT;
LOAD CACHE GROUP CG1_USERSPECCACHE COMMIT EVERY 256 ROWS;
COMMIT;
CALL ttOptUpdateStats (&#39;ORAUSER.VPN_USERS&#39;,1);
COMMIT;
COMMIT;
COMMIT;
EXEC execImmediate (&#39;CALL ttRepStart&#39;);
COMMIT;
</pre>
<p>The name of the script is <code>ttCacheAdvisor_</code><span class="italic">task-name</span><code>_</code><span class="italic">timestamp</span><code>.sql</code> and it resides in the directory where the <code>ttCacheAdvisor</code> utility was invoked. This script can be run with the <code>ttIsql</code> utility to create objects in the TimesTen database used to implement the caching of the Oracle Database objects that were accessed by the application.</p>
<pre>% ttIsql -f ttCacheAdvisor_sampletask_20120531164101.sql 
 &#34;DSN=cacheadv;UID=cacheuser;OraclePWD=oracache&#34;
</pre>
<p>You can obtain database and system information about the target Oracle database (Workload Collection), repository Oracle database and TimesTen database (Client) by clicking the &#34;Click here for information about the configuration that was used to generate this report&#34; link from the home page.</p>
<div id="TTCAC494" class="figure">
<p class="titleinfigure"><a id="sthref744"></a>Figure 10-8 Configuration overview page</p>
<img width="844" height="611" src="img/careportconfig.jpg" alt="Description of Figure 10-8 follows"/><br/>
<a id="sthref745" href="img_text/careportconfig.htm">Description of &#34;Figure 10-8 Configuration overview page&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<div id="TTCAC495" class="figure">
<p class="titleinfigure"><a id="sthref746"></a>Figure 10-9 Repository and client configuration information</p>
<img width="832" height="443" src="img/careportconfig2.jpg" alt="Description of Figure 10-9 follows"/><br/>
<a id="sthref747" href="img_text/careportconfig2.htm">Description of &#34;Figure 10-9 Repository and client configuration information&#34;</a><br/>
<br/></div>
<!-- class="figure" --></div>
<!-- class="sect1" -->
<a id="BABIFEAB"></a>
<div id="TTCAC507" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Cleaning up the Oracle and TimesTen databases and host systems<a id="sthref748"></a></h2>
<p>Complete the following tasks to restore the Oracle Database and TimesTen systems to their original state after you have finished evaluating the application workload that was run on the target Oracle database:</p>
<ol>
<li>
<p><a href="#BABDFEDG">Clean up the target Oracle database and host system</a></p>
</li>
<li>
<p><a href="#CHDBHAED">Clean up the repository Oracle database and host system</a></p>
</li>
<li>
<p><a href="#CHDBHGGF">Clean up the TimesTen database and host system</a></p>
</li>
</ol>
<a id="BABDFEDG"></a>
<div id="TTCAC508" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Clean up the target Oracle database and host system</h3>
<p>Start SQL*Plus from an operating system shell on the TimesTen database system and connect to the target Oracle database as the <code>sys</code> user. Then, use SQL*Plus as follows to clean up the target Oracle database and its host system:</p>
<ol>
<li>
<p>Drop the <code>timesten</code> user, the <code>oratt</code> target Oracle Database user (if you created this user because it did not exist before configuring the target database), and the <code>cacheuser</code> cache administration user.</p>
<pre>% sqlplus sys@targetdb as sysdba
Enter password: <span class="italic">password</span>
SQL&gt; DROP USER timesten CASCADE;
SQL&gt; DROP USER oratt CASCADE;
SQL&gt; DROP USER cacheuser CASCADE;
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
Specifying <code>CASCADE</code> in a <code>DROP USER</code> statement drops all objects, such as tables owned by the user, before dropping the user itself.</div>
</li>
<li>
<p>Drop the <code>TT_CACHE_ADMIN_ROLE</code> role, the <code>TTCA_TARGET_ROLE</code> role, and the <code>TTCA_DIRECTORY</code> directory object.</p>
<pre>SQL&gt; <a id="sthref749"></a>DROP ROLE TT_CACHE_ADMIN_ROLE;
SQL&gt; DROP ROLE TTCA_TARGET_ROLE;
SQL&gt; <a id="sthref750"></a>DROP DIRECTORY TTCA_DIRECTORY;
SQL&gt; exit
</pre></li>
<li>
<p>Drop the <a id="sthref751"></a><a id="sthref752"></a><code>cachetblsp</code> default tablespace used by the <code>timesten</code> user and cache administration user, including the contents of the tablespace and its data file. Exit the SQL*Plus session.</p>
<pre>SQL&gt; DROP TABLESPACE cachetblsp INCLUDING CONTENTS AND DATAFILES;
SQL&gt; exit
</pre></li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
The above steps do not drop the schemas that were created for the workload by the Cache Advisor. You can keep the schemas for use by another application workload, if they use the same schemas, or if you want to re-execute the same workload after re-creating the user and tablespace. If not, you can either manually drop the schemas created or, if the target database is a test database, destroy the database.</div>
</div>
<!-- class="sect2" -->
<a id="CHDBHAED"></a>
<div id="TTCAC480" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Clean up the repository Oracle database and host system</h3>
<p>If the repository resides on a separate, devoted Oracle database, drop the repository database.</p>
<p>If the repository resides in the same Oracle database as the target, start SQL*Plus from an operating system shell on the TimesTen database system and connect to the repository Oracle database as the <code>sys</code> user. Use SQL*Plus as follows to clean up the repository Oracle database and its host system:</p>
<ol>
<li>
<p>Drop the <code>ttcacheadvisor</code> user that owns the objects in the repository database used to analyze the SQL workload run on the target Oracle database.</p>
<pre>% sqlplus sys@repositorydb as sysdba
Enter password: <span class="italic">password</span>
SQL&gt; DROP USER ttcacheadvisor CASCADE;
</pre></li>
<li>
<p>Drop the <code>TTCA_DIRECTORY</code> directory object.</p>
<pre>SQL&gt; DROP DIRECTORY TTCA_DIRECTORY;
</pre></li>
<li>
<p>Drop the <a id="sthref753"></a><a id="sthref754"></a><code>ttca_ts</code> tablespace used by the <code>ttCacheAdvisor</code> user, including the contents of the tablespace and its data file. Exit the SQL*Plus session.</p>
<pre>SQL&gt; DROP TABLESPACE ttca_ts INCLUDING CONTENTS AND DATAFILES;
SQL&gt; exit
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CHDBHGGF"></a>
<div id="TTCAC481" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Clean up the TimesTen database and host system</h3>
<p>Start the <code>ttIsql</code> utility and connect to the <code>cacheadv</code> DSN as the TimesTen instance administrator user. Perform the following to clean up the TimesTen database:</p>
<ol>
<li>
<p>Use <code>ttIsql</code> to grant the <code>DROP ANY TABLE</code> privilege to the cache manager user so that this user can drop the underlying cache tables when dropping the cache groups. Then, exit this <code>ttIsql</code> session.</p>
<pre>% ttIsql cacheadv
Command&gt; GRANT DROP ANY TABLE TO cacheuser;
Command&gt; exit
</pre></li>
<li>
<p>Start the <code>ttIsql</code> utility and connect to the <code>cacheadv</code> DSN as the cache manager user. The password of the TimesTen cache manager user <code>cacheuser</code> is <code>ttcache</code>. Use <code>ttIsql</code> to call the <code>ttRepStop</code> built-in procedure to stop the replication agent on the TimesTen database. Drop the <code>cg1_userspeccache</code> AWT cache group. Call the <code>ttCacheStop</code> built-in procedure to stop the cache agent on the TimesTen database. Exit this <code>ttIsql</code> session.</p>
<pre>% ttIsql &#34;DSN=cacheadv;UID=cacheuser;OraclePWD=oracache&#34;
Enter password for &#39;cacheuser&#39;: <span class="italic">password</span>
Command&gt; call ttRepStop;
Command&gt; DROP CACHE GROUP cg1_userspeccache;
Command&gt; call ttCacheStop;
Command&gt; exit
</pre></li>
<li>
<p>Use the <code>ttDestroy</code> utility to connect to the <code>cacheadv</code> DSN and destroy the TimesTen database.</p>
<pre>% ttDestroy cacheadv
</pre></li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5343">
<tr>
<td class="cellalignment5350">
<table class="cellalignment5348">
<tr>
<td class="cellalignment5347"><a href="cleanup.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5347"><a href="rac.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2012, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5352">
<table class="cellalignment5346">
<tr>
<td class="cellalignment5347"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5347"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5347"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5347"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5347"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5347"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>