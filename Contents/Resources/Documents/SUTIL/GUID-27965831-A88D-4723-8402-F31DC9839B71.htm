<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-105192"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Placing%20Conditions%20on%20Transforms"></a><title>Placing Conditions on Transforms</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="dcterms.created" content="2017-07-10T17:06:49Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Utilities"/>
<meta name="dcterms.identifier" content="E41528-09"/>
<meta name="dcterms.isVersionOf" content="SUTIL"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="GUID-68EB7622-137B-46CC-AE50-75972582092E.htm" title="Previous" type="text/html"/>
<link rel="Next" href="GUID-BB45CA8D-2621-419B-906C-1E811499786A.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41528-09.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-27965831-A88D-4723-8402-F31DC9839B71"></a> <span id="PAGE" style="display:none;">816/1019</span> <!-- End Header -->
<a id="SUTIL3621"></a><a id="SUTIL3622"></a><a id="SUTIL1627"></a>
<h1 id="SUTIL-GUID-27965831-A88D-4723-8402-F31DC9839B71" class="sect1">Placing Conditions on Transforms</h1>
<div>
<div class="section">
<p>You can use transform parameters to specify conditions on the transforms you add. To do this, you use the <code class="codeph">SET_TRANSFORM_PARAM</code> procedure. For example, if you have added the <code class="codeph">DDL</code> transform for a <code class="codeph">TABLE</code> object, then you can specify the <code class="codeph">SEGMENT_ATTRIBUTES</code> transform parameter to indicate that you do not want segment attributes (physical, storage, logging, and so on) to appear in the DDL. The default is that segment attributes do appear in the DDL.</p>
<p><a href="GUID-27965831-A88D-4723-8402-F31DC9839B71.htm#GUID-27965831-A88D-4723-8402-F31DC9839B71__i1014066">Example 21-4</a> shows use of the <code class="codeph">SET_TRANSFORM_PARAM</code> procedure.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-27965831-A88D-4723-8402-F31DC9839B71__i1014066">
<p class="titleinexample">Example 21-4 Placing Conditions on Transforms</p>
<ol>
<li>
<p>Create a function named <code class="codeph">get_table_md</code>, as follows:</p>
<pre dir="ltr">CREATE OR REPLACE FUNCTION get_table_md RETURN CLOB IS
 -- Define local variables.
 h    NUMBER;   -- handle returned by &#39;OPEN&#39;
 th   NUMBER;   -- handle returned by &#39;ADD_TRANSFORM&#39;
 doc  CLOB;
BEGIN

 -- Specify the object type. 
 h := DBMS_METADATA.OPEN(&#39;TABLE&#39;);

 -- Use filters to specify the particular object desired.
 DBMS_METADATA.SET_FILTER(h,&#39;SCHEMA&#39;,&#39;HR&#39;);
 DBMS_METADATA.SET_FILTER(h,&#39;NAME&#39;,&#39;TIMECARDS&#39;);

 -- Request that the metadata be transformed into creation DDL.
 th := dbms_metadata.add_transform(h,&#39;DDL&#39;);

 -- Specify that segment attributes are not to be returned.
 -- Note that this call uses the TRANSFORM handle, not the OPEN handle.
DBMS_METADATA.SET_TRANSFORM_PARAM(th,&#39;SEGMENT_ATTRIBUTES&#39;,false);

 -- Fetch the object.
 doc := DBMS_METADATA.FETCH_CLOB(h);

 -- Release resources.
 DBMS_METADATA.CLOSE(h);

 RETURN doc;
END;
/
</pre></li>
<li>
<p>Perform the following query:</p>
<pre dir="ltr">SQL&gt; SELECT get_table_md FROM dual;
</pre>
<p>The output looks similar to the following:</p>
<pre dir="ltr">  CREATE TABLE &#34;HR&#34;.&#34;TIMECARDS&#34;
   (    &#34;EMPLOYEE_ID&#34; NUMBER(6,0),
        &#34;WEEK&#34; NUMBER(2,0),
        &#34;JOB_ID&#34; VARCHAR2(10),
        &#34;HOURS_WORKED&#34; NUMBER(4,2),
         FOREIGN KEY (&#34;EMPLOYEE_ID&#34;)
          REFERENCES &#34;HR&#34;.&#34;EMPLOYEES&#34; (&#34;EMPLOYEE_ID&#34;) ENABLE
   )
</pre></li>
</ol>
<p>The examples shown up to this point have used a single transform, the <code class="codeph">DDL</code> transform. The <code class="codeph">DBMS_METADATA</code> API also enables you to specify multiple transforms, with the output of the first being the input to the next and so on.</p>
<p>Oracle supplies a transform called <code class="codeph">MODIFY</code> that modifies an XML document. You can do things like change schema names or tablespace names. To do this, you use remap parameters and the <code class="codeph">SET_REMAP_PARAM</code> procedure.</p>
<p><a href="GUID-27965831-A88D-4723-8402-F31DC9839B71.htm#GUID-27965831-A88D-4723-8402-F31DC9839B71__i1014070">Example 21-5</a> shows a sample use of the <code class="codeph">SET_REMAP_PARAM</code> procedure. It first adds the <code class="codeph">MODIFY</code> transform and specifies remap parameters to change the schema name from <code class="codeph">hr</code> to <code class="codeph">scott</code>. It then adds the <code class="codeph">DDL</code> transform. The output of the <code class="codeph">MODIFY</code> transform is an XML document that becomes the input to the <code class="codeph">DDL</code> transform. The end result is the creation DDL for the <code class="codeph">timecards</code> table with all instances of schema <code class="codeph">hr</code> changed to <code class="codeph">scott</code>.</p>
</div>
<!-- class="example" -->
<div class="example" id="GUID-27965831-A88D-4723-8402-F31DC9839B71__i1014070">
<p class="titleinexample">Example 21-5 Modifying an XML Document</p>
<ol>
<li>
<p>Create a function named remap_schema:</p>
<pre dir="ltr">CREATE OR REPLACE FUNCTION remap_schema RETURN CLOB IS
-- Define local variables.
h NUMBER; --handle returned by OPEN
th NUMBER; -- handle returned by ADD_TRANSFORM
doc CLOB;
BEGIN

-- Specify the object type.
h := DBMS_METADATA.OPEN(&#39;TABLE&#39;);

-- Use filters to specify the particular object desired.
DBMS_METADATA.SET_FILTER(h,&#39;SCHEMA&#39;,&#39;HR&#39;);
DBMS_METADATA.SET_FILTER(h,&#39;NAME&#39;,&#39;TIMECARDS&#39;);

-- Request that the schema name be modified.
th := DBMS_METADATA.ADD_TRANSFORM(h,&#39;MODIFY&#39;);
DBMS_METADATA.SET_REMAP_PARAM(th,&#39;REMAP_SCHEMA&#39;,&#39;HR&#39;,&#39;SCOTT&#39;);

-- Request that the metadata be transformed into creation DDL.
th := DBMS_METADATA.ADD_TRANSFORM(h,&#39;DDL&#39;);

-- Specify that segment attributes are not to be returned.
DBMS_METADATA.SET_TRANSFORM_PARAM(th,&#39;SEGMENT_ATTRIBUTES&#39;,false);

-- Fetch the object.
doc := DBMS_METADATA.FETCH_CLOB(h);

-- Release resources.
DBMS_METADATA.CLOSE(h);
RETURN doc;
END;
/ 
</pre></li>
<li>
<p>Perform the following query:</p>
<pre dir="ltr">SELECT remap_schema FROM dual;
</pre>
<p>The output looks similar to the following:</p>
<pre dir="ltr">  CREATE TABLE &#34;SCOTT&#34;.&#34;TIMECARDS&#34;
   (    &#34;EMPLOYEE_ID&#34; NUMBER(6,0),
        &#34;WEEK&#34; NUMBER(2,0),
        &#34;JOB_ID&#34; VARCHAR2(10),
        &#34;HOURS_WORKED&#34; NUMBER(4,2),
         FOREIGN KEY (&#34;EMPLOYEE_ID&#34;)
          REFERENCES &#34;SCOTT&#34;.&#34;EMPLOYEES&#34; (&#34;EMPLOYEE_ID&#34;) ENABLE
   )
</pre>
<p>If you are familiar with XSLT, then you can add your own user-written transforms to process the XML.</p>
</li>
</ol>
</div>
<!-- class="example" --></div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2015">
<tr>
<td class="cellalignment2022">
<table class="cellalignment2020">
<tr>
<td class="cellalignment2019"><a href="GUID-68EB7622-137B-46CC-AE50-75972582092E.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2019"><a href="GUID-BB45CA8D-2621-419B-906C-1E811499786A.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2024">
<table class="cellalignment2018">
<tr>
<td class="cellalignment2019"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2019"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2019"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2019"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2019"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2019"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>