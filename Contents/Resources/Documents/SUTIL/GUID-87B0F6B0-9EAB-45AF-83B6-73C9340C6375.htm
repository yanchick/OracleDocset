<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-105560"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Querying%20V%24LOGMNR_CONTENTS%20Based%20on%20Column%20Values"></a><title>Querying V$LOGMNR_CONTENTS Based on Column Values</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="dcterms.created" content="2017-07-10T17:06:49Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Utilities"/>
<meta name="dcterms.identifier" content="E41528-09"/>
<meta name="dcterms.isVersionOf" content="SUTIL"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="GUID-CD389496-1D82-4E39-881F-C0C18355C573.htm" title="Previous" type="text/html"/>
<link rel="Next" href="GUID-4444BC3A-B32D-424F-89B5-E903C903FD11.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41528-09.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-87B0F6B0-9EAB-45AF-83B6-73C9340C6375"></a> <span id="PAGE" style="display:none;">756/1019</span> <!-- End Header -->
<a id="SUTIL1567"></a>
<h1 id="SUTIL-GUID-87B0F6B0-9EAB-45AF-83B6-73C9340C6375" class="sect1">Querying V$LOGMNR_CONTENTS Based on Column Values</h1>
<div>
<p><a id="d153221e29" class="indexterm-anchor"></a>LogMiner lets you make queries based on column values. For instance, you can perform a query to show all updates to the <code class="codeph">hr.employees</code> table that increase <code class="codeph">salary</code> more than a certain amount. Data such as this can be used to analyze system behavior and to perform auditing tasks.</p>
<p>LogMiner data extraction from redo log files is performed using two mine functions: <a id="d153221e42" class="indexterm-anchor"></a><code class="codeph">DBMS_LOGMNR.MINE_VALUE</code> and <a id="d153221e47" class="indexterm-anchor"></a><code class="codeph">DBMS_LOGMNR.COLUMN_PRESENT</code>. Support for these mine functions is provided by the <code class="codeph">REDO_VALUE</code> and <code class="codeph">UNDO_VALUE</code> columns in the <code class="codeph">V$LOGMNR_CONTENTS</code> view.</p>
<p>The following is an example of how you could use the <code class="codeph">MINE_VALUE</code> function to select all updates to <code class="codeph">hr.employees</code> that increased the <code class="codeph">salary</code> column to more than twice its original value:</p>
<pre dir="ltr">SELECT SQL_REDO FROM V$LOGMNR_CONTENTS
   WHERE
   SEG_NAME = &#39;EMPLOYEES&#39; AND
   SEG_OWNER = &#39;HR&#39; AND
   OPERATION = &#39;UPDATE&#39; AND
   DBMS_LOGMNR.MINE_VALUE(REDO_VALUE, &#39;HR.EMPLOYEES.SALARY&#39;) &gt;
   2*DBMS_LOGMNR.MINE_VALUE(UNDO_VALUE, &#39;HR.EMPLOYEES.SALARY&#39;);
</pre>
<p>As shown in this example, the <code class="codeph">MINE_VALUE</code> function takes two arguments:</p>
<ul style="list-style-type: disc;">
<li>
<p>The first one specifies whether to mine the redo (<code class="codeph">REDO_VALUE</code>) or undo (<code class="codeph">UNDO_VALUE</code>) portion of the data. The redo portion of the data is the data that is in the column after an insert, update, or delete operation; the undo portion of the data is the data that was in the column before an insert, update, or delete operation. It may help to think of the <code class="codeph">REDO_VALUE</code> as the new value and the <code class="codeph">UNDO_VALUE</code> as the old value.</p>
</li>
<li>
<p>The second argument is a string that specifies the fully qualified name of the column to be mined (in this case, <code class="codeph">hr.employees.salary</code>). The <code class="codeph">MINE_VALUE</code> function always returns a string that can be converted back to the original data type.</p>
</li>
</ul>
</div>
<a id="SUTIL1568"></a>
<div class="props_rev_3"><a id="GUID-A89673AD-EC53-4BA0-B298-D62291C5728B"></a>
<h2 id="SUTIL-GUID-A89673AD-EC53-4BA0-B298-D62291C5728B" class="sect2">The Meaning of NULL Values Returned by the MINE_VALUE Function</h2>
<div>
<p><a id="d153221e136" class="indexterm-anchor"></a>If the <code class="codeph">MINE_VALUE</code> function returns a <code class="codeph">NULL</code> value, then it can mean either:</p>
<ul style="list-style-type: disc;">
<li>
<p>The specified column is not present in the redo or undo portion of the data.</p>
</li>
<li>
<p>The specified column is present and has a null value.</p>
</li>
</ul>
<p>To distinguish between these two cases, use the <code class="codeph">DBMS_LOGMNR</code>.<code class="codeph">COLUMN_PRESENT</code> function which returns a <code class="codeph">1</code> if the column is present in the redo or undo portion of the data. Otherwise, it returns a <code class="codeph">0</code>. For example, suppose you wanted to find out the increment by which the values in the <code class="codeph">salary</code> column were modified and the corresponding transaction identifier. You could issue the following SQL query:</p>
<pre dir="ltr">SELECT 
  (XIDUSN || &#39;.&#39; || XIDSLT || &#39;.&#39; || XIDSQN) AS XID,
  (DBMS_LOGMNR.MINE_VALUE(REDO_VALUE, &#39;HR.EMPLOYEES.SALARY&#39;) -
   DBMS_LOGMNR.MINE_VALUE(UNDO_VALUE, &#39;HR.EMPLOYEES.SALARY&#39;)) AS INCR_SAL
   FROM V$LOGMNR_CONTENTS
   WHERE
   OPERATION = &#39;UPDATE&#39; AND
   DBMS_LOGMNR.COLUMN_PRESENT(REDO_VALUE, &#39;HR.EMPLOYEES.SALARY&#39;) = 1 AND
   DBMS_LOGMNR.COLUMN_PRESENT(UNDO_VALUE, &#39;HR.EMPLOYEES.SALARY&#39;) = 1;
</pre></div>
</div>
<a id="SUTIL1569"></a>
<div class="props_rev_3"><a id="GUID-66897AA4-7B9D-4C2C-9FC3-64DF9A292290"></a>
<h2 id="SUTIL-GUID-66897AA4-7B9D-4C2C-9FC3-64DF9A292290" class="sect2">Usage Rules for the MINE_VALUE and COLUMN_PRESENT Functions</h2>
<div>
<p>The following usage rules apply to the <code class="codeph">MINE_VALUE</code> and <code class="codeph">COLUMN_PRESENT</code> functions:</p>
<ul style="list-style-type: disc;">
<li>
<p>They can only be used within a LogMiner session.</p>
</li>
<li>
<p>They must be started in the context of a select operation from the <code class="codeph">V$LOGMNR_CONTENTS</code> view.</p>
</li>
<li>
<p>They do not support <code class="codeph">LONG</code>, <code class="codeph">LONG RAW,</code> <code class="codeph">CLOB,</code> <code class="codeph">BLOB,</code> <code class="codeph">NCLOB</code>, <code class="codeph">ADT</code>, or <code class="codeph">COLLECTION</code> data types.</p>
</li>
</ul>
</div>
</div>
<a id="SUTIL4342"></a>
<div class="props_rev_3"><a id="GUID-7C1FB699-52D6-4B93-A676-C9426D32FE3C"></a>
<h2 id="SUTIL-GUID-7C1FB699-52D6-4B93-A676-C9426D32FE3C" class="sect2">Restrictions When Using the MINE_VALUE Function To Get an NCHAR Value</h2>
<div>
<div class="section">
<p>If the <code class="codeph">DBMS_LOGMNR.MINE_VALUE</code> function is used to get an <code class="codeph">NCHAR</code> value that includes characters not found in the database character set, then those characters are returned as the replacement character (for example, an inverted question mark) of the database character set.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2015">
<tr>
<td class="cellalignment2022">
<table class="cellalignment2020">
<tr>
<td class="cellalignment2019"><a href="GUID-CD389496-1D82-4E39-881F-C0C18355C573.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2019"><a href="GUID-4444BC3A-B32D-424F-89B5-E903C903FD11.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2024">
<table class="cellalignment2018">
<tr>
<td class="cellalignment2019"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2019"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2019"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2019"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2019"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2019"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>