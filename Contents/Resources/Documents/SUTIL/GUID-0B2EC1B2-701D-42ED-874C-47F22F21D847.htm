<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-105095"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Unloading%20and%20Loading%20Data%20with%20the%20ORACLE_DATAPUMP%20Access%20Driver"></a><title>Unloading and Loading Data with the ORACLE_DATAPUMP Access Driver</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="dcterms.created" content="2017-07-10T17:06:49Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Utilities"/>
<meta name="dcterms.identifier" content="E41528-09"/>
<meta name="dcterms.isVersionOf" content="SUTIL"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="GUID-039387FC-3011-402F-B38A-B1D392738AD2.htm" title="Previous" type="text/html"/>
<link rel="Next" href="GUID-3BEF455B-7CEB-4E5D-800A-7000A501A652.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41528-09.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-0B2EC1B2-701D-42ED-874C-47F22F21D847"></a> <span id="PAGE" style="display:none;">624/1019</span> <!-- End Header -->
<a id="SUTIL1457"></a>
<h1 id="SUTIL-GUID-0B2EC1B2-701D-42ED-874C-47F22F21D847" class="sect1">Unloading and Loading Data with the ORACLE_DATAPUMP Access Driver</h1>
<div>
<div class="section">
<p>As part of creating an external table with a SQL <code class="codeph">CREATE TABLE AS SELECT</code> statement, the <code class="codeph">ORACLE_DATAPUMP</code> access driver can write data to a dump file. The data in the file is written in a binary format that can only be read by the <code class="codeph">ORACLE_DATAPUMP</code> access driver. Once the dump file is created, it cannot be modified (that is, no data manipulation language (DML) operations can be performed on it). However, the file can be read any number of times and used as the dump file for another external table in the same database or in a different database.</p>
<p>The following steps use the sample schema, <code class="codeph">oe</code>, to show an extended example of how you can use the <code class="codeph">ORACLE_DATAPUMP</code> access driver to unload and load data. (The example assumes that the directory object <code class="codeph">def_dir1</code> already exists, and that user <code class="codeph">oe</code> has read and write access to it.)</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>An external table will populate a file with data only as part of creating the external table with the <code class="codeph">AS</code> <code class="codeph">SELECT</code> clause. The following example creates an external table named <code class="codeph">inventories_xt</code> and populates the dump file for the external table with the data from table <code class="codeph">inventories</code> in the <code class="codeph">oe</code> schema.</span>
<div>
<pre dir="ltr">SQL&gt; CREATE TABLE inventories_xt
  2  ORGANIZATION EXTERNAL
  3  (
  4    TYPE ORACLE_DATAPUMP
  5    DEFAULT DIRECTORY def_dir1
  6    LOCATION (&#39;inv_xt.dmp&#39;)
  7  )
  8  AS SELECT * FROM inventories;

Table created.
</pre></div>
</li>
<li class="stepexpand"><span>Describe both <code class="codeph">inventories</code> and the new external table, as follows. They should both match.</span>
<div>
<pre dir="ltr">SQL&gt; DESCRIBE inventories
 Name                                      Null?    Type
 ---------------------------------------- --------- ----------------
 PRODUCT_ID                                NOT NULL NUMBER(6)
 WAREHOUSE_ID                              NOT NULL NUMBER(3)
 QUANTITY_ON_HAND                          NOT NULL NUMBER(8)

SQL&gt; DESCRIBE inventories_xt
 Name                                      Null?    Type
 ----------------------------------------- -------- -----------------
 PRODUCT_ID                                NOT NULL NUMBER(6)
 WAREHOUSE_ID                              NOT NULL NUMBER(3)
 QUANTITY_ON_HAND                          NOT NULL NUMBER(8)
</pre></div>
</li>
<li class="stepexpand"><span>Now that the external table is created, it can be queried just like any other table. For example, select the count of records in the external table, as follows:</span>
<div>
<pre dir="ltr">SQL&gt; SELECT COUNT(*) FROM inventories_xt;

  COUNT(*)
----------
      1112
</pre></div>
</li>
<li class="stepexpand"><span>Compare the data in the external table against the data in <code class="codeph">inventories</code>. There should be no differences.</span>
<div>
<pre dir="ltr">SQL&gt; SELECT * FROM inventories MINUS SELECT * FROM inventories_xt;

no rows selected
</pre></div>
</li>
<li class="stepexpand"><span>After an external table has been created and the dump file populated by the <code class="codeph">CREATE</code> <code class="codeph">TABLE</code> <code class="codeph">AS</code> <code class="codeph">SELECT</code> statement, no rows may be added, updated, or deleted from the external table. Any attempt to modify the data in the external table will fail with an error.</span>
<div>
<p>The following example shows an attempt to use data manipulation language (DML) on an existing external table. This will return an error, as shown.</p>
<pre dir="ltr">SQL&gt; DELETE FROM inventories_xt WHERE warehouse_id = 5;
DELETE FROM inventories_xt WHERE warehouse_id = 5
            *
ERROR at line 1:
ORA-30657: operation not supported on external organized table
</pre></div>
</li>
<li class="stepexpand"><span>The dump file created for the external table can now be moved and used as the dump file for another external table in the same database or different database. Note that when you create an external table that uses an existing file, there is no <code class="codeph">AS</code> <code class="codeph">SELECT</code> clause for the <code class="codeph">CREATE</code> <code class="codeph">TABLE</code> statement.</span>
<div>
<pre dir="ltr">SQL&gt; CREATE TABLE inventories_xt2
  2  (
  3    product_id          NUMBER(6),
  4    warehouse_id        NUMBER(3),
  5    quantity_on_hand    NUMBER(8)
  6  )
  7  ORGANIZATION EXTERNAL
  8  (
  9    TYPE ORACLE_DATAPUMP
 10    DEFAULT DIRECTORY def_dir1
 11    LOCATION (&#39;inv_xt.dmp&#39;)
 12  );

Table created.
</pre></div>
</li>
<li class="stepexpand"><span>Compare the data for the new external table against the data in the <code class="codeph">inventories</code> table. The <code class="codeph">product_id</code> field will be converted to a compatible data type before the comparison is done. There should be no differences.</span>
<div>
<pre dir="ltr">SQL&gt; SELECT * FROM inventories MINUS SELECT * FROM inventories_xt2;

no rows selected
</pre></div>
</li>
<li class="stepexpand"><span>Create an external table with three dump files and with a degree of parallelism of three.</span>
<div>
<pre dir="ltr">SQL&gt; CREATE TABLE inventories_xt3
  2  ORGANIZATION EXTERNAL
  3  (
  4    TYPE ORACLE_DATAPUMP
  5    DEFAULT DIRECTORY def_dir1
  6    LOCATION (&#39;inv_xt1.dmp&#39;, &#39;inv_xt2.dmp&#39;, &#39;inv_xt3.dmp&#39;)
  7  )
  8  PARALLEL 3
  9  AS SELECT * FROM inventories;

Table created.
</pre></div>
</li>
<li class="stepexpand"><span>Compare the data unload against <code class="codeph">inventories</code>. There should be no differences.</span>
<div>
<pre dir="ltr">SQL&gt; SELECT * FROM inventories MINUS SELECT * FROM inventories_xt3;

no rows selected
</pre></div>
</li>
<li class="stepexpand"><span>Create an external table containing some rows from table <code class="codeph">inventories</code>.</span>
<div>
<pre dir="ltr">SQL&gt; CREATE TABLE inv_part_xt
  2  ORGANIZATION EXTERNAL
  3  (
  4  TYPE ORACLE_DATAPUMP
  5  DEFAULT DIRECTORY def_dir1
  6  LOCATION (&#39;inv_p1_xt.dmp&#39;)
  7  )
  8  AS SELECT * FROM inventories WHERE warehouse_id &lt; 5;
 
Table created.
</pre></div>
</li>
<li class="stepexpand"><span>Create another external table containing the rest of the rows from <code class="codeph">inventories</code>.</span>
<div>
<pre dir="ltr">SQL&gt; drop table inv_part_xt;
 
Table dropped.
 
SQL&gt; 
SQL&gt; CREATE TABLE inv_part_xt
  2  ORGANIZATION EXTERNAL
  3  (
  4  TYPE ORACLE_DATAPUMP
  5  DEFAULT DIRECTORY def_dir1
  6  LOCATION (&#39;inv_p2_xt.dmp&#39;)
  7  )
  8  AS SELECT * FROM inventories WHERE warehouse_id &gt;= 5;
 
Table created.
</pre></div>
</li>
<li class="stepexpand"><span>Create an external table that uses the two dump files created in Steps 10 and 11.</span>
<div>
<pre dir="ltr">SQL&gt; CREATE TABLE inv_part_all_xt
  2  (
  3  product_id NUMBER(6),
  4  warehouse_id NUMBER(3),
  5  quantity_on_hand NUMBER(8)
  6  )
  7  ORGANIZATION EXTERNAL
  8  (
  9  TYPE ORACLE_DATAPUMP
 10  DEFAULT DIRECTORY def_dir1
 11  LOCATION (&#39;inv_p1_xt.dmp&#39;,&#39;inv_p2_xt.dmp&#39;)
 12  );
 
Table created.
</pre></div>
</li>
<li class="stepexpand"><span>Compare the new external table to the <code class="codeph">inventories</code> table. There should be no differences. This is because the two dump files used to create the external table have the same metadata (for example, the same table name <code class="codeph">inv_part_xt</code> and the same column information).</span>
<div>
<pre dir="ltr">SQL&gt; SELECT * FROM inventories MINUS SELECT * FROM inv_part_all_xt;

no rows selected
</pre></div>
</li>
</ol>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2015">
<tr>
<td class="cellalignment2022">
<table class="cellalignment2020">
<tr>
<td class="cellalignment2019"><a href="GUID-039387FC-3011-402F-B38A-B1D392738AD2.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2019"><a href="GUID-3BEF455B-7CEB-4E5D-800A-7000A501A652.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2024">
<table class="cellalignment2018">
<tr>
<td class="cellalignment2019"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2019"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2019"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2019"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2019"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2019"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>