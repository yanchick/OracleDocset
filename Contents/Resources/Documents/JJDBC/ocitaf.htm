<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-71002"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Transparent%20Application%20Failover"></a><title>Transparent Application Failover</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1023"/>
<meta name="description" content="This book describes how to use Oracle JDBC drivers to develop powerful Java database applications."/>
<meta name="dcterms.created" content="2014-06-30T1:22:37Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database JDBC Developer&#39;s Guide"/>
<meta name="dcterms.identifier" content="E49300-05"/>
<meta name="dcterms.isVersionOf" content="JJDBC"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="appcontnew.htm" title="Previous" type="text/html"/>
<link rel="Next" href="scan.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E49300-05.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">41/55</span> <!-- End Header -->
<div id="JJDBC27000" class="chapter"><a id="BABGIDEE"></a>
<h1 class="chapter"><span class="secnum">28</span> Transparent Application Failover</h1>
<p>This chapter contains the following sections:</p>
<ul>
<li>
<p><a href="#BABCFEBH">Overview of Transparent Application Failover</a></p>
</li>
<li>
<p><a href="#BABHCECE">Failover Type Events</a></p>
</li>
<li>
<p><a href="#BABGACJC">TAF Callbacks</a></p>
</li>
<li>
<p><a href="#BABDCCEE">Java TAF Callback Interface</a></p>
</li>
<li>
<p><a href="#CIHJGCFE">Comparison of TAF and Fast Connection Failover</a></p>
</li>
</ul>
<a id="BABCFEBH"></a>
<div id="JJDBC28836" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Overview of Transparent Application Failover</h2>
<p><a id="sthref894"></a>Transparent Application Failover (<a id="sthref895"></a>TAF) is a feature of the Java Database Connectivity (JDBC) Oracle Call Interface (OCI) driver. It enables the application to automatically reconnect to a database, if the database instance to which the connection is made fails. In this case, the active transactions roll back.</p>
<p>When an instance to which a connection is established fails or is shut down, the connection on the client-side becomes stale and would throw exceptions to the caller trying to use it. TAF enables the application to transparently reconnect to a preconfigured secondary instance, creating a fresh connection, but identical to the connection that was established on the first original instance. That is, the connection properties are the same as that of the earlier connection. This is true regardless of how the connection was lost.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<ul>
<li>
<p>TAF is always active and does not have to be set.</p>
</li>
<li>
<p>TAF is not supported with LOB and XML types.</p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="BABHCECE"></a>
<div id="JJDBC28837" class="sect1">
<h2 class="sect1">Failover Type Events</h2>
<p>The following are possible failover events in the <code>OracleOCIFailover</code> interface:</p>
<ul>
<li>
<p><code>FO_SESSION</code></p>
<p>Is equivalent to <code>FAILOVER_MODE=SESSION</code> in the <code>tnsnames.ora</code> file <code>CONNECT_DATA</code> flags. This means that only the user session is authenticated again on the server side, while open cursors in the OCI application need to be reprocessed.</p>
</li>
<li>
<p><code>FO_SELECT</code></p>
<p>Is equivalent to <code>FAILOVER_MODE=SELECT</code> in <code>tnsnames.ora</code> file <code>CONNECT_DATA</code> flags. This means that not only the user session is re-authenticated on the server side, but open cursors in the OCI can continue fetching. This implies that the client-side logic maintains fetch-state of each open cursor.</p>
</li>
<li>
<p><code>FO_NONE</code></p>
<p>Is equivalent to <code>FAILOVER_MODE=NONE</code> in the <code>tnsnames.ora</code> file <code>CONNECT_DATA</code> flags. This is the default, in which no failover functionality is used. This can also be explicitly specified to prevent failover from happening. Additionally, <code>FO_TYPE_UNKNOWN</code> implies that a bad failover type was returned from the OCI driver.</p>
</li>
<li>
<p><code>FO_BEGIN</code></p>
<p>Indicates that failover has detected a lost connection and failover is starting.</p>
</li>
<li>
<p><code>FO_END</code></p>
<p>Indicates successful completion of failover.</p>
</li>
<li>
<p><code>FO_ABORT</code></p>
<p>Indicates that failover was unsuccessful and there is no option of retrying.</p>
</li>
<li>
<p><code>FO_REAUTH</code></p>
<p>Indicates that a user handle has been re-authenticated.</p>
</li>
<li>
<p><code>FO_ERROR</code></p>
<p>Indicates that failover was temporarily unsuccessful, but it gives the application the opportunity to handle the error and retry failover. The usual method of error handling is to issue the <code>sleep</code> method and retry by returning the value <code>FO_RETRY</code>.</p>
</li>
<li>
<p><code>FO_RETRY</code></p>
<p>Indicates that the application should retry failover.</p>
</li>
<li>
<p><code>FO_EVENT_UNKNOWN</code></p>
<p>Indicates a bad failover event.</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="BABGACJC"></a>
<div id="JJDBC28838" class="sect1">
<h2 class="sect1">TAF Callbacks</h2>
<p>TAF callbacks are used in the event of the failure of one database connection, and failover to another database connection. TAF callbacks are callbacks that are registered in case of failover. The callback is called during the failover to notify the JDBC application of events generated. The application also has some control of failover.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The callback setting is optional.</div>
</div>
<!-- class="sect1" -->
<a id="BABDCCEE"></a>
<div id="JJDBC28839" class="sect1">
<h2 class="sect1">Java TAF Callback Interface</h2>
<p>The <code>OracleOCIFailover</code> interface includes the <code>callbackFn</code> method, supporting the following types and events:</p>
<pre>public interface OracleOCIFailover{

// Possible Failover Types
public static final int FO_SESSION = 1;
public static final int FO_SELECT  = 2;
public static final int FO_NONE  = 3;
public static final int;

// Possible Failover events registered with callback
public static final int FO_BEGIN   = 1;
public static final int FO_END     = 2;
public static final int FO_ABORT   = 3;
public static final int FO_REAUTH  = 4;
public static final int FO_ERROR  = 5;
public static final int FO_RETRY  = 6;
public static final int FO_EVENT_UNKNOWN = 7;

public int callbackFn (Connection conn,
                       Object ctxt, // ANy thing the user wants to save
                       int type, // One of the possible Failover Types
                       int event ); // One of the possible Failover Events
</pre>
<p class="subhead2"><a id="JJDBC28840"></a>Handling the FO_ERROR Event</p>
<p>In case of an error while failing over to a new connection, the JDBC application is able to retry failover. Typically, the application sleeps for a while and then it retries, either indefinitely or for a limited amount of time, by having the callback return <code>FO_RETRY</code>.</p>
<p class="subhead2"><a id="JJDBC28841"></a>Handling the FO_ABORT Event</p>
<p>Callback registered should return the <code>FO_ABORT</code> event if the <code>FO_ERROR</code> event is passed to it.</p>
</div>
<!-- class="sect1" -->
<a id="CIHJGCFE"></a>
<div id="JJDBC28835" class="sect1">
<h2 class="sect1">Comparison of TAF and Fast Connection Failover</h2>
<p>Transparent Application Failover (TAF) differs from Fast Connection Failover in the following ways:</p>
<ul>
<li>
<p>Application-level connection retries</p>
<p>TAF supports connection retries only at the OCI/Net layer. Fast Connection Failover supports application-level connection retries. This gives the application control of responding to connection failovers. The application can choose whether to retry the connection or to rethrow the exception.</p>
</li>
<li>
<p>Integration with the Universal Connection Pool</p>
<p>TAF works at the network level on a per-connection basis, which means that the connection cache cannot be notified of failures. Fast Connection Failover is well-integrated with the Universal Connection Pool, which enables the Connection Cache Manager to manage the cache for high availability. For example, failed connections are automatically invalidated in the cache.</p>
</li>
<li>
<p>Event-based</p>
<p>Fast Connection Failover is based on the Oracle RAC event mechanism. This means that Fast Connection Failover is efficient and detects failures quickly for both active and inactive connections.</p>
</li>
<li>
<p>Load-balancing support</p>
<p>Fast Connection Failover supports <code>UP</code> event load balancing of connections and run-time work request distribution across active Oracle RAC instances.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink JJUCP08100" href="../JJUCP/rac.htm#JJUCP08100"><span class="italic">Oracle Universal Connection Pool for JDBC Developer&#39;s Guide</span></a></div>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle recommends <span class="italic">not</span> to use TAF and Fast Connection Failover in the same application.</div>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2237">
<tr>
<td class="cellalignment2246">
<table class="cellalignment2242">
<tr>
<td class="cellalignment2241"><a href="appcontnew.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2241"><a href="scan.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2249">
<table class="cellalignment2240">
<tr>
<td class="cellalignment2241"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2241"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2241"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2241"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2241"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2241"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>