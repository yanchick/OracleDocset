<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-71001"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/OCI%20Connection%20Pooling"></a><title>OCI Connection Pooling</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1023"/>
<meta name="description" content="This book describes how to use Oracle JDBC drivers to develop powerful Java database applications."/>
<meta name="dcterms.created" content="2014-06-30T1:22:37Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database JDBC Developer&#39;s Guide"/>
<meta name="dcterms.identifier" content="E49300-05"/>
<meta name="dcterms.isVersionOf" content="JJDBC"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="oraperf.htm" title="Previous" type="text/html"/>
<link rel="Next" href="drcp.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E49300-05.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">34/55</span> <!-- End Header -->
<div id="JJDBC28789" class="chapter"><a id="CIHFFCEC"></a>
<h1 class="chapter"><span class="secnum">22</span> OCI Connection Pooling</h1>
<p>The Java Database Connectivity (JDBC) Oracle Call Interface (OCI) driver connection pooling functionality is part of the JDBC client. This functionality is provided by the <code><a id="sthref824"></a>OracleOCIConnectionPool</code> class.</p>
<p>A JDBC application can have multiple pools at the same time. Multiple pools can correspond to multiple application servers or pools to different data sources. The connection pooling provided by the JDBC OCI driver enables applications to have multiple logical connections, all using a small set of physical connections. Each call on a logical connection gets routed on to the physical connection that is available at the time of call.</p>
<p>This chapter contains the following sections:</p>
<ul>
<li>
<p><a href="#CIHHBDGJ">OCI Driver Connection Pooling: Background</a></p>
</li>
<li>
<p><a href="#CIHCAGED">OCI Driver Connection Pooling and Shared Servers Compared</a></p>
</li>
<li>
<p><a href="#CIHHACGJ">Defining an OCI Connection Pool</a></p>
</li>
<li>
<p><a href="#CIHGJJHC">Connecting to an OCI Connection Pool</a></p>
</li>
<li>
<p><a href="#CIHHCGGH">Sample Code for OCI Connection Pooling</a></p>
</li>
<li>
<p><a href="#CIHDABJC">Statement Handling and Caching</a></p>
</li>
<li>
<p><a href="#CIHGAIII">JNDI and the OCI Connection Pool</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
Use OCI connection pooling if you need session multiplexing. Otherwise, Oracle recommends using Universal Connection Pool.</div>
<a id="CIHHBDGJ"></a>
<div id="JJDBC28790" class="sect1">
<h2 class="sect1">OCI Driver Connection Pooling: Background</h2>
<p>The Oracle JDBC OCI driver provides several transaction monitor capabilities, such as the fine-grained management of Oracle sessions and connections. It is possible for a high-end application server or transaction monitor to multiplex several sessions over fewer physical connections on a call-level basis, thereby achieving a high degree of scalability by pooling of connections and back-end Oracle server processes.</p>
<p>The connection pooling provided by the <code>OracleOCIConnectionPool</code> interface simplifies the session/connection separation interface hiding the management of the physical connection pool. The Oracle sessions are the <code>OracleOCIConnection</code> objects obtained from <code>OracleOCIConnectionPool</code>. The connection pool itself is usually configured with a much smaller shared pool of physical connections, translating to a back-end server pool containing an identical number of dedicated server processes. Note that many more Oracle sessions can be multiplexed over this pool of fewer shared connections and back-end Oracle processes.</p>
</div>
<!-- class="sect1" -->
<a id="CIHCAGED"></a>
<div id="JJDBC28791" class="sect1">
<h2 class="sect1">OCI Driver Connection Pooling and Shared Servers Compared</h2>
<p>In some ways, what OCI driver connection pooling offers on the middle tier is similar to what shared server processes offer on the back end. OCI driver connection pooling makes a dedicated server instance behaves as a shared instance by managing the session multiplexing logic on the middle tier. Therefore, the pooling of dedicated server processes and incoming connections into the dedicated server processes is controlled by the OCI connection pool on the middle tier.</p>
<p>The main difference between OCI connection pooling and shared servers is that in the case of shared servers, the connection from the client is typically to a dispatcher in the database instance. The dispatcher is responsible for directing the client request to an appropriate shared server. On the other hand, the physical connection from the OCI connection pool is established directly from the middle tier to the Oracle dedicated server process in the back-end server pool.</p>
<p>Note that OCI connection pool is mainly beneficial only if the middle tier is multithreaded. Each thread could maintain a session to the database. The actual connections to the database are maintained by <code>OracleOCIConnectionPool</code>, and these connections, including the pool of dedicated database server processes, are shared among all the threads in the middle tier.</p>
</div>
<!-- class="sect1" -->
<a id="CIHHACGJ"></a>
<div id="JJDBC28792" class="sect1">
<h2 class="sect1">Defining an OCI Connection Pool</h2>
<p>An OCI connection pool is created at the beginning of the application. Creating connections from a pool is quite similar to creating connections using the <code><a id="sthref825"></a>OracleDataSource</code> class.</p>
<p>The <code><a id="sthref826"></a>oracle.jdbc.pool.OracleOCIConnectionPool</code> class, which extends the <code><a id="sthref827"></a>OracleDataSource</code> class, is used to create OCI connection pools. From an <code>OracleOCIConnectionPool</code> instance, you can obtain logical connection objects. These connection objects are of the <code>OracleOCIConnection</code> class type. This class implements the <code><a id="sthref828"></a>OracleConnection</code> interface. The <code>Statement</code> objects you create from the <code><a id="sthref829"></a>OracleOCIConnection</code> instance have the same fields and methods as <code>OracleStatement</code> objects you create from <code>OracleConnection</code> instances.</p>
<p>The following code shows header information for the <code>OracleOCIConnectionPool</code> class:</p>
<pre>/* 
   * @param us  ConnectionPool user-id. 
   * @param p   ConnectionPool password 
   * @param name  logical name of the pool. This needs to be one in the 
   *                   tnsnames.ora configuration file. 
     @param config (optional)  Properties of the pool, if the default does not 
                suffice. Default connection configuration is min =1, max=1,
                incr=0 
                  Please refer setPoolConfig for property names. 

                 Since this is optional, pass null if the default configuration 
                 suffices. 

   * @return 
   * 
   * Notes: Choose a userid and password that can act as proxy for the users 
   *        in the getProxyConnection() method. 

            If config is null, then the following default values will take
            effect 
            CONNPOOL_MIN_LIMIT = 1 
            CONNPOOL_MAX_LIMIT = 1 
            CONNPOOL_INCREMENT = 0 

*/ 

public synchronized OracleOCIConnectionPool 
  (String       user,    String   password,  String name, Properties config) 
  throws SQLException 

/* 
 * This will use the user-id, password and connection pool name values set 
   LATER using the methods setUser, setPassword, setConnectionPoolName. 

 * @return 
 * 
 * Notes: 

     No OracleOCIConnection objects can be created on 
     this class unless the methods setUser, setPassword, setPoolConfig 
     are invoked. 
     When invoking the setUser, setPassword later, choose a userid and 
     password that can act as proxy for the users 
 *   in the getProxyConnection() method. 
 */ 
  public synchronized OracleOCIConnectionPool () 
    throws SQLException 
</pre>
<p class="subhead2"><a id="JJDBC28793"></a>Importing the oracle.jdbc.pool and oracle.jdbc.oci Packages<a id="sthref830"></a></p>
<p>Before you create an OCI connection pool, import the following to have Oracle OCI connection pooling functionality:</p>
<pre>import oracle.jdbc.pool.*;
import oracle.jdbc.oci.*;
</pre>
<p class="subhead2"><a id="JJDBC28794"></a>Creating an OCI Connection Pool</p>
<p>The following code show how you create an instance of the <code>OracleOCIConnectionPool</code> class called <code>cpool</code>:</p>
<pre>OracleOCIConnectionPool cpool = new OracleOCIConnectionPool
    (&#34;HR&#34;, &#34;hr&#34;, &#34;jdbc:oracle:oci:@(description=(address=(host=
    localhost)(protocol=tcp)(port=5221))(connect_data=(INSTANCE_NAME=orcl)))&#34;,
    poolConfig);
</pre>
<p><code>poolConfig</code> is a set of properties that specify the connection pool. If <code>poolConfig</code> is null, then the default values are used. For example, consider the following:</p>
<ul>
<li>
<p><code>poolConfig.put (OracleOCIConnectionPool.CONNPOOL_MIN_LIMIT, &#34;4&#34;);</code></p>
</li>
<li>
<p><code>poolConfig.put (OracleOCIConnectionPool.CONNPOOL_MAX_LIMIT, &#34;10&#34;);</code></p>
</li>
<li>
<p><code>poolConfig.put (OracleOCIConnectionPool.CONNPOOL_INCREMENT, &#34;2&#34;);</code></p>
</li>
</ul>
<p>As an alternative to the constructor call, you can create an instance of the <code>OracleOCIConnectionPool</code> class using individual methods to specify the user, password, and connection string.</p>
<pre>OracleOCIConnectionPool cpool = new OracleOCIConnectionPool ( );
cpool.setUser(&#34;HR&#34;);
cpool.setPassword(&#34;hr&#34;);
cpool.setURL(&#34;jdbc:oracle:oci:@(description=(address=(host=
    localhost)(protocol=tcp)(port=5221))(connect_data=(INSTANCE_NAME=orcl)))&#34;);
cpool.setPoolConfig(poolConfig);  // In case you want to specify a different 
                                  // configuration other than the default 
                                  // values.
</pre>
<p class="subhead2"><a id="JJDBC28795"></a>Setting the OCI Connection Pool Parameters</p>
<p>The connection pool configuration is determined by the following <code>OracleOCIConnectionPool</code> class attributes:</p>
<ul>
<li>
<p><code>CONNPOOL_MIN_LIMIT</code></p>
<p>Specifies the minimum number of physical connections that can be maintained by the pool.</p>
</li>
<li>
<p><code>CONNPOOL_MAX_LIMIT</code></p>
<p>Specifies the maximum number of physical connections that can be maintained by the pool.</p>
</li>
<li>
<p><code>CONNPOOL_INCREMENT</code></p>
<p>Specifies the incremental number of physical connections to be opened when all the existing ones are busy and a call needs one more connection; the increment is done only when the total number of open physical connections is less than the maximum number that can be opened in that pool.</p>
</li>
<li>
<p><code>CONNPOOL_TIMEOUT</code></p>
<p>Specifies how much time must pass before an idle physical connection is disconnected; this does not affect a logical connection.</p>
</li>
<li>
<p><code>CONNPOOL_NOWAIT</code></p>
<p>Specifies, if enabled, that an error is returned if a call needs a physical connection while the maximum number of connections in the pool are busy. If disabled, a call waits until a connection is available. Once this attribute is set to <code>true</code>, it cannot be reset to <code>false</code>.</p>
</li>
</ul>
<p>You can configure all of these attributes dynamically. Therefore, an application has the flexibility of reading the current load, that is number of open connections and number of busy connections, and adjusting these attributes appropriately, using the <code><a id="sthref831"></a>setPoolConfig</code> method.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The default values for the <code>CONNPOOL_MIN_LIMIT</code>, <code>CONNPOOL_MAX_LIMIT</code>, and <code>CONNPOOL_INCREMENT</code> parameters are <code>1</code>, <code>1</code>, and <code>0</code>, respectively.</div>
<p>The <code>set<a id="sthref832"></a>PoolConfig</code> method is used to configure OCI connection pool properties. The following is a typical example of how the <code>OracleOCIConnectionPool</code> class attributes can be set:<a id="sthref833"></a></p>
<pre>...
java.util.Properties p  = new java.util.Properties( );
p.put (OracleOCIConnectionPool.CONNPOOL_MIN_LIMIT, &#34;1&#34;);
p.put (OracleOCIConnectionPool.CONNPOOL_MAX_LIMIT, &#34;5&#34;);
p.put (OracleOCIConnectionPool.CONNPOOL_INCREMENT, &#34;2&#34;);
p.put (OracleOCIConnectionPool.CONNPOOL_TIMEOUT, &#34;10&#34;);
p.put (OracleOCIConnectionPool.CONNPOOL_NOWAIT, &#34;true&#34;);
cpool.setPoolConfig(p);
...
</pre>
<p>Observe the following rules when setting these attributes:</p>
<ul>
<li>
<p><code>CONNPOOL_MIN_LIMIT</code>, <code>CONNPOOL_MAX_LIMIT</code>, and <code>CONNPOOL_INCREMENT</code> are mandatory.</p>
</li>
<li>
<p><code>CONNPOOL_MIN_LIMIT</code> must be a value greater than zero.</p>
</li>
<li>
<p><code>CONNPOOL_MAX_LIMIT</code> must be a value greater than or equal to <code>CONNPOOL_MIN_LIMIT</code> plus <code>CONNPOOL_INCREMENT</code>.</p>
</li>
<li>
<p><code>CONNPOOL_INCREMENT</code> must be a value greater than or equal to zero.</p>
</li>
<li>
<p><code>CONNPOOL_TIMEOUT</code> must be a value greater than zero.</p>
</li>
<li>
<p><code>CONNPOOL_NOWAIT</code> must be <code>true</code> or <code>false.</code></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink LNOCI091" href="../LNOCI/oci09adv.htm#LNOCI091"><span class="italic">Oracle Call Interface Programmer&#39;s Guide</span></a></div>
<p class="subhead2"><a id="JJDBC28796"></a>Checking the OCI Connection Pool Status</p>
<p>To check the status of the connection pool, use the following methods from the <code>OracleOCIConnectionPool</code> class:</p>
<ul>
<li>
<p><code>int getMinLimit()</code></p>
<p>Retrieves the minimum number of physical connections that can be maintained by the pool.</p>
</li>
<li>
<p><code>int getMaxLimit()</code></p>
<p>Retrieves the maximum number of physical connections that can be maintained by the pool.</p>
</li>
<li>
<p><code>int getConnectionIncrement()</code></p>
<p>Retrieves the incremental number of physical connections to be opened when all the existing ones are busy and a call needs a connection.</p>
</li>
<li>
<p><code>int getTimeout()</code></p>
<p>Retrieves the specified time (in seconds) that a physical connection in a pool can remain idle before it is disconnected; the age of a connection is based on the <a id="sthref834"></a>Least Recently Used (LRU) algorithm.</p>
</li>
<li>
<p><code>String getNoWait()</code></p>
<p>Retrieves if the <code>NOWAIT</code> property is enabled. It returns a string of &#34;<code>true</code>&#34; or &#34;<code>false</code>&#34;.</p>
</li>
<li>
<p><code>int getPoolSize()</code></p>
<p>Retrieves the number of physical connections that are open. This should be used only as an estimate and for statistical analysis.</p>
</li>
<li>
<p><code>int getActiveSize()</code></p>
<p>Retrieves the number of physical connections that are open and busy. This should be used only as an estimate and for statistical analysis.</p>
</li>
<li>
<p><code>boolean isPoolCreated()</code></p>
<p>Retrieves if the pool has been created. The pool is actually created when <code>OracleOCIConnection(user, password, url, poolConfig)</code> is called or when <code>setUser</code>, <code>setPassword</code>, and <code>setURL</code> has been done after calling <code>OracleOCIConnection()</code>.</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="CIHGJJHC"></a>
<div id="JJDBC28797" class="sect1">
<h2 class="sect1">Connecting to an OCI Connection Pool</h2>
<p>The <code>OracleOCIConnectionPool</code> class, through a <code>getConnection</code> method call, creates an instance of the <code>OracleOCIConnection</code> class. This instance represents a connection.</p>
<p>Because the <code>OracleOCIConnection</code> class extends <code>OracleConnection</code> class, it has the functionality of this class too. Close the <code>OracleOCIConnection</code> objects once the user session is over, otherwise, they are closed when the pool instance is closed.</p>
<p>There are two ways of calling <code>getConnection</code>:</p>
<ul>
<li>
<p><code>OracleConnection getConnection()</code></p>
<p>If you do not supply the user name and password, then the default user name and password used for the creation of the connection pool are used while creating the connection objects.</p>
</li>
<li>
<p><code>OracleConnection getConnection(String user, String password)</code></p>
<p>If you this method, you will get a logical connection identified with the specified user name and password, which can be different from that used for pool creation.</p>
</li>
</ul>
<p>The following code shows the signatures of the overloaded <code><a id="sthref835"></a>getConnection</code> method:</p>
<pre>public synchronized OracleConnection getConnection( ) 
                    throws SQLException 

/* 
 * For getting a connection to the database. 
 * 
 * @param us  Connection user-id 
 * @param p   Connection password 
 * @return     connection object 
 */ 
public synchronized OracleConnection getConnection(String us, String p) 
throws SQLException 
</pre>
<p>As an enhancement to <code>OracleConnection</code>, the following new method is added into <code>OracleOCIConnection</code> as a way to change the password for the user:</p>
<pre>void passwordChange (String user, String oldPassword, String newPassword) 
</pre></div>
<!-- class="sect1" -->
<a id="CIHHCGGH"></a>
<div id="JJDBC28798" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Sample Code for OCI Connection Pooling</h2>
<p>The following code illustrates the use of OCI connection pooling in a sample application:</p>
<pre>import java.sql.DriverManager;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Properties;
import oracle.jdbc.OracleDriver;
import oracle.jdbc.pool.OracleOCIConnectionPool;
 
public class conPoolAppl extends Thread
{
  public static final String query = &#34;SELECT object_name FROM all_objects WHERE rownum &lt; 300&#34;;
  static public void main(String args[]) throws SQLException
  {
    int _maxCount = 10;
    Connection []conn = new Connection[_maxCount];
    try
    {
      String s = null;   //System.getProperty (&#34;JDBC_URL&#34;);
      String url = &#34;jdbc:oracle:oci8:@localhost&#34;;
      OracleOCIConnectionPool cpool = new OracleOCIConnectionPool(&#34;HR&#34;, &#34;hr&#34;, url, null);
 
      // Print out the default configuration for the OracleOCIConnectionPool
      System.out.println (&#34;-- The default configuration for the OracleOCIConnectionPool --&#34;);
      displayPoolConfig(cpool);
 
      //Set up the initial pool configuration
      Properties p1  = new Properties();
      p1.put (OracleOCIConnectionPool.CONNPOOL_MIN_LIMIT, Integer.toString(1));
      p1.put (OracleOCIConnectionPool.CONNPOOL_MAX_LIMIT, Integer.toString(_maxCount));
      p1.put (OracleOCIConnectionPool.CONNPOOL_INCREMENT, Integer.toString(1));
  
      // Enable the initial configuration
      cpool.setPoolConfig(p1);
 
      Thread []t = new Thread[_maxCount];
      for (int i = 0; i &lt; _maxCount; ++i)
      {
        conn[i] = cpool.getConnection(&#34;HR&#34;, &#34;hr&#34;);
        if ( conn[i] == null )
        {
          System.out.println(&#34;Unable to create connection.&#34;);
          return;
        }
        t[i] = new conPoolAppl (i, conn[i]);
        t[i].start ();
        //displayPoolConfig(cpool);
      }
 
      ((conPoolAppl)t[0]).startAllThreads ();
      try 
      { 
        Thread.sleep (200); 
      } 
      catch (Exception ea) {}
 
      displayPoolConfig(cpool);
      for (int i = 0; i &lt; _maxCount; ++i)
        t[i].join ();
    }
    catch(Exception ex)
    {
      System.out.println(&#34;Error: &#34; + ex);
      ex.printStackTrace ();
      return;
    } 
    finally
    {
      for (int i = 0; i &lt; _maxCount; ++i)
        if (conn[i] != null)
        conn[i].close ();
    }
  } //end of main
 
  private Connection m_conn;
  private static boolean m_startThread = false;
  private int m_threadId;
  
  public conPoolAppl (int i, Connection conn)
  {
    m_threadId = i;
    m_conn = conn;
  }
 
  public void startAllThreads ()
  {
    m_startThread = true;
  }
 
  public void run ()
  {
    while (!m_startThread) Thread.yield ();
    try
    {
      doQuery (m_conn);
    }
    catch (SQLException ea)
    {
      System.out.println (&#34;*** Thread id: &#34; + m_threadId);
      ea.printStackTrace ();
    }
  } // end of run
 
  private static void doQuery (Connection conn) throws SQLException
  {
    PreparedStatement pstmt = null;
    ResultSet rs = null;
    try
    {
      pstmt = conn.prepareStatement (query);
      rs = pstmt.executeQuery ();
      while (rs.next ())
      {
        //System.out.println (&#34;Object name: &#34; +rs.getString (1));
      }
    }
    catch (Exception ea)
    {
      System.out.println (&#34;Error during execution: &#34; +ea);
      ea.printStackTrace ();
    }
    finally
    {
      if (rs != null)
        rs.close ();
      if (pstmt != null)
        pstmt.close ();
      if (conn != null)
        conn.close ();
    }
  }  // end of doQuery (Connection)
 
  // Display the current status of the OracleOCIConnectionPool
  private static void displayPoolConfig (OracleOCIConnectionPool cpool) throws SQLException
  {
    System.out.println (&#34; Min poolsize Limit: &#34; + cpool.getMinLimit());
    System.out.println (&#34; Max poolsize Limit: &#34; + cpool.getMaxLimit());
  /*
    System.out.println (&#34; Connection Increment: &#34; + cpool.getConnectionIncrement());
    System.out.println (&#34; NoWait: &#34; + cpool.getNoWait());
    System.out.println (&#34; Timeout: &#34; + cpool.getTimeout());
  */
    System.out.println (&#34; PoolSize: &#34; + cpool.getPoolSize());
    System.out.println (&#34; ActiveSize: &#34; + cpool.getActiveSize());
  }
 
}  // end of class conPoolAppl
</pre></div>
<!-- class="sect1" -->
<a id="CIHDABJC"></a>
<div id="JJDBC28799" class="sect1">
<h2 class="sect1">Statement Handling and Caching</h2>
<p>Statement caching is supported with <code>OracleOCIConnectionPool</code>. The caching improves performance by not having to open, parse, and close cursors. When <code>OracleOCIConnection.prepareStatement</code> (&#34;<code><span class="codeinlineitalic">a_SQL_query</span></code>&#34;) is processed, the statement cache is searched for a statement that matches the SQL query. If a match is found, then you can reuse the <code>Statement</code> object instead of incurring the cost of creating another <code>Statement</code> object. The cache size can be dynamically increased or decreased. The default cache size is zero.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The <code>OracleStatement</code> object created from <code>OracleOCIConnection</code> has the same behavior as one that is created from <code>OracleConnection</code>.</div>
</div>
<!-- class="sect1" -->
<a id="CIHGAIII"></a>
<div id="JJDBC28800" class="sect1">
<h2 class="sect1">JNDI and the OCI Connection Pool</h2>
<p>The Java Naming and Directory Interface (JNDI) feature makes the properties of a Java object persist, therefore these properties can be used to construct a new instance of the object, such as cloning the object. The benefit is that the old object can be freed, and at a later time a new object with exactly the same properties can be created. The <code>InitialContext.bind</code> method makes the properties persist, either on file or in a database, while the <code>InitialContext.lookup</code> method retrieves the properties from the persistent store and creates a new object with these properties.</p>
<p><code>OracleOCIConnectionPool</code> objects can be bound and looked up using the JNDI feature. No new interface calls in <code>OracleOCIConnectionPool</code> are necessary.</p>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2237">
<tr>
<td class="cellalignment2246">
<table class="cellalignment2242">
<tr>
<td class="cellalignment2241"><a href="oraperf.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2241"><a href="drcp.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2249">
<table class="cellalignment2240">
<tr>
<td class="cellalignment2241"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2241"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2241"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2241"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2241"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2241"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>