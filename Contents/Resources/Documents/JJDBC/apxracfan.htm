<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-70975"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Oracle%20RAC%20Fast%20Application%20Notification"></a><title>Oracle RAC Fast Application Notification</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1023"/>
<meta name="description" content="This book describes how to use Oracle JDBC drivers to develop powerful Java database applications."/>
<meta name="dcterms.created" content="2014-06-30T1:22:37Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database JDBC Developer&#39;s Guide"/>
<meta name="dcterms.identifier" content="E49300-05"/>
<meta name="dcterms.isVersionOf" content="JJDBC"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="apxref.htm" title="Previous" type="text/html"/>
<link rel="Next" href="apxtips.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E49300-05.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">51/55</span> <!-- End Header -->
<div id="JJDBC28934" class="appendix"><a id="CDCBIDHF"></a>
<h1 class="appendix"><span class="secnum">B</span> Oracle RAC Fast Application Notification</h1>
<p>Oracle Database 12<span class="italic">c</span> Release 1 (12.1) introduces a new set of APIs for Oracle RAC Fast Application Notification (FAN) events. These APIs provide an alternative for taking advantage of the high-availability (HA) features of Oracle Database, if you do not use Universal Connection Pool or Oracle JDBC connection caching. These APIs are not a part of Oracle JDBC APIs.</p>
<p>This appendix covers the following topics:</p>
<ul>
<li>
<p><a href="#CDCBBJGJ">Overview of Oracle RAC Fast Application Notification</a></p>
</li>
<li>
<p><a href="#CDCBCDBD">Installing and Configuring Oracle RAC Fast Application Notification</a></p>
</li>
<li>
<p><a href="#CDCFEFAF">Using Oracle RAC Fast Application Notification</a></p>
</li>
<li>
<p><a href="#CDCGBIEI">Implementing a Connection Cache</a></p>
</li>
</ul>
<p>This feature depends on the Oracle Notification System (ONS) message transport mechanism. This feature requires configuring your system, servers, and clients to use ONS.</p>
<p>For using Oracle RAC Fast Application Notification, the <code>simplefan.jar</code> file must be present in the classpath, and either the <code>ons.jar</code> file must be present in the classpath or an Oracle Notification Services (ONS) client must be installed and running in the client system.</p>
<a id="CDCBBJGJ"></a>
<div id="JJDBC28935" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Overview of Oracle RAC Fast Application Notification</h2>
<p>The Oracle RAC Fast Application Notification (FAN) feature provides a simplified API for accessing FAN events through a callback mechanism. This mechanism enables application code to receive a callback when a FAN event occurs. These APIs are referred to as Oracle RAC FAN APIs in this appendix.</p>
<p>The Oracle RAC FAN APIs provide FAN event notification for developing more responsive applications that can take full advantage of Oracle Database HA features. If you do not want to use Universal Connection Pool, but want to work with FAN events implementing your own connection cache, then you should use Oracle RAC Fast Application Notification.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<ul>
<li>
<p>If you do not want to implement your own connection cache, then you should use Universal Connection Pooling to get all the advantages of Oracle RAC Fast Application Notification, along with many additional benefits. For more information on Universal Connection Pooling, refer to <span class="italic">Oracle Universal Connection Pool for JDBC Developer&#39;s Guide</span>.</p>
</li>
<li>
<p>Starting from Oracle Database 12<span class="italic">c</span> Release 1 (12.1), implicit connection cache is desupported. Oracle recommends to use Universal Connection Pool in place of implicit connection cache.</p>
</li>
</ul>
</div>
<p>FAN event notifications sent by Oracle RAC. This is achieved by enabling the code to respond to FAN events in the following way:</p>
<ul>
<li>
<p>Listening for Oracle RAC service down and node down events</p>
</li>
<li>
<p>Listening for load balancing advisory events and responding to them</p>
</li>
</ul>
<p>This feature exposes a subset of FAN events, which are the notifications sent by a cluster running Oracle RAC, to inform the subscribers about the configuration changes within the cluster. The supported FAN events are the following:</p>
<ul>
<li>
<p>Service down</p>
<p>The service down events notify that the managed resources are down and currently not available for access. There are two kinds of service down events:</p>
<ul>
<li>
<p>Events indicating that a particular instance of a service is down and the instance is no longer able to accept work.</p>
</li>
<li>
<p>Events indicating that <span class="italic">all</span> instances of a service are down and the service is no longer able to accept work.</p>
</li>
</ul>
<p>When the last instance of a service goes down, then the subscriber receives both events. The events may or may not arrive together.</p>
</li>
<li>
<p>Node down</p>
<p>The node down events notify that the Oracle RAC node identified by the host identifier is down and not reachable. The cluster sends node down events when a node is no longer able to accept work.</p>
</li>
<li>
<p>Load balancing advisory</p>
<p>The load balancing advisory events provide metrics for load balancing algorithms. Load balancing advisories are sent regularly to inform subscribers of the recommended distribution of work among the available nodes.</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you want to implement your own connection cache, only then you should use Oracle RAC Fast Application Notification. Otherwise, you should use Universal Connection Pooling to get all the advantages of Oracle RAC Fast Application Notification, along with many additional benefits. For more information on Universal Connection Pooling, refer to <a class="olink JJUCP8109" href="../JJUCP/intro.htm#JJUCP8109"><span class="italic">Oracle Universal Connection Pool for JDBC Developer&#39;s Guide</span></a>.</div>
</div>
<!-- class="sect1" -->
<a id="CDCBCDBD"></a>
<div id="JJDBC28936" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Installing and Configuring Oracle RAC Fast Application Notification</h2>
<p>You can install the Oracle RAC FAN APIs by performing the following steps:</p>
<ol>
<li>
<p>Download the <code>simplefan.jar</code> file from the following link</p>
<pre><a href="http://www.oracle.com/technetwork/database/enterprise-edition/jdbc-112010-090769.html">http://www.oracle.com/technetwork/database/enterprise-edition/jdbc-112010-090769.html</a>
</pre></li>
<li>
<p>Add the <code>simplefan.jar</code> file to the classpath.</p>
</li>
<li>
<p>Perform the following in your Java code:</p>
<ol>
<li>
<p>Get an instance of the <code>FanManager</code> class by using the <code>getInstance</code> method.</p>
</li>
<li>
<p>Configure the event daemon using the <code>configure</code> method of the <code>FanManager</code> class. The <code>configure</code> method sets the following properties:</p>
<p><code>onsNodes</code>: A comma separated list of <code>host:port</code> pairs of ONS daemons that the ONS runtime in this Java VM should communicate with. The <code>host</code> in a <code>host:port</code> pair is the host name of a system running the ONS daemon. The <code>port</code> is the local port configuration parameter for that daemon.</p>
<p><code>onsWalletFile</code>: The path name of the ONS wallet file. The wallet file is the path to a local wallet file used by SSL to store SSL certificates. Same as wallet file configuration parameter to ONS daemon.</p>
<p><code>onsWalletPassword</code>: The password for accessing the ONS wallet file.</p>
</li>
</ol>
</li>
</ol>
<p>For a detailed description of the Oracle RAC FAN APIs, refer to <a class="olink JAFAN" href="../JAFAN/toc.htm"><span class="italic">Oracle Database RAC FAN Events Java API Reference</span></a>.</p>
</div>
<!-- class="sect1" -->
<a id="CDCFEFAF"></a>
<div id="JJDBC28945" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Using Oracle RAC Fast Application Notification</h2>
<p><a href="#CDCDJIAC">Example B-1</a> provides an example to use Oracle RAC Fast Application Notification in your code. This example code prints the event data to the standard output device.</p>
<p>This example code demonstrates sample usages of Oracle RAC FAN APIs by overloading the <code>handleFanEvent</code> method to accept different FAN event notifications as arguments. The example code also displays event data such as</p>
<ul>
<li>
<p>Name of the system sending the FAN event notification</p>
</li>
<li>
<p>Timestamp of the FAN event notification</p>
</li>
<li>
<p>Load status of the FAN event notification</p>
</li>
</ul>
<div id="JJDBC28946" class="example">
<p class="titleinexample"><a id="CDCDJIAC"></a>Example B-1 Example of Sample Code Using Oracle RAC FAN API</p>
<pre>...
...Properties props = new Properties();
props.putProperty(&rdquo;serviceName&rdquo;, &rdquo;gl&rdquo;);
FanSubscription sub = FanManager.getInstance().subscribe(props);
sub.addListener(new FanEventListener()) {
  public void handleFanEvent(ServiceDownEvent event) {
    try {
      System.out.println(event.getTimestamp());
      System.out.println(event.getServiceName());
      System.out.println(event.getDatabaseUniqueName());
      System.out.println(event.getReason());
      ServiceMemberEvent me = se.getServiceMemberEvent();
      if (me != null) {
        System.out.println(me.getInstanceName());
        System.out.println(me.getNodeName());
        System.out.println(me.getServiceMemberStatus());
      }
      ServiceCompositeEvent ce = se.getServiceCompositeEvent();
      if (ce != null) {
        System.out.println(ce.getServiceCompositeStatus());
      }
    }
    catch (Throwable t) {
      // handle all exceptions and errors
      t.printStackTrace(System.err);
    }
  }
  public void handleFanEvent(NodeDownEvent event) {
    try {
      System.out.println(event.getTimestamp());
      System.out.println(ne.getNodeName());
      System.out.println(ne.getIncarnation());
    }
    catch (Throwable t) {
      // handle all exceptions and errors
      t.printStackTrace(System.err);
    }
  }
  public void handleFanEvent(LoadAdvisoryEvent event) {
    try {
      System.out.println(event.getTimestamp());
      System.out.println(le.getServiceName());
      System.out.println(le.getDatabaseUniqueName());
      System.out.println(le.getInstanceName());
      System.out.println(le.getPercent());
      System.out.println(le.getServiceQuality());
      System.out.println(le.getLoadStatus());
    }
    catch (Throwable t) {
      // handle all exceptions and errors
      t.printStackTrace(System.err);
    }
  }
});
</pre></div>
<!-- class="example" --></div>
<!-- class="sect1" -->
<a id="CDCGBIEI"></a>
<div id="JJDBC28947" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Implementing a Connection Cache</h2>
<p>You must implement your own connection cache for using Oracle RAC FAN APIs. Consider the following points before you implement a connection cache using the Oracle RAC FAN APIs:</p>
<ul>
<li>
<p>Oracle RAC FAN APIs provide a minimal subset of FAN events.</p>
</li>
<li>
<p>Oracle RAC FAN APIs support only ONS events. If you want your application to support corresponding supercluster events, then you may require additions to the subscription properties.</p>
</li>
<li>
<p>Oracle RAC FAN APIs do not enable application code to send FAN events.</p>
</li>
</ul>
</div>
<!-- class="sect1" --></div>
<!-- class="appendix" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2237">
<tr>
<td class="cellalignment2246">
<table class="cellalignment2242">
<tr>
<td class="cellalignment2241"><a href="apxref.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2241"><a href="apxtips.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2249">
<table class="cellalignment2240">
<tr>
<td class="cellalignment2241"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2241"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2241"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2241"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2241"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2241"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>