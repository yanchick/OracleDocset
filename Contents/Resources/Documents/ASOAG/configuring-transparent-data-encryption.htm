<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-2505"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Configuring%20Transparent%20Data%20Encryption"></a><title>Configuring Transparent Data Encryption</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="description" content="You can configure software or hardware keystores, for use on both individual table columns or entire tablespaces."/>
<meta name="keywords" content="keystores, software, configuration process, Transparent Data Encryption (TDE), configuring software keystores, about, master encryption key, TDE master encryption key, sqlnet.ora file configuration, multitenant container databases, CDBs, pluggable databases, PDBs, about creating, external store for passwords, creating password-based keystore, creating auto-login keystore, creating local auto-login keystore, opening keystores, keystores, opening software keystores, setting software master encryption key, hardware keystore, external, external keystores, configuring hardware keystores, sqlnet.ora configuration, configuration step, PKCS#11 library, opening hardware keystores, opening, setting master encryption key, reconfiguring software keystore, column encryption, data types supported, data types to encrypt, restrictions, synchronous change data capture, change data capture, synchronous, transportable tablespaces, import/export utilities, original, original import/export utilities, utilities, import/export, creating tables with default encryption algorithm, creating encrypted table column with default algorithm, creating tables with non-default encryption algorithm, creating encrypted table column with non-default algorithm, skipping integrity check, creating tables without integrity checks (NOMAC), NOMAC parameter (TDE), improving performance, creating encrypted column in external table, external tables, encrypting columns in existing tables, existing tables, adding encrypted column to, adding encrypting column to existing table, encrypting existing column, encrypting unencrypted column, disabling encryption in existing column, disabling encryption, creating index on encrypted column, indexes, creating on encrypted column, column encryption, salt (TDE), adding, salt in encrypted columns, salt, removing, changing encryption key, changing algorithm, tablespace encryption, tablespace encryption, setting with COMPATIBLE parameter, procedure, opening keystore, tablespace master encryption key, setting, setting tablespace key, creating, creating encrypted tablespaces, examples, finding information about, views"/>
<meta name="dcterms.created" content="2017-06-05T10:46:18Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Advanced Security Guide"/>
<meta name="dcterms.identifier" content="E50333-18"/>
<meta name="dcterms.isVersionOf" content="ASOAG"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="introduction-to-transparent-data-encryption.htm" title="Previous" type="text/html"/>
<link rel="Next" href="managing-keystore-and-tde-master-encryption-key.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E50333-18.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-C5D20EAE-3369-411F-9A7E-13AB14139F1D"></a> <span id="PAGE" style="display:none;">8/21</span> <!-- End Header -->
<a id="ASOAG10474"></a>
<h1 class="sect1"><span class="enumeration_chapter">3</span> Configuring Transparent Data Encryption</h1>
<div>
<p>You can configure software or hardware keystores, for use on both individual table columns or entire tablespaces.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-1FA85E9E-5666-4CF3-A3C7-1F8A9230B0C9" title="A software keystore is a container for the TDE master encryption key, and it resides in the software file system.">Configuring a Software Keystore</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-753C4808-CC51-4DA1-A5C3-980417FDAB14" title="A hardware keystore resides in a hardware security module (HSM), which is designed to store encryption keys.">Configuring a Hardware Keystore</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-A0E2C279-10F6-48D9-AB92-C547529C06EE" title="You can use Transparent Data Encryption to encrypt individual columns in database tables.">Encrypting Columns in Tables</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-1CA947A5-164A-4AA9-AD75-F7D9D4F6FFF8" title="You can perform encryption operations on both offline and online tablespaces and databases.">Encrypting Tablespaces</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-F2CB30AB-99AA-4BF6-A95F-41C1C205963F" title="Oracle Database provides a set of dynamic and data dictionary views that you can query to find more information about Transparent Data Encryption data.">Transparent Data Encryption Data Dynamic and Data Dictionary Views</a></p>
</li>
</ul>
</div>
<a id="ASOAG10274"></a>
<div class="props_rev_3"><a id="GUID-1FA85E9E-5666-4CF3-A3C7-1F8A9230B0C9"></a>
<h2 class="sect2">Configuring a Software Keystore</h2>
<div>
<p>A software keystore is a container for the TDE master encryption key, and it resides in the software file system.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-01E3A39B-87BD-4E3F-9198-6CBD896B405B" title="A software keystore is a container that stores the Transparent Data Encryption master encryption key.">About Configuring a Software Keystore</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-93527DE3-9186-444E-BCD0-63ED029E1ECB" title="The first step you must take to configure a software keystore is to designate a location for it in the sqlnet.ora file.">Step 1: Set the Software Keystore Location in the sqlnet.ora File</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-F098129B-BBFF-4C86-B119-80AB706DB2A1" title="After you have specified a directory location for the software keystore, you can create the keystore.">Step 2: Create the Software Keystore</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-37296947-18DB-4CFA-A112-794A55E942E2" title="Depending on the type of keystore you create, you must manually open the keystore before you can use it.">Step 3: Open the Software Keystore</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-15E41F0A-5D80-4A7A-88F6-30EE86FA44E8" title="Once the keystore is open, you can set a TDE master encryption key for it.">Step 4: Set the Software TDE Master Encryption Key</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-9D157063-2C48-40AC-8697-0FD1A866F038" title="After you complete the software keystore configuration, you can begin to encrypt data.">Step 5: Encrypt Your Data</a></p>
</li>
</ul>
</div>
<a id="ASOAG10275"></a>
<div class="props_rev_3"><a id="GUID-01E3A39B-87BD-4E3F-9198-6CBD896B405B"></a>
<h3 class="sect3">About Configuring a Software Keystore</h3>
<div>
<p>A software keystore is a container that stores the Transparent Data Encryption master encryption key.</p>
<p>Before you can configure the keystore, you first must define a location for it in the <code class="codeph">sqlnet.ora</code> file. There is one keystore per database, and the database locates this keystore by checking the keystore location that you define in the <code class="codeph">sqlnet.ora</code> file. You can create other keystores, such as copies of the keystore and export files that contain keys, depending on your needs. However, you must never remove or delete the keystore that you configured in the <code class="codeph">sqlnet.ora</code> location, nor replace it with a different keystore.</p>
<p>After you configure the software keystore location in the <code class="codeph">sqlnet.ora</code> file, you can log in to the database instance to create and open the keystore, and then set the TDE master encryption key. After you complete these steps, you can begin to encrypt data.</p>
</div>
</div>
<a id="ASOAG10276"></a>
<div class="props_rev_3"><a id="GUID-93527DE3-9186-444E-BCD0-63ED029E1ECB"></a>
<h3 class="sect3">Step 1: Set the Software Keystore Location in the sqlnet.ora File</h3>
<div>
<p>The first step you must take to configure a software keystore is to designate a location for it in the <code class="codeph">sqlnet.ora</code> file.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-DF9504EF-BA08-4585-895D-2E5F4BA30E50" title="Oracle Database checks the sqlnet.ora file for the directory location of the keystore, whether it is a software keystore, a hardware module security (HSM) keystore, or an Oracle Key Vault keystore.">About the Keystore Location in the sqlnet.ora File</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-278422A5-1F77-4E82-B4A1-578F03AE30FD" title="Use the sqlnet.ora file to configure the keystore location for a regular file system, for multiple database access, and for use with Oracle Automatic Storage Management (ASM).">Configuring the sqlnet.ora File for a Software Keystore Location</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-446E7F4A-D122-4533-B194-60383F128B53" title="You can configure a software keystore for a regular file system.">Example: Configuring a Software Keystore for a Regular File System</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-0DDFCEB4-3331-4475-90F2-2092AAB5CFF3" title="You can configure multiple databases to share the sqlnet.ora file.">Example: Configuring a Software Keystore When Multiple Databases Share the sqlnet.ora File</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-443E617E-EFE9-4C5E-BAF0-A56E339DD72F" title="You can configure sqlnet.ora for an Automatic Storage Management (ASM) file system">Example: Configuring a Software Keystore for Oracle Automatic Storage Management</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-C55E491B-5C30-406E-BDCF-67B87C5A0F00" title="You can configure sqlnet.ora for an Oracle Automatic Storage Management (ASM) disk group.">Example: Configuring a Software Keystore for an Oracle Automatic Storage Management Disk Group</a></p>
</li>
</ul>
</div>
<a id="ASOAG10277"></a>
<div class="props_rev_3"><a id="GUID-DF9504EF-BA08-4585-895D-2E5F4BA30E50"></a>
<h4 class="sect4">About the Keystore Location in the sqlnet.ora File</h4>
<div>
<p>Oracle Database checks the <code class="codeph">sqlnet.ora</code> file for the directory location of the keystore, whether it is a software keystore, a hardware module security (HSM) keystore, or an Oracle Key Vault keystore.</p>
<p>You must edit the <code class="codeph">sqlnet.ora</code> file to define a directory location for the keystore that you plan to create. Ensure that this directory exists beforehand. Preferably, this directory should be empty.</p>
<p>Note the following behavior when you must edit the <code class="codeph">sqlnet.ora</code> file in an Oracle Real Application Clusters (Oracle RAC) or a multitenant environment:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">In an Oracle RAC environment:</span> If you are using the <code class="codeph">srvctl</code> utility and if you want to include environment variables in the <code class="codeph">sqlnet.ora</code> configuration file, then you must set these environment variables in both the operating system and the <code class="codeph">srvctl</code> environment. Oracle recommends that you place the keystore on a shared file system, such as Oracle Automatic Storage Management (ASM) or NFS.</p>
</li>
<li>
<p><span class="bold">In a multitenant environment:</span> The keystore location is set for the entire multitenant container database (CDB), not for individual pluggable databases (PDBs).</p>
</li>
</ul>
<p>In the <code class="codeph">sqlnet.ora</code> file, you must set the <code class="codeph">ENCRYPTION_WALLET_LOCATION</code> parameter to specify the keystore location. When determining which keystore to use, Oracle Database searches for the keystore location in the following places, in this order:</p>
<ol>
<li>
<p>It attempts to use the keystore in the location specified by the parameter <code class="codeph">ENCRYPTION_WALLET_LOCATION</code> in the <code class="codeph">sqlnet.ora</code> file.</p>
</li>
<li>
<p>If the <code class="codeph">ENCRYPTION_WALLET_LOCATION</code> parameter is not set, then it attempts to use the keystore in the location that is specified by the parameter <code class="codeph">WALLET_LOCATION</code>.</p>
</li>
<li>
<p>If the <code class="codeph">WALLET_LOCATION</code> parameter is also not set, then Oracle Database looks for a keystore at the default database location, which is <span class="italic"><code class="codeph">ORACLE_BASE</code></span><code class="codeph">/admin/</code><span class="italic"><code class="codeph">DB_UNIQUE_NAME</code></span><code class="codeph">/wallet</code> or <span class="italic"><code class="codeph">ORACLE_HOME</code></span><code class="codeph">/admin/</code><span class="italic"><code class="codeph">DB_UNIQUE_NAME</code></span><code class="codeph">/wallet</code>. (<span class="italic"><code class="codeph">DB_UNIQUE_NAME</code></span> is the unique name of the database specified in the initialization parameter file.) When the keystore location is not set in the <code class="codeph">sqlnet.ora</code> file, then the <code class="codeph">V$ENCRYPTION_WALLET</code> view displays the default location. You can check the location and status of the keystore in the <code class="codeph">V$ENCRYPTION_WALLET</code> view.</p>
</li>
</ol>
<p>By default, the <code class="codeph">sqlnet.ora</code> file is located in the <span class="italic"><code class="codeph">ORACLE_HOME</code></span><code class="codeph">dbs</code> directory or in the location set by the <code class="codeph">TNS_ADMIN</code> environment variable. Ensure that you have properly set the <code class="codeph">TNS_ADMIN</code> environment variable to point to the correct <code class="codeph">sqlnet.ora</code> file.</p>
<div class="infoboxnotealso" id="GUID-DF9504EF-BA08-4585-895D-2E5F4BA30E50__GUID-DC3B1C46-8FC3-4747-B78F-AFC4C719353F">
<p class="notep1">See Also:</p>
<a class="olink SQPUG004" target="_blank" href="../SQPUG/qstart.htm#SQPUG004"><span><cite>SQL*Plus User&#39;s Guide and Reference</cite></span></a> for more information and examples of setting the <code class="codeph">TNS_ADMIN</code> environment variable</div>
</div>
</div>
<a id="ASOAG10278"></a>
<div class="props_rev_3"><a id="GUID-278422A5-1F77-4E82-B4A1-578F03AE30FD"></a>
<h4 class="sect4">Configuring the sqlnet.ora File for a Software Keystore Location</h4>
<div>
<p>Use the <code class="codeph">sqlnet.ora</code> file to configure the keystore location for a regular file system, for multiple database access, and for use with Oracle Automatic Storage Management (ASM).</p>
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>To create a software keystore on a regular file system, use the following format when you edit the <code class="codeph">sqlnet.ora</code> file:</p>
<pre dir="ltr">ENCRYPTION_WALLET_LOCATION=
 (SOURCE=
  (METHOD=<span class="bold">FILE</span>)
   (METHOD_DATA=
    (DIRECTORY=<span class="italic"><span class="bold">path_to_keystore</span></span>)))
</pre></li>
</ul>
<p>If the <span class="bold"><span class="italic"><code class="codeph">path_to_keystore</code></span></span> will contain an environment variable, then set this variable in the environment where the database instance is started and before you start the database. If you are using the <code class="codeph">srvctl</code> utility to start the database, then set the environment variable in the <code class="codeph">srvctl</code> environment as well, using the following command:</p>
<pre dir="ltr">srvctl setenv database -db <span class="italic">database_name</span> -env &#34;<span class="italic">environment_variable_name</span>=<span class="italic">environment_variable_value</span>&#34;
</pre></div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-446E7F4A-D122-4533-B194-60383F128B53"></a>
<h4 class="sect4">Example: Configuring a Software Keystore for a Regular File System</h4>
<div>
<p>You can configure a software keystore for a regular file system.</p>
<p>The following example shows how to configure a software keystore location in the <code class="codeph">sqlnet.ora</code> file for a regular file system in which the database name is <code class="codeph">orcl</code>.</p>
<pre dir="ltr">ENCRYPTION_WALLET_LOCATION=
  (SOURCE=
   (METHOD=FILE)
    (METHOD_DATA=
     (DIRECTORY=/etc/ORACLE/WALLETS/orcl)))
</pre></div>
</div>
<div class="props_rev_3"><a id="GUID-0DDFCEB4-3331-4475-90F2-2092AAB5CFF3"></a>
<h4 class="sect4">Example: Configuring a Software Keystore When Multiple Databases Share the sqlnet.ora File</h4>
<div>
<p>You can configure multiple databases to share the <code class="codeph">sqlnet.ora</code> file.</p>
<p>The following example shows how to configure a software keystore location when multiple databases share the <code class="codeph">sqlnet.ora</code> file.</p>
<pre dir="ltr">ENCRYPTION_WALLET_LOCATION=
 (SOURCE=
  (METHOD=FILE)
   (METHOD_DATA=
    (DIRECTORY=/etc/ORACLE/WALLETS/$ORACLE_SID/)))
</pre></div>
</div>
<div class="props_rev_3"><a id="GUID-443E617E-EFE9-4C5E-BAF0-A56E339DD72F"></a>
<h4 class="sect4">Example: Configuring a Software Keystore for Oracle Automatic Storage Management</h4>
<div>
<p>You can configure <code class="codeph">sqlnet.ora</code> for an Automatic Storage Management (ASM) file system</p>
<p>The following example shows how to configure a software keystore location in the <code class="codeph">sqlnet.ora</code> file for an ASM file system:</p>
<pre dir="ltr">ENCRYPTION_WALLET_LOCATION=
 (SOURCE=
  (METHOD=FILE)
   (METHOD_DATA=
    (DIRECTORY=+disk1/mydb/wallet)))
</pre></div>
</div>
<div class="props_rev_3"><a id="GUID-C55E491B-5C30-406E-BDCF-67B87C5A0F00"></a>
<h4 class="sect4">Example: Configuring a Software Keystore for an Oracle Automatic Storage Management Disk Group</h4>
<div>
<p>You can configure <code class="codeph">sqlnet.ora</code> for an Oracle Automatic Storage Management (ASM) disk group.</p>
<p>The following format shows how to configure a software keystore if you want to create a software keystore location on an ASM disk group:</p>
<pre dir="ltr">ENCRYPTION_WALLET_LOCATION=
 (SOURCE=
  (METHOD=FILE)
   (METHOD_DATA=
    (DIRECTORY=+<span class="italic">ASM_file_path_of_the_diskgroup</span>)))
</pre></div>
</div>
</div>
<a id="ASOAG10282"></a>
<div class="props_rev_3"><a id="GUID-F098129B-BBFF-4C86-B119-80AB706DB2A1"></a>
<h3 class="sect3">Step 2: Create the Software Keystore</h3>
<div>
<p>After you have specified a directory location for the software keystore, you can create the keystore.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-5DAB02E7-CEE2-4C06-B2E0-6070F7BF8BDE" title="There are three different types of software keystores.">About Creating Software Keystores</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-0AB76778-7D98-4C23-B848-C00BD05DFEFE" title="A password-based software keystore requires a user password, which is used to protect the keys and credentials stored in the keystore.">Creating a Password-Based Software Keystore</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-98BA94DA-571B-429C-8E7A-B6A1020E9420" title="As an alternative to password-based keystores, you can create either an auto-login or local auto-login software keystore.">Creating an Auto-Login or a Local Auto-Login Software Keystore</a></p>
</li>
</ul>
</div>
<a id="ASOAG10501"></a>
<div class="props_rev_3"><a id="GUID-5DAB02E7-CEE2-4C06-B2E0-6070F7BF8BDE"></a>
<h4 class="sect4">About Creating Software Keystores</h4>
<div>
<p>There are three different types of software keystores.</p>
<p>You can create password-based software keystores, auto-login software keystores, and local auto-login software keystores.</p>
<p>Be aware that executing the query <code class="codeph">SELECT * FROM V$ENCRYPTION_WALLET</code> will automatically open an auto-login software keystore. For example, suppose you have a password-based keystore and an auto-login keystore. If the password-based keystore is open and you close the password-based keystore and then query the <code class="codeph">V$ENCRYPTION_WALLET</code> view, then the output will indicate that a keystore is open. However, this is because <code class="codeph">V$ENCRYPTION_WALLET</code> opened up the auto-login software keystore and then displayed the status of the auto-login keystore.</p>
<div class="infoboxnotealso" id="GUID-5DAB02E7-CEE2-4C06-B2E0-6070F7BF8BDE__GUID-DF80250F-EA63-4F60-A258-2E3964E3699B">
<p class="notep1">See Also:</p>
<p><a href="introduction-to-transparent-data-encryption.htm#GUID-4B020933-2A30-4ED1-AE58-F8F6BD26A224" title="Oracle Database supports software keystores and hardware (HSM-based) keystores.">Types of Keystores</a> for more information about software keystores</p>
</div>
</div>
</div>
<a id="ASOAG10283"></a>
<div class="props_rev_3"><a id="GUID-0AB76778-7D98-4C23-B848-C00BD05DFEFE"></a>
<h4 class="sect4">Creating a Password-Based Software Keystore</h4>
<div>
<p>A password-based software keystore requires a user password, which is used to protect the keys and credentials stored in the keystore.</p>
<div class="section"></div>
<!-- class="section" -->
<div class="section">
<ol>
<li>
<p>Ensure that you complete the procedure described in <a href="configuring-transparent-data-encryption.htm#GUID-93527DE3-9186-444E-BCD0-63ED029E1ECB" title="The first step you must take to configure a software keystore is to designate a location for it in the sqlnet.ora file.">Step 1: Set the Software Keystore Location in the sqlnet.ora File</a>.</p>
</li>
<li>
<p>Log in to the database instance as a user who has been granted the <code class="codeph">ADMINISTER KEY MANAGEMENT</code> or <code class="codeph">SYSKM</code> privilege.</p>
<p>In a multitenant environment, log in to the root. For example:</p>
<pre dir="ltr">sqlplus c##sec_admin as syskm
Enter password: <span class="italic">password</span>
Connected.
</pre>
<p>If SQL*Plus is already open and you had modified the <code class="codeph">sqlnet.ora</code> file during this time, then reconnect to SQL*Plus. The database session must be changed before the <code class="codeph">sqlnet.ora</code> changes can take effect.</p>
</li>
<li>
<p>Run the <code class="codeph">ADMINISTER KEY MANAGEMENT</code> SQL statement to create the keystore.</p>
<p>The syntax is as follows:</p>
<pre dir="ltr">ADMINISTER KEY MANAGEMENT CREATE KEYSTORE &#39;<span class="italic">keystore_location</span>&#39; IDENTIFIED BY <span class="italic">software_keystore_password</span>;
</pre>
<p>In this specification:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="italic"><code class="codeph">keystore_location</code></span> is the path to the keystore directory location of the password-based keystore for which you want to create the auto-login keystore (for example, <code class="codeph">/etc/ORACLE/WALLETS/orcl</code>). Enclose the <span class="italic"><code class="codeph">keystore_location</code></span> setting in single quotation marks (&#39; &#39;). To find this location, you can query the <code class="codeph">WRL_PARAMETER</code> column of the <code class="codeph">V$ENCRYPTION_WALLET</code> view. (If the keystore was not created in the default location, then the <code class="codeph">STATUS</code> column of the <code class="codeph">V$ENCRYPTION_WALLET</code> view is <code class="codeph">NOT_AVAILABLE</code>.)</p>
</li>
<li>
<p><span class="italic"><code class="codeph">software_keystore_password</code></span> is the password of the keystore that you, the security administrator, creates.</p>
</li>
</ul>
<p>For example, to create the keystore in the <code class="codeph">/etc/ORACLE/WALLETS/orcl</code> directory:</p>
<pre dir="ltr">ADMINISTER KEY MANAGEMENT CREATE KEYSTORE &#39;/etc/ORACLE/WALLETS/orcl&#39; IDENTIFIED BY <span class="italic">password</span>;

keystore altered.
</pre>
<p>After you run this statement, the <code class="codeph">ewallet.p12</code> file, which is the keystore, appears in the keystore location.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="ASOAG10284"></a>
<div class="props_rev_3"><a id="GUID-98BA94DA-571B-429C-8E7A-B6A1020E9420"></a>
<h4 class="sect4">Creating an Auto-Login or a Local Auto-Login Software Keystore</h4>
<div>
<p>As an alternative to password-based keystores, you can create either an auto-login or local auto-login software keystore.</p>
<div class="section">
<p>Both of these keystores have system-generated passwords. They are also PKCS#12-based files. The auto-login software keystore can be opened from different computers from the computer where this keystore resides, but the local auto-login software keystore can only be opened from the computer on which it was created. Both the auto-login and local auto-login keystores are created from the password-based software keystores.</p>
</div>
<!-- class="section" -->
<div class="section">
<ol>
<li>
<p>Ensure that you complete the procedure described in <a href="configuring-transparent-data-encryption.htm#GUID-93527DE3-9186-444E-BCD0-63ED029E1ECB" title="The first step you must take to configure a software keystore is to designate a location for it in the sqlnet.ora file.">Step 1: Set the Software Keystore Location in the sqlnet.ora File</a>.</p>
</li>
<li>
<p>Log in to the database instance as a user who has been granted the <code class="codeph">ADMINISTER KEY MANAGEMENT</code> or <code class="codeph">SYSKM</code> privilege.</p>
<p>In a multitenant environment, log in to the root. For example:</p>
<pre dir="ltr">sqlplus c##sec_admin as syskm
Enter password: <span class="italic">password</span>
Connected.
</pre>
<p>If SQL*Plus is already open and you had modified the <code class="codeph">sqlnet.ora</code> file during this time, then reconnect to SQL*Plus. The database session must be changed before the <code class="codeph">sqlnet.ora</code> changes can take effect.</p>
</li>
<li>
<p>Create a password-based software keystore, as described in <a href="configuring-transparent-data-encryption.htm#GUID-0AB76778-7D98-4C23-B848-C00BD05DFEFE" title="A password-based software keystore requires a user password, which is used to protect the keys and credentials stored in the keystore.">Creating a Password-Based Software Keystore</a>.</p>
</li>
<li>
<p>Run the <code class="codeph">ADMINISTER KEY MANAGEMENT</code> SQL statement to create the keystore.</p>
<p>The syntax is as follows:</p>
<pre dir="ltr">ADMINISTER KEY MANAGEMENT CREATE [LOCAL] AUTO_LOGIN KEYSTORE FROM KEYSTORE &#39;<span class="italic">keystore_location</span>&#39; IDENTIFIED BY <span class="italic">software_keystore_password</span>;
</pre>
<p>In this specification:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">LOCAL</code> enables you to create a local auto-login software keystore. Otherwise, omit this clause if you want the keystore to be accessible by other computers.</p>
</li>
<li>
<p><span class="italic"><code class="codeph">keystore_location</code></span> is the path to the directory location of the password-based keystore for which you want to create the auto-login keystore (for example, <code class="codeph">/etc/ORACLE/WALLETS/orcl</code>). Enclose this setting in single quotation marks (&#39;&nbsp;&#39;). To find this location, query the <code class="codeph">WRL_PARAMETER</code> column of the <code class="codeph">V$ENCRYPTION_WALLET</code> view.</p>
</li>
<li>
<p><span class="italic"><code class="codeph">software_keystore_password</code></span> is the password-based keystore for which you want to create the auto-login keystore.</p>
</li>
</ul>
<p>For example, to create an auto-login software keystore of the password-based keystore that is located in the<code class="codeph">/etc/ORACLE/WALLETS/orcl</code> directory:</p>
<pre dir="ltr">ADMINISTER KEY MANAGEMENT CREATE AUTO_LOGIN KEYSTORE FROM KEYSTORE &#39;/etc/ORACLE/WALLETS/orcl&#39; IDENTIFIED BY <span class="italic">password</span>;

keystore altered.
</pre>
<p>After you run this statement, the <code class="codeph">cwallet.sso</code> file appears in the keystore location. The <code class="codeph">ewallet.p12</code> file is the password-based wallet.</p>
</li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infobox-note" id="GUID-98BA94DA-571B-429C-8E7A-B6A1020E9420__GUID-1B5ED154-D90D-4E1D-AA18-B09065C0793D">
<p class="notep1">Note:</p>
<p>Do not remove the <code class="codeph">PKCS#12</code> wallet (<code class="codeph">ewallet.p12</code> file) after you create the auto login keystore (<code class="codeph">.sso</code> file). You must have the <code class="codeph">PKCS#12</code> wallet to regenerate or rekey the TDE master encryption key in the future. By default, this file is located in the <code class="codeph">$ORACLE_HOME/admin/</code><span class="italic"><code class="codeph">ORACLE_SID</code></span><code class="codeph">/wallet</code> directory.</p>
</div>
<p>Transparent Data Encryption uses an auto login keystore only if it is available at the correct location (<code class="codeph">ENCRYPTION_WALLET_LOCATION</code><code class="codeph">,</code> <code class="codeph">WALLET_LOCATION</code><code class="codeph">,</code> or the default keystore location), and the SQL statement to open an encrypted keystore has not already been executed. (Note that auto-login keystores are encrypted, because they have system-generated passwords.)</p>
<div class="infoboxnotealso" id="GUID-98BA94DA-571B-429C-8E7A-B6A1020E9420__GUID-1D3E4FF0-AF61-42A7-A5CC-A0A2938F5D76">
<p class="notep1">See Also:</p>
<p><a href="managing-keystore-and-tde-master-encryption-key.htm#GUID-5CC83A60-8EA4-4984-AD2C-42BC12E5A16F" title="Oracle strongly recommends that you do not delete keystores, particularly after you have configured Transparent Data Encryption and the keystore is in use.">Deletion of Keystores</a></p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="ASOAG10285"></a>
<div class="props_rev_3"><a id="GUID-37296947-18DB-4CFA-A112-794A55E942E2"></a>
<h3 class="sect3">Step 3: Open the Software Keystore</h3>
<div>
<p>Depending on the type of keystore you create, you must manually open the keystore before you can use it.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-F3652F6F-B1B8-485A-BCBE-32C0875E93E5" title="You must manually open a password-based software keystore before any TDE master encryption keys can be created or accessed in the keystore.">About Opening Software Keystores</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-A9C23E31-CF57-477A-9E85-856DD411718D" title="To open a software keystore, you must use the ADMINISTER KEY MANAGEMENT statement with the SET KEYSTORE OPEN clause.">Opening a Software Keystore</a></p>
</li>
</ul>
</div>
<a id="ASOAG10286"></a>
<div class="props_rev_3"><a id="GUID-F3652F6F-B1B8-485A-BCBE-32C0875E93E5"></a>
<h4 class="sect4">About Opening Software Keystores</h4>
<div>
<p>You must manually open a password-based software keystore before any TDE master encryption keys can be created or accessed in the keystore.</p>
<p>You do not need to manually open auto-login or local auto-login software keystores. These keystore are automatically opened when it is required, that is, when an encryption operation must access the key. If necessary, you can explicitly close any of these types of keystores. You can check the status of whether a keystore is open, closed, open but with no master key, or open but with an unknown master key by querying the <code class="codeph">STATUS</code> column of the <code class="codeph">V$ENCRYPTION_WALLET</code> view.</p>
<p>After you open a keystore, it remains open until you manually close it. Each time you restart a database instance, you must manually open the password keystore to reenable encryption and decryption operations.</p>
<div class="infoboxnotealso" id="GUID-F3652F6F-B1B8-485A-BCBE-32C0875E93E5__GUID-89590D76-D9C4-4F7E-B53A-0C5D250FFEF8">
<p class="notep1">See Also:</p>
<p><a href="using-transparent-data-encryption-with-other-oracle-features.htm#GUID-75855CB2-3FBC-41E4-BC89-8EA2078E633E" title="You should be aware of how keystore open and close operations work in a multitenant environment.">How Keystore Open and Close Operations Work in a Multitenant Environment</a></p>
</div>
</div>
</div>
<a id="ASOAG10287"></a>
<div class="props_rev_3"><a id="GUID-A9C23E31-CF57-477A-9E85-856DD411718D"></a>
<h4 class="sect4">Opening a Software Keystore</h4>
<div>
<p>To open a software keystore, you must use the <code class="codeph">ADMINISTER KEY MANAGEMENT</code> statement with the <code class="codeph">SET KEYSTORE OPEN</code> clause.</p>
<ol>
<li class="stepexpand"><span>Ensure that you complete the procedure described in <a href="configuring-transparent-data-encryption.htm#GUID-F098129B-BBFF-4C86-B119-80AB706DB2A1" title="After you have specified a directory location for the software keystore, you can create the keystore.">Step 2: Create the Software Keystore</a>.</span></li>
<li class="stepexpand"><span>Log in to the database instance as a user who has been granted the <code class="codeph">ADMINISTER KEY MANAGEMENT</code> or <code class="codeph">SYSKM</code> privilege.</span>
<div>
<p>In a multitenant environment, you must open the keystore first in the root before you can open it in a PDB. For example, to log in to the root:</p>
<pre dir="ltr">sqlplus c##sec_admin as syskm
Enter password: <span class="italic">password</span>
Connected.
</pre>
<p>To find the available PDBs, query the <code class="codeph">DBA_PDBS</code> data dictionary view. To check the current PDB, run the <code class="codeph">show con_name</code> command.</p>
</div>
</li>
<li class="stepexpand"><span>Run the <code class="codeph">ADMINISTER KEY MANAGEMENT</code> statement.</span>
<div>
<p>Use the following syntax:</p>
<pre dir="ltr">ADMINISTER KEY MANAGEMENT SET KEYSTORE OPEN IDENTIFIED BY <span class="italic">software_keystore_password</span> [CONTAINER = ALL | CURRENT];
</pre>
<p>In this specification:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="italic"><code class="codeph">software_keystore_password</code></span> is the same password that you used to create the keystore in <a href="configuring-transparent-data-encryption.htm#GUID-F098129B-BBFF-4C86-B119-80AB706DB2A1" title="After you have specified a directory location for the software keystore, you can create the keystore.">Step 2: Create the Software Keystore</a>.</p>
</li>
<li>
<p><code class="codeph">CONTAINER</code> is for use in a multitenant environment. Enter <code class="codeph">ALL</code> to set the keystore in all of the PDBs in this CDB, or <code class="codeph">CURRENT</code> for the current PDB.</p>
<p>For example:</p>
<pre dir="ltr">ADMINISTER KEY MANAGEMENT SET KEYSTORE OPEN IDENTIFIED BY <span class="italic">password</span>;

keystore altered.
</pre></li>
</ul>
</div>
</li>
</ol>
<div class="section">
<p>Note that if the keystore is open but you have not created a TDE master encryption key yet (described next), the <code class="codeph">STATUS</code> column of the <code class="codeph">V$ENCRYPTION_WALLET</code> view reminds you with an <code class="codeph">OPEN_NO_MASTER_KEY</code> status.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="ASOAG10288"></a>
<div class="props_rev_3"><a id="GUID-15E41F0A-5D80-4A7A-88F6-30EE86FA44E8"></a>
<h3 class="sect3">Step 4: Set the Software TDE Master Encryption Key</h3>
<div>
<p>Once the keystore is open, you can set a TDE master encryption key for it.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-C44968C5-9B77-4D19-82F4-5705268BF429" title="The TDE master encryption key is stored in the keystore.">About Setting the Software TDE Master Encryption Key</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-9C72F219-B6DC-4F57-B5FC-40F1F4C1EA21" title="To set the TDE master encryption key in a software keystore, use the ADMINISTER KEY MANAGEMENT statement with the SET KEY clause.">Setting the TDE Master Encryption Key in the Software Keystore</a></p>
</li>
</ul>
</div>
<a id="ASOAG10289"></a>
<div class="props_rev_3"><a id="GUID-C44968C5-9B77-4D19-82F4-5705268BF429"></a>
<h4 class="sect4">About Setting the Software TDE Master Encryption Key</h4>
<div>
<p>The TDE master encryption key is stored in the keystore.</p>
<p>This key protects the <a href="glossary.htm#GUID-78CFC3BC-9BDD-406E-A6E2-2374AC636269"><span class="xrefglossterm">TDE table key</span></a>s and <a href="glossary.htm#GUID-5101B9BB-386F-4826-B639-2BE246A66E90"><span class="xrefglossterm">tablespace encryption key</span></a>s. By default, the TDE master encryption key is a key that Transparent Data Encryption (TDE) generates. You can find if a keystore has no master key set or an unknown master key by querying the <code class="codeph">STATUS</code> column of the <code class="codeph">V$ENCRYPTION_WALLET</code> view.</p>
<p>In a multitenant environment, you can create and manage the TDE master encryption key from either the root or the PDB.</p>
<div class="infobox-note" id="GUID-C44968C5-9B77-4D19-82F4-5705268BF429__GUID-75ADEC1D-A684-4F7F-9A26-1E347907E5EE">
<p class="notep1">Note:</p>
<p>You can create TDE master encryption keys for use later on, and then manually activate them. See <a href="managing-keystore-and-tde-master-encryption-key.htm#GUID-EA686044-5B10-4F70-88F2-B45BF1DD1E55" title="You can create a TDE master encryption key that can be activated at a later date.">Creating TDE Master Encryption Keys for Later Use</a> for more information.</p>
</div>
</div>
</div>
<a id="ASOAG10290"></a>
<div class="props_rev_3"><a id="GUID-9C72F219-B6DC-4F57-B5FC-40F1F4C1EA21"></a>
<h4 class="sect4">Setting the TDE Master Encryption Key in the Software Keystore</h4>
<div>
<p>To set the TDE master encryption key in a software keystore, use the <code class="codeph">ADMINISTER KEY MANAGEMENT</code> statement with the <code class="codeph">SET KEY</code> clause.</p>
<div class="section">
<ol>
<li>
<p>For password software keystores, ensure that you complete the procedure described in <a href="configuring-transparent-data-encryption.htm#GUID-37296947-18DB-4CFA-A112-794A55E942E2" title="Depending on the type of keystore you create, you must manually open the keystore before you can use it.">Step 3: Open the Software Keystore</a> to open the key.</p>
<p>Auto-login or local auto-login software keys are opened automatically after you create them. Password-based software keystores must be open before you can set the TDE master encryption key. If the auto-login software keystore is open, then you must close it and open the password-based software keystore. If both the password-based keystore and auto-login keystores are present in the configured location and the password-based keystore is open, then the TDE master encryption key is automatically written to the auto-login keystore as well.</p>
</li>
<li>
<p>Log in to the database instance as a user who has been granted the <code class="codeph">ADMINISTER KEY MANAGEMENT</code> or <code class="codeph">SYSKM</code> privilege.</p>
<p>In a multitenant environment, log in to the root or to the PDB. For example, to log in to a PDB:</p>
<pre dir="ltr">sqlplus sec_admin@hrpdb as syskm
Enter password: <span class="italic">password</span>
Connected.
</pre>
<p>To find the available PDBs, query the <code class="codeph">DBA_PDBS</code> data dictionary view. To check the current PDB, run the <code class="codeph">show con_name</code> command.</p>
</li>
<li>
<p>Ensure that the database is open in <code class="codeph">READ WRITE</code> mode.</p>
<p>You can set the TDE master encryption key if <code class="codeph">OPEN_MODE</code> is set to <code class="codeph">READ WRITE</code>. To find the status, for a non-multitenant environment, query the <code class="codeph">OPEN_MODE</code> column of the <code class="codeph">V$DATABASE</code> dynamic view. If you are using a multitenant environment, then query the <code class="codeph">V$PDBS</code> view. (If you cannot access these views, then connect as <code class="codeph">SYSDBA</code> and try the query again. In order to connect as <code class="codeph">SYSKM</code> for this type of query, you must create a password file for it. See <a class="olink ADMIN11056" target="_blank" href="../ADMIN/dba.htm#ADMIN11056"><span><cite>Oracle Database Administrator&rsquo;s Guide</cite></span></a> for more information.)</p>
</li>
<li>
<p>Connect using the <code class="codeph">SYSKM</code> administrative privilege and then run the <code class="codeph">ADMINISTER KEY MANAGEMENT</code> SQL statement to set the software management keystore.</p>
<pre dir="ltr">ADMINISTER KEY MANAGEMENT SET KEY [USING TAG &#39;<span class="italic">tag</span>&#39;] IDENTIFIED BY <span class="italic">keystore_password</span> [WITH BACKUP [USING &#39;<span class="italic">backup_identifier</span>&#39;]] [CONTAINER = ALL | CURRENT];
</pre>
<p>In this specification:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="italic"><code class="codeph">tag</code></span> is the associated attributes and information that you define. Enclose this setting in single quotation marks (&#39;&nbsp;&#39;).</p>
</li>
<li>
<p><span class="italic"><code class="codeph">password</code></span> is the mandatory keystore password that you created when you created the keystore in <a href="configuring-transparent-data-encryption.htm#GUID-F098129B-BBFF-4C86-B119-80AB706DB2A1" title="After you have specified a directory location for the software keystore, you can create the keystore.">Step 2: Create the Software Keystore</a>.</p>
</li>
<li>
<p><code class="codeph">WITH BACKUP</code> creates a backup of the keystore. You must use this option for password-based keystores. Optionally, you can use the <code class="codeph">USING</code> clause to add a brief description of the backup. Enclose this description in single quotation marks (&#39;&nbsp;&#39;). This identifier is appended to the named keystore file (for example, <code class="codeph">ewallet_</code><span class="italic"><code class="codeph">time_stamp</code></span><code class="codeph">_emp_key_backup.p12</code>, with <code class="codeph">emp_key_backup</code> being the backup identifier). Follow the file naming conventions that your operating system uses.</p>
</li>
<li>
<p><code class="codeph">CONTAINER</code> is for use in a multitenant environment. Enter <code class="codeph">ALL</code> to set the key in all of the PDBs in this CDB, or <code class="codeph">CURRENT</code> for the current PDB.</p>
</li>
</ul>
<p>For example:</p>
<pre dir="ltr">ADMINISTER KEY MANAGEMENT SET KEY IDENTIFIED BY <span class="italic">keystore_password</span> WITH BACKUP USING &#39;emp_key_backup&#39;;

keystore altered.
</pre></li>
</ol>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="ASOAG10291"></a>
<div class="props_rev_3"><a id="GUID-9D157063-2C48-40AC-8697-0FD1A866F038"></a>
<h3 class="sect3">Step 5: Encrypt Your Data</h3>
<div>
<p>After you complete the software keystore configuration, you can begin to encrypt data.</p>
<div class="section">
<p>You can encrypt data in individual table columns or in entire tablespaces.</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>See the following topics for information about encrypting data:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-A0E2C279-10F6-48D9-AB92-C547529C06EE" title="You can use Transparent Data Encryption to encrypt individual columns in database tables.">Encrypting Columns in Tables</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-1CA947A5-164A-4AA9-AD75-F7D9D4F6FFF8" title="You can perform encryption operations on both offline and online tablespaces and databases.">Encrypting Tablespaces</a></p>
</li>
</ul>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="ASOAG10292"></a>
<div class="props_rev_3"><a id="GUID-753C4808-CC51-4DA1-A5C3-980417FDAB14"></a>
<h2 class="sect2">Configuring a Hardware Keystore</h2>
<div>
<p>A hardware keystore resides in a hardware security module (HSM), which is designed to store encryption keys.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-B2A6A003-BA45-4740-8BA8-308307CACC33" title="A hardware keystore is a separate server or device that provides security storage for encryption keys.">About Configuring a Hardware (External) Keystore</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-3F97FA3A-75D6-47BB-9678-72F34392983C" title="Before you can configure a hardware keystore, you must modify the sqlnet.ora file.">Step 1: Set the Hardware Keystore Type in the sqlnet.ora File</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-7838C4B8-FF6A-4B81-86C1-8583D3555291" title="To configure a third-party hardware security module, you must copy the PKCS#11 library to the correct location and follow your vendor&#39;s instructions.">Step 2: Configure the Hardware Security Module</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-4FBC5088-A045-4306-88C0-FEBC07CA18AC" title="After you have configured the hardware security module, you must open the hardware keystore before it can be used.">Step 3: Open the Hardware Keystore</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-96BEF7DD-2B37-48F2-9651-38059DE499C5" title="After you have opened the hardware keystore, you are ready to set the hardware keystore TDE master encryption key.">Step 4: Set the Hardware Keystore TDE Master Encryption Key</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-34017F99-A5AC-46BF-828A-1EBDF51A796D" title="After you have completed the hardware keystore configuration, you can begin to encrypt data.">Step 5: Encrypt Your Data</a></p>
</li>
</ul>
</div>
<a id="ASOAG10293"></a>
<div class="props_rev_3"><a id="GUID-B2A6A003-BA45-4740-8BA8-308307CACC33"></a>
<h3 class="sect3">About Configuring a Hardware (External) Keystore</h3>
<div>
<p>A hardware keystore is a separate server or device that provides security storage for encryption keys.</p>
<p>External keystores are external to an Oracle database. Oracle Database can interface with external keystores but cannot manipulate them outside of the Oracle interface. The Oracle database can request the external keystore to create a key but it cannot define how this key is stored in an external database. (Conversely, for software keystores that are created using TDE, Oracle Database has full control: that is, you can use SQL statements to manipulate this type of keystore.) Examples of external keystores are hardware security modules or Oracle Key Vault keystores. External keystores among multiple databases can be managed centrally, such as with Oracle Key Vault.</p>
<p>To configure a keystore for a hardware security module (hardware keystore), you must first include the keystore type in the <code class="codeph">sqlnet.ora</code> file, configure and open the hardware keystore, and then set the hardware keystore TDE master encryption key. In short, there is one hardware keystore per database, and the database locates this keystore by checking the keystore type that you define in the <code class="codeph">sqlnet.ora</code> file.</p>
<p>After you configure the hardware keystore, you are ready to begin encrypting your data.</p>
</div>
</div>
<a id="ASOAG10294"></a>
<div class="props_rev_3"><a id="GUID-3F97FA3A-75D6-47BB-9678-72F34392983C"></a>
<h3 class="sect3">Step 1: Set the Hardware Keystore Type in the sqlnet.ora File</h3>
<div>
<p>Before you can configure a hardware keystore, you must modify the <code class="codeph">sqlnet.ora</code> file.</p>
<div class="section">
<p>By default, this file is located in the <span class="italic"><code class="codeph">ORACLE_HOME</code></span><code class="codeph">dbs</code> directory or in the location set by the <code class="codeph">TNS_ADMIN</code> environment variable.</p>
<ul style="list-style-type: disc;">
<li>
<p>Use the following setting in the <code class="codeph">sqlnet.ora</code> file to define the hardware keystore type, which is <code class="codeph">HSM</code>.</p>
<pre dir="ltr">ENCRYPTION_WALLET_LOCATION=
 (SOURCE=
  (METHOD=<span class="bold">HSM</span>))
</pre></li>
</ul>
<div class="infoboxnotealso" id="GUID-3F97FA3A-75D6-47BB-9678-72F34392983C__GUID-25F23B95-C74B-41A7-935B-7C3BB831C58A">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-DF9504EF-BA08-4585-895D-2E5F4BA30E50" title="Oracle Database checks the sqlnet.ora file for the directory location of the keystore, whether it is a software keystore, a hardware module security (HSM) keystore, or an Oracle Key Vault keystore.">About the Keystore Location in the sqlnet.ora File</a> for more information about how Oracle Database finds the keystore location</p>
</li>
<li>
<p><a href="managing-keystore-and-tde-master-encryption-key.htm#GUID-4335220F-49FF-40BC-9EB0-21442608F436" title="You can migrate between password-based software keystores and hardware keystores.">Migrating Between a Software Password Keystore and a Hardware Keystore</a> for information about how to configure the <code class="codeph">sqlnet.ora</code> file for migration between these two keystore types</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ASOAG10295"></a>
<div class="props_rev_3"><a id="GUID-7838C4B8-FF6A-4B81-86C1-8583D3555291"></a>
<h3 class="sect3">Step 2: Configure the Hardware Security Module</h3>
<div>
<p>To configure a third-party hardware security module, you must copy the PKCS#11 library to the correct location and follow your vendor&#39;s instructions.</p>
<div class="section">
<ol>
<li>
<p>Ensure that you complete the procedure described in <a href="configuring-transparent-data-encryption.htm#GUID-3F97FA3A-75D6-47BB-9678-72F34392983C" title="Before you can configure a hardware keystore, you must modify the sqlnet.ora file.">Step 1: Set the Hardware Keystore Type in the sqlnet.ora File</a>.</p>
</li>
<li>
<p>Copy the PKCS#11 library to its correct path.</p>
<p>Your hardware security module vendor should provide you with an associated PKCS#11 library. Only one PKCS#11 library is supported at a time. If you want to use an HSM from a new vendor, then you must replace the PKCS#11 library from the earlier vendor with the library from the new vendor.</p>
<p>Copy this library to the appropriate location to ensure that Oracle Database can find this library:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">UNIX systems:</span> Use the following syntax to copy the library to this directory:</p>
<pre dir="ltr">/opt/oracle/extapi/[32,64]/hsm/{<span class="italic">VENDOR</span>}/{<span class="italic">VERSION</span>}/lib<span class="italic">apiname.</span>so
</pre></li>
<li>
<p><span class="bold">Windows systems:</span> Use the following syntax to copy the library to this directory:</p>
<pre dir="ltr"><span class="italic">%SYSTEM_DRIVE%</span>\oracle\extapi\[32,64]\hsm\{<span class="italic">VENDOR</span>}\{<span class="italic">VERSION</span>}\lib<span class="italic">apiname.</span>dll
</pre></li>
</ul>
<p>In this specification:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">[32,64]</code> specifies whether the supplied binary is 32 bits or 64 bits.</p>
</li>
<li>
<p><span class="italic"><code class="codeph">VENDOR</code></span> stands for the name of the vendor supplying the library</p>
</li>
<li>
<p><span class="italic"><code class="codeph">VERSION</code></span> refers to the version of the library. This should preferably be in the format, <span class="italic"><code class="codeph">number.number.number</code></span></p>
</li>
<li>
<p><span class="italic"><code class="codeph">apiname</code></span> requires no special format. However, the <span class="italic"><code class="codeph">apiname</code></span> must be prefixed with the word <code class="codeph">lib</code>, as illustrated in the syntax.</p>
</li>
</ul>
</li>
<li id="GUID-7838C4B8-FF6A-4B81-86C1-8583D3555291__CIHHFABB">
<p>Follow your vendor&#39;s instructions to set up the hardware security module.</p>
<p>Use your hardware security module management interface and the instructions provided by your HSM vendor to set up the hardware security module. Create the user account and password that must be used by the database to interact with the hardware security module. This process creates and configures a hardware keystore that communicates with your Oracle database.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="ASOAG10296"></a>
<div class="props_rev_3"><a id="GUID-4FBC5088-A045-4306-88C0-FEBC07CA18AC"></a>
<h3 class="sect3">Step 3: Open the Hardware Keystore</h3>
<div>
<p>After you have configured the hardware security module, you must open the hardware keystore before it can be used.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-CEDB143A-BC7E-43EF-AD41-59BD0ED36421" title="You must open the hardware keystore so that it is accessible to the database before you can perform any encryption or decryption.">About Opening the Hardware Keystore</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-81E6D2BA-EE27-4D35-96FB-2FFC0BCD396B">Opening the Hardware Keystore</a></p>
</li>
</ul>
</div>
<a id="ASOAG10297"></a>
<div class="props_rev_3"><a id="GUID-CEDB143A-BC7E-43EF-AD41-59BD0ED36421"></a>
<h4 class="sect4">About Opening the Hardware Keystore</h4>
<div>
<p>You must open the hardware keystore so that it is accessible to the database before you can perform any encryption or decryption.</p>
<p>You can check the status of whether a keystore is open, closed, open but with no TDE master encryption key, or open but with an unknown master encryption key by querying the <code class="codeph">STATUS</code> column of the <code class="codeph">V$ENCRYPTION_WALLET</code> view.</p>
<div class="infoboxnotealso" id="GUID-CEDB143A-BC7E-43EF-AD41-59BD0ED36421__GUID-0F95BB43-FEF6-4222-BBD7-E51F4EE370B7">
<p class="notep1">See Also:</p>
<p><a href="using-transparent-data-encryption-with-other-oracle-features.htm#GUID-75855CB2-3FBC-41E4-BC89-8EA2078E633E" title="You should be aware of how keystore open and close operations work in a multitenant environment.">How Keystore Open and Close Operations Work in a Multitenant Environment</a></p>
</div>
</div>
</div>
<a id="ASOAG10298"></a>
<div class="props_rev_3"><a id="GUID-81E6D2BA-EE27-4D35-96FB-2FFC0BCD396B"></a>
<h4 class="sect4">Opening the Hardware Keystore</h4>
<div>
<div class="section">
<p>To open a hardware keystore, use the <code class="codeph">ADMINISTER KEY MANAGEMENT</code> statement with the <code class="codeph">SET KEYSTORE OPEN</code> clause.</p>
</div>
<!-- class="section" -->
<div class="section">
<ol>
<li>
<p>Ensure that you complete the procedure described in <a href="configuring-transparent-data-encryption.htm#GUID-7838C4B8-FF6A-4B81-86C1-8583D3555291" title="To configure a third-party hardware security module, you must copy the PKCS#11 library to the correct location and follow your vendor&#39;s instructions.">Step 2: Configure the Hardware Security Module</a>.</p>
</li>
<li>
<p>Log in to the database instance as a user who has been granted the <code class="codeph">ADMINISTER KEY MANAGEMENT</code> or <code class="codeph">SYSKM</code> privilege.</p>
<p>In a multitenant environment, you must open the keystore first in the root before you can open it in a PDB. For example, to log in to the root:</p>
<pre dir="ltr">sqlplus sec_admin as syskm
Enter password: <span class="italic">password</span>
Connected.
</pre>
<p>To find the available PDBs, query the <code class="codeph">DBA_PDBS</code> data dictionary view. To check the current PDB, run the <code class="codeph">show con_name</code> command.</p>
<p>If SQL*Plus is already open and you had modified the <code class="codeph">sqlnet.ora</code> file during this time, then reconnect to SQL*Plus. The database session must be changed before the <code class="codeph">sqlnet.ora</code> changes can take effect.</p>
</li>
<li>
<p>Run the <code class="codeph">ADMINISTER KEY MANAGEMENT</code> SQL statement using the following syntax:</p>
<pre dir="ltr">ADMINISTER KEY MANAGEMENT SET KEYSTORE OPEN IDENTIFIED BY &#34;<span class="italic">user_id</span>:<span class="italic">password</span>&#34; [CONTAINER = ALL | CURRENT];
</pre>
<p>In this specification:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="italic"><code class="codeph">user_id</code></span> is the user ID created for the database using the HSM management interface</p>
</li>
<li>
<p><span class="italic"><code class="codeph">password</code></span> is the password created for the user ID using the HSM management interface.</p>
<p>Enclose the <span class="italic"><code class="codeph">user_id:password</code></span> string in double quotation marks (&#34; &#34;) and separate <span class="italic"><code class="codeph">user_id</code></span> and <span class="italic"><code class="codeph">password</code></span> with a colon (<code class="codeph">:</code>).</p>
</li>
<li>
<p><code class="codeph">CONTAINER</code> is for use in a multitenant environment. Enter <code class="codeph">ALL</code> to set the keystore in all of the PDBs in this CDB, or <code class="codeph">CURRENT</code> for the current PDB.</p>
</li>
</ul>
<p>For example:</p>
<pre dir="ltr">ADMINISTER KEY MANAGEMENT SET KEYSTORE OPEN IDENTIFIED BY &#34;psmith:<span class="italic">password</span>&#34;;

keystore altered.
</pre></li>
<li>
<p>Repeat this procedure each time you restart the database instance.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="ASOAG10299"></a>
<div class="props_rev_3"><a id="GUID-96BEF7DD-2B37-48F2-9651-38059DE499C5"></a>
<h3 class="sect3">Step 4: Set the Hardware Keystore TDE Master Encryption Key</h3>
<div>
<p>After you have opened the hardware keystore, you are ready to set the hardware keystore TDE master encryption key.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-E3DC7C57-A8F3-41D5-98FB-1DBE6EE10D1E" title="You must create a TDE master encryption key that is stored inside the hardware keystore.">About Setting the Hardware Keystore TDE Master Encryption Key</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-6781E98E-F59C-420E-AC7E-8CC57D33E706" title="You should complete this procedure if you have not previously configured a software keystore for Transparent Data Encryption.">Setting a TDE Master Encryption Key if You Have Not Previously Configured One</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-5CDB2D10-81DE-4C98-9F9C-155C45E31CDB" title="You must migrate the previously configured TDE master encryption key if you previously configured a software keystore.">Migration of a Previously Configured TDE Master Encryption Key</a></p>
</li>
</ul>
</div>
<a id="ASOAG10502"></a>
<div class="props_rev_3"><a id="GUID-E3DC7C57-A8F3-41D5-98FB-1DBE6EE10D1E"></a>
<h4 class="sect4">About Setting the Hardware Keystore TDE Master Encryption Key</h4>
<div>
<p>You must create a TDE master encryption key that is stored inside the hardware keystore.</p>
<p>Oracle Database uses the TDE master encryption key to encrypt or decrypt <a href="glossary.htm#GUID-78CFC3BC-9BDD-406E-A6E2-2374AC636269"><span class="xrefglossterm">TDE table key</span></a>s or <a href="glossary.htm#GUID-5101B9BB-386F-4826-B639-2BE246A66E90"><span class="xrefglossterm">tablespace encryption key</span></a>s inside the hardware security module.</p>
<p>If you have not previously configured a software keystore for Transparent Data Encryption, then follow the steps in <a href="configuring-transparent-data-encryption.htm#GUID-6781E98E-F59C-420E-AC7E-8CC57D33E706" title="You should complete this procedure if you have not previously configured a software keystore for Transparent Data Encryption.">Setting a TDE Master Encryption Key if You Have Not Previously Configured One</a>. If you have already configured a software keystore for TDE, then you must migrate it to the hardware security module, as described in <a href="configuring-transparent-data-encryption.htm#GUID-5CDB2D10-81DE-4C98-9F9C-155C45E31CDB" title="You must migrate the previously configured TDE master encryption key if you previously configured a software keystore.">Migration of a Previously Configured TDE Master Encryption Key</a>.</p>
<p>Along with the current TDE master key, Oracle wallets maintain historical TDE master keys that are generated after every re-key operation that rotates the TDE master key. These historical TDE master keys help to restore Oracle database backups that were taken previously using one of the historical TDE master keys.</p>
</div>
</div>
<a id="ASOAG10503"></a>
<div class="props_rev_3"><a id="GUID-6781E98E-F59C-420E-AC7E-8CC57D33E706"></a>
<h4 class="sect4">Setting a TDE Master Encryption Key if You Have Not Previously Configured One</h4>
<div>
<p>You should complete this procedure if you have not previously configured a software keystore for Transparent Data Encryption.</p>
<div class="section">
<p>In a multitenant environment, you can create and manage the TDE master encryption key from either the root or the PDB.</p>
<div class="infobox-note" id="GUID-6781E98E-F59C-420E-AC7E-8CC57D33E706__GUID-92EEECC6-B0B3-4D20-8A86-43FB4E6F5B4A">
<p class="notep1">Note:</p>
<p>You can create TDE master encryption keys for use later on, and then manually activate them. See <a href="managing-keystore-and-tde-master-encryption-key.htm#GUID-EA686044-5B10-4F70-88F2-B45BF1DD1E55" title="You can create a TDE master encryption key that can be activated at a later date.">Creating TDE Master Encryption Keys for Later Use</a> for more information.</p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<ol>
<li>
<p>Ensure that you complete the procedure described in <a href="configuring-transparent-data-encryption.htm#GUID-4FBC5088-A045-4306-88C0-FEBC07CA18AC" title="After you have configured the hardware security module, you must open the hardware keystore before it can be used.">Step 3: Open the Hardware Keystore</a>.</p>
</li>
<li>
<p>Log in to the database instance as a user who has been granted the <code class="codeph">ADMINISTER KEY MANAGEMENT</code> or <code class="codeph">SYSKM</code> privilege.</p>
<p>In a multitenant environment, log in to the root or to the PDB. For example:</p>
<pre dir="ltr">sqlplus sec_admin@hrpdb as syskm
Enter password: <span class="italic">password</span>
Connected.
</pre>
<p>To find the available PDBs, query the <code class="codeph">DBA_PDBS</code> data dictionary view. To check the current PDB, run the <code class="codeph">show con_name</code> command.</p>
</li>
<li>
<p>Ensure that the database is open in <code class="codeph">READ WRITE</code> mode.</p>
<p>You can set the TDE master encryption key if <code class="codeph">OPEN_MODE</code> is set to <code class="codeph">READ WRITE</code>. To find the status, for a non-multitenant environment, query the <code class="codeph">OPEN_MODE</code> column of the <code class="codeph">V$DATABASE</code> dynamic view. If you are in a multitenant environment, then query the <code class="codeph">V$PDBS</code> view. (If you cannot access these views, then connect as <code class="codeph">SYSDBA</code> and try the query again. In order to connect as <code class="codeph">SYSKM</code> for this type of query, you must create a password file for it. See <a class="olink ADMIN11056" target="_blank" href="../ADMIN/dba.htm#ADMIN11056"><span><cite>Oracle Database Administrator&rsquo;s Guide</cite></span></a> for more information.)</p>
</li>
<li>
<p>Run the following SQL statement:</p>
<pre dir="ltr">ADMINISTER KEY MANAGEMENT SET KEY [USING TAG &#39;<span class="italic">tag</span>&#39;] [FORCE KEYSTORE] IDENTIFIED BY [EXTERNAL STORE | &#34;<span class="italic">user_id</span>:<span class="italic">password</span>&#34;] [CONTAINER = ALL | CURRENT];
</pre>
<p>In this specification:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="italic"><code class="codeph">tag</code></span> is the associated attributes and information that you define. Enclose this setting in single quotation marks (&#39; &#39;).</p>
</li>
<li>
<p><code class="codeph">FORCE KEYSTORE</code> enables the keystore operation if the keystore is closed.</p>
</li>
<li>
<p><code class="codeph">IDENTIFIED BY</code> can be one of the following settings:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">EXTERNAL STORE</code> uses the keystore password stored in the external store to perform the keystore operation.</p>
</li>
<li>
<p><code class="codeph"><span class="codeinlineitalic">user_id</span>:<span class="codeinlineitalic">password</span></code>: <span class="italic"><code class="codeph">user_id</code></span> is the user ID created for the hardware keystore; <span class="italic"><code class="codeph">password</code></span> is the password created for the hardware keystore. Enclose the <span class="italic"><code class="codeph">user_id:password</code></span> string in double quotation marks (&#34; &#34;) and separate <span class="italic"><code class="codeph">user_id</code></span> and <span class="italic"><code class="codeph">password</code></span> with a colon (<code class="codeph">:</code>).</p>
</li>
</ul>
</li>
<li>
<p><code class="codeph">CONTAINER</code> is for use in a multitenant environment. Enter <code class="codeph">ALL</code> to set the keystore in all of the PDBs in this CDB, or <code class="codeph">CURRENT</code> for the current PDB.</p>
</li>
</ul>
<p>For example:</p>
<pre dir="ltr">ADMINISTER KEY MANAGEMENT SET KEY IDENTIFIED BY &#34;psmith:<span class="italic">password</span>&#34;;

keystore altered.
</pre></li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="ASOAG10504"></a>
<div class="props_rev_3"><a id="GUID-5CDB2D10-81DE-4C98-9F9C-155C45E31CDB"></a>
<h4 class="sect4">Migration of a Previously Configured TDE Master Encryption Key</h4>
<div>
<p>You must migrate the previously configured TDE master encryption key if you previously configured a software keystore.</p>
<p>Tools such as Oracle Data Pump and Oracle Recovery Manager require access to the old software keystore to perform decryption and encryption operations on data exported or backed up using the software keystore. You can migrate from the software to the hardware keystore by following the instructions in <a href="managing-keystore-and-tde-master-encryption-key.htm#GUID-4335220F-49FF-40BC-9EB0-21442608F436" title="You can migrate between password-based software keystores and hardware keystores.">Migrating Between a Software Password Keystore and a Hardware Keystore</a>.</p>
<p>Along with the current TDE master key, Oracle wallets maintain historical TDE master keys that are generated after every re-key operation that rotates the TDE master key. These historical TDE master keys help to restore Oracle database backups that were taken previously using one of the historical TDE master keys.</p>
</div>
</div>
</div>
<a id="ASOAG10301"></a>
<div class="props_rev_3"><a id="GUID-34017F99-A5AC-46BF-828A-1EBDF51A796D"></a>
<h3 class="sect3">Step 5: Encrypt Your Data</h3>
<div>
<p>After you have completed the hardware keystore configuration, you can begin to encrypt data.</p>
<div class="section">
<p>You can encrypt individual columns in a table or entire tablespaces.</p>
<ul style="list-style-type: disc;">
<li>
<p>See the following topics for more information about encrypting data:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-A0E2C279-10F6-48D9-AB92-C547529C06EE" title="You can use Transparent Data Encryption to encrypt individual columns in database tables.">Encrypting Columns in Tables</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-1CA947A5-164A-4AA9-AD75-F7D9D4F6FFF8" title="You can perform encryption operations on both offline and online tablespaces and databases.">Encrypting Tablespaces</a></p>
</li>
</ul>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="ASOAG10143"></a>
<div class="props_rev_3"><a id="GUID-A0E2C279-10F6-48D9-AB92-C547529C06EE"></a>
<h2 class="sect2">Encrypting Columns in Tables</h2>
<div>
<p>You can use Transparent Data Encryption to encrypt individual columns in database tables.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-86FCB830-28B8-4F7C-97B6-EB80B20D8752" title="You can encrypt individual columns in tables.">About Encrypting Columns in Tables</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-E9DFE595-0119-4189-84AD-19FFE5683CC6" title="Oracle Database supports a specific set of data types that can be used with TDE column encryption.">Data Types That Can Be Encrypted with TDE Column Encryption</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-9A78E72B-D9D9-4BA2-BFEF-11C0060B6F91" title="TDE encrypts at the SQL layer. Oracle Database utilities that bypass the SQL layer cannot use the TDE column encryption services.">Restrictions on Using Transparent Data Encryption Column Encryption</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-FC8D6E7E-CD47-4972-89B4-E90CB8A811AA" title="You can create new tables that have encrypted columns. Oracle Database provides a selection of different algorithms that you can use to definite the encryption.">Creating Tables with Encrypted Columns</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-613F7E02-EA77-4CF4-9683-A0344DF724D0" title="You can encrypt columns in existing tables. As with new tables, you have a choice of different algorithms to use to definite the encryption.">Encrypting Columns in Existing Tables</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-9E4EC0E4-A395-4C79-B841-CB13BDE41B4C" title="You can create an index on an encrypted column.">Creating an Index on an Encrypted Column</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-3A298444-09BB-409E-94E5-1FA5FFA89A1D" title="Salt, which is a random string added to data before encryption, is a way to strengthen the security of encrypted data. .">Adding Salt to an Encrypted Column</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-F1C34179-BE14-4966-82B7-97904AB4CF44" title="You can use the ALTER TABLE SQL statement to remove salt from an encrypted column.">Removing Salt from an Encrypted Column</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-2931A16D-84E8-4A42-8D01-662FD693A711" title="You can use the ALTER TABLE SQL statement to change the encryption key or algorithm used in encrypted columns.">Changing the Encryption Key or Algorithm for Tables with Encrypted Columns</a></p>
</li>
</ul>
</div>
<a id="ASOAG10302"></a>
<div class="props_rev_3"><a id="GUID-86FCB830-28B8-4F7C-97B6-EB80B20D8752"></a>
<h3 class="sect3">About Encrypting Columns in Tables</h3>
<div>
<p>You can encrypt individual columns in tables.</p>
<p>Whether you choose to encrypt individual columns or entire tablespaces depends on the data types that the table has. There are also several features that do not support TDE column encryption.</p>
<div class="infoboxnotealso" id="GUID-86FCB830-28B8-4F7C-97B6-EB80B20D8752__ORACLEDATABASESECURITYGUIDEFORMOREI-28E6F4F2">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-E9DFE595-0119-4189-84AD-19FFE5683CC6" title="Oracle Database supports a specific set of data types that can be used with TDE column encryption.">Data Types That Can Be Encrypted with TDE Column Encryption</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-9A78E72B-D9D9-4BA2-BFEF-11C0060B6F91" title="TDE encrypts at the SQL layer. Oracle Database utilities that bypass the SQL layer cannot use the TDE column encryption services.">Restrictions on Using Transparent Data Encryption Column Encryption</a></p>
</li>
</ul>
</div>
</div>
</div>
<a id="ASOAG10158"></a><a id="ASOAG9579"></a>
<div class="props_rev_3"><a id="GUID-E9DFE595-0119-4189-84AD-19FFE5683CC6"></a>
<h3 class="sect3">Data Types That Can Be Encrypted with TDE Column Encryption</h3>
<div>
<p>Oracle Database supports a specific set of data types that can be used with TDE column encryption.</p>
<div class="section">
<p>You can encrypt data columns that use a variety of different data types.</p>
<p>Supported data types are as follows:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">BINARY_DOUBLE</code></p>
</li>
<li>
<p><code class="codeph">BINARY_FLOAT</code></p>
</li>
<li>
<p><code class="codeph">CHAR</code></p>
</li>
<li>
<p><code class="codeph">DATE</code></p>
</li>
<li>
<p><code class="codeph">INTERVAL DAY TO SECOND</code></p>
</li>
<li>
<p><code class="codeph">INTERVAL YEAR TO MONTH</code></p>
</li>
<li>
<p><code class="codeph">NCHAR</code></p>
</li>
<li>
<p><code class="codeph">NUMBER</code></p>
</li>
<li>
<p><code class="codeph">NVARCHAR2</code></p>
</li>
<li>
<p><code class="codeph">RAW</code> (legacy or extended)</p>
</li>
<li>
<p><code class="codeph">TIMESTAMP</code> (includes <code class="codeph">TIMESTAMP WITH TIME ZONE</code> and <code class="codeph">TIMESTAMP WITH LOCAL TIME ZONE</code>)</p>
</li>
<li>
<p><code class="codeph">VARCHAR2</code> (legacy or extended)</p>
</li>
</ul>
<p>You cannot encrypt a column if the encrypted column size is greater than the size allowed by the data type of the column.</p>
<p><a href="configuring-transparent-data-encryption.htm#GUID-E9DFE595-0119-4189-84AD-19FFE5683CC6__CJAIDCFJ" title="Data types and sizes">Table 3-1</a> shows the maximum allowable sizes for various data types.</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-E9DFE595-0119-4189-84AD-19FFE5683CC6__CJAIDCFJ">
<p class="titleintable">Table 3-1 Maximum Allowable Size for Data Types</p>
<table class="cellalignment5391" title="Maximum Allowable Size for Data Types" summary="Data types and sizes">
<thead>
<tr class="cellalignment5373">
<th class="cellalignment5412" id="d4983e4100">Data Type</th>
<th class="cellalignment5413" id="d4983e4103">Maximum Size</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment5373">
<td class="cellalignment5414" id="d4983e4108" headers="d4983e4100">
<p><code class="codeph">CHAR</code></p>
</td>
<td class="cellalignment5415" headers="d4983e4108 d4983e4103">
<p>1932 bytes</p>
</td>
</tr>
<tr class="cellalignment5373">
<td class="cellalignment5414" id="d4983e4116" headers="d4983e4100">
<p><code class="codeph">VARCHAR2</code> (legacy)</p>
</td>
<td class="cellalignment5415" headers="d4983e4116 d4983e4103">
<p>3932 bytes</p>
</td>
</tr>
<tr class="cellalignment5373">
<td class="cellalignment5414" id="d4983e4125" headers="d4983e4100">
<p><code class="codeph">VARCHAR2</code> (extended)</p>
</td>
<td class="cellalignment5415" headers="d4983e4125 d4983e4103">
<p>32,699 bytes</p>
</td>
</tr>
<tr class="cellalignment5373">
<td class="cellalignment5414" id="d4983e4134" headers="d4983e4100">
<p><code class="codeph">NVARCHAR2</code> (legacy)</p>
</td>
<td class="cellalignment5415" headers="d4983e4134 d4983e4103">
<p>1966 bytes</p>
</td>
</tr>
<tr class="cellalignment5373">
<td class="cellalignment5414" id="d4983e4143" headers="d4983e4100">
<p><code class="codeph">NVARCHAR2</code> (extended)</p>
</td>
<td class="cellalignment5415" headers="d4983e4143 d4983e4103">
<p>16,315 bytes</p>
</td>
</tr>
<tr class="cellalignment5373">
<td class="cellalignment5414" id="d4983e4152" headers="d4983e4100">
<p><code class="codeph">NCHAR</code></p>
</td>
<td class="cellalignment5415" headers="d4983e4152 d4983e4103">
<p>966 bytes</p>
</td>
</tr>
<tr class="cellalignment5373">
<td class="cellalignment5414" id="d4983e4160" headers="d4983e4100">
<p><code class="codeph">RAW</code> (extended)</p>
</td>
<td class="cellalignment5415" headers="d4983e4160 d4983e4103">
<p>32,699 bytes</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<div class="infobox-note" id="GUID-E9DFE595-0119-4189-84AD-19FFE5683CC6__GUID-3B5429F4-360E-415D-8E11-19A5B8AC079B">
<p class="notep1">Note:</p>
<p>TDE tablespace encryption does not have these data type restrictions. See <a href="configuring-transparent-data-encryption.htm#GUID-1CA947A5-164A-4AA9-AD75-F7D9D4F6FFF8" title="You can perform encryption operations on both offline and online tablespaces and databases.">Encrypting Tablespaces</a> for more information.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ASOAG9518"></a>
<div class="props_rev_3"><a id="GUID-9A78E72B-D9D9-4BA2-BFEF-11C0060B6F91"></a>
<h3 class="sect3">Restrictions on Using Transparent Data Encryption Column Encryption</h3>
<div>
<p>TDE encrypts at the SQL layer. Oracle Database utilities that bypass the SQL layer cannot use the TDE column encryption services.</p>
<p>Do not use TDE column encryption with the following database features:</p>
<ul style="list-style-type: disc;">
<li>
<p>Index types other than B-tree</p>
</li>
<li>
<p>Range scan search through an index</p>
</li>
<li>
<p>Synchronous change data capture</p>
</li>
<li>
<p>Transportable tablespaces</p>
</li>
</ul>
<p>In addition, you cannot use TDE column encryption to encrypt columns used in foreign key constraints.</p>
<p>Applications that must use these unsupported features can use the <code class="codeph">DBMS_CRYPTO</code> PL/SQL package for their encryption needs.</p>
<p>Transparent Data Encryption protects data stored on a disk or other media. It does not protect data in transit. Use the network encryption solutions discussed in <a class="olink DBSEG451" target="_blank" href="../DBSEG/asotools.htm#DBSEG451"><span><cite>Oracle Database Security Guide</cite></span></a> to encrypt data over the network.</p>
<div class="infoboxnotealso" id="GUID-9A78E72B-D9D9-4BA2-BFEF-11C0060B6F91__GUID-03ECA205-4F0A-4D57-9B37-5F2FE66E1D84">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="using-transparent-data-encryption-with-other-oracle-features.htm#GUID-15CB716C-74A5-42E5-9BCA-7EC9C9FFA712" title="You can use Oracle Data Pump to export and import tables that contain encrypted columns, as well as encrypt entire dump sets.">How Transparent Data Encryption Works with Export and Import Operations</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-E9DFE595-0119-4189-84AD-19FFE5683CC6" title="Oracle Database supports a specific set of data types that can be used with TDE column encryption.">Data Types That Can Be Encrypted with TDE Column Encryption</a></p>
</li>
<li>
<p><a class="olink ARPLS65670" target="_blank" href="../ARPLS/d_crypto.htm#ARPLS65670"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about the <code class="codeph">DBMS_CRYPTO</code> PL/SQL package</p>
</li>
<li>
<p><a class="olink SQLRF01402" target="_blank" href="../SQLRF/statements_7002.htm#SQLRF01402"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for more information about identity columns, which are created with the <code class="codeph">CREATE TABLE</code> statement</p>
</li>
</ul>
</div>
</div>
</div>
<a id="ASOAG9529"></a>
<div class="props_rev_3"><a id="GUID-FC8D6E7E-CD47-4972-89B4-E90CB8A811AA"></a>
<h3 class="sect3">Creating Tables with Encrypted Columns</h3>
<div>
<p>You can create new tables that have encrypted columns. Oracle Database provides a selection of different algorithms that you can use to definite the encryption.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-F2EECC3A-0AEC-48B7-8EC9-8CA829146A6B" title="You can use the CREATE TABLE SQL statement to create a table with an encrypted column.">About Creating Tables with Encrypted Columns</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-5235D492-19CB-4E23-80A0-68030C7D5C85" title="By default, TDE uses the AES encryption algorithm with a 192-bit key length (AES192).">Creating a Table with an Encrypted Column Using the Default Algorithm</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-F27449B1-AD0D-4F94-8249-EF072584FF68" title="You an use the CREATE TABLE SQL statement to create a table with an encrypted column.">Creating a Table with an Encrypted Column Using No Algorithm or a Non-Default Algorithm</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-0332B6B4-2A41-498A-B584-713E5ED3AB62" title="You can bypass checks that TDE performs. This can save up to 20 bytes of disk space per encrypted value.">Using the NOMAC Parameter to Save Disk Space and Improve Performance</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-DFAB21A7-7024-4A7E-9DFE-B6E667857DA7" title="You can use the CREATE TABLE SQL statement to encrypt a table column using the NOMAC parameter.">Example: Using the NOMAC Parameter in a CREATE TABLE Statement</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-ACAB9AA5-6EC8-4430-A799-54117177CC91" title="You can use the ALTER TABLE SQL statement to change the integrity algorithm for a database table.">Example: Changing the Integrity Algorithm for a Table</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-936CC3D2-8102-454C-AC49-D0126929D738" title="The external table feature enables you to access data in external sources as if the data were in a database table.">Creating an Encrypted Column in an External Table</a></p>
</li>
</ul>
</div>
<a id="ASOAG10375"></a>
<div class="props_rev_3"><a id="GUID-F2EECC3A-0AEC-48B7-8EC9-8CA829146A6B"></a>
<h4 class="sect4">About Creating Tables with Encrypted Columns</h4>
<div>
<p>You can use the <code class="codeph">CREATE TABLE</code> SQL statement to create a table with an encrypted column.</p>
<p>To create relational tables with encrypted columns, you can specify the SQL <code class="codeph">ENCRYPT</code> clause when you define database columns with the <code class="codeph">CREATE TABLE</code> SQL statement.</p>
</div>
</div>
<a id="ASOAG9530"></a>
<div class="props_rev_3"><a id="GUID-5235D492-19CB-4E23-80A0-68030C7D5C85"></a>
<h4 class="sect4">Creating a Table with an Encrypted Column Using the Default Algorithm</h4>
<div>
<p>By default, TDE uses the <code class="codeph">AES</code> encryption algorithm with a 192-bit key length (<code class="codeph">AES192</code>).</p>
<div class="section">
<p>If you encrypt a table column without specifying an algorithm, then the column is encrypted using the <code class="codeph">AES192</code> algorithm.</p>
<p>TDE adds <a href="glossary.htm#GUID-6803F75B-7883-4D0B-B1FF-0084AD65E001"><span class="xrefglossterm">salt</span></a> to plaintext before encrypting it. Adding salt makes it harder for attackers to steal data through a brute force attack. TDE also adds a Message Authentication Code (MAC) to the data for integrity checking. The <code class="codeph">SHA-1</code> integrity algorithm is used by default.</p>
<ul style="list-style-type: disc;">
<li>
<p>To create a table that encrypts a column, use the <code class="codeph">CREATE TABLE</code> SQL statement with the <code class="codeph">ENCRYPT</code> clause.</p>
<p>For example, to encrypt a table column using the default algorithm:</p>
<pre dir="ltr">CREATE TABLE employee (
     first_name VARCHAR2(128),
     last_name VARCHAR2(128),
     empID NUMBER,
     salary NUMBER(6) <span class="bold">ENCRYPT</span>);
</pre>
<p>This example creates a new table with an encrypted column (<code class="codeph">salary</code>). The column is encrypted using the default encryption algorithm (<code class="codeph">AES192</code>). Salt and MAC are added by default. This example assumes that the wallet is open and a master key is set.</p>
</li>
</ul>
<div class="infobox-note" id="GUID-5235D492-19CB-4E23-80A0-68030C7D5C85__GUID-0939699C-0204-41CB-A778-63F344B7DB5A">
<p class="notep1">Note:</p>
<p>If there are multiple encrypted columns in a table, then all of these columns must use the same pair of encryption and integrity algorithms.</p>
<p>Salt is specified at the column level. This means that an encrypted column in a table can choose not to use salt irrespective of whether or not other encrypted columns in the table use salt.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ASOAG9531"></a>
<div class="props_rev_3"><a id="GUID-F27449B1-AD0D-4F94-8249-EF072584FF68"></a>
<h4 class="sect4">Creating a Table with an Encrypted Column Using No Algorithm or a Non-Default Algorithm</h4>
<div>
<p>You an use the <code class="codeph">CREATE TABLE</code> SQL statement to create a table with an encrypted column.</p>
<div class="section">
<p>By default, TDE adds <a href="glossary.htm#GUID-6803F75B-7883-4D0B-B1FF-0084AD65E001"><span class="xrefglossterm">salt</span></a> to plaintext before encrypting it. Adding salt makes it harder for attackers to steal data through a brute force attack. However, if you plan to index the encrypted column, then you must use the <code class="codeph">NO SALT</code> parameter.</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>To create a table that uses an encrypted column that is a non-default algorithm or no algorithm, run the <code class="codeph">CREATE TABLE</code> SQL statement as follows:</p>
<ul style="list-style-type: disc;">
<li>
<p>If you do not want to use any algorithm, then include the <code class="codeph">ENCRYPT NO SALT</code> clause.</p>
</li>
<li>
<p>If you want to use a non-default algorithm, then use the <code class="codeph">ENCRYPT USING</code> clause, followed by one of the following algorithms enclosed in single quotation marks:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">3DES168</code></p>
</li>
<li>
<p><code class="codeph">AES128</code></p>
</li>
<li>
<p><code class="codeph">AES192</code> (default)</p>
</li>
<li>
<p><code class="codeph">AES256</code></p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The following example shows how to specify encryption settings for the <code class="codeph">empID</code> and <code class="codeph">salary</code> columns.</p>
<pre dir="ltr">CREATE TABLE employee (
     first_name VARCHAR2(128),
     last_name VARCHAR2(128),
     empID NUMBER <span class="bold">ENCRYPT NO SALT</span>,
     salary NUMBER(6) <span class="bold">ENCRYPT USING &#39;3DES168&#39;</span>);
</pre>
<p>In this example:</p>
<ul style="list-style-type: disc;">
<li>
<p>The <code class="codeph">empID</code> column is encrypted and does not use salt. Both the <code class="codeph">empID</code> and <code class="codeph">salary</code> columns will use the <code class="codeph">3DES168</code> encryption algorithm, because all of the encrypted columns in a table must use the same encryption algorithm.</p>
</li>
<li>
<p>The <code class="codeph">salary</code> column is encrypted using the <code class="codeph">3DES168</code> encryption algorithm. Note that the string that specifies the algorithm must be enclosed in single quotation marks (&#39; &#39;). The <code class="codeph">salary</code> column uses salt by default.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="ASOAG10146"></a>
<div class="props_rev_3"><a id="GUID-0332B6B4-2A41-498A-B584-713E5ED3AB62"></a>
<h4 class="sect4">Using the NOMAC Parameter to Save Disk Space and Improve Performance</h4>
<div>
<p>You can bypass checks that TDE performs. This can save up to 20 bytes of disk space per encrypted value.</p>
<div class="section">
<p>If the number of rows and encrypted columns in the table is large, then bypassing TDE checks can add up to a significant amount of disk space. In addition, this saves processing cycles and reduces the performance overhead associated with TDE.</p>
<p>TDE uses the <code class="codeph">SHA-1</code> integrity algorithm by default. All of the encrypted columns in a table must use the same integrity algorithm. If you already have a table column using the <code class="codeph">SHA-1</code> algorithm, then you cannot use the <code class="codeph">NOMAC</code> parameter to encrypt another column in the same table.</p>
<ul style="list-style-type: disc;">
<li>
<p>To bypass the integrity check during encryption and decryption operations, use the <code class="codeph">NOMAC</code> parameter in the <code class="codeph">CREATE TABLE</code> and <code class="codeph">ALTER TABLE</code> statements.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-0332B6B4-2A41-498A-B584-713E5ED3AB62__GUID-8FF13576-94B8-4FED-B1B8-DA9579F2FD83">
<p class="notep1">See Also:</p>
<p><a href="general-considerations-of-using-transparent-data-encryption.htm#GUID-2B082CD7-EDDA-4705-9B61-1B1015AB287B" title="The performance of Transparent Data Encryption can vary. There are no storage overheads, but TDE column encryption has some associated storage overhead.">Performance and Storage Overhead of Transparent Data Encryption</a></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ASOAG10147"></a>
<div class="props_rev_3"><a id="GUID-DFAB21A7-7024-4A7E-9DFE-B6E667857DA7"></a>
<h4 class="sect4">Example: Using the NOMAC Parameter in a CREATE TABLE Statement</h4>
<div>
<p>You can use the <span class="apiname">CREATE TABLE</span> SQL statement to encrypt a table column using the <span class="apiname">NOMAC</span> parameter.</p>
<p><a href="configuring-transparent-data-encryption.htm#GUID-DFAB21A7-7024-4A7E-9DFE-B6E667857DA7__CHDGCAIG">Example 3-1</a> creates a table with an encrypted column. The <code class="codeph">empID</code> column is encrypted using the <code class="codeph">NOMAC</code> parameter.</p>
<div class="example" id="GUID-DFAB21A7-7024-4A7E-9DFE-B6E667857DA7__CHDGCAIG">
<p class="titleinexample">Example 3-1 Using the NOMAC parameter in a CREATE TABLE statement</p>
<pre dir="ltr">CREATE TABLE employee (
     first_name VARCHAR2(128),
     last_name VARCHAR2(128),
     empID NUMBER <span class="bold">ENCRYPT &#39;NOMAC&#39;</span> ,
     salary NUMBER(6));
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ASOAG10303"></a>
<div class="props_rev_3"><a id="GUID-ACAB9AA5-6EC8-4430-A799-54117177CC91"></a>
<h4 class="sect4">Example: Changing the Integrity Algorithm for a Table</h4>
<div>
<p>You can use the <span class="apiname">ALTER TABLE</span> SQL statement to change the integrity algorithm for a database table.</p>
<p><a href="configuring-transparent-data-encryption.htm#GUID-ACAB9AA5-6EC8-4430-A799-54117177CC91__CHDDAFEG">Example 3-2</a> shows how to change the integrity algorithm for encrypted columns in a table. The encryption algorithm is set to <code class="codeph">3DES168</code> and the integrity algorithm is set to <code class="codeph">SHA-1</code>. The second <code class="codeph">ALTER TABLE</code> statement sets the integrity algorithm to <code class="codeph">NOMAC</code>.</p>
<div class="example" id="GUID-ACAB9AA5-6EC8-4430-A799-54117177CC91__CHDDAFEG">
<p class="titleinexample">Example 3-2 Changing the Integrity Algorithm for a Table</p>
<pre dir="ltr">ALTER TABLE EMPLOYEE REKEY USING &#39;3DES168&#39; &#39;<span class="bold">SHA-1</span>&#39;;

ALTER TABLE EMPLOYEE REKEY USING &#39;3DES168&#39; &#39;<span class="bold">NOMAC</span>&#39;;
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ASOAG10148"></a><a id="ASOAG9532"></a>
<div class="props_rev_3"><a id="GUID-936CC3D2-8102-454C-AC49-D0126929D738"></a>
<h4 class="sect4">Creating an Encrypted Column in an External Table</h4>
<div>
<p>The external table feature enables you to access data in external sources as if the data were in a database table.</p>
<div class="section">
<p>External tables can be updated using the <code class="codeph">ORACLE_DATAPUMP</code> access driver.</p>
<ul style="list-style-type: disc;">
<li>
<p>To encrypt specific columns in an external table, use the <code class="codeph">ENCRYPT</code> clause when you define those columns:</p>
<p>A system-generated key encrypts the columns. For example, the following <code class="codeph">CREATE TABLE</code> SQL statement encrypts the <code class="codeph">ssn</code> column using the <code class="codeph">3DES168</code> algorithm:</p>
<pre dir="ltr">CREATE TABLE emp_ext (
    first_name,
    ....
    <span class="bold">ssn ENCRYPT USING &#39;3DES168&#39;</span>,
    ....

</pre></li>
</ul>
<p>If you plan to move an external table to a new location, then you cannot use a randomly generated key to encrypt the columns. This is because the randomly generated key will not be available at the new location.</p>
<p>For such scenarios, you should specify a password while you encrypt the columns. After you move the data, you can use the same password to regenerate the key required to access the encrypted column data at the new location.</p>
<p>Table partition exchange also requires a password-based <a href="glossary.htm#GUID-78CFC3BC-9BDD-406E-A6E2-2374AC636269"><span class="xrefglossterm">TDE table key</span></a>.</p>
<p><a href="configuring-transparent-data-encryption.htm#GUID-936CC3D2-8102-454C-AC49-D0126929D738__BABHGEAC">Example 3-3</a> creates an external table using a password to create the <a href="glossary.htm#GUID-78CFC3BC-9BDD-406E-A6E2-2374AC636269"><span class="xrefglossterm">TDE table key</span></a>.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-936CC3D2-8102-454C-AC49-D0126929D738__BABHGEAC">
<p class="titleinexample">Example 3-3 Creating a New External Table with a Password-Generated TDE Table Key</p>
<pre dir="ltr">CREATE TABLE emp_ext (
     first_name,
     last_name,
     empID,
     salary,
     ssn <span class="bold">ENCRYPT IDENTIFIED BY </span><span class="italic"><span class="bold">password</span></span>
)  ORGANIZATION EXTERNAL
   (
    TYPE ORACLE_DATAPUMP
    DEFAULT DIRECTORY &#34;D_DIR&#34;
    LOCATION(&#39;emp_ext.dat&#39;)
    )
    REJECT LIMIT UNLIMITED
AS SELECT * FROM EMPLOYEE;
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<a id="ASOAG9533"></a>
<div class="props_rev_3"><a id="GUID-613F7E02-EA77-4CF4-9683-A0344DF724D0"></a>
<h3 class="sect3">Encrypting Columns in Existing Tables</h3>
<div>
<p>You can encrypt columns in existing tables. As with new tables, you have a choice of different algorithms to use to definite the encryption.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-7BEE47F1-A3FE-4B1D-9744-B8F24E699B01" title="The ALTER TABLE SQL statement enables you to encrypt columns in an existing table.">About Encrypting Columns in Existing Tables</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-2720E333-6335-42CC-935F-35041991D130" title="You can encrypt columns in existing tables, use a different algorithm, and use NO SALT to index the column.">Adding an Encrypted Column to an Existing Table</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-E3CAE9C6-CD38-4854-B53F-F082A41A14F5" title="You can use the ALTER TABLE MODIFY statement to encrypt an existing unencrypted column.">Encrypting an Unencrypted Column</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-49ADF60E-73A2-4672-8494-11F499160AB0" title="You may want to disable encryption for reasons of compatibility or performance.">Disabling Encryption on a Column</a></p>
</li>
</ul>
</div>
<a id="ASOAG10304"></a>
<div class="props_rev_3"><a id="GUID-7BEE47F1-A3FE-4B1D-9744-B8F24E699B01"></a>
<h4 class="sect4">About Encrypting Columns in Existing Tables</h4>
<div>
<p>The <code class="codeph">ALTER TABLE</code> SQL statement enables you to encrypt columns in an existing table.</p>
<p>To add an encrypted column to an existing table, or to encrypt or decrypt an existing column, you use the <code class="codeph">ALTER TABLE</code> SQL statement with the <code class="codeph">ADD</code> or <code class="codeph">MODIFY</code> clause.</p>
</div>
</div>
<a id="ASOAG10149"></a><a id="ASOAG9534"></a>
<div class="props_rev_3"><a id="GUID-2720E333-6335-42CC-935F-35041991D130"></a>
<h4 class="sect4">Adding an Encrypted Column to an Existing Table</h4>
<div>
<p>You can encrypt columns in existing tables, use a different algorithm, and use <code class="codeph">NO SALT</code> to index the column.</p>
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>To add an encrypted column to an existing table, use the <code class="codeph">ALTER TABLE ADD</code> statement, specifying the new column with the <code class="codeph">ENCRYPT</code> clause.</p>
</li>
</ul>
<p><a href="configuring-transparent-data-encryption.htm#GUID-2720E333-6335-42CC-935F-35041991D130__BABEDGDA">Example 3-4</a> adds an encrypted column, <code class="codeph">ssn</code>, to an existing table, called <code class="codeph">employee</code>. The <code class="codeph">ssn</code> column is encrypted with the default <code class="codeph">AES192</code> algorithm. Salt and MAC are added by default.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-2720E333-6335-42CC-935F-35041991D130__BABEDGDA">
<p class="titleinexample">Example 3-4 Adding an Encrypted Column to an Existing Table</p>
<pre dir="ltr">ALTER TABLE employee ADD (ssn VARCHAR2(11) ENCRYPT);
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ASOAG9535"></a>
<div class="props_rev_3"><a id="GUID-E3CAE9C6-CD38-4854-B53F-F082A41A14F5"></a>
<h4 class="sect4">Encrypting an Unencrypted Column</h4>
<div>
<p>You can use the <code class="codeph">ALTER TABLE MODIFY</code> statement to encrypt an existing unencrypted column.</p>
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>To encrypt an existing unencrypted column, use the <code class="codeph">ALTER TABLE MODIFY</code> statement, specifying the unencrypted column with the <code class="codeph">ENCRYPT</code> clause.</p>
</li>
</ul>
<p>The following example encrypts the <code class="codeph">first_name</code> column in the <code class="codeph">employee</code> table. The <code class="codeph">first_name</code> column is encrypted with the default <code class="codeph">AES192</code> algorithm. Salt is added to the data, by default. You can encrypt the column using a different algorithm. If you want to index a column, then you must specify <code class="codeph">NO SALT</code>. You can also bypass integrity checks by using the <code class="codeph">NOMAC</code> parameter.</p>
<pre dir="ltr">ALTER TABLE employee MODIFY (first_name ENCRYPT);
</pre>
<p>The following example encrypts the <code class="codeph">first_name</code> column in the employee table using the <code class="codeph">NOMAC</code> parameter.</p>
<pre dir="ltr">ALTER TABLE employee MODIFY (first_name ENCRYPT &#39;NOMAC&#39;);
</pre></div>
<!-- class="section" --></div>
</div>
<a id="ASOAG10152"></a><a id="ASOAG9536"></a>
<div class="props_rev_3"><a id="GUID-49ADF60E-73A2-4672-8494-11F499160AB0"></a>
<h4 class="sect4">Disabling Encryption on a Column</h4>
<div>
<p>You may want to disable encryption for reasons of compatibility or performance.</p>
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>To disable column encryption, use the <code class="codeph">ALTER TABLE MODIFY</code> command with the <code class="codeph">DECRYPT</code> clause.</p>
</li>
</ul>
<p><a href="configuring-transparent-data-encryption.htm#GUID-49ADF60E-73A2-4672-8494-11F499160AB0__BABHAIFI">Example 3-5</a> decrypts the <code class="codeph">first_name</code> column in the <code class="codeph">employee</code> table.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-49ADF60E-73A2-4672-8494-11F499160AB0__BABHAIFI">
<p class="titleinexample">Example 3-5 Turning Off Column Encryption</p>
<pre dir="ltr">ALTER TABLE employee MODIFY (first_name <span class="bold">DECRYPT</span>);
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<a id="ASOAG10153"></a><a id="ASOAG9537"></a>
<div class="props_rev_3"><a id="GUID-9E4EC0E4-A395-4C79-B841-CB13BDE41B4C"></a>
<h3 class="sect3">Creating an Index on an Encrypted Column</h3>
<div>
<p>You can create an index on an encrypted column.</p>
<div class="section">
<p>The column being indexed must be encrypted without <a href="glossary.htm#GUID-6803F75B-7883-4D0B-B1FF-0084AD65E001"><span class="xrefglossterm">salt</span></a>. If the column is encrypted with salt, then the <code class="codeph">ORA-28338: cannot encrypt indexed column(s) with salt</code> error is raised.</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>To create an index on an encrypted column, use the <code class="codeph">CREATE INDEX</code> statement with the <code class="codeph">ENCRYPT NO SALT</code> clause.</p>
</li>
</ul>
<p><a href="configuring-transparent-data-encryption.htm#GUID-9E4EC0E4-A395-4C79-B841-CB13BDE41B4C__CHDFIGCF">Example 3-6</a> shows how to create an index on a column that has been encrypted without salt.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-9E4EC0E4-A395-4C79-B841-CB13BDE41B4C__CHDFIGCF">
<p class="titleinexample">Example 3-6 Creating Index on a Column Encrypted Without Salt</p>
<pre dir="ltr">CREATE TABLE employee (
   first_name VARCHAR2(128),
   last_name VARCHAR2(128),
   empID NUMBER <span class="bold">ENCRYPT NO SALT</span>,
   salary NUMBER(6) ENCRYPT USING &#39;3DES168&#39;);

CREATE INDEX employee_idx on employee (empID);
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ASOAG9538"></a>
<div class="props_rev_3"><a id="GUID-3A298444-09BB-409E-94E5-1FA5FFA89A1D"></a>
<h3 class="sect3">Adding Salt to an Encrypted Column</h3>
<div>
<p>Salt, which is a random string added to data before encryption, is a way to strengthen the security of encrypted data. .</p>
<div class="section">
<p>Salt ensures that the same plaintext data does not always translate to the same encrypted text. Salt removes the one common method that intruders use to steal data, namely, matching patterns of encrypted text. Adding <a href="glossary.htm#GUID-6803F75B-7883-4D0B-B1FF-0084AD65E001"><span class="xrefglossterm">salt</span></a> requires an additional 16 bytes of storage per encrypted data value.</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>To add or remove salt from encrypted columns, use the <code class="codeph">ALTER TABLE MODIFY</code> SQL statement.</p>
</li>
</ul>
<p>For example, suppose you want to encrypt the <code class="codeph">first_name</code> column using salt. If the <code class="codeph">first_name</code> column was encrypted without salt earlier, then the <code class="codeph">ALTER TABLE MODIFY</code> statement reencrypts it using salt.</p>
<pre dir="ltr">ALTER TABLE employee MODIFY (first_name ENCRYPT SALT);
</pre></div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-F1C34179-BE14-4966-82B7-97904AB4CF44"></a>
<h3 class="sect3">Removing Salt from an Encrypted Column</h3>
<div>
<p>You can use the <span class="apiname">ALTER TABLE</span> SQL statement to remove salt from an encrypted column.</p>
<div class="section"></div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>To remove salt from an encrypted column, use the <code class="codeph">ENCRYPT NO SALT</code> clause in the <span class="apiname">ALTER TABLE</span> SQL statement.</p>
</li>
</ul>
<p>For example, suppose you wanted to remove salt from the <code class="codeph">first_name</code> column. If you must index a column that was encrypted using salt, then you can use this statement to remove the salt before indexing</p>
<pre dir="ltr">ALTER TABLE employee MODIFY (first_name ENCRYPT NO SALT);
</pre></div>
<!-- class="section" --></div>
</div>
<a id="ASOAG10305"></a><a id="ASOAG9539"></a>
<div class="props_rev_3"><a id="GUID-2931A16D-84E8-4A42-8D01-662FD693A711"></a>
<h3 class="sect3">Changing the Encryption Key or Algorithm for Tables with Encrypted Columns</h3>
<div>
<p>You can use the <code class="codeph">ALTER TABLE</code> SQL statement to change the encryption key or algorithm used in encrypted columns.</p>
<div class="section">
<p>Each table can have only one <a href="glossary.htm#GUID-78CFC3BC-9BDD-406E-A6E2-2374AC636269"><span class="xrefglossterm">TDE table key</span></a> for its columns. You can regenerate the TDE table key with the <code class="codeph">ALTER TABLE</code> statement. This process generates a new key, decrypts the data in the table using the previous key, reencrypts the data using the new key, and then updates the table metadata with the new key information. You can also use a different encryption algorithm for the new TDE table key.</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>To change the encryption key or algorithm for tables that contain encrypted columns, use the <code class="codeph">ALTER TABLE</code> SQL statement with the <code class="codeph">REKEY</code> or <code class="codeph">REKEY USING</code> clause.</p>
</li>
</ul>
<p>For example:</p>
<pre dir="ltr">ALTER TABLE employee REKEY;
</pre>
<p><a href="configuring-transparent-data-encryption.htm#GUID-2931A16D-84E8-4A42-8D01-662FD693A711__CIHHEEFF">Example 3-7</a> regenerates the TDE table key for the <code class="codeph">employee</code> table by using the <code class="codeph">3DES168</code> algorithm.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-2931A16D-84E8-4A42-8D01-662FD693A711__CIHHEEFF">
<p class="titleinexample">Example 3-7 Changing an Encrypted Table Column Encryption Key and Algorithm</p>
<pre dir="ltr">ALTER TABLE employee REKEY USING &#39;3DES168&#39;;
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<a id="ASOAG620"></a>
<div class="props_rev_3"><a id="GUID-1CA947A5-164A-4AA9-AD75-F7D9D4F6FFF8"></a>
<h2 class="sect2">Encrypting Tablespaces</h2>
<div>
<p>You can perform encryption operations on both offline and online tablespaces and databases.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-EA4F9C84-0BE8-44AF-8638-3B7EFE4CA92C" title="You should be aware of restrictions on using Transparent Data Encryption when you encrypt a tablespace.">Restrictions on Using Transparent Data Encryption Tablespace Encryption</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-058B849C-6014-4730-B395-E1FF36900F0F" title="You must set the COMPATIBLE initialization parameter before creating an encrypted tablespace.">Step 1: Set the COMPATIBLE Initialization Parameter for Tablespace Encryption</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-A00B8C8A-3C98-41A5-BB80-EC7BE3E46252" title="You should ensure that you have configured the TDE master encryption key.">Step 2: Set the Tablespace TDE Master Encryption Key</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-161BDCBD-BC49-4D49-A1B5-9AE7F942FE4B" title="After you have set the COMPATIBLE initialization parameter, you are ready to create the encrypted tablespace.">Step 3: Create the Encrypted Tablespace</a></p>
</li>
</ul>
</div>
<a id="ASOAG10162"></a>
<div class="props_rev_3"><a id="GUID-EA4F9C84-0BE8-44AF-8638-3B7EFE4CA92C"></a>
<h3 class="sect3">Restrictions on Using Transparent Data Encryption Tablespace Encryption</h3>
<div>
<p>You should be aware of restrictions on using Transparent Data Encryption when you encrypt a tablespace.</p>
<p>Note the following restrictions:</p>
<ul style="list-style-type: disc;">
<li>
<p>Transparent Data Encryption (TDE) tablespace encryption encrypts or decrypts data during read and write operations, as opposed to TDE column encryption, which encrypts and decrypts data at the SQL layer. This means that most restrictions that apply to TDE column encryption, such as data type restrictions and index type restrictions, do not apply to TDE tablespace encryption.</p>
</li>
<li>
<p>To perform import and export operations, use Oracle Data Pump.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-EA4F9C84-0BE8-44AF-8638-3B7EFE4CA92C__GUID-008664C9-6B9F-4BAF-B65B-1EBD7E859E9E">
<p class="notep1">See Also:</p>
<p><a class="olink SUTIL100" target="_blank" href="../SUTIL/GUID-17FAE261-0972-4220-A2E4-44D479F519D4.htm#SUTIL100"><span><cite>Oracle Database Utilities</cite></span></a> for more information about Oracle Data Pump</p>
</div>
</div>
</div>
<a id="ASOAG10307"></a>
<div class="props_rev_3"><a id="GUID-058B849C-6014-4730-B395-E1FF36900F0F"></a>
<h3 class="sect3">Step 1: Set the COMPATIBLE Initialization Parameter for Tablespace Encryption</h3>
<div>
<p>You must set the <code class="codeph">COMPATIBLE</code> initialization parameter before creating an encrypted tablespace.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-FC737030-FB70-4E7E-809D-22ABAF8A4C09" title="A minimum COMPATIBLE setting of 11.2.0.0 enables the full set of tablespace encryption features.">About Setting the COMPATIBLE Initialization Parameter for Tablespace Encryption</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-DE637157-E201-482D-B12D-F5C59FF9618D" title="To set the COMPATIBLE initialization parameter, you must edit the initialization parameter file for the database instance.">Setting the COMPATIBLE Initialization Parameter for Tablespace Encryption</a></p>
</li>
</ul>
</div>
<a id="ASOAG10516"></a>
<div class="props_rev_3"><a id="GUID-FC737030-FB70-4E7E-809D-22ABAF8A4C09"></a>
<h4 class="sect4">About Setting the COMPATIBLE Initialization Parameter for Tablespace Encryption</h4>
<div>
<p>A minimum <code class="codeph">COMPATIBLE</code> setting of <code class="codeph">11.2.0.0</code> enables the full set of tablespace encryption features.</p>
<p>Setting the compatibility to <code class="codeph">11.2.0.0</code> instead of <code class="codeph">11.1.0.0</code> enables the following additional features:</p>
<ul style="list-style-type: disc;">
<li>
<p>The <code class="codeph">11.2.0.0</code> setting enables the database to use any of the four supported algorithms for data encryption (<code class="codeph">3DES168</code>, <code class="codeph">AES128</code>, <code class="codeph">AES192</code>, and <code class="codeph">AES256</code>).</p>
</li>
<li>
<p>The <code class="codeph">11.2.0.0</code> setting enables the migration of a key from a software keystore to a hardware keystore (ensure that the TDE master encryption key was configured for the hardware keystore)</p>
</li>
<li>
<p>The <code class="codeph">11.2.0.0</code> setting enables resetting and rotating the TDE master encryption key</p>
</li>
</ul>
<p>Be aware that once you set this parameter to <code class="codeph">11.2.0.0</code>, the change is irreversible. To use tablespace encryption, ensure that the compatibility setting is at the minimum, which is <code class="codeph">11.1.0.0</code>.</p>
<div class="infoboxnotealso" id="GUID-FC737030-FB70-4E7E-809D-22ABAF8A4C09__GUID-E3D7450D-3507-4CCD-9722-EFAA4AD01832">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink REFRN10019" target="_blank" href="../REFRN/GUID-6C57EE11-BD06-4BB8-A0F7-D6CDDD086FA9.htm#REFRN10019"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for more information about the <code class="codeph">COMPATIBLE</code> parameter</p>
</li>
<li>
<p><a class="olink ADMIN11099" target="_blank" href="../ADMIN/create.htm#ADMIN11099"><span><cite>Oracle Database Administrator&rsquo;s Guide</cite></span></a> for more information about initialization parameter files</p>
</li>
</ul>
</div>
</div>
</div>
<a id="ASOAG10517"></a>
<div class="props_rev_3"><a id="GUID-DE637157-E201-482D-B12D-F5C59FF9618D"></a>
<h4 class="sect4">Setting the COMPATIBLE Initialization Parameter for Tablespace Encryption</h4>
<div>
<p>To set the <code class="codeph">COMPATIBLE</code> initialization parameter, you must edit the initialization parameter file for the database instance.</p>
<div class="section">
<ol>
<li>
<p>Log in to the database instance.</p>
<p>In a multitenant environment, log in to the PDB. For example:</p>
<pre dir="ltr">sqlplus sec_admin@hrpdb
Enter password: <span class="italic">password</span>
Connected.
</pre>
<p>To find the available PDBs, query the <code class="codeph">DBA_PDBS</code> data dictionary view. To check the current PDB, run the <code class="codeph">show con_name</code> command.</p>
</li>
<li>
<p>Check the current setting of the <code class="codeph">COMPATIBLE</code> parameter.</p>
<p>For example:</p>
<pre dir="ltr">SHOW PARAMETER COMPATIBLE
 
NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
compatible                           string      11.0.0.0
noncdbcompatible                     BOOLEAN     FALSE
</pre></li>
<li>
<p>If you must change the <code class="codeph">COMPATIBLE</code> parameter, then complete the remaining steps in this procedure.</p>
<p>The value should be 11.2.0.0 or higher.</p>
</li>
<li>
<p>Locate the initialization parameter file for the database instance.</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">UNIX systems:</span> This file is in the <span class="italic"><code class="codeph">ORACLE_HOME</code></span><code class="codeph">/dbs</code> directory and is named <code class="codeph">init</code><span class="italic"><code class="codeph">ORACLE_SID</code></span><code class="codeph">.ora</code> (for example, <code class="codeph">initmydb.ora</code>).</p>
</li>
<li>
<p><span class="bold">Windows systems:</span> This file is in the <span class="italic"><code class="codeph">ORACLE_HOME</code></span><code class="codeph">\database</code> directory and is named <code class="codeph">init</code><span class="italic"><code class="codeph">ORACLE_SID</code></span><code class="codeph">.ora</code> (for example, <code class="codeph">initmydb.ora</code>).</p>
</li>
</ul>
</li>
<li>
<p>Edit the initialization parameter file to use the new <code class="codeph">COMPATIBLE</code> setting.</p>
<p>For example:</p>
<pre dir="ltr">compatible=11.2.0.0.0
</pre></li>
<li>
<p>In SQL*Plus, connect as a user who has the <code class="codeph">SYSDBA</code> administrative privilege, and then shut down the database.</p>
<p>For example:</p>
<pre dir="ltr">CONNECT /AS SYSDBA
SHUTDOWN
</pre></li>
<li>
<p>Edit the initialization parameter file to use the correct <code class="codeph">COMPATIBLE</code> setting.</p>
<p>For example:</p>
<pre dir="ltr">COMPATIBLE = 12.1.0.0
</pre></li>
<li>
<p>In SQL*Plus, ensure that you are connected as a user who has the <code class="codeph">SYSDBA</code> administrative privilege, and then start the database.</p>
<p>For example:</p>
<pre dir="ltr">CONNECT /AS SYSDBA
STARTUP
</pre>
<p>If tablespace encryption is in use, then open the keystore at the database mount. The keystore must be open before you can access data in an encrypted tablespace.</p>
<pre dir="ltr">STARTUP MOUNT;
ADMINISTER KEY MANAGEMENT SET KEYSTORE OPEN IDENTIFIED BY <span class="italic">keystore_password</span>;
ALTER DATABASE OPEN;
</pre></li>
</ol>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="ASOAG9556"></a>
<div class="props_rev_3"><a id="GUID-A00B8C8A-3C98-41A5-BB80-EC7BE3E46252"></a>
<h3 class="sect3">Step 2: Set the Tablespace TDE Master Encryption Key</h3>
<div>
<p>You should ensure that you have configured the TDE master encryption key.</p>
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Set the TDE master encryption key as follows:</p>
<ul style="list-style-type: disc;">
<li>
<p>For software TDE master encryption keys, see <a href="configuring-transparent-data-encryption.htm#GUID-15E41F0A-5D80-4A7A-88F6-30EE86FA44E8" title="Once the keystore is open, you can set a TDE master encryption key for it.">Step 4: Set the Software TDE Master Encryption Key</a>.</p>
</li>
<li>
<p>For hardware TDE master encryption keys, see <a href="configuring-transparent-data-encryption.htm#GUID-96BEF7DD-2B37-48F2-9651-38059DE499C5" title="After you have opened the hardware keystore, you are ready to set the hardware keystore TDE master encryption key.">Step 4: Set the Hardware Keystore TDE Master Encryption Key</a>.</p>
</li>
</ul>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="ASOAG9558"></a>
<div class="props_rev_3"><a id="GUID-161BDCBD-BC49-4D49-A1B5-9AE7F942FE4B"></a>
<h3 class="sect3">Step 3: Create the Encrypted Tablespace</h3>
<div>
<p>After you have set the <code class="codeph">COMPATIBLE</code> initialization parameter, you are ready to create the encrypted tablespace.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-5B8CCF8D-278D-411B-B8EF-F69F9364D762" title="To create an encrypted tablespace, you can use the CREATE TABLESPACE SQL statement.">About Creating Encrypted Tablespaces</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-A0D33E93-FC64-45F1-B45A-D0D80AD37176" title="To create an encrypted tablespace, you must use the CREATE TABLESPACE statement with the ENCRYPTION USING clause.">Creating an Encrypted Tablespace</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-9E5ACD09-D598-4DB1-8C8F-1BB5F646B6E9" title="You can use the CREATE TABLESPACE SQL statement to create an encrypted tablespace.">Example: Creating an Encrypted Tablespace That Uses 3DES168</a></p>
</li>
<li>
<p><a href="configuring-transparent-data-encryption.htm#GUID-A7FE953F-048E-462F-8E2A-851A05AF9A04" title="You can use the CREATE TABLESPACE SQL statement to create an encrypted tablespace that uses the default algorithm.">Example: Creating an Encrypted Tablespace That Uses the Default Algorithm</a></p>
</li>
</ul>
</div>
<a id="ASOAG10308"></a>
<div class="props_rev_3"><a id="GUID-5B8CCF8D-278D-411B-B8EF-F69F9364D762"></a>
<h4 class="sect4">About Creating Encrypted Tablespaces</h4>
<div>
<p>To create an encrypted tablespace, you can use the <code class="codeph">CREATE TABLESPACE</code> SQL statement.</p>
<p>You must have the <code class="codeph">CREATE TABLESPACE</code> system privilege to create an encrypted tablespace.</p>
<p>You cannot change an existing tablespace to make it encrypted. You can, however, import data into an encrypted tablespace by using Oracle Data Pump. You can also use a SQL statement such as <code class="codeph">CREATE TABLE...AS SELECT...</code>or <code class="codeph">ALTER TABLE...MOVE...</code> to move data into an encrypted tablespace. The <code class="codeph">CREATE TABLE...AS SELECT...</code> statement creates a table from an existing table. The <code class="codeph">ALTER TABLE...MOVE...</code> statement moves a table into the encrypted tablespace.</p>
<p>For security reasons, you cannot encrypt a tablespace with the <code class="codeph">NO SALT</code> option.</p>
<p>You can query the <code class="codeph">ENCRYPTED</code> column of the <code class="codeph">DBA_TABLESPACES</code> and <code class="codeph">USER_TABLESPACES</code> data dictionary views to verify if a tablespace was encrypted.</p>
<div class="infoboxnotealso" id="GUID-5B8CCF8D-278D-411B-B8EF-F69F9364D762__GUID-A14F401C-494B-409F-A962-A6E84FD8FF06">
<p class="notep1">See Also:</p>
<p><a class="olink REFRN" target="_blank" href="../REFRN/toc.htm"><span><cite>Oracle Database Reference</cite></span></a> for more information about these data dictionary views</p>
</div>
</div>
</div>
<a id="ASOAG10309"></a>
<div class="props_rev_3"><a id="GUID-A0D33E93-FC64-45F1-B45A-D0D80AD37176"></a>
<h4 class="sect4">Creating an Encrypted Tablespace</h4>
<div>
<p>To create an encrypted tablespace, you must use the <code class="codeph">CREATE TABLESPACE</code> statement with the <code class="codeph">ENCRYPTION USING</code> clause.</p>
<div class="section">
<ol>
<li>
<p>Log in to the database instance as a user who has been granted the <code class="codeph">CREATE TABLESPACE</code> system privilege.</p>
<p>In a multitenant environment, log in to the PDB. For example:</p>
<pre dir="ltr">sqlplus sec_admin@hrpdb as syskm
Enter password: <span class="italic">password</span>
Connected.
</pre>
<p>To find the available PDBs, query the <code class="codeph">DBA_PDBS</code> data dictionary view. To check the current PDB, run the <code class="codeph">show con_name</code> command.</p>
</li>
<li>
<p>Run the <code class="codeph">CREATE TABLESPACE</code> statement, using its encryption clauses.</p>
<p>For example:</p>
<pre dir="ltr">CREATE TABLESPACE encrypt_ts
  DATAFILE &#39;$ORACLE_HOME/dbs/encrypt_df.dbf&#39; SIZE 1M
  <span class="bold">ENCRYPTION USING &#39;AES256&#39;</span>
  DEFAULT STORAGE <span class="bold">(ENCRYPT)</span>;
</pre>
<p>In this specification:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">ENCRYPTION USING &#39;AES256&#39;</code> specifies the encryption algorithm and the key length for the encryption. Enclose this setting in single quotation marks (&#39; &#39;). The key lengths are included in the names of the algorithms. If you do not specify an encryption algorithm, then the default encryption algorithm, <code class="codeph">AES128</code>, is used. Choose from the following algorithms:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">3DES168</code></p>
</li>
<li>
<p><code class="codeph">AES128</code></p>
</li>
<li>
<p><code class="codeph">AES192</code></p>
</li>
<li>
<p><code class="codeph">AES256</code></p>
</li>
</ul>
</li>
<li>
<p><code class="codeph">ENCRYPT</code> in the <code class="codeph">DEFAULT STORAGE</code> clause encrypts the tablespace.</p>
</li>
</ul>
</li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-A0D33E93-FC64-45F1-B45A-D0D80AD37176__GUID-E801EA16-1DC9-4480-8B34-2C4106B8F7C8">
<p class="notep1">See Also:</p>
<p><a class="olink SQLRF01403" target="_blank" href="../SQLRF/statements_7003.htm#SQLRF01403"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for the <code class="codeph">CREATE TABLESPACE</code> statement syntax</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ASOAG10160"></a><a id="ASOAG10310"></a>
<div class="props_rev_3"><a id="GUID-9E5ACD09-D598-4DB1-8C8F-1BB5F646B6E9"></a>
<h4 class="sect4">Example: Creating an Encrypted Tablespace That Uses 3DES168</h4>
<div>
<p>You can use the <span class="apiname">CREATE TABLESPACE</span> SQL statement to create an encrypted tablespace.</p>
<p><a href="configuring-transparent-data-encryption.htm#GUID-9E5ACD09-D598-4DB1-8C8F-1BB5F646B6E9__CJABGBEJ">Example 3-8</a> creates a tablespace called <code class="codeph">securespace_1</code> that is encrypted using the <code class="codeph">3DES</code> algorithm. The key length is 168 bits.</p>
<div class="example" id="GUID-9E5ACD09-D598-4DB1-8C8F-1BB5F646B6E9__CJABGBEJ">
<p class="titleinexample">Example 3-8 Creating an Encrypted Tablespace That Uses 3DES168</p>
<pre dir="ltr">CREATE TABLESPACE securespace_1
DATAFILE &#39;/home/user/oradata/secure01.dbf&#39;
SIZE 150M
ENCRYPTION USING &#39;3DES168&#39;
DEFAULT STORAGE(ENCRYPT);
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ASOAG10161"></a>
<div class="sect4"><a id="GUID-A7FE953F-048E-462F-8E2A-851A05AF9A04"></a>
<h4 class="sect4">Example: Creating an Encrypted Tablespace That Uses the Default Algorithm</h4>
<div>
<p>You can use the <span class="apiname">CREATE TABLESPACE</span> SQL statement to create an encrypted tablespace that uses the default algorithm.</p>
<p><a href="configuring-transparent-data-encryption.htm#GUID-A7FE953F-048E-462F-8E2A-851A05AF9A04__CJADCCEH">Example 3-9</a> creates a tablespace called <code class="codeph">securespace_2</code>. Because no encryption algorithm is specified, the default encryption algorithm (<code class="codeph">AES128</code>) is used. The key length is 128 bits.</p>
<p>You cannot encrypt an existing tablespace.</p>
<div class="example" id="GUID-A7FE953F-048E-462F-8E2A-851A05AF9A04__CJADCCEH">
<p class="titleinexample">Example 3-9 Creating an Encrypted Tablespace That Uses the Default Algorithm</p>
<pre dir="ltr">CREATE TABLESPACE securespace_2
DATAFILE &#39;/home/user/oradata/secure01.dbf&#39;
SIZE 150M
ENCRYPTION
DEFAULT STORAGE(ENCRYPT);
</pre></div>
<!-- class="example" --></div>
</div>
</div>
</div>
<a id="ASOAG10362"></a><a id="ASOAG9555"></a>
<div class="props_rev_3"><a id="GUID-F2CB30AB-99AA-4BF6-A95F-41C1C205963F"></a>
<h2 class="sect2">Transparent Data Encryption Data Dynamic and Data Dictionary Views</h2>
<div>
<p>Oracle Database provides a set of dynamic and data dictionary views that you can query to find more information about Transparent Data Encryption data.</p>
<div class="section">
<p><a href="configuring-transparent-data-encryption.htm#GUID-F2CB30AB-99AA-4BF6-A95F-41C1C205963F__CIHGBGHG" title="TDE views">Table 3-2</a> describes these dynamic and data dictionary views.</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-F2CB30AB-99AA-4BF6-A95F-41C1C205963F__CIHGBGHG">
<p class="titleintable">Table 3-2 Transparent Data Encryption Related Views</p>
<table class="cellalignment5391" title="Transparent Data Encryption Related Views" summary="TDE views">
<thead>
<tr class="cellalignment5373">
<th class="cellalignment5416" id="d4983e7497">View</th>
<th class="cellalignment5417" id="d4983e7500">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment5373">
<td class="cellalignment5418" id="d4983e7505" headers="d4983e7497">
<p><code class="codeph">ALL_ENCRYPTED_COLUMNS</code></p>
</td>
<td class="cellalignment5419" headers="d4983e7505 d4983e7500">
<p>Displays encryption information about encrypted columns in the tables accessible to the current user</p>
</td>
</tr>
<tr class="cellalignment5373">
<td class="cellalignment5418" id="d4983e7513" headers="d4983e7497">
<p><code class="codeph">DBA_ENCRYPTED_COLUMNS</code></p>
</td>
<td class="cellalignment5419" headers="d4983e7513 d4983e7500">
<p>Displays encryption information for all of the encrypted columns in the database</p>
</td>
</tr>
<tr class="cellalignment5373">
<td class="cellalignment5418" id="d4983e7521" headers="d4983e7497">
<p><code class="codeph">USER_ENCRYPTED_COLUMNS</code></p>
</td>
<td class="cellalignment5419" headers="d4983e7521 d4983e7500">
<p>Displays encryption information for encrypted table columns in the current user&#39;s schema</p>
</td>
</tr>
<tr class="cellalignment5373">
<td class="cellalignment5418" id="d4983e7529" headers="d4983e7497">
<p><code class="codeph">DBA_TABLESPACE_USAGE_METRICS</code></p>
</td>
<td class="cellalignment5419" headers="d4983e7529 d4983e7500">
<p>Describes tablespace usage metrics for all types of tablespaces, including permanent, temporary, and undo tablespaces</p>
</td>
</tr>
<tr class="cellalignment5373">
<td class="cellalignment5418" id="d4983e7537" headers="d4983e7497">
<p><code class="codeph">V$CLIENT_SECRETS</code></p>
</td>
<td class="cellalignment5419" headers="d4983e7537 d4983e7500">
<p>Lists the properties of the strings (secrets) that were stored in the keystore for various features (clients).</p>
<p>In a multitenant environment, when you query this view in a PDB, then it displays information about keys that were created or activated for the current PDB. If you query this view in the root, then it displays this information about keys for all of the PDBs.</p>
</td>
</tr>
<tr class="cellalignment5373">
<td class="cellalignment5418" id="d4983e7547" headers="d4983e7497">
<p><code class="codeph">V$ENCRYPTED_TABLESPACES</code></p>
</td>
<td class="cellalignment5419" headers="d4983e7547 d4983e7500">
<p>Displays information about the tablespaces that are encrypted</p>
</td>
</tr>
<tr class="cellalignment5373">
<td class="cellalignment5418" id="d4983e7555" headers="d4983e7497">
<p><code class="codeph">V$ENCRYPTION_KEYS</code></p>
</td>
<td class="cellalignment5419" headers="d4983e7555 d4983e7500">
<p>When used with keys that have been rotated with the <code class="codeph">ADMINISTER KEY MANAGEMENT</code> statement, displays information about the TDE master encryption keys.</p>
<p>In a multitenant environment, when you query this view in a PDB, it displays information about keys that were created or activated for the current PDB. If you query this view in the root, it displays this information about keys for all of the PDBs.</p>
</td>
</tr>
<tr class="cellalignment5373">
<td class="cellalignment5418" id="d4983e7568" headers="d4983e7497">
<p><code class="codeph">V$ENCRYPTION_WALLET</code></p>
</td>
<td class="cellalignment5419" headers="d4983e7568 d4983e7500">
<p>Displays information on the status of the keystore and the keystore location for TDE</p>
</td>
</tr>
<tr class="cellalignment5373">
<td class="cellalignment5418" id="d4983e7576" headers="d4983e7497">
<p><code class="codeph">V$WALLET</code></p>
</td>
<td class="cellalignment5419" headers="d4983e7576 d4983e7500">
<p>Displays metadata information for a PKI certificate, which can be used as a master encryption key for TDE</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-F2CB30AB-99AA-4BF6-A95F-41C1C205963F__GUID-0D627C67-A82E-4C3E-BCC3-AD6B6DD3731F">
<p class="notep1">See Also:</p>
<p><a class="olink REFRN" target="_blank" href="../REFRN/toc.htm"><span><cite>Oracle Database Reference</cite></span></a> for detailed information about these views</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5372">
<tr>
<td class="cellalignment5379">
<table class="cellalignment5377">
<tr>
<td class="cellalignment5376"><a href="introduction-to-transparent-data-encryption.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5376"><a href="managing-keystore-and-tde-master-encryption-key.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5381">
<table class="cellalignment5375">
<tr>
<td class="cellalignment5376"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5376"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5376"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5376"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5376"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5376"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>