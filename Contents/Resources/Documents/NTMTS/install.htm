<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-78803"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Installing%20Oracle%20Services%20for%20Microsoft%20Transaction%20Server"></a><title>Installing Oracle Services for Microsoft Transaction Server</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1023"/>
<meta name="dcterms.created" content="2014-08-21T15:13:25Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Services for Microsoft Transaction Server Developer&#39;s Guide"/>
<meta name="dcterms.identifier" content="E18595-03"/>
<meta name="dcterms.isVersionOf" content="NTMTS"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="using.htm" title="Previous" type="text/html"/>
<link rel="Next" href="recovery.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E18595-03.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">6/12</span> <!-- End Header -->
<div id="NTMTS002" class="chapter"><a id="CIHFFEFD"></a> <a id="i1007044"></a>
<h1 class="chapter"><span class="secnum">2</span> Installing Oracle Services for Microsoft Transaction Server</h1>
<p>This chapter describes installation requirements for the <a href="glossary.htm#CBAIJAFH"><span class="xrefglossterm">Microsoft Transaction Server</span></a> and Oracle Database environment.</p>
<p>This chapter contains these topics:</p>
<ul>
<li>
<p><a href="#i1007065">Installation Introduction</a></p>
</li>
<li>
<p><a href="#CHDEEIFA">Installation Requirements for Microsoft Transaction Server</a></p>
</li>
<li>
<p><a href="#CHDECAHH">Using Oracle Services for MTS with Oracle Data Provider for .NET, Managed Driver</a></p>
</li>
<li>
<p><a href="#CHDFEBJJ">Manually Creating an Oracle MTS Recovery Service</a></p>
</li>
</ul>
<a id="i1007065"></a>
<div id="NTMTS114" class="sect1">
<h2 class="sect1">Installation Introduction<a id="sthref26"></a><a id="sthref27"></a><a id="sthref28"></a><a id="sthref29"></a><a id="sthref30"></a><a id="sthref31"></a></h2>
<p>You can install <a href="glossary.htm#CBAEJGHF"><span class="xrefglossterm">OraMTS</span></a> as part of the Oracle Database Client. OraMTS service will be created for the Oracle Home you installed. Beginning in Oracle 12<span class="italic">c</span>, each Oracle Home has its own OraMTS recovery Windows service. Also, beginning in Oracle 12<span class="italic">c</span>, the OraMTS service runs as the Oracle Home user.</p>
<p>Oracle Home User is the owner of Oracle Services that run from Oracle Home and cannot be changed after installation. It can be a Windows built-in account or a Windows User Account. For enhanced security, Oracle recommends choosing the standard Windows User Account as Oracle Home User for Oracle Database installations rather than a Windows built-in account. The primary purpose of Oracle Home User is to run Windows services with Windows User Account. However, this user account (Oracle Home User) must be a low-privileged user account that should not be used for database administration. This ensures that Oracle Database services running under Oracle Home User have only the minimal privileges required to run Oracle products. The Windows User Account can be a Local User, a Domain User, or a Managed Services Account.</p>
<p>In some cases, such as a software-only install, clone cycles, or an <code>AddNode</code> operation on the database, you may need to manually create the OraMTS service. For more information, see <a href="#CHDFEBJJ">&#34;Manually Creating an Oracle MTS Recovery Service&#34;</a>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink NTQRF672" href="../NTQRF/oh_usr.htm#NTQRF672"><span class="italic">Oracle Database Platform Guide for Microsoft Windows</span></a></div>
<p>This section describes the Oracle and non-Oracle products you must install for OraMTS. Additional installation requirements include:</p>
<ul>
<li>
<p><a id="sthref32"></a>For <a href="glossary.htm#CBACHHGF"><span class="xrefglossterm">Oracle Data Provider for .NET (ODP.NET)</span></a> cluster configurations (or any failover configuration), install Microsoft Transaction Server on the node running the <a href="glossary.htm#CBAFFEFA"><span class="xrefglossterm">Microsoft Distributed Transaction Coordinator (MS DTC)</span></a> component. This ensures that the Oracle MTS Recovery Service migrates with the client application during failover. You can configure this when scheduling recovery transactions.</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="CHDEEIFA"></a>
<div id="NTMTS115" class="sect1">
<h2 class="sect1">Installation Requirements for Microsoft Transaction Server<a id="sthref33"></a><a id="sthref34"></a></h2>
<p>The Windows computer where Microsoft Transaction Server is installed has the following product requirements:</p>
<div id="NTMTS116" class="sect2"><a id="sthref35"></a>
<h3 class="sect2">Oracle Products</h3>
<ul>
<li>
<p><a href="glossary.htm#CBAEJGHF"><span class="xrefglossterm">OraMTS</span></a> <a id="sthref36"></a><a id="sthref37"></a></p>
</li>
<li>
<p><a id="sthref38"></a><a id="sthref39"></a>Oracle Database Client, included automatically with the OraMTS installation.</p>
</li>
<li>
<p>A data access driver that uses Oracle Services for MTS, such as:</p>
<ul>
<li>
<p><a href="glossary.htm#CBACHHGF"><span class="xrefglossterm">Oracle Data Provider for .NET (ODP.NET)</span></a></p>
</li>
<li>
<p><a id="sthref40"></a><a id="sthref41"></a><a href="glossary.htm#CBACJCBG"><span class="xrefglossterm">Oracle Open Database Connectivity (ODBC) Driver</span></a></p>
</li>
<li>
<p><a href="glossary.htm#CBAHFGAI"><span class="xrefglossterm">Oracle Provider for OLE DB</span></a></p>
</li>
<li>
<p><a href="glossary.htm#CBAEGJCG"><span class="xrefglossterm">Oracle Call Interface (OCI)</span></a></p>
</li>
</ul>
</li>
<li>
<p>Access to an Oracle Database 10<span class="italic">g</span> Release 2 or higher version</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Notes:</p>
<ul>
<li>
<p>Oracle ODBC Driver, ODP.NET, Oracle Provider for OLE DB, and OCI are only required if you are building or using components with which they are required.</p>
</li>
<li>
<p>Depending on the installation, you are prompted to enter the port number on which the Oracle MTS Recovery Service will listen for requests to resolve in-doubt transactions</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<div id="NTMTS117" class="sect2"><a id="sthref42"></a>
<h3 class="sect2">Non-Oracle Products</h3>
<ul>
<li>
<p>Windows operating system <a id="sthref43"></a><a id="sthref44"></a></p>
</li>
<li>
<p>Microsoft Distributed Transaction Coordinator, which is part of the Windows operating system</p>
</li>
</ul>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDECAHH"></a>
<div id="NTMTS311" class="sect1">
<h2 class="sect1">Using Oracle Services for MTS with Oracle Data Provider for .NET, Managed Driver</h2>
<p>Oracle Data Provider for .NET, Managed Driver is a fully managed data provider consisting of 100% native .NET code introduced with Oracle Database 12c. ODP.NET, Managed Driver incorporates Oracle Services for MTS entire enlistment and commit functionality, within <code>Oracle.ManagedDataAccessDTC.dll</code> installed with the managed driver, allowing those functions to execute using managed code. The Oracle Services for MTS recovery service remains unmanaged.</p>
<p>The <code>Oracle.ManagedDataAccessDTC.dll</code> must be deployed with <code>Oracle.ManagedDataAccess.dll</code> for any ODP.NET, Managed Driver applications using distributed transactions. It can run alongside the unmanaged Oracle Services for MTS version if unmanaged data access drivers, such as ODBC, are also using distributed transactions on the same computer.</p>
<p>There are two versions of <code>Oracle.ManagedDataAccessDTC.dll</code>, one for 32-bit .NET Framework and one for 64-bit .NET Framework, installed with ODP.NET, Managed Driver. While both versions of <code>Oracle.ManagedDataAccessDTC.dll</code> are fully managed, they must be platform-specific, because the MS DTC application programming interfaces are unmanaged code. Thus, ODP.NET, Managed Driver enlistment and commit functions call either the 32-bit or 64-bit MS DTC, depending on the platform.</p>
<p>The two versions of <code>Oracle.ManagedDataAccessDTC.dll</code> are located in the following directories:</p>
<ul>
<li>
<p>32-bit .NET Framework located in: <code><span class="codeinlineitalic">OH\</span></code><code>odp.net\managed\x86</code></p>
</li>
<li>
<p>64-bit .NET Framework located in: <code><span class="codeinlineitalic">OH</span></code>\<code>odp.net\managed\x64</code></p>
</li>
</ul>
<p>Deploy the <code>Oracle.ManagedDataAccessDTC.dll</code> from the directory appropriate for your .NET application&#39;s target platform, 32-bit or 64-bit.</p>
<p><code>Oracle.ManagedDataAccessDTC.dll</code> should not be directly referenced by a .NET application. It will be implicitly loaded by ODP.NET, Managed Driver when using distributed transactions.</p>
<p>The Oracle Services for MTS recovery service does not need to run in the same computer as ODP.NET, Managed Driver. Administrators can specify the host computer name that has a running recovery service in the .NET config file of the application.</p>
</div>
<!-- class="sect1" -->
<a id="CHDFEBJJ"></a>
<div id="NTMTS303" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Manually Creating an Oracle MTS Recovery Service<a id="sthref45"></a><a id="sthref46"></a></h2>
<p>Starting with Oracle Database 12<span class="italic">c</span>, Oracle Database on Windows software includes the <code>oramtsctl.exe</code> utility to enable manual creation of the OraMTS recovery service. Because ODP.NET, Managed Driver does not automatically create the OraMTS recovery service, running this utility creates the service. When run, the service will be created for the current Oracle home and runs as the Oracle Home User.If ODP.NET, Managed Driver can access an existing OraMTS recovery service running on the same computer or another computer, it is not necessary to run this utility.</p>
<p><span class="bold">To manually create an Oracle MTS Recovery Service:</span></p>
<ol>
<li>
<p>Install an Oracle Database.</p>
</li>
<li>
<p>Open the command prompt.</p>
</li>
<li>
<p>Run this command:</p>
<pre>oramtsctl -new
</pre></li>
</ol>
<p><span class="bold">To delete an Oracle MTS Recovery Service run:</span></p>
<pre>oramtsctl -delete
</pre>
<p><span class="bold">Usage</span></p>
<pre>oramtsctl &lt;-new|-delete|-start|-stop|-status|-config|-passwd|-trace|-trcdir&gt;
          [-host    &lt;hostname|IP_address&gt; ...]
          [-port    &lt;number&gt;]
          [-ip      &lt;IP_address&gt;]
          [-dtchost &lt;DTC_hostname&gt;]
          [-cluster &lt;on|off&gt;]
          [-default]
 
 -new    
</pre>
<p>Create and start a new <code>Oracler1MTSRecoveryService</code> service.</p>
<pre> 
 -delete [Oracle_home_directory]
</pre>
<p>Delete <code>Oracler1MTSRecoveryService</code> of current home or specified home.</p>
<pre> 
 -start  
</pre>
<p>Start <code>Oracler1MTSRecoveryService</code> service.</p>
<pre> 
 -stop   
</pre>
<p>Stop <code>Oracler1MTSRecoveryService</code> service.</p>
<pre> 
 -status Query Oracler1MTSRecoveryService
</pre>
<p>service status.</p>
<pre> 
 -config [-port &lt;number&gt;] [-ip &lt;IP_address&gt;] [-dtchost &lt;DTC_hostname&gt;]
         [-cluster &lt;on|off&gt;] [-default]
</pre>
<p>Show or set <code>Oracler1MTSRecoveryService</code> service configuration.</p>
<p>Use -default to reset <code>Oracler1MTSRecoveryService</code> configuration.</p>
<pre> 
 -passwd
</pre>
<p>Update <code>Oracler1MTSRecoveryService</code> service user password.</p>
<pre> 
 -trace  [0-5]
</pre>
<p>Show traces or set trace level. Set level 0 to turn off tracing.</p>
<pre> 
 -trcdir [trace_directory]
</pre>
<p>Show or set trace directory.</p>
<pre> 
 -host   &lt;hostname|IP_address&gt; ...
</pre>
<p>Execute operation on host(s) identified by name(s) or IP address(es).</p>
<p>Local host is used if option not specified.</p>
<pre> 
 -port   &lt;number&gt;
</pre>
<p>Execute <code>-new</code> or <code>-config</code> with this option to specify a service port.</p>
<p>Service port is configured automatically if option not specified.</p>
<pre> 
 -ip     &lt;IP_address&gt;
</pre>
<p>Execute <code>-new</code> or <code>-config</code> with this option to specify an IP address.</p>
<pre> 
 -default
</pre>
<p>Execute <code>-new</code> or <code>-config</code> with this option to set default configuration.</p>
<pre> 
oramtsctl -new -host host1 host2.domain.com host3 -port 2033
</pre>
<p><span class="bold">Examples:</span></p>
<p>Install the service with automatic configuration:</p>
<pre>oramtsctl -new
 
</pre>
<p>Install the service on port 2032:</p>
<pre>oramtsctl -new -port 2032
 
</pre>
<p>Configure the service to use port 2033:</p>
<pre>oramtsctl -config -port 2033
 
</pre>
<p>Update the service user password:</p>
<pre>oramtsctl -passwd
 
</pre>
<p>Install the service on several hosts and use uniform port 2033:</p>
<pre>oramtsctl -new -host host1 host2.domain.com host3 -port 2033 
</pre></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2496">
<tr>
<td class="cellalignment2503">
<table class="cellalignment2501">
<tr>
<td class="cellalignment2500"><a href="using.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2500"><a href="recovery.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2505">
<table class="cellalignment2499">
<tr>
<td class="cellalignment2500"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2500"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2500"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2500"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2500"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2500"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>