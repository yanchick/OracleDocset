<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-114018"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Defining%20an%20Active%20Standby%20Pair%20Replication%20Scheme"></a><title>Defining an Active Standby Pair Replication Scheme</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 726"/>
<meta name="dcterms.created" content="2014-09-29T11:11:55Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="TimesTen In-Memory Database Replication Guide"/>
<meta name="dcterms.identifier" content="E21635-11"/>
<meta name="dcterms.isVersionOf" content="TTREP"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2012, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="gettingstarted.htm" title="Previous" type="text/html"/>
<link rel="Next" href="attrib.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E21635-11.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">7/21</span> <!-- End Header -->
<div id="TTREP177" class="chapter"><a id="CHDJBJAI"></a>
<h1 class="chapter"><span class="secnum">3</span> Defining an Active Standby Pair Replication Scheme</h1>
<p>The following sections describe how to design a highly available system and define replication schemes:</p>
<ul>
<li>
<p><a href="#BABDCGEJ">Overview of master database states</a></p>
</li>
<li>
<p><a href="#CBAGAJGF">Duplicating a database</a></p>
</li>
<li>
<p><a href="#CHDFADGF">Restrictions on active standby pairs</a></p>
</li>
<li>
<p><a href="#CHDBGEGH">Defining the DSNs for the databases</a></p>
</li>
<li>
<p><a href="#BABDIIGH">Table requirements for active standby pairs</a></p>
</li>
<li>
<p><a href="#CHDBDJBB">Defining an active standby pair replication scheme</a></p>
</li>
<li>
<p><a href="#CHDDHHCE">Identifying the databases in the active standby pair</a></p>
</li>
<li>
<p><a href="#CHDBDADH">Using a return service for an active standby pair</a></p>
</li>
<li>
<p><a href="#CHDDHCFC">Setting STORE attributes for an active standby pair</a></p>
</li>
<li>
<p><a href="#CHDGDBHC">Configuring network operations for an active standby pair</a></p>
</li>
<li>
<p><a href="#CHDEIBIA">Using automatic client failover for an active standby pair</a></p>
</li>
<li>
<p><a href="#CHDHFDJI">Including or excluding database objects from replication</a></p>
</li>
<li>
<p><a href="#CHDHDDDF">Replicating tables with foreign key relationships in an active standby pair</a></p>
</li>
<li>
<p><a href="#BABIHIJJ">Materialized views in an active standby pair</a></p>
</li>
<li>
<p><a href="#BABBJAFD">Replicating sequences in an active standby pair</a></p>
</li>
</ul>
<p>To reduce the amount of bandwidth required for replication, see <a href="attrib.htm#CHDBEDCC">&#34;Compressing replicated traffic&#34;</a>.</p>
<a id="BABDCGEJ"></a>
<div id="TTREP211" class="sect1">
<h2 class="sect1">Overview of master database states<a id="sthref89"></a></h2>
<p>This section summarizes the possible states of a master database. These states are referenced in the tasks described in the rest of the chapter.</p>
<p>The master databases can be in one of the following states:</p>
<ul>
<li>
<p><code>ACTIVE</code> - A database in this state is the active database. Applications can update its replicated tables.</p>
</li>
<li>
<p><code>STANDBY</code> - A database in this state is the standby database. Applications can update only nonreplicated tables in the standby database. Nonreplicated tables are tables that have been excluded from the replication scheme by using the <code>EXCLUDE TABLE</code> or <code>EXCLUDE CACHE GROUP</code> clauses of the <code>CREATE ACTIVE STANDBY PAIR</code> statement.</p>
</li>
<li>
<p><code>FAILED</code> - A database in this state is a failed master database. No updates can be replicated to it.</p>
</li>
<li>
<p><code>IDLE</code> - A database in this state has not yet had its role in the active standby pair assigned. It cannot be updated. Every database comes up in the <code>IDLE</code> state.</p>
</li>
<li>
<p><code>RECOVERING</code> - When a previously failed master database is synchronizing updates with the active database, it is in the <code>RECOVERING</code> state.</p>
</li>
</ul>
<p>You can use the <code>ttRepStateGet</code> built-in procedure to discover the state of a master database.</p>
</div>
<!-- class="sect1" -->
<a id="CBAGAJGF"></a>
<div id="TTREP212" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Duplicating a database<a id="sthref90"></a><a id="sthref91"></a><a id="sthref92"></a><a id="sthref93"></a></h2>
<p>When you set up a replication scheme or administer a recovery, a common task is to duplicate a database. Use the <code>-duplicate</code> option of the <code>ttRepAdmin</code> utility or the <code>ttRepDuplicateEx</code> C function to duplicate a database.</p>
<p>To duplicate a database, these conditions must be fulfilled:</p>
<ul>
<li>
<p>The instance administrator performs the duplicate operation.</p>
</li>
<li>
<p>The instance administrator user name must be the same on both instances involved in the duplication.</p>
</li>
<li>
<p>You must provide the user name and password for a user with the <code>ADMIN</code> privilege on the source database.</p>
</li>
<li>
<p>The target DSN cannot include client/server attributes.</p>
</li>
</ul>
<p>On the source database, create a user and grant the <code>ADMIN</code> privilege to the user:</p>
<pre>Command&gt; CREATE USER ttuser IDENTIFIED BY ttuser;
User created.

Command&gt; GRANT ADMIN TO ttuser;
</pre>
<p>Assume the user name of the instance administrator is <code>timesten</code>. Logged in as <code>timesten</code> on the target host, duplicate the <code>dsn1</code> database on <code>host1</code> to <code>dsn2</code>:</p>
<pre>ttRepAdmin -duplicate -from dsn1 -host host1 dsn2

Enter internal UID at the remote datastore with ADMIN privileges: ttuser 
Enter password of the internal Uid at the remote datastore:
</pre>
<p>Enter <code>ttuser</code> when prompted for the password of the internal user at the remote database.</p>
<p>If you want to use a specific local or remote network interface over which the database duplication occurs, you can optionally specify either by providing an alias or the IP address of the network interface. You can specify the local and remote network interfaces for the source and target hosts by using the <code>-localIP</code> and <code>-remoteIP</code> options of <code>ttRepAdmin -duplicate</code>. If you do not specify one or both network interfaces, TimesTen chooses them.</p>
<p>If you are <a id="sthref94"></a>duplicating an active database that has cache groups, use the <code>-keepCG</code> option. You must also specify the cache administration user name and password with the <code>-cacheUid</code> and <code>-cachePwd</code> options. If you do not provide the cache administration user password, <code>ttRepAdmin</code> prompts for a password. If the cache administration user name is <code>orauser</code> and the password is <code>orapwd</code>, duplicate database <code>dsn1</code> on <code>host1</code>:</p>
<pre>ttRepAdmin -duplicate -from dsn1 -host host1 -keepCG 
 -connStr &#34;DSN=dsn2;UID=;PWD=&#34;

Enter internal UID at the remote datastore with ADMIN privileges: ttuser 
Enter password of the internal Uid at the remote datastore:
</pre>
<p>Enter <code>ttuser</code> when prompted for the password. The <code>ttRepAdmin</code> utility then prompts for the cache administration user and password:</p>
<pre>Enter cache administrator UID: orauser
Enter cache administrator password: 
</pre>
<p>Enter <code>orapwd</code> when prompted for the cache administration password.</p>
<p>The <code>UID</code> and <code>PWD</code> for <code>dsn2</code> are specified as null values in the connection string so that the connection is made as the current OS user, which is the instance administrator. Only the instance administrator can run <code>ttRepAdmin -duplicate</code>. If <code>dsn2</code> is configured with <code>PWDCrypt</code> instead of <code>PWD</code>, then the connection string should be <code>&#34;DSN=dsn2;UID=;PWDCrypt=&#34;</code>.</p>
<p>When you duplicate a standby database with cache groups to a read-only subscriber, use the <code>-nokeepCG</code> option. In this example, <code>dsn2</code> is the standby database and <code>sub1</code> is the read-only subscriber:</p>
<pre>ttRepAdmin -duplicate -from dsn2 -host host2 -nokeepCG 
 -connStr &#34;DSN=sub1;UID=;PWD=&#34;
</pre>
<p>The <code>ttRepAdmin</code> utility prompts for values for <code>-uid</code> and <code>-pwd</code>.</p>
<p>If you cannot access the Oracle database (either the Oracle database is down or you cannot connect to it) while performing a duplicate for a replication scheme with AWT or incremental autorefresh cache groups, then the <code>ttRepAdmin -duplicate</code> command cannot update the metadata on the Oracle database (that cache uses to manage AWT and autorefresh cache groups) after AWT or incremental autorefresh cache groups are duplicated. In this case, use one of the following options to perform the duplicate:</p>
<ul>
<li>
<p>If you are using <code>ttRepAdmin -duplicate</code> to recover either a failed active or standby master where all AWT or incremental autorefresh cache groups are included in the active standby pair replication scheme, then use the <code>-keepCG -recoveringNode</code> options. When this option is used, changes that occur during the duplicate operation are tracked and so may not need to initiate a full autorefresh.</p>
</li>
<li>
<p>Otherwise, use the <code>-keepCG -deferCacheUpdate</code> options. This option may initiate a full autorefresh.</p>
</li>
</ul>
<p>After completion of the duplicate operation with either <code>-keepCG -recoveringNode</code> options or <code>-keepCG -deferCacheUpdate</code> options, warning messages are posted informing you that while the duplicate operation was successful, updates to the Oracle database metadata are deferred until the cache and replication agents are started. Thus, once the duplicate operation is complete, start both the cache and replication agents on the new node. If there are cascading TimesTen node failures and intermittent connectivity problems with the Oracle database, then starting the cache and replication agents may initiate a full autorefresh.</p>
<p>For more information about the <code>ttRepAdmin</code> utility, see <a class="olink TTREF353" href="../TTREF/util.htm#TTREF353">&#34;ttRepAdmin&#34;</a> in <span class="italic">Oracle TimesTen In-Memory Database Reference</span>. For more information about the <code>ttRepDuplicateEx</code> C function, see <a class="olink TTCDV380" href="../TTCDV/c_ref.htm#TTCDV380">&#34;ttRepDuplicateEx&#34;</a> in <span class="italic">Oracle TimesTen In-Memory Database C Developer&#39;s Guide</span>.</p>
</div>
<!-- class="sect1" -->
<a id="CHDFADGF"></a>
<div id="TTREP178" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Restrictions on active standby pairs<a id="sthref95"></a><a id="sthref96"></a></h2>
<p>When you are planning an active standby pair, keep in mind the following:</p>
<ul>
<li>
<p>For the initial setup, you create the standby database by duplicating the active database with the <code>ttRepAdmin</code> <code>-duplicate</code> utility or the <code>ttRepDuplicateEx</code> C function.</p>
</li>
<li>
<p>To ensure high availability, each active and standby master databases as well as all subscriber databases should be on different machines.</p>
</li>
<li>
<p>To avoid performance issues, especially in intensive operations such as a master database catchup, standby master recovery, or processing a return service, we strongly recommend that the network has a latency of less than 100 milliseconds between the hosts on which the master databases are installed.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
When using return services, the active master waits for a response from the standby master. If the bandwidth causes the latency response time to exceed the defined timeout, the performance of the transaction is negatively affected. For more information on the timeout period for return services, see <a href="attrib.htm#CHDHHAGE">&#34;Setting the return service timeout period&#34;</a>.</div>
</li>
<li>
<p>The clock skew between the active node and the standby node cannot exceed 250 milliseconds. When adjusting the system clocks on any nodes to be synchronized with each other, do not set any clock backward in time.</p>
</li>
<li>
<p><code>ALTER ACTIVE STANDBY PAIR</code> statements can be executed only on the active database. If <code>ALTER ACTIVE STANDBY PAIR</code> is executed on the active database, then the standby database must be regenerated by duplicating the active database. All subscribers must also be regenerated from the standby database. See <a href="#CBAGAJGF">&#34;Duplicating a database&#34;</a>.</p>
</li>
<li>
<p>Read-only subscribers can be created only by duplicating the standby database. If the standby database is unavailable, then the read-only subscribers can be created by duplicating the active database. See <a href="#CBAGAJGF">&#34;Duplicating a database&#34;</a>.</p>
</li>
<li>
<p>You can specify at most 127 subscriber databases.</p>
</li>
<li>
<p>Replication from the standby database to the read-only subscribers occurs asynchronously.</p>
</li>
<li>
<p>Writes on replicated tables are not allowed on the standby database or the subscriber databases. However, operations on sequences and XLA bookmarks <span class="italic">are</span> allowed on the standby database and the subscriber databases. Reads are also allowed.</p>
</li>
<li>
<p>After failover, the new standby database can only be recovered from the active database by duplicating the active database <span class="italic">unless</span> return twosafe replication is used between the active and the standby databases. If return twosafe replication is used, the automated master catch-up feature may be used instead. See <a href="failure.htm#CFHHHGGG">&#34;Automatic catch-up of a failed master database&#34;</a>.</p>
</li>
<li>
<p>You cannot replicate a temporary <a id="sthref97"></a>database.</p>
</li>
<li>
<p>You cannot replicate tables with compressed columns.</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="CHDBGEGH"></a>
<div id="TTREP179" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Defining the DSNs for the databases<a id="sthref98"></a><a id="sthref99"></a></h2>
<p>Before you define the active standby pair, define the DSNs for the active, standby, and read-only subscriber databases. On UNIX, create an <code>odbc.ini</code> file. On Windows, use the ODBC Administrator to name the databases and set connection attributes. See <a href="gettingstarted.htm#CHDHFBED">&#34;Step 1: Create the DSNs for the master and the subscriber databases&#34;</a> for an example.</p>
<p>Each database &#34;name&#34; specified in a replication scheme must match the prefix of the database file name (without the path) given for the <code>DataStore</code> data store attribute in the DSN definition for the database. To avoid confusion, use the same name for both the <code>DataStore</code> and <code>Data Source Name</code> data store attributes in each DSN definition. Values for <code>DataStore</code> are case-sensitive. For example, if the database path is <code><span class="codeinlineitalic">directory</span></code><code>/</code><code><span class="codeinlineitalic">subdirectory</span></code><code>/foo.ds0</code>, then <code>foo</code> is the database name that you should use.</p>
</div>
<!-- class="sect1" -->
<a id="BABDIIGH"></a>
<div id="TTREP692" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Table requirements <a id="sthref100"></a>for active standby pairs</h2>
<p>Before you can create an active standby pair, you must create an object to be replicated.</p>
<p>Tables that are replicated in an active standby pair must have one of the following:</p>
<ul>
<li>
<p>A primary key</p>
</li>
<li>
<p>A unique index over non-nullable columns</p>
</li>
</ul>
<p>Replication uses the primary key or unique index to identify each row in the replicated table. Replication always selects the first usable index that turns up in a sequential check of the table&#39;s index array. If there is no primary key, replication selects the first unique index without <code>NULL</code> columns it encounters. The selected index on the replicated table in the active database must also exist on its counterpart table in the standby database.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The keys on replicated tables are transmitted in each update record to the subscribers. Smaller keys are transmitted more efficiently.</div>
<p>Replicated tables have these data type restrictions:</p>
<ul>
<li>
<p><a id="sthref101"></a><a id="sthref102"></a><a id="sthref103"></a><a id="sthref104"></a><a id="sthref105"></a><a id="sthref106"></a><a id="sthref107"></a><code>VARCHAR2</code>, <code>NVARCHAR2</code>, <code>VARBINARY</code> and <code>TT_VARCHAR</code> columns in replicated tables are limited to a size of 4 megabytes. For a <code>VARCHAR2</code> column, the maximum length when using character length semantics depends on the number of bytes each character occupies when using a particular database character set. For example, if the character set requires four bytes for each character, the maximum possible length is one million characters. For an <code>NVARCHAR2</code> column, which requires two bytes for each character, the maximum length when using character length semantics is two million characters.</p>
</li>
<li>
<p><a id="sthref108"></a>Columns with the <code>BLOB</code> data type in replicated tables are limited to a size of 16 megabytes. Columns with the <code>CLOB</code> or <code>NCLOB</code> data type in replicated tables are limited to a size of 4 megabytes.</p>
</li>
<li>
<p>A primary key column cannot have a LOB data type.</p>
</li>
</ul>
<p>You cannot replicate tables with <a id="sthref109"></a><a id="sthref110"></a>compressed columns.</p>
</div>
<!-- class="sect1" -->
<a id="CHDBDJBB"></a>
<div id="TTREP180" class="sect1">
<h2 class="sect1">Defining an active standby pair replication scheme</h2>
<p>Use the <code>CREATE ACTIVE STANDBY PAIR</code> SQL statement to create an active standby pair replication scheme. You must have the <a id="sthref111"></a><a id="sthref112"></a><code>ADMIN</code> privilege to use the <code>CREATE ACTIVE STANDBY PAIR</code> statement and to perform other replication operations. Only the instance administrator can duplicate databases.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
See <a href="gettingstarted.htm#CHDFDCBH">&#34;Step 3: Define the active standby pair&#34;</a> for an example. See <a class="olink TTSQL289" href="../TTSQL/state.htm#TTSQL289">&#34;CREATE ACTIVE STANDBY PAIR&#34;</a> for the complete syntax in the <span class="italic">Oracle TimesTen In-Memory Database SQL Reference</span>.</div>
<p><a href="#CHDEEEII">Table 3-1</a> shows the components of the <code>CREATE ACTIVE STANDBY PAIR</code> statement that are used to create the active standby pair replication scheme. Each component is described with the identified topics in this chapter.</p>
<div id="TTREP181" class="tblhruleformal">
<p class="titleintable"><a id="sthref113"></a><a id="CHDEEEII"></a>Table 3-1 Components <a id="sthref114"></a>of an active standby pair replication scheme</p>
<table class="cellalignment5810" title="Components of an active standby pair replication scheme" summary="This table provides references to information about the components of a replication scheme." dir="ltr">
<thead>
<tr class="cellalignment5804">
<th class="cellalignment5811" id="r1c1-t5">Component</th>
<th class="cellalignment5811" id="r1c2-t5">See...</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment5804">
<td class="cellalignment5812" id="r2c1-t5" headers="r1c1-t5">
<p><code>CREATE ACTIVE STANDBY PAIR</code> <code><span class="codeinlineitalic">FullDatabaseName, FullDatabaseName</span></code></p>
</td>
<td class="cellalignment5812" headers="r2c1-t5 r1c2-t5">
<p><a href="#CHDDHHCE">&#34;Identifying the databases in the active standby pair&#34;</a></p>
</td>
</tr>
<tr class="cellalignment5804">
<td class="cellalignment5812" id="r3c1-t5" headers="r1c1-t5">
<p><code>[</code><code><span class="codeinlineitalic">ReturnServiceAttribute</span></code><code>]</code></p>
</td>
<td class="cellalignment5812" headers="r3c1-t5 r1c2-t5">
<p><a href="attrib.htm#CHDHCDCB">&#34;Using a return service&#34;</a></p>
</td>
</tr>
<tr class="cellalignment5804">
<td class="cellalignment5812" id="r4c1-t5" headers="r1c1-t5">
<p><code>[SUBSCRIBER</code> <code><span class="codeinlineitalic">FullDatabaseName</span></code> <code>[,...]]</code></p>
</td>
<td class="cellalignment5812" headers="r4c1-t5 r1c2-t5">
<p><a href="#CHDDHHCE">&#34;Identifying the databases in the active standby pair&#34;</a></p>
</td>
</tr>
<tr class="cellalignment5804">
<td class="cellalignment5812" id="r5c1-t5" headers="r1c1-t5">
<p><code>[STORE</code> <code><span class="codeinlineitalic">FullDatabaseName</span></code> <code>[</code><code><span class="codeinlineitalic">StoreAttribute</span></code> <code>[...]]]</code></p>
</td>
<td class="cellalignment5812" headers="r5c1-t5 r1c2-t5">
<p><a href="attrib.htm#CHDFAGAB">&#34;Setting STORE attributes&#34;</a></p>
</td>
</tr>
<tr class="cellalignment5804">
<td class="cellalignment5812" id="r6c1-t5" headers="r1c1-t5">
<p><code>[</code><code><span class="codeinlineitalic">NetworkOperation</span></code> <code>[...]]</code></p>
</td>
<td class="cellalignment5812" headers="r6c1-t5 r1c2-t5">
<p><a href="attrib.htm#CHDBICJF">&#34;Configuring network interfaces with the ROUTE clause&#34;</a></p>
</td>
</tr>
<tr class="cellalignment5804">
<td class="cellalignment5812" id="r7c1-t5" headers="r1c1-t5">
<p><code>[{INCLUDE|EXCLUDE}</code></p>
<p><code>{TABLE [[</code><code><span class="codeinlineitalic">Owner</span></code><code>.]</code><code><span class="codeinlineitalic">TableName</span></code><code>[,...]]|</code></p>
<p><code>CACHE GROUP [[</code><code><span class="codeinlineitalic">Owner</span></code><code>.]</code><code><span class="codeinlineitalic">CacheGroupName</span></code><code>[,...]</code><code>|</code></p>
<p><code>SEQUENCE [[</code><code><span class="codeinlineitalic">Owner</span></code><code>.]</code><code><span class="codeinlineitalic">SequenceName</span></code><code>[,...]]}</code></p>
<p><code>[,...]]</code></p>
</td>
<td class="cellalignment5812" headers="r7c1-t5 r1c2-t5">
<p><a href="#CHDHFDJI">&#34;Including or excluding database objects from replication&#34;</a></p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblhruleformal" --></div>
<!-- class="sect1" -->
<a id="CHDDHHCE"></a>
<div id="TTREP182" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Identifying the databases in the active standby pair</h2>
<p>The first component identifies the active database, standby database, and any subscriber databases. The first database name designates the active database. The second database name designates the standby database. Read-only subscriber databases are indicated by the <code>SUBSCRIBER</code> clause.</p>
<p>Use the <a id="sthref115"></a><a id="sthref116"></a><a id="sthref117"></a>full database name described in <a href="#CHDBGEGH">&#34;Defining the DSNs for the databases&#34;</a>.</p>
<pre>Command&gt; CREATE ACTIVE STANDBY PAIR master1, master2
       &gt; SUBSCRIBER subscriber1;
</pre>
<p>The active database and the standby database should be on separate hosts to achieve a highly available system. Read-only subscribers can be either local or remote. A remote subscriber provides protection from site-specific disasters.</p>
<p>You can also specify the hosts where the databases reside by using an IP address or a literal host name surrounded by double quotes. Provide a host ID as part of <code><span class="codeinlineitalic">FullDatabaseName</span></code>:</p>
<pre><span class="italic">DatabaseName</span> [ON <span class="italic">Host</span>]
</pre>
<p><code><span class="codeinlineitalic">Host</span></code> can be either an IP address or a literal host name. Use the value returned by the <code><span class="codeinlineitalic">hostname</span></code> operating system command. It is good practice to surround a host name with double quotes. For example:</p>
<pre>Command&gt; CREATE ACTIVE STANDBY PAIR 
  &gt; repdb1 ON &#34;host1&#34;, 
  &gt; repdb2 ON &#34;host2&#34;;
</pre></div>
<!-- class="sect1" -->
<a id="CHDBDADH"></a>
<div id="TTREP778" class="sect1">
<h2 class="sect1">Using a return service for an active standby pair<a id="sthref118"></a><a id="sthref119"></a></h2>
<p>You can configure your replication scheme with a return service to ensure a higher level of confidence that your replicated data is consistent on the active and standby databases. For full details on how to configure a return service for your replication scheme, see <a href="attrib.htm#CHDHCDCB">&#34;Using a return service&#34;</a>.</p>
</div>
<!-- class="sect1" -->
<a id="CHDDHCFC"></a>
<div id="TTREP779" class="sect1">
<h2 class="sect1">Setting STORE attribute<a id="sthref120"></a>s for an active standby pair</h2>
<p>The <code>STORE</code> attributes clause in either the <code>CREATE ACTIVE STANDBY PAIR</code> or <code>ALTER ACTIVE STANDBY PAIR</code> statements are used to set optional behavior for return services, compression, timeouts, durable commit behavior, and table definition checking. See <a class="olink TTSQL289" href="../TTSQL/state.htm#TTSQL289">&#34;CREATE ACTIVE STANDBY PAIR&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database SQL Reference</span> for a full description of <code>STORE</code> attributes.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you are using <code>ALTER ACTIVE STANDBY PAIR</code> to change any of the <code>STORE</code> attributes, you must follow the steps described in <a href="alterpair.htm#BABJAICG">&#34;Making other changes to an active standby pair&#34;</a>.</div>
<p>See <a href="attrib.htm#CHDFAGAB">&#34;Setting STORE attributes&#34;</a> for more details on how to use and configure the <code>STORE</code> attributes for an active standby pair.</p>
</div>
<!-- class="sect1" -->
<a id="CHDGDBHC"></a>
<div id="TTREP780" class="sect1">
<h2 class="sect1">Configuring network operations for an active standby pair<a id="sthref121"></a><a id="sthref122"></a></h2>
<p>If a replication host has more than one network interface, you may want to configure replication to use an interface other than the default interface. For details, see <a href="attrib.htm#CHDBICJF">&#34;Configuring network interfaces with the ROUTE clause&#34;</a>.</p>
</div>
<!-- class="sect1" -->
<a id="CHDEIBIA"></a>
<div id="TTREP751" class="sect1">
<h2 class="sect1">Using auto<a id="sthref123"></a><a id="sthref124"></a><a id="sthref125"></a>matic client failover for an active standby pair</h2>
<p>Automatic client failover is for use in High Availability scenarios with a TimesTen active standby pair replication configuration. If failure of the active TimesTen node results in the original standby node becoming the new active node, then automatic client failover feature automatically transfers the application connection to the new active node.</p>
<p>For full details on how to configure and use automatic client failover, see <a class="olink TTOPR736" href="../TTOPR/client_server.htm#TTOPR736">&#34;Using automatic client failover&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Operations Guide</span>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Automatic client failover is complementary to Oracle Clusterware in situations where Oracle Clusterware is used, but the two features are not dependent on each other. For information about Oracle Clusterware, you can refer to <a href="cluster.htm#CCHCFAAD">Chapter 8, &#34;Using Oracle Clusterware to Manage Active Standby Pairs&#34;</a>.</div>
</div>
<!-- class="sect1" -->
<a id="CHDHFDJI"></a>
<div id="TTREP209" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Including or excluding <a id="sthref126"></a><a id="sthref127"></a><a id="sthref128"></a>database objects from replication</h2>
<p>An active standby pair replicates an entire database by default. Use the <code>INCLUDE</code> clause to replicate <span class="italic">only</span> the tables, cache groups and sequences that are listed in the <code>INCLUDE</code> clause. No other database objects are replicated in an active standby pair that is defined with an <code>INCLUDE</code> clause. For example, this <code>INCLUDE</code> clause specifies three tables to be replicated by the active standby pair:</p>
<pre>INCLUDE TABLE employees, departments, jobs
</pre>
<p>You can choose to exclude specific tables, cache groups or sequences from replication by using the <code>EXCLUDE</code> clause of the <code>CREATE ACTIVE STANDBY PAIR</code> statement. Use one <code>EXCLUDE</code> clause for each object type. For example:</p>
<pre>EXCLUDE TABLE ttuser.tab1, ttuser.tab2
EXCLUDE CACHE GROUP ttuser.cg1, ttuser.cg2
EXCLUDE SEQUENCE ttuser.seq1, ttuser.seq2
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
Sequences with the <code>CYCLE</code> attribute cannot be replicated.</div>
</div>
<!-- class="sect1" -->
<a id="CHDHDDDF"></a>
<div id="TTREP819" class="sect1">
<h2 class="sect1">Replicating tables with foreign key relationships in an active standby pair<a id="sthref129"></a><a id="sthref130"></a><a id="sthref131"></a><a id="sthref132"></a></h2>
<p>With the active standby pair replication scheme, you may choose to replicate all or a subset of tables that have foreign key relationships with one another. You can create the tables and the foreign key relationship on the active master either before or after the active standby pair replication scheme is created.</p>
<ul>
<li>
<p>Before creation of active standby pair: You can create the tables and the foreign key relationship on the active master before the active standby pair replication scheme is created. Then, create the active standby pair replication scheme.</p>
</li>
<li>
<p>After creation of active standby pair: You can create the tables and the foreign key relationship on the active master after the active standby pair replication scheme is created. In order for the tables to be automatically replicated to the standby master and added to the replication scheme, you must be using the default mode where <code>DDLReplicationLevel</code> is set to 2 or larger and <code>DDLReplicationAction=&#39;INCLUDE&#39;</code>.</p>
</li>
</ul>
<p>If a child table with a foreign key defines <code>ON DELETE CASCADE</code>, then you must replicate any other table with a foreign key relationship to the child table. This requirement prevents foreign key conflicts from occurring on the standby master tables when a cascade deletion occurs on the active master database.</p>
<p>TimesTen replicates a cascade deletion as a single operation, rather than replicating to the subscriber each individual row deletion which occurs on the child table when a row is deleted on the parent. As a result, any row on the child table on the subscriber database, which contains the foreign key value that was deleted on the parent table, is also deleted, even if that row did not exist on the child table on the master database.</p>
</div>
<!-- class="sect1" -->
<a id="BABIHIJJ"></a>
<div id="TTREP742" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Materialized views in an active standby pair<a id="sthref133"></a><a id="sthref134"></a><a id="sthref135"></a></h2>
<p>When you replicate a database containing a materialized or nonmaterialized view, only the detail tables associated with the view are replicated. The view itself is not replicated. A matching view can be defined on the standby database, but it is not required. If detail tables are replicated, TimesTen automatically updates the corresponding view. However, TimesTen replication verifies only that the replicated detail tables have the same structure on both databases. It does not enforce that the materialized views are the same on each database.</p>
</div>
<!-- class="sect1" -->
<a id="BABBJAFD"></a>
<div id="TTREP743" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Replicating sequences in an active standby pair<a id="sthref136"></a><a id="sthref137"></a></h2>
<p>Sequences are replicated unless you exclude them from the active standby pair or unless they have the <code>CYCLE</code> attribute. See <a href="#CHDHFDJI">&#34;Including or excluding database objects from replication&#34;</a>. Replication of sequences is optimized by reserving a range of sequence numbers on the standby database each time a sequence is updated on the active database. Reserving a range of sequence numbers reduces the number of updates to the transaction log. The range of sequence numbers is called a <span class="italic">cache</span>. Sequence updates on the active database are replicated only when they are followed by or used in replicated transactions.</p>
<p>Consider a sequence named <code>my.sequence</code> with a <code>MINVALUE</code> of 1, an <code>INCREMENT</code> of 1 and the default <code><span class="codeinlineitalic">Cache</span></code> of 20. The very first time that you reference <code>my.sequence.NEXTVAL</code>, the current value of the sequence on the active database is changed to 2, and a new current value of 21 (20+1) is replicated to the standby database. The next 19 references to <code>my.seq.NEXTVAL</code> on the active database result in no new current value being replicated, because the current value of 21 on the standby database is still ahead of the current value on the active database. On the twenty-first reference to <code>my.seq.NEXTVAL</code>, a new current value of 41 (21+20) is transmitted to the standby database because the previous current value of 21 on the standby database is now behind the value of 22 on the active database.</p>
<p>Operations on sequences such as <code>SELECT my.seq.NEXTVAL FROM sys.dual</code>, while incrementing the sequence value, are not replicated until they are followed by transactions on replicated tables. A side effect of this behavior is that these sequence updates are not purged from the log until followed by transactions on replicated tables. This causes <a id="sthref138"></a><code>ttRepSubscriberWait</code> and <code>ttRepAdmin</code> <code>-wait</code> to fail when only these sequence updates are present at the end of the log.</p>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5803">
<tr>
<td class="cellalignment5812">
<table class="cellalignment5808">
<tr>
<td class="cellalignment5807"><a href="gettingstarted.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5807"><a href="attrib.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2012, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5814">
<table class="cellalignment5806">
<tr>
<td class="cellalignment5807"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5807"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5807"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5807"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5807"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5807"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>