<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-1605"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/XML%20Schema%20Storage%20and%20Query%3A%20Basic"></a><title>XML Schema Storage and Query: Basic</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="description" content="XML Schema is a standard for describing the content and structure of XML documents. You can register, update, and delete an XML schema used with Oracle XML&nbsp;DB. You can define storage structures to use for your XML schema-based data and map XML Schema data types to SQL data types."/>
<meta name="keywords" content="XML schema, W3C Recommendation, definition, instance document, XML instance document, annotations, XML schema, annotations, DOM, fidelity, DOM, DOM fidelity, XMLType methods, XMLType, methods, methods, XMLType, isSchemaBased() XMLType method, isSchemaBased(), getSchemaURL() XMLType method, getSchemaURL(), schemaValidate() XMLType method, schemaValidate(), isSchemaValid(), isSchemaValidated() XMLType method, isSchemaValidated(), setSchemaValidated(), schema location hint, document location hint, registerSchema PL/SQL procedure, procedures, PL/SQL, registerSchema, DBMS_XMLSCHEMA PL/SQL package, registerSchema procedure, local and global, private (local) XML schema, definition, public (global) XML schema, definition, local XML schema, URLs, fully qualified XML schema URLs, qualified XML schema URLs, global XML schema, using fully qualified URL to override, using fully qualified URL to specify, deletion, deleting, XML schema using DBMS_XMLSCHEMA, registered XML schemas, list of, XML schema-based tables and columns, creating, tables, views, columns, creating an XMLType table, XML schema-based, storage options, CREATE TABLE statement, encoding options for binary XML, collection, XML"/>
<meta name="dcterms.created" content="2016-12-08T13:53:25Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="XML DB Developer&#39;s Guide"/>
<meta name="dcterms.identifier" content="E41152-15"/>
<meta name="dcterms.isVersionOf" content="ADXDB"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2002, 2016, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="xdb_storage.htm" title="Previous" type="text/html"/>
<link rel="Next" href="xdb06stt.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41152-15.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-C09824C1-6B02-4556-A265-B1749DEE8DE1"></a> <span id="PAGE" style="display:none;">29/61</span> <!-- End Header -->
<script>
//<![CDATA[
window.name='xdb05sto'
//]]>
</script> <script>
    function footdisplay(footnum,footnote) {
    var msg = window.open('', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');

    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">');
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>');
    msg.document.write('Footnote&amp;nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('');
    msg.document.write('<style> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]\u003e <\/style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
</script><noscript>
<p>The script content on this page is for navigation purposes only and does not alter the content in any way.</p>
</noscript><a id="ADXDB0600"></a>
<h1 id="ADXDB-GUID-C09824C1-6B02-4556-A265-B1749DEE8DE1" class="sect1"><span class="enumeration_chapter">17</span> XML Schema Storage and Query: Basic</h1>
<div>
<p>XML Schema is a standard for describing the content and structure of XML documents. You can register, update, and delete an XML schema used with Oracle XML&nbsp;DB. You can define storage structures to use for your XML schema-based data and map XML Schema data types to SQL data types.</p>
<p>The <a id="d83368e22" class="indexterm-anchor"></a>XML Schema Recommendation was created by the World Wide Web Consortium (W3C) to describe the content and structure of XML documents. It includes the full capabilities of <a id="d83368e27" class="indexterm-anchor"></a>Document Type Definitions (DTDs) so that existing DTDs can be converted to XML Schema. XML schemas have additional capabilities compared to DTDs.</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="xdb05sto.htm#GUID-DF33451A-6F65-4BBC-8834-80FBD687100B" title="The W3C XML Schema Recommendation defines a standardized language for specifying the structure, content, and certain semantics of a set of XML documents. An XML schema can be considered as the metadata that describes a class of XML documents.">Overview of XML Schema</a></p>
</li>
<li>
<p><a href="xdb05sto.htm#GUID-CD1BA605-196D-461C-9707-6A0B870F1172" title="Oracle XML&nbsp;DB supports registering XML schemas, validating documents against an XML schema, generating XML schemas from SQL object types, mapping from XML Schema to SQL, creating and querying XML Schema-based tables, views, and columns, and automatically inserting data when XML Schema-based documents are inserted into Oracle XML&nbsp;DB Repository.">Overview of Using XML Schema with Oracle XML&nbsp;DB</a></p>
</li>
<li>
<p><a href="xdb05sto.htm#GUID-E27F30C8-3081-403B-B75C-4A84C3F256EF" title="Before an XML schema can be used by Oracle XML&nbsp;DB, you must register it. It can then be used to create XMLType tables and columns and to validate XML documents. If schema registration fails then the database is restored to the state it had prior to the registration attempt.">XML Schema Registration with Oracle XML&nbsp;DB</a></p>
</li>
<li>
<p><a href="xdb05sto.htm#GUID-A7862EBA-F10A-43BA-A540-933529E514E5" title="You can create XMLType tables and columns that are constrained to a global element defined by an XML schema. After an XMLType column has been constrained to a particular element and a particular schema, it can only contain documents that are compliant with the schema definition of that element.">Creation of XMLType Tables and Columns Based on XML Schemas</a></p>
</li>
<li>
<p><a href="xdb05sto.htm#GUID-43D926FC-083A-4CBB-8B3A-A157462D51F6" title="Before an XML document can be inserted into an XML Schema-based XMLType table or column, the associated XML schema must be identified. You can do this when you create the table or column, or you can use XMLSchema-instance to explicitly add the required schema identification to the XML instance document.">Ways to Identify XML Schema Instance Documents</a></p>
</li>
<li>
<p><a href="xdb05sto.htm#GUID-F5DA0566-E0D0-49C8-A846-1CE5067E15F4" title="Data that conforms to an XML schema uses XML Schema data types. When this XML data is stored in Oracle XML&nbsp;DB, its storage data types are derived from the XML Schema data types using a default mapping and, optionally, using mapping information that you specify using XML schema annotations.">XML Schema Data Types Are Mapped to Oracle XML&nbsp;DB Storage</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-C09824C1-6B02-4556-A265-B1749DEE8DE1__GUID-977C4EA2-6C98-4748-AE8E-D345ADF363AB">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="xdb06stt.htm#GUID-B0C1A0B0-2DD1-491A-8CE1-1F857FD267B7" title="Advanced techniques for XML Schema-based data include using object-relational storage; annotating XML schemas; mapping Schema data types to SQL; using complexType extensions and restrictions; creating, specifying relational constraints on, and partitioning XML Schema-based data, storing XMLType data out of line, working with complex or large schemas, and debugging schema registration.">XML Schema Storage and Query: Object-Relational Storage</a> for more advanced information about using XML Schema with Oracle XML&nbsp;DB</p>
</li>
<li>
<p><a href="xdb_rewrite.htm#GUID-35551023-CCAC-477B-8BBF-CD0E0B44C962" title="For XMLType data stored object-relationally, queries involving XPath expression arguments to various SQL functions can often be automatically rewritten to queries against the underlying SQL tables, which are highly optimized.">XPath Rewrite for Object-Relational Storage</a> for information about the optimization of XPath expressions in Oracle XML&nbsp;DB</p>
</li>
<li>
<p><a href="http://www.w3.org/TR/xmlschema-0/" target="_blank"><code>http://www.w3.org/TR/xmlschema-0/</code></a> for an introduction to XML Schema</p>
</li>
</ul>
</div>
</div>
<a id="ADXDB6296"></a>
<div class="props_rev_3"><a id="GUID-DF33451A-6F65-4BBC-8834-80FBD687100B"></a>
<h2 id="ADXDB-GUID-DF33451A-6F65-4BBC-8834-80FBD687100B" class="sect2"><span class="enumeration_section">17.1</span> Overview of XML Schema</h2>
<div>
<p>The W3C XML Schema Recommendation defines a standardized language for specifying the structure, content, and certain semantics of a set of XML documents. An XML schema can be considered as the metadata that describes a class of XML documents.</p>
<p>The XML Schema Recommendation is described at: <a href="http://www.w3.org/TR/xmlschema-0/" target="_blank"><code>http://www.w3.org/TR/xmlschema-0/</code></a></p>
<p>This documentation refers to an XML Schema instance definition as an <strong class="term">XML schema</strong> (lowercase).</p>
</div>
<a id="ADXDB6297"></a>
<div class="props_rev_3"><a id="GUID-89C13D9D-C554-4080-B683-756FE129C790"></a>
<h3 id="ADXDB-GUID-89C13D9D-C554-4080-B683-756FE129C790" class="sect3"><span class="enumeration_section">17.1.1</span> XML Schema for Schemas</h3>
<div>
<p>The W3C Schema working group publishes an XML schema, often referred to as the &#34;Schema for Schemas&#34;. This XML schema provides the definition, or vocabulary, of the XML Schema language. All valid XML schemas can be considered to be members of the class defined by this XML schema.</p>
<p>An XML schema is thus an XML document that conforms to the class defined by the XML schema published at <a href="http://www.w3.org/2001/XMLSchema" target="_blank"><code>http://www.w3.org/2001/XMLSchema</code></a>.</p>
</div>
</div>
<a id="ADXDB6298"></a>
<div class="props_rev_3"><a id="GUID-8EF2B93D-D9EF-4AEC-88EF-A14AC88F06DB"></a>
<h3 id="ADXDB-GUID-8EF2B93D-D9EF-4AEC-88EF-A14AC88F06DB" class="sect3"><span class="enumeration_section">17.1.2</span> XML Schema Features</h3>
<div>
<p>XML Schema defines 47 scalar data types, for strong typing of elements and attributes. It supports object-oriented inheritance and extension, so you can design an XML schema with complex objects from base data types. It includes constructs for defining and ordering, default values, mandatory content, nesting, repeated sets, and redefines.</p>
<p>Oracle XML&nbsp;DB supports all of the constructs defined by XML Schema, except for redefines.</p>
</div>
</div>
<a id="ADXDB6299"></a>
<div class="props_rev_3"><a id="GUID-4FB64E7A-AE63-48B9-8FC1-BFEE055E7D6C"></a>
<h3 id="ADXDB-GUID-4FB64E7A-AE63-48B9-8FC1-BFEE055E7D6C" class="sect3"><span class="enumeration_section">17.1.3</span> XML Instance Documents</h3>
<div>
<p>Documents conforming to an XML schema can be considered as instances of the class defined by that XML schema. A common use of an XML schema is to validate that a given such <strong class="term">instance document</strong>conforms to the rules defined by the XML schema.</p>
</div>
</div>
<a id="ADXDB6300"></a>
<div class="props_rev_3"><a id="GUID-FB7F9AFB-117B-40F4-B74B-77EED9ED9511"></a>
<h3 id="ADXDB-GUID-FB7F9AFB-117B-40F4-B74B-77EED9ED9511" class="sect3"><span class="enumeration_section">17.1.4</span> XML Namespaces and XML Schemas</h3>
<div>
<p>An XML schema can specify a <code>targetNamespace</code> attribute, whose value is a URL. If omitted, the schema has no target namespace. The target namespace is the namespace for everything defined in the XML schema. The <code>targetNamespace</code> value is typically a URL where the XML schema can be accessed.</p>
<p>An XML instance document must specify the namespace<a id="d83368e294" class="indexterm-anchor"></a> of the root element of the document (same as the target namespace of the XML schema that the instance conforms to) and the location (URL) of the XML schema that defines this root element. This information is specified by attribute <code>xsi:schemaLocation</code>. When the XML schema has no target namespace, use attribute <code>xsi:noNamespaceSchemaLocation</code> to specify the schema URL.</p>
</div>
</div>
<a id="ADXDB6302"></a><a id="ADXDB6301"></a>
<div class="props_rev_3"><a id="GUID-23D89612-2661-48FE-9DBD-41C37EB3BBE4"></a>
<h3 id="ADXDB-GUID-23D89612-2661-48FE-9DBD-41C37EB3BBE4" class="sect3"><span class="enumeration_section">17.1.5</span> Overview of Editing XML Schemas</h3>
<div>
<p>You can author and edit XML schemas anyway you like.</p>
<p>For example, you can use any of the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>A simple text editor, such as Emacs or vi</p>
</li>
<li>
<p>An XML Schema-aware editor, such as the XML editor included with Oracle JDeveloper</p>
</li>
<li>
<p>An explicit XML Schema authoring tool, such as XMLSpy from Altova Corporation</p>
</li>
</ul>
<p><a href="xdb05sto.htm#GUID-23D89612-2661-48FE-9DBD-41C37EB3BBE4__CEGDDAHG">Figure 17-1</a> shows a purchase-order XML schema being edited using XMLSpy. XMLSpy is a graphical XML tool from Altova Corporation that you can use to create and edit XML schemas and other XML documents. See <a href="http://www.altova.com" target="_blank"><code>http://www.altova.com</code></a> for details.<a id="fn_1" href="#fn_1" onclick="footdisplay(1,&#34;XMLSpy also supports WebDAV and FTP protocols, so you can use it to directly access and edit content stored in Oracle XML&nbsp;DB Repository. &#34;)"><sup>Foot&nbsp;1</sup></a></p>
<div class="figure" id="GUID-23D89612-2661-48FE-9DBD-41C37EB3BBE4__CEGDDAHG">
<p class="titleinfigure">Figure 17-1 XMLSpy Graphical Representation of a Purchase-Order XML Schema</p>
<img width="874" height="690" src="img/GUID-0AF42C51-7B46-4DB9-8751-5AEEF2EE2B2E-default.gif" alt="Description of Figure 17-1 follows" title="Description of Figure 17-1 follows"/><br/>
<a href="img_text/GUID-0AF42C51-7B46-4DB9-8751-5AEEF2EE2B2E-default.htm">Description of &#34;Figure 17-1 XMLSpy Graphical Representation of a Purchase-Order XML Schema&#34;</a></div>
<!-- class="figure" --></div>
</div>
</div>
<a id="ADXDB6303"></a>
<div class="props_rev_3"><a id="GUID-CD1BA605-196D-461C-9707-6A0B870F1172"></a>
<h2 id="ADXDB-GUID-CD1BA605-196D-461C-9707-6A0B870F1172" class="sect2"><span class="enumeration_section">17.2</span> Overview of Using XML Schema with Oracle XML&nbsp;DB</h2>
<div>
<p>Oracle XML&nbsp;DB supports registering XML schemas, validating documents against an XML schema, generating XML schemas from SQL object types, mapping from XML Schema to SQL, creating and querying XML Schema-based tables, views, and columns, and automatically inserting data when XML Schema-based documents are inserted into Oracle XML&nbsp;DB Repository.</p>
<p>XML schemas are stored in Oracle XML&nbsp;DB as <code>XMLType</code> instances, just like the XML documents that reference them. You must <span class="italic">register</span> an XML schema with Oracle XML&nbsp;DB in order to use it with XML data that is stored in the database.</p>
<p>Oracle XML&nbsp;DB takes advantage of the strong typing and other features of XML Schema to process XML database data safely and efficiently.</p>
<p>To be registered with Oracle XML&nbsp;DB, an XML schema must conform to the the <a id="d83368e393" class="indexterm-anchor"></a><strong class="term">root XML Schema</strong>, <a id="d83368e400" class="indexterm-anchor"></a><strong class="term">XDBSchema.xsd</strong>. This is the <a id="d83368e407" class="indexterm-anchor"></a>XML schema for Oracle XML&nbsp;DB XML schemas. You can access <code>XDBSchema.xsd</code> at Oracle XML&nbsp;DB Repository location <code>/sys/schemas/PUBLIC/xmlns.oracle.com/xdb/XDBSchema.xsd</code>.</p>
<p>Oracle XML&nbsp;DB uses <span class="italic">annotated</span> XML schemas as metadata. The standard XML Schema definitions are used, along with several Oracle namespace attributes. These attributes determine how XML instance documents get mapped to the database. Because these attributes are in a different namespace from the XML Schema namespace, such annotated XML schemas respect the XML Schema standard.</p>
<p>Oracle XML&nbsp;DB provides XML Schema support for the following tasks:</p>
<ul style="list-style-type: disc;">
<li>
<p>Registering W3C-compliant XML schemas, both local and global.</p>
</li>
<li>
<p>Validating your XML documents against registered XML schema definitions.</p>
</li>
<li>
<p>Generating XML schemas from SQL object types.</p>
</li>
<li>
<p>Referencing an XML schema owned by another user.</p>
</li>
<li>
<p>Referencing a global XML schema when a local XML schema exists with the same name.</p>
</li>
<li>
<p>Generating a database mapping from your XML schemas during XML schema registration. This includes generating SQL object types, collection types, and default tables, and capturing the mapping information using XML schema attributes.</p>
</li>
<li>
<p>Specifying a particular SQL data type mapping when there are multiple allowed mappings.</p>
</li>
<li>
<p>Creating <code>XMLType</code> tables, views, and columns based on registered XML schemas.</p>
</li>
<li>
<p>Manipulating and querying XML schema-based <code>XMLType</code> tables.</p>
</li>
<li>
<p>Automatically inserting data into default tables when XML schema-based documents are inserted into Oracle XML&nbsp;DB Repository using protocols (FTP, HTTP(S)/WebDAV) and languages other than SQL.</p>
</li>
</ul>
</div>
<a id="ADXDB6304"></a>
<div class="props_rev_3"><a id="GUID-A708BD08-16C2-4E67-BF64-F8213A4FBAB9"></a>
<h3 id="ADXDB-GUID-A708BD08-16C2-4E67-BF64-F8213A4FBAB9" class="sect3"><span class="enumeration_section">17.2.1</span> Why Use XML Schema with Oracle XML&nbsp;DB?</h3>
<div>
<p>Common reasons to use XML Schema include validation, constraint definition, storage specification, and optimization of document insertion, storage, and access.</p>
<ul style="list-style-type: disc;">
<li>
<p>The most common use of XML Schema is as a mechanism for <span class="italic">validating</span> that XML instance documents conform to a given XML schema, that is, verify that your XML data conforms to its intended definition. This definition includes data types, numbers of allowed item occurrences, and allowed lengths of items.</p>
</li>
<li>
<p>An XML schema can also be used as a <span class="italic">constraint</span> when creating <code>XMLType</code> tables or columns. For example, the table or column can be constrained to store only XML documents that compliant with one of the global elements defined by the XML schema.</p>
</li>
<li>
<p>Oracle XML&nbsp;DB also uses XML Schema as a mechanism for defining how the contents of an <code>XMLType</code> instance should be stored inside the database. Both binary XML and object-relational storage models for <code>XMLType</code> support the use of XML Schema. When <code>XMLType</code> data is stored object-relationally, XML Schema is used to efficiently map XML Schema data types to SQL data types and object-relational tables and columns.</p>
</li>
<li>
<p>XML schema information can also improve the efficiency of document insertion when you storing XML Schema-based documents in Oracle XML&nbsp;DB using protocols FTP and HTTP(S).</p>
</li>
<li>
<p>When XML instances must be handled without any prior information about them, XML schemas can be useful in predicting optimum storage, fidelity, and access.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-A708BD08-16C2-4E67-BF64-F8213A4FBAB9__GUID-C156EACC-A5B2-46EC-BCF6-5FEB478639D4">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="xdb01int.htm#GUID-B8507F44-B010-4384-94E6-101131DD7D88" title="XMLType is an abstract data type that provides different storage models to best fit your data and your use of it. As an abstract data type, your applications and database queries gain in flexibility: the same interface is available for all XMLType operations.">XMLType Storage Models</a>&#34;</span></p>
</div>
</div>
</div>
<a id="ADXDB6309"></a><a id="ADXDB6307"></a>
<div class="props_rev_3"><a id="GUID-0E11429E-1FF3-4C75-8B50-416A7F5C60C8"></a>
<h3 id="ADXDB-GUID-0E11429E-1FF3-4C75-8B50-416A7F5C60C8" class="sect3"><span class="enumeration_section">17.2.2</span> Overview of Annotating an XML Schema to Control Naming, Mapping, and Storage</h3>
<div>
<p>The W3C XML Schema Recommendation lets vendor-specific annotations be added to an XML schema. Oracle XML&nbsp;DB uses annotations to control the mapping between an XML schema and various database features. You can use annotations to specify which tables store XML data. Annotation is especially useful for object-relational storage.</p>
<p>You can use XML schema annotations with Oracle XML&nbsp;DB to do the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>Specify which database tables are used to store the XML data.</p>
</li>
<li>
<p>Override the default mapping between XML Schema data types and SQL data types, for object-relational storage.</p>
</li>
<li>
<p>Name the database objects and attributes that are created to store XML data (for object-relational storage).</p>
</li>
</ul>
<p><a href="apphxdb.htm#GUID-1CB2213C-C6E8-4BC4-86A3-EFDE51AEBEFD__BABDAGBF">Example A-2</a> shows an annotated purchase-order XML schema. It defines the following two XML namespaces:</p>
<ul style="list-style-type: disc;">
<li>
<p><code>http://www.w3c.org/2001/XMLSchema</code>. This is reserved by W3C for the Schema for Schemas.</p>
</li>
<li>
<p><code>http://xmlns.oracle.com/xdb</code>. This is reserved by Oracle for the Oracle XML&nbsp;DB schema annotations.</p>
</li>
</ul>
<p>Before annotating an XML schema you <span class="italic">must</span> declare the Oracle XML&nbsp;DB namespace. The Oracle XML&nbsp;DB namespace is <code>http://xmlns.oracle.com/xdb</code>. <a href="apphxdb.htm#GUID-1CB2213C-C6E8-4BC4-86A3-EFDE51AEBEFD__BABDAGBF">Example A-2</a> makes use of the namespace <span class="italic">prefix</span> <span class="bold"><code>xdb</code></span> to abbreviate the Oracle XML&nbsp;DB namespace.</p>
<p><a href="apphxdb.htm#GUID-1CB2213C-C6E8-4BC4-86A3-EFDE51AEBEFD__BABDAGBF">Example A-2</a> uses several XML schema annotations, including the following:</p>
<ul style="list-style-type: disc;">
<li>
<p><code>defaultTable</code> annotation in the <code>PurchaseOrder</code> element. This specifies that XML documents, compliant with this XML schema are stored in a database table called <code>purchaseorder</code>.</p>
</li>
<li>
<p><code>SQLType</code> annotation.</p>
<p>The first occurrence of annotation <code>SQLType</code> specifies that the name of the SQL data type generated from <code>complexType</code> element <code>PurchaseOrderType</code> is <code>purchaseorder_t</code>.</p>
<p>The second occurrence of annotation <code>SQLType</code> specifies that the name of the SQL data type generated from <code>complexType</code> element <code>LineItemType</code> is <code>lineitem_t</code>.</p>
</li>
<li>
<p><code>SQLCollType</code> annotation. This specifies that the name of the SQL varray type that manages the collection of <code>LineItem</code> elements is <code>lineitem_v</code>.</p>
</li>
<li>
<p><code>SQLName</code> annotation. This provides an explicit name for each SQL object attribute of <code>purchaseorder_t</code>.</p>
</li>
</ul>
<p><a href="xdb05sto.htm#GUID-0E11429E-1FF3-4C75-8B50-416A7F5C60C8__CEGIBHEB">Figure 17-2</a> shows the XMLSpy <span class="bold">Oracle</span> tab, which facilitates adding Oracle XML&nbsp;DB annotations to an XML schema while working in the graphical editor.</p>
<div class="figure" id="GUID-0E11429E-1FF3-4C75-8B50-416A7F5C60C8__CEGIBHEB">
<p class="titleinfigure">Figure 17-2 XMLSpy Support for Oracle XML&nbsp;DB Schema Annotations</p>
<img width="874" height="690" src="img/GUID-9DBC7285-BC3C-49A6-87AF-1B964CA38BEF-default.gif" alt="Description of Figure 17-2 follows" title="Description of Figure 17-2 follows"/><br/>
<a href="img_text/GUID-9DBC7285-BC3C-49A6-87AF-1B964CA38BEF-default.htm">Description of &#34;Figure 17-2 XMLSpy Support for Oracle XML&nbsp;DB Schema Annotations&#34;</a></div>
<!-- class="figure" --></div>
</div>
<a id="ADXDB4482"></a>
<div class="props_rev_3"><a id="GUID-F809A6FE-28CD-4776-AB11-0B34ECBD9FF6"></a>
<h3 id="ADXDB-GUID-F809A6FE-28CD-4776-AB11-0B34ECBD9FF6" class="sect3"><span class="enumeration_section">17.2.3</span> DOM Fidelity</h3>
<div>
<p>DOM fidelity means that all information in an XML document is preserved except whitespace that is insignificant. You can use DOM fidelity to ensure the accuracy and integrity of XML documents stored in Oracle XML&nbsp;DB.</p>
<p><strong class="term">Document Object Model (DOM) fidelity</strong> is the concept of retaining the structure of a retrieved XML document, compared to the original XML document, for DOM traversals.</p>
<p>With DOM fidelity, XML data retrieved from the database has the same information as before it was inserted into the database, with the single exception of insignificant whitespace. The term &#34;DOM fidelity&#34; is used because this kind of fidelity is particularly important for DOM traversals.</p>
<p>With binary XML storage of XML data, all of the significant information is encoded in the binary XML format, ensuring DOM fidelity.</p>
<div class="infoboxnotealso" id="GUID-F809A6FE-28CD-4776-AB11-0B34ECBD9FF6__GUID-7B1AFA1D-52A5-4F78-A2F8-88CCF7AD2C59">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="xdb06stt.htm#GUID-AF8651CF-49C5-4B13-A198-0AE1F0770439" title="In order to provide DOM fidelity for XML data that is stored object-relationally, Oracle XML&nbsp;DB records all information that cannot be stored in any of the other object attributes as instance-level metadata using the system-defined binary object attribute SYS_XDBPD$ (positional descriptor, or PD).">SYS_XDBPD$ and DOM Fidelity for Object-Relational Storage</a>&#34;</span> for information about DOM fidelity and object-relational storage of XML data</p>
</div>
</div>
</div>
<a id="ADXDB4476"></a><a id="ADXDB4475"></a>
<div class="props_rev_3"><a id="GUID-A6A640D9-3EE9-44D0-AE9D-A3CF66466EC6"></a>
<h3 id="ADXDB-GUID-A6A640D9-3EE9-44D0-AE9D-A3CF66466EC6" class="sect3"><span class="enumeration_section">17.2.4</span> XMLType Methods Related to XML Schema</h3>
<div>
<p>The most important <code>XMLType</code> methods for working with XML schemas are: <code>isSchemaBased()</code>, <code>getSchemaURL()</code>, <code>schemaValidate()</code>, <code>isSchemaValid()</code>, <code>isSchemaValidated()</code>, and <code>setSchemaValidated()</code>.</p>
<div class="tblformalwide" id="GUID-A6A640D9-3EE9-44D0-AE9D-A3CF66466EC6__g1048549">
<p class="titleintable">Table 17-1 XMLType Methods Related to XML Schema</p>
<table class="cellalignment3431" title="XMLType Methods Related to XML Schema " summary="This table describes XMLType API&rsquo;s eight XML Schema methods.">
<thead>
<tr class="cellalignment3411">
<th class="cellalignment3510" id="d83368e897">XMLType Method</th>
<th class="cellalignment3511" id="d83368e900">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment3411">
<td class="cellalignment3512" id="d83368e905" headers="d83368e897">
<pre>isSchemaBased()
</pre></td>
<td class="cellalignment3513" headers="d83368e905 d83368e900">
<p>Returns <code>TRUE</code> if the <code>XMLType</code> instance is based on an XML schema, <code>FALSE</code> otherwise.</p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3512" id="d83368e921" headers="d83368e897">
<pre dir="ltr">getSchemaURL() 
</pre></td>
<td class="cellalignment3513" headers="d83368e921 d83368e900">
<p>The XML schema URL for an <code>XMLType</code> instance.</p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3512" id="d83368e931" headers="d83368e897">
<pre dir="ltr">schemaValidate()
isSchemaValid()
isSchemaValidated()
setSchemaValidated()
</pre></td>
<td class="cellalignment3513" headers="d83368e931 d83368e900">
<p>Validation of an <code>XMLType</code> instance against a registered XML schema: validate, check validation status, or set recorded validation status. See <a href="xdb08tra.htm#GUID-EC4E2212-67EF-425C-AB5E-D48E62EAB9A7" title="There are several Oracle SQL functions and XMLType APIs for transforming XMLType data using XSLT stylesheets and for validating XMLType instances against an XML schema.">Transformation and Validation of XMLType Data</a>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
</div>
<a id="ADXDB6310"></a>
<div class="props_rev_3"><a id="GUID-E27F30C8-3081-403B-B75C-4A84C3F256EF"></a>
<h2 id="ADXDB-GUID-E27F30C8-3081-403B-B75C-4A84C3F256EF" class="sect2"><span class="enumeration_section">17.3</span> XML Schema Registration with Oracle XML&nbsp;DB</h2>
<div>
<p>Before an XML schema can be used by Oracle XML&nbsp;DB, you must register it. It can then be used to create <code>XMLType</code> tables and columns and to validate XML documents. If schema registration fails then the database is restored to the state it had prior to the registration attempt.</p>
<p>Like all DDL operations, XML schema registration is non-transactional. However, registration is <span class="italic">atomic</span>, in this sense:</p>
<ul style="list-style-type: disc;">
<li>
<p>If registration succeeds then the operation is auto-committed.</p>
</li>
<li>
<p>If registration fails then the database is rolled back to the state it had before registration began.</p>
</li>
</ul>
<p>Because XML schema registration potentially involves creating object types and tables, error recovery involves dropping any types and tables thus created. The entire XML schema registration process is guaranteed to be atomic: either it succeeds or the database is restored to its state before the start of registration.</p>
<p>Two items are required to register an XML schema with Oracle XML&nbsp;DB:</p>
<ul style="list-style-type: disc;">
<li>
<p>The XML schema document</p>
</li>
<li>
<p>A string that can be used as a unique identifier for the XML schema, after it is registered with Oracle Database. XML instance documents use this unique identifier to identify themselves as members of the class defined by the XML schema. The identifier is typically in the form of a URL, and is often referred to as the <strong class="term">schema location hint</strong> or the <strong class="term">document location hint</strong>.</p>
</li>
</ul>
<div class="infobox-note" id="GUID-E27F30C8-3081-403B-B75C-4A84C3F256EF__GUID-E0C23F1A-CADE-43F8-860E-80EC3ED426C7">
<p class="notep1">Note:</p>
<p>The act of registering an XML schema has <span class="italic">no effect</span> on the status of any instance documents that are <span class="italic">already loaded</span> into Oracle XML&nbsp;DB Repository and that reference that XML schema.</p>
<p>Such instance documents were treated as non XML-schema-based when they were loaded. They remain such. After schema registration, you must <span class="italic">delete</span> such documents and <span class="italic">reload</span> them, in order to obtain XML schema-based documents.</p>
</div>
</div>
<a id="ADXDB4460"></a>
<div class="props_rev_3"><a id="GUID-88464A1A-32CB-40C3-A940-416E3442CF10"></a>
<h3 id="ADXDB-GUID-88464A1A-32CB-40C3-A940-416E3442CF10" class="sect3"><span class="enumeration_section">17.3.1</span> XML Schema Registration Actions</h3>
<div>
<p>As part of registering an XML schema, Oracle XML&nbsp;DB performs several actions that facilitate storing, accessing, and manipulating XML instances that conform to the XML schema.</p>
<p>These include:</p>
<ul style="list-style-type: disc;">
<li>
<p>Mapping XML Schema data types to Oracle XML&nbsp;DB storage. When XML schema-based data is stored, its storage data types are derived from the XML Schema data types using a default mapping and, optionally, using mapping information that you specify using XML schema annotations. For binary XML storage, XML Schema types are mapped to binary XML encoding types. For object-relational storage, XML schema registration creates the appropriate SQL object types for the object-relational storage of conforming documents.</p>
</li>
<li>
<p>Creating default tables. XML schema registration generates default <code>XMLType</code> tables for all global elements. You can use XML-schema annotations to control the names of the tables, and to provide column-level and table-level storage clauses and constraints for use during table creation.</p>
<div class="infoboxnotealso" id="GUID-88464A1A-32CB-40C3-A940-416E3442CF10__GUID-AD225EE3-D6F2-4E5E-8186-23B8A6642A5E">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="xdb05sto.htm#GUID-F5DA0566-E0D0-49C8-A846-1CE5067E15F4" title="Data that conforms to an XML schema uses XML Schema data types. When this XML data is stored in Oracle XML&nbsp;DB, its storage data types are derived from the XML Schema data types using a default mapping and, optionally, using mapping information that you specify using XML schema annotations.">XML Schema Data Types Are Mapped to Oracle XML&nbsp;DB Storage</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="xdb06stt.htm#GUID-54A3CBE8-19BE-43BB-8979-7769116B6F53" title="You can create default tables as part of XML schema registration. Default tables are most useful when documents are inserted using APIs and protocols such as FTP and HTTP(S), which do not provide any table specification.">Default Tables Created during XML Schema Registration</a> &#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="xdb06stt.htm#GUID-F7E43D3A-67D8-432E-833A-DE0EA4CFCE7A" title="You can annotate XML schemas to influence the objects and tables that are generated by the XML schema registration process. You do this by adding Oracle-specific attributes to complexType, element, and attribute definitions that are declared by the XML schema.">Oracle XML Schema Annotations</a>&#34;</span></p>
</li>
</ul>
</div>
</li>
</ul>
<p>After XML schema registration, documents that reference the XML schema using the XML Schema instance mechanism can be processed automatically by Oracle XML&nbsp;DB. For XML data that is stored object-relationally, <code>XMLType</code> tables and columns can be created that are constrained to the global elements defined by the XML schema.</p>
</div>
</div>
<a id="ADXDB6312"></a><a id="ADXDB6311"></a>
<div class="props_rev_3"><a id="GUID-2758A6B4-2BE7-4597-94E7-F344FF7C9660"></a>
<h3 id="ADXDB-GUID-2758A6B4-2BE7-4597-94E7-F344FF7C9660" class="sect3"><span class="enumeration_section">17.3.2</span> Registering an XML Schema with Oracle XML&nbsp;DB</h3>
<div>
<p>An example illustrates the use of PL/SQL procedure <code>DBMS_XMLSCHEMA.registerSchema</code> to register an XML schema. The main parameters of this procedure are the schema URL, the schema source document, the character-set ID of the source-document encoding, and options that specify how the schema should be registered.</p>
<div class="section">
<p>The main parameters to <code>DBMS_XMLSCHEMA.registerSchema</code> are as follows:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><code>SCHEMAURL</code> &ndash; the XML schema URL. This is a unique identifier for the XML schema within Oracle XML&nbsp;DB. It is conventionally in the form of a URL, but this is not a requirement. The XML schema URL is used with Oracle XML&nbsp;DB to identify instance documents, by making the schema location hint identical to the XML schema URL. Oracle XML&nbsp;DB never tries to access a Web server identified by the specified URL.</p>
<div class="infobox-note" id="GUID-2758A6B4-2BE7-4597-94E7-F344FF7C9660__GUID-950A38B2-6813-4262-9D0D-00EBEFCAEB5D">
<p class="notep1">Note:</p>
<p>You cannot register an XML schema using the same <code>SCHEMAURL</code> as any system-defined XML schema.</p>
</div>
</li>
<li>
<p><code>SCHEMADOC</code> &ndash; The XML schema source document. This is a <code>VARCHAR</code>, <code>CLOB</code>, <code>BLOB</code>, <code>BFILE</code>, <code>XMLType</code>, or <code>URIType</code> value.</p>
</li>
<li>
<p><code>CSID</code> &ndash; The character-set ID of the source-document encoding, when <code>schemaDoc</code> is a <code>BFILE</code> or <code>BLOB</code> value.</p>
</li>
<li>
<p><code>OPTIONS</code> &ndash; Options that specify how the XML schema should be registered. The most important option is <code>REGISTER_BINARYXML</code>, which indicates that the XML schema is used for binary XML storage. Another option is <code>REGISTER_NT_AS_IOT</code>, which forces OCTs to be stored as index-organized tables (IOTs).</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-2758A6B4-2BE7-4597-94E7-F344FF7C9660__GUID-30F39B84-5563-4270-A48E-0639502FA06B">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS377" target="_blank" href="../ARPLS/d_xmlsch.htm#ARPLS377"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a></p>
</div>
<p><a href="xdb05sto.htm#GUID-2758A6B4-2BE7-4597-94E7-F344FF7C9660__CEGDEDDF">Example 17-1</a> registers the annotated XML schema of <a href="apphxdb.htm#GUID-1CB2213C-C6E8-4BC4-86A3-EFDE51AEBEFD__BABDAGBF">Example A-2</a>.</p>
<p>In <a href="apphxdb.htm#GUID-1CB2213C-C6E8-4BC4-86A3-EFDE51AEBEFD__BABDAGBF">Example A-2</a>, the unique identifier for the XML schema is:</p>
<pre dir="ltr">http://localhost:8080/source/schemas/poSource/xsd/purchaseOrder.xsd
</pre>
<p>The XML schema document was previously loaded into Oracle XML&nbsp;DB Repository at this path: <code>/source/schemas/poSource/xsd/purchaseOrder.xsd</code>.</p>
<p>During XML schema registration, option <code>SCHEMADOC</code> specifies that PL/SQL constructor <code>XDBURIType</code> is to access the content of the XML schema document, based on its location in the repository. Other options passed to procedure <code>registerSchema</code> specify that the schema in <a href="apphxdb.htm#GUID-1CB2213C-C6E8-4BC4-86A3-EFDE51AEBEFD__BABDAGBF">Example A-2</a> is to be registered as a local XML schema (option <code>LOCAL</code>), and that SQL objects, and that tables are to be generated during the registration process (option <code>GENTABLES</code>).</p>
<p>PL/SQL procedure <code>DBMS_XMLSCHEMA.registerSchema</code> performs the following operations:</p>
<ul style="list-style-type: disc;">
<li>
<p>Parses and validates the XML schema.</p>
</li>
<li>
<p>Creates a set of entries in Oracle Data Dictionary that describe the XML schema.</p>
</li>
<li>
<p>Creates a set of SQL object definitions, based on <code>complexType</code> elements defined in the XML schema.</p>
</li>
<li>
<p>Creates an <code>XMLType</code> table for each global element defined by the XML schema.</p>
</li>
</ul>
<p>By default, when an XML schema is registered, Oracle XML&nbsp;DB automatically generates all of the SQL object types and <code>XMLType</code> tables required to manage the instance documents. An XML schema can be registered as global or local.</p>
<div class="infoboxnotealso" id="GUID-2758A6B4-2BE7-4597-94E7-F344FF7C9660__GUID-CA96B25F-AB87-44BA-BA18-F503B82FC9AB">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="xdb05sto.htm#GUID-5663C810-F20E-4CFE-99D5-96AC7D4081F4" title="An XML schema can be registered as local (visible only to its owner, by default) or global (visible to all database users, by default).">Local and Global XML Schemas</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="xdb05sto.htm#GUID-7E0BA10E-2E50-4A54-9DE1-C2C95665AB0F" title="Registration of an XML schema results in the creation of object types and tables.">SQL Types and Tables Created During XML Schema Registration</a>&#34;</span></p>
</li>
<li>
<p><a class="olink ARPLS377" target="_blank" href="../ARPLS/d_xmlsch.htm#ARPLS377"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about <code>DBMS_XMLSCHEMA.registerSchema</code></p>
</li>
</ul>
</div>
</div>
<!-- class="section" -->
<div class="example" id="GUID-2758A6B4-2BE7-4597-94E7-F344FF7C9660__CEGDEDDF">
<p class="titleinexample">Example 17-1 Registering an XML Schema Using DBMS_XMLSCHEMA.REGISTERSCHEMA</p>
<pre dir="ltr">BEGIN
  DBMS_XMLSCHEMA.registerSchema(
    SCHEMAURL =&gt; &#39;<span class="bold">http://localhost:8080/source/schemas/poSource/xsd/purchaseOrder.xsd</span>&#39;,
    SCHEMADOC =&gt; XDBURIType(&#39;<span class="bold">/source/schemas/poSource/xsd/purchaseOrder.xsd</span>&#39;).getCLOB(),
    LOCAL     =&gt; <span class="bold">TRUE</span>,
    GENTYPES  =&gt; <span class="bold">TRUE</span>, 
    GENTABLES =&gt; TRUE);
END;
/
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ADXDB6314"></a><a id="ADXDB6313"></a>
<div class="props_rev_3"><a id="GUID-7E0BA10E-2E50-4A54-9DE1-C2C95665AB0F"></a>
<h3 id="ADXDB-GUID-7E0BA10E-2E50-4A54-9DE1-C2C95665AB0F" class="sect3"><span class="enumeration_section">17.3.3</span> SQL Types and Tables Created During XML Schema Registration</h3>
<div>
<p>Registration of an XML schema results in the creation of object types and tables.</p>
<p><a href="xdb05sto.htm#GUID-7E0BA10E-2E50-4A54-9DE1-C2C95665AB0F__CEGHCACG">Example 17-2</a> shows the SQL type definitions that were created during an XML schema registration such as that of <a href="xdb05sto.htm#GUID-2758A6B4-2BE7-4597-94E7-F344FF7C9660__CEGDEDDF">Example 17-1</a>. These SQL type definitions include:</p>
<ul style="list-style-type: disc;">
<li>
<p><code>purchaseorder_t</code>. This type is used to persist the SQL objects generated from a <code>PurchaseOrder</code> element. When an XML document containing a <code>PurchaseOrder</code> element is stored in Oracle XML&nbsp;DB the document is broken up, and the contents of the document are stored as an instance of <code>purchaseorder_t</code>.</p>
</li>
<li>
<p><code>lineitems_t</code>, <code>lineitem_v</code>, and <code>lineitem_t</code>. These types manage the collection of <code>LineItem</code> elements that may be present in a <code>PurchaseOrder</code> document. Type <code>lineitems_t</code> consists of a single attribute <code>lineitem</code>, defined as an instance of type <code>lineitem_v</code>. Type <code>lineitem_v</code> is defined as a varray of <code>linteitem_t</code> objects. There is one instance of the <code>lineitem_t</code> object for each <code>LineItem</code> element in the document.</p>
</li>
</ul>
<div class="example" id="GUID-7E0BA10E-2E50-4A54-9DE1-C2C95665AB0F__CEGHCACG">
<p class="titleinexample">Example 17-2 Objects Created During XML Schema Registration</p>
<pre dir="ltr">DESCRIBE purchaseorder_t
 purchaseorder_t is NOT FINAL
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 SYS_XDBPD$                                         XDB.XDB$RAW_LIST_T
 REFERENCE                                          VARCHAR2(30 CHAR)
 ACTIONS                                            ACTIONS_T
 REJECTION                                          REJECTION_T
 REQUESTOR                                          VARCHAR2(128 CHAR)
 USERID                                             VARCHAR2(10 CHAR)
 COST_CENTER                                        VARCHAR2(4 CHAR)
 SHIPPING_INSTRUCTIONS                              SHIPPING_INSTRUCTIONS_T
 SPECIAL_INSTRUCTIONS                               VARCHAR2(2048 CHAR)
 LINEITEMS                                          LINEITEMS_T
 
DESCRIBE lineitems_t
 lineitems_t is NOT FINAL
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 SYS_XDBPD$                                         XDB.XDB$RAW_LIST_T
 LINEITEM                                           LINEITEM_V
 
DESCRIBE lineitem_v
 lineitem_v VARRAY(2147483647) OF LINEITEM_T
 LINEITEM_T is NOT FINAL
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 SYS_XDBPD$                                         XDB.XDB$RAW_LIST_T
 ITEMNUMBER                                         NUMBER(38)
 DESCRIPTION                                        VARCHAR2(256 CHAR)
 PART                                               PART_T
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ADXDB6316"></a>
<div class="props_rev_3"><a id="GUID-4AC085E5-5E41-42A1-8124-1D875AB69D12"></a>
<h3 id="ADXDB-GUID-4AC085E5-5E41-42A1-8124-1D875AB69D12" class="sect3"><span class="enumeration_section">17.3.4</span> Default Tables for Global Elements</h3>
<div>
<p>By default, tables with system-generated names are created for all global elements. You can specify names to use instead. You can prevent the creation of default tables for particular elements, which can reduce processor time and space used, especially if an XML schema contains many global element definitions.</p>
<p>By default, when an XML schema is registered with the database, Oracle XML&nbsp;DB generates a <span class="italic">default table for each global element</span> defined by the XML schema.</p>
<p>You can use attribute <code>xdb:defaultTable</code> to specify the name of the default table for a given global element. Each <code>xdb:defaultTable</code> attribute value you provide must be <span class="italic">unique</span> among <span class="italic">all schemas</span> registered by a given database user. If you do <span class="italic">not</span> supply a nonempty default table name for some element, then a unique name is provided automatically.</p>
<p>In practice, however, you do <span class="italic">not</span> want to create a default table for most global elements. Elements that never serve as the root element for an XML instance document do not need default tables&thinsp;&mdash;&thinsp;such tables are never used. Creating default tables for all global elements can lead to significant overhead in processor time and space used, especially if an XML schema contains a large number of global element definitions.</p>
<p>As a general rule, then, you want to prevent the creation of a default table for any global element (or any local element stored out of line) that you are sure will <span class="italic">not</span> be used as a root element in any document. You can do this in one of the following ways:</p>
<ul style="list-style-type: disc;">
<li>
<p>Add the annotation <code>xdb:defaultTable =</code> <span class="bold"><code>&#34;&#34;</code></span> (empty string) to the definition of <span class="italic">each</span> global element that will <span class="italic">not</span> appear as the root element of an XML instance document. Using this approach, you allow automatic default-table creation, in general, and you prohibit it explicitly where needed, using <code>xdb:defaultTable = &#34;&#34;</code>.</p>
</li>
<li>
<p>Set parameter <code>GENTABLES</code> to <code>FALSE</code> when registering the XML schema, and then <span class="italic">manually create the default table</span> for each global element that can legally appear as the root element of an instance document. Using this approach, you inhibit automatic default-table creation, and you create only the tables that are needed, by hand.</p>
</li>
</ul>
</div>
</div>
<a id="ADXDB4469"></a>
<div class="props_rev_3"><a id="GUID-5F79EAA4-F8AC-4241-A18C-1B4465776460"></a>
<h3 id="ADXDB-GUID-5F79EAA4-F8AC-4241-A18C-1B4465776460" class="sect3"><span class="enumeration_section">17.3.5</span> Database Objects That Depend on Registered XML Schemas</h3>
<div>
<p>Several kinds of database object can depend on registered XML schemas: tables, views, other XML schemas, and cursors that reference an XML schema.</p>
<p>More precisely:</p>
<ul style="list-style-type: disc;">
<li>
<p>Tables or views that have an <code>XMLType</code> column that conforms to an element in an XML schema.</p>
</li>
<li>
<p>Other XML schemas that include or import a given XML schema as part of their definition.</p>
</li>
<li>
<p>Cursors that reference an XML schema. This includes references within functions of package <code>DBMS_XMLGEN</code>. Such cursors are purely transient objects.</p>
</li>
</ul>
</div>
</div>
<a id="ADXDB4477"></a>
<div class="props_rev_3"><a id="GUID-5663C810-F20E-4CFE-99D5-96AC7D4081F4"></a>
<h3 id="ADXDB-GUID-5663C810-F20E-4CFE-99D5-96AC7D4081F4" class="sect3"><span class="enumeration_section">17.3.6</span> Local and Global XML Schemas</h3>
<div>
<p>An XML schema can be registered as local (visible only to its owner, by default) or global (visible to all database users, by default).</p>
<p>When you register an XML schema, PL/SQL package <code>DBMS_XMLSCHEMA</code> adds a corresponding resource to Oracle XML&nbsp;DB Repository. The XML schema URL determines the path name of the XML schema resource in the repository (and it is associated with parameter <code>SCHEMAURL</code> of PL/SQL procedure <code>DBMS_XMLSCHEMA.registerSchema</code>).</p>
<div class="infobox-note" id="GUID-5663C810-F20E-4CFE-99D5-96AC7D4081F4__GUID-68C0ACB6-8FFF-4FC4-BFD2-6ECADB69D9AA">
<p class="notep1">Note:</p>
<p>In Oracle Enterprise Manager, local and global registered XML schemas are referred to as <strong class="term">private</strong> and <strong class="term">public</strong>, respectively.</p>
</div>
</div>
<a id="ADXDB4479"></a><a id="ADXDB4478"></a>
<div class="props_rev_3"><a id="GUID-26C1BFCD-5CC5-4608-A93E-24E5529B1077"></a>
<h4 id="ADXDB-GUID-26C1BFCD-5CC5-4608-A93E-24E5529B1077" class="sect4"><span class="enumeration_section">17.3.6.1</span> Local XML Schema</h4>
<div>
<p>By default, an XML schema is local, meaning that it belongs to you alone, after you register it with Oracle XML&nbsp;DB. A reference to the XML schema document is stored in Oracle XML&nbsp;DB Repository under your user (database schema) name.</p>
<p>Such XML schemas are referred to as <strong class="term">local</strong>. By default, they are usable only by you, the owner. In Oracle XML&nbsp;DB, local XML schema resources are created under folder <code>/sys/schemas/</code><span class="italic"><code>username</code></span>. The rest of the repository path name is derived from the schema URL.</p>
<p>For example, if the XML schema purchaseOrder.xsd is registered as a local schema by user <code>QUINE</code>, it is given this path name:</p>
<pre dir="ltr">/sys/schemas/<span class="bold">QUINE</span>/xmlns.oracle.com/xdb/documentation/purchaseOrder.xsd
</pre>
<p>Database users need appropriate permissions and Access Control Lists (ACLs) to create a resource with a given path name, in order to register the XML schema as a local XML schema.</p>
<div class="infoboxnotealso" id="GUID-26C1BFCD-5CC5-4608-A93E-24E5529B1077__GUID-9F6ED840-F74B-46E1-AFB1-F4DE0EAD6212">
<p class="notep1">See Also:</p>
<p><a href="xdb21sec.htm#GUID-CD4A712D-CCA2-4A19-909E-AEC57849A55A" title="Oracle Database provides classic database security such as row-level and column-level secure access by database users. It also provides fine-grained access control for resources in Oracle XML&nbsp;DB Repository. You can create, set, and modify access control lists (ACLs).">Repository Access Control</a></p>
</div>
<div class="infobox-note" id="GUID-26C1BFCD-5CC5-4608-A93E-24E5529B1077__GUID-63DC23EC-2ABA-4F36-85B6-C9EE9EE80742">
<p class="notep1">Note:</p>
<p>Typically, only the owner of the XML schema can use it to define <code>XMLType</code> tables, columns, or views, validate documents, and so on. However, Oracle XML&nbsp;DB supports fully qualified XML schema URLs. For example: <code>http://xmlns.oracle.com/xdb/schemas/QUINE/xmlns.oracle.com/xdb/documentation/purchaseOrder.xsd</code>. Privileged users can use such an extended URL to specify XML schemas belonging to other users (in this case, user <code>QUINE</code>).</p>
</div>
<div class="example" id="GUID-26C1BFCD-5CC5-4608-A93E-24E5529B1077__BJFIJHJA">
<p class="titleinexample">Example 17-3 Registering a Local XML Schema</p>
<pre dir="ltr">BEGIN
  DBMS_XMLSCHEMA.registerSchema(
    SCHEMAURL =&gt; &#39;http://xmlns.oracle.com/xdb/documentation/purchaseOrder.xsd&#39;,
    SCHEMADOC =&gt; bfilename(&#39;XMLDIR&#39;,&#39;purchaseOrder.xsd&#39;),
    LOCAL     =&gt; <span class="bold">TRUE</span>,
    GENTYPES  =&gt; TRUE, 
    GENTABLES =&gt; FALSE, 
    CSID      =&gt; nls_charset_id(&#39;AL32UTF8&#39;));
END;
/
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ADXDB4481"></a><a id="ADXDB4480"></a>
<div class="props_rev_3"><a id="GUID-CA2A548B-11B3-4D83-9A21-53EC8CE6DDC9"></a>
<h4 id="ADXDB-GUID-CA2A548B-11B3-4D83-9A21-53EC8CE6DDC9" class="sect4"><span class="enumeration_section">17.3.6.2</span> Global XML Schema</h4>
<div>
<p>In contrast to local XML schemas, a privileged user can register an XML schema as global by specifying an argument to registration function <code>DBMS_XMLSCHEMA</code>. are visible to <span class="italic">all</span> users. They are stored under folder <code>/sys/schemas/PUBLIC/</code> in Oracle XML&nbsp;DB Repository.</p>
<div class="infobox-note" id="GUID-CA2A548B-11B3-4D83-9A21-53EC8CE6DDC9__GUID-C0712B94-5A53-469E-B836-CBC574078E8F">
<p class="notep1">Note:</p>
<p>Access to folder <code>/sys/schemas/PUBLIC</code> is controlled by access control lists (ACLs). By default, this folder is writable only by a database administrator. You need write privileges on this folder to register global XML schemas. Role <code>XDBADMIN</code> provides write access to this folder, assuming that it is protected by the default ACLs. See <a href="xdb21sec.htm#GUID-CD4A712D-CCA2-4A19-909E-AEC57849A55A" title="Oracle Database provides classic database security such as row-level and column-level secure access by database users. It also provides fine-grained access control for resources in Oracle XML&nbsp;DB Repository. You can create, set, and modify access control lists (ACLs).">Repository Access Control</a>.</p>
</div>
<p>You can register a local schema with the same URL as an existing global schema. A local schema always shadows (hides) any global schema with the same name (URL).</p>
<p><a href="xdb05sto.htm#GUID-CA2A548B-11B3-4D83-9A21-53EC8CE6DDC9__BJFBGBEJ">Example 17-4</a> illustrates the registration of a global schema.</p>
<div class="example" id="GUID-CA2A548B-11B3-4D83-9A21-53EC8CE6DDC9__BJFBGBEJ">
<p class="titleinexample">Example 17-4 Registering a Global XML Schema</p>
<pre dir="ltr"><span class="bold">GRANT XDBADMIN TO QUINE;</span>

Grant succeeded.

CONNECT quine
Enter password: <span class="italic">password</span>

Connected.

BEGIN
  DBMS_XMLSCHEMA.registerSchema(
    SCHEMAURL =&gt; &#39;http://xmlns.oracle.com/xdb/documentation/purchaseOrder.xsd&#39;,
    SCHEMADOC =&gt; bfilename(&#39;XMLDIR&#39;,&#39;purchaseOrder.xsd&#39;),
    LOCAL     =&gt; <span class="bold">FALSE</span>,
    GENTYPES  =&gt; TRUE, 
    GENTABLES =&gt; FALSE, 
    CSID      =&gt; nls_charset_id(&#39;AL32UTF8&#39;));
END;
/
</pre>
<p>If this global XML schema is registered by user <code>QUINE</code>, it is given this path name:</p>
<pre dir="ltr">/sys/schemas/<span class="bold">PUBLIC</span>/xmlns.oracle.com/xdb/documentation/purchaseOrder.xsd
</pre>
<p>Database users need appropriate permissions (ACL access) to create this resource in order to register the XML schema as global.</p>
</div>
<!-- class="example" --></div>
</div>
</div>
<a id="ADXDB4634"></a>
<div class="props_rev_3"><a id="GUID-7A661274-35C2-422B-A290-5E06D9BADAA0"></a>
<h3 id="ADXDB-GUID-7A661274-35C2-422B-A290-5E06D9BADAA0" class="sect3"><span class="enumeration_section">17.3.7</span> Fully Qualified XML Schema URLs</h3>
<div>
<p><span class="italic">Fully qualified</span> XML schema URLs permit explicit reference to particular XML schemas. The name of the database user owning the XML schema is specified as part of the URL. Fully qualified schema URLs belong to the Oracle XML&nbsp;DB namespace.</p>
<p>By default, XML schema URLs are referenced within the scope of the current database user. XML schema URLs are first resolved as the names of <span class="italic">local</span> XML schemas owned by the current user.</p>
<ul style="list-style-type: disc;">
<li>
<p>If there are no such XML schemas, then they are resolved as names of <span class="italic">global</span> XML schemas.</p>
</li>
<li>
<p>If there are no <span class="italic">global</span> XML schemas either, then Oracle XML&nbsp;DB raises an error.</p>
</li>
</ul>
<p>The Oracle XML&nbsp;DB namespace is:</p>
<pre dir="ltr">http://xmlns.oracle.com/xdb/schemas/<span class="italic"><span class="bold">&lt;database-user&gt;</span></span>/&lt;schemaURL-minus-protocol&gt;
</pre>
<p>For example, suppose there is a registered global XML schema with the URL <code>http://www.example.com/po.xsd</code>, and user <code>QUINE</code> has a local registered XML schema with the same URL. Another user can reference the schema owned by <code>QUINE</code> as follows using this fully qualified XML Schema URL:</p>
<pre dir="ltr">http://xmlns.oracle.com/xdb/schemas/<span class="bold">QUINE</span>/www.example.com/po.xsd
</pre>
<p>The fully qualified URL for the global XML schema is:</p>
<pre dir="ltr">http://xmlns.oracle.com/xdb/schemas/<span class="bold">PUBLIC</span>/www.example.com/po.xsd
</pre>
<div class="infoboxnotealso" id="GUID-7A661274-35C2-422B-A290-5E06D9BADAA0__GUID-956CB5AC-5A9D-4312-825A-2CA44E7EEDDC">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="xdb05sto.htm#GUID-5663C810-F20E-4CFE-99D5-96AC7D4081F4" title="An XML schema can be registered as local (visible only to its owner, by default) or global (visible to all database users, by default).">Local and Global XML Schemas</a>&#34;</span></p>
</div>
</div>
</div>
<a id="ADXDB4474"></a><a id="ADXDB4472"></a>
<div class="props_rev_3"><a id="GUID-96A06AFE-40DA-4544-A38B-C4577FD4762F"></a>
<h3 id="ADXDB-GUID-96A06AFE-40DA-4544-A38B-C4577FD4762F" class="sect3"><span class="enumeration_section">17.3.8</span> Deletion of an XML Schema</h3>
<div>
<p>You can delete a registered XML schema using procedure <code>DBMS_XMLSCHEMA.</code><span class="bold"><code>deleteSchema</code></span>.</p>
<p>This does the following, by default:</p>
<ol>
<li>
<p>Checks that the current user has the appropriate privileges to delete the resource corresponding to the XML schema within Oracle XML&nbsp;DB Repository. You can control which users can delete which XML schemas, by setting the appropriate ACLs on the XML schema resources.</p>
</li>
<li>
<p>Checks whether there are any tables dependent on the XML schema that is to be deleted. If so, raises an error and cancels the deletion. This check is not performed if option <code>delete_invalidate</code> or <code>delete_cascade_force</code> is used. In that case, no error is raised.</p>
</li>
<li>
<p>Removes the XML schema document from the Oracle XML&nbsp;DB Repository (folder <code>/sys/schemas</code>).</p>
</li>
<li>
<p>Removes the XML schema document from <code>DBA_XML_SCHEMAS</code>, unless it was registered for use with binary XML instances and neither <code>delete_invalidate</code> nor <code>delete_cascade_force</code> is used.</p>
</li>
<li>
<p>Drops the default table, if either <code>delete_cascade</code> or <code>delete_cascade_force</code> is used. Raises an error if <code>delete_cascade</code> is specified and there are instances in other tables that are also dependent on the XML schema.</p>
</li>
</ol>
<p>The following values are available for option <code>DELETE_OPTION</code> of procedure <code>DBMS_XMLSCHEMA.deleteSchema</code>:</p>
<ul style="list-style-type: disc;">
<li>
<p><code>DELETE_RESTRICT</code> &ndash; Raise an error and cancel deletion if dependencies are detected. This is the default behavior.</p>
</li>
<li>
<p><code>DELETE_INVALIDATE</code> &ndash; Do not raise an error if dependencies are detected. Instead, mark each of the dependencies as being invalid.</p>
</li>
<li>
<p><code>DELETE_CASCADE</code> &ndash; Drop all types and default tables that were generated during XML schema registration. Raise an error if there are instances that depend upon the XML schema that are stored in tables other than the default table. However, do not raise an error for any such instances that are stored in <code>XMLType</code> columns that were created using <code>ANY_SCHEMA</code>. If the XML schema was registered for use with binary XML, do not remove it from <code>DBA_XML_SCHEMAS</code>.</p>
</li>
<li>
<p><code>DELETE_CASCADE_FORCE</code> &ndash; Drop all types and default tables that were generated during XML schema registration. Do not raise an error if there are instances that depend upon the XML schema that are stored in tables other than the default table. Instead, mark each of the dependencies as being invalid. Remove the XML schema from <code>DBA_XML_SCHEMAS</code>.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-96A06AFE-40DA-4544-A38B-C4577FD4762F__GUID-32452F70-71C2-48A7-BBDF-532A2D7A3EE3">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS377" target="_blank" href="../ARPLS/d_xmlsch.htm#ARPLS377"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a></p>
</div>
<p><a href="xdb05sto.htm#GUID-96A06AFE-40DA-4544-A38B-C4577FD4762F__CHDICCDF">Example 17-5</a> illustrates the use of <code>DELETE_CASCADE_FORCE</code>.</p>
<p>If an XML schema was registered for use with binary XML, it is not removed from <code>DBA_XML_SCHEMAS</code> when you delete it using option <code>DELETE_RESTRICT</code> (the default value) or <code>DELETE_CASCADE</code>. As a consequence, although you can no longer use the XML schema to encode new XML instance documents, any existing documents in Oracle XML&nbsp;DB that reference the XML schema can still be <span class="italic">decoded</span> using it.</p>
<p>This remains the case until you remove the XML schema from <code>DBA_XML_SCHEMAS</code> using <code>DBMS_XMLSCHEMA.</code><span class="bold"><code>purgeSchema</code></span>. Oracle recommends that, in general, you use <code>delete_restrict</code> or <code>delete_cascade</code>. Instead of using <code>DELETE_CASCADE_FORCE</code>, call <code>DBMS_XMLSCHEMA.purgeSchema</code> when you are sure you no longer need the XML schema.</p>
<p>Procedure <code>purgeSchema</code> removes the XML schema completely from Oracle XML&nbsp;DB. In particular, it removes it from <code>DBA_XML_SCHEMAS</code>. Before you use <code>DBMS_XMLSCHEMA.purgeSchema</code>, be sure that you have transformed all existing XML documents that reference the XML schema to be purged, so they reference a different XML schema or no XML schema. Otherwise, it will be impossible to decode them after the purge.</p>
<div class="example" id="GUID-96A06AFE-40DA-4544-A38B-C4577FD4762F__CHDICCDF">
<p class="titleinexample">Example 17-5 Deleting an XML Schema with DBMS_XMLSCHEMA.DELETESCHEMA</p>
<pre dir="ltr">BEGIN
  DBMS_XMLSCHEMA.deleteSchema(
    SCHEMAURL =&gt; &#39;http://xmlns.oracle.com/xdb/documentation/purchaseOrder.xsd&#39;,
    <span class="bold">DELETE_OPTION =&gt; DBMS_XMLSCHEMA.DELETE_CASCADE_FORCE</span>);
END;
/
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ADXDB4471"></a><a id="ADXDB4470"></a>
<div class="props_rev_3"><a id="GUID-1ADDD9A7-5636-4587-AF9D-255790EA1BF9"></a>
<h3 id="ADXDB-GUID-1ADDD9A7-5636-4587-AF9D-255790EA1BF9" class="sect3"><span class="enumeration_section">17.3.9</span> Listing All Registered XML Schemas</h3>
<div>
<p>An example lists all XML schemas that are registered with Oracle XML&nbsp;DB.</p>
<div class="section">
<p><a href="xdb05sto.htm#GUID-1ADDD9A7-5636-4587-AF9D-255790EA1BF9__CHDHHBEB">Example 17-6</a> shows how to use PL/SQL procedure <code>DBMS_XMLSCHEMA.registerSchema</code> to obtain a list of all XML schemas registered with Oracle XML&nbsp;DB. You can also examine views <code>USER_XML_SCHEMAS</code>, <code>ALL_XML_SCHEMAS</code>, <code>USER_XML_TABLES</code>, and <code>ALL_XML_TABLES</code>.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-1ADDD9A7-5636-4587-AF9D-255790EA1BF9__CHDHHBEB">
<p class="titleinexample">Example 17-6 Data Dictionary Table for Registered Schemas</p>
<pre dir="ltr">DESCRIBE DBA_XML_SCHEMAS

Name         Null? Type
------------ ----- -----------------------
OWNER              VARCHAR2(30)
SCHEMA_URL         VARCHAR2(700)
LOCAL              VARCHAR2(3)
SCHEMA             XMLTYPE(XMLSchema &#34;http://xmlns.oracle.com/xdb/XDBSchema.xsd&#34;
                           Element &#34;schema&#34;)
INT_OBJNAME        VARCHAR2(4000)
QUAL_SCHEMA_URL    VARCHAR2(767)
HIER_TYPE          VARCHAR2(11)
BINARY             VARCHAR2(3)
SCHEMA_ID          RAW(16)
HIDDEN             VARCHAR2(3)

SELECT OWNER, LOCAL, SCHEMA_URL FROM DBA_XML_SCHEMAS;

OWNER   LOC   SCHEMA_URL
-----   ---   ----------------------
XDB     NO    http://xmlns.oracle.com/xdb/XDBSchema.xsd
XDB     NO    http://xmlns.oracle.com/xdb/XDBResource.xsd
XDB     NO    http://xmlns.oracle.com/xdb/acl.xsd
XDB     NO    http://xmlns.oracle.com/xdb/dav.xsd
XDB     NO    http://xmlns.oracle.com/xdb/XDBStandard.xsd
XDB     NO    http://www.w3.org/2001/xml.xsd
XDB     NO    http://xmlns.oracle.com/xdb/stats.xsd
XDB     NO    http://xmlns.oracle.com/xdb/xdbconfig.xsd
SCOTT   YES   http://xmlns.oracle.com/xdb/documentation/purchaseOrder.xsd

13 rows selected.

DESCRIBE DBA_XML_TABLES

Name         Null? Type
------------ ----- -----------------------
OWNER              VARCHAR2(30)
TABLE_NAME         VARCHAR2(30)
XMLSCHEMA          VARCHAR2(700)
SCHEMA_OWNER       VARCHAR2(30)
ELEMENT_NAME       VARCHAR2(2000)
STORAGE_TYPE       VARCHAR2(17)
ANYSCHEMA          VARCHAR2(3)
NONSCHEMA          VARCHAR2(3)

SELECT TABLE_NAME FROM DBA_XML_TABLES
  WHERE XMLSCHEMA = &#39;http://xmlns.oracle.com/xdb/documentation/purchaseOrder.xsd&#39;;

TABLE_NAME
---------------------
PurchaseOrder1669_TAB

1 row selected.
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<a id="ADXDB4501"></a><a id="ADXDB4502"></a><a id="ADXDB4503"></a><a id="ADXDB4504"></a><a id="ADXDB4505"></a><a id="ADXDB4500"></a>
<div class="props_rev_3"><a id="GUID-A7862EBA-F10A-43BA-A540-933529E514E5"></a>
<h2 id="ADXDB-GUID-A7862EBA-F10A-43BA-A540-933529E514E5" class="sect2"><span class="enumeration_section">17.4</span> Creation of XMLType Tables and Columns Based on XML Schemas</h2>
<div>
<p>You can create <code>XMLType</code> tables and columns that are constrained to a global element defined by an XML schema. After an <code>XMLType</code> column has been constrained to a particular element and a particular schema, it can only contain documents that are compliant with the schema definition of that element.</p>
<p>You constrain an <code>XMLType</code> table column to a particular element and XML schema by adding appropriate <code>XMLSCHEMA</code> and <code>ELEMENT</code> clauses to the <code>CREATE TABLE</code> operation.</p>
<p>Figures <a href="xdb05sto.htm#GUID-A7862EBA-F10A-43BA-A540-933529E514E5__i1044839">Figure 17-3</a> through <a href="xdb05sto.htm#GUID-A7862EBA-F10A-43BA-A540-933529E514E5__BJFBIIIA">Figure 17-6</a> show the syntax for creating an <code>XMLType</code> table.</p>
<div class="infoboxnotealso" id="GUID-A7862EBA-F10A-43BA-A540-933529E514E5__GUID-179239AF-6B31-4345-8E1B-E6F9874A5804">
<p class="notep1">See Also:</p>
<p><a class="olink SQLRF01402" target="_blank" href="../SQLRF/statements_7002.htm#SQLRF01402"><span class="italic">Oracle Database SQL Language Reference</span></a> for the complete description of <code>CREATE TABLE</code>, including syntax elements such as <tt>object_properties</tt>.</p>
</div>
<div class="infobox-note" id="GUID-A7862EBA-F10A-43BA-A540-933529E514E5__GUID-21C67238-CA2E-4281-8372-E2A71ACFAA58">
<p class="notep1">Note:</p>
<p>To create an <code>XMLType</code> table in a different database schema from your own, you must have not only privilege <code>CREATE ANY TABLE</code> but also privilege <code>CREATE ANY INDEX</code>. This is because a unique index is created on column <code>OBJECT_ID</code> when you create the table. Column <code>OBJECT_ID</code> stores a system-generated object identifier.</p>
</div>
<div class="figure" id="GUID-A7862EBA-F10A-43BA-A540-933529E514E5__i1044839">
<p class="titleinfigure">Figure 17-3 Creating an XMLType Table &ndash; CREATE TABLE Syntax</p>
<img width="652" height="91" src="img/GUID-D264795C-245A-49AD-8237-20A5AB6F36D9-default.gif" alt="Description of Figure 17-3 follows" title="Description of Figure 17-3 follows"/><br/>
<a href="img_text/GUID-D264795C-245A-49AD-8237-20A5AB6F36D9-print.htm">Description of &#34;Figure 17-3 Creating an XMLType Table &ndash; CREATE TABLE Syntax&#34;</a></div>
<!-- class="figure" -->
<div class="figure" id="GUID-A7862EBA-F10A-43BA-A540-933529E514E5__GUID-4F16853D-8E1A-42F6-8C48-6DAE2556EE32">
<p class="titleinfigure">Figure 17-4 Creating an XMLType Table &ndash; XMLType_table Syntax</p>
<img width="767" height="209" src="img/GUID-CCD63D10-5BB4-4773-9C34-9DF43E1D779E-default.gif" alt="Description of Figure 17-4 follows" title="Description of Figure 17-4 follows"/><br/>
<a href="img_text/GUID-CCD63D10-5BB4-4773-9C34-9DF43E1D779E-print.htm">Description of &#34;Figure 17-4 Creating an XMLType Table &ndash; XMLType_table Syntax&#34;</a></div>
<!-- class="figure" -->
<div class="figure" id="GUID-A7862EBA-F10A-43BA-A540-933529E514E5__GUID-D526D23F-ABB1-48C1-9159-CAB83E16EFE4">
<p class="titleinfigure">Figure 17-5 Creating an XMLType Table &ndash; table_properties Syntax</p>
<img width="800" height="237" src="img/GUID-D56B3B50-2B56-4E0A-8A03-8DA020FCA635-default.gif" alt="Description of Figure 17-5 follows" title="Description of Figure 17-5 follows"/><br/>
<a href="img_text/GUID-D56B3B50-2B56-4E0A-8A03-8DA020FCA635-print.htm">Description of &#34;Figure 17-5 Creating an XMLType Table &ndash; table_properties Syntax&#34;</a></div>
<!-- class="figure" -->
<div class="figure" id="GUID-A7862EBA-F10A-43BA-A540-933529E514E5__BJFBIIIA">
<p class="titleinfigure">Figure 17-6 Creating an XMLType Table &ndash; XMLType_virtual_columns Syntax</p>
<img width="482" height="58" src="img/GUID-C0F5294A-AE59-49C2-820B-153531FDA9AD-default.gif" alt="Description of Figure 17-6 follows" title="Description of Figure 17-6 follows"/><br/>
<a href="img_text/GUID-C0F5294A-AE59-49C2-820B-153531FDA9AD-print.htm">Description of &#34;Figure 17-6 Creating an XMLType Table &ndash; XMLType_virtual_columns Syntax&#34;</a></div>
<!-- class="figure" -->
<div class="infobox-note" id="GUID-A7862EBA-F10A-43BA-A540-933529E514E5__GUID-284E475A-1C17-4CA3-9765-DA471A56F9D3">
<p class="notep1">Note:</p>
<ul style="list-style-type: disc;">
<li>
<p>Clause <code>XMLType_virtual_columns</code> can be used only for <code>XMLType</code> data that is stored as <span class="italic">binary XML</span>. In particular, if you use it for data that is stored object-relationally, and if you use a partitioning clause, then an error is raised.</p>
</li>
<li>
<p>For XML data, virtual columns are used primarily for partitioning or defining SQL constraints. If your need is to project out specific XML data in order to access it relationally, then consider using SQL/XML function <code>XMLTable</code> or <code>XMLIndex</code> with a structured component.</p>
</li>
</ul>
</div>
<div class="infoboxnotealso" id="GUID-A7862EBA-F10A-43BA-A540-933529E514E5__note-1415-33A1FE33">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="xdb03usg.htm#GUID-C516A75D-519D-4599-ACFF-2837EB4F3242" title="You can create virtual columns only for XMLType data that is stored as binary XML. Such columns are useful for partitioning or constraining the data.">Creating Virtual Columns on XMLType Data Stored as Binary XML</a> &#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="xdb_xquery.htm#GUID-F4508470-D420-4B5A-B5DF-59A424887F10" title="You use SQL/XML function XMLTable to decompose the result of an XQuery-expression evaluation into the relational rows and columns of a new, virtual table. You can insert this data into a pre-existing database table, or you can query it using SQL &mdash; in a join expression, for example.">XMLTABLE SQL/XML Function in Oracle XML&nbsp;DB</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="xdb_indexing.htm#GUID-2DC9E402-5C06-4AED-B04B-C37B687DB6BB" title="You create and use the structured component of an XMLIndex index for queries that project fixed, structured islands of XML content, even if the surrounding data is relatively unstructured.">XMLIndex Structured Component</a>&#34;</span></p>
</li>
</ul>
</div>
<p>A subset of the XPointer notation can also be used to provide a single URL that contains the XML schema location and element name. See also <a href="xdb04cre.htm#GUID-01C75289-804F-4BAA-AE7C-DFA73198581E" title="There are many ways for applications to query and update XML data that is in Oracle Database, both XML schema-based and non-schema-based.">Query and Update of XML Data</a>.</p>
<p><a href="xdb05sto.htm#GUID-A7862EBA-F10A-43BA-A540-933529E514E5__CHDDJDBD">Example 17-7</a> shows two <code>CREATE TABLE</code> statements. The first creates <code>XMLType</code> table <code>purchaseorder_as_table</code>. The second creates relational table <code>purchaseorder_as_column</code>, which has <code>XMLType</code> column <code>xml_document</code>. In each table, the <code>XMLType</code> instance is constrained to the <code>PurchaseOrder</code> element that is defined by the XML schema registered with URL <code>http://xmlns.oracle.com/xdb/documentation/purchaseOrder.xsd</code>.</p>
<p>There are two ways to specify <code>XMLSchema</code> and <code>Element</code>:</p>
<ul style="list-style-type: disc;">
<li>
<p>as separate clauses, <code>XMLSchema</code> and <code>Element</code></p>
</li>
<li>
<p>using only the <code>Element</code> clause with an XPointer notation</p>
</li>
</ul>
<p>The data associated with an <code>XMLType</code> table or column that is constrained to an XML schema can be stored in different ways:</p>
<ul style="list-style-type: disc;">
<li>
<p>Decomposed and stored object-relationally</p>
</li>
<li>
<p>Stored as binary XML, using a single binary-XML column</p>
</li>
</ul>
<div class="example" id="GUID-A7862EBA-F10A-43BA-A540-933529E514E5__CHDDJDBD">
<p class="titleinexample">Example 17-7 Creating XML Schema-Based XMLType Tables and Columns</p>
<pre dir="ltr">CREATE TABLE purchaseorder_as_table <span class="bold">OF XMLType</span>
  XMLSCHEMA &#34;http://xmlns.oracle.com/xdb/documentation/purchaseOrder.xsd&#34;
  ELEMENT &#34;PurchaseOrder&#34;;

CREATE TABLE purchaseorder_as_column (id NUMBER, xml_document <span class="bold">XMLType</span>)
  XMLTYPE COLUMN xml_document
  ELEMENT
    &#34;http://xmlns.oracle.com/xdb/documentation/purchaseOrder.xsd#PurchaseOrder&#34;;
</pre></div>
<!-- class="example" --></div>
<a id="ADXDB4506"></a>
<div class="props_rev_3"><a id="GUID-CF8A4404-C51C-40D4-A4EE-D53DADBD63D5"></a>
<h3 id="ADXDB-GUID-CF8A4404-C51C-40D4-A4EE-D53DADBD63D5" class="sect3"><span class="enumeration_section">17.4.1</span> Specification of XMLType Storage Options for XML Schema-Based Data</h3>
<div>
<p>You can specify storage options to use when you manually create a table that stores XML instance documents that reference an XML schema. To specify a particular <code>XMLType</code> storage model, use a <code>STORE AS</code> clause in the <code>CREATE TABLE</code> statement.</p>
<p>Otherwise, the storage model specified during registration of the XML schema is used. If no storage model was specified during registration, then object-relational storage is used.</p>
<p>Besides specifying storage options for XML schema-based data, you can also specify storage options for tables that are created automatically, by using XML schema annotations.</p>
<div class="infoboxnotealso" id="GUID-CF8A4404-C51C-40D4-A4EE-D53DADBD63D5__GUID-BB9A5954-D5D3-440C-A029-0661CD1C3FB8">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="xdb06stt.htm#GUID-F7E43D3A-67D8-432E-833A-DE0EA4CFCE7A" title="You can annotate XML schemas to influence the objects and tables that are generated by the XML schema registration process. You do this by adding Oracle-specific attributes to complexType, element, and attribute definitions that are declared by the XML schema.">Oracle XML Schema Annotations</a>&#34;</span></p>
</li>
<li>
<p><a href="xdb_storage.htm#GUID-F1EE5B88-69E1-47B4-97FC-92F184C0CBA1" title="Important design choices for your application include what XMLType storage model to use and which indexing approaches to use.">Choice of XMLType Storage and Indexing</a></p>
</li>
</ul>
</div>
</div>
<a id="ADXDB4508"></a><a id="ADXDB4507"></a>
<div class="props_rev_3"><a id="GUID-E7AB5A1F-FAAC-4463-8491-74992E49FA8E"></a>
<h4 id="ADXDB-GUID-E7AB5A1F-FAAC-4463-8491-74992E49FA8E" class="sect4"><span class="enumeration_section">17.4.1.1</span> Binary XML Storage of XML Schema-Based Data</h4>
<div>
<p>If you specify <code>STORE AS BINARY_XML</code> then binary XML storage is used. If you specify an XML schema that the documents must conform to then you can use that schema only to create <code>XMLType</code> tables and columns that are stored as binary XML.</p>
<p>You <span class="italic">cannot</span> use the same XML schema to create <code>XMLType</code> tables and columns that are stored object-relationally.</p>
<p>The converse is also true: If you use object-relational storage for the registered XML schema, then you can use only that XML schema to create <code>XMLType</code> tables and columns that are stored as binary XML.</p>
<p>Binary XML storage offers a great deal of flexibility for XML data, especially concerning the use of XML schemas. Binary XML encodes XML data differently, depending upon whether or not an XML schema is used for the encoding, and it can encode the same data differently using different XML schemas.</p>
<p>When an XML schema is taken into account for encoding binary XML data, the XML Schema data types are mapped to encoded types for storage. Alternatively, you can encode XML data as non-schema-based binary XML, whether or not the data references an XML schema. In that case, any referenced XML schema is ignored, and there is no encoding of XML Schema data types.</p>
<p>When you create an <code>XMLType</code> table or column and you use binary XML storage, you can specify how to encode the column or table to make use of XML schemas. Choose from among these possibilities:</p>
<ul style="list-style-type: disc;">
<li>
<p>Encode the column or table data as <span class="italic">non-schema-based</span> binary XML. The XML data stored in the column can nevertheless conform to an XML schema, but it need not. Any referenced XML schema is ignored for encoding purposes, and documents are not automatically validated when they are inserted or updated.</p>
<p>You can nevertheless explicitly validate an XML schema-based document that is encoded as non-schema-based binary XML. This represents an important use case: situations where you do not want to tie documents too closely to a particular XML schema, because you might change it or delete it.</p>
</li>
<li>
<p>Encode the column or table data to conform to a <span class="italic">single XML schema</span>. All rows (documents) must conform to the same XML schema. You can nevertheless specify, as an option, that non-schema-based documents can also be stored in the same column.</p>
</li>
<li>
<p>Encode the column or table data to conform to whatever XML schema it references Each row (document) can reference <span class="italic">any XML schema</span>, and that XML schema is used to encode that particular XML document. In this case also, you can specify, as an option, that non-schema-based documents can also be stored in the same column.</p>
<p>You can use multiple <span class="italic">versions</span> of the same XML schema in this way. Store documents that conform to different versions. Each is encoded according to the XML schema that it references.</p>
</li>
</ul>
<p>You can specify that any XML schema can be used for encoding by using option <code>ALLOW ANYSCHEMA</code> when you create the table.</p>
<div class="infobox-note" id="GUID-E7AB5A1F-FAAC-4463-8491-74992E49FA8E__GUID-AAE3334F-4802-4E24-A26B-3BF67F6EEA61">
<p class="notep1">Note:</p>
<ul style="list-style-type: disc;">
<li>
<p>If you use option <code>ALLOW ANYSCHEMA</code>, then any XML schema referenced by your instance documents is used <span class="italic">only for validation</span>. It is <span class="italic">not</span> used at query time. Queries of your data treat it as if it were non XML schema-based data.</p>
</li>
<li>
<p>Oracle recommends that you do <span class="italic">not</span> use option <code>ALLOW ANYSCHEMA</code> if you anticipate using copy-based XML schema evolution (see <span class="q">&#34;<a href="xdb07evo.htm#GUID-0E4FC235-D8D1-4F27-85DC-A3DCCC2662AB" title="You perform copy-based XML schema evolution using PL/SQL procedure DBMS_XMLSCHEMA.copyEvolve. This backs up existing instance documents to temporary XMLType tables, drops the old version of the XML schema (which also deletes the associated instance documents), registers the new version, and copies the backed-up instance documents to new XMLType tables.">Copy-Based Schema Evolution</a>&#34;</span>). If you use this option, it is impossible to determine which rows (documents) might conform to the XML schema that is evolved. Conforming rows are not transformed during copy-based evolution, and afterward they are not decodable.</p>
</li>
</ul>
</div>
<p>You can specify, for tables and columns that use XML schema-based encodings, that they can accept also non-schema-based documents by using option <code>ALLOW NONSCHEMA</code>. In the absence of keyword <code>XMLSCHEMA</code>, encoding is for non-schema-based documents. In the absence of the keywords <code>ALLOW NONSCHEMA</code> but the presence of keyword <code>XMLSCHEMA</code>, encoding is for the single XML schema specified. In the absence of the keywords <code>ALLOW NONSCHEMA</code> but the presence of the keywords <code>ALLOW ANYSCHEMA</code>, encoding is for any XML schema that is referenced.</p>
<p>An error is raised if you try to insert an XML document into an <code>XMLType</code> table or column that does not correspond to the document.</p>
<p>The various possibilities are summarized in <a href="xdb05sto.htm#GUID-E7AB5A1F-FAAC-4463-8491-74992E49FA8E__CHDIAFJH" title="CREATE TABLE Encoding Options for Binary XML">Table 17-2</a>.</p>
<div class="tblformal" id="GUID-E7AB5A1F-FAAC-4463-8491-74992E49FA8E__CHDIAFJH">
<p class="titleintable">Table 17-2 CREATE TABLE Encoding Options for Binary XML</p>
<table class="cellalignment3420" title="CREATE TABLE Encoding Options for Binary XML" summary="CREATE TABLE Encoding Options for Binary XML">
<thead>
<tr class="cellalignment3411">
<th class="cellalignment3510" id="d83368e2639">Storage Options</th>
<th class="cellalignment3511" id="d83368e2642">Encoding Effect</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment3411">
<td class="cellalignment3512" id="d83368e2647" headers="d83368e2639">
<pre dir="ltr">STORE AS BINARY XML
</pre></td>
<td class="cellalignment3513" headers="d83368e2647 d83368e2642">
<p>Encodes all documents using the non-schema-based encoding.</p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3512" id="d83368e2654" headers="d83368e2639">
<pre dir="ltr">STORE AS BINARY XML
 XMLSCHEMA ...
</pre></td>
<td class="cellalignment3513" headers="d83368e2654 d83368e2642">
<p>Encodes all documents using an encoding based on the referenced XML schema.</p>
<p>Trying to insert or update a document that does not conform to the XML schema raises an error.</p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3512" id="d83368e2663" headers="d83368e2639">
<pre dir="ltr">STORE AS BINARY XML
 XMLSCHEMA ...
 ALLOW NONSCHEMA
</pre></td>
<td class="cellalignment3513" headers="d83368e2663 d83368e2642">
<p>Encodes all XML schema-based documents using an encoding based on the referenced XML schema. Encodes all non-schema-based documents using the non-schema-based encoding.</p>
<p>Trying to insert or update an XML schema-based document that does not conform to the referenced XML schema raises an error.</p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3512" id="d83368e2672" headers="d83368e2639">
<pre dir="ltr">STORE AS BINARY XML
 ALLOW ANYSCHEMA
</pre></td>
<td class="cellalignment3513" headers="d83368e2672 d83368e2642">
<p>Encodes all XML schema-based documents using an encoding based on the XML schema referenced by the document.</p>
<p>Trying to insert or update a document that does not reference a registered XML schema or that does not conform to the XML schema it references raises an error.</p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3512" id="d83368e2681" headers="d83368e2639">
<pre dir="ltr">STORE AS BINARY XML
 ALLOW ANYSCHEMA
 ALLOW NONSCHEMA
</pre></td>
<td class="cellalignment3513" headers="d83368e2681 d83368e2642">
<p>Encodes all XML schema-based documents using an encoding based on the XML schema referenced by the document. Encodes all non-schema-based documents using the non-schema-based encoding.</p>
<p>Trying to insert or update an XML schema-based document that does not conform to the registered XML schema it references raises an error.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="infobox-note" id="GUID-E7AB5A1F-FAAC-4463-8491-74992E49FA8E__GUID-917ECA57-9353-4220-B942-A4F730E45354">
<p class="notep1">Note:</p>
<p>If you use <code>CREATE TABLE</code> with <code>ALLOW NONSCHEMA</code> but not <code>ALLOW ANYSCHEMA</code>, then all documents, even XML schema-based documents, are encoded using the non-schema-based encoding. If you later use <code>ALTER TABLE</code> with <code>ALLOW ANYSCHEMA</code> on the same table, this has no effect on the encoding of documents that were stored prior to the <code>ALTER TABLE</code> operation&thinsp;&mdash;&thinsp;all such documents continue to be encoded using the non-schema-based encoding, regardless of whether they reference an XML schema. Only XML schema-based documents that you insert in the table after the <code>ALTER TABLE</code> operation are encoded using XML schema-based encodings.</p>
</div>
</div>
</div>
<a id="ADXDB6366"></a><a id="ADXDB4512"></a><a id="ADXDB5836"></a><a id="ADXDB4511"></a>
<div class="props_rev_3"><a id="GUID-F8159034-643E-4B26-BA57-4D60AF6D65D3"></a>
<h4 id="ADXDB-GUID-F8159034-643E-4B26-BA57-4D60AF6D65D3" class="sect4"><span class="enumeration_section">17.4.1.2</span> Object-Relational Storage of XML Schema-Based Data</h4>
<div>
<p>After you register an XML schema you can create an object-relational <code>XMLType</code> table or column for documents that conform to that schema. You can optionally specify object-relational storage options for the table or column.</p>
<p>Suppose that you have registered a purchase-order XML schema, identified by URL <code>http://xmlns.oracle.com/xdb/documentation/purchaseOrder.xsd</code>. You then create an object-relational <code>XMLType</code> table, <code>purchaseorder_as_table</code>, to store instances that conform to element <code>PurchaseOrder</code> of the XML schema, as in <a href="xdb05sto.htm#GUID-F8159034-643E-4B26-BA57-4D60AF6D65D3__CEGBEEAJ">Example 17-8</a>.</p>
<p>This automatically creates hidden columns that correspond to the database object type to which the <code>PurchaseOrder</code> element has been mapped. In addition, an <code>XMLEXTRA</code> object column is created, to store top-level instance data such as namespace declarations. <code>XMLEXTRA</code> is reserved for internal use.</p>
<p>Suppose that XML schema <code>purchaseOrder.xsd</code> defines element <code>LineItems</code> as a child of element <code>PurchaseOrder</code>, and that <code>LineItems</code> is a collection of <code>LineItem</code> elements.</p>
<p>With object-relational storage, collections are mapped to SQL varray values. An XML <strong class="term">collection</strong> is any element that is defined by the XML schema with <code>maxOccurs</code> &gt; 1, allowing it to appear multiple times. By default, the entire contents of such a varray is stored as a set of rows in an ordered collection table (OCT).</p>
<p><a href="xdb05sto.htm#GUID-F8159034-643E-4B26-BA57-4D60AF6D65D3__BJFGGABH">Example 17-9</a> creates table <code>purchaseorder_as_table</code> differently from <a href="xdb05sto.htm#GUID-F8159034-643E-4B26-BA57-4D60AF6D65D3__CEGBEEAJ">Example 17-8</a>. It specifies additional storage options:</p>
<ul style="list-style-type: disc;">
<li>
<p>The <code>LineItems</code> collection varray is stored as a LOB, not as a table.</p>
</li>
<li>
<p>Tablespace <code>USERS</code> is used for storing element <code>Notes</code>.</p>
</li>
<li>
<p>The table is <a id="d83368e2830" class="indexterm-anchor"></a>compressed for online transaction processing (OLTP).</p>
</li>
</ul>
<div class="infobox-note" id="GUID-F8159034-643E-4B26-BA57-4D60AF6D65D3__GUID-3E56EFF6-C688-4006-ACE1-1AAF246CFB65">
<p class="notep1">Note:</p>
<p>In releases prior to Oracle Database&nbsp;11<span class="italic">g</span>R2, the default behavior for <code>CREATE TABLE</code> was to store a collection using a varray stored as a LOB, not a varray stored as a table.</p>
</div>
<div class="infobox-note" id="GUID-F8159034-643E-4B26-BA57-4D60AF6D65D3__GUID-CFA51E25-D881-4D87-B2C4-C1858A2464B5">
<p class="notep1">Note:</p>
<p>When compression is specified for a parent <code>XMLType</code> table or column, all descendant <code>XMLType</code> ordered collection tables (OCTs) are similarly compressed.</p>
</div>
<div class="infoboxnotealso" id="GUID-F8159034-643E-4B26-BA57-4D60AF6D65D3__GUID-621B91CD-3705-4F32-A653-5664F1A6599D">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="xdb06stt.htm#GUID-F7E43D3A-67D8-432E-833A-DE0EA4CFCE7A" title="You can annotate XML schemas to influence the objects and tables that are generated by the XML schema registration process. You do this by adding Oracle-specific attributes to complexType, element, and attribute definitions that are declared by the XML schema.">Oracle XML Schema Annotations</a>&#34;</span> for information about specifying storage options by using XML schema annotations</p>
</li>
<li>
<p><a class="olink SQLRF54484" target="_blank" href="../SQLRF/statements_7002.htm#SQLRF54484"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about compression for OLTP</p>
</li>
</ul>
</div>
<p>As a convenience, if you need to specify that <span class="italic">all</span> varrays in an <code>XMLType</code> table or column are to be stored as LOBs, or all are to be stored as tables, then you can use the syntax clause <code>STORE ALL VARRAYS AS</code>, followed by <code>LOBS</code> or <code>TABLES</code>, respectively. This is a convenient alternative to using multiple <code>VARRAY</code>...<code>STORE AS</code> clauses, one for each collection. <a href="xdb05sto.htm#GUID-F8159034-643E-4B26-BA57-4D60AF6D65D3__BJFCHIJH">Example 17-10</a> illustrates this.</p>
<p>The storage method specified using <code>STORE ALL VARRAYS AS</code> overrides any storage method specified using (deprecated) XML Schema annotation <code>xdb:storeVarrayAsTable</code><a id="fn_2" href="#fn_2" onclick="footdisplay(2,&#34;XML Schema annotation xdb:storeVarrayAsTable is deprecated, starting with Oracle Database 12c Release 1 (12.1.0.1). &#34;)"><sup>Foot&nbsp;2</sup></a> in the corresponding XML schema.</p>
<div class="infoboxnotealso" id="GUID-F8159034-643E-4B26-BA57-4D60AF6D65D3__GUID-60A4936D-FC4F-45FC-8054-B92A59E39C37">
<p class="notep1">See Also:</p>
<p><a class="olink SQLRF01709" target="_blank" href="../SQLRF/statements_7002.htm#SQLRF01709"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about using <code>STORE ALL VARRAYS AS LOBS</code></p>
</div>
<div class="example" id="GUID-F8159034-643E-4B26-BA57-4D60AF6D65D3__CEGBEEAJ">
<p class="titleinexample">Example 17-8 Creating an Object-Relational XMLType Table with Default Storage</p>
<pre dir="ltr">CREATE TABLE purchaseorder_as_table OF XMLType 
   ELEMENT
   &#34;http://xmlns.oracle.com/xdb/documentation/purchaseOrder.xsd#PurchaseOrder&#34;;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-F8159034-643E-4B26-BA57-4D60AF6D65D3__BJFGGABH">
<p class="titleinexample">Example 17-9 Specifying Object-Relational Storage Options for XMLType Tables and Columns</p>
<pre dir="ltr">CREATE TABLE purchaseorder_as_table 
  OF XMLType (UNIQUE (&#34;XMLDATA&#34;.&#34;Reference&#34;),
              FOREIGN KEY (&#34;XMLDATA&#34;.&#34;User&#34;) REFERENCES hr.employees (email))
ELEMENT
  &#34;http://xmlns.oracle.com/xdb/documentation/purchaseOrder.xsd#PurchaseOrder&#34;
  <span class="bold">VARRAY</span> &#34;XMLDATA&#34;.&#34;LineItems&#34;.&#34;LineItem&#34; <span class="bold">STORE AS LOB</span> lineitem_lob
  <span class="bold">LOB</span> (&#34;XMLDATA&#34;.&#34;<span class="bold">Notes</span>&#34;)
    <span class="bold">STORE AS</span> (TABLESPACE <span class="bold">USERS</span> ENABLE STORAGE IN ROW 
              STORAGE(INITIAL 4K NEXT 32K))
    <span class="bold">COMPRESS FOR OLTP</span>;

CREATE TABLE purchaseorder_as_column (
  id NUMBER,
  xml_document XMLType,
  UNIQUE (xml_document.&#34;XMLDATA&#34;.&#34;Reference&#34;),
  FOREIGN KEY (xml_document.&#34;XMLDATA&#34;.&#34;User&#34;) REFERENCES hr.employees (email))
  XMLTYPE COLUMN xml_document
  XMLSCHEMA &#34;http://xmlns.oracle.com/xdb/documentation/purchaseOrder.xsd&#34;
  ELEMENT &#34;PurchaseOrder&#34;
  <span class="bold">VARRAY</span> xml_document.&#34;XMLDATA&#34;.&#34;LineItems&#34;.&#34;LineItem&#34; <span class="bold">STORE AS LOB</span> lineitem_lob
  <span class="bold">LOB</span> (xml_document.&#34;XMLDATA&#34;.&#34;<span class="bold">Notes</span>&#34;)
    <span class="bold">STORE AS</span> (TABLESPACE <span class="bold">USERS</span> ENABLE STORAGE IN ROW 
              STORAGE(INITIAL 4K NEXT 32K))
    <span class="bold">COMPRESS FOR OLTP</span>;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-F8159034-643E-4B26-BA57-4D60AF6D65D3__BJFCHIJH">
<p class="titleinexample">Example 17-10 Using STORE ALL VARRAYS AS</p>
<pre dir="ltr">CREATE TABLE purchaseorder_as_table OF XMLType (UNIQUE (&#34;XMLDATA&#34;.&#34;Reference&#34;),
  FOREIGN KEY (&#34;XMLDATA&#34;.&#34;User&#34;) REFERENCES hr.employees (email))
  ELEMENT
    &#34;http://xmlns.oracle.com/xdb/documentation/purchaseOrder.xsd#PurchaseOrder&#34;
  <span class="bold">STORE ALL VARRAYS AS LOBS</span>;
</pre></div>
<!-- class="example" --></div>
</div>
</div>
</div>
<a id="ADXDB4098"></a>
<div class="props_rev_3"><a id="GUID-43D926FC-083A-4CBB-8B3A-A157462D51F6"></a>
<h2 id="ADXDB-GUID-43D926FC-083A-4CBB-8B3A-A157462D51F6" class="sect2"><span class="enumeration_section">17.5</span> Ways to Identify XML Schema Instance Documents</h2>
<div>
<p>Before an XML document can be inserted into an XML Schema-based <code>XMLType</code> table or column, the associated XML schema must be identified. You can do this when you create the table or column, or you can use <code>XMLSchema-instance</code> to explicitly add the required schema identification to the XML instance document.</p>
<p>To explicitly identify the XML schema when creating the <code>XMLType</code> table or column, you can pass the name of the XML schema to the <code>XMLType</code> constructor, or you can invoke <code>XMLType</code> method <code>createSchemaBasedXML()</code>.</p>
<p>The advantage of the <code>XMLSchema-instance</code> mechanism is that it lets the Oracle XML&nbsp;DB protocol servers recognize that an XML document inserted into Oracle XML&nbsp;DB Repository is an instance of a registered XML schema. The content of the instance document is automatically stored in the default table specified by that XML schema.</p>
<p>The <code>XMLSchema-instance</code> mechanism is defined by the W3C XML Schema working group. It is based on adding attributes that identify the target XML schema to the root element of the instance document. These attributes are defined by the <code>XMLSchema-instance</code> namespace.</p>
<p>To identify an instance document as a member of the class defined by a particular XML schema you must declare the <code>XMLSchema-instance</code> namespace by adding a namespace declaration to the root element of the instance document. For example:</p>
<p><code>xmlns:xsi = http://www.w3.org/2001/XMLSchema-instance</code></p>
<p>Once the <code>XMLSchema-instance</code> namespace has been declared and given a <code>namespace</code> prefix, attributes that identify the XML schema can be added to the root element of the instance document. In the preceding example, the namespace prefix for the <code>XMLSchema-instance</code> namespace was defined as <code>xsi</code>. This prefix can then be used when adding the <code>XMLSchema-instance</code> attributes to the root element of the instance document.</p>
<p>Which attributes must be added depends on several factors. There are two possibilities, <code>noNamespaceSchemaLocation</code> and <code>schemaLocation</code>. Depending on the XML schema, one or both of these attributes is required to identify the XML schemas that the instance document is associated with.</p>
</div>
<a id="ADXDB4099"></a>
<div class="props_rev_3"><a id="GUID-167BD6E7-2628-4A7E-B4B9-D843CFF5F055"></a>
<h3 id="ADXDB-GUID-167BD6E7-2628-4A7E-B4B9-D843CFF5F055" class="sect3"><span class="enumeration_section">17.5.1</span> Attributes noNamespaceSchemaLocation and schemaLocation</h3>
<div>
<p>If the target XML schema does not declare a target namespace, attribute <code>noNamespaceSchemaLocation</code> is used to identify the XML schema. The attribute value is the <span class="italic">schema location hint</span>. This is the unique identifier that is passed to PL/SQL procedure <code>DBMS_XMLSCHEMA.registerSchema</code> when the XML schema is registered with the database.</p>
<p>For XML schema <code>purchaseOrder.xsd</code>, the correct definition of the root element of the instance document would read as follows:</p>
<pre dir="ltr">&lt;PurchaseOrder
  xmlns:xsi=http://www.w3.org/2001/XMLSchema-instance
  xsi:noNamespaceSchemaLocation=
    &#34;http://localhost:8080/source/schemas/poSource/xsd/purchaseOrder.xsd&#34;&gt;
</pre>
<p>If the target XML schema declares a target namespace, then the <code>schemaLocation</code> attribute is used to identify the XML schema. The value of this attribute is a pair of values separated by a space:</p>
<ul style="list-style-type: disc;">
<li>
<p>The value of the <span class="italic">target namespace</span> declared in the XML schema</p>
</li>
<li>
<p>The <span class="italic">schema location hint</span>, the unique identifier passed to procedure <code>DBMS_XMLSCHEMA.registerSchema</code> when the schema is registered with the database</p>
</li>
</ul>
<p>For example, assume that the <code>PurchaseOrder</code> XML schema includes a target namespace declaration. The root element of the schema would look like this:</p>
<pre dir="ltr">&lt;xs:schema <span class="bold">targetNamespace=&#34;http://demo.oracle.com/xdb/purchaseOrder&#34;</span>
           xmlns:xs=&#34;http://www.w3.org/2001/XMLSchema&#34;
           xmlns:xdb=&#34;http://xmlns.oracle.com/xdb&#34;
           version=&#34;1.0&#34;&gt;
   &lt;xs:element name=&#34;PurchaseOrder&#34; type=&#34;PurchaseOrderType&#34;
               xdb:defaultTable=&#34;PURCHASEORDER&#34;/&gt;
</pre>
<p>In this case, the correct form of the root element of the instance document would read as follows:</p>
<pre dir="ltr">&lt;PurchaseOrder
    xnlns=&#34;http://demo.oracle.com/xdb/purchaseOrder&#34;
    xmlns:xsi=http://www.w3.org/2001/XMLSchema-instance
    <span class="bold">xsi:schemaLocation=</span>
      &#34;<span class="bold">http://demo.oracle.com/xdb/purchaseOrder</span>
       <span class="bold">http://mdrake-lap:8080/source/schemas/poSource/xsd/purchaseOrder.xsd</span>&#34;&gt;
</pre></div>
</div>
<a id="ADXDB4100"></a>
<div class="props_rev_3"><a id="GUID-75D23190-524F-4A39-BC6E-F7D4C6F3FD66"></a>
<h3 id="ADXDB-GUID-75D23190-524F-4A39-BC6E-F7D4C6F3FD66" class="sect3"><span class="enumeration_section">17.5.2</span> XML Schema and Multiple Namespaces</h3>
<div>
<p>When an XML schema includes elements defined in multiple namespaces, an entry must occur in the <code>schemaLocation</code> attribute for each of the XML schemas. Each entry consists of the namespace declaration and the <span class="italic">schema location hint</span>.</p>
<p>The entries are separated from each other by one or more whitespace characters.</p>
<p>If the primary XML schema does not declare a target namespace, then the XML instance document also needs to include a <code>noNamespaceSchemaLocation</code> attribute that provides the <span class="italic">schema location hint</span> for the primary XML schema.</p>
</div>
</div>
</div>
<a id="ADXDB4526"></a><a id="ADXDB4525"></a>
<div class="props_rev_3"><a id="GUID-F5DA0566-E0D0-49C8-A846-1CE5067E15F4"></a>
<h2 id="ADXDB-GUID-F5DA0566-E0D0-49C8-A846-1CE5067E15F4" class="sect2"><span class="enumeration_section">17.6</span> XML Schema Data Types Are Mapped to Oracle XML&nbsp;DB Storage</h2>
<div>
<p>Data that conforms to an XML schema uses XML Schema data types. When this XML data is stored in Oracle XML&nbsp;DB, its storage data types are derived from the XML Schema data types using a default mapping and, optionally, using mapping information that you specify using XML schema annotations.</p>
<p>Whenever you do not specify a data type to use for storage, Oracle XML&nbsp;DB uses the default mapping to annotate the XML schema appropriately, during registration. In this way, the registered XML schema has a complete set of data-type annotations.</p>
<ul style="list-style-type: disc;">
<li>
<p>For object-relational storage, XML Schema data types are mapped to SQL data types.</p>
</li>
<li>
<p>For binary XML storage, XML Schema data types are mapped to Oracle XML&nbsp;DB binary XML encoding types.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-F5DA0566-E0D0-49C8-A846-1CE5067E15F4__GUID-F228C160-839B-4493-B14C-D3C326BE481F">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="xdb06stt.htm#GUID-844D686D-D95A-4C5B-8624-71BABDBF1EF5" title="You use PL/SQL package DBMS_XMLSCHEMA to map data types for XML Schema attributes and elements to SQL data types.">How to Map XML Schema Data Types to SQL Data Types</a>&#34;</span></p>
</div>
<p><a href="xdb05sto.htm#GUID-F5DA0566-E0D0-49C8-A846-1CE5067E15F4__i1044841">Figure 17-7</a> shows how Oracle XML&nbsp;DB creates XML schema-based <code>XMLType</code> tables using an XML document and a mapping specified in an XML schema. Depending on the storage method specified in the XML schema, an XML instance document is stored either as a binary XML value in a single <code>XMLType</code> column, or using multiple object-relational columns.</p>
<div class="figure" id="GUID-F5DA0566-E0D0-49C8-A846-1CE5067E15F4__i1044841">
<p class="titleinfigure">Figure 17-7 How Oracle XML&nbsp;DB Maps XML Schema-Based XMLType Tables</p>
<img width="489" height="584" src="img/GUID-D5A9BF23-59BB-4FC1-BEAD-1E6465D9BC9E-default.png" alt="Description of Figure 17-7 follows" title="Description of Figure 17-7 follows"/><br/>
<a href="img_text/GUID-D5A9BF23-59BB-4FC1-BEAD-1E6465D9BC9E-print.htm">Description of &#34;Figure 17-7 How Oracle XML&nbsp;DB Maps XML Schema-Based XMLType Tables&#34;</a></div>
<!-- class="figure" --></div>
</div>
<hr/>
<br/>
<p style="text-decoration:underline">Footnote Legend</p>
Footnote&nbsp;1:
<p>XMLSpy also supports WebDAV and FTP protocols, so you can use it to directly access and edit content stored in Oracle XML&nbsp;DB Repository.</p>
<br/>
Footnote&nbsp;2:
<p>XML Schema annotation <code>xdb:storeVarrayAsTable</code> is <span class="italic">deprecated</span>, starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.1).</p>
<br/></div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment3410">
<tr>
<td class="cellalignment3417">
<table class="cellalignment3415">
<tr>
<td class="cellalignment3414"><a href="xdb_storage.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment3414"><a href="xdb06stt.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2002, 2016, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment3419">
<table class="cellalignment3413">
<tr>
<td class="cellalignment3414"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment3414"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment3414"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment3414"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment3414"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment3414"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>


</body></html>