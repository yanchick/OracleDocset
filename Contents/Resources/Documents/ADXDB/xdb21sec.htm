<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-1619"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Repository%20Access%20Control"></a><title>Repository Access Control</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="description" content="Oracle Database provides classic database security such as row-level and column-level secure access by database users. It also provides fine-grained access control for resources in Oracle XML&nbsp;DB Repository. You can create, set, and modify access control lists (ACLs)."/>
<meta name="keywords" content="authentication, definition, authorization, principal, user, role, database, database role, database user, LDAP principal, LDAP, privilege, aggregate privilege, atomic privilege, access control entry (ACE), ACE, access control entry, access control list (ACL), resource, required privileges for operations, object identifier, OID, system ACLs, system, system ACL, predefined ACLs, bootstrap ACL, setting property in ACLs, hierarchy-enabled table, path-index trigger, trigger, path-index, uniform access control mechanism, Oracle Internet Directory"/>
<meta name="dcterms.created" content="2016-12-08T13:53:25Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="XML DB Developer&#39;s Guide"/>
<meta name="dcterms.identifier" content="E41152-15"/>
<meta name="dcterms.isVersionOf" content="ADXDB"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2002, 2016, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="xdb19rpl.htm" title="Previous" type="text/html"/>
<link rel="Next" href="xdb22pro.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41152-15.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-CD4A712D-CCA2-4A19-909E-AEC57849A55A"></a> <span id="PAGE" style="display:none;">40/61</span> <!-- End Header -->
<script>
//<![CDATA[
window.name='xdb21sec'
//]]>
</script> <script>
    function footdisplay(footnum,footnote) {
    var msg = window.open('', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');

    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">');
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>');
    msg.document.write('Footnote&amp;nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('');
    msg.document.write('<style> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]\u003e <\/style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
</script><noscript>
<p>The script content on this page is for navigation purposes only and does not alter the content in any way.</p>
</noscript><a id="ADXDB2400"></a>
<h1 id="ADXDB-GUID-CD4A712D-CCA2-4A19-909E-AEC57849A55A" class="sect1"><span class="enumeration_chapter">27</span> Repository Access Control</h1>
<div>
<p>Oracle Database provides classic database security such as row-level and column-level secure access by database users. It also provides fine-grained access control for resources in Oracle XML&nbsp;DB Repository. You can create, set, and modify access control lists (ACLs).</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="xdb21sec.htm#GUID-14816427-7EA8-4D7A-964A-326DF35AAEE5" title="Access control terms and concepts are explained. Each of the access-control entity &mdash; user, role, principal, privilege, access control list (ACL), and access control entry (ACE) &mdash; is implemented declaratively as an XML document or fragment.">Access Control Concepts</a></p>
</li>
<li>
<p><a href="xdb21sec.htm#GUID-FD4386C7-26F7-41B1-A5E4-CBFB21505883" title="The database privileges needed for common operations on resources in Oracle XML&nbsp;DB Repository are described.">Database Privileges for Repository Operations</a></p>
</li>
<li>
<p><a href="xdb21sec.htm#GUID-A81367EA-79B7-4744-A8B2-78F769626CF2" title="The privileges provided with Oracle Database include the standard WebDAV privileges as well as Oracle-specific privileges.">Privileges</a></p>
</li>
<li>
<p><a href="xdb21sec.htm#GUID-3B9D8F83-DA3E-4070-8D4C-AF12B212D806" title="ACLs are used to protect resources, which in the case of Oracle Database are resources (files and folders) in Oracle XML&nbsp;DB Repository. ACLs are composed of ACEs.">ACLs and ACEs</a></p>
</li>
<li>
<p><a href="xdb21sec.htm#GUID-899B397A-45B6-4180-9DEF-EFF4A0C6170A" title="Oracle Database access control lists (ACLs) are themselves (file) resources in Oracle XML&nbsp;DB Repository, so all of the access methods that operate on repository resources also apply to ACLs. In addition, there are several APIs specific to ACLs in PL/SQL package DBMS_XDB_REPOS.">Overview of Working with Access Control Lists (ACLs)</a></p>
</li>
<li>
<p><a href="xdb21sec.htm#GUID-A7903BE5-C081-40A9-B778-99289AB08E84" title="Since ACLs are checked for each access to the data they protect, the performance of the ACL check operation is critical to the performance of such data, including Oracle XML&nbsp;DB Repository resources. In Oracle XML&nbsp;DB, the required performance for this repository operation is achieved by employing several caches.">ACL Caching</a></p>
</li>
<li>
<p><a href="xdb21sec.htm#GUID-604D4E88-5309-4903-8224-B9DB850E4566" title="A uniform security mechanism for accessing REF-based repository resources is provided by enabling hierarchy on the tables used to store them. When ACL-based security is not needed for particular resources, you can optimize their access by using PL/SQL procedure DBMS_XDBZ.disable_hierarchy to turn off ACL checking.">Repository Resources and Database Table Security</a></p>
</li>
<li>
<p><a href="xdb21sec.htm#GUID-3E0217D9-1A93-49E8-AF39-04DD770C225D" title="You can allow Lightweight Directory Access Protocol (LDAP) users to use the features of Oracle XML&nbsp;DB, including ACLs.">Integration Of Oracle XML&nbsp;DB with LDAP</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-CD4A712D-CCA2-4A19-909E-AEC57849A55A__GUID-69760748-DA37-4A19-83E3-EE28427E2C8B">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="xdb22pro.htm#GUID-0476309D-E3DF-4C56-BF21-68CD04D00C98" title="You can access Oracle XML&nbsp;DB Repository data using protocols FTP and HTTP(S)/WebDAV.">Repository Access Using Protocols</a> for more information about WebDAV</p>
</li>
<li>
<p><a href="appaman.htm#GUID-FD0BCF20-2345-4D78-B96F-C52A4361291D" title="Administration of Oracle XML&nbsp;DB includes installing, upgrading, and configuring it.">Administration of Oracle XML&nbsp;DB</a> for information about configuring and administering resource security</p>
</li>
<li>
<p><span class="q">&#34;<a href="xdb10pls.htm#GUID-63032A9C-B4E2-4BB9-89E5-EBEEEF282C39" title="The PL/SQL Application Programming Interfaces (APIs) for XMLType are described.">PL/SQL APIs for XMLType: References</a>&#34;</span> for information about the PL/SQL APIs you can use to manage resource security</p>
</li>
</ul>
</div>
</div>
<a id="ADXDB5453"></a>
<div class="props_rev_3"><a id="GUID-14816427-7EA8-4D7A-964A-326DF35AAEE5"></a>
<h2 id="ADXDB-GUID-14816427-7EA8-4D7A-964A-326DF35AAEE5" class="sect2"><span class="enumeration_section">27.1</span> Access Control Concepts</h2>
<div>
<p>Access control terms and concepts are explained. Each of the access-control entity &mdash; user, role, principal, privilege, access control list (ACL), and access control entry (ACE) &mdash; is implemented declaratively as an XML document or fragment.</p>
<p>Secure authorization requires defining which users, applications, or functions can have access to which data, to perform which kinds of operations. There are thus three dimensions: (1) <span class="italic">which users</span> can (2) perform <span class="italic">which operations</span> (3) on <span class="italic">which data</span>. We speak of (1) principals, (2) privileges, and (3) objects, corresponding to these three dimensions, respectively. Principals are users or roles.</p>
<p>Principals and privileges (dimensions 1 and 2) are related in a declarative way by defining <span class="italic">access control lists</span>. These are then related to the third dimension, data, in various ways, either declaratively or procedurally. For example, you can protect an Oracle XML&nbsp;DB Repository resource or table data by using PL/SQL procedure <code>DBMS_XDB_REPOS.setACL</code> to set its controlling ACL.</p>
</div>
<a id="ADXDB6204"></a>
<div class="props_rev_3"><a id="GUID-0FCCC0AA-DAFF-4297-992C-276502D93068"></a>
<h3 id="ADXDB-GUID-0FCCC0AA-DAFF-4297-992C-276502D93068" class="sect3"><span class="enumeration_section">27.1.1</span> Authentication and Authorization</h3>
<div>
<p>The term <strong class="term">authentication</strong> refers to verifying the <span class="italic">identity</span> of something (for example, a user, device, or application). The term <strong class="term">authorization</strong> refers to verifying whether something that has been authenticated is allowed to <span class="italic">access</span> something else (for example, a database table or WebDAV resource).</p>
<p>Principals of various kinds can be authorized to access Oracle XML&nbsp;DB Repository resources. Application-specific principals can be authenticated.</p>
<div class="infoboxnotealso" id="GUID-0FCCC0AA-DAFF-4297-992C-276502D93068__GUID-6F02DC6B-4309-423D-8C26-F7FC38C6E57E">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="xdb21sec.htm#GUID-E1B993EA-E72F-44CC-8DDC-3A287B586BFF" title="In the context of fine-grained database access control, a principal is ultimately a set of one or more people or applications that access information in the database. A principal can be a database user or role, or an LDAP user or group.">Principal: A User or Role</a>&#34;</span> for information about principals</p>
</li>
<li>
<p>&#34;Custom Authentication and Authorization by Applications&#34; on page&nbsp;27‚Äê31 for information about authentication and authorization of application-specific principals</p>
</li>
</ul>
</div>
</div>
</div>
<a id="ADXDB5454"></a>
<div class="props_rev_3"><a id="GUID-E1B993EA-E72F-44CC-8DDC-3A287B586BFF"></a>
<h3 id="ADXDB-GUID-E1B993EA-E72F-44CC-8DDC-3A287B586BFF" class="sect3"><span class="enumeration_section">27.1.2</span> Principal: A User or Role</h3>
<div>
<p>In the context of fine-grained database access control, a principal is ultimately a set of one or more people or applications that access information in the database. A principal can be a database user or role, or an LDAP user or group.</p>
<p>A <strong class="term">principal</strong> is a user or a role. A <strong class="term">user</strong> can be any person or application that accesses information in the database. A <strong class="term">role</strong> is composed of users and possibly other roles, but this recursion cannot be circular. Ultimately, each role, and thus each principal, corresponds to a <span class="italic">set of users</span>.</p>
<p>A user is represented for access control purposes by an XML fragment with element <code>user</code>. A role is represented by a fragment with element <code>role</code>.</p>
<p>Oracle Database supports the following as principals:</p>
<ul style="list-style-type: disc;">
<li>
<p>Database users and <strong class="term">database roles</strong>. A <span class="bold">database user</span> is also sometimes referred to as a database <strong class="term">schema</strong> or a user <strong class="term">account</strong>. When a person or application logs onto the database, it uses a database user (schema) and password. A <strong class="term">database role</strong> corresponds to a set of database privileges that can be granted to database users, applications, or other database roles&thinsp;&mdash;&thinsp;see <span class="q">&#34;<a href="xdb21sec.htm#GUID-F58BB443-D5A5-490D-B766-60F80EB01645" title="A database role maps privileges to users. In the context of fine-grained access control, an ACL maps privileges to users, and a role is just a set of users.">Database Roles and ACLs Map Privileges to Users</a>&#34;</span>.</p>
</li>
<li>
<p>LDAP users and groups of LDAP users. For details about using <strong class="term">LDAP principals</strong> see <span class="q">&#34;<a href="xdb21sec.htm#GUID-3E0217D9-1A93-49E8-AF39-04DD770C225D" title="You can allow Lightweight Directory Access Protocol (LDAP) users to use the features of Oracle XML&nbsp;DB, including ACLs.">Integration Of Oracle XML&nbsp;DB with LDAP</a>&#34;</span>.</p>
</li>
</ul>
<p>When a term such as &#34;user&#34; or &#34;role&#34; is used here without qualification, it applies to all types of user or role. When it is important to distinguish the type, the qualifier &#34;database&#34; or &#34;LDAP&#34; is used.</p>
</div>
<a id="ADXDB5455"></a>
<div class="props_rev_3"><a id="GUID-F58BB443-D5A5-490D-B766-60F80EB01645"></a>
<h4 id="ADXDB-GUID-F58BB443-D5A5-490D-B766-60F80EB01645" class="sect4"><span class="enumeration_section">27.1.2.1</span> Database Roles and ACLs Map Privileges to Users</h4>
<div>
<p>A database role maps privileges to users. In the context of fine-grained access control, an ACL maps privileges to users, and a role is just a set of users.</p>
<p>A database role is <span class="italic">granted</span> privileges, just as a database user can be granted privileges. A database role serves as an intermediary for mapping database privileges to database users (and applications): a role is granted privileges, and the role is then granted to users (giving them the privileges).</p>
<p>The line between a group of users and a group of privileges that are granted to those users is blurred a bit in the concept of database role: the role can serve to group the privileges that are mapped to the users and to group the users to which the privileges are mapped. The mapping is done by defining the role and granting it to users, and traditional database terminology considers the role to be the same thing as the set of privileges that are granted to it.</p>
<p>In the context of fine-grained access control, a different mechanism, an <span class="italic">access control list</span> (ACL), is used as the intermediary that maps privileges to users. A role is simply a set of users. In this context, the act of associating privileges with users and with roles is not a database grant. It is a declarative ACL entry, together with a run-time evaluation of ACLs and resolution of ACL conflicts.</p>
<p>Please keep this terminology difference in mind, to avoid confusion. As a means of mapping privileges to users, a database role combines some of the functionality that in an access-control context is divided into (1) principals, (2) privileges, and (3) ACLs. In access control terminology, roles are classified with users as principals. In traditional database terminology, roles are instead classified as sets of privileges.</p>
</div>
</div>
<a id="ADXDB5457"></a>
<div class="props_rev_3"><a id="GUID-2F37A1AE-35E5-4997-B85E-E4A7179AA9E2"></a>
<h4 id="ADXDB-GUID-2F37A1AE-35E5-4997-B85E-E4A7179AA9E2" class="sect4"><span class="enumeration_section">27.1.2.2</span> Principal DAV::owner</h4>
<div>
<p>You can use principal <code>DAV::owner</code> to refer to the owner of a given repository resource. The owner of a resource is one of the properties of the resource. You can use principal <code>DAV::owner</code> to facilitate ACL sharing among principals, because the owner of a resource often has special rights.</p>
</div>
</div>
</div>
<a id="ADXDB5458"></a>
<div class="props_rev_3"><a id="GUID-09CBE3AA-EB8A-4466-9AAD-B35DAE5B35DD"></a>
<h3 id="ADXDB-GUID-09CBE3AA-EB8A-4466-9AAD-B35DAE5B35DD" class="sect3"><span class="enumeration_section">27.1.3</span> Privilege: A Permission</h3>
<div>
<p>A <strong class="term">privilege</strong> is a particular right or permission that can be granted or denied to a principal. A privilege is aggregate or atomic. An aggregate privilege includes other privileges; an atomic privilege does not.</p>
<ul style="list-style-type: disc;">
<li>
<p><strong class="term">Aggregate</strong> privilege &ndash; A privilege that includes other privileges.</p>
</li>
<li>
<p><strong class="term">Atomic</strong> privilege &ndash; A privilege that does not include other privileges. It cannot be subdivided.</p>
</li>
</ul>
<p>Aggregate privileges simplify usability when the number of privileges becomes large, and they promote interoperability between ACL clients. See <span class="q">&#34;<a href="xdb21sec.htm#GUID-A81367EA-79B7-4744-A8B2-78F769626CF2" title="The privileges provided with Oracle Database include the standard WebDAV privileges as well as Oracle-specific privileges.">Privileges</a>&#34;</span>.</p>
<p>Aggregate privileges retain their identity: they are not decomposed into the corresponding atomic (leaf) privileges. In WebDAV terms, Oracle Database aggregate privileges are not abstract. This implies that an aggregate privilege acts as a set of pointers to its component privileges, rather than a copy of those components. Thus, an aggregate privilege is always up to date, even if the definition of a component changes.</p>
<p>The set of privileges granted to a principal controls whether that principal can perform a given operation on the data that it protects. For example, if the principal (database user) <code>HR</code> wants to perform the <code>read</code> operation on a given resource, then read privileges must be granted to principal <code>HR</code> prior to the read operation.</p>
</div>
</div>
<a id="ADXDB5462"></a><a id="ADXDB5461"></a>
<div class="props_rev_3"><a id="GUID-8608F3A2-59C3-439A-9A03-D887D1F0DF46"></a>
<h3 id="ADXDB-GUID-8608F3A2-59C3-439A-9A03-D887D1F0DF46" class="sect3"><span class="enumeration_section">27.1.4</span> Access Control Entry (ACE)</h3>
<div>
<p>An <strong class="term">access control entry</strong> (<strong class="term">ACE</strong>) is an XML element (<code>ace</code>) that is an entry in an access control list (ACL). An ACE either grants or denies access to some repository resource or other database data by a particular principal.</p>
<p>The ACE does not, itself, specify which data to protect. That is done outside the ACE and the ACL, by associating the ACL with target data. One way to make that association is by using PL/SQL procedure <code>DBMS_XDB_REPOS.setACL</code>.</p>
<p>See <span class="q">&#34;<a href="xdb21sec.htm#GUID-3A94EEAA-A6ED-41EC-AE44-98D4D5FCF452" title="Privileges are checked before a principal is allowed to access a repository resource that is protected by ACLs. This check is done by evaluating the protecting ACLs for that principal, in order. For each such ACL, the ACEs in it that apply to the principal are examined, in order.">ACL and ACE Evaluation</a>&#34;</span>.</p>
<p>An Oracle XML&nbsp;DB ACE either grants or denies privileges for a principal. An <span class="bold"><code>ace</code></span> element has the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>Operation <code>grant</code>: either <code>true</code> (to grant) or <code>false</code> (to deny) access.</p>
</li>
<li>
<p>Either a valid principal (element <code>principal</code>) or a completed list of principals (element <code>invert</code>).</p>
</li>
<li>
<p>Privileges: A set of privileges to be granted or denied for a particular principal (element <code>privilege</code>).</p>
</li>
<li>
<p>Principal format (optional): The format of the principal. An LDAP distinguished name (DN), a short name (database user/role or LDAP nickname), or an LDAP globally unique identifier (GUID). The default value is <code>short name</code>. If the principal name matches both a database user and an LDAP nickname, it is assumed to refer to the LDAP nickname.</p>
</li>
<li>
<p>Collection (optional): A <code>BOOLEAN</code> attribute that specifies whether the principal is a collection of users (LDAP group or database role) or a single user (LDAP user or database user).</p>
</li>
</ul>
<p><a href="xdb21sec.htm#GUID-8608F3A2-59C3-439A-9A03-D887D1F0DF46__CHDGJBCF">Example 27-1</a> shows a simple ACE that grants privilege <code>DAV::all</code> to principal <code>DAV::owner</code>. It thus grants all privileges to the owner of the resource to which its ACL applies.</p>
<div class="example" id="GUID-8608F3A2-59C3-439A-9A03-D887D1F0DF46__CHDGJBCF">
<p class="titleinexample">Example 27-1 Simple Access Control Entry (ACE) that Grants a Privilege</p>
<pre>&lt;ace&gt;
  &lt;grant&gt;true&lt;/grant&gt;
  &lt;principal&gt;DAV::owner&lt;/principal&gt;
  &lt;privilege&gt;
    &lt;DAV::all/&gt;
  &lt;/privilege&gt;
&lt;/ace&gt;
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ADXDB5464"></a><a id="ADXDB5463"></a>
<div class="props_rev_3"><a id="GUID-59DFDDDD-BCCE-4349-AEB0-E433879BAD5B"></a>
<h3 id="ADXDB-GUID-59DFDDDD-BCCE-4349-AEB0-E433879BAD5B" class="sect3"><span class="enumeration_section">27.1.5</span> Access Control List (ACL)</h3>
<div>
<p>An <strong class="term">access control list</strong> (<strong class="term">ACL</strong>) is a list of access control entries (ACEs). By default, order in the list is relevant.</p>
<div class="infoboxnotealso" id="GUID-59DFDDDD-BCCE-4349-AEB0-E433879BAD5B__GUID-6FC0A3C1-E31A-4992-AA8F-2F99CD97A942">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="xdb21sec.htm#GUID-3A94EEAA-A6ED-41EC-AE44-98D4D5FCF452" title="Privileges are checked before a principal is allowed to access a repository resource that is protected by ACLs. This check is done by evaluating the protecting ACLs for that principal, in order. For each such ACL, the ACEs in it that apply to the principal are examined, in order.">ACL and ACE Evaluation</a>&#34;</span></p>
</div>
<p><a href="xdb21sec.htm#GUID-59DFDDDD-BCCE-4349-AEB0-E433879BAD5B__CHDGIJJJ">Example 27-2</a> shows a simple ACL that contains only the ACE of <a href="xdb21sec.htm#GUID-8608F3A2-59C3-439A-9A03-D887D1F0DF46__CHDGJBCF">Example 27-1</a>.</p>
<div class="example" id="GUID-59DFDDDD-BCCE-4349-AEB0-E433879BAD5B__CHDGIJJJ">
<p class="titleinexample">Example 27-2 Simple Access Control List (ACL) that Grants a Privilege</p>
<pre dir="ltr">&lt;acl description=&#34;myacl&#34;
     xmlns=&#34;http://xmlns.oracle.com/xdb/acl.xsd&#34;
     xmlns:dav=&#34;DAV:&#34;
     xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;
     xsi:schemaLocation=&#34;http://xmlns.oracle.com/xdb/acl.xsd
                         http://xmlns.oracle.com/xdb/acl.xsd&#34;&gt;
  &lt;ace&gt;
    &lt;grant&gt;true&lt;/grant&gt;
    &lt;principal&gt;dav:owner&lt;/principal&gt;
    &lt;privilege&gt;
      &lt;dav:all/&gt;
    &lt;/privilege&gt;
  &lt;/ace&gt;
&lt;/acl&gt;
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<a id="ADXDB5466"></a><a id="ADXDB5465"></a>
<div class="props_rev_3"><a id="GUID-FD4386C7-26F7-41B1-A5E4-CBFB21505883"></a>
<h2 id="ADXDB-GUID-FD4386C7-26F7-41B1-A5E4-CBFB21505883" class="sect2"><span class="enumeration_section">27.2</span> Database Privileges for Repository Operations</h2>
<div>
<p>The database privileges needed for common operations on resources in Oracle XML&nbsp;DB Repository are described.</p>
<p><a href="xdb21sec.htm#GUID-FD4386C7-26F7-41B1-A5E4-CBFB21505883__g1037226" title="This table describes privileges needed for various operations on Oracle XML DB resources, such as create, delete, and update.">Table 27-1</a> shows the database privileges required for some common operations on resources in Oracle XML&nbsp;DB Repository. In addition to the privileges listed in column <span class="bold">Privileges Required</span> you must have the <code>resolve</code> privilege for the folder containing the resource and for all of its parent folders, up to the root folder.</p>
<div class="tblformalwide" id="GUID-FD4386C7-26F7-41B1-A5E4-CBFB21505883__g1037226">
<p class="titleintable">Table 27-1 Database Privileges Needed for Operations on Oracle XML&nbsp;DB Resources</p>
<table class="cellalignment3431" title="Database Privileges Needed for Operations on Oracle XML&nbsp;DB Resources " summary="This table describes privileges needed for various operations on Oracle XML DB resources, such as create, delete, and update.">
<thead>
<tr class="cellalignment3411">
<th class="cellalignment3558" id="d131103e729">Operation</th>
<th class="cellalignment3444" id="d131103e732">Description</th>
<th class="cellalignment3524" id="d131103e735">Privileges Required</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment3411">
<td class="cellalignment3559" id="d131103e740" headers="d131103e729">
<p><code>CREATE</code></p>
</td>
<td class="cellalignment3446" headers="d131103e740 d131103e732">
<p>Create a new resource in folder F</p>
</td>
<td class="cellalignment3525" headers="d131103e740 d131103e735">
<p><code>update</code> and <code>link</code> on folder F</p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3559" id="d131103e756" headers="d131103e729">
<p><code>DELETE</code></p>
</td>
<td class="cellalignment3446" headers="d131103e756 d131103e732">
<p>Delete resource R from folder F</p>
</td>
<td class="cellalignment3525" headers="d131103e756 d131103e735">
<p><code>update</code> and <code>unlink-from</code> on R, <code>update</code> and <code>unlink</code> on folder F</p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3559" id="d131103e778" headers="d131103e729">
<p><code>UPDATE</code></p>
</td>
<td class="cellalignment3446" headers="d131103e778 d131103e732">
<p>Update the contents or properties of resources R</p>
</td>
<td class="cellalignment3525" headers="d131103e778 d131103e735">
<p><code>update</code> on R</p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3559" id="d131103e791" headers="d131103e729">
<p><code>GET</code></p>
</td>
<td class="cellalignment3446" headers="d131103e791 d131103e732">
<p>An FTP or HTTP(S) retrieval of resource R</p>
</td>
<td class="cellalignment3525" headers="d131103e791 d131103e735">
<p><code>read-properties</code>, <code>read-contents</code> on R</p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3559" id="d131103e807" headers="d131103e729">
<p><code>SET_ACL</code></p>
</td>
<td class="cellalignment3446" headers="d131103e807 d131103e732">
<p>Set the ACL of a resource R</p>
</td>
<td class="cellalignment3525" headers="d131103e807 d131103e735">
<p><code>DAV::write-acl</code> on R</p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3559" id="d131103e820" headers="d131103e729">
<p><code>LIST</code></p>
</td>
<td class="cellalignment3446" headers="d131103e820 d131103e732">
<p>List the resources in folder F</p>
</td>
<td class="cellalignment3525" headers="d131103e820 d131103e735">
<p><code>read-properties</code> on folder F, <code>read-properties</code> on resources in folder F. Only those resources on which the user has <code>read-properties</code> privilege are listed.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="infoboxnotealso" id="GUID-FD4386C7-26F7-41B1-A5E4-CBFB21505883__GUID-F0702B17-03B2-4BF2-825B-98C3C44DA830">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="appaman.htm#GUID-D89A2092-4BBF-4069-90FE-8E71C3EC3896" title="Various considerations apply to all upgrades of Oracle Database from a release prior to Oracle Database 12c Release 1 (12.1.0.1).">Upgrade or Downgrade of an Existing Oracle XML&nbsp;DB Installation</a>&#34;</span> for information about treatment of database access privileges when upgrading</p>
</div>
</div>
</div>
<a id="ADXDB2410"></a>
<div class="props_rev_3"><a id="GUID-A81367EA-79B7-4744-A8B2-78F769626CF2"></a>
<h2 id="ADXDB-GUID-A81367EA-79B7-4744-A8B2-78F769626CF2" class="sect2"><span class="enumeration_section">27.3</span> Privileges</h2>
<div>
<p>The privileges provided with Oracle Database include the standard WebDAV privileges as well as Oracle-specific privileges.</p>
<div class="section">
<p>The standard WebDAV privileges use the WebDAV namespace <span class="bold"><code>DAV:</code></span><a id="fn_1" href="#fn_1" onclick="footdisplay(1,&#34;Note the colon (:) as part of the namespace name. DAV: is the namespace itself, not a prefix. A prefix commonly used for namespace DAV: is dav, but this is only conventional. dav is not a predefined prefix for Oracle XML&nbsp;DB. &#34;)"><sup>Foot&nbsp;1</sup></a>. The Oracle-specific privileges use the Oracle XML&nbsp;DB ACL namespace, <code>http://xmlns.oracle.com/xdb/acl.xsd</code>, which has the predefined prefix <a id="d131103e905" class="indexterm-anchor"></a><span class="bold"><code>xdb</code></span>.</p>
<div class="infoboxnotealso" id="GUID-A81367EA-79B7-4744-A8B2-78F769626CF2__GUID-28119663-59C7-4F83-A8BE-8A9E9CBEECC4">
<p class="notep1">See Also:</p>
<p>RFC 3744: &#34;Web Distributed Authoring and Versioning (WebDAV) Access Control Protocol&#34;, IETF Network Working Group Request For Comments #3744, May 2004</p>
</div>
</div>
<!-- class="section" --></div>
<a id="ADXDB5473"></a><a id="ADXDB5472"></a>
<div class="props_rev_3"><a id="GUID-841802F8-3D05-485C-8A42-4D4C41CE6744"></a>
<h3 id="ADXDB-GUID-841802F8-3D05-485C-8A42-4D4C41CE6744" class="sect3"><span class="enumeration_section">27.3.1</span> Atomic Privileges</h3>
<div>
<p>An atomic privilege does not include other privileges. The available atomic privileges for repository operations are described, and their database counterparts are listed.</p>
<div class="section"></div>
<!-- class="section" -->
<div class="tblformalwide" id="GUID-841802F8-3D05-485C-8A42-4D4C41CE6744__CHDBECJA">
<p class="titleintable">Table 27-2 Atomic Privileges</p>
<table class="cellalignment3431" title="Atomic Privileges" summary="This table describes atomic privileges supported by Oracle XML DB. It includes the database equivalent privilege.">
<thead>
<tr class="cellalignment3411">
<th class="cellalignment3462" id="d131103e949">Atomic Privilege</th>
<th class="cellalignment3560" id="d131103e952">Description</th>
<th class="cellalignment3467" id="d131103e955">Database Counterpart</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment3411">
<td class="cellalignment3465" id="d131103e960" headers="d131103e949">
<p><code>DAV::lock</code></p>
</td>
<td class="cellalignment3561" headers="d131103e960 d131103e952">
<p>Lock a resource using WebDAV locks.</p>
</td>
<td class="cellalignment3470" headers="d131103e960 d131103e955">
<p><code>UPDATE</code></p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3465" id="d131103e972" headers="d131103e949">
<p><code>DAV::read-current-user-privilege-set</code></p>
</td>
<td class="cellalignment3561" headers="d131103e972 d131103e952">
<p>Access the <code>DAV::current-user-privilege-set</code> property of a resource.</p>
</td>
<td class="cellalignment3470" headers="d131103e972 d131103e955">
<p>N/A</p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3465" id="d131103e986" headers="d131103e949">
<p><code>DAV::take-ownership</code></p>
</td>
<td class="cellalignment3561" headers="d131103e986 d131103e952">
<p>Take ownership of a resource.</p>
</td>
<td class="cellalignment3470" headers="d131103e986 d131103e955">
<p>N/A</p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3465" id="d131103e997" headers="d131103e949">
<p><code>DAV::unlock</code></p>
</td>
<td class="cellalignment3561" headers="d131103e997 d131103e952">
<p>Unlock a resource locked using a WebDAV lock.</p>
</td>
<td class="cellalignment3470" headers="d131103e997 d131103e955">
<p><code>UPDATE</code></p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3465" id="d131103e1009" headers="d131103e949">
<p><code>DAV::write-content</code></p>
</td>
<td class="cellalignment3561" headers="d131103e1009 d131103e952">
<p>Modify the content of a resource.</p>
</td>
<td class="cellalignment3470" headers="d131103e1009 d131103e955">
<p><code>UPDATE</code></p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3465" id="d131103e1021" headers="d131103e949">
<p><code>DAV::write-properties</code></p>
</td>
<td class="cellalignment3561" headers="d131103e1021 d131103e952">
<p>Modify the properties of a resource. Lock or unlock a resource. Modifiable properties include <code>Author</code>, <code>DisplayName</code>, <code>Language</code>, <code>CharacterSet</code>, <code>ContentType</code>, <code>SBResExtra</code>, <code>Owner</code>, <code>OwnerID</code>, <code>CreationDate</code>, <code>Modification Date</code>, <code>ACL</code>, <code>ACLOID</code>, <code>Lock</code>, and <code>Locktoken</code>.</p>
</td>
<td class="cellalignment3470" headers="d131103e1021 d131103e955">
<p><code>UPDATE</code></p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3465" id="d131103e1077" headers="d131103e949">
<p><code>xdb:link</code></p>
</td>
<td class="cellalignment3561" headers="d131103e1077 d131103e952">
<p>Allow creation of links from a resource.</p>
</td>
<td class="cellalignment3470" headers="d131103e1077 d131103e955">
<p><code>INSERT</code></p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3465" id="d131103e1089" headers="d131103e949">
<p><code>xdb:link-to</code></p>
</td>
<td class="cellalignment3561" headers="d131103e1089 d131103e952">
<p>Allow creation of links to a resource.</p>
</td>
<td class="cellalignment3470" headers="d131103e1089 d131103e955">
<p>N/A</p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3465" id="d131103e1100" headers="d131103e949">
<p><code>xdb:read-acl</code></p>
</td>
<td class="cellalignment3561" headers="d131103e1100 d131103e952">
<p>Read the ACL of a resource.</p>
</td>
<td class="cellalignment3470" headers="d131103e1100 d131103e955">
<p><code>SELECT</code></p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3465" id="d131103e1112" headers="d131103e949">
<p><code>xdb:read-contents</code></p>
</td>
<td class="cellalignment3561" headers="d131103e1112 d131103e952">
<p>Read the contents of a resource.</p>
</td>
<td class="cellalignment3470" headers="d131103e1112 d131103e955">
<p><code>SELECT</code></p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3465" id="d131103e1124" headers="d131103e949">
<p><code>xdb:read-properties</code></p>
</td>
<td class="cellalignment3561" headers="d131103e1124 d131103e952">
<p>Read the properties of a resource.</p>
</td>
<td class="cellalignment3470" headers="d131103e1124 d131103e955">
<p><code>SELECT</code></p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3465" id="d131103e1137" headers="d131103e949">
<p><code>xdb:resolve</code></p>
</td>
<td class="cellalignment3561" headers="d131103e1137 d131103e952">
<p>Traverse a folder (for folders only).</p>
</td>
<td class="cellalignment3470" headers="d131103e1137 d131103e955">
<p><code>SELECT</code></p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3465" id="d131103e1149" headers="d131103e949">
<p><code>xdb:unlink</code></p>
</td>
<td class="cellalignment3561" headers="d131103e1149 d131103e952">
<p>Allow deletion of links from a resource.</p>
</td>
<td class="cellalignment3470" headers="d131103e1149 d131103e955">
<p><code>DELETE</code></p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3465" id="d131103e1161" headers="d131103e949">
<p><code>xdb:unlink-from</code></p>
</td>
<td class="cellalignment3561" headers="d131103e1161 d131103e952">
<p>Allow deletion of links to a resource.</p>
</td>
<td class="cellalignment3470" headers="d131103e1161 d131103e955">
<p>N/A</p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3465" id="d131103e1172" headers="d131103e949">
<p><code>xdb:update-acl</code></p>
</td>
<td class="cellalignment3561" headers="d131103e1172 d131103e952">
<p>Change the contents of the resource ACL.</p>
</td>
<td class="cellalignment3470" headers="d131103e1172 d131103e955">
<p><code>UPDATE</code></p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3465" id="d131103e1184" headers="d131103e949">
<p><code>xdb:write-acl-ref</code></p>
</td>
<td class="cellalignment3561" headers="d131103e1184 d131103e952">
<p>Change the ACLOID of a resource.</p>
</td>
<td class="cellalignment3470" headers="d131103e1184 d131103e955">
<p><code>UPDATE</code></p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="ADXDB5475"></a><a id="ADXDB5474"></a>
<div class="props_rev_3"><a id="GUID-81D0DBA7-1370-4B2C-A62B-47E0BBEFF707"></a>
<h3 id="ADXDB-GUID-81D0DBA7-1370-4B2C-A62B-47E0BBEFF707" class="sect3"><span class="enumeration_section">27.3.2</span> Aggregate Privileges</h3>
<div>
<p>An Aggregate privilege contains other privileges, atomic or aggregate. The available aggregate privileges for repository operations are listed together with their component atomic privileges.</p>
<div class="section"></div>
<!-- class="section" -->
<div class="tblformal" id="GUID-81D0DBA7-1370-4B2C-A62B-47E0BBEFF707__CHDGJIHA">
<p class="titleintable">Table 27-3 Aggregate Privileges</p>
<table class="cellalignment3420" title="Aggregate Privileges" summary="This table describes aggregate privileges supported by Oracle XML DB.">
<thead>
<tr class="cellalignment3411">
<th class="cellalignment3526" id="d131103e1231">Aggregate Privilege</th>
<th class="cellalignment3527" id="d131103e1234">Component Atomic Privileges</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment3411">
<td class="cellalignment3528" id="d131103e1239" headers="d131103e1231">
<p><code>DAV::all</code></p>
</td>
<td class="cellalignment3529" headers="d131103e1239 d131103e1234">
<p>All atomic DAV privileges.</p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3528" id="d131103e1247" headers="d131103e1231">
<p><code>xdb:all</code></p>
</td>
<td class="cellalignment3529" headers="d131103e1247 d131103e1234">
<p>All atomic DAV privileges plus <code>xdb:link-to</code>.</p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3528" id="d131103e1258" headers="d131103e1231">
<p><code>DAV::bind</code></p>
</td>
<td class="cellalignment3529" headers="d131103e1258 d131103e1234">
<p><code>xdb:link</code></p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3528" id="d131103e1267" headers="d131103e1231">
<p><code>DAV::unbind</code></p>
</td>
<td class="cellalignment3529" headers="d131103e1267 d131103e1234">
<p><code>xdb:unlink</code></p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3528" id="d131103e1276" headers="d131103e1231">
<p><code>DAV::read</code></p>
</td>
<td class="cellalignment3529" headers="d131103e1276 d131103e1234">
<p><code>xdb:read-properties</code>, <code>xdb:read-contents</code>, <code>xdb:resolve</code></p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3528" id="d131103e1291" headers="d131103e1231">
<p><code>DAV::read-acl</code></p>
</td>
<td class="cellalignment3529" headers="d131103e1291 d131103e1234">
<p><code>xdb:read-acl</code></p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3528" id="d131103e1300" headers="d131103e1231">
<p><code>DAV::write</code></p>
</td>
<td class="cellalignment3529" headers="d131103e1300 d131103e1234">
<p><code>DAV::write-content</code>, <code>DAV::write-properties</code>, <code>xdb:link</code>, <code>xdb:unlink</code>, <code>xdb:unlink-from</code></p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3528" id="d131103e1321" headers="d131103e1231">
<p><code>DAV::write-acl</code></p>
</td>
<td class="cellalignment3529" headers="d131103e1321 d131103e1234">
<p><code>xdb:write-acl-ref</code>, <code>xdb:update-acl</code></p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3528" id="d131103e1333" headers="d131103e1231">
<p><code>DAV::update</code></p>
</td>
<td class="cellalignment3529" headers="d131103e1333 d131103e1234">
<p><code>DAV::write-content</code>, <code>DAV::write-properties</code></p>
</td>
</tr>
<tr class="cellalignment3411">
<td class="cellalignment3528" id="d131103e1345" headers="d131103e1231">
<p><code>xdb:update</code></p>
</td>
<td class="cellalignment3529" headers="d131103e1345 d131103e1234">
<p><code>DAV::write-properties</code>, <code>DAV::write-content</code></p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
</div>
<a id="ADXDB2430"></a>
<div class="props_rev_3"><a id="GUID-3B9D8F83-DA3E-4070-8D4C-AF12B212D806"></a>
<h2 id="ADXDB-GUID-3B9D8F83-DA3E-4070-8D4C-AF12B212D806" class="sect2"><span class="enumeration_section">27.4</span> ACLs and ACEs</h2>
<div>
<p>ACLs are used to protect resources, which in the case of Oracle Database are resources (files and folders) in Oracle XML&nbsp;DB Repository. ACLs are composed of ACEs.</p>
<p>An access control list (ACL) is a standard security mechanism that is used in some languages, such as Java, and some operating systems, such as Microsoft Windows. ACLs are also a part of the WebDAV standard.</p>
<p>Repository resources can be accessed using WebDAV, and their protecting ACLs act as WebDAV ACLs. Each repository resource is protected by some ACL. ACLs that protect a resource are enforced no matter how the resource is accessed, whether by WebDAV, SQL, or any other way.</p>
<p>When a new resource is created in Oracle XML&nbsp;DB Repository, by default the ACL on its parent folder is used to protect the resource. After the resource is created, a new ACL can be set on it.</p>
<p>ACLs in Oracle Database are XML documents that are validated against the Oracle Database ACL XML schema, which is located in Oracle XML&nbsp;DB Repository at <code>/sys/schemas/PUBLIC/xmlns.oracle.com/xdb/acl.xsd</code>. ACLs are themselves stored and managed as resources in the repository.</p>
<p>Before a principal performs an operation on ACL-protected data, the user privileges for the protected data are checked. The set of privileges checked depends on the operation to be performed.</p>
<p>Aggregate privileges are composed of other privileges. When an ACL is stored, the aggregate privileges it refers to act as sets of pointers to their component privileges.</p>
<p>All ACLs are stored in table <span class="bold"><code>XDB$ACL</code></span>, which is owned by database schema (user account) <code>XDB</code>. This is an XML schema-based <code>XMLType</code> table. Each row in this table (and therefore each ACL) has a system-generated object identifier (<strong class="term">OID</strong>) that can be accessed as a column named <span class="bold"><code>OBJECT_ID</code></span>.</p>
<p>Each Oracle XML&nbsp;DB Repository resource has a property named <span class="bold"><code>ACLOID</code></span>. The <code>ACLOID</code> stores the OID of the ACL that protects the resource. An ACL is itself a resource, and the <code>XMLRef</code> property of an ACL, for example, <code>/sys/acls/all_all_acl.xml</code>, is a <code>REF</code> to the row in table <code>XDB$ACL</code> that contains the content of the ACL. These two properties form the link between table <code>XDB$RESOURCE</code>, which stores Oracle XML&nbsp;DB resources, and table <code>XDB$ACL</code>.</p>
<div class="infoboxnotealso" id="GUID-3B9D8F83-DA3E-4070-8D4C-AF12B212D806__GUID-69D635B6-4961-4383-BD00-6B2AE7ACA4A1">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="apphxdb.htm#GUID-8FCAD86A-3BF9-4B20-A9EE-8FC46C95C3CE" title="Full listings are provided here for the Oracle XML&nbsp;DB-supplied XML schemas, purchase-order XML schemas and an XSLT stylesheet used in various examples, and C-language (OCI) examples for loading XML content into Oracle XML&nbsp;DB and initializing and terminating an XML context.">Oracle-Supplied XML Schemas and Examples</a> for the ACL XML schema</p>
</li>
<li>
<p><a class="olink TDPSG20030" target="_blank" href="../TDPSG/GUID-3EC7A894-D620-4497-AFB1-64EB8C33D854.htm#TDPSG20030"><span class="italic">Oracle Database 2 Day + Security Guide</span></a> for information about database schema <code>XDB</code></p>
</li>
</ul>
</div>
</div>
<a id="ADXDB5480"></a>
<div class="props_rev_3"><a id="GUID-99334EEF-A97D-49DC-BA06-E7347ECCB681"></a>
<h3 id="ADXDB-GUID-99334EEF-A97D-49DC-BA06-E7347ECCB681" class="sect3"><span class="enumeration_section">27.4.1</span> System ACLs</h3>
<div>
<p>The system ACLs, which are predefined and supplied with Oracle Database, are described.</p>
<div class="section">
<p>Some ACLs are predefined and supplied with Oracle Database. They are referred to as <strong class="term">system ACLs</strong>.</p>
<p>There is only one ACL that is self-protected, that is, protected by its own contents. It is the <strong class="term">bootstrap ACL</strong>, a system ACL that is located in Oracle XML&nbsp;DB Repository at <code>/sys/acls/bootstrap_acl.xml</code>. The bootstrap ACL grants <code>READ</code> privilege to all users. It also grants <code>FULL ACCESS</code> to database roles <code>XDBADMIN</code> (the Oracle XML&nbsp;DB administrator) and <code>DBA</code>. Database role <code>XDBADMIN</code> is particularly useful for users who must register global XML schemas.</p>
<p>Other system ACLs include the following. Each is protected by the bootstrap ACL.</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold"><code>all_all_acl.xml</code></span> &ndash; Grants all privileges to all users.</p>
</li>
<li>
<p><span class="bold"><code>all_owner_acl.xml</code></span> &ndash; Grants all privileges to the owner of the resource.</p>
</li>
<li>
<p><span class="bold"><code>ro_all_acl.xml</code></span> &ndash; Grants read privileges to all users.</p>
</li>
</ul>
<p>System ACLs use the file-naming convention <span class="italic"><code>&lt;privilege&gt;</code></span><code>_</code><span class="italic"><code>&lt;users&gt;</code></span><code>_acl.xml</code>, where <span class="italic"><code>&lt;privilege&gt;</code></span> represents the privilege granted, and <span class="italic"><code>&lt;users&gt;</code></span> represents the users that are granted access to the resource. When you define your own ACLs, you can use any names you like.</p>
<div class="infoboxnotealso" id="GUID-99334EEF-A97D-49DC-BA06-E7347ECCB681__GUID-E3F02E55-A2A0-46B8-A2B4-CEE95CA47F90">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="xdb05sto.htm#GUID-5663C810-F20E-4CFE-99D5-96AC7D4081F4" title="An XML schema can be registered as local (visible only to its owner, by default) or global (visible to all database users, by default).">Local and Global XML Schemas</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADXDB2435"></a>
<div class="props_rev_3"><a id="GUID-3A94EEAA-A6ED-41EC-AE44-98D4D5FCF452"></a>
<h3 id="ADXDB-GUID-3A94EEAA-A6ED-41EC-AE44-98D4D5FCF452" class="sect3"><span class="enumeration_section">27.4.2</span> ACL and ACE Evaluation</h3>
<div>
<p>Privileges are checked before a principal is allowed to access a repository resource that is protected by ACLs. This check is done by evaluating the protecting ACLs for that principal, in order. For each such ACL, the ACEs in it that apply to the principal are examined, in order.</p>
<p>If one ACE grants a certain privilege to the current user and another ACE denies that privilege to the user, then a conflict arises. There are two possible ways to manage conflicts among ACEs for the same principal.</p>
<ul style="list-style-type: disc;">
<li>
<p>The default behavior, termed <span class="bold"><code>ace-order</code></span>, is to use only the <span class="italic">first</span> ACE that occurs for a given principal. Additional ACEs for that principal have no effect. In this case, <span class="italic">ACE order is relevant</span>.</p>
</li>
<li>
<p>You can, however, configure the database to use an alternate behavior, <span class="bold"><code>deny-trumps-grant</code></span>. In this case, any ACE with child <code>deny</code> for a given principal denies permission to that principal, whether or not there are other ACEs for that principal that have a <code>grant</code> child. In this case, <code>deny</code> always takes precedence over <code>grant</code>, and <span class="italic">ACE order is irrelevant</span>.</p>
</li>
</ul>
<p>You can configure ACL evaluation behavior by setting configuration parameter <span class="bold"><code>acl-evaluation-method</code></span>, in configuration file <code>xdbconfig.xml</code>, to either <code>ace-order</code> or <code>deny-trumps-grant</code>. The default configuration file specifies <code>ace-method</code>, but the default value for element <code>acl-evaluation-method</code>, used when no method is given, is <code>deny-trumps-grant</code>.</p>
<div class="infobox-note" id="GUID-3A94EEAA-A6ED-41EC-AE44-98D4D5FCF452__GUID-1FCE41FC-04BF-4F25-8997-677933E56555">
<p class="notep1">Note:</p>
<p>In releases prior to Oracle Database&nbsp;11g Release 1, only one ACL evaluation behavior was available: <code>deny-trumps-grant</code> (though it was not specified in the configuration file).</p>
<p>The change to use <code>ace-order</code> as the default behavior has important consequences for upgrading and downgrading between database versions. See <span class="q">&#34;<a href="appaman.htm#GUID-D89A2092-4BBF-4069-90FE-8E71C3EC3896" title="Various considerations apply to all upgrades of Oracle Database from a release prior to Oracle Database 12c Release 1 (12.1.0.1).">Upgrade or Downgrade of an Existing Oracle XML&nbsp;DB Installation</a>&#34;</span>.</p>
</div>
</div>
</div>
<a id="ADXDB5481"></a>
<div class="props_rev_3"><a id="GUID-37DD263E-D61A-42FA-933A-A78E07EA6004"></a>
<h3 id="ADXDB-GUID-37DD263E-D61A-42FA-933A-A78E07EA6004" class="sect3"><span class="enumeration_section">27.4.3</span> ACL Validation</h3>
<div>
<p>When an ACL is created, it is validated against the XML schema for ACLs, and some correctness tests are run, such as ensuring that start and end dates for ACEs are in chronological order. There is no complete check at ACL creation time of relations among ACLs.</p>
<p>Such a complete check of ACL correctness is called <strong class="term">ACL validity</strong> checking, but it is not to be confused with its XML <span class="italic">schema</span> validity. For an ACL to be valid (as an ACL), it must also be XML schema-valid, but the converse does not hold.</p>
<p>A full ACL validity check is made at run time, whenever an ACL is evaluated to check whether a principal has the proper privileges for some operation. If this check finds that the ACL is invalid, then all privileges that the ACL would grant are <span class="italic">denied</span> to the specified principals.</p>
</div>
</div>
<a id="ADXDB5486"></a><a id="ADXDB5485"></a>
<div class="props_rev_3"><a id="GUID-C7C3D320-22CB-4152-A891-9289A1FAEA0A"></a>
<h3 id="ADXDB-GUID-C7C3D320-22CB-4152-A891-9289A1FAEA0A" class="sect3"><span class="enumeration_section">27.4.4</span> Element invert: Complement the Principals in an ACE</h3>
<div>
<p>It is sometimes more convenient to define a set of principals by complementing another set of principals&thinsp;&mdash;&thinsp;that is the purpose of ACE element <code>invert</code>. Instead of listing each of the principals that you want to include, wrap the list of principals that you want to exclude with element <code>invert</code>.</p>
<div class="section">
<p>In <a href="xdb21sec.htm#GUID-C7C3D320-22CB-4152-A891-9289A1FAEA0A__CHDHIHCG">Example 27-3</a>, the first ACE denies privilege <code>privilege1</code> to all principals except <code>IntranetUsers</code>. Because (by default) ACEs are considered in the order they appear, all subsequent ACEs are overridden by the first ACE, so principal <code>NonIntraNetUser</code> is denied privilege <code>privilege1</code> in spite of the explicit grant.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-C7C3D320-22CB-4152-A891-9289A1FAEA0A__CHDHIHCG">
<p class="titleinexample">Example 27-3 Complementing a Set of Principals with Element invert</p>
<pre dir="ltr">&lt;acl description=&#34;invert ACL&#34; 
     xmlns=&#34;http://xmlns.oracle.com/xdb/acl.xsd&#34;
     xmlns:dav=&#34;DAV:&#34; 
     xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; 
     xsi:schemaLocation=&#34;http://xmlns.oracle.com/xdb/acl.xsd 
                         http://xmlns.oracle.com/xdb/acl.xsd&#34;&gt;
  &lt;extends-from type=&#34;simple&#34; href=&#34;/sys/acls/parent_acl.xml&#34;/&gt;
  &lt;ace&gt;
    &lt;grant&gt;<span class="bold">false</span>&lt;/grant&gt;
    &lt;<span class="bold">invert</span>&gt;&lt;principal&gt;dav:owner&lt;/principal&gt;&lt;/invert&gt;
    &lt;privilege&gt;&lt;read-contents/&gt;&lt;/privilege&gt;
  &lt;/ace&gt;
  &lt;ace&gt;
    &lt;grant&gt;true&lt;/grant&gt;
    &lt;principal&gt;GERONIMO&lt;/principal&gt;
    &lt;privilege&gt;&lt;read-contents/&gt;&lt;/privilege&gt;
  &lt;/ace&gt;
&lt;/acl&gt;
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<a id="ADXDB2420"></a>
<div class="props_rev_3"><a id="GUID-899B397A-45B6-4180-9DEF-EFF4A0C6170A"></a>
<h2 id="ADXDB-GUID-899B397A-45B6-4180-9DEF-EFF4A0C6170A" class="sect2"><span class="enumeration_section">27.5</span> Overview of Working with Access Control Lists (ACLs)</h2>
<div>
<p>Oracle Database access control lists (ACLs) are themselves (file) resources in Oracle XML&nbsp;DB Repository, so all of the access methods that operate on repository resources also apply to ACLs. In addition, there are several APIs specific to ACLs in PL/SQL package <code>DBMS_XDB_REPOS</code>.</p>
<p>Those ACL procedures and functions let you use PL/SQL to access Oracle XML&nbsp;DB security mechanisms, check user privileges based on a particular ACL, and list the set of privileges the current user has for a particular ACL and resource.</p>
<div class="infoboxnotealso" id="GUID-899B397A-45B6-4180-9DEF-EFF4A0C6170A__GUID-CA6E9836-EAB9-48A5-A942-17C993FD00DA">
<p class="notep1">See Also:</p>
<p><a href="appaman.htm#GUID-FD0BCF20-2345-4D78-B96F-C52A4361291D" title="Administration of Oracle XML&nbsp;DB includes installing, upgrading, and configuring it.">Administration of Oracle XML&nbsp;DB</a></p>
</div>
</div>
<a id="ADXDB5490"></a><a id="ADXDB5489"></a>
<div class="props_rev_3"><a id="GUID-DEC8D585-EDB6-4713-8218-5DE27268CDE6"></a>
<h3 id="ADXDB-GUID-DEC8D585-EDB6-4713-8218-5DE27268CDE6" class="sect3"><span class="enumeration_section">27.5.1</span> Creating an ACL Using DBMS_XDB_REPOS.CREATERESOURCE</h3>
<div>
<p>An example illustrates using <code>DBMS_XDB_REPOS.createResource</code> to create an ACL.</p>
<div class="section">
<p><a href="xdb21sec.htm#GUID-DEC8D585-EDB6-4713-8218-5DE27268CDE6__CEGCAIHC">Example 27-4</a> creates an ACL as file resource <code>/TESTUSER/acl1.xml</code>. If applied to a resource, this ACL grants all privileges to the owner of the resource.</p>
<div class="infobox-note" id="GUID-DEC8D585-EDB6-4713-8218-5DE27268CDE6__GUID-D74153C0-B6E9-4471-AE5F-0C28E3B09A23">
<p class="notep1">Note:</p>
<p>Before performing any operation that uses an ACL file resource that was created during the current transaction, you must perform a <code>COMMIT</code> operation. Until you do that, an ORA-22881 &#34;dangling REF&#34; error is raised whenever you use the ACL file.</p>
</div>
</div>
<!-- class="section" -->
<div class="example" id="GUID-DEC8D585-EDB6-4713-8218-5DE27268CDE6__CEGCAIHC">
<p class="titleinexample">Example 27-4 Creating an ACL Using CREATERESOURCE</p>
<pre dir="ltr">DECLARE
  b BOOLEAN;
BEGIN
  b := DBMS_XDB_REPOS.createFolder(&#39;/TESTUSER&#39;);
  b := DBMS_XDB_REPOS.createResource(
         &#39;<span class="bold">/TESTUSER/acl1.xml</span>&#39;, 
         &#39;&lt;acl description=&#34;myacl&#34;
               xmlns=&#34;http://xmlns.oracle.com/xdb/acl.xsd&#34;
               xmlns:dav=&#34;DAV:&#34;
               xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;
               xsi:schemaLocation=&#34;http://xmlns.oracle.com/xdb/acl.xsd
                                   http://xmlns.oracle.com/xdb/acl.xsd&#34;&gt;
            &lt;ace&gt;
              &lt;grant&gt;true&lt;/grant&gt;
              &lt;principal&gt;<span class="bold">dav:owner</span>&lt;/principal&gt;
              &lt;privilege&gt;
                <span class="bold">&lt;dav:all/&gt;</span>
              &lt;/privilege&gt;
            &lt;/ace&gt;
          &lt;/acl&gt;&#39;,
         &#39;http://xmlns.oracle.com/xdb/acl.xsd&#39;,
         &#39;acl&#39;);
END;
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ADXDB5491"></a><a id="ADXDB2425"></a>
<div class="props_rev_3"><a id="GUID-B9F9E132-3A63-4514-BA9A-2835F6B422E2"></a>
<h3 id="ADXDB-GUID-B9F9E132-3A63-4514-BA9A-2835F6B422E2" class="sect3"><span class="enumeration_section">27.5.2</span> Retrieving an ACL Document, Given its Repository Path</h3>
<div>
<p>An example shows how to retrieve an ACL document, given its location in Oracle XML&nbsp;DB Repository.</p>
<div class="section"></div>
<!-- class="section" -->
<div class="example" id="GUID-B9F9E132-3A63-4514-BA9A-2835F6B422E2__CHDCDIFA">
<p class="titleinexample">Example 27-5 Retrieving an ACL Document, Given its Repository Path</p>
<pre dir="ltr">SELECT a.OBJECT_VALUE FROM RESOURCE_VIEW rv, XDB.XDB$ACL a
  WHERE ref(a)
        = XMLCast(XMLQuery(&#39;declare default element namespace
                            &#34;http://xmlns.oracle.com/xdb/XDBResource.xsd&#34;; (: :)
                            fn:data(/Resource/XMLRef)&#39;
                           PASSING rv.RES RETURNING CONTENT)
                  AS REF XMLType)
    AND equals_path(rv.RES, &#39;<span class="bold">/TESTUSER/acl1.xml</span>&#39;) = 1;

OBJECT_VALUE
--------------------------------------------------------------------------------
&lt;acl description=&#34;myacl&#34; xmlns=&#34;http://xmlns.oracle.com/xdb/acl.xsd&#34; xmlns:dav=&#34;
DAV:&#34; xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; xsi:schemaLocation=&#34;
http://xmlns.oracle.com/xdb/acl.xsd                                    http://xm
lns.oracle.com/xdb/acl.xsd&#34; shared=&#34;true&#34;&gt;
  &lt;ace&gt;
    &lt;grant&gt;true&lt;/grant&gt;
    &lt;principal&gt;dav:owner&lt;/principal&gt;
    &lt;privilege&gt;
      &lt;dav:all/&gt;
    &lt;/privilege&gt;
  &lt;/ace&gt;
&lt;/acl&gt;
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ADXDB5493"></a><a id="ADXDB5492"></a>
<div class="props_rev_3"><a id="GUID-69858501-FCB3-4623-B79C-A2D2AAFA3B7A"></a>
<h3 id="ADXDB-GUID-69858501-FCB3-4623-B79C-A2D2AAFA3B7A" class="sect3"><span class="enumeration_section">27.5.3</span> Setting the ACL of a Resource</h3>
<div>
<p>An example uses PL/SQL procedure <code>DBMS_XDB_REPOS.setACL</code> to set the ACL of a resource.</p>
<div class="section">
<p><a href="xdb21sec.htm#GUID-69858501-FCB3-4623-B79C-A2D2AAFA3B7A__CEGCCFDD">Example 27-6</a> creates resource <code>/TESTUSER/po1.xml</code> and sets its ACL to <code>/TESTUSER/acl1.xml</code> using PL/SQL procedure <code>DBMS_XDB_REPOS.setACL</code>.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-69858501-FCB3-4623-B79C-A2D2AAFA3B7A__CEGCCFDD">
<p class="titleinexample">Example 27-6 Setting the ACL of a Resource</p>
<pre dir="ltr">DECLARE
  b BOOLEAN;
BEGIN
  b := DBMS_XDB_REPOS_REPOS.createResource(&#39;/TESTUSER/po1.xml&#39;, &#39;Hello&#39;);
END;
/
 
CALL DBMS_XDB_REPOS_REPOS.setACL(&#39;/TESTUSER/po1.xml&#39;, &#39;/TESTUSER/acl1.xml&#39;);
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ADXDB5495"></a><a id="ADXDB5494"></a>
<div class="props_rev_3"><a id="GUID-116946C5-88A3-4D88-BCA5-CD6CAAC32E39"></a>
<h3 id="ADXDB-GUID-116946C5-88A3-4D88-BCA5-CD6CAAC32E39" class="sect3"><span class="enumeration_section">27.5.4</span> Deleting an ACL</h3>
<div>
<p>An example uses PL/SQL procedure <code>DBMS_XDB_REPOS.deleteResource</code> to delete an ACL.</p>
<div class="section">
<p><a href="xdb21sec.htm#GUID-116946C5-88A3-4D88-BCA5-CD6CAAC32E39__CEGEGGBC">Example 27-7</a> deletes the ACL created in <a href="xdb21sec.htm#GUID-DEC8D585-EDB6-4713-8218-5DE27268CDE6__CEGCAIHC">Example 27-4</a>.</p>
<p>If a resource is being protected by an ACL that you want to delete, change the ACL of that resource before deleting the ACL.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-116946C5-88A3-4D88-BCA5-CD6CAAC32E39__CEGEGGBC">
<p class="titleinexample">Example 27-7 Deleting an ACL</p>
<pre dir="ltr">CALL DBMS_XDB_REPOS_REPOS.deleteResource(&#39;/TESTUSER/acl1.xml&#39;);
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ADXDB5497"></a><a id="ADXDB5498"></a><a id="ADXDB5499"></a><a id="ADXDB5496"></a>
<div class="props_rev_3"><a id="GUID-0AA30F48-9EFF-46C9-8C46-3B8717DB7198"></a>
<h3 id="ADXDB-GUID-0AA30F48-9EFF-46C9-8C46-3B8717DB7198" class="sect3"><span class="enumeration_section">27.5.5</span> Updating an ACL</h3>
<div>
<p>You can update an ACL using any of the standard ways of updating resources. In particular, since an ACL is an XML document, you can use Oracle SQL/XML function <code>XMLQuery</code> with XQuery Update to manipulate ACLs. You must <code>COMMIT</code> after making any ACL changes.</p>
<div class="section">
<p>Oracle XML&nbsp;DB ACLs are <span class="italic">cached</span>, for fast evaluation. When a transaction that updates an ACL is committed, the modified ACL is picked up by existing database sessions, after the timeout specified in the Oracle XML&nbsp;DB configuration file, <code>xdbconfig.xml</code>. The XPath location for this timeout parameter is <code>/xdbconfig/sysconfig/acl-max-age</code>. The value is expressed in seconds. Sessions initiated after the ACL is modified use the new ACL without any delay.</p>
<p>If an ACL resource is updated with non-ACL content, the same rules apply as for deletion. Thus, if any resource is being protected by an ACL that is being updated, you must first change the ACL.</p>
<div class="infoboxnotealso" id="GUID-0AA30F48-9EFF-46C9-8C46-3B8717DB7198__GUID-ED982B0A-6180-4D10-BE7A-C2BF78F2D3E8">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="xdb04cre.htm#GUID-6AE99020-C3C8-44EB-8E54-40188E1103F2" title="There are several ways you can use Oracle XML&nbsp;DB features to update XML data, whether it is transient or stored in database tables.">Updating XML Data</a>&#34;</span> for information about the Oracle SQL functions used here to update XML data</p>
</div>
<p>You can use FTP or WebDAV to update an ACL. For more details on how to use these protocols, see <a href="xdb22pro.htm#GUID-0476309D-E3DF-4C56-BF21-68CD04D00C98" title="You can access Oracle XML&nbsp;DB Repository data using protocols FTP and HTTP(S)/WebDAV.">Repository Access Using Protocols</a>. You can update an ACL or an access control entry (ACE) using <code>RESOURCE_VIEW</code>.</p>
<p><a href="xdb21sec.htm#GUID-0AA30F48-9EFF-46C9-8C46-3B8717DB7198__BCGFICIA">Example 27-8</a> uses SQL/XML function <code>XMLQuery</code> together with XQuery Update to update the ACL <code>/TESTUSER/acl1.xml</code> by replacing it entirely. The effect is to replace the principal value <code>DAV::owner</code> by <code>TESTUSER</code>, because the rest of the replacement ACL is the same as it was before.</p>
<p><a href="xdb21sec.htm#GUID-0AA30F48-9EFF-46C9-8C46-3B8717DB7198__BCGIGIDB">Example 27-9</a> uses XQuery Update to append an ACE to an existing ACL. The ACE gives privileges <code>read-properties</code> and <code>read-contents</code> to user <code>HR</code>.</p>
<p><a href="xdb21sec.htm#GUID-0AA30F48-9EFF-46C9-8C46-3B8717DB7198__BCGGBIJH">Example 27-10</a> uses Oracle SQL function <code>deleteXML</code> to delete an ACE from an ACL. The first ACE is deleted.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-0AA30F48-9EFF-46C9-8C46-3B8717DB7198__BCGFICIA">
<p class="titleinexample">Example 27-8 Updating (Replacing) an Access Control List</p>
<pre dir="ltr">UPDATE RESOURCE_VIEW r
 SET r.RES =
   XMLQuery(
     &#39;declare namespace r=&#34;http://xmlns.oracle.com/xdb/XDBResource.xsd&#34;; (: :)
      declare namespace a=&#34;http://xmlns.oracle.com/xdb/acl.xsd&#34;; (: :)
      copy $i := $p1 modify
        (for $j in $i/r:Resource/r:Contents/a:acl
         return replace node $j with $p2)
      return $i&#39;
     PASSING r.RES AS &#34;p1&#34;,
             &#39;&lt;acl description=&#34;myacl&#34;
                   xmlns=&#34;http://xmlns.oracle.com/xdb/acl.xsd&#34;
                   xmlns:dav=&#34;DAV:&#34;
                   xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;
                   xsi:schemaLocation=&#34;http://xmlns.oracle.com/xdb/acl.xsd
                                       http://xmlns.oracle.com/xdb/acl.xsd&#34;&gt;
                &lt;ace&gt;
                  &lt;grant&gt;true&lt;/grant&gt;
                  &lt;principal&gt;<span class="bold">TESTUSER</span>&lt;/principal&gt;
                  &lt;privilege&gt;&lt;dav:all/&gt;&lt;/privilege&gt;
                &lt;/ace&gt;
              &lt;/acl&gt;&#39; AS &#34;p2&#34;
     RETURNING CONTENT)
  WHERE equals_path(r.RES, &#39;/TESTUSER/acl1.xml&#39;) = 1;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-0AA30F48-9EFF-46C9-8C46-3B8717DB7198__BCGIGIDB">
<p class="titleinexample">Example 27-9 Appending ACEs to an Access Control List</p>
<pre dir="ltr">UPDATE RESOURCE_VIEW r
  SET r.RES =
    XMLQuery(&#39;declare namespace r=&#34;http://xmlns.oracle.com/xdb/XDBResource.xsd&#34;; (: :)
              declare namespace a=&#34;http://xmlns.oracle.com/xdb/acl.xsd&#34;; (: :)
              copy $i := $p1 modify
                (for $j in $i/r:Resource/r:Contents/a:acl
                 return insert nodes $p2 as last into $j)
              return $i&#39;
             PASSING r.RES AS &#34;p1&#34;,
                     XMLType(&#39;&lt;ace xmlns=&#34;http://xmlns.oracle.com/xdb/acl.xsd&#34;&gt;
                                 &lt;grant&gt;true&lt;/grant&gt;
                                 &lt;principal&gt;<span class="bold">HR</span>&lt;/principal&gt;
                                 &lt;privilege&gt;
                                   <span class="bold">&lt;read-properties/&gt;</span>
                                   <span class="bold">&lt;read-contents/&gt;</span>
                                 &lt;/privilege&gt;
                              &lt;/ace&gt;&#39;) as &#34;p2&#34;
             RETURNING CONTENT)
  WHERE equals_path(r.RES, &#39;/TESTUSER/acl1.xml&#39;) = 1;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-0AA30F48-9EFF-46C9-8C46-3B8717DB7198__BCGGBIJH">
<p class="titleinexample">Example 27-10 Deleting an ACE from an Access Control List</p>
<pre dir="ltr">UPDATE RESOURCE_VIEW r
  SET r.RES =
    XMLQuery(&#39;declare namespace r=&#34;http://xmlns.oracle.com/xdb/XDBResource.xsd&#34;; (: :)
              declare namespace a=&#34;http://xmlns.oracle.com/xdb/acl.xsd&#34;; (: :)
              copy $i := $p modify delete nodes $i/r:Resource/r:Contents/a:acl/a:ace[1]
              return $i&#39;
             PASSING r.RES AS &#34;p&#34; RETURNING CONTENT)
  WHERE equals_path(r.RES, &#39;/TESTUSER/acl1.xml&#39;) = 1;
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ADXDB5501"></a><a id="ADXDB5500"></a>
<div class="props_rev_3"><a id="GUID-4C24957E-DA31-42EA-B5EC-9159C9E892F9"></a>
<h3 id="ADXDB-GUID-4C24957E-DA31-42EA-B5EC-9159C9E892F9" class="sect3"><span class="enumeration_section">27.5.6</span> Retrieving the ACL Document that Protects a Given Resource</h3>
<div>
<p>An example illustrates how to use PL/SQL function <code>DBMS_XDB_REPOS.getACLDocument</code> to retrieve the ACL document that protects a given resource.</p>
<div class="section">
<div class="infoboxnotealso" id="GUID-4C24957E-DA31-42EA-B5EC-9159C9E892F9__GUID-4DC4995D-D731-4159-99C5-45DDD5605051">
<p class="notep1">See Also:</p>
<p><a href="xdb19rpl.htm#GUID-9560B205-943B-4159-9734-44B9B74F2ACE__i1028509">Example 26-2</a></p>
</div>
</div>
<!-- class="section" -->
<div class="example" id="GUID-4C24957E-DA31-42EA-B5EC-9159C9E892F9__GUID-DB37D970-1493-4391-B969-51EF2C07AC07">
<p class="titleinexample">Example 27-11 Retrieving the ACL Document for a Resource</p>
<pre dir="ltr">SELECT XMLSerialize(DOCUMENT DBMS_XDB_REPOS.getACLDocument(&#39;<span class="bold">/TESTUSER/po1.xml</span>&#39;)
                    AS CLOB)
  FROM DUAL;
 
XMLSERIALIZE(DOCUMENTDBMS_XDB_REPOS.GETACLDOCUMENT(&#39;/TESTUSER/PO1.XML&#39;)ASCLOB)
--------------------------------------------------------------------------------
&lt;acl description=&#34;myacl&#34; xmlns=&#34;http://xmlns.oracle.com/xdb/acl.xsd&#34; xmlns:dav=&#34;
DAV:&#34; xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; xsi:schemaLocation=&#34;
http://xmlns.oracle.com/xdb/acl.xsd                                     http://x
mlns.oracle.com/xdb/acl.xsd&#34;&gt;
  &lt;ace&gt;
    &lt;grant&gt;true&lt;/grant&gt;
    &lt;principal&gt;TESTUSER&lt;/principal&gt;
    &lt;privilege&gt;
      &lt;dav:all/&gt;
    &lt;/privilege&gt;
  &lt;/ace&gt;
  &lt;ace xmlns=&#34;http://xmlns.oracle.com/xdb/acl.xsd&#34;&gt;
    &lt;grant&gt;true&lt;/grant&gt;
    &lt;principal&gt;HR&lt;/principal&gt;
    &lt;privilege&gt;
      &lt;read-properties/&gt;
      &lt;read-contents/&gt;
    &lt;/privilege&gt;
  &lt;/ace&gt;
&lt;/acl&gt;
 
1 row selected.
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ADXDB5503"></a><a id="ADXDB5502"></a>
<div class="props_rev_3"><a id="GUID-49A1AE46-87C9-40FA-ACBB-7D70B0A91D13"></a>
<h3 id="ADXDB-GUID-49A1AE46-87C9-40FA-ACBB-7D70B0A91D13" class="sect3"><span class="enumeration_section">27.5.7</span> Retrieving Privileges Granted to the Current User for a Particular Resource</h3>
<div>
<p>An example illustrates how to use PL/SQL function <code>DBMS_XDB_REPOS.getPrivileges</code> to retrieve privileges granted to the current user.</p>
<div class="section"></div>
<!-- class="section" -->
<div class="example" id="GUID-49A1AE46-87C9-40FA-ACBB-7D70B0A91D13__BABDDAHF">
<p class="titleinexample">Example 27-12 Retrieving Privileges Granted to the Current User for a Particular Resource</p>
<pre dir="ltr">SELECT XMLSerialize(DOCUMENT DBMS_XDB_REPOS.getPrivileges(&#39;/TESTUSER/po1.xml&#39;)
                    AS CLOB)
  FROM DUAL;
 
XMLSERIALIZE(DOCUMENTDBMS_XDB_REPOS.GETPRIVILEGES(&#39;/TESTUSER/PO1.XML&#39;)ASCLOB)
--------------------------------------------------------------------------------
&lt;privilege xmlns=&#34;http://xmlns.oracle.com/xdb/acl.xsd&#34; xmlns:xsi=&#34;http://www.w3.
org/2001/XMLSchema-instance&#34; xsi:schemaLocation=&#34;http://xmlns.oracle.com/xdb/acl
.xsd http://xmlns.oracle.com/xdb/acl.xsd DAV: http://xmlns.oracle.com/xdb/dav.xs
d&#34; xmlns:xdbacl=&#34;http://xmlns.oracle.com/xdb/acl.xsd&#34; xmlns:dav=&#34;DAV:&#34;&gt;
  &lt;read-acl/&gt;
  &lt;dav:execute/&gt;
  &lt;read-contents/&gt;
  &lt;update-acl/&gt;
  &lt;dav:write-content/&gt;
  &lt;dav:read-current-user-privilege-set/&gt;
  &lt;link-to/&gt;
  &lt;resolve/&gt;
  &lt;dav:lock/&gt;
  &lt;unlink-from/&gt;
  &lt;write-config/&gt;
  &lt;dav:write-properties/&gt;
  &lt;dav:unlock/&gt;
  &lt;link/&gt;
  &lt;write-acl-ref/&gt;
  &lt;read-properties/&gt;
  &lt;dav:take-ownership/&gt;
  &lt;unlink/&gt;
&lt;/privilege&gt;

1 row selected.
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ADXDB5505"></a><a id="ADXDB5504"></a>
<div class="props_rev_3"><a id="GUID-FC2A630F-A65E-4814-8A9F-36D39EE4D744"></a>
<h3 id="ADXDB-GUID-FC2A630F-A65E-4814-8A9F-36D39EE4D744" class="sect3"><span class="enumeration_section">27.5.8</span> Checking Whether the Current User Has Privileges on a Resource</h3>
<div>
<p>An example illustrates how to use PL/SQL function <code>DBMS_XDB_REPOS.checkPrivileges</code> to check whether the current user has a given set of privileges on a resource. The function returns a nonzero value if the user has the privileges.</p>
<div class="section">
<p><a href="xdb21sec.htm#GUID-FC2A630F-A65E-4814-8A9F-36D39EE4D744__CEGBGBFB">Example 27-13</a> checks to see if the access privileges <code>read-contents</code> and <code>read-properties</code> have been granted to the current user on resource <code>/TESTUSER/po1.xml</code>. The positive-integer return value shows that they have.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-FC2A630F-A65E-4814-8A9F-36D39EE4D744__CEGBGBFB">
<p class="titleinexample">Example 27-13 Checking If a User Has a Certain Privileges on a Resource</p>
<pre dir="ltr">SELECT DBMS_XDB_REPOS.checkPrivileges(
</pre>
<pre dir="ltr">         &#39;<span class="bold">/TESTUSER/po1.xml</span>&#39;,
         XMLType(&#39;&lt;privilege
                      xmlns=&#34;http://xmlns.oracle.com/xdb/acl.xsd&#34;
                      xmlns:dav=&#34;DAV:&#34;
                      xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;
                      xsi:schemaLocation=&#34;http://xmlns.oracle.com/xdb/acl.xsd
                                          http://xmlns.oracle.com/xdb/acl.xsd&#34;&gt;
                    <span class="bold">&lt;read-contents/&gt;</span>
                    <span class="bold">&lt;read-properties/&gt;</span>
                  &lt;/privilege&gt;&#39;))
  FROM DUAL;
 
DBMS_XDB_REPOS.CHECKPRIVILEGES(&#39;/TESTUSER/PO1.XML&#39;,
---------------------------------------------------
                                                  <span class="bold">1</span>
 
1 row selected.
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ADXDB5507"></a><a id="ADXDB5506"></a>
<div class="props_rev_3"><a id="GUID-C6CB85B8-935D-436B-906B-F1ED3598B421"></a>
<h3 id="ADXDB-GUID-C6CB85B8-935D-436B-906B-F1ED3598B421" class="sect3"><span class="enumeration_section">27.5.9</span> Checking Whether a User Has Privileges Using the ACL and Resource Owner</h3>
<div>
<p>Function <code>DBMS_XDB_REPOS.ACLCheckPrivileges</code> is typically used by applications that must perform ACL evaluation on their own, before allowing a user to perform an operation.</p>
<div class="section">
<p><a href="xdb21sec.htm#GUID-C6CB85B8-935D-436B-906B-F1ED3598B421__BCGIACEI">Example 27-14</a> checks whether the ACL <code>/TESTUSER/acl1.xml</code> grants the privileges <code>read-contents</code> and <code>read-properties</code> to the current user, <code>sh</code>. The second argument, <code>TESTUSER</code>, is the user that is substituted for <code>DAV::owner</code> in the ACL when checking. Since user <code>sh</code> does <span class="italic">not</span> match any of the users granted the specified privileges, the return value is zero.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-C6CB85B8-935D-436B-906B-F1ED3598B421__BCGIACEI">
<p class="titleinexample">Example 27-14 Checking User Privileges Using ACLCheckPrivileges</p>
<pre dir="ltr">CONNECT <span class="bold">sh</span>
Enter password: <span class="italic">&lt;password&gt;</span>

Connected.

SELECT DBMS_XDB_REPOS.ACLCheckPrivileges(
         &#39;<span class="bold">/TESTUSER/acl1.xml</span>&#39;,
         &#39;<span class="bold">TESTUSER</span>&#39;,
         XMLType(&#39;&lt;privilege
                      xmlns=&#34;http://xmlns.oracle.com/xdb/acl.xsd&#34;
                      xmlns:dav=&#34;DAV:&#34;
                      xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;
                      xsi:schemaLocation=&#34;http://xmlns.oracle.com/xdb/acl.xsd
                                          http://xmlns.oracle.com/xdb/acl.xsd&#34;&gt;
                    <span class="bold">&lt;read-contents/&gt;</span>
                    <span class="bold">&lt;read-properties/&gt;</span>
                  &lt;/privilege&gt;&#39;))
  FROM DUAL;
 
DBMS_XDB_REPOS.ACLCHECKPRIVILEGES(&#39;/TESTUSER/ACL1.XML&#39;,&#39;TESTUSER&#39;,
------------------------------------------------------------------
                                                                 <span class="bold">0</span>
 
1 row selected.
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ADXDB5509"></a><a id="ADXDB5508"></a>
<div class="props_rev_3"><a id="GUID-14D106C4-04A4-42DA-9168-7937B0DC0976"></a>
<h3 id="ADXDB-GUID-14D106C4-04A4-42DA-9168-7937B0DC0976" class="sect3"><span class="enumeration_section">27.5.10</span> Retrieving the Path of the ACL that Protects a Given Resource</h3>
<div>
<p>An example uses a <code>RESOURCE_VIEW</code> query to retrieve the path of the ACL that protects a given resource. The query uses the fact that the <code>XMLRef</code> and <code>ACLOID</code> elements of a resource form the link between an ACL and a resource.</p>
<div class="section">
<p><a href="xdb21sec.htm#GUID-14D106C4-04A4-42DA-9168-7937B0DC0976__CEGJJGII">Example 27-15</a> retrieves the path to an ACL, given a resource protected by the ACL. The <code>ACLOID</code> of a protected resource (<code>r</code>) stores the OID of the ACL resource (<code>a</code>) that protects it. The <code>REF</code> of the ACL resource is the same as that of the object identified by the protected-resource <code>ACLOID</code>.</p>
<p>The <code>REF</code> of the resource <code>ACLOID</code> can be obtained using Oracle SQL function <code>make_ref</code>, which returns a <code>REF</code> to an object-table row with a given OID.</p>
<p>In <a href="xdb21sec.htm#GUID-14D106C4-04A4-42DA-9168-7937B0DC0976__CEGJJGII">Example 27-15</a>, <code>make_ref</code> returns a <code>REF</code> to the row of table <code>XDB$ACL</code> whose OID is the <code>/Resource/ACLOID</code> for the resource <code>/TESTUSER/po1.xml</code>. The inner query returns the <code>ACLOID</code> of the resource. The outer query returns the path to the corresponding ACL.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-14D106C4-04A4-42DA-9168-7937B0DC0976__CEGJJGII">
<p class="titleinexample">Example 27-15 Retrieving the Path of the ACL that Protects a Given Resource</p>
<pre dir="ltr">SELECT rv1.ANY_PATH
  FROM RESOURCE_VIEW rv1
  WHERE
    XMLCast(XMLQuery(&#39;declare default element namespace
                      &#34;http://xmlns.oracle.com/xdb/XDBResource.xsd&#34;; (: :)
                      fn:data(/Resource/XMLRef)&#39;
                     PASSING rv1.RES RETURNING CONTENT)
            AS REF XMLType)
    = make_ref(XDB.XDB$ACL,
               (SELECT XMLCast(XMLQuery(&#39;declare default element namespace
                                         &#34;http://xmlns.oracle.com/xdb/XDBResource.xsd&#34;; (: :)
                                         fn:data(/Resource/ACLOID)&#39;
                                        PASSING rv2.RES RETURNING CONTENT)
                               AS REF XMLType)
                  FROM RESOURCE_VIEW rv2
                  WHERE equals_path(rv2.RES, &#39;/TESTUSER/po1.xml&#39;) = 1));

ANY_PATH
------------------
/TESTUSER/acl1.xml
</pre></div>
<!-- class="example" --></div>
</div>
<a id="ADXDB5511"></a><a id="ADXDB5510"></a>
<div class="props_rev_3"><a id="GUID-4C8DD9FF-D656-400E-883C-9F0E42CE55A4"></a>
<h3 id="ADXDB-GUID-4C8DD9FF-D656-400E-883C-9F0E42CE55A4" class="sect3"><span class="enumeration_section">27.5.11</span> Retrieving the Paths of All Resources Protected by a Given ACL</h3>
<div>
<p>An example retrieves the paths of all resources protected by a given ACL.</p>
<div class="section">
<p><a href="xdb21sec.htm#GUID-4C8DD9FF-D656-400E-883C-9F0E42CE55A4__CEGFHAFJ">Example 27-16</a> retrieves the paths to the resources whose <code>ACLOID</code> <code>REF</code> matches the <code>REF</code> of the ACL resource whose path is <code>/TESTUSER/acl1.xml</code>. Function <code>make_ref</code> returns the resource <code>ACLOID</code> <code>REF</code>.</p>
<p>The inner query retrieves the <code>REF</code> of the specified ACL. The outer query selects the paths of the resources whose <code>ACLOID</code> <code>REF</code> matches the <code>REF</code> of the specified ACL.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-4C8DD9FF-D656-400E-883C-9F0E42CE55A4__CEGFHAFJ">
<p class="titleinexample">Example 27-16 Retrieving the Paths of All Resources Protected by a Given ACL</p>
<pre dir="ltr">SELECT rv1.ANY_PATH
  FROM RESOURCE_VIEW rv1
  WHERE make_ref(XDB.XDB$ACL, 
                 XMLCast(XMLQuery(&#39;declare default element namespace
                                   &#34;http://xmlns.oracle.com/xdb/XDBResource.xsd&#34;; (: :)
                                   fn:data(/Resource/ACLOID)&#39;
                                  PASSING rv1.RES RETURNING CONTENT)
                         AS REF XMLType))
        = (SELECT XMLCast(XMLQuery(&#39;declare default element namespace
                                    &#34;http://xmlns.oracle.com/xdb/XDBResource.xsd&#34;; (: :)
                                    fn:data(/Resource/XMLRef)&#39;
                                   PASSING rv2.RES RETURNING CONTENT)
                          AS REF XMLType)
             FROM RESOURCE_VIEW rv2
             WHERE equals_path(rv2.RES, &#39;/TESTUSER/acl1.xml&#39;) = 1);

ANY_PATH
-----------------
/TESTUSER/po1.xml
 
1 row selected.
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<a id="ADXDB5516"></a>
<div class="props_rev_3"><a id="GUID-A7903BE5-C081-40A9-B778-99289AB08E84"></a>
<h2 id="ADXDB-GUID-A7903BE5-C081-40A9-B778-99289AB08E84" class="sect2"><span class="enumeration_section">27.6</span> ACL Caching</h2>
<div>
<p>Since ACLs are checked for each access to the data they protect, the performance of the ACL check operation is critical to the performance of such data, including Oracle XML&nbsp;DB Repository resources. In Oracle XML&nbsp;DB, the required performance for this repository operation is achieved by employing several caches.</p>
<p>ACLs are saved in a cache that is shared by all sessions in the database instance. When an ACL is updated, its entry in the cache is invalidated, together with all objects dependent on it. The next time the ACL is used, a new copy of it is brought into the cache. Oracle recommends that you share ACLs among resources as much as possible.</p>
<p>There is a session-specific cache of privileges granted to a given user by a given ACL. The entries in this cache have a time out (in seconds) specified by the element <code>&lt;acl-max-age&gt;</code> in the Oracle XML&nbsp;DB configuration file (<code>xdbconfig.xml</code>). For maximum performance, set this timeout as large as possible. But note that there is a trade-off here: the greater the timeout, the longer it takes for current sessions to pick up an updated ACL.</p>
<p>Oracle XML&nbsp;DB also maintains caches to improve performance when using ACLs that have LDAP principals (LDAP groups or users). The goal of these caches is to minimize network communication with the LDAP server. One is a shared cache that maps LDAP GUIDs to the corresponding LDAP nicknames and Distinguished Names (DNs). This is used when an ACL document is being displayed (or converted to <code>CLOB</code> or <code>VARCHAR</code>2 values from an <code>XMLType</code> instance). To purge this cache, use procedure <code>DBMS_XDBZ.purgeLDAPCache</code>. The other cache is session-specific and maps LDAP groups to their members (nested membership). Note that whenever Oracle XML&nbsp;DB encounters an LDAP group for the first time (in a session) it gets the nested membership of that group from the LDAP server. Hence it is best to use groups with as few members and levels of nesting as possible.</p>
</div>
</div>
<a id="ADXDB5517"></a>
<div class="props_rev_3"><a id="GUID-604D4E88-5309-4903-8224-B9DB850E4566"></a>
<h2 id="ADXDB-GUID-604D4E88-5309-4903-8224-B9DB850E4566" class="sect2"><span class="enumeration_section">27.7</span> Repository Resources and Database Table Security</h2>
<div>
<p>A uniform security mechanism for accessing <code>REF</code>-based repository resources is provided by enabling hierarchy on the tables used to store them. When ACL-based security is not needed for particular resources, you can optimize their access by using PL/SQL procedure <code>DBMS_XDBZ.disable_hierarchy</code> to turn off ACL checking.</p>
<p>Resources in Oracle XML&nbsp;DB Repository are of two types:</p>
<ul style="list-style-type: disc;">
<li>
<p>LOB-based (the content is stored in a LOB which is part of the resource). Access is determined only by the ACL that protects the resource.</p>
</li>
<li>
<p><code>REF</code>-based (the content is XML data and is stored in a database table). Users must have the appropriate privilege for the underlying table or view where the XML content is stored in addition to ACL permissions for the resource.</p>
</li>
</ul>
<p>Since the content of a <code>REF</code>-based resource can be stored in a table, it is possible to access this data directly using SQL queries on the table. A <strong class="term">uniform</strong> access control mechanism is one where the privileges needed for access are independent of the method of access (for example, FTP, HTTP, or SQL). To provide a uniform security mechanism using ACLs, the underlying table must first be <strong class="term">hierarchy-enabled</strong>, before resources that reference the rows in the table are inserted into Oracle XML&nbsp;DB.</p>
<p>The default tables produced by XML schema registration are hierarchy-enabled. Enabling hierarchy is the default behavior when you register an XML schema with Oracle XML&nbsp;DB. You can also enable hierarchy after registration, using procedure <code>DBMS_XDBZ.enable_hierarchy</code>.</p>
<p>Enabling hierarchy on a resource table does the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>Adds two hidden columns to store the <code>ACLOID</code> and the <code>OWNER</code> of the resources that reference the rows in the table.</p>
</li>
<li>
<p>Adds a row-level security (RLS) policy to the table, which checks the ACL whenever a <code>SELECT</code>, <code>UPDATE</code>, or <code>DELETE</code> operation is executed on the table.</p>
</li>
<li>
<p>Creates a database trigger, called the <strong class="term">path-index trigger</strong>, that ensures that the last-modified information for a resource is updated whenever the corresponding row is updated in the <code>XMLType</code> table where the content is stored.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-604D4E88-5309-4903-8224-B9DB850E4566__GUID-B11333D8-6947-43B3-9393-605F391CA549">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink ARPLS377" target="_blank" href="../ARPLS/d_xmlsch.htm#ARPLS377"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about procedure <code>DBMS_XMLSCHEMA.registerSchema</code></p>
</li>
<li>
<p><a class="olink ARPLS805" target="_blank" href="../ARPLS/d_xdbz.htm#ARPLS805"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about procedure <code>DBMS_XDBZ.enable_hierarchy</code></p>
</li>
</ul>
</div>
<p>In any given table, it is possible that only some of the objects are mapped to Oracle XML&nbsp;DB resources. Only those objects that are mapped undergo ACL checking, but <span class="italic">all</span> of the objects have table-level security.</p>
<div class="infobox-note" id="GUID-604D4E88-5309-4903-8224-B9DB850E4566__GUID-5EE69CD2-E37E-49EC-883B-1CB4FB32EAE7">
<p class="notep1">Note:</p>
<p>You cannot hide data in <code>XMLType</code> tables from other users if <span class="italic">out-of-line</span> storage of is used. Out-of-line data is <span class="italic">not</span> protected by ACL security.</p>
</div>
</div>
<a id="ADXDB5928"></a>
<div class="props_rev_3"><a id="GUID-F5935ADF-4BE3-402C-8CB7-742FF7781EC7"></a>
<h3 id="ADXDB-GUID-F5935ADF-4BE3-402C-8CB7-742FF7781EC7" class="sect3"><span class="enumeration_section">27.7.1</span> Optimization: Do not enforce ACL-based security if you do not need it</h3>
<div>
<p>ACL-based security provides control of access to XML content document-by-document, rather than just table-by-table. When you call PL/SQL procedure <code>DBMS_XMLSCHEMA.register_chema</code>, the tables it creates have ACL-based security enabled, by default.</p>
<p>One effect of this is that when the XML content of such a table is accessed using a SQL statement, a call to <code>sys_checkACL</code> is automatically added to the query <code>WHERE</code> clause, to ensure that the ACL security that was defined is enforced at the SQL level.</p>
<p>Enforcing ACL-based security adds overhead to the SQL query, however. If ACL-based security is <span class="italic">not</span> required, then use procedure <code>DBMS_XDBZ.disable_hierarchy</code> to turn <span class="italic">off</span> ACL checking.</p>
<p>When ACL-based security is enabled for an <code>XMLType</code> table, the execution plan output for a query of that table contains a filter similar to the following:</p>
<pre dir="ltr">3 - filter(<span class="bold">SYS_CHECKACL</span>(&#34;ACLOID&#34;,&#34;OWNERID&#34;,xmltype(&#39;&#39;&lt;privilege
              xmlns=&#34;http://xmlns.oracle.com/xdb/acl.xsd&#34;
              xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;
              xsi:schemaLocation=&#34;http://xmlns.oracle.com/xdb/acl.xsd
              http://xmlns.oracle.com/xdb/acl.xsd
              DAV:http://xmlns.oracle.com/xdb/dav.xsd&#34;&gt;
                        <span class="bold">&lt;read-properties/&gt;&lt;read-contents/&gt;</span>&lt;/privilege&gt;&#39;&#39;))=1)
</pre>
<p>In this example, the filter checks that the user performing the SQL query has <code>read-contents</code> privilege on each of the documents to be accessed.</p>
<p>After calling <code>DBMS_XDBZ.disable_hierarchy</code>, an execution plan of the same query does not show <code>SYS_CHECKACL</code> in the filter.</p>
<div class="infoboxnotealso" id="GUID-F5935ADF-4BE3-402C-8CB7-742FF7781EC7__GUID-E0E253BD-F766-48DC-90F5-A1A3167FED7C">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS805" target="_blank" href="../ARPLS/d_xdbz.htm#ARPLS805"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about procedure <code>DBMS_XDBZ.disable_hierarchy</code></p>
</div>
</div>
</div>
</div>
<a id="ADXDB5518"></a><a id="ADXDB5519"></a><a id="ADXDB2470"></a>
<div class="props_rev_3"><a id="GUID-3E0217D9-1A93-49E8-AF39-04DD770C225D"></a>
<h2 id="ADXDB-GUID-3E0217D9-1A93-49E8-AF39-04DD770C225D" class="sect2"><span class="enumeration_section">27.8</span> Integration Of Oracle XML&nbsp;DB with LDAP</h2>
<div>
<p>You can allow Lightweight Directory Access Protocol (LDAP) users to use the features of Oracle XML&nbsp;DB, including ACLs.</p>
<p>The typical scenario is a single, shared database schema (user), to which multiple LDAP users are mapped. This mapping is maintained in the Oracle Internet Directory. End users can log into the database using their LDAP user name and password. They are then automatically mapped to the corresponding shared database schema. (Users can log in using SQL or any of the supported Oracle XML&nbsp;DB protocols.) The implicit ACL resolution is based on the current LDAP user and the corresponding LDAP group membership information.</p>
<p>Before you can use LDAP users and groups (also known as LDAP roles) as principals in Oracle XML&nbsp;DB ACLs, the following prerequisites must be satisfied:</p>
<ul style="list-style-type: disc;">
<li>
<p>An Oracle Internet Directory must be set up, and the database must be registered with it.</p>
</li>
<li>
<p>SSL authentication must be set up between the database and the Oracle Internet Directory.</p>
</li>
<li>
<p>A database user must be created that corresponds to the shared database schema.</p>
</li>
<li>
<p>The LDAP users must be created and mapped in the Oracle Internet Directory to the shared database schema.</p>
</li>
<li>
<p>The LDAP groups must be created and their members must be specified.</p>
</li>
<li>
<p>ACLs must be defined for the LDAP groups and users, and they must be used to protect the repository resources to be accessed by the LDAP users.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-3E0217D9-1A93-49E8-AF39-04DD770C225D__GUID-205B2677-E7E7-459A-845A-8A0CA5C4F09D">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink OIDAG" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=OIDAG"><span class="italic">Oracle Fusion Middleware Administrator&#39;s Guide for Oracle Internet Directory</span></a></p>
</li>
<li>
<p><a class="olink DBSEG070" target="_blank" href="../DBSEG/asossl.htm#DBSEG070"><span class="italic">Oracle Database Security Guide</span></a> for information about setting up SSL authentication</p>
</li>
<li>
<p><a class="olink DBIMI151" target="_blank" href="../DBIMI/concepts.htm#DBIMI151"><span class="italic">Oracle Database Enterprise User Security Administrator&#39;s Guide</span></a> for information about using shared database schemas for enterprise (LDAP) users</p>
</li>
</ul>
</div>
<p><a href="xdb21sec.htm#GUID-3E0217D9-1A93-49E8-AF39-04DD770C225D__BCGJADII">Example 27-17</a> shows an ACL for an LDAP user. Element <code>&lt;principal&gt;</code> contains the full <span class="italic">distinguished name</span> of the LDAP user &ndash; in this case, <code>cn=user1,ou=Americas,o=oracle,l=redwoodshores,st=CA,c=US</code>.</p>
<div class="infoboxnotealso" id="GUID-3E0217D9-1A93-49E8-AF39-04DD770C225D__GUID-2B8B03D2-CF5D-40CC-9308-54686295B47F">
<p class="notep1">See Also:</p>
<p><span class="italic">Oracle Fusion Middleware Administrator&#39;s Guide for Oracle Internet Directory</span> for the format of an LDAP user distinguished name</p>
</div>
<p><a href="xdb21sec.htm#GUID-3E0217D9-1A93-49E8-AF39-04DD770C225D__BCGGJAGE">Example 27-18</a> shows an ACL for an LDAP group. Element <code>&lt;principal&gt;</code> contains the full distinguished name of the LDAP group.</p>
<div class="infoboxnotealso" id="GUID-3E0217D9-1A93-49E8-AF39-04DD770C225D__GUID-2097B04A-D0E4-4D31-A56D-243947AB4E0D">
<p class="notep1">See Also:</p>
<p><span class="italic">Oracle Fusion Middleware Administrator&#39;s Guide for Oracle Internet Directory</span> for the format of an LDAP group distinguished name</p>
</div>
<div class="example" id="GUID-3E0217D9-1A93-49E8-AF39-04DD770C225D__BCGJADII">
<p class="titleinexample">Example 27-17 ACL Referencing an LDAP User</p>
<pre dir="ltr">&lt;acl description=&#34;/public/txmlacl1/acl1.xml&#34;
     xmlns=&#34;http://xmlns.oracle.com/xdb/acl.xsd&#34; xmlns:dav=&#34;DAV:&#34;
     xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; 
     xsi:schemaLocation=&#34;http://xmlns.oracle.com/xdb/acl.xsd 
                         http://xmlns.oracle.com/xdb/acl.xsd&#34;&gt;
  &lt;ace principalFormat=&#34;DistinguishedName&#34;&gt; 
    &lt;grant&gt;true&lt;/grant&gt;
    &lt;principal&gt;<span class="bold">cn=user1,ou=Americas,o=oracle,l=redwoodshores,st=CA,c=US</span>
    &lt;/principal&gt;
    &lt;privilege&gt;
      &lt;dav:all/&gt;
    &lt;/privilege&gt;
  &lt;/ace&gt; 
&lt;/acl&gt;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-3E0217D9-1A93-49E8-AF39-04DD770C225D__BCGGJAGE">
<p class="titleinexample">Example 27-18 ACL Referencing an LDAP Group</p>
<pre dir="ltr">&lt;acl xmlns=&#34;http://xmlns.oracle.com/xdb/acl.xsd&#34; xmlns:dav=&#34;DAV:&#34;
     xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; 
     xsi:schemaLocation=&#34;http://xmlns.oracle.com/xdb/acl.xsd 
                         http://xmlns.oracle.com/xdb/acl.xsd&#34;&gt;
  &lt;ace principalFormat=&#34;DistinguishedName&#34;&gt; 
    &lt;grant&gt;true&lt;/grant&gt;
    &lt;principal&gt;<span class="bold">cn=grp1,ou=Americas,o=oracle,l=redwoodshores,st=CA,c=US</span>&lt;/principal&gt;
    &lt;privilege&gt;
      &lt;dav:read/&gt;
    &lt;/privilege&gt;
  &lt;/ace&gt; 
&lt;/acl&gt;
</pre></div>
<!-- class="example" --></div>
</div>
<hr/>
<br/>
<p style="text-decoration:underline">Footnote Legend</p>
Footnote&nbsp;1:
<p>Note the colon (<code>:</code>) as part of the namespace name. <code>DAV:</code> is the namespace itself, <span class="italic">not</span> a prefix. A prefix commonly used for namespace <code>DAV:</code> is <code>dav</code>, but this is only conventional. <code>dav</code> is not a predefined prefix for Oracle XML&nbsp;DB.</p>
<br/></div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment3410">
<tr>
<td class="cellalignment3417">
<table class="cellalignment3415">
<tr>
<td class="cellalignment3414"><a href="xdb19rpl.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment3414"><a href="xdb22pro.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2002, 2016, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment3419">
<table class="cellalignment3413">
<tr>
<td class="cellalignment3414"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment3414"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment3414"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment3414"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment3414"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment3414"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>


</body></html>