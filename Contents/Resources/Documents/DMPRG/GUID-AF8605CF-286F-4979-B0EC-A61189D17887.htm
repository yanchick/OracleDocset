<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-5725"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Example%3A%20Segmenting%20Customer%20Data"></a><title>Example: Segmenting Customer Data</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="dcterms.created" content="2017-05-15T23:58:14Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Data Mining User&#39;s Guide"/>
<meta name="dcterms.identifier" content="E53115-05"/>
<meta name="dcterms.isVersionOf" content="DMPRG"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2005, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="GUID-9E0276FD-40E0-4053-9CA6-1FC51397BEEE.htm" title="Previous" type="text/html"/>
<link rel="Next" href="GUID-0B413EF4-62D2-4E83-803E-E693438EFD45.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E53115-05.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-AF8605CF-286F-4979-B0EC-A61189D17887"></a> <span id="PAGE" style="display:none;">9/141</span> <!-- End Header -->
<a id="DMPRG804"></a><a id="DMPRG805"></a><a id="DMPRG806"></a><a id="DMPRG803"></a>
<h1 id="DMPRG-GUID-AF8605CF-286F-4979-B0EC-A61189D17887" class="sect1">Example: Segmenting Customer Data</h1>
<div>
<div class="section">
<p>The <a id="d3163e22" class="indexterm-anchor"></a>examples in this section use an Expectation Maximization clustering model to segment the customer data based on common characteristics. The examples in this section are:</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-AF8605CF-286F-4979-B0EC-A61189D17887__BABJGEID">
<p class="titleinexample">Example 1-6 Compute Customer Segments</p>
<p>This query computes natural groupings of customers and returns the number of customers <a id="d3163e30" class="indexterm-anchor"></a>in each group.</p>
<pre dir="ltr">SELECT CLUSTER_ID(em_sh_clus_sample USING *) AS clus, COUNT(*) AS cnt
  FROM mining_data_apply_v
GROUP BY CLUSTER_ID(em_sh_clus_sample USING *)
ORDER BY cnt DESC;
 
      CLUS        CNT
---------- ----------
         9        311
         3        294
         7        215
        12        201
        17        123
        16        114
        14         86
        19         64
        15         56
        18         36
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-AF8605CF-286F-4979-B0EC-A61189D17887__BABJBBHH">
<p class="titleinexample">Example 1-7 Find the Customers Who Are Most Likely To Be in the Largest Segment</p>
<p>The query in <a href="GUID-AF8605CF-286F-4979-B0EC-A61189D17887.htm#GUID-AF8605CF-286F-4979-B0EC-A61189D17887__BABJGEID">Example 1-6</a> shows that segment 9 has the most members. The following query lists the five customers who are most likely to be in segment 9.</p>
<pre dir="ltr">SELECT cust_id
FROM (SELECT cust_id, RANK() over (ORDER BY prob DESC, cust_id) rnk_clus2
  FROM (SELECT cust_id,
          ROUND(CLUSTER_PROBABILITY(em_sh_clus_sample, 9 USING *),3) prob
          FROM mining_data_apply_v))
WHERE rnk_clus2 &lt;= 5
ORDER BY rnk_clus2;
 
   CUST_ID
----------
    100002
    100012
    100016
    100019
    100021
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-AF8605CF-286F-4979-B0EC-A61189D17887__BABGCJGE">
<p class="titleinexample">Example 1-8 Find Key Characteristics of the Most Representative Customer in the Largest Cluster</p>
<p>The query in <a href="GUID-AF8605CF-286F-4979-B0EC-A61189D17887.htm#GUID-AF8605CF-286F-4979-B0EC-A61189D17887__BABJBBHH">Example 1-7</a> lists customer 100002 first in the list of likely customers for segment 9. The following query returns the five characteristics that are most significant in determining the assignment of customer 100002 to segments with probability &gt; 20% (only segment 9 for this customer).</p>
<pre dir="ltr">SELECT S.cluster_id, probability prob,
       <a id="d3163e53" class="indexterm-anchor"></a>CLUSTER_DETAILS(em_sh_clus_sample, S.cluster_id, 5 using T.*) det
 FROM
  (SELECT v.*, <a id="d3163e56" class="indexterm-anchor"></a>CLUSTER_SET(em_sh_clus_sample, NULL, 0.2 USING *) pset
    FROM mining_data_apply_v v
    WHERE cust_id = 100002) T,
 TABLE(T.pset) S
 ORDER BY 2 desc;
 
CLUSTER_ID    PROB DET
---------- ------- --------------------------------------------------------------------------------
         9  1.0000 &lt;Details algorithm=&#34;Expectation Maximization&#34; cluster=&#34;9&#34;&gt;
                   &lt;Attribute name=&#34;YRS_RESIDENCE&#34; actualValue=&#34;4&#34; weight=&#34;1&#34; rank=&#34;1&#34;/&gt;
                   &lt;Attribute name=&#34;EDUCATION&#34; actualValue=&#34;Bach.&#34; weight=&#34;0&#34; rank=&#34;2&#34;/&gt;
                   &lt;Attribute name=&#34;AFFINITY_CARD&#34; actualValue=&#34;0&#34; weight=&#34;0&#34; rank=&#34;3&#34;/&gt;
                   &lt;Attribute name=&#34;BOOKKEEPING_APPLICATION&#34; actualValue=&#34;1&#34; weight=&#34;0&#34; rank=&#34;4&#34;/&gt;
                   &lt;Attribute name=&#34;Y_BOX_GAMES&#34; actualValue=&#34;0&#34; weight=&#34;0&#34; rank=&#34;5&#34;/&gt;
                   &lt;/Details&gt;
</pre></div>
<!-- class="example" --></div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment3323">
<tr>
<td class="cellalignment3330">
<table class="cellalignment3328">
<tr>
<td class="cellalignment3327"><a href="GUID-9E0276FD-40E0-4053-9CA6-1FC51397BEEE.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment3327"><a href="GUID-0B413EF4-62D2-4E83-803E-E693438EFD45.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2005, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment3332">
<table class="cellalignment3326">
<tr>
<td class="cellalignment3327"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment3327"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment3327"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment3327"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment3327"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment3327"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>