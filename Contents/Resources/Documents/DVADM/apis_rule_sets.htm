<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-5960"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Oracle%20Database%20Vault%20Rule%20Set%20APIs"></a><title>Oracle Database Vault Rule Set APIs</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="description" content="You can use the DBMS_MACADM PL/SQL package and a set of Oracle Database Vault rule functions to manage rule sets."/>
<meta name="keywords" content="DBMS_MACADM package, rule set procedures, listed, rule sets, procedures, DBMS_MACADM (configuration), functions, DBMS_MACADM (configuration), functions, DBMS_MACADM.ADD_RULE_TO_RULE_SET procedure, Oracle Label Security, using OLS_LABEL_DOMINATES function in rule expressions, DBMS_MACADM.CREATE_RULE procedure, DBMS_MACADM.CREATE_RULE_SET procedure, DBMS_MACADM.DELETE_RULE procedure, DBMS_MACADM.DELETE_RULE_FROM_RULE_SET procedure, DBMS_MACADM.DELETE_RULE_SET procedure, DBMS_MACADM.RENAME_RULE procedure, DBMS_MACADM.RENAME_RULE_SET procedure, DBMS_MACADM.UPDATE_RULE procedure, DBMS_MACADM.UPDATE_RULE_SET procedure, PL/SQL functions for inspecting SQL, PL/SQL functions for rule sets, events firing, finding with DVSYS.DV_SYSEVENT, users, login user name, finding with DVSYS.DV_LOGIN_USER, databases, instances, number, finding with DVSYS.DV_INSTANCE_NUM, names, retrieving with DVSYS.DV_DATABASE_NAME, objects, types, finding with DVSYS.DV_DICT_OBJ_TYPE, object owners, finding with DVSYS.DV_DICT_OBJ_OWNER, object names, finding with DVSYS.DV_DICT_OBJ_NAME, SQL text, finding with DVSYS.DV_SQL_TEXT"/>
<meta name="dcterms.created" content="2017-06-05T10:50:14Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Vault Administrator&#39;s Guide"/>
<meta name="dcterms.identifier" content="E49109-12"/>
<meta name="dcterms.isVersionOf" content="DVADM"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2006, 2016, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="apis_realms.htm" title="Previous" type="text/html"/>
<link rel="Next" href="apis_command_rules.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E49109-12.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-66E0EDFE-B4F0-4B5B-9657-B6C4737A37BF"></a> <span id="PAGE" style="display:none;">18/34</span> <!-- End Header -->
<a id="DVADM71189"></a>
<h1 id="DVADM-GUID-66E0EDFE-B4F0-4B5B-9657-B6C4737A37BF" class="sect1"><span class="enumeration_chapter">14</span> Oracle Database Vault Rule Set APIs</h1>
<div>
<p>You can use the <code class="codeph">DBMS_MACADM</code> PL/SQL package and a set of Oracle Database Vault rule functions to manage rule sets.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="apis_rule_sets.htm#GUID-1B24D370-46E3-445E-91CC-8E621F5E94CB" title="The DBMS_MACADM rule set procedures enable you to configure both rule sets and individual rules that go within these rule sets.">DBMS_MACADM Rule Set Procedures</a></p>
</li>
<li>
<p><a href="apis_rule_sets.htm#GUID-9CC41BCB-1335-4230-8547-977AD105E47B" title="Oracle Database Vault provides functions to use in rule sets to inspect the SQL statement that the rule set protects.">Oracle Database Vault PL/SQL Rule Set Functions</a></p>
</li>
</ul>
</div>
<a id="DVADM70470"></a>
<div class="props_rev_3"><a id="GUID-1B24D370-46E3-445E-91CC-8E621F5E94CB"></a>
<h2 id="DVADM-GUID-1B24D370-46E3-445E-91CC-8E621F5E94CB" class="sect2">DBMS_MACADM Rule Set Procedures</h2>
<div>
<p>The <code class="codeph">DBMS_MACADM</code> rule set procedures enable you to configure both rule sets and individual rules that go within these rule sets.</p>
<p><a href="apis_rule_sets.htm#GUID-1B24D370-46E3-445E-91CC-8E621F5E94CB__CHDBGFHI" title="Rule Set APIs">Table 14-1</a> lists procedures within the <code class="codeph">DBMS_MACADM</code> package that you can use to configure rule sets. Only users who have been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role can use these procedures.</p>
<div class="tblformalwide" id="GUID-1B24D370-46E3-445E-91CC-8E621F5E94CB__CHDBGFHI">
<p class="titleintable">Table 14-1 DBMS_MACADM Rule Set Configuration Procedures</p>
<table class="cellalignment379" title="DBMS_MACADM Rule Set Configuration Procedures" summary="Rule Set APIs">
<thead>
<tr class="cellalignment332">
<th class="cellalignment402" id="d63546e221">Procedure</th>
<th class="cellalignment458" id="d63546e224">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment332">
<td class="cellalignment405" id="d63546e229" headers="d63546e221">
<p><a href="apis_rule_sets.htm#GUID-0549C094-EE0A-42E0-90B4-3FAF0A0304C3" title="The ADD_RULE_TO_RULE_SET procedure adds rule to a rule set; you can enable having the rule checked when the rule set is evaluated.">ADD_RULE_TO_RULE_SET Procedure</a></p>
</td>
<td class="cellalignment459" headers="d63546e229 d63546e224">
<p>Adds a rule to a rule set</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment405" id="d63546e243" headers="d63546e221">
<p><a href="apis_rule_sets.htm#GUID-4AF93021-ECC4-497F-934D-CAE1D4022965" title="The CREATE_RULE procedure creates a rule, which afterwards, can be added to a rule set.">CREATE_RULE Procedure</a></p>
</td>
<td class="cellalignment459" headers="d63546e243 d63546e224">
<p>Creates a rule</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment405" id="d63546e257" headers="d63546e221">
<p><a href="apis_rule_sets.htm#GUID-5CAD2D42-C5B5-48AD-B0D8-4CBD71B7B219" title="The CREATE_RULE_SET procedure creates a rule set.">CREATE_RULE_SET Procedure</a></p>
</td>
<td class="cellalignment459" headers="d63546e257 d63546e224">
<p>Creates a rule set</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment405" id="d63546e271" headers="d63546e221">
<p><a href="apis_rule_sets.htm#GUID-A2A7354F-1593-46D2-A343-7638FF7DB0EE" title="The DELETE_RULE procedure deletes a rule.">DELETE_RULE Procedure</a></p>
</td>
<td class="cellalignment459" headers="d63546e271 d63546e224">
<p>Deletes a rule</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment405" id="d63546e285" headers="d63546e221">
<p><a href="apis_rule_sets.htm#GUID-318F7DA6-FAD3-49A5-A174-139BB06C8914" title="The DELETE_RULE_FROM_RULE_SET procedure deletes a rule from a rule set.">DELETE_RULE_FROM_RULE_SET Procedure</a></p>
</td>
<td class="cellalignment459" headers="d63546e285 d63546e224">
<p>Deletes a rule from a rule set</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment405" id="d63546e299" headers="d63546e221">
<p><a href="apis_rule_sets.htm#GUID-9BE707E1-1357-49F8-904C-AFE55C78C3C6" title="The DELETE_RULE_SET procedure deletes a rule set.">DELETE_RULE_SET Procedure</a></p>
</td>
<td class="cellalignment459" headers="d63546e299 d63546e224">
<p>Deletes a rule set</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment405" id="d63546e313" headers="d63546e221">
<p><a href="apis_rule_sets.htm#GUID-C2F60720-7668-42A2-8E57-8FDA1CCBB1A9" title="The RENAME_RULE procedure renames a rule and causes the name change to take effect everywhere the rule is used.">RENAME_RULE Procedure</a></p>
</td>
<td class="cellalignment459" headers="d63546e313 d63546e224">
<p>Renames a rule. The name change takes effect everywhere the rule is used.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment405" id="d63546e327" headers="d63546e221">
<p><a href="apis_rule_sets.htm#GUID-B42D559E-3F95-4F0A-82D3-F0BF2F3207DE" title="The RENAME_RULE_SET procedure renames a rule set and causes the name change to take effect everywhere the rule set is used.">RENAME_RULE_SET Procedure</a></p>
</td>
<td class="cellalignment459" headers="d63546e327 d63546e224">
<p>Renames a rule set. The name change takes effect everywhere the rule set is used.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment405" id="d63546e341" headers="d63546e221">
<p><a href="apis_rule_sets.htm#GUID-658C2D27-D1B6-46B6-A7C2-A8D629BC9D0F" title="The UPDATE_RULE procedure updates a rule.">UPDATE_RULE Procedure</a></p>
</td>
<td class="cellalignment459" headers="d63546e341 d63546e224">
<p>Updates a rule</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment405" id="d63546e355" headers="d63546e221">
<p><a href="apis_rule_sets.htm#GUID-6D99458F-A85A-462E-AA1E-B1970A265866" title="The UPDATE_RULE_SET procedure updates a rule set.">UPDATE_RULE_SET Procedure</a></p>
</td>
<td class="cellalignment459" headers="d63546e355 d63546e224">
<p>Updates a rule set</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="infoboxnotealso" id="GUID-1B24D370-46E3-445E-91CC-8E621F5E94CB__GUID-30D480C5-203A-40F3-A090-B20B2F0B5F70">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="cfrulset.htm#GUID-41914FF0-20E0-4878-8124-C6C976C19104" title="Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.">Configuring Rule Sets</a>, for detailed information about rule sets</p>
</li>
<li>
<p><a href="apis_dbms_macutl.htm#GUID-5A0CB405-9A3C-48ED-B18F-3A8013D436E3" title="Oracle Database Vault provides a set of utility APIs in the DBMS_MACUTL PL/SQL package.">Oracle Database Vault Utility APIs</a>, for a set of general-purpose utility procedures that you can use with the rule set procedures and functions</p>
</li>
</ul>
</div>
</div>
<a id="DVADM70473"></a><a id="DVADM70474"></a><a id="DVADM70475"></a><a id="DVADM70476"></a><a id="DVADM70472"></a>
<div class="props_rev_3"><a id="GUID-0549C094-EE0A-42E0-90B4-3FAF0A0304C3"></a>
<h3 id="DVADM-GUID-0549C094-EE0A-42E0-90B4-3FAF0A0304C3" class="sect3">ADD_RULE_TO_RULE_SET Procedure</h3>
<div>
<p>The <code class="codeph">ADD_RULE_TO_RULE_SET</code> procedure adds rule to a rule set; you can enable having the rule checked when the rule set is evaluated.</p>
<div class="section">
<p class="subhead3">Syntax</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">DBMS_MACADM.ADD_RULE_TO_RULE_SET(
  rule_set_name  IN VARCHAR2, 
  rule_name      IN VARCHAR2, 
  rule_order     IN NUMBER, 
  enabled        IN VARCHAR2);
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Parameters</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-0549C094-EE0A-42E0-90B4-3FAF0A0304C3__ADD_RULE_TO_RULE_SETPARAMETERS-090F2CEE">
<p class="titleintable">Table 14-2 ADD_RULE_TO_RULE_SET Parameters</p>
<table class="cellalignment338" title="ADD_RULE_TO_RULE_SET Parameters" summary="ADD_RULE_TO_RULE_SET 1">
<thead>
<tr class="cellalignment332">
<th class="cellalignment380" id="d63546e494">Parameter</th>
<th class="cellalignment381" id="d63546e497">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment332">
<td class="cellalignment382" id="d63546e502" headers="d63546e494">
<p><code class="codeph">rule_set_name</code></p>
</td>
<td class="cellalignment383" headers="d63546e502 d63546e497">
<p>Rule set name.</p>
<p>To find existing rule sets in the current database instance, query the <code class="codeph">DVSYS.DBA_DV_RULE_SET</code> view, described in <a href="views.htm#GUID-A7FD62EB-A8E4-4279-A0D5-1677493AC202" title="The DVSYS.DBA_DV_RULE_SET data dictionary view lists the rules sets that have been created.">DVSYS.DBA_DV_RULE_SET View</a>.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment382" id="d63546e525" headers="d63546e494">
<p><code class="codeph">rule_name</code></p>
</td>
<td class="cellalignment383" headers="d63546e525 d63546e497">
<p>Rule to add to the rule set.</p>
<p>To find existing rules, query the <code class="codeph">DVSYS.DBA_DV_RULE</code> view, described in <a href="views.htm#GUID-97C96089-0EE4-4A57-8257-1F9F61606245" title="The DVSYS.DBA_DV_RULE data dictionary view lists the rules that have been defined.">DVSYS.DBA_DV_RULE View</a>.</p>
<p>To find rules that have been associated with rule sets, use <code class="codeph">DVSYS.DBA_DV_RULE_SET_RULE</code>, described in <a href="views.htm#GUID-97C96089-0EE4-4A57-8257-1F9F61606245" title="The DVSYS.DBA_DV_RULE data dictionary view lists the rules that have been defined.">DVSYS.DBA_DV_RULE View</a>.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment382" id="d63546e562" headers="d63546e494">
<p><code class="codeph">rule_order</code></p>
</td>
<td class="cellalignment383" headers="d63546e562 d63546e497">
<p>Does not apply to this release, but you must include a value for the <code class="codeph">ADD_RULE_TO_RULE_SET</code> procedure to work. Enter <code class="codeph">1</code>.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment382" id="d63546e577" headers="d63546e494">
<p><code class="codeph">enabled</code></p>
</td>
<td class="cellalignment383" headers="d63546e577 d63546e497">
<p>Optional. Determines whether the rule should be checked when the rule set is evaluated. Possible values are:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">DBMS_MACUTL.G_YES</code> (Yes; default). Enables the rule to be checked during the rule set evaluation.</p>
</li>
<li>
<p><code class="codeph">DBMS_MACUTL.G_NO</code> (No). Prevents the rule from being checked during the rule set evaluation.</p>
</li>
</ul>
<p>See <a href="apis_dbms_macutl.htm#GUID-B6513A8B-6DE9-45B1-96CB-3558C635CD4A__BCFGCJFH" title="Field summary for the DVSYS.DBMS_MACSEC_ROLES API">Table 19-1</a> for more information.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<p class="subhead3">Examples</p>
</div>
<!-- class="section" -->
<div class="section">
<p>The following example adds a rule to a rule set, and by omitting the <code class="codeph">enabled</code> parameter, automatically enables the rule to be checked when the rule set is evaluated.</p>
<pre dir="ltr">BEGIN
 DBMS_MACADM.ADD_RULE_TO_RULE_SET(
  rule_set_name =&gt; &#39;Limit_DBA_Access&#39;, 
  rule_name     =&gt; &#39;Restrict DROP TABLE operations&#39;,
  rule_order    =&gt; 1);
END;
/
</pre>
<p>This example adds the rule to the rule set but disables rule checking.</p>
<pre dir="ltr">BEGIN
 DBMS_MACADM.ADD_RULE_TO_RULE_SET(
  rule_set_name =&gt; &#39;Limit_DBA_Access&#39;,
  rule_name     =&gt; &#39;Check UPDATE operations&#39;,
  rule_order    =&gt; 1,
  enabled       =&gt; DBMS_MACUTL.G_NO);
END;
/
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DVADM70478"></a><a id="DVADM70479"></a><a id="DVADM70480"></a><a id="DVADM70481"></a><a id="DVADM70477"></a>
<div class="props_rev_3"><a id="GUID-4AF93021-ECC4-497F-934D-CAE1D4022965"></a>
<h3 id="DVADM-GUID-4AF93021-ECC4-497F-934D-CAE1D4022965" class="sect3">CREATE_RULE Procedure</h3>
<div>
<p>The <code class="codeph">CREATE_RULE</code> procedure creates a rule, which afterwards, can be added to a rule set.</p>
<div class="section">
<p class="subhead3">Syntax</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">DBMS_MACADM.CREATE_RULE(
  rule_name  IN VARCHAR2, 
  rule_expr  IN VARCHAR2);
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Parameters</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-4AF93021-ECC4-497F-934D-CAE1D4022965__CREATE_RULEPARAMETERS-090F321F">
<p class="titleintable">Table 14-3 CREATE_RULE Parameters</p>
<table class="cellalignment338" title="CREATE_RULE Parameters" summary="CREATE_RULE">
<thead>
<tr class="cellalignment332">
<th class="cellalignment422" id="d63546e729">Parameter</th>
<th class="cellalignment423" id="d63546e732">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment332">
<td class="cellalignment424" id="d63546e737" headers="d63546e729">
<p><code class="codeph">rule_name</code></p>
</td>
<td class="cellalignment425" headers="d63546e737 d63546e732">
<p>Rule name, up to 128 characters in mixed-case. Spaces are allowed.</p>
<p>To find existing rules in the current database instance, query the <code class="codeph">DVSYS.DBA_DV_RULE</code> view, described in <a href="views.htm#GUID-97C96089-0EE4-4A57-8257-1F9F61606245" title="The DVSYS.DBA_DV_RULE data dictionary view lists the rules that have been defined.">DVSYS.DBA_DV_RULE View</a>.</p>
<p>To find rules that have been associated with rule sets, query <code class="codeph">DVSYS.DBA_DV_RULE_SET_RULE</code>, described in <a href="views.htm#GUID-52C00874-C14D-44F6-A89A-CCB5E07FBE3E" title="The DVSYS.DBA_DV_RULE_SET_RULE data dictionary view lists rules that are associated with existing rule sets.">DVSYS.DBA_DV_RULE_SET_RULE View</a>.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment424" id="d63546e774" headers="d63546e729">
<p><code class="codeph">rule_expr</code></p>
</td>
<td class="cellalignment425" headers="d63546e774 d63546e732">
<p>PL/SQL <code class="codeph">BOOLEAN</code> expression.</p>
<p>If the expression contains quotation marks, do not use double quotation marks. Instead, use two single quotation marks. Enclose the entire expression within single quotation marks. For example:</p>
<pre dir="ltr">&#39;TO_CHAR(SYSDATE,&#39;&#39;HH24&#39;&#39;) = &#39;&#39;12&#39;&#39;&#39;
</pre>
<p>See <a href="cfrulset.htm#GUID-AAAFC806-8DB8-45A7-A058-B7CD352B0C50" title="You can create a new rule in Enterprise Manager Cloud Control.">Creating a New Rule</a> for more information on rule expressions.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<p class="subhead3">Examples</p>
</div>
<!-- class="section" -->
<div class="section">
<p>The following example shows how to create a rule expression that checks if the current session user is <code class="codeph">SYSADM</code>.</p>
<pre dir="ltr">BEGIN
 DBMS_MACADM.CREATE_RULE(
  rule_name  =&gt; &#39;Check UPDATE operations&#39;, 
  rule_expr  =&gt;&#39;SYS_CONTEXT(&#39;&#39;USERENV&#39;&#39;,&#39;&#39;SESSION_USER&#39;&#39;) = &#39;&#39;SYSADM&#39;&#39;&#39;);
END;
/
</pre>
<div class="infobox-note" id="GUID-4AF93021-ECC4-497F-934D-CAE1D4022965__GUID-08B95BED-D7D0-457D-8FAA-525AE17E4D7B">
<p class="notep1">Note:</p>
<p>The following feature is available starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.2).</p>
</div>
<p>The following example shows how to create a rule expression that uses the public standalone function <code class="codeph">OLS_LABEL_DOMINATES</code> to find if the session label of the <code class="codeph">hr_ols_pol</code> Oracle Label Security policy dominates or is equal to the <code class="codeph">hs</code> label. The value <code class="codeph">0</code> indicates if it is false. (To check if it is equal, you would specify <code class="codeph">1</code>.)</p>
<pre dir="ltr">BEGIN
 DBMS_MACADM.CREATE_RULE(
  rule_name  =&gt; &#39;Check OLS Factor&#39;, 
  rule_expr  =&gt; &#39;OLS_LABEL_DOMINATES(&#39;&#39;hr_ols_pol&#39;&#39;, &#39;&#39;hs&#39;&#39;) = 1&#39;);
END;
/
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DVADM70483"></a><a id="DVADM70484"></a><a id="DVADM70485"></a><a id="DVADM70486"></a><a id="DVADM70482"></a>
<div class="props_rev_3"><a id="GUID-5CAD2D42-C5B5-48AD-B0D8-4CBD71B7B219"></a>
<h3 id="DVADM-GUID-5CAD2D42-C5B5-48AD-B0D8-4CBD71B7B219" class="sect3">CREATE_RULE_SET Procedure</h3>
<div>
<p>The <code class="codeph">CREATE_RULE_SET</code> procedure creates a rule set.</p>
<div class="section">
<p>After you create a rule set, you can use the <code class="codeph">CREATE_RULE</code> and <code class="codeph">ADD_RULE_TO_RULE_SET</code> procedures to create and add rules to the rule set.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Syntax</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">DBMS_MACADM.CREATE_RULE_SET(
  rule_set_name    IN VARCHAR2, 
  description      IN VARCHAR2, 
  enabled          IN VARCHAR2, 
  eval_options     IN NUMBER, 
  audit_options    IN NUMBER, 
  fail_options     IN NUMBER, 
  fail_message     IN VARCHAR2, 
  fail_code        IN NUMBER, 
  handler_options  IN NUMBER, 
  handler          IN VARCHAR2,
  is_static        IN BOOLEAN DEFAULT);
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Parameters</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-5CAD2D42-C5B5-48AD-B0D8-4CBD71B7B219__CREATE_RULE_SETPARAMETERS-090F36CD">
<p class="titleintable">Table 14-4 CREATE_RULE_SET Parameters</p>
<table class="cellalignment338" title="CREATE_RULE_SET Parameters" summary="CREATE_RULE_SET">
<thead>
<tr class="cellalignment332">
<th class="cellalignment410" id="d63546e947">Parameter</th>
<th class="cellalignment411" id="d63546e950">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e955" headers="d63546e947">
<p><code class="codeph">rule_set_name</code></p>
</td>
<td class="cellalignment413" headers="d63546e955 d63546e950">
<p>Rule set name, up to 90 characters in mixed-case. Spaces are allowed.</p>
<p>To find existing rule sets in the current database instance, query the <code class="codeph">DVSYS.DBA_DV_RULE_SET</code> view, described in <a href="views.htm#GUID-A7FD62EB-A8E4-4279-A0D5-1677493AC202" title="The DVSYS.DBA_DV_RULE_SET data dictionary view lists the rules sets that have been created.">DVSYS.DBA_DV_RULE_SET View</a>.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e978" headers="d63546e947">
<p><code class="codeph">description</code></p>
</td>
<td class="cellalignment413" headers="d63546e978 d63546e950">
<p>Description of the purpose of the rule set, up to 1024 characters in mixed-case.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e987" headers="d63546e947">
<p><code class="codeph">enabled</code></p>
</td>
<td class="cellalignment413" headers="d63546e987 d63546e950">
<p><code class="codeph">DBMS_MACUTL.G_YES</code> (Yes) enables the rule set; <code class="codeph">DBMS_MACUTL.G_NO</code> (No) disables it. The default is <code class="codeph">DBMS_MACUTL.G_YES</code>.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e1004" headers="d63546e947">
<p><code class="codeph">eval_options</code></p>
</td>
<td class="cellalignment413" headers="d63546e1004 d63546e950">
<p>If you plan to assign multiple rules to the rule set, enter one of the following settings:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_EVAL_ALL</code>: All rules in the rule set must evaluate to true for the rule set itself to evaluate to true (default).</p>
</li>
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_EVAL_ANY</code>: At least one rule in the rule set must evaluate to true for the rule set itself to evaluate to true.</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e1024" headers="d63546e947">
<p><code class="codeph">audit_options</code></p>
</td>
<td class="cellalignment413" headers="d63546e1024 d63546e950">
<p>Select one of the following settings:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_AUDIT_OFF</code>: Disables auditing for the rule set (default)</p>
</li>
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_AUDIT_FAIL</code>: Creates an audit record when a rule set violation occurs</p>
</li>
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_AUDIT_SUCCESS</code>: Creates an audit record for a successful rule set evaluation</p>
</li>
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_AUDIT_FAIL + DBMS_MACUTL.G_RULESET_AUDIT_SUCCESS</code>: Creates an audit record for both successful and failed rule set evaluations</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e1054" headers="d63546e947">
<p><code class="codeph">fail_options</code></p>
</td>
<td class="cellalignment413" headers="d63546e1054 d63546e950">
<p>Options for reporting errors:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_FAIL_SHOW</code>: Shows an error message (default)</p>
</li>
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_FAIL_SILENT</code>: Does not show an error message</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e1074" headers="d63546e947">
<p><code class="codeph">fail_message</code></p>
</td>
<td class="cellalignment413" headers="d63546e1074 d63546e950">
<p>Enter an error message for failure, up to 80 characters in mixed-case, to associate with the fail code you specify for <code class="codeph">fail_code</code>.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e1086" headers="d63546e947">
<p><code class="codeph">fail_code</code></p>
</td>
<td class="cellalignment413" headers="d63546e1086 d63546e950">
<p>Enter a number in the range of -20000 to -20999 or 20000 to 20999 to associate with the <code class="codeph">fail_message</code> parameter.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e1098" headers="d63546e947">
<p><code class="codeph">handler_options</code></p>
</td>
<td class="cellalignment413" headers="d63546e1098 d63546e950">
<p>Select one of the following settings:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_HANDLER_OFF</code>: Disables error handling (default)</p>
</li>
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_HANDLER_FAIL</code>: Calls handler on rule set failure</p>
</li>
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_HANDLER_SUCCESS</code>: Calls handler on rule set success</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e1123" headers="d63546e947">
<p><code class="codeph">handler</code></p>
</td>
<td class="cellalignment413" headers="d63546e1123 d63546e950">
<p>Name of the PL/SQL function or procedure that defines the custom event handler logic.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e1132" headers="d63546e947">
<p><code class="codeph">is_static</code></p>
</td>
<td class="cellalignment413" headers="d63546e1132 d63546e950">
<p>Optional. Determines how often a rule set is evaluated when it is accessed. The default is <code class="codeph">FALSE</code>.</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">TRUE</code>: The rule set is evaluated once during the user session. After that, the value is re-used.</p>
</li>
<li>
<p><code class="codeph">FALSE</code>: The rule set is evaluated every time.</p>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<p class="subhead3">Example</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">BEGIN
 DBMS_MACADM.CREATE_RULE_SET(
  rule_set_name    =&gt; &#39;Limit_DBA_Access&#39;, 
  description      =&gt; &#39;DBA access through predefined processes&#39;, 
  enabled          =&gt; DBMS_MACUTL.G_YES,
  eval_options     =&gt; DBMS_MACUTL.G_RULESET_EVAL_ANY,
  audit_options    =&gt; DBMS_MACUTL.G_RULESET_AUDIT_FAIL + DBMS_MACUTL.G_RULESET_AUDIT_SUCCESS,
  fail_options     =&gt; DBMS_MACUTL.G_RULESET_FAIL_SILENT,
  fail_message     =&gt; &#39;&#39;,
  fail_code        =&gt; 20461,
  handler_options  =&gt; DBMS_MACUTL.G_RULESET_HANDLER_FAIL, 
  handler          =&gt; &#39;dbavowner.email_alert&#39;,
  is_static        =&gt; TRUE);
END;
/
</pre>
<div class="infoboxnotealso" id="GUID-5CAD2D42-C5B5-48AD-B0D8-4CBD71B7B219__GUID-37701448-5B60-42C1-88B9-FDDAC9618DFE">
<p class="notep1">See Also:</p>
<p><a href="apis_dbms_macutl.htm#GUID-40FF8DC6-F09C-4CA0-83D6-679052619888__CIHCFIDJ">Example 19-2</a></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="DVADM70488"></a><a id="DVADM70489"></a><a id="DVADM70490"></a><a id="DVADM70491"></a><a id="DVADM70487"></a>
<div class="props_rev_3"><a id="GUID-A2A7354F-1593-46D2-A343-7638FF7DB0EE"></a>
<h3 id="DVADM-GUID-A2A7354F-1593-46D2-A343-7638FF7DB0EE" class="sect3">DELETE_RULE Procedure</h3>
<div>
<p>The <code class="codeph">DELETE_RULE</code> procedure deletes a rule.</p>
<div class="section"></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Syntax</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">DBMS_MACADM.DELETE_RULE(
  rule_name IN VARCHAR2); 
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Parameter</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-A2A7354F-1593-46D2-A343-7638FF7DB0EE__DELETE_RULEPARAMETER-090F3A78">
<p class="titleintable">Table 14-5 DELETE_RULE Parameter</p>
<table class="cellalignment338" title="DELETE_RULE Parameter" summary="DELETE_RULE">
<thead>
<tr class="cellalignment332">
<th class="cellalignment450" id="d63546e1270">Parameter</th>
<th class="cellalignment460" id="d63546e1273">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment332">
<td class="cellalignment451" id="d63546e1278" headers="d63546e1270">
<p><code class="codeph">rule_name</code></p>
</td>
<td class="cellalignment461" headers="d63546e1278 d63546e1273">
<p>Rule name.</p>
<p>To find existing rules in the current database instance, query the <code class="codeph">DVSYS.DBA_DV_RULE</code> view, described in <a href="views.htm#GUID-97C96089-0EE4-4A57-8257-1F9F61606245" title="The DVSYS.DBA_DV_RULE data dictionary view lists the rules that have been defined.">DVSYS.DBA_DV_RULE View</a>.</p>
<p>To find rules that have been associated with rule sets, query <code class="codeph">DVSYS.DBA_DV_RULE_SET_RULE</code>, described in <a href="views.htm#GUID-52C00874-C14D-44F6-A89A-CCB5E07FBE3E" title="The DVSYS.DBA_DV_RULE_SET_RULE data dictionary view lists rules that are associated with existing rule sets.">DVSYS.DBA_DV_RULE_SET_RULE View</a>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<p class="subhead3">Example</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">EXEC DBMS_MACADM.DELETE_RULE(&#39;Check UPDATE operations&#39;); 
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DVADM70493"></a><a id="DVADM70494"></a><a id="DVADM70495"></a><a id="DVADM70496"></a><a id="DVADM70492"></a>
<div class="props_rev_3"><a id="GUID-318F7DA6-FAD3-49A5-A174-139BB06C8914"></a>
<h3 id="DVADM-GUID-318F7DA6-FAD3-49A5-A174-139BB06C8914" class="sect3">DELETE_RULE_FROM_RULE_SET Procedure</h3>
<div>
<p>The <code class="codeph">DELETE_RULE_FROM_RULE_SET</code> procedure deletes a rule from a rule set.</p>
<div class="section">
<p class="subhead3">Syntax</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">DBMS_MACADM.DELETE_RULE_FROM_RULE_SET(
  rule_set_name IN VARCHAR2, 
  rule_name     IN VARCHAR2);
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Parameters</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-318F7DA6-FAD3-49A5-A174-139BB06C8914__DELETE_RULE_FROM_RULE_SETPARAMETERS-090F3E01">
<p class="titleintable">Table 14-6 DELETE_RULE_FROM_RULE_SET Parameters</p>
<table class="cellalignment338" title="DELETE_RULE_FROM_RULE_SET Parameters" summary="DELETE_RULE_FROM_RULE_SET">
<thead>
<tr class="cellalignment332">
<th class="cellalignment410" id="d63546e1426">Parameter</th>
<th class="cellalignment411" id="d63546e1429">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e1434" headers="d63546e1426">
<p><code class="codeph">rule_set_name</code></p>
</td>
<td class="cellalignment413" headers="d63546e1434 d63546e1429">
<p>Rule set name.</p>
<p>To find existing rule sets in the current database instance, query the <code class="codeph">DVSYS.DBA_DV_RULE_SET</code> view, described in <a href="views.htm#GUID-A7FD62EB-A8E4-4279-A0D5-1677493AC202" title="The DVSYS.DBA_DV_RULE_SET data dictionary view lists the rules sets that have been created.">DVSYS.DBA_DV_RULE_SET View</a>.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e1457" headers="d63546e1426">
<p><code class="codeph">rule_name</code></p>
</td>
<td class="cellalignment413" headers="d63546e1457 d63546e1429">
<p>Rule to remove from the rule set.</p>
<p>To find existing rules in the current database instance, query the <code class="codeph">DVSYS.DBA_DV_RULE</code> view, described in <a href="views.htm#GUID-97C96089-0EE4-4A57-8257-1F9F61606245" title="The DVSYS.DBA_DV_RULE data dictionary view lists the rules that have been defined.">DVSYS.DBA_DV_RULE View</a>.</p>
<p>To find rules that have been associated with rule sets, query <code class="codeph">DVSYS.DBA_DV_RULE_SET_RULE</code>, described in <a href="views.htm#GUID-52C00874-C14D-44F6-A89A-CCB5E07FBE3E" title="The DVSYS.DBA_DV_RULE_SET_RULE data dictionary view lists rules that are associated with existing rule sets.">DVSYS.DBA_DV_RULE_SET_RULE View</a>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<p class="subhead3">Example</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">BEGIN
 DBMS_MACADM.DELETE_RULE_FROM_RULE_SET(
  rule_set_name =&gt; &#39;Limit_DBA_Access&#39;, 
  rule_name     =&gt; &#39;Check UPDATE operations&#39;);
END;
/
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DVADM70498"></a><a id="DVADM70499"></a><a id="DVADM70500"></a><a id="DVADM70501"></a><a id="DVADM70497"></a>
<div class="props_rev_3"><a id="GUID-9BE707E1-1357-49F8-904C-AFE55C78C3C6"></a>
<h3 id="DVADM-GUID-9BE707E1-1357-49F8-904C-AFE55C78C3C6" class="sect3">DELETE_RULE_SET Procedure</h3>
<div>
<p>The <code class="codeph">DELETE_RULE_SET</code> procedure deletes a rule set.</p>
<div class="section">
<p class="subhead3">Syntax</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">DBMS_MACADM.DELETE_RULE_SET(
  rule_set_name IN VARCHAR2); 
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Parameters</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-9BE707E1-1357-49F8-904C-AFE55C78C3C6__DELETE_RULE_SETPARAMETER-090F40FC">
<p class="titleintable">Table 14-7 DELETE_RULE_SET Parameter</p>
<table class="cellalignment338" title="DELETE_RULE_SET Parameter" summary="DELETE_RULE_SET">
<thead>
<tr class="cellalignment332">
<th class="cellalignment380" id="d63546e1604">Parameter</th>
<th class="cellalignment381" id="d63546e1607">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment332">
<td class="cellalignment382" id="d63546e1612" headers="d63546e1604">
<p><code class="codeph">rule_set_name</code></p>
</td>
<td class="cellalignment383" headers="d63546e1612 d63546e1607">
<p>Rule set name.</p>
<p>To find existing rule sets in the current database instance, query the <code class="codeph">DVSYS.DBA_DV_RULE_SET</code> view, described in <a href="views.htm#GUID-A7FD62EB-A8E4-4279-A0D5-1677493AC202" title="The DVSYS.DBA_DV_RULE_SET data dictionary view lists the rules sets that have been created.">DVSYS.DBA_DV_RULE_SET View</a>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<p class="subhead3">Example</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">EXEC DBMS_MACADM.DELETE_RULE_SET(&#39;Limit_DBA_Access&#39;); 
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DVADM70503"></a><a id="DVADM70504"></a><a id="DVADM70505"></a><a id="DVADM70506"></a><a id="DVADM70502"></a>
<div class="props_rev_3"><a id="GUID-C2F60720-7668-42A2-8E57-8FDA1CCBB1A9"></a>
<h3 id="DVADM-GUID-C2F60720-7668-42A2-8E57-8FDA1CCBB1A9" class="sect3">RENAME_RULE Procedure</h3>
<div>
<p>The <code class="codeph">RENAME_RULE</code> procedure renames a rule and causes the name change to take effect everywhere the rule is used.</p>
<div class="section">
<p class="subhead3">Syntax</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">DBMS_MACADM.RENAME_RULE(
  rule_name  IN VARCHAR2, 
  new_name   IN VARCHAR2); 
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Parameters</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-C2F60720-7668-42A2-8E57-8FDA1CCBB1A9__RENAME_RULEPARAMETERS-090F446B">
<p class="titleintable">Table 14-8 RENAME_RULE Parameters</p>
<table class="cellalignment338" title="RENAME_RULE Parameters" summary="RENAME_RULE">
<thead>
<tr class="cellalignment332">
<th class="cellalignment450" id="d63546e1745">Parameter</th>
<th class="cellalignment460" id="d63546e1748">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment332">
<td class="cellalignment451" id="d63546e1753" headers="d63546e1745">
<p><code class="codeph">rule_name</code></p>
</td>
<td class="cellalignment461" headers="d63546e1753 d63546e1748">
<p>Current rule name.</p>
<p>To find existing rules in the current database instance, query the <code class="codeph">DVSYS.DBA_DV_RULE</code> view, described in <a href="views.htm#GUID-97C96089-0EE4-4A57-8257-1F9F61606245" title="The DVSYS.DBA_DV_RULE data dictionary view lists the rules that have been defined.">DVSYS.DBA_DV_RULE View</a>.</p>
<p>To find rules that have been associated with rule sets, query <code class="codeph">DVSYS.DBA_DV_RULE_SET_RULE</code>, described in <a href="views.htm#GUID-52C00874-C14D-44F6-A89A-CCB5E07FBE3E" title="The DVSYS.DBA_DV_RULE_SET_RULE data dictionary view lists rules that are associated with existing rule sets.">DVSYS.DBA_DV_RULE_SET_RULE View</a>.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment451" id="d63546e1790" headers="d63546e1745">
<p><code class="codeph">new_name</code></p>
</td>
<td class="cellalignment461" headers="d63546e1790 d63546e1748">
<p>New rule name, up to 128 characters in mixed-case.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<p class="subhead3">Example</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">BEGIN
 DBMS_MACADM.RENAME_RULE(
  rule_name  =&gt; &#39;Check UPDATE operations&#39;, 
  new_name   =&gt; &#39;Check Sector 2 Processes&#39;);
END; 
/
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DVADM70508"></a><a id="DVADM70509"></a><a id="DVADM70510"></a><a id="DVADM70511"></a><a id="DVADM70507"></a>
<div class="props_rev_3"><a id="GUID-B42D559E-3F95-4F0A-82D3-F0BF2F3207DE"></a>
<h3 id="DVADM-GUID-B42D559E-3F95-4F0A-82D3-F0BF2F3207DE" class="sect3">RENAME_RULE_SET Procedure</h3>
<div>
<p>The <code class="codeph">RENAME_RULE_SET</code> procedure renames a rule set and causes the name change to take effect everywhere the rule set is used.</p>
<div class="section">
<p class="subhead3">Syntax</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">DBMS_MACADM.RENAME_RULE_SET(
  rule_set_name IN VARCHAR2, 
  new_name      IN VARCHAR2); 
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Parameters</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-B42D559E-3F95-4F0A-82D3-F0BF2F3207DE__RENAME_RULE_SETPARAMETERS-090F4779">
<p class="titleintable">Table 14-9 RENAME_RULE_SET Parameters</p>
<table class="cellalignment338" title="RENAME_RULE_SET Parameters" summary="RENAME_RULE_SET">
<thead>
<tr class="cellalignment332">
<th class="cellalignment380" id="d63546e1910">Parameter</th>
<th class="cellalignment381" id="d63546e1913">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment332">
<td class="cellalignment382" id="d63546e1918" headers="d63546e1910">
<p><code class="codeph">rule_set_name</code></p>
</td>
<td class="cellalignment383" headers="d63546e1918 d63546e1913">
<p>Current rule set name.</p>
<p>To find existing rule sets in the current database instance, query the <code class="codeph">DVSYS.DBA_DV_RULE_SET</code> view, described in <a href="views.htm#GUID-A7FD62EB-A8E4-4279-A0D5-1677493AC202" title="The DVSYS.DBA_DV_RULE_SET data dictionary view lists the rules sets that have been created.">DVSYS.DBA_DV_RULE_SET View</a>.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment382" id="d63546e1941" headers="d63546e1910">
<p><code class="codeph">new_name</code></p>
</td>
<td class="cellalignment383" headers="d63546e1941 d63546e1913">
<p>New rule set name, up to 128 characters in mixed-case. Spaces are allowed.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<p class="subhead3">Example</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">BEGIN
 DBMS_MACADM.RENAME_RULE_SET(
  rule_set_name =&gt; &#39;Limit_DBA_Access&#39;, 
  new_name      =&gt; &#39;Limit Sector 2 Access&#39;); 
END;
/
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DVADM70517"></a><a id="DVADM70518"></a><a id="DVADM70519"></a><a id="DVADM70520"></a><a id="DVADM70516"></a>
<div class="props_rev_3"><a id="GUID-658C2D27-D1B6-46B6-A7C2-A8D629BC9D0F"></a>
<h3 id="DVADM-GUID-658C2D27-D1B6-46B6-A7C2-A8D629BC9D0F" class="sect3">UPDATE_RULE Procedure</h3>
<div>
<p>The <code class="codeph">UPDATE_RULE</code> procedure updates a rule.</p>
<div class="section">
<p class="subhead3">Syntax</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">DBMS_MACADM.UPDATE_RULE(
  rule_name  IN VARCHAR2, 
  rule_expr  IN VARCHAR2);
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Parameters</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-658C2D27-D1B6-46B6-A7C2-A8D629BC9D0F__UPDATE_RULEPARAMETERS-090F4AE9">
<p class="titleintable">Table 14-10 UPDATE_RULE Parameters</p>
<table class="cellalignment338" title="UPDATE_RULE Parameters" summary="UPDATE_RULE">
<thead>
<tr class="cellalignment332">
<th class="cellalignment410" id="d63546e2060">Parameter</th>
<th class="cellalignment411" id="d63546e2063">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e2068" headers="d63546e2060">
<p><code class="codeph">rule_name</code></p>
</td>
<td class="cellalignment413" headers="d63546e2068 d63546e2063">
<p>Rule name.</p>
<p>To find existing rules in the current database instance, query the <code class="codeph">DVSYS.DBA_DV_RULE</code> view, described in <a href="views.htm#GUID-97C96089-0EE4-4A57-8257-1F9F61606245" title="The DVSYS.DBA_DV_RULE data dictionary view lists the rules that have been defined.">DVSYS.DBA_DV_RULE View</a>.</p>
<p>To find rules that have been associated with rule sets, query <code class="codeph">DVSYS.DBA_DV_RULE_SET_RULE</code>, described in <a href="views.htm#GUID-52C00874-C14D-44F6-A89A-CCB5E07FBE3E" title="The DVSYS.DBA_DV_RULE_SET_RULE data dictionary view lists rules that are associated with existing rule sets.">DVSYS.DBA_DV_RULE_SET_RULE View</a>.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e2105" headers="d63546e2060">
<p><code class="codeph">rule_expr</code></p>
</td>
<td class="cellalignment413" headers="d63546e2105 d63546e2063">
<p>PL/SQL <code class="codeph">BOOLEAN</code> expression.</p>
<p>If the expression contains quotation marks, do not use double quotation marks. Instead, use two single quotation marks. Enclose the entire expression within single quotation marks. For example:</p>
<pre dir="ltr">&#39;TO_CHAR(SYSDATE,&#39;&#39;HH24&#39;&#39;) = &#39;&#39;12&#39;&#39;&#39;
</pre>
<p>See <a href="cfrulset.htm#GUID-AAAFC806-8DB8-45A7-A058-B7CD352B0C50" title="You can create a new rule in Enterprise Manager Cloud Control.">Creating a New Rule</a> for more information on rule expressions.</p>
<p>To find existing rule expressions, query the <code class="codeph">DVSYS.DBA_DV_RULE</code> view.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<p class="subhead3">Example</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">BEGIN
 DBMS_MACADM.UPDATE_RULE(
  rule_name  =&gt; &#39;Check UPDATE operations&#39;, 
  rule_expr  =&gt;&#39;SYS_CONTEXT(&#39;&#39;USERENV&#39;&#39;,&#39;&#39;SESSION_USER&#39;&#39;) = &#39;&#39;SYSADM&#39;&#39; AND
               (
                 UPPER(SYS_CONTEXT(&#39;&#39;USERENV&#39;&#39;,&#39;&#39;MODULE&#39;&#39;)) LIKE &#39;&#39;APPSRVR%&#39;&#39; OR
                 UPPER(SYS_CONTEXT(&#39;&#39;USERENV&#39;&#39;,&#39;&#39;MODULE&#39;&#39;)) LIKE &#39;&#39;DBAPP%&#39;&#39; )&#39;
               );
END;
/
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DVADM70522"></a><a id="DVADM70523"></a><a id="DVADM70524"></a><a id="DVADM70525"></a><a id="DVADM70521"></a>
<div class="props_rev_3"><a id="GUID-6D99458F-A85A-462E-AA1E-B1970A265866"></a>
<h3 id="DVADM-GUID-6D99458F-A85A-462E-AA1E-B1970A265866" class="sect3">UPDATE_RULE_SET Procedure</h3>
<div>
<p>The <code class="codeph">UPDATE_RULE_SET</code> procedure updates a rule set.</p>
<div class="section">
<p class="subhead3">Syntax</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">DBMS_MACADM.UPDATE_RULE_SET(
  rule_set_name    IN VARCHAR2,
  description      IN VARCHAR2, 
  enabled          IN VARCHAR2, 
  eval_options     IN NUMBER, 
  audit_options    IN NUMBER, 
  fail_options     IN NUMBER, 
  fail_message     IN VARCHAR2, 
  fail_code        IN NUMBER, 
  handler_options  IN NUMBER, 
  handler          IN VARCHAR2,
  is_static        IN BOOLEAN DEFAULT FALSE); 
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Parameters</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-6D99458F-A85A-462E-AA1E-B1970A265866__UPDATE_RULE_SETPARAMETERS-090F4DED">
<p class="titleintable">Table 14-11 UPDATE_RULE_SET Parameters</p>
<table class="cellalignment338" title="UPDATE_RULE_SET Parameters" summary="UPDATE_RULE_SET">
<thead>
<tr class="cellalignment332">
<th class="cellalignment410" id="d63546e2244">Parameter</th>
<th class="cellalignment411" id="d63546e2247">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e2252" headers="d63546e2244">
<p><code class="codeph">rule_set_name</code></p>
</td>
<td class="cellalignment413" headers="d63546e2252 d63546e2247">
<p>Rule set name.</p>
<p>To find existing rule sets in the current database instance, query the <code class="codeph">DVSYS.DBA_DV_RULE_SET</code> view, described in <a href="views.htm#GUID-A7FD62EB-A8E4-4279-A0D5-1677493AC202" title="The DVSYS.DBA_DV_RULE_SET data dictionary view lists the rules sets that have been created.">DVSYS.DBA_DV_RULE_SET View</a>.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e2275" headers="d63546e2244">
<p><code class="codeph">description</code></p>
</td>
<td class="cellalignment413" headers="d63546e2275 d63546e2247">
<p>Description of the purpose of the rule set, up to 1024 characters in mixed-case.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e2284" headers="d63546e2244">
<p><code class="codeph">enabled</code></p>
</td>
<td class="cellalignment413" headers="d63546e2284 d63546e2247">
<p><code class="codeph">DBMS_MACUTL.G_YES</code> (Yes) enables rule set checking; <code class="codeph">DBMS_MACUTL.G_NO</code> (No) disables it.</p>
<p>The default for the <code class="codeph">enabled</code> setting is the previously set value, which you can find by querying the <code class="codeph">DVSYS.DBA_DV_RULE_SET</code> data dictionary view.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e2306" headers="d63546e2244">
<p><code class="codeph">eval_options</code></p>
</td>
<td class="cellalignment413" headers="d63546e2306 d63546e2247">
<p>If you plan to assign multiple rules to the rule set, enter one of the following settings:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_EVAL_ALL</code>: All rules in the rule set must evaluate to true for the rule set itself to evaluate to true.</p>
</li>
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_EVAL_ANY</code>: At least one rule in the rule set must evaluate to true for the rule set itself to evaluate to true.</p>
</li>
</ul>
<p>The default for <code class="codeph">eval_options</code> is the previously set value, which you can find by querying the <code class="codeph">DVSYS.DBA_DV_RULE_SET</code> data dictionary view.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e2334" headers="d63546e2244">
<p><code class="codeph">audit_options</code></p>
</td>
<td class="cellalignment413" headers="d63546e2334 d63546e2247">
<p>Select one of the following settings:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_AUDIT_OFF</code>: Disables auditing for the rule set</p>
</li>
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_AUDIT_FAIL</code>: Creates an audit record when a rule set violation occurs</p>
</li>
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_AUDIT_SUCCESS</code>: Creates an audit record for a successful rule set evaluation</p>
</li>
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_AUDIT_FAIL + DBMS_MACUTL.G_RULESET_AUDIT_SUCCESS</code>: Creates an audit record for both successful and failed rule set evaluations</p>
</li>
</ul>
<p>The default for <code class="codeph">audit_options</code> is the previously set value, which you can find by querying the <code class="codeph">DVSYS.DBA_DV_RULE_SET</code> data dictionary view.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e2372" headers="d63546e2244">
<p><code class="codeph">fail_options</code></p>
</td>
<td class="cellalignment413" headers="d63546e2372 d63546e2247">
<p>Options for reporting errors:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_FAIL_SHOW</code>: Shows an error message.</p>
</li>
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_FAIL_SILENT</code>: Does not show an error message.</p>
</li>
</ul>
<p>The default for <code class="codeph">fail_options</code> is the previously set value, which you can find by querying the <code class="codeph">DVSYS.DBA_DV_RULE_SET</code> data dictionary view.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e2400" headers="d63546e2244">
<p><code class="codeph">fail_message</code></p>
</td>
<td class="cellalignment413" headers="d63546e2400 d63546e2247">
<p>Error message for failure, up to 80 characters in mixed-case, to associate with the fail code you specify for <code class="codeph">fail_code</code>.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e2412" headers="d63546e2244">
<p><code class="codeph">fail_code</code></p>
</td>
<td class="cellalignment413" headers="d63546e2412 d63546e2247">
<p>Enter a number in the range of -20000 to -20999 or 20000 to 20999 to associate with the <code class="codeph">fail_message</code> parameter.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e2424" headers="d63546e2244">
<p><code class="codeph">handler_options</code></p>
</td>
<td class="cellalignment413" headers="d63546e2424 d63546e2247">
<p>Select one of the following settings:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_HANDLER_OFF</code>: Disables error handling.</p>
</li>
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_HANDLER_FAIL</code>: Call handler on rule set failure.</p>
</li>
<li>
<p><code class="codeph">DBMS_MACUTL.G_RULESET_HANDLER_SUCCESS</code>: Call handler on rule set success.</p>
</li>
</ul>
<p>The default for <code class="codeph">handler_options</code> is the previously set value, which you can find by querying the <code class="codeph">DVSYS.DBA_DV_RULE_SET</code> data dictionary view.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e2457" headers="d63546e2244">
<p><code class="codeph">handler</code></p>
</td>
<td class="cellalignment413" headers="d63546e2457 d63546e2247">
<p>Name of the PL/SQL function or procedure that defines the custom event handler logic.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment412" id="d63546e2466" headers="d63546e2244">
<p><code class="codeph">is_static</code></p>
</td>
<td class="cellalignment413" headers="d63546e2466 d63546e2247">
<p>Optional. Determines how often a rule set is evaluated when it is accessed by a SQL statement.</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">TRUE</code>: The rule set is evaluated once during the user session. After that, the value is re-used.</p>
</li>
<li>
<p><code class="codeph">FALSE</code>: The rule set evaluated each time a SQL statement accesses it (default).</p>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<p class="subhead3">Example</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">BEGIN
 DBMS_MACADM.UPDATE_RULE_SET(
  rule_set_name    =&gt; &#39;Limit_DBA_Access&#39;, 
  description      =&gt; &#39;DBA access through predefined processes&#39;, 
  enabled          =&gt; DBMS_MACUTL.G_YES,
  eval_options     =&gt; DBMS_MACUTL.G_RULESET_EVAL_ANY,
  audit_options    =&gt; DBMS_MACUTL.G_RULESET_AUDIT_FAIL,
  fail_options     =&gt; DBMS_MACUTL.G_RULESET_FAIL_SHOW,
  fail_message     =&gt; &#39;Access denied!&#39;,
  fail_code        =&gt; 20900,
  handler_options  =&gt; DBMS_MACUTL.G_RULESET_HANDLER_OFF, 
  handler          =&gt; &#39;&#39;,
  is_static        =  TRUE);
END;
/
</pre></div>
<!-- class="section" --></div>
</div>
</div>
<a id="DVADM70946"></a>
<div class="props_rev_3"><a id="GUID-9CC41BCB-1335-4230-8547-977AD105E47B"></a>
<h2 id="DVADM-GUID-9CC41BCB-1335-4230-8547-977AD105E47B" class="sect2">Oracle Database Vault PL/SQL Rule Set Functions</h2>
<div>
<p>Oracle Database Vault provides functions to use in rule sets to inspect the SQL statement that the rule set protects.</p>
<p>For example, if a rule set protects <code class="codeph">SELECT ON HR.EMPLOYEES</code> under a command rule, then you could use these functions to make more informed decisions in the rule expression.</p>
<p><a href="apis_rule_sets.htm#GUID-9CC41BCB-1335-4230-8547-977AD105E47B__INSTALLEDORACLEDATABASEVAULTPLSQLRU-A827EEFE" title="Rule Set Functions">Table 14-12</a> lists the default rule functions.</p>
<div class="tblformal" id="GUID-9CC41BCB-1335-4230-8547-977AD105E47B__INSTALLEDORACLEDATABASEVAULTPLSQLRU-A827EEFE">
<p class="titleintable">Table 14-12 Installed Oracle Database Vault PL/SQL Rule Set Functions</p>
<table class="cellalignment338" title="Installed Oracle Database Vault PL/SQL Rule Set Functions" summary="Rule Set Functions">
<thead>
<tr class="cellalignment332">
<th class="cellalignment398" id="d63546e2601">Rule Set Function</th>
<th class="cellalignment399" id="d63546e2604">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment332">
<td class="cellalignment400" id="d63546e2609" headers="d63546e2601">
<p><a href="apis_rule_sets.htm#GUID-6F9F2F2D-B70A-447F-B576-FAF3B03A23B3" title="The DV_SYSEVENT function returns the system event firing the rule set.">DVSYS.DV_SYSEVENT Function</a></p>
</td>
<td class="cellalignment401" headers="d63546e2609 d63546e2604">
<p>Returns the system event firing the rule set</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment400" id="d63546e2623" headers="d63546e2601">
<p><a href="apis_rule_sets.htm#GUID-F872A37B-B9A5-45EB-B077-07A85C2DC7FF" title="The DV_LOGIN_USER function returns the login user name, in VARCHAR2 data type.">DVSYS.DV_LOGIN_USER Function</a></p>
</td>
<td class="cellalignment401" headers="d63546e2623 d63546e2604">
<p>Returns the login user name</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment400" id="d63546e2640" headers="d63546e2601">
<p><a href="apis_rule_sets.htm#GUID-40395C3C-7E0F-4996-9F9D-7893BC8AB287" title="The DV_INSTANCE_NUM function returns the database instance number, in NUMBER data type.">DVSYS.DV_INSTANCE_NUM Function</a></p>
</td>
<td class="cellalignment401" headers="d63546e2640 d63546e2604">
<p>Returns the database instance number</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment400" id="d63546e2657" headers="d63546e2601">
<p><a href="apis_rule_sets.htm#GUID-22366869-8D6D-4790-AD2D-A83B78D43D44" title="The DV_DATABASE_NAME function returns the database name, in VARCHAR2 data type.">DVSYS.DV_DATABASE_NAME Function</a></p>
</td>
<td class="cellalignment401" headers="d63546e2657 d63546e2604">
<p>Returns the database name</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment400" id="d63546e2674" headers="d63546e2601">
<p><a href="apis_rule_sets.htm#GUID-6D45A09F-D723-4D74-8940-7D12F8A738A9" title="The DV_DICT_OBJ_TYPE function returns the type of the dictionary object on which the database operation occurred.">DVSYS.DV_DICT_OBJ_TYPE Function</a></p>
</td>
<td class="cellalignment401" headers="d63546e2674 d63546e2604">
<p>Returns the type of the dictionary object on which the database operation occurred (for example, table, procedure, view)</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment400" id="d63546e2688" headers="d63546e2601">
<p><a href="apis_rule_sets.htm#GUID-5CF7BEC7-1C86-4B06-BBB7-589C4E044EF9" title="The DV_DICT_OBJ_OWNER function returns the name of the owner of the dictionary object on which the database operation occurred.">DVSYS.DV_DICT_OBJ_OWNER Function</a></p>
</td>
<td class="cellalignment401" headers="d63546e2688 d63546e2604">
<p>Returns the owner of the dictionary object on which the database operation occurred</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment400" id="d63546e2702" headers="d63546e2601">
<p><a href="apis_rule_sets.htm#GUID-51733B80-15EF-4BE2-8894-84751B775B1A" title="The DV_DICT_OBJ_NAME function returns the name of the dictionary object on which the database operation occurred.">DVSYS.DV_DICT_OBJ_NAME Function</a></p>
</td>
<td class="cellalignment401" headers="d63546e2702 d63546e2604">
<p>Returns the name of the dictionary object on which the database operation occurred</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment400" id="d63546e2716" headers="d63546e2601">
<p><a href="apis_rule_sets.htm#GUID-EB19D648-1D2A-48F4-AC2D-CBED52494EB2" title="The DV_SQL_TEXT function returns the first 4000 characters of SQL text of the database statement used in the operation.">DVSYS.DV_SQL_TEXT Function</a></p>
</td>
<td class="cellalignment401" headers="d63546e2716 d63546e2604">
<p>Returns the first 4000 characters of SQL text of the database statement used in the operation</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
<a id="DVADM70949"></a><a id="DVADM70950"></a><a id="DVADM70951"></a><a id="DVADM70948"></a>
<div class="props_rev_3"><a id="GUID-6F9F2F2D-B70A-447F-B576-FAF3B03A23B3"></a>
<h3 id="DVADM-GUID-6F9F2F2D-B70A-447F-B576-FAF3B03A23B3" class="sect3">DVSYS.DV_SYSEVENT Function</h3>
<div>
<p>The <code class="codeph">DV_SYSEVENT</code> function returns the system event firing the rule set.</p>
<div class="section">
<p>The event name is the same as that in the syntax of the SQL statement (for example, <code class="codeph">INSERT</code>, <code class="codeph">CREATE</code>.) The return type is <code class="codeph">VARCHAR2</code>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Syntax</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">DVSYS.DV_SYSEVENT ()
RETURN VARCHAR2;
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Parameters</p>
</div>
<!-- class="section" -->
<div class="section">
<p>None</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Example</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">BEGIN 
 DBMS_MACADM.CREATE_RULE(
  rule_name =&gt; &#39;Get System Event Firing the Maintenance Rule Set&#39;,
  rule_expr =&gt; &#39;DVSYS.DV_SYSEVENT = &#39;&#39;CREATE&#39;&#39;&#39;);
END;
/
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DVADM70953"></a><a id="DVADM70954"></a><a id="DVADM70955"></a><a id="DVADM70952"></a>
<div class="props_rev_3"><a id="GUID-F872A37B-B9A5-45EB-B077-07A85C2DC7FF"></a>
<h3 id="DVADM-GUID-F872A37B-B9A5-45EB-B077-07A85C2DC7FF" class="sect3">DVSYS.DV_LOGIN_USER Function</h3>
<div>
<p>The <code class="codeph">DV_LOGIN_USER</code> function returns the login user name, in <code class="codeph">VARCHAR2</code> data type.</p>
<div class="section">
<p class="subhead3">Syntax</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">DVSYS.DV_LOGIN_USER ()
RETURN VARCHAR2;
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Parameters</p>
</div>
<!-- class="section" -->
<div class="section">
<p>None</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Example</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">BEGIN 
 DBMS_MACADM.CREATE_RULE(
  rule_name =&gt; &#39;Check System Login User Name&#39;,
  rule_expr =&gt; &#39;DVSYS.DV_LOGIN_USER = &#39;&#39;SEBASTIAN&#39;&#39;&#39;);
END;
/
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DVADM70957"></a><a id="DVADM70958"></a><a id="DVADM70959"></a><a id="DVADM70956"></a>
<div class="props_rev_3"><a id="GUID-40395C3C-7E0F-4996-9F9D-7893BC8AB287"></a>
<h3 id="DVADM-GUID-40395C3C-7E0F-4996-9F9D-7893BC8AB287" class="sect3">DVSYS.DV_INSTANCE_NUM Function</h3>
<div>
<p>The <code class="codeph">DV_INSTANCE_NUM</code> function returns the database instance number, in <code class="codeph">NUMBER</code> data type.</p>
<div class="section">
<p class="subhead3">Syntax</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">DVSYS.DV_INSTANCE_NUM ()
RETURN NUMBER;
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Parameters</p>
</div>
<!-- class="section" -->
<div class="section">
<p>None</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Example</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">BEGIN 
 DBMS_MACADM.CREATE_RULE(
  rule_name =&gt; &#39;Check Database Instance Number&#39;,
  rule_expr =&gt; &#39;DVSYS.DV_INSTANCE_NUM BETWEEN 6 AND 9&#39;);
END;
/
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DVADM70961"></a><a id="DVADM70962"></a><a id="DVADM70963"></a><a id="DVADM70960"></a>
<div class="props_rev_3"><a id="GUID-22366869-8D6D-4790-AD2D-A83B78D43D44"></a>
<h3 id="DVADM-GUID-22366869-8D6D-4790-AD2D-A83B78D43D44" class="sect3">DVSYS.DV_DATABASE_NAME Function</h3>
<div>
<p>The <code class="codeph">DV_DATABASE_NAME</code> function returns the database name, in <code class="codeph">VARCHAR2</code> data type.</p>
<div class="section">
<p class="subhead3">Syntax</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">DVSYS.DV_DATABASE_NAME ()
RETURN VARCHAR2;
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Parameters</p>
</div>
<!-- class="section" -->
<div class="section">
<p>None</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Example</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">BEGIN 
 DBMS_MACADM.CREATE_RULE(
  rule_name =&gt; &#39;Check Database Name&#39;,
  rule_expr =&gt; &#39;DVSYS.DV_DATABASE_NAME = &#39;&#39;ORCL&#39;&#39;&#39;);
END;
/
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DVADM70965"></a><a id="DVADM70966"></a><a id="DVADM70967"></a><a id="DVADM70964"></a>
<div class="props_rev_3"><a id="GUID-6D45A09F-D723-4D74-8940-7D12F8A738A9"></a>
<h3 id="DVADM-GUID-6D45A09F-D723-4D74-8940-7D12F8A738A9" class="sect3">DVSYS.DV_DICT_OBJ_TYPE Function</h3>
<div>
<p>The <code class="codeph">DV_DICT_OBJ_TYPE</code> function returns the type of the dictionary object on which the database operation occurred.</p>
<div class="section">
<p>For example, dictionary objects it returns are table, procedure, or view. The return type is <code class="codeph">VARCHAR2</code>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Syntax</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">DVSYS.DV_DICT_OBJ_TYPE ()
RETURN VARCHAR2;
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Parameters</p>
</div>
<!-- class="section" -->
<div class="section">
<p>None</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Example</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">BEGIN 
 DBMS_MACADM.CREATE_RULE(
  rule_name =&gt; &#39;Check Dictionary Object Type&#39;,
  rule_expr =&gt; &#39;DVSYS.DV_DICT_OBJ_TYPE IN (&#39;&#39;TABLE&#39;&#39;, &#39;&#39;VIEW&#39;&#39;)&#39;);
END;
/
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DVADM70969"></a><a id="DVADM70970"></a><a id="DVADM70971"></a><a id="DVADM70968"></a>
<div class="props_rev_3"><a id="GUID-5CF7BEC7-1C86-4B06-BBB7-589C4E044EF9"></a>
<h3 id="DVADM-GUID-5CF7BEC7-1C86-4B06-BBB7-589C4E044EF9" class="sect3">DVSYS.DV_DICT_OBJ_OWNER Function</h3>
<div>
<p>The <code class="codeph">DV_DICT_OBJ_OWNER</code> function returns the name of the owner of the dictionary object on which the database operation occurred.</p>
<div class="section">
<p>The return type is <code class="codeph">VARCHAR2</code>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Syntax</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">DVSYS.DV_DICT_OBJ_OWNER ()
RETURN VARCHAR2;
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Parameters</p>
</div>
<!-- class="section" -->
<div class="section">
<p>None</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Example</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">BEGIN 
 DBMS_MACADM.CREATE_RULE(
  rule_name =&gt; &#39;Check Dictionary Object Owner&#39;,
  rule_expr =&gt; &#39;DVSYS.DV_DICT_OBJ_OWNER = &#39;&#39;JSMITH&#39;&#39;&#39;);
END;
/
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DVADM70973"></a><a id="DVADM70974"></a><a id="DVADM70975"></a><a id="DVADM70972"></a>
<div class="props_rev_3"><a id="GUID-51733B80-15EF-4BE2-8894-84751B775B1A"></a>
<h3 id="DVADM-GUID-51733B80-15EF-4BE2-8894-84751B775B1A" class="sect3">DVSYS.DV_DICT_OBJ_NAME Function</h3>
<div>
<p>The <code class="codeph">DV_DICT_OBJ_NAME</code> function returns the name of the dictionary object on which the database operation occurred.</p>
<div class="section">
<p>The return type is <code class="codeph">VARCHAR2</code>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Syntax</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">DVSYS.DV_DICT_OBJ_NAME ()
RETURN VARCHAR2;
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Parameters</p>
</div>
<!-- class="section" -->
<div class="section">
<p>None</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Example</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">BEGIN 
 DBMS_MACADM.CREATE_RULE(
  rule_name =&gt; &#39;Check Dictionary Object Name&#39;,
  rule_expr =&gt; &#39;DVSYS.DV_DICT_OBJ_NAME = &#39;&#39;SALES&#39;&#39;&#39;);
END;
/
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DVADM70977"></a><a id="DVADM70978"></a><a id="DVADM70979"></a><a id="DVADM70976"></a>
<div class="props_rev_3"><a id="GUID-EB19D648-1D2A-48F4-AC2D-CBED52494EB2"></a>
<h3 id="DVADM-GUID-EB19D648-1D2A-48F4-AC2D-CBED52494EB2" class="sect3">DVSYS.DV_SQL_TEXT Function</h3>
<div>
<p>The <code class="codeph">DV_SQL_TEXT</code> function returns the first 4000 characters of SQL text of the database statement used in the operation.</p>
<div class="section">
<p>The return type is <code class="codeph">VARCHAR2</code>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Syntax</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">DVSYS.DV_SQL_TEXT ()
RETURN VARCHAR2;
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Parameters</p>
</div>
<!-- class="section" -->
<div class="section">
<p>None</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Example</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">BEGIN 
 DBMS_MACADM.CREATE_RULE(
  rule_name =&gt; &#39;Check SQL Text&#39;,
  rule_expr =&gt; &#39;DVSYS.DV_SQL_TEXT = &#39;&#39;SELECT SALARY FROM HR.EMPLOYEES&#39;&#39;&#39;);
END;
/
</pre></div>
<!-- class="section" --></div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment331">
<tr>
<td class="cellalignment359">
<table class="cellalignment336">
<tr>
<td class="cellalignment335"><a href="apis_realms.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment335"><a href="apis_command_rules.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2006, 2016, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment361">
<table class="cellalignment334">
<tr>
<td class="cellalignment335"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment335"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment335"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment335"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment335"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment335"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>