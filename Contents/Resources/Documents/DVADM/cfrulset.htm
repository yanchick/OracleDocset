<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-5965"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Configuring%20Rule%20Sets"></a><title>Configuring Rule Sets</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="description" content="Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object."/>
<meta name="keywords" content="rule sets, command rules, factors, realms, rules, secure application roles, about, default rule sets, initialization parameters, Allow System Parameters default rule set, Oracle Virtual Private Database (VPD), GRANT EXECUTE privileges with Grant VPD Administration default rule set, VPD, database sessions, controlling with Allow Sessions default rule set, managing user accounts and profiles, Can Maintain Accounts/Profiles default rule set, managing user accounts and profiles on own account, Can Maintain Own Accounts default rule set, disabling system features with Disabled default rule set, system features, disabling with Disabled rule set, enabling system features with Enabled default rule set, enabling with Enabled rule set, creating names, naming conventions, rule sets, evaluation options, security attacks, tracking, with rule set auditing, auditing, intruders, using rule sets, fail code, fail message, event handlers, event handler, audit options, options, creating, rules, evaluation of rules, default rules, default, rules, rules in, existing rules, adding to rule set, adding existing rules, deleting from rule set, deleting, rules from, removing from rule set, removing references to objects, deleting, how rule sets work, process flow, nested rules, nested within a rule set, rules that exclude one user, email alert in rule set, tutorials, email alert in rule set, alerts, external network services, fine-grained access to, example using email alert, ORA-24247 error, ORA-06512 error, ORA-47400 error, two-man rule security, two-person integrity (TPI), patches, two-person integrity used for, dual key connection, dual key security, configuring with a rule set, configuring two-person integrity (TPI), guidelines, static evaluation, performance tools, TKPROF utility, Automatic Workload Repository (AWR), Oracle Enterprise Manager Cloud Control, Oracle Enterprise Manager, performance effect, static evaluation for rule sets, reports, data dictionary views, data dictionary views"/>
<meta name="dcterms.created" content="2017-06-05T10:50:14Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Vault Administrator&#39;s Guide"/>
<meta name="dcterms.identifier" content="E49109-12"/>
<meta name="dcterms.isVersionOf" content="DVADM"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2006, 2016, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="cfrealms.htm" title="Previous" type="text/html"/>
<link rel="Next" href="cfcmdaut.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E49109-12.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-41914FF0-20E0-4878-8124-C6C976C19104"></a> <span id="PAGE" style="display:none;">10/34</span> <!-- End Header -->
<a id="DVADM006"></a>
<h1 id="DVADM-GUID-41914FF0-20E0-4878-8124-C6C976C19104" class="sect1"><span class="enumeration_chapter">6</span> Configuring Rule Sets</h1>
<div>
<p>Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="cfrulset.htm#GUID-AAC9F751-6498-4FD0-BB0E-64A6E2BB4E4A" title="A rule set is a collection of one or more rules.">What Are Rule Sets?</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-AE122705-6BAD-4B72-8321-C25187545589" title="Oracle Database Vault provides default rules sets that you can customize for your needs.">Default Rule Sets</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-E2477C97-F87A-4FCF-A8C7-AFACA707B444" title="To create a rule set, you first create the rule set itself, and then you can edit the rule set to associate it with one or more rules.">Creating a Rule Set</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-1DEA3C18-91A0-475A-B001-8DC97372B40F" title="A rule defines the behavior that you want to control; a rule set is a named collection of rules.">Creating a Rule to Add to a Rule Set</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-DB38EF41-865C-41D6-89AD-3C9E32084E82" title="Before you remove a rule set, you should remove the rule set references to Oracle Database Vault components.">Removing Rule Set References to Oracle Database Vault Components</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-24510A4C-39FA-4701-91A2-6E213BD9AE59" title="You can use Enterprise Manager Cloud Control to find reference to the rule set and then delete the rule set.">Deleting a Rule Set</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-BFA919E1-0941-4246-BCA6-D9BC03B1CCB3" title="Understanding how rule sets work helps to create more effective rule sets.">How Rule Sets Work</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-744EC9BB-0804-4F91-BA0F-7D5584EA5B97" title="This tutorial demonstrates how to use the UTL_MAIL PL/SQL package and an access control list to create an email alert for security violations.">Tutorial: Creating an Email Alert for Security Violations</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-D9AA1CCC-065C-4DFE-A078-908123401816" title="This tutorial demonstrates how to use Oracle Database Vault to control the authorization of two users.">Tutorial: Configuring Two-Person Integrity, or Dual Key Security</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-F99FE15B-869E-44CC-A6C4-CC9BACD6BE34" title="Oracle provides guidelines for designing rule sets.">Guidelines for Designing Rule Sets</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-980369CA-666C-4E3A-8F90-572F7F34CEC7" title="The number and complexity of rules can slow database performance.">How Rule Sets Affect Performance</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-FABD139C-F858-40F8-AD5D-6089F517F2E7" title="Oracle Database Vault provides reports and data dictionary views that are useful for analyzing rule sets and the rules within them.">Rule Set and Rule Related Reports and Data Dictionary Views</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-41914FF0-20E0-4878-8124-C6C976C19104__GUID-6A6CB60C-3723-4A33-8080-778AFF7D97C0">
<p class="notep1">See Also:</p>
<p><a href="apis_rule_sets.htm#GUID-66E0EDFE-B4F0-4B5B-9657-B6C4737A37BF" title="You can use the DBMS_MACADM PL/SQL package and a set of Oracle Database Vault rule functions to manage rule sets.">Oracle Database Vault Rule Set APIs</a></p>
</div>
</div>
<a id="DVADM70170"></a>
<div class="props_rev_3"><a id="GUID-AAC9F751-6498-4FD0-BB0E-64A6E2BB4E4A"></a>
<h2 id="DVADM-GUID-AAC9F751-6498-4FD0-BB0E-64A6E2BB4E4A" class="sect2">What Are Rule Sets?</h2>
<div>
<p>A rule set is a collection of one or more rules.</p>
<p>You can associate the rule set with a realm authorization, factor assignment, command rule, or secure application role.</p>
<p>The rule set evaluates to true or false based on the evaluation of each rule it contains and the evaluation type (<span class="italic">All True</span> or <span class="italic">Any True</span>). A rule within a rule set is a PL/SQL expression that evaluates to true or false. You can create a rule and add the rule to multiple rule sets.</p>
<p>You can use rule sets to accomplish the following activities:</p>
<ul style="list-style-type: disc;">
<li>
<p>As a further restriction to realm authorization, to define the conditions under which realm authorization is active</p>
</li>
<li>
<p>To define when to allow a command rule</p>
</li>
<li>
<p>To enable a secure application role</p>
</li>
<li>
<p>To define when to assign the identity of a factor</p>
</li>
</ul>
<p>When you create a rule set, Oracle Database Vault makes it available for selection when you configure the authorization for a realm, command rule, factor, or secure application role.</p>
<p>You can run reports on the rule sets that you create in Oracle Database Vault. See <a href="cfrulset.htm#GUID-FABD139C-F858-40F8-AD5D-6089F517F2E7" title="Oracle Database Vault provides reports and data dictionary views that are useful for analyzing rule sets and the rules within them.">Rule Set and Rule Related Reports and Data Dictionary Views</a> for more information.</p>
<p>This chapter explains how to configure rule sets by using Oracle Database Vault Administrator. To configure rule sets by using the PL/SQL interfaces and packages provided by Oracle Database Vault, refer to <a href="apis_rule_sets.htm#GUID-66E0EDFE-B4F0-4B5B-9657-B6C4737A37BF" title="You can use the DBMS_MACADM PL/SQL package and a set of Oracle Database Vault rule functions to manage rule sets.">Oracle Database Vault Rule Set APIs</a>.</p>
</div>
</div>
<a id="DVADM70171"></a>
<div class="props_rev_3"><a id="GUID-AE122705-6BAD-4B72-8321-C25187545589"></a>
<h2 id="DVADM-GUID-AE122705-6BAD-4B72-8321-C25187545589" class="sect2">Default Rule Sets</h2>
<div>
<p>Oracle Database Vault provides default rules sets that you can customize for your needs.</p>
<div class="section">
<p>You can find a full list of rule sets by querying the <code class="codeph">DVSYS.DBA_DV_RULE_SET</code> data dictionary view. To find rules that are associated with a rule set, query the <code class="codeph">DVSYS.DBA_DV_RULE_SET_RULE</code> data dictionary view.</p>
<p>The default rule sets are as follows:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Allow Fine Grained Control of System Parameters:</span> This rule set provides a very flexible, fine-grained control over initialization parameters that manage system security, dump or destination location, backup and restore settings, optimizer settings, PL/SQL debugging, and security parameters. It affects the following initialization parameters, based on the associated rules of this rule set:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Are System Security Parameters Allowed rule:</span> Cannot set <code class="codeph">O7_DICTIONARY_ACCESSIBILITY</code></p>
</li>
<li>
<p><span class="bold">Are Dump or Dest Parameters Allowed rule:</span> Cannot set the following parameters:</p>
<div class="tblformal" id="GUID-AE122705-6BAD-4B72-8321-C25187545589__GUID-92E14AAF-1BEC-410A-A38D-988BD54A2261">
<table class="cellalignment364" summary="Are Dump or Desk Parameters Allowed rule, from left to right, top to bottom">
<thead>
<tr class="cellalignment332">
<th class="cellalignment438" id="d23765e456">Parameters B-D</th>
<th class="cellalignment438" id="d23765e458">Parameters D-U</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment332">
<td class="cellalignment439" id="d23765e462" headers="d23765e456">
<p><code class="codeph">BACKGROUND_DUMP_DEST</code></p>
</td>
<td class="cellalignment439" headers="d23765e462 d23765e458">
<p><code class="codeph">DB_RECOVERY_FILE_DEST</code></p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment439" id="d23765e471" headers="d23765e456">
<p><code class="codeph">CORE_DUMP_DEST</code></p>
</td>
<td class="cellalignment439" headers="d23765e471 d23765e458">
<p><code class="codeph">DIAGNOSTIC_DEST</code></p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment439" id="d23765e480" headers="d23765e456">
<p><code class="codeph">DUMP_DATAFILE</code></p>
</td>
<td class="cellalignment439" headers="d23765e480 d23765e458">
<p><code class="codeph">LOG_ARCHIVE_MIN_SUCCEED_DEST</code></p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment439" id="d23765e489" headers="d23765e456">
<p><code class="codeph">USER_DUMP_DEST</code></p>
</td>
<td class="cellalignment439" headers="d23765e489 d23765e458">
<p><code class="codeph">LOG_ARCHIVE_TRACE</code></p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment439" id="d23765e498" headers="d23765e456">
<p><code class="codeph">DB_CREATE_ONLINE_LOG_DEST</code></p>
</td>
<td class="cellalignment439" headers="d23765e498 d23765e458">
<p><code class="codeph">USER_DUMP_DEST</code></p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></li>
<li>
<p><span class="bold">Are Backup Restore Parameters Allowed rule:</span> Cannot set <code class="codeph">RECYCLEBIN</code> (but does not prevent disabling the recycle bin)</p>
</li>
<li>
<p><span class="bold">Are Database File Parameters Allowed rule:</span> Cannot set <code class="codeph">CONTROL_FILES</code></p>
</li>
<li>
<p><span class="bold">Are Optimizer Parameters Allowed rule:</span> Can set <code class="codeph">OPTIMIZER_SECURE_VIEW_MERGING = FALSE</code> (but <code class="codeph">TRUE</code> not allowed)</p>
</li>
<li>
<p><span class="bold">Are PL-SQL Parameters Allowed rule:</span> Can set <code class="codeph">PLSQL_DEBUG = FALSE</code> (but <code class="codeph">TRUE</code> not allowed), cannot set <code class="codeph">UTL_FILE_DIR</code></p>
</li>
<li>
<p><span class="bold">Are Security Parameters Allowed rule:</span> Cannot set the following:</p>
<div class="tblformal" id="GUID-AE122705-6BAD-4B72-8321-C25187545589__GUID-1A7ECDA0-75B3-428E-9B2C-63766279E2B4">
<table class="cellalignment364" summary="Are Security Parameters Allowed, left to right, top to bottom">
<thead>
<tr class="cellalignment332">
<th class="cellalignment438" id="d23765e558">Parameters A-A</th>
<th class="cellalignment438" id="d23765e560">Parameters O-S</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment332">
<td class="cellalignment439" id="d23765e564" headers="d23765e558">
<p><code class="codeph">AUDIT_SYS_OPERATIONS = FALSE</code></p>
</td>
<td class="cellalignment439" headers="d23765e564 d23765e560">
<p><code class="codeph">OS_ROLES = TRUE</code></p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment439" id="d23765e573" headers="d23765e558">
<p><code class="codeph">AUDIT_TRAIL = NONE</code> or <code class="codeph">FALSE</code></p>
</td>
<td class="cellalignment439" headers="d23765e573 d23765e560">
<p><code class="codeph">REMOTE_OS_ROLES = TRUE</code></p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment439" id="d23765e585" headers="d23765e558">
<p><code class="codeph">AUDIT_SYSLOG_LEVEL</code></p>
</td>
<td class="cellalignment439" headers="d23765e585 d23765e560">
<p><code class="codeph">SQL92_SECURITY = FALSE</code></p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></li>
</ul>
<p>See <a class="olink REFRN001" target="_blank" href="../REFRN/GUID-6F1C3203-0AA0-4AF1-921C-A027DD7CB6A9.htm#REFRN001"><span><cite>Oracle Database Reference</cite></span></a> for detailed information about initialization parameters.</p>
</li>
<li>
<p><span class="bold">Allow System Parameters:</span> Controls the ability to set system initialization parameters. Since Oracle Database 11<span class="italic">g</span> Release 2 (11.2), the Allow Fine Grained Control of System Parameters rule set has replaced this rule set, but it is still supported for backward compatibility. The Allow System Parameters rule set is not associated with any commands, but its rules are still available and can be used with any custom rule set. Oracle recommends that you use the Allow Fine Grained Control of System Parameters rule set.</p>
</li>
<li>
<p><span class="bold">Can Grant VPD Administration:</span> Controls the ability to grant the <code class="codeph">GRANT EXECUTE</code> or <code class="codeph">REVOKE EXECUTE</code> privileges on the Oracle Virtual Private Database <code class="codeph">DBMS_RLS</code> package, with the <code class="codeph">GRANT</code> and <code class="codeph">REVOKE</code> statements.</p>
</li>
<li>
<p><span class="bold">Allow Sessions:</span> Controls the ability to create a session in the database. This rule set enables you to add rules to control database logins using the CONNECT command rule. The CONNECT command rule is useful to control or limit <code class="codeph">SYSDBA</code> access to programs that require its use. This rule set is not populated.</p>
</li>
<li>
<p><span class="bold">Can Maintain Accounts/Profiles:</span> Controls the roles that manage user accounts and profiles, through the <code class="codeph">CREATE USER</code>, <code class="codeph">DROP USER</code>, <code class="codeph">CREATE PROFILE</code>, <code class="codeph">ALTER PROFILE</code>, or <code class="codeph">DROP PROFILE</code> statements.</p>
</li>
<li>
<p><span class="bold">Can Maintain Own Account:</span> Allows the accounts with the <code class="codeph">DV_ACCTMGR</code> role to manage user accounts and profiles with the <code class="codeph">ALTER USER</code> statement. Also allows individual accounts to change their own password using the <code class="codeph">ALTER USER</code> statement. See <a href="db_objects.htm#GUID-BE9F1454-3798-4B2E-A07D-98A3B6263802" title="The DV_ACCTMGR role is a powerful role, used for accounts management.">DV_ACCTMGR Database Vault Account Manager Role</a> for more information about the <code class="codeph">DV_ACCTMGR</code> role.</p>
</li>
<li>
<p><span class="bold">Disabled:</span> Convenience rule set to quickly disable security configurations like realms, command rules, factors, and secure application roles.</p>
</li>
<li>
<p><span class="bold">Enabled:</span> Convenience rule set to quickly enable system features.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="DVADM70172"></a>
<div class="props_rev_3"><a id="GUID-E2477C97-F87A-4FCF-A8C7-AFACA707B444"></a>
<h2 id="DVADM-GUID-E2477C97-F87A-4FCF-A8C7-AFACA707B444" class="sect2">Creating a Rule Set</h2>
<div>
<p>To create a rule set, you first create the rule set itself, and then you can edit the rule set to associate it with one or more rules.</p>
<div class="section">You can associate a new rule with the rule set, add existing rules to the rule set, or delete a rule association from the rule set.</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>From Cloud Control, log into Oracle Database Vault Administrator as a user who has been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role.</span>
<div>
<p><a href="getting_started.htm#GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" title="Oracle Enterprise Manager Cloud Control (Cloud Control) provides pages for Oracle Database Vault.">Logging into Oracle Database Vault</a> explains how to log in.</p>
</div>
</li>
<li class="stepexpand"><span>In the Administration page, under Database Vault Components, click <span class="bold">Rule Sets</span>.</span></li>
<li class="stepexpand"><span>In the Rule Sets page, click <span class="bold">Create</span> to display the Create Rule Sets page.</span>
<div>
<div class="figure" id="GUID-E2477C97-F87A-4FCF-A8C7-AFACA707B444__GUID-CBBDE68C-61AE-4911-A5BA-01D5305A3DE1"><img width="825" height="341" src="img/GUID-4FAEDD92-8ADE-4BA7-88DA-D709394B61BD-default.gif" alt="Description of GUID-4FAEDD92-8ADE-4BA7-88DA-D709394B61BD-default.gif follows" title="Description of GUID-4FAEDD92-8ADE-4BA7-88DA-D709394B61BD-default.gif follows"/><br/>
<a href="img_text/GUID-4FAEDD92-8ADE-4BA7-88DA-D709394B61BD-default.htm">Description of the illustration GUID-4FAEDD92-8ADE-4BA7-88DA-D709394B61BD-default.gif</a></div>
<!-- class="figure" --></div>
</li>
<li class="stepexpand"><span>In the General page, enter the following information:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Name:</span> Enter a name for the rule set. It can contain up to 90 characters in mixed-case. Spaces are allowed. This attribute is mandatory.</p>
<p>Oracle suggests that you start the name with a verb and complete it with the realm or command rule name to which the rule set is attached. For example:</p>
<pre dir="ltr">Limit SQL*Plus access
</pre></li>
<li>
<p><span class="bold">Description:</span> Enter a description of the functionality for the rule set. It can have up to 1024 characters in mixed-case. This attribute is optional.</p>
<p>You may want to document the business requirement of the rule set. For example:</p>
<pre dir="ltr">Rule to limit access to SQL*Plus
</pre></li>
<li>
<p><span class="bold">Static Rule Set:</span> You can control how often the rule set is evaluated when it is accessed during a user session. A static rule set is evaluated once when accessed for the first time in a user session. After that, the evaluated value is re-used in the user session. On the other hand, a non-static rule set is evaluated every time it is accessed.</p>
</li>
<li>
<p><span class="bold">Status:</span> Select either <span class="bold">Enabled</span> or <span class="bold">Disabled</span> to enable or disable the rule set during run time. This attribute is mandatory.</p>
</li>
<li>
<p><span class="bold">Evaluation Options:</span> If you plan to assign multiple rules to a rule set, then select one of the following settings:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">All True:</span> All rules in the rule set must evaluate to true for the rule set itself to evaluate to true.</p>
</li>
<li>
<p><span class="bold">Any True:</span> At least one rule in the rule set must evaluate to true for the rule set itself to evaluate to true.</p>
</li>
</ul>
</li>
</ul>
</div>
</li>
<li class="stepexpand"><span>Click <span class="bold">Next</span> to display the Rules Associated with Rule Sets page.</span></li>
<li class="stepexpand"><span>Select one of the following options:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Add Existing Rule:</span> Double-click from the list of available rules to move them to the Selected Rules list, and then click <span class="bold">OK</span>.</p>
</li>
<li>
<p><span class="bold">Create Rule:</span> Enter a name and <code class="codeph">WHERE</code> clause expression that evaluates to true or false. Click <span class="bold">OK</span>. See <a href="cfrulset.htm#GUID-1DEA3C18-91A0-475A-B001-8DC97372B40F" title="A rule defines the behavior that you want to control; a rule set is a named collection of rules.">Creating a Rule to Add to a Rule Set</a> for more information.</p>
</li>
</ul>
</div>
</li>
<li class="stepexpand"><span>Click <span class="bold">Next</span> to display the Error handling and Audit options page.</span></li>
<li class="stepexpand"><span>Enter the following information:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Error Handling:</span> Select either <span class="bold">Show Error Message</span> or <span class="bold">Do Not Show Error Message</span>.</p>
<p>An advantage of selecting <span class="bold">Do Not Show Error Message</span> and then enabling auditing is that you can track the activities of a potential intruder. The audit report reveals the activities of the intruder, yet the intruder is unaware that you are doing this because he or she does not see any error messages.</p>
</li>
<li>
<p><span class="bold">Fail Code:</span> Enter a number in the ranges of -20000 to -20999 or 20000 to 20999. The error code is displayed with the <span class="bold">Fail Message</span> (created next) when the rule set evaluates to false or one of the associated rules contains an invalid PL/SQL expression. If you omit this setting, then Oracle Database Vault displays a generic error code.</p>
</li>
<li>
<p><span class="bold">Fail Message:</span> Enter a message, up to 80 characters in mixed-case, to associate with the fail code you specified under <span class="bold">Fail Code</span>. The error message is displayed when the rule set evaluates to false or one of the associated rules contains an invalid PL/SQL expression. If you do not specify an error message, then Oracle Database Vault displays a generic error message.</p>
</li>
<li>
<p><span class="bold">Custom Event Handler Option:</span> Select one of the following options to determine when to run the <span class="bold">Custom Event Handler Logic</span> (created next).</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Handler Disabled:</span> Does not run any custom event method.</p>
</li>
<li>
<p><span class="bold">Execute On Failure:</span> Runs the custom event method when the rule set evaluates to false or one of the associated rules contains an invalid PL/SQL expression.</p>
</li>
<li>
<p><span class="bold">Execute On Success:</span> Runs the custom event method when the rule set evaluates to true.</p>
</li>
</ul>
<p>You can create a custom event method to provide special processing outside the standard Oracle Database Vault rule set auditing features. For example, you can use an event handler to initiate a workflow process or send event information to an external system.</p>
</li>
<li>
<p><span class="bold">Custom Event Handler Logic:</span> Enter a PL/SQL expression up to 255 characters in mixed-case. An expression may include any package procedure or standalone procedure. You can create your own expression or use the PL/SQL interfaces described in <a href="apis_rule_sets.htm#GUID-66E0EDFE-B4F0-4B5B-9657-B6C4737A37BF" title="You can use the DBMS_MACADM PL/SQL package and a set of Oracle Database Vault rule functions to manage rule sets.">Oracle Database Vault Rule Set APIs</a>.</p>
<p>Write the expression as a fully qualified procedure (such as <span class="italic"><code class="codeph">schema</code></span>.<span class="italic"><code class="codeph">procedure_name</code></span>). Do not include any other form of SQL statements. If you are using application package procedures or standalone procedures, you must provide <code class="codeph">DVSYS</code> with the <code class="codeph">EXECUTE</code> privilege on the object. The procedure signature can be in one of the following two forms:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">PROCEDURE</code> <span class="italic"><code class="codeph">my_ruleset_handler(</code></span><span class="italic"><code class="codeph">p_ruleset_name</code></span> <code class="codeph">IN VARCHAR2,</code> <span class="italic"><code class="codeph">p_ruleset_rules</code></span> <code class="codeph">IN BOOLEAN)</code>: Use this form when the name of the rule set and its return value are required in the handler processing.</p>
</li>
<li>
<p><code class="codeph">PROCEDURE</code> <span class="italic"><code class="codeph">my_ruleset_handler</code></span>: Use this form when the name of the rule set and its return value are not required in the handler processing.</p>
</li>
</ul>
<p>Be aware that you cannot use invoker&#39;s rights procedures as event handlers. Doing so can cause the rule set evaluation to fail unexpectedly. Only use definer&#39;s rights procedures as event handlers.</p>
<p>Use the following syntax:</p>
<pre dir="ltr"><span class="italic">myschema</span>.<span class="italic">my_ruleset_handler</span>
</pre></li>
<li>
<p><span class="bold">Audit Options:</span> Select from the following options to generate an audit record for the rule set in a non-unified auditing environment. Oracle Database Vault writes the audit trail to the <code class="codeph">DVSYS.AUDIT_TRAIL$</code> table. (If you have enabled unified auditing, then this setting does not capture audit records. Instead, you must create unified audit policies to capture this information.)</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Audit Disabled:</span> Does not create an audit record under any circumstances.</p>
</li>
<li>
<p><span class="bold">Audit on Success:</span> Creates an audit record when the rule set evaluates to true.</p>
</li>
<li>
<p><span class="bold">Audit On Failure:</span> Creates an audit record when the rule set evaluates to false or one of the associated rules contains an invalid PL/SQL expression.</p>
</li>
<li>
<p><span class="bold">Audit On Success or Failure:</span> Creates an audit record whenever a rule set is evaluated.</p>
</li>
</ul>
</li>
</ul>
</div>
</li>
<li class="stepexpand"><span>Click <span class="bold">Next</span> to display the Review page.</span></li>
<li class="stepexpand"><span>Review the settings, and if they are satisfactory, click <span class="bold">Finish</span>.</span></li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-E2477C97-F87A-4FCF-A8C7-AFACA707B444__GUID-83538986-4E3D-4F9A-B5DA-3C06F335F5DA">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="audplcy.htm#GUID-9E9C7DBE-A8C5-4F02-8E90-F7311D47AB92" title="You can audit activities in Oracle Database Vault, such as changes to policy configurations.">Auditing Oracle Database Vault</a> for more information about audit records in the <code class="codeph">DVSYS.AUDIT_TRAIL$</code> table</p>
</li>
<li>
<p><a class="olink DBSEG419" target="_blank" href="../DBSEG/audit_config.htm#DBSEG419"><span><cite>Oracle Database Security Guide</cite></span></a> for information about creating unified audit policies for Database Vault</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="DVADM70177"></a>
<div class="props_rev_3"><a id="GUID-1DEA3C18-91A0-475A-B001-8DC97372B40F"></a>
<h2 id="DVADM-GUID-1DEA3C18-91A0-475A-B001-8DC97372B40F" class="sect2">Creating a Rule to Add to a Rule Set</h2>
<div>
<p>A rule defines the behavior that you want to control; a rule set is a named collection of rules.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="cfrulset.htm#GUID-FDD7A2C2-4E6A-4D84-828C-7040F4B297DA" title="You can create rules during the rule set creation process, or independently of it.">About Creating Rules</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-A5550945-496A-411D-922F-B4BFDEA85FD9" title="Default rules are rules that have commonly used behavior, such as checking if an action evaluates to true or false.">Default Rules</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-AAAFC806-8DB8-45A7-A058-B7CD352B0C50" title="You can create a new rule in Enterprise Manager Cloud Control.">Creating a New Rule</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-2D82F552-0D94-44B8-9F81-2F42E0EAA4FD" title="After you have created one or more rules, you can use Enterprise Manager Cloud Control to add to a rule set.">Adding Existing Rules to a Rule Set</a></p>
</li>
</ul>
</div>
<a id="DVADM71223"></a>
<div class="props_rev_3"><a id="GUID-FDD7A2C2-4E6A-4D84-828C-7040F4B297DA"></a>
<h3 id="DVADM-GUID-FDD7A2C2-4E6A-4D84-828C-7040F4B297DA" class="sect3">About Creating Rules</h3>
<div>
<p>You can create rules during the rule set creation process, or independently of it.</p>
<p>After you create the rule, you can associate a rule set with one or more additional rules.</p>
<p>If you create a new rule during the rule set creation process, the rule is automatically added to the current rule set. You also can add existing rules to the rule set. Alternatively, you can omit adding rules to the rule set and use it as a template for rule sets you may want to create in the future.</p>
<p>You can add as many rules that you want to a rule set, but for better design and performance, you should keep the rule sets simple. See <a href="cfrulset.htm#GUID-F99FE15B-869E-44CC-A6C4-CC9BACD6BE34" title="Oracle provides guidelines for designing rule sets.">Guidelines for Designing Rule Sets</a> for additional advice.</p>
<p>The rule set evaluation depends on the evaluation of its rules using the Evaluation Options (<span class="bold">All True</span> or <span class="bold">Any True</span>). If a rule set is disabled, Oracle Database Vault evaluates the rule set to true without evaluating its rules.</p>
<div class="infoboxnotealso" id="GUID-FDD7A2C2-4E6A-4D84-828C-7040F4B297DA__GUID-E89338EC-694E-4723-9CEA-FF9F04F96793">
<p class="notep1">See Also:</p>
<a href="cfrulset.htm#GUID-BFA919E1-0941-4246-BCA6-D9BC03B1CCB3" title="Understanding how rule sets work helps to create more effective rule sets.">How Rule Sets Work</a> for information on how rules are evaluated, how to nest rules, and how to create rules that exclude a particular user, such as a privileged user</div>
</div>
</div>
<a id="DVADM71280"></a><a id="DVADM71279"></a>
<div class="props_rev_3"><a id="GUID-A5550945-496A-411D-922F-B4BFDEA85FD9"></a>
<h3 id="DVADM-GUID-A5550945-496A-411D-922F-B4BFDEA85FD9" class="sect3">Default Rules</h3>
<div>
<p>Default rules are rules that have commonly used behavior, such as checking if an action evaluates to true or false.</p>
<div class="section">
<p>You can find a full list of rules by querying the <code class="codeph">DVSYS.DBA_DV_RULE</code> data dictionary view.</p>
<p><a href="cfrulset.htm#GUID-A5550945-496A-411D-922F-B4BFDEA85FD9__CHDGGDFC" title="Describes default rules">Table 6-1</a> lists the default Oracle Database rules.</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-A5550945-496A-411D-922F-B4BFDEA85FD9__CHDGGDFC">
<p class="titleintable">Table 6-1 Default Oracle Database Vault Rules</p>
<table class="cellalignment338" title="Default Oracle Database Vault Rules" summary="Describes default rules">
<thead>
<tr class="cellalignment332">
<th class="cellalignment371" id="d23765e1487">Rule</th>
<th class="cellalignment372" id="d23765e1490">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1495" headers="d23765e1487">
<p>Are Backup Restore Parameters Allowed</p>
</td>
<td class="cellalignment374" headers="d23765e1495 d23765e1490">
<p>Checks if the current SQL statement attempts to turn on the <code class="codeph">RECYCLEBIN</code> parameter</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1505" headers="d23765e1487">
<p>Are Database File Parameters Allowed</p>
</td>
<td class="cellalignment374" headers="d23765e1505 d23765e1490">
<p>Checks if the current SQL statement attempts to alter control file related configuration</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1512" headers="d23765e1487">
<p>Are Dump or Dest Parameters Allowed</p>
</td>
<td class="cellalignment374" headers="d23765e1512 d23765e1490">
<p>Checks if the current SQL statement attempts to alter initialization parameters related to the size limit or destination of dump</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1519" headers="d23765e1487">
<p>Are Optimizer Parameters Allowed</p>
</td>
<td class="cellalignment374" headers="d23765e1519 d23765e1490">
<p>Checks if the current SQL statement attempts to alter the setting for the <code class="codeph">OPTIMIZER_SECURE_VIEW_MERGING</code> parameter</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1529" headers="d23765e1487">
<p>Are PL-SQL Parameters Allowed</p>
</td>
<td class="cellalignment374" headers="d23765e1529 d23765e1490">
<p>Checks if the current SQL statement attempts to alter the following initialization parameters:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">UTL_FILE_DIR</code></p>
</li>
<li>
<p><code class="codeph">PLSQL_DEBUG</code></p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1545" headers="d23765e1487">
<p>Are Security Parameters Allowed</p>
</td>
<td class="cellalignment374" headers="d23765e1545 d23765e1490">
<p>Checks if there is an attempt to disable the following initialization parameters:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">AUDIT_SYS_OPERATIONS</code></p>
</li>
<li>
<p><code class="codeph">AUDIT_TRAIL</code></p>
</li>
<li>
<p><code class="codeph">AUDIT_SYSLOG_LEVEL</code></p>
</li>
<li>
<p><code class="codeph">SQL92_SECURITY</code></p>
</li>
</ul>
<p>Note that if you have enabled unified auditing, then the <code class="codeph">AUDIT_SYS_OPERATIONS</code>, <code class="codeph">AUDIT_TRAIL</code>, and <code class="codeph">AUDIT_SYSLOG_LEVEL</code> parameters have no effect.</p>
<p>This rule prevents any attempt to enable the following parameters:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">OS_ROLES</code></p>
</li>
<li>
<p><code class="codeph">REMOTE_OS_ROLES</code></p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1591" headers="d23765e1487">
<p>Are System Security Parameters Allowed</p>
</td>
<td class="cellalignment374" headers="d23765e1591 d23765e1490">
<p>Prevents modification of the following parameters:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">O7_DICTIONARY_ACCESSIBILITY</code></p>
</li>
<li>
<p><code class="codeph">DYNAMIC_RLS_POLICIES</code></p>
</li>
<li>
<p><code class="codeph">_SYSTEM_TRIG_ENABLED</code></p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1611" headers="d23765e1487">
<p>False</p>
</td>
<td class="cellalignment374" headers="d23765e1611 d23765e1490">
<p>Evaluates to <code class="codeph">FALSE</code></p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1620" headers="d23765e1487">
<p>Is Alter DVSYS Allowed</p>
</td>
<td class="cellalignment374" headers="d23765e1620 d23765e1490">
<p>Checks if the logged-in user can execute the <code class="codeph">ALTER USER</code> statement on other users successfully</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1630" headers="d23765e1487">
<p>Is Database Administrator</p>
</td>
<td class="cellalignment374" headers="d23765e1630 d23765e1490">
<p>Checks if a user has been granted the <code class="codeph">DBA</code> role</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1640" headers="d23765e1487">
<p>Is Drop User Allowed</p>
</td>
<td class="cellalignment374" headers="d23765e1640 d23765e1490">
<p>Checks if the logged in user can drop users</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1648" headers="d23765e1487">
<p>Is First Day of Month</p>
</td>
<td class="cellalignment374" headers="d23765e1648 d23765e1490">
<p>Checks if the specified date is the first day of the month</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1655" headers="d23765e1487">
<p>Is Label Administrator</p>
</td>
<td class="cellalignment374" headers="d23765e1655 d23765e1490">
<p>Checks if the user has been granted the <code class="codeph">LBAC_DBA</code> role</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1665" headers="d23765e1487">
<p>Is Last Day of Month</p>
</td>
<td class="cellalignment374" headers="d23765e1665 d23765e1490">
<p>Checks if the specified date is the last day of the month</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1672" headers="d23765e1487">
<p>Is _dynamic_rls_init Parameters Allowed</p>
</td>
<td class="cellalignment374" headers="d23765e1672 d23765e1490">
<p>Prevent modification of the <code class="codeph">DYNAMIC_RLS_POLICIES</code> parameter</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1682" headers="d23765e1487">
<p>Is SYS or SYSTEM User</p>
</td>
<td class="cellalignment374" headers="d23765e1682 d23765e1490">
<p>Checks if the user is <code class="codeph">SYS</code> or <code class="codeph">SYSTEM</code></p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1694" headers="d23765e1487">
<p>Is Security Administrator</p>
</td>
<td class="cellalignment374" headers="d23765e1694 d23765e1490">
<p>Checks if a user has been granted the <code class="codeph">DV_ADMIN</code> role</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1704" headers="d23765e1487">
<p>Is Security Owner</p>
</td>
<td class="cellalignment374" headers="d23765e1704 d23765e1490">
<p>Checks if a user has been granted the <code class="codeph">DV_OWNER</code> role</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1714" headers="d23765e1487">
<p>Is User Manager</p>
</td>
<td class="cellalignment374" headers="d23765e1714 d23765e1490">
<p>Checks if a user has been granted the <code class="codeph">DV_ACCTMGR</code> role</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1724" headers="d23765e1487">
<p>Is _system_trig_enabled Parameters Allowed</p>
</td>
<td class="cellalignment374" headers="d23765e1724 d23765e1490">
<p>Checks if the user tries to modify the following system parameters, but in database recovery operations, this rule permits these parameters to be changed.</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">AUDIT_SYS_OPERATIONS</code>: Prevents users from setting it to <code class="codeph">FALSE</code></p>
</li>
<li>
<p><code class="codeph">AUDIT_TRAIL</code>: Prevents users from setting it to <code class="codeph">NONE</code> or <code class="codeph">FALSE</code></p>
</li>
<li>
<p><code class="codeph">AUDIT_SYSLOG_LEVEL</code>: Blocks all operations on this parameter</p>
</li>
<li>
<p><code class="codeph">CONTROL_FILES</code>: Blocks all operations</p>
</li>
<li>
<p><code class="codeph">OPTIMIZER_SECURE_VIEW_MERGING</code>: Prevents users from setting it to <code class="codeph">TRUE</code></p>
</li>
<li>
<p><code class="codeph">OS_ROLES</code>: Prevents users from setting it to <code class="codeph">TRUE</code></p>
</li>
<li>
<p><code class="codeph">PLSQL_DEBUG</code>: Prevents users from setting it to <code class="codeph">ON</code></p>
</li>
<li>
<p><code class="codeph">RECYCLEBIN</code>: Prevents users from setting it to <code class="codeph">ON</code></p>
</li>
<li>
<p><code class="codeph">REMOTE_OS_ROLES</code>: Prevents users from setting it to <code class="codeph">TRUE</code></p>
</li>
<li>
<p><code class="codeph">SQL92_SECURITY</code>: Prevents users from setting it to <code class="codeph">FALSE</code></p>
</li>
<li>
<p><code class="codeph">UTL_FILE_DIR</code>: Blocks all operations on this parameter</p>
</li>
</ul>
<p>Note that if you have enabled unified auditing, then the <code class="codeph">AUDIT_SYS_OPERATIONS</code>, <code class="codeph">AUDIT_TRAIL</code>, and <code class="codeph">AUDIT_SYSLOG_LEVEL</code> parameters have no effect.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1817" headers="d23765e1487">
<p>Is o7_dictionary_accessibility Parameters Allowed</p>
</td>
<td class="cellalignment374" headers="d23765e1817 d23765e1490">
<p>Checks if current SQL statement attempts to alter the setting of the <code class="codeph">O7_DICTIONARY_ACCESSIBILITY</code> parameter</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1827" headers="d23765e1487">
<p>Login User Is Object User</p>
</td>
<td class="cellalignment374" headers="d23765e1827 d23765e1490">
<p>Checks if the logged in user is the same as the user about to be altered by the current SQL statement</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1835" headers="d23765e1487">
<p>No Exempt Access Policy Role</p>
</td>
<td class="cellalignment374" headers="d23765e1835 d23765e1490">
<p>Checks if the user has been granted the <code class="codeph">EXEMPT ACCESS POLICY</code> role or is user <code class="codeph">SYS</code></p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1847" headers="d23765e1487">
<p>Not Export Session</p>
</td>
<td class="cellalignment374" headers="d23765e1847 d23765e1490">
<p>Obsolete</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d23765e1854" headers="d23765e1487">
<p>True</p>
</td>
<td class="cellalignment374" headers="d23765e1854 d23765e1490">
<p>Evaluates to <code class="codeph">TRUE</code></p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="DVADM70178"></a>
<div class="props_rev_3"><a id="GUID-AAAFC806-8DB8-45A7-A058-B7CD352B0C50"></a>
<h3 id="DVADM-GUID-AAAFC806-8DB8-45A7-A058-B7CD352B0C50" class="sect3">Creating a New Rule</h3>
<div>
<p>You can create a new rule in Enterprise Manager Cloud Control.</p>
<ol>
<li class="stepexpand"><span>From Cloud Control, log into Oracle Database Vault Administrator as a user who has been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role.</span>
<div>
<p><a href="getting_started.htm#GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" title="Oracle Enterprise Manager Cloud Control (Cloud Control) provides pages for Oracle Database Vault.">Logging into Oracle Database Vault</a> explains how to log in.</p>
</div>
</li>
<li class="stepexpand"><span>In the Administration page, under Database Vault Components, click <span class="bold">Rules</span>.</span></li>
<li class="stepexpand"><span>Click the <span class="bold">Create</span> button.</span></li>
<li class="stepexpand"><span>In the Create Rule page, enter the following settings:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Name:</span> Enter a name for the rule. Use up to 90 characters in mixed-case.</p>
<p>Oracle suggests that you start the name with a verb and complete the name with the purpose of the rule. For example:</p>
<pre dir="ltr">Prevent non-admin access to SQL*Plus
</pre>
<p>Because rules do not have a <span class="bold">Description</span> field, make the name explicit but be sure to not exceed over 90 characters.</p>
</li>
<li>
<p><span class="bold">Rule Expression:</span> Enter a PL/SQL expression that fits the following requirements:</p>
<ul style="list-style-type: disc;">
<li>
<p>It is valid in a SQL <code class="codeph">WHERE</code> clause.</p>
</li>
<li>
<p>It can be a freestanding and valid PL/SQL Boolean expression such as the following:</p>
<pre dir="ltr">TO_CHAR(SYSDATE,&#39;HH24&#39;) = &#39;12&#39;
</pre></li>
<li>
<p>It must evaluate to a Boolean (<code class="codeph">TRUE</code> or <code class="codeph">FALSE</code>) value.</p>
</li>
<li>
<p>It must be no more than 1024 characters long.</p>
</li>
<li>
<p>It can contain existing and compiled PL/SQL functions from the current database instance. Ensure that these are fully qualified functions (such as <span class="italic"><code class="codeph">schema</code></span>. <span class="italic"><code class="codeph">function_name</code></span>). Do not include any other form of SQL statements.</p>
<p>Be aware that you cannot use invoker&#39;s rights procedures with rule expressions. Doing so will cause the rule evaluation to fail unexpectedly. Only use definer&#39;s rights procedures with rule expressions.</p>
<p>If you want to use application package functions or standalone functions, you must grant the <code class="codeph">DVSYS</code> account the <code class="codeph">EXECUTE</code> privilege on the function. Doing so reduces the chances of errors when you add new rules.</p>
</li>
<li>
<p>Ensure that the rule works. You can test the syntax by running the following statement in SQL*Plus:</p>
<pre dir="ltr">SELECT <span class="italic">rule_expression</span> FROM DUAL;
</pre>
<p>For example, suppose you have created the following the rule expression:</p>
<pre dir="ltr">SYS_CONTEXT(&#39;USERENV&#39;,&#39;SESSION_USER&#39;) != &#39;TSMITH&#39;
</pre>
<p>You could test this expression as follows:</p>
<pre dir="ltr">SELECT SYS_CONTEXT(&#39;USERENV&#39;,&#39;SESSION_USER&#39;) FROM DUAL;
</pre>
<p>For the Boolean example listed earlier, you would enter the following:</p>
<pre dir="ltr">SELECT TO_CHAR(SYSDATE,&#39;HH24&#39;)FROM DUAL;
</pre></li>
</ul>
<div class="infoboxnotealso" id="GUID-AAAFC806-8DB8-45A7-A058-B7CD352B0C50__GUID-3009FCDB-5371-4057-91D1-D35ADB372B58">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="apis_rule_sets.htm#GUID-9CC41BCB-1335-4230-8547-977AD105E47B" title="Oracle Database Vault provides functions to use in rule sets to inspect the SQL statement that the rule set protects.">Oracle Database Vault PL/SQL Rule Set Functions</a></p>
</li>
<li>
<p><a href="apis_rule_sets.htm#GUID-1B24D370-46E3-445E-91CC-8E621F5E94CB" title="The DBMS_MACADM rule set procedures enable you to configure both rule sets and individual rules that go within these rule sets.">DBMS_MACADM Rule Set Procedures</a></p>
</li>
<li>
<p><a href="apis_dbms_macutl.htm#GUID-5A0CB405-9A3C-48ED-B18F-3A8013D436E3" title="Oracle Database Vault provides a set of utility APIs in the DBMS_MACUTL PL/SQL package.">Oracle Database Vault Utility APIs</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li class="stepexpand"><span>Click <span class="bold">OK</span>.</span></li>
</ol>
</div>
</div>
<a id="DVADM70181"></a>
<div class="props_rev_3"><a id="GUID-2D82F552-0D94-44B8-9F81-2F42E0EAA4FD"></a>
<h3 id="DVADM-GUID-2D82F552-0D94-44B8-9F81-2F42E0EAA4FD" class="sect3">Adding Existing Rules to a Rule Set</h3>
<div>
<p>After you have created one or more rules, you can use Enterprise Manager Cloud Control to add to a rule set.</p>
<ol>
<li class="stepexpand"><span>From Cloud Control, log into Oracle Database Vault Administrator as a user who has been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role.</span>
<div>
<p><span class="q">&#34;<a href="getting_started.htm#GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" title="Oracle Enterprise Manager Cloud Control (Cloud Control) provides pages for Oracle Database Vault.">Logging into Oracle Database Vault</a>&#34;</span> explains how to log in.</p>
</div>
</li>
<li class="stepexpand"><span>In the Administration page, under Database Vault Components, click <span class="bold">Rule Sets</span>.</span></li>
<li class="stepexpand"><span>Select the rule set to which you want to add an existing rule, and then click <span class="bold">Edit</span>.</span></li>
<li class="stepexpand"><span>Click <span class="bold">Next</span> until you reach the Rules Associated with Rule Sets page.</span></li>
<li class="stepexpand"><span>Click <span class="bold">Add Existing Rule</span> to display the Add Existing Rules dialog box.</span></li>
<li class="stepexpand"><span>In the Add Existing Rules page, select the rules you want, and then click <span class="bold">Move</span> (or <span class="bold">Move All</span>, if you want all of them) to move them to the Selected Rules list.</span>
<div>
<p>You can select multiple rules by holding down the <span class="bold">Ctrl</span> key as you click each rule.</p>
</div>
</li>
<li class="stepexpand"><span>Click <span class="bold">OK</span>.</span></li>
<li class="stepexpand"><span>Click <span class="bold">Done</span>, then click <span class="bold">Finish</span>.</span></li>
</ol>
</div>
</div>
<a id="DVADM71224"></a>
<div class="props_rev_3"><a id="GUID-D22EB64B-F62F-4747-B218-FE1C7C3BC709"></a>
<h3 id="DVADM-GUID-D22EB64B-F62F-4747-B218-FE1C7C3BC709" class="sect3">Removing a Rule from a Rule Set</h3>
<div>
<p>Before you remove a rule from a rule set, you can locate the various references to it using Cloud Control.</p>
<div class="section">
<p>See <a href="views.htm#GUID-C0CEF4FC-DB4C-4AD5-9671-C0861A647183" title="You can find information about the Oracle Database Vault configuration settings by querying the Database Vault-specific data dictionary views.">Oracle Database Vault Data Dictionary Views</a> for more information about Oracle Database Vault views.</p>
<p>To remove a rule from a rule set:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>From Cloud Control, log into Oracle Database Vault Administrator as a user who has been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role.</span>
<div>
<p><a href="getting_started.htm#GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" title="Oracle Enterprise Manager Cloud Control (Cloud Control) provides pages for Oracle Database Vault.">Logging into Oracle Database Vault</a> explains how to log in.</p>
</div>
</li>
<li class="stepexpand"><span>In the Administration page, under Database Vault Components, click <span class="bold">Rule Sets</span>.</span></li>
<li class="stepexpand"><span>Select the rule set to which you want to add an existing rule, and then click <span class="bold">Edit</span>.</span></li>
<li class="stepexpand"><span>Click <span class="bold">Next</span> until you reach the Rules Associated with Rule Sets page.</span></li>
<li class="stepexpand"><span>Select the rule you want to delete and click <span class="bold">Remove</span>.</span></li>
<li class="stepexpand"><span>Click <span class="bold">Done</span>, then click <span class="bold">Finish</span>.</span></li>
</ol>
<div class="section">
<p>After you remove the rule from the rule set, the rule still exists. If you want, you can associate it with other rule sets. If you want to delete the rule, you can do so from the Rules page.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="DVADM71225"></a>
<div class="props_rev_3"><a id="GUID-DB38EF41-865C-41D6-89AD-3C9E32084E82"></a>
<h2 id="DVADM-GUID-DB38EF41-865C-41D6-89AD-3C9E32084E82" class="sect2">Removing Rule Set References to Oracle Database Vault Components</h2>
<div>
<p>Before you remove a rule set, you should remove the rule set references to Oracle Database Vault components.</p>
<ol>
<li class="stepexpand"><span>From Cloud Control, log into Oracle Database Vault Administrator as a user who has been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role.</span>
<div>
<p><a href="getting_started.htm#GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" title="Oracle Enterprise Manager Cloud Control (Cloud Control) provides pages for Oracle Database Vault.">Logging into Oracle Database Vault</a> explains how to log in.</p>
</div>
</li>
<li class="stepexpand"><span>Find the references to the rule set that you want to delete.</span>
<div>
<p>In the Rule Sets page, select the rule set and then click the <span class="bold">View</span> button (but not the <span class="bold">View</span> menu). In the View Rule Set page, check the Ruleset Usages area for the references to the rule set that you want to remove. Click <span class="bold">OK</span>.</p>
</div>
</li>
<li class="stepexpand"><span>In the Administration page, under Database Vault Components, select the component that contains the reference to the rule set (such as <span class="bold">Realms</span>).</span></li>
<li class="stepexpand"><span>Select the object, and then click <span class="bold">Edit</span>.</span></li>
<li class="stepexpand"><span>Click <span class="bold">Next</span> until you reach the authorizations page.</span></li>
<li class="stepexpand"><span>Select the authorization with the rule set and then click <span class="bold">Edit</span>, and then remove the referenced object.</span></li>
<li class="stepexpand"><span>Click <span class="bold">Done</span>, then click <span class="bold">Finish</span>.</span></li>
</ol>
</div>
</div>
<a id="DVADM70182"></a>
<div class="props_rev_3"><a id="GUID-24510A4C-39FA-4701-91A2-6E213BD9AE59"></a>
<h2 id="DVADM-GUID-24510A4C-39FA-4701-91A2-6E213BD9AE59" class="sect2">Deleting a Rule Set</h2>
<div>
<p>You can use Enterprise Manager Cloud Control to find reference to the rule set and then delete the rule set.</p>
<ol>
<li class="stepexpand"><span>From Cloud Control, log into Oracle Database Vault Administrator as a user who has been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role.</span>
<div>
<p><a href="getting_started.htm#GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" title="Oracle Enterprise Manager Cloud Control (Cloud Control) provides pages for Oracle Database Vault.">Logging into Oracle Database Vault</a> explains how to log in.</p>
</div>
</li>
<li class="stepexpand"><span>Ensure that there are no references to the rule set.</span>
<div>
<p>Before you can delete a rule set, you must remove references to this rule set.</p>
<p>See <a href="cfrulset.htm#GUID-DB38EF41-865C-41D6-89AD-3C9E32084E82" title="Before you remove a rule set, you should remove the rule set references to Oracle Database Vault components.">Removing Rule Set References to Oracle Database Vault Components</a>.</p>
</div>
</li>
<li class="stepexpand"><span>Select the rule set that you want to remove and click <span class="bold">Delete</span>.</span></li>
<li class="stepexpand"><span>In the Confirmation window, click <span class="bold">Yes</span>.</span>
<div>
<p>The rule set is deleted. Optionally, you can choose to remove the existing associations with rules before deleting the rule set.</p>
</div>
</li>
</ol>
</div>
</div>
<a id="DVADM70183"></a>
<div class="props_rev_3"><a id="GUID-BFA919E1-0941-4246-BCA6-D9BC03B1CCB3"></a>
<h2 id="DVADM-GUID-BFA919E1-0941-4246-BCA6-D9BC03B1CCB3" class="sect2">How Rule Sets Work</h2>
<div>
<p>Understanding how rule sets work helps to create more effective rule sets.</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="cfrulset.htm#GUID-5A6D122C-4DB2-4DED-85EC-E8D42657622E" title="Oracle Database Vault evaluates the rules within a rule set as a collection of expressions.">How Oracle Database Vault Evaluates Rules</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-C54D769A-258E-4226-9AF2-37DF33A29C50" title="You can nest one or more rules within the rule set.">Nested Rules within a Rule Set</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-D0169640-4949-4726-84AB-3656B20A03BF" title="You can also create rules to apply to everyone except one user (for example, a privileged user).">Creating Rules to Apply to Everyone Except One User</a></p>
</li>
</ul>
</div>
<a id="DVADM70184"></a>
<div class="props_rev_3"><a id="GUID-5A6D122C-4DB2-4DED-85EC-E8D42657622E"></a>
<h3 id="DVADM-GUID-5A6D122C-4DB2-4DED-85EC-E8D42657622E" class="sect3">How Oracle Database Vault Evaluates Rules</h3>
<div>
<p>Oracle Database Vault evaluates the rules within a rule set as a collection of expressions.</p>
<p>If you have set <span class="bold">Evaluation Options</span> to <span class="bold">All True</span> and if a rule evaluates to false, then the evaluation stops at that point, instead of attempting to evaluate the rest of the rules in the rule set. Similarly, if <span class="bold">Evaluation Options</span> is set to <span class="bold">Any True</span> and if a rule evaluates to true, the evaluation stops at that point. If a rule set is disabled, Oracle Database Vault evaluates it to true without evaluating its rules.</p>
</div>
</div>
<a id="DVADM70186"></a>
<div class="props_rev_3"><a id="GUID-C54D769A-258E-4226-9AF2-37DF33A29C50"></a>
<h3 id="DVADM-GUID-C54D769A-258E-4226-9AF2-37DF33A29C50" class="sect3">Nested Rules within a Rule Set</h3>
<div>
<p>You can nest one or more rules within the rule set.</p>
<p>For example, suppose you want to create a nested rule, Is Corporate Network During Maintenance, that performs the following two tasks:</p>
<ul style="list-style-type: disc;">
<li>
<p>It limits table modifications only when the database session originates within the corporate network.</p>
</li>
<li>
<p>It restricts table modifications during the system maintenance window scheduled between 10:00 p.m. and 10:59 p.m.</p>
</li>
</ul>
<p>The rule definition would be as follows:</p>
<pre dir="ltr">DVF.F$NETWORK = &#39;Corporate&#39; AND TO_CHAR(SYSDATE,&#39;HH24&#39;) between &#39;22&#39; AND &#39;23&#39;
</pre>
<p>You can create it using a factor function. See <a href="apis_factors.htm#GUID-364245B9-C339-488A-8D49-B8B01B667857" title="Oracle Database Vault maintains the DVF schema functions when you use the DBMS_MACADM PL/SQL package to manage the various factors.">Oracle Database Vault DVF PL/SQL Factor Functions</a> for more information. <a href="cfgfact.htm#GUID-26DF59FF-D0BF-496A-8D5B-6B2B6AC99822" title="Factors enable you to base Database Vault restrictions on attributes such as a client IP address or a domain.">Configuring Factors</a> explains how to create factors.</p>
</div>
</div>
<a id="DVADM70187"></a>
<div class="props_rev_3"><a id="GUID-D0169640-4949-4726-84AB-3656B20A03BF"></a>
<h3 id="DVADM-GUID-D0169640-4949-4726-84AB-3656B20A03BF" class="sect3">Creating Rules to Apply to Everyone Except One User</h3>
<div>
<p>You can also create rules to apply to everyone <span class="italic">except</span> one user (for example, a privileged user).</p>
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>To create a rule that excludes specific users, user the <code class="codeph">SYS_CONTEXT</code> function.</p>
</li>
</ul>
<p>For example:</p>
<pre dir="ltr">SYS_CONTEXT(&#39;USERENV&#39;,&#39;SESSION_USER&#39;) = &#39;SUPERADMIN_USER&#39; OR <span class="italic">additional_rule</span>
</pre>
<p>If the current user is a privileged user, then the system evaluates the rule to true without evaluating <span class="italic"><code class="codeph">additional_rule</code></span>. If the current user is not a privileged user, then the evaluation of the rule depends on the evaluation of <span class="italic"><code class="codeph">additional_rule</code></span>.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="DVADM50058"></a>
<div class="props_rev_3"><a id="GUID-744EC9BB-0804-4F91-BA0F-7D5584EA5B97"></a>
<h2 id="DVADM-GUID-744EC9BB-0804-4F91-BA0F-7D5584EA5B97" class="sect2">Tutorial: Creating an Email Alert for Security Violations</h2>
<div>
<p>This tutorial demonstrates how to use the <code class="codeph">UTL_MAIL</code> PL/SQL package and an access control list to create an email alert for security violations.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="cfrulset.htm#GUID-D43A729D-6528-46ED-9CB8-55591745C6F8" title="In tutorial, you create an email alert that is sent when a user attempts to alter a table outside a maintenance period.">About This Tutorial</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-16C3DDD7-A749-46FE-BC65-D523C4EBCC63" title="The UTL_MAIL PL/SQL package, which you must manually install, has procedures to manage email notifications.">Step 1: Install and Configure the UTL_MAIL PL/SQL Package</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-478D9B85-F2FC-47DE-8F35-40E4E5A6D6EC" title="User leo_dvowner can use the CREATE PROCEDURE statement to create the email security alert.">Step 2: Create an Email Security Alert PL/SQL Procedure</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-2E877560-EDF1-4835-9F5C-CDD67201DDB0" title="Before you can use UTL_MAIL, you must configure an access control list (ACL) to enable fine-grained access to external network services.">Step 3: Configure an Access Control List File for Network Services</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-FAF67375-E88D-42B2-A107-F940BC3C0616" title="To create the rule set and command rule, you can use DBMS_MACADM PL/SQL package.">Step 4: Create a Rule Set and a Command Rule to Use the Email Security Alert</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-1AEEE3DA-9104-4DA4-836A-C5AE5AC028E8" title="After the alert has been created, it is ready to be tested.">Step 5: Test the Email Security Alert</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-ED7B98BF-87DD-4893-9992-FF0319FE9788" title="You can remove the components that you created for this tutorial if you no longer need them.">Step 6: Remove the Components for This Tutorial</a></p>
</li>
</ul>
</div>
<a id="DVADM71115"></a>
<div class="props_rev_3"><a id="GUID-D43A729D-6528-46ED-9CB8-55591745C6F8"></a>
<h3 id="DVADM-GUID-D43A729D-6528-46ED-9CB8-55591745C6F8" class="sect3">About This Tutorial</h3>
<div>
<p>In tutorial, you create an email alert that is sent when a user attempts to alter a table outside a maintenance period.</p>
<p>To do this, you must create a rule to set the maintenance period hours, attach this rule to a rule set, and then create a command rule to allow the user to alter the table. You then associate the rule set with this command rule, which then sends the email alert when the user attempts to use the <code class="codeph">ALTER TABLE</code> SQL statement outside the maintenance period.</p>
<div class="infobox-note" id="GUID-D43A729D-6528-46ED-9CB8-55591745C6F8__GUID-2D4AE163-0DB8-4315-9BCF-D3BA522BB49E">
<p class="notep1">Note:</p>
<p>To complete this tutorial, you must use a database that has an SMTP server.</p>
</div>
</div>
</div>
<a id="DVADM70188"></a>
<div class="props_rev_3"><a id="GUID-16C3DDD7-A749-46FE-BC65-D523C4EBCC63"></a>
<h3 id="DVADM-GUID-16C3DDD7-A749-46FE-BC65-D523C4EBCC63" class="sect3">Step 1: Install and Configure the UTL_MAIL PL/SQL Package</h3>
<div>
<p>The <code class="codeph">UTL_MAIL</code> PL/SQL package, which you must manually install, has procedures to manage email notifications.</p>
<ol>
<li class="stepexpand"><span>Log into the database instance as <code class="codeph">SYS</code> using the <code class="codeph">SYSDBA</code> administrative privilege.</span>
<div>
<pre dir="ltr">sqlplus sys as sysdba
Enter password: <span class="italic">password</span>
</pre></div>
</li>
<li class="stepexpand"><span>In a multitenant environment, connect to the appropriate pluggable database (PDB).</span>
<div>
<p>For example:</p>
<pre dir="ltr">CONNECT SYS@my_pdb AS SYSDBA
Enter password: <span class="italic">password</span>
</pre>
<p>To find the available PDBs, query the <code class="codeph">DBA_PDBS</code> data dictionary view. To check the current PDB, run the <code class="codeph">show con_name</code> command.</p>
</div>
</li>
<li class="stepexpand"><span>Install the <code class="codeph">UTL_MAIL</code> package.</span>
<div>
<pre dir="ltr">@$ORACLE_HOME/rdbms/admin/utlmail.sql
@$ORACLE_HOME/rdbms/admin/prvtmail.plb
</pre>
<p>The <code class="codeph">UTL_MAIL</code> package enables you to manage email. See <a class="olink ARPLS384" target="_blank" href="../ARPLS/u_mail.htm#ARPLS384"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for more information about <code class="codeph">UTL_MAIL</code>. However, be aware that currently, the <code class="codeph">UTL_MAIL</code> PL/SQL package do not support SSL servers.</p>
</div>
</li>
<li class="stepexpand"><span>Check the current value of the <code class="codeph">SMTP_OUT_SERVER</code> parameter, and make a note of this value so that you can restore it when you complete this tutorial.</span>
<div>
<p>For example:</p>
<pre dir="ltr">SHOW PARAMETER SMTP_OUT_SERVER
</pre>
<p>Output similar to the following appears:</p>
<pre dir="ltr">NAME                    TYPE              VALUE
----------------------- ----------------- ----------------------------------
SMTP_OUT_SERVER         string            some_value.example.com
</pre></div>
</li>
<li class="stepexpand"><span>Issue the following <code class="codeph">ALTER SYSTEM</code> statement:</span>
<div>
<pre dir="ltr">ALTER SYSTEM SET SMTP_OUT_SERVER=&#34;<span class="italic">imap_mail_server.example.com</span>&#34;;
</pre>
<p>Replace <span class="italic"><code class="codeph">imap_mail_server.example.com</code></span> with the name of your SMTP server, which you can find in the account settings in your email tool. Enclose these settings in double quotation marks. For example:</p>
<pre dir="ltr">ALTER SYSTEM SET SMTP_OUT_SERVER=&#34;my_imap_mail_server.example.com&#34;
</pre></div>
</li>
<li class="stepexpand"><span>Connect as <code class="codeph">SYS</code> using the <code class="codeph">SYSOPER</code> privilege and then restart the database.</span>
<div>
<pre dir="ltr">CONNECT SYS AS SYSOPER <span class="italic">-- Or, CONNECT SYS@hrpdb AS SYSOPER</span>
Enter password: <span class="italic">password</span>

SHUTDOWN IMMEDIATE
STARTUP
</pre></div>
</li>
<li class="stepexpand"><span>Ensure that the <code class="codeph">SMTP_OUT_SERVER</code> parameter setting is correct.</span>
<div>
<pre dir="ltr">CONNECT SYS AS SYSDBA <span class="italic">-- Or, CONNECT SYS@hrpdb AS SYSDBA</span>
Enter password: <span class="italic">password</span>

SHOW PARAMETER SMTP_OUT_SERVER
</pre>
<p>Output similar to the following appears:</p>
<pre dir="ltr">NAME                    TYPE              VALUE
----------------------- ----------------- ----------------------------------
SMTP_OUT_SERVER         string            my_imap_mail_server.example.com
</pre></div>
</li>
</ol>
</div>
</div>
<a id="DVADM70189"></a>
<div class="props_rev_3"><a id="GUID-478D9B85-F2FC-47DE-8F35-40E4E5A6D6EC"></a>
<h3 id="DVADM-GUID-478D9B85-F2FC-47DE-8F35-40E4E5A6D6EC" class="sect3">Step 2: Create an Email Security Alert PL/SQL Procedure</h3>
<div>
<p>User <code class="codeph">leo_dvowner</code> can use the <code class="codeph">CREATE PROCEDURE</code> statement to create the email security alert.</p>
<ol>
<li class="stepexpand"><span>Ensure that you are connected as a user who has privileges to perform the grants described in this step, and then grant these privileges to a user who has been granted the <code class="codeph">DV_OWNER</code> role. You should also be authorized as an owner of the Oracle System Privilege and Role Management realm.</span>
<div>
<p>(Alternatively, you can select a user who has been granted the <code class="codeph">DV_ADMIN</code> role, but for this tutorial, you will select a user who has the <code class="codeph">DV_OWNER</code> role.)</p>
<p>For example:</p>
<pre dir="ltr">CONNECT dba_psmith <span class="italic">-- Or, CONNECT dba_psmith@hrpdb</span>
Enter password: <span class="italic">password</span>

GRANT CREATE PROCEDURE, DROP ANY PROCEDURE TO leo_dvowner;
GRANT EXECUTE ON UTL_TCP TO leo_dvowner;
GRANT EXECUTE ON UTL_SMTP TO leo_dvowner;
GRANT EXECUTE ON UTL_MAIL TO leo_dvowner;
GRANT EXECUTE ON DBMS_NETWORK_ACL_ADMIN TO leo_dvowner;
</pre>
<p>The <code class="codeph">UTL_TCP</code>, <code class="codeph">UTL_SMTP</code>, <code class="codeph">UTL_MAIL</code>, and <code class="codeph">DBMS_NETWORK_ACL_ADMIN</code> PL/SQL packages will be used by the email security alert that you create.</p>
</div>
</li>
<li class="stepexpand"><span>Connect to SQL*Plus as the <code class="codeph">DV_OWNER</code> user.</span>
<div>
<p>For example:</p>
<pre dir="ltr">CONNECT leo_dvowner <span class="italic">-- Or, CONNECT leo_dvowner@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre></div>
</li>
<li class="stepexpand"><span>Create the following procedure:</span>
<div>
<pre dir="ltr">CREATE OR REPLACE PROCEDURE email_alert AS
msg varchar2(20000) := &#39;Realm violation occurred for the ALTER TABLE Command Security Policy rule set. The time is: &#39;; 
BEGIN
  msg := msg||to_char(SYSDATE, &#39;Day DD MON, YYYY HH24:MI:SS&#39;); 
UTL_MAIL.SEND (
    sender      =&gt; &#39;<span class="italic">youremail@example.com</span>&#39;,
    recipients  =&gt; &#39;<span class="italic">recipientemail@example.com</span>&#39;,
    subject     =&gt; &#39;Table modification attempted outside maintenance!&#39;,
    message     =&gt; msg); 
END email_alert;
/
</pre>
<p>Replace <span class="italic"><code class="codeph">youremail@example.com</code></span> with your email address, and <span class="italic"><code class="codeph">recipientemail@example.com</code></span> with the email address of the person you want to receive the notification.</p>
</div>
</li>
<li class="stepexpand"><span>Grant the <code class="codeph">EXECUTE</code> permission on this procedure to <code class="codeph">DVSYS</code>.</span>
<div>
<pre dir="ltr">GRANT EXECUTE ON email_alert TO DVSYS;
</pre></div>
</li>
</ol>
</div>
</div>
<a id="DVADM70190"></a>
<div class="props_rev_3"><a id="GUID-2E877560-EDF1-4835-9F5C-CDD67201DDB0"></a>
<h3 id="DVADM-GUID-2E877560-EDF1-4835-9F5C-CDD67201DDB0" class="sect3">Step 3: Configure an Access Control List File for Network Services</h3>
<div>
<p>Before you can use <code class="codeph">UTL_MAIL</code>, you must configure an access control list (ACL) to enable fine-grained access to external network services.</p>
<div class="section">
<p>For detailed information about fine-grained access to external network services, see <a class="olink DBSEG40012" target="_blank" href="../DBSEG/fine_grained_access.htm#DBSEG40012"><span><cite>Oracle Database Security Guide</cite></span></a>.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>As the <code class="codeph">DV_OWNER</code> user, in SQL*Plus, configure the following access control setting and its privilege definitions.</span>
<div>
<pre dir="ltr">BEGIN
 DBMS_NETWORK_ACL_ADMIN.APPEND_HOST_ACE(
  host       =&gt; &#39;<span class="italic">SMTP_OUT_SERVER_setting</span>&#39;,
  lower_port =&gt; 25,
  ace        =&gt;  xs$ace_type(privilege_list =&gt; xs$name_list(&#39;smtp&#39;),
                             principal_name =&gt; &#39;LEO_DVOWNER,
                             principal_type =&gt; xs_acl.ptype_db));
END;
/
</pre>
<p>In this example:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="italic"><code class="codeph">lower_port</code></span>: Enter the port number that your email tool specifies for its outgoing server. Typically, this setting is 25. Enter this value for both the <code class="codeph">lower_port</code> and <code class="codeph">upper_port</code> settings. (Currently, the <code class="codeph">UTL_MAIL</code> package does not support SSL. If your mail server is an SSL server, then enter 25 for the port number, even if the mail server uses a different port number.)</p>
</li>
<li>
<p><code class="codeph">principal_name</code>: Replace <code class="codeph">LEO_DVOWNER</code> with the name of the <code class="codeph">DV_OWNER</code> user.</p>
</li>
<li>
<p><code class="codeph">host</code>: For the <span class="italic"><code class="codeph">SMTP_OUT_SERVER_setting</code></span>, enter the <code class="codeph">SMTP_OUT_SERVER</code> setting that you set for the <code class="codeph">SMTP_OUT_SERVER</code> parameter in <a href="cfrulset.htm#GUID-16C3DDD7-A749-46FE-BC65-D523C4EBCC63" title="The UTL_MAIL PL/SQL package, which you must manually install, has procedures to manage email notifications.">Step 1: Install and Configure the UTL_MAIL PL/SQL Package</a>. This setting should match exactly the setting that your email tool specifies for its outgoing server.</p>
</li>
</ul>
</div>
</li>
<li class="stepexpand"><span>Commit your changes to the database.</span>
<div>
<pre dir="ltr">COMMIT;
</pre></div>
</li>
<li class="stepexpand"><span>Test the settings that you have created so far.</span>
<div>
<pre dir="ltr">EXEC EMAIL_ALERT;
COMMIT;
</pre>
<p>SQL*Plus should display a <code class="codeph">PL/SQL procedure successfully completed</code> message, and in a moment, depending on the speed of your email server, you should receive the email alert.</p>
<p>If you receive an <code class="codeph">ORA-24247: network access denied by access control list (ACL)</code> error followed by <code class="codeph">ORA-06512: at</code> <span class="italic"><code class="codeph">string</code></span><code class="codeph">line</code> <span class="italic"><code class="codeph">string</code></span> errors, then check the settings in the access control list file.</p>
</div>
</li>
</ol>
</div>
</div>
<a id="DVADM70191"></a>
<div class="props_rev_3"><a id="GUID-FAF67375-E88D-42B2-A107-F940BC3C0616"></a>
<h3 id="DVADM-GUID-FAF67375-E88D-42B2-A107-F940BC3C0616" class="sect3">Step 4: Create a Rule Set and a Command Rule to Use the Email Security Alert</h3>
<div>
<p>To create the rule set and command rule, you can use <code class="codeph">DBMS_MACADM</code> PL/SQL package.</p>
<ol>
<li class="stepexpand"><span>As the <code class="codeph">DV_OWNER</code> user, create the following rule set:</span>
<div>
<pre dir="ltr">BEGIN
 DBMS_MACADM.CREATE_RULE_SET(
  rule_set_name    =&gt; &#39;ALTER TABLE Command Security Policy&#39;, 
  description      =&gt; &#39;This rule set allows ALTER TABLE only during the 
                       maintenance period.&#39;, 
  enabled          =&gt; DBMS_MACUTL.G_YES,
  eval_options     =&gt; DBMS_MACUTL.G_RULESET_EVAL_ALL,
  audit_options    =&gt; DBMS_MACUTL.G_RULESET_AUDIT_FAIL,
  fail_options     =&gt; DBMS_MACUTL.G_RULESET_FAIL_SILENT,
  fail_message     =&gt; &#39;&#39;,
  fail_code        =&gt; NULL,
  handler_options  =&gt; DBMS_MACUTL.G_RULESET_HANDLER_FAIL,
  handler          =&gt; &#39;leo_dvowner.email_alert&#39;);
END;
/
</pre></div>
</li>
<li class="stepexpand"><span>Create a rule similar to the following.</span>
<div>
<p>For now, set the rule expression to be during the time you test it. For example, if you want to test it between 2 p.m. and 3 p.m., create the rule as follows:</p>
<pre dir="ltr">BEGIN
 DBMS_MACADM.CREATE_RULE(
  rule_name  =&gt; &#39;Restrict Access to Maintenance Period&#39;, 
  rule_expr  =&gt; &#39;TO_CHAR(SYSDATE,&#39;&#39;HH24&#39;&#39;) BETWEEN &#39;&#39;14&#39;&#39; AND &#39;&#39;15&#39;&#39;&#39;);
END;
/
</pre>
<p>Ensure that you use two single quotation marks instead of double quotation marks for <code class="codeph">HH24</code>, <code class="codeph">14</code>, and <code class="codeph">15</code>.</p>
<p>You can check the system time on your computer by issuing the following SQL statement:</p>
<pre dir="ltr">SELECT TO_CHAR(SYSDATE,&#39;HH24&#39;) FROM DUAL;
</pre>
<p>Output similar to the following appears:</p>
<pre dir="ltr">TO
--
14
</pre>
<p>Later on, when you are satisfied that the rule works, you can update it to a time when your site typically performs maintenance work (for example, between 7 p.m. and 10 p.m), as follows:</p>
<pre dir="ltr">BEGIN
 DBMS_MACADM.UPDATE_RULE(
  rule_name  =&gt; &#39;Restrict Access to Maintenance Period&#39;, 
  rule_expr  =&gt; &#39;TO_CHAR(SYSDATE,&#39;&#39;HH24&#39;&#39;) BETWEEN &#39;&#39;16&#39;&#39; AND &#39;&#39;22&#39;&#39;&#39;);
END;
/
</pre></div>
</li>
<li class="stepexpand"><span>Add the Restrict Access to Maintenance Period rule to the ALTER TABLE Command Security Policy rule set.</span>
<div>
<pre dir="ltr">BEGIN
 DBMS_MACADM.ADD_RULE_TO_RULE_SET(
  rule_set_name =&gt; &#39;ALTER TABLE Command Security Policy&#39;, 
  rule_name     =&gt; &#39;Restrict Access to Maintenance Period&#39;); 
END;
/
</pre></div>
</li>
<li class="stepexpand"><span>Create the following command rule:</span>
<div>
<pre dir="ltr">BEGIN
 DBMS_MACADM.CREATE_COMMAND_RULE(
  command         =&gt; &#39;ALTER TABLE&#39;, 
  rule_set_name   =&gt; &#39;ALTER TABLE Command Security Policy&#39;, 
  object_owner    =&gt; &#39;SCOTT&#39;, 
  object_name     =&gt; &#39;%&#39;, 
  enabled         =&gt; DBMS_MACUTL.G_YES);
END; 
/
</pre></div>
</li>
<li class="stepexpand"><span>Commit these updates to the database.</span>
<div>
<pre dir="ltr">COMMIT;
</pre></div>
</li>
</ol>
</div>
</div>
<a id="DVADM70192"></a>
<div class="props_rev_3"><a id="GUID-1AEEE3DA-9104-4DA4-836A-C5AE5AC028E8"></a>
<h3 id="DVADM-GUID-1AEEE3DA-9104-4DA4-836A-C5AE5AC028E8" class="sect3">Step 5: Test the Email Security Alert</h3>
<div>
<p>After the alert has been created, it is ready to be tested.</p>
<ol>
<li class="stepexpand"><span>Connect to SQL*Plus as user <code class="codeph">SCOTT</code>.</span>
<div>
<p>For example:</p>
<pre dir="ltr">CONNECT SCOTT <span class="italic">-- Or, CONNECT SCOTT@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre>
<p>If the <code class="codeph">SCOTT</code> account is locked and expired, then a user with the <code class="codeph">DV_ACCTMGR</code> role can unlock this account and create a new password as follows:</p>
<pre dir="ltr">ALTER USER SCOTT ACCOUNT UNLOCK IDENTIFIED BY <span class="italic">password</span>;
</pre>
<p>Replace <span class="italic"><code class="codeph">password</code></span> with a password that is secure. See <a class="olink DBSEG33223" target="_blank" href="../DBSEG/authentication.htm#DBSEG33223"><span class="italic">Oracle Database Security Guide</span></a> for the minimum requirements for creating passwords.</p>
</div>
</li>
<li class="stepexpand"><span>As the user <code class="codeph">SCOTT</code>, create a test table.</span>
<div>
<pre dir="ltr">CREATE TABLE mytest (col1 number);
</pre></div>
</li>
<li class="stepexpand"><span>Change the system time on your computer to a time when the ALTER TABLE Command Security Policy rule set takes place.</span>
<div>
<p>For example, if you set the test period time to between 2 p.m. and 3 p.m., do the following:</p>
<p><span class="bold">UNIX:</span> Log in as root and use the <code class="codeph">date</code> command to set the time. For example, assuming the date today is August 15, 2012, you would enter the following:</p>
<pre dir="ltr">$ su root
Password: <span class="italic">password</span>

$ date -s &#34;08/15/2012 14:48:00&#34;
</pre>
<p><span class="bold">Windows:</span> Double-click the clock icon, which is typically at the lower right corner of the screen. In the Date and Time Properties window, set the time to 2 p.m., and then click <span class="bold">OK</span>.</p>
</div>
</li>
<li class="stepexpand"><span>Try altering the <code class="codeph">my_test</code> table.</span>
<div>
<pre dir="ltr">ALTER TABLE mytest ADD (col2 number);

Table altered.
</pre>
<p><code class="codeph">SCOTT</code> should be able to alter the <code class="codeph">mytest</code> table during this time.</p>
</div>
</li>
<li class="stepexpand"><span>Reset the system time to a time outside the Restrict Access to Maintenance Period time.</span></li>
<li class="stepexpand"><span>Log in as <code class="codeph">SCOTT</code> and try altering the <code class="codeph">my_test</code> table again.</span>
<div>
<pre dir="ltr">CONNECT SCOTT <span class="italic">-- Or, CONNECT SCOTT@hrpdb</span>
Enter password: <span class="italic">password</span>

ALTER TABLE mytest ADD (col3 number);
</pre>
<p>The following output should appear:</p>
<pre dir="ltr">ORA-47400: Command Rule violation for ALTER TABLE on SCOTT.MYTEST
</pre>
<p><code class="codeph">SCOTT</code> cannot alter the <code class="codeph">mytest</code> table. In a moment, you should receive an email with the subject header <code class="codeph">Table modification attempted outside maintenance!</code> and with a message similar to the following:</p>
<pre dir="ltr">Realm violation occurred for the ALTER TABLE Command Security Policy rule set. The time is: Wednesday 15 AUG, 2012 14:24:25
</pre></div>
</li>
<li class="stepexpand"><span>Reset the system time to the correct time.</span></li>
</ol>
</div>
</div>
<a id="DVADM70193"></a>
<div class="props_rev_3"><a id="GUID-ED7B98BF-87DD-4893-9992-FF0319FE9788"></a>
<h3 id="DVADM-GUID-ED7B98BF-87DD-4893-9992-FF0319FE9788" class="sect3">Step 6: Remove the Components for This Tutorial</h3>
<div>
<p>You can remove the components that you created for this tutorial if you no longer need them.</p>
<ol>
<li class="stepexpand"><span>Connect to SQL*Plus as the <code class="codeph">DV_OWNER</code> user.</span>
<div>
<pre dir="ltr">CONNECT leo_dvowner <span class="italic">-- Or, CONNECT leo_dvowner@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre></div>
</li>
<li class="stepexpand"><span>In the order shown, drop the Oracle Database Vault rule components.</span>
<div>
<pre dir="ltr">EXEC DBMS_MACADM.DELETE_RULE_FROM_RULE_SET(&#39;ALTER TABLE Command Security Policy&#39;, &#39;Restrict Access to Maintenance Period&#39;);
EXEC DBMS_MACADM.DELETE_RULE(&#39;Restrict Access to Maintenance Period&#39;);
EXEC DBMS_MACADM.DELETE_COMMAND_RULE(&#39;ALTER TABLE&#39;, &#39;SCOTT&#39;, &#39;%&#39;);
EXEC DBMS_MACADM.DELETE_RULE_SET(&#39;ALTER TABLE Command Security Policy&#39;);
</pre></div>
</li>
<li class="stepexpand"><span>Drop the <code class="codeph">email_alert</code> PL/SQL procedure.</span>
<div>
<pre dir="ltr">DROP PROCEDURE email_alert;
</pre></div>
</li>
<li class="stepexpand"><span>Connect as user <code class="codeph">SCOTT</code> and remove the <code class="codeph">mytest</code> table.</span>
<div>
<pre dir="ltr">CONNECT SCOTT <span class="italic">-- Or, CONNECT SCOTT@hrpdb</span>
Enter password: <span class="italic">password</span>

DROP TABLE mytest;
</pre></div>
</li>
<li class="stepexpand"><span>Connect as a user who has privileges to revoke privileges from other users.</span>
<div>
<p>For example:</p>
<pre dir="ltr">CONNECT dba_psmith <span class="italic">-- Or, CONNECT dba_psmith@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre></div>
</li>
<li class="stepexpand"><span>Revoke the <code class="codeph">EXECUTE</code> privilege on the <code class="codeph">UTL_TCP</code>, <code class="codeph">UTL_SMTP</code>, and <code class="codeph">UTL_MAIL</code> PL/SQL packages from the <code class="codeph">DV_OWNER</code> user.</span>
<div>
<p>For example:</p>
<pre dir="ltr">REVOKE EXECUTE ON UTL_TCP FROM leo_dvowner;
REVOKE EXECUTE ON UTL_SMTP FROM leo_dvowner;
REVOKE EXECUTE ON UTL_MAIL FROM leo_dvowner;
REVOKE EXECUTE ON DBMS_NETWORK_ACL_ADMIN FROM leo_dvowner;
</pre></div>
</li>
<li class="stepexpand"><span>Set the <code class="codeph">SMTP_OUT_SERVER</code> parameter to its original value.</span>
<div>
<p>For example:</p>
<pre dir="ltr">ALTER SYSTEM SET SMTP_OUT_SERVER=&#34;some_value.example.com&#34;;
</pre></div>
</li>
<li class="stepexpand"><span>Connect as <code class="codeph">SYS</code> with the <code class="codeph">SYSOPER</code> administrative privilege and then restart the database.</span>
<div>
<pre dir="ltr">CONNECT SYS AS SYSOPER <span class="italic">-- Or, CONNECT SYS@hrpdb AS SYSOPER</span>
Enter password: <span class="italic">password</span>

SHUTDOWN IMMEDIATE
STARTUP
</pre></div>
</li>
</ol>
</div>
</div>
</div>
<a id="DVADM70194"></a>
<div class="props_rev_3"><a id="GUID-D9AA1CCC-065C-4DFE-A078-908123401816"></a>
<h2 id="DVADM-GUID-D9AA1CCC-065C-4DFE-A078-908123401816" class="sect2">Tutorial: Configuring Two-Person Integrity, or Dual Key Security</h2>
<div>
<p>This tutorial demonstrates how to use Oracle Database Vault to control the authorization of two users.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="cfrulset.htm#GUID-F84E9514-A74D-4354-AE2B-F9AEDBD77C36" title="In this tutorial, you configure a rule set that defines two-person integrity (TPI).">About This Tutorial</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-5EDF2BCE-C39C-4EF9-BF22-4814F22AA7E6" title="You must create two users for this tutorial, patch_boss and patch_user.">Step 1: Create Users for This Tutorial</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-572E823B-9551-4B15-BA7F-32E468E7D3ED" title="The behavior of the Database Vault settings will be determined by the function.">Step 2: Create a Function to Check if User patch_boss Is Logged In</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-312BAFD1-5704-430E-A6CE-311E47D4F042" title="Next, you must create two rules, a rule set to which you will add them, and a command rule.">Step 3: Create Rules, a Rule Set, and a Command Rule to Control User Access</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-B09ABAAA-AE06-458B-8FF2-A41A99ED672D" title="After the rules have been created, they are ready to be tested.">Step 4: Test the Users&#39; Access</a></p>
</li>
<li>
<p><a href="cfrulset.htm#GUID-200A09DC-119E-40B1-B42B-2176ED117772" title="You can remove the components that you created for this tutorial if you no longer need them.">Step 5: Remove the Components for This Tutorial</a></p>
</li>
</ul>
</div>
<a id="DVADM71116"></a>
<div class="props_rev_3"><a id="GUID-F84E9514-A74D-4354-AE2B-F9AEDBD77C36"></a>
<h3 id="DVADM-GUID-F84E9514-A74D-4354-AE2B-F9AEDBD77C36" class="sect3">About This Tutorial</h3>
<div>
<p>In this tutorial, you configure a rule set that defines two-person integrity (TPI).</p>
<p>This feature is also called dual key security, dual key connection, and two-man rule security. In this type of security, two users are required to authorize an action instead of one user.</p>
<p>The idea is that one user provides a safety check for the other user before that user can proceed with a task. Two-person integrity provides an additional layer of security for actions that potentially can be dangerous. This type of scenario is often used for tasks such as database patch updates, which is what this tutorial will demonstrate. One user, <code class="codeph">patch_user</code> must log into perform a database patch upgrade, but the only way that he can do this is if his manager, <code class="codeph">patch_boss</code> is already logged in. You will create a function, rules, a rule set, and a command rule to control <code class="codeph">patch_user</code>&#39;s ability to log in.</p>
</div>
</div>
<a id="DVADM70195"></a>
<div class="props_rev_3"><a id="GUID-5EDF2BCE-C39C-4EF9-BF22-4814F22AA7E6"></a>
<h3 id="DVADM-GUID-5EDF2BCE-C39C-4EF9-BF22-4814F22AA7E6" class="sect3">Step 1: Create Users for This Tutorial</h3>
<div>
<p>You must create two users for this tutorial, <code class="codeph">patch_boss</code> and <code class="codeph">patch_user.</code></p>
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">patch_boss</code> acts in a supervisory role: If <code class="codeph">patch_boss</code> is not logged in, then the <code class="codeph">patch_user</code> user cannot log in.</p>
</li>
<li>
<p><code class="codeph">patch_user</code> is the user who is assigned to perform the patch upgrade. However, for this tutorial, user <code class="codeph">patch_user</code> does not actually perform a patch upgrade. He only attempts to log in.</p>
</li>
</ul>
<p>To create the users:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Log into the database instance as a user who has been granted the <code class="codeph">DV_ACCTMGR</code> role.</span>
<div>
<p>For example:</p>
<pre dir="ltr">sqlplus bea_dvacctmgr
Enter password: <span class="italic">password</span>
</pre>
<p>In a multitenant environment, you must log in to the appropriate pluggable database (PDB). For example:</p>
<pre dir="ltr">sqlplus bea_dvacctmgr@hrpdb
Enter password: <span class="italic">password</span>
</pre>
<p>To find the available PDBs, query the <code class="codeph">DBA_PDBS</code> data dictionary view. To check the current PDB, run the <code class="codeph">show con_name</code> command.</p>
</div>
</li>
<li class="stepexpand"><span>Create the following users and grant them the <code class="codeph">CREATE SESSION</code> privilege.</span>
<div>
<pre dir="ltr">GRANT CREATE SESSION TO patch_boss IDENTIFIED BY <span class="italic">password</span>;
GRANT CREATE SESSION TO patch_user IDENTIFIED BY <span class="italic">password</span>;
</pre>
<p>Follow the guidelines in <a class="olink DBSEG33223" target="_blank" href="../DBSEG/authentication.htm#DBSEG33223"><span><cite>Oracle Database Security Guide</cite></span></a> to replace <span class="italic"><code class="codeph">password</code></span> with a password that is secure.</p>
</div>
</li>
<li class="stepexpand"><span>Connect as user <code class="codeph">SYS</code> with the <code class="codeph">SYSDBA</code> administrative privilege.</span>
<div>
<pre dir="ltr">CONNECT SYS AS SYSDBA <span class="italic">-- Or, CONNECT SYS@hrpdb</span> AS SYSDBA
Enter password: <span class="italic">password</span>
</pre></div>
</li>
<li class="stepexpand"><span>Grant the following privileges to the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> user.</span>
<div>
<p>For example:</p>
<pre dir="ltr">GRANT CREATE PROCEDURE TO leo_dvowner;
GRANT SELECT ON V_$SESSION TO leo_dvowner;
</pre>
<p>The <code class="codeph">V_$SESSION</code> table is the underlying table for the <code class="codeph">V$SESSION</code> dynamic view.</p>
</div>
</li>
</ol>
<div class="section">
<p>In a real-world scenario, you also would log in as the <code class="codeph">DV_OWNER</code> user and grant the <code class="codeph">DV_PATCH_ADMIN</code> role to user <code class="codeph">patch_user</code> (but not to <code class="codeph">patch_boss</code>). But because you are not really going to perform a database patch upgrade in this tutorial, you do not need to grant this role to user <code class="codeph">patch_user</code>.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="DVADM70196"></a>
<div class="props_rev_3"><a id="GUID-572E823B-9551-4B15-BA7F-32E468E7D3ED"></a>
<h3 id="DVADM-GUID-572E823B-9551-4B15-BA7F-32E468E7D3ED" class="sect3">Step 2: Create a Function to Check if User patch_boss Is Logged In</h3>
<div>
<p>The behavior of the Database Vault settings will be determined by the function.</p>
<div class="section">The function that you must create, <code class="codeph">check_boss_logged_in</code>, does just that: When user <code class="codeph">patch_user</code> tries to log into the database instance, it checks if user <code class="codeph">patch_boss</code> is already logged in by querying the <code class="codeph">V$SESSION</code> data dictionary view.</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Connect as a user who has been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role.</span>
<div>
<p>For example:</p>
<pre dir="ltr">CONNECT leo_dvowner <span class="italic">-- Or, CONNECT leo_dvowner@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre></div>
</li>
<li class="stepexpand"><span>Create the <code class="codeph">check_boss_logged_in</code> function as follows:</span>
<div>
<pre dir="ltr">CREATE OR REPLACE FUNCTION check_boss_logged_in
return varchar2
authid definer as 
 
v_session_number number := 0;
v_allow varchar2(10)    := &#39;TRUE&#39;;
v_deny varchar2(10)     := &#39;FALSE&#39;;
 
BEGIN
  SELECT COUNT(*) INTO v_session_number
  FROM SYS.V_$SESSION
  WHERE USERNAME = &#39;PATCH_BOSS&#39;; -- Enter the user name in capital letters.
 
 IF v_session_number &gt; 0
  THEN RETURN v_allow;
 ELSE
  RETURN v_deny;
 END IF;
END check_boss_logged_in;
/
</pre></div>
</li>
<li class="stepexpand"><span>Grant the <code class="codeph">EXECUTE</code> privilege on the <code class="codeph">check_boss_logged_in</code> function to the <code class="codeph">DVSYS</code> schema.</span>
<div>
<pre dir="ltr">GRANT EXECUTE ON check_boss_logged_in to DVSYS;
</pre></div>
</li>
</ol>
</div>
</div>
<a id="DVADM70197"></a>
<div class="props_rev_3"><a id="GUID-312BAFD1-5704-430E-A6CE-311E47D4F042"></a>
<h3 id="DVADM-GUID-312BAFD1-5704-430E-A6CE-311E47D4F042" class="sect3">Step 3: Create Rules, a Rule Set, and a Command Rule to Control User Access</h3>
<div>
<p>Next, you must create two rules, a rule set to which you will add them, and a command rule.</p>
<div class="section">The rule set triggers the <code class="codeph">check_boss_logged_in</code> function when user <code class="codeph">patch_user</code> tries to logs in to the database.</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Connect as a user who has been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role.</span>
<div>
<p>For example:</p>
<pre dir="ltr">CONNECT leo_dvowner <span class="italic">-- Or, CONNECT leo_dvowner@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre></div>
</li>
<li class="stepexpand"><span>Create the Check if Boss Is Logged In rule, which checks that the <code class="codeph">patch_user</code> user is logged in to the database. In the definition, replace <code class="codeph">leo_dvowner</code> with the name of the <code class="codeph">DVOWNER</code> or <code class="codeph">DV_ADMIN</code> user who created the <code class="codeph">check_boss_logged_in</code> function.</span>
<div>
<p>If the <code class="codeph">check_boss_logged_in</code> function returns <code class="codeph">TRUE</code> (that is, <code class="codeph">patch_boss</code> is logged in to another session), then <code class="codeph">patch_user</code> can log in.</p>
<pre dir="ltr">BEGIN
  DBMS_MACADM.CREATE_RULE(
   rule_name =&gt; &#39;Check if Boss Is Logged In&#39;,
   rule_expr =&gt; &#39;SYS_CONTEXT(&#39;&#39;USERENV&#39;&#39;,&#39;&#39;SESSION_USER&#39;&#39;) = &#39;&#39;PATCH_USER&#39;&#39; and leo_dvowner.check_boss_logged_in =  &#39;&#39;TRUE&#39;&#39; &#39;);
END;
/
</pre>
<p>Enter the user name, <code class="codeph">PATCH_USER</code>, in upper-case letters, which is how the <code class="codeph">SESSION_USER</code> parameter stores it.</p>
</div>
</li>
<li class="stepexpand"><span>Create the Allow Connect for Other Database Users rule, which ensures that the user logged in (<code class="codeph">patch_user</code>) is not user <code class="codeph">patch_boss</code>. It also enables all other valid users to log in.</span>
<div>
<pre dir="ltr">BEGIN
 DBMS_MACADM.CREATE_RULE(
  rule_name =&gt; &#39;Allow Connect for Other Database Users&#39;,
  rule_expr =&gt; &#39;SYS_CONTEXT(&#39;&#39;USERENV&#39;&#39;,&#39;&#39;SESSION_USER&#39;&#39;) != &#39;&#39;PATCH_USER&#39;&#39;&#39;);
END;
/
COMMIT;
</pre></div>
</li>
<li class="stepexpand"><span>Create the Dual Connect for Boss and Patch rule set, and then add the two rules to it.</span>
<div>
<pre dir="ltr">BEGIN
    DBMS_MACADM.CREATE_RULE_SET(
     rule_set_name     =&gt; &#39;Dual Connect for Boss and Patch&#39;,
     description       =&gt; &#39;Checks if both boss and patch users are logged in.&#39;,
     enabled           =&gt; DBMS_MACUTL.G_YES,
     eval_options      =&gt; 2,
     audit_options     =&gt; DBMS_MACUTL.G_RULESET_AUDIT_FAIL,
     fail_options      =&gt; DBMS_MACUTL.G_RULESET_FAIL_SILENT,
     fail_message      =&gt;&#39;&#39;,
     fail_code         =&gt; NULL,
     handler_options   =&gt; DBMS_MACUTL.G_RULESET_HANDLER_OFF,
     handler           =&gt; &#39;&#39;
     );
END;
/

BEGIN
    DBMS_MACADM.ADD_RULE_TO_RULE_SET(
     rule_set_name     =&gt; &#39;Dual Connect for Boss and Patch&#39;,
     rule_name         =&gt; &#39;Check if Boss Is Logged In&#39;
   );
END;
/

BEGIN
    DBMS_MACADM.ADD_RULE_TO_RULE_SET(
     rule_set_name     =&gt; &#39;Dual Connect for Boss and Patch&#39;,
     rule_name         =&gt; &#39;Allow Connect for Other Database Users&#39;
   );
END;
/
</pre></div>
</li>
<li class="stepexpand"><span>Create the following CONNECT command rule, which permits user <code class="codeph">patch_user</code> to connect to the database only if <code class="codeph">patch_boss</code> is already logged in.</span>
<div>
<pre dir="ltr">BEGIN
   DBMS_MACADM.CREATE_COMMAND_RULE(
    command            =&gt; &#39;CONNECT&#39;,
    rule_set_name      =&gt; &#39;Dual Connect for Boss and Patch&#39;,
    object_owner       =&gt; &#39;%&#39;,
    object_name        =&gt; &#39;%&#39;,
    enabled            =&gt; DBMS_MACUTL.G_YES);
END;
/
COMMIT;
</pre></div>
</li>
</ol>
</div>
</div>
<a id="DVADM70198"></a>
<div class="props_rev_3"><a id="GUID-B09ABAAA-AE06-458B-8FF2-A41A99ED672D"></a>
<h3 id="DVADM-GUID-B09ABAAA-AE06-458B-8FF2-A41A99ED672D" class="sect3">Step 4: Test the Users&#39; Access</h3>
<div>
<p>After the rules have been created, they are ready to be tested.</p>
<ol>
<li class="stepexpand"><span>Exit SQL*Plus.</span>
<div>
<pre dir="ltr">EXIT
</pre></div>
</li>
<li class="stepexpand"><span>Create a second shell, for example:</span>
<div>
<pre dir="ltr">xterm &amp;
</pre></div>
</li>
<li class="stepexpand"><span>In the first shell, try to log in as user <code class="codeph">patch_user</code>.</span>
<div>
<pre dir="ltr">sqlplus patch_user <span class="italic">-- Or, sqlplus patch_user@hrpdb</span>
Enter password: <span class="italic">password</span>

ERROR:
ORA-47400: Command Rule violation for CONNECT on LOGON

Enter user-name:
</pre>
<p>User <code class="codeph">patch_user</code> cannot log in until user <code class="codeph">patch_boss</code> is already logged in. (Do not try the <code class="codeph">Enter user-name</code> prompt yet.)</p>
</div>
</li>
<li class="stepexpand"><span>In the second shell and then log in as user <code class="codeph">patch_boss</code>.</span>
<div>
<pre dir="ltr">sqlplus patch_boss <span class="italic">-- Or, sqlplus patch_boss@hrpdb</span>
Enter password: <span class="italic">password</span>
Connected. 
</pre>
<p>User <code class="codeph">patch_boss</code> can log in.</p>
</div>
</li>
<li class="stepexpand"><span>Go back to the first shell, and then try logging in as user <code class="codeph">patch_user</code> again.</span>
<div>
<pre dir="ltr">Enter user_name: patch_user
Enter password: <span class="italic">password</span>
</pre>
<p>This time, user <code class="codeph">patch_user</code> is deemed a valid user, so now he can log in.</p>
</div>
</li>
</ol>
</div>
</div>
<a id="DVADM70199"></a>
<div class="props_rev_3"><a id="GUID-200A09DC-119E-40B1-B42B-2176ED117772"></a>
<h3 id="DVADM-GUID-200A09DC-119E-40B1-B42B-2176ED117772" class="sect3">Step 5: Remove the Components for This Tutorial</h3>
<div>
<p>You can remove the components that you created for this tutorial if you no longer need them.</p>
<ol>
<li class="stepexpand"><span>In the session for the user <code class="codeph">patch_boss</code>, exit SQL*Plus and then close the shell.</span>
<div>
<pre dir="ltr">EXIT
</pre></div>
</li>
<li class="stepexpand"><span>In the first shell, connect the <code class="codeph">DV_ACCTMGR</code> user and remove the users you created.</span>
<div>
<pre dir="ltr">CONNECT bea_dvacctmgr <span class="italic">-- Or, CONNECT bea_dvacctmgr@hrpdb</span>
Enter password: <span class="italic">password</span>

DROP USER patch_boss;
DROP USER patch_user;
</pre></div>
</li>
<li class="stepexpand"><span>Connect as a user <code class="codeph">SYS</code> with the <code class="codeph">SYSDBA</code> administrative privilege and revoke the privileges that you had granted to the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> user.</span>
<div>
<pre dir="ltr">CONNECT SYS AS SYSDBA <span class="italic">-- Or, CONNECT SYS@hrpdb</span> AS SYSDBA
Enter password: <span class="italic">password</span>

REVOKE CREATE PROCEDURE FROM leo_dvowner;
REVOKE SELECT ON V_$SESSION FROM leo_dvowner;
</pre></div>
</li>
<li class="stepexpand"><span>Connect as the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> user and drop the rules, rule set, and command rule, in the order shown.</span>
<div>
<pre dir="ltr">CONNECT leo_dvowner <span class="italic">-- Or, CONNECT leo_dvowner@hrpdb</span>
Enter password: <span class="italic">password</span>

DROP FUNCTION check_boss_logged_in;
EXEC DBMS_MACADM.DELETE_COMMAND_RULE(&#39;CONNECT&#39;, &#39;%&#39;, &#39;%&#39;);
EXEC DBMS_MACADM.DELETE_RULE_FROM_RULE_SET(&#39;Dual Connect for Boss and Patch&#39;, &#39;Check if Boss Is Logged In&#39;);
EXEC DBMS_MACADM.DELETE_RULE_FROM_RULE_SET(&#39;Dual Connect for Boss and Patch&#39;, &#39;Allow Connect for Other Database Users&#39;);
EXEC DBMS_MACADM.DELETE_RULE(&#39;Check if Boss Is Logged In&#39;);
EXEC DBMS_MACADM.DELETE_RULE(&#39;Allow Connect for Other Database Users&#39;);
EXEC DBMS_MACADM.DELETE_RULE_SET(&#39;Dual Connect for Boss and Patch&#39;);
COMMIT;
</pre></div>
</li>
</ol>
</div>
</div>
</div>
<a id="DVADM70200"></a>
<div class="props_rev_3"><a id="GUID-F99FE15B-869E-44CC-A6C4-CC9BACD6BE34"></a>
<h2 id="DVADM-GUID-F99FE15B-869E-44CC-A6C4-CC9BACD6BE34" class="sect2">Guidelines for Designing Rule Sets</h2>
<div>
<p>Oracle provides guidelines for designing rule sets.</p>
<ul style="list-style-type: disc;">
<li>
<p>You can share rules among multiple rule sets. This lets you develop a library of reusable rule expressions. Oracle recommends that you design such rules to be discrete, single-purpose expressions.</p>
</li>
<li>
<p>You can design a rule set so that its evaluation is static, that is, it is evaluated only once during a user session. Alternatively, it can be evaluated each time the rule set is accessed. If the rule set is evaluated only once, then the evaluated value is reused throughout the user session each time the rule set is accessed. Using static evaluation is useful in cases where the rule set must be accessed multiple times but the conditions on which the rule set depend do not change during that session. An example would be a SELECT command rule associated with a rule set when the same <code class="codeph">SELECT</code> statement occurs multiple times and if the evaluated value is acceptable to use again, rather than evaluating the rule set each time the <code class="codeph">SELECT</code> occurs.</p>
<p>To control the static evaluation of the rule set, set the <code class="codeph">is_static</code> parameter of the <code class="codeph">CREATE_RULE_SET</code> or <code class="codeph">UPDATE_RULE_SET</code> procedures of the <code class="codeph">DBMS_MACADM</code> PL/SQL package. See <a href="apis_rule_sets.htm#GUID-1B24D370-46E3-445E-91CC-8E621F5E94CB" title="The DBMS_MACADM rule set procedures enable you to configure both rule sets and individual rules that go within these rule sets.">DBMS_MACADM Rule Set Procedures</a> for more information.</p>
</li>
<li>
<p>Use Oracle Database Vault factors in your rule expressions to provide reusability and trust in the values used by your rule expressions. Factors can provide contextual information to use in your rules expressions.</p>
</li>
<li>
<p>You can use custom event handlers to extend Oracle Database Vault security policies to integrate external systems for error handling or alerting. Using Oracle utility packages such as <code class="codeph">UTL_TCP</code>, <code class="codeph">UTL_HTTP</code>, <code class="codeph">UTL_MAIL</code>, <code class="codeph">UTL_SMTP</code>, or <code class="codeph">DBMS_AQ</code> can help you to achieve this type of integration.</p>
</li>
<li>
<p>Test rule sets thoroughly for various accounts and scenarios either on a test database or on a test realm or command rule for nonsensitive data before you apply them to realms and command rules that protect sensitive data. You can test rule expressions directly with the following SQL statement:</p>
<pre dir="ltr">SQL&gt; SELECT SYSDATE from DUAL where <span class="italic">rule expression</span>
</pre></li>
<li>
<p>You can nest rule expressions inside a single rule. This helps to achieve more complex situations where you would need a logical <code class="codeph">AND</code> for a subset of rules and a logical <code class="codeph">OR</code> with the rest of the rules. See the definition for the Is Corporate Network During Maintenance rule set under <a href="cfrulset.htm#GUID-744EC9BB-0804-4F91-BA0F-7D5584EA5B97" title="This tutorial demonstrates how to use the UTL_MAIL PL/SQL package and an access control list to create an email alert for security violations.">Tutorial: Creating an Email Alert for Security Violations</a> for an example.</p>
</li>
<li>
<p>You cannot use invoker&#39;s rights procedures with rule expressions. Only use definer&#39;s rights procedures with rule expressions.</p>
</li>
</ul>
</div>
</div>
<a id="DVADM70201"></a>
<div class="props_rev_3"><a id="GUID-980369CA-666C-4E3A-8F90-572F7F34CEC7"></a>
<h2 id="DVADM-GUID-980369CA-666C-4E3A-8F90-572F7F34CEC7" class="sect2">How Rule Sets Affect Performance</h2>
<div>
<p>The number and complexity of rules can slow database performance.</p>
<p>Rule sets govern the performance for execution of certain operations. For example, if you have a very large number of rules in a rule set governing a <code class="codeph">SELECT</code> statement, performance could degrade significantly.</p>
<p>If you have rule sets that require many rules, performance improves if you move all the rules to logic defined in a single PL/SQL standalone or package function. However, if a rule is used by other rule sets, there is little performance effect on your system.</p>
<p>If possible, consider setting the rule set to use static evaluation, assuming this is compatible with the associated command rule&#39;s usage. See <a href="cfrulset.htm#GUID-F99FE15B-869E-44CC-A6C4-CC9BACD6BE34" title="Oracle provides guidelines for designing rule sets.">Guidelines for Designing Rule Sets</a> for more information.</p>
<p>You can check system performance by running tools such as Oracle Enterprise Manager (including Oracle Enterprise Manager Cloud Control, which is installed by default with Oracle Database), Automatic Workload Repository (AWR), and <code class="codeph">TKPROF</code>.</p>
<div class="infoboxnotealso" id="GUID-980369CA-666C-4E3A-8F90-572F7F34CEC7__ORACLEDATABASEPERFORMANCETUNINGGUID-630E988B">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink TGDBA025" target="_blank" href="../TGDBA/pfgrf_perf_overview.htm#TGDBA025"><span><cite>Oracle Database Performance Tuning Guide</cite></span></a> to learn how to monitor database performance</p>
</li>
<li>
<p><a class="olink TGSQL809" target="_blank" href="../TGSQL/tgsql_trace.htm#TGSQL809"><span><cite>Oracle Database SQL Tuning Guide</cite></span></a> to monitor the performance of individual SQL and PL/SQL statements</p>
</li>
</ul>
</div>
</div>
</div>
<a id="DVADM70203"></a><a id="DVADM70204"></a><a id="DVADM70202"></a>
<div class="props_rev_3"><a id="GUID-FABD139C-F858-40F8-AD5D-6089F517F2E7"></a>
<h2 id="DVADM-GUID-FABD139C-F858-40F8-AD5D-6089F517F2E7" class="sect2">Rule Set and Rule Related Reports and Data Dictionary Views</h2>
<div>
<p>Oracle Database Vault provides reports and data dictionary views that are useful for analyzing rule sets and the rules within them.</p>
<div class="section">
<p><a href="cfrulset.htm#GUID-FABD139C-F858-40F8-AD5D-6089F517F2E7__BABBJDEI" title="rule set reports">Table 6-2</a> lists the Oracle Database Vault reports. See <a href="reports.htm#GUID-1B6D02DE-3FB2-4ADB-9916-4491B37FDECD" title="Oracle Database Vault provides reports that track activities, such as the Database Vault configuration settings.">Oracle Database Vault Reports</a> for information about how to run these reports.</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-FABD139C-F858-40F8-AD5D-6089F517F2E7__BABBJDEI">
<p class="titleintable">Table 6-2 Reports Related to Rule Sets</p>
<table class="cellalignment338" title="Reports Related to Rule Sets" summary="rule set reports">
<thead>
<tr class="cellalignment332">
<th class="cellalignment375" id="d23765e5987">Report</th>
<th class="cellalignment376" id="d23765e5990">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment332">
<td class="cellalignment377" id="d23765e5995" headers="d23765e5987">
<p><a href="reports.htm#GUID-162BB69D-9C1F-4FB8-959E-1B8C21FE6FF9" title="The Rule Set Configuration Issues Report displays Oracle Database Vault rule set configuration issues.">Rule Set Configuration Issues Report</a></p>
</td>
<td class="cellalignment378" headers="d23765e5995 d23765e5990">
<p>Lists rule sets that have no rules defined or enabled</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment377" id="d23765e6006" headers="d23765e5987">
<p><a href="reports.htm#GUID-0BEBF077-C4BA-471B-8789-85BD5A758421" title="The Secure Application Configuration Issues Report displays Database Vault secure application role configuration issues.">Secure Application Configuration Issues Report</a></p>
</td>
<td class="cellalignment378" headers="d23765e6006 d23765e5990">
<p>Lists secure application roles that have incomplete or disabled rule sets</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment377" id="d23765e6017" headers="d23765e5987">
<p><a href="reports.htm#GUID-DB10DAF0-4E4C-4A11-A9B8-A227DC82D8AA" title="The Command Rule Configuration Issues Report displays command rules that have configuration issues.">Command Rule Configuration Issues Report</a></p>
</td>
<td class="cellalignment378" headers="d23765e6017 d23765e5990">
<p>Lists rule sets that are incomplete or disabled</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<p><a href="cfrulset.htm#GUID-FABD139C-F858-40F8-AD5D-6089F517F2E7__BABIFDJJ" title="Rule Set Data Dictionary Views">Table 6-3</a> lists data dictionary views that provide information about existing rules and rule sets.</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-FABD139C-F858-40F8-AD5D-6089F517F2E7__BABIFDJJ">
<p class="titleintable">Table 6-3 Data Dictionary Views Used for Rules and Rule Sets</p>
<table class="cellalignment338" title="Data Dictionary Views Used for Rules and Rule Sets" summary="Rule Set Data Dictionary Views">
<thead>
<tr class="cellalignment332">
<th class="cellalignment375" id="d23765e6044">Data Dictionary View</th>
<th class="cellalignment376" id="d23765e6047">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment332">
<td class="cellalignment377" id="d23765e6052" headers="d23765e6044">
<p><a href="views.htm#GUID-97C96089-0EE4-4A57-8257-1F9F61606245" title="The DVSYS.DBA_DV_RULE data dictionary view lists the rules that have been defined.">DVSYS.DBA_DV_RULE View</a></p>
</td>
<td class="cellalignment378" headers="d23765e6052 d23765e6047">
<p>Lists the rules that have been defined</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment377" id="d23765e6066" headers="d23765e6044">
<p><a href="views.htm#GUID-A7FD62EB-A8E4-4279-A0D5-1677493AC202" title="The DVSYS.DBA_DV_RULE_SET data dictionary view lists the rules sets that have been created.">DVSYS.DBA_DV_RULE_SET View</a></p>
</td>
<td class="cellalignment378" headers="d23765e6066 d23765e6047">
<p>Lists the rule sets that have been created</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment377" id="d23765e6080" headers="d23765e6044">
<p><a href="views.htm#GUID-52C00874-C14D-44F6-A89A-CCB5E07FBE3E" title="The DVSYS.DBA_DV_RULE_SET_RULE data dictionary view lists rules that are associated with existing rule sets.">DVSYS.DBA_DV_RULE_SET_RULE View</a></p>
</td>
<td class="cellalignment378" headers="d23765e6080 d23765e6047">
<p>Lists rules that are associated with existing rule sets</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment331">
<tr>
<td class="cellalignment359">
<table class="cellalignment336">
<tr>
<td class="cellalignment335"><a href="cfrealms.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment335"><a href="cfcmdaut.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2006, 2016, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment361">
<table class="cellalignment334">
<tr>
<td class="cellalignment335"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment335"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment335"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment335"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment335"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment335"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>