<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-6007"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Performing%20Privilege%20Analysis%20to%C2%A0Find%C2%A0Privilege%C2%A0Use"></a><title>Performing Privilege Analysis to&nbsp;Find&nbsp;Privilege&nbsp;Use</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="description" content="Privilege analysis dynamically analyzes the privileges and roles that users use and do not use."/>
<meta name="keywords" content="privilege analysis, about, ORA$DEPENDENCY profile, pre-compiled database objects, requirements for using, privilege uses captured, roles, context profiles, logon users, restrictions, SYS account, benefits, use cases, application security, finding privilege use by users, finding application pool privileges, connection pooling, finding unnecessarily granted privileges, finding overly privileged users, CDBs, privilege profiles, PDBs, DBMS_PRIVILEGE_CAPTURE PL/SQL package, general steps for managing, creating, in Cloud Control, usingDBMS_PRIVILEGE_CAPTURE.CREATE_CAPTURE, SYS_CONTEXT function, Boolean expressions used in privilege analysis, examples of creating and enabling, enabling, in Cloud Control, using DBMS_PRIVILEGE_CAPTURE.ENABLE_CAPTURE, disabling, using DBMS_PRIVILEGE_CAPTURE.DISABLE_CAPTURE, generating reports, accessing reports in Cloud Control, using DBMS_PRIVILEGE_CAPTURE.GENERATE_REPORT, dropping, using DBMS_PRIVILEGE_CAPTURE.DROP_CAPTURE, creating role in Cloud Control, revoking and re-granting in Cloud Control, revoking and regranting using scripts, generating regrant scripts, tutorials, privilege analysis for ANY privileges, tutorial for ANY privileges, tutorial, data dictionary views"/>
<meta name="dcterms.created" content="2017-06-05T10:50:14Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Vault Administrator&#39;s Guide"/>
<meta name="dcterms.identifier" content="E49109-12"/>
<meta name="dcterms.isVersionOf" content="DVADM"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2006, 2016, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="getting_started.htm" title="Previous" type="text/html"/>
<link rel="Next" href="cfrealms.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E49109-12.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-44CB644B-7B59-4B3B-B375-9F9B96F60186"></a> <span id="PAGE" style="display:none;">8/34</span> <!-- End Header -->
<a id="DVADM591"></a>
<h1 id="DVADM-GUID-44CB644B-7B59-4B3B-B375-9F9B96F60186" class="sect1"><span class="enumeration_chapter">4</span> Performing Privilege Analysis to&nbsp;Find&nbsp;Privilege&nbsp;Use</h1>
<div>
<p>Privilege analysis dynamically analyzes the privileges and roles that users use and do not use.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="priv_analysis.htm#GUID-DE3DC8D3-4357-4DC7-B66F-62356911076E" title="Privilege analysis performs a dynamic (not static) analysis of privileges and roles that a user account or database uses over time.">About Privilege Analysis</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-442371F1-541D-4A1E-BCBF-180C0D88517D" title="You can create and manage privilege analysis policies in either SQL*Plus or in Enterprise Manager Cloud Control.">Creating and Managing Privilege Analysis Policies</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-819C319D-2A16-4F3B-BC4E-6D216418F6CA" title="You can create new roles using privileges found in a privilege analysis report and then grant this role to users.">Creating Roles and Managing Privileges Using Cloud Control</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-0A2B341F-FDFB-486E-9F93-B2063F82CC13" title="This tutorial demonstrates how to use privilege analysis to analyze the use of the READ ANY TABLE system privilege.">Tutorial: Analyzing ANY Privilege Use</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-3AA55C7A-CD73-4B28-AE02-9D80A69E8B6E" title="This tutorial demonstrates how to analyze the privilege use of a user who has the DBA role and performs database tuning operations.">Tutorial: Analyzing Privilege Use by a User Who Has the DBA Role</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-2F1929EB-8EB5-4678-BBC9-EE4A8056D112" title="Oracle Database provides data dictionary views that show information about analyzed privileges.">Privilege Analysis Policy and Report Data Dictionary Views</a></p>
</li>
</ul>
</div>
<a id="DVADM71418"></a>
<div class="props_rev_3"><a id="GUID-624BEE71-EE04-450F-9E8D-E5DF9788D18C"></a>
<h2 id="DVADM-GUID-624BEE71-EE04-450F-9E8D-E5DF9788D18C" class="sect2">What Is Privilege Analysis?</h2>
<div>
<p>Oracle Database Vault with Oracle Database Release 12<span class="italic">c</span> includes a feature called privilege analysis to help you increase the security of your applications and database operations.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="priv_analysis.htm#GUID-DE3DC8D3-4357-4DC7-B66F-62356911076E" title="Privilege analysis performs a dynamic (not static) analysis of privileges and roles that a user account or database uses over time.">About Privilege Analysis</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-77961026-AD82-4BD2-98B0-70A74DD3FAA0" title="Privilege analysis can be used to capture the privileges that have been exercised on pre-compiled database objects.">How Privilege Analysis Works with Pre-Compiled Database Objects</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-43F5F696-8414-4A47-B609-F9FB134C9175" title="To use privilege analysis, you must be granted the CAPTURE_ADMIN role.">Who Can Perform Privilege Analysis?</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-087DF0BE-E64E-4097-815D-49FF86703F6D" title="You can create different types of privilege analysis policies to achieve specific goals.">Types of Privilege Analysis</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-280C672A-5399-4823-8F8B-09F3135DF5DD" title="Analyzing privilege use is beneficial in finding unnecessarily granted privileges.">Benefits and Use Cases of Privilege Analysis</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-AD683DDB-D345-4702-B1F4-37B79F276B66" title="You can create and use privilege analysis policies in a multitenant environment.">How Does a Multitenant Environment Affect Privilege Analysis?</a></p>
</li>
</ul>
</div>
<a id="DVADM669"></a>
<div class="props_rev_3"><a id="GUID-DE3DC8D3-4357-4DC7-B66F-62356911076E"></a>
<h3 id="DVADM-GUID-DE3DC8D3-4357-4DC7-B66F-62356911076E" class="sect3">About Privilege Analysis</h3>
<div>
<p>Privilege analysis performs a dynamic (not static) analysis of privileges and roles that a user account or database uses over time.</p>
<p>Because it is a dynamic analysis, it captures real privileges and roles that were actually used.</p>
<p>Privilege analysis captures privileges used by database users and applications at runtime. You then can revoke unused grants and other changes to better reflect the access a user requires. This simplifies the work required to implement least privilege practice.</p>
<p>Running inside the Oracle Database kernel, privilege analysis helps reduce the attack surface of applications and increase operational security by identifying used and unused privileges. Privilege analysis can be used after you install Oracle Database Release 12<span class="italic">c</span> without any additional configuration steps.</p>
<p>Privilege analysis support is available from Oracle Enterprise Manager Cloud Control 12<span class="italic">c</span> Release 3 Plug-in Update 1 (12.1.0.3).</p>
</div>
</div>
<a id="DVADM71431"></a>
<div class="props_rev_3"><a id="GUID-77961026-AD82-4BD2-98B0-70A74DD3FAA0"></a>
<h3 id="DVADM-GUID-77961026-AD82-4BD2-98B0-70A74DD3FAA0" class="sect3">How Privilege Analysis Works with Pre-Compiled Database Objects</h3>
<div>
<p>Privilege analysis can be used to capture the privileges that have been exercised on pre-compiled database objects.</p>
<p>Examples of these objects are PL/SQL packages, procedures, functions, views, triggers, and Java classes and data.</p>
<p>Because these privileges may not be exercised during run time when a stored procedure is called, these privileges are collected when you generate the results for any database-wide capture, along with run-time captured privileges. A privilege is treated as an unused privilege when it is not used in either pre-compiled database objects or run-time capture, and it is saved under the run-time capture name. If a privilege is used for pre-compiled database objects, then it is saved under the capture name <code class="codeph">ORA$DEPENDENCY</code>. If a privilege is captured during run time, then it is saved under the run-time capture name. If you want to know what the used privileges are for both pre-compiled database objects and run-time usage, then you must query both the <code class="codeph">ORA$DEPENDENCY</code> and run-time captures. For unused privileges, you only need to query with the run-time capture name.</p>
<p>To find a full list of the pre-compiled objects on which privilege analysis can be used, query the <code class="codeph">TYPE</code> column of the <code class="codeph">ALL_DEPENDENCIES</code> data dictionary view.</p>
</div>
</div>
<a id="DVADM482"></a>
<div class="props_rev_3"><a id="GUID-43F5F696-8414-4A47-B609-F9FB134C9175"></a>
<h3 id="DVADM-GUID-43F5F696-8414-4A47-B609-F9FB134C9175" class="sect3">Who Can Perform Privilege Analysis?</h3>
<div>
<p>To use privilege analysis, you must be granted the <code class="codeph">CAPTURE_ADMIN</code> role.</p>
<p>You use the <code class="codeph">DBMS_PRIVILEGE_CAPTURE</code> PL/SQL package to manage privilege capture. You use the data dictionary views provided by privilege analysis to analyze your privilege use.</p>
</div>
</div>
<a id="DVADM342"></a>
<div class="props_rev_3"><a id="GUID-087DF0BE-E64E-4097-815D-49FF86703F6D"></a>
<h3 id="DVADM-GUID-087DF0BE-E64E-4097-815D-49FF86703F6D" class="sect3">Types of Privilege Analysis</h3>
<div>
<p>You can create different types of privilege analysis policies to achieve specific goals.</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Role-based privilege use capture.</span> You must provide a list of roles. If the roles in the list are enabled in the database session, then the used privileges for the session will be captured.</p>
</li>
<li>
<p><span class="bold">Context-based privilege use capture.</span> You must specify a Boolean expression only with the <code class="codeph">SYS_CONTEXT</code> function. The used privileges will be captured if the condition evaluates to <code class="codeph">TRUE</code>.</p>
</li>
<li>
<p><span class="bold">Role- and context-based privilege use capture.</span> You must provide both a list of roles that are enabled and a <code class="codeph">SYS_CONTEXT</code> Boolean expression for the condition. When any of these roles is enabled in a session and the given context condition is satisfied, then privilege analysis starts capturing the privilege use.</p>
</li>
<li>
<p><span class="bold">Database-wide privilege capture.</span> If you do not specify any type in your privilege analysis policy, then the used privileges in the database will be captured, except those for the user <code class="codeph">SYS</code>. (This is also referred to as unconditional analysis, because it is turned on without any conditions.)</p>
</li>
</ul>
<p>Note the following restrictions:</p>
<ul style="list-style-type: disc;">
<li>
<p>You can enable only one privilege analysis policy at a time. The only exception is that you can enable a database-wide privilege analysis policy at the same time as a non-database-wide privilege analysis policy, such as a role or context attribute-driven analysis policy.</p>
</li>
<li>
<p>You cannot analyze the privileges of the <code class="codeph">SYS</code> user.</p>
</li>
<li>
<p>Privilege analysis shows the grant paths to the privilege but it does not suggest which grant path to keep.</p>
</li>
<li>
<p>If the role, user, or object has been dropped, then the values that reflect the privilege captures for these in the privilege analysis data dictionary views are dropped as well.</p>
</li>
</ul>
</div>
</div>
<a id="DVADM675"></a>
<div class="props_rev_3"><a id="GUID-280C672A-5399-4823-8F8B-09F3135DF5DD"></a>
<h3 id="DVADM-GUID-280C672A-5399-4823-8F8B-09F3135DF5DD" class="sect3">Benefits and Use Cases of Privilege Analysis</h3>
<div>
<p>Analyzing privilege use is beneficial in finding unnecessarily granted privileges.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="priv_analysis.htm#GUID-A67ECE4F-0FDB-45B8-A202-6C15C0F15960" title="The privileges of the account that accesses a database should only be limited to the privileges that are strictly required by the application.">Unnecessarily Granted Privileges of Applications</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-46EDA5CF-3C7F-4C24-9EC6-C227F7BD306C" title="During the application development phase, some administrators may grant many powerful system privileges and roles to application developers.">Development of Secure Applications</a></p>
</li>
</ul>
</div>
<a id="DVADM1004"></a>
<div class="props_rev_3"><a id="GUID-A67ECE4F-0FDB-45B8-A202-6C15C0F15960"></a>
<h4 id="DVADM-GUID-A67ECE4F-0FDB-45B8-A202-6C15C0F15960" class="sect4">Unnecessarily Granted Privileges of Applications</h4>
<div>
<p>The privileges of the account that accesses a database should only be limited to the privileges that are strictly required by the application.</p>
<p>But when an application is developed, especially by a third party, more privileges than necessary may be granted to the application connection pool accounts for convenience. In addition, some developers grant system and application object privileges to the <code class="codeph">PUBLIC</code> role.</p>
<p>For example, to select from application data and run application procedures, the system privileges <code class="codeph">SELECT ANY TABLE</code> and <code class="codeph">EXECUTE ANY PROCEDURE</code> are granted to an application account <code class="codeph">appsys</code>. The account <code class="codeph">appsys</code> now can access non-application data even if he or she does not intend to. In this situation, you can analyze the privilege usage by user <code class="codeph">appsys</code>, and then based on the results, revoke and grant privileges as necessary.</p>
</div>
</div>
<a id="DVADM1002"></a>
<div class="props_rev_3"><a id="GUID-46EDA5CF-3C7F-4C24-9EC6-C227F7BD306C"></a>
<h4 id="DVADM-GUID-46EDA5CF-3C7F-4C24-9EC6-C227F7BD306C" class="sect4">Development of Secure Applications</h4>
<div>
<p>During the application development phase, some administrators may grant many powerful system privileges and roles to application developers.</p>
<p>The administrators may do this because at that stage they may not know what privileges the application developer needs.</p>
<p>Once the application is developed and working, the privileges that the application developer needs &mdash; and does not need &mdash; become more apparent. At that time, the security administrator can begin to revoke unnecessary privileges. However, the application developer may resist this idea on the basis that the application is currently working without problems. The administrator can use privilege analysis to examine each privilege that the application uses, to ensure that when he or she does revoke any privileges, the application will continue to work.</p>
<p>For example, <code class="codeph">app_owner</code> is an application database user through whom the application connects to a database. User <code class="codeph">app_owner</code> must query tables in the <code class="codeph">OE</code>, <code class="codeph">SH</code>, and <code class="codeph">PM</code> schemas. Instead of granting the <code class="codeph">SELECT</code> object privilege on each of the tables in these schemas, a security administrator grants the <code class="codeph">SELECT ANY TABLE</code> privilege to <code class="codeph">app_owner</code>. After a while, a new schema, <code class="codeph">HR</code>, is created and sensitive data are inserted into <code class="codeph">HR.EMPLOYEES</code> table. Because user <code class="codeph">app_owner</code> has the <code class="codeph">SELECT ANY TABLE</code> privilege, he can query this table to access its sensitive data, which is a security issue. Instead of granting system privileges (particularly the <code class="codeph">ANY</code> privileges), it is far better to grant object privileges for specific tables.</p>
</div>
</div>
</div>
<a id="DVADM670"></a>
<div class="props_rev_3"><a id="GUID-AD683DDB-D345-4702-B1F4-37B79F276B66"></a>
<h3 id="DVADM-GUID-AD683DDB-D345-4702-B1F4-37B79F276B66" class="sect3">How Does a Multitenant Environment Affect Privilege Analysis?</h3>
<div>
<p>You can create and use privilege analysis policies in a multitenant environment.</p>
<p>If you are using a multitenant environment, then you can create privilege analysis policies in either the root or in individual PDBs. The privilege analysis policy applies only to the container in which it is created, either to the privileges used within the root or to the privileges used within a PDB. It cannot be applied globally throughout the multitenant environment.</p>
<div class="infoboxnotealso" id="GUID-AD683DDB-D345-4702-B1F4-37B79F276B66__GUID-C661D8B5-1057-406B-9189-A1F5C3DA61E6">
<p class="notep1">See Also:</p>
<p><a class="olink ADMIN13506" target="_blank" href="../ADMIN/part_cdb.htm#ADMIN13506"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for more information about multitenant container databases (CDBs)</p>
</div>
</div>
</div>
</div>
<a id="DVADM671"></a>
<div class="props_rev_3"><a id="GUID-442371F1-541D-4A1E-BCBF-180C0D88517D"></a>
<h2 id="DVADM-GUID-442371F1-541D-4A1E-BCBF-180C0D88517D" class="sect2">Creating and Managing Privilege Analysis Policies</h2>
<div>
<p>You can create and manage privilege analysis policies in either SQL*Plus or in Enterprise Manager Cloud Control.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="priv_analysis.htm#GUID-E3297105-B1F5-4B49-9CB7-7361EE17E8CE" title="You can use Oracle Enterprise Manager Cloud Control or the DBMS_PRIVILEGE_CAPTURE PL/SQL package to analyze privileges.">About Creating and Managing Privilege Analysis Policies</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-41B8439B-2713-43C0-BF51-4FE50A70B705" title="You must follow a general set of steps to analyze privileges.">General Steps for Managing Privilege Analysis</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-AFA08712-2C4E-4E08-82AC-DA109AAF4D44" title="You can create a privilege analysis policy in either Enterprise Manager Cloud Control or from SQL*Plus, using the DBMS_PRIVILEGE_CAPTURE PL/SQL package.">Creating a Privilege Analysis Policy</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-C347E3C2-37DC-44C3-BC9B-1FFAFEEFD1F6" title="You can create a variety of privilege analysis policies.">Examples of Privilege Analysis Policies</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-CE4C421B-6578-4527-9D0A-0ED0066643A4" title="You can enable a privilege analysis policy using either Enterprise Manager Cloud Control or from SQL*Plus, using the DBMS_PRIVILEGE_CAPTURE PL/SQL package.">Enabling a Privilege Analysis Policy</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-2228CF12-028D-4C71-98B3-89D1A939CFEF" title="You can disable a privilege analysis policy using either Enterprise Manager Cloud Control or from SQL*Plus, using the DBMS_PRIVILEGE_CAPTURE PL/SQL package.">Disabling a Privilege Analysis Policy</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-09B5E21E-5C5B-4171-B6D7-32DDF7EA1222" title="You can generate a privilege analysis policy report using either Enterprise Manager Cloud Control or from SQL*Plus, using the DBMS_PRIVILEGE_CAPTURE PL/SQL package.">Generating a Privilege Analysis Report</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-4CF1EE91-C812-4BB8-BB94-9DE36CAAB72B" title="You can drop a privilege analysis policy report using either Enterprise Manager Cloud Control or from SQL*Plus, using the DBMS_PRIVILEGE_CAPTURE PL/SQL package.">Dropping a Privilege Analysis Policy</a></p>
</li>
</ul>
</div>
<a id="DVADM676"></a>
<div class="props_rev_3"><a id="GUID-E3297105-B1F5-4B49-9CB7-7361EE17E8CE"></a>
<h3 id="DVADM-GUID-E3297105-B1F5-4B49-9CB7-7361EE17E8CE" class="sect3">About Creating and Managing Privilege Analysis Policies</h3>
<div>
<p>You can use Oracle Enterprise Manager Cloud Control or the <code class="codeph">DBMS_PRIVILEGE_CAPTURE</code> PL/SQL package to analyze privileges.</p>
<p>Before you can do so, you must be granted the <code class="codeph">CAPTURE_ADMIN</code> role. The <code class="codeph">DBMS_PRIVILEGE_CAPTURE</code> package enables you to create, enable, disable, and drop privilege analysis policies. It also generates reports that show the privilege usage, which you can view in <code class="codeph">DBA_*</code> views.</p>
<div class="infoboxnotealso" id="GUID-E3297105-B1F5-4B49-9CB7-7361EE17E8CE__GUID-9E5C155F-CDD9-4828-A666-C46FA3EF2A18">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS74328" target="_blank" href="../ARPLS/d_priv_prof.htm#ARPLS74328"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for detailed information about the <code class="codeph">DBMS_PRIVILEGE_CAPTURE</code> PL/SQL package</p>
</div>
</div>
</div>
<a id="DVADM1013"></a>
<div class="props_rev_3"><a id="GUID-41B8439B-2713-43C0-BF51-4FE50A70B705"></a>
<h3 id="DVADM-GUID-41B8439B-2713-43C0-BF51-4FE50A70B705" class="sect3">General Steps for Managing Privilege Analysis</h3>
<div>
<p>You must follow a general set of steps to analyze privileges.</p>
<ol>
<li class="stepexpand"><span>Define the privilege analysis policy.</span></li>
<li class="stepexpand"><span>Enable the privilege analysis policy.</span>
<div>
<p>This step begins recording the privilege use that the policy defined.</p>
</div>
</li>
<li class="stepexpand"><span>After a sufficient period of time to gather data, disable the privilege analysis policy&#39;s recording of privilege use.</span>
<div>
<p>This step stops capturing the privilege use for the policy.</p>
</div>
</li>
<li class="stepexpand"><span>Generate privilege analysis results.</span>
<div>
<p>This step writes the results to the data dictionary views described in <a href="priv_analysis.htm#GUID-2F1929EB-8EB5-4678-BBC9-EE4A8056D112" title="Oracle Database provides data dictionary views that show information about analyzed privileges.">Privilege Analysis Policy and Report Data Dictionary Views</a>.</p>
</div>
</li>
<li class="stepexpand"><span>Optionally, disable and then drop the privilege analysis policy.</span>
<div>
<p>Dropping a privilege analysis policy deletes the data captured by the policy.</p>
</div>
</li>
</ol>
</div>
</div>
<a id="DVADM677"></a>
<div class="props_rev_3"><a id="GUID-AFA08712-2C4E-4E08-82AC-DA109AAF4D44"></a>
<h3 id="DVADM-GUID-AFA08712-2C4E-4E08-82AC-DA109AAF4D44" class="sect3">Creating a Privilege Analysis Policy</h3>
<div>
<p>You can create a privilege analysis policy in either Enterprise Manager Cloud Control or from SQL*Plus, using the <code class="codeph">DBMS_PRIVILEGE_CAPTURE</code> PL/SQL package.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="priv_analysis.htm#GUID-B4AD98D4-1323-4281-A952-2B6B075D4F7F" title="When a policy is created, it resides in the Oracle data dictionary and the SYS schema.">About Creating a Privilege Analysis Policy</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-36F8C2B2-E5CD-442B-A92C-D741E98E558B" title="You can create a privilege analysis policy in Cloud Control.">Creating a Privilege Analysis Policy in Enterprise Manager Cloud Control</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-C4084ACD-81A0-484A-B668-813CD374AEDD" title="The DBMS_PRIVILEGE_CAPTURE.CREATE_CAPTURE procedure creates a privilege analysis policy.">Creating a Privilege Analysis Policy Using DBMS_PRIVILEGE_CAPTURE</a></p>
</li>
</ul>
</div>
<a id="DVADM71383"></a>
<div class="props_rev_3"><a id="GUID-B4AD98D4-1323-4281-A952-2B6B075D4F7F"></a>
<h4 id="DVADM-GUID-B4AD98D4-1323-4281-A952-2B6B075D4F7F" class="sect4">About Creating a Privilege Analysis Policy</h4>
<div>
<p>When a policy is created, it resides in the Oracle data dictionary and the <code class="codeph">SYS</code> schema.</p>
<p>However, the user who created the policy can drop it, as well as user <code class="codeph">SYS</code>. After you create the policy, you must manually enable it so that it can begin to analyze privilege use. If you want to use Oracle Enterprise Manager Cloud Control, then you must use Enterprise Manager Release 12.1.0.3 or later.</p>
</div>
</div>
<a id="DVADM71384"></a>
<div class="props_rev_3"><a id="GUID-36F8C2B2-E5CD-442B-A92C-D741E98E558B"></a>
<h4 id="DVADM-GUID-36F8C2B2-E5CD-442B-A92C-D741E98E558B" class="sect4">Creating a Privilege Analysis Policy in Enterprise Manager Cloud Control</h4>
<div>
<p>You can create a privilege analysis policy in Cloud Control.</p>
<ol>
<li class="stepexpand"><span>In Enterprise Manager, access the target Database home page as a user who has been granted the <code class="codeph">CAPTURE_ADMIN</code> role and the <code class="codeph">SELECT ANY DICTIONARY</code> privilege.</span>
<div>
<p>See <a class="olink ADMQS033" target="_blank" href="../ADMQS/GUID-E2807CDE-1401-4A79-8131-EBC6D45C71B4.htm#ADMQS033"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information.</p>
</div>
</li>
<li class="stepexpand"><span>From the <span class="bold">Security</span> menu, select <span class="bold">Privilege Analysis</span>.</span></li>
<li class="stepexpand"><span>In the Privilege Analysis page, under Policies, select <span class="bold">Create</span>.</span>
<div>
<p>The Privilege Analysis: Create Policy page appears.</p>
<div class="figure" id="GUID-36F8C2B2-E5CD-442B-A92C-D741E98E558B__GUID-87F28F39-B304-44FE-A8F3-6CD8DC6D143D"><img width="971" height="393" src="img/GUID-111F2D45-9127-4E5D-A616-7468A732C370-default.gif" alt="Description of GUID-111F2D45-9127-4E5D-A616-7468A732C370-default.gif follows" title="Description of GUID-111F2D45-9127-4E5D-A616-7468A732C370-default.gif follows"/><br/>
<a href="img_text/GUID-111F2D45-9127-4E5D-A616-7468A732C370-default.htm">Description of the illustration GUID-111F2D45-9127-4E5D-A616-7468A732C370-default.gif</a></div>
<!-- class="figure" --></div>
</li>
<li class="stepexpand"><span>Enter the following information:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Policy</span>: Enter a unique name for the privilege analysis policy. You can find the names of existing policies by querying the <code class="codeph">NAME</code> column of the <code class="codeph">DBA_PRIV_CAPTURES</code> view. You can include spaces in the name and have a maximum of 128 characters in this name.</p>
</li>
<li>
<p><span class="bold">Description</span>: Optionally, enter a description for the policy, in up to 1024 characters.</p>
</li>
<li>
<p><span class="bold">Scope</span>: Select from the following types:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Database</span> captures all privileges that were used in the entire database, except privileges from user <code class="codeph">SYS</code>.</p>
</li>
<li>
<p><span class="bold">Role</span> captures privileges from one or more roles that you specify. If the roles in the list are enabled in the database session, then the used privileges for the session will be captured. If you select this option, then the Create Policy page displays the <span class="bold">Available Roles</span> list.</p>
<div class="figure" id="GUID-36F8C2B2-E5CD-442B-A92C-D741E98E558B__GUID-98E7287E-2099-4F9F-AFA8-D5AD9E3D99AE"><img width="530" height="263" src="img/GUID-8DC0E162-CA0E-44C4-BA43-AB1C6E81756C-default.gif" alt="Description of GUID-8DC0E162-CA0E-44C4-BA43-AB1C6E81756C-default.gif follows" title="Description of GUID-8DC0E162-CA0E-44C4-BA43-AB1C6E81756C-default.gif follows"/><br/>
<a href="img_text/GUID-8DC0E162-CA0E-44C4-BA43-AB1C6E81756C-default.htm">Description of the illustration GUID-8DC0E162-CA0E-44C4-BA43-AB1C6E81756C-default.gif</a></div>
<!-- class="figure" --></li>
<li>
<p><span class="bold">Context</span> captures privileges when the condition that you specify evaluates to <code class="codeph">TRUE</code>. If you select this option, then the Capture Policy page displays a <span class="bold">Condition</span> field. To build the condition, select the edit icon on the right of this field to display the Policy Expression Builder dialog box.</p>
<div class="figure" id="GUID-36F8C2B2-E5CD-442B-A92C-D741E98E558B__GUID-B2D53FEF-C8EB-4516-908A-3E0F1FEF7AB1"><img width="473" height="244" src="img/GUID-A905BB52-FB75-443D-A807-FD0B44CDA794-default.gif" alt="Description of GUID-A905BB52-FB75-443D-A807-FD0B44CDA794-default.gif follows" title="Description of GUID-A905BB52-FB75-443D-A807-FD0B44CDA794-default.gif follows"/><br/>
<a href="img_text/GUID-A905BB52-FB75-443D-A807-FD0B44CDA794-default.htm">Description of the illustration GUID-A905BB52-FB75-443D-A807-FD0B44CDA794-default.gif</a></div>
<!-- class="figure" --></li>
<li>
<p><span class="bold">Role and Context</span> captures privileges from one of the specified roles when the context condition evaluates to <code class="codeph">TRUE</code>. If you select this option, then both the list of available roles and <span class="bold">Condition</span> field appear.</p>
</li>
</ul>
</li>
</ul>
</div>
</li>
<li class="stepexpand"><span>Click <span class="bold">OK</span>.</span>
<div>
<p>The new policy appears in the Policies area of the Privilege Analysis page.</p>
</div>
</li>
<li class="stepexpand"><span>To enable the policy so that it can begin to capture privilege use, return to the main Privilege Analysis policy page, select the policy under <span class="bold">Policies</span>, and then click <span class="bold">Start Capture</span>.</span></li>
</ol>
</div>
</div>
<a id="DVADM71385"></a>
<div class="props_rev_3"><a id="GUID-C4084ACD-81A0-484A-B668-813CD374AEDD"></a>
<h4 id="DVADM-GUID-C4084ACD-81A0-484A-B668-813CD374AEDD" class="sect4">Creating a Privilege Analysis Policy Using DBMS_PRIVILEGE_CAPTURE</h4>
<div>
<p>The <code class="codeph">DBMS_PRIVILEGE_CAPTURE.CREATE_CAPTURE</code> procedure creates a privilege analysis policy.</p>
<div class="section">
<p>After you create the privilege analysis policy, you can find it listed in the <code class="codeph">DBA_PRIV_CAPTURES</code> data dictionary view.</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Use the following syntax for the <code class="codeph">DBMS_PRIVILEGE_CAPTURE.CREATE_CAPTURE</code> procedure:</p>
<pre dir="ltr">DBMS_PRIVILEGE_CAPTURE.CREATE_CAPTURE(
<span class="italic">   </span>name              VARCHAR2, 
   description       VARCHAR2 DEFAULT NULL,<span class="italic"> </span>
   type              NUMBER DEFAULT DBMS_PRIVILEGE_CAPTURE.G_DATABASE, 
   roles             ROLE_NAME_LIST DEFAULT ROLE_NAME_LIST(), 
   condition         VARCHAR2 DEFAULT NULL);
</pre></li>
</ul>
<p>In this specification:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">name</code>: Specifies the name of the privilege analysis policy to be created. Ensure that this name is unique and no more than 128 characters. You can include spaces in the name, but you must enclose the name in single quotation marks whenever you refer to it. To find the names of existing policies, query the <code class="codeph">NAME</code> column of the <code class="codeph">DBA_PRIV_CAPTURES</code> view.</p>
</li>
<li>
<p><code class="codeph">description</code>: Describes the purpose of the privilege analysis policy, up to 1024 characters in mixed-case letters. Optional.</p>
</li>
<li>
<p><code class="codeph">type</code>: Specifies the type of capture condition. If you omit the <code class="codeph">type</code> parameter, then the default is <code class="codeph">DBMS_PRIVILEGE_CAPTURE.G_DATABASE</code>. Optional.</p>
<p>Enter one of the following types:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">DBMS_PRIVILEGE_CAPTURE.G_DATABASE</code>: Captures all privileges used in the entire database, except privileges from user <code class="codeph">SYS</code>.</p>
</li>
<li>
<p><code class="codeph">DBMS_PRIVILEGE_CAPTURE.G_ROLE</code>: Captures privileges for the sessions that have the roles enabled. If you enter <code class="codeph">DBMS_PRIVILEGE_CAPTURE.G_ROLE</code> for the <code class="codeph">type</code> parameter, then you must also specify the <code class="codeph">roles</code> parameter. For multiple roles, separate each role name with a comma.</p>
</li>
<li>
<p><code class="codeph">DBMS_PRIVILEGE_CAPTURE.G_CONTEXT</code>: Captures privileges for the sessions that have the condition specified by the <code class="codeph">condition</code> parameter evaluating to <code class="codeph">TRUE</code>. If you enter <code class="codeph">DBMS_PRIVILEGE_CAPTURE.G_CONTEXT</code> for the <code class="codeph">type</code> parameter, then you must also specify the <code class="codeph">condition</code> parameter.</p>
</li>
<li>
<p><code class="codeph">DBMS_PRIVILEGE_CAPTURE.G_ROLE_AND_CONTEXT</code>: Captures privileges for the sessions that have the role enabled and the context condition evaluating to <code class="codeph">TRUE</code>. If you enter <code class="codeph">DBMS_PRIVILEGE_CAPTURE.G_ROLE_AND_CONTEXT</code> for the <code class="codeph">type</code> parameter, then you must also specify both the <code class="codeph">roles</code> and <code class="codeph">condition</code> parameters.</p>
</li>
</ul>
</li>
<li>
<p><code class="codeph">roles</code>: Specifies the roles whose used privileges will be analyzed. That is, if a privilege from one of the given roles is used, then the privilege will be analyzed. You must specify this argument if you specify <code class="codeph">DBMS_PRIVILEGE_CAPTURE.G_ROLE</code> or <code class="codeph">DBMS_PRIVILEGE_CAPTURE.G_ROLE_AND_CONTEXT</code> for the <code class="codeph">type</code> argument. Each role you enter must exist in the database. (You can find existing roles by querying the <code class="codeph">DBA_ROLES</code> data dictionary view.) For multiple roles, use varray type <code class="codeph">role_name_list</code> to enter the role names. You can specify up to 10 roles.</p>
<p>For example, to specify two roles:</p>
<pre dir="ltr">roles =&gt; role_name_list(&#39;role1&#39;, &#39;role2&#39;),
</pre></li>
<li>
<p><code class="codeph">condition</code>: Specifies a Boolean expression up to 4000 characters. You must specify this argument if you specify <code class="codeph">DBMS_PRIVILEGE_CAPTURE.G_CONTEXT</code> or <code class="codeph">DBMS_PRIVILEGE_CAPTURE.G_ROLE_AND_CONTEXT</code> for the <code class="codeph">type</code> argument. Only <code class="codeph">SYS_CONTEXT</code> expressions with relational operators(<code class="codeph">==</code>, <code class="codeph">&gt;</code>, <code class="codeph">&gt;=</code>, <code class="codeph">&lt;</code>, <code class="codeph">&lt;=</code>, <code class="codeph">&lt;&gt;</code>, <code class="codeph">BETWEEN</code>, and <code class="codeph">IN</code>) are permitted in this Boolean expression.</p>
<p>The <code class="codeph">condition</code> expression syntax is as follows:</p>
<pre dir="ltr">predicate::= SYS_CONTEXT(<span class="italic">namespace</span>, <span class="italic">attribute</span>) relop <span class="italic">constant_value</span> |
             SYS_CONTEXT(<span class="italic">namespace</span>, <span class="italic">attribute</span>)
             BETWEEN 
             <span class="italic">constant_value</span> 
             AND <span class="italic">constant_value</span> | SYS_CONTEXT(<span class="italic">namespace</span>, <span class="italic">attribute</span>) 
             IN {<span class="italic">constant_value</span> (,<span class="italic">constant_value</span>)* }

relop::= = | &lt; | &lt;= | &gt; | &gt;= | &lt;&gt;

context_expression::= predicate | (context_expression) 
             AND (context_expression) | (context_expression) 
             OR (context_expression )
</pre>
<p>For example, to use a condition to specify the IP address <code class="codeph">192.0.2.1</code>:</p>
<pre dir="ltr">condition =&gt; &#39;SYS_CONTEXT(&#39;&#39;USERENV&#39;&#39;, &#39;&#39;IP_ADDRESS&#39;&#39;)=&#39;&#39;192.0.2.1&#39;&#39;&#39;;
</pre></li>
</ul>
<p>* You can add as many constant values as you need (for example, <code class="codeph">IN {</code><span class="italic"><code class="codeph">constant_value1</code></span><code class="codeph">}</code>, or <code class="codeph">IN {</code><span class="italic"><code class="codeph">constant_value1</code></span><code class="codeph">,</code> <span class="italic"><code class="codeph">constant_value2</code></span><code class="codeph">,</code> <span class="italic"><code class="codeph">constant_value3</code></span><code class="codeph">}</code>).</p>
<p>Remember that after you create the privilege analysis policy, you must enable it, as described in <a href="priv_analysis.htm#GUID-CE4C421B-6578-4527-9D0A-0ED0066643A4" title="You can enable a privilege analysis policy using either Enterprise Manager Cloud Control or from SQL*Plus, using the DBMS_PRIVILEGE_CAPTURE PL/SQL package.">Enabling a Privilege Analysis Policy</a>.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="DVADM1041"></a>
<div class="props_rev_3"><a id="GUID-C347E3C2-37DC-44C3-BC9B-1FFAFEEFD1F6"></a>
<h3 id="DVADM-GUID-C347E3C2-37DC-44C3-BC9B-1FFAFEEFD1F6" class="sect3">Examples of Privilege Analysis Policies</h3>
<div>
<p>You can create a variety of privilege analysis policies.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="priv_analysis.htm#GUID-22A1DF70-95F3-4F77-8C8B-4F5E6BBBE23C" title="The DBMS_PRIVILEGE_CAPTURE.CREATE_CAPTURE can be used to analyze database-wide privileges.">Example: Privilege Analysis of Database-Wide Privileges</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-FA1DF4BF-B906-4D88-8E13-96D29F62AAED" title="The DBMS_PRIVILEGE_CAPTURE.CREATE_CAPTURE procedure can be used to analyze the privilege usage of multiple roles.">Example: Privilege Analysis of Privilege Usage of Two Roles</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-F66B66E1-4EDF-497F-88FF-0464202F794C" title="The DBMS_PRIVILEGE_CAPTURE.CREATE_CAPTURE procedure can be used to capture privileges for analysis.">Example: Privilege Analysis of Privileges During SQL*Plus Use</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-6D534AD9-E7A9-4BDE-843B-C3A3B1C14B3B" title="The DBMS_PRIVILEGE_CAPTURE.CREATE_CAPTURE can be used to analyze user access when the user is running SQL*Plus.">Example: Privilege Analysis of PSMITH Privileges During SQL*Plus Access</a></p>
</li>
</ul>
</div>
<a id="DVADM345"></a><a id="DVADM71432"></a>
<div class="props_rev_3"><a id="GUID-22A1DF70-95F3-4F77-8C8B-4F5E6BBBE23C"></a>
<h4 id="DVADM-GUID-22A1DF70-95F3-4F77-8C8B-4F5E6BBBE23C" class="sect4">Example: Privilege Analysis of Database-Wide Privileges</h4>
<div>
<p>The <code class="codeph">DBMS_PRIVILEGE_CAPTURE.CREATE_CAPTURE</code> can be used to analyze database-wide privileges.</p>
<p><a href="priv_analysis.htm#GUID-22A1DF70-95F3-4F77-8C8B-4F5E6BBBE23C__CACFHIEB">Example 4-1</a> shows how to use the <code class="codeph">DBMS_PRIVILEGE_CAPTURE</code> package to create and enable a privilege analysis policy to record all privilege use in the database.</p>
<div class="example" id="GUID-22A1DF70-95F3-4F77-8C8B-4F5E6BBBE23C__CACFHIEB">
<p class="titleinexample">Example 4-1 Privilege Analysis of Database-Wide Privileges</p>
<pre dir="ltr">BEGIN
 DBMS_PRIVILEGE_CAPTURE.CREATE_CAPTURE(
  name          =&gt; &#39;db_wide_capture_pol&#39;,
  description   =&gt; &#39;Captures database-wide privileges&#39;,
  type          =&gt; DBMS_PRIVILEGE_CAPTURE.G_DATABASE);
END;
/
EXEC DBMS_PRIVILEGE_CAPTURE.ENABLE_CAPTURE (&#39;db_wide_capture_pol&#39;);
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DVADM347"></a><a id="DVADM71433"></a>
<div class="props_rev_3"><a id="GUID-FA1DF4BF-B906-4D88-8E13-96D29F62AAED"></a>
<h4 id="DVADM-GUID-FA1DF4BF-B906-4D88-8E13-96D29F62AAED" class="sect4">Example: Privilege Analysis of Privilege Usage of Two Roles</h4>
<div>
<p>The <code class="codeph">DBMS_PRIVILEGE_CAPTURE.CREATE_CAPTURE</code> procedure can be used to analyze the privilege usage of multiple roles.</p>
<p><a href="priv_analysis.htm#GUID-FA1DF4BF-B906-4D88-8E13-96D29F62AAED__CACJDHBE">Example 4-2</a> shows how to analyze the privilege usage of two roles.</p>
<div class="example" id="GUID-FA1DF4BF-B906-4D88-8E13-96D29F62AAED__CACJDHBE">
<p class="titleinexample">Example 4-2 Privilege Analysis of Privilege Usage of Two Roles</p>
<pre dir="ltr">BEGIN
 DBMS_PRIVILEGE_CAPTURE.CREATE_CAPTURE(
  name          =&gt; &#39;dba_roles_capture_pol&#39;,
  description   =&gt; &#39;Captures DBA and LBAC_DBA role use&#39;,
  type          =&gt; DBMS_PRIVILEGE_CAPTURE.G_ROLE,
  roles         =&gt; role_name_list(&#39;dba&#39;, &#39;lbac_dba&#39;));
END;
/
EXEC DBMS_PRIVILEGE_CAPTURE.ENABLE_CAPTURE (&#39;dba_roles_capture_pol&#39;);
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DVADM348"></a><a id="DVADM71434"></a>
<div class="props_rev_3"><a id="GUID-F66B66E1-4EDF-497F-88FF-0464202F794C"></a>
<h4 id="DVADM-GUID-F66B66E1-4EDF-497F-88FF-0464202F794C" class="sect4">Example: Privilege Analysis of Privileges During SQL*Plus Use</h4>
<div>
<p>The <code class="codeph">DBMS_PRIVILEGE_CAPTURE.CREATE_CAPTURE</code> procedure can be used to capture privileges for analysis.</p>
<p><a href="priv_analysis.htm#GUID-F66B66E1-4EDF-497F-88FF-0464202F794C__CACGIABC">Example 4-3</a> shows how to analyze privileges used to run SQL*Plus.</p>
<div class="example" id="GUID-F66B66E1-4EDF-497F-88FF-0464202F794C__CACGIABC">
<p class="titleinexample">Example 4-3 Privilege Analysis of Privileges During SQL*Plus Use</p>
<pre dir="ltr">BEGIN
 DBMS_PRIVILEGE_CAPTURE.CREATE_CAPTURE(
  name             =&gt; &#39;sqlplus_capture_pol&#39;,
  description      =&gt; &#39;Captures privilege use during SQL*Plus use&#39;,
  type             =&gt; DBMS_PRIVILEGE_CAPTURE.G_CONTEXT,
  condition        =&gt; &#39;SYS_CONTEXT(&#39;&#39;USERENV&#39;&#39;, &#39;&#39;MODULE&#39;&#39;)=&#39;&#39;sqlplus&#39;&#39;&#39;);
END;
/
EXEC DBMS_PRIVILEGE_CAPTURE.ENABLE_CAPTURE (&#39;sqlplus_capture_pol&#39;);
</pre></div>
<!-- class="example" --></div>
</div>
<a id="DVADM351"></a><a id="DVADM71435"></a>
<div class="props_rev_3"><a id="GUID-6D534AD9-E7A9-4BDE-843B-C3A3B1C14B3B"></a>
<h4 id="DVADM-GUID-6D534AD9-E7A9-4BDE-843B-C3A3B1C14B3B" class="sect4">Example: Privilege Analysis of PSMITH Privileges During SQL*Plus Access</h4>
<div>
<p>The <code class="codeph">DBMS_PRIVILEGE_CAPTURE.CREATE_CAPTURE</code> can be used to analyze user access when the user is running SQL*Plus.</p>
<p><a href="priv_analysis.htm#GUID-6D534AD9-E7A9-4BDE-843B-C3A3B1C14B3B__CACCDFFI">Example 4-4</a> shows how to analyze the privileges used by session user <code class="codeph">PSMITH</code> when running SQL*Plus.</p>
<div class="example" id="GUID-6D534AD9-E7A9-4BDE-843B-C3A3B1C14B3B__CACCDFFI">
<p class="titleinexample">Example 4-4 Privilege Analysis of PSMITH Privileges During SQL*Plus Access</p>
<pre dir="ltr">BEGIN
 DBMS_PRIVILEGE_CAPTURE.CREATE_CAPTURE(
  name         =&gt; &#39;psmith_sqlplus_analysis_pol&#39;,
  description  =&gt; &#39;Analyzes PSMITH role priv use for SQL*Plus module&#39;,
  type         =&gt; DBMS_PRIVILEGE_CAPTURE.G_CONTEXT,
  condition    =&gt; &#39;SYS_CONTEXT(&#39;&#39;USERENV&#39;&#39;, &#39;&#39;MODULE&#39;&#39;)=&#39;&#39;sqlplus&#39;&#39; 
                  AND SYS_CONTEXT(&#39;&#39;USERENV&#39;&#39;, &#39;&#39;SESSION_USER&#39;&#39;)=&#39;&#39;PSMITH&#39;&#39;&#39;);
END;
/
EXEC DBMS_PRIVILEGE_CAPTURE.ENABLE_CAPTURE (&#39;psmith_sqlplus_analysis_pol&#39;);
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<a id="DVADM678"></a>
<div class="props_rev_3"><a id="GUID-CE4C421B-6578-4527-9D0A-0ED0066643A4"></a>
<h3 id="DVADM-GUID-CE4C421B-6578-4527-9D0A-0ED0066643A4" class="sect3">Enabling a Privilege Analysis Policy</h3>
<div>
<p>You can enable a privilege analysis policy using either Enterprise Manager Cloud Control or from SQL*Plus, using the <code class="codeph">DBMS_PRIVILEGE_CAPTURE</code> PL/SQL package.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="priv_analysis.htm#GUID-3A1CD6E6-1BAA-4D82-8FB0-A45A63F7191A" title="After you create a privilege analysis policy, you must enable it.">About Enabling a Privilege Analysis Policy</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-0A13C239-7771-4250-B616-A9010842EF1B" title="You can enable a privilege analysis policy using Cloud Control.">Enabling a Privilege Analysis Policy Using Cloud Control</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-C4A9E2B3-0051-4190-BD23-1F24052B352C" title="The DBMS_PRIVILEGE_CAPTURE.ENABLE_CAPTURE procedure enables a privilege policy and creates a capture run name for it.">Enabling a Privilege Analysis Policy Using DBMS_PRIVILEGE_CAPTURE</a></p>
</li>
</ul>
</div>
<a id="DVADM71386"></a>
<div class="props_rev_3"><a id="GUID-3A1CD6E6-1BAA-4D82-8FB0-A45A63F7191A"></a>
<h4 id="DVADM-GUID-3A1CD6E6-1BAA-4D82-8FB0-A45A63F7191A" class="sect4">About Enabling a Privilege Analysis Policy</h4>
<div>
<p>After you create a privilege analysis policy, you must enable it.</p>
<p>Once enabled, the privilege analysis policy will begin to record the privilege usage when the condition is satisfied. At any given time, only one privilege analysis policy in the database can be enabled. The only exception is that a privilege analysis policy of type <code class="codeph">DBMS_PRIVILEGE_CAPTURE.G_DATABASE</code> can be enabled at the same time with a privilege analysis of a different type.</p>
<p>Restarting a database does not change the status of a privilege analysis. For example, if a privilege analysis policy is enabled before a database shutdown, then the policy is still enabled after the database shutdown and restart.</p>
</div>
</div>
<a id="DVADM71387"></a>
<div class="props_rev_3"><a id="GUID-0A13C239-7771-4250-B616-A9010842EF1B"></a>
<h4 id="DVADM-GUID-0A13C239-7771-4250-B616-A9010842EF1B" class="sect4">Enabling a Privilege Analysis Policy Using Cloud Control</h4>
<div>
<p>You can enable a privilege analysis policy using Cloud Control.</p>
<ol>
<li class="stepexpand"><span>In Enterprise Manager, access the target Database home page as a user who has been granted the <code class="codeph">CAPTURE_ADMIN</code> role and the <code class="codeph">SELECT ANY DICTIONARY</code> privilege.</span>
<div>
<p>See <a class="olink ADMQS033" target="_blank" href="../ADMQS/GUID-E2807CDE-1401-4A79-8131-EBC6D45C71B4.htm#ADMQS033"><span><cite>Oracle Database 2 Day DBA</cite></span></a> for more information.</p>
</div>
</li>
<li class="stepexpand"><span>From the <span class="bold">Security</span> menu, select <span class="bold">Privilege Analysis</span>.</span></li>
<li class="stepexpand"><span>Under Policies, select the policy that you want to enable.</span></li>
<li class="stepexpand"><span>Select the <span class="bold">Start Capture</span> button.</span></li>
<li class="stepexpand"><span>In the Privilege Analysis: Start Capture dialog box, specify a time to begin the privilege analysis policy.</span>
<div>
<p>To run the policy now, select <span class="bold">Immediate</span>. To run the policy later, select <span class="bold">Later</span>, and then specify the hour, minute, second, and the time zone for the policy to begin.</p>
</div>
</li>
<li class="stepexpand"><span>Click <span class="bold">OK</span>.</span></li>
</ol>
</div>
</div>
<a id="DVADM71388"></a>
<div class="props_rev_3"><a id="GUID-C4A9E2B3-0051-4190-BD23-1F24052B352C"></a>
<h4 id="DVADM-GUID-C4A9E2B3-0051-4190-BD23-1F24052B352C" class="sect4">Enabling a Privilege Analysis Policy Using DBMS_PRIVILEGE_CAPTURE</h4>
<div>
<p>The <code class="codeph">DBMS_PRIVILEGE_CAPTURE.ENABLE_CAPTURE</code> procedure enables a privilege policy and creates a capture run name for it.</p>
<div class="section">The run name defines the period of time that the capture took place.</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Query the <code class="codeph">NAME</code> and <code class="codeph">ENABLED</code> columns of the <code class="codeph">DBA_PRIV_CAPTURES</code> data dictionary view to find the existing privilege analysis policies and whether they are currently enabled.</span></li>
<li class="stepexpand"><span>Run the <code class="codeph">DBMS_PRIVILEGE_CAPTURE.ENABLE_CAPTURE</code> procedure to enable the policy and optionally create a name for a capture run.</span>
<div>
<p>For example, to enable the privilege analysis policy <code class="codeph">logon_users_analysis</code>:</p>
<pre dir="ltr">BEGIN
  DBMS_PRIVILEGE_CAPTURE.ENABLE_CAPTURE (
    name     =&gt; &#39;logon_users_analysis_pol&#39;,
    run_name =&gt; &#39;logon_users_04092016&#39;);
END;
/
</pre></div>
</li>
</ol>
</div>
</div>
</div>
<a id="DVADM680"></a>
<div class="props_rev_3"><a id="GUID-2228CF12-028D-4C71-98B3-89D1A939CFEF"></a>
<h3 id="DVADM-GUID-2228CF12-028D-4C71-98B3-89D1A939CFEF" class="sect3">Disabling a Privilege Analysis Policy</h3>
<div>
<p>You can disable a privilege analysis policy using either Enterprise Manager Cloud Control or from SQL*Plus, using the <code class="codeph">DBMS_PRIVILEGE_CAPTURE</code> PL/SQL package.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="priv_analysis.htm#GUID-0170D3CD-5C98-4A77-A4AD-7D53A22DA031" title="You must disable the privilege analysis policy before you can generate a privilege analysis report.">About Disabling a Privilege Analysis Policy</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-5B18A36B-0419-4F3F-A63C-5F35BE31CA89" title="You can disable a privilege analysis policy using Cloud Control.">Disabling a Privilege Analysis Policy Using Cloud Control</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-ECD0AC5D-0EDD-4AF0-84D9-401749659786" title="The DBMS_PRIVILEGE_CAPTURE.DISABLE_CAPTURE procedure disables a privilege analysis policy.">Disabling a Privilege Analysis Policy Using DBMS_PRIVILEGE_CAPTURE</a></p>
</li>
</ul>
</div>
<a id="DVADM71389"></a>
<div class="props_rev_3"><a id="GUID-0170D3CD-5C98-4A77-A4AD-7D53A22DA031"></a>
<h4 id="DVADM-GUID-0170D3CD-5C98-4A77-A4AD-7D53A22DA031" class="sect4">About Disabling a Privilege Analysis Policy</h4>
<div>
<p>You must disable the privilege analysis policy before you can generate a privilege analysis report.</p>
<p>After you disable the policy, then the privileges are no longer recorded. Disabling a privilege analysis policy takes effect immediately for user sessions logged on both before and after the privilege analysis policy is disabled.</p>
</div>
</div>
<a id="DVADM71390"></a>
<div class="props_rev_3"><a id="GUID-5B18A36B-0419-4F3F-A63C-5F35BE31CA89"></a>
<h4 id="DVADM-GUID-5B18A36B-0419-4F3F-A63C-5F35BE31CA89" class="sect4">Disabling a Privilege Analysis Policy Using Cloud Control</h4>
<div>
<p>You can disable a privilege analysis policy using Cloud Control.</p>
<ol>
<li class="stepexpand"><span>In Enterprise Manager, access the target Database home page as a user who has been granted the <code class="codeph">CAPTURE_ADMIN</code> role and the <code class="codeph">SELECT ANY DICTIONARY</code> privilege.</span>
<div>
<p>See <a class="olink ADMQS033" target="_blank" href="../ADMQS/GUID-E2807CDE-1401-4A79-8131-EBC6D45C71B4.htm#ADMQS033"><span><cite>Oracle Database 2 Day DBA</cite></span></a> for more information.</p>
</div>
</li>
<li class="stepexpand"><span>From the <span class="bold">Security</span> menu, select <span class="bold">Privilege Analysis</span>.</span></li>
<li class="stepexpand"><span>Under Policies, select the policy that you want to disable.</span></li>
<li class="stepexpand"><span>Select <span class="bold">Stop Capture</span>.</span></li>
<li class="stepexpand"><span>In the Privilege Analysis: Stop Capture dialog box, do the following: specify a time to stop the privilege analysis policy.</span>
<div>
<p>To stop the policy now, select <span class="bold">Immediate</span>. To stop the policy later, select <span class="bold">Later</span>, and then specify the hour, minute, second, and the time zone for the policy to stop.</p>
</div>
</li>
<li class="stepexpand"><span>Click <span class="bold">OK</span>.</span></li>
</ol>
</div>
</div>
<a id="DVADM71391"></a>
<div class="props_rev_3"><a id="GUID-ECD0AC5D-0EDD-4AF0-84D9-401749659786"></a>
<h4 id="DVADM-GUID-ECD0AC5D-0EDD-4AF0-84D9-401749659786" class="sect4">Disabling a Privilege Analysis Policy Using DBMS_PRIVILEGE_CAPTURE</h4>
<div>
<p>The <code class="codeph">DBMS_PRIVILEGE_CAPTURE.DISABLE_CAPTURE</code> procedure disables a privilege analysis policy.</p>
<ol>
<li class="stepexpand"><span>Query the <code class="codeph">NAME</code> and <code class="codeph">ENABLED</code> columns of the <code class="codeph">DBA_PRIV_CAPTURES</code> data dictionary view to find the existing privilege analysis policies and whether they are currently disabled.</span></li>
<li class="stepexpand"><span>Run the <code class="codeph">DBMS_PRIVILEGE_CAPTURE.DISBLE_CAPTURE</code> procedure to enable the policy.</span>
<div>
<p>For example, to disable the privilege analysis policy <code class="codeph">logon_users_analysis</code>:</p>
<pre dir="ltr">EXEC DBMS_PRIVILEGE_CAPTURE.DISABLE_CAPTURE (&#39;logon_users_analysis_pol&#39;);
</pre></div>
</li>
</ol>
</div>
</div>
</div>
<a id="DVADM682"></a>
<div class="props_rev_3"><a id="GUID-09B5E21E-5C5B-4171-B6D7-32DDF7EA1222"></a>
<h3 id="DVADM-GUID-09B5E21E-5C5B-4171-B6D7-32DDF7EA1222" class="sect3">Generating a Privilege Analysis Report</h3>
<div>
<p>You can generate a privilege analysis policy report using either Enterprise Manager Cloud Control or from SQL*Plus, using the <code class="codeph">DBMS_PRIVILEGE_CAPTURE</code> PL/SQL package.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="priv_analysis.htm#GUID-AFC16E86-D7BF-4AD7-A127-CDA6D04A9077" title="After the privilege analysis policy has been disabled, you can generate a report.">About Generating a Privilege Analysis Report</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-27D2232F-38AF-415A-BD64-69D368FB0FC0" title="You can generate a privilege analysis report using Cloud Control.">Generating a Privilege Analysis Report Using Cloud Control</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-E44DCDB5-9687-4355-93CA-3836ACBF9AA5" title="A privilege analysis report provides information about both used and unused privileges.">Accessing Privilege Analysis Reports Using Cloud Control</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-67406253-7709-4F74-B962-EDFCA1CCB2F9" title="The DBMS_PRIVILEGE_CAPTURE.GENERATE_RESULT procedure generates a report showing the results of a privilege capture.">Generating a Privilege Analysis Report Using DBMS_PRIVILEGE_CAPTURE</a></p>
</li>
</ul>
</div>
<a id="DVADM71392"></a>
<div class="props_rev_3"><a id="GUID-AFC16E86-D7BF-4AD7-A127-CDA6D04A9077"></a>
<h4 id="DVADM-GUID-AFC16E86-D7BF-4AD7-A127-CDA6D04A9077" class="sect4">About Generating a Privilege Analysis Report</h4>
<div>
<p>After the privilege analysis policy has been disabled, you can generate a report.</p>
<p>In Enterprise Manager Cloud Control, you can view the reports from the Privilege Analysis page <span class="bold">Actions</span> menu, and from there, revoke and regrant roles and privileges as necessary. To view the report results in SQL*Plus, query the data dictionary views in <a href="priv_analysis.htm#GUID-2F1929EB-8EB5-4678-BBC9-EE4A8056D112" title="Oracle Database provides data dictionary views that show information about analyzed privileges.">Privilege Analysis Policy and Report Data Dictionary Views</a>. If a privilege is used during the privilege analysis process and then revoked before you generate the report, then the privilege is still reported as a used privilege, but without the privilege grant path.</p>
</div>
</div>
<a id="DVADM71393"></a>
<div class="props_rev_3"><a id="GUID-27D2232F-38AF-415A-BD64-69D368FB0FC0"></a>
<h4 id="DVADM-GUID-27D2232F-38AF-415A-BD64-69D368FB0FC0" class="sect4">Generating a Privilege Analysis Report Using Cloud Control</h4>
<div>
<p>You can generate a privilege analysis report using Cloud Control.</p>
<ol>
<li class="stepexpand"><span>In Enterprise Manager, access the target Database home page as a user who has been granted the <code class="codeph">CAPTURE_ADMIN</code> role and the <code class="codeph">SELECT ANY DICTIONARY</code> privilege.</span>
<div>
<p>See <a class="olink ADMQS033" target="_blank" href="../ADMQS/GUID-E2807CDE-1401-4A79-8131-EBC6D45C71B4.htm#ADMQS033"><span><cite>Oracle Database 2 Day DBA</cite></span></a> for more information.</p>
</div>
</li>
<li class="stepexpand"><span>From the <span class="bold">Security</span> menu, select <span class="bold">Privilege Analysis</span>.</span></li>
<li class="stepexpand"><span>Under Policies, select the policy whose report you want to generate.</span></li>
<li class="stepexpand"><span>Select <span class="bold">Generate Report</span>.</span></li>
<li class="stepexpand"><span>In the Privilege Analysis: Generate Report dialog box, specify a time to generate the report.</span>
<div>
<p>To generate the report now, select <span class="bold">Immediate</span>. To generate the report later, select <span class="bold">Later</span>, and then specify the hour, minute, second, and the time zone for the report to generate.</p>
</div>
</li>
<li class="stepexpand"><span>Click <span class="bold">OK</span>.</span>
<div>
<p>In the Privilege Analysis page, a Confirmation message notifies you that a report has been submitted. You can refresh the page until the job is complete. To view the report, select the policy name and then click <span class="bold">View Reports</span>.</p>
</div>
</li>
</ol>
</div>
</div>
<a id="DVADM71419"></a>
<div class="props_rev_3"><a id="GUID-E44DCDB5-9687-4355-93CA-3836ACBF9AA5"></a>
<h4 id="DVADM-GUID-E44DCDB5-9687-4355-93CA-3836ACBF9AA5" class="sect4">Accessing Privilege Analysis Reports Using Cloud Control</h4>
<div>
<p>A privilege analysis report provides information about both used and unused privileges.</p>
<ol>
<li class="stepexpand"><span>Generate the privilege analysis report.</span>
<div>
<p>See <a href="priv_analysis.htm#GUID-27D2232F-38AF-415A-BD64-69D368FB0FC0" title="You can generate a privilege analysis report using Cloud Control.">Generating a Privilege Analysis Report Using Cloud Control</a> for more information.</p>
</div>
</li>
<li class="stepexpand"><span>In the Privilege Analysis page, select the policy on which you generated a report.</span></li>
<li class="stepexpand"><span>From the <span class="bold">Actions</span> menu, select <span class="bold">Reports</span>.</span>
<div>
<p>The Privilege Analysis Reports page appears. The following image shows the <span class="bold">Usage Summary</span> tab, with the <span class="bold">Search</span> field expanded. It also shows how many system privileges not used.</p>
<div class="figure" id="GUID-E44DCDB5-9687-4355-93CA-3836ACBF9AA5__GUID-47F57053-CEE3-47EE-B9E0-B997F0E2FB11"><img width="994" height="346" src="img/GUID-11B8260C-3DB1-4130-ADA8-3BCB0155A372-default.gif" alt="Description of GUID-11B8260C-3DB1-4130-ADA8-3BCB0155A372-default.gif follows" title="Description of GUID-11B8260C-3DB1-4130-ADA8-3BCB0155A372-default.gif follows"/><br/>
<a href="img_text/GUID-11B8260C-3DB1-4130-ADA8-3BCB0155A372-default.htm">Description of the illustration GUID-11B8260C-3DB1-4130-ADA8-3BCB0155A372-default.gif</a></div>
<!-- class="figure" --></div>
</li>
<li class="stepexpand"><span>Select from the <span class="bold">Usage Summary</span>, <span class="bold">Unused</span>, and <kbd class="userinput">Used</kbd> tabs to find detailed information about the privilege use that was found by the policy.</span>
<div>
<p>From here, you can select roles to revoke or regrant to users as necessary. To do so, select the role nad then click <span class="bold">Revoke</span> or <span class="bold">Regrant</span>.</p>
</div>
</li>
</ol>
</div>
</div>
<a id="DVADM71394"></a>
<div class="props_rev_3"><a id="GUID-67406253-7709-4F74-B962-EDFCA1CCB2F9"></a>
<h4 id="DVADM-GUID-67406253-7709-4F74-B962-EDFCA1CCB2F9" class="sect4">Generating a Privilege Analysis Report Using DBMS_PRIVILEGE_CAPTURE</h4>
<div>
<p>The <code class="codeph">DBMS_PRIVILEGE_CAPTURE.GENERATE_RESULT</code> procedure generates a report showing the results of a privilege capture.</p>
<ol>
<li class="stepexpand"><span>Query the <code class="codeph">NAME</code> and <code class="codeph">ENABLED</code> columns of the <code class="codeph">DBA_PRIV_CAPTURES</code> data dictionary view to find the existing privilege analysis policies and whether they are currently disabled.</span>
<div>
<p>The privilege analysis policy must be disabled before you can generate a privilege analysis report on it.</p>
</div>
</li>
<li class="stepexpand"><span>Run the <code class="codeph">DBMS_PRIVILEGE_CAPTURE.GENERATE_RESULT</code> procedure.</span>
<div>
<p>For example, to generate a report for the privilege analysis policy <code class="codeph">logon_users_analysis</code>:</p>
<pre dir="ltr">EXEC DBMS_PRIVILEGE_CAPTURE.GENERATE_RESULT (&#39;logon_users_analysis&#39;);
</pre></div>
</li>
<li class="stepexpand"><span>Query the used privileges from <code class="codeph">DBA_USED_*</code> data dictionary views with privilege grant paths.</span></li>
</ol>
</div>
</div>
</div>
<a id="DVADM684"></a>
<div class="props_rev_3"><a id="GUID-4CF1EE91-C812-4BB8-BB94-9DE36CAAB72B"></a>
<h3 id="DVADM-GUID-4CF1EE91-C812-4BB8-BB94-9DE36CAAB72B" class="sect3">Dropping a Privilege Analysis Policy</h3>
<div>
<p>You can drop a privilege analysis policy report using either Enterprise Manager Cloud Control or from SQL*Plus, using the <code class="codeph">DBMS_PRIVILEGE_CAPTURE</code> PL/SQL package.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="priv_analysis.htm#GUID-5F27E964-A61C-452C-A1CD-4AC89B600A1F" title="Before you can drop a privilege analysis policy, you must first disable it.">About Dropping a Privilege Analysis Policy</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-1817ED19-9AF1-443D-9C5F-C7B99D29B505" title="You can drop a privilege analysis policy by using Cloud Control.">Dropping a Privilege Analysis Policy Using Cloud Control</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-403B206F-71B5-481E-8FF7-6FEBA2DE1D75" title="The DBMS_PRIVILEGE_CAPTURE.DROP_CAPTURE procedure drops a privilege analysis policy.">Dropping a Privilege Analysis Policy Using the DBMS_PRIVILEGE_CAPTURE Package</a></p>
</li>
</ul>
</div>
<a id="DVADM71395"></a>
<div class="props_rev_3"><a id="GUID-5F27E964-A61C-452C-A1CD-4AC89B600A1F"></a>
<h4 id="DVADM-GUID-5F27E964-A61C-452C-A1CD-4AC89B600A1F" class="sect4">About Dropping a Privilege Analysis Policy</h4>
<div>
<p>Before you can drop a privilege analysis policy, you must first disable it.</p>
<p>Dropping a privilege analysis policy also drops all the used and unused privilege records associated with this privilege analysis.</p>
</div>
</div>
<a id="DVADM71396"></a>
<div class="props_rev_3"><a id="GUID-1817ED19-9AF1-443D-9C5F-C7B99D29B505"></a>
<h4 id="DVADM-GUID-1817ED19-9AF1-443D-9C5F-C7B99D29B505" class="sect4">Dropping a Privilege Analysis Policy Using Cloud Control</h4>
<div>
<p>You can drop a privilege analysis policy by using Cloud Control.</p>
<ol>
<li class="stepexpand"><span>In Enterprise Manager, access the target Database home page as a user who has been granted the <code class="codeph">CAPTURE_ADMIN</code> role and the <code class="codeph">SELECT ANY DICTIONARY</code> privilege.</span>
<div>
<p>See <a class="olink ADMQS033" target="_blank" href="../ADMQS/GUID-E2807CDE-1401-4A79-8131-EBC6D45C71B4.htm#ADMQS033"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information.</p>
</div>
</li>
<li class="stepexpand"><span>From the <span class="bold">Security</span> menu, select <span class="bold">Privilege Analysis</span>.</span></li>
<li class="stepexpand"><span>Under Policies, select the policy that you want to drop.</span></li>
<li class="stepexpand"><span>Select <span class="bold">Delete</span>.</span></li>
<li class="stepexpand"><span>In the Confirmation dialog box, select <span class="bold">Yes</span>.</span></li>
</ol>
</div>
</div>
<a id="DVADM71397"></a>
<div class="props_rev_3"><a id="GUID-403B206F-71B5-481E-8FF7-6FEBA2DE1D75"></a>
<h4 id="DVADM-GUID-403B206F-71B5-481E-8FF7-6FEBA2DE1D75" class="sect4">Dropping a Privilege Analysis Policy Using the DBMS_PRIVILEGE_CAPTURE Package</h4>
<div>
<p>The <code class="codeph">DBMS_PRIVILEGE_CAPTURE.DROP_CAPTURE</code> procedure drops a privilege analysis policy.</p>
<ol>
<li class="stepexpand"><span>Query the <code class="codeph">NAME</code> and <code class="codeph">ENABLE</code> columns of the <code class="codeph">DBA_PRIV_CAPTURES</code> data dictionary view to find the policy and to check if it is enabled or disabled.</span></li>
<li class="stepexpand"><span>If the policy is enabled, then disable it.</span>
<div>
<p>For example:</p>
<pre dir="ltr">EXEC DBMS_PRIVILEGE_CAPTURE.DISABLE_CAPTURE (&#39;logon_users_analysis_pol&#39;);
</pre></div>
</li>
<li class="stepexpand"><span>Run the <code class="codeph">DBMS_PRIVILEGE_CAPTURE.DROP_CAPTURE</code> procedure to drop the policy.</span>
<div>
<p>For example:</p>
<pre dir="ltr">EXEC DBMS_PRIVILEGE_CAPTURE.DROP_CAPTURE (&#39;logon_users_analysis_pol&#39;);
</pre></div>
</li>
</ol>
</div>
</div>
</div>
</div>
<a id="DVADM71436"></a>
<div class="props_rev_3"><a id="GUID-819C319D-2A16-4F3B-BC4E-6D216418F6CA"></a>
<h2 id="DVADM-GUID-819C319D-2A16-4F3B-BC4E-6D216418F6CA" class="sect2">Creating Roles and Managing Privileges Using Cloud Control</h2>
<div>
<p>You can create new roles using privileges found in a privilege analysis report and then grant this role to users.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="priv_analysis.htm#GUID-32E2ACC1-CF16-4843-8149-0DAFA8A659EE" title="You can use the report summary to find the least number of privileges an application needs, and encapsulate these privileges into a role.">Creating a Role from a Privilege Analysis Report in Cloud Control</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-7FEDBD68-0F3F-4856-9D48-B90AEB692361" title="You can use Enterprise Manager Cloud Control to revoke and regrant roles and privileges to users.">Revoking and Regranting Roles and Privileges Using Cloud Control</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-52659855-2B5E-4E93-80EE-174679594BE9" title="You can perform a bulk revoke of unused system and object privileges and roles by using scripts that you can download after you have generated the privilege analysis. You can use Enterprise Manager Cloud Control to generate a script that regrants privileges that have been revoked from users.">Generating a Revoke or Regrant Script Using Cloud Control</a></p>
</li>
</ul>
</div>
<a id="DVADM71437"></a>
<div class="props_rev_3"><a id="GUID-32E2ACC1-CF16-4843-8149-0DAFA8A659EE"></a>
<h3 id="DVADM-GUID-32E2ACC1-CF16-4843-8149-0DAFA8A659EE" class="sect3">Creating a Role from a Privilege Analysis Report in Cloud Control</h3>
<div>
<p>You can use the report summary to find the least number of privileges an application needs, and encapsulate these privileges into a role.</p>
<ol>
<li class="stepexpand"><span>Access the Privilege Analysis page.</span>
<div>
<p>See <a href="priv_analysis.htm#GUID-E44DCDB5-9687-4355-93CA-3836ACBF9AA5" title="A privilege analysis report provides information about both used and unused privileges.">Accessing Privilege Analysis Reports Using Cloud Control</a> for more information.</p>
</div>
</li>
<li class="stepexpand"><span>On the Privilege Analysis page, select the policy name, and then from <span class="bold">Actions</span> menu, click <span class="bold">Create Role</span>.</span></li>
<li class="stepexpand"><span>On the Create Role page, provide the following details, and then click <span class="bold">OK</span>:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p>Select the policy from which you would like to create a new role.</p>
</li>
<li>
<p>Enter a unique name for the new role that you want to create.</p>
</li>
<li>
<p>Select the <span class="bold">Used</span> or <span class="bold">Unused</span> check box, depending on what your role must encapsulate. The role can have used or unused system and object privileges and roles.</p>
</li>
<li>
<p>Select the corresponding radio buttons for <span class="bold">Directly Granted System Privileges</span>, <span class="bold">Directly Granted Object Privileges</span>, and <span class="bold">Directly Granted Roles</span>.</p>
<p>For example, if you select the <span class="bold">Used</span> check box, and select:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">All</span> system privileges, then all the used system privileges captured are included in the new role that you are creating.</p>
</li>
<li>
<p><span class="bold">None</span> for role, then no role that is captured in the policy will be used in the new role.</p>
</li>
<li>
<p><span class="bold">Customize</span> object privileges, then a list of available used objects privileges captured are displayed, you need to select the privileges from the list to assign to the role.</p>
</li>
</ul>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<a id="DVADM71422"></a>
<div class="props_rev_3"><a id="GUID-7FEDBD68-0F3F-4856-9D48-B90AEB692361"></a>
<h3 id="DVADM-GUID-7FEDBD68-0F3F-4856-9D48-B90AEB692361" class="sect3">Revoking and Regranting Roles and Privileges Using Cloud Control</h3>
<div>
<p>You can use Enterprise Manager Cloud Control to revoke and regrant roles and privileges to users.</p>
<ol>
<li class="stepexpand"><span>If Oracle Database Vault is enabled, then ensure that you are authorized as an owner of the Oracle System Privilege and Role Management realm.</span>
<div>
<p>In SQL*Plus, a user who has been granted the <code class="codeph">DV_OWNER</code> role can check the authorization by querying the <code class="codeph">DVSYS.DBA_DV_REALM_AUTH</code> data dictionary view. To grant the user authorization, use the <code class="codeph">DBMS_MACADM.ADD_AUTH_TO_REALM</code> procedure.</p>
</div>
</li>
<li class="stepexpand"><span>Access the Privilege Analysis Reports page.</span>
<div>
<p>In the Privilege Analysis page, select the policy that is associated with the report, and then from the <span class="bold">Actions</span> menu, select <span class="bold">Reports</span>.</p>
</div>
</li>
<li class="stepexpand"><span>In the Privilege Analysis Reports page, expand the grantee whose privileges you want to revoke or regrant.</span>
<div>
<p>The following image shows the <code class="codeph">EXP_FULL_DATABASE</code> role, which can be revoked.</p>
<div class="figure" id="GUID-7FEDBD68-0F3F-4856-9D48-B90AEB692361__GUID-69B67A52-3CCD-4FF6-A898-7FEA2286B4D5"><img width="983" height="442" src="img/GUID-4EE55F7B-836E-438A-85B3-EA710FCA0008-default.gif" alt="Description of GUID-4EE55F7B-836E-438A-85B3-EA710FCA0008-default.gif follows" title="Description of GUID-4EE55F7B-836E-438A-85B3-EA710FCA0008-default.gif follows"/><br/>
<a href="img_text/GUID-4EE55F7B-836E-438A-85B3-EA710FCA0008-default.htm">Description of the illustration GUID-4EE55F7B-836E-438A-85B3-EA710FCA0008-default.gif</a></div>
<!-- class="figure" --></div>
</li>
<li class="stepexpand"><span>Select a category under this user name, such as a specific role, or the privileges listed in the <span class="bold">System Privileges</span> or <span class="bold">Object Privileges</span> folders.</span>
<div>
<p>The <span class="bold">Revoke</span> button is enabled if the role or privilege is currently granted to the user. If it is not, then the <span class="bold">Regrant</span> button is enabled.</p>
</div>
</li>
<li class="stepexpand"><span>To revoke the role or privilege, select <span class="bold">Revoke</span>; to regrant it, select <span class="bold">Regrant</span>.</span></li>
<li class="stepexpand"><span>In the Confirmation window, select <span class="bold">Yes</span>.</span></li>
</ol>
</div>
</div>
<a id="DVADM71402"></a>
<div class="props_rev_3"><a id="GUID-52659855-2B5E-4E93-80EE-174679594BE9"></a>
<h3 id="DVADM-GUID-52659855-2B5E-4E93-80EE-174679594BE9" class="sect3">Generating a Revoke or Regrant Script Using Cloud Control</h3>
<div>
<p>You can generate a script that revokes or regrants privileges from and to users, based on the results of privilege analysis reports.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="priv_analysis.htm#GUID-BAF8C605-D14A-49A8-B819-B39EC18D0FAE" title="You can perform a bulk revoke of unused system and object privileges and roles by using scripts that you can download after you have generated the privilege analysis.">About Generating Revoke and Regrant Scripts</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-D7DD58E0-6884-4A7E-B593-1A6CC5612081">Generating a Revoke Script</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-80C2B380-C315-43BD-AC09-077FF7F4F09B" title="You can use Enterprise Manager Cloud Control to generate a script that regrants privileges that have been revoked from users.">Generating a Regrant Script</a></p>
</li>
</ul>
</div>
<a id="DVADM71405"></a>
<div class="props_rev_3"><a id="GUID-BAF8C605-D14A-49A8-B819-B39EC18D0FAE"></a>
<h4 id="DVADM-GUID-BAF8C605-D14A-49A8-B819-B39EC18D0FAE" class="sect4">About Generating Revoke and Regrant Scripts</h4>
<div>
<p>You can perform a bulk revoke of unused system and object privileges and roles by using scripts that you can download after you have generated the privilege analysis.</p>
<p>Later on, if you want to regrant these privileges back to the user, you can generate a regrant script. In order to generate the regrant script, you must have a corresponding revoke script.</p>
<p>Execute the revoke scripts in a development or test environment. Be aware that you cannot revoke privileges and roles from Oracle-supplied accounts and roles.</p>
</div>
</div>
<a id="DVADM71406"></a>
<div class="props_rev_3"><a id="GUID-D7DD58E0-6884-4A7E-B593-1A6CC5612081"></a>
<h4 id="DVADM-GUID-D7DD58E0-6884-4A7E-B593-1A6CC5612081" class="sect4">Generating a Revoke Script</h4>
<div>
<div class="section">
<p>You can use Enterprise Manager Cloud Control to generate a script that revokes privileges from users.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>If Oracle Database Vault is enabled, then ensure that you are authorized as an owner of the Oracle System Privilege and Role Management realm.</span>
<div>
<p>In SQL*Plus, a user who has been granted the <code class="codeph">DV_OWNER</code> role can check the authorization by querying the <code class="codeph">DVSYS.DBA_DV_REALM_AUTH</code> data dictionary view. To grant the user authorization, use the <code class="codeph">DBMS_MACADM.ADD_AUTH_TO_REALM</code> procedure.</p>
</div>
</li>
<li class="stepexpand"><span>In<a id="d13268e5345" class="indexterm-anchor"></a> Enterprise Manager, access the target Database home page as a user who has been granted the <code class="codeph">CAPTURE_ADMIN</code> role and the <code class="codeph">SELECT ANY DICTIONARY</code> privilege.</span>
<div>
<p>See <a class="olink ADMQS033" target="_blank" href="../ADMQS/GUID-E2807CDE-1401-4A79-8131-EBC6D45C71B4.htm#ADMQS033"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information.</p>
</div>
</li>
<li class="stepexpand"><span>From the <span class="bold">Security</span> menu, select <span class="bold">Privilege Analysis</span>.</span></li>
<li class="stepexpand"><span>Ensure that the reports you want have been generated.</span>
<div>
<p>See <span class="q">&#34;<a href="priv_analysis.htm#GUID-27D2232F-38AF-415A-BD64-69D368FB0FC0" title="You can generate a privilege analysis report using Cloud Control.">Generating a Privilege Analysis Report Using Cloud Control</a>&#34;</span> for more information.</p>
</div>
</li>
<li class="stepexpand"><span>In the Privilege Analysis page, from the <span class="bold">Actions</span> menu, select <span class="bold">Revoke Scripts</span>.</span></li>
<li class="stepexpand"><span>On the Revoke Scripts page, click <span class="bold">Generate</span>.</span>
<div>
<p>The generate revoke script details wizard is displayed.</p>
</div>
</li>
<li class="stepexpand"><span>In the Script Details page, select a policy name from the menu against which the revoke script needs to be prepared.</span></li>
<li class="stepexpand"><span>Enter a unique name and description for the script.</span>
<div>
<p>For example, if you want to revoke all the unused privileges, select the <span class="bold">All</span> option for all the privileges and roles, and click <span class="bold">Next</span>.</p>
<p>Based on your selection, and the available privileges, all the unused system privileges, object privileges, and roles that are going to be revoked are displayed on the respective pages.</p>
</div>
</li>
<li class="stepexpand"><span>Click <span class="bold">Next</span>.</span>
<div>
<p>On the Review page, you can see a list of all the privileges that are going to be included in the revoke script.</p>
</div>
</li>
<li class="stepexpand"><span>Click <span class="bold">Save</span>.</span>
<div>
<p>A Confirmation window appears.</p>
</div>
</li>
<li class="stepexpand"><span>In the Revoke Scripts page, find the newly created SQL script, and then click <span class="bold">Revoke Script</span> to download this script.</span></li>
</ol>
</div>
</div>
<a id="DVADM71407"></a>
<div class="props_rev_3"><a id="GUID-80C2B380-C315-43BD-AC09-077FF7F4F09B"></a>
<h4 id="DVADM-GUID-80C2B380-C315-43BD-AC09-077FF7F4F09B" class="sect4">Generating a Regrant Script</h4>
<div>
<p>You can use Enterprise Manager Cloud Control to generate a script that regrants privileges that have been revoked from users.</p>
<ol>
<li class="stepexpand"><span>If Oracle Database Vault is enabled, then ensure that you are authorized as an owner of the Oracle System Privilege and Role Management realm.</span>
<div>
<p>In SQL*Plus, a user who has been granted the <code class="codeph">DV_OWNER</code> role can check the authorization by querying the <code class="codeph">DVSYS.DBA_DV_REALM_AUTH</code> data dictionary view. To grant the user authorization, use the <code class="codeph">DBMS_MACADM.ADD_AUTH_TO_REALM</code> procedure.</p>
</div>
</li>
<li class="stepexpand"><span>In Enterprise Manager, access the target Database home page as a user who has been granted the <code class="codeph">CAPTURE_ADMIN</code> role and the <code class="codeph">SELECT ANY DICTIONARY</code> privilege.</span>
<div>
<p>See <a class="olink ADMQS033" target="_blank" href="../ADMQS/GUID-E2807CDE-1401-4A79-8131-EBC6D45C71B4.htm#ADMQS033"><span><cite>Oracle Database 2 Day DBA</cite></span></a> for more information.</p>
</div>
</li>
<li class="stepexpand"><span>From the <span class="bold">Security</span> menu, select <span class="bold">Privilege Analysis</span>.</span></li>
<li class="stepexpand"><span>Ensure that the reports you want have been generated.</span>
<div>
<p>See <a href="priv_analysis.htm#GUID-27D2232F-38AF-415A-BD64-69D368FB0FC0" title="You can generate a privilege analysis report using Cloud Control.">Generating a Privilege Analysis Report Using Cloud Control</a> for more information.</p>
</div>
</li>
<li class="stepexpand"><span>In the Privilege Analysis page, from the <span class="bold">Actions</span> menu, select <span class="bold">Revoke Scripts</span>.</span></li>
<li class="stepexpand"><span>In the Revoke Scripts page, find the regrant script that corresponds to the revoke script that you had generated earlier, and then click <span class="bold">Regrant Script</span> to download this script.</span></li>
</ol>
</div>
</div>
</div>
</div>
<a id="DVADM1005"></a>
<div class="props_rev_3"><a id="GUID-0A2B341F-FDFB-486E-9F93-B2063F82CC13"></a>
<h2 id="DVADM-GUID-0A2B341F-FDFB-486E-9F93-B2063F82CC13" class="sect2">Tutorial: Analyzing ANY Privilege Use</h2>
<div>
<p>This tutorial demonstrates how to use privilege analysis to analyze the use of the <code class="codeph">READ ANY TABLE</code> system privilege.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="priv_analysis.htm#GUID-E6A53756-A25B-4AA9-8CFA-A90E0B5009CF" title="You must create two users, one user to create the policy and a second user whose privilege use will be analyzed.">Step 1: Create User Accounts</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-7D38155B-51F7-4FF9-B24D-1FBDF64F923A" title="The user pa_admin must create and enable the privilege analysis policy.">Step 2: Create and Enable a Privilege Analysis Policy</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-5DAB3004-561B-424C-A473-71000980E578" title="User app_user uses the READ ANY TABLE system privilege.">Step 3: Use the READ ANY TABLE System Privilege</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-A7FF0521-F296-4821-84F1-3F4580E281A6" title="You must disable the policy before you can generate a report that captures the actions of user app_user.">Step 4: Disable the Privilege Analysis Policy</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-B3D1C54B-9FFB-4376-B767-12A631E3F66D" title="With the privilege analysis policy disabled, user pa_admin then can generate and view a privilege analysis report.">Step 5: Generate and View a Privilege Analysis Report</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-1FA9F206-75C2-4FC9-BA53-A17118A2C934" title="You can remove the components that you created for this tutorial if you no longer need them.">Step 6: Remove the Components for This Tutorial</a></p>
</li>
</ul>
</div>
<a id="DVADM1007"></a>
<div class="props_rev_3"><a id="GUID-E6A53756-A25B-4AA9-8CFA-A90E0B5009CF"></a>
<h3 id="DVADM-GUID-E6A53756-A25B-4AA9-8CFA-A90E0B5009CF" class="sect3">Step 1: Create User Accounts</h3>
<div>
<p>You must create two users, one user to create the policy and a second user whose privilege use will be analyzed.</p>
<ol>
<li class="stepexpand"><span>Log into the database instance as a user who has been granted the <code class="codeph">DV_ACCTMGR</code> role.</span>
<div>
<p>For example:</p>
<pre dir="ltr">sqlplus bea_dvacctmgr
Enter password: <span class="italic">password</span>
</pre>
<p>In a multitenant environment, you must connect to the appropriate pluggable database (PDB).</p>
<p>For example:</p>
<pre dir="ltr">sqlplus bea_dvacctmgr@hrpdb
Enter password: <span class="italic">password</span>
</pre>
<p>To find the available PDBs, query the <code class="codeph">DBA_PDBS</code> data dictionary view. To check the current PDB, run the <code class="codeph">show con_name</code> command.</p>
<p>If Oracle Database Vault is not enabled, then log into the database instance as a user who has the <code class="codeph">CREATE USER</code> system privilege.</p>
</div>
</li>
<li class="stepexpand"><span>Create the following users:</span>
<div>
<pre dir="ltr">CREATE USER pa_admin IDENTIFIED BY <span class="italic">password</span>;
CREATE USER app_user IDENTIFIED BY <span class="italic">password</span>;
</pre></div>
</li>
<li class="stepexpand"><span>Connect as a user who has the privileges to grant roles and system privileges to other users, and who has been granted the owner authorization for the Oracle System Privilege and Role Management realm. (User <code class="codeph">SYS</code> has these privileges by default.)</span>
<div>
<p>For example:</p>
<pre dir="ltr">CONNECT dba_psmith <span class="italic">-- Or, CONNECT dba_psmith@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre>
<p>In SQL*Plus, a user who has been granted the <code class="codeph">DV_OWNER</code> role can check the authorization by querying the <code class="codeph">DVSYS.DBA_DV_REALM_AUTH</code> data dictionary view. To grant the user authorization, use the <code class="codeph">DBMS_MACADM.ADD_AUTH_TO_REALM</code> procedure.</p>
</div>
</li>
<li class="stepexpand"><span>Grant the following role and privilege to the users.</span>
<div>
<pre dir="ltr">GRANT CREATE SESSION, CAPTURE_ADMIN TO pa_admin;
GRANT CREATE SESSION, READ ANY TABLE TO app_user;
</pre>
<p>User <code class="codeph">pa_admin</code> will create the privilege analysis policy that will analyze the <code class="codeph">READ ANY TABLE</code> query that user <code class="codeph">app_user</code> will perform.</p>
</div>
</li>
</ol>
</div>
</div>
<a id="DVADM1008"></a>
<div class="props_rev_3"><a id="GUID-7D38155B-51F7-4FF9-B24D-1FBDF64F923A"></a>
<h3 id="DVADM-GUID-7D38155B-51F7-4FF9-B24D-1FBDF64F923A" class="sect3">Step 2: Create and Enable a Privilege Analysis Policy</h3>
<div>
<p>The user <code class="codeph">pa_admin</code> must create and enable the privilege analysis policy.</p>
<ol>
<li class="stepexpand"><span>Connect as user <code class="codeph">pa_admin</code>.</span>
<div>
<pre dir="ltr">CONNECT pa_admin <span class="italic">-- Or, CONNECT pa_admin@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre></div>
</li>
<li class="stepexpand"><span>Create the following privilege analysis policy:</span>
<div>
<pre dir="ltr">BEGIN
 DBMS_PRIVILEGE_CAPTURE.CREATE_CAPTURE(
  name           =&gt; &#39;ANY_priv_analysis_pol&#39;,
  description    =&gt; &#39;Analyzes system privilege use&#39;,
  type           =&gt; DBMS_PRIVILEGE_CAPTURE.G_CONTEXT,
  condition      =&gt; &#39;SYS_CONTEXT(&#39;&#39;USERENV&#39;&#39;, &#39;&#39;SESSION_USER&#39;&#39;)=&#39;&#39;APP_USER&#39;&#39;&#39;);
END;
/
</pre>
<p>In this example:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">type</code> specifies the type of capture condition that is defined by the <code class="codeph">condition</code> parameter, described next. In this policy, the type is a context-based condition.</p>
</li>
<li>
<p><code class="codeph">condition</code> specifies condition using a Boolean expression that must evaluate to <code class="codeph">TRUE</code> for the policy to take effect. In this case, the condition checks if the session user is <code class="codeph">app_user</code>.</p>
</li>
</ul>
</div>
</li>
<li class="stepexpand"><span>Enable the policy.</span>
<div>
<pre dir="ltr">EXEC DBMS_PRIVILEGE_CAPTURE.ENABLE_CAPTURE (&#39;ANY_priv_analysis_pol&#39;);
</pre>
<p>At this point, the policy is ready to start recording the actions of user <code class="codeph">app_user</code>.</p>
</div>
</li>
</ol>
</div>
</div>
<a id="DVADM1009"></a>
<div class="props_rev_3"><a id="GUID-5DAB3004-561B-424C-A473-71000980E578"></a>
<h3 id="DVADM-GUID-5DAB3004-561B-424C-A473-71000980E578" class="sect3">Step 3: Use the READ ANY TABLE System Privilege</h3>
<div>
<p>User <code class="codeph">app_user</code> uses the <code class="codeph">READ ANY TABLE</code> system privilege.</p>
<ol>
<li class="stepexpand"><span>Connect as user <code class="codeph">app_user</code>.</span>
<div>
<pre dir="ltr">CONNECT app_user <span class="italic">-- Or, CONNECT app_user@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre></div>
</li>
<li class="stepexpand"><span>Query the <code class="codeph">HR.EMPLOYEES</code> table.</span>
<div>
<pre dir="ltr">SELECT FIRST_NAME, LAST_NAME, SALARY FROM HR.EMPLOYEES WHERE SALARY &gt; 12000 ORDER BY SALARY DESC;

FIRST_NAME           LAST_NAME                     SALARY
-------------------- ------------------------- ----------
Steven               King                           24000
Neena                Kochhar                        17000
Lex                  De Haan                        17000
John                 Russell                        14000
Karen                Partners                       13500
Michael              Hartstein                      13000
Shelley              Higgins                        12008
Nancy                Greenberg                      12008
</pre></div>
</li>
</ol>
</div>
</div>
<a id="DVADM1010"></a>
<div class="props_rev_3"><a id="GUID-A7FF0521-F296-4821-84F1-3F4580E281A6"></a>
<h3 id="DVADM-GUID-A7FF0521-F296-4821-84F1-3F4580E281A6" class="sect3">Step 4: Disable the Privilege Analysis Policy</h3>
<div>
<p>You must disable the policy before you can generate a report that captures the actions of user <code class="codeph">app_user</code>.</p>
<ol>
<li class="stepexpand"><span>Connect as user <code class="codeph">pa_admin</code>.</span>
<div>
<pre dir="ltr">CONNECT pa_admin <span class="italic">-- Or, CONNECT pa_admin@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre></div>
</li>
<li class="stepexpand"><span>Disable the <code class="codeph">ANY_priv_analysis_pol</code> privilege policy.</span>
<div>
<pre dir="ltr">EXEC DBMS_PRIVILEGE_CAPTURE.DISABLE_CAPTURE (&#39;ANY_priv_analysis_pol&#39;);
</pre></div>
</li>
</ol>
</div>
</div>
<a id="DVADM1011"></a>
<div class="props_rev_3"><a id="GUID-B3D1C54B-9FFB-4376-B767-12A631E3F66D"></a>
<h3 id="DVADM-GUID-B3D1C54B-9FFB-4376-B767-12A631E3F66D" class="sect3">Step 5: Generate and View a Privilege Analysis Report</h3>
<div>
<p>With the privilege analysis policy disabled, user <code class="codeph">pa_admin</code> then can generate and view a privilege analysis report.</p>
<ol>
<li class="stepexpand"><span>As user <code class="codeph">pa_admin</code>, generate the privilege analysis results.</span>
<div>
<pre dir="ltr">EXEC DBMS_PRIVILEGE_CAPTURE.GENERATE_RESULT (&#39;ANY_priv_analysis_pol&#39;);
</pre>
<p>The generated results are stored in the privilege analysis data dictionary views, which are described in <span class="q">&#34;<a href="priv_analysis.htm#GUID-2F1929EB-8EB5-4678-BBC9-EE4A8056D112" title="Oracle Database provides data dictionary views that show information about analyzed privileges.">Privilege Analysis Policy and Report Data Dictionary Views</a>.&#34;</span></p>
</div>
</li>
<li class="stepexpand"><span>Enter the following commands to format the data dictionary view output:</span>
<div>
<pre dir="ltr">col username format a10
col sys_priv format a16
col object_owner format a13
col object_name format a23
</pre></div>
</li>
<li class="stepexpand"><span>Find the system privileges that <code class="codeph">app_user</code> used and the objects on which he used them during the privilege analysis period.</span>
<div>
<pre dir="ltr">SELECT USERNAME, SYS_PRIV, OBJECT_OWNER, OBJECT_NAME FROM DBA_USED_PRIVS WHERE USERNAME = &#39;APP_USER&#39;;
</pre>
<p>Output similar to the following appears. The first row shows that <code class="codeph">app_user</code> used the <code class="codeph">READ ANY TABLE</code> privilege on the <code class="codeph">HR.EMPLOYEES</code> table.</p>
<pre dir="ltr">USERNAME   SYS_PRIV             OBJECT_OWNER  OBJECT_NAME
---------- ---------------- ------------- -----------------------
APP_USER                    SYSTEM        PRODUCT_PRIVS
APP_USER                    SYS           DUAL
APP_USER                    SYS           DUAL
APP_USER   CREATE SESSION
APP_USER                    SYS           DBMS_APPLICATION_INFO
APP_USER   READ ANY TABLE   HR            EMPLOYEES
</pre></div>
</li>
</ol>
</div>
</div>
<a id="DVADM1012"></a>
<div class="props_rev_3"><a id="GUID-1FA9F206-75C2-4FC9-BA53-A17118A2C934"></a>
<h3 id="DVADM-GUID-1FA9F206-75C2-4FC9-BA53-A17118A2C934" class="sect3">Step 6: Remove the Components for This Tutorial</h3>
<div>
<p>You can remove the components that you created for this tutorial if you no longer need them.</p>
<ol>
<li class="stepexpand"><span>As user <code class="codeph">pa_admin</code>, drop the <code class="codeph">ANY_priv_analysis_pol</code> privilege analysis policy.</span>
<div>
<pre dir="ltr">EXEC DBMS_PRIVILEGE_CAPTURE.DROP_CAPTURE (&#39;ANY_priv_analysis_pol&#39;);
</pre>
<p>Even though in the next steps you will drop the <code class="codeph">pa_admin</code> user, including any objects created in this user&#39;s schema, you must manually drop the <code class="codeph">ANY_priv_analysis_pol</code> privilege analysis policy because this object resides in the <code class="codeph">SYS</code> schema.</p>
</div>
</li>
<li class="stepexpand"><span>Connect as the user who created the user accounts. If Oracle Database Vault is enabled, then connect as the Oracle Database Vault Account Manager.</span>
<div>
<p>For example:</p>
<pre dir="ltr">CONNECT bea_dvacctmgr <span class="italic">-- Or, CONNECT bea_dvacctmgr@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre></div>
</li>
<li class="stepexpand"><span>Drop the users <code class="codeph">pa_admin</code> and <code class="codeph">app_user</code>.</span>
<div>
<pre dir="ltr">DROP USER pa_admin;
DROP USER app_user;
</pre></div>
</li>
</ol>
</div>
</div>
</div>
<a id="DVADM476"></a>
<div class="props_rev_3"><a id="GUID-3AA55C7A-CD73-4B28-AE02-9D80A69E8B6E"></a>
<h2 id="DVADM-GUID-3AA55C7A-CD73-4B28-AE02-9D80A69E8B6E" class="sect2">Tutorial: Analyzing Privilege Use by a User Who Has the DBA Role</h2>
<div>
<p>This tutorial demonstrates how to analyze the privilege use of a user who has the <code class="codeph">DBA</code> role and performs database tuning operations.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="priv_analysis.htm#GUID-63EFFFC3-A68E-41B1-95BD-7147A0F53E4A" title="You must create two users, one to create the privilege analysis policy and a second user whose privilege use will be analyzed.">Step 1: Create User Accounts</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-8CEAD3FE-9F33-4E2A-9196-31DBA3E59AD6" title="User pa_admin must create the and enable the privilege analysis policy.">Step 2: Create and Enable a Privilege Analysis Policy</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-5ED78334-FB5B-4A37-932D-9D5C5CBD2ED4" title="User tjones uses the DBA role to perform database tuning operations.">Step 3: Perform the Database Tuning Operations</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-11D7DE54-BCAC-49F7-A92D-FB0F8B9C7A6A" title="You must disable the policy before you can generate a report that captures the actions of user tjones.">Step 4: Disable the Privilege Analysis Policy</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-3BB21726-7D0B-4853-8C44-8A1C9BD8E4B9" title="With the privilege analysis policy disabled, user pa_admin can generate and view privilege analysis reports.">Step 5: Generate and View Privilege Analysis Reports</a></p>
</li>
<li>
<p><a href="priv_analysis.htm#GUID-7B824C23-9990-418E-AD33-0D92702EBD3D" title="You can remove the components that you created for this tutorial if you no longer need them.">Step 6: Remove the Components for This Tutorial</a></p>
</li>
</ul>
</div>
<a id="DVADM955"></a>
<div class="props_rev_3"><a id="GUID-63EFFFC3-A68E-41B1-95BD-7147A0F53E4A"></a>
<h3 id="DVADM-GUID-63EFFFC3-A68E-41B1-95BD-7147A0F53E4A" class="sect3">Step 1: Create User Accounts</h3>
<div>
<p>You must create two users, one to create the privilege analysis policy and a second user whose privilege use will be analyzed.</p>
<ol>
<li class="stepexpand"><span>Log into the database instance as a user who has been granted the <code class="codeph">DV_ACCTMGR</code> role.</span>
<div>
<p>For example:</p>
<pre dir="ltr">sqlplus bea_dvacctmgr
Enter password: <span class="italic">password</span>
</pre>
<p>In a multitenant environment, you must log into the appropriate pluggable database (PDB).</p>
<p>For example:</p>
<pre dir="ltr">sqlplus bea_dvacctmgr@hrpdb
Enter password: <span class="italic">password</span>
</pre>
<p>To find the available PDBs, query the <code class="codeph">DBA_PDBS</code> data dictionary view. To check the current PDB, run the <code class="codeph">show con_name</code> command.</p>
<p>If Oracle Database Vault is not enabled, then log into the database instance as a user who has the <code class="codeph">CREATE USER</code> system privilege.</p>
</div>
</li>
<li class="stepexpand"><span>Create the following users:</span>
<div>
<pre dir="ltr">CREATE USER pa_admin IDENTIFIED BY <span class="italic">password</span>;
CREATE USER tjones IDENTIFIED BY <span class="italic">password</span>;
</pre></div>
</li>
<li class="stepexpand"><span>Connect as a user who has the privileges to grant roles and system privileges to other users, and who has been granted the owner authorization for the Oracle System Privilege and Role Management realm. (User <code class="codeph">SYS</code> has these privileges by default.)</span>
<div>
<p>For example:</p>
<pre dir="ltr">CONNECT dba_psmith <span class="italic">-- Or, CONNECT dba_psmith@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre>
<p>In SQL*Plus, a user who has been granted the <code class="codeph">DV_OWNER</code> role can check the authorization by querying the <code class="codeph">DVSYS.DBA_DV_REALM_AUTH</code> data dictionary view. To grant the user authorization, use the <code class="codeph">DBMS_MACADM.ADD_AUTH_TO_REALM</code> procedure.</p>
</div>
</li>
<li class="stepexpand"><span>Grant the following roles and privileges to the users.</span>
<div>
<pre dir="ltr">GRANT CREATE SESSION, CAPTURE_ADMIN TO pa_admin;
GRANT CREATE SESSION, DBA TO tjones;
</pre>
<p>User <code class="codeph">pa_admin</code> will create the privilege analysis policy that will analyze the database tuning operations that user <code class="codeph">tjones</code> will perform.</p>
</div>
</li>
</ol>
</div>
</div>
<a id="DVADM963"></a>
<div class="props_rev_3"><a id="GUID-8CEAD3FE-9F33-4E2A-9196-31DBA3E59AD6"></a>
<h3 id="DVADM-GUID-8CEAD3FE-9F33-4E2A-9196-31DBA3E59AD6" class="sect3">Step 2: Create and Enable a Privilege Analysis Policy</h3>
<div>
<p>User <code class="codeph">pa_admin</code> must create the and enable the privilege analysis policy.</p>
<ol>
<li class="stepexpand"><span>Connect as user <code class="codeph">pa_admin</code>.</span>
<div>
<pre dir="ltr">CONNECT pa_admin <span class="italic">-- Or, CONNECT pa_admin@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre>
<p>If Oracle Database Vault is enabled, then log in as the Database Vault Account Manager, who has the <code class="codeph">DV_ACCTMGR</code> role. Ensure that you are the owner of the Oracle System Privilege and Role Management realm.</p>
</div>
</li>
<li class="stepexpand"><span>Create the following privilege analysis policy:</span>
<div>
<pre dir="ltr">BEGIN
 DBMS_PRIVILEGE_CAPTURE.CREATE_CAPTURE(
  name             =&gt; &#39;dba_tuning_priv_analysis_pol&#39;,
  description      =&gt; &#39;Analyzes DBA tuning privilege use&#39;,
  type             =&gt; DBMS_PRIVILEGE_CAPTURE.G_CONTEXT,
  condition        =&gt; &#39;SYS_CONTEXT(&#39;&#39;USERENV&#39;&#39;, &#39;&#39;SESSION_USER&#39;&#39;)=&#39;&#39;TJONES&#39;&#39;&#39;);
END;
/
</pre>
<p>In this example:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">type</code> specifies the type of capture condition that is defined by the <code class="codeph">condition</code> parameter, described next. In this policy, the type is a context-based condition.</p>
</li>
<li>
<p><code class="codeph">condition</code> specifies condition using a Boolean expression that must evaluate to <code class="codeph">TRUE</code> for the policy to take effect. In this case, the condition checks if the session user is <code class="codeph">tjones</code>.</p>
</li>
</ul>
</div>
</li>
<li class="stepexpand"><span>Enable the policy.</span>
<div>
<pre dir="ltr">EXEC DBMS_PRIVILEGE_CAPTURE.ENABLE_CAPTURE (&#39;dba_tuning_priv_analysis_pol&#39;);
</pre>
<p>At this point, the policy is ready to start recording the actions of user <code class="codeph">tjones</code>.</p>
</div>
</li>
</ol>
</div>
</div>
<a id="DVADM964"></a>
<div class="props_rev_3"><a id="GUID-5ED78334-FB5B-4A37-932D-9D5C5CBD2ED4"></a>
<h3 id="DVADM-GUID-5ED78334-FB5B-4A37-932D-9D5C5CBD2ED4" class="sect3">Step 3: Perform the Database Tuning Operations</h3>
<div>
<p>User <code class="codeph">tjones</code> uses the <code class="codeph">DBA</code> role to perform database tuning operations.</p>
<ol>
<li class="stepexpand"><span>Connect as user <code class="codeph">tjones</code>.</span>
<div>
<pre dir="ltr">CONNECT tjones <span class="italic">-- Or, CONNECT tjones@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre></div>
</li>
<li class="stepexpand"><span>Run the following script to create the <code class="codeph">PLAN_TABLE</code> table.</span>
<div>
<pre dir="ltr">@$ORACLE_HOME/rdbms/admin/utlxplan.sql
</pre>
<p>The location of this script may vary depending on your operating system. This script creates the <code class="codeph">PLAN_TABLE</code> table in the <code class="codeph">tjones</code> schema.</p>
</div>
</li>
<li class="stepexpand"><span>Run the following <code class="codeph">EXPLAIN PLAN</code> SQL statement on the <code class="codeph">HR.EMPLOYEES</code> table:</span>
<div>
<pre dir="ltr">EXPLAIN PLAN
 SET STATEMENT_ID = &#39;Raise in Tokyo&#39; 
 INTO PLAN_TABLE
 FOR UPDATE HR.EMPLOYEES
 SET SALARY = SALARY * 1.10
 WHERE DEPARTMENT_ID = 
  (SELECT DEPARTMENT_ID FROM HR.DEPARTMENTS WHERE LOCATION_ID = 110);
</pre>
<p>Next, user <code class="codeph">tjones</code> will analyze the <code class="codeph">HR.EMPLOYEES</code> table.</p>
</div>
</li>
<li class="stepexpand"><span>Run either of the following scripts to create the <code class="codeph">CHAINED_ROWS</code> table</span>
<div>
<pre dir="ltr">@$ORACLE_HOME/rdbms/admin/utlchain.sql
</pre>
<p>Or</p>
<pre dir="ltr">@$ORACLE_HOME/rdbms/admin/utlchn1.sql
</pre></div>
</li>
<li class="stepexpand"><span>Run the <code class="codeph">ANALYZE TABLE</code> statement on the <code class="codeph">HR.EMPLOYEES</code> table.</span>
<div>
<pre dir="ltr">ANALYZE TABLE HR.EMPLOYEES LIST CHAINED ROWS INTO CHAINED_ROWS;
</pre></div>
</li>
</ol>
</div>
</div>
<a id="DVADM965"></a>
<div class="props_rev_3"><a id="GUID-11D7DE54-BCAC-49F7-A92D-FB0F8B9C7A6A"></a>
<h3 id="DVADM-GUID-11D7DE54-BCAC-49F7-A92D-FB0F8B9C7A6A" class="sect3">Step 4: Disable the Privilege Analysis Policy</h3>
<div>
<p>You must disable the policy before you can generate a report that captures the actions of user <code class="codeph">tjones</code>.</p>
<ol>
<li class="stepexpand"><span>Connect as user <code class="codeph">pa_admin</code>.</span>
<div>
<pre dir="ltr">CONNECT pa_admin <span class="italic">-- Or, CONNECT pa_admin@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre></div>
</li>
<li class="stepexpand"><span>Disable the <code class="codeph">dba_tuning_priv_analysis_pol</code> privilege policy.</span>
<div>
<pre dir="ltr">EXEC DBMS_PRIVILEGE_CAPTURE.DISABLE_CAPTURE (&#39;dba_tuning_priv_analysis_pol&#39;);
</pre></div>
</li>
</ol>
</div>
</div>
<a id="DVADM966"></a>
<div class="props_rev_3"><a id="GUID-3BB21726-7D0B-4853-8C44-8A1C9BD8E4B9"></a>
<h3 id="DVADM-GUID-3BB21726-7D0B-4853-8C44-8A1C9BD8E4B9" class="sect3">Step 5: Generate and View Privilege Analysis Reports</h3>
<div>
<p>With the privilege analysis policy disabled, user <code class="codeph">pa_admin</code> can generate and view privilege analysis reports.</p>
<ol>
<li class="stepexpand"><span>As user <code class="codeph">pa_admin</code>, generate the privilege analysis results.</span>
<div>
<pre dir="ltr">EXEC DBMS_PRIVILEGE_CAPTURE.GENERATE_RESULT (&#39;dba_tuning_priv_analysis_pol&#39;);
</pre>
<p>The generated results are stored in the privilege analysis data dictionary views, which are described in <a href="priv_analysis.htm#GUID-2F1929EB-8EB5-4678-BBC9-EE4A8056D112" title="Oracle Database provides data dictionary views that show information about analyzed privileges.">Privilege Analysis Policy and Report Data Dictionary Views</a>.</p>
</div>
</li>
<li class="stepexpand"><span>Enter the following commands to format the data dictionary view output:</span>
<div>
<pre dir="ltr">col username format a8
col sys_priv format a18
col used_role format a20
col path format a150
col obj_priv format a10
col object_owner format a10
col object_name format a10
col object_type format a10
</pre></div>
</li>
<li class="stepexpand"><span>Find the system privileges and roles that user <code class="codeph">tjones</code> used during the privilege analysis period.</span>
<div>
<pre dir="ltr">SELECT USERNAME, SYS_PRIV, USED_ROLE, PATH
 FROM DBA_USED_SYSPRIVS_PATH
 WHERE USERNAME = &#39;TJONES&#39;
 ORDER BY 1, 2, 3;
</pre>
<p>Output similar to the following appears:</p>
<pre dir="ltr">USERNAME SYS_PRIV           USED_ROLE
-------- ------------------ --------------------
PATH
-------------------------------------------------------------------------------
TJONES   ANALYZE ANY        IMP_FULL_DATABASE
GRANT_PATH(&#39;TJONES&#39;, &#39;DBA&#39;)

TJONES   ANALYZE ANY        IMP_FULL_DATABASE
GRANT_PATH(&#39;TJONES&#39;, &#39;DBA&#39;, &#39;IMP_FULL_DATABASE&#39;)

TJONES   ANALYZE ANY        IMP_FULL_DATABASE
GRANT_PATH(&#39;TJONES&#39;, &#39;DBA&#39;, &#39;DATAPUMP_IMP_FULL_DATABASE&#39;, &#39;IMP_FULL_DATABASE&#39;)
...
</pre>
<pre dir="ltr"></pre></div>
</li>
<li class="stepexpand"><span>Find the object privileges and roles that user <code class="codeph">tjones</code> used during the privilege analysis period.</span>
<div>
<pre dir="ltr">col username format a9
col used_role format a10
col object_name format a22
col object_type format a12

SELECT USERNAME, OBJ_PRIV, USED_ROLE,
 OBJECT_OWNER, OBJECT_NAME, OBJECT_TYPE
 FROM DBA_USED_OBJPRIVS 
 WHERE USERNAME = &#39;TJONES&#39;
 ORDER BY 1, 2, 3, 4, 5, 6;
</pre>
<p>Output similar to the following appears:</p>
<pre dir="ltr">USERNAME  OBJ_PRIV   USED_ROLE  OBJECT_OWN OBJECT_NAME            OBJECT_TYPE
--------- ---------- ---------- ---------- ---------------------- ------------
TJONES    EXECUTE    PUBLIC     SYS        DBMS_APPLICATION_INFO  PACKAGE
TJONES    SELECT     PUBLIC     SYS        DUAL                   TABLE
TJONES    SELECT     PUBLIC     SYS        DUAL                   TABLE
TJONES    SELECT     PUBLIC     SYSTEM     PRODUCT_PRIVS          VIEW
...
</pre></div>
</li>
<li class="stepexpand"><span>Find the unused system privileges for user <code class="codeph">tjones</code>.</span>
<div>
<pre dir="ltr">col username format a9
col sys_priv format a35

SELECT USERNAME, SYS_PRIV
 FROM DBA_UNUSED_SYSPRIVS
 WHERE USERNAME = &#39;TJONES&#39;
 ORDER BY 1, 2;

USERNAME SYS_PRIV
-------- ------------------------------
TJONES   ADMINISTER ANY SQL TUNING SET
TJONES   ADMINISTER DATABASE TRIGGER
TJONES   ADMINISTER RESOURCE MANAGER
TJONES   ADMINISTER SQL TUNING SET
TJONES   ALTER ANY ASSEMBLY
TJONES   ON COMMIT REFRESH
...
</pre></div>
</li>
</ol>
</div>
</div>
<a id="DVADM992"></a>
<div class="props_rev_3"><a id="GUID-7B824C23-9990-418E-AD33-0D92702EBD3D"></a>
<h3 id="DVADM-GUID-7B824C23-9990-418E-AD33-0D92702EBD3D" class="sect3">Step 6: Remove the Components for This Tutorial</h3>
<div>
<p>You can remove the components that you created for this tutorial if you no longer need them.</p>
<ol>
<li class="stepexpand"><span>As user <code class="codeph">pa_admin</code>, drop the <code class="codeph">dba_tuning_priv_analysis_pol</code> privilege analysis policy.</span>
<div>
<pre dir="ltr">EXEC DBMS_PRIVILEGE_CAPTURE.DROP_CAPTURE (&#39;dba_tuning_priv_analysis_pol&#39;);
</pre>
<p>Even though in the next steps you will drop the <code class="codeph">pa_admin</code> user, including any objects created in this user&#39;s schema, you must manually drop the <code class="codeph">dba_tuning_priv_analysis_pol</code> privilege analysis policy because this object resides in the <code class="codeph">SYS</code> schema.</p>
</div>
</li>
<li class="stepexpand"><span>Connect as the user who created the user accounts. If Oracle Database Vault is enabled, then connect as the Oracle Database Vault Account Manager.</span>
<div>
<p>For example:</p>
<pre dir="ltr">CONNECT bea_dvacctmgr <span class="italic">-- Or, CONNECT bea_dvacctmgr@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre></div>
</li>
<li class="stepexpand"><span>Drop the users <code class="codeph">pa_admin</code> and <code class="codeph">tjones</code>.</span>
<div>
<pre dir="ltr">DROP USER pa_admin;
DROP USER tjones CASCADE;
</pre></div>
</li>
</ol>
</div>
</div>
</div>
<a id="DVADM674"></a><a id="DVADM673"></a>
<div class="props_rev_3"><a id="GUID-2F1929EB-8EB5-4678-BBC9-EE4A8056D112"></a>
<h2 id="DVADM-GUID-2F1929EB-8EB5-4678-BBC9-EE4A8056D112" class="sect2">Privilege Analysis Policy and Report Data Dictionary Views</h2>
<div>
<p>Oracle Database provides data dictionary views that show information about analyzed privileges.</p>
<div class="section">
<p><a href="priv_analysis.htm#GUID-2F1929EB-8EB5-4678-BBC9-EE4A8056D112__CACIIEGE" title="Privilege Profiler Data Dictionary Views">Table 4-1</a> lists these data dictionary views.</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-2F1929EB-8EB5-4678-BBC9-EE4A8056D112__CACIIEGE">
<p class="titleintable">Table 4-1 Data Dictionary Views That Display Privilege Analysis Information</p>
<table class="cellalignment338" title="Data Dictionary Views That Display Privilege Analysis Information" summary="Privilege Profiler Data Dictionary Views">
<thead>
<tr class="cellalignment332">
<th class="cellalignment371" id="d13268e7579">View</th>
<th class="cellalignment372" id="d13268e7582">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment332">
<td class="cellalignment373" id="d13268e7587" headers="d13268e7579">
<p><code class="codeph">DBA_PRIV_CAPTURES</code></p>
</td>
<td class="cellalignment374" headers="d13268e7587 d13268e7582">
<p>Lists information about existing privilege analysis policies</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d13268e7595" headers="d13268e7579">
<p><code class="codeph">DBA_USED_PRIVS</code></p>
</td>
<td class="cellalignment374" headers="d13268e7595 d13268e7582">
<p>Lists the privileges that have been used for reported privilege analysis policies</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d13268e7603" headers="d13268e7579">
<p><code class="codeph">DBA_UNUSED_PRIVS</code></p>
</td>
<td class="cellalignment374" headers="d13268e7603 d13268e7582">
<p>Lists the privileges that have not been used for reported privilege analysis policies</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d13268e7611" headers="d13268e7579">
<p><code class="codeph">DBA_USED_OBJPRIVS</code></p>
</td>
<td class="cellalignment374" headers="d13268e7611 d13268e7582">
<p>Lists the object privileges that have been used for reported privilege analysis policies. It does not include the object grant paths.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d13268e7619" headers="d13268e7579">
<p><code class="codeph">DBA_UNUSED_OBJPRIVS</code></p>
</td>
<td class="cellalignment374" headers="d13268e7619 d13268e7582">
<p>Lists the object privileges that have not been used for reported privilege analysis policies. It does not include the object privilege grant paths.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d13268e7627" headers="d13268e7579">
<p><code class="codeph">DBA_USED_OBJPRIVS_PATH</code></p>
</td>
<td class="cellalignment374" headers="d13268e7627 d13268e7582">
<p>Lists the object privileges that have been used for reported privilege analysis policies. It includes the object privilege grant paths.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d13268e7635" headers="d13268e7579">
<p><code class="codeph">DBA_UNUSED_OBJPRIVS_PATH</code></p>
</td>
<td class="cellalignment374" headers="d13268e7635 d13268e7582">
<p>Lists the object privileges that have not been used for reported privilege analysis policies. It includes the object privilege grant paths.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d13268e7643" headers="d13268e7579">
<p><code class="codeph">DBA_USED_SYSPRIVS</code></p>
</td>
<td class="cellalignment374" headers="d13268e7643 d13268e7582">
<p>Lists the system privileges that have been used for reported privilege analysis policies. It does not include the system privilege grant paths.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d13268e7651" headers="d13268e7579">
<p><code class="codeph">DBA_UNUSED_SYSPRIVS</code></p>
</td>
<td class="cellalignment374" headers="d13268e7651 d13268e7582">
<p>Lists the system privileges that have not been used for reported privilege analysis policies. It does not include the system privilege grant paths.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d13268e7659" headers="d13268e7579">
<p><code class="codeph">DBA_USED_SYSPRIVS_PATH</code></p>
</td>
<td class="cellalignment374" headers="d13268e7659 d13268e7582">
<p>Lists the system privileges that have been used for reported privilege analysis policies. It includes the system privilege grant paths.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d13268e7667" headers="d13268e7579">
<p><code class="codeph">DBA_UNUSED_SYSPRIVS_PATH</code></p>
</td>
<td class="cellalignment374" headers="d13268e7667 d13268e7582">
<p>Lists the system privileges that have not been used for reported privilege analysis policies. It includes system privilege grant paths</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d13268e7676" headers="d13268e7579">
<p><code class="codeph">DBA_USED_PUBPRIVS</code></p>
</td>
<td class="cellalignment374" headers="d13268e7676 d13268e7582">
<p>Lists all the privileges for the <code class="codeph">PUBLIC</code> role that have been used for reported privilege analysis policies</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d13268e7687" headers="d13268e7579">
<p><code class="codeph">DBA_USED_USERPRIVS</code></p>
</td>
<td class="cellalignment374" headers="d13268e7687 d13268e7582">
<p>Lists the user privileges that have been used for reported privilege analysis policies. It does not include the user privilege grant paths.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d13268e7695" headers="d13268e7579">
<p><code class="codeph">DBA_UNUSED_USERPRIVS</code></p>
</td>
<td class="cellalignment374" headers="d13268e7695 d13268e7582">
<p>Lists the user privileges that have not been used for reported privilege analysis policies. It does not include the user privilege grant paths.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d13268e7703" headers="d13268e7579">
<p><code class="codeph">DBA_USED_USERPRIVS_PATH</code></p>
</td>
<td class="cellalignment374" headers="d13268e7703 d13268e7582">
<p>Lists the user privileges that have been used for reported privilege analysis policies. It includes the user privilege grant paths.</p>
</td>
</tr>
<tr class="cellalignment332">
<td class="cellalignment373" id="d13268e7712" headers="d13268e7579">
<p><code class="codeph">DBA_UNUSED_USERPRIVS_PATH</code></p>
</td>
<td class="cellalignment374" headers="d13268e7712 d13268e7582">
<p>Lists the privileges that have not been used for reported privilege analysis policies. It includes the user privilege grant paths.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-2F1929EB-8EB5-4678-BBC9-EE4A8056D112__GUID-3EEDEA70-9893-4637-8377-6E60E5BC13DF">
<p class="notep1">See Also:</p>
<p><a class="olink REFRN" target="_blank" href="../REFRN/toc.htm"><span><cite>Oracle Database Reference</cite></span></a> for a detailed description of these data dictionary views</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment331">
<tr>
<td class="cellalignment359">
<table class="cellalignment336">
<tr>
<td class="cellalignment335"><a href="getting_started.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment335"><a href="cfrealms.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2006, 2016, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment361">
<table class="cellalignment334">
<tr>
<td class="cellalignment335"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment335"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment335"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment335"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment335"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment335"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>