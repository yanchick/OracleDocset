<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-2348"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/DBMS_SPD"></a><title>DBMS_SPD</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1086"/>
<meta name="dcterms.created" content="2016-09-02T5:36:35Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database PL/SQL Packages and Types Reference"/>
<meta name="dcterms.identifier" content="E41829-07"/>
<meta name="dcterms.isVersionOf" content="ARPLS"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="d_spadmn.htm" title="Previous" type="text/html"/>
<link rel="Next" href="d_spm.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41829-07.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">151/290</span> <!-- End Header -->
<div id="ARPLS73856" class="chapter"><a id="CIHDJBBI"></a>
<h1 class="chapter"><span class="secnum">147</span> DBMS_SPD</h1>
<p>The <code dir="ltr">DBMS_SPD</code> package provides subprograms for managing SQL plan directives (SPD).</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="d_stats.htm#CIHBIEII">Chapter 155, &#34;DBMS_STATS&#34;</a></p>
</li>
<li>
<p><a class="olink TGSQL347" href="../TGSQL/tgsql_statscon.htm#TGSQL347"><span class="italic">Oracle Database SQL Tuning Guide</span></a> regarding SQL plan directives</p>
</li>
</ul>
</div>
<p>This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#CIHJGICF">Using DBMS_SPD</a></p>
<ul>
<li>
<p>Overview</p>
</li>
<li>
<p>Security Model</p>
</li>
<li>
<p>Views</p>
</li>
</ul>
</li>
<li>
<p><a href="#CIHFAHEE">Summary of DBMS_SPD Subprograms</a></p>
</li>
</ul>
<div class="refentry"><a id="CIHJGICF"></a>
<div id="ARPLS73857" class="refsect1"><!-- infolevel="all" infotype="General" -->
<h2 class="refsect1">Using DBMS_SPD</h2>
<ul>
<li>
<p><a href="#CIHCHFJH">Overview</a></p>
</li>
<li>
<p><a href="#CIHBBHHF">Security Model</a></p>
</li>
<li>
<p><a href="#CIHCADID">Views</a></p>
</li>
</ul>
<div id="ARPLS73858" class="refsect2"><a id="CIHCHFJH"></a>
<h3 class="refsect2">Overview</h3>
<p>This package provides subprograms for managing SQL plan directives (SPD). SPD are objects generated automatically by Oracle. For example, if Oracle detects that the single table cardinality estimated made by the optimizer is different from the actual number of rows returned when accessing the table, it will automatically create a directive to perform dynamic statistics for the table. When any SQL statement referencing the table is compiled, the optimizer will perform dynamic statistics for the table to get a more accurate estimate.</p>
</div>
<!-- class="refsect2" -->
<div id="ARPLS73859" class="refsect2"><a id="CIHBBHHF"></a>
<h3 class="refsect2">Security Model</h3>
<p><code dir="ltr">DBMS_SPD</code> is an invoker-rights package. The invoker requires <code dir="ltr">ADMINISTER SQL MANAGEMENT OBJECT</code> privilege for executing most of the subprograms in this package. Also, the subprograms commit the current transaction (if any), perform the operation, and then commit it again.</p>
</div>
<!-- class="refsect2" -->
<div id="ARPLS73860" class="refsect2"><a id="CIHCADID"></a>
<h3 class="refsect2">Views</h3>
<p>The DBA view <code dir="ltr">DBA_SQL_PLAN_DIRECTIVES</code> shows all the directives created in the system and the view <code dir="ltr">DBA_SQL_PLAN_DIR_OBJECTS</code> displays the objects that are included in the directives.</p>
</div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" --></div>
<!-- class="refentry" -->
<div class="refentry"><a id="CIHFAHEE"></a>
<div id="ARPLS73861" class="refsect1"><!-- infolevel="all" infotype="General" -->
<h2 class="refsect1">Summary of DBMS_SPD Subprograms</h2>
<div id="ARPLS73862" class="tblformal">
<p class="titleintable"><a id="sthref9169"></a><a id="sthref9170"></a>Table 147-1 DBMS_SPD Package Subprograms</p>
<table class="cellalignment4330" title="DBMS_SPD Package Subprograms" summary="DBMS_SPD Package Subprograms" dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t3">Subprogram</th>
<th class="cellalignment4328" id="r1c2-t3">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t3" headers="r1c1-t3">
<p><a href="#CIHEFGBI">ALTER_SQL_PLAN_DIRECTIVE Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r2c1-t3 r1c2-t3">
<p>Changes different attributes of a SQL plan directive</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t3" headers="r1c1-t3">
<p><a href="#CIHEFDGI">CREATE_STGTAB_DIRECTIVE Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r3c1-t3 r1c2-t3">
<p>Creates a staging table into which to pack (export) SQL plan directives.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t3" headers="r1c1-t3">
<p><a href="#CIHEIAFA">DROP_SQL_PLAN_DIRECTIVE Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r4c1-t3 r1c2-t3">
<p>Drops a SQL plan directive</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t3" headers="r1c1-t3">
<p><a href="#CIHDIFFC">FLUSH_SQL_PLAN_DIRECTIVE Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r5c1-t3 r1c2-t3">
<p>Allows for manual flushing of the SQL plan directives that are automatically recorded in SGA memory while executing SQL statements.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r6c1-t3" headers="r1c1-t3">
<p><a href="#CIHJGBJG">GET_PREFS Function</a></p>
</td>
<td class="cellalignment4329" headers="r6c1-t3 r1c2-t3">
<p>Gets the values for preferences for SQL plan directives</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r7c1-t3" headers="r1c1-t3">
<p><a href="#CIHBEHIF">PACK_STGTAB_DIRECTIVE Function</a></p>
</td>
<td class="cellalignment4329" headers="r7c1-t3 r1c2-t3">
<p>Packs (exports) SQL plan directives into a staging table.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r8c1-t3" headers="r1c1-t3">
<p><a href="#CIHJJFHA">SET_PREFS Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r8c1-t3 r1c2-t3">
<p>Allows the setting of different preferences for SQL plan directives</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r9c1-t3" headers="r1c1-t3">
<p><a href="#CIHEFIFG">UNPACK_STGTAB_DIRECTIVE Function</a></p>
</td>
<td class="cellalignment4329" headers="r9c1-t3 r1c2-t3">
<p>Unpacks (imports) SQL plan directives from a staging table.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<div id="ARPLS73863" class="refsect2"><a id="CIHEFGBI"></a>
<h3 class="refsect2"><a id="sthref9171"></a>ALTER_SQL_PLAN_DIRECTIVE Procedure</h3>
<p>This procedure changes different attributes of a SQL plan directive.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9172"></a>Syntax</p>
<pre dir="ltr">DBMS_SPD.ALTER_SQL_PLAN_DIRECTIVE (
   directive_id        IN     NUMBER,
   attribute_name      IN     VARCHAR2,
   attribute_value     IN     VARCHAR2);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9173"></a>Parameters</p>
<div id="ARPLS73864" class="tblformal">
<p class="titleintable"><a id="sthref9174"></a><a id="sthref9175"></a>Table 147-2 <span class="bolditalic">ALTER_SQL_PLAN_DIRECTIVE Procedure Parameters</span></p>
<table class="cellalignment4330" title="ALTER_SQL_PLAN_DIRECTIVE Procedure Parameters" summary="This table describes the parameters of the DBMS_SPD.ALTER_SQL_PLAN_DIRECTIVE subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t4">Parameter</th>
<th class="cellalignment4328" id="r1c2-t4">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t4" headers="r1c1-t4">
<p><code dir="ltr">directive_id</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t4 r1c2-t4">
<p>SQL plan directive ID</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t4" headers="r1c1-t4">
<p><code dir="ltr">attribute_name</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t4 r1c2-t4">
<ul>
<li>
<p><code dir="ltr">ENABLED</code></p>
</li>
<li>
<p><code dir="ltr">AUTO_DROP</code></p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t4" headers="r1c1-t4">
<p><code dir="ltr">attribute_value</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t4 r1c2-t4">
<p>Possible values:</p>
<ul>
<li>
<p><code dir="ltr">ENABLED:</code></p>
<p>- If <code dir="ltr">YES</code> directive is enabled and may be used</p>
<p>- If <code dir="ltr">NO</code> directive is not enabled and will not be used</p>
</li>
<li>
<p><code dir="ltr">AUTO_DROP</code>:</p>
<p>- If <code dir="ltr">YES</code> directive will be dropped automatically if not used for <code dir="ltr">SPD_RETENTION_WEEKS</code>. This is the default behavior.</p>
<p>- If <code dir="ltr">NO</code> directive will not be dropped automatically</p>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9176"></a>Exceptions</p>
<ul>
<li>
<p><code dir="ltr">ORA-38171 INSUFFICIENT_PRIVILEGE</code>: The user does not have proper privilege to perform the operation.</p>
</li>
<li>
<p><code dir="ltr">ORA-28104 INVALID_INPUT</code>: The input value is not valid.</p>
</li>
<li>
<p><code dir="ltr">ORA-13158 OBJECT_DOES_NOT_EXIST</code>: The specified object does not exist.</p>
</li>
</ul>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9177"></a>Usage Notes</p>
<p>The <code dir="ltr">ADMINISTER SQL MANAGEMENT OBJECT</code> privilege is required to execute this procedure.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9178"></a>Examples</p>
<pre dir="ltr">BEGIN
  DBMS_SPD.ALTER_SQL_PLAN_DIRECTIVE (12345, &#39;STATE&#39;, &#39;PERMANENT&#39;);
END;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS74423" class="refsect2"><a id="CIHEFDGI"></a>
<h3 class="refsect2"><a id="sthref9179"></a>CREATE_STGTAB_DIRECTIVE Procedure</h3>
<p>This procedure creates a staging table into which to pack (export) SQL plan directives.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9180"></a>Syntax</p>
<pre dir="ltr">DBMS_SPD.CREATE_STGTAB_DIRECTIVE (
   table_name         IN VARCHAR2,
   table_owner        IN VARCHAR2  := USER,
   tablespace_name    IN VARCHAR2  := NULL);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9181"></a>Parameters</p>
<div id="ARPLS74424" class="tblformal">
<p class="titleintable"><a id="sthref9182"></a><a id="sthref9183"></a>Table 147-3 <span class="bolditalic">CREATE_STGTAB_DIRECTIVE Procedure Parameters</span></p>
<table class="cellalignment4330" title="CREATE_STGTAB_DIRECTIVE Procedure Parameters" summary="This table describes the parameters of the DBMS_SPD.CREATE_STGTAB_DIRECTIVE subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t5">Parameter</th>
<th class="cellalignment4328" id="r1c2-t5">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t5" headers="r1c1-t5">
<p><code dir="ltr">table_name</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t5 r1c2-t5">
<p>Name of staging table</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t5" headers="r1c1-t5">
<p><code dir="ltr">table_owner</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t5 r1c2-t5">
<p>Name of schema owner of staging table. Default is current schema.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t5" headers="r1c1-t5">
<p><code dir="ltr">tablespace_name</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t5 r1c2-t5">
<p>Name of tablespace. Default <code dir="ltr">NULL</code> means create staging table in the default tablespace:</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9184"></a>Exceptions</p>
<ul>
<li>
<p><code dir="ltr">ORA-38171 INSUFFICIENT_PRIVILEGE</code>: The user does not have proper privilege to perform the operation.</p>
</li>
<li>
<p><code dir="ltr">ORA-28104 INVALID_INPUT</code>: The input value is not valid.</p>
</li>
<li>
<p><code dir="ltr">ORA-44001 INVALID_SCHEMA</code>: The input schema does not exist.</p>
</li>
<li>
<p><code dir="ltr">ORA-13159 TABLE_ALREADY_EXISTS</code>: The specified table already exists.</p>
</li>
<li>
<p><code dir="ltr">ORA-29304 TABLESPACE_MISSING</code>: The specified tablespace does not exist.</p>
</li>
</ul>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9185"></a>Usage Notes</p>
<p>The <code dir="ltr">ADMINISTER SQL MANAGEMENT OBJECT</code> privilege is required to execute this procedure.</p>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS73865" class="refsect2"><a id="CIHEIAFA"></a>
<h3 class="refsect2"><a id="sthref9186"></a>DROP_SQL_PLAN_DIRECTIVE Procedure</h3>
<p>This procedure drops a SQL plan directive.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9187"></a>Syntax</p>
<pre dir="ltr">DBMS_SPD.DROP_SQL_PLAN_DIRECTIVE (
   directive_id        IN     NUMBER);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9188"></a>Parameters</p>
<div id="ARPLS73866" class="tblformal">
<p class="titleintable"><a id="sthref9189"></a><a id="sthref9190"></a>Table 147-4 <span class="bolditalic">DROP_SQL_PLAN_DIRECTIVE Procedure Parameters</span></p>
<table class="cellalignment4330" title="DROP_SQL_PLAN_DIRECTIVE Procedure Parameters" summary="This table describes the parameters of the DBMS_SPD.DROP_SQL_PLAN_DIRECTIVE subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t6">Parameter</th>
<th class="cellalignment4328" id="r1c2-t6">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t6" headers="r1c1-t6">
<p><code dir="ltr">directive_id</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t6 r1c2-t6">
<p>SQL plan directive ID</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9191"></a>Exceptions</p>
<ul>
<li>
<p><code dir="ltr">ORA-38171 INSUFFICIENT_PRIVILEGE</code>: The user does not have proper privilege to perform the operation.</p>
</li>
<li>
<p><code dir="ltr">ORA-28104 INVALID_INPUT</code>: The input value is not valid.</p>
</li>
<li>
<p><code dir="ltr">ORA-13158 OBJECT_DOES_NOT_EXIST</code>: The specified object does not exist.</p>
</li>
</ul>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9192"></a>Usage Notes</p>
<p>The <code dir="ltr">ADMINISTER SQL MANAGEMENT OBJECT</code> privilege is required to execute this procedure.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9193"></a>Examples</p>
<pre dir="ltr">BEGIN
  DBMS_SPD.DROP_SQL_PLAN_DIRECTIVE (12345);
END;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS74425" class="refsect2"><a id="CIHDIFFC"></a>
<h3 class="refsect2"><a id="sthref9194"></a>FLUSH_SQL_PLAN_DIRECTIVE Procedure</h3>
<p>This procedure allows for manual flushing of the SQL plan directives that are automatically recorded in SGA memory while executing SQL statements. The information recorded in the SGA is periodically flushed by an Oracle background process. This procedure provides a way to flush the information manually.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9195"></a>Syntax</p>
<pre dir="ltr">DBMS_SPD.FLUSH_SQL_PLAN_DIRECTIVE;
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9196"></a>Exceptions</p>
<p><code dir="ltr">ORA-38171 INSUFFICIENT_PRIVILEGE</code>: The user does not have proper privilege to perform the operation.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9197"></a>Usage Notes</p>
<p>The <code dir="ltr">ADMINISTER SQL MANAGEMENT OBJECT</code> privilege is required to execute this procedure.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9198"></a>Examples</p>
<pre dir="ltr">BEGIN
  DBMS_SPD.FLUSH_SQL_PLAN_DIRECTIVE;
END;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS74426" class="refsect2"><a id="CIHJGBJG"></a>
<h3 class="refsect2"><a id="sthref9199"></a>GET_PREFS Function</h3>
<p>This function returns the value for the specified preferences for SQL plan directives.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9200"></a>Syntax</p>
<pre dir="ltr">DBMS_SPD.GET_PREFS (
   pname     IN   VARCHAR2)
 RETURN VARCHAR2;
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9201"></a>Parameters</p>
<div id="ARPLS74427" class="tblformal">
<p class="titleintable"><a id="sthref9202"></a><a id="sthref9203"></a>Table 147-5 <span class="bolditalic">GET_PREFS Function Parameters</span></p>
<table class="cellalignment4330" title="GET_PREFS Function Parameters" summary="This table describes the parameters of the DBMS_SPD.GET_PREFS subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t7">Parameter</th>
<th class="cellalignment4328" id="r1c2-t7">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t7" headers="r1c1-t7">
<p><code dir="ltr">pname</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t7 r1c2-t7">
<p>Preference name. The procedure supports the preference <code dir="ltr">SPD_RETENTION_WEEKS</code>.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9204"></a>Return Values</p>
<p>Preference value</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9205"></a>Exceptions</p>
<ul>
<li>
<p><code dir="ltr">ORA-38171 INSUFFICIENT_PRIVILEGE</code>: The user does not have proper privilege to perform the operation.</p>
</li>
<li>
<p><code dir="ltr">ORA-28104 INVALID_INPUT</code>: The input value is not valid.</p>
</li>
</ul>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9206"></a>Usage Notes</p>
<ul>
<li>
<p>The <code dir="ltr">ADMINISTER SQL MANAGEMENT OBJECT</code> privilege is required to execute this procedure.</p>
</li>
<li>
<p><code dir="ltr">SPD_RETENTION_WEEKS</code> - SQL plan directives are purged if not used for more than the value set for this preference.</p>
</li>
</ul>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9207"></a>Examples</p>
<pre dir="ltr">SELECT DBMS_SPD.GET_PREFS(&#39;SPD_RETENTION_WEEKS&#39;) FROM DUAL;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS74428" class="refsect2"><a id="CIHBEHIF"></a>
<h3 class="refsect2"><a id="sthref9208"></a>PACK_STGTAB_DIRECTIVE Function</h3>
<p>This function packs (exports) SQL plan directives into a staging table.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9209"></a>Syntax</p>
<pre dir="ltr">DBMS_SPD.PACK_STGTAB_DIRECTIVE (
   table_name         IN VARCHAR2,
   table_owner        IN VARCHAR2  := USER
   directive_id       IN NUMBER    := NULL,
   obj_list           IN OBJECTTAB := NULL) 
 RETURN NUMBER
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9210"></a>Parameters</p>
<div id="ARPLS74429" class="tblformal">
<p class="titleintable"><a id="sthref9211"></a><a id="sthref9212"></a>Table 147-6 <span class="bolditalic">PACK_STGTAB_DIRECTIVE Function Parameters</span></p>
<table class="cellalignment4330" title="PACK_STGTAB_DIRECTIVE Function Parameters" summary="This table describes the parameters of the DBMS_SPD.PACK_STGTAB_DIRECTIVE subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t8">Parameter</th>
<th class="cellalignment4328" id="r1c2-t8">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t8" headers="r1c1-t8">
<p><code dir="ltr">table_name</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t8 r1c2-t8">
<p>Name of staging table</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t8" headers="r1c1-t8">
<p><code dir="ltr">table_owner</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t8 r1c2-t8">
<p>Name of schema owner of staging table. Default is current schema.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t8" headers="r1c1-t8">
<p><code dir="ltr">directive_id</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t8 r1c2-t8">
<p>SQL plan directive ID. Default <code dir="ltr">NULL</code> means all directives in the system.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t8" headers="r1c1-t8">
<p><code dir="ltr">obj_list</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t8 r1c2-t8">
<p>Used to filter the directives to be packed based on the objects used in directives. If <code dir="ltr">obj_list</code> is not <code dir="ltr">NULL</code>, a directive is packed only if all the objects in the directive exist in <code dir="ltr">obj_list</code>.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9213"></a>Return Values</p>
<p>Number of SQL plan directives packed.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9214"></a>Exceptions</p>
<ul>
<li>
<p><code dir="ltr">ORA-38171 INSUFFICIENT_PRIVILEGE</code>: The user does not have proper privilege to perform the operation.</p>
</li>
<li>
<p><code dir="ltr">ORA-28104 INVALID_INPUT</code>: The input value is not valid.</p>
</li>
<li>
<p><code dir="ltr">ORA-44001 INVALID_SCHEMA</code>: The input schema does not exist.</p>
</li>
<li>
<p><code dir="ltr">ORA-29304 INVALID_STGTAB</code>: The specified staging table is invalid or does not exist.</p>
</li>
<li>
<p><code dir="ltr">ORA-13158 OBJECT_DOES_NOT_EXIST</code>: The specified object does not exist.</p>
</li>
</ul>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9215"></a>Usage Notes</p>
<p>The <code dir="ltr">ADMINISTER SQL MANAGEMENT OBJECT</code> privilege is required to execute this procedure.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9216"></a>Examples</p>
<pre dir="ltr">-- Pack all directives in the system
SELECT DBMS_SPD.PACK_STGTAB_DIRECTIVE(&#39;mydirtab&#39;) FROM DUAL;
 
SET SERVEROUTPUT ON;
-- Pack directives relevant to objects in SH schema
DECLARE
  my_list  DBMS_SPD.OBJECTTAB := DBMS_SPD.ObjectTab();
  dir_cnt  NUMBER;
BEGIN
  my_list.extend(1);
  my_list(1).owner := &#39;SH&#39;;           -- schema name
  my_list(1).object_name := NULL;     -- all tables in SH
  my_list(1).object_type := &#39;TABLE&#39;;  -- type of object
 
  dir_cnt :=
    DBMS_SPD.PACK_STGTAB_DIRECTIVE(&#39;mydirtab&#39;, obj_list =&gt; my_list);
  DBMS_OUTPUT.PUT_LINE(&#39;dir_cnt = &#39; || dir_cnt);
END;
 
-- Pack directives relevant to tables SALES and CUSTOMERS in SH schema
DECLARE
  my_list  DBMS_SPD.OBJECTTAB := DBMS_SPD.ObjectTab();
  dir_cnt  NUMBER;
BEGIN
  my_list.extend(2);
 
  -- SALES table
  my_list(1).owner := &#39;SH&#39;;
  my_list(1).object_name := &#39;SALES&#39;;
  my_list(1).object_type := &#39;TABLE&#39;;
 
  -- CUSTOMERS table
  my_list(2).owner := &#39;SH&#39;;
  my_list(2).object_name := &#39;CUSTOMERS&#39;;
  my_list(2).object_type := &#39;TABLE&#39;;
 
  dir_cnt :=
    DBMS_SPD.PACK_STGTAB_DIRECTIVE(&#39;mydirtab&#39;, obj_list =&gt; my_list);
  DBMS_OUTPUT.PUT_LINE(&#39;dir_cnt = &#39; || dir_cnt);
END;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS74430" class="refsect2"><a id="CIHJJFHA"></a>
<h3 class="refsect2"><a id="sthref9217"></a>SET_PREFS Procedure</h3>
<p>This procedure allows the setting of different preferences for SQL plan directives.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9218"></a>Syntax</p>
<pre dir="ltr">DBMS_SPD.SET_PREFS (
   pname     IN   VARCHAR2,
   pvalue    IN   VARCHAR2);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9219"></a>Parameters</p>
<div id="ARPLS74431" class="tblformal">
<p class="titleintable"><a id="sthref9220"></a><a id="sthref9221"></a>Table 147-7 <span class="bolditalic">SET_PREFS Procedure Parameters</span></p>
<table class="cellalignment4330" title="SET_PREFS Procedure Parameters" summary="This table describes the parameters of the DBMS_SPD.SET_PREFS subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t9">Parameter</th>
<th class="cellalignment4328" id="r1c2-t9">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t9" headers="r1c1-t9">
<p><code dir="ltr">pname</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t9 r1c2-t9">
<p>Preference name. The procedure supports the preference <code dir="ltr">SPD_RETENTION_WEEKS</code>.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t9" headers="r1c1-t9">
<p><code dir="ltr">pvalue</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t9 r1c2-t9">
<p>Preference value.</p>
<ul>
<li>
<p>SPD_RETENTION_WEEKS: SQL plan directives are purged if not used for more than the value set for this preference. Default is 53 (<code dir="ltr">SPD_RETENTION_WEEKS_DEFAULT</code>) weeks, which means a directive is purged if it has been left unused for little over a year. It can be set to any value greater than or equal to 0. Also value <code dir="ltr">NULL</code> can be passed to set the preference to default.</p>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9222"></a>Exceptions</p>
<ul>
<li>
<p><code dir="ltr">ORA-38171 INSUFFICIENT_PRIVILEGE</code>: The user does not have proper privilege to perform the operation.</p>
</li>
<li>
<p><code dir="ltr">ORA-28104 INVALID_INPUT</code>: The input value is not valid.</p>
</li>
</ul>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9223"></a>Usage Notes</p>
<ul>
<li>
<p>The <code dir="ltr">ADMINISTER SQL MANAGEMENT OBJECT</code> privilege is required to execute this procedure.</p>
</li>
<li>
<p><code dir="ltr">SPD_RETENTION_WEEKS</code> - SQL plan directives are purged if not used for more than the value set for this preference.</p>
</li>
</ul>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9224"></a>Examples</p>
<pre dir="ltr">BEGIN
  DBMS_SPD.SET_PREFS(&#39;SPD_RETENTION_WEEKS&#39;, &#39;4&#39;);
END;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS74432" class="refsect2"><a id="CIHEFIFG"></a>
<h3 class="refsect2"><a id="sthref9225"></a>UNPACK_STGTAB_DIRECTIVE Function</h3>
<p>This procedure unpacks (imports) SQL plan directives from a staging table.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9226"></a>Syntax</p>
<pre dir="ltr">DBMS_SPD.UNPACK_STGTAB_DIRECTIVE (
   table_name         IN VARCHAR2,
   table_owner        IN VARCHAR2  := USER,
   directive_id       IN NUMBER    := NULL,
   obj_list           IN OBJECTTAB := NULL) 
 RETURN NUMBER
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9227"></a>Parameters</p>
<div id="ARPLS74433" class="tblformal">
<p class="titleintable"><a id="sthref9228"></a><a id="sthref9229"></a>Table 147-8 <span class="bolditalic">UNPACK_STGTAB_DIRECTIVE Function Parameters</span></p>
<table class="cellalignment4330" title="UNPACK_STGTAB_DIRECTIVE Function Parameters" summary="This table describes the parameters of the DBMS_SPD.UNPACK_STGTAB_DIRECTIVE subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t10">Parameter</th>
<th class="cellalignment4328" id="r1c2-t10">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t10" headers="r1c1-t10">
<p><code dir="ltr">table_name</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t10 r1c2-t10">
<p>Name of staging table</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t10" headers="r1c1-t10">
<p><code dir="ltr">table_owner</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t10 r1c2-t10">
<p>Name of schema owner of staging table. Default is current schema.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t10" headers="r1c1-t10">
<p><code dir="ltr">directive_id</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t10 r1c2-t10">
<p>SQL plan directive ID. Default <code dir="ltr">NULL</code> means all directives in the system.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t10" headers="r1c1-t10">
<p><code dir="ltr">obj_list</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t10 r1c2-t10">
<p>Used to filter the directives to be unpacked based on the objects used in directives. If <code dir="ltr">obj_list</code> is not <code dir="ltr">NULL</code>, a directive is unpacked only if all the objects in the directive exist in <code dir="ltr">obj_list</code>.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9230"></a>Return Values</p>
<p>Number of SQL plan directives unpacked.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9231"></a>Exceptions</p>
<ul>
<li>
<p><code dir="ltr">ORA-38171 INSUFFICIENT_PRIVILEGE</code>: The user does not have proper privilege to perform the operation.</p>
</li>
<li>
<p><code dir="ltr">ORA-28104 INVALID_INPUT</code>: The input value is not valid.</p>
</li>
<li>
<p><code dir="ltr">ORA-44001 INVALID_SCHEMA</code>: The input schema does not exist.</p>
</li>
<li>
<p><code dir="ltr">ORA-29304 INVALID_STGTAB</code>: The specified staging table is invalid or does not exist.</p>
</li>
<li>
<p><code dir="ltr">ORA-13158 OBJECT_DOES_NOT_EXIST</code>: The specified object does not exist.</p>
</li>
</ul>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9232"></a>Usage Notes</p>
<p>The <code dir="ltr">ADMINISTER SQL MANAGEMENT OBJECT</code> privilege is required to execute this procedure.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref9233"></a>Examples</p>
<pre dir="ltr">-- Unack all directives in the staging table
SELECT DBMS_SPD.UNPACK_STGTAB_DIRECTIVE(&#39;mydirtab&#39;) FROM DUAL;
 
SET SERVEROUTPUT ON;
-- Unpack directives relevant to objects in SH schema
DECLARE
  my_list  DBMS_SPD.OBJECTTAB := DBMS_SPD.ObjectTab();
  dir_cnt  number;
BEGIN
  my_list.extend(1);
  my_list(1).owner := &#39;SH&#39;;           -- schema name
  my_list(1).object_name := null;     -- all tables in SH
  my_list(1).object_type := &#39;TABLE&#39;;  -- type of object
 
  dir_cnt :=
    DBMS_SPD.UNPACK_STGTAB_DIRECTIVE(&#39;mydirtab&#39;, obj_list =&gt; my_list);
  DBMS_OUTPUT.PUT_LINE(&#39;dir_cnt = &#39; || dir_cnt);
END;
 
-- Unpack directives relevant to tables SALES and CUSTOMERS in SH schema
DECLARE
  my_list  DBMS_SPD.OBJECTTAB := DBMS_SPD.ObjectTab();
  dir_cnt  NUMBER;
begin
  my_list.extend(2);
 
  -- SALES table
  my_list(1).owner := &#39;SH&#39;;
  my_list(1).object_name := &#39;SALES&#39;;
  my_list(1).object_type := &#39;TABLE&#39;;
 
  -- CUSTOMERS table
  my_list(2).owner := &#39;SH&#39;;
  my_list(2).object_name := &#39;CUSTOMERS&#39;;
  my_list(2).object_type := &#39;TABLE&#39;;
 
  dir_cnt :=
    DBMS_SPD.UNPACK_STGTAB_DIRECTIVE(&#39;mydirtab&#39;, obj_list =&gt; my_list);
  DBMS_OUTPUT.PUT_LINE(&#39;dir_cnt = &#39; || dir_cnt);
END;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" --></div>
<!-- class="refentry" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment4320">
<tr>
<td class="cellalignment4329">
<table class="cellalignment4325">
<tr>
<td class="cellalignment4324"><a href="d_spadmn.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment4324"><a href="d_spm.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment4332">
<table class="cellalignment4323">
<tr>
<td class="cellalignment4324"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment4324"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment4324"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment4324"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment4324"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment4324"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>