<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-2272"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/DBMS_FREQUENT_ITEMSET"></a><title>DBMS_FREQUENT_ITEMSET</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1086"/>
<meta name="dcterms.created" content="2016-09-02T5:36:20Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database PL/SQL Packages and Types Reference"/>
<meta name="dcterms.identifier" content="E41829-07"/>
<meta name="dcterms.isVersionOf" content="ARPLS"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="d_goldengate_auth.htm" title="Previous" type="text/html"/>
<link rel="Next" href="d_heat_map.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41829-07.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">77/290</span> <!-- End Header -->
<div id="ARPLS007" class="chapter"><a id="BHACGDFF"></a> <a id="i1001728"></a>
<h1 class="chapter"><span class="secnum">73</span> DBMS_FREQUENT_ITEMSET</h1>
<p>The <a id="sthref4528"></a>DBMS_FREQUENT_ITEMSET package enables frequent itemset counting. The two functions are identical except in the input cursor format difference.</p>
<p>This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#BHAHIJCC">Summary of DBMS_FREQUENT_ITEMSET Subprograms</a></p>
</li>
</ul>
<div class="refentry"><a id="BHAHIJCC"></a>
<div id="ARPLS66409" class="refsect1">
<h2 class="refsect1">Summary of DBMS_FREQUENT_ITEMSET Subprograms</h2>
<div id="ARPLS66410" class="tblformal">
<p class="titleintable"><a id="sthref4529"></a><a id="sthref4530"></a>Table 73-1 DBMS_FREQUENT_ITEMSET Package Subprograms</p>
<table class="cellalignment4330" title=" DBMS_FREQUENT_ITEMSET Package Subprograms" summary="This table lists the DBMS_FREQUENT_ITEMSET subprograms in alphabetical order and briefly describes them." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t2">Subprogram</th>
<th class="cellalignment4328" id="r1c2-t2">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t2" headers="r1c1-t2">
<p><a href="#i1000739">FI_HORIZONTAL Function</a></p>
</td>
<td class="cellalignment4329" headers="r2c1-t2 r1c2-t2">
<p>Counts all frequent itemsets given a cursor for input data which is in &#39;<code dir="ltr">HORIZONTAL</code>&#39; row format, support threshold, minimum itemset length, maximum itemset length, items to be included, items to be excluded</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t2" headers="r1c1-t2">
<p><a href="#BHAHCCDB">FI_TRANSACTIONAL Function</a></p>
</td>
<td class="cellalignment4329" headers="r3c1-t2 r1c2-t2">
<p>Counts all frequent itemsets given a cursor for input data which is in &#39;<code dir="ltr">TRANSACTIONAL</code>&#39; row format, support threshold, minimum itemset length, maximum itemset length, items to be included, items to be excluded</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<div id="ARPLS66411" class="refsect2"><a id="i1000739"></a>
<h3 class="refsect2"><a id="sthref4531"></a>FI_HORIZONTAL Function</h3>
<p>The purpose of this table function is to count all frequent itemsets given a cursor for input data which is in &#39;<code dir="ltr">HORIZONTAL</code>&#39; row format, support threshold, minimum itemset length, maximum itemset length, items to be included, items to be excluded. The result will be a table of rows in form of itemset, support, length, total transactions counted.</p>
<p>In &#39;<code dir="ltr">HORIZONTAL</code>&#39; row format, each row contains all of the item ids for a single transaction. Since all of the items come together, no transaction id is necessary.</p>
<p>The benefit of this table function is that if an application already has data in horizontal format, the database can skip the step of transforming rows that are in transactional format into horizontal format.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4532"></a>Syntax</p>
<pre dir="ltr">DBMS_FREQUENT_ITEMSET.FI_HORIZONTAL(
   tranx_cursor         IN    SYSREFCURSOR,
   support_threshold    IN    NUMBER,
   itemset_length_min   IN    NUMBER,
   itemset_length_max   IN    NUMBER,
   including_items      IN    SYS_REFCURSOR DEFAULT NULL,
   excluding_items      IN    SYS_REFCURSOR DEFAULT NULL)
  RETURN TABLE OF ROW (
     itemset [Nested Table of Item Type DERIVED FROM tranx_cursor],
     support        NUMBER,
     length         NUMBER,
     total_tranx    NUMBER);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4533"></a>Parameters</p>
<div id="ARPLS66412" class="tblformal">
<p class="titleintable"><a id="sthref4534"></a><a id="sthref4535"></a>Table 73-2 FI_HORIZONTAL Function Parameters</p>
<table class="cellalignment4330" title="FI_HORIZONTAL Function Parameters" summary="This table describes the parameters of DBMS_FREQUENT_ITEMSET.FI_HORIZONTAL." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t3">Parameter</th>
<th class="cellalignment4328" id="r1c2-t3">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t3" headers="r1c1-t3">
<p><code dir="ltr">tranx_cursor</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t3 r1c2-t3">
<p>The cursor parameter that the user will supply when calling the function. There is no limits on the number of returning columns.Each column of cursor represents an item. All columns of the cursor must be of the same datatype. The item id must be number or character type (for example, <code dir="ltr">VARCHAR2</code>(n)).</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t3" headers="r1c1-t3">
<p><code dir="ltr">support_threshold</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t3 r1c2-t3">
<p>A fraction number of total transaction count. An itemset is termed &#34;frequent&#34; if [the number of transactions it occurs in] divided by [the total number of transactions] exceed the fraction. The parameter must be a <code dir="ltr">NUMBER</code>.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t3" headers="r1c1-t3">
<p><code dir="ltr">itemset_length_min</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t3 r1c2-t3">
<p>The minimum length for interested frequent itemset. The parameter must be a <code dir="ltr">NUMBER</code> between 1 and 20, inclusive.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t3" headers="r1c1-t3">
<p><code dir="ltr">itemset_length_max</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t3 r1c2-t3">
<p>The maximum length for interested frequent itemset. This parameter must be a <code dir="ltr">NUMBER</code> between 1 and 20, inclusive, and must not be less than <code dir="ltr">itemset_length_min</code>.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r6c1-t3" headers="r1c1-t3">
<p><code dir="ltr">including_items</code></p>
</td>
<td class="cellalignment4329" headers="r6c1-t3 r1c2-t3">
<p>A cursor from which a list of items can be fetched. At least one item from the list must appear in frequent itemsets that are returned. The default is <code dir="ltr">NULL</code>.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r7c1-t3" headers="r1c1-t3">
<p><code dir="ltr">excluding_items</code></p>
</td>
<td class="cellalignment4329" headers="r7c1-t3 r1c2-t3">
<p>A cursor from which a list of items can be fetched. No item from the list can appear in frequent itemsets that are returned.The default is <code dir="ltr">NULL</code>.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4536"></a>Return Values</p>
<div id="ARPLS66413" class="tblformal">
<p class="titleintable"><a id="sthref4537"></a><a id="sthref4538"></a>Table 73-3 FI_HORIZONTAL Return Values</p>
<table class="cellalignment4330" title="FI_HORIZONTAL Return Values" summary="This table describes the Return Values for FI_HORIZONTAL." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t4">Parameter</th>
<th class="cellalignment4328" id="r1c2-t4">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t4" headers="r1c1-t4">
<pre dir="ltr">support
</pre></td>
<td class="cellalignment4329" headers="r2c1-t4 r1c2-t4">
<p>The number of transactions in which a frequent itemset occurs. This will be returned as a <code dir="ltr">NUMBER</code>.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t4" headers="r1c1-t4">
<pre dir="ltr">itemset
</pre></td>
<td class="cellalignment4329" headers="r3c1-t4 r1c2-t4">
<p>A collection of items which is computed as frequent itemset. This will be returned as a nested table of item type which is the item column type of the input cursor.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t4" headers="r1c1-t4">
<pre dir="ltr">length
</pre></td>
<td class="cellalignment4329" headers="r4c1-t4 r1c2-t4">
<p>Number of items in a frequent itemset. This will be returned as a <code dir="ltr">NUMBER</code>.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t4" headers="r1c1-t4">
<pre dir="ltr">total_tranx
</pre></td>
<td class="cellalignment4329" headers="r5c1-t4 r1c2-t4">
<p>The total transaction count. This will be returned as a <code dir="ltr">NUMBER</code>.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4539"></a>Example</p>
<p>Suppose you have a table <code dir="ltr">horiz_table_in</code>.</p>
<pre dir="ltr">horiz_table_in(iid1 VARCHAR2(30), iid2 VARCHAR2(30), iid3 VARCHAR2(30), iid4
VARCHAR2(30), iid5 VARCHAR2(30));
</pre>
<p>and the data in horiz_table_in looks as follows:</p>
<pre dir="ltr">(&#39;apple&#39;, &#39;banana&#39;, NULL, NULL, NULL)
(&#39;apple&#39;, &#39;milk&#39;, &#39;banana&#39;, NULL, NULL)
(&#39;orange&#39;, NULL, NULL, NULL, NULL)
</pre>
<p>Suppose you want to find out what combinations of items is frequent with a given support threshold of 30%, requiring itemset containing at least one of (&#39;apple&#39;,&#39;banana&#39;,&#39;orange&#39;), but excluding any of (&#39;milk&#39;) in any itemset. You use the following query:</p>
<pre dir="ltr">CREATE TYPE fi_varchar_nt AS TABLE OF VARCHAR2(30);
SELECT CAST(itemset as FI_VARCHAR_NT)itemset, support, length, total_tranx
   FROM table(DBMS_FREQUENT_ITEMSET.FI_HORIZONTAL(
                 CURSOR(SELECT iid1, iid2, iid3, iid4, iid5
                          FROM horiz_table_in),
                 0.3, 
                 2, 
                 5,
                 CURSOR(SELECT * FROM table(FI_VARCHAR_NT 
                                            (&#39;apple&#39;,&#39;banana&#39;,&#39;orange&#39;))),
                 CURSOR(SELECT * FROM table(FI_VARCHAR_NT(&#39;milk&#39;)))));
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS66414" class="refsect2"><a id="BHAHCCDB"></a>
<h3 class="refsect2"><a id="sthref4540"></a>FI_TRANSACTIONAL Function</h3>
<p>This procedure counts all frequent itemsets given a cursor for input data which is in &#39;<code dir="ltr">TRANSACTIONAL</code>&#39; row format, support threshold, minimum itemset length, maximum itemset length, items to be included, items to be excluded. The result will be a table of rows in form of itemset, support, length, total number of transactions.</p>
<p>In &#39;<code dir="ltr">TRANSACTIONAL</code>&#39; row format, each transaction is spread across multiple rows. All the rows of a given transaction have the same transaction id, and each row has a different item id. Combining all of the item ids which share a given transaction id results in a single transaction.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4541"></a>Syntax</p>
<pre dir="ltr">DBMS_FREQUENT_ITEMSET.FI_TRANSACTIONAL (
   tranx_cursor         IN    SYSREFCURSOR,
   support_threshold    IN    NUMBER,
   itemset_length_min   IN    NUMBER,
   itemset_length_max   IN    NUMBER,
   including_items      IN    SYS_REFCURSOR DEFAULT NULL,
   excluding_items      IN    SYS_REFCURSOR DEFAULT NULL)
  RETURN TABLE OF ROW (
     itemset [Nested Table of Item Type DERIVED FROM tranx_cursor],
     support        NUMBER,
     length         NUMBER,
     total_tranx    NUMBER);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4542"></a>Parameters</p>
<div id="ARPLS66415" class="tblformal">
<p class="titleintable"><a id="sthref4543"></a><a id="sthref4544"></a>Table 73-4 <span class="bolditalic">FI_TRANSACTIONAL Function Parameters</span></p>
<table class="cellalignment4330" title="FI_TRANSACTIONAL Function Parameters" summary="This table describes the parameters of DBMS_FREQUENT_ITEMSET.FI_TRANSACTIONAL." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t5">Parameter</th>
<th class="cellalignment4328" id="r1c2-t5">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t5" headers="r1c1-t5">
<p><code dir="ltr">tranx_cursor</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t5 r1c2-t5">
<p>The cursor parameter that the user will supply when calling the function. It should return two columns in its returning row, the first column being the transaction id, the second column being the item id. The item id must be number or character type (for example, <code dir="ltr">VARCHAR2</code>(n)).</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t5" headers="r1c1-t5">
<p><code dir="ltr">support_threshold</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t5 r1c2-t5">
<p>A fraction number of total transaction count. An itemset is termed &#34;frequent&#34; if [the number of transactions it occurs in] divided by [the total number of transactions] exceed the fraction. The parameter must be a <code dir="ltr">NUMBER</code>.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t5" headers="r1c1-t5">
<p><code dir="ltr">itemset_length_min</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t5 r1c2-t5">
<p>The minimum length for interested frequent itemset. The parameter must be a <code dir="ltr">NUMBER</code> between 1 and 20, inclusive.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t5" headers="r1c1-t5">
<p><code dir="ltr">itemset_length_max</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t5 r1c2-t5">
<p>The maximum length for interested frequent itemset. This parameter must be a <code dir="ltr">NUMBER</code> between 1 and 20, inclusive, and must not be less than <code dir="ltr">itemset_length_min</code>.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r6c1-t5" headers="r1c1-t5">
<p><code dir="ltr">including_items</code></p>
</td>
<td class="cellalignment4329" headers="r6c1-t5 r1c2-t5">
<p>A cursor from which a list of items can be fetched. At least one item from the list must appear in frequent itemsets that will be returned. The default is <code dir="ltr">NULL</code>.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r7c1-t5" headers="r1c1-t5">
<p><code dir="ltr">excluding_items</code></p>
</td>
<td class="cellalignment4329" headers="r7c1-t5 r1c2-t5">
<p>A cursor from which a list of items can be fetched. No item from the list can appear in frequent itemsets that will returned. The default is <code dir="ltr">NULL</code>.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4545"></a>Return Values</p>
<div id="ARPLS66416" class="tblformal">
<p class="titleintable"><a id="sthref4546"></a><a id="sthref4547"></a>Table 73-5 FI_TRANSACTIONAL Return Values</p>
<table class="cellalignment4330" title="FI_TRANSACTIONAL Return Values" summary="This table describes the Return Values for FI_TRANSACTIONAL." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t6">Parameter</th>
<th class="cellalignment4328" id="r1c2-t6">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t6" headers="r1c1-t6">
<pre dir="ltr">support
</pre></td>
<td class="cellalignment4329" headers="r2c1-t6 r1c2-t6">
<p>The number of transactions in which a frequent itemset occurs. This will be returned as a <code dir="ltr">NUMBER</code>.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t6" headers="r1c1-t6">
<pre dir="ltr">itemset
</pre></td>
<td class="cellalignment4329" headers="r3c1-t6 r1c2-t6">
<p>A collection of items which is computed as frequent itemset. This will be returned as a nested table of item type which is the item column type of the input cursor.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t6" headers="r1c1-t6">
<pre dir="ltr">length
</pre></td>
<td class="cellalignment4329" headers="r4c1-t6 r1c2-t6">
<p>Number of items in a frequent itemset. This will be returned as a <code dir="ltr">NUMBER</code>.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t6" headers="r1c1-t6">
<pre dir="ltr">total_tranx
</pre></td>
<td class="cellalignment4329" headers="r5c1-t6 r1c2-t6">
<p>The total transaction count. This will be returned as a <code dir="ltr">NUMBER</code>, and will be the same for all returned rows, similar to a reporting aggregate.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4548"></a>Usage Notes</p>
<p>Applications must predefine a nested table type of the input item type and cast the output itemset into this predefined nested table type before further processing, such as loading into a table.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4549"></a>Examples</p>
<p>Suppose that the input table <code dir="ltr">tranx_table_in</code> looks as follows:</p>
<pre dir="ltr">(1, &#39;apple&#39;)
(1, &#39;banana&#39;)
(2, &#39;apple&#39;)
(2, &#39;milk&#39;)
(2, &#39;banana&#39;)
(3, &#39;orange&#39;)
 
</pre>
<p>and the user is trying to find itemsets that satisfy a support-threshold of 60% and have the itemset-length greater than 1 (namely, (apple, banana)).</p>
<p>The output of this function would contain the following output row:</p>
<pre dir="ltr">itemset=(&#39;apple&#39;,&#39;banana&#39;), support=2, length=2, total_tranx=3
</pre>
<p>You need to create a nested table of item type before you submit a query to perform the frequent itemset counting. In this example, since item is of <code dir="ltr">VARCHAR2(30)</code>, you must create a nested table of <code dir="ltr">VARCHAR2(30)</code>:</p>
<pre dir="ltr">CREATE TYPE fi_varchar_nt AS TABLE OF VARCHAR2(30);
SELECT CAST(itemset as FI_VARCHAR_NT) itemset, support, length, total_tranx
   FROM table(DBMS_FREQUENT_ITEMSET.FI_TRANSACTIONAL(
                 cursor(SELECT tid, iid FROM tranx_table_in),
                 0.6, 
                 2, 
                 5,
                 NULL,
                 NULL));
</pre>
<p>Here is another example to illustrate how to include certain items and exclude certain items in the counting.</p>
<pre dir="ltr">SELECT CAST(itemset as FI_VARCHAR_NT)itemset, support, length, total_tranx
   FROM table(DBMS_FREQUENT_ITEMSET.FI_TRANSACTIONAL(
                 CURSOR(SELECT tid, iid FROM tranx_table_in),
                 0.6, 
                 2,
                 5,
                CURSOR(SELECT * FROM table(FI_VARCHAR_NT 
                                           (&#39;apple&#39;,&#39;banana&#39;,&#39;orange&#39;))),
                CURSOR(SELECT * FROM table(FI_VARCHAR_NT(&#39;milk&#39;)))));
</pre>
<p>Using the including/excluding items parameter, you are able to further optimize the execution by ignoring itemsets that are not expected by application.</p>
<p>You can also use transactional output through collection unnesting:</p>
<pre dir="ltr">  SELECT
    bt.setid, nt.*
  FROM
  (SELECT cast(Itemset as FI_VARCHAR_NT) itemset, rownum setid
   FROM table(
     DBMS_FREQUENT_ITEMSET.FI_TRANSACTIONAL(
       CURSOR(SELECT tid, iid FROM tranx_table_in), 0.6, 2, 5,
       NULL, NULL))) bt,
  table(bt.itemset) nt;
</pre>
<p>If you want to use an insert statement to load frequent itemsets into a nested table, it is better to use the <code dir="ltr">NESTED_TABLE_FAST_INSERT</code> hint for performance:</p>
<pre dir="ltr">  CREATE TABLE fq_nt (coll FI_VARCHAR_NT) NESTED TABLE coll STORE AS
    coll_nest;
  INSERT /*+ NESTED_TABLE_FAST_INSERT */  INTO fq_nt
   SELECT cast(itemset as FI_VARCHAR_NT)
   FROM table(DBMS_FREQUENT_ITEMSET.FI_TRANSACTIONAL(
          cursor(SELECT tid, iid FROM tranx_table_in), 0.6, 2, 5,
          NULL, NULL));
</pre>
<p>Note that if you want to use the package inside a PL/SQL cursor, you must cast the return type of the table function:</p>
<pre dir="ltr">  CREATE TYPE fi_res AS OBJECT (
    itemset      FI_VARCHAR_NT,
    support      NUMBER,
    length       NUMBER,
    total_tranx  NUMBER
  );
  /
  CREATE TYPE fi_coll AS TABLE OF fi_res;
  /

  DECLARE
    cursor freqC is
      SELECT Itemset
      FROM table(
        CAST(DBMS_FREQUENT_ITEMSET.FI_TRANSACTIONAL(
          cursor(SELECT tid, iid FROM tranx_table_in), 0.6, 2, 5,
          NULL, NULL) AS fi_coll));
    coll_nt  FI_VARCHAR_NT;
    num_rows int;
    num_itms int;
  BEGIN
    num_rows := 0;
    num_itms := 0;
    OPEN freqC;
    LOOP
      FETCH freqC INTO coll_nt;
      EXIT WHEN freqC%NOTFOUND;
      num_rows := num_rows + 1;
      num_itms := num_itms + coll_nt.count;
    END LOOP;
  CLOSE freqC;
  DBMS_OUTPUT.PUT_LINE(&#39;Totally &#39; || num_rows || &#39; rows &#39; || num_itms || &#39;
items were produced.&#39;);
END;
/
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" --></div>
<!-- class="refentry" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment4320">
<tr>
<td class="cellalignment4329">
<table class="cellalignment4325">
<tr>
<td class="cellalignment4324"><a href="d_goldengate_auth.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment4324"><a href="d_heat_map.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment4332">
<table class="cellalignment4323">
<tr>
<td class="cellalignment4324"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment4324"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment4324"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment4324"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment4324"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment4324"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>