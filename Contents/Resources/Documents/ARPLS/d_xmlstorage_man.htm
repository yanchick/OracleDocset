<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-2400"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/DBMS_XMLSTORAGE_MANAGE"></a><title>DBMS_XMLSTORAGE_MANAGE</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1086"/>
<meta name="dcterms.created" content="2016-09-02T5:37:2Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database PL/SQL Packages and Types Reference"/>
<meta name="dcterms.identifier" content="E41829-07"/>
<meta name="dcterms.isVersionOf" content="ARPLS"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="d_xmlschema_annotate.htm" title="Previous" type="text/html"/>
<link rel="Next" href="d_xmlstore.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41829-07.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">203/290</span> <!-- End Header -->
<div id="ARPLS73588" class="chapter"><a id="CHDIBCII"></a>
<h1 class="chapter"><span class="secnum">199</span> DBMS_XMLSTORAGE_MANAGE</h1>
<p>The <code dir="ltr">DBMS_XMLSTORAGE_MANAGE</code> package provides an interface to manage and modify XML storage after schema registration has been completed.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADXDB5731" href="../ADXDB/xdb25loa.htm#ADXDB5731"><span class="italic">Oracle XML DB Developer&#39;s Guide</span></a></div>
<p>This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#CACFDFCD">Using DBMS_XMLSTORAGE_MANAGE</a></p>
<ul>
<li>
<p>Overview</p>
</li>
<li>
<p>Security Model</p>
</li>
</ul>
</li>
<li>
<p><a href="#CACHBJJB">Summary of DBMS_XMLSTORAGE_MANAGE Subprograms</a></p>
</li>
</ul>
<div class="refentry"><a id="CACFDFCD"></a>
<div id="ARPLS73589" class="refsect1"><!-- infolevel="all" infotype="General" -->
<h2 class="refsect1">Using DBMS_XMLSTORAGE_MANAGE</h2>
<ul>
<li>
<p><a href="#CACIDDDJ">Overview</a></p>
</li>
<li>
<p><a href="#CACCJEJF">Security Model</a></p>
</li>
</ul>
<div id="ARPLS73590" class="refsect2"><a id="CACIDDDJ"></a>
<h3 class="refsect2">Overview</h3>
<p><code dir="ltr">DBMS_XMLSTORAGE_MANAGE</code> contains procedures to manage and modify XML storage after schema registration has been completed. Use subprograms from this package to improve the performance of bulk load operations. You can disable indexes and constraints before doing a bulk load process and to enable them afterwards.</p>
</div>
<!-- class="refsect2" -->
<div id="ARPLS73591" class="refsect2"><a id="CACCJEJF"></a>
<h3 class="refsect2">Security Model</h3>
<p>Owned by XDB, the DBMS_XMLSTORAGE_MANAGE package must be created by <code dir="ltr">SYS</code> or XDB. The <code dir="ltr">EXECUTE</code> privilege is granted to <code dir="ltr">PUBLIC</code>. Subprograms in this package are executed using the privileges of the current user.</p>
</div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" --></div>
<!-- class="refentry" -->
<div class="refentry"><a id="CACHBJJB"></a>
<div id="ARPLS73592" class="refsect1"><!-- infolevel="all" infotype="General" -->
<h2 class="refsect1">Summary of DBMS_XMLSTORAGE_MANAGE Subprograms</h2>
<div id="ARPLS73593" class="tblformal">
<p class="titleintable"><a id="sthref15844"></a><a id="sthref15845"></a>Table 199-1 DBMS_XMLSTORAGE_MANAGE Package Subprograms</p>
<table class="cellalignment4330" title="DBMS_XMLSTORAGE_MANAGE Package Subprograms" summary="DBMS_XML_STORAGE Package Subprograms" dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t3">Subprogram</th>
<th class="cellalignment4328" id="r1c2-t3">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t3" headers="r1c1-t3">
<p><a href="#CHDIJDBB">DISABLEINDEXESANDCONSTRAINTS Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r2c1-t3 r1c2-t3">
<p>Disables the indexes and constraints for <code dir="ltr">XMLType</code> tables and <code dir="ltr">XMLType</code> columns</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t3" headers="r1c1-t3">
<p><a href="#CHDBBDAD">ENABLEINDEXESANDCONSTRAINTS Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r3c1-t3 r1c2-t3">
<p>Rebuilds all indexes and enables the constraints on an <code dir="ltr">XMLType</code> table including its child tables and out-of-line tables</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t3" headers="r1c1-t3">
<p><a href="#CHDDHJFI">EXCHANGEPOSTPROC Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r4c1-t3 r1c2-t3">
<p>Enable constraints after exchange partition</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t3" headers="r1c1-t3">
<p><a href="#CHDJDIGH">EXCHANGEPREPROC Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r5c1-t3 r1c2-t3">
<p>Disable constraints before exchange partition</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r6c1-t3" headers="r1c1-t3">
<p><a href="#CHDBIDDE">INDEXXMLREFERENCES Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r6c1-t3 r1c2-t3">
<p>Creates unique indexes on the <code dir="ltr">REF</code> columns of the given XML type table or the XML type column of a given table</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r7c1-t3" headers="r1c1-t3">
<p><a href="#CHDCFFJH">RENAMECOLLECTIONTABLE Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r7c1-t3 r1c2-t3">
<p>Renames a collection table to the given table name</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r8c1-t3" headers="r1c1-t3">
<p><a href="#CHDDCBAC">SCOPEXMLREFERENCES Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r8c1-t3 r1c2-t3">
<p>Scopes all XML references. Scoped <code dir="ltr">REF</code> types require less storage space and allow more efficient access than unscoped <code dir="ltr">REF</code> types</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r9c1-t3" headers="r1c1-t3">
<p><a href="#CHDCECHD">XPATH2TABCOLMAPPING Function</a></p>
</td>
<td class="cellalignment4329" headers="r9c1-t3 r1c2-t3">
<p>Maps a path expression (in XPath notation or DOT notations) to the corresponding table name and column name</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<div id="ARPLS74486" class="refsect2"><a id="CHDIJDBB"></a>
<h3 class="refsect2"><a id="sthref15846"></a>DISABLEINDEXESANDCONSTRAINTS Procedure</h3>
<p>This procedure disables the indexes and constraints for <code dir="ltr">XMLType</code> tables and <code dir="ltr">XMLType</code> columns.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15847"></a>Syntax</p>
<pre dir="ltr">DBMS_XMLSTORAGE_MANAGE.DISABLEINDEXESANDCONSTRAINTS (
   owner_name    IN  VARCHAR2 DEFAULT USER, 
   table_name    IN  VARCHAR2, 
   column_name   IN  VARCHAR2 DEFAULT NULL,
   clear         IN  BOOLEAN  DEFAULT FALSE);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15848"></a>Parameters</p>
<div id="ARPLS74487" class="tblformal">
<p class="titleintable"><a id="sthref15849"></a><a id="sthref15850"></a>Table 199-2 DISABLEINDEXESANDCONSTRAINTS Procedure Parameters</p>
<table class="cellalignment4330" title="DISABLEINDEXESANDCONSTRAINTS Procedure Parameters" summary="This table describes Parameters used by the DBMS_XMLSTORAGE_MANAGE.DISABLEINDEXESANDCONSTRAINTS subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t4">Parameter</th>
<th class="cellalignment4328" id="r1c2-t4">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t4" headers="r1c1-t4">
<p><code dir="ltr">owner_name</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t4 r1c2-t4">
<p>Owner&#39;s name</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t4" headers="r1c1-t4">
<p><code dir="ltr">table_name</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t4 r1c2-t4">
<p>Name of the <code dir="ltr">XMLType</code> table that the procedure is being performed on</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t4" headers="r1c1-t4">
<p><code dir="ltr">column_name</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t4 r1c2-t4">
<p><code dir="ltr">XMLType</code> column name</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t4" headers="r1c1-t4">
<p><code dir="ltr">clear</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t4 r1c2-t4">
<p>Boolean that when set to <code dir="ltr">TRUE</code> clears all stored index and constraint data for the table before the procedure executes. The default is <code dir="ltr">FALSE</code>, which does not clear them.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15851"></a>Usage Notes</p>
<p class="subhead2"><a id="ARPLS74488"></a>Passing XMLTYPE tables</p>
<p>For <code dir="ltr">XMLType</code> tables, you must pass the <code dir="ltr">XMLType</code> table name on which the bulk load operation is to be performed. For <code dir="ltr">XMLType</code> columns, you must pass the relational table name and the corresponding <code dir="ltr">XMLType</code> column name.</p>
<p class="subhead2"><a id="ARPLS74489"></a>Using clear to Enable and Disable Indexes and Constraints</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If the <code dir="ltr">DISABLEINDEXESANDCONTRAINTS</code> procedure is called with <code dir="ltr">clear</code> set to <code dir="ltr">TRUE</code>, it removes any index or constraint information about the <code dir="ltr">XMLTYPE</code> table or column memorized during earlier executions of the procedure.</div>
<p>Therefore, you must ensure that all disabled indexes and constraints are re-enabled on the table or column before you call the <code dir="ltr">DISABLEINDEXESANDCONTRAINTS</code> procedure with <code dir="ltr">clear</code> set to <code dir="ltr">TRUE</code>.</p>
<p>Ideally, it is recommended that you set <code dir="ltr">clear</code> set to <code dir="ltr">TRUE</code> for the first execution. For any subsequent executions (due to errors while disabling or enabling indexes) <code dir="ltr">clear</code> should be set to <code dir="ltr">FALSE</code>, the default value. Once you have successfully re-enabled all the indexes and constraints following the bulk load operation, you can call this procedure again with <code dir="ltr">clear</code> set to <code dir="ltr">TRUE</code> for the next bulk load operation.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15852"></a>Example</p>
<p>The following example illustrates the use of <code dir="ltr">clear</code> in the <code dir="ltr">DISABLEINDEXESANDCONSTRAINTS</code> procedure and the <a href="#CHDBBDAD">ENABLEINDEXESANDCONSTRAINTS Procedure</a>.</p>
<p>First, add a not-<code dir="ltr">NULL</code> constraint on <code dir="ltr">comment</code> element of the <code dir="ltr">PURCHASEORDER_TAB</code> table:</p>
<pre dir="ltr">ALTER TABLE PURCHASEORDER_TAB ADD CONSTRAINT c1 check            (&#34;XMLDATA&#34;.&#34;comment&#34; IS NOT NULL);
</pre>
<p>Then, disable all the indexes and constraints by passing the <code dir="ltr">clear</code> as <code dir="ltr">TRUE</code>, by calling the <code dir="ltr">DISABLEINDEXESANDCONSTRAINTS</code> procedure:</p>
<pre dir="ltr">BEGIN
     XDB.DBMS_XMLSTORAGE_MANAGE.DISABLEINDEXESANDCONSTRAINTS
                                ( USER,&#39;PURCHASEORDER_TAB&#39;,NULL,TRUE );
END;
/
 
</pre>
<p>Next, perform a bulk load operation (such as datapump import) which violates constraint <code dir="ltr">c1</code> in the <code dir="ltr">ALTER</code> table statement. This does not raise an error because the constraint is disabled:</p>
<pre dir="ltr">host impdp orexample/orexample directory=dir dumpfile=dmp.txt
   tables=OREXAMPLE.PURCHASEORDER_TAB content = DATA_ONLY;
 
</pre>
<p>NOTE: To view the disabled constraints and indexes use:</p>
<pre dir="ltr">SELECT constraint_name,table_name,status FROM all_constraints  
  WHERE owner = user;
</pre>
<p>Finally, try to enable the constraint using the <code dir="ltr">ENABLEINDEXESANDCONSTRAINTS</code> procedure. It raises an error because <code dir="ltr">c1</code>, the not null constraint, is violated by the bulk load operation:</p>
<pre dir="ltr">BEGIN
     XDB.DBMS_XMLSTORAGE_MANAGE.ENABLEINDEXESANDCONSTRAINTS
                                         ( USER,&#39;PURCHASEORDER_TAB&#39;);
END;
/
</pre>
<p>To disable all the indexes and constraints, again use <code dir="ltr">DISABLEINDEXESANDCONSTRAINTS</code>, but set <code dir="ltr">clear=</code> <code dir="ltr">FALSE</code> (because the <code dir="ltr">ENABLEINDEXESANDCONSTRAINTS</code> failed to complete successfully). Note: <code dir="ltr">clear = FALSE</code> by default, so we do not need to pass it explicitly in the next call.</p>
<pre dir="ltr">BEGIN
     xdb.DBMS_XMLSTORAGE_MANAGE.DISABLEINDEXESANDCONSTRAINTS
                                ( USER,&#39;PURCHASEORDER_TAB&#39;);
END;
/
 
</pre>
<p>Then, delete the incorrect rows entered into the table</p>
<pre dir="ltr">DELETE FROM purchaseorder_tab p
     WHERE p.xmldata.&#34;comment&#34; IS NULL;
 
</pre>
<p>Re-enable the indexes and constraints using <code dir="ltr">ENABLEINDEXESANDCONSTRAINTS</code>, which completes successfully.</p>
<pre dir="ltr">BEGIN
     xdb.DBMS_XMLSTORAGE_MANAGE.ENABLEINDEXESANDCONSTRAINTS
                                         ( USER,&#39;PURCHASEORDER_TAB&#39;);
END;
/
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS74490" class="refsect2"><a id="CHDBBDAD"></a>
<h3 class="refsect2"><a id="sthref15853"></a>ENABLEINDEXESANDCONSTRAINTS Procedure</h3>
<p>This procedure rebuilds all indexes and enables the constraints on an <code dir="ltr">XMLType</code> table including its child tables and out-of-line tables. When <code dir="ltr">column_name</code> is passed, it does the same for this <code dir="ltr">XMLType</code> column.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15854"></a>Syntax</p>
<pre dir="ltr">DBMS_XMLSTORAGE_MANAGE.ENABLEINDEXESANDCONSTRAINTS (
   owner_name   IN VARCHAR2 DEFAULT USER, 
   table_name   IN VARCHAR2, 
   column_name  IN VARCHAR2 DEFAULT NULL);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15855"></a>Parameters</p>
<div id="ARPLS74491" class="tblformal">
<p class="titleintable"><a id="sthref15856"></a><a id="sthref15857"></a>Table 199-3 ENABLEINDEXESANDCONSTRAINTS Procedure Parameters</p>
<table class="cellalignment4330" title="ENABLEINDEXESANDCONSTRAINTS Procedure Parameters" summary="This table describes Parameters used by the DBMS_XMLSTORAGE_MANAGE.ENABLEINDEXESANDCONSTRAINTS subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t6">Parameter</th>
<th class="cellalignment4328" id="r1c2-t6">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t6" headers="r1c1-t6">
<p><code dir="ltr">owner_user</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t6 r1c2-t6">
<p>Owner&#39;s name</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t6" headers="r1c1-t6">
<p><code dir="ltr">table_name</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t6 r1c2-t6">
<p>Name of the table that the indexes and constraints are being removed from</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t6" headers="r1c1-t6">
<p><code dir="ltr">column_name</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t6 r1c2-t6">
<p>Column name</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15858"></a>Usage Notes</p>
<p>This procedure reverses <a href="#CHDIJDBB">DISABLEINDEXESANDCONSTRAINTS Procedure</a>.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15859"></a>Example</p>
<p>See <a href="#CHDIJDBB">DISABLEINDEXESANDCONSTRAINTS Procedure</a></p>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS74492" class="refsect2"><a id="CHDDHJFI"></a>
<h3 class="refsect2"><a id="sthref15860"></a>EXCHANGEPOSTPROC Procedure</h3>
<p>This procedure enable constraints after exchange partition.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15861"></a>Syntax</p>
<pre dir="ltr">DBMS_XMLSTORAGE_MANAGE.EXCHANGEPOSTPROC (
   owner_name   IN VARCHAR2 DEFAULT USER, 
   table_name   IN VARCHAR2);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15862"></a>Parameters</p>
<div id="ARPLS74493" class="tblformal">
<p class="titleintable"><a id="sthref15863"></a><a id="sthref15864"></a>Table 199-4 EXCHANGEPOSTPROC Procedure Parameters</p>
<table class="cellalignment4330" title="EXCHANGEPOSTPROC Procedure Parameters" summary="This table describes Parameters used by the DBMS_XMLSTORAGE_MANAGE.EXCHANGEPOSTPROC subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t7">Parameter</th>
<th class="cellalignment4328" id="r1c2-t7">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t7" headers="r1c1-t7">
<p><code dir="ltr">owner_user</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t7 r1c2-t7">
<p>Owner&#39;s name</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t7" headers="r1c1-t7">
<p><code dir="ltr">table_name</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t7 r1c2-t7">
<p>Name of the table that the indexes and constraints are being removed from</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS74494" class="refsect2"><a id="CHDJDIGH"></a>
<h3 class="refsect2"><a id="sthref15865"></a>EXCHANGEPREPROC Procedure</h3>
<p>This procedure disable constraints before exchange partition.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15866"></a>Syntax</p>
<pre dir="ltr">DBMS_XMLSTORAGE_MANAGE.EXCHANGEPREPROC (
   owner_name   IN VARCHAR2 DEFAULT USER, 
   table_name   IN VARCHAR2);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15867"></a>Parameters</p>
<div id="ARPLS74495" class="tblformal">
<p class="titleintable"><a id="sthref15868"></a><a id="sthref15869"></a>Table 199-5 EXCHANGEPREPROC Procedure Parameters</p>
<table class="cellalignment4330" title="EXCHANGEPREPROC Procedure Parameters" summary="This table describes Parameters used by the DBMS_XMLSTORAGE_MANAGE.EXCHANGEPREPROC subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t8">Parameter</th>
<th class="cellalignment4328" id="r1c2-t8">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t8" headers="r1c1-t8">
<p><code dir="ltr">owner_user</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t8 r1c2-t8">
<p>Owner&#39;s name</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t8" headers="r1c1-t8">
<p><code dir="ltr">table_name</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t8 r1c2-t8">
<p>Name of the table that the indexes and constraints are being removed from</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS74496" class="refsect2"><a id="CHDBIDDE"></a>
<h3 class="refsect2"><a id="sthref15870"></a>INDEXXMLREFERENCES Procedure</h3>
<p>This procedure creates unique indexes on the <code dir="ltr">REF</code> columns of the given XML type table or the XML type column of a given table.</p>
<p>If the procedure creates multiple <code dir="ltr">REF</code> columns, it appends <code dir="ltr">_1</code>, <code dir="ltr">_2</code>, and so on to their names.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15871"></a>Syntax</p>
<pre dir="ltr">DBMS_XMLSTORAGE_MANAGE.INDEXXMLREFERENCES (
   owner_name    IN VARCHAR2 DEFAULT USER, 
   table_name    IN VARCHAR2,
   column_name   IN VARCHAR2 DEFAULT NULL);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15872"></a>Parameters</p>
<div id="ARPLS74497" class="tblformal">
<p class="titleintable"><a id="sthref15873"></a><a id="sthref15874"></a>Table 199-6 INDEXXMLREFERENCES Procedure Parameters</p>
<table class="cellalignment4330" title="INDEXXMLREFERENCES Procedure Parameters" summary="This table describes Parameters used by the DBMS_XMLSTORAGE_MANAGE.EXCHANGEPREPROC subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t9">Parameter</th>
<th class="cellalignment4328" id="r1c2-t9">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t9" headers="r1c1-t9">
<p><code dir="ltr">owner_name</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t9 r1c2-t9">
<p>The owner&#39;s name</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t9" headers="r1c1-t9">
<p><code dir="ltr">table_name</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t9 r1c2-t9">
<p>The table being indexed</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t9" headers="r1c1-t9">
<p><code dir="ltr">column_name</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t9 r1c2-t9">
<p>A column name. Not needed for XML type tables.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t9" headers="r1c1-t9">
<p><code dir="ltr">index_name</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t9 r1c2-t9">
<p>The name of the newly created index</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15875"></a>Usage Notes</p>
<p>This procedure is only used if the <code dir="ltr">REF</code>s are scoped. See <a href="#CHDDCBAC">SCOPEXMLREFERENCES Procedure</a>.</p>
<p>Indexed <code dir="ltr">REF</code>s lead to better performance when joins between the base table and a child table occur in the query plan.</p>
<ul>
<li>
<p>If the base table has a higher selectivity than the child table, there is no need to index the <code dir="ltr">REF</code>s.</p>
</li>
<li>
<p>If the selectivity of the child table is higher than that of the base table and if no indexes are present, then the join of one row in the child table with the base table leads to a full table scan of the base table.</p>
</li>
</ul>
<p><code dir="ltr">INDEXXMLREFERENCES</code> does not index <code dir="ltr">REF</code>s recursively in child tables of a table it is called on. To do this, Oracle recommends calling the procedure from within a loop over the <code dir="ltr">XML_OUT_OF_LINE_TABLES</code> or <code dir="ltr">XML_NESTED_TABLES</code> view. This creates the index names from the current value of a column in the view.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
This procedure is limited to the structured storage model.</div>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS74498" class="refsect2"><a id="CHDCFFJH"></a>
<h3 class="refsect2"><a id="sthref15876"></a>RENAMECOLLECTIONTABLE Procedure</h3>
<p>This procedure renames a collection table to the given table name.</p>
<p>An XPath expression specifies the collection table, starting from the <code dir="ltr">XMLtype</code> base table or an <code dir="ltr">XMLType</code> column of the base table.</p>
<p>This procedure provides the only way to derive a collection table name from the corresponding collection type name because there is no direct schema annotation for the purpose.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15877"></a>Syntax</p>
<pre dir="ltr">DBMS_XMLSTORAGE_MANAGE.RENAMECOLLECTIONTABLE (
   owner_name             IN VARCHAR2 DEFAULT USER,
   table_name             IN VARCHAR2,
   column_name            IN VARCHAR2 DEFAULT NULL,
   xpath                  IN VARCHAR2,
   collection_table_name  IN VARCHAR2
   namespaces             IN VARCHAR2 default NULL);  // For release 11.2 only
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15878"></a>Parameters</p>
<div id="ARPLS74499" class="tblformal">
<p class="titleintable"><a id="sthref15879"></a><a id="sthref15880"></a>Table 199-7 RENAMECOLLECTIONTABLE Procedure Parameters</p>
<table class="cellalignment4330" title="RENAMECOLLECTIONTABLE Procedure Parameters" summary="This table describes Parameters used by the DBMS_XMLSTORAGE_MANAGE.RENAMECOLLECTIONTABLE subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t11">Parameter</th>
<th class="cellalignment4328" id="r1c2-t11">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t11" headers="r1c1-t11">
<p><code dir="ltr">owner_name</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t11 r1c2-t11">
<p>The name of the owner</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t11" headers="r1c1-t11">
<p>table_name</p>
</td>
<td class="cellalignment4329" headers="r3c1-t11 r1c2-t11">
<p>The name of a base table that can be used as the starting point for specifying the collection table</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t11" headers="r1c1-t11">
<p><code dir="ltr">column_name</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t11 r1c2-t11">
<p>An <code dir="ltr">XMLType</code> column that can be the starting point for specifying the collection table</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t11" headers="r1c1-t11">
<p><code dir="ltr">xpath</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t11 r1c2-t11">
<p>The XPath expression that specifies the collection table</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r6c1-t11" headers="r1c1-t11">
<p><code dir="ltr">collection_table_name</code></p>
</td>
<td class="cellalignment4329" headers="r6c1-t11 r1c2-t11">
<p>The name of the collection table</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r7c1-t11" headers="r1c1-t11">
<p><code dir="ltr">namespaces</code></p>
</td>
<td class="cellalignment4329" headers="r7c1-t11 r1c2-t11">
<p>For Oracle Database 11<span class="italic">g</span> Release 2 (11.2) and higher. The namespaces used in XPath.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15881"></a>Usage Notes</p>
<p>Call this procedure after registering the XML schema.</p>
<p>The table name serves as a prefix to the index names.</p>
<p>Oracle recommends using this function because it makes query execution plans more readable.</p>
<p>Report errors that occur while this procedure runs to the user that called the procedure.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
This procedure is limited to the structured storage model.</div>
<p>For Oracle Database 11<span class="italic">g</span> Release 2 (11.2) and higher, only, this function accepts XPath notation as well as DOT notation. If XPath notation is used, a <code dir="ltr">namespaces</code> parameter may also be required.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15882"></a>Example</p>
<p>The collection table name will be <code dir="ltr">EMP_TAB_NAMELIST</code>. You can verify this using <code dir="ltr">SELECT * FROM user_nested_tables</code>.</p>
<p class="subhead2"><a id="ARPLS74500"></a>Using DOT Notation:</p>
<pre dir="ltr">call  XDB.DBMS_XMLSTORAGE_MANAGE.RENAMECOLLECTIONTABLE (
            USER,
            &#39;EMP_TAB&#39;,
            NULL,
            &#39;&#34;XMLDATA&#34;.&#34;EMPLOYEE&#34;.&#34;NAME&#34;&#39;,
           &#39;&#39;EMP_TAB_NAMELIST); 
</pre>
<p class="subhead2"><a id="ARPLS74501"></a>Using XPath Notation:</p>
<p>XPath notation is available with Oracle Database 11g Release 2 (11.2) and higher.</p>
<pre dir="ltr">call  XDB.DBMS_XMLSTORAGE_MANAGE.RENAMECOLLECTIONTABLE (
               USER,
               &#39;EMP_TAB&#39;,
               NULL,
               &#39;/e:Employee/Name&#39;,
               &#39;EMP_TAB_NAMELIST&#39;,
               &#39;&#39;&#39;http://www.oracle.com/emp.xsd&#39;&#39; as &#34;e&#34;&#39;); 
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS74502" class="refsect2"><a id="CHDDCBAC"></a>
<h3 class="refsect2"><a id="sthref15883"></a>SCOPEXMLREFERENCES Procedure</h3>
<p>This procedure scopes all XML references. Scoped <code dir="ltr">REF</code> types require less storage space and allow more efficient access than unscoped <code dir="ltr">REF</code> types.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15884"></a>Syntax</p>
<pre dir="ltr">DBMS_XMLSTORAGE_MANAGE.SCOPEXMLREFERENCES;
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15885"></a>Usage Notes</p>
<ul>
<li>
<p>If you have used <a href="d_xmlschema_annotate.htm#CIAHBFAG">SETOUTOFLINE Procedure</a> in the <a href="#CHDIBCII">DBMS_XMLSTORAGE_MANAGE</a> package to avoid raising <code dir="ltr">&#39;1000 column limit&#39;</code> errors during XML schema registration, you should also use <a href="#CHDDCBAC">SCOPEXMLREFERENCES Procedure</a>.</p>
</li>
<li>
<p>Using <code dir="ltr">SCOPEXMLREFERENCES</code> after XML schema registration and before loading XML instance data, makes these reference scoped to the out-of-line table only.</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
This procedure is limited to the structured storage model.</div>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS74503" class="refsect2"><a id="CHDCECHD"></a>
<h3 class="refsect2"><a id="sthref15886"></a>XPATH2TABCOLMAPPING Function</h3>
<p>This function maps a path expression (in XPath notation or DOT notations) to the corresponding table name and column name. This is necessary in cases in which the user wants to create an index on this table, or to add a constraint, or to rename a table to make query execution plans more readable.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15887"></a>Syntax</p>
<pre dir="ltr">DBMS_XMLSTORAGE_MANAGE.XPATH2TABCOLMAPPING (
   owner_name   IN  VARCHAR2 DEFAULT USER, 
   table_name   IN  VARCHAR2,
   column_name  IN  VARCHAR2 DEFAULT NULL,
   xpath        IN  VARCHAR2,
   namespaces   IN  VARCHAR2 DEFAULT NULL)
 RETURN XMLTYPE;
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15888"></a>Parameters</p>
<div id="ARPLS74504" class="tblformal">
<p class="titleintable"><a id="sthref15889"></a><a id="sthref15890"></a>Table 199-8 XPATH2TABCOLMAPPING Procedure Parameters</p>
<table class="cellalignment4330" title="XPATH2TABCOLMAPPING Procedure Parameters" summary="This table describes Parameters used by the DBMS_XMLSTORAGE_MANAGE.XPATH2TABCOLMAPPING subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t14">Parameter</th>
<th class="cellalignment4328" id="r1c2-t14">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t14" headers="r1c1-t14">
<p><code dir="ltr">owner_user</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t14 r1c2-t14">
<p>Owner&#39;s name</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t14" headers="r1c1-t14">
<p><code dir="ltr">table_name</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t14 r1c2-t14">
<p>Name of the base table</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t14" headers="r1c1-t14">
<p><code dir="ltr">column_name</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t14 r1c2-t14">
<p>Optional name of the XML type column if <code dir="ltr">table_name</code> is not an XMLtype table. If table_name refers to XMLType table then <code dir="ltr">column_name</code> should be NULL.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t14" headers="r1c1-t14">
<p><code dir="ltr">xpath</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t14 r1c2-t14">
<p>Path expression in DOT notation or XPath notation (see examples below)</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r6c1-t14" headers="r1c1-t14">
<p><code dir="ltr">namespaces</code></p>
</td>
<td class="cellalignment4329" headers="r6c1-t14 r1c2-t14">
<p>Optional namespace definitions for path expression</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref15891"></a>Examples</p>
<p class="subhead2"><a id="ARPLS74511"></a>XPath2TablColMapping evaluated on XMLType table with Xpath Notation, namespaces provided</p>
<pre dir="ltr">SELECT XDB.DBMS_XMLSTORAGE_MANAGE.XPATH2TABCOLMAPPING (
   USER, &#39;XML_TAB&#39;, &#39;&#39;, &#39;//n1:item/n1:location&#39;,&#39;&#39;&#39;xdbXmark&#39;&#39; as &#34;n1&#34;&#39;) 
FROM DUAL;
</pre>
<p>This produces a result, for example:</p>
<pre dir="ltr">&lt;Result&gt;
&lt;Mapping TableName=&#34;SYS_NT12345&#34; ColumnName=&#34;location&#34;/&gt;
&lt;/Result&gt;
</pre>
<p>This allows us to define an index or constraint on table <code dir="ltr">SYS_NT12345</code> and column <code dir="ltr">location</code>.</p>
<p class="subhead2"><a id="ARPLS74512"></a>XPath2TablColMapping evaluated on table not of XMLType but with XMLType column by means of DOT notation</p>
<pre dir="ltr">SELECT XDB.DBMS_XMLSTORAGE_MANAGE.XPATH2TABCOLMAPPING (   
   USER,&#39;PurchaseOrderTab&#39;,&#39;XMLCOL&#39;,&#39;xmldata.LineItems.LineItem&#39;, &#39;&#39;)
FROM DUAL;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" --></div>
<!-- class="refentry" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment4320">
<tr>
<td class="cellalignment4329">
<table class="cellalignment4325">
<tr>
<td class="cellalignment4324"><a href="d_xmlschema_annotate.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment4324"><a href="d_xmlstore.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment4332">
<table class="cellalignment4323">
<tr>
<td class="cellalignment4324"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment4324"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment4324"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment4324"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment4324"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment4324"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>