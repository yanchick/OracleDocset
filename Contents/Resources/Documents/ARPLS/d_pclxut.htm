<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-2310"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/DBMS_PCLXUTIL"></a><title>DBMS_PCLXUTIL</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1086"/>
<meta name="dcterms.created" content="2016-09-02T5:36:27Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database PL/SQL Packages and Types Reference"/>
<meta name="dcterms.identifier" content="E41829-07"/>
<meta name="dcterms.isVersionOf" content="ARPLS"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="d_part.htm" title="Previous" type="text/html"/>
<link rel="Next" href="d_pdb.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41829-07.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">113/290</span> <!-- End Header -->
<div id="ARPLS037" class="chapter"><a id="sthref6929"></a>
<h1 class="chapter"><span class="secnum">109</span> DBMS_PCLXUTIL</h1>
<p>The <code dir="ltr"><a id="sthref6930"></a>DBMS_PCLXUTIL</code> package provides intra-partition parallelism for creating partition-wise local indexes. <code dir="ltr">DBMS_PCLXUTIL</code> circumvents the limitation that, for local index creation, the degree of parallelism is restricted to the number of partitions as only one parallel execution server process for each partition is used.</p>
<div class="infoboxnotealso">
<p class="notep1"><span class="bold">See Also</span>:</p>
There are several rules concerning partitions and indexes. For more information, see <a class="olink CNCPT" href="../CNCPT/toc.htm"><span class="italic">Oracle Database Concepts</span></a> and <a class="olink ADMIN" href="../ADMIN/toc.htm"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a>.</div>
<p>This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#BABDGBIH">Using DBMS_PCLXUTIL</a></p>
<ul>
<li>
<p>Overview</p>
</li>
<li>
<p>Security Model</p>
</li>
<li>
<p>Operational Notes</p>
</li>
<li>
<p>Rules and Limits</p>
</li>
</ul>
</li>
<li>
<p><a href="#i996811">Summary of DBMS_PCLXUTIL Subprograms</a></p>
</li>
</ul>
<div class="refentry"><a id="BABDGBIH"></a>
<div id="ARPLS67383" class="refsect1">
<h2 class="refsect1">Using DBMS_PCLXUTIL</h2>
<ul>
<li>
<p><a href="#CHDGJJBJ">Overview</a></p>
</li>
<li>
<p><a href="#CHDFCCJC">Security Model</a></p>
</li>
<li>
<p><a href="#i998037">Operational Notes</a></p>
</li>
<li>
<p><a href="#i998038">Rules and Limits</a></p>
</li>
</ul>
<div id="ARPLS73692" class="refsect2"><a id="CHDGJJBJ"></a>
<h3 class="refsect2">Overview</h3>
<p><code dir="ltr">DBMS_PCLXUTIL</code> uses the <code dir="ltr">DBMS_JOB</code> package to provide a greater degree of parallelism for creating a local index for a partitioned table. This is achieved by asynchronous inter-partition parallelism using the background processes (with <code dir="ltr">DBMS_JOB</code>), in combination with intra-partition parallelism using the parallel execution server.</p>
<p><code dir="ltr">DBMS_PCLXUTIL</code> works with both range and range-hash composite partitioning.</p>
<p>The <code dir="ltr">DBMS_PCLXUTIL</code> package can be used during the following DBA tasks:</p>
<ol>
<li>
<p>Local index creation</p>
<p>The procedure <code dir="ltr">BUILD_PART_INDEX</code> assumes that the dictionary information for the local index already exists. This can be done by issuing the create index SQL command with the <code dir="ltr">UNUSABLE</code> option.</p>
<pre dir="ltr">CREATE INDEX &lt;idx_name&gt; on &lt;tab_name&gt;(...) local(...) unusable; 
</pre>
<p>This causes the dictionary entries to be created without &#34;building&#34; the index itself, the time consuming part of creating an index. Now, invoking the procedure <code dir="ltr">BUILD_PART_INDEX</code> causes a concurrent build of local indexes with the specified degree of parallelism.</p>
<pre dir="ltr">EXECUTE dbms_pclxutil.build_part_index(4,4,&lt;tab_name&gt;,&lt;idx_name&gt;,FALSE); 
 
</pre>
<p>For composite partitions, the procedure automatically builds local indexes for all subpartitions of the composite table.</p>
</li>
<li>
<p>Local index maintenance</p>
<p>By marking desired partitions usable or unusable, the <code dir="ltr">BUILD_PART_INDEX</code> procedure also enables selective rebuilding of local indexes. The <code dir="ltr">force_opt</code> parameter provides a way to override this and build local indexes for all partitions.</p>
<pre dir="ltr">ALTER INDEX &lt;idx_name&gt; local(...) unusable; 
</pre>
<p>Rebuild only the desired (sub)partitions (that are marked unusable):</p>
<pre dir="ltr">EXECUTE dbms_pclxutil.build_part_index(4,4,&lt;tab_name&gt;,&lt;idx_name&gt;,FALSE); 
 
</pre>
<p>Rebuild all (sub)partitions using <code dir="ltr">force_opt</code> = <code dir="ltr">TRUE</code>:</p>
<pre dir="ltr">EXECUTE dbms_pclxutil.build_part_index(4,4,&lt;tab_name&gt;,&lt;idx_name&gt;,TRUE); 
 
</pre>
<p>A progress report is produced, and the output appears on screen when the program is ended (because the <code dir="ltr">DBMS_OUTPUT</code> package writes messages to a buffer first, and flushes the buffer to the screen only upon termination of the program).</p>
</li>
</ol>
</div>
<!-- class="refsect2" -->
<div id="ARPLS67385" class="refsect2"><a id="CHDFCCJC"></a>
<h3 class="refsect2">Security Model</h3>
<p>This utility can be run only as table owner, and not as any other user.</p>
</div>
<!-- class="refsect2" -->
<div id="ARPLS67386" class="refsect2"><a id="i998037"></a>
<h3 class="refsect2">Operational Notes</h3>
<p><code dir="ltr">DBMS_PCLXUTIL</code> submits a job for each partition. It is the responsibility of the user/dba to control the number of concurrent jobs by setting the <code dir="ltr">INIT</code>.<code dir="ltr">ORA</code> parameter <code dir="ltr">JOB_QUEUE_PROCESSES</code> correctly. There is minimal error checking for correct syntax. Any errors are reported in the job queue process trace files.</p>
</div>
<!-- class="refsect2" -->
<div id="ARPLS67387" class="refsect2"><a id="i998038"></a>
<h3 class="refsect2">Rules and Limits</h3>
<div class="infobox-note">
<p class="notep1">Note:</p>
For range partitioning, the minimum compatibility mode is 8.0; for range-hash composite partitioning, the minimum compatibility mode is 8<span class="italic">i</span>.</div>
<p>Because <code dir="ltr">DBMS_PCLXUTIL</code> uses the <code dir="ltr">DBMS_JOB</code> package, you must be aware of the following limitations pertaining to <code dir="ltr">DBMS_JOB</code>:</p>
<ul>
<li>
<p>You must decide appropriate values for the <code dir="ltr">job_queue_processes</code> initialization parameter. Clearly, if the job processes are not started before calling <code dir="ltr">BUILD_PART_INDEX</code>(), then the package will not function properly. The background processes are specified by the following <code dir="ltr">init</code>.<code dir="ltr">ora</code> parameters:</p>
</li>
</ul>
<pre dir="ltr">    job_queue_processes=n   #the number of background processes = n  
</pre>
<ul>
<li>
<p>Failure conditions are reported only in the trace files (a <code dir="ltr">DBMS_JOB</code> limitation), making it impossible to give interactive feedback to the user. This package prints a failure message, removes unfinished jobs from the queue, and requests the user to take a look at the <code dir="ltr">j*.trc</code> trace files.</p>
</li>
</ul>
</div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" -->
<a id="i996811"></a>
<div id="ARPLS67388" class="refsect1">
<h2 class="refsect1">Summary of DBMS_PCLXUTIL Subprograms</h2>
<div id="ARPLS67389" class="tblformal">
<p class="titleintable"><a id="sthref6931"></a><a id="sthref6932"></a>Table 109-1 DBMS_PCLXUTIL Package Subprograms</p>
<table class="cellalignment4330" title="DBMS_PCLXUTIL Package Subprograms " summary="This table lists the DBMS_PCLXUTIL subprogram and briefly describes it." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t4">Subprogram</th>
<th class="cellalignment4328" id="r1c2-t4">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t4" headers="r1c1-t4">
<p><a href="#i996814">BUILD_PART_INDEX Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r2c1-t4 r1c2-t4">
<p>Provides intra-partition parallelism for creating partition-wise local indexes</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<div id="ARPLS67390" class="refsect2"><a id="i996814"></a>
<h3 class="refsect2"><a id="sthref6933"></a>BUILD_PART_INDEX Procedure</h3>
<p>This procedure provides intra-partition parallelism for creating partition-wise local indexes.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref6934"></a>Syntax</p>
<pre dir="ltr">DBMS_PCLXUTIL.BUILD_PART_INDEX ( 
   jobs_per_batch  IN NUMBER   DEFAULT 1,
   procs_per_job   IN NUMBER   DEFAULT 1, 
   tab_name        IN VARCHAR2 DEFAULT NULL, 
   idx_name        IN VARCHAR2 DEFAULT NULL, 
   force_opt       IN BOOLEAN  DEFAULT FALSE);  
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref6935"></a>Parameters</p>
<div id="ARPLS67391" class="tblformal">
<p class="titleintable"><a id="sthref6936"></a><a id="sthref6937"></a>Table 109-2 BUILD_PART_INDEX Procedure Parameters</p>
<table class="cellalignment4330" title="BUILD_PART_INDEX Procedure Parameters" summary="This table describes Parameters used by the BUILD_PART_INDEX subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t5">Parameter</th>
<th class="cellalignment4328" id="r1c2-t5">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t5" headers="r1c1-t5">
<p><code dir="ltr">jobs_per_batch</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t5 r1c2-t5">
<p>The number of concurrent partition-wise &#34;local index builds&#34;.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t5" headers="r1c1-t5">
<p><code dir="ltr">procs_per_job</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t5 r1c2-t5">
<p>The number of parallel execution servers to be utilized for each local index build (1 &lt;= <code dir="ltr">procs_per_job</code> &lt;= <code dir="ltr">max_slaves</code>).</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t5" headers="r1c1-t5">
<p><code dir="ltr">tab_name</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t5 r1c2-t5">
<p>The name of the partitioned table (an exception is raised if the table does not exist or not partitioned).</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t5" headers="r1c1-t5">
<p><code dir="ltr">idx_name</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t5 r1c2-t5">
<p>The name given to the local index (an exception is raised if a local index is not created on the table <code dir="ltr">tab_name</code>).</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r6c1-t5" headers="r1c1-t5">
<p><code dir="ltr">force_opt</code></p>
</td>
<td class="cellalignment4329" headers="r6c1-t5 r1c2-t5">
<p>If <code dir="ltr">TRUE</code>, then force rebuild of all partitioned indexes; otherwise, rebuild only the partitions marked &#39;<code dir="ltr">UNUSABLE</code>&#39;.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref6938"></a>Usage Notes</p>
<p>This utility can be run only as table owner, and not as any other user.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref6939"></a>Examples</p>
<p>Suppose a table <code dir="ltr">PROJECT</code> is created with two partitions <code dir="ltr">PROJ001</code> and <code dir="ltr">PROJ002</code>, along with a local index <code dir="ltr">IDX</code>.</p>
<p>A call to the procedure <code dir="ltr">BUILD_PART_INDEX(2,4,&#39;PROJECT&#39;,&#39;IDX&#39;,TRUE)</code> produces the following output:</p>
<pre dir="ltr">SQLPLUS&gt; EXECUTE dbms_pclxutil.build_part_index(2,4,&#39;PROJECT&#39;,&#39;IDX&#39;,TRUE); 
Statement processed. 
INFO: Job #21 created for partition PROJ002 with 4 slaves 
INFO: Job #22 created for partition PROJ001 with 4 slaves 
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" --></div>
<!-- class="refentry" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment4320">
<tr>
<td class="cellalignment4329">
<table class="cellalignment4325">
<tr>
<td class="cellalignment4324"><a href="d_part.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment4324"><a href="d_pdb.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment4332">
<table class="cellalignment4323">
<tr>
<td class="cellalignment4324"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment4324"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment4324"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment4324"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment4324"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment4324"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>