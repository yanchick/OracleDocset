<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-2268"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/DBMS_FGA"></a><title>DBMS_FGA</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1086"/>
<meta name="dcterms.created" content="2016-09-02T5:36:20Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database PL/SQL Packages and Types Reference"/>
<meta name="dcterms.identifier" content="E41829-07"/>
<meta name="dcterms.isVersionOf" content="ARPLS"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="d_errlog.htm" title="Previous" type="text/html"/>
<link rel="Next" href="d_filgrp.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41829-07.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">71/290</span> <!-- End Header -->
<div id="ARPLS015" class="chapter"><a id="CIABBGDJ"></a> <a id="i1001938"></a>
<h1 class="chapter"><span class="secnum">67</span> DBMS_FGA</h1>
<p>The <code dir="ltr"><a id="sthref4245"></a>DBMS_FGA</code> package provides fine-grained security functions.</p>
<p>This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#CIAFBIDH">Using DBMS_FGA</a></p>
<ul>
<li>
<p>Security Model</p>
</li>
<li>
<p>Operational Notes</p>
</li>
</ul>
</li>
<li>
<p><a href="#i1002216">Summary of DBMS_FGA Subprograms</a></p>
</li>
</ul>
<div class="refentry"><a id="CIAFBIDH"></a>
<div id="ARPLS66348" class="refsect1">
<h2 class="refsect1">Using DBMS_FGA</h2>
<ul>
<li>
<p><a href="#i1005836">Security Model</a></p>
</li>
<li>
<p><a href="#i1005872">Operational Notes</a></p>
</li>
</ul>
<div id="ARPLS66349" class="refsect2"><a id="i1005836"></a>
<h3 class="refsect2">Security Model</h3>
<p>You must have the <code dir="ltr">AUDIT_ADMIN</code> role and the <code dir="ltr">EXECUTE</code> privilege on the <code dir="ltr">DBMS_FGA</code> package to administer audit policies. Because the audit function can potentially capture all user environment and application context values, policy administration should be executable by privileged users only. The policy event handler module will be executed with the module owner&#39;s privilege.</p>
</div>
<!-- class="refsect2" -->
<div id="ARPLS66350" class="refsect2"><a id="i1005872"></a>
<h3 class="refsect2">Operational Notes</h3>
<p>This package is available for only cost-based optimization. The rule-based optimizer may generate unnecessary audit records since audit monitoring can occur before row filtering. For both the rule-based optimizer and the cost-based optimizer, you can query the <code dir="ltr">SQL_TEXT</code> and <code dir="ltr">SQL_BINDS</code> columns of the <code dir="ltr">UNIFIED_AUDIT_TRAIL</code> view to analyze the SQL text and corresponding bind variables that are issued.</p>
</div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" -->
<a id="i1002216"></a>
<div id="ARPLS66351" class="refsect1">
<h2 class="refsect1">Summary of DBMS_FGA Subprograms</h2>
<div id="ARPLS66352" class="tblformal">
<p class="titleintable"><a id="sthref4246"></a><a id="sthref4247"></a>Table 67-1 <span class="bolditalic">DBMS_FGA Package Subprograms</span></p>
<table class="cellalignment4330" title="DBMS_FGA Package Subprograms" summary="This table lists the DBMS_FGA subprograms in alphabetical order and briefly describes them." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t2">Subprogram</th>
<th class="cellalignment4328" id="r1c2-t2">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t2" headers="r1c1-t2">
<p><a href="#CDEIECAG">ADD_POLICY Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r2c1-t2 r1c2-t2">
<p>Creates an audit policy using the supplied predicate as the audit condition</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t2" headers="r1c1-t2">
<p><a href="#i1011920">DISABLE_POLICY Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r3c1-t2 r1c2-t2">
<p>Disables an audit policy</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t2" headers="r1c1-t2">
<p><a href="#i1011851">DROP_POLICY Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r4c1-t2 r1c2-t2">
<p>Drops an audit policy</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t2" headers="r1c1-t2">
<p><a href="#i1011884">ENABLE_POLICY Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r5c1-t2 r1c2-t2">
<p>Enables an audit policy</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<div id="ARPLS225" class="refsect2"><a id="CDEIECAG"></a>
<h3 class="refsect2"><a id="sthref4248"></a>ADD_POLICY Procedure</h3>
<p>This procedure creates an audit policy using the supplied predicate as the audit condition.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4249"></a>Syntax</p>
<pre dir="ltr">DBMS_FGA.ADD_POLICY(
<span class="italic">   </span>object_schema      IN  VARCHAR2 DEFAULT NULL, 
   object_name        IN  VARCHAR2,<span class="italic"> </span>
   policy_name        IN  VARCHAR2, 
   audit_condition    IN  VARCHAR2 DEFAULT NULL, 
   audit_column       IN  VARCHAR2 DEFAULT NULL, 
   handler_schema     IN  VARCHAR2 DEFAULT NULL, 
<span class="italic">   </span>handler_module     IN  VARCHAR2 DEFAULT NULL, 
   enable             IN  BOOLEAN DEFAULT TRUE, 
   statement_types    IN  VARCHAR2 DEFAULT SELECT,
   audit_trail        IN  BINARY_INTEGER DEFAULT NULL,
   audit_column_opts  IN  BINARY_INTEGER DEFAULT ANY_COLUMNS,
   policy_owner       IN  VARCHAR2 DEFAULT NULL);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4250"></a>Parameters</p>
<div id="ARPLS74535" class="tblformal">
<p class="titleintable"><a id="sthref4251"></a><a id="sthref4252"></a>Table 67-2 ADD_POLICY Procedure Parameters</p>
<table class="cellalignment4330" title="ADD_POLICY Procedure Parameters" summary="This table lists and describes the ADD_POLICY procedure parameters and their default values." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t3">Parameter</th>
<th class="cellalignment4328" id="r1c2-t3">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t3" headers="r1c1-t3">
<p><code dir="ltr">object_schema</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t3 r1c2-t3">
<p>Schema of the object to be audited. If <code dir="ltr">NULL</code>, the current log-on user schema is assumed.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t3" headers="r1c1-t3">
<p><code dir="ltr">object_name</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t3 r1c2-t3">
<p>Name of the object to be audited</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t3" headers="r1c1-t3">
<p><code dir="ltr">policy_name</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t3 r1c2-t3">
<p>Unique name of the policy</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t3" headers="r1c1-t3">
<p><code dir="ltr">audit_condition</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t3 r1c2-t3">
<p>A condition in a row that indicates a monitoring condition. <code dir="ltr">NULL</code> is allowed and acts as <code dir="ltr">TRUE</code>.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r6c1-t3" headers="r1c1-t3">
<p><code dir="ltr">audit_column</code></p>
</td>
<td class="cellalignment4329" headers="r6c1-t3 r1c2-t3">
<p>Columns to be checked for access. These can include OLS hidden columns or object type columns. The default, <code dir="ltr">NULL</code>, causes audit if any column is accessed or affected.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r7c1-t3" headers="r1c1-t3">
<p><code dir="ltr">handler_schema</code></p>
</td>
<td class="cellalignment4329" headers="r7c1-t3 r1c2-t3">
<p>Schema that contains the event handler. The default, <code dir="ltr">NULL</code>, causes the current schema to be used.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r8c1-t3" headers="r1c1-t3">
<p><code dir="ltr">handler_module</code></p>
</td>
<td class="cellalignment4329" headers="r8c1-t3 r1c2-t3">
<p>Function name of the event handler; includes the package name if necessary. This function is invoked only after the first row that matches the audit condition in the query is processed. If the procedure fails with an exception, the user SQL statement will fail as well.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r9c1-t3" headers="r1c1-t3">
<p><code dir="ltr">enable</code></p>
</td>
<td class="cellalignment4329" headers="r9c1-t3 r1c2-t3">
<p>Enables the policy if <code dir="ltr">TRUE</code>, which is the default</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r10c1-t3" headers="r1c1-t3">
<p><code dir="ltr">statement_types</code></p>
</td>
<td class="cellalignment4329" headers="r10c1-t3 r1c2-t3">
<p>SQL statement types to which this policy is applicable: <code dir="ltr">INSERT</code>, <code dir="ltr">UPDATE</code>, <code dir="ltr">DELETE</code>, or <code dir="ltr">SELECT</code> only</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r11c1-t3" headers="r1c1-t3">
<p><code dir="ltr">audit_trail</code></p>
</td>
<td class="cellalignment4329" headers="r11c1-t3 r1c2-t3">
<p>In an environment that has not yet migrated to unified auditing, the destination (DB or XML) of fine-grained audit records. Also specifies whether to populate the <code dir="ltr">LSQLTEXT</code> and <code dir="ltr">LSQLBIND</code> columns in the <code dir="ltr">FGA_LOG$</code> system table.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r12c1-t3" headers="r1c1-t3">
<p><code dir="ltr">audit_column_opts</code></p>
</td>
<td class="cellalignment4329" headers="r12c1-t3 r1c2-t3">
<p>Establishes whether a statement is audited when the query references <span class="italic">any</span> column specified in the <code dir="ltr">audit_column</code> parameter or only when <span class="italic">all</span> such columns are referenced</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r13c1-t3" headers="r1c1-t3">
<p><code dir="ltr">policy_owner</code></p>
</td>
<td class="cellalignment4329" headers="r13c1-t3 r1c2-t3">
<p>User who owns the fine-grained auditing policy. However, this setting is not a user-supplied argument. The Oracle Data Pump client uses this setting internally to recreate the fine-grained audit policies appropriately.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="CDECGACG"></a>Usage Notes</p>
<ul>
<li>
<p>A table or view can have a maximum of 256 fine-grained audit policies applied to it.</p>
</li>
<li>
<p>If <code dir="ltr">object_schema</code> is not specified, then the current log-on user schema is assumed.</p>
</li>
<li>
<p>An FGA policy should not be applied to out-of-line columns such as LOB columns.</p>
</li>
<li>
<p>Each audit policy is applied to the query individually. However, at most one audit record may be generated for each policy, no matter how many rows being returned satisfy that policy&#39;s <code dir="ltr">audit_condition</code>. In other words, whenever any number of rows being returned satisfy an audit condition defined on the table, a single audit record will be generated for each such policy.</p>
</li>
<li>
<p>If a table with an FGA policy defined on it receives a Fast Path insert or a vectored update, the hint is automatically disabled before any such operations. Disabling the hint allows auditing to occur according to the policy&#39;s terms. (One example of a Fast Path insert is the statement <code dir="ltr">INSERT-WITH-APPEND-hint</code>.)</p>
</li>
<li>
<p>The <code dir="ltr">audit_condition</code> must be a boolean expression that can be evaluated using the values in the row being inserted, updated, or deleted. The expression can also use functions, such as the <code dir="ltr">USER</code> or <code dir="ltr">SYS_CONTEXT</code> functions.</p>
<p>The expression must not combine conditions using operators such as <code dir="ltr">AND</code> and <code dir="ltr">OR</code>. <code dir="ltr">audit_condition</code> can be <code dir="ltr">NULL</code> (or omitted), which is interpreted as <code dir="ltr">TRUE</code>, but it cannot contain the following elements:</p>
<ul>
<li>
<p>Subqueries or sequences</p>
</li>
<li>
<p>The following attributes of the <code dir="ltr">USERENV</code> namespace when accessed using the <code dir="ltr">SYS_CONTEXT</code> function:</p>
<ul>
<li>
<p><code dir="ltr">CURRENT_SQL</code></p>
</li>
<li>
<p><code dir="ltr">CURRENT_SQL_LENGTH</code></p>
</li>
<li>
<p><code dir="ltr">CURRENT_BIND</code></p>
</li>
</ul>
</li>
<li>
<p>Any use of the pseudo columns <code dir="ltr">LEVEL, PRIOR, or ROWNUM</code>.</p>
</li>
</ul>
<p>Specifying an audit condition of &#34;1=1&#34; to force auditing of all specified statements (&#34;<code dir="ltr">statement_types</code>&#34;) affecting the specified column (&#34;<code dir="ltr">audit_column</code>&#34;) is no longer needed to achieve this purpose. A <code dir="ltr">NULL</code> value for <code dir="ltr">audit_condition</code> causes audit to happen even if no rows are processed, so that all actions on a table with this policy are audited.</p>
</li>
<li>
<p>The <code dir="ltr">audit_condition</code> is evaluated using the privileges of the user who creates the policy.</p>
</li>
<li>
<p>For the <code dir="ltr">audit_condition</code> setting, do not include functions, which execute the <code dir="ltr">auditable</code> statement on the same base table, in the <code dir="ltr">audit_condition</code> setting. For example, suppose you create a function that executes an <code dir="ltr">INSERT</code> statement on the <code dir="ltr">HR.EMPLOYEES</code> table. The policy <code dir="ltr">audit_condition</code> contains this function and it is for <code dir="ltr">INSERT</code> statements (as set by the statement_types parameter). When the policy is used, the function executes recursively until the system has run out of memory. This can raise the error <code dir="ltr">ORA-1000: maximum open cursors exceeded</code> or <code dir="ltr">ORA-00036: maximum number of recursive SQL levels (50) exceeded</code>.</p>
</li>
<li>
<p>Do not issue the <code dir="ltr">DBMS_FGA.ENABLE_POLICY</code> or <code dir="ltr">DBMS_FGA.DISABLE_POLICY</code> statement from a policy function in a condition.</p>
</li>
<li>
<p>The audit function (<code dir="ltr">handler_module</code>) is an alerting mechanism for the administrator. The required interface for such a function is as follows:</p>
<pre dir="ltr">PROCEDURE <span class="italic">fname</span> ( <span class="italic">object_schema</span> VARCHAR2, <span class="italic">object_name</span> VARCHAR2, <span class="italic">policy_name</span> VARCHAR2 )  AS ...
</pre>
<p>where <code dir="ltr"><span class="codeinlineitalic">fname</span></code> is the name of the procedure, <code dir="ltr"><span class="codeinlineitalic">object_schema</span></code> is the name of the schema of the table audited, <code dir="ltr"><span class="codeinlineitalic">object_name</span></code> is the name of the table to be audited, and <code dir="ltr"><span class="codeinlineitalic">policy_name</span></code> is the name of the policy being enforced. The audit function will be executed with the function owner&#39;s privilege.</p>
</li>
<li>
<p>If you have migrated to unified auditing, then omit the <code dir="ltr">audit_trail</code> parameter because the audit records will automatically be written to the unified audit trail.</p>
</li>
<li>
<p>Be aware that sensitive data, such as credit card information, can be recorded in clear text.</p>
</li>
<li>
<p>The <code dir="ltr">audit_trail</code> parameter, if used, specifies both where the fine-grained audit trail will be written and whether it is to include the query&#39;s SQL Text and SQL Bind variable information (typically in columns named <code dir="ltr">LSQLTEXT</code> and <code dir="ltr">LSQLBIND</code>):</p>
<ul>
<li>
<p>If audit_trail includes XML, then fine-grained audit records are written to XML-format operating system files stored in the directory specified by an <code dir="ltr">AUDIT_FILE_DEST</code> statement in SQL. (The default <code dir="ltr">AUDIT_FILE_DEST</code> is <code dir="ltr">$ORACLE_BASE/admin/$DB_UNIQUE_NAME/adump</code> on Unix-based systems, and $<code dir="ltr">ORACLE_BASE\admin\$DB_UNIQUE_NAME\adump</code> on Windows systems.)</p>
</li>
<li>
<p>If <code dir="ltr">audit_trail</code> includes <code dir="ltr">DB</code> instead, then the audit records are written to the <code dir="ltr">SYS.FGA_LOG$</code> table in the database. However, for read-only databases, Oracle Database writes the fine-grained audit records to XML files, regardless of the <code dir="ltr">audit_trail</code> settings.</p>
</li>
<li>
<p>If audit_trail includes <code dir="ltr">EXTENDED</code>, then the query&#39;s SQL Text and SQL Bind variable information are included in the audit trail.</p>
</li>
<li>
<p>For example:</p>
<ul>
<li>
<p>Setting <code dir="ltr">audit_trail</code> to <code dir="ltr">DBMS_FGA.DB</code> sends the audit trail to the <code dir="ltr">SYS.FGA_LOG$</code> table in the database and omits SQL Text and SQL Bind.</p>
</li>
<li>
<p>Setting <code dir="ltr">audit_trail</code> to <code dir="ltr">DBMS_FGA.DB + DBMS_FGA.EXTENDED</code> sends the audit trail to the <code dir="ltr">SYS.FGA_LOG$</code> table in the database and includes SQL Text and SQL Bind.</p>
</li>
<li>
<p>Setting <code dir="ltr">audit_trail</code> to <code dir="ltr">DBMS_FGA.XML</code> writes the audit trail in XML files sent to the operating system and omits SQL Text and SQL Bind.</p>
</li>
<li>
<p>Setting <code dir="ltr">audit_trail</code> to <code dir="ltr">DBMS_FGA.XML + DBMS_FGA.EXTENDED</code> writes the audit trail in XML files sent to the operating system and includes SQL Text and SQL Bind.</p>
</li>
</ul>
</li>
</ul>
<p>The <code dir="ltr">audit_trail</code> parameter appears in the <code dir="ltr">ALL_AUDIT_POLICIES</code> view.</p>
</li>
<li>
<p>You can change the operating system destination using the following command:</p>
<pre dir="ltr">ALTER SYSTEM SET AUDIT_FILE_DEST =  <span class="italic">New Directory</span> DEFERRED
</pre></li>
<li>
<p>On many platforms, XML audit files are named <code dir="ltr"><span class="codeinlineitalic">process_name_processId</span></code><code dir="ltr">.xml</code>, for example, <code dir="ltr">ora_2111.xml</code>. Alternatively,l on Windows, the XML audit files are named <code dir="ltr"><span class="codeinlineitalic">process_name_ThreadId</span></code><code dir="ltr">.xml</code> (or <code dir="ltr"><span class="codeinlineitalic">process_name_ProcessId</span></code><code dir="ltr">.xml</code> if the process is not running as a thread).</p>
</li>
<li>
<p>The <code dir="ltr">audit_column_opts</code> parameter establishes whether a statement is audited</p>
<ul>
<li>
<p>when the query references <span class="italic">any</span> column specified in the audit_column parameter (<code dir="ltr">audit_column_opts</code> = <code dir="ltr">DBMS_FGA.ANY_COLUMNS</code>), or</p>
</li>
<li>
<p>only when <span class="italic">all</span> such columns are referenced (<code dir="ltr">audit_column_opts</code> = <code dir="ltr">DBMS_FGA.ALL_COLUMNS</code>).</p>
</li>
</ul>
<p>The default is <code dir="ltr">DBMS_FGA.ANY_COLUMNS</code>.</p>
<p>The <code dir="ltr">ALL_AUDIT_POLICIES</code> view also shows <code dir="ltr">audit_column_opts</code>.</p>
</li>
<li>
<p>When <code dir="ltr">audit_column_opts</code> is set to <code dir="ltr">DBMS_FGA.ALL_COLUMNS</code>, a SQL statement is audited only when all the columns mentioned in <code dir="ltr">audit_column</code> have been explicitly referenced in the statement. And these columns must be referenced in the same SQL-statement or in the sub-select.</p>
<p>All these columns must refer to a single table/view or alias.</p>
<p>If a SQL statement selects the columns from different table aliases, the statement will not be audited.</p>
</li>
<li>
<p>Every XML audit record contains the elements <code dir="ltr">AUDIT_TYPE</code> and <code dir="ltr">EXTENDED_TIMESTAMP</code>, with the latter printed in UTC zone (with no timezone information). Values retrieved using <code dir="ltr">V$XML_AUDIT_TRAIL</code> view are converted to session timezone and printed.</p>
</li>
<li>
<p>For <code dir="ltr">SQL_TEXT</code> and <code dir="ltr">SQL_BIND</code> element values (<code dir="ltr">CLOB</code> type columns), the dynamic view shows only the first 4000 characters. The underlying XML file may have more than 4000 characters for such <code dir="ltr">SQL_TEXT</code> and <code dir="ltr">SQL_BIND</code> values.</p>
</li>
<li>
<p>For large numbers of XML audit files, querying <code dir="ltr">V$XML_AUDIT_TRAIL</code> is faster when they are loaded into a database table using SQL*Loader or a similar tool. XML audit files are larger than the equivalent written to OS files when <code dir="ltr">AUDIT_TRAIL</code>=OS.</p>
</li>
<li>
<p>Error handling is the same as when <code dir="ltr">AUDIT_TRAIL</code>=OS. If any error occurs in writing an audit record to disk, including the directory identified by <code dir="ltr">AUDIT_FILE_DEST</code> being full, the auditing operation fails. An alert message is logged.</p>
</li>
<li>
<p>The policy event handler module will be executed with the module owner&#39;s privilege.</p>
</li>
<li>
<p>Do not create recursive fine-grained audit handlers. For example, suppose you create a handler that executes an <code dir="ltr">INSERT</code> statement on the <code dir="ltr">HR.EMPLOYEES</code> table. The policy that is associated with this handler is for <code dir="ltr">INSERT</code> statements (as set by the statement_types parameter). When the policy is used, the handler executes recursively until the system has run out of memory. This can raise the error <code dir="ltr">ORA-1000: maximum open cursors exceeded</code> or <code dir="ltr">ORA-00036: maximum number of recursive SQL levels (50) exceeded</code>. See also <a class="olink DBSEG797" href="../DBSEG/audit_config.htm#DBSEG797"><span class="italic">Oracle Database Security Guide</span></a> with regard to Creating a Fine-Grained Audit Policy.</p>
</li>
<li>
<p>The values for the <code dir="ltr">audit_trail</code> parameter (<code dir="ltr">XML</code> and <code dir="ltr">XML+EXTENDED</code>) cause fine-grained auditing records to be written to operating system files in XML format. A dynamic view, <code dir="ltr">V$</code><code dir="ltr">XML_AUDIT_TRAIL</code>, makes such audit records from XML files available to DBAs through SQL query, providing enhanced usability. Querying this view causes all XML files (all files with an<code dir="ltr">.xml</code> extension) in the <code dir="ltr">AUDIT_FILE_DEST</code> directory to be parsed and presented in relational table format.</p>
<p>Audit records stored in operating system files can be more secure than database-stored audit records because access can require file permissions that DBAs do not have. Operating system storage for audit records also offers higher availability, since such records remain available even if the database is temporarily inaccessible.</p>
<p>The <code dir="ltr">DBA_COMMON_AUDIT_TRAIL</code> view includes the contents of the <code dir="ltr">V$</code><code dir="ltr">XML_AUDIT_TRAIL</code> dynamic view for standard and fine-grained audit records.</p>
<p>Note that the <code dir="ltr">V$XML_AUDIT_TRAIL</code> view is populated only if unified auditing is not enabled. If you have enabled unified auditing, then you can query the <code dir="ltr">UNIFIED_AUDIT_TRAIL</code> data dictionary view for the audit trail records.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink DBSEG90057" href="../DBSEG/audit_config.htm#DBSEG90057"></a> <a class="olink DBSEG90057" href="../DBSEG/audit_config.htm#DBSEG90057"><span class="italic">Oracle Database Security Guide</span></a> for an example of creating an email alert handler for a fine-grained audit policy</div>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4253"></a>Examples</p>
<pre dir="ltr">DBMS_FGA.ADD_POLICY (
   object_schema      =&gt;  &#39;scott&#39;, 
   object_name        =&gt;  &#39;emp&#39;, 
   policy_name        =&gt;  &#39;mypolicy1&#39;, 
   audit_condition    =&gt;  &#39;sal &lt; 100&#39;, 
   audit_column       =&gt;  &#39;comm,sal&#39;, 
   handler_schema     =&gt;   NULL, 
   handler_module     =&gt;   NULL, 
   enable             =&gt;   TRUE, 
   statement_types    =&gt;  &#39;INSERT, UPDATE&#39;, 
   audit_column_opts  =&gt;   DBMS_FGA.ANY_COLUMNS,
   policy_owner       =&gt;  &#39;sec_admin); 
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS226" class="refsect2"><a id="i1011920"></a>
<h3 class="refsect2">DISABLE_POLICY Procedure</h3>
<p>This procedure disables an audit policy.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4254"></a>Syntax</p>
<pre dir="ltr">DBMS_FGA.DISABLE_POLICY(
<span class="italic">   </span>object_schema  IN  VARCHAR2, 
   object_name    IN  VARCHAR2,<span class="italic"> </span>
   policy_name    IN  VARCHAR2); 
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4255"></a>Parameters</p>
<div id="ARPLS66355" class="tblformal">
<p class="titleintable"><a id="sthref4256"></a><a id="sthref4257"></a>Table 67-3 DISABLE_POLICY Procedure Parameters</p>
<table class="cellalignment4330" title="DISABLE_POLICY Procedure Parameters" summary="This table lists and describes the DISABLE_POLICY procedure parameters." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t5">Parameter</th>
<th class="cellalignment4328" id="r1c2-t5">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t5" headers="r1c1-t5">
<p><code dir="ltr">object_schema</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t5 r1c2-t5">
<p>Schema of the object to be audited. If <code dir="ltr">NULL</code>, the current log-on user schema is assumed.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t5" headers="r1c1-t5">
<p><code dir="ltr">object_name</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t5 r1c2-t5">
<p>Name of the object to be audited</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t5" headers="r1c1-t5">
<p><code dir="ltr">policy_name</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t5 r1c2-t5">
<p>Unique name of the policy</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<p>The default value for <code dir="ltr">object_schema</code> is <code dir="ltr">NULL</code>. (If <code dir="ltr">NULL</code>, the current log-on user schema is assumed.)</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4258"></a>Examples</p>
<pre dir="ltr">DBMS_FGA.DISABLE_POLICY (
object_schema   =&gt;  &#39;scott&#39;,
object_name     =&gt;  &#39;emp&#39;,
policy_name     =&gt;  &#39;mypolicy1&#39;);
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS227" class="refsect2"><a id="i1011851"></a>
<h3 class="refsect2">DROP_POLICY Procedure</h3>
<p>This procedure drops an audit policy.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4259"></a>Syntax</p>
<pre dir="ltr">DBMS_FGA.DROP_POLICY(
   object_schema  IN  VARCHAR2, 
   object_name    IN  VARCHAR2,<span class="italic"> </span>
   policy_name    IN  VARCHAR2);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4260"></a>Parameters</p>
<div id="ARPLS66356" class="tblformal">
<p class="titleintable"><a id="sthref4261"></a><a id="sthref4262"></a>Table 67-4 DROP_POLICY Procedure Parameters</p>
<table class="cellalignment4330" title="DROP_POLICY Procedure Parameters" summary="This table lists and describes the DROP_POLICY procedure parameters." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t6">Parameter</th>
<th class="cellalignment4328" id="r1c2-t6">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t6" headers="r1c1-t6">
<p><code dir="ltr">object_schema</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t6 r1c2-t6">
<p>Schema of the object to be audited. If <code dir="ltr">NULL</code>, the current log-on user schema is assumed.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t6" headers="r1c1-t6">
<p><code dir="ltr">object_name</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t6 r1c2-t6">
<p>Name of the object to be audited</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t6" headers="r1c1-t6">
<p><code dir="ltr">policy_name</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t6 r1c2-t6">
<p>Unique name of the policy</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4263"></a>Usage Notes</p>
<p>The <code dir="ltr">DBMS_FGA</code> procedures cause current DML transactions, if any, to commit before the operation unless they are inside a DDL event trigger. With DDL transactions, the <code dir="ltr">DBMS_FGA</code> procedures are part of the DDL transaction. The default value for object_schema is <code dir="ltr">NULL</code>. (If <code dir="ltr">NULL</code>, the current log-on user schema is assumed.<code dir="ltr">)</code></p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle Database automatically drops the audit policy if you remove the object specified in the <code dir="ltr">object_name</code> parameter of the <code dir="ltr">DBMS_FGA.ADD_POLICY</code> procedure, or if you drop the user who created the audit policy.</div>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4264"></a>Examples</p>
<pre dir="ltr">DBMS_FGA.DROP_POLICY (
object_schema   =&gt;  &#39;scott&#39;,
object_name     =&gt;  &#39;emp&#39;,
policy_name     =&gt;  &#39;mypolicy1&#39;);
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS228" class="refsect2"><a id="i1011884"></a>
<h3 class="refsect2">ENABLE_POLICY Procedure</h3>
<p>This procedure enables an audit policy.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4265"></a>Syntax</p>
<pre dir="ltr">DBMS_FGA.ENABLE_POLICY(
<span class="italic">   </span>object_schema  IN  VARCHAR2,
   object_name    IN  VARCHAR2,
   policy_name    IN  VARCHAR2,
   enable         IN  BOOLEAN);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4266"></a>Parameters</p>
<div id="ARPLS66357" class="tblformal">
<p class="titleintable"><a id="sthref4267"></a><a id="sthref4268"></a>Table 67-5 ENABLE_POLICY Procedure Parameters</p>
<table class="cellalignment4330" title="ENABLE_POLICY Procedure Parameters" summary="This table lists and describes the ENABLE_POLICY procedure parameters." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t8">Parameter</th>
<th class="cellalignment4328" id="r1c2-t8">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t8" headers="r1c1-t8">
<p><code dir="ltr">object_schema</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t8 r1c2-t8">
<p>Schema of the object to be audited. If <code dir="ltr">NULL</code>, the current log-on user schema is assumed.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t8" headers="r1c1-t8">
<p><code dir="ltr">object_name</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t8 r1c2-t8">
<p>Name of the object to be audited</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t8" headers="r1c1-t8">
<p><code dir="ltr">policy_name</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t8 r1c2-t8">
<p>Unique name of the policy</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t8" headers="r1c1-t8">
<p><code dir="ltr">enable</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t8 r1c2-t8">
<p>Defaults to <code dir="ltr">TRUE</code> to enable the policy</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4269"></a>Examples</p>
<pre dir="ltr">DBMS_FGA.ENABLE_POLICY (
object_schema    =&gt;  &#39;scott&#39;,
object_name      =&gt;  &#39;emp&#39;,
policy_name      =&gt;  &#39;mypolicy1&#39;,
enable           =&gt;   TRUE);
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" --></div>
<!-- class="refentry" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment4320">
<tr>
<td class="cellalignment4329">
<table class="cellalignment4325">
<tr>
<td class="cellalignment4324"><a href="d_errlog.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment4324"><a href="d_filgrp.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment4332">
<table class="cellalignment4323">
<tr>
<td class="cellalignment4324"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment4324"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment4324"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment4324"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment4324"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment4324"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>