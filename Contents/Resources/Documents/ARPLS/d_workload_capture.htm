<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-2378"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/DBMS_WORKLOAD_CAPTURE"></a><title>DBMS_WORKLOAD_CAPTURE</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1086"/>
<meta name="dcterms.created" content="2016-09-02T5:36:54Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database PL/SQL Packages and Types Reference"/>
<meta name="dcterms.identifier" content="E41829-07"/>
<meta name="dcterms.isVersionOf" content="ARPLS"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="d_wm.htm" title="Previous" type="text/html"/>
<link rel="Next" href="d_workload_replay.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41829-07.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">181/290</span> <!-- End Header -->
<div id="ARPLS207" class="chapter"><a id="CHDHFBJE"></a>
<h1 class="chapter"><span class="secnum">177</span> DBMS_WORKLOAD_CAPTURE</h1>
<p>The <a id="sthref12411"></a><code dir="ltr">DBMS_WORKLOAD_CAPTURE</code> package configures the Workload Capture system and produce the workload capture data. Replay of this capture is implemented by way of the <a href="d_workload_replay.htm#CHDHHIDH">DBMS_WORKLOAD_REPLAY</a> package.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink RATUG" href="../RATUG/toc.htm"><span class="italic">Oracle Database Testing Guide</span></a> for more information about Database Replay</div>
<p>This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#CHDEDGGH">Using DBMS_WORKLOAD_CAPTURE</a></p>
<ul>
<li>
<p>Overview</p>
</li>
<li>
<p>Security Model<a href="#CHDJHAHE">Summary of DBMS_WORKLOAD_CAPTURE Subprograms</a></p>
</li>
</ul>
</li>
</ul>
<div class="refentry"><a id="CHDEDGGH"></a>
<div id="ARPLS69041" class="refsect1"><!-- infolevel="all" infotype="General" -->
<h2 class="refsect1">Using DBMS_WORKLOAD_CAPTURE</h2>
<ul>
<li>
<p><a href="#CACJGGCG">Overview</a></p>
</li>
<li>
<p><a href="#CFHGGCFG">Security Model</a></p>
</li>
</ul>
<div id="ARPLS69042" class="refsect2"><a id="CACJGGCG"></a>
<h3 class="refsect2">Overview</h3>
<p>Since the capture infrastructure is instance wide (and also within an Oracle Real Application Clusters (Oracle RAC)), only one workload capture is being produced at any point in time. Thus capture interfaces do not need a state object passed in as a parameter since there is one single state at any point in time. This means that all subprograms cannot be methods of an object but are package wide PL/SQL subprograms.</p>
</div>
<!-- class="refsect2" -->
<div id="ARPLS69043" class="refsect2"><a id="CFHGGCFG"></a>
<h3 class="refsect2">Security Model</h3>
<p>The following code describes the minimal set of privileges required to:</p>
<ul>
<li>
<p>Create directory objects</p>
</li>
<li>
<p>Operate the interface provided by the <code dir="ltr">DBMS_WORKLOAD_CAPTURE</code> and <code dir="ltr">DBMS_WORKLOAD_REPLAY</code> packages</p>
</li>
<li>
<p>Act as a replay client user (wrc <code dir="ltr">someuser</code>/<code dir="ltr">somepassword</code> or wrc <code dir="ltr">USER=someuser</code> <code dir="ltr">PASSWORD=somepassword</code>)</p>
</li>
</ul>
<pre dir="ltr">DROP USER rom1 CASCADE;
CREATE USER rom1 IDENTIFIED BY rom1;
 
GRANT EXECUTE ON DBMS_WORKLOAD_CAPTURE TO rom1;
GRANT EXECUTE ON DBMS_WORKLOAD_REPLAY TO rom1;
 
GRANT CREATE SESSION TO rom1;
GRANT CREATE ANY DIRECTORY TO rom1;
GRANT SELECT_CATALOG_ROLE TO rom1;
GRANT BECOME USER TO rom1;
</pre>
<p>Appropriate OS permissions are required to access and manipulate files and directories on both the capture and replay system. This means that the Oracle process(es) and the OS user performing the capture or replay must be able to access and manipulate at least one common directory accessible from the host where the instance is running. Additionally, the OS user performing the replay should be able to execute wrc on hosts that are used for the replay clients and be able to access the file system appropriately to copy the capture to the replay clients&#39; hosts if required.</p>
</div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" --></div>
<!-- class="refentry" -->
<div class="refentry"><a id="CHDJHAHE"></a>
<div id="ARPLS69044" class="refsect1"><!-- infolevel="all" infotype="General" -->
<h2 class="refsect1">Summary of DBMS_WORKLOAD_CAPTURE Subprograms</h2>
<p>This table list the package subprograms in alphabetical order.</p>
<div id="ARPLS69045" class="tblformal">
<p class="titleintable"><a id="sthref12412"></a><a id="sthref12413"></a>Table 177-1 DBMS_WORKLOAD_CAPTURE Package Subprograms</p>
<table class="cellalignment4330" title="DBMS_WORKLOAD_CAPTURE Package Subprograms" summary="This table lists the DBMS_WORKLOAD_CAPTURE subprograms in alphabetical order and briefly describes them." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t3">Subprogram</th>
<th class="cellalignment4328" id="r1c2-t3">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t3" headers="r1c1-t3">
<p><a href="#CFHFAAFB">ADD_FILTER Procedures</a></p>
</td>
<td class="cellalignment4329" headers="r2c1-t3 r1c2-t3">
<p>Adds a specified filter</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t3" headers="r1c1-t3">
<p><a href="#CFHJFFJH">DELETE_CAPTURE_INFO Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r3c1-t3 r1c2-t3">
<p>Deletes the rows in the <code dir="ltr">DBA_WORKLOAD_CAPTURES</code> and <code dir="ltr">DBA_WORKLOAD_FILTERS</code> views that corresponds to the given workload capture ID</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t3" headers="r1c1-t3">
<p><a href="#CHDEJDGC">DELETE_FILTER Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r4c1-t3 r1c2-t3">
<p>Deletes a specified filter</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t3" headers="r1c1-t3">
<p><a href="#CFHBICJI">EXPORT_AWR Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r5c1-t3 r1c2-t3">
<p>Exports the AWR snapshots associated with a given capture ID</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r6c1-t3" headers="r1c1-t3">
<p><a href="#CHDBCGBA">FINISH_CAPTURE Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r6c1-t3 r1c2-t3">
<p>Finalizes the workload capture by signaling all connected sessions to stop capture, and stops future requests to the database from being captured</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r7c1-t3" headers="r1c1-t3">
<p><a href="#CFHEGGDF">GET_CAPTURE_INFO Function</a></p>
</td>
<td class="cellalignment4329" headers="r7c1-t3 r1c2-t3">
<p>Retrieves all the information regarding a workload capture present in the stipulated directory, imports the information into the <code dir="ltr">DBA_WORKLOAD_CAPTURES</code> and <code dir="ltr">DBA_WORKLOAD_FILTERS</code> views, and returns the appropriate <code dir="ltr">DBA_WORKLOAD_CAPTURES</code>.<code dir="ltr">ID</code></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r8c1-t3" headers="r1c1-t3">
<p><a href="#CFHGHFHG">IMPORT_AWR Function</a></p>
</td>
<td class="cellalignment4329" headers="r8c1-t3 r1c2-t3">
<p>Imports the AWR snapshots associated with a given capture ID</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r9c1-t3" headers="r1c1-t3">
<p><a href="#CHDIIDCC">REPORT Function</a></p>
</td>
<td class="cellalignment4329" headers="r9c1-t3 r1c2-t3">
<p>Returns a report on the workload capture under consideration using one or more different sources</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r10c1-t3" headers="r1c1-t3">
<p><a href="#CHDJIJIE">START_CAPTURE Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r10c1-t3 r1c2-t3">
<p>Initiates workload capture on all instances</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<div id="ARPLS69046" class="refsect2"><a id="CFHFAAFB"></a>
<h3 class="refsect2"><a id="sthref12414"></a>ADD_FILTER Procedures</h3>
<p>This procedure adds a filter to capture a subset of the workload.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12415"></a>Syntax</p>
<pre dir="ltr">DBMS_WORKLOAD_CAPTURE.ADD_FILTER (
   fname           IN   VARCHAR2 NOT NULL, 
   fattribute      IN   VARCHAR2 NOT NULL, 
   fvalue          IN   VARCHAR2 NOT NULL);
</pre>
<pre dir="ltr">DBMS_WORKLOAD_CAPTURE.ADD_FILTER (
   fname           IN   VARCHAR2 NOT NULL, 
   fattribute      IN   VARCHAR2 NOT NULL, 
   fvalue          IN   NUMBER NOT NULL);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12416"></a>Parameters</p>
<div id="ARPLS69047" class="tblformal">
<p class="titleintable"><a id="sthref12417"></a><a id="sthref12418"></a>Table 177-2 ADD_FILTER Procedure Parameters</p>
<table class="cellalignment4330" title="ADD_FILTER Procedure Parameters" summary="This table describes the parameters of DBMS_WORKLOAD_CAPTURE.ADD_FILTER." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t4">Parameter</th>
<th class="cellalignment4328" id="r1c2-t4">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t4" headers="r1c1-t4">
<p><code dir="ltr">fname</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t4 r1c2-t4">
<p>Name for the filter to be added. Can be used to delete the filter later if it is not required. (Mandatory)</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t4" headers="r1c1-t4">
<p><code dir="ltr">fattribute</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t4 r1c2-t4">
<p>Specifies the attribute on which the filter needs to be applied (Mandatory). The possible values are:</p>
<ul>
<li>
<p><code dir="ltr">INSTANCE_NUMBER</code> - type <code dir="ltr">NUMBER</code></p>
</li>
<li>
<p><code dir="ltr">USER</code> - type <code dir="ltr">STRING</code></p>
</li>
<li>
<p><code dir="ltr">MODULE</code> - type <code dir="ltr">STRING</code></p>
</li>
<li>
<p><code dir="ltr">ACTION</code> - type <code dir="ltr">STRING</code></p>
</li>
<li>
<p><code dir="ltr">PROGRAM</code> - type <code dir="ltr">STRING</code></p>
</li>
<li>
<p><code dir="ltr">SERVICE</code> - type <code dir="ltr">STRING</code></p>
</li>
<li>
<p><code dir="ltr">PDB_NAME</code> - type <code dir="ltr">STRING</code></p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t4" headers="r1c1-t4">
<p><code dir="ltr">fvalue</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t4 r1c2-t4">
<p>Specifies the value to which the given attribute should be equal to for the filter to be considered active. Wildcards like &#39;%&#39; are acceptable for all attributes that are of type <code dir="ltr">STRING</code>. This means that the filter for a <code dir="ltr">NUMBER</code> attribute is parsed as &#34;attribute = value&#34;, with the filter for a <code dir="ltr">STRING</code> attribute parsed as &#34;attribute like value&#34; (Mandatory).</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12419"></a>Usage Notes</p>
<ul>
<li>
<p>The workload capture filters work in either the <code dir="ltr">DEFAULT</code> <code dir="ltr">INCLUSION</code> or the <code dir="ltr">DEFAULT</code> <code dir="ltr">EXCLUSION</code> mode as determined by the <code dir="ltr">default_action</code> input to the <a href="#CHDJIJIE">START_CAPTURE Procedure</a>.</p>
</li>
<li>
<p><code dir="ltr">ADD_FILTER</code> adds a new filter that affects the next workload capture, and whether the filters are considered as <code dir="ltr">INCLUSION</code> filters or <code dir="ltr">EXCLUSION</code> filters depends on the value of the default_action input to <a href="#CHDJIJIE">START_CAPTURE Procedure</a>.</p>
</li>
<li>
<p>Filters once specified are valid only for the next workload capture. If the same set of filters need to be used for subsequent capture, they need to be specified each time before the <a href="#CHDJIJIE">START_CAPTURE Procedure</a> is executed.</p>
</li>
<li>
<p>All the filters are listed in the <code dir="ltr">DBA_WORKLOAD_FILTERS</code> view.</p>
</li>
<li>
<p>You can capture the workload for a particular PDB by specifying a filter of PDB type.</p>
</li>
</ul>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12420"></a>Examples</p>
<ul>
<li>
<p>By default, a capture works in an <code dir="ltr">INCLUSION</code> mode, which records everything except for those requests that satisfy conditions of specified filters. For example, if you want to exclude all requests from <code dir="ltr">SCOTT</code>, you can add the following filter before starting a capture.</p>
<pre dir="ltr">EXEC DBMS_WORKLOAD_CAPTURE.ADD_FILTER (&#39;filter user1&#39;, &#39;USER&#39;, &#39;SCOTT&#39;);
</pre></li>
<li>
<p>Multiple filters are evaluated according to the logical disjunction operator <code dir="ltr">OR</code>. Therefore, if you want to record workload for both <code dir="ltr">SCOTT</code> and <code dir="ltr">JOHN</code>, you add an additional filter:</p>
<pre dir="ltr">EXEC DBMS_WORKLOAD_CAPTURE.ADD_FILTER (&#39;filter user2&#39;, &#39;USER&#39;, &#39;JOHN&#39;);
</pre></li>
<li>
<p>In a CDB, you exclude the workload of a particular PDB by the filter:</p>
<pre dir="ltr">EXEC DBMS_WORKLOAD_CAPTURE.ADD_FILTER (&#39;filter pdb workload&#39;, &#39;PDB_NAME&#39;, &#39;CDB1_PDB1&#39;);
</pre></li>
<li>
<p>To use <a href="d_appinf.htm#CHECEIEB">DBMS_APPLICATION_INFO</a> to identify workload that is issued to the database:</p>
<pre dir="ltr">DBMS_APPLICATION_INFO.SET_MODULE(&#39;ORDER_ENTRY&#39;, NULL);
-- run some SQL here
DBMS_APPLICATION_INFO.SET_ACTION(&#39;ORDER_ENTRY_LOG&#39;);
-- run logging SQL
</pre></li>
<li>
<p>If having captured workload, you want to exclude the logging SQL from the captured, specify a filter for capture:</p>
<pre dir="ltr">DBMS_WORKLOAD_CAPTURE.ADD_FILTER(&#39;filter logging operations&#39;, &#39;ACTION&#39;, &#39;ORDER_ENTRY_LOG&#39;);
</pre></li>
<li>
<p>To filter out the full order entry transaction, define a filter:</p>
<pre dir="ltr">DBMS_WORKLOAD_CAPTURE.ADD_FILTER(&#39;filter order entry&#39;, &#39;MODULE&#39;, &#39;ORDER_ENTRY&#39;);
</pre></li>
</ul>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS69048" class="refsect2"><a id="CFHJFFJH"></a>
<h3 class="refsect2"><a id="sthref12421"></a>DELETE_CAPTURE_INFO Procedure</h3>
<p>This procedure deletes the rows in the <code dir="ltr">DBA_WORKLOAD_CAPTURES</code> and <code dir="ltr">DBA_WORKLOAD_FILTERS</code> views that corresponds to the given workload capture ID.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12422"></a>Syntax</p>
<pre dir="ltr">DBMS_WORKLOAD_CAPTURE.DELETE_CAPTURE_INFO
   capture_id     IN   NUMBER);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12423"></a>Parameters</p>
<div id="ARPLS69049" class="tblformal">
<p class="titleintable"><a id="sthref12424"></a><a id="sthref12425"></a>Table 177-3 DELETE_CAPTURE_INFO Procedure Parameters</p>
<table class="cellalignment4330" title="DELETE_CAPTURE_INFO Procedure Parameters" summary="This table describes the parameters of DBMS_WORKLOAD_CAPTURE.DELETE_CAPTURE_INFO." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t5">Parameter</th>
<th class="cellalignment4328" id="r1c2-t5">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t5" headers="r1c1-t5">
<p><code dir="ltr">capture_id</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t5 r1c2-t5">
<p>ID of the workload capture that needs to be deleted. Corresponds to <code dir="ltr">DBA_WORKLOAD_CAPTURES</code>.<code dir="ltr">ID</code>. (Mandatory)</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12426"></a>Usage Notes</p>
<p>Passing the ID of a capture that is in progress will first automatically stop that capture.</p>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS69050" class="refsect2"><a id="CHDEJDGC"></a>
<h3 class="refsect2"><a id="sthref12427"></a>DELETE_FILTER Procedure</h3>
<p>This procedure deletes a specified filter.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12428"></a>Syntax</p>
<pre dir="ltr">DBMS_WORKLOAD_CAPTURE.DELETE_FILTER (
   filter_name           IN   VARCHAR2(40) NOT NULL);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12429"></a>Parameters</p>
<div id="ARPLS69051" class="tblformal">
<p class="titleintable"><a id="sthref12430"></a><a id="sthref12431"></a>Table 177-4 DELETE_FILTER Procedure Parameters</p>
<table class="cellalignment4330" title="DELETE_FILTER Procedure Parameters" summary="This table describes the parameters of DBMS_WORKLOAD_CAPTURE.DELETE_FILTER." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t6">Parameter</th>
<th class="cellalignment4328" id="r1c2-t6">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t6" headers="r1c1-t6">
<p><code dir="ltr">filter_name</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t6 r1c2-t6">
<p>Filter to be deleted</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12432"></a>Usage Notes</p>
<p>The <code dir="ltr">DELETE_FILTER</code> Procedure only affects filters that have not been used by any previous capture. Consequently, filters can be deleted only if they have been added using the <a href="#CFHFAAFB">ADD_FILTER Procedures</a> after any capture has been completed. Filters that have been added using <code dir="ltr">ADD_FILTER</code> before a <code dir="ltr">START_CAPTURE</code> and <code dir="ltr">FINISH_CAPTURE</code> cannot be deleted <code dir="ltr">anymore</code> using this subprogram.</p>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS69052" class="refsect2"><a id="CFHBICJI"></a>
<h3 class="refsect2"><a id="sthref12433"></a>EXPORT_AWR Procedure</h3>
<p>This procedure exports the AWR snapshots associated with a given capture ID.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12434"></a>Syntax</p>
<pre dir="ltr">DBMS_WORKLOAD_CAPTURE.EXPORT_AWR (
   capture_id     IN NUMBER);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12435"></a>Parameters</p>
<div id="ARPLS69053" class="tblformal">
<p class="titleintable"><a id="sthref12436"></a><a id="sthref12437"></a>Table 177-5 EXPORT_AWR Procedure Parameters</p>
<table class="cellalignment4330" title="EXPORT_AWR Procedure Parameters" summary="This table describes the parameters of DBMS_WORKLOAD_CAPTURE.EXPORT_AWR." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t7">Parameter</th>
<th class="cellalignment4328" id="r1c2-t7">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t7" headers="r1c1-t7">
<p><code dir="ltr">capture_id</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t7 r1c2-t7">
<p>ID of the capture whose AWR snapshots are to be exported. (Mandatory)</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12438"></a>Usage Notes</p>
<p>This procedure works only if the corresponding workload capture was performed in the current database (meaning that the corresponding row in <code dir="ltr">DBA_WORKLOAD_CAPTURES</code> was not created by calling the <a href="#CFHEGGDF">GET_CAPTURE_INFO Function</a>) and the AWR snapshots that correspond to the original capture time period are still available.</p>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS69054" class="refsect2"><a id="CHDBCGBA"></a>
<h3 class="refsect2"><a id="sthref12439"></a>FINISH_CAPTURE Procedure</h3>
<p>This procedure signals all connected sessions to stop the workload capture and stops future requests to the database from being captured.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12440"></a>Syntax</p>
<pre dir="ltr">DBMS_WORKLOAD_CAPTURE.FINISH_CAPTURE
   timeout     IN   NUMBER  DEFAULT 30
   reason       IN   VARCHAR2 DEFAULT NULL);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12441"></a>Parameters</p>
<div id="ARPLS69055" class="tblformal">
<p class="titleintable"><a id="sthref12442"></a><a id="sthref12443"></a>Table 177-6 FINISH_CAPTURE Procedure Parameters</p>
<table class="cellalignment4330" title="FINISH_CAPTURE Procedure Parameters" summary="This table describes the parameters of DBMS_WORKLOAD_CAPTURE.FINISH_CAPTURE." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t8">Parameter</th>
<th class="cellalignment4328" id="r1c2-t8">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t8" headers="r1c1-t8">
<p><code dir="ltr">timeout</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t8 r1c2-t8">
<p>Specifies in seconds for how long the procedure should wait before it times out. Pass 0 if you want to cancel the current workload capture and not wait for any sessions to flush it&#39;s capture buffers. Default value: 30 seconds</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t8" headers="r1c1-t8">
<p><code dir="ltr">reason</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t8 r1c2-t8">
<p>Specifies a reason for calling the procedure. The reason appears in the column <code dir="ltr">ERROR_MESSAGE</code> of the view <code dir="ltr">DBA_WORKLOAD_CAPTURES</code>.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12444"></a>Usage Notes</p>
<ul>
<li>
<p>By default, <code dir="ltr">FINISH_CAPTURE</code> waits for 30 seconds to receive a successful acknowledgement from all sessions in the database cluster before timing out.</p>
</li>
<li>
<p>All sessions that either were in the middle of executing a user request or received a new user request, while <code dir="ltr">FINISH_CAPTURE</code> was waiting for acknowledgements, flush their buffers and send back their acknowledgement to <code dir="ltr">FINISH_CAPTURE</code>.</p>
</li>
<li>
<p>If a database session remains idle (waiting for the next user request) throughout the duration of <code dir="ltr">FINISH_CAPTURE</code>, the session might have unflushed capture buffers and does not send it&#39;s acknowledgement to <code dir="ltr">FINISH_CAPTURE</code>.</p>
<p>To avoid this, do not have sessions that remain idle (waiting for the next user request) while invoking <code dir="ltr">FINISH_CAPTURE</code>. Either close the database session(s) before running <code dir="ltr">FINISH_CAPTURE</code> or send new database requests to those sessions during <code dir="ltr">FINISH_CAPTURE</code>.</p>
</li>
</ul>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS69056" class="refsect2"><a id="CFHEGGDF"></a>
<h3 class="refsect2"><a id="sthref12445"></a>GET_CAPTURE_INFO Function</h3>
<p>This procedure retrieves all information regarding a workload capture present in the stipulated directory, imports the information into the <code dir="ltr">DBA_WORKLOAD_CAPTURES</code> and <code dir="ltr">DBA_WORKLOAD_FILTERS</code> views, and returns the appropriate <code dir="ltr">DBA_WORKLOAD_CAPTURES</code>.<code dir="ltr">ID</code></p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12446"></a>Syntax</p>
<pre dir="ltr">DBMS_WORKLOAD_CAPTURE.GET_CAPTURE_INFO
   dir     IN   VARCHAR2)
  RETURN NUMBER;
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12447"></a>Parameters</p>
<div id="ARPLS69057" class="tblformal">
<p class="titleintable"><a id="sthref12448"></a><a id="sthref12449"></a>Table 177-7 GET_CAPTURE_INFO Function Parameters</p>
<table class="cellalignment4330" title="GET_CAPTURE_INFO Function Parameters" summary="This table describes the parameters of DBMS_WORKLOAD_CAPTURE.GET_CAPTURE_INFO." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t9">Parameter</th>
<th class="cellalignment4328" id="r1c2-t9">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t9" headers="r1c1-t9">
<p><code dir="ltr">dir</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t9 r1c2-t9">
<p>Name of the <code dir="ltr">DIRECTORY</code> object (case sensitive) where all the workload capture files are located (Mandatory)</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12450"></a>Usage Notes</p>
<p>If an appropriate row describing the capture in the stipulated directory already exists in <code dir="ltr">DBA_WORKLOAD_CAPTURES</code>, the <a href="#CFHEGGDF">GET_CAPTURE_INFO Function</a> simply returns that row&#39;s <code dir="ltr">DBA_WORKLOAD_CAPTURES</code>.<code dir="ltr">ID</code>. If no existing row matches the capture present in the stipulated directory a new row is inserted to <code dir="ltr">DBA_WORKLOAD_CAPTURES</code> and that row&#39;s <code dir="ltr">ID</code> is returned.</p>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS69058" class="refsect2"><a id="CFHGHFHG"></a>
<h3 class="refsect2"><a id="sthref12451"></a>IMPORT_AWR Function</h3>
<p>This procedure imports the AWR snapshots associated with a given capture ID provided those AWR snapshots were exported earlier from the original capture system using the <a href="#CFHBICJI">EXPORT_AWR Procedure</a>.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12452"></a>Syntax</p>
<pre dir="ltr">DBMS_WORKLOAD_CAPTURE.IMPORT_AWR (
   capture_id       IN   NUMBER,
   staging_schema   IN   VARCHAR2,
   force_cleanup    IN   BOOLEAN DEFAULT FALSE)
 RETURN NUMBER;
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12453"></a>Parameters</p>
<div id="ARPLS69059" class="tblformal">
<p class="titleintable"><a id="sthref12454"></a><a id="sthref12455"></a>Table 177-8 IMPORT_AWR Function Parameters</p>
<table class="cellalignment4330" title="IMPORT_AWR Function Parameters" summary="This table describes the parameters of DBMS_WORKLOAD_CAPTURE.IMPORT_AWR." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t10">Parameter</th>
<th class="cellalignment4328" id="r1c2-t10">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t10" headers="r1c1-t10">
<p><code dir="ltr">capture_id</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t10 r1c2-t10">
<p>ID of the capture whose AWR snapshots should be imported. (Mandatory)</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t10" headers="r1c1-t10">
<p><code dir="ltr">staging_schema</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t10 r1c2-t10">
<p>Name of a valid schema in the current database which can be used as a staging area while importing the AWR snapshots from the capture directory to the <code dir="ltr">SYS</code> <code dir="ltr">AWR</code> schema.The <code dir="ltr">SYS</code> schema is not a valid input. (Mandatory, Case sensitive).</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t10" headers="r1c1-t10">
<p><code dir="ltr">force_cleanup</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t10 r1c2-t10">
<p>Values:</p>
<ul>
<li>
<p><code dir="ltr">TRUE</code> - any AWR data present in the given <code dir="ltr">staging_schema</code> are removed before the actual import operation. All tables with names that match any of the tables in AWR are dropped before the actual import. This typically is equivalent to dropping all tables returned by the following SQL:</p>
<pre dir="ltr">SELECT table_name FROM dba_tables
WHERE owner = staging_schema
AND table_name like &#39;WR_$%&#39;;
</pre>
<p>Use this option only if you are sure that there are no important data in any such tables in the <code dir="ltr">staging_schema</code>.</p>
</li>
<li>
<p><code dir="ltr">FALSE</code> - (default) no tables dropped from the <code dir="ltr">staging_schema</code> prior to the import operation</p>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12456"></a>Return Values</p>
<p>Returns the new randomly generated database ID that was used to import the AWR snapshots. The same value can be found in the <code dir="ltr">AWR_DBID</code> column in the <code dir="ltr">DBA_WORKLOAD_CAPTURES</code> view.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12457"></a>Usage Notes</p>
<p><code dir="ltr">IMPORT_AWR</code> fails if the <code dir="ltr">staging_schema</code> provided as input contains any tables with the same name as any of the AWR tables, such as <code dir="ltr">WRM$_SNAPSHOT</code> or <code dir="ltr">WRH$_PARAMETER</code>. Please drop any such tables in the <code dir="ltr">staging_schema</code> before invoking <code dir="ltr">IMPORT_AWR</code>.</p>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS69062" class="refsect2"><a id="CHDIIDCC"></a>
<h3 class="refsect2"><a id="sthref12458"></a>REPORT Function</h3>
<p>This function generates a report on the stipulated workload capture.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12459"></a>Syntax</p>
<pre dir="ltr">DBMS_WORKLOAD_CAPTURE.REPORT (
   capture_id      IN   NUMBER,
   format          IN   VARCHAR2)
 RETURN CLOB;
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12460"></a>Parameters</p>
<div id="ARPLS69063" class="tblformal">
<p class="titleintable"><a id="sthref12461"></a><a id="sthref12462"></a>Table 177-9 REPORT Function Parameters</p>
<table class="cellalignment4330" title="REPORT Function Parameters" summary="This table describes the parameters of DBMS_WORKLOAD_CAPTURE.REPORT." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t11">Parameter</th>
<th class="cellalignment4328" id="r1c2-t11">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t11" headers="r1c1-t11">
<p><code dir="ltr">capture_id</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t11 r1c2-t11">
<p>ID of the workload capture whose capture report is required. (Mandatory)</p>
<p>This relates to the directory that contains the workload capture on which the Report needs to be generated. Should be a valid <code dir="ltr">DIRECTORY</code> object that points to a valid directory in the host system that contains a workload capture.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t11" headers="r1c1-t11">
<p><code dir="ltr">format</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t11 r1c2-t11">
<p>Specifies the report format. Valid values are <code dir="ltr">DBMS_WORKLOAD_CAPTURE</code>.<code dir="ltr">TYPE_TEXT</code> and <code dir="ltr">DBMS_WORKLOAD_CAPTURE</code>.<code dir="ltr">TYPE_HTML</code>.(Mandatory)</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12463"></a>Return Values</p>
<p>The report body in the desired format returned as a <code dir="ltr">CLOB</code>.</p>
<div id="ARPLS69064" class="tblformal">
<p class="titleintable"><a id="sthref12464"></a><a id="sthref12465"></a>Table 177-10 Constants Used by Report Function</p>
<table class="cellalignment4330" title="Constants Used by Report Function" summary="Constants used by Report Function" dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t12">Constant</th>
<th class="cellalignment4328" id="r1c2-t12">Type</th>
<th class="cellalignment4328" id="r1c3-t12">Value</th>
<th class="cellalignment4328" id="r1c4-t12">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t12" headers="r1c1-t12">
<p><code dir="ltr">TYPE_HTML</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t12 r1c2-t12">
<p><code dir="ltr">VARCHAR2(4)</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t12 r1c3-t12">
<p>&#39;HTML&#39;</p>
</td>
<td class="cellalignment4329" headers="r2c1-t12 r1c4-t12">
<p>Generates the HTML version of the report</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t12" headers="r1c1-t12">
<p><code dir="ltr">TYPE_TEXT</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t12 r1c2-t12">
<p><code dir="ltr">VARCHAR2(4)</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t12 r1c3-t12">
<p>&#39;TEXT&#39;</p>
</td>
<td class="cellalignment4329" headers="r3c1-t12 r1c4-t12">
<p>Used as input to the <code dir="ltr">format</code> argument to generate the text version of the report</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS69065" class="refsect2"><a id="CHDJIJIE"></a>
<h3 class="refsect2"><a id="sthref12466"></a>START_CAPTURE Procedure</h3>
<p>This procedure initiates workload capture on all instances.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12467"></a>Syntax</p>
<pre dir="ltr">DBMS_WORKLOAD_CAPTURE.START_CAPTURE (
   name              IN  VARCHAR2,
   dir               IN  VARCHAR2,
   duration          IN  NUMBER   DEFAULT NULL,
   default_action    IN  VARCHAR2 DEFAULT &#39;INCLUDE&#39;,
   auto_unrestrict   IN  BOOLEAN  DEFAULT TRUE,
   capture_sts       IN  BOOLEAN  DEFAULT FALSE,
   sts_cap_interval  IN  NUMBER   DEFAULT 300);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12468"></a>Parameters</p>
<div id="ARPLS69066" class="tblformal">
<p class="titleintable"><a id="sthref12469"></a><a id="sthref12470"></a>Table 177-11 START_CAPTURE Procedure Parameters</p>
<table class="cellalignment4330" title="START_CAPTURE Procedure Parameters" summary="This table describes the parameters of DBMS_WORKLOAD_CAPTURE.START." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t13">Parameter</th>
<th class="cellalignment4328" id="r1c2-t13">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t13" headers="r1c1-t13">
<p><code dir="ltr">name</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t13 r1c2-t13">
<p>Name of the workload capture. Allows the workload capture to be given a label, such as &#34;Thanksgiving weekend&#34; or &#34;Christmas peak workload&#34; for future reference. The workload capture&#39;s name is preserved along with the captured workload actions. (Mandatory)</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t13" headers="r1c1-t13">
<p><code dir="ltr">dir</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t13 r1c2-t13">
<p>Name of the <code dir="ltr">DIRECTORY</code> object (case sensitive) where all the workload capture files are stored. Should contain enough space to hold all the workload capture files. (Mandatory)</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t13" headers="r1c1-t13">
<p><code dir="ltr">duration</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t13 r1c2-t13">
<p>Optional input to specify the duration (in seconds) for which the workload needs to be captured. <code dir="ltr">DEFAULT</code> is <code dir="ltr">NULL</code> which means that workload capture continues until the user executes <code dir="ltr">DBMS_WORKLOAD_CAPTURE</code>.<code dir="ltr">FINISH_CAPTURE</code>.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t13" headers="r1c1-t13">
<p><code dir="ltr">default_action</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t13 r1c2-t13">
<p>Can be either <code dir="ltr">INCLUDE</code> or <code dir="ltr">EXCLUDE</code>. Determines whether, by default, every user request should be captured or not. Also determines whether the workload filters specified should be considered as <code dir="ltr">INCLUSION</code> filters or <code dir="ltr">EXCLUSION</code> filters.</p>
<ul>
<li>
<p>If <code dir="ltr">INCLUDE</code>, by default all user requests to the database are captured, except for the part of the workload defined by the filters. In this case, all the filters specified using the <a href="#CFHFAAFB">ADD_FILTER Procedures</a> are treated as <code dir="ltr">EXCLUSION</code> filters, determining the workload that is not captured. (<code dir="ltr">DEFAULT</code>, and so all the filters specified are assumed to be <code dir="ltr">EXCLUSION</code> filters.)</p>
</li>
<li>
<p>If <code dir="ltr">EXCLUDE</code>, by default no user request to the database is captured, except for the part of the workload defined by the filters. In this case, all the filters specified using the <a href="#CFHFAAFB">ADD_FILTER Procedures</a> are treated as <code dir="ltr">INCLUSION</code> filters, determining the workload that is captured.</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r6c1-t13" headers="r1c1-t13">
<p><code dir="ltr">auto_unrestrict</code></p>
</td>
<td class="cellalignment4329" headers="r6c1-t13 r1c2-t13">
<p>Can be either <code dir="ltr">TRUE</code> or <code dir="ltr">FALSE</code>.</p>
<ul>
<li>
<p>If <code dir="ltr">TRUE</code>, all instances started up in <code dir="ltr">RESTRICTED</code> mode using <code dir="ltr">STARTUP</code> <code dir="ltr">RESTRICT</code> are automatically unrestricted upon a successful <code dir="ltr">START_CAPTURE</code>. (<code dir="ltr">DEFAULT</code>)</p>
</li>
<li>
<p>If <code dir="ltr">FALSE</code>, no database instance is automatically unrestricted.</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r7c1-t13" headers="r1c1-t13">
<p><code dir="ltr">capture_sts</code></p>
</td>
<td class="cellalignment4329" headers="r7c1-t13 r1c2-t13">
<p>If this parameter is <code dir="ltr">TRUE</code>, a SQL tuning set capture is also started in parallel with workload capture. The resulting SQL tuning set can be exported using the <a href="#CFHBICJI">EXPORT_AWR Procedure</a> along with the AWR data. Currently, parallel STS capture is not supported in an Oracle RAC environment, so this parameter has no effect if used in that context. Capture filters defined using the <code dir="ltr">DBMS_WORKLOAD_REPLAY</code> interface do not apply to the SQL tuning set capture. The calling user must have the appropriate privileges (&#39;<code dir="ltr">ADMINISTER SQL TUNING SET</code>&#39;).</p>
<p>If starting SQL set capture fails, workload capture is stopped. The reason is stored in <code dir="ltr">DBA_WORKLOAD_CAPTURES</code>.<code dir="ltr">ERROR_MESSAGE</code>. The default value is <code dir="ltr">FALSE</code>.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r8c1-t13" headers="r1c1-t13">
<p><code dir="ltr">sts_cap_interval</code></p>
</td>
<td class="cellalignment4329" headers="r8c1-t13 r1c2-t13">
<p>Specifies the capture interval of the SQL set capture from the cursor cache in seconds. The default value is 300.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref12471"></a>Usage Notes</p>
<ul>
<li>
<p>All user requests sent to database after a successful invocation of <code dir="ltr">START_CAPTURE</code> are recorded in the given <code dir="ltr">dir</code> directory for the given duration provided that one was specified. If no duration was specified, the capture lasts indefinitely until the <a href="#CHDBCGBA">FINISH_CAPTURE Procedure</a> is executed.</p>
</li>
<li>
<p>A workload capture once started continues to record user requests across database instance shutdowns and startups for the specified duration, or until <code dir="ltr">FINISH_CAPTURE</code> is executed, whichever occurs first.</p>
</li>
<li>
<p>One can use workload filters (as described with regard to the <a href="#CFHFAAFB">ADD_FILTER Procedures</a>) to capture only a subset of the user requests sent to the database. By default, when no workload filters are defined, all user requests are captured.</p>
</li>
<li>
<p>Workload that is initiated from Oracle Database background processes (such as <code dir="ltr">SMON</code>, <code dir="ltr">PMON</code>, <code dir="ltr">MMON</code>) and Oracle Database Scheduler Jobs (as detailed in the <a href="d_sched.htm#CIHHBGGI">DBMS_SCHEDULER</a> package) is not captured, no matter how the workload filters are defined. These activities should happen automatically on an appropriately configured replay system.</p>
</li>
<li>
<p>By default, all database instances that were started up in <code dir="ltr">RESTRICTED</code> mode using <code dir="ltr">STARTUP</code> <code dir="ltr">RESTRICT</code> are <code dir="ltr">UNRESTRICTED</code> upon a successful invocation of <code dir="ltr">START_CAPTURE</code> Use <code dir="ltr">FALSE</code> for the <code dir="ltr">auto_unrestrict</code> input parameter, if you do not want this behavior.</p>
</li>
<li>
<p>It is important to have a well-defined starting point for the workload so that the replay system can be restored to that point before initiating a replay of the captured workload. To have a well-defined starting point for the workload capture, it is preferable not to have any active user sessions when <code dir="ltr">START_CAPTURE</code> is executed. If ongoing sessions have ongoing transactions, those transactions are not replayed properly in subsequent database replays, since only that part of the transaction whose calls were executed after <code dir="ltr">START_CAPTURE</code> are replayed.</p>
</li>
</ul>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" --></div>
<!-- class="refentry" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment4320">
<tr>
<td class="cellalignment4329">
<table class="cellalignment4325">
<tr>
<td class="cellalignment4324"><a href="d_wm.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment4324"><a href="d_workload_replay.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment4332">
<table class="cellalignment4323">
<tr>
<td class="cellalignment4324"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment4324"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment4324"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment4324"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment4324"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment4324"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>