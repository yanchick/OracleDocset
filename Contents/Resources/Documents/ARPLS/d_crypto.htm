<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-2241"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/DBMS_CRYPTO"></a><title>DBMS_CRYPTO</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1086"/>
<meta name="dcterms.created" content="2016-09-02T5:36:10Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database PL/SQL Packages and Types Reference"/>
<meta name="dcterms.identifier" content="E41829-07"/>
<meta name="dcterms.isVersionOf" content="ARPLS"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="d_credential.htm" title="Previous" type="text/html"/>
<link rel="Next" href="d_csx_admin.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41829-07.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">44/290</span> <!-- End Header -->
<script>
<!-- // <![CDATA[
window.name='d_crypto'
// ]]> -->
</script> <script>
// <![CDATA[
function footdisplay(footnum,footnote) {
    var msg = window.open('', 'NewWindow' + footnum,
        'directories=no,height=120,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');

    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">');
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>');
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('');
    msg.document.write('<style> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]\u003e <\/style>');
    msg.document.write('<\/head><body><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/body><\/html>');
    msg.document.close();
    msg.focus();
}
// ]]>
</script> <noscript>
<p>The script content on this page is for navigation purposes only and does not alter the content in any way.</p>
</noscript>
<div id="ARPLS664" class="chapter"><a id="BJFGFDFG"></a> <a id="i1005082"></a>
<h1 class="chapter"><span class="secnum">40</span> DBMS_CRYPTO</h1>
<p><code>DBMS_CRYPTO</code> provides an interface to encrypt and decrypt stored data, and can be used in conjunction with PL/SQL programs running network communications. It provides support for several industry-standard encryption and hashing algorithms, including the Advanced Encryption Standard (AES) encryption algorithm. AES has been approved by the National Institute of Standards and Technology (NIST) to replace the Data Encryption Standard (DES).</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink DBSEG80084" href="../DBSEG/data_encryption.htm#DBSEG80084"><span class="italic">Oracle Database Security Guide</span></a> for further information about using this package and about encrypting data in general.</div>
<p>This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#BJFCGDIC">Using the DBMS_CRYPTO Subprograms</a></p>
<ul>
<li>
<p>Overview</p>
</li>
<li>
<p>Security Model</p>
</li>
<li>
<p>Types</p>
</li>
<li>
<p>Algorithms</p>
</li>
<li>
<p>Restrictions</p>
</li>
<li>
<p>Exceptions</p>
</li>
<li>
<p>Operational Notes</p>
</li>
</ul>
</li>
<li>
<p><a href="#i1001225">Summary of DBMS_CRYPTO Subprograms</a></p>
</li>
</ul>
<div class="refentry"><a id="BJFCGDIC"></a>
<div id="ARPLS65669" class="refsect1">
<h2 class="refsect1">Using the DBMS_CRYPTO Subprograms</h2>
<ul>
<li>
<p><a href="#i1004090">Overview</a></p>
</li>
<li>
<p><a href="#i1004143">Security Model</a></p>
</li>
<li>
<p><a href="#i1004144">Datatypes</a></p>
</li>
<li>
<p><a href="#i1004145">Algorithms</a></p>
</li>
<li>
<p><a href="#i1004146">Restrictions</a></p>
</li>
<li>
<p><a href="#i1004147">Exceptions</a></p>
</li>
<li>
<p><a href="#i1004148">Operational Notes</a></p>
</li>
</ul>
<div id="ARPLS65670" class="refsect2"><a id="i1004090"></a>
<h3 class="refsect2">Overview</h3>
<p><code dir="ltr">DBMS_CRYPTO</code> contains basic cryptographic functions and procedures. To use this package correctly and securely, a general level of security expertise is assumed.</p>
<p>The <code dir="ltr">DBMS_CRYPTO</code> package enables encryption and decryption for common Oracle datatypes, including <code dir="ltr">RAW</code> and large objects (<code dir="ltr">LOB</code>s), such as images and sound. Specifically, it supports <code dir="ltr">BLOB</code>s and <code dir="ltr">CLOB</code>s. In addition, it provides Globalization Support for encrypting data across different database character sets.</p>
<p>The following cryptographic algorithms are supported:</p>
<ul>
<li>
<p>Data Encryption Standard (DES), Triple DES (3DES, 2-key and 3-key)</p>
</li>
<li>
<p>Advanced Encryption Standard (AES)</p>
</li>
<li>
<p>MD5, MD4, SHA-1, and SHA-2 cryptographic hashes</p>
</li>
<li>
<p>MD5, SHA-1, and SHA-2 Message Authentication Code (MAC)</p>
</li>
</ul>
<p>Block cipher modifiers are also provided with <code dir="ltr">DBMS_CRYPTO</code>. You can choose from several padding options, including PKCS (Public Key Cryptographic Standard) #5, and from four block cipher chaining modes, including Cipher Block Chaining (CBC).</p>
<p><a href="#BJFFAJCC">Table 40-1</a> summarizes the <code dir="ltr">DBMS_CRYPTO</code> package features.</p>
<div id="ARPLS65671" class="tblformalwidemax">
<p class="titleintable"><a id="sthref1765"></a><a id="BJFFAJCC"></a>Table 40-1 DBMS_CRYPTO Features</p>
<table class="cellalignment4327" title="DBMS_CRYPTO Features" summary="This table lists the DBMS_CRYPTO package features." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t3">Package Feature</th>
<th class="cellalignment4328" id="r1c2-t3">DBMS_CRYPTO</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t3" headers="r1c1-t3">
<p>Cryptographic algorithms</p>
</td>
<td class="cellalignment4329" headers="r2c1-t3 r1c2-t3">
<p>DES, 3DES, AES, RC4, 3DES_2KEY</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t3" headers="r1c1-t3">
<p>Padding forms</p>
</td>
<td class="cellalignment4329" headers="r3c1-t3 r1c2-t3">
<p>PKCS5, zeroes</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t3" headers="r1c1-t3">
<p>Block cipher chaining modes</p>
</td>
<td class="cellalignment4329" headers="r4c1-t3 r1c2-t3">
<p>CBC, CFB, ECB, OFB</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t3" headers="r1c1-t3">
<p>Cryptographic hash algorithms</p>
</td>
<td class="cellalignment4329" headers="r5c1-t3 r1c2-t3">
<p>MD5, SHA-1, SHA-2 (SHA-256, SHA-384, SHA-512), MD4</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r6c1-t3" headers="r1c1-t3">
<p>Keyed hash (MAC) algorithms</p>
</td>
<td class="cellalignment4329" headers="r6c1-t3 r1c2-t3">
<p>HMAC_MD5, HMAC_SH1, HMAC_SH256, HMAC_SH384, HMAC_SH512</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r7c1-t3" headers="r1c1-t3">
<p>Cryptographic pseudo-random number generator</p>
</td>
<td class="cellalignment4329" headers="r7c1-t3 r1c2-t3">
<p><code dir="ltr">RAW</code>, <code dir="ltr">NUMBER</code>, <code dir="ltr">BINARY_INTEGER</code></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r8c1-t3" headers="r1c1-t3">
<p>Database types</p>
</td>
<td class="cellalignment4329" headers="r8c1-t3 r1c2-t3">
<p><code dir="ltr">RAW</code>, <code dir="ltr">CLOB</code>, <code dir="ltr">BLOB</code></p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformalwidemax" -->
<p>The <code dir="ltr">DBMS_CRYPTO</code> package replaces <code dir="ltr">DBMS_OBFUSCATION_TOOLKIT</code>, providing greater ease of use and support for a range of algorithms to accommodate new and existing systems. Specifically, <code dir="ltr">3DES_2KEY</code> and MD4 are provided for backward compatibility. It is not recommended that you use these algorithms because they do not provide the same level of security as provided by 3DES, AES, MD5, SHA-1, or SHA-2.</p>
</div>
<!-- class="refsect2" -->
<div id="ARPLS65672" class="refsect2"><a id="i1004143"></a>
<h3 class="refsect2">Security Model</h3>
<p>Oracle Database installs this package in the <code dir="ltr">SYS</code> schema. You can then grant package access to existing users and roles as needed.</p>
</div>
<!-- class="refsect2" -->
<div id="ARPLS65673" class="refsect2"><a id="i1004144"></a>
<h3 class="refsect2">Datatypes</h3>
<p>Parameters for the <code dir="ltr">DBMS_CRYPTO</code> subprograms use these datatypes:</p>
<div id="ARPLS65674" class="tblformal">
<p class="titleintable"><a id="sthref1766"></a><a id="sthref1767"></a>Table 40-2 DBMS_CRYPTO Datatypes</p>
<table class="cellalignment4330" title="DBMS_CRYPTO Datatypes" summary="This table describes DBMS_CRYPTO Datatypes." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t4">Type</th>
<th class="cellalignment4328" id="r1c2-t4">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t4" headers="r1c1-t4">
<p><code dir="ltr">BLOB</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t4 r1c2-t4">
<p>A source or destination binary LOB</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t4" headers="r1c1-t4">
<p><code dir="ltr">CLOB</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t4 r1c2-t4">
<p>A source or destination character LOB (excluding NCLOB)</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t4" headers="r1c1-t4">
<p><code dir="ltr">PLS_INTEGER</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t4 r1c2-t4">
<p>Specifies a cryptographic algorithm type (used with BLOB, CLOB, and RAW datatypes)</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t4" headers="r1c1-t4">
<p><code dir="ltr">RAW</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t4 r1c2-t4">
<p>A source or destination RAW buffer</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsect2" -->
<div id="ARPLS65675" class="refsect2"><a id="i1004145"></a>
<h3 class="refsect2">Algorithms</h3>
<p>The following cryptographic algorithms, modifiers, and cipher suites are predefined in this package.</p>
<div id="ARPLS65676" class="tblformal">
<p class="titleintable"><a id="sthref1768"></a><a id="BJFCHAFC"></a>Table 40-3 DBMS_CRYPTO Cryptographic Hash Functions</p>
<table class="cellalignment4330" title="DBMS_CRYPTO Cryptographic Hash Functions" summary="This table describes DBMS_CRYPTO Cryptographic Hash Functions." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t5">Name</th>
<th class="cellalignment4328" id="r1c2-t5">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t5" headers="r1c1-t5">
<p><code dir="ltr">HASH_MD4</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t5 r1c2-t5">
<p>Produces a 128-bit hash, or message digest of the input message</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t5" headers="r1c1-t5">
<p><code dir="ltr">HASH_MD5</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t5 r1c2-t5">
<p>Also produces a 128-bit hash, but is more complex than MD4</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t5" headers="r1c1-t5">
<p><code dir="ltr">HASH_SH1</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t5 r1c2-t5">
<p>Secure Hash Algorithm (SHA-1). Produces a 160-bit hash.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t5" headers="r1c1-t5">
<p><code dir="ltr">HASH_SH256</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t5 r1c2-t5">
<p>SHA-2, produces a 256-bit hash.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r6c1-t5" headers="r1c1-t5">
<p><code dir="ltr">HASH_SH384</code></p>
</td>
<td class="cellalignment4329" headers="r6c1-t5 r1c2-t5">
<p>SHA-2, produces a 384-bit hash.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r7c1-t5" headers="r1c1-t5">
<p><code dir="ltr">HASH_SH512</code></p>
</td>
<td class="cellalignment4329" headers="r7c1-t5 r1c2-t5">
<p>SHA-2, produces a 512-bit hash.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<div id="ARPLS65677" class="tblformal">
<p class="titleintable"><a id="sthref1769"></a><a id="BJFEIEFA"></a>Table 40-4 DBMS_CRYPTO MAC (Message Authentication Code) Functions</p>
<table class="cellalignment4330" title="DBMS_CRYPTO MAC (Message Authentication Code) Functions" summary="This table describes BMS_CRYPTO MAC (Message Authentication Code) functions." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t6">Name</th>
<th class="cellalignment4328" id="r1c2-t6">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t6" headers="r1c1-t6">
<p><code dir="ltr">HMAC_MD5</code><a id="BJFHFCCA" href="#BJFHFCCA" onclick="footdisplay(1,&#34;Complies with IETF RFC 2104 standard&#34;)"><sup class="tablefootnote">Foot&nbsp;1&nbsp;</sup></a></p>
</td>
<td class="cellalignment4329" headers="r2c1-t6 r1c2-t6">
<p>Same as MD5 hash function, except it requires a secret key to verify the hash value.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t6" headers="r1c1-t6">
<p><code dir="ltr">HMAC_SH1</code><a id="sthref1770" href="#sthref1770" onclick="footdisplay(1,&#34;Complies with IETF RFC 2104 standard&#34;)"><sup class="footnotenumber">Footref&nbsp;1</sup></a></p>
</td>
<td class="cellalignment4329" headers="r3c1-t6 r1c2-t6">
<p>Same as SHA hash function, except it requires a secret key to verify the hash value.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t6" headers="r1c1-t6">
<p><code dir="ltr">HMAC_SH256</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t6 r1c2-t6">
<p>Same as SHA-2 256-bit hash function, except it requires a secret key to verify the hash value.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t6" headers="r1c1-t6">
<p><code dir="ltr">HMAC_SH384</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t6 r1c2-t6">
<p>Same as SHA-2 384-bit hash function, except it requires a secret key to verify the hash value.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r6c1-t6" headers="r1c1-t6">
<p><code dir="ltr">HMAC_SH512</code></p>
</td>
<td class="cellalignment4329" headers="r6c1-t6 r1c2-t6">
<p>Same as SHA-2 512-bit hash function, except it requires a secret key to verify the hash value.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;1&nbsp;</sup>Complies with IETF RFC 2104 standard</p>
<div id="ARPLS65678" class="tblformal">
<p class="titleintable"><a id="sthref1771"></a><a id="CHDBJIEF"></a>Table 40-5 DBMS_CRYPTO Encryption Algorithms</p>
<table class="cellalignment4330" title="DBMS_CRYPTO Encryption Algorithms" summary="This table describes DBMS_CRYPTO Encryption algorithms." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t7">Name</th>
<th class="cellalignment4328" id="r1c2-t7">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t7" headers="r1c1-t7">
<p><code dir="ltr">ENCRYPT_DES</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t7 r1c2-t7">
<p>Data Encryption Standard. Block cipher. Uses key length of 56 bits.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t7" headers="r1c1-t7">
<p><code dir="ltr">ENCRYPT_3DES_2KEY</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t7 r1c2-t7">
<p>Data Encryption Standard. Block cipher. Operates on a block 3 times with 2 keys. Effective key length of 112 bits.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t7" headers="r1c1-t7">
<p><code dir="ltr">ENCRYPT_3DES</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t7 r1c2-t7">
<p>Data Encryption Standard. Block cipher. Operates on a block 3 times.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t7" headers="r1c1-t7">
<p><code dir="ltr">ENCRYPT_AES128</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t7 r1c2-t7">
<p>Advanced Encryption Standard. Block cipher. Uses 128-bit key size.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r6c1-t7" headers="r1c1-t7">
<p><code dir="ltr">ENCRYPT_AES192</code></p>
</td>
<td class="cellalignment4329" headers="r6c1-t7 r1c2-t7">
<p>Advanced Encryption Standard. Block cipher. Uses 192-bit key size.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r7c1-t7" headers="r1c1-t7">
<p><code dir="ltr">ENCRYPT_AES256</code></p>
</td>
<td class="cellalignment4329" headers="r7c1-t7 r1c2-t7">
<p>Advanced Encryption Standard. Block cipher. Uses 256-bit key size.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r8c1-t7" headers="r1c1-t7">
<p><code dir="ltr">ENCRYPT_RC4</code></p>
</td>
<td class="cellalignment4329" headers="r8c1-t7 r1c2-t7">
<p>Stream cipher. Uses a secret, randomly generated key unique to each session.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<div id="ARPLS65679" class="tblformal">
<p class="titleintable"><a id="sthref1772"></a><a id="BJFJEGDA"></a>Table 40-6 DBMS_CRYPTO Block Cipher Suites</p>
<table class="cellalignment4330" title="DBMS_CRYPTO Block Cipher Suites" summary="This table describes DBMS_CRYPTO Block Cipher Suites." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t8">Name</th>
<th class="cellalignment4328" id="r1c2-t8">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t8" headers="r1c1-t8">
<p><code dir="ltr">DES_CBC_PKCS5</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t8 r1c2-t8">
<p>ENCRYPT_DES<a id="BJFEGJJE" href="#BJFEGJJE" onclick="footdisplay(1,&#34;See \u003ca target=\&#34;d_crypto\&#34; href=\&#34;#CHDBJIEF\&#34;\u003eTable 40-5, \&#34;DBMS_CRYPTO Encryption Algorithms\&#34;\u003c/a\u003e&#34;)"><sup class="tablefootnote">Foot&nbsp;1&nbsp;</sup></a> + CHAIN_CBC<a id="BJFJAADE" href="#BJFJAADE" onclick="footdisplay(2,&#34;See \u003ca target=\&#34;d_crypto\&#34; href=\&#34;#BJFEAAHD\&#34;\u003eTable 40-7, \&#34;DBMS_CRYPTO Block Cipher Chaining Modifiers\&#34;\u003c/a\u003e&#34;)"><sup class="tablefootnote">Foot&nbsp;2&nbsp;</sup></a>+ PAD_PKCS5<a id="BJFBICJJ" href="#BJFBICJJ" onclick="footdisplay(3,&#34;See \u003ca target=\&#34;d_crypto\&#34; href=\&#34;#BJFEJIEH\&#34;\u003eTable 40-8, \&#34;DBMS_CRYPTO Block Cipher Padding Modifiers\&#34;\u003c/a\u003e&#34;)"><sup class="tablefootnote">Foot&nbsp;3&nbsp;</sup></a></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t8" headers="r1c1-t8">
<p><code dir="ltr">DES3_CBC_PKCS5</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t8 r1c2-t8">
<p><code dir="ltr">ENCRYPT_3DES</code><a id="sthref1773" href="#sthref1773" onclick="footdisplay(1,&#34;See \u003ca target=\&#34;d_crypto\&#34; href=\&#34;#CHDBJIEF\&#34;\u003eTable 40-5, \&#34;DBMS_CRYPTO Encryption Algorithms\&#34;\u003c/a\u003e&#34;)"><sup class="footnotenumber">Footref&nbsp;1</sup></a> + <code dir="ltr">CHAIN_CBC</code><a id="sthref1774" href="#sthref1774" onclick="footdisplay(2,&#34;See \u003ca target=\&#34;d_crypto\&#34; href=\&#34;#BJFEAAHD\&#34;\u003eTable 40-7, \&#34;DBMS_CRYPTO Block Cipher Chaining Modifiers\&#34;\u003c/a\u003e&#34;)"><sup class="footnotenumber">Footref&nbsp;2</sup></a> + PAD_PKCS5<a id="sthref1775" href="#sthref1775" onclick="footdisplay(3,&#34;See \u003ca target=\&#34;d_crypto\&#34; href=\&#34;#BJFEJIEH\&#34;\u003eTable 40-8, \&#34;DBMS_CRYPTO Block Cipher Padding Modifiers\&#34;\u003c/a\u003e&#34;)"><sup class="footnotenumber">Footref&nbsp;3</sup></a></p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;1&nbsp;</sup>See <a href="#CHDBJIEF">Table 40-5, &#34;DBMS_CRYPTO Encryption Algorithms&#34;</a></p>
<p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;2&nbsp;</sup>See <a href="#BJFEAAHD">Table 40-7, &#34;DBMS_CRYPTO Block Cipher Chaining Modifiers&#34;</a></p>
<p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;3&nbsp;</sup>See <a href="#BJFEJIEH">Table 40-8, &#34;DBMS_CRYPTO Block Cipher Padding Modifiers&#34;</a></p>
<div id="ARPLS65680" class="tblformal">
<p class="titleintable"><a id="sthref1776"></a><a id="BJFEAAHD"></a>Table 40-7 DBMS_CRYPTO Block Cipher Chaining Modifiers</p>
<table class="cellalignment4330" title="DBMS_CRYPTO Block Cipher Chaining Modifiers" summary="This table describes DBMS_CRYPTO Block Cipher Chaining Modifiers." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t9">Name</th>
<th class="cellalignment4328" id="r1c2-t9">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t9" headers="r1c1-t9">
<p><code dir="ltr">CHAIN_ECB</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t9 r1c2-t9">
<p>Electronic Codebook. Encrypts each plaintext block independently.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t9" headers="r1c1-t9">
<p><code dir="ltr">CHAIN_CBC</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t9 r1c2-t9">
<p>Cipher Block Chaining. Plaintext is XORed with the previous ciphertext block before it is encrypted.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t9" headers="r1c1-t9">
<p><code dir="ltr">CHAIN_CFB</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t9 r1c2-t9">
<p>Cipher-Feedback. Enables encrypting units of data smaller than the block size.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t9" headers="r1c1-t9">
<p><code dir="ltr">CHAIN_OFB</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t9 r1c2-t9">
<p>Output-Feedback. Enables running a block cipher as a synchronous stream cipher. Similar to CFB, except that <span class="italic">n</span> bits of the previous output block are moved into the right-most positions of the data queue waiting to be encrypted.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<div id="ARPLS65681" class="tblformal">
<p class="titleintable"><a id="sthref1777"></a><a id="BJFEJIEH"></a>Table 40-8 DBMS_CRYPTO Block Cipher Padding Modifiers</p>
<table class="cellalignment4330" title="DBMS_CRYPTO Block Cipher Padding Modifiers" summary="This table describes DBMS_CRYPTO Block Cipher Padding Modifiers." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t10">Name</th>
<th class="cellalignment4328" id="r1c2-t10">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t10" headers="r1c1-t10">
<p><code dir="ltr">PAD_PKCS5</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t10 r1c2-t10">
<p>Provides padding which complies with the PKCS #5: Password-Based Cryptography Standard</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t10" headers="r1c1-t10">
<p><code dir="ltr">PAD_NONE</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t10 r1c2-t10">
<p>Provides option to specify no padding. Caller must ensure that blocksize is correct, else the package returns an error.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t10" headers="r1c1-t10">
<p><code dir="ltr">PAD_ZERO</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t10 r1c2-t10">
<p>Provides padding consisting of zeroes</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsect2" -->
<div id="ARPLS65682" class="refsect2"><a id="i1004146"></a>
<h3 class="refsect2">Restrictions</h3>
<p>The <code dir="ltr">VARCHAR2</code> datatype is not directly supported by <code dir="ltr">DBMS_CRYPTO</code>. Before you can perform cryptographic operations on data of the type <code dir="ltr">VARCHAR2</code>, you must convert it to the uniform database character set AL32UTF8, and then convert it to the <code dir="ltr">RAW</code> datatype. After performing these conversions, you can then encrypt it with the <code dir="ltr">DBMS_CRYPTO</code> package.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#i1004371">&#34;Conversion Rules&#34;</a> for information about converting datatypes.</div>
</div>
<!-- class="refsect2" -->
<div id="ARPLS65683" class="refsect2"><a id="i1004147"></a>
<h3 class="refsect2">Exceptions</h3>
<p><a href="#BJFJHJHH">Table 40-9</a> lists exceptions that have been defined for <code dir="ltr">DBMS_CRYPTO</code>.</p>
<div id="ARPLS65684" class="tblformal">
<p class="titleintable"><a id="sthref1778"></a><a id="BJFJHJHH"></a>Table 40-9 DBMS_CRYPTO Exceptions</p>
<table class="cellalignment4330" title="DBMS_CRYPTO Exceptions" summary="This table describes DBMS_CRYPTO Exceptions." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t12">Exception</th>
<th class="cellalignment4328" id="r1c2-t12">Code</th>
<th class="cellalignment4328" id="r1c3-t12">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t12" headers="r1c1-t12">
<p><code dir="ltr">CipherSuiteInvalid</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t12 r1c2-t12">
<p><code dir="ltr">28827</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t12 r1c3-t12">
<p>The specified cipher suite is not defined.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t12" headers="r1c1-t12">
<p><code dir="ltr">CipherSuiteNull</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t12 r1c2-t12">
<p><code dir="ltr">28829</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t12 r1c3-t12">
<p>No value has been specified for the cipher suite to be used.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t12" headers="r1c1-t12">
<p><code dir="ltr">KeyNull</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t12 r1c2-t12">
<p><code dir="ltr">28239</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t12 r1c3-t12">
<p>The encryption key has not been specified or contains a <code dir="ltr">NULL</code> value.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t12" headers="r1c1-t12">
<p><code dir="ltr">KeyBadSize</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t12 r1c2-t12">
<p><code dir="ltr">28234</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t12 r1c3-t12">
<p>DES keys: Specified key size is too short. DES keys must be at least 8 bytes (64 bits).</p>
<p>AES keys: Specified key size is not supported. AES keys must be 128, 192, or 256 bits in length.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r6c1-t12" headers="r1c1-t12">
<p><code dir="ltr">DoubleEncryption</code></p>
</td>
<td class="cellalignment4329" headers="r6c1-t12 r1c2-t12">
<p><code dir="ltr">28233</code></p>
</td>
<td class="cellalignment4329" headers="r6c1-t12 r1c3-t12">
<p>Source data was previously encrypted.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsect2" -->
<div id="ARPLS65685" class="refsect2"><a id="i1004148"></a>
<h3 class="refsect2">Operational Notes</h3>
<ul>
<li>
<p><a href="#i1003719">When to Use Encrypt and Decrypt Procedures or Functions</a></p>
</li>
<li>
<p><a href="#i1003350">When to Use Hash or Message Authentication Code (MAC) Functions</a></p>
</li>
<li>
<p><a href="#i1003750">About Generating and Storing Encryption Keys</a></p>
</li>
<li>
<p><a href="#i1004371">Conversion Rules</a></p>
</li>
</ul>
<div id="ARPLS65686" class="refsect3"><a id="i1003719"></a>
<h4 class="refsect3">When to Use Encrypt and Decrypt Procedures or Functions</h4>
<p>This package includes both <code dir="ltr">ENCRYPT</code> and <code dir="ltr">DECRYPT</code> procedures and functions. The procedures are used to encrypt or decrypt <code dir="ltr">LOB</code> datatypes (overloaded for <code dir="ltr">CLOB</code> and <code dir="ltr">BLOB</code> datatypes). In contrast, the <code dir="ltr">ENCRYPT</code> and <code dir="ltr">DECRYPT</code> functions are used to encrypt and decrypt <code dir="ltr">RAW</code> datatypes. Data of type <code dir="ltr">VARCHAR2</code> must be converted to <code dir="ltr">RAW</code> before you can use <code dir="ltr">DBMS_CRYPTO</code> functions to encrypt it.</p>
</div>
<!-- class="refsect3" -->
<div id="ARPLS65687" class="refsect3"><a id="i1003350"></a>
<h4 class="refsect3">When to Use Hash or Message Authentication Code (MAC) Functions</h4>
<p>This package includes two different types of one-way hash functions: the <code dir="ltr">HASH</code> function and the <code dir="ltr">MAC</code> function. Hash functions operate on an arbitrary-length input message, and return a fixed-length hash value. One-way hash functions work in one direction only. It is easy to compute a hash value from an input message, but it is extremely difficult to generate an input message that hashes to a particular value. Note that hash values should be at least 128 bits in length to be considered secure.</p>
<p>You can use hash values to verify whether data has been altered. For example, before storing data, the user runs <code dir="ltr">DBMS_CRYPTO.HASH</code> against the stored data to create a hash value. On returning the stored data, the user can again run the hash function against it, using the same algorithm. If the second hash value is identical to the first one, then the data has not been altered. Hash values are similar to &#34;file fingerprints&#34; and are used to ensure data integrity.</p>
<p>The <code dir="ltr">HASH</code> function included with <code dir="ltr">DBMS_CRYPTO</code>, is a one-way hash function that you can use to generate a hash value from either <code dir="ltr">RAW</code> or <code dir="ltr">LOB</code> data. The <code dir="ltr">MAC</code> function is also a one-way hash function, but with the addition of a secret key. It works the same way as the <code dir="ltr">DBMS_CRYPTO.HASH</code> function, except only someone with the key can verify the hash value.</p>
<p>MACs can be used to authenticate files between users. They can also be used by a single user to determine if her files have been altered, perhaps by a virus. A user could compute the MAC of his files and store that value in a table. If the user did not use a MAC function, then the virus could compute the new hash value after infection and replace the table entry. A virus cannot do that with a MAC because the virus does not know the key.</p>
</div>
<!-- class="refsect3" -->
<div id="ARPLS65688" class="refsect3"><a id="i1003750"></a>
<h4 class="refsect3">About Generating and Storing Encryption Keys</h4>
<p>The <code dir="ltr">DBMS_CRYPTO</code> package can generate random material for encryption keys, but it does not provide a mechanism for maintaining them. Application developers must take care to ensure that the encryption keys used with this package are securely generated and stored. Also note that the encryption and decryption operations performed by <code dir="ltr">DBMS_CRYPTO</code> occur on the server, not on the client. Consequently, if the key is sent over the connection between the client and the server, the connection must be protected by using network encryption. Otherwise, the key is vulnerable to capture over the wire.</p>
<p>Although <code dir="ltr">DBMS_CRYPTO</code> cannot generate keys on its own, it does provide tools you can use to aid in key generation. For example, you can use the <code dir="ltr">RANDOMBYTES</code> function to generate random material for keys.</p>
<p>When generating encryption keys for DES, it is important to remember that some numbers are considered weak and semiweak keys. Keys are considered weak or semiweak when the pattern of the algorithm combines with the pattern of the initial key value to produce ciphertext that is more susceptible to cryptanalysis. To avoid this, filter out the known weak DES keys. Lists of the known weak and semiweak DES keys are available on several public Internet sites.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink ASOAG" href="../ASOAG/toc.htm"><span class="italic">Oracle Database Advanced Security Guide</span></a> for information about configuring network encryption and SSL.</p>
</li>
<li>
<p><a href="#i1000605">&#34;RANDOMBYTES Function&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="refsect3" -->
<div id="ARPLS65689" class="refsect3"><a id="i1004371"></a>
<h4 class="refsect3">Conversion Rules</h4>
<ul>
<li>
<p>To convert <code dir="ltr">VARCHAR2</code> to <code dir="ltr">RAW</code>, use the <code dir="ltr">UTL_I18N.STRING_TO_RAW</code> function to perform the following steps:</p>
<ol>
<li>
<p>Convert <code dir="ltr">VARCHAR2</code> in the current database character set to <code dir="ltr">VARCHAR2</code> in the AL32UTF8 database character.</p>
</li>
<li>
<p>Convert <code dir="ltr">VARCHAR2</code> in the AL32UTF8 database character set to <code dir="ltr">RAW</code>.</p>
</li>
</ol>
<p>Syntax example:</p>
<pre dir="ltr">UTL_I18N.STRING_TO_RAW (<span class="variable">string</span>, &#39;AL32UTF8&#39;);
</pre></li>
<li>
<p>To convert <code dir="ltr">RAW</code> to <code dir="ltr">VARCHAR2</code>, use the <code dir="ltr">UTL_I18N.RAW_TO_CHAR</code> function to perform the following steps:</p>
<ol>
<li>
<p>Convert <code dir="ltr">RAW</code> to <code dir="ltr">VARCHAR2</code> in the AL32UTF8 database character set.</p>
</li>
<li>
<p>Convert <code dir="ltr">VARCHAR2</code> in the AL32UTF8 database character set to <code dir="ltr">VARCHAR2</code> in the database character set you wish to use.</p>
</li>
</ol>
<p>Syntax example:</p>
<pre dir="ltr">UTL_I18N.RAW_TO_CHAR (data, &#39;AL32UTF8&#39;);
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="u_i18n.htm#CHDICDCB">Chapter 253, &#34;UTL_I18N&#34;</a> for information about using the <code dir="ltr">UTL_I18N</code> PL/SQL package.</div>
</li>
<li>
<p>If you want to store encrypted data of the <code dir="ltr">RAW</code> datatype in a <code dir="ltr">VARCHAR2</code> database column, then use <code dir="ltr">RAWTOHEX</code> or <code dir="ltr">UTL_ENCODE.BASE64_ENCODE</code> to make it suitable for <code dir="ltr">VARCHAR2</code> storage. These functions expand data size by 2 and 4/3, respectively.</p>
</li>
</ul>
</div>
<!-- class="refsect3" --></div>
<!-- class="refsect2" -->
<div id="ARPLS65690" class="refsect2"><a id="sthref1779"></a>
<h3 class="refsect2">Examples</h3>
<p>The following listing shows PL/SQL block encrypting and decrypting pre-defined &#39;<code dir="ltr">input_string</code>&#39; using 256-bit AES algorithm with Cipher Block Chaining and PKCS#5 compliant padding.</p>
<pre dir="ltr">DECLARE
   input_string       VARCHAR2 (200) :=  &#39;Secret Message&#39;;
   output_string      VARCHAR2 (200);
   encrypted_raw      RAW (2000);             -- stores encrypted binary text
   decrypted_raw      RAW (2000);             -- stores decrypted binary text
   num_key_bytes      NUMBER := 256/8;        -- key length 256 bits (32 bytes)
   key_bytes_raw      RAW (32);               -- stores 256-bit encryption key
   encryption_type    PLS_INTEGER :=          -- total encryption type
                            DBMS_CRYPTO.ENCRYPT_AES256
                          + DBMS_CRYPTO.CHAIN_CBC
                          + DBMS_CRYPTO.PAD_PKCS5;
   iv_raw             RAW (16);

BEGIN
   DBMS_OUTPUT.PUT_LINE ( &#39;Original string: &#39; || input_string);
   key_bytes_raw := DBMS_CRYPTO.RANDOMBYTES (num_key_bytes);
   iv_raw        := DBMS_CRYPTO.RANDOMBYTES (16);
   encrypted_raw := DBMS_CRYPTO.ENCRYPT
      (
         src =&gt; UTL_I18N.STRING_TO_RAW (input_string,  &#39;AL32UTF8&#39;),
         typ =&gt; encryption_type,
         key =&gt; key_bytes_raw,
         iv  =&gt; iv_raw
      );
    -- The encrypted value &#34;encrypted_raw&#34; can be used here

   decrypted_raw := DBMS_CRYPTO.DECRYPT
      (
         src =&gt; encrypted_raw,
         typ =&gt; encryption_type,
         key =&gt; key_bytes_raw,
         iv  =&gt; iv_raw
      );
   output_string := UTL_I18N.RAW_TO_CHAR (decrypted_raw, &#39;AL32UTF8&#39;);
 
   DBMS_OUTPUT.PUT_LINE (&#39;Decrypted string: &#39; || output_string); 
 
END;
</pre></div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" -->
<a id="i1001225"></a>
<div id="ARPLS665" class="refsect1">
<h2 class="refsect1">Summary of DBMS_CRYPTO Subprograms</h2>
<div id="ARPLS65691" class="tblformal">
<p class="titleintable"><a id="sthref1780"></a><a id="sthref1781"></a>Table 40-10 <span class="bolditalic">DBMS_CRYPTO Package Subprograms</span></p>
<table class="cellalignment4330" title="DBMS_CRYPTO Package Subprograms" summary="This table lists the DBMS_CRYPTO subprograms in alphabetical order and briefly describes them." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t15">Subprogram</th>
<th class="cellalignment4328" id="r1c2-t15">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t15" headers="r1c1-t15">
<p><a href="#i1004325">DECRYPT Function</a></p>
</td>
<td class="cellalignment4329" headers="r2c1-t15 r1c2-t15">
<p>Decrypts <code dir="ltr">RAW</code> data using a stream or block cipher with a user supplied key and optional IV (initialization vector)</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t15" headers="r1c1-t15">
<p><a href="#i1004271">DECRYPT Procedures</a></p>
</td>
<td class="cellalignment4329" headers="r3c1-t15 r1c2-t15">
<p>Decrypts <code dir="ltr">LOB</code> data using a stream or block cipher with a user supplied key and optional IV</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t15" headers="r1c1-t15">
<p><a href="#i1002112">ENCRYPT Function</a></p>
</td>
<td class="cellalignment4329" headers="r4c1-t15 r1c2-t15">
<p>Encrypts <code dir="ltr">RAW</code> data using a stream or block cipher with a user supplied key and optional IV</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t15" headers="r1c1-t15">
<p><a href="#i1003081">ENCRYPT Procedures</a></p>
</td>
<td class="cellalignment4329" headers="r5c1-t15 r1c2-t15">
<p>Encrypts <code dir="ltr">LOB</code> data using a stream or block cipher with a user supplied key and optional IV</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r6c1-t15" headers="r1c1-t15">
<p><a href="#i1002022">HASH Function</a></p>
</td>
<td class="cellalignment4329" headers="r6c1-t15 r1c2-t15">
<p>Applies one of the supported cryptographic hash algorithms (MD4, MD5, SHA-1, or SHA-2) to data</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r7c1-t15" headers="r1c1-t15">
<p><a href="#i1000594">MAC Function</a></p>
</td>
<td class="cellalignment4329" headers="r7c1-t15 r1c2-t15">
<p>Applies Message Authentication Code algorithms (MD5, SHA-1, or SHA-2) to data to provide keyed message protection</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r8c1-t15" headers="r1c1-t15">
<p><a href="#i1000605">RANDOMBYTES Function</a></p>
</td>
<td class="cellalignment4329" headers="r8c1-t15 r1c2-t15">
<p>Returns a <code dir="ltr">RAW</code> value containing a cryptographically secure pseudo-random sequence of bytes, and can be used to generate random material for encryption keys</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r9c1-t15" headers="r1c1-t15">
<p><a href="#i1003214">RANDOMINTEGER Function</a></p>
</td>
<td class="cellalignment4329" headers="r9c1-t15 r1c2-t15">
<p>Returns a random <code dir="ltr">BINARY_INTEGER</code></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r10c1-t15" headers="r1c1-t15">
<p><a href="#i1004384">RANDOMNUMBER Function</a></p>
</td>
<td class="cellalignment4329" headers="r10c1-t15 r1c2-t15">
<p>Returns a random 128-bit integer of the <code dir="ltr">NUMBER</code> datatype</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<div id="ARPLS65692" class="refsect2"><a id="i1004325"></a>
<h3 class="refsect2">DECRYPT Function</h3>
<p>This function decrypts <code dir="ltr">RAW</code> data using a stream or block cipher with a user supplied key and optional IV (initialization vector).</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1782"></a>Syntax</p>
<pre dir="ltr">DBMS_CRYPTO.DECRYPT(
   src IN RAW,
   typ IN PLS_INTEGER,
   key IN RAW,
   iv  IN RAW DEFAULT NULL)
 RETURN RAW;
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1783"></a>Pragmas</p>
<pre dir="ltr">pragma restrict_references(decrypt,WNDS,RNDS,WNPS,RNPS);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1784"></a>Parameters</p>
<div id="ARPLS65693" class="tblformal">
<p class="titleintable"><a id="sthref1785"></a><a id="sthref1786"></a>Table 40-11 DECRYPT Function Parameters</p>
<table class="cellalignment4330" title="DECRYPT Function Parameters" summary="This table describes the parameters of DBMS_CRYPTO.DECRYPT function." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t16">Parameter Name</th>
<th class="cellalignment4328" id="r1c2-t16">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t16" headers="r1c1-t16">
<p><code dir="ltr">src</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t16 r1c2-t16">
<p><code dir="ltr">RAW</code> data to be decrypted.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t16" headers="r1c1-t16">
<p><code dir="ltr">typ</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t16 r1c2-t16">
<p>Stream or block cipher type and modifiers to be used.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t16" headers="r1c1-t16">
<p><code dir="ltr">key</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t16 r1c2-t16">
<p>Key to be used for decryption.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t16" headers="r1c1-t16">
<p><code dir="ltr">iv</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t16 r1c2-t16">
<p>Optional initialization vector for block ciphers. Default is <code dir="ltr">NULL</code>.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1787"></a>Usage Notes</p>
<ul>
<li>
<p>To retrieve original plaintext data, <code dir="ltr">DECRYPT</code> must be called with the same cipher, modifiers, key, and IV that was used to encrypt the data originally.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#i1004615">&#34;Usage Notes&#34;</a> for the <code dir="ltr">ENCRYPT</code> function for additional information about the ciphers and modifiers available with this package.</div>
</li>
<li>
<p>If <code dir="ltr">VARCHAR2</code> data is converted to <code dir="ltr">RAW</code> before encryption, then it must be converted back to the appropriate database character set by using the <code dir="ltr">UTL_I18N</code> package.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#i1004371">&#34;Conversion Rules&#34;</a> for a discussion of the <code dir="ltr">VARCHAR2</code> to <code dir="ltr">RAW</code> conversion process.</div>
</li>
</ul>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS65694" class="refsect2"><a id="i1004271"></a>
<h3 class="refsect2">DECRYPT Procedures</h3>
<p>These procedures decrypt <code dir="ltr">LOB</code> data using a stream or block cipher with a user supplied key and optional IV (initialization vector).</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1788"></a>Syntax</p>
<pre dir="ltr">DBMS_CRYPTO.DECRYPT(
   dst IN OUT NOCOPY BLOB,
   src IN            BLOB,
   typ IN            PLS_INTEGER,
   key IN            RAW,
   iv  IN            RAW          DEFAULT NULL);

DBMS_CRYPT.DECRYPT(
   dst IN OUT NOCOPY CLOB         CHARACTER SET ANY_CS,
   src IN            BLOB,
   typ IN            PLS_INTEGER,
   key IN            RAW,
   iv  IN            RAW          DEFAULT NULL);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1789"></a>Pragmas</p>
<pre dir="ltr">pragma restrict_references(decrypt,WNDS,RNDS,WNPS,RNPS);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1790"></a>Parameters</p>
<div id="ARPLS65695" class="tblformal">
<p class="titleintable"><a id="sthref1791"></a><a id="sthref1792"></a>Table 40-12 DECRYPT Procedure Parameters</p>
<table class="cellalignment4330" title="DECRYPT Procedure Parameters" summary="This table describes the parameters of DBMS_CRYPTO.DECRYPT procedures." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t19">Parameter Name</th>
<th class="cellalignment4328" id="r1c2-t19">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t19" headers="r1c1-t19">
<p>dst</p>
</td>
<td class="cellalignment4329" headers="r2c1-t19 r1c2-t19">
<p><code dir="ltr">LOB</code> locator of output data. The value in the output <code dir="ltr">LOB</code> &lt;<code dir="ltr">dst</code>&gt; will be overwritten.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t19" headers="r1c1-t19">
<p><code dir="ltr">src</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t19 r1c2-t19">
<p><code dir="ltr">LOB</code> locator of input data.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t19" headers="r1c1-t19">
<p><code dir="ltr">typ</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t19 r1c2-t19">
<p>Stream or block cipher type and modifiers to be used.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t19" headers="r1c1-t19">
<p><code dir="ltr">key</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t19 r1c2-t19">
<p>Key to be used for decryption.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r6c1-t19" headers="r1c1-t19">
<p><code dir="ltr">iv</code></p>
</td>
<td class="cellalignment4329" headers="r6c1-t19 r1c2-t19">
<p>Optional initialization vector for block ciphers. Default is all zeroes.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS65696" class="refsect2"><a id="i1002112"></a>
<h3 class="refsect2">ENCRYPT Function</h3>
<p>This function encrypts <code dir="ltr">RAW</code> data using a stream or block cipher with a user supplied key and optional IV (initialization vector).</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1793"></a>Syntax</p>
<pre dir="ltr">DBMS_CRYPTO.ENCRYPT(
   src IN RAW,
   typ IN PLS_INTEGER,
   key IN RAW,
   iv  IN RAW          DEFAULT NULL)
 RETURN RAW;
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1794"></a>Pragmas</p>
<pre dir="ltr">pragma restrict_references(encrypt,WNDS,RNDS,WNPS,RNPS);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1795"></a>Parameters</p>
<div id="ARPLS65697" class="tblformal">
<p class="titleintable"><a id="sthref1796"></a><a id="sthref1797"></a>Table 40-13 ENCRYPT Function Parameters</p>
<table class="cellalignment4330" title="ENCRYPT Function Parameters" summary="This table describes the parameters of DBMS_CRYPTO.ENCRYPT function." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t20">Parameter Name</th>
<th class="cellalignment4328" id="r1c2-t20">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t20" headers="r1c1-t20">
<p><code dir="ltr">src</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t20 r1c2-t20">
<p><code dir="ltr">RAW</code> data to be encrypted.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t20" headers="r1c1-t20">
<p><code dir="ltr">typ</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t20 r1c2-t20">
<p>Stream or block cipher type and modifiers to be used.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t20" headers="r1c1-t20">
<p><code dir="ltr">key</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t20 r1c2-t20">
<p>Encryption key to be used for encrypting data.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t20" headers="r1c1-t20">
<p><code dir="ltr">iv</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t20 r1c2-t20">
<p>Optional initialization vector for block ciphers. Default is <code dir="ltr">NULL</code>.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="i1004615"></a>Usage Notes</p>
<ul>
<li>
<p>Block ciphers may be modified with chaining and padding type modifiers. The chaining and padding type modifiers are added to the block cipher to produce a cipher suite. Cipher Block Chaining (CBC) is the most commonly used chaining type, and PKCS #5 is the recommended padding type. See <a href="#BJFEAAHD">Table 40-7</a> and <a href="#BJFEJIEH">Table 40-8</a> for block cipher chaining and padding modifier constants that have been defined for this package.</p>
</li>
<li>
<p>To improve readability, you can define your own package-level constants to represent the cipher suites you use for encryption and decryption. For example, the following example defines a cipher suite that uses DES, cipher block chaining mode, and no padding:</p>
<pre dir="ltr">DES_CBC_NONE CONSTANT PLS_INTEGER := DBMS_CRYPTO.ENCRYPT_DES
                                     + DBMS_CRYPTO.CHAIN_CBC
                                     + DBMS_CRYPTO.PAD_NONE;
</pre>
<p>See <a href="#BJFJEGDA">Table 40-6</a> for the block cipher suites already defined as constants for this package.</p>
</li>
<li>
<p>To encrypt <code dir="ltr">VARCHAR2</code> data, it should first be converted to the AL32UTF8 character set.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#i1004371">&#34;Conversion Rules&#34;</a> for a discussion of the conversion process.</div>
</li>
<li>
<p>Stream ciphers, such as RC4, are not recommended for stored data encryption.</p>
</li>
</ul>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS65698" class="refsect2"><a id="i1003081"></a>
<h3 class="refsect2">ENCRYPT Procedures</h3>
<p>These procedures encrypt <code dir="ltr">LOB</code> data using a stream or block cipher with a user supplied key and optional IV (initialization vector).</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1798"></a>Syntax</p>
<pre dir="ltr">DBMS_CRYPTO.ENCRYPT(
   dst IN OUT NOCOPY BLOB,
   src IN            BLOB,
   typ IN            PLS_INTEGER,
   key IN            RAW,
   iv  IN            RAW          DEFAULT NULL);

DBMS_CRYPTO.ENCRYPT(
   dst IN OUT NOCOPY BLOB,
   src IN            CLOB         CHARACTER SET ANY_CS,
   typ IN            PLS_INTEGER,
   key IN            RAW,
   iv  IN            RAW          DEFAULT NULL);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1799"></a>Pragmas</p>
<pre dir="ltr">pragma restrict_references(encrypt,WNDS,RNDS,WNPS,RNPS);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1800"></a>Parameters</p>
<div id="ARPLS65699" class="tblformal">
<p class="titleintable"><a id="sthref1801"></a><a id="sthref1802"></a>Table 40-14 ENCRYPT Procedure Parameters</p>
<table class="cellalignment4330" title="ENCRYPT Procedure Parameters" summary="This table describes the parameters of DBMS_CRYPTO.ENCRYPT procedures." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t22">Parameter Name</th>
<th class="cellalignment4328" id="r1c2-t22">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t22" headers="r1c1-t22">
<p>dst</p>
</td>
<td class="cellalignment4329" headers="r2c1-t22 r1c2-t22">
<p><code dir="ltr">LOB</code> locator of output data. The value in the output <code dir="ltr">LOB</code> &lt;<code dir="ltr">dst</code>&gt; will be overwritten.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t22" headers="r1c1-t22">
<p><code dir="ltr">src</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t22 r1c2-t22">
<p><code dir="ltr">LOB</code> locator of input data.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t22" headers="r1c1-t22">
<p><code dir="ltr">typ</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t22 r1c2-t22">
<p>Stream or block cipher type and modifiers to be used.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t22" headers="r1c1-t22">
<p><code dir="ltr">key</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t22 r1c2-t22">
<p>Encryption key to be used for encrypting data.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r6c1-t22" headers="r1c1-t22">
<p><code dir="ltr">iv</code></p>
</td>
<td class="cellalignment4329" headers="r6c1-t22 r1c2-t22">
<p>Optional initialization vector for block ciphers. Default is <code dir="ltr">NULL</code>.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1803"></a>Usage Notes</p>
<p>See <a href="#i1004371">&#34;Conversion Rules&#34;</a> for usage notes about using the <code dir="ltr">ENCRYPT</code> procedure.</p>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS65700" class="refsect2"><a id="i1002022"></a>
<h3 class="refsect2">HASH Function</h3>
<p>A one-way hash function takes a variable-length input string, the data, and converts it to a fixed-length (generally smaller) output string called a <span class="italic">hash value</span>. The hash value serves as a unique identifier (like a fingerprint) of the input data. You can use the hash value to verify whether data has been changed or not.</p>
<p>Note that a one-way hash function is a hash function that works in one direction. It is easy to compute a hash value from the input data, but it is hard to generate data that hashes to a particular value. Consequently, one-way hash functions work well to ensure data integrity. Refer to <a href="#i1003350">&#34;When to Use Hash or Message Authentication Code (MAC) Functions&#34;</a> for more information about using one-way hash functions.</p>
<p>This function applies to data one of the supported cryptographic hash algorithms listed in <a href="#BJFCHAFC">Table 40-3</a>.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1804"></a>Syntax</p>
<pre dir="ltr">DBMS_CRYPTO.Hash (
   src IN RAW,
   typ IN PLS_INTEGER)
 RETURN RAW;

DBMS_CRYPTO.Hash (
   src IN BLOB,
   typ IN PLS_INTEGER)
 RETURN RAW;

DBMS_CRYPTO.Hash (
   src IN CLOB CHARACTER SET ANY_CS,
   typ IN PLS_INTEGER)
 RETURN RAW;
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1805"></a>Pragmas</p>
<pre dir="ltr">pragma restrict_references(hash,WNDS,RNDS,WNPS,RNPS);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1806"></a>Parameters</p>
<div id="ARPLS65701" class="tblformal">
<p class="titleintable"><a id="sthref1807"></a><a id="sthref1808"></a>Table 40-15 HASH Function Parameters</p>
<table class="cellalignment4330" title="HASH Function Parameters" summary="This table describes the parameters of DBMS_CRYPTO.HASH." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t23">Parameter Name</th>
<th class="cellalignment4328" id="r1c2-t23">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t23" headers="r1c1-t23">
<p><code dir="ltr">src</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t23 r1c2-t23">
<p>The source data to be hashed.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t23" headers="r1c1-t23">
<p><code dir="ltr">typ</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t23 r1c2-t23">
<p>The hash algorithm to be used.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1809"></a>Usage Note</p>
<p>Oracle recommends that you use the SHA-1 (Secure Hash Algorithm) or SHA-2 because it is more resistant to brute-force attacks than MD4 or MD5. If you must use a Message Digest algorithm, then MD5 provides greater security than MD4.</p>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS65702" class="refsect2"><a id="i1000594"></a>
<h3 class="refsect2">MAC Function</h3>
<p>A Message Authentication Code, or MAC, is a key-dependent one-way hash function. MACs have the same properties as the one-way hash function described in <a href="#i1002022">&#34;HASH Function&#34;</a>, but they also include a key. Only someone with the identical key can verify the hash. Also refer to <a href="#i1003350">&#34;When to Use Hash or Message Authentication Code (MAC) Functions&#34;</a> for more information about using MACs.</p>
<p>This function applies MAC algorithms to data to provide keyed message protection. See <a href="#BJFEIEFA">Table 40-4</a> for a list of MAC algorithms that have been defined for this package.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1810"></a>Syntax</p>
<pre dir="ltr">DBMS_CRYPTO.MAC (
   src IN RAW,
   typ IN PLS_INTEGER,
   key IN RAW)
 RETURN RAW;

DBMS_CRYPTO.MAC (
   src IN BLOB,
   typ IN PLS_INTEGER
   key IN RAW)
 RETURN RAW;

DBMS_CRYPTO.MAC (
   src IN CLOB CHARACTER SET ANY_CS,
   typ IN PLS_INTEGER
   key IN RAW)
 RETURN RAW;
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1811"></a>Pragmas</p>
<pre dir="ltr">pragma restrict_references(mac,WNDS,RNDS,WNPS,RNPS);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1812"></a>Parameters</p>
<div id="ARPLS65703" class="tblformal">
<p class="titleintable"><a id="sthref1813"></a><a id="sthref1814"></a>Table 40-16 MAC Function Parameters</p>
<table class="cellalignment4330" title="MAC Function Parameters" summary="This table describes the parameters of DBMS_CRYPTO.MAC." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t24">Parameter Name</th>
<th class="cellalignment4328" id="r1c2-t24">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t24" headers="r1c1-t24">
<p><code dir="ltr">src</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t24 r1c2-t24">
<p>Source data to which MAC algorithms are to be applied.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t24" headers="r1c1-t24">
<p><code dir="ltr">typ</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t24 r1c2-t24">
<p>MAC algorithm to be used.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t24" headers="r1c1-t24">
<p><code dir="ltr">key</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t24 r1c2-t24">
<p>Key to be used for MAC algorithm.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS65704" class="refsect2"><a id="i1000605"></a>
<h3 class="refsect2">RANDOMBYTES Function</h3>
<p>This function returns a <code dir="ltr">RAW</code> value containing a cryptographically secure pseudo-random sequence of bytes, which can be used to generate random material for encryption keys. The <code dir="ltr">RANDOMBYTES</code> function is based on the RSA X9.31 PRNG (Pseudo-Random Number Generator).</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1815"></a>Syntax</p>
<pre dir="ltr">DBMS_CRYPTO.RANDOMBYTES (
   number_bytes IN POSITIVE)
 RETURN RAW;
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1816"></a>Pragmas</p>
<pre dir="ltr">pragma restrict_references(randombytes,WNDS,RNDS,WNPS,RNPS);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1817"></a>Parameters</p>
<div id="ARPLS65705" class="tblformal">
<p class="titleintable"><a id="sthref1818"></a><a id="sthref1819"></a>Table 40-17 RANDOMBYTES Function Parameter</p>
<table class="cellalignment4330" title="RANDOMBYTES Function Parameter" summary="This table describes the parameters of DBMS_CRYPTO.RANDOMBYTES." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t25">Parameter Name</th>
<th class="cellalignment4328" id="r1c2-t25">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t25" headers="r1c1-t25">
<p><code dir="ltr">number_bytes</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t25 r1c2-t25">
<p>The number of pseudo-random bytes to be generated.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1820"></a>Usage Note</p>
<p>The <code dir="ltr">number_bytes</code> value should not exceed the maximum length of a <code dir="ltr">RAW</code> variable.</p>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS65706" class="refsect2"><a id="i1003214"></a>
<h3 class="refsect2">RANDOMINTEGER Function</h3>
<p>This function returns an integer in the complete range available for the Oracle <code dir="ltr">BINARY_INTEGER</code> datatype.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1821"></a>Syntax</p>
<pre dir="ltr">DBMS_CRYPTO.RANDOMINTEGER
 RETURN BINARY_INTEGER;
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1822"></a>Pragmas</p>
<pre dir="ltr">pragma restrict_references(randominteger,WNDS,RNDS,WNPS,RNPS);
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS65707" class="refsect2"><a id="i1004384"></a>
<h3 class="refsect2">RANDOMNUMBER Function</h3>
<p>This function returns an integer in the Oracle <code dir="ltr">NUMBER</code> datatype in the range of [0..2**128-1].</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1823"></a>Syntax</p>
<pre dir="ltr">DBMS_CRYPTO.RANDOMNUMBER
 RETURN NUMBER;
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1824"></a>Pragmas</p>
<pre dir="ltr">pragma restrict_references(randomnumber,WNDS,RNDS,WNPS,RNPS);
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" --></div>
<!-- class="refentry" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment4320">
<tr>
<td class="cellalignment4329">
<table class="cellalignment4325">
<tr>
<td class="cellalignment4324"><a href="d_credential.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment4324"><a href="d_csx_admin.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment4332">
<table class="cellalignment4323">
<tr>
<td class="cellalignment4324"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment4324"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment4324"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment4324"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment4324"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment4324"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>


</body></html>