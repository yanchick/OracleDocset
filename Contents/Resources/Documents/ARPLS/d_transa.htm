<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-2369"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/DBMS_TRANSACTION"></a><title>DBMS_TRANSACTION</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1086"/>
<meta name="dcterms.created" content="2016-09-02T5:36:53Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database PL/SQL Packages and Types Reference"/>
<meta name="dcterms.identifier" content="E41829-07"/>
<meta name="dcterms.isVersionOf" content="ARPLS"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="d_trace.htm" title="Previous" type="text/html"/>
<link rel="Next" href="d_transf.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41829-07.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">172/290</span> <!-- End Header -->
<div id="ARPLS062" class="chapter"><a id="sthref11900"></a>
<h1 class="chapter"><span class="secnum">168</span> DBMS_TRANSACTION</h1>
<p>The <a id="sthref11901"></a>DBMS_TRANSACTION package provides access to SQL transaction statements from stored procedures.</p>
<div class="infoboxnotealso">
<p class="notep1"><span class="bold">See Also</span>:</p>
<a class="olink SQLRF" href="../SQLRF/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a></div>
<p>This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#CIAHBHAB">Using DBMS_TRANSACTION</a></p>
<ul>
<li>
<p>Security Model</p>
</li>
</ul>
</li>
<li>
<p><a href="#CIAJBJEI">Summary of DBMS_TRANSACTION Subprograms</a></p>
</li>
</ul>
<div class="refentry"><a id="CIAHBHAB"></a>
<div id="ARPLS68889" class="refsect1">
<h2 class="refsect1">Using DBMS_TRANSACTION</h2>
<ul>
<li>
<p><a href="#i996753">Security Model</a></p>
</li>
</ul>
<div id="ARPLS68890" class="refsect2"><a id="i996753"></a>
<h3 class="refsect2">Security Model</h3>
<p>This package runs with the privileges of calling user, rather than the package owner <code dir="ltr">SYS</code>.</p>
</div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" -->
<a id="CIAJBJEI"></a>
<div id="ARPLS68891" class="refsect1">
<h2 class="refsect1">Summary of DBMS_TRANSACTION Subprograms</h2>
<div id="ARPLS68892" class="tblformal">
<p class="titleintable"><a id="sthref11902"></a><a id="sthref11903"></a>Table 168-1 DBMS_TRANSACTION Package Subprograms</p>
<table class="cellalignment4330" title="DBMS_TRANSACTION Package Subprograms" summary="This table lists the DBMS_TRANSACTION subprograms in alphabetical order and briefly describes them." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t3">Subprogram</th>
<th class="cellalignment4328" id="r1c2-t3">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t3" headers="r1c1-t3">
<p><a href="#i1000260">ADVISE_COMMIT Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r2c1-t3 r1c2-t3">
<p>Equivalent to the SQL statement:</p>
<p><code dir="ltr">ALTER SESSION ADVISE COMMIT</code></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t3" headers="r1c1-t3">
<p><a href="#i1000264">ADVISE_NOTHING Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r3c1-t3 r1c2-t3">
<p>Equivalent to the SQL statement:</p>
<p><code dir="ltr">ALTER SESSION ADVISE NOTHING</code></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t3" headers="r1c1-t3">
<p><a href="#i1000298">ADVISE_ROLLBACK Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r4c1-t3 r1c2-t3">
<p>Equivalent to the SQL statement:</p>
<p><code dir="ltr">ALTER SESSION ADVISE ROLLBACK</code></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t3" headers="r1c1-t3">
<p><a href="#i1000373">COMMIT Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r5c1-t3 r1c2-t3">
<p>Equivalent to the SQL statement:</p>
<p><code dir="ltr">COMMIT</code></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r6c1-t3" headers="r1c1-t3">
<p><a href="#i1000443">COMMIT_COMMENT Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r6c1-t3 r1c2-t3">
<p>Equivalent to the SQL statement:</p>
<p><code dir="ltr">COMMIT COMMENT &lt;text&gt;</code></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r7c1-t3" headers="r1c1-t3">
<p><a href="#i1000448">COMMIT_FORCE Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r7c1-t3 r1c2-t3">
<p>Equivalent to the SQL statement:</p>
<p><code dir="ltr">COMMIT FORCE &lt;text&gt;, &lt;number&gt;&#34;</code></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r8c1-t3" headers="r1c1-t3">
<p><a href="#i1000530">LOCAL_TRANSACTION_ID Function</a></p>
</td>
<td class="cellalignment4329" headers="r8c1-t3 r1c2-t3">
<p>Returns the local (to instance) unique identifier for the current transaction</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r9c1-t3" headers="r1c1-t3">
<p><a href="#i1000592">PURGE_LOST_DB_ENTRY Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r9c1-t3 r1c2-t3">
<p>Enables removal of incomplete transactions from the local site when the remote database is destroyed or re-created before recovery completes</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r10c1-t3" headers="r1c1-t3">
<p><a href="#i1000748">PURGE_MIXED Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r10c1-t3 r1c2-t3">
<p>Deletes information about a given mixed outcome transaction</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r11c1-t3" headers="r1c1-t3">
<p><a href="#i1000791">READ_ONLY Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r11c1-t3 r1c2-t3">
<p>Equivalent to the SQL statement:</p>
<p><code dir="ltr">SET TRANSACTION READ ONLY</code></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r12c1-t3" headers="r1c1-t3">
<p><a href="#CIAEGFIB">READ_WRITE Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r12c1-t3 r1c2-t3">
<p>equivalent to the SQL statement:</p>
<p><code dir="ltr">SET TRANSACTION READ WRITE</code></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r13c1-t3" headers="r1c1-t3">
<p><a href="#i1000835">ROLLBACK Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r13c1-t3 r1c2-t3">
<p>Equivalent to the SQL statement:</p>
<p><code dir="ltr">ROLLBACK</code></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r14c1-t3" headers="r1c1-t3">
<p><a href="#i1000863">ROLLBACK_FORCE Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r14c1-t3 r1c2-t3">
<p>Equivalent to the SQL statement:</p>
<p><code dir="ltr">ROLLBACK</code> <code dir="ltr">FORCE</code> <code dir="ltr">&lt;text&gt;</code></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r15c1-t3" headers="r1c1-t3">
<p><a href="#i1000909">ROLLBACK_SAVEPOINT Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r15c1-t3 r1c2-t3">
<p>Equivalent to the SQL statement:</p>
<p><code dir="ltr">ROLLBACK</code> <code dir="ltr">TO</code> <code dir="ltr">SAVEPOINT</code> <code dir="ltr">&lt;savepoint_name&gt;</code></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r16c1-t3" headers="r1c1-t3">
<p><a href="#i997017">SAVEPOINT Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r16c1-t3 r1c2-t3">
<p>Equivalent to the SQL statement:</p>
<p><code dir="ltr">SAVEPOINT</code> <code dir="ltr">&lt;savepoint_name&gt;</code></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r17c1-t3" headers="r1c1-t3">
<p><a href="#i1000520">STEP_ID Function</a></p>
</td>
<td class="cellalignment4329" headers="r17c1-t3 r1c2-t3">
<p>Returns local (to local transaction) unique positive integer that orders the DML operations of a transaction</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r18c1-t3" headers="r1c1-t3">
<p><a href="#i1000982">USE_ROLLBACK_SEGMENT Procedure</a></p>
</td>
<td class="cellalignment4329" headers="r18c1-t3 r1c2-t3">
<p>Equivalent to the SQL statement:</p>
<p><code dir="ltr">SET</code> <code dir="ltr">TRANSACTION</code> <code dir="ltr">USE</code> <code dir="ltr">ROLLBACK</code> <code dir="ltr">SEGMENT</code> <code dir="ltr">&lt;rb_seg_name&gt;</code></p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<div id="ARPLS68893" class="refsect2"><a id="i1000260"></a>
<h3 class="refsect2"><a id="sthref11904"></a>ADVISE_COMMIT Procedure</h3>
<p>This procedure is equivalent to the SQL statement:</p>
<pre dir="ltr">ALTER SESSION ADVISE COMMIT
</pre>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11905"></a>Syntax</p>
<pre dir="ltr">DBMS_TRANSACTION.ADVISE_COMMIT;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS68894" class="refsect2"><a id="i1000264"></a>
<h3 class="refsect2"><a id="sthref11906"></a>ADVISE_NOTHING Procedure</h3>
<p>This procedure is equivalent to the SQL statement:</p>
<pre dir="ltr">ALTER SESSION ADVISE NOTHING
</pre>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11907"></a>Syntax</p>
<pre dir="ltr">DBMS_TRANSACTION.ADVISE_NOTHING;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS68895" class="refsect2"><a id="i1000298"></a>
<h3 class="refsect2"><a id="sthref11908"></a>ADVISE_ROLLBACK Procedure</h3>
<p>This procedure is equivalent to the SQL statement:</p>
<pre dir="ltr">ALTER SESSION ADVISE ROLLBACK
</pre>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11909"></a>Syntax</p>
<pre dir="ltr">DBMS_TRANSACTION.ADVISE_ROLLBACK;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS68898" class="refsect2"><a id="i1000373"></a>
<h3 class="refsect2"><a id="sthref11910"></a>COMMIT Procedure</h3>
<p>This procedure is equivalent to the SQL statement:</p>
<pre dir="ltr">COMMIT 
</pre>
<p>This procedure is included for completeness, the functionality being already implemented as part of PL/SQL.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11911"></a>Syntax</p>
<pre dir="ltr">DBMS_TRANSACTION.COMMIT;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS68899" class="refsect2"><a id="i1000443"></a>
<h3 class="refsect2"><a id="sthref11912"></a>COMMIT_COMMENT Procedure</h3>
<p>This procedure is equivalent to the SQL statement:</p>
<pre dir="ltr">COMMIT COMMENT &lt;text&gt;
</pre>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11913"></a>Syntax</p>
<pre dir="ltr">DBMS_TRANSACTION.COMMIT_COMMENT (
   cmnt VARCHAR2);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11914"></a>Parameters</p>
<div id="ARPLS68900" class="tblformal">
<p class="titleintable"><a id="sthref11915"></a><a id="sthref11916"></a>Table 168-2 COMMIT_COMMENT Procedure Parameters</p>
<table class="cellalignment4330" title="COMMIT_COMMENT Procedure Parameters " summary="This table describes the Parameters of DBMS_TRANSACTION.COMMIT_COMMENT subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t4">Parameter</th>
<th class="cellalignment4328" id="r1c2-t4">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t4" headers="r1c1-t4">
<p><code dir="ltr">cmnt</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t4 r1c2-t4">
<p>Comment to associate with this commit.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS68901" class="refsect2"><a id="i1000448"></a>
<h3 class="refsect2"><a id="sthref11917"></a>COMMIT_FORCE Procedure</h3>
<p>This procedure is equivalent to the SQL statement:</p>
<pre dir="ltr">COMMIT FORCE &lt;text&gt;, &lt;number&gt;&#34;
</pre>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11918"></a>Syntax</p>
<pre dir="ltr">DBMS_TRANSACTION.COMMIT_FORCE (
   xid VARCHAR2, 
   scn VARCHAR2 DEFAULT NULL);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11919"></a>Parameters</p>
<div id="ARPLS68902" class="tblformal">
<p class="titleintable"><a id="sthref11920"></a><a id="sthref11921"></a>Table 168-3 COMMIT_FORCE Procedure Parameters</p>
<table class="cellalignment4330" title="COMMIT_FORCE Procedure Parameters " summary="This table describes the Parameters of DBMS_TRANSACTION.COMMIT_FORCE subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t5">Parameter</th>
<th class="cellalignment4328" id="r1c2-t5">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t5" headers="r1c1-t5">
<p><code dir="ltr">xid</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t5 r1c2-t5">
<p>Local or global transaction ID.</p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t5" headers="r1c1-t5">
<p><code dir="ltr">scn</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t5 r1c2-t5">
<p>System change number.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS68903" class="refsect2"><a id="i1000530"></a>
<h3 class="refsect2"><a id="sthref11922"></a>LOCAL_TRANSACTION_ID Function</h3>
<p>This function returns the local (to instance) unique identifier for the current transaction. It returns null if there is no current transaction.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11923"></a>Syntax</p>
<pre dir="ltr">DBMS_TRANSACTION.LOCAL_TRANSACTION_ID (
   create_transaction BOOLEAN := FALSE)
  RETURN VARCHAR2;
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11924"></a>Parameters</p>
<div id="ARPLS68904" class="tblformal">
<p class="titleintable"><a id="sthref11925"></a><a id="sthref11926"></a>Table 168-4 LOCAL_TRANSACTION_ID Function Parameters</p>
<table class="cellalignment4330" title="LOCAL_TRANSACTION_ID Function Parameters " summary="This table describes the Parameters of DBMS_TRANSACTION.LOCAL_TRANSACTION_ID subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t6">Parameter</th>
<th class="cellalignment4328" id="r1c2-t6">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t6" headers="r1c1-t6">
<p><code dir="ltr">create_transaction</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t6 r1c2-t6">
<p>If true, then start a transaction if one is not currently active.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS68905" class="refsect2"><a id="i1000592"></a>
<h3 class="refsect2"><a id="sthref11927"></a>PURGE_LOST_DB_ENTRY Procedure</h3>
<p>When a failure occurs during commit processing, automatic recovery consistently resolves the results at all sites involved in the transaction. However, if the remote database is destroyed or re-created before recovery completes, then the entries used to control recovery in <code dir="ltr">DBA_2PC_PENDING</code> and associated tables are never removed, and recovery will periodically retry. Procedure <code dir="ltr">PURGE_LOST_DB_ENTRY</code> enables removal of such transactions from the local site.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11928"></a>Syntax</p>
<pre dir="ltr">DBMS_TRANSACTION.PURGE_LOST_DB_ENTRY (
   xid VARCHAR2);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11929"></a>Parameters</p>
<div id="ARPLS68906" class="tblformal">
<p class="titleintable"><a id="sthref11930"></a><a id="sthref11931"></a>Table 168-5 PURGE_LOST_DB_ENTRY Procedure Parameters</p>
<table class="cellalignment4330" title="PURGE_LOST_DB_ENTRY Procedure Parameters " summary="This table describes the Parameters of DBMS_TRANSACTION.PURGE_LOST_DB_ENTRY subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t7">Parameter</th>
<th class="cellalignment4328" id="r1c2-t7">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t7" headers="r1c1-t7">
<p><code dir="ltr">xid</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t7 r1c2-t7">
<p>Must be set to the value of the <code dir="ltr">LOCAL_TRAN_ID</code> column in the <code dir="ltr">DBA_2PC_PENDING</code> table.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11932"></a>Usage Notes</p>
<div class="infoboxnotewarn">
<p class="notep1">WARNING:</p>
<p class="warnsp">PURGE_LOST_DB_ENTRY should <span class="italic">only</span> be used when the other database is lost or has been re-created. Any other use may leave the other database in an unrecoverable or inconsistent state.</p>
</div>
</div>
<!-- class="refsubsect" -->
<p>Before automatic recovery runs, the transaction may show up in <code dir="ltr">DBA_2PC_PENDING</code> as state &#34;collecting&#34;, &#34;committed&#34;, or &#34;prepared&#34;. If the DBA has forced an in-doubt transaction to have a particular result by using &#34;commit force&#34; or &#34;rollback force&#34;, then states &#34;forced commit&#34; or &#34;forced rollback&#34; may also appear. Automatic recovery normally deletes entries in any of these states. The only exception is when recovery finds a forced transaction which is in a state inconsistent with other sites in the transaction; in this case, the entry is left in the table and the <code dir="ltr">MIXED</code> column has the value &#39;yes&#39;.</p>
<p>However, under certain conditions, it may not be possible for automatic recovery to run. For example, a remote database may have been permanently lost. Even if it is re-created, it gets a new database ID, so that recovery cannot identify it (a possible symptom is <code dir="ltr">ORA-02062</code>). In this case, the DBA may use the procedure <code dir="ltr">PURGE_LOST_DB_ENTRY</code> to clean up the entries in any state other than &#34;prepared&#34;. The DBA does not need to be in any particular hurry to resolve these entries, because they are not holding any database resources.</p>
<p>The following table indicates what the various states indicate about the transaction and what the DBA actions should be:</p>
<div id="ARPLS68907" class="tblformal">
<p class="titleintable"><a id="sthref11933"></a><a id="sthref11934"></a>Table 168-6 PURGE_LOST_DB_ENTRY Procedure States</p>
<table class="cellalignment4330" title="PURGE_LOST_DB_ENTRY Procedure States " summary="This table describes Procedure States of PURGE_LOST_DB_ENTRY subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t9">State of Column</th>
<th class="cellalignment4328" id="r1c2-t9">State of Global Transaction</th>
<th class="cellalignment4328" id="r1c3-t9">State of Local Transaction</th>
<th class="cellalignment4328" id="r1c4-t9">Normal DBA Action</th>
<th class="cellalignment4328" id="r1c5-t9">Alternative DBA Action</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t9" headers="r1c1-t9">
<p><code dir="ltr">Collecting</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t9 r1c2-t9">
<p><code dir="ltr">Rolled back</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t9 r1c3-t9">
<p><code dir="ltr">Rolled back</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t9 r1c4-t9">
<p><code dir="ltr">None</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t9 r1c5-t9">
<p><code dir="ltr">PURGE_LOST_DB_ENTRY (See Note 1)</code></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r3c1-t9" headers="r1c1-t9">
<p><code dir="ltr">Committed</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t9 r1c2-t9">
<p><code dir="ltr">Committed</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t9 r1c3-t9">
<p><code dir="ltr">Committed</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t9 r1c4-t9">
<p><code dir="ltr">None</code></p>
</td>
<td class="cellalignment4329" headers="r3c1-t9 r1c5-t9">
<p><code dir="ltr">PURGE_LOST_DB_ENTRY (See Note 1)</code></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r4c1-t9" headers="r1c1-t9">
<p><code dir="ltr">Prepared</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t9 r1c2-t9">
<p><code dir="ltr">Unknown</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t9 r1c3-t9">
<p><code dir="ltr">Prepared</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t9 r1c4-t9">
<p><code dir="ltr">None</code></p>
</td>
<td class="cellalignment4329" headers="r4c1-t9 r1c5-t9">
<p><code dir="ltr">FORCE COMMIT or ROLLBACK</code></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r5c1-t9" headers="r1c1-t9">
<p><code dir="ltr">Forced commit</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t9 r1c2-t9">
<p><code dir="ltr">Unknown</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t9 r1c3-t9">
<p><code dir="ltr">Committed</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t9 r1c4-t9">
<p><code dir="ltr">None</code></p>
</td>
<td class="cellalignment4329" headers="r5c1-t9 r1c5-t9">
<p><code dir="ltr">PURGE_LOST_DB_ENTRY (See Note 1)</code></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r6c1-t9" headers="r1c1-t9">
<p><code dir="ltr">Forced rollback</code></p>
</td>
<td class="cellalignment4329" headers="r6c1-t9 r1c2-t9">
<p><code dir="ltr">Unknown</code></p>
</td>
<td class="cellalignment4329" headers="r6c1-t9 r1c3-t9">
<p><code dir="ltr">Rolled back</code></p>
</td>
<td class="cellalignment4329" headers="r6c1-t9 r1c4-t9">
<p><code dir="ltr">None</code></p>
</td>
<td class="cellalignment4329" headers="r6c1-t9 r1c5-t9">
<p><code dir="ltr">PURGE_LOST_DB_ENTRY (See Note 1)</code></p>
</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r7c1-t9" headers="r1c1-t9">
<p><code dir="ltr">Forced commit (mixed)</code></p>
</td>
<td class="cellalignment4329" headers="r7c1-t9 r1c2-t9">
<p><code dir="ltr">Mixed</code></p>
</td>
<td class="cellalignment4329" headers="r7c1-t9 r1c3-t9">
<p><code dir="ltr">Committed</code></p>
</td>
<td class="cellalignment4329" headers="r7c1-t9 r1c4-t9">
<p><code dir="ltr">(See Note 2)</code></p>
</td>
<td class="cellalignment4329" headers="r7c1-t9 r1c5-t9">&nbsp;</td>
</tr>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r8c1-t9" headers="r1c1-t9">
<p><code dir="ltr">Forced rollback (mixed)</code></p>
</td>
<td class="cellalignment4329" headers="r8c1-t9 r1c2-t9">
<p><code dir="ltr">Mixed</code></p>
</td>
<td class="cellalignment4329" headers="r8c1-t9 r1c3-t9">
<p><code dir="ltr">Rolled back</code></p>
</td>
<td class="cellalignment4329" headers="r8c1-t9 r1c4-t9">
<p><code dir="ltr">(See Note 2)</code></p>
</td>
<td class="cellalignment4329" headers="r8c1-t9 r1c5-t9">&nbsp;</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<div class="infobox-note">
<p class="notep1">NOTE 1:</p>
Use only if significant reconfiguration has occurred so that automatic recovery cannot resolve the transaction. Examples are total loss of the remote database, reconfiguration in software resulting in loss of two-phase commit capability, or loss of information from an external transaction coordinator such as a TP monitor.</div>
<div class="infobox-note">
<p class="notep1">NOTE 2:</p>
Examine and take any manual action to remove inconsistencies; then use the procedure <code dir="ltr">PURGE_MIXED</code>.</div>
</div>
<!-- class="refsect2" -->
<div id="ARPLS68908" class="refsect2"><a id="i1000748"></a>
<h3 class="refsect2"><a id="sthref11935"></a>PURGE_MIXED Procedure</h3>
<p>When in-doubt transactions are forced to commit or rollback (instead of letting automatic recovery resolve their outcomes), there is a possibility that a transaction can have a mixed outcome: Some sites commit, and others rollback. Such inconsistency cannot be resolved automatically by Oracle; however, Oracle flags entries in <code dir="ltr">DBA_2PC_PENDING</code> by setting the <code dir="ltr">MIXED</code> column to a value of &#39;yes&#39;.</p>
<p>Oracle never automatically deletes information about a mixed outcome transaction. When the application or DBA is certain that all inconsistencies that might have arisen as a result of the mixed transaction have been resolved, this procedure can be used to delete the information about a given mixed outcome transaction.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11936"></a>Syntax</p>
<pre dir="ltr">DBMS_TRANSACTION.PURGE_MIXED (
   xid VARCHAR2);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11937"></a>Parameters</p>
<div id="ARPLS68909" class="tblformal">
<p class="titleintable"><a id="sthref11938"></a><a id="sthref11939"></a>Table 168-7 PURGE_MIXED Procedure Parameters</p>
<table class="cellalignment4330" title="PURGE_MIXED Procedure Parameters " summary="This table describes the Parameters of DBMS_TRANSACTION.PURGE_MIXED subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t12">Parameter</th>
<th class="cellalignment4328" id="r1c2-t12">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t12" headers="r1c1-t12">
<p><code dir="ltr">xid</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t12 r1c2-t12">
<p>Must be set to the value of the <code dir="ltr">LOCAL_TRAN_ID</code> column in the <code dir="ltr">DBA_2PC_PENDING</code> table.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS68910" class="refsect2"><a id="i1000791"></a>
<h3 class="refsect2"><a id="sthref11940"></a>READ_ONLY Procedure</h3>
<p>This procedure is equivalent to the SQL statement:</p>
<pre dir="ltr">SET TRANSACTION READ ONLY
</pre>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11941"></a>Syntax</p>
<pre dir="ltr">DBMS_TRANSACTION.READ_ONLY;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS68911" class="refsect2"><a id="CIAEGFIB"></a>
<h3 class="refsect2"><a id="sthref11942"></a>READ_WRITE Procedure</h3>
<p>This procedure is equivalent to the SQL statement:</p>
<pre dir="ltr">SET TRANSACTION READ WRITE
</pre>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11943"></a>Syntax</p>
<pre dir="ltr">DBMS_TRANSACTION.READ_WRITE;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS68912" class="refsect2"><a id="i1000835"></a>
<h3 class="refsect2"><a id="sthref11944"></a>ROLLBACK Procedure</h3>
<p>This procedure is equivalent to the SQL statement:</p>
<pre dir="ltr">ROLLBACK
</pre>
<p>This procedure is included for completeness, the functionality being already implemented as part of PL/SQL.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11945"></a>Syntax</p>
<pre dir="ltr">DBMS_TRANSACTION.ROLLBACK;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS68913" class="refsect2"><a id="i1000863"></a>
<h3 class="refsect2"><a id="sthref11946"></a>ROLLBACK_FORCE Procedure</h3>
<p>This procedure is equivalent to the SQL statement:</p>
<pre dir="ltr">ROLLBACK FORCE &lt;text&gt;
</pre>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11947"></a>Syntax</p>
<pre dir="ltr">DBMS_TRANSACTION.ROLLBACK_FORCE (
   xid VARCHAR2);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11948"></a>Parameters</p>
<div id="ARPLS68914" class="tblformal">
<p class="titleintable"><a id="sthref11949"></a><a id="sthref11950"></a>Table 168-8 ROLLBACK_FORCE Procedure Parameters</p>
<table class="cellalignment4330" title="ROLLBACK_FORCE Procedure Parameters " summary="This table describes the Parameters of DBMS_TRANSACTION.ROLLBACK_FORCE subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t13">Parameter</th>
<th class="cellalignment4328" id="r1c2-t13">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t13" headers="r1c1-t13">
<p><code dir="ltr">xid</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t13 r1c2-t13">
<p>Local or global transaction ID.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS68915" class="refsect2"><a id="i1000909"></a>
<h3 class="refsect2"><a id="sthref11951"></a>ROLLBACK_SAVEPOINT Procedure</h3>
<p>This procedure is equivalent to the SQL statement:</p>
<pre dir="ltr">ROLLBACK TO SAVEPOINT &lt;savepoint_name&gt;
</pre>
<p>This procedure is included for completeness, the functionality being already implemented as part of PL/SQL.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11952"></a>Syntax</p>
<pre dir="ltr">DBMS_TRANSACTION.ROLLBACK_SAVEPOINT (
   savept VARCHAR2);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11953"></a>Parameters</p>
<div id="ARPLS68916" class="tblformal">
<p class="titleintable"><a id="sthref11954"></a><a id="sthref11955"></a>Table 168-9 ROLLBACK_SAVEPOINT Procedure Parameters</p>
<table class="cellalignment4330" title="ROLLBACK_SAVEPOINT Procedure Parameters " summary="This table describes the Parameters of DBMS_TRANSACTION.ROLLBACK_SAVEPOINT subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t14">Parameter</th>
<th class="cellalignment4328" id="r1c2-t14">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t14" headers="r1c1-t14">
<p><code dir="ltr">savept</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t14 r1c2-t14">
<p>Savepoint identifier.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS68917" class="refsect2"><a id="i997017"></a>
<h3 class="refsect2"><a id="sthref11956"></a>SAVEPOINT Procedure</h3>
<p>This procedure is equivalent to the SQL statement:</p>
<pre dir="ltr">SAVEPOINT &lt;savepoint_name&gt;
</pre>
<p>This procedure is included for completeness, the feature being already implemented as part of PL/SQL.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11957"></a>Syntax</p>
<pre dir="ltr">DBMS_TRANSACTION.SAVEPOINT (
   savept VARCHAR2);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11958"></a>Parameters</p>
<div id="ARPLS68918" class="tblformal">
<p class="titleintable"><a id="sthref11959"></a><a id="sthref11960"></a>Table 168-10 SAVEPOINT Procedure Parameters</p>
<table class="cellalignment4330" title="SAVEPOINT Procedure Parameters " summary="This table describes the Parameters of DBMS_TRANSACTION.SAVEPOINT subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t15">Parameter</th>
<th class="cellalignment4328" id="r1c2-t15">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t15" headers="r1c1-t15">
<p><code dir="ltr">savept</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t15 r1c2-t15">
<p>Savepoint identifier.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS68919" class="refsect2"><a id="i1000520"></a>
<h3 class="refsect2"><a id="sthref11961"></a>STEP_ID Function</h3>
<p>This function returns local (to local transaction) unique positive integer that orders the DML operations of a transaction.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11962"></a>Syntax</p>
<pre dir="ltr">DBMS_TRANSACTION.STEP_ID 
   RETURN NUMBER;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS68920" class="refsect2"><a id="i1000982"></a>
<h3 class="refsect2"><a id="sthref11963"></a>USE_ROLLBACK_SEGMENT Procedure</h3>
<p>This procedure is equivalent to the SQL statement:</p>
<pre dir="ltr">SET TRANSACTION USE ROLLBACK SEGMENT &lt;rb_seg_name&gt;
</pre>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11964"></a>Syntax</p>
<pre dir="ltr">DBMS_TRANSACTION.USE_ROLLBACK_SEGMENT (
   rb_name VARCHAR2);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref11965"></a>Parameters</p>
<div id="ARPLS68921" class="tblformal">
<p class="titleintable"><a id="sthref11966"></a><a id="sthref11967"></a>Table 168-11 USE_ROLLBACK_SEGMENT Procedure Parameters</p>
<table class="cellalignment4330" title="USE_ROLLBACK_SEGMENT Procedure Parameters " summary="This table describes the Parameters of DBMS_TRANSACTION.USE_ROLLBACK_SEGMENT subprogram." dir="ltr">
<thead>
<tr class="cellalignment4321">
<th class="cellalignment4328" id="r1c1-t16">Parameter</th>
<th class="cellalignment4328" id="r1c2-t16">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4321">
<td class="cellalignment4329" id="r2c1-t16" headers="r1c1-t16">
<p><code dir="ltr">rb_name</code></p>
</td>
<td class="cellalignment4329" headers="r2c1-t16 r1c2-t16">
<p>Name of rollback segment to use.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" --></div>
<!-- class="refentry" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment4320">
<tr>
<td class="cellalignment4329">
<table class="cellalignment4325">
<tr>
<td class="cellalignment4324"><a href="d_trace.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment4324"><a href="d_transf.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment4332">
<table class="cellalignment4323">
<tr>
<td class="cellalignment4324"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment4324"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment4324"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment4324"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment4324"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment4324"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>