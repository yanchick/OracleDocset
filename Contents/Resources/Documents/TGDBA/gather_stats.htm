<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-106614"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Gathering%20Database%20Statistics"></a><title>Gathering Database Statistics</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="dcterms.created" content="2017-01-18T01:24:57Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Performance Tuning Guide"/>
<meta name="dcterms.identifier" content="E49058-08"/>
<meta name="dcterms.isVersionOf" content="TGDBA"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2013, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="measure_db.htm" title="Previous" type="text/html"/>
<link rel="Next" href="pfgrf_diag.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E49058-08.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-CBB1716F-2B20-4575-ADCE-94E33BEA53EF"></a> <span id="PAGE" style="display:none;">12/27</span> <!-- End Header -->
<a id="TGDBA167"></a>
<h1 id="TGDBA-GUID-CBB1716F-2B20-4575-ADCE-94E33BEA53EF" class="sect1"><span class="enumeration_chapter">6</span> Gathering Database Statistics</h1>
<div>
<p>This chapter describes how to gather database statistics for Oracle Database and contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="gather_stats.htm#GUID-56AEF38E-9400-427B-A818-EDEC145F7ACD">About Gathering Database Statistics</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-9D3A3890-8E68-48C5-84D0-DB0A8D93C53A">Managing the Automatic Workload Repository</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-9BFC6383-6C4F-4103-A2CB-4713802F2669">Generating Automatic Workload Repository Reports</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-23061F14-767D-47B6-9B45-D1E26FB1E075">Generating Performance Hub Active Report</a></p>
</li>
</ul>
</div>
<a id="TGDBA168"></a>
<div class="props_rev_3"><a id="GUID-56AEF38E-9400-427B-A818-EDEC145F7ACD"></a>
<h2 id="TGDBA-GUID-56AEF38E-9400-427B-A818-EDEC145F7ACD" class="sect2">About Gathering Database Statistics</h2>
<div>
<p>Oracle Database automatically persists the cumulative and delta values for most of the statistics at all levels (except the session level) in the Automatic Workload Repository (AWR). This process is repeated on a regular time period and the results are captured in an AWR snapshot. The delta values captured by the snapshot represent the changes for each statistic over the time period.</p>
<p>A statistical <a id="d10800e93" class="indexterm-anchor"></a><a id="d10800e97" class="indexterm-anchor"></a>baseline is a collection of statistic rates usually taken over a time period when the system is performing well at an optimal level. Use statistical baselines to diagnose performance problems by comparing statistics captured in a baseline to those captured during a period of poor performance. This enables you to identify specific statistics that may have increased significantly and could be the cause of the problem. AWR supports the capture of baseline data by enabling you to specify and preserve a pair or range of AWR snapshots as a baseline.</p>
<p>A <a id="d10800e104" class="indexterm-anchor"></a>metric is typically the rate of change in a cumulative statistic. You can measure this rate against a variety of units, including time, transactions, or database calls. For example, the number database calls per second is a metric. Metric values are exposed in some <code>V$</code> views, where the values are the averages over a fairly small time interval, typically 60 seconds. A history of recent metric values is available through <code>V$</code> views, and some data is also persisted by AWR snapshots.</p>
<p>The following sections describe various Oracle Database features that enable you to more effectively gather database statistics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="gather_stats.htm#GUID-CE73D449-0EE9-4022-B1F1-AA12F0955C03">Automatic Workload Repository</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-A64AE148-DFB9-4B5F-BAA8-6A4A575E79DF">Snapshots</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-C6401C10-F958-4339-99C2-3320BDAB4CEA">Baselines</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-6C74FDE0-FF92-4605-82DB-9FA598E59407">Space Consumption</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-6450312A-8894-4648-8DC3-83C83F6995F3">Adaptive Thresholds</a></p>
</li>
</ul>
<div class="infobox-note" id="GUID-56AEF38E-9400-427B-A818-EDEC145F7ACD__GUID-9B1DA07F-EC37-4FB4-A9B7-E543BD114AA2">
<p class="notep1">Note:</p>
<p>Use of AWR features described in this chapter requires licensing of the Oracle Diagnostic Pack.</p>
</div>
<div class="infobox-note" id="GUID-56AEF38E-9400-427B-A818-EDEC145F7ACD__GUID-BF0499FC-CEF3-40F0-9526-36EAC0E0BAB4">
<p class="notep1">Note:</p>
<p>Data visibility and privilege requirements may differ when using AWR features with pluggable databases (PDBs). For information about how manageability features&mdash;including AWR features&mdash;work in a multitenant container database (CDB), see <a class="olink ADMIN13885" target="_blank" href="../ADMIN/cdb_admin.htm#ADMIN13885"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a>.</p>
</div>
</div>
<a id="TGDBA169"></a>
<div class="props_rev_3"><a id="GUID-CE73D449-0EE9-4022-B1F1-AA12F0955C03"></a>
<h3 id="TGDBA-GUID-CE73D449-0EE9-4022-B1F1-AA12F0955C03" class="sect3">Automatic Workload Repository</h3>
<div>
<p><a id="d10800e187" class="indexterm-anchor"></a>AWR collects, processes, and maintains performance statistics for problem detection and self-tuning purposes. This gathered data is stored both in memory and in the database, and is displayed in both reports and views.</p>
<p><a id="d10800e193" class="indexterm-anchor"></a>The statistics collected and processed by AWR include:</p>
<ul style="list-style-type: disc;">
<li>
<p>Object statistics that determine both access and usage statistics of database segments</p>
</li>
<li>
<p>Time model statistics based on time usage for activities, displayed in the <code>V$SYS_TIME_MODEL</code> and <code>V$SESS_TIME_MODEL</code> views</p>
</li>
<li>
<p>Some of the system and session statistics collected in the <code>V$SYSSTAT</code> and <code>V$SESSTAT</code> views</p>
</li>
<li>
<p>SQL statements that are producing the highest load on the system, based on criteria such as elapsed time and CPU time</p>
</li>
<li>
<p>Active Session History (ASH) statistics, representing the history of recent sessions activity</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-CE73D449-0EE9-4022-B1F1-AA12F0955C03__GUID-FA71697E-E16C-40EA-8CF0-EFD0C55EA8DE">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="measure_db.htm#GUID-D106A7A3-1B96-47E7-883C-2BB0F11567E1">About Database Statistics</a>&#34;</span> for information about the various types of database statistics</p>
</li>
<li>
<p><a class="olink REFRN" target="_blank" href="../REFRN/toc.htm"><span class="italic">Oracle Database Reference</span></a> for information about the views</p>
</li>
</ul>
</div>
</div>
</div>
<a id="TGDBA170"></a>
<div class="props_rev_3"><a id="GUID-A64AE148-DFB9-4B5F-BAA8-6A4A575E79DF"></a>
<h3 id="TGDBA-GUID-A64AE148-DFB9-4B5F-BAA8-6A4A575E79DF" class="sect3">Snapshots</h3>
<div>
<p><a id="d10800e277" class="indexterm-anchor"></a>Snapshots are sets of historical data for specific time periods that are used for performance comparisons by Automatic Database Diagnostic Monitor (ADDM). By default, Oracle Database automatically generates snapshots of the performance data once every hour and retains the statistics in AWR for 8 days. You can also manually create snapshots or change the snapshot retention period, but it is usually not necessary.</p>
<p>AWR compares the difference between snapshots to determine which SQL statements to capture based on the effect on the system load. This reduces the number of SQL statements that must be captured over time. After the snapshots are created, ADDM analyzes the data captured in the snapshots to perform its performance analysis.</p>
<div class="infoboxnotealso" id="GUID-A64AE148-DFB9-4B5F-BAA8-6A4A575E79DF__GUID-8828CE63-56E1-4349-BF30-BEC434C492A3">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="gather_stats.htm#GUID-144711F9-85AE-4281-B548-3E01280F9A56">Managing Snapshots</a>&#34;</span> for information about managing snapshots</p>
</div>
</div>
</div>
<a id="TGDBA171"></a>
<div class="props_rev_3"><a id="GUID-C6401C10-F958-4339-99C2-3320BDAB4CEA"></a>
<h3 id="TGDBA-GUID-C6401C10-F958-4339-99C2-3320BDAB4CEA" class="sect3">Baselines</h3>
<div>
<p>A <a id="d10800e328" class="indexterm-anchor"></a>baseline is a set of snapshots from a specific time period that is preserved for comparison with other snapshots when a performance problem occurs. The snapshots contained in a baseline are excluded from the automatic AWR purging process and are retained indefinitely.</p>
<p>There are several types of available baselines:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="gather_stats.htm#GUID-9855A86D-0A2C-413B-8980-490E96A062B3">Fixed Baselines</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-91C614C3-5B49-4DD9-90B5-A38F3D6AAD62">Moving Window Baselines</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-BC0E898A-5AE3-4305-9F74-C24EE5F288DF">Baseline Templates</a></p>
</li>
</ul>
</div>
<a id="TGDBA172"></a>
<div class="props_rev_3"><a id="GUID-9855A86D-0A2C-413B-8980-490E96A062B3"></a>
<h4 id="TGDBA-GUID-9855A86D-0A2C-413B-8980-490E96A062B3" class="sect4">Fixed Baselines</h4>
<div>
<p>A fixed baseline corresponds to a fixed, contiguous time period in the past that you specify. Before creating a fixed baseline, carefully consider the time period you choose as a baseline, because the baseline should represent the system operating at an optimal level. In the future, you can compare the baseline with other baselines or snapshots captured during periods of poor performance to analyze performance degradation over time.</p>
<div class="infoboxnotealso" id="GUID-9855A86D-0A2C-413B-8980-490E96A062B3__GUID-15C41FDC-ECE0-446E-B7E1-E5B537B3A00A">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="gather_stats.htm#GUID-44811EF8-D082-487F-8EEC-DA6E78700E68">Managing Baselines</a>&#34;</span> for information about managing fixed baselines</p>
</div>
</div>
</div>
<a id="TGDBA173"></a>
<div class="props_rev_3"><a id="GUID-91C614C3-5B49-4DD9-90B5-A38F3D6AAD62"></a>
<h4 id="TGDBA-GUID-91C614C3-5B49-4DD9-90B5-A38F3D6AAD62" class="sect4">Moving Window Baselines</h4>
<div>
<p>A moving window baseline corresponds to all AWR data that exists within the AWR retention period. This is useful when using adaptive thresholds because the database can use AWR data in the entire AWR retention period to compute metric threshold values.</p>
<p>Oracle Database automatically maintains a system-defined moving window baseline. The default window size for the system-defined moving window baseline is the current AWR retention period, which by default is 8 days. If you are planning to use adaptive thresholds, then consider using a larger moving window&mdash;such as 30 days&mdash;to accurately compute threshold values. You can resize the moving window baseline by changing the number of days in the moving window to a value that is equal to or less than the number of days in the AWR retention period. Therefore, to increase the size of a moving window, you must first increase the AWR retention period accordingly.</p>
<div class="infoboxnotealso" id="GUID-91C614C3-5B49-4DD9-90B5-A38F3D6AAD62__GUID-610550A1-6F5D-4E73-A4C8-DEB5796BFFFC">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="gather_stats.htm#GUID-FFB695C6-E57A-487D-898A-EDAF0ECDD881">Resizing the Default Moving Window Baseline</a>&#34;</span> for information about resizing a moving window baseline</p>
</div>
</div>
</div>
<a id="TGDBA174"></a>
<div class="props_rev_3"><a id="GUID-BC0E898A-5AE3-4305-9F74-C24EE5F288DF"></a>
<h4 id="TGDBA-GUID-BC0E898A-5AE3-4305-9F74-C24EE5F288DF" class="sect4">Baseline Templates</h4>
<div>
<p>Baseline templates enable you to create baselines for a contiguous time period in the future. There are two types of baseline templates:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="gather_stats.htm#GUID-55C09FAB-9DCD-4EC8-BE2F-5B99125387B7">Single Baseline Templates</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-A07D8B81-2451-4513-8885-42504DD680C1">Repeating Baseline Templates</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-BC0E898A-5AE3-4305-9F74-C24EE5F288DF__GUID-19B6C0FB-9FCF-4F16-ABBF-24E5EEFACD3C">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="gather_stats.htm#GUID-B5DB2422-951F-4D00-A473-AB6739ECC88B">Managing Baseline Templates</a>&#34;</span> for information about managing baseline templates</p>
</div>
</div>
<a id="TGDBA175"></a>
<div class="props_rev_3"><a id="GUID-55C09FAB-9DCD-4EC8-BE2F-5B99125387B7"></a>
<h5 id="TGDBA-GUID-55C09FAB-9DCD-4EC8-BE2F-5B99125387B7" class="sect5">Single Baseline Templates</h5>
<div>
<p>Use a single baseline template to create a baseline for a single contiguous time period in the future. This is useful if you know beforehand of a time period that you intend to capture in the future. For example, you may want to capture AWR data during a system test that is scheduled for the upcoming weekend. In this case, you can create a single baseline template to automatically capture the time period when the test occurs.</p>
</div>
</div>
<a id="TGDBA176"></a>
<div class="props_rev_3"><a id="GUID-A07D8B81-2451-4513-8885-42504DD680C1"></a>
<h5 id="TGDBA-GUID-A07D8B81-2451-4513-8885-42504DD680C1" class="sect5">Repeating Baseline Templates</h5>
<div>
<p>Use a repeating baseline template to create and drop baselines based on a repeating time schedule. This is useful if you want Oracle Database to automatically capture a contiguous time period on an ongoing basis. For example, you may want to capture AWR data during every Monday morning for a month. In this case, you can create a repeating baseline template to automatically create baselines on a repeating schedule for every Monday, and automatically remove older baselines after a specified expiration interval, such as one month.</p>
</div>
</div>
</div>
</div>
<a id="TGDBA187"></a>
<div class="props_rev_3"><a id="GUID-6C74FDE0-FF92-4605-82DB-9FA598E59407"></a>
<h3 id="TGDBA-GUID-6C74FDE0-FF92-4605-82DB-9FA598E59407" class="sect3">Space Consumption</h3>
<div>
<p><a id="d10800e599" class="indexterm-anchor"></a>The space consumed by AWR is determined by several factors:</p>
<ul style="list-style-type: disc;">
<li>
<p>Number of active sessions in the database at any given time</p>
</li>
<li>
<p>Snapshot interval</p>
<p>The snapshot interval determines the frequency at which snapshots are captured. A smaller snapshot interval increases the frequency, which increases the volume of data collected by AWR.</p>
</li>
<li>
<p>Historical data retention period</p>
<p>The retention period determines how long this data is retained before being purged. A longer retention period increases the space consumed by AWR.</p>
</li>
</ul>
<p><a id="d10800e619" class="indexterm-anchor"></a><a id="d10800e623" class="indexterm-anchor"></a><a id="d10800e627" class="indexterm-anchor"></a>By default, Oracle Database captures snapshots once every hour and retains them in the database for 8 days. With these default settings, a typical system with an average of 10 concurrent active sessions can require approximately 200 to 300 MB of space for its AWR data.</p>
<p>To reduce <a id="d10800e634" class="indexterm-anchor"></a>AWR space consumption, increase the snapshot interval and reduce the retention period. When reducing the retention period, note that several Oracle Database self-managing features depend on AWR data for proper functioning. Not having enough data can affect the validity and accuracy of these components and features, including:</p>
<ul style="list-style-type: disc;">
<li>
<p>Automatic Database Diagnostic Monitor (ADDM)</p>
</li>
<li>
<p>SQL Tuning Advisor</p>
</li>
<li>
<p>Undo Advisor</p>
</li>
<li>
<p>Segment Advisor</p>
</li>
</ul>
<p><a id="d10800e653" class="indexterm-anchor"></a>If possible, Oracle recommends that you set the AWR retention period large enough to capture at least one complete workload cycle. If your system experiences weekly workload cycles&mdash;such as OLTP workload during weekdays and batch jobs during the weekend&mdash;then you do not need to change the default AWR retention period of 8 days. However, if your system is subjected to a monthly peak load during month-end book closing, then you may need to set the retention period to one month.</p>
<p><a id="d10800e659" class="indexterm-anchor"></a>Under exceptional circumstances, you can disable automatic snapshot collection by setting the snapshot interval to 0. Under this condition, the automatic collection of the workload and statistical data is stopped, and most of the Oracle Database self-management functionality is not operational. In addition, you cannot manually create snapshots. For this reason, Oracle strongly recommends against disabling automatic snapshot collection.</p>
<div class="infoboxnotealso" id="GUID-6C74FDE0-FF92-4605-82DB-9FA598E59407__GUID-A6447C91-65FB-47F4-BB53-2C2327B177D4">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="gather_stats.htm#GUID-62D01B30-2687-4821-A651-DC0E4AAC3B01">Modifying Snapshot Settings</a>&#34;</span> for information about changing the default values for the snapshot interval and retention period</p>
</div>
</div>
</div>
<a id="TGDBA177"></a>
<div class="props_rev_3"><a id="GUID-6450312A-8894-4648-8DC3-83C83F6995F3"></a>
<h3 id="TGDBA-GUID-6450312A-8894-4648-8DC3-83C83F6995F3" class="sect3">Adaptive Thresholds</h3>
<div>
<p>Adaptive thresholds enable you to monitor and detect performance issues, while minimizing administrative overhead. Adaptive thresholds automatically set warning and critical alert thresholds for some system metrics using statistics derived from metric values captured in the moving window baseline. The statistics for these thresholds are recomputed weekly and might result in new thresholds as system performance evolves over time. Additionally, adaptive thresholds can compute different thresholds values for different times of the day or week based on periodic workload patterns.</p>
<p>For example, many databases support an online transaction processing (OLTP) workload during the day and batch processing at night. The performance metric for response time per transaction can be useful for detecting degradation in OLTP performance during the day. However, a useful OLTP threshold value is usually too low for batch workloads, where long-running transactions might be common. As a result, threshold values appropriate to OLTP might trigger frequent false performance alerts during batch processing. Adaptive thresholds can detect such a workload pattern and automatically set different threshold values for daytime and nighttime.</p>
<p>There are two types of adaptive thresholds:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="gather_stats.htm#GUID-5B32060C-1752-4ACC-AB45-1CBE76DE53E9">Percentage of Maximum Thresholds</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-145777F9-E316-4663-B847-042F2A85B144">Significance Level Thresholds</a></p>
</li>
</ul>
</div>
<a id="TGDBA178"></a>
<div class="props_rev_3"><a id="GUID-5B32060C-1752-4ACC-AB45-1CBE76DE53E9"></a>
<h4 id="TGDBA-GUID-5B32060C-1752-4ACC-AB45-1CBE76DE53E9" class="sect4">Percentage of Maximum Thresholds</h4>
<div>
<p>The threshold value for percentage of maximum thresholds is computed as a percentage multiple of the maximum value observed for the data in the moving window baseline.</p>
<p>Percentage of maximum thresholds are most useful when a system is sized for peak workloads, and you want to be alerted when the current workload volume approaches or exceeds previous high values. Metrics that have an unknown but definite limiting value are prime candidates for these settings. For example, the redo generated per second metric is typically a good candidate for a percentage of maximum threshold.</p>
</div>
</div>
<a id="TGDBA179"></a>
<div class="props_rev_3"><a id="GUID-145777F9-E316-4663-B847-042F2A85B144"></a>
<h4 id="TGDBA-GUID-145777F9-E316-4663-B847-042F2A85B144" class="sect4">Significance Level Thresholds</h4>
<div>
<p>The threshold value for significance level thresholds is set to a statistical percentile that represents how unusual it is to observe values above the threshold value based the data in the moving window baseline.</p>
<p>Significance level thresholds are most useful for metrics that exhibit statistically stable behavior when the system is operating normally, but might vary over a wide range when the system is performing poorly. For example, the response time per transaction metric should be stable for a well-tuned OLTP system, but may fluctuate widely when performance issues arise. Significance level thresholds are meant to generate alerts when conditions produce both unusual metric values and unusual system performance.</p>
<p>Significance level thresholds can be set to one of the following levels:</p>
<ul style="list-style-type: disc;">
<li>
<p>High (.95)</p>
<p>Only 5 in 100 observations are expected to exceed this value.</p>
</li>
<li>
<p>Very High (.99)</p>
<p>Only 1 in 100 observations are expected to exceed this value.</p>
</li>
<li>
<p>Severe (.999)</p>
<p>Only 1 in 1,000 observations are expected to exceed this value.</p>
</li>
<li>
<p>Extreme (.9999)</p>
<p>Only 1 in 10,000 observations are expected to exceed this value.</p>
</li>
</ul>
<p>When you specify a significance level threshold, Oracle Database performs an internal calculation to set the threshold value. In some cases, Oracle Database cannot establish the threshold value at higher significance levels using the data in the baseline, and the significance level threshold is not set.</p>
<p>If you specified a Severe (.999) or Extreme (.9999) significance level threshold and are not receiving alerts as expected, try setting the significance level threshold to a lower value, such as Very High (.99) or High (.95). Alternatively, consider using a percentage of maximum threshold instead. If you change the threshold and find that you are receiving too many alerts, try increasing the number of occurrences to trigger an alert.</p>
<div class="infobox-note" id="GUID-145777F9-E316-4663-B847-042F2A85B144__GUID-81E67E00-D34E-41C8-92E1-C6303C179B47">
<p class="notep1">Note:</p>
<p>The primary interface for managing baseline metrics is Oracle Enterprise Manager. To create an adaptive threshold for a baseline metric, use Oracle Enterprise Manager, as described in <a class="olink TDPPT334" target="_blank" href="../TDPPT/tdppt_degrade.htm#TDPPT334"><span class="italic">Oracle Database 2 Day + Performance Tuning Guide</span></a>.</p>
</div>
<div class="infoboxnotealso" id="GUID-145777F9-E316-4663-B847-042F2A85B144__GUID-F36B9899-CC9C-43FE-B6D1-7C9FC764219F">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="gather_stats.htm#GUID-91C614C3-5B49-4DD9-90B5-A38F3D6AAD62">Moving Window Baselines</a>&#34;</span> for information about moving window baselines</p>
</li>
<li>
<p><span class="q">&#34;<a href="gather_stats.htm#GUID-44811EF8-D082-487F-8EEC-DA6E78700E68">Managing Baselines</a>&#34;</span> for information about managing baseline metrics</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<a id="TGDBA185"></a>
<div class="props_rev_3"><a id="GUID-9D3A3890-8E68-48C5-84D0-DB0A8D93C53A"></a>
<h2 id="TGDBA-GUID-9D3A3890-8E68-48C5-84D0-DB0A8D93C53A" class="sect2">Managing the Automatic Workload Repository</h2>
<div>
<p>This section describes how to manage AWR features of Oracle Database and contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="gather_stats.htm#GUID-26D359FA-F809-4444-907C-B5AFECD9AE29">Enabling the Automatic Workload Repository</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-144711F9-85AE-4281-B548-3E01280F9A56">Managing Snapshots</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-44811EF8-D082-487F-8EEC-DA6E78700E68">Managing Baselines</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-B5DB2422-951F-4D00-A473-AB6739ECC88B">Managing Baseline Templates</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-F25470A0-C236-46DE-84F7-D68FBE1B0F12">Transporting Automatic Workload Repository Data</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-18E1B278-B3C5-4FE1-8E51-BC8878C439F5">Using Automatic Workload Repository Views</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-9D3A3890-8E68-48C5-84D0-DB0A8D93C53A__GUID-34657870-039E-4272-822B-29466028668F">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="gather_stats.htm#GUID-CE73D449-0EE9-4022-B1F1-AA12F0955C03">Automatic Workload Repository</a>&#34;</span> for a description of AWR</p>
</div>
</div>
<a id="TGDBA186"></a>
<div class="props_rev_3"><a id="GUID-26D359FA-F809-4444-907C-B5AFECD9AE29"></a>
<h3 id="TGDBA-GUID-26D359FA-F809-4444-907C-B5AFECD9AE29" class="sect3">Enabling the Automatic Workload Repository</h3>
<div>
<div class="section">
<p><a id="d10800e959" class="indexterm-anchor"></a>Gathering database statistics using AWR is enabled by default and is controlled by the <code>STATISTICS_LEVEL</code> initialization parameter.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To enable statistics gathering by AWR:</p>
<ul style="list-style-type: disc;">
<li>
<p>Set the <code>STATISTICS_LEVEL</code> parameter to <code>TYPICAL</code> or <code>ALL</code>.</p>
<p>The default setting for this parameter is <code>TYPICAL</code>.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p>Setting <code>STATISTICS_LEVEL</code> to <code>BASIC</code> disables many Oracle Database features, including AWR, and is not recommended. If <code>STATISTICS_LEVEL</code> is set to <code>BASIC</code>, you can still manually capture AWR statistics using the <code>DBMS_WORKLOAD_REPOSITORY</code> package. However, because in-memory collection of many system statistics&mdash;such as segments statistics and memory advisor information&mdash;will be disabled, the statistics captured in these snapshots may not be complete.</p>
<div class="infoboxnotealso" id="GUID-26D359FA-F809-4444-907C-B5AFECD9AE29__GUID-9DC1D01A-774D-4DC0-A429-40884F4A4E90">
<p class="notep1">See Also:</p>
<p><a class="olink REFRN10214" target="_blank" href="../REFRN/GUID-16B23F95-8644-407A-A6C8-E85CADFA61FF.htm#REFRN10214"><span class="italic">Oracle Database Reference</span></a> for information about the <code>STATISTICS_LEVEL</code> initialization parameter</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="TGDBA188"></a>
<div class="props_rev_3"><a id="GUID-144711F9-85AE-4281-B548-3E01280F9A56"></a>
<h3 id="TGDBA-GUID-144711F9-85AE-4281-B548-3E01280F9A56" class="sect3">Managing Snapshots</h3>
<div>
<p>By default, Oracle Database generates snapshots once every hour, and retains the statistics in the workload repository for 8 days. When necessary, you can manually create or drop snapshots and modify snapshot settings.</p>
<p>This section describes how to manage snapshots and contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="gather_stats.htm#GUID-1BD04654-3D24-42DA-96A5-9FCAED77439D">User Interfaces for Managing Snapshots</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-70A79E56-18AB-4E85-9494-C0C8F02320AF">Creating Snapshots</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-542ED7D0-ABED-48F4-9D2F-5DADEB610249">Dropping Snapshots</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-62D01B30-2687-4821-A651-DC0E4AAC3B01">Modifying Snapshot Settings</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-144711F9-85AE-4281-B548-3E01280F9A56__GUID-E0B4A412-24D7-4C75-BB17-0DFB5643F7A7">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="gather_stats.htm#GUID-A64AE148-DFB9-4B5F-BAA8-6A4A575E79DF">Snapshots</a>&#34;</span> for information about snapshots</p>
</div>
</div>
<a id="TGDBA189"></a>
<div class="props_rev_3"><a id="GUID-1BD04654-3D24-42DA-96A5-9FCAED77439D"></a>
<h4 id="TGDBA-GUID-1BD04654-3D24-42DA-96A5-9FCAED77439D" class="sect4">User Interfaces for Managing Snapshots</h4>
<div>
<p>The primary interface for managing snapshots is Oracle Enterprise Manager. Whenever possible, you should manage snapshots using Oracle Enterprise Manager.</p>
<p>If Oracle Enterprise Manager is unavailable, then manage snapshots using the <code>DBMS_WORKLOAD_REPOSITORY</code> package in the command-line interface. The DBA role is required to invoke the <code>DBMS_WORKLOAD_REPOSITORY</code> procedures.</p>
<div class="infoboxnotealso" id="GUID-1BD04654-3D24-42DA-96A5-9FCAED77439D__GUID-B1F12ADB-CFAC-4100-9F8F-924398E299F3">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS093" target="_blank" href="../ARPLS/d_workload_repos.htm#ARPLS093"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the <code>DBMS_WORKLOAD_REPOSITORY</code> package</p>
</div>
</div>
</div>
<a id="TGDBA665"></a><a id="TGDBA190"></a>
<div class="props_rev_3"><a id="GUID-70A79E56-18AB-4E85-9494-C0C8F02320AF"></a>
<h4 id="TGDBA-GUID-70A79E56-18AB-4E85-9494-C0C8F02320AF" class="sect4">Creating Snapshots</h4>
<div>
<div class="section">
<p>By default, Oracle Database automatically generates snapshots once every hour. However, you may want to manually create snapshots to capture statistics at times different from those of the automatically generated snapshots.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Creating Snapshots Using the Command-Line Interface</p>
<p>To manually create snapshots, use the <code>CREATE_SNAPSHOT</code> procedure.</p>
<p><a href="gather_stats.htm#GUID-70A79E56-18AB-4E85-9494-C0C8F02320AF__CIHJAGIJ">Example 6-1</a> shows a <code>CREATE_SNAPSHOT</code> procedure call.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-70A79E56-18AB-4E85-9494-C0C8F02320AF__CIHJAGIJ">
<p class="titleinexample">Example 6-1 Using the CREATE_SNAPSHOT Procedure</p>
<pre dir="ltr">BEGIN
  DBMS_WORKLOAD_REPOSITORY.CREATE_SNAPSHOT ();
END;
/
</pre>
<p>In this example, a snapshot is created immediately on the local database instance with the flush level specified to the default flush level of <code>TYPICAL</code>. To view information about the newly created snapshot (and any existing snapshots), use the <code>DBA_HIST_SNAPSHOT</code> view.</p>
<div class="infoboxnotealso" id="GUID-70A79E56-18AB-4E85-9494-C0C8F02320AF__GUID-4CA05C3A-7AF1-471A-95A0-DD44AD33365E">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink ARPLS093" target="_blank" href="../ARPLS/d_workload_repos.htm#ARPLS093"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the <code>DBMS_WORKLOAD_REPOSITORY</code> package</p>
</li>
<li>
<p><a class="olink REFRN23442" target="_blank" href="../REFRN/GUID-542B6CA6-793B-4D15-AAFD-4D3E6550C0B6.htm#REFRN23442"><span class="italic">Oracle Database Reference</span></a> for information about the <code>DBA_HIST_SNAPSHOT</code> view</p>
</li>
</ul>
</div>
</div>
<!-- class="example" --></div>
</div>
<a id="TGDBA666"></a><a id="TGDBA193"></a>
<div class="props_rev_3"><a id="GUID-542ED7D0-ABED-48F4-9D2F-5DADEB610249"></a>
<h4 id="TGDBA-GUID-542ED7D0-ABED-48F4-9D2F-5DADEB610249" class="sect4">Dropping Snapshots</h4>
<div>
<div class="section">
<p>By default, Oracle Database automatically purges snapshots that have been stored in AWR for over 8 days. However, you may want to manually drop a range of snapshots to free up space.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Dropping Snapshots Using the Command-Line Interface</p>
<p>To manually drop a range of snapshots, use the <code>DROP_SNAPSHOT_RANGE</code> procedure.</p>
<p><a href="gather_stats.htm#GUID-542ED7D0-ABED-48F4-9D2F-5DADEB610249__CIHJGHJF">Example 6-2</a> shows a <code>DROP_SNAPSHOT_RANGE</code> procedure call.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-542ED7D0-ABED-48F4-9D2F-5DADEB610249__CIHJGHJF">
<p class="titleinexample">Example 6-2 Using the DROP_SNAPSHOT_RANGE Procedure</p>
<pre dir="ltr">BEGIN
  DBMS_WORKLOAD_REPOSITORY.DROP_SNAPSHOT_RANGE (low_snap_id =&gt; 22, 
                           high_snap_id =&gt; 32, dbid =&gt; 3310949047);
END;
/
</pre>
<p>In the example, snapshots with snapshot IDs ranging from 22 to 32 are dropped immediately from the database instance with the database identifier of <code>3310949047</code>. Any ASH data that were captured during this snapshot range are also purged.</p>
<div class="infoboxnotealso" id="GUID-542ED7D0-ABED-48F4-9D2F-5DADEB610249__GUID-DA1A705C-E218-413A-923D-05723486B2E1">
<p class="notep1">Tip:</p>
<p>To determine which snapshots to drop, use the <code>DBA_HIST_SNAPSHOT</code> view to review the existing snapshots</p>
</div>
<div class="infoboxnotealso" id="GUID-542ED7D0-ABED-48F4-9D2F-5DADEB610249__GUID-FAE546F9-C537-4811-B807-B24B3B746FF1">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink ARPLS093" target="_blank" href="../ARPLS/d_workload_repos.htm#ARPLS093"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the <code>DBMS_WORKLOAD_REPOSITORY</code> package</p>
</li>
<li>
<p><a class="olink REFRN23442" target="_blank" href="../REFRN/GUID-542B6CA6-793B-4D15-AAFD-4D3E6550C0B6.htm#REFRN23442"><span class="italic">Oracle Database Reference</span></a> for information about the <code>DBA_HIST_SNAPSHOT</code> view</p>
</li>
</ul>
</div>
</div>
<!-- class="example" --></div>
</div>
<a id="TGDBA667"></a><a id="TGDBA196"></a>
<div class="props_rev_3"><a id="GUID-62D01B30-2687-4821-A651-DC0E4AAC3B01"></a>
<h4 id="TGDBA-GUID-62D01B30-2687-4821-A651-DC0E4AAC3B01" class="sect4">Modifying Snapshot Settings</h4>
<div>
<div class="section">
<p>You can adjust the interval, retention, and captured Top SQL of snapshot generation for a specified database ID, but note that this can affect the precision of the Oracle Database diagnostic tools.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Modifying Snapshot Settings Using the Command-Line Interface</p>
<p>You can modify various snapshot settings using the <code>MODIFY_SNAPSHOT_SETTINGS</code> procedure:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>The <code>INTERVAL</code> setting affects how often the database automatically generates snapshots.</p>
</li>
<li>
<p>The <code>RETENTION</code> setting affects how long the database stores snapshots in AWR.</p>
</li>
<li>
<p>The <code>TOPNSQL</code> setting affects the number of Top SQL to flush for each SQL criteria (Elapsed Time, CPU Time, Parse Calls, sharable Memory, and Version Count).</p>
<p>The value for this setting is not affected by the statistics/flush level and overrides the system default behavior for AWR SQL collection. It is possible to set the value for this setting to <code>MAXIMUM</code> to capture the complete set of SQL in the shared SQL area, though doing so (or by setting the value to a very high number) may lead to possible space and performance issues because there will be more data to collect and store.</p>
</li>
</ul>
<p>To modify the settings, use the <code>MODIFY_SNAPSHOT_SETTINGS</code> procedure, as shown in the following example.</p>
<p><a href="gather_stats.htm#GUID-62D01B30-2687-4821-A651-DC0E4AAC3B01__CIHIAGBI">Example 6-3</a> shows a <code>MODIFY_SNAPSHOT_SETTINGS</code> procedure call.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-62D01B30-2687-4821-A651-DC0E4AAC3B01__CIHIAGBI">
<p class="titleinexample">Example 6-3 Using the MODIFY_SNAPSHOT_SETTINGS Procedure</p>
<pre dir="ltr">BEGIN
  DBMS_WORKLOAD_REPOSITORY.MODIFY_SNAPSHOT_SETTINGS( retention =&gt; 43200, 
                 interval =&gt; 30, topnsql =&gt; 100, dbid =&gt; 3310949047);
END;
/
</pre>
<p>In this example, the snapshot settings for the database with the database identifier of <code>3310949047</code> are modified as follows:</p>
<ul style="list-style-type: disc;">
<li>
<p>The retention period is specified as 43200 minutes (30 days).</p>
</li>
<li>
<p>The interval between each snapshot is specified as 30 minutes.</p>
</li>
<li>
<p>The number of Top SQL to flush for each SQL criteria is specified as 100.</p>
</li>
</ul>
<p>To verify the current settings for your database, use the <code>DBA_HIST_WR_CONTROL</code> view.</p>
<div class="infoboxnotealso" id="GUID-62D01B30-2687-4821-A651-DC0E4AAC3B01__GUID-B599EB38-C7DD-454C-9703-43CB5036F49C">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink ARPLS093" target="_blank" href="../ARPLS/d_workload_repos.htm#ARPLS093"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the <code>DBMS_WORKLOAD_REPOSITORY</code> package</p>
</li>
<li>
<p><a class="olink REFRN23462" target="_blank" href="../REFRN/GUID-D1EF336E-2F68-40F4-80AD-A92B3564CD58.htm#REFRN23462"><span class="italic">Oracle Database Reference</span></a> for information about the <code>DBA_HIST_WR_CONTROL</code> view</p>
</li>
</ul>
</div>
</div>
<!-- class="example" --></div>
</div>
</div>
<a id="TGDBA199"></a>
<div class="props_rev_3"><a id="GUID-44811EF8-D082-487F-8EEC-DA6E78700E68"></a>
<h3 id="TGDBA-GUID-44811EF8-D082-487F-8EEC-DA6E78700E68" class="sect3">Managing Baselines</h3>
<div>
<p>By default, Oracle Database automatically maintains a system-defined moving window baseline. When necessary, you can manually create, drop, or rename a baseline and view the baseline threshold settings. Additionally, you can manually resize the window size of the moving window baseline.</p>
<p>This section describes how to manage baselines and contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="gather_stats.htm#GUID-471AAB84-1CE9-456C-9FF0-59B448D087C3">User Interface for Managing Baselines</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-CDAB6DE7-F5A1-4D14-8FF0-954C86DFC3FF">Creating a Baseline</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-53D4F193-5EA5-4C6C-8547-A4A0B602D553">Dropping a Baseline</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-0E0D7ECE-A8C5-41C6-9CB7-69E99DB75193">Renaming a Baseline</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-4206BF49-A554-4104-8CB7-A9281CA1A9D8">Displaying Baseline Metrics</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-FFB695C6-E57A-487D-898A-EDAF0ECDD881">Resizing the Default Moving Window Baseline</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-44811EF8-D082-487F-8EEC-DA6E78700E68__GUID-1C5587B3-9325-4B92-BC74-AE023454EC16">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="gather_stats.htm#GUID-C6401C10-F958-4339-99C2-3320BDAB4CEA">Baselines</a>&#34;</span> for information about baselines</p>
</div>
</div>
<a id="TGDBA200"></a>
<div class="props_rev_3"><a id="GUID-471AAB84-1CE9-456C-9FF0-59B448D087C3"></a>
<h4 id="TGDBA-GUID-471AAB84-1CE9-456C-9FF0-59B448D087C3" class="sect4">User Interface for Managing Baselines</h4>
<div>
<p>The primary interface for managing baselines is Oracle Enterprise Manager. Whenever possible, manage baselines using Oracle Enterprise Manager.</p>
<p>If Oracle Enterprise Manager is unavailable, then manage baselines using the <code>DBMS_WORKLOAD_REPOSITORY</code> package in the command-line interface. The DBA role is required to invoke the <code>DBMS_WORKLOAD_REPOSITORY</code> procedures.</p>
<div class="infoboxnotealso" id="GUID-471AAB84-1CE9-456C-9FF0-59B448D087C3__GUID-1D5A96FA-83DA-446C-BBA1-FEF4A96261C9">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink TDPPT230" target="_blank" href="../TDPPT/tdppt_degrade.htm#TDPPT230"><span class="italic">Oracle Database 2 Day + Performance Tuning Guide</span></a> for more information about managing baselines using Oracle Enterprise Manager</p>
</li>
<li>
<p><a class="olink ARPLS093" target="_blank" href="../ARPLS/d_workload_repos.htm#ARPLS093"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the <code>DBMS_WORKLOAD_REPOSITORY</code> package</p>
</li>
</ul>
</div>
</div>
</div>
<a id="TGDBA668"></a><a id="TGDBA201"></a>
<div class="props_rev_3"><a id="GUID-CDAB6DE7-F5A1-4D14-8FF0-954C86DFC3FF"></a>
<h4 id="TGDBA-GUID-CDAB6DE7-F5A1-4D14-8FF0-954C86DFC3FF" class="sect4">Creating a Baseline</h4>
<div>
<div class="section">
<p>By default, Oracle Database automatically maintains a system-defined moving window baseline. However, you may want to manually create a fixed baseline that represents the system operating at an optimal level, so you can compare it with other baselines or snapshots captured during periods of poor performance.</p>
</div>
<!-- class="section" -->
<div class="section">
<p>To create baselines using command-line interface, use the <code>CREATE_BASELINE</code> procedure.</p>
<p><a href="gather_stats.htm#GUID-CDAB6DE7-F5A1-4D14-8FF0-954C86DFC3FF__CIHJICEB">Example 6-4</a> shows a <code>CREATE_BASELINE</code> procedure call.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-CDAB6DE7-F5A1-4D14-8FF0-954C86DFC3FF__CIHJICEB">
<p class="titleinexample">Example 6-4 Using the CREATE_BASELINE Procedure</p>
<pre dir="ltr">BEGIN
    DBMS_WORKLOAD_REPOSITORY.CREATE_BASELINE (start_snap_id =&gt; 270, 
                   end_snap_id =&gt; 280, baseline_name =&gt; &#39;peak baseline&#39;, 
                   dbid =&gt; 3310949047, expiration =&gt; 30);
END;
/
</pre>
<p>In this example, a baseline is created on the database instance with the database identifier of <code>3310949047</code> with the following settings:</p>
<ul style="list-style-type: disc;">
<li>
<p>The start snapshot sequence number is 270.</p>
</li>
<li>
<p>The end snapshot sequence number is 280.</p>
</li>
<li>
<p>The name of baseline is <code>peak baseline</code>.</p>
</li>
<li>
<p>The expiration of the baseline is 30 days.</p>
</li>
</ul>
<p>Oracle Database automatically assigns a unique baseline ID to the new baseline when the baseline is created.</p>
<div class="infoboxnotealso" id="GUID-CDAB6DE7-F5A1-4D14-8FF0-954C86DFC3FF__GUID-9B17EAA9-2E95-4EDC-8D8B-4E225416089A">
<p class="notep1">Tip:</p>
<p>To determine the range of snapshots to include in a baseline, use the <code>DBA_HIST_SNAPSHOT</code> view to review the existing snapshots</p>
</div>
<div class="infoboxnotealso" id="GUID-CDAB6DE7-F5A1-4D14-8FF0-954C86DFC3FF__GUID-05244353-23C0-418D-BFC9-83F919BAA297">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink ARPLS093" target="_blank" href="../ARPLS/d_workload_repos.htm#ARPLS093"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the <code>DBMS_WORKLOAD_REPOSITORY</code> package</p>
</li>
<li>
<p><a class="olink REFRN23442" target="_blank" href="../REFRN/GUID-542B6CA6-793B-4D15-AAFD-4D3E6550C0B6.htm#REFRN23442"><span class="italic">Oracle Database Reference</span></a> for information about the <code>DBA_HIST_SNAPSHOT</code> view</p>
</li>
</ul>
</div>
</div>
<!-- class="example" --></div>
</div>
<a id="TGDBA669"></a><a id="TGDBA204"></a>
<div class="props_rev_3"><a id="GUID-53D4F193-5EA5-4C6C-8547-A4A0B602D553"></a>
<h4 id="TGDBA-GUID-53D4F193-5EA5-4C6C-8547-A4A0B602D553" class="sect4">Dropping a Baseline</h4>
<div>
<div class="section">
<p>To conserve disk space, consider periodically dropping a baseline that is no longer being used. The snapshots associated with a baseline are retained indefinitely until you explicitly drop the baseline or the baseline has expired.</p>
</div>
<!-- class="section" -->
<div class="section">
<p>To drop a baseline using command-line interface, use the <code>DROP_BASELINE</code> procedure.</p>
<p><a href="gather_stats.htm#GUID-53D4F193-5EA5-4C6C-8547-A4A0B602D553__CIHJCJGI">Example 6-5</a> shows a <code>DROP_BASELINE</code> procedure call.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-53D4F193-5EA5-4C6C-8547-A4A0B602D553__CIHJCJGI">
<p class="titleinexample">Example 6-5 Using the DROP_BASELINE Procedure</p>
<pre dir="ltr">BEGIN
  DBMS_WORKLOAD_REPOSITORY.DROP_BASELINE (baseline_name =&gt; &#39;peak baseline&#39;,
                  cascade =&gt; FALSE, dbid =&gt; 3310949047);
END;
/
</pre>
<p>In the example, the baseline <code>peak baseline</code> is dropped from the database instance with the database identifier of <code>3310949047</code> and the associated snapshots are preserved.</p>
<div class="infoboxnotealso" id="GUID-53D4F193-5EA5-4C6C-8547-A4A0B602D553__GUID-204E8C52-AC8B-4014-BE2F-564A93F3427F">
<p class="notep1">Tip:</p>
<p>To determine which baseline to drop, use the <code>DBA_HIST_BASELINE</code> view to review the existing baselines</p>
</div>
<div class="infoboxnotealso" id="GUID-53D4F193-5EA5-4C6C-8547-A4A0B602D553__GUID-8BEDA752-4A26-47BE-A1E3-BC27EC9B8A4A">
<p class="notep1">Tip:</p>
<p>To drop the associated snapshots along with the baseline, set the <code>cascade</code> parameter to <code>TRUE</code></p>
</div>
<div class="infoboxnotealso" id="GUID-53D4F193-5EA5-4C6C-8547-A4A0B602D553__GUID-AF1A803D-238B-42D6-8D13-8D0138A043DC">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS093" target="_blank" href="../ARPLS/d_workload_repos.htm#ARPLS093"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the <code>DBMS_WORKLOAD_REPOSITORY</code> package</p>
</div>
</div>
<!-- class="example" --></div>
</div>
<a id="TGDBA670"></a><a id="TGDBA207"></a>
<div class="props_rev_3"><a id="GUID-0E0D7ECE-A8C5-41C6-9CB7-69E99DB75193"></a>
<h4 id="TGDBA-GUID-0E0D7ECE-A8C5-41C6-9CB7-69E99DB75193" class="sect4">Renaming a Baseline</h4>
<div>
<div class="section">
<p>To rename a baseline using command-line interface, use the <code>RENAME_BASELINE</code> procedure.</p>
<p><a href="gather_stats.htm#GUID-0E0D7ECE-A8C5-41C6-9CB7-69E99DB75193__CIHDDJEG">Example 6-6</a> shows a <code>RENAME_BASELINE</code> procedure call.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-0E0D7ECE-A8C5-41C6-9CB7-69E99DB75193__CIHDDJEG">
<p class="titleinexample">Example 6-6 Using the RENAME_BASELINE Procedure</p>
<pre dir="ltr">BEGIN
    DBMS_WORKLOAD_REPOSITORY.RENAME_BASELINE (
                   old_baseline_name =&gt; &#39;peak baseline&#39;, 
                   new_baseline_name =&gt; &#39;peak mondays&#39;, 
                   dbid =&gt; 3310949047);
END;
/
</pre>
<p>In this example, the name of the baseline on the database instance with the database identifier of <code>3310949047</code> is renamed from <code>peak baseline</code> to <code>peak mondays</code>.</p>
<div class="infoboxnotealso" id="GUID-0E0D7ECE-A8C5-41C6-9CB7-69E99DB75193__GUID-D1CFEA9C-F6CE-4D93-8815-D278847F82A4">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS093" target="_blank" href="../ARPLS/d_workload_repos.htm#ARPLS093"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the <code>DBMS_WORKLOAD_REPOSITORY</code> package</p>
</div>
</div>
<!-- class="example" --></div>
</div>
<a id="TGDBA210"></a>
<div class="props_rev_3"><a id="GUID-4206BF49-A554-4104-8CB7-A9281CA1A9D8"></a>
<h4 id="TGDBA-GUID-4206BF49-A554-4104-8CB7-A9281CA1A9D8" class="sect4">Displaying Baseline Metrics</h4>
<div>
<div class="section">
<p>When used with adaptive thresholds, a baseline contains AWR data that the database can use to compute metric threshold values.</p>
<div class="infoboxnotealso" id="GUID-4206BF49-A554-4104-8CB7-A9281CA1A9D8__GUID-B5E6BC1C-17C3-4BCB-9295-06DCBB519889">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="gather_stats.htm#GUID-6450312A-8894-4648-8DC3-83C83F6995F3">Adaptive Thresholds</a>&#34;</span> for information about baseline metric thresholds</p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p>To display the summary statistics for metric values in a baseline period using the command-line interface, use the <code>SELECT_BASELINE_METRICS</code> function:</p>
<pre dir="ltr">DBMS_WORKLOAD_REPOSITORY.SELECT_BASELINE_METRICS (
    baseline_name IN VARCHAR2,
             dbid IN NUMBER DEFAULT NULL,
     instance_num IN NUMBER DEFAULT NULL)
RETURN awr_baseline_metric_type_table PIPELINED;
</pre>
<div class="infoboxnotealso" id="GUID-4206BF49-A554-4104-8CB7-A9281CA1A9D8__GUID-A9621E73-25C1-4763-B4B9-62A8DBE98516">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS093" target="_blank" href="../ARPLS/d_workload_repos.htm#ARPLS093"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the <code>DBMS_WORKLOAD_REPOSITORY</code> package</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="TGDBA671"></a><a id="TGDBA213"></a>
<div class="props_rev_3"><a id="GUID-FFB695C6-E57A-487D-898A-EDAF0ECDD881"></a>
<h4 id="TGDBA-GUID-FFB695C6-E57A-487D-898A-EDAF0ECDD881" class="sect4">Resizing the Default Moving Window Baseline</h4>
<div>
<div class="section">
<p>By default, Oracle Database automatically maintains a system-defined moving window baseline. The default window size for the system-defined moving window baseline is the current AWR retention period, which by default is 8 days. In certain circumstances, you may want to modify the window size of the default moving window baseline, such as increasing its size to more accurately compute threshold values for adaptive thresholds.</p>
<div class="infoboxnotealso" id="GUID-FFB695C6-E57A-487D-898A-EDAF0ECDD881__GUID-F5A077F6-D94F-4A35-8CEC-D93290E21390">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="gather_stats.htm#GUID-91C614C3-5B49-4DD9-90B5-A38F3D6AAD62">Moving Window Baselines</a>&#34;</span> for information about moving window baselines</p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p>To modify the window size of the default moving window baseline using the command-line interface, use the <code>MODIFY_BASELINE_WINDOW_SIZE</code> procedure.</p>
<p><a href="gather_stats.htm#GUID-FFB695C6-E57A-487D-898A-EDAF0ECDD881__CIHJCECD">Example 6-7</a> shows a <code>MODIFY_BASELINE_WINDOW_SIZE</code> procedure call.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-FFB695C6-E57A-487D-898A-EDAF0ECDD881__CIHJCECD">
<p class="titleinexample">Example 6-7 Using the MODIFY_BASELINE_WINDOW_SIZE Procedure</p>
<pre dir="ltr">BEGIN
    DBMS_WORKLOAD_REPOSITORY.MODIFY_BASELINE_WINDOW_SIZE (
                   window_size =&gt; 30, 
                   dbid =&gt; 3310949047);
END;
/
</pre>
<p>In this example, the default moving window is resized to 30 days on the database instance with the database identifier of <code>3310949047</code>.</p>
<div class="infobox-note" id="GUID-FFB695C6-E57A-487D-898A-EDAF0ECDD881__GUID-A575D691-2ACE-4BB2-8005-995D18F7708D">
<p class="notep1">Note:</p>
<p>The window size must be set to a value that is equal to or less than the value of the AWR retention setting. To set a window size that is greater than the current AWR retention period, you must first increase the value of the <code>retention</code> parameter, as described in <span class="q">&#34;<a href="gather_stats.htm#GUID-62D01B30-2687-4821-A651-DC0E4AAC3B01">Modifying Snapshot Settings</a>&#34;</span>.</p>
</div>
<div class="infoboxnotealso" id="GUID-FFB695C6-E57A-487D-898A-EDAF0ECDD881__GUID-B705F485-D11D-4DF2-BFC9-868C3AF63018">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS093" target="_blank" href="../ARPLS/d_workload_repos.htm#ARPLS093"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the <code>DBMS_WORKLOAD_REPOSITORY</code> package</p>
</div>
</div>
<!-- class="example" --></div>
</div>
</div>
<a id="TGDBA216"></a>
<div class="props_rev_3"><a id="GUID-B5DB2422-951F-4D00-A473-AB6739ECC88B"></a>
<h3 id="TGDBA-GUID-B5DB2422-951F-4D00-A473-AB6739ECC88B" class="sect3">Managing Baseline Templates</h3>
<div>
<p>Baseline templates enable you to automatically create baselines to capture specified time periods in the future. This section describes how to manage baseline templates and contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="gather_stats.htm#GUID-67905721-1F11-4F0C-8186-8EF56B94C53B">User Interfaces for Managing Baseline Templates</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-A4FA4563-BF8B-4EA6-8348-5D1CDB32664D">Creating a Single Baseline Template</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-2B940DB3-B11F-4A17-B0B9-AE4C83E01CD6">Creating a Repeating Baseline Template</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-8ED1483E-AED8-41D6-9E8A-E31379F5B174">Dropping a Baseline Template</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-B5DB2422-951F-4D00-A473-AB6739ECC88B__GUID-B9E842DF-3952-4183-AB4F-1A0AD5E222CD">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="gather_stats.htm#GUID-BC0E898A-5AE3-4305-9F74-C24EE5F288DF">Baseline Templates</a>&#34;</span> for information about baseline templates</p>
</div>
</div>
<a id="TGDBA217"></a>
<div class="props_rev_3"><a id="GUID-67905721-1F11-4F0C-8186-8EF56B94C53B"></a>
<h4 id="TGDBA-GUID-67905721-1F11-4F0C-8186-8EF56B94C53B" class="sect4">User Interfaces for Managing Baseline Templates</h4>
<div>
<p>The primary interface for managing baseline templates is Oracle Enterprise Manager. Whenever possible, manage baseline templates using Oracle Enterprise Manager.</p>
<p>If Oracle Enterprise Manager is unavailable, then manage baseline templates using the <code>DBMS_WORKLOAD_REPOSITORY</code> package in the command-line interface. The DBA role is required to invoke the <code>DBMS_WORKLOAD_REPOSITORY</code> procedures.</p>
<div class="infoboxnotealso" id="GUID-67905721-1F11-4F0C-8186-8EF56B94C53B__GUID-D5E696CD-7320-4739-8C96-FC24002292AB">
<p class="notep1">See Also:</p>
<p><a class="olink TDPPT230" target="_blank" href="../TDPPT/tdppt_degrade.htm#TDPPT230"><span class="italic">Oracle Database 2 Day + Performance Tuning Guide</span></a> for more information about managing baseline templates using Oracle Enterprise Manager</p>
</div>
</div>
</div>
<a id="TGDBA672"></a><a id="TGDBA218"></a>
<div class="props_rev_3"><a id="GUID-A4FA4563-BF8B-4EA6-8348-5D1CDB32664D"></a>
<h4 id="TGDBA-GUID-A4FA4563-BF8B-4EA6-8348-5D1CDB32664D" class="sect4">Creating a Single Baseline Template</h4>
<div>
<div class="section">
<p>You can use a single baseline template to create a baseline during a single, fixed time interval in the future. For example, you can create a single baseline template to generate a baseline that is captured on April 2, 2012 from 5:00 p.m. to 8:00 p.m.</p>
</div>
<!-- class="section" -->
<div class="section">
<p>To create a single baseline template using command-line interface, use the <code>CREATE_BASELINE_TEMPLATE</code> procedure.</p>
<p><a href="gather_stats.htm#GUID-A4FA4563-BF8B-4EA6-8348-5D1CDB32664D__CIHBJAIB">Example 6-8</a> shows a <code>CREATE_BASELINE_TEMPLATE</code> procedure call.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-A4FA4563-BF8B-4EA6-8348-5D1CDB32664D__CIHBJAIB">
<p class="titleinexample">Example 6-8 Using the CREATE_BASELINE_TEMPLATE Procedure</p>
<pre dir="ltr">BEGIN
    DBMS_WORKLOAD_REPOSITORY.CREATE_BASELINE_TEMPLATE (
                   start_time =&gt; &#39;2012-04-02 17:00:00 PST&#39;, 
                   end_time =&gt; &#39;2012-04-02 20:00:00 PST&#39;, 
                   baseline_name =&gt; &#39;baseline_120402&#39;, 
                   template_name =&gt; &#39;template_120402&#39;, expiration =&gt; 30, 
                   dbid =&gt; 3310949047);
END;
/
</pre>
<p>In this example, a baseline template named <code>template_120402</code> is created that will generate a baseline named <code>baseline_120402</code> for the time period from 5:00 p.m. to 8:00 p.m. on April 2, 2012 on the database with a database ID of <code>3310949047</code>. The baseline will expire after 30 days.</p>
<div class="infoboxnotealso" id="GUID-A4FA4563-BF8B-4EA6-8348-5D1CDB32664D__GUID-0D808D3D-9FA5-43CF-9AC1-51C432FC7161">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS093" target="_blank" href="../ARPLS/d_workload_repos.htm#ARPLS093"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the <code>DBMS_WORKLOAD_REPOSITORY</code> package</p>
</div>
</div>
<!-- class="example" --></div>
</div>
<a id="TGDBA673"></a><a id="TGDBA221"></a>
<div class="props_rev_3"><a id="GUID-2B940DB3-B11F-4A17-B0B9-AE4C83E01CD6"></a>
<h4 id="TGDBA-GUID-2B940DB3-B11F-4A17-B0B9-AE4C83E01CD6" class="sect4">Creating a Repeating Baseline Template</h4>
<div>
<div class="section">
<p>You can use a repeating baseline template to automatically create baselines that repeat during a particular time interval over a specific period in the future. For example, you can create a repeating baseline template to generate a baseline that repeats every Monday from 5:00 p.m. to 8:00 p.m. for the year 2012.</p>
</div>
<!-- class="section" -->
<div class="section">
<p>To create a repeating baseline template using command-line, use the <code>CREATE_BASELINE_TEMPLATE</code> procedure.</p>
<p><a href="gather_stats.htm#GUID-2B940DB3-B11F-4A17-B0B9-AE4C83E01CD6__CIHGGFFG">Example 6-9</a> shows a <code>CREATE_BASELINE_TEMPLATE</code> procedure call.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-2B940DB3-B11F-4A17-B0B9-AE4C83E01CD6__CIHGGFFG">
<p class="titleinexample">Example 6-9 Using the CREATE_BASELINE_TEMPLATE Procedure</p>
<pre dir="ltr">BEGIN
    DBMS_WORKLOAD_REPOSITORY.CREATE_BASELINE_TEMPLATE (
                   day_of_week =&gt; &#39;monday&#39;, hour_in_day =&gt; 17,
                   duration =&gt; 3, expiration =&gt; 30,
                   start_time =&gt; &#39;2012-04-02 17:00:00 PST&#39;, 
                   end_time =&gt; &#39;2012-12-31 20:00:00 PST&#39;, 
                   baseline_name_prefix =&gt; &#39;baseline_2012_mondays_&#39;, 
                   template_name =&gt; &#39;template_2012_mondays&#39;,
                   dbid =&gt; 3310949047);
END;
/
</pre>
<p>In this example, a baseline template named <code>template_2012_mondays</code> is created that will generate a baseline on every Monday from 5:00 p.m. to 8:00 p.m. beginning on April 2, 2012 at 5:00 p.m. and ending on December 31, 2012 at 8:00 p.m. on the database with a database ID of <code>3310949047</code>. Each of the baselines will be created with a baseline name with the prefix <code>baseline_2012_mondays_</code> and will expire after 30 days.</p>
<div class="infoboxnotealso" id="GUID-2B940DB3-B11F-4A17-B0B9-AE4C83E01CD6__GUID-1DFB1349-D51B-42B3-B58A-F70FA388C4DC">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS093" target="_blank" href="../ARPLS/d_workload_repos.htm#ARPLS093"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the <code>DBMS_WORKLOAD_REPOSITORY</code> package</p>
</div>
</div>
<!-- class="example" --></div>
</div>
<a id="TGDBA674"></a><a id="TGDBA224"></a>
<div class="props_rev_3"><a id="GUID-8ED1483E-AED8-41D6-9E8A-E31379F5B174"></a>
<h4 id="TGDBA-GUID-8ED1483E-AED8-41D6-9E8A-E31379F5B174" class="sect4">Dropping a Baseline Template</h4>
<div>
<div class="section">
<p>Periodically, you may want to remove baselines templates that are no longer used to conserve disk space.</p>
</div>
<!-- class="section" -->
<div class="section">
<p>To drop a baseline template using command-line, use the <code>DROP_BASELINE_TEMPLATE</code> procedure.</p>
<p><a href="gather_stats.htm#GUID-8ED1483E-AED8-41D6-9E8A-E31379F5B174__CIHIBDDF">Example 6-10</a> shows a <code>DROP_BASELINE_TEMPLATE</code> procedure call.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-8ED1483E-AED8-41D6-9E8A-E31379F5B174__CIHIBDDF">
<p class="titleinexample">Example 6-10 Using the DROP_BASELINE_TEMPLATE Procedure</p>
<pre dir="ltr">BEGIN
  DBMS_WORKLOAD_REPOSITORY.DROP_BASELINE_TEMPLATE (
                   template_name =&gt; &#39;template_2012_mondays&#39;,
                   dbid =&gt; 3310949047);
END;
/
</pre>
<p>In this example, the baseline template named <code>template_2012_mondays</code> is dropped from the database instance with the database identifier of <code>3310949047</code>.</p>
<div class="infoboxnotealso" id="GUID-8ED1483E-AED8-41D6-9E8A-E31379F5B174__GUID-2C608B95-160C-41CB-BC05-24D38FBD3932">
<p class="notep1">Tip:</p>
<p>To determine which baseline template to drop, use the <code>DBA_HIST_BASELINE_TEMPLATE</code> view to review the existing baseline templates</p>
</div>
<div class="infoboxnotealso" id="GUID-8ED1483E-AED8-41D6-9E8A-E31379F5B174__GUID-42343832-2C01-4BE4-8EAD-DF81C54084DC">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS093" target="_blank" href="../ARPLS/d_workload_repos.htm#ARPLS093"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the <code>DBMS_WORKLOAD_REPOSITORY</code> package</p>
</div>
</div>
<!-- class="example" --></div>
</div>
</div>
<a id="TGDBA227"></a>
<div class="props_rev_3"><a id="GUID-F25470A0-C236-46DE-84F7-D68FBE1B0F12"></a>
<h3 id="TGDBA-GUID-F25470A0-C236-46DE-84F7-D68FBE1B0F12" class="sect3">Transporting Automatic Workload Repository Data</h3>
<div>
<p>Oracle Database enables you to transport AWR data between systems. This is useful in cases where you want to use a separate system to perform analysis of AWR data. To transport AWR data, first extract the data from the database on the source system, and then load the data into the database on the target system.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="gather_stats.htm#GUID-CC6A87BD-BFEA-4A1B-9FD1-3445DC11BE72">Extracting AWR Data</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-C916E80F-B819-4452-ABFC-18CA70D8A501">Loading AWR Data</a></p>
</li>
</ul>
</div>
<a id="TGDBA229"></a>
<div class="props_rev_3"><a id="GUID-CC6A87BD-BFEA-4A1B-9FD1-3445DC11BE72"></a>
<h4 id="TGDBA-GUID-CC6A87BD-BFEA-4A1B-9FD1-3445DC11BE72" class="sect4">Extracting AWR Data</h4>
<div>
<div class="section">
<p>The <code>awrextr.sql</code> script extracts AWR data for a range of snapshots from the database into a Data Pump export file. After it is created, you can transport this dump file to another database where you can load the extracted data. To run the <code>awrextr.sql</code> script, you must be connected to the database as the <code>SYS</code> user.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To extract AWR data:</p>
<ol>
<li>
<p>At the SQL prompt, enter:</p>
<pre dir="ltr">@$ORACLE_HOME/rdbms/admin/awrextr.sql
</pre>
<p>A list of the databases in the AWR schema is displayed.</p>
</li>
<li>
<p>Specify the database from which AWR data will be extracted:</p>
<pre dir="ltr">Enter value for db_id: 1377863381
</pre>
<p>In this example, the database with the database identifier of <code>1377863381</code> is selected.</p>
</li>
<li>
<p>Specify the number of days for which you want to list snapshot IDs.</p>
<pre dir="ltr">Enter value for num_days: 2
</pre>
<p>A list of existing snapshots for the specified time range is displayed. In this example, snapshots captured in the last 2 days are displayed.</p>
</li>
<li>
<p>Define the range of snapshots for which AWR data will be extracted by specifying a beginning and ending snapshot ID:</p>
<pre dir="ltr">Enter value for begin_snap: 30
Enter value for end_snap: 40
</pre>
<p>In this example, the snapshot with a snapshot ID of 30 is selected as the beginning snapshot, and the snapshot with a snapshot ID of 40 is selected as the ending snapshot.</p>
<p>A list of directory objects is displayed.</p>
</li>
<li>
<p>Specify the directory object pointing to the directory where the export dump file will be stored:</p>
<pre dir="ltr">Enter value for directory_name: DATA_PUMP_DIR
</pre>
<p>In this example, the directory object <code>DATA_PUMP_DIR</code> is selected.</p>
</li>
<li>
<p>Specify a prefix for the name of the export dump file (the <code>.dmp</code> suffix will be automatically appended):</p>
<pre dir="ltr">Enter value for file_name: awrdata_30_40
</pre>
<p>In this example, an export dump file named <code>awrdata_30_40</code> will be created in the directory corresponding to the directory object you specified:</p>
<pre dir="ltr">Dump file set for SYS.SYS_EXPORT_TABLE_01 is:
C:\ORACLE\PRODUCT\12.1.0.1\DB_1\RDBMS\LOG\AWRDATA_30_40.DMP
Job &#34;SYS&#34;.&#34;SYS_EXPORT_TABLE_01&#34; successfully completed at 08:58:20
</pre>
<p>Depending on the amount of AWR data that must be extracted, the AWR extract operation may take a while to complete. After the dump file is created, you can use Data Pump to transport the file to another system.</p>
</li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-CC6A87BD-BFEA-4A1B-9FD1-3445DC11BE72__GUID-A7D89CA3-8271-4786-8ADD-581E48D9C621">
<p class="notep1">See Also:</p>
<p><a class="olink SUTIL100" target="_blank" href="../SUTIL/GUID-17FAE261-0972-4220-A2E4-44D479F519D4.htm#SUTIL100"><span class="italic">Oracle Database Utilities</span></a> for information about using Data Pump</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="TGDBA230"></a>
<div class="props_rev_3"><a id="GUID-C916E80F-B819-4452-ABFC-18CA70D8A501"></a>
<h4 id="TGDBA-GUID-C916E80F-B819-4452-ABFC-18CA70D8A501" class="sect4">Loading AWR Data</h4>
<div>
<div class="section">
<p>After the export dump file is transported to the target system, load the extracted AWR data using the <code>awrload.sql</code> script. The <code>awrload.sql</code> script will first create a staging schema where the snapshot data is transferred from the Data Pump file into the database. The data is then transferred from the staging schema into the appropriate AWR tables. To run the <code>awrload.sql</code> script, you must be connected to the database as the <code>SYS</code> user.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To load AWR data:</p>
<ol>
<li>
<p>At the SQL prompt, enter:</p>
<pre dir="ltr">@$ORACLE_HOME/rdbms/admin/awrload.sql
</pre>
<p>A list of directory objects is displayed.</p>
</li>
<li>
<p>Specify the directory object pointing to the directory where the export dump file is located:</p>
<pre dir="ltr">Enter value for directory_name: DATA_PUMP_DIR
</pre>
<p>In this example, the directory object <code>DATA_PUMP_DIR</code> is selected.</p>
</li>
<li>
<p>Specify a prefix for the name of the export dump file (the <code>.dmp</code> suffix will be automatically appended):</p>
<pre dir="ltr">Enter value for file_name: awrdata_30_40
</pre>
<p>In this example, the export dump file named <code>awrdata_30_40</code> is selected.</p>
</li>
<li>
<p>Specify the name of the staging schema where AWR data will be loaded:</p>
<pre dir="ltr">Enter value for schema_name: AWR_STAGE
</pre>
<p>In this example, a staging schema named <code>AWR_STAGE</code> will be created where AWR data will be loaded.</p>
</li>
<li>
<p>Specify the default tablespace for the staging schema:</p>
<pre dir="ltr">Enter value for default_tablespace: SYSAUX
</pre>
<p>In this example, the <code>SYSAUX</code> tablespace is selected.</p>
</li>
<li>
<p>Specify the temporary tablespace for the staging schema:</p>
<pre dir="ltr">Enter value for temporary_tablespace: TEMP
</pre>
<p>In this example, the <code>TEMP</code> tablespace is selected.</p>
</li>
<li>
<p>A staging schema named <code>AWR_STAGE</code> will be created where AWR data will be loaded. After AWR data is loaded into the <code>AWR_STAGE</code> schema, the data will be transferred into AWR tables in the <code>SYS</code> schema:</p>
<pre dir="ltr">Processing object type TABLE_EXPORT/TABLE/CONSTRAINT/CONSTRAINT
Completed 113 CONSTRAINT objects in 11 seconds
Processing object type TABLE_EXPORT/TABLE/CONSTRAINT/REF_CONSTRAINT
Completed 1 REF_CONSTRAINT objects in 1 seconds
Job &#34;SYS&#34;.&#34;SYS_IMPORT_FULL_03&#34; successfully completed at 09:29:30
... Dropping AWR_STAGE user
End of AWR Load
</pre>
<p>Depending on the amount of AWR data that must be loaded, the AWR load operation may take a while to complete. After AWR data is loaded, the staging schema will be dropped automatically.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="TGDBA231"></a>
<div class="props_rev_3"><a id="GUID-18E1B278-B3C5-4FE1-8E51-BC8878C439F5"></a>
<h3 id="TGDBA-GUID-18E1B278-B3C5-4FE1-8E51-BC8878C439F5" class="sect3">Using Automatic Workload Repository Views</h3>
<div>
<div class="section">
<p><a id="d10800e2691" class="indexterm-anchor"></a>Typically, you would view AWR data through Oracle Enterprise Manager or AWR reports. However, you can also view historical data stored in AWR using the following <code>DBA_HIST</code> views:</p>
<ul style="list-style-type: disc;">
<li>
<p><code>DBA_HIST_ACTIVE_SESS_HISTORY</code> displays the history of the contents of the in-memory active session history for recent system activity.</p>
</li>
<li>
<p><code>DBA_HIST_BASELINE</code> displays information about the baselines captured on the system, such as the time range of each baseline and the baseline type.</p>
</li>
<li>
<p><code>DBA_HIST_BASELINE_DETAILS</code> displays details about a specific baseline.</p>
</li>
<li>
<p><code>DBA_HIST_BASELINE_TEMPLATE</code> displays information about the baseline templates used by the system to generate baselines.</p>
</li>
<li>
<p><code>DBA_HIST_DATABASE_INSTANCE</code> displays information about the database environment.</p>
</li>
<li>
<p><code>DBA_HIST_DB_CACHE_ADVICE</code> displays historical predictions of the number of physical reads for the cache size corresponding to each row.</p>
</li>
<li>
<p><code>DBA_HIST_DISPATCHER</code> displays historical information for each dispatcher process at the time of the snapshot.</p>
</li>
<li>
<p><code>DBA_HIST_DYN_REMASTER_STATS</code> displays statistical information about the dynamic remastering process.</p>
</li>
<li>
<p><code>DBA_HIST_IOSTAT_DETAIL</code> displays historical I/O statistics aggregated by file type and function.</p>
</li>
<li>
<p><code>DBA_HIST_SHARED_SERVER_SUMMARY</code> displays historical information for shared servers, such as shared server activity, common queues and dispatcher queues.</p>
</li>
<li>
<p><code>DBA_HIST_SNAPSHOT</code> displays information on snapshots in the system.</p>
</li>
<li>
<p><code>DBA_HIST_SQL_PLAN</code> displays the SQL execution plans.</p>
</li>
<li>
<p><code>DBA_HIST_WR_CONTROL</code> displays the settings for controlling AWR.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-18E1B278-B3C5-4FE1-8E51-BC8878C439F5__GUID-B6CF0FB2-0A32-4DFD-A2B1-6B1E85557957">
<p class="notep1">See Also:</p>
<p><a class="olink REFRN" target="_blank" href="../REFRN/toc.htm"><span class="italic">Oracle Database Reference</span></a> for information about dynamic and static data dictionary views</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="TGDBA232"></a>
<div class="props_rev_3"><a id="GUID-9BFC6383-6C4F-4103-A2CB-4713802F2669"></a>
<h2 id="TGDBA-GUID-9BFC6383-6C4F-4103-A2CB-4713802F2669" class="sect2">Generating Automatic Workload Repository Reports</h2>
<div>
<p>An AWR report shows data captured between two snapshots (or two points in time). AWR reports are divided into multiple sections. The content of the report contains the workload profile of the system for the selected range of snapshots. The HTML report includes links that can be used to navigate quickly between sections.</p>
<div class="infobox-note" id="GUID-9BFC6383-6C4F-4103-A2CB-4713802F2669__GUID-9A976CD9-69E7-4413-B84A-7FF94892CB43">
<p class="notep1">Note:</p>
<p><a id="d10800e2814" class="indexterm-anchor"></a>If you run a report on a database that does not have any workload activity during the specified range of snapshots, then calculated percentages for some report statistics can be less than 0 or greater than 100. This result means that there is no meaningful value for the statistic.</p>
</div>
<p>This section describes how to generate AWR reports and contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="gather_stats.htm#GUID-590826F2-AA17-4565-B0E6-3FF5225063D8">User Interface for Generating an AWR Report</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-4B5CB76B-7A8E-4A31-8850-1BB77B13EEE2">Generating an AWR Report Using the Command-Line Interface</a></p>
</li>
</ul>
</div>
<a id="TGDBA233"></a>
<div class="props_rev_3"><a id="GUID-590826F2-AA17-4565-B0E6-3FF5225063D8"></a>
<h3 id="TGDBA-GUID-590826F2-AA17-4565-B0E6-3FF5225063D8" class="sect3">User Interface for Generating an AWR Report</h3>
<div>
<p>The primary interface for generating AWR reports is Oracle Enterprise Manager. Whenever possible, generate AWR reports using Oracle Enterprise Manager.</p>
<p>If Oracle Enterprise Manager is unavailable, then generate AWR reports by running SQL scripts. The DBA role is required to run these scripts.</p>
<div class="infoboxnotealso" id="GUID-590826F2-AA17-4565-B0E6-3FF5225063D8__GUID-0F779AE5-01F4-4AE0-8534-5E764AC81F6C">
<p class="notep1">See Also:</p>
<p><a class="olink TDPPT032" target="_blank" href="../TDPPT/tdppt_auto.htm#TDPPT032"><span class="italic">Oracle Database 2 Day + Performance Tuning Guide</span></a> for more information about generating AWR reports using Oracle Enterprise Manager</p>
</div>
</div>
</div>
<a id="TGDBA235"></a>
<div class="props_rev_3"><a id="GUID-4B5CB76B-7A8E-4A31-8850-1BB77B13EEE2"></a>
<h3 id="TGDBA-GUID-4B5CB76B-7A8E-4A31-8850-1BB77B13EEE2" class="sect3">Generating an AWR Report Using the Command-Line Interface</h3>
<div>
<p>This section describes how to generate AWR reports by running SQL scripts in the command-line interface. The DBA role is required to run these scripts.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="gather_stats.htm#GUID-B7D1B185-4942-4934-9B21-A9010F82A4FF">Generating an AWR Report for the Local Database</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-EB7B34CD-6F4B-4010-9A8A-E1C7B8F2F851">Generating an AWR Report for a Specific Database</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-A1ACE3E6-7655-4CA2-BD98-0CEC937D9F63">Generating an Oracle RAC AWR Report for the Local Database</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-1FE0EA42-4299-411B-A69D-F6B1FD038293">Generating an Oracle RAC AWR Report for a Specific Database</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-BD9DA8AD-89FC-4C7E-B902-04340C0E9E3D">Generating an AWR Report for a SQL Statement on the Local Database</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-28885D04-6EB8-4AEB-8019-B767782F84C3">Generating an AWR Report for a SQL Statement on a Specific Database</a></p>
</li>
</ul>
</div>
<a id="TGDBA236"></a>
<div class="props_rev_3"><a id="GUID-B7D1B185-4942-4934-9B21-A9010F82A4FF"></a>
<h4 id="TGDBA-GUID-B7D1B185-4942-4934-9B21-A9010F82A4FF" class="sect4">Generating an AWR Report for the Local Database</h4>
<div>
<div class="section">
<p>The <a id="d10800e2983" class="indexterm-anchor"></a><a id="d10800e2987" class="indexterm-anchor"></a><code>awrrpt.sql</code> SQL script generates an HTML or text report that displays statistics from a range of snapshot IDs.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To generate an AWR report on the local database instance using the command-line interface:</p>
<ol>
<li>
<p>At the SQL prompt, enter:</p>
<pre dir="ltr">@$ORACLE_HOME/rdbms/admin/awrrpt.sql
</pre></li>
<li>
<p>Specify whether you want an HTML or a text report:</p>
<pre dir="ltr">Enter value for report_type: text
</pre>
<p>In this example, a text report is chosen.</p>
</li>
<li>
<p>Specify the number of days for which you want to list snapshot IDs.</p>
<pre dir="ltr">Enter value for num_days: 2
</pre>
<p>A list of existing snapshots for the specified time range is displayed. In this example, snapshots captured in the last 2 days are displayed.</p>
</li>
<li>
<p>Specify a beginning and ending snapshot ID for the workload repository report:</p>
<pre dir="ltr">Enter value for begin_snap: 150
Enter value for end_snap: 160
</pre>
<p>In this example, the snapshot with a snapshot ID of 150 is selected as the beginning snapshot, and the snapshot with a snapshot ID of 160 is selected as the ending snapshot.</p>
</li>
<li>
<p>Enter a report name, or accept the default report name:</p>
<pre dir="ltr">Enter value for report_name: 
Using the report name awrrpt_1_150_160
</pre>
<p>In this example, the default name is accepted and an AWR report named <code>awrrpt_1_150_160</code> is generated.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="TGDBA237"></a>
<div class="props_rev_3"><a id="GUID-EB7B34CD-6F4B-4010-9A8A-E1C7B8F2F851"></a>
<h4 id="TGDBA-GUID-EB7B34CD-6F4B-4010-9A8A-E1C7B8F2F851" class="sect4">Generating an AWR Report for a Specific Database</h4>
<div>
<div class="section">
<p>The <code>awrrpti.sql</code> SQL script generates an HTML or text report that displays statistics from a range of snapshot IDs using a specific database instance. This script enables you to specify a database identifier and instance for which the AWR report will be generated.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To generate an AWR report on a specific database instance using the command-line interface:</p>
<ol>
<li>
<p>At the SQL prompt, enter:</p>
<pre dir="ltr">@$ORACLE_HOME/rdbms/admin/awrrpti.sql
</pre></li>
<li>
<p>Specify whether you want an HTML or a text report:</p>
<pre dir="ltr">Enter value for report_type: text
</pre>
<p>In this example, a text report is chosen.</p>
<p>A list of available database identifiers and instance numbers are displayed:</p>
<pre dir="ltr">Instances in this Workload Repository schema
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   DB Id    Inst Num DB Name      Instance     Host
----------- -------- ------------ ------------ ------------
 3309173529        1 MAIN         main         examp1690
 3309173529        1 TINT251      tint251      samp251
</pre></li>
<li>
<p>Enter the values for the database identifier (<code>dbid)</code> and instance number (<code>inst_num)</code>:</p>
<pre dir="ltr">Enter value for dbid: 3309173529
Using 3309173529 for database Id
Enter value for inst_num: 1
</pre></li>
<li>
<p>Specify the number of days for which you want to list snapshot IDs.</p>
<pre dir="ltr">Enter value for num_days: 2
</pre>
<p>A list of existing snapshots for the specified time range is displayed. In this example, snapshots captured in the last 2 days are displayed.</p>
</li>
<li>
<p>Specify a beginning and ending snapshot ID for the workload repository report:</p>
<pre dir="ltr">Enter value for begin_snap: 150
Enter value for end_snap: 160
</pre>
<p>In this example, the snapshot with a snapshot ID of 150 is selected as the beginning snapshot, and the snapshot with a snapshot ID of 160 is selected as the ending snapshot.</p>
</li>
<li>
<p>Enter a report name, or accept the default report name:</p>
<pre dir="ltr">Enter value for report_name: 
Using the report name awrrpt_1_150_160
</pre>
<p>In this example, the default name is accepted and an AWR report named <code>awrrpt_1_150_160</code> is generated on the database instance with a database ID value of <code>3309173529</code>.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="TGDBA238"></a>
<div class="props_rev_3"><a id="GUID-A1ACE3E6-7655-4CA2-BD98-0CEC937D9F63"></a>
<h4 id="TGDBA-GUID-A1ACE3E6-7655-4CA2-BD98-0CEC937D9F63" class="sect4">Generating an Oracle RAC AWR Report for the Local Database</h4>
<div>
<div class="section">
<p>The <code>awrgrpt.sql</code> SQL script generates an HTML or text report that displays statistics from a range of snapshot IDs using the current database instance in an Oracle Real Application Clusters (Oracle RAC) environment.</p>
<div class="infobox-note" id="GUID-A1ACE3E6-7655-4CA2-BD98-0CEC937D9F63__GUID-34D1A713-3FA3-46B9-B5DB-9F19999E42FE">
<p class="notep1">Note:</p>
<p>In an Oracle RAC environment, Oracle recommends generating an HTML report (instead of a text report) because it is much easier to read.</p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To generate an AWR report for Oracle RAC on the local database instance using the command-line interface:</p>
<ol>
<li>
<p>At the SQL prompt, enter:</p>
<pre dir="ltr">@$ORACLE_HOME/rdbms/admin/awrgrpt.sql
</pre></li>
<li>
<p>Specify whether you want an HTML or a text report:</p>
<pre dir="ltr">Enter value for report_type: html
</pre>
<p>In this example, an HTML report is chosen.</p>
</li>
<li>
<p>Specify the number of days for which you want to list snapshot IDs.</p>
<pre dir="ltr">Enter value for num_days: 2
</pre>
<p>A list of existing snapshots for the specified time range is displayed. In this example, snapshots captured in the last day are displayed.</p>
</li>
<li>
<p>Specify a beginning and ending snapshot ID for the workload repository report:</p>
<pre dir="ltr">Enter value for begin_snap: 150
Enter value for end_snap: 160
</pre>
<p>In this example, the snapshot with a snapshot ID of 150 is selected as the beginning snapshot, and the snapshot with a snapshot ID of 160 is selected as the ending snapshot.</p>
</li>
<li>
<p>Enter a report name, or accept the default report name:</p>
<pre dir="ltr">Enter value for report_name: 
Using the report name awrrpt_rac_150_160.html
</pre>
<p>In this example, the default name is accepted and an AWR report named <code>awrrpt_rac_150_160.html</code> is generated.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="TGDBA239"></a>
<div class="props_rev_3"><a id="GUID-1FE0EA42-4299-411B-A69D-F6B1FD038293"></a>
<h4 id="TGDBA-GUID-1FE0EA42-4299-411B-A69D-F6B1FD038293" class="sect4">Generating an Oracle RAC AWR Report for a Specific Database</h4>
<div>
<div class="section">
<p>The <code>awrgrpti.sql</code> SQL script generates an HTML or text report that displays statistics from a range of snapshot IDs using specific databases instances running in an Oracle RAC environment. This script enables you to specify database identifiers and a comma-delimited list of database instances for which the AWR report will be generated.</p>
<div class="infobox-note" id="GUID-1FE0EA42-4299-411B-A69D-F6B1FD038293__GUID-5E1BD446-DC71-4F9C-ABAA-44D5A0383C4A">
<p class="notep1">Note:</p>
<p>In an Oracle RAC environment, Oracle recommends generating an HTML report (instead of a text report) because it is much easier to read.</p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To generate an AWR report for Oracle RAC on a specific database instance using the command-line interface:</p>
<ol>
<li>
<p>At the SQL prompt, enter:</p>
<pre dir="ltr">@$ORACLE_HOME/rdbms/admin/awrgrpti.sql
</pre></li>
<li>
<p>Specify whether you want an HTML or a text report:</p>
<pre dir="ltr">Enter value for report_type: html
</pre>
<p>In this example, an HTML report is chosen.</p>
<p>A list of available database identifiers and instance numbers are displayed:</p>
<pre dir="ltr">Instances in this Workload Repository schema
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   DB Id    Inst Num DB Name      Instance     Host
----------- -------- ------------ ------------ ------------
 3309173529        1 MAIN         main         examp1690
 3309173529        1 TINT251      tint251      samp251
 3309173529        2 TINT251      tint252      samp252
</pre></li>
<li>
<p>Enter the value for the database identifier (<code>dbid)</code>:</p>
<pre dir="ltr">Enter value for dbid: 3309173529
Using 3309173529 for database Id
</pre></li>
<li>
<p>Enter the value for the instance numbers (<code>instance_numbers_or_all</code>) of the Oracle RAC instances you want to include in the report:</p>
<pre dir="ltr">Enter value for instance_numbers_or_all: 1,2
</pre></li>
<li>
<p>Specify the number of days for which you want to list snapshot IDs.</p>
<pre dir="ltr">Enter value for num_days: 2
</pre>
<p>A list of existing snapshots for the specified time range is displayed. In this example, snapshots captured in the last 2 days are displayed.</p>
</li>
<li>
<p>Specify a beginning and ending snapshot ID for the workload repository report:</p>
<pre dir="ltr">Enter value for begin_snap: 150
Enter value for end_snap: 160
</pre>
<p>In this example, the snapshot with a snapshot ID of 150 is selected as the beginning snapshot, and the snapshot with a snapshot ID of 160 is selected as the ending snapshot.</p>
</li>
<li>
<p>Enter a report name, or accept the default report name:</p>
<pre dir="ltr">Enter value for report_name: 
Using the report name awrrpt_rac_150_160.html
</pre>
<p>In this example, the default name is accepted and an AWR report named <code>awrrpt_rac_150_160.html</code> is generated on the database instance with a database ID value of <code>3309173529</code>.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="TGDBA240"></a>
<div class="props_rev_3"><a id="GUID-BD9DA8AD-89FC-4C7E-B902-04340C0E9E3D"></a>
<h4 id="TGDBA-GUID-BD9DA8AD-89FC-4C7E-B902-04340C0E9E3D" class="sect4">Generating an AWR Report for a SQL Statement on the Local Database</h4>
<div>
<div class="section">
<p>The <code>awrsqrpt.sql</code> SQL script generates an HTML or text report that displays statistics of a particular SQL statement from a range of snapshot IDs. Run this report to inspect or debug the performance of a SQL statement.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To generate an AWR report for a SQL statement on the local database instance using the command-line interface:</p>
<ol>
<li>
<p>At the SQL prompt, enter:</p>
<pre dir="ltr">@$ORACLE_HOME/rdbms/admin/awrsqrpt.sql
</pre></li>
<li>
<p>Specify whether you want an HTML or a text report:</p>
<pre dir="ltr">Enter value for report_type: html
</pre>
<p>In this example, an HTML report is chosen.</p>
</li>
<li>
<p>Specify the number of days for which you want to list snapshot IDs.</p>
<pre dir="ltr">Enter value for num_days: 1
</pre>
<p>A list of existing snapshots for the specified time range is displayed. In this example, snapshots captured in the previous day are displayed.</p>
</li>
<li>
<p>Specify a beginning and ending snapshot ID for the workload repository report:</p>
<pre dir="ltr">Enter value for begin_snap: 146
Enter value for end_snap: 147
</pre>
<p>In this example, the snapshot with a snapshot ID of 146 is selected as the beginning snapshot, and the snapshot with a snapshot ID of 147 is selected as the ending snapshot.</p>
</li>
<li>
<p>Specify the SQL ID of a particular SQL statement to display statistics:</p>
<pre dir="ltr">Enter value for sql_id: 2b064ybzkwf1y
</pre>
<p>In this example, the SQL statement with a SQL ID of <code>2b064ybzkwf1y</code> is selected.</p>
</li>
<li>
<p>Enter a report name, or accept the default report name:</p>
<pre dir="ltr">Enter value for report_name: 
Using the report name awrrpt_1_146_147.html
</pre>
<p>In this example, the default name is accepted and an AWR report named <code>awrrpt_1_146_147</code> is generated.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="TGDBA241"></a>
<div class="props_rev_3"><a id="GUID-28885D04-6EB8-4AEB-8019-B767782F84C3"></a>
<h4 id="TGDBA-GUID-28885D04-6EB8-4AEB-8019-B767782F84C3" class="sect4">Generating an AWR Report for a SQL Statement on a Specific Database</h4>
<div>
<div class="section">
<p>The <code>awrsqrpi.sql</code> SQL script generates an HTML or text report that displays statistics of a particular SQL statement from a range of snapshot IDs using a specific database instance.This script enables you to specify a database identifier and instance for which the AWR report will be generated. Run this report to inspect or debug the performance of a SQL statement on a specific database and instance.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To generate an AWR report for a SQL statement on a specific database instance using the command-line interface:</p>
<ol>
<li>
<p>At the SQL prompt, enter:</p>
<pre dir="ltr">@$ORACLE_HOME/rdbms/admin/awrsqrpi.sql
</pre></li>
<li>
<p>Specify whether you want an HTML or a text report:</p>
<pre dir="ltr">Enter value for report_type: html
</pre>
<p>In this example, an HTML report is chosen.</p>
<p>A list of available database identifiers and instance numbers are displayed:</p>
<pre dir="ltr">Instances in this Workload Repository schema
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   DB Id    Inst Num DB Name      Instance     Host
----------- -------- ------------ ------------ ------------
 3309173529        1 MAIN         main         examp1690
 3309173529        1 TINT251      tint251      samp251
</pre></li>
<li>
<p>Enter the values for the database identifier (<code>dbid)</code> and instance number (<code>inst_num)</code>:</p>
<pre dir="ltr">Enter value for dbid: 3309173529
Using 3309173529 for database Id
Enter value for inst_num: 1
Using 1 for instance number
</pre></li>
<li>
<p>Specify the number of days for which you want to list snapshot IDs.</p>
<pre dir="ltr">Enter value for num_days: 1
</pre>
<p>A list of existing snapshots for the specified time range is displayed. In this example, snapshots captured in the previous day are displayed.</p>
</li>
<li>
<p>Specify a beginning and ending snapshot ID for the workload repository report:</p>
<pre dir="ltr">Enter value for begin_snap: 146
Enter value for end_snap: 147
</pre>
<p>In this example, the snapshot with a snapshot ID of 146 is selected as the beginning snapshot, and the snapshot with a snapshot ID of 147 is selected as the ending snapshot.</p>
</li>
<li>
<p>Specify the SQL ID of a particular SQL statement to display statistics:</p>
<pre dir="ltr">Enter value for sql_id: 2b064ybzkwf1y
</pre>
<p>In this example, the SQL statement with a SQL ID of <code>2b064ybzkwf1y</code> is selected.</p>
</li>
<li>
<p>Enter a report name, or accept the default report name:</p>
<pre dir="ltr">Enter value for report_name: 
Using the report name awrrpt_1_146_147.html
</pre>
<p>In this example, the default name is accepted and an AWR report named <code>awrrpt_1_146_147</code> is generated on the database instance with a database ID value of <code>3309173529</code>.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<a id="TGDBA95393"></a>
<div class="props_rev_3"><a id="GUID-23061F14-767D-47B6-9B45-D1E26FB1E075"></a>
<h2 id="TGDBA-GUID-23061F14-767D-47B6-9B45-D1E26FB1E075" class="sect2">Generating Performance Hub Active Report</h2>
<div>
<p><a id="d10800e3556" class="indexterm-anchor"></a>Performance Hub feature of EM Express provides an active report with a consolidated view of all performance data for a specified time period. The report is fully interactive; its contents are saved in a HTML file, which you can access offline using a web browser.</p>
<div class="infoboxnotealso" id="GUID-23061F14-767D-47B6-9B45-D1E26FB1E075__GUID-4909A519-DE7E-4C0B-9054-065831C2D0F9">
<p class="notep1">See Also:</p>
<p><a class="olink ADMQS12446" target="_blank" href="../ADMQS/GUID-573F73E4-EF1C-46F2-9BAB-73DA08E7D364.htm#ADMQS12446"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information about Performance Hub feature of EM Express</p>
</div>
<p>This section describes how to generate Performance Hub active report and contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="gather_stats.htm#GUID-5D746952-984F-4D20-9EA2-09486332128A">Overview of Performance Hub Active Report</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-2757F38D-F766-4208-94AA-13D58B03C5C5">Command-Line User Interface for Generating a Performance Hub Active Report</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-BA1747A8-590B-4266-9D9E-AAD4182563AB">Generating a Performance Hub Active Report Using a SQL Script</a></p>
</li>
</ul>
</div>
<a id="TGDBA95394"></a>
<div class="props_rev_3"><a id="GUID-5D746952-984F-4D20-9EA2-09486332128A"></a>
<h3 id="TGDBA-GUID-5D746952-984F-4D20-9EA2-09486332128A" class="sect3">Overview of Performance Hub Active Report</h3>
<div>
<p><a id="d10800e3621" class="indexterm-anchor"></a>Performance Hub active report enables you to view all performance data available for a time period that you specify. Different tabs are available in the Performance Hub, depending on whether real-time or historical data is selected for the time period. When real-time data is selected, more granular data is presented, because real-time data for the last hour is displayed. When historical data is selected, more detailed data is presented, but the data points are averaged out to the Automatic Workload Repository (AWR) interval for the selected time period.</p>
<p>This section describes Performance Hub active report and contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="gather_stats.htm#GUID-C4A1CCF0-FA06-4AFB-BAB1-1F2C7021B1FA">About Performance Hub Active Report Tabs</a></p>
</li>
<li>
<p><a href="gather_stats.htm#GUID-87FF1297-3CA4-419E-9323-D6B63820E84D">About Performance Hub Active Report Types</a></p>
</li>
</ul>
</div>
<a id="TGDBA95395"></a>
<div class="props_rev_3"><a id="GUID-C4A1CCF0-FA06-4AFB-BAB1-1F2C7021B1FA"></a>
<h4 id="TGDBA-GUID-C4A1CCF0-FA06-4AFB-BAB1-1F2C7021B1FA" class="sect4">About Performance Hub Active Report Tabs</h4>
<div>
<p>Performance Hub active report contains interactive tabs that enable you to view and navigate through performance data categorized into various performance areas.</p>
<p>The tabs contained in a Performance Hub active report include the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>Summary</p>
<p>The Summary tab provides an overview of system performance, including resource consumption, average active sessions, and load profile information. This tab is available for real-time data as well as historical data.</p>
</li>
<li>
<p>Activity</p>
<p>The Activity tab displays ASH analytics. This tab is available for real-time data as well as historical data.</p>
</li>
<li>
<p>Workload</p>
<p>The Workload tab displays metric information about the workload profile, such as call rates, logon rate, and top SQL. This tab is available for real-time data as well as historical data.</p>
</li>
<li>
<p>RAC</p>
<p>The RAC tab displays metrics specific to Oracle RAC, such as the number of global cache blocks received and the average block latency. This tab is only available in Oracle RAC environments. This tab is available for real-time data as well as historical data.</p>
</li>
<li>
<p>Monitored SQL</p>
<p>The Monitored SQL tab displays information about monitored SQL statements. This tab is available for real-time data as well as historical data.</p>
</li>
<li>
<p>ADDM</p>
<p>The ADDM tab displays information for ADDM analysis tasks and Real-Time ADDM analysis reports. This tab is available for real-time data as well as historical data.</p>
</li>
<li>
<p>Current ADDM Findings</p>
<p>The Current ADDM Findings tab displays a real-time analysis of system performance for the past 5 minutes. This tab is only available if the specified time period for the Performance Hub active report is within the past hour. This tab is available only for real-time data.</p>
</li>
<li>
<p>Database time</p>
<p>The Database Time tab displays wait events by category for various metrics. This tab is available only for historical data.</p>
</li>
<li>
<p>Resources</p>
<p>The Resources tab displays operating system and I/O usage statistics. This tab is available only for historical data.</p>
</li>
<li>
<p>System Statistics</p>
<p>The System Statistics tab displays database and system statistics. This tab is available only for historical data.</p>
</li>
</ul>
</div>
</div>
<a id="TGDBA95396"></a>
<div class="props_rev_3"><a id="GUID-87FF1297-3CA4-419E-9323-D6B63820E84D"></a>
<h4 id="TGDBA-GUID-87FF1297-3CA4-419E-9323-D6B63820E84D" class="sect4">About Performance Hub Active Report Types</h4>
<div>
<p>You can choose the level of details displayed within each tab of the Performance Hub active report by selecting the report type.</p>
<p>The available report types for the Performance Hub active report include the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>Basic</p>
<p>Only the basic information for all the tabs is saved to the report.</p>
</li>
<li>
<p>Typical</p>
<p>In addition to the information saved in the basic report type, the SQL Monitor information for the top SQL statements contained in the Monitored SQL tab and the ADDM reports are saved to the report.</p>
</li>
<li>
<p>All</p>
<p>In addition to the information saved in the typical report type, the SQL Monitor information for all SQL statements contained in the Monitored SQL tab and all detailed reports for all tabs are saved to the report.</p>
</li>
</ul>
</div>
</div>
</div>
<a id="TGDBA95397"></a>
<div class="props_rev_3"><a id="GUID-2757F38D-F766-4208-94AA-13D58B03C5C5"></a>
<h3 id="TGDBA-GUID-2757F38D-F766-4208-94AA-13D58B03C5C5" class="sect3">Command-Line User Interface for Generating a Performance Hub Active Report</h3>
<div>
<p>You can generate a Performance Hub active report using the command-line interface in one of two ways:</p>
<ul style="list-style-type: disc;">
<li>
<p>Using a SQL script, as described in <span class="q">&#34;<a href="gather_stats.htm#GUID-BA1747A8-590B-4266-9D9E-AAD4182563AB">Generating a Performance Hub Active Report Using a SQL Script</a>&#34;</span>.</p>
</li>
<li>
<p>Using the <code>DBMS_PERF</code> package, as described in <a class="olink ARPLS75006" target="_blank" href="../ARPLS/d_perf.htm#ARPLS75006"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a>.</p>
</li>
</ul>
</div>
</div>
<a id="TGDBA95398"></a>
<div class="props_rev_3"><a id="GUID-BA1747A8-590B-4266-9D9E-AAD4182563AB"></a>
<h3 id="TGDBA-GUID-BA1747A8-590B-4266-9D9E-AAD4182563AB" class="sect3">Generating a Performance Hub Active Report Using a SQL Script</h3>
<div>
<div class="section">
<p>This section describes how to generate <a id="d10800e3876" class="indexterm-anchor"></a>Performance Hub active report by running the <code>perfhubrpt.sql</code> SQL script in the command-line interface. The DBA role is required to run this script.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To generate a Performance Hub active report:</p>
<ol>
<li>
<p>At the SQL prompt, enter:</p>
<pre dir="ltr">@$ORACLE_HOME/rdbms/admin/perfhubrpt.sql
</pre></li>
<li>
<p>Specify the desired report type:</p>
<pre dir="ltr">Please enter report type: typical
</pre>
<p>For information about the available report types, see <span class="q">&#34;<a href="gather_stats.htm#GUID-87FF1297-3CA4-419E-9323-D6B63820E84D">About Performance Hub Active Report Types</a>&#34;</span>.</p>
</li>
<li>
<p>Enter the value for the database identifier of the database you want to use:</p>
<pre dir="ltr">Please enter database ID: 3309173529
</pre>
<p>To use the local database, enter a null value (the default value). If you specify a database identifier for a database other than the local database, then the Performance Hub active report is generated from imported AWR data.</p>
</li>
<li>
<p>Enter the value for the instance number of the database instance you want to use:</p>
<pre dir="ltr">Please enter instance number: all instances
</pre>
<p>To specify all instances, enter <code>all instances</code> (the default value).</p>
</li>
<li>
<p>Enter the desired time period by specifying an end time and a start time in the format of <code>dd:mm:yyyy hh:mi:ss</code>:</p>
<pre dir="ltr">Please enter end time in format of dd:mm:yyyy hh24:mi:ss: 03:04:2014 17:00:00
Please enter start time in format of dd:mm:yyyy hh24:mi:ss: 03:04:2014 16:00:00
</pre></li>
<li>
<p>Enter a report name, or accept the default report name:</p>
<pre dir="ltr">Enter value for report_name: my_perfhub_report.html
</pre>
<p>In this example, a Performance Hub active report named <code>my_perfhub_report</code> is generated on all database instances with a database ID value of <code>3309173529</code> for the specified time period from 4:00 p.m. to 5:00 p.m on April 3, 2014.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1">
<tr>
<td class="cellalignment8">
<table class="cellalignment6">
<tr>
<td class="cellalignment5"><a href="measure_db.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5"><a href="pfgrf_diag.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2013, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment10">
<table class="cellalignment4">
<tr>
<td class="cellalignment5"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>