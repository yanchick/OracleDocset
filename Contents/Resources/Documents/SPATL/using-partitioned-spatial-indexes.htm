<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-101974"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Using%20Partitioned%20Spatial%20Indexes"></a><title>Using Partitioned Spatial Indexes</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="indexes, partitioned, partitioned spatial indexes, LOCAL partitioning, spatial indexes"/>
<meta name="dcterms.created" content="2017-01-26T11:46:57Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Spatial and Graph Developer&#39;s Guide"/>
<meta name="dcterms.identifier" content="E49172-07"/>
<meta name="dcterms.isVersionOf" content="SPATL"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="creating-cross-schema-index.htm" title="Previous" type="text/html"/>
<link rel="Next" href="creating-local-partitioned-spatial-index.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E49172-07.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-DB52CEB5-4A4D-44E5-B6F6-F80E00A39E61"></a> <span id="PAGE" style="display:none;">75/475</span> <!-- End Header -->
<a id="SPATL1453"></a><a id="SPATL586"></a>
<h1 id="SPATL-GUID-DB52CEB5-4A4D-44E5-B6F6-F80E00A39E61" class="sect1"><span class="enumeration_section">5.1.3</span> Using Partitioned Spatial Indexes</h1>
<div>
<p>You can create a partitioned spatial index on a partitioned table. This section describes usage considerations specific to Oracle Spatial and Graph. For a detailed explanation of partitioned tables and partitioned indexes, see <a class="olink VLDBG002" target="_blank" href="../VLDBG/GUID-EA7EF5CB-DD49-43AF-889A-F83AAC0D7D51.htm#VLDBG002"><span class="italic">Oracle Database VLDB and Partitioning Guide</span></a>.</p>
<p>A partitioned spatial index can provide the following benefits:</p>
<ul style="list-style-type: disc;">
<li>
<p>Reduced response times for long-running queries, because partitioning reduces disk I/O operations</p>
</li>
<li>
<p>Reduced response times for concurrent queries, because I/O operations run concurrently on each partition</p>
</li>
<li>
<p>Easier index maintenance, because of partition-level create and rebuild operations</p>
<p>Indexes on partitions can be rebuilt without affecting the queries on other partitions, and storage parameters for each local index can be changed independent of other partitions.</p>
</li>
<li>
<p>Parallel query on multiple partition searching</p>
<p>The degree of parallelism is the value from the DEGREE column in the row for the index in the USER_INDEXES view (that is, the value specified or defaulted for the PARALLEL keyword with the <a href="create-index.htm">CREATE INDEX</a>, <a href="alter-index.htm">ALTER INDEX</a>, or <a href="alter-index-rebuild.htm">ALTER INDEX REBUILD</a> statement).</p>
</li>
<li>
<p>Improved query processing in multiprocessor system environments</p>
<p>In a multiprocessor system environment, if a spatial operator is invoked on a table with partitioned spatial index and if multiple partitions are involved in the query, multiple processors can be used to evaluate the query. The number of processors used is determined by the degree of parallelism and the number of partitions used in evaluating the query.</p>
</li>
</ul>
<p>The following restrictions apply to spatial index partitioning:</p>
<ul style="list-style-type: disc;">
<li>
<p>The partition key for spatial tables must be a scalar value, and must not be a spatial column.</p>
</li>
<li>
<p>Only range partitioning is supported on the underlying table. All other kinds of partitioning are not currently supported for partitioned spatial indexes.</p>
</li>
</ul>
<p>To create a partitioned spatial index, you must specify the LOCAL keyword. (If you do not specify the LOCAL keyword, a nonpartitioned spatial index is created on the data in all table partitions.) The following example creates a partitioned spatial index:</p>
<pre dir="ltr">CREATE INDEX counties_idx ON counties(geometry)
   INDEXTYPE IS MDSYS.SPATIAL_INDEX LOCAL;
</pre>
<p>In this example, the default values are used for the number and placement of index partitions, namely:</p>
<ul style="list-style-type: disc;">
<li>
<p>Index partitioning is based on the underlying table partitioning. For each table partition, a corresponding index partition is created.</p>
</li>
<li>
<p>Each index partition is placed in the default tablespace.</p>
</li>
</ul>
<p>If you do specify parameters for individual partitions, the following considerations apply:</p>
<ul style="list-style-type: disc;">
<li>
<p>The storage characteristics for each partition can be the same or different for each partition. If they are different, it may enable parallel I/O (if the tablespaces are on different disks) and may improve performance.</p>
</li>
<li>
<p>The <code>sdo_indx_dims</code> value must be the same for all partitions.</p>
</li>
<li>
<p>The <code>layer_gtype</code> parameter value (see <a href="constraining-data-geometry-type.htm">Constraining Data to a Geometry Type</a>) used for each partition may be different.</p>
</li>
</ul>
<p>To override the default partitioning values, use a CREATE INDEX statement with the following general format:</p>
<pre dir="ltr">CREATE INDEX &lt;indexname&gt; ON &lt;table&gt;(&lt;column&gt;) 
  INDEXTYPE IS MDSYS.SPATIAL_INDEX 
     [PARAMETERS (&#39;&lt;spatial-params&gt;, &lt;storage-params&gt;&#39;)] LOCAL 
     [( PARTITION &lt;index_partition&gt; 
        PARAMETERS (&#39;&lt;spatial-params&gt;, &lt;storage-params&gt;&#39;) 
     [, PARTITION &lt;index_partition&gt; 
        PARAMETERS (&#39;&lt;spatial-params&gt;, &lt;storage-params&gt;&#39;)] 
     )] 
</pre>
<p>Queries can operate on partitioned tables to perform the query on only one partition. For example:</p>
<pre dir="ltr">SELECT * FROM counties PARTITION(p1)
    WHERE ...&lt;some-spatial-predicate&gt;;
</pre>
<p>Querying on a selected partition may speed up the query and also improve overall throughput when multiple queries operate on different partitions concurrently.</p>
<p>When queries use a partitioned spatial index, the semantics (meaning or behavior) of spatial operators and functions is the same with partitioned and nonpartitioned indexes, except in the case of <a href="sdo_nn.htm">SDO_NN</a> (nearest neighbor). With <a href="sdo_nn.htm">SDO_NN</a>, the requested number of geometries is returned for each partition that is affected by the query. (See the description of the <a href="sdo_nn.htm">SDO_NN</a> operator in <a href="spatial-operators.htm">Spatial Operators</a> for more information.)</p>
<p>For example, if you request the 5 closest restaurants to a point and the spatial index has 4 partitions, <a href="sdo_nn.htm">SDO_NN</a> returns up to 20 (5*4) geometries. In this case, you must use the ROWNUM pseudocolumn (here, <code>WHERE ROWNUM &lt;=5</code>) to return the 5 closest restaurants, and the ORDER BY clause to sort the results by distance in miles. <a href="using-partitioned-spatial-indexes.htm#GUID-DB52CEB5-4A4D-44E5-B6F6-F80E00A39E61__BABEBDJH">Example 5-1</a> returns the 5 nearest restaurants from a partitioned spatial index.</p>
<div class="infobox-note" id="GUID-DB52CEB5-4A4D-44E5-B6F6-F80E00A39E61__GUID-E3894790-548F-4FAF-A864-2C3F46CC64E7">
<p class="notep1">Note:</p>
<p><a href="sdo_nn-examples.htm">SDO_NN Examples</a>for more examples of using the <a href="sdo_nn.htm">SDO_NN</a> operator.</p>
</div>
<p>For a cross-schema query when a table has a partitioned spatial index, the user must be granted SELECT or READ privilege on both the spatial table and the index table (MDRT_<span class="italic">xxx</span>) for the spatial index that was created on the spatial table. For more information and an example, see <span class="q">&#34;<a href="sdo_join.htm#GUID-4D9DD9EF-DD9C-4198-A416-37B900B4E32F__BABBFGFE">Cross-Schema Invocation of SDO_JOIN</a>&#34;</span> in the Usage Notes for the <a href="sdo_join.htm">SDO_JOIN</a> operator in <a href="spatial-operators.htm">Spatial Operators</a> .</p>
<div class="example" id="GUID-DB52CEB5-4A4D-44E5-B6F6-F80E00A39E61__BABEBDJH">
<p class="titleinexample">Example 5-1 SDO_NN Query with Partitioned Spatial Index</p>
<pre dir="ltr">SELECT * FROM
(
SELECT r.name, r.location, SDO_NN_DISTANCE(1) distance_in_miles
FROM restaurants_part_table r
WHERE SDO_NN(r.location,
      MDSYS.SDO_GEOMETRY(2001,8307,MDSYS.SDO_POINT_TYPE(-110,35,Null),Null,Null),
     &#39;SDO_NUM_RES=5 distance=2  unit=MILE&#39;, 1) = &#39;TRUE&#39;
<span class="bold">ORDER BY distance_in_miles</span>
)
<span class="bold">WHERE ROWNUM&lt;=5</span>;
</pre></div>
<!-- class="example" --></div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment142">
<tr>
<td class="cellalignment149">
<table class="cellalignment147">
<tr>
<td class="cellalignment146"><a href="creating-cross-schema-index.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment146"><a href="creating-local-partitioned-spatial-index.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment151">
<table class="cellalignment145">
<tr>
<td class="cellalignment146"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment146"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment146"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment146"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment146"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment146"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>