<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-101212"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/SDO_GEOM.VALIDATE_GEOMETRY_WITH_CONTEXT"></a><title>SDO_GEOM.VALIDATE_GEOMETRY_WITH_CONTEXT</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="VALIDATE_GEOMETRY_WITH_CONTEXT function, SDO_GEOM package, VALIDATE_GEOMETRY_WITH_CONTEXT, validation of geometries, general and two-dimensional checks"/>
<meta name="dcterms.created" content="2017-01-26T11:46:57Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Spatial and Graph Developer&#39;s Guide"/>
<meta name="dcterms.identifier" content="E49172-07"/>
<meta name="dcterms.isVersionOf" content="SPATL"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="sdo_geom-sdo_xor.htm" title="Previous" type="text/html"/>
<link rel="Next" href="sdo_geom-validate_layer_with_context.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E49172-07.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-5243762A-A199-48FF-87BB-B5955F4FF604"></a> <span id="PAGE" style="display:none;">301/475</span> <!-- End Header -->
<a id="SPATL1131"></a><a id="SPATL1130"></a>
<h1 id="SPATL-GUID-5243762A-A199-48FF-87BB-B5955F4FF604" class="sect1"><span class="enumeration_section">23.33</span> SDO_GEOM.VALIDATE_GEOMETRY_WITH_CONTEXT</h1>
<div>
<div class="section">
<p class="subhead1">Format</p>
<pre dir="ltr">SDO_GEOM.VALIDATE_GEOMETRY_WITH_CONTEXT(     
  theGeometry  IN SDO_GEOMETRY,      
  theDimInfo   IN SDO_DIM_ARRAY,      
  conditional  IN VARCHAR2 DEFAULT &#39;TRUE&#39; ,      
  flag10g      IN VARCHAR2 DEFAULT &#39;FALSE&#39;       
) RETURN VARCHAR2;
</pre>
<p>or</p>
<pre dir="ltr">SDO_GEOM.VALIDATE_GEOMETRY_WITH_CONTEXT(     
  theGeometry  IN SDO_GEOMETRY,      
  tolerance    IN NUMBER,      
  conditional  IN VARCHAR2 DEFAULT &#39;TRUE&#39; ,      
  flag10g      IN VARCHAR2 DEFAULT &#39;FALSE&#39;       
) RETURN VARCHAR2;
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead1">Description</p>
<p>Performs a <a id="d133423e68" class="indexterm-anchor"></a>consistency check for valid geometry types and returns context information if the geometry is invalid. The function checks the representation of the geometry from the tables against the element definitions.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead1">Parameters</p>
<dl>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-101207"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-5243762A-A199-48FF-87BB-B5955F4FF604__GUID-D02E942B-B501-4870-9195-46DE6A2C0FFD"><!-- --></a>theGeometry</dt>
<dd>
<p>Geometry object.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-101208"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-5243762A-A199-48FF-87BB-B5955F4FF604__GUID-CC813A1F-EBFA-49A1-84D9-435F363B99B9"><!-- --></a>theDimInfo</dt>
<dd>
<p>Dimensional information array corresponding to <code>theGeometry</code>, usually selected from one of the xxx_SDO_GEOM_METADATA views (described in <a href="geometry-metadata-views.htm#GUID-AEA8FA01-880B-4865-8074-3B6FBD17A5E1">Geometry Metadata Views</a>).</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-101209"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-5243762A-A199-48FF-87BB-B5955F4FF604__GUID-CC922571-0107-4BB9-8FAE-32A4F0F146E5"><!-- --></a>tolerance</dt>
<dd>
<p>Tolerance value (see <a href="data-model.htm#GUID-7469388B-6D23-4294-904F-78CA3B7191D3">Tolerance</a>).</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-101210"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-5243762A-A199-48FF-87BB-B5955F4FF604__GUID-E73789E4-AFED-49FB-957D-8D3F3C4215E7"><!-- --></a>conditional</dt>
<dd>
<p>Conditional flag; relevant only for a three-dimensional composite surface or composite solid. A string value of <code>TRUE</code> (the default) causes validation to fail if two outer rings are on the same plane and share an edge; a string value of <code>FALSE</code> does not cause validation to fail if two outer rings are on the same plane and share an edge.</p>
</dd>
<dt class="dlterm"><a class="dashingAutolink" name="autolink-101211"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="GUID-5243762A-A199-48FF-87BB-B5955F4FF604__GUID-D9A80763-5335-4479-9F32-E06B8CFAB599"><!-- --></a>flag10g</dt>
<dd>
<p>Oracle Database 10<span class="italic">g</span> compatibility flag. A string value of <code>TRUE</code> causes only validation checks specific to two-dimensional geometries to be performed, and no 3D-specific validation checks to be performed. A string value of <code>FALSE</code> (the default) performs all validation checks that are relevant for the geometry. (See the Usage Notes for more information about the <code>flag10g</code> parameter.)</p>
</dd>
</dl>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead1">Usage Notes</p>
<p>You should validate all geometry data, and fix any validation errors, before performing any spatial operations on the data, as explained in <a href="recommendations-loading-and-validating-spatial-data.htm">Recommendations for Loading and Validating Spatial Data</a>.</p>
<p>If the geometry is valid, this function returns TRUE. (For a user-defined geometry, that is, a geometry with an SDO_GTYPE value of 2000, this function returns the string NULL.)</p>
<p>If the geometry is not valid, this function returns the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>An Oracle error message number based on the specific reason the geometry is invalid, or FALSE if the geometry fails for some other reason</p>
</li>
<li>
<p>The context of the error (the coordinate, edge, or ring that causes the geometry to be invalid). (See <span class="q">&#34;<a href="sdo_geom-validate_geometry_with_context.htm#GUID-5243762A-A199-48FF-87BB-B5955F4FF604__CACDHEDE">Context of Errors: Details</a>&#34;</span> in this section.)</p>
</li>
</ul>
<p>This function checks for type consistency and geometry consistency.</p>
<p>For type consistency, the function checks for the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>The SDO_GTYPE is valid.</p>
</li>
<li>
<p>The SDO_ETYPE values are consistent with the SDO_GTYPE value. For example, if the SDO_GTYPE is 2003, there should be at least one element of type POLYGON in the geometry.</p>
</li>
<li>
<p>The SDO_ELEM_INFO_ARRAY has valid triplet values.</p>
</li>
</ul>
<p>For geometry consistency, the function checks for the following, as appropriate for the specific geometry type:</p>
<ul style="list-style-type: disc;">
<li>
<p>Polygons have at least four points, which includes the point that closes the polygon. (The last point is the same as the first.)</p>
</li>
<li>
<p>Polygons are not self-crossing.</p>
</li>
<li>
<p>No two vertices on a line or polygon are the same.</p>
</li>
<li>
<p>Polygons are oriented correctly. (Exterior ring boundaries must be oriented counterclockwise, and interior ring boundaries must be oriented clockwise.)</p>
</li>
<li>
<p>The interior of a polygon is connected.</p>
</li>
<li>
<p>Line strings have at least two points.</p>
</li>
<li>
<p>SDO_ETYPE 1-digit and 4-digit values are not mixed (that is, both used) in defining polygon ring elements.</p>
</li>
<li>
<p>Points on an arc are not colinear (that is, are not on a straight line) and are not the same point.</p>
</li>
<li>
<p>Geometries are within the specified bounds of the applicable DIMINFO column value (from the USER_SDO_GEOM_METADATA view).</p>
</li>
<li>
<p>LRS geometries (see <a href="linear-referencing-system.htm">Linear Referencing System</a>) have three or four dimensions and a valid measure dimension position (3 or 4, depending on the number of dimensions).</p>
</li>
</ul>
<p>For COLLECTION type geometries, some of the preceding checks mentioned above are not performed. Specifically, interior ring checks and polygon-polygon overlap checks are not performed for polygon elements of the COLLECTION type geometry.</p>
<p>For multipoint geometries, this function checks for duplicate vertices with three-dimensional geometries, but not with two-dimensional geometries.</p>
<p>For three-dimensional geometries, this function also performs the checks described in <a href="validation-checks-three-dimensional-geometries.htm">Validation Checks for Three-Dimensional Geometries</a>.</p>
<p>In checking for geometry consistency, the function considers the geometry&#39;s tolerance value in determining if lines touch or if points are the same.</p>
<p>If the function format with <code>tolerance</code> is used, no checking is done to validate that the geometry is within the coordinate system bounds as stored in the DIMINFO field of the USER_SDO_GEOM_METADATA view. If this check is required for your usage, use the function format with <code>theDimInfo</code>.</p>
<p>Setting the <code>flag10g</code> parameter value to <code>TRUE</code> causes the validation logic for Oracle Spatial Release 10.2 to be used, irrespective of the dimensionality of the geometry. This can be useful for allowing three-dimensional geometries that contain geometries in pre-Release 11.1 format to pass the validation check when they would otherwise fail. For example, a three-dimensional line is not valid if it contains circular arcs; and setting <code>flag10g</code> to <code>TRUE</code> will allow such geometries to avoid being considered invalid solely because of the circular arcs. (You should later make these geometries valid according to the criteria for the current release, such as by densifying the circular arcs.)</p>
<p>You can use this function in a PL/SQL procedure as an alternative to using the <a href="sdo_geom-validate_layer_with_context.htm">SDO_GEOM.VALIDATE_LAYER_WITH_CONTEXT</a> procedure. See the Usage Notes for <a href="sdo_geom-validate_layer_with_context.htm">SDO_GEOM.VALIDATE_LAYER_WITH_CONTEXT</a> for more information.</p>
<p id="GUID-5243762A-A199-48FF-87BB-B5955F4FF604__CACDHEDE">Context of Errors: Details</p>
<p>If a geometry is invalid, the result can include information about a combination of the following: coordinates, elements, rings, and edges.</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Coordinates</span>: A coordinate refers to a vertex in a geometry. In a two-dimensional geometry, a vertex is two numbers (X and Y, or Longitude and Latitude). In a three-dimensional geometry, a vertex is defined using three numbers; and in a four-dimensional geometry, a vertex is defined using four numbers. (You can use the <a href="sdo_util-getvertices.htm">SDO_UTIL.GETVERTICES</a> function to return the coordinates in a geometry.)</p>
<p>If you receive a geometry validation error such as 13356 (adjacent points in a geometry are redundant), you can call the <a href="sdo_util-getvertices.htm">SDO_UTIL.GETVERTICES</a> function, specifying a rownum stopping condition to include the coordinate one greater than the coordinate indicated with the error. The last two coordinates shown in the output are the redundant coordinates. These coordinates may be exactly the same, or they may be within the user-specified tolerance and thus are considered the same point. You can remove redundant coordinates by using the <a href="sdo_util-remove_duplicate_vertices.htm">SDO_UTIL.REMOVE_DUPLICATE_VERTICES</a> function.</p>
</li>
<li>
<p><span class="bold">Elements</span>: An element is a point, a line string, or an exterior polygon with zero or more corresponding interior polygons. (That is, a polygon element includes the exterior ring and all interior rings associated with that exterior ring.) If a geometry is a multi-element geometry (for example, multiple points, lines, or polygons), the first element is element 1, the second element is element 2, and so on.</p>
</li>
<li>
<p><span class="bold">Rings</span>: A ring is only used with polygon elements. Exterior rings in a polygon are considered polygon elements, and an exterior ring can include zero or more interior rings (or holes). Each interior ring has its own ring designation, but Ring 1 is associated with the exterior polygon itself. For example, Element 1, Ring 1 refers to the first exterior polygon in a geometry; Element 1, Ring 2 refers to the first interior polygon of the first exterior polygon; and Element 1, Ring 3 refers to the second interior polygon. If the geometry is a multipolygon, Element 2, Ring 1 is used to refers to the second exterior polygon. If there are interior polygons associated with it, Element 2, Ring 2 refers to the first interior polygon of the second exterior polygon.</p>
</li>
<li>
<p><span class="bold">Edges</span>: An edge refers to a line segment between two coordinates. Edge 1 refers to the segment between coordinate 1 and coordinate 2, Edge 2 refers to the line segment between coordinates 2 and 3, and so on. <a id="d133423e295" class="indexterm-anchor"></a><a id="d133423e297" class="indexterm-anchor"></a>The most common place to see edge errors when validating geometries is with self-intersecting polygons. (The Open Geospatial Consortium simple features specification does not allow a polygon to self-intersect.) In such cases, Oracle reports error 13349 (polygon boundary crosses itself), including the Element, Ring, and Edge numbers where self-intersection occurs.</p>
<p>If error 13351 (shared edge) is returned for an optimized rectangle that spans more than 119 degrees in longitude, some queries on this rectangle will return correct results, as explained in <a href="geodetic-coordinate-support.htm#GUID-AFB77449-C15A-4A64-9A66-384C16413C98">Geodetic MBRs</a>.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead1">Examples</p>
<p>The following example validates a geometry (deliberately created as invalid) named <code>cola_invalid_geom</code>.</p>
<pre dir="ltr">-- Validate; provide context if invalid
SELECT c.name, SDO_GEOM.VALIDATE_GEOMETRY_WITH_CONTEXT(c.shape, 0.005)
   FROM cola_markets c WHERE c.name = &#39;cola_invalid_geom&#39;;

NAME                                                                            
--------------------------------                                                
SDO_GEOM.VALIDATE_GEOMETRY_WITH_CONTEXT(C.SHAPE,0.005)                          
--------------------------------------------------------------------------------
cola_invalid_geom                                                               
13349 [Element &lt;1&gt;] [Ring &lt;1&gt;][Edge &lt;1&gt;][Edge &lt;3&gt;] 
</pre>
<p>In the output for this example, 13349 indicates the error <code>ORA-13349: polygon boundary crosses itself</code>. The first ring of the first element has edges that intersect. The edges that intersect are edge 1 (the first and second vertices) and edge 3 (the third and fourth vertices).</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead1">Related Topics</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="sdo_geom-validate_layer_with_context.htm">SDO_GEOM.VALIDATE_LAYER_WITH_CONTEXT</a></p>
</li>
<li>
<p><a href="sdo_geom-sdo_self_union.htm">SDO_GEOM.SDO_SELF_UNION</a></p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment142">
<tr>
<td class="cellalignment149">
<table class="cellalignment147">
<tr>
<td class="cellalignment146"><a href="sdo_geom-sdo_xor.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment146"><a href="sdo_geom-validate_layer_with_context.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment151">
<table class="cellalignment145">
<tr>
<td class="cellalignment146"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment146"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment146"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment146"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment146"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment146"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>