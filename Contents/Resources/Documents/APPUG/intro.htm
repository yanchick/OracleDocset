<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-2141"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Introduction%20to%20Oracle%20Database%20Gateway%20for%20APPC"></a><title>Introduction to Oracle Database Gateway for APPC</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1090"/>
<meta name="dcterms.created" content="2017-06-08T15:9:56Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Gateway for APPC User&#39;s Guide"/>
<meta name="dcterms.identifier" content="E17931-04"/>
<meta name="dcterms.isVersionOf" content="APPUG"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="preface.htm" title="Previous" type="text/html"/>
<link rel="Next" href="admin_util.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E17931-04.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">6/20</span> <!-- End Header -->
<div id="APPUG100" class="chapter"><a id="g1024329"></a> <a id="i1006259"></a>
<h1 class="chapter"><span class="secnum">1</span> Introduction to Oracle Database Gateway for APPC</h1>
<p>The Oracle Database Gateway for APPC enables users to initiate transaction program execution on remote <a id="sthref9"></a>online transaction processors (OLTPs). The Oracle Database Gateway for APPC can establish connection with OLTP using the SNA communication protocol. The gateway can also use TCP/IP for IMS Connect to establish communication with <a id="sthref10"></a>IMS/TM through TCP/IP. The gateway provides Oracle applications with seamless access to IBM mainframe data and services through <a id="sthref11"></a>Remote Procedural Call (RPC) processing.</p>
<p>Refer to the <a class="olink GINST" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=GINST"><span class="italic">Oracle Database Installation Guide</span></a> and to the certification matrix on the My Oracle Support Web site for the most up-to-date list of certified hardware platforms and operating system versions. The My Oracle Support Web site can be found at:</p>
<p><code dir="ltr"><a href="https://support.oracle.com">https://support.oracle.com</a></code></p>
<p>This chapter describes the architecture, uses, and features of the Oracle Database Gateway for APPC.</p>
<p>This chapter contains the following sections:</p>
<ul>
<li>
<p><a href="#i1009845">Overview of the Gateway</a></p>
</li>
<li>
<p><a href="#i1009853">Features of the Gateway</a></p>
</li>
<li>
<p><a href="#i1009861">Terms</a></p>
</li>
<li>
<p><a href="#i1009869">Examples and Sample Files for the Gateway</a></p>
</li>
<li>
<p><a href="#i1007873">Architecture of the Gateway</a></p>
</li>
<li>
<p><a href="#i1016173">Communication with the Gateway</a></p>
</li>
<li>
<p><a href="#i1009907">RPC Functions</a></p>
</li>
<li>
<p><a href="#BGBHAGAC">Overview of a Gateway Using SNA</a></p>
</li>
<li>
<p><a href="#BGBCDABF">Overview of a Gateway Using TCP/IP</a></p>
</li>
</ul>
<a id="i1009845"></a>
<div id="APPUG901" class="sect1">
<h2 class="sect1">Overview of the Gateway<a id="sthref12"></a><a id="sthref13"></a></h2>
<p>The Oracle Database Gateway for APPC extends the <a id="sthref14"></a>RPC <a id="sthref15"></a><a id="sthref16"></a>facilities available with the Oracle database. The gateway enables any client application to use <a id="sthref17"></a>PL/SQL to request execution of a remote transaction<a id="sthref18"></a> program (RTP) residing on a host. The gateway provides RPC processing to systems using the <a id="sthref19"></a>SNA Advanced Program-to-Program Communication (APPC) protocol and to IMS/TM systems using <a id="sthref20"></a>TCP/IP support for IMS Connect. This architecture allows efficient access to data and transactions available on the IBM mainframe and <a id="sthref21"></a>IMS, respectively.</p>
<p>The gateway requires no Oracle software on the remote host system. Thus, the gateway uses existing transactions with little or no programming effort on the remote host.</p>
<p class="subhead2"><a id="APPUG1155"></a>For gateways using SNA only:</p>
<p><a id="sthref22"></a>The use of a generic and standard protocol, APPC, allows the gateway to access numerous systems. The <a id="sthref23"></a>gateway can communicate with virtually any APPC-enabled system, including IBM Corporation&#39;s CICS on any platform and IBM Corporation&#39;s IMS and APPC/MVS. These transaction monitors provide access to a broad range of systems, allowing the gateway to access many <a id="sthref24"></a><a id="sthref25"></a>datastores, including VSAM, DB2 (static SQL), IMS, and others.</p>
<p>The gateway can access any application capable of using the CPI-C API, either directly or through a TP monitor such as CICS.</p>
</div>
<!-- class="sect1" -->
<a id="i1009853"></a>
<div id="APPUG902" class="sect1">
<h2 class="sect1">Features of the Gateway</h2>
<p>The Oracle Database Gateway for APPC provides the following benefits:</p>
<ul>
<li>
<p><a id="sthref26"></a>Fast interface</p>
<p>The gateway is optimized so that remote execution of a program is achieved with minimum network traffic. The interface to the gateway is an optimized PL/SQL stored procedure specification (called the TIP or transaction interface package) precompiled in the <a id="sthref27"></a>Oracle database. Because there are no additional software layers on the remote host, overhead occurs only when your program executes.</p>
</li>
<li>
<p>Location <a id="sthref28"></a><a id="sthref29"></a>transparency</p>
<p>Client applications need not be operating system-specific. For example, your application can call a program in a CICS Transaction Server for z/OS. If you move the program to a CICS region on AIX, then you need not change the application.</p>
</li>
<li>
<p>Application<a id="sthref30"></a><a id="sthref31"></a> transparency</p>
<p>Users calling applications that execute a remote transaction program are unaware that a request is sent to a host.</p>
</li>
<li>
<p><a id="sthref32"></a>Flexible interface</p>
<p>You can use the gateway to interface with existing procedural logic or to integrate new procedural logic into an Oracle database environment.</p>
</li>
<li>
<p><a id="sthref33"></a>Oracle database integration</p>
<p>The integration of the Oracle database with the gateway enables the gateway to benefit from existing and future Oracle database features. For example, the gateway can be called from an Oracle stored procedure or database trigger.</p>
</li>
<li>
<p>Transactional support</p>
<p>The gateway and the Oracle database allow remote transfer updates and Oracle database updates to be performed in a coordinated fashion.</p>
</li>
<li>
<p>Wide selection of <a id="sthref34"></a>tools</p>
<p>The gateway supports any tool or application that supports PL/SQL.</p>
</li>
<li>
<p><a id="sthref35"></a><a id="sthref36"></a>PL/SQL code generator</p>
<p>The <a id="sthref37"></a>Oracle Database Gateway for APPC provides a powerful development environment, including:</p>
<ul>
<li>
<p>a data dictionary to store information relevant to the remote transaction</p>
</li>
<li>
<p>a tool to generate the PL/SQL Transaction Interface Package, or TIP</p>
</li>
<li>
<p>a report utility to view the information stored in the gateway dictionary</p>
</li>
<li>
<p>a complete set of tracing and debugging facilities</p>
</li>
<li>
<p>a wide set of samples to demonstrate the use of the product against datastores such as DB2, IMS, and CICS.</p>
</li>
</ul>
</li>
<li>
<p><a id="sthref38"></a>Site autonomy and security</p>
<p>The gateway provides site autonomy, allowing you to do such things as authenticate users. It also provides role-based security compatible with any security package running on your mainframe computer.</p>
</li>
<li>
<p><a id="sthref39"></a>Automatic conversion</p>
<p>Through the <a id="sthref40"></a>TIP, the following conversions are performed:</p>
<ul>
<li>
<p><a id="sthref41"></a>ASCII to and from <a id="sthref42"></a>EBCDIC</p>
</li>
<li>
<p>remote transaction program datatypes to and from PL/SQL datatypes</p>
</li>
<li>
<p>national language support for many languages</p>
</li>
</ul>
</li>
<li>
<p>Globalization Support</p>
</li>
<li>
<p>TCP/IP support for IMS Connect</p>
<p><a id="sthref43"></a>This release of the gateway includes TCP/IP support for IMS Connect, giving users a choice of whether to use an SNA or TCP/IP communication protocol. IMS Connect is an IBM product which allows TCP/IP clients to trigger execution of IMS transactions. The gateway can use a TCP/IP communication protocol to access IMS Connect, which triggers execution of IMS transactions. There is no SNA involvement with this configuration.</p>
<p>Related to this feature of the gateway is:</p>
<ul>
<li>
<p>The <a id="sthref44"></a>gateway mapping tool. This release of the gateway includes a tool (<a id="sthref45"></a><code dir="ltr">pg4tcpmap</code>) whose purpose is to map the information from your SNA Side Profile Name to the TCP/IP host name and Port Number.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
When your communications protocol is <a id="sthref46"></a><a id="sthref47"></a>TCP/IP, only IMS is supported as the OLTP.</div>
</li>
</ul>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="i1009861"></a>
<div id="APPUG903" class="sect1">
<h2 class="sect1">Terms<a id="sthref48"></a></h2>
<p>The following terms and definitions are used throughout this guide:</p>
<p class="subhead1"><a id="APPUG1156"></a>Gateway Initialization File<a id="sthref49"></a></p>
<p>This file is known as <a id="sthref50"></a><a id="sthref51"></a><code dir="ltr">init<span class="italic">sid</span>.ora</code> and it contains parameters that govern the operation of the gateway. If you are using the SNA protocol, refer to Appendix&nbsp;A, &#34;Gateway Initialization Parameters for SNA Protocol&#34; in the <a class="olink APPCI283" href="../APPCI/apa.htm#APPCI283"><span class="italic">Oracle Database Gateway for APPC Installation and Configuration Guide for IBM AIX on POWER Systems (64-Bit), Linux x86-64, Oracle Solaris on SPARC (64-Bit), and HP-UX Itanium</span></a> or <a class="olink APPCW258" href="../APPCW/apa.htm#APPCW258"><span class="italic">Oracle Database Gateway for APPC Installation and Configuration Guide for Microsoft Windows</span></a> for more information. If your protocol is TCP/IP, refer to Appendix&nbsp;B, &#34;Gateway Initialization Parameters for TCP/IP Communication Protocol&#34; in the <a class="olink APPCI290" href="../APPCI/apb.htm#APPCI290"><span class="italic">Oracle Database Gateway for APPC Installation and Configuration Guide for IBM AIX on POWER Systems (64-Bit), Linux x86-64, Oracle Solaris on SPARC (64-Bit), and HP-UX Itanium</span></a> or <a class="olink APPCW265" href="../APPCW/apb.htm#APPCW265"><span class="italic">Oracle Database Gateway for APPC Installation and Configuration Guide for Microsoft Windows</span></a>.</p>
<p class="subhead1"><a id="i1008974"></a><a id="APPUG1157"></a><a id="sthref52"></a><a id="sthref53"></a><a id="sthref54"></a><a id="sthref55"></a><a id="sthref56"></a>Gateway Remote Procedure</p>
<p>The Oracle Database Gateway for APPC provides prebuilt remote procedures. In general, <a id="sthref57"></a><a id="sthref58"></a><a id="sthref59"></a>the following three remote procedures are used:</p>
<ul>
<li>
<p><code dir="ltr">PGAINIT</code>, which initializes transactions</p>
</li>
<li>
<p><code dir="ltr">PGAXFER</code>, which transfers data</p>
</li>
<li>
<p><code dir="ltr">PGATERM</code>, which terminates transactions</p>
</li>
</ul>
<p>Refer to <a href="apb.htm#g639177">Appendix B, &#34;Gateway RPC Interface&#34;</a> in this guide and to &#34;Remote Procedural Call Functions&#34; in Chapter&nbsp;1 of the <a class="olink APPCI101" href="../APPCI/ch1.htm#APPCI101"><span class="italic">Oracle Database Gateway for APPC Installation and Configuration Guide for IBM AIX on POWER Systems (64-Bit), Linux x86-64, Oracle Solaris on SPARC (64-Bit), and HP-UX Itanium</span></a> or <a class="olink APPCW101" href="../APPCW/ch1.htm#APPCW101"><span class="italic">Oracle Database Gateway for APPC Installation and Configuration Guide for Microsoft Windows</span></a> for more information about gateway remote procedures.</p>
<p class="subhead1"><a id="APPUG1158"></a><a id="sthref60"></a>dg4pwd</p>
<p><code dir="ltr"><a id="sthref61"></a><a id="sthref62"></a></code><code dir="ltr">dg4pwd</code> is a utility which encrypts passwords that are normally stored in the gateway initialization file. Passwords are stored in an encrypted form in the password file, making the information more secure. Refer to &#34;Passwords in the Gateway Initialization File&#34; in the security requirements chapter of the <a class="olink APPCI256" href="../APPCI/ch14.htm#APPCI256"><span class="italic">Oracle Database Gateway for APPC Installation and Configuration Guide for IBM AIX on POWER Systems (64-Bit), Linux x86-64, Oracle Solaris on SPARC (64-Bit), and HP-UX Itanium</span></a> and <a class="olink APPCW232" href="../APPCW/ch11.htm#APPCW232"><span class="italic">Oracle Database Gateway for APPC Installation and Configuration Guide for Microsoft Windows</span></a> for detailed information about how the <code dir="ltr">dg4pwd</code> utility works.</p>
<p class="subhead1"><a id="APPUG1159"></a><a id="sthref63"></a>pg4tcpmap Tool</p>
<p>This tool is applicable only when the gateway is using TCP/IP support for IMS Connect. Its function is to map SNA parameters (such as Side Profile Name) to TCP/IP parameters (such as OLTP host name, IMS Connect port number and IMS destination ID).</p>
<p class="subhead1"><a id="APPUG1160"></a><a id="sthref64"></a>PGA (Procedural Gateway Administration)</p>
<p>PGA is a general reference within this guide to all or most components comprising the Oracle Database Gateway for APPC. This term is used when references to a specific product or component are too narrow.</p>
<p class="subhead1"><a id="APPUG1161"></a><a id="sthref65"></a><a id="sthref66"></a>PGDL (Procedural Gateway Definition Language)</p>
<p>PGDL is the collection of statements used to define transactions and data to the PGAU.</p>
<p class="subhead1"><a id="APPUG1162"></a>PL/SQL <a id="sthref67"></a><a id="sthref68"></a>Stored Procedure Specification (PL/SQL package)</p>
<p>This is a precompiled PL/SQL procedure that is stored in Oracle database.</p>
<p class="subhead1"><a id="APPUG1163"></a><a id="sthref69"></a><a id="sthref70"></a>UTL_RAW PL/SQL Package (the UTL_RAW Functions)</p>
<p>This component of the gateway represents a series of data conversion functions for PL/SQL RAW variables and remote host data. The types of conversions performed depend on the language of the remote host data. Refer to <a href="apd.htm#g640607">Appendix D, &#34;Datatype Conversions&#34;</a> in this guide for more information.</p>
<p class="subhead1"><a id="APPUG1164"></a><a id="sthref71"></a><a id="sthref72"></a>UTL_PG PL/SQL Package (the UTL_PG Functions)</p>
<p>This component of the gateway represents a series of COBOL numeric data conversion functions. Refer to <a href="apc.htm#i635625">&#34;NUMBER_TO_RAW and RAW_TO_NUMBER Argument Values&#34;</a> in <a href="apc.htm#g656113">Appendix C</a> of this guide for supported numeric datatype conversions.</p>
<p class="subhead1"><a id="APPUG1165"></a>Oracle Database<a id="sthref73"></a></p>
<p>This is any Oracle database instance that communicates with the gateway for purposes of performing RPCs to execute <a id="sthref74"></a>RTP. The Oracle database can be on the same system as the gateway or on a different system. If it is on a different system, then <a id="sthref75"></a>Oracle Net is required on both systems. Refer to <a href="#i1006880">Figure 1-2, &#34;Gateway Architecture Featuring SNA or TCP/IP Protocol&#34;</a> for a view of the gateway architecture.</p>
<p class="subhead1"><a id="APPUG1166"></a>O<a id="sthref76"></a>LTP (Online Transaction Processor)</p>
<p>OLTP is any of a number of online transaction processors available from other vendors, including CICS Transaction Server for z/OS and IMS/TM.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
When your communications protocol is <a id="sthref77"></a><a id="sthref78"></a>TCP/IP, only IMS is supported as the OLTP. <a id="sthref79"></a><a id="sthref80"></a></div>
<p class="subhead1"><a id="APPUG1167"></a><a id="sthref81"></a>PGAU (Procedural Gateway Administration Utility)</p>
<p>PGAU is the tool that is used to define and generate <a id="sthref82"></a>PL/SQL transaction interface packages (TIPs). Refer to <a href="admin_util.htm#g1029659">Chapter 2, &#34;Procedural Gateway Administration Utility&#34;</a> in this guide for more information about PGAU.</p>
<p class="subhead1"><a id="APPUG1168"></a><a id="sthref83"></a>PG DD (Procedural Gateway Data Dictionary)</p>
<p>This component of the gateway is a repository of remote host transaction definitions and data definitions. <a id="sthref84"></a>PGAU accesses definitions in the PG&nbsp;DD when generating TIPs. The PG DD has datatype dependencies because it supports the PGAU and is not intended to be directly accessed by the customer. Refer to <a href="apa.htm#g650736">Appendix A, &#34;Database Gateway for APPC Data Dictionary&#34;</a> in this guide for a list of PG&nbsp;DD tables.</p>
<p class="subhead1"><a id="APPUG1169"></a><a id="sthref85"></a>RPC (Remote Procedural Call)</p>
<p>RPC is a programming call that executes program logic on one system in response to a request from another system. Refer to &#34;Gateway Remote Procedure&#34; in Appendix&nbsp;C of the <a class="olink APPCI296" href="../APPCI/apc.htm#APPCI296"><span class="italic">Oracle Database Gateway for APPC Installation and Configuration Guide for IBM AIX on POWER Systems (64-Bit), Linux x86-64, Oracle Solaris on SPARC (64-Bit), and HP-UX Itanium</span></a>or <a class="olink APPCW271" href="../APPCW/apc.htm#APPCW271"><span class="italic">Oracle Database Gateway for APPC Installation and Configuration Guide for Microsoft Windows</span></a> , and to <a href="apb.htm#g639177">Appendix B, &#34;Gateway RPC Interface&#34;</a> in this guide for more information.</p>
<p class="subhead1"><a id="APPUG1170"></a><a id="sthref86"></a>RTP (Remote Transaction Program)</p>
<p>A remote transaction program is a customer-written transaction, running under the control of an OLTP, which the user invokes remotely using a PL/SQL procedure. To execute a remote transaction program through the gateway, you must use RPC to execute a PL/SQL program to call the gateway functions.</p>
<p class="subhead1"><a id="APPUG1171"></a><a id="sthref87"></a>TIP (Transaction Interface Package)</p>
<p>A <a id="sthref88"></a>TIP is an Oracle <a id="sthref89"></a>PL/SQL package that exists between your application and the remote transaction program. The transaction interface package, or TIP, is a set of PL/SQL stored procedures that invoke the RTP through the gateway. TIPs perform the conversion and reformatting of remote host data using PL/SQL and <code dir="ltr">UTL_RAW/UTL_PG</code> functions.</p>
<p><a href="#i1006739">Figure 1-1</a> illustrates where the terminology discussed in the preceding sections applies to the gateway&#39;s architecture.</p>
<div id="APPUG1172" class="figure">
<p class="titleinfigure"><a id="i1006739"></a>Figure 1-1 Relationship of Gateway and Oracle Database</p>
<img width="505" height="385" src="img/trms1_1.gif" alt="Description of Figure 1-1 follows"/><br/>
<a id="sthref90" href="img_text/trms1_1.htm">Description of &#39;&#39;Figure 1-1 Relationship of Gateway and Oracle Database &#39;&#39;</a><br/>
<br/></div>
<!-- class="figure" --></div>
<!-- class="sect1" -->
<a id="i1009869"></a>
<div id="APPUG904" class="sect1">
<h2 class="sect1">Examples and Sample Files for the Gateway<a id="sthref91"></a></h2>
<p>The following sample files and examples are referred to for illustration purposes throughout this guide. There are different example and sample files for a gateway using the SNA protocol than for a gateway using TCP/IP for IMS Connect.</p>
<p class="subhead1"><a id="APPUG1173"></a>Examples and Sample Files for Gateway Using SNA</p>
<p><a id="sthref92"></a>For gateways using the SNA communication protocol, this guide uses a CICS-DB2 inquiry as an example. Transaction Interface Packages (TIPs) <a id="sthref93"></a><a id="sthref94"></a><code dir="ltr">pgadb2i.pkb</code> and <a id="sthref95"></a><a id="sthref96"></a><code dir="ltr">pgadb2i.pkh</code> send an employee number, <code dir="ltr">empno</code>, to a DB2 application and receive an employee record, <code dir="ltr">emprec</code>.</p>
<p>The CICS-DB2 inquiry sample and its associated PGAU commands are also available in the <code dir="ltr">%ORACLE_HOME%\dg4appc\demo\CICS</code> directory on Windows platform and <code dir="ltr">$ORACLE_HOME/dg4appc/demo/CICS</code> directory on UNIX platforms. The sample CICS-DB2 inquiry used as an example in this chapter is in files <a id="sthref97"></a><a id="sthref98"></a><code dir="ltr">pgadb2i.pkh</code> and <a id="sthref99"></a><a id="sthref100"></a><code dir="ltr">pgadb2i.pkb</code>. Refer to the <code dir="ltr">README.doc</code> file in the same directory for information about installing and using the samples. It can be found in the <code dir="ltr">%ORACLE_HOME%\dg4appc\demo\CICS</code> directory for Windows and <code dir="ltr">$ORACLE_HOME/dg4appc/demo/CICS</code> directory for UNIX.</p>
<p class="subhead2"><a id="APPUG1174"></a>Examples and Sample Files for Gateway Using <a id="sthref101"></a><a id="sthref102"></a>TCP/IP</p>
<p>If your gateway is using the TCP/IP communication protocol, this guide uses an IMS inquiry as an example. Transaction Interface Packages (<a id="sthref103"></a>TIPs) <code dir="ltr"><a id="sthref104"></a>pgtflip.pkh</code> and <code dir="ltr"><a id="sthref105"></a><a id="sthref106"></a>pgtflip.pkb</code> send input to IMS, through IMS Connect, and receive the flipped input as the output.</p>
<p>The <a id="sthref107"></a>IMS inquiry sample (FLIP) and its associated PGAU commands are located in the <code dir="ltr">%ORACLE_HOME%\dg4appc\demo\IMS</code> directory for Windows and <code dir="ltr">$ORACLE_HOME/dg4appc/demo/IMS</code> directory for UNIX. The sample IMS inquiry used as an example for a gateway using TCP/IP is located in files <code dir="ltr">pgtflip.pkh</code> and <code dir="ltr"><a id="sthref108"></a>pgtflip.pkb</code>.</p>
<p>Refer to the <code dir="ltr">README.doc</code> file for more information about installing and using other IMS samples. It can be found in the <code dir="ltr">%ORACLE_HOME%\dg4appc\demo\IMS</code> directory for Windows and <code dir="ltr">$ORACLE_HOME/dg4appc/demo/IMS</code> directory for UNIX.</p>
</div>
<!-- class="sect1" -->
<a id="i1007873"></a>
<div id="APPUG905" class="sect1">
<h2 class="sect1">Architecture of the Gateway</h2>
<p>The architecture of Oracle Database Gateway for APPC consists of several components:<a id="sthref109"></a><a id="sthref110"></a><a id="sthref111"></a><a id="sthref112"></a></p>
<ol>
<li>
<p><a id="sthref113"></a>Oracle database</p>
<p>Refer to the configuration chapter corresponding to your communications protocol in the <a class="olink APPCI" href="../APPCI/toc.htm"><span class="italic">Oracle Database Gateway for APPC Installation and Configuration Guide for IBM AIX on POWER Systems (64-Bit), Linux x86-64, Oracle Solaris on SPARC (64-Bit), and HP-UX Itanium</span></a> or <a class="olink APPCW" href="../APPCW/toc.htm"><span class="italic">Oracle Database Gateway for APPC Installation and Configuration Guide for Microsoft Windows</span></a>for a description of the various methods for establishing the gateway-Oracle database relationship.</p>
<p>The Oracle database can also be used for non-gateway applications.</p>
</li>
<li>
<p>The gateway</p>
<p>Oracle Database Gateway for APPC must be installed on a server that can run the <a id="sthref114"></a>required version of the operating system.</p>
</li>
<li>
<p>An OLTP</p>
<p>The OLTP must be accessible from the gateway using your SNA or TCP/IP communication protocol. Multiple <a id="sthref115"></a><a id="sthref116"></a>Oracle databases can access the same gateway. A single system gateway installation can be configured to access more than one OLTP.</p>
<ul>
<li>
<p><span class="italic">For gateways using <a id="sthref117"></a><a id="sthref118"></a>TCP/IP:</span> The only <a id="sthref119"></a>OLTP that is supported through TCP/IP is IMS through IMS Connect.The OLTP must be accessible to the system using the TCP/IP protocol. Multiple <a id="sthref120"></a>Oracle databases can access the same gateway. A single system gateway installation can be configured to access more than one OLTP. Multiple IMS systems can be accessed from an IMS Connect. If you have a number of IMS Connect systems available, any of these may be connected to one or more IMS systems.</p>
</li>
</ul>
</li>
</ol>
<p><a href="#i1006880">Figure 1-2</a> illustrates the architecture of the Oracle Database Gateway for APPC using SNA or TCP/IP, as described in the previous section.</p>
<div id="APPUG1175" class="figure">
<p class="titleinfigure"><a id="i1006880"></a>Figure 1-2 Gateway Architecture Featuring SNA or TCP/IP Protocol</p>
<img width="715" height="418" src="img/arch1_2.gif" alt="Description of Figure 1-2 follows"/><br/>
<a id="sthref121" href="img_text/arch1_2.htm">Description of &#39;&#39;Figure 1-2 Gateway Architecture Featuring SNA or TCP/IP Protocol&#39;&#39;</a><br/>
<br/></div>
<!-- class="figure" --></div>
<!-- class="sect1" -->
<a id="i1016173"></a>
<div id="APPUG906" class="sect1">
<h2 class="sect1">Communication with the Gateway</h2>
<p>All the communication between the <a id="sthref122"></a><a id="sthref123"></a>user or client program and the gateway is handled through a TIP which executes on an Oracle database. The TIP is a standard <a id="sthref124"></a><a id="sthref125"></a>PL/SQL package that provides the following functions:</p>
<ul>
<li>
<p>declares the PL/SQL variables that can be exchanged with a remote transaction program;</p>
</li>
<li>
<p>calls the gateway packages that handle the communications for starting the conversation, exchanging data, and terminating the conversation;</p>
</li>
<li>
<p>handles all datatype conversions between <a id="sthref126"></a>PL/SQL datatypes and the target program datatypes.</p>
</li>
</ul>
<p>The <a id="sthref127"></a><a id="sthref128"></a>PGAU, provided with the gateway, automatically generates the <a id="sthref129"></a><a id="sthref130"></a>TIP specification.</p>
<p>The gateway is identified to the Oracle database using a database link.<a id="sthref131"></a> The database link is the same construct used to identify other Oracle databases. The functions in the gateway are referenced in <a id="sthref132"></a>PL/SQL as:</p>
<pre dir="ltr"><span class="italic">function_name@dblink_name</span> 
</pre></div>
<!-- class="sect1" -->
<a id="i1009907"></a>
<div id="APPUG907" class="sect1">
<h2 class="sect1">RPC Functions</h2>
<p>The Oracle Database Gateway for APPC provides a set of functions that are called by the client through <a id="sthref133"></a>RPC. These functions direct the gateway to initiate, transfer data with, and terminate RTP running under an OLTP on another system.</p>
<p><a href="#CHDBFJJG">Table 1-1</a> lists the RPC functions and the correlating commands that are invoked in the gateway and remote host.</p>
<div id="APPUG1176" class="tblformal">
<p class="titleintable"><a id="sthref134"></a><a id="CHDBFJJG"></a>Table 1-1 RPC Functions and Commands in the Gateway and Remote Host</p>
<table class="cellalignment6315" title="RPC Functions and Commands in the Gateway and Remote Host" summary="lists the remote procedural call functions and the correlating commands that are invoked in the Oracle TIP, the gateway and remote host" dir="ltr">
<thead>
<tr class="cellalignment6309">
<th class="cellalignment6316" id="r1c1-t4">Applications</th>
<th class="cellalignment6316" id="r1c2-t4">Oracle TIP</th>
<th class="cellalignment6316" id="r1c3-t4">Gateway</th>
<th class="cellalignment6316" id="r1c4-t4">Remote Host</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment6309">
<td class="cellalignment6317" id="r2c1-t4" headers="r1c1-t4">
<p><code dir="ltr">call tip_init</code></p>
</td>
<td class="cellalignment6317" headers="r2c1-t4 r1c2-t4">
<p><code dir="ltr">tip_init</code></p>
<p><code dir="ltr">call pgainit@gateway</code></p>
</td>
<td class="cellalignment6317" headers="r2c1-t4 r1c3-t4">
<p><code dir="ltr">PGAINIT</code></p>
</td>
<td class="cellalignment6317" headers="r2c1-t4 r1c4-t4">
<p>Initiate program</p>
</td>
</tr>
<tr class="cellalignment6309">
<td class="cellalignment6317" id="r3c1-t4" headers="r1c1-t4">
<p><code dir="ltr">call tip_main</code></p>
</td>
<td class="cellalignment6317" headers="r3c1-t4 r1c2-t4">
<p><code dir="ltr">tip_main</code></p>
<p><code dir="ltr">call pgaxfer@gateway</code></p>
</td>
<td class="cellalignment6317" headers="r3c1-t4 r1c3-t4">
<p><code dir="ltr">PGAXFER</code></p>
</td>
<td class="cellalignment6317" headers="r3c1-t4 r1c4-t4">
<p>Exchange data</p>
</td>
</tr>
<tr class="cellalignment6309">
<td class="cellalignment6317" id="r4c1-t4" headers="r1c1-t4">
<p><code dir="ltr">call tip_term</code></p>
</td>
<td class="cellalignment6317" headers="r4c1-t4 r1c2-t4">
<p><code dir="ltr">tip_term</code></p>
<p><code dir="ltr">call pgaterm@gateway</code></p>
</td>
<td class="cellalignment6317" headers="r4c1-t4 r1c3-t4">
<p><code dir="ltr">PGATERM</code></p>
</td>
<td class="cellalignment6317" headers="r4c1-t4 r1c4-t4">
<p>Terminate program</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<div id="APPUG908" class="sect2"><a id="sthref135"></a>
<h3 class="sect2">TIP Function</h3>
<p>The following sections describe how a TIP works by first establishing a connection to the remote host, then exchanging data from the target transaction program and finally, terminating a conversation.</p>
<div id="APPUG909" class="sect3"><a id="sthref136"></a>
<h4 class="sect3">Remote Transaction<a id="sthref137"></a><a id="sthref138"></a><a id="sthref139"></a> Initiation</h4>
<p>The <a id="sthref140"></a><a id="sthref141"></a><a id="sthref142"></a>TIP initiates a connection to the remote host using one of the gateway functions, <code dir="ltr">PGAINIT</code>.</p>
<p><span class="bold">When the communication protocol is SNA:</span> <code dir="ltr">PGAINIT</code><a id="sthref143"></a><a id="sthref144"></a><a id="sthref145"></a><a id="sthref146"></a><a id="sthref147"></a> provides, as input, the required <a id="sthref148"></a>SNA parameters to start a conversation with the target transaction program. These parameters are sent across the SNA network, which returns a conversation identifier to <code dir="ltr">PGAINIT</code>. Future calls to the target program use the conversation identifier as an input parameter.</p>
<p><span class="bold">When the communication protocol is TCP/IP</span>: <code dir="ltr">PGAINIT</code><a id="sthref149"></a><a id="sthref150"></a><a id="sthref151"></a><a id="sthref152"></a><a id="sthref153"></a> provides<a id="sthref154"></a>, as input, the required TCP/IP parameters.These parameters are sent across the TCP/IP network to start the conversation with the target transaction program. The TCP/IP network returns a <a id="sthref155"></a><a id="sthref156"></a>socket file descriptor to <code dir="ltr">PGAINIT</code>. Future calls, such as <a id="sthref157"></a><code dir="ltr">PGAXFER</code> and <a id="sthref158"></a><code dir="ltr">PGATERM</code>, use this same socket file descriptor as an input parameter.</p>
</div>
<!-- class="sect3" -->
<div id="APPUG910" class="sect3"><a id="sthref159"></a>
<h4 class="sect3">Data Exchange<a id="sthref160"></a><a id="sthref161"></a></h4>
<p>After the conversation is established, a database gateway function called <a id="sthref162"></a><a id="sthref163"></a><code dir="ltr">PGAXFER</code> can exchange data in the form of input and output variables. <code dir="ltr">PGAXFER</code> sends and receives buffers to and from the target transaction program. The gateway sees a buffer as only a RAW stream of bytes. The TIP that resides in the <a id="sthref164"></a><a id="sthref165"></a>Oracle database is responsible for converting P<a id="sthref166"></a>L/SQL datatypes of the application to RAW before sending the buffer to the gateway. It is also responsible for converting RAW to PL/SQL datatypes before returning the results to the application.</p>
</div>
<!-- class="sect3" -->
<div id="APPUG911" class="sect3"><a id="sthref167"></a>
<h4 class="sect3">Remote Transaction Termination</h4>
<p>When communication with the remote program is complete, the gateway function <code dir="ltr">PGATERM</code> terminates the conversation between the gateway and the remote host.</p>
<p><span class="bold"><a id="sthref168"></a><a id="sthref169"></a><a id="sthref170"></a>When the communication protocol is SNA</span>: <code dir="ltr">PGATERM</code> uses the conversation identifier as an input parameter to request conversation termination.</p>
<p><span class="bold">When the communication protocol is TCP/IP</span>: <a id="sthref171"></a><a id="sthref172"></a><a id="sthref173"></a><code dir="ltr">PGATERM</code> uses the socket file descriptor for TCP/IP as an input parameter to request conversation termination.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
At this point, if your communication protocol is SNA, then proceed to the following section, <a href="#BGBHAGAC">Overview of a Gateway Using SNA</a>.
<p>If your gateway communication protocol is TCP/IP, then proceed to <a href="#BGBCDABF">Overview of a Gateway Using TCP/IP</a>.</p>
</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BGBHAGAC"></a>
<div id="APPUG912" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Overview of a Gateway Using SNA</h2>
<p>If you are using the SNA communication protocol, read the following sections to develop an understanding of how the gateway communicates with the Oracle database and with the mainframe, as well as transaction types unique to your gateway and writing TIPs.</p>
<a id="i1008334"></a>
<div id="APPUG913" class="sect2">
<h3 class="sect2">Transaction Types for a Gateway Using SNA</h3>
<p>The Oracle Database Gateway for APPC supports <a id="sthref174"></a><a id="sthref175"></a><a id="sthref176"></a><a id="sthref177"></a>three types of transactions that read data from and write data to remote host systems:</p>
<ul>
<li>
<p><span class="bold">one-shot</span></p>
<p>In a <a id="sthref178"></a>one-shot transaction, the application starts the connection, exchanges data, and terminates the connection, all in a single call.</p>
</li>
<li>
<p><span class="bold">persistent</span></p>
<p>In a <a id="sthref179"></a>persistent transaction, multiple calls to exchange data with the remote transaction can be executed before terminating the conversation.</p>
</li>
<li>
<p><span class="bold">multi-conversational</span></p>
<p>In a <a id="sthref180"></a>multi-conversational transaction, the database gateway server can be used to exchange multiple records in one call to the remote transaction program.</p>
</li>
</ul>
<p>Refer to <a href="app_sna.htm#i1006667">&#34;Remote Host Transaction Types&#34;</a> in <a href="app_sna.htm#g1020838">Chapter 4, &#34;Client Application Development (SNA Only)&#34;</a> of this guide for more information about transaction types.</p>
<p>The following list demonstrates examples of the power of the Oracle Database Gateway for APPC:</p>
<ul>
<li>
<p>You can initiate a CICS transaction on the mainframe to retrieve data from a VSAM file for a PC application.</p>
</li>
<li>
<p>You can modify and monitor the operation of a remote process control computer.</p>
</li>
<li>
<p>You can initiate an IMS/TM transaction that executes static SQL in DB2.</p>
</li>
<li>
<p>You can initiate a <a id="sthref181"></a>CICS transaction that returns a large number of records in a single call.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="i1011033"></a>
<div id="APPUG914" class="sect2">
<h3 class="sect2">Simple Gateway Communication with the Oracle Database (SNA)<a id="sthref182"></a><a id="sthref183"></a><a id="sthref184"></a></h3>
<p>This section describes simple communication between the mainframe and the <a id="sthref185"></a>Oracle database on a gateway using the SNA communication protocol. The Oracle Database Gateway for APPC lets you write your own procedures to begin transferring information between the Oracle database and a variety of programs on an IBM mainframe, including IBM CICS, IMS, and APPC/MVS.</p>
<p>For an illustration of the communications function of the Oracle Database Gateway for APPC, refer to <code dir="ltr">%ORACLE_HOME%\dg4appc\demo\CICS\pgacics.sql</code> on Microsoft Windows or <code dir="ltr">$ORACLE_HOME/dg4appc/demo/CICS/pgacics.sql</code> on UNIX based platforms. This is a sample communication between the Oracle database and CICS Transaction Server for z/OS. Executing this simple <a id="sthref186"></a>PL/SQL procedure <code dir="ltr"><a id="sthref187"></a>pgacics.sql</code>, causes the Oracle database to invoke the database gateway, which uses <a id="sthref188"></a>SNA to converse with the <a id="sthref189"></a><code dir="ltr">FLIP</code> transaction in CICS. These steps are described in detail in <a href="#i1011928">Steps to Communicate Between Gateway and Mainframe Using SNA</a>. Note that you will already have compiled and linked the stored procedure when you configured the gateway.</p>
<a id="i1011928"></a>
<div id="APPUG915" class="sect3">
<h4 class="sect3">Steps to Communicate Between Gateway and Mainframe Using SNA</h4>
<p>The following steps describe the Windows-to-mainframe communications process illustrated in <a href="#i1007062">Figure 1-3, &#34;Communication Between the Oracle Database and the Mainframe, Using SNA&#34;</a> when your communication protocol is SNA to communicate between the gateway and the mainframe:</p>
<ol>
<li>
<p>From <a id="sthref190"></a><a id="sthref191"></a><a id="sthref192"></a>SQL*Plus, execute <code dir="ltr">pgacics</code>. This invokes the <a id="sthref193"></a>PL/SQL stored procedure in the Oracle database.</p>
<p>For Microsoft Windows:</p>
<pre dir="ltr">C:\&gt; sqlplus &lt;userid&gt;/&lt;password&gt;@&lt;database_specification_string&gt;
SQL&gt; execute pgacics(&#39;==&lt; .SCIC htiw gnitacinummoc si yawetag ruoy ,snoitalutargnoC &gt;==&#39;);
</pre>
<p>For UNIX Based platforms:</p>
<pre dir="ltr">$ sqlplus &lt;userid&gt;/&lt;password&gt;@&lt;database_specification_string&gt;
SQL&gt; execute pgacics(&#39;==&lt; .SCIC htiw gnitacinummoc si yawetag ruoy ,snoitalutargnoC &gt;==&#39;);
</pre></li>
<li>
<p>The <code dir="ltr">pgacics</code> <a id="sthref194"></a><a id="sthref195"></a>PL/SQL stored procedure will start up the gateway. The <a id="sthref196"></a><a id="sthref197"></a>gateway will start up communication with <a id="sthref198"></a>CICS Transaction Server for z/OS through SNA and will call <code dir="ltr">FLIP</code>.</p>
</li>
<li>
<p><code dir="ltr">FLIP</code> processes the input, generates the output and sends the output back to the database gateway.</p>
</li>
<li id="i1011017">
<p>Finally, the database gateway will send the output back to the PL/SQL stored procedure in the Oracle database. The result is displayed in SQL*Plus:</p>
<pre dir="ltr">==&gt; Congratulations, your gateway is communicating with CICS. &lt;==
PL/SQL procedure successfully completed.
</pre>
<p><a href="#i1007062">Figure 1-3, &#34;Communication Between the Oracle Database and the Mainframe, Using SNA&#34;</a> illustrates the communications process described in steps 1 through 4.</p>
</li>
</ol>
<div id="APPUG1177" class="figure">
<p class="titleinfigure"><a id="i1007062"></a>Figure 1-3 Communication Between the Oracle Database and the Mainframe, Using SNA</p>
<img width="478" height="466" src="img/svrcm1_3.gif" alt="Description of Figure 1-3 follows"/><br/>
<a id="sthref199" href="img_text/svrcm1_3.htm">Description of &#39;&#39;Figure 1-3 Communication Between the Oracle Database and the Mainframe, Using SNA&#39;&#39;</a><br/>
<br/></div>
<!-- class="figure" --></div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1009938"></a>
<div id="APPUG916" class="sect2">
<h3 class="sect2">Writing TIPs to Generate PL/SQL Programs Using SNA</h3>
<p><a id="sthref200"></a><a id="sthref201"></a>Most transactions using SNA communication protocol are much larger and more complex than the sample <code dir="ltr">pgacics.sql</code> file referred to in <a href="#i1007062">Figure 1-3, &#34;Communication Between the Oracle Database and the Mainframe, Using SNA&#34;</a>. Additionally, communication with a normal-sized RTP would require you to create an extremely long PL/SQL file. PGAU function generates the PL/SQL procedure for you.</p>
<p><a id="sthref202"></a><a id="sthref203"></a><a id="sthref204"></a>The following is a brief description of the <a id="sthref205"></a>four steps necessary for you to generate a TIP. Refer to <a href="tip.htm#g1011602">Chapter 3, &#34;Creating a TIP&#34;</a> for detailed information about this procedure, and refer to <a href="admin_util.htm#g1029659">Chapter 2, &#34;Procedural Gateway Administration Utility&#34;</a> for more information about PGAU.</p>
<p>All parameter names in this section are taken from a file called <code dir="ltr">pgadb2i.ctl</code> in the <code dir="ltr">%ORACLE_HOME%\pga4appc\demo\CICS</code> directory on Microsoft Windows or in the <code dir="ltr">$ORACLE_HOME/pga4appc/demo/CICS</code> directory on UNIX Based systems.</p>
<a id="i1011972"></a>
<div id="APPUG917" class="sect3">
<h4 class="sect3">Steps to Writing a <a id="sthref206"></a>TIP on a Gateway Using SNA</h4>
<p>Follow these steps to write a TIP.</p>
<dl>
<dd><a id="APPUG1417"></a><a id="sthref207"></a></dd>
<dt class="seghead">Step 1&nbsp;&nbsp;&nbsp; Create a <a class="dashingAutolink" name="autolink-2142"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="sthref208"></a>control file:</dt>
<dd>
<p>The user writes the control files. The <a id="sthref209"></a><a id="sthref210"></a>control file has four main types of <a id="sthref211"></a>PGAU commands:</p>
<ol>
<li>
<p><a id="sthref212"></a><a id="sthref213"></a><a id="sthref214"></a><code dir="ltr">DEFINE DATA</code>. This is used to define input and output fields, using COBOL data definitions.</p>
<ul>
<li>
<p>Sample define data:</p>
<pre dir="ltr">define data empno plsdname(empno) usage(pass) language(ibmvscobolii)
                  infile(&#34;empno.cob&#34;);
</pre></li>
</ul>
</li>
<li>
<p><a id="sthref215"></a><a id="sthref216"></a><a id="sthref217"></a><code dir="ltr">DEFINE CALL</code>. This is used to define PL/SQL functions calls to be generated as part of the package.</p>
<ul>
<li>
<p>Sample define call:</p>
<pre dir="ltr">define call db2imain pkgcall(pgadb2i_main) 
                     parms((empno in),(emprec out));
</pre></li>
</ul>
</li>
<li>
<p><a id="sthref218"></a><a id="sthref219"></a><a id="sthref220"></a><code dir="ltr">DEFINE TRANSACTION</code>. This is used to group the preceding functions and specify other parameters on which the TIP depends.</p>
<ul>
<li>
<p>Sample define transaction:</p>
<pre dir="ltr">define transaction db2i call(db2imain,db2idiag)
                        sideprofile(CICSPGA) 
                        tpname(DB2I)
                        logmode(oraplu62)
                        synclevel(0)
                        nls_language(&#34;american_america.we8ebcdic37c&#34;);
</pre></li>
</ul>
</li>
<li>
<p><a id="sthref221"></a><a id="sthref222"></a><a id="sthref223"></a><code dir="ltr">GENERATE</code>. This is used to generate the TIP specification files from the previously stored data, call, and transaction definitions.</p>
<ul>
<li>
<p>Sample generate transaction:</p>
<pre dir="ltr">generate db2i pkgname(pgadb2i) pganode(pga) outfile(&#34;pgadb2i&#34;);
</pre></li>
</ul>
</li>
</ol>
</dd>
<dd><a id="APPUG1418"></a><a id="sthref224"></a></dd>
<dt class="seghead">Step 2&nbsp;&nbsp;&nbsp;Execute the control file within PGAU</dt>
<dd>
<p>Running the control file within PGAU will create PG DD entries for the data, call, and transaction definitions, and will generate the <a id="sthref225"></a><a id="sthref226"></a>specification files (For example, <a id="sthref227"></a><a id="sthref228"></a><code dir="ltr">pgadb2i.pkh</code> and <a id="sthref229"></a><a id="sthref230"></a><code dir="ltr">pgadb2i.pkb</code>):</p>
<p>For Microsoft Windows:</p>
<pre dir="ltr">C:\&gt; pgau
PGAU&gt; CONNECT&lt;userid&gt;/&lt;password&gt;@&lt;database&gt;_specification_string&gt;
PGAU&gt; @pgadb2i.ctl
</pre>
<p>For UNIX based systems:</p>
<pre dir="ltr">$ pgau
PGAU&gt; CONNECT&lt;userid&gt;/&lt;password&gt;@&lt;database&gt;_specification_string&gt;
PGAU&gt; @pgadb2i.ctl
</pre></dd>
<dd><a id="APPUG1419"></a><a id="sthref231"></a></dd>
<dt class="seghead">Step 3&nbsp;&nbsp;&nbsp;Execute the specification files</dt>
<dd>
<p>Running the specification files will create the PL/SQL stored procedures. Note that the header specification file <span class="bold"><a id="sthref232"></a><a id="sthref233"></a></span>(for example, <code dir="ltr">pgadb2i.pkh</code>) must be run first:</p>
<p>For Microsoft Windows:</p>
<pre dir="ltr">C:\&gt; sqlplus&lt;userid&gt;/&lt;password&gt;@&lt;database_specification_string&gt;
SQL&gt; @pgadb2i.pkh;
SQL&gt; @pgadb2i.pkb;
</pre>
<p>For UNIX based systems:</p>
<pre dir="ltr">$ sqlplus&lt;userid&gt;/&lt;password&gt;@&lt;database_specification_string&gt;
SQL&gt; @pgadb2i.pkh;
SQL&gt; @pgadb2i.pkb;
</pre></dd>
<dd><a id="APPUG1420"></a><a id="sthref234"></a></dd>
<dt class="seghead">Step 4&nbsp;&nbsp;&nbsp;Create a driver procedure to run the TIP</dt>
<dd>
<p>The TIP is now ready for use. For convenience, it will usually be called using a <a id="sthref235"></a><a id="sthref236"></a>driver procedure (for example, <code dir="ltr">db2idriv</code>). This driver will then call the individual stored procedures in the correct order. Create the driver procedure and run it:</p>
<p>For Microsoft Windows:</p>
<pre dir="ltr">C:\&gt; sqlplus &lt;userid&gt;/&lt;password&gt;@&lt;database_specification string&gt; 
SQL&gt; @pgadb2id.sql
SQL&gt; execute db2idriv(&#39;000320&#39;);
</pre>
<p>For UNIX based systems:</p>
<pre dir="ltr">$ sqlplus &lt;userid&gt;/&lt;password&gt;@&lt;database_specification string&gt; 
SQL&gt; @pgadb2id.sql
SQL&gt; execute db2idriv(&#39;000320&#39;);
</pre></dd>
</dl>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BGBCDABF"></a>
<div id="APPUG918" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Overview of a Gateway Using TCP/IP</h2>
<p>If you are using the TCP/IP communication protocol, read the following sections to develop an understanding of how the gateway communicates with the Oracle database and with the mainframe, as well as transaction types unique to your gateway and writing TIPs.</p>
<a id="i1009922"></a>
<div id="APPUG919" class="sect2">
<h3 class="sect2">Transaction Types for a Gateway Using TCP/IP</h3>
<p>The <a id="sthref237"></a><a id="sthref238"></a>Oracle Database Gateway for APPC using TCP/IP support for IMS Connect supports three types of transaction socket connections:</p>
<ul>
<li>
<p><span class="bold"><a id="sthref239"></a>transaction socket</span></p>
<p>The socket connection lasts across a single transaction.</p>
</li>
<li>
<p><a id="sthref240"></a><a id="sthref241"></a><span class="bold">persistent socket</span></p>
<p>The socket connection lasts across multiple transactions.</p>
</li>
<li>
<p><a id="sthref242"></a><a id="sthref243"></a><span class="bold">nonpersistent socket</span></p>
<p>The socket connection lasts across a single exchange consisting of one input and one output.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Do not use the nonpersistent socket type if you plan to implement conversational transactions because multiple connections and disconnections will occur.</div>
<p>Refer to the section about <code dir="ltr">pg4tcpmap</code> commands in <a href="tcpmap.htm#g1011686">Chapter 6, &#34;PG4TCPMAP Commands (TCP/IP Only)&#34;</a> of this guide for more information about the function and use of these parameters.</p>
<p>You can initiate an IMS/TM transaction that executes static SQL in DB2. This illustrates the power of the Oracle Database Gateway for APPC&#39;s feature supporting TCP/IP for IMS Connect.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="i1014802"></a>
<div id="APPUG920" class="sect2">
<h3 class="sect2">Simple Gateway Communication with the Oracle Database (TCP/IP)</h3>
<p>This section describes simple communication between IMS and the <a id="sthref244"></a><a id="sthref245"></a><a id="sthref246"></a>Oracle database when<a id="sthref247"></a><a id="sthref248"></a>TCP/IP for IMS Connect is being used as the communication protocol between the gateway and the remote host (IMS). The Oracle Database Gateway for APPC lets you write your own procedures to begin transferring information between the Oracle database and <a id="sthref249"></a>I/O PCB programs on IMS.</p>
<p>For an illustration of the communications function of the gateway using TCP/IP for IMS Connect, refer to the <code dir="ltr">%ORACLE_HOME%\dg4appc\demo\IMS\pgaims.sql</code> file on Microsoft Windows or <code dir="ltr">$ORACLE_HOME/dg4appc/demo/IMS/pgaims.sql</code> on UNIX based systems.</p>
<p>Executing the simple <a id="sthref250"></a>PL/SQL procedure <code dir="ltr"><a id="sthref251"></a>pgaims.sql</code> causes the Oracle database to call the gateway, which uses <a id="sthref252"></a>TCP/IP to converse with the sample transaction <a id="sthref253"></a><code dir="ltr">FLIP</code> in IMS. The communication steps that take place when you execute the PL/SQL procedure are described in detail in <a href="#i1013837">Steps to Communication Between the Gateway and IMS, Using TCP/IP</a>. Note that you will already have compiled and linked the stored procedure when you configured the gateway.</p>
<a id="i1011956"></a>
<div id="APPUG921" class="sect3">
<h4 class="sect3">Preparing the Gateway to Communicate Using TCP/IP</h4>
<p>If your gateway is using TCP/IP support for IMS Connect, then you must use the <code dir="ltr">pg4tcpmap</code> tool to create the required mapping between <code dir="ltr">PGAINIT</code> parameters and the target system network address information. The <code dir="ltr">pg4tcpmap</code> tool maps the Side Profile Name specified in a <code dir="ltr">DEFINE TRANSACTION</code> to TCP/IP and IMS Connect attributes, such as port number, IP address (host name) and IMS subsystem ID. The TCP/IP parameters are used to start a conversation with the target transaction program.</p>
<p>The <code dir="ltr">pg4tcpmap</code> tool must be run in order to populate the <code dir="ltr">PGA_TCP_IMSC</code> table before executing any TIPs which rely on TPC/IP support for IMS Connect.</p>
<ul>
<li>
<p>Refer to <a href="tcpmap.htm#g1011686">Chapter 6, &#34;PG4TCPMAP Commands (TCP/IP Only)&#34;</a> in this guide for complete instructions for setting up and executing <code dir="ltr">pg4tcpmap</code> commands to populate the <code dir="ltr">PGA_TCP_IMSC</code> table. <a href="tcpmap.htm#g1011686">Chapter 6</a> also explains the content of the <code dir="ltr">PGA_TCP_IMSC</code> table and an example of how to use the table.</p>
</li>
<li>
<p>A trace file from a sample <code dir="ltr">pg4tcpmap</code> execution is located in <a href="pro_det.htm#g1026955">Chapter 8, &#34;Troubleshooting&#34;</a> in this guide.</p>
</li>
<li>
<p>A screen output file is located in Appendix&nbsp;B, &#34;Gateway Initialization Parameters for TCP/IP Communication Protocol&#34; in the <a class="olink APPCI290" href="../APPCI/apb.htm#APPCI290"><span class="italic">Oracle Database Gateway for APPC Installation and Configuration Guide for IBM AIX on POWER Systems (64-Bit), Linux x86-64, Oracle Solaris on SPARC (64-Bit), and HP-UX Itanium</span></a> or <a class="olink APPCW265" href="../APPCW/apb.htm#APPCW265"><span class="italic">Oracle Database Gateway for APPC Installation and Configuration Guide for Microsoft Windows</span></a>.</p>
</li>
</ul>
</div>
<!-- class="sect3" -->
<a id="i1013837"></a>
<div id="APPUG922" class="sect3">
<h4 class="sect3">Steps to Communication Between the Gateway and IMS, Using TCP/IP</h4>
<p>The following steps describe the communications process, as illustrated in <a href="#i1012713">Figure 1-4</a> when your communication protocol is <a id="sthref254"></a><a id="sthref255"></a>TCP/IP:</p>
<ol>
<li>
<p>From <a id="sthref256"></a>SQL*Plus, execute <code dir="ltr">pgaims.sql</code>. This invokes the <a id="sthref257"></a>PL/SQL stored procedure in the Oracle database.</p>
<p>For Microsoft Windows:</p>
<pre dir="ltr">C:\&gt; sqlplus &lt;userid&gt;/&lt;password&gt;@&lt;database_specification_string&gt;
SQL&gt; execute pgaims &#39;snoitalutargnoC&#39;;
</pre>
<p>For UNIX based systems:</p>
<pre dir="ltr">$ sqlplus &lt;userid&gt;/&lt;password&gt;@&lt;database_specification_string&gt;
SQL&gt; execute pgaims &#39;snoitalutargnoC&#39;;
</pre>
<p>The <code dir="ltr">pgaims.sql</code> stored procedure will start up the gateway.</p>
</li>
<li>
<p>The gateway which has the APPC information will call the mapping table (<a id="sthref258"></a><a id="sthref259"></a><code dir="ltr">PGA_TCP_IMSC</code>). The mapping table will map the information so that it will have the host name (TCP/IP address) and the port number.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Rather than insert, delete, or update the <code dir="ltr">PGA_TCP_IMSC</code> mapping table manually, you should use the <a id="sthref260"></a><code dir="ltr">pg4tcpmap</code> tool to do so. You may use the <code dir="ltr">SELECT</code> statement to query the rows.</div>
</li>
<li>
<p>When the gateway has the port number and host name, it will initiate communication with IMS Connect through TCP/IP, and it will call <code dir="ltr">FLIP</code> through IMS.</p>
</li>
<li>
<p><code dir="ltr">FLIP</code> processes the input, generates the output, and sends the output back to the gateway.</p>
</li>
<li id="i1013906">
<p>Finally, the gateway will send the output back to the PL/SQL stored procedure in the Oracle database. The result is displayed in SQL*Plus:</p>
<pre dir="ltr">Congratulations
PL/SQL procedure successfully completed.
</pre></li>
</ol>
<p><a href="#i1012713">Figure 1-4, &#34;Communication Between Oracle Database and Mainframe, Using TCP/IP&#34;</a> illustrates the communications process described in the previous Steps 1 through 5.</p>
<div id="APPUG1178" class="figure">
<p class="titleinfigure"><a id="i1012713"></a>Figure 1-4 Communication Between Oracle Database and Mainframe, Using TCP/IP</p>
<img width="554" height="579" src="img/svtcp1_4.gif" alt="Description of Figure 1-4 follows"/><br/>
<a id="sthref261" href="img_text/svtcp1_4.htm">Description of &#39;&#39;Figure 1-4 Communication Between Oracle Database and Mainframe, Using TCP/IP&#39;&#39;</a><br/>
<br/></div>
<!-- class="figure" --></div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1014709"></a>
<div id="APPUG923" class="sect2">
<h3 class="sect2">Writing TIPs to Generate PL/SQL Programs Using TCP/IP</h3>
<p>Most transactions are much larger and more complex than the sample <code dir="ltr">pgaims.sql</code> file referred to in <a href="#i1012713">Figure 1-4, &#34;Communication Between Oracle Database and Mainframe, Using TCP/IP&#34;</a>. Additionally, communication with a normal-sized RTP (remote transaction program) would require you to create an extremely long PL/SQL file. Oracle Database Gateway for APPC&#39;s TIP function generates the PL/SQL procedure for you.</p>
<p><a id="sthref262"></a><a id="sthref263"></a>The following is a brief description of the <a id="sthref264"></a>four steps necessary for you to generate a TIP. Refer to <a href="tip.htm#g1011602">Chapter 3, &#34;Creating a TIP&#34;</a> for detailed information about this procedure, and refer to <a href="admin_util.htm#g1029659">Chapter 2, &#34;Procedural Gateway Administration Utility&#34;</a> for more information about PGAU.</p>
<p>All parameter names in this section are taken from a file called <code dir="ltr">pgtflip.ctl</code> in the <code dir="ltr">%ORACLE_HOME%\pga4appc\demo\IMS</code> directory on Microsoft Windows or <code dir="ltr">$ORACLE_HOME/pga4appc/demo/IMS</code> directory on UNIX based systems.</p>
<a id="BGBIAAFC"></a>
<div id="APPUG924" class="sect3">
<h4 class="sect3">Steps to Writing a <a id="sthref265"></a>TIP on a Gateway Using TCP/IP</h4>
<p>Follow these steps to write a TIP.</p>
<dl>
<dd><a id="APPUG1421"></a><a id="sthref266"></a></dd>
<dt class="seghead">Step 1&nbsp;&nbsp;&nbsp; Create a <a class="dashingAutolink" name="autolink-2143"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="sthref267"></a><a class="dashingAutolink" name="autolink-2144"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="sthref268"></a>control file:</dt>
<dd>
<p>The user writes the control files. The <a id="sthref269"></a><a id="sthref270"></a>control file has four main types of <a id="sthref271"></a>PGAU commands:</p>
<ol>
<li>
<p><a id="sthref272"></a><a id="sthref273"></a><a id="sthref274"></a><code dir="ltr">DEFINE DATA</code>. This is used to define input and output fields, using COBOL data definitions.</p>
<ul>
<li>
<p>Sample define data:</p>
<pre dir="ltr">define data flipin plsdname(flipin) usage(pass) language(ibmvscobolii)
(
  01 msgin pic x(20).
)

define data flipout plsdname(flipout) usage(pass) language(ibmvscobolii)
(
  01 msgout pic x(20).
)
</pre></li>
</ul>
</li>
<li>
<p><a id="sthref275"></a><a id="sthref276"></a><a id="sthref277"></a><code dir="ltr">DEFINE CALL</code>. This is used to define PL/SQL functions calls to be generated as part of the package.</p>
<ul>
<li>
<p>Sample define call:</p>
<pre dir="ltr">define call flipmain pkgcall(pgtflip_main) 
                     parms((flipin in),(flipout out));
</pre></li>
</ul>
</li>
<li>
<p><a id="sthref278"></a><a id="sthref279"></a><code dir="ltr">DEFINE TRANSACTION</code>. This is used to group the preceding functions and specify other parameters on which the TIP depends.</p>
<ul>
<li>
<p>Sample define transaction:</p>
<pre dir="ltr">define transaction imsflip call(flipmain)
                        sideprofile(pgatcp) 
                        tpname(flip)
                        nls_language(&#34;american_america.us7ascii&#34;);
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
On a gateway using TCP/IP, the side profile name value is actually the TCP/IP unique name that was defined when the user specified the value, host name, port number and many other IMS Connect values during configuration of the network.</div>
</li>
</ul>
</li>
<li>
<p><a id="sthref280"></a><a id="sthref281"></a><a id="sthref282"></a><code dir="ltr">GENERATE</code>. This is used to generate the TIP specification files from the previously stored data, call, and transaction definitions.</p>
<ul>
<li>
<p>Sample generate transaction:</p>
<pre dir="ltr">generate imsflip pkgname(pgtflip) pganode(pga10ia) outfile(&#34;pgtflip&#34;) diagnose(pkgex(dc,dr));
</pre></li>
</ul>
</li>
</ol>
</dd>
<dd><a id="APPUG1422"></a><a id="sthref283"></a></dd>
<dt class="seghead">Step 2&nbsp;&nbsp;&nbsp;Execute the control file within PGAU</dt>
<dd>
<p>Running the control file within PGAU will create PG DD entries for the data, call, and transaction definitions and will generate the <a id="sthref284"></a><a id="sthref285"></a>specification files (for example, <a id="sthref286"></a><a id="sthref287"></a><code dir="ltr">pgtflip.pkh</code> and <a id="sthref288"></a><a id="sthref289"></a><code dir="ltr">pgtflip.pkb</code>):</p>
<p>For Microsoft Windows:</p>
<pre dir="ltr">C:\&gt; cd %ORACLE_HOME%\dg4appc\demo\IMS
C:\&gt; pgau
PGAU&gt; CONNECT <span class="italic">userid</span>/<span class="italic">password</span>@<span class="italic">database_specification_string</span>
PGAU&gt; @pgtflip.ctl
</pre>
<p>For UNIX based systems:</p>
<pre dir="ltr">$ pgau
PGAU&gt; CONNECT <span class="italic">userid</span>/<span class="italic">password</span>@<span class="italic">database_specification_string</span>
PGAU&gt; @pgtflip.ctl
</pre></dd>
<dd><a id="APPUG1423"></a><a id="sthref290"></a></dd>
<dt class="seghead">Step 3&nbsp;&nbsp;&nbsp;Execute the specification files</dt>
<dd>
<p>Running the specification files will create the PL/SQL stored procedures. Note that the header specification file (for example, <code dir="ltr">pgtflip.pkh</code>) must be run first:</p>
<p>For Microsoft Windows:</p>
<pre dir="ltr">C:\&gt; sqlplus<span class="italic"> userid</span>/p<span class="italic">assword@database_specification_string</span>
SQL&gt; @pgtflip.pkh;
SQL&gt; @pgtflip.pkb;
</pre>
<p>For UNIX based systems:</p>
<pre dir="ltr">$ sqlplus<span class="italic"> userid</span>/p<span class="italic">assword@database_specification_string</span>
SQL&gt; @pgtflip.pkh;
SQL&gt; @pgtflip.pkb;
</pre></dd>
<dd><a id="APPUG1424"></a><a id="sthref291"></a></dd>
<dt class="seghead">Step 4&nbsp;&nbsp;&nbsp;Create a driver procedure to run the TIP</dt>
<dd>
<p>The TIP is now ready for use. For convenience, it will usually be called using a <a id="sthref292"></a><a id="sthref293"></a>driver procedure (for example, <code dir="ltr"><a id="sthref294"></a>pgtflipd</code>). This driver will then call the individual stored procedures in the correct order. Create the driver procedure and run it:</p>
<p>For Microsoft Windows:</p>
<pre dir="ltr">C:\&gt; sqlplus &lt;userid&gt;/&lt;password&gt;@&lt;database_specification string&gt; 
SQL&gt; @pgtflip.sql
SQL&gt; execute pgtflipd(&#39;hello&#39;);
</pre>
<p>For UNIX based system:</p>
<pre dir="ltr">$ sqlplus &lt;userid&gt;/&lt;password&gt;@&lt;database_specification string&gt; 
SQL&gt; @pgtflip.sql
SQL&gt; execute pgtflipd(&#39;hello&#39;);
</pre></dd>
</dl>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment6308">
<tr>
<td class="cellalignment6317">
<table class="cellalignment6313">
<tr>
<td class="cellalignment6312"><a href="preface.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment6312"><a href="admin_util.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment6320">
<table class="cellalignment6311">
<tr>
<td class="cellalignment6312"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment6312"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment6312"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment6312"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment6312"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment6312"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>