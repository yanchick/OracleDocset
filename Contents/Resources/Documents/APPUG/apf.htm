<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-2128"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Tip%20Internals"></a><title>Tip Internals</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1090"/>
<meta name="dcterms.created" content="2017-06-08T15:9:57Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Gateway for APPC User&#39;s Guide"/>
<meta name="dcterms.identifier" content="E17931-04"/>
<meta name="dcterms.isVersionOf" content="APPUG"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="apd.htm" title="Previous" type="text/html"/>
<link rel="Next" href="apg.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E17931-04.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">18/20</span> <!-- End Header -->
<div id="APPUG130" class="appendix"><a id="g638154"></a>
<h1 class="appendix"><span class="secnum">E</span> Tip Internals</h1>
<p>PGAU generates complete and operational TIPs for most circumstances. <a id="sthref1303"></a><a id="sthref1304"></a><a id="sthref1305"></a><a id="sthref1306"></a>TIP internals information is provided to assist you in diagnosing problems with PGAU-generated TIPs, and in writing custom TIPs, if you choose to do so.</p>
<ul>
<li>
<p><span class="bold">If your gateway is using the SNA communication protocol:</span></p>
<p>This appendix refers to a sample called <code dir="ltr"><a id="sthref1307"></a><a id="sthref1308"></a>pgadb2i</code>. The source for this TIP is in file <a id="sthref1309"></a><a id="sthref1310"></a><code dir="ltr">pgadb2i.sql</code> in the <code dir="ltr">%ORACLE_HOME%\dg4appc\demo\CICS</code> directory for Microsoft Windows and <code dir="ltr">$ORACLE_HOME/dg4appc/demo/CICS</code> directory for UNIX based systems.</p>
</li>
<li>
<p><span class="bold">If your gateway is using the TCP/IP communication protocol:</span></p>
<p>This appendix refers to a sample called <code dir="ltr"><a id="sthref1311"></a><a id="sthref1312"></a>pgaims</code>. The source for this TIP is in file <code dir="ltr"><a id="sthref1313"></a><a id="sthref1314"></a>pgtflipd.sql</code> in the <code dir="ltr">%ORACLE_HOME%\dg4appc\demo\IMS</code> directory for Microsoft Windows and <code dir="ltr">$ORACLE_HOME/dg4appc/demo/IMS</code> directory on UNIX based systems.</p>
</li>
</ul>
<p>This appendix contains the following sections:</p>
<ul>
<li>
<p><a href="#CHDBBEEB">&#34;Background Reading&#34;</a></p>
</li>
<li>
<p><a href="#i634260">&#34;PL/SQL Package and TIP File Separation&#34;</a></p>
</li>
</ul>
<a id="CHDBBEEB"></a>
<div id="APPUG1121" class="sect1">
<h2 class="sect1">Background Reading</h2>
<p>Several topics are important to understanding <a id="sthref1315"></a>TIP operation and development; following is a list of concepts that are key to TIP operation and suggested sources to which you can refer for more information.</p>
<ul>
<li>
<p>For information about PL/SQL Packages, refer to the <a class="olink LNPLS" href="../LNPLS/toc.htm"><span class="italic">Oracle Database PL/SQL Language Reference</span></a>.</p>
</li>
<li>
<p>For information about PGA Application Concepts, refer to the following chapters in this guide:</p>
</li>
<li>
<p><span class="bold">If your communication protocol is SNA:</span> refer to <a href="app_sna.htm#g1020838">Chapter 4, &#34;Client Application Development (SNA Only)&#34;</a>;</p>
</li>
<li>
<p><span class="bold">If your communication protocol is TCP/IP:</span> refer to <a href="app_tcp.htm#g1017213">Chapter 7, &#34;Client Application Development (TCP/IP Only)&#34;</a>.</p>
</li>
<li>
<p>For information about PGA RPC Interface, refer to <a href="apb.htm#g639177">Appendix B, &#34;Gateway RPC Interface&#34;</a>.</p>
</li>
<li>
<p>For information about PGA <code dir="ltr">UTL_PG</code> Interface, refer to <a href="apc.htm#g656113">Appendix C, &#34;The UTL_PG Interface&#34;</a>.</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="i634260"></a>
<div id="APPUG1122" class="sect1">
<h2 class="sect1">PL/SQL Package and TIP File Separation</h2>
<p>PGAU <a id="sthref1316"></a><a id="sthref1317"></a><code dir="ltr">GENERATE</code> writes each output TIP into a standard <a id="sthref1318"></a>PL/SQL package specification file and body file. This separation is beneficial and important. Refer to the <a class="olink ADFNS" href="../ADFNS/toc.htm"><span class="italic">Oracle Database Development Guide</span></a> and the <a class="olink LNPLS" href="../LNPLS/toc.htm"><span class="italic">Oracle Database PL/SQL Language Reference</span></a> for more information. Also refer to <a href="admin_util.htm#i1007070">&#34;GENERATE&#34;</a> in <a href="admin_util.htm#g1029659">Chapter 2, &#34;Procedural Gateway Administration Utility&#34;</a> for more information about building the PL/SQL package.</p>
<p>TIPs are <a id="sthref1319"></a>PL/SQL packages. Any time a package specification is recompiled, all objects which depend on that package are invalidated and implicitly recompiled as they are referenced, even if the specification did not change.</p>
<p>Objects which depend on a <a id="sthref1320"></a>TIP specification include client applications that call the TIP to interact with remote host transactions.</p>
<p>It might be important to change the TIP body for the following reasons:</p>
<ul>
<li>
<p>Oracle ships maintenance which affects the TIP body, or</p>
</li>
<li>
<p>Oracle ships maintenance for the <code dir="ltr">UTL_RAW</code> or <code dir="ltr">UTL_PG</code> conversion functions upon which the TIP body relies.</p>
<p>Refer to <a href="apc.htm#g656113">Appendix C, &#34;The UTL_PG Interface&#34;</a> for more detailed information about these functions.</p>
</li>
<li>
<p>if the remote host network or program location parameters have changed. Refer to <a href="admin_util.htm#i1006863">&#34;DEFINE TRANSACTION&#34;</a> in <a href="admin_util.htm#g1029659">Chapter 2, &#34;Procedural Gateway Administration Utility&#34;</a> for more information</p>
</li>
</ul>
<p>Provided that the TIP specification does not need to change or be recompiled, the <a id="sthref1321"></a>TIP body can be regenerated and recompiled to pick up changes without causing invalidation and implicit recompilation of client applications that call the TIP.</p>
<p>It is for this reason that PGAU now separates output TIPs into specification and body files. Refer to <a href="admin_util.htm#i1007070">&#34;GENERATE&#34;</a> in <a href="admin_util.htm#g1029659">Chapter 2, &#34;Procedural Gateway Administration Utility&#34;</a> for a discussion of file identification.</p>
<div id="APPUG1123" class="sect2"><a id="sthref1322"></a>
<h3 class="sect2">Independent TIP Body Changes</h3>
<p><a id="sthref1323"></a>Independent TIP body changes are internal and require no change to the TIP specification. Examples of such changes include: a change in <code dir="ltr">UTL_RAW</code> or <code dir="ltr">UTL_PG</code> conversions, inclusion of diagnostics, or a change to network transaction parameters.</p>
<p>In these cases, when PGAU is used to regenerate the TIP, the new <a id="sthref1324"></a>TIP specification file can be saved or discarded, but should not be recompiled. The new TIP body should be recompiled under <a id="sthref1325"></a><a id="sthref1326"></a>SQL*Plus. Provided that the TIP body change is independent, the new body compilation completes without errors and the former TIP specification remains valid.</p>
<div id="APPUG1124" class="sect3"><a id="sthref1327"></a>
<h4 class="sect3">Determine if a Specification Has Remained Valid</h4>
<p>To determine if a specification has remained valid, issue the following statements from SQL*Plus, depending upon your communication protocol:</p>
<ul>
<li>
<p><span class="bold">If your gateway is using the <a id="sthref1328"></a><a id="sthref1329"></a>SNA communication protocol,</span> issue the following:</p>
<pre dir="ltr">SQL&gt;  column ddl_date format A22 heading &#39;LAST_DDL&#39;
SQL&gt; select object_name,
  2   object_type,
  3   to_char(last_ddl_time,&#39;MON-DD-YY HH:MM:SS&#39;) ddl_date,
  4   status
  5   from all_objects where owner = &#39;PGAADMIN&#39; 
  6   order by object_type, object_name;

OBJECT_NAME  OBJECT_TYPE   LAST_DDL                 STATUS 
-----------  -----------   --------------------     ---------
PGADB2I      PACKAGE       NOV-24-1999 09:09:13     VALID
PGADB2I      PACKAGE BODY  NOV-24-1999 09:11:44     VALID
DB2IDRIV     PROCEDURE     DEC-30-1999 12:12:14     VALID
DB2IDRVM     PROCEDURE     DEC-30-1999 12:12:53     VALID
DB2IFORM     PROCEDURE     DEC-14-1999 11:12:24     VALID
</pre>
<p>The <code dir="ltr">LAST_DDL</code> column is the date and time at which the last DDL change against the object was done. It shows that the order of compilation was:</p>
<pre dir="ltr">PGADB2I PACKAGE (the specification)
DB2IDRVM PROCEDURE (1st client application depending on PGADB2I)
DB2IFORM PROCEDURE (2nd client application depending on PGADB2I)
DB2IDRIV PROCEDURE (3rd client application depending on PGADB2I)
PGADB2I PACKAGE BODY (a recompilation of the body)
</pre>
<p>Note that the recompilation of the body does not invalidate its dependent object, the specification, or the client application indirectly.</p>
</li>
<li>
<p><span class="bold">If your gateway is using the TCP/IP communication protocol,</span> issue the following fro SQL*Plus:</p>
<pre dir="ltr">SQL&gt;  column ddl_date format A22 heading &#39;LAST_DDL&#39;
SQL&gt; select object_name,
  2   object_type,
  3   to_char(last_ddl_time,&#39;MON-DD-YY HH:MM:SS&#39;) ddl_date,
  4   status
  5   from all_objects where owner = &#39;PGAADMIN&#39; 
  6   order by object_type, object_name;

OBJECT_NAME  OBJECT_TYPE   LAST_DDL                 STATUS 
-----------  -----------   --------------------     ---------
PGTFLIP      PACKAGE       APR-24-03 03:04:58       VALID
PGTFLIP      PACKAGE BODY  APR-24-03 03:04:02       VALID
PGTFLIPD     PROCEDURE     APR-24-03 03:04:09       VALID
</pre>
<p>The <code dir="ltr">LAST_DDL</code> column is the date and time at which the last DDL change against the object was done. It shows that the order of compilation was:</p>
<pre dir="ltr">PGTFLIP PACKAGE (the specification)
PGTFLIPD PROCEDURE (client application depending on PGADB2I)
PGTFLIP PACKAGE BODY (a recompilation of the body)
</pre></li>
</ul>
<p>Note that the recompilation of the body does not invalidate its dependent object, the specification, or the client application indirectly.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<div id="APPUG1125" class="sect2"><a id="sthref1330"></a>
<h3 class="sect2">D<a id="sthref1331"></a><a id="sthref1332"></a>ependent TIP Body or Specification Changes</h3>
<p>You can also change the data structures or call exchange sequences of the remote host transaction. However, this kind of change is exposed to dependent client applications because the public datatypes or functions in the <a id="sthref1333"></a>TIP specification will also change and necessitate recompilation, which in turn causes the Oracle database to recompile such dependent client applications.</p>
<ul>
<li>
<p><span class="bold">If your gateway is using the SNA communication protocol</span>, issue the following:</p>
<pre dir="ltr">SQL&gt; column ddl_date format A22 heading &#39;LAST_DDL&#39;
SQL&gt; select object_name,
  2   object_type,
  3   to_char(LAST_DDL_TIME,&#39;MON-DD-YY HH:MM:SS&#39;) ddl_date,
  4   status
  5   from all_objects where owner = &#39;PGAADMIN&#39;
  6   order by object_type, object_name;

OBJECT_NAME    OBJECT_TYPE      LAST_DDL                 STATUS
----------     -----------      ---------------------    ---------
PGADB2I        PACKAGE          NOV-24-1999 09:09:13     VALID
PGADB2I        PACKAGE BODY     NOV-24-1999 09:11:44     INVALID
DB2IDRIV       PROCEDURE        DEC-30-1999 12:12:14     INVALID
DB2IDRVM       PROCEDURE        DEC-30-1999 12:12:53     INVALID
DB2IFORM       PROCEDURE        DEC-14-1999 11:12:24     INVALID
</pre></li>
<li>
<p><span class="bold">If your gateway is using the TCP/IP communication protocol,</span> issue the following:</p>
<pre dir="ltr">SQL&gt; column ddl_date format A22 heading &#39;LAST_DDL&#39;
SQL&gt; select object_name,
  2   object_type,
  3   to_char(LAST_DDL_TIME,&#39;MON-DD-YY HH:MM:SS&#39;) ddl_date,
  4   status
  5   from all_objects where owner = &#39;PGAADMIN&#39;
  6   order by object_type, object_name;

OBJECT_NAME    OBJECT_TYPE      LAST_DDL                 STATUS
----------     -----------      ---------------------    ---------
PGTFLIP        PACKAGE          APR-24-03 03:04:58       VALID
PGTFLIP        PACKAGE BODY     APR-24-03 05:03:52       INVALID
PGTFLIP        PROCEDURE        APR-24-03 05:04:29       INVALID
 
</pre></li>
</ul>
<div id="APPUG1126" class="sect3"><a id="sthref1334"></a>
<h4 class="sect3">Recompile the TIP Body</h4>
<p>Note that the recompilation of the specification has invalidated its dependent objects, the three client applications in addition to the package body. To complete these changes, the body must be recompiled to bring it into compliance with the specification and then the three client applications could be compiled manually, or the Oracle database compiles them automatically as they are referenced.</p>
<p>If the client applications are recompiled by the Oracle database as they are referenced, there is a one-time delay during recompilation.</p>
<p><a id="sthref1335"></a><a id="sthref1336"></a>Recompilation errors in the client application, if any, are due to:</p>
<ul>
<li>
<p>customer changes in the client application source</p>
</li>
<li>
<p>an altered PG DD definition for the TIP if the TIP has been regenerated</p>
</li>
<li>
<p>the wrong version being generated from multiple transaction entry versions saved in the PG DD if the TIP has been regenerated</p>
</li>
</ul>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<div id="APPUG1127" class="sect2"><a id="sthref1337"></a>
<h3 class="sect2">Inadvertent Alteration of TIP Specification</h3>
<p>If you make a mistake when you generate a tip (for example, if you alter a PG DD transaction definition, or if you have inadvertently specified the wrong version during regeneration), then the recompiled body will not match the stored specification; as a result, the Oracle database would invalidate the specification and any dependent client applications.</p>
<p>You may have to regenerate and recompile the TIP and its dependent client applications to restore correct operation.</p>
<p>Refer to &#34;Listing Dependency Management Information,&#34; in the <a class="olink ADFNS" href="../ADFNS/toc.htm"><span class="italic">Oracle Database Development Guide</span></a> for more information.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="appendix" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment6308">
<tr>
<td class="cellalignment6317">
<table class="cellalignment6313">
<tr>
<td class="cellalignment6312"><a href="apd.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment6312"><a href="apg.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment6320">
<table class="cellalignment6311">
<tr>
<td class="cellalignment6312"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment6312"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment6312"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment6312"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment6312"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment6312"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>