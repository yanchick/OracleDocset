<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-2669"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Configuring%20the%20RMAN%20Environment"></a><title>Configuring the RMAN Environment</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="fast recovery area, enabling"/>
<meta name="dcterms.created" content="2017-06-07T23:52:16Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Backup and Recovery User&#39;s Guide"/>
<meta name="dcterms.identifier" content="E50658-09"/>
<meta name="dcterms.isVersionOf" content="BRADV"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="rcmcnctg.htm" title="Previous" type="text/html"/>
<link rel="Next" href="rcmconfa.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E50658-09.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-5155F8E6-6E35-4261-9CC1-F12DAA9FAC5B"></a> <span id="PAGE" style="display:none;">14/48</span> <!-- End Header -->
<a id="BRADV8002"></a>
<h1 id="BRADV-GUID-5155F8E6-6E35-4261-9CC1-F12DAA9FAC5B" class="sect1"><span class="enumeration_chapter">5</span> Configuring the RMAN Environment</h1>
<div>
<p>This chapter explains the most basic tasks involved in configuring RMAN. This chapter contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfb.htm#GUID-AD92E09D-0788-4AB5-8792-5F969C8D237A">About Configuring the Environment for RMAN Backups</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-215D0081-288D-4A90-92C2-1E9CA8AF0CAB">Configuring RMAN to Make Backups to a Media Manager</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-6F28089E-6D4E-4D6B-B96E-043C35D029D5">Configuring RMAN to Make Backups to Recovery Appliance</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-302339EC-EE0F-45FB-9862-BB2BA138AA13">Configuring the Fast Recovery Area</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-03DE4CF6-9D9F-4806-B5CA-CAA4CF5F2133">Configuring the Backup Retention Policy</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-914A65A7-872E-465B-95E5-0FD5ADAF6A9C">Backup Optimization and the CONFIGURE command</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-FA142760-8ACB-43DA-939C-8407618D2D0F">Configuring an Archived Redo Log Deletion Policy</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-FDA66A53-B2AA-4C59-A142-C2F04016FAEF">Configuring RMAN in a Data Guard Environment</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-5155F8E6-6E35-4261-9CC1-F12DAA9FAC5B__GUID-4B47A9AA-4F10-4507-93C8-575ADE31B584">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfa.htm#GUID-2210B194-FDA8-4BB4-BC1E-DBE7DBEACB4A">Configuring the RMAN Environment: Advanced Topics</a> to learn about configuration options not covered in this chapter, including backup compression and encryption</p>
</li>
<li>
<p>Appendix C in the <a class="olink RCMRF90489" target="_blank" href="../RCMRF/web_services.htm#RCMRF90489"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for information about configuring RMAN for the Oracle Secure Backup (OSB) Cloud Module.</p>
</li>
</ul>
</div>
</div>
<a id="BRADV99961"></a>
<div class="props_rev_3"><a id="GUID-AD92E09D-0788-4AB5-8792-5F969C8D237A"></a>
<h2 id="BRADV-GUID-AD92E09D-0788-4AB5-8792-5F969C8D237A" class="sect2">About Configuring the Environment for RMAN Backups</h2>
<div>
<p><a id="d21351e194" class="indexterm-anchor"></a>For most parameters required for backups, RMAN provides sensible defaults that enable you to perform basic backup and recovery. When implementing an RMAN-based backup strategy, you can use RMAN more effectively if you understand the most common configurations.</p>
<p>To simplify ongoing use of RMAN, you can set several persistent configuration settings for each target database. These settings control many aspects of RMAN behavior. For example, you can configure the backup retention policy, default destinations for backups, default backup device type, and so on. You can use the <a class="olink RCMRF154" target="_blank" href="../RCMRF/rcmsynta2015.htm#RCMRF154"><code class="codeph">SHOW</code></a> and <a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><code class="codeph">CONFIGURE</code></a> commands to view and change RMAN configurations.</p>
<p>This section explains what an RMAN configuration is and how you can use the <code class="codeph">CONFIGURE</code> command to change RMAN default behavior for your backup and recovery environment. This section also introduces the major settings available to you and their more common values.</p>
<div class="infobox-note" id="GUID-AD92E09D-0788-4AB5-8792-5F969C8D237A__GUID-36E91B28-8C3C-4A5F-8130-EF9CC2F8BB69">
<p class="notep1">Note:</p>
<p>If you plan to back up to tape, refer to <span class="q">&#34;<a href="rcmconfb.htm#GUID-215D0081-288D-4A90-92C2-1E9CA8AF0CAB">Configuring RMAN to Make Backups to a Media Manager</a>&#34;</span>.</p>
</div>
<p>This section includes the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfb.htm#GUID-44DD1FEB-3A95-436C-ABF9-03921B778155">Showing and Clearing Persistent RMAN Configurations</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-3845B630-DD47-4147-BA6E-8D677CAF1CC2">Configuring the Default Device for Backups: Disk or SBT</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-BC37B3E4-3338-4452-A363-DB882F2E9415">Configuring the Default Type for Backups: Backup Sets or Copies</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-911248BA-A742-426C-9B90-51214CFAF36B">Configuring Channels</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-98BA7492-7108-4DF9-B5A2-21957072E308">Configuring Control File and Server Parameter File Autobackups</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-AD92E09D-0788-4AB5-8792-5F969C8D237A__GUID-A99BABA6-FBC7-4317-8E29-986FC08258C6">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">CONFIGURE</code> syntax</p>
</div>
</div>
<a id="BRADV566"></a><a id="BRADV8124"></a>
<div class="props_rev_3"><a id="GUID-44DD1FEB-3A95-436C-ABF9-03921B778155"></a>
<h3 id="BRADV-GUID-44DD1FEB-3A95-436C-ABF9-03921B778155" class="sect3">Showing and Clearing Persistent RMAN Configurations</h3>
<div>
<div class="section">
<p>You can use <a id="d21351e335" class="indexterm-anchor"></a><a id="d21351e337" class="indexterm-anchor"></a>the <code class="codeph">SHOW</code> command to display the current value of RMAN configured settings for the target database. You can also view whether these commands are currently set to their default values.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To view or change your CONFIGURE command settings:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to a target database and a recovery catalog (if used).</span></li>
<li class="stepexpand"><span>Run the RMAN <code class="codeph">SHOW</code> command.</span>
<div>
<p>For example, run <code class="codeph">SHOW ALL</code> as shown in the following example (sample output included). The output includes both parameters that you have changed and those that are set to the default. The configuration is displayed as the series of RMAN commands required to re-create the configuration. You can save the output in a text file and use this command file to re-create the configuration on the same or a different database.</p>
<pre dir="ltr">SHOW ALL;

RMAN configuration parameters for database with db_unique_name PROD1 are:
CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 3 DAYS;
CONFIGURE BACKUP OPTIMIZATION ON;
CONFIGURE DEFAULT DEVICE TYPE TO DISK; # default
CONFIGURE CONTROLFILE AUTOBACKUP ON; # default
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE SBT_TAPE TO &#39;%F&#39;; # default
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO &#39;%F&#39;; # default
CONFIGURE DEVICE TYPE &#39;SBT_TAPE&#39; PARALLELISM 2 BACKUP TYPE TO COMPRESSED BACKUPSET;
CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO BACKUPSET; # default
CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE SBT_TAPE TO 1; # default
CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE DISK TO 1; # default
CONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE SBT_TAPE TO 1; # default
CONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE DISK TO 1; # default
CONFIGURE CHANNEL DEVICE TYPE &#39;SBT_TAPE&#39; PARMS &#39;ENV=(OB_DEVICE=tape1)&#39;;
CONFIGURE MAXSETSIZE TO UNLIMITED; # default
CONFIGURE ENCRYPTION FOR DATABASE OFF; # default
CONFIGURE ENCRYPTION ALGORITHM &#39;AES128&#39;; # default
CONFIGURE COMPRESSION ALGORITHM &#39;BASIC&#39; AS OF RELEASE &#39;DEFAULT&#39; OPTIMIZE FOR LOAD TRUE ; # default
CONFIGURE RMAN OUTPUT TO KEEP FOR 7 DAYS; # default
CONFIGURE ARCHIVELOG DELETION POLICY TO NONE; # default
CONFIGURE SNAPSHOT CONTROLFILE NAME TO &#39;/disk1/oracle/dbs/snapcf_ev.f&#39;; # default
</pre>
<p>You can also use the <code class="codeph">SHOW</code> command with the name of a particular configuration. For example, you can view the retention policy and default device type as follows:</p>
<pre dir="ltr">SHOW RETENTION POLICY;
SHOW DEFAULT DEVICE TYPE;
</pre></div>
</li>
<li class="stepexpand"><span>Optionally, use the <code class="codeph">CONFIGURE ... CLEAR</code> command to return any configuration to its default value, as shown in the following examples:</span>
<div>
<pre dir="ltr">CONFIGURE BACKUP OPTIMIZATION CLEAR;
CONFIGURE RETENTION POLICY CLEAR;
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK CLEAR;
</pre></div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-44DD1FEB-3A95-436C-ABF9-03921B778155__GUID-A1C92018-3525-4305-8296-A60750A785AA">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF154" target="_blank" href="../RCMRF/rcmsynta2015.htm#RCMRF154"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">SHOW</code> syntax</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV162"></a><a id="BRADV163"></a><a id="BRADV89399"></a>
<div class="props_rev_3"><a id="GUID-3845B630-DD47-4147-BA6E-8D677CAF1CC2"></a>
<h3 id="BRADV-GUID-3845B630-DD47-4147-BA6E-8D677CAF1CC2" class="sect3">Configuring the Default Device for Backups: Disk or SBT</h3>
<div>
<div class="section">
<p><a id="d21351e466" class="indexterm-anchor"></a><a id="d21351e468" class="indexterm-anchor"></a>Backups for which no destination device type is specified are directed to the configured default device. RMAN is preconfigured to use disk as the default device type. No additional configuration is necessary.</p>
<p>You may need to change the default device type from disk to tape, or change it back from tape to disk. <a href="rcmconfb.htm#GUID-3845B630-DD47-4147-BA6E-8D677CAF1CC2__CHDIDJIC" title="Lists commands to specify the default device type.">Table 5-1</a> shows the commands that configure the default device.</p>
<div class="tblformal" id="GUID-3845B630-DD47-4147-BA6E-8D677CAF1CC2__CHDIDJIC">
<p class="titleintable">Table 5-1 Commands to Configure the Default Device Type</p>
<table class="cellalignment515" title="Commands to Configure the Default Device Type" summary="Lists commands to specify the default device type.">
<thead>
<tr class="cellalignment501">
<th class="cellalignment522" id="d21351e490">Command</th>
<th class="cellalignment525" id="d21351e493">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment501">
<td class="cellalignment524" id="d21351e498" headers="d21351e490">
<p><code class="codeph">CONFIGURE DEFAULT DEVICE TYPE TO DISK</code></p>
</td>
<td class="cellalignment526" headers="d21351e498 d21351e493">
<p>Specifies that backups go to disk by default.</p>
<p>If a recovery area is enabled, then the backup location defaults to the <a href="glossary.htm#GUID-6E3CDD76-A573-4E5C-B12D-59C232C96C19"><span class="xrefglossterm">fast recovery area</span></a>. Otherwise, the backup location defaults to an operating system-specific directory on disk.</p>
<p>When backing up to disk, the logical block size of the database file must be an even multiple of the physical block size of the destination device. For example, a device of type DISK with a block size of 2 kilobytes can only be used as a destination for backups of database files with logical block sizes of 2 KB, 4 KB, 6 KB, and so on. Most disk drives have physical block sizes of 512 bytes, so this limitation rarely affects backup to disk drives. Nevertheless, you can encounter this limitation when backing up to a writable DVD or a device that has a larger physical block size.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment524" id="d21351e514" headers="d21351e490">
<p><code class="codeph">CONFIGURE DEFAULT DEVICE TYPE TO sbt</code></p>
</td>
<td class="cellalignment526" headers="d21351e514 d21351e493">
<p>Specifies that backups go to tape by default.</p>
<p><span class="q">&#34;<a href="rcmconfb.htm#GUID-215D0081-288D-4A90-92C2-1E9CA8AF0CAB">Configuring RMAN to Make Backups to a Media Manager</a>&#34;</span> explains how to set up RMAN for use with a media manager. When RMAN can communicate with the media manager, you can configure RMAN to make backups to tape and specify <a href="glossary.htm#GUID-2E48CE71-9547-4196-B715-5CE59033262E"><span class="xrefglossterm">SBT</span></a> as the default device type.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p><a id="d21351e532" class="indexterm-anchor"></a><a id="d21351e536" class="indexterm-anchor"></a>You can always override the default device by using the <code class="codeph">DEVICE</code> <code class="codeph">TYPE</code> clause of the <a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><code class="codeph">BACKUP</code></a> command, as shown in the following examples:</p>
<pre dir="ltr">BACKUP DEVICE TYPE sbt DATABASE;
BACKUP DEVICE TYPE DISK DATABASE;
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To change the configured default device type:</p>
</div>
<!-- class="section" -->
<ol>
<li>
<p>Start RMAN and connect to a target database and a recovery catalog (if used).</p>
</li>
<li>
<p>Run the <code class="codeph">SHOW ALL</code> command to show the currently configured default device.</p>
</li>
<li>
<p>Run the <code class="codeph">CONFIGURE DEFAULT DEVICE TYPE</code> command, specifying either <code class="codeph">TO DISK</code> or <code class="codeph">TO sbt</code>.</p>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-3845B630-DD47-4147-BA6E-8D677CAF1CC2__GUID-D3A68BD8-FA5E-479A-B644-BA2ECB3326BE">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for more details on using the <code class="codeph">BACKUP</code> command with the <code class="codeph">DEVICE</code> <code class="codeph">TYPE</code> clause</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV164"></a><a id="BRADV89400"></a>
<div class="props_rev_3"><a id="GUID-BC37B3E4-3338-4452-A363-DB882F2E9415"></a>
<h3 id="BRADV-GUID-BC37B3E4-3338-4452-A363-DB882F2E9415" class="sect3">Configuring the Default Type for Backups: Backup Sets or Copies</h3>
<div>
<div class="section">
<p><a id="d21351e668" class="indexterm-anchor"></a><a id="d21351e672" class="indexterm-anchor"></a>The <a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><code class="codeph">BACKUP</code></a> command can create either backup sets or image copies. For disk, you can configure RMAN to create either backup sets or image copies as its default backup type with the <code class="codeph">CONFIGURE DEVICE TYPE DISK BACKUP TYPE TO</code> command. The default backup type for disk is an uncompressed <a id="d21351e685" class="indexterm-anchor"></a><a href="glossary.htm#GUID-6AA43E7D-9946-4C41-A62F-01E5BACEB8A7"><span class="xrefglossterm">backup set</span></a>.</p>
<div class="infobox-note" id="GUID-BC37B3E4-3338-4452-A363-DB882F2E9415__GUID-13388200-9291-465E-9A69-3E7E01C8AAFB">
<p class="notep1">Note:</p>
<p>Because RMAN can write an <a href="glossary.htm#GUID-397CB99E-3F07-4980-96B3-9D0D0ABBABEA"><span class="xrefglossterm">image copy</span></a> only to disk, the backup type for tape can only be a backup set.</p>
</div>
<p>RMAN can create backup sets using <a id="d21351e702" class="indexterm-anchor"></a><a id="d21351e706" class="indexterm-anchor"></a><a href="glossary.htm#GUID-90E07DCF-D038-4770-8A1A-06AF137C3762"><span class="xrefglossterm">binary compression</span></a>. You can configure RMAN to use compressed backup sets by default on a device type by specifying the <code class="codeph">COMPRESSED</code> option in the <code class="codeph">BACKUP TYPE TO ... BACKUPSET</code> clause. To disable compression, use the <code class="codeph">CONFIGURE DEVICE TYPE</code> command with arguments specifying your other desired settings, but omit the <code class="codeph">COMPRESSED</code> keyword.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To configure the default type of backup:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to a target database and a recovery catalog (if used).</span></li>
<li class="stepexpand"><span>Configure backup sets or image copies as the default backup type.</span>
<div>
<p>The following examples configure the backup type for disk backups to copies and backup sets:</p>
<pre dir="ltr">CONFIGURE DEVICE TYPE DISK BACKUP TYPE TO COPY; # image copies
CONFIGURE DEVICE TYPE DISK BACKUP TYPE TO BACKUPSET; # uncompressed
</pre>
<p>The following examples configure compression for backup sets:</p>
<pre dir="ltr">CONFIGURE DEVICE TYPE DISK BACKUP TYPE TO COMPRESSED BACKUPSET;
CONFIGURE DEVICE TYPE sbt BACKUP TYPE TO COMPRESSED BACKUPSET;
</pre>
<div class="infoboxnotealso" id="GUID-BC37B3E4-3338-4452-A363-DB882F2E9415__GUID-4F1B7117-2D8A-4EAF-87D8-BDCEDDA388FD">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="rcmcncpt.htm#GUID-74FF41AF-D1EE-4DB1-AC0D-56FC83CAA91D">About Backup Sets</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="rcmbckba.htm#GUID-E0D30989-9477-45DD-8FE1-367BDD0A7A8E">Making Compressed Backups</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
</li>
</ol>
</div>
</div>
<a id="BRADV89402"></a>
<div class="props_rev_3"><a id="GUID-911248BA-A742-426C-9B90-51214CFAF36B"></a>
<h3 id="BRADV-GUID-911248BA-A742-426C-9B90-51214CFAF36B" class="sect3">Configuring Channels</h3>
<div>
<p>As explained in <span class="q">&#34;<a href="rcmarchi.htm#GUID-282FD0B6-8593-4775-9965-DB47534D349C">About RMAN Channels</a>&#34;</span>, an RMAN <a id="d21351e833" class="indexterm-anchor"></a><a href="glossary.htm#GUID-D7D8E7D7-3CD3-4FCF-AF75-AF2BE11A366F"><span class="xrefglossterm">channel</span></a> is a connection to a database server session. RMAN uses channels to perform most tasks.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfb.htm#GUID-06001DF9-43B5-4A93-BFBC-B03D718A8692">About Channel Configuration</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-FAFF9171-43CF-493A-BA5A-AD9B59B2CFEB">Configuring Channels for Disk</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-C6D6E615-892F-4586-B14D-1BA42CB0C457">Configuring Parallel Channels for Disk and SBT Devices</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-1090ADE7-5B97-43FE-B9BA-B720C50CE6B7">Manually Overriding Configured Channels</a></p>
</li>
</ul>
</div>
<a id="BRADV89403"></a>
<div class="props_rev_3"><a id="GUID-06001DF9-43B5-4A93-BFBC-B03D718A8692"></a>
<h4 id="BRADV-GUID-06001DF9-43B5-4A93-BFBC-B03D718A8692" class="sect4">About Channel Configuration</h4>
<div>
<p><a id="d21351e933" class="indexterm-anchor"></a><a id="d21351e937" class="indexterm-anchor"></a><a id="d21351e941" class="indexterm-anchor"></a><a id="d21351e943" class="indexterm-anchor"></a>Use the <code class="codeph">CONFIGURE</code> <code class="codeph">CHANNEL</code> command to configure options for disk or <a href="glossary.htm#GUID-2E48CE71-9547-4196-B715-5CE59033262E"><span class="xrefglossterm">SBT</span></a> channels. <code class="codeph">CONFIGURE</code> <code class="codeph">CHANNEL</code> takes the same options used to specify one-time options with the <a class="olink RCMRF102" target="_blank" href="../RCMRF/rcmsynta004.htm#RCMRF102"><code class="codeph">ALLOCATE CHANNEL</code></a> command. You can configure <a id="d21351e970" class="indexterm-anchor"></a><a id="d21351e974" class="indexterm-anchor"></a>generic channel settings for a device type, that is, a template that is used for any channels created based on configured settings for that device.</p>
<div class="infobox-note" id="GUID-06001DF9-43B5-4A93-BFBC-B03D718A8692__GUID-2E08C1B6-AEF3-4D0A-B072-CE10F95444A2">
<p class="notep1">Note:</p>
<p>This section explains configuration of disk channels. To learn how to configure channels for tape, see <span class="q">&#34;<a href="rcmconfb.htm#GUID-DB37EEF2-426B-4060-BA36-FEE38C11ADB8">Configuring SBT Channels for Use with a Media Manager</a>&#34;</span>.</p>
</div>
<p>If you use <code class="codeph">CONFIGURE</code> <code class="codeph">CHANNEL</code> to specify generic channel settings for a device, any previous settings are discarded, even if the settings are not in conflict. For example, after the second <code class="codeph">CONFIGURE</code> <code class="codeph">CHANNEL</code> command, which specifies only the <a class="olink RCMRF195" target="_blank" href="../RCMRF/rcmsubcl012.htm#RCMRF195"><code class="codeph">FORMAT</code></a> for configured disk channels, the <code class="codeph">MAXPIECESIZE</code> for the disk channel is returned to its default value:</p>
<pre dir="ltr">CONFIGURE CHANNEL DEVICE TYPE DISK MAXPIECESIZE 2G;
CONFIGURE CHANNEL DEVICE TYPE DISK FORMAT /tmp/%U;
</pre></div>
</div>
<a id="BRADV165"></a><a id="BRADV602"></a><a id="BRADV89404"></a>
<div class="props_rev_3"><a id="GUID-FAFF9171-43CF-493A-BA5A-AD9B59B2CFEB"></a>
<h4 id="BRADV-GUID-FAFF9171-43CF-493A-BA5A-AD9B59B2CFEB" class="sect4">Configuring Channels for Disk</h4>
<div>
<div class="section">
<p>By default, RMAN allocates one disk channel for all operations. You may want to specify different options for this channel, for example, a new default location for backups.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-FAFF9171-43CF-493A-BA5A-AD9B59B2CFEB__CHDDEHCC">
<p class="titleinexample">Example 5-1 Configuring a Nondefault Backup Location</p>
<p>This example configures RMAN to write disk backups to the <code class="codeph">/disk1</code> directory and specifies a nondefault format for the relative file name.</p>
<pre dir="ltr">CONFIGURE CHANNEL DEVICE TYPE DISK FORMAT &#39;/disk1/ora_df%t_s%s_s%p&#39;;
</pre>
<p>In <a href="rcmconfb.htm#GUID-FAFF9171-43CF-493A-BA5A-AD9B59B2CFEB__CHDDEHCC">Example 5-1</a>, RMAN automatically replaces the format specifier <code class="codeph">%t</code> with a four byte time stamp, <code class="codeph">%s</code> with the backup set number, and <code class="codeph">%p</code> with the backup piece number.</p>
<div class="infobox-note" id="GUID-FAFF9171-43CF-493A-BA5A-AD9B59B2CFEB__GUID-9AE42905-DFA8-407D-8499-80EE084CDCA6">
<p class="notep1">Note:</p>
<p>When you configure an explicit format for disk channels, RMAN does not create backups by default in the <a href="glossary.htm#GUID-6E3CDD76-A573-4E5C-B12D-59C232C96C19"><span class="xrefglossterm">fast recovery area</span></a>. In this case, you lose the disk space management capabilities of the fast recovery area.</p>
</div>
</div>
<!-- class="example" -->
<div class="example" id="GUID-FAFF9171-43CF-493A-BA5A-AD9B59B2CFEB__BGBDHBEF">
<p class="titleinexample">Example 5-2 Configuring an ASM Disk Location</p>
<p>This example demonstrates how to configure an ASM disk location.</p>
<pre dir="ltr">CONFIGURE CHANNEL DEVICE TYPE DISK FORMAT &#39;+dgroup1&#39;;
</pre>
<div class="infoboxnotealso" id="GUID-FAFF9171-43CF-493A-BA5A-AD9B59B2CFEB__GUID-146E49DF-3C3E-42F1-8336-B49CB8917F31">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmbckba.htm#GUID-344F4D14-AC81-4093-B921-6403EE75112C">Backing Up Database Files with RMAN</a>&#34;</span> to learn how to make backups</p>
</div>
</div>
<!-- class="example" --></div>
</div>
<a id="BRADV166"></a><a id="BRADV568"></a><a id="BRADV89405"></a>
<div class="props_rev_3"><a id="GUID-C6D6E615-892F-4586-B14D-1BA42CB0C457"></a>
<h4 id="BRADV-GUID-C6D6E615-892F-4586-B14D-1BA42CB0C457" class="sect4">Configuring Parallel Channels for Disk and SBT Devices</h4>
<div>
<div class="section">
<p><a id="d21351e1202" class="indexterm-anchor"></a>The number of channels available for a device type when you run a command determines whether RMAN reads or writes in parallel. As a rule, the number of channels used in executing a command should match the number of devices accessed. Thus, for tape backups, allocate one channel for each tape drive. For disk backups, allocate one channel for each physical disk, unless you can optimize the backup for your disk subsystem architecture with multiple channels. Failing to allocate the right number of channels adversely affects RMAN performance during I/O operations.</p>
<p>You can configure <a href="glossary.htm#GUID-57D1A253-9620-4588-82E3-EC2BEC2B1B0C"><span class="xrefglossterm">channel parallelism</span></a> settings, <a href="glossary.htm#GUID-90E07DCF-D038-4770-8A1A-06AF137C3762"><span class="xrefglossterm">binary compression</span></a> for backup sets, and other options for an <a href="glossary.htm#GUID-2E48CE71-9547-4196-B715-5CE59033262E"><span class="xrefglossterm">SBT</span></a> device with <code class="codeph">CONFIGURE</code> <code class="codeph">DEVICE</code> <code class="codeph">TYPE</code> <code class="codeph">sbt</code>. You set the configuration for the device type independently of the channel configuration.</p>
<div class="infoboxnotealso" id="GUID-C6D6E615-892F-4586-B14D-1BA42CB0C457__GUID-B73AFCC8-FCD2-4F9B-BD36-953A8446EBDA">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="rcmbckba.htm#GUID-D9A1870F-E5E4-48DD-B479-C55C09B59388">Specifying Multiple Formats for Disk Backups</a>&#34;</span> to learn how to make disk backups in parallel</p>
</li>
<li>
<p><a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for reference material on the <code class="codeph">CHANNEL</code> parameter of <a id="d21351e1253" class="indexterm-anchor"></a><a id="d21351e1257" class="indexterm-anchor"></a>the <code class="codeph">BACKUP</code> command</p>
</li>
<li>
<p><a class="olink RACAD" target="_blank" href="../RACAD/toc.htm"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for information about taking advantage of parallel operations in an Oracle Real Application Clusters (Oracle RAC) configuration</p>
</li>
</ul>
</div>
</div>
<!-- class="section" -->
<div class="example" id="GUID-C6D6E615-892F-4586-B14D-1BA42CB0C457__CHDGCAFE">
<p class="titleinexample">Example 5-3 Configuring Parallelism for an SBT Device</p>
<p>This example changes the SBT device (sample output included) so that RMAN can back up to a media manager using two tape drives in parallel. Each configured SBT channel backs up approximately half the total data.</p>
<pre dir="ltr">RMAN&gt; CONFIGURE DEVICE TYPE sbt PARALLELISM 2;

old RMAN configuration parameters:
CONFIGURE DEVICE TYPE &#39;SBT_TAPE&#39; BACKUP TYPE TO COMPRESSED BACKUPSET PARALLELISM 1;
new RMAN configuration parameters:
CONFIGURE DEVICE TYPE &#39;SBT_TAPE&#39; PARALLELISM 2 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters are successfully stored
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-C6D6E615-892F-4586-B14D-1BA42CB0C457__CHDEGICJ">
<p class="titleinexample">Example 5-4 Configuring the Backup Type for an SBT Device</p>
<p>This example changes the default backup type for the SBT device to an uncompressed backup set (sample output included).</p>
<p>The <code class="codeph">CONFIGURE DEVICE TYPE</code> commands used in this example only affect parallelism and backup type and do not affect the values of settings not specified. In <a href="rcmconfb.htm#GUID-C6D6E615-892F-4586-B14D-1BA42CB0C457__CHDGCAFE">Example 5-3</a>, the default backup type of compressed backup set was not changed by changing the parallelism setting. In <a href="rcmconfb.htm#GUID-C6D6E615-892F-4586-B14D-1BA42CB0C457__CHDEGICJ">Example 5-4</a>, the ability to use multiple tape drives in parallel was not affected by changing the default backup type.</p>
<pre dir="ltr">RMAN&gt; CONFIGURE DEVICE TYPE sbt BACKUP TYPE TO BACKUPSET;
</pre>
<pre dir="ltr">old RMAN configuration parameters:
CONFIGURE DEVICE TYPE &#39;SBT_TAPE&#39; PARALLELISM 2 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters:
CONFIGURE DEVICE TYPE &#39;SBT_TAPE&#39; BACKUP TYPE TO BACKUPSET PARALLELISM 2;
new RMAN configuration parameters are successfully stored
</pre></div>
<!-- class="example" --></div>
</div>
<a id="BRADV89406"></a>
<div class="props_rev_3"><a id="GUID-1090ADE7-5B97-43FE-B9BA-B720C50CE6B7"></a>
<h4 id="BRADV-GUID-1090ADE7-5B97-43FE-B9BA-B720C50CE6B7" class="sect4">Manually Overriding Configured Channels</h4>
<div>
<div class="section">
<p>If you manually allocate a channel during a job, then RMAN disregards any configured channel settings. For example, assume that the default device type is SBT, and you execute the following command:</p>
<pre dir="ltr">RUN 
{
  ALLOCATE CHANNEL c1 DEVICE TYPE DISK;
  BACKUP TABLESPACE users;
}
</pre>
<p>In this case, RMAN uses only the disk channel that you manually allocated within the <a class="olink RCMRF151" target="_blank" href="../RCMRF/rcmsynta2012.htm#RCMRF151"><code class="codeph">RUN</code></a> command, overriding any defaults set by using <code class="codeph">CONFIGURE</code> <code class="codeph">DEVICE</code> <code class="codeph">TYPE</code>, <code class="codeph">CONFIGURE</code> <code class="codeph">DEFAULT</code> <code class="codeph">DEVICE</code>, or <code class="codeph">CONFIGURE</code> <code class="codeph">CHANNEL</code> settings.</p>
<div class="infoboxnotealso" id="GUID-1090ADE7-5B97-43FE-B9BA-B720C50CE6B7__GUID-A7E5373B-006C-4B6B-B2B0-56526FA1A2E4">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="rcmarchi.htm#GUID-282FD0B6-8593-4775-9965-DB47534D349C">About RMAN Channels</a>&#34;</span> to learn about configured and allocated channels</p>
</li>
<li>
<p><a class="olink RCMRF102" target="_blank" href="../RCMRF/rcmsynta004.htm#RCMRF102"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">ALLOCATE CHANNEL</code> syntax</p>
</li>
<li>
<p><a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">CONFIGURE</code> syntax</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="BRADV89407"></a>
<div class="props_rev_3"><a id="GUID-98BA7492-7108-4DF9-B5A2-21957072E308"></a>
<h3 id="BRADV-GUID-98BA7492-7108-4DF9-B5A2-21957072E308" class="sect3">Configuring Control File and Server Parameter File Autobackups</h3>
<div>
<div class="section">
<p>As explained in <span class="q">&#34;<a href="rcmcncpt.htm#GUID-95840C84-1595-49AC-923D-310DA750676B">About RMAN Control File and Server Parameter File Autobackups</a>&#34;</span>, you can configure RMAN to automatically back up the control file and server parameter file. The autobackup occurs whenever a backup record is added.<a id="d21351e1507" class="indexterm-anchor"></a><a id="d21351e1511" class="indexterm-anchor"></a><a id="d21351e1515" class="indexterm-anchor"></a><a id="d21351e1519" class="indexterm-anchor"></a><a id="d21351e1523" class="indexterm-anchor"></a><a id="d21351e1527" class="indexterm-anchor"></a> If the database runs in <code class="codeph">ARCHIVELOG</code> mode, then an autobackup is also taken whenever the database structure metadata in the control file changes. A <a href="glossary.htm#GUID-7CDA6567-DFB0-450D-8771-B033E9872AF7"><span class="xrefglossterm">control file autobackup</span></a> enables RMAN to recover the database even if the current control file, recovery catalog, and server parameter file are lost.</p>
<p>Because the file name for the autobackup follows a well-known format, RMAN can search for it without access to a repository and then restore the server parameter file. After you have started the instance with the restored server parameter file, RMAN can restore the control file from an autobackup. After you mount the control file, the RMAN repository is available, and RMAN can restore the data files and find the archived redo logs.</p>
<p>You can enable the autobackup feature by running the following command:</p>
<pre dir="ltr">CONFIGURE CONTROLFILE AUTOBACKUP ON;
</pre>
<p>You can disable the feature by running the following command:</p>
<pre dir="ltr">CONFIGURE CONTROLFILE AUTOBACKUP OFF;
</pre>
<p>By default, control file autobackups are turned on for CDBs and turned off for non-CDBs.</p>
<div class="infoboxnotealso" id="GUID-98BA7492-7108-4DF9-B5A2-21957072E308__GUID-AFB214A7-50F4-45C9-955F-FBA383C136C6">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">CONFIGURE</code> syntax</p>
</div>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfb.htm#GUID-C64AE090-0749-43EA-92C4-69DC6201A15F">Configuring the Control File Autobackup Format</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-B04B5550-6DF9-4FDE-A03A-CFDF57518264">Overriding the Configured Control File Autobackup Format</a></p>
</li>
</ul>
</div>
<!-- class="section" --></div>
<a id="BRADV8101"></a>
<div class="props_rev_3"><a id="GUID-C64AE090-0749-43EA-92C4-69DC6201A15F"></a>
<h4 id="BRADV-GUID-C64AE090-0749-43EA-92C4-69DC6201A15F" class="sect4">Configuring the Control File Autobackup Format</h4>
<div>
<div class="section">
<p><a id="d21351e1645" class="indexterm-anchor"></a><a id="d21351e1649" class="indexterm-anchor"></a><a id="d21351e1653" class="indexterm-anchor"></a><a id="d21351e1657" class="indexterm-anchor"></a><a id="d21351e1661" class="indexterm-anchor"></a><a id="d21351e1665" class="indexterm-anchor"></a>By default, the format of the autobackup file for all configured devices is the substitution variable <code class="codeph">%F</code> in the <a class="olink RCMRF195" target="_blank" href="../RCMRF/rcmsubcl012.htm#RCMRF195"><code class="codeph">FORMAT</code></a> clause. This variable format translates into <span class="italic"><code class="codeph">c-IIIIIIIIII-YYYYMMDD-QQ</code></span>, with the placeholders defined as follows:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><span class="italic"><code class="codeph">IIIIIIIIII</code></span> stands for the DBID.</p>
</li>
<li>
<p><span class="italic"><code class="codeph">YYYYMMDD</code></span> is a time stamp of the day the backup is generated.</p>
</li>
<li>
<p><span class="italic"><code class="codeph">QQ</code></span> is the hexadecimal sequence that starts with <code class="codeph">00</code> and has a maximum of <code class="codeph">FF</code>.</p>
</li>
</ul>
<p>You can change the default format by using the following command, where <span class="italic"><code class="codeph">deviceSpecifier</code></span> is any valid device type, and &#39;<span class="italic"><code class="codeph">string</code></span>&#39; must contain the substitution variable <code class="codeph">%F</code> (and no other substitution variables) and is a valid handle for the specified device:</p>
<pre dir="ltr">CONFIGURE CONTROLFILE AUTOBACKUP FORMAT 
  FOR DEVICE TYPE <span class="italic">deviceSpecifier</span> TO &#39;<span class="italic">string</span>&#39;;
</pre>
<p>For example, you can run the following command to specify a nondefault file name for the control file autobackup. In the file name, <code class="codeph">?</code> stands for <code class="codeph">ORACLE_HOME</code>.</p>
<pre dir="ltr">CONFIGURE CONTROLFILE AUTOBACKUP FORMAT 
  FOR DEVICE TYPE DISK TO &#39;?/oradata/cf_%F&#39;;
</pre>
<p>The following example configures the autobackup to write to an Automatic Storage Management disk group:</p>
<pre dir="ltr">CONFIGURE CONTROLFILE AUTOBACKUP FORMAT 
  FOR DEVICE TYPE DISK TO &#39;+dgroup1/%F&#39;;
</pre>
<div class="infobox-note" id="GUID-C64AE090-0749-43EA-92C4-69DC6201A15F__GUID-617A138B-8098-458B-B12A-0521B5907E3C">
<p class="notep1">Note:</p>
<p>The valid formats for control file autobackups are: <code class="codeph">%D</code>, <code class="codeph">%I</code>, <code class="codeph">%M</code>, <code class="codeph">%Y</code>, <code class="codeph">%F</code>, <code class="codeph">%T</code>, <code class="codeph">%d</code>, and <code class="codeph">%n</code>. If you use formats other than these, you may not be able to restore the control file autobackup.</p>
</div>
<p>To clear control file autobackup formats for a device, use the following commands:</p>
<pre dir="ltr">CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK CLEAR;
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE sbt CLEAR;
</pre>
<p>If you have set up a <a id="d21351e1778" class="indexterm-anchor"></a><a href="glossary.htm#GUID-6E3CDD76-A573-4E5C-B12D-59C232C96C19"><span class="xrefglossterm">fast recovery area</span></a> for the database, then you can direct control file autobackups to the fast recovery area by clearing the control file autobackup format for disk.</p>
<div class="infobox-note" id="GUID-C64AE090-0749-43EA-92C4-69DC6201A15F__GUID-7E11ECA8-B5D9-4826-877A-73B07200478C">
<p class="notep1">Note:</p>
<p>All files in the fast recovery area are maintained by Oracle Database and associated file names are maintained in the Oracle Managed Files (OMF) format.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV89408"></a>
<div class="props_rev_3"><a id="GUID-B04B5550-6DF9-4FDE-A03A-CFDF57518264"></a>
<h4 id="BRADV-GUID-B04B5550-6DF9-4FDE-A03A-CFDF57518264" class="sect4">Overriding the Configured Control File Autobackup Format</h4>
<div>
<div class="section">
<p>The <a class="olink RCMRF153" target="_blank" href="../RCMRF/rcmsynta2014.htm#RCMRF153"><code class="codeph">SET</code></a> <code class="codeph">CONTROLFILE</code> <code class="codeph">AUTOBACKUP</code> <code class="codeph">FORMAT</code> command, which you can specify either within a <a class="olink RCMRF151" target="_blank" href="../RCMRF/rcmsynta2012.htm#RCMRF151"><code class="codeph">RUN</code></a> command or at the RMAN prompt, overrides the configured autobackup format in the current session only. The order of precedence is:</p>
</div>
<!-- class="section" -->
<ol>
<li><span><code class="codeph">SET CONTROLFILE AUTOBACKUP FORMAT</code> (within a <code class="codeph">RUN</code> block<code class="codeph">)</code></span></li>
<li><span><code class="codeph">SET CONTROLFILE AUTOBACKUP FORMAT</code> (at <code class="codeph">RMAN</code> prompt)</span></li>
<li><span><code class="codeph">CONFIGURE CONTROLFILE AUTOBACKUP FORMAT</code></span></li>
</ol>
<div class="section">
<p>The following example shows how the two forms of <code class="codeph">SET</code> <code class="codeph">CONTROLFILE</code> <code class="codeph">AUTOBACKUP</code> <code class="codeph">FORMAT</code> interact:</p>
<pre dir="ltr">SET CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO &#39;controlfile_%F&#39;;
BACKUP AS COPY DATABASE;
RUN
{ 
  SET CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO &#39;/tmp/%F.bck&#39;; 
  BACKUP AS BACKUPSET 
    DEVICE TYPE DISK 
    DATABASE;
}
</pre>
<p>The first <code class="codeph">SET CONTROLFILE AUTOBACKUP FORMAT</code> controls the name of the control file autobackup until the RMAN client exits, overriding any configured control file autobackup format. The <code class="codeph">SET CONTROFILE AUTOBACKUP FORMAT</code> in the <code class="codeph">RUN</code> block overrides the <code class="codeph">SET CONTROLFILE AUTOBACKUP FORMAT</code> outside the <code class="codeph">RUN</code> block for the duration of the <code class="codeph">RUN</code> block.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<a id="BRADV132"></a>
<div class="props_rev_3"><a id="GUID-215D0081-288D-4A90-92C2-1E9CA8AF0CAB"></a>
<h2 id="BRADV-GUID-215D0081-288D-4A90-92C2-1E9CA8AF0CAB" class="sect2">Configuring RMAN to Make Backups to a Media Manager</h2>
<div>
<div class="section">
<p>On most platforms, to back up to and restore from sequential media such as tape you must integrate a <a id="d21351e2012" class="indexterm-anchor"></a><a href="glossary.htm#GUID-26FF62D0-5938-481D-B7B9-929BC971813E"><span class="xrefglossterm">media management software</span></a> with your Oracle database. You can use <a id="d21351e2020" class="indexterm-anchor"></a><a href="glossary.htm#GUID-8879C26C-4DF5-4040-BC7A-37CF7C482C56"><span class="xrefglossterm">Oracle Secure Backup</span></a>, which supports both database and file system backups to tape, as your media manager. See <a class="olink OBADM" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=OBADM"><span class="italic">Oracle Secure Backup Administrator&#39;s Guide</span></a> to learn how to set up RMAN for use specifically with Oracle Secure Backup.</p>
<p>If you do not use Oracle Secure Backup, then you can use a third-party media manager. This section describes the generic steps for configuring RMAN for use with a third-party media manager. The actual steps depend on the media management product that you install and the platform on which you run the database. If you opt to use RMAN with a media manager other than Oracle Secure Backup, then you must obtain all product-specific information from the vendor.</p>
<p>Read the following sections in order when configuring the media manager:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span><a href="rcmconfb.htm#GUID-B46C2D03-78D2-4880-8D47-57B2BD8C84C9">Prerequisites for Using a Media Manager with RMAN</a></span></li>
<li class="stepexpand"><span><a href="rcmconfb.htm#GUID-E9AE6653-6F60-4ED6-8AC1-7C6A31C9321F">Determining the Location of the Media Management Library</a></span></li>
<li class="stepexpand"><span><a href="rcmconfb.htm#GUID-56142138-9032-4454-B289-8A67A577682F">Configuring Media Management Software for RMAN Backups</a></span></li>
<li class="stepexpand"><span><a href="rcmconfb.htm#GUID-8AD950E0-2C8C-42A1-884F-B416CBE06CB0">Testing Whether the Media Manager Library Is Integrated Correctly</a></span></li>
<li class="stepexpand"><span><a href="rcmconfb.htm#GUID-DB37EEF2-426B-4060-BA36-FEE38C11ADB8">Configuring SBT Channels for Use with a Media Manager</a></span>
<div>
<div class="infoboxnotealso" id="GUID-215D0081-288D-4A90-92C2-1E9CA8AF0CAB__GUID-5602B1AD-1753-4B5A-AF8A-C00552A918F1">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmarchi.htm#GUID-12A32971-242E-4C62-AE95-26D58D5C983D">About Media Management Using RMAN</a>&#34;</span> for an overview of media management software and its implications for RMAN</p>
</div>
</div>
</li>
</ol>
</div>
<a id="BRADV89409"></a>
<div class="props_rev_3"><a id="GUID-B46C2D03-78D2-4880-8D47-57B2BD8C84C9"></a>
<h3 id="BRADV-GUID-B46C2D03-78D2-4880-8D47-57B2BD8C84C9" class="sect3">Prerequisites for Using a Media Manager with RMAN</h3>
<div>
<p><a id="d21351e2138" class="indexterm-anchor"></a><a id="d21351e2142" class="indexterm-anchor"></a>Before you can begin using RMAN with a third-party media manager, you must install the media manager and ensure that RMAN can communicate with it. Refer to the media management vendor&#39;s software documentation for instructions.</p>
<p><a id="d21351e2148" class="indexterm-anchor"></a><a id="d21351e2152" class="indexterm-anchor"></a>In general, you begin by installing and configuring the media management software on the target host or production network. Ensure that you can make non-RMAN backups of operating system files on the target database host. This step makes later troubleshooting much easier by confirming that the basic integration of the media manager with the target host has been successful. Refer to your media management documentation to learn how to back up files to the media manager without using RMAN.</p>
<p>Then, obtain and install the third-party media management module for integration with the database server. This module contains the <a href="glossary.htm#GUID-AAB3332C-E54E-49E3-9FFB-C2ED6232FA43"><span class="xrefglossterm">media management library</span></a> that the Oracle database loads and uses when accessing the media manager. It is generally a third-party product that must be purchased separately. Contact your media management vendor for details.</p>
</div>
</div>
<a id="BRADV89410"></a>
<div class="props_rev_3"><a id="GUID-E9AE6653-6F60-4ED6-8AC1-7C6A31C9321F"></a>
<h3 id="BRADV-GUID-E9AE6653-6F60-4ED6-8AC1-7C6A31C9321F" class="sect3">Determining the Location of the Media Management Library</h3>
<div>
<div class="section">
<p><a id="d21351e2233" class="indexterm-anchor"></a><a id="d21351e2239" class="indexterm-anchor"></a><a id="d21351e2243" class="indexterm-anchor"></a>Before attempting to use RMAN with a media manager, determine the location of the media management library. When allocating or configuring a <a href="glossary.htm#GUID-D7D8E7D7-3CD3-4FCF-AF75-AF2BE11A366F"><span class="xrefglossterm">channel</span></a> for RMAN to use to communicate with a media manager, you must specify the <code class="codeph">SBT_LIBRARY</code> parameter in an <code class="codeph">ALLOCATE CHANNEL</code> or <code class="codeph">CONFIGURE CHANNEL</code> command. The <code class="codeph">SBT_LIBRARY</code> parameter specifies the path to the library.</p>
<p>The following example shows the channel syntax, where <span class="italic">pathname</span> is the absolute file name of the library:</p>
<pre dir="ltr">CONFIGURE CHANNEL DEVICE TYPE sbt
  PARMS &#39;SBT_LIBRARY=<span class="italic">pathname</span>&#39;;
</pre>
<p>When RMAN allocates channels to communicate with a media manager, it attempts to load the library indicated by the <code class="codeph">SBT_LIBRARY</code> parameter.</p>
<p>If you do not provide a value for the <code class="codeph">SBT_LIBRARY</code> parameter in an allocated or preconfigured channel, then RMAN looks in a platform-specific and secured default location.</p>
<p>On Linux and UNIX, the SBT library is loaded from:</p>
<pre dir="ltr">/opt/oracle/extapi/[32,64]/{SBT}/{VENDOR}/{VERSION}/libobk.so
</pre>
<p>The SBT library file name extension name varies according to platform:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">.so</code>, <code class="codeph">.sl</code> on HP-UX,</p>
</li>
<li>
<p><code class="codeph">.a</code> on AIX,</p>
</li>
</ul>
<p>On Windows, the SBT library is loaded from:</p>
<pre dir="ltr">%SYSTEM_DRIVE%\oracle\extapi\[32,64]\{SBT}\{VENDOR}\{VERSION}\orasbt.dll
</pre>
<p>If RMAN cannot use the secured default location or if you are using Oracle Database 11<span class="italic">g</span> or earlier, then RMAN loads the SBT library from the location designated by the environment variables <code class="codeph">PATH</code> or <code class="codeph">LIBPATH</code>.</p>
<p>In some cases, your organization may have security or regulatory compliance requirements that prohibit the use of environment variables <code class="codeph">PATH</code> or <code class="codeph">LIBPATH</code> to designate a library directory. To disable this behavior, set the <code class="codeph">PARMS</code> string to <code class="codeph">SBT_SECURE=1</code>.</p>
<div class="infobox-note" id="GUID-E9AE6653-6F60-4ED6-8AC1-7C6A31C9321F__GUID-A3E39E33-948A-4636-8FBF-5F03AF3E668F">
<p class="notep1">Note:</p>
<p>The default media management library file is <span class="italic">not</span> part of the standard database installation. It is present only if you install third-party media management software.</p>
</div>
<div class="infoboxnotealso" id="GUID-E9AE6653-6F60-4ED6-8AC1-7C6A31C9321F__GUID-56464409-FDB4-4DA1-898F-6E3855F26B7C">
<p class="notep1">See Also:</p>
<p>Your operating system-specific database documentation and the documentation supplied by your media vendor for instructions on how to achieve media manager integration on your platform</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV569"></a><a id="BRADV89411"></a>
<div class="props_rev_3"><a id="GUID-56142138-9032-4454-B289-8A67A577682F"></a>
<h3 id="BRADV-GUID-56142138-9032-4454-B289-8A67A577682F" class="sect3">Configuring Media Management Software for RMAN Backups</h3>
<div>
<div class="section">
<p><a id="d21351e2416" class="indexterm-anchor"></a><a id="d21351e2420" class="indexterm-anchor"></a>After installing the media management software, perform whatever configuration that your vendor requires so that the software can accept RMAN backups. Depending on the type of media management software that you installed, you may have to define media pools, configure users and classes, and so on.</p>
<p>Consult your media management vendor documentation for the appropriate RMAN settings. The <code class="codeph">PARMS</code> parameter sends instructions to the media manager. If <code class="codeph">PARMS</code> values are needed for the <a class="olink RCMRF102" target="_blank" href="../RCMRF/rcmsynta004.htm#RCMRF102"><code class="codeph">ALLOCATE CHANNEL</code></a> or the <a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><code class="codeph">CONFIGURE CHANNEL</code></a> command, or if a <a class="olink RCMRF195" target="_blank" href="../RCMRF/rcmsubcl012.htm#RCMRF195"><code class="codeph">FORMAT</code></a> string is recommended for <a id="d21351e2447" class="indexterm-anchor"></a><a id="d21351e2451" class="indexterm-anchor"></a>the <a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><code class="codeph">BACKUP</code></a> or <code class="codeph">CONFIGURE</code> command, then refer to the vendor documentation for this information.</p>
<p><a href="rcmconfb.htm#GUID-56142138-9032-4454-B289-8A67A577682F__CHDCDBHB">Example 5-5</a> shows a <code class="codeph">PARMS</code> setting for Oracle Secure Backup. This <code class="codeph">PARMS</code> settings instructs the media manager to back up to a family of tapes called <code class="codeph">datafile_mf</code>. The <code class="codeph">PARMS</code> settings are always vendor-specific.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-56142138-9032-4454-B289-8A67A577682F__CHDCDBHB">
<p class="titleinexample">Example 5-5 PARMS Setting for Oracle Secure Backup</p>
<pre dir="ltr">CONFIGURE CHANNEL DEVICE TYPE &#39;SBT_TAPE&#39;
  PARMS &#39;ENV=(OB_MEDIA_FAMILY=datafile_mf)&#39;;
</pre>
<div class="infoboxnotealso" id="GUID-56142138-9032-4454-B289-8A67A577682F__GUID-C6E09F72-8923-4EF4-A244-28127DB0A0FF">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink RCMRF102" target="_blank" href="../RCMRF/rcmsynta004.htm#RCMRF102"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">ALLOCATE</code> <code class="codeph">CHANNEL</code> syntax</p>
</li>
<li>
<p><a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for channel control options</p>
</li>
<li>
<p><a class="olink OBREF564" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=OBREF564"><span class="italic">Oracle Secure Backup Reference</span></a> for RMAN-specific parameter settings for Oracle Secure Backup</p>
</li>
</ul>
</div>
</div>
<!-- class="example" --></div>
</div>
<a id="BRADV89412"></a>
<div class="props_rev_3"><a id="GUID-8AD950E0-2C8C-42A1-884F-B416CBE06CB0"></a>
<h3 id="BRADV-GUID-8AD950E0-2C8C-42A1-884F-B416CBE06CB0" class="sect3">Testing Whether the Media Manager Library Is Integrated Correctly</h3>
<div>
<p><a id="d21351e2582" class="indexterm-anchor"></a><a id="d21351e2584" class="indexterm-anchor"></a><a id="d21351e2586" class="indexterm-anchor"></a><a id="d21351e2590" class="indexterm-anchor"></a><a id="d21351e2592" class="indexterm-anchor"></a><a id="d21351e2596" class="indexterm-anchor"></a>After you have confirmed that the database server can load the media management library, test to ensure that RMAN can back up to the media manager.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfb.htm#GUID-DCB869C0-C252-4A37-A618-7D505775B1B1">Testing ALLOCATE CHANNEL on the Media Manager</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-4685176B-25B4-4C5A-94E6-2DE2B2A5DC24">Testing Backup and Restore Operations on the Media Manager</a></p>
</li>
</ul>
</div>
<a id="BRADV169"></a><a id="BRADV89413"></a>
<div class="props_rev_3"><a id="GUID-DCB869C0-C252-4A37-A618-7D505775B1B1"></a>
<h4 id="BRADV-GUID-DCB869C0-C252-4A37-A618-7D505775B1B1" class="sect4">Testing ALLOCATE CHANNEL on the Media Manager</h4>
<div>
<div class="section">
<p>The following steps use the <code class="codeph">ALLOCATE CHANNEL</code> command to perform a basic test of RMAN communication with the media manager.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To test channel allocation on the media manager:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to a target database and a recovery catalog (if used).</span></li>
<li class="stepexpand"><span>Run the <code class="codeph">ALLOCATE</code> <code class="codeph">CHANNEL</code> command with the <code class="codeph">PARMS</code> required by your media management software.</span>
<div>
<p>The following <code class="codeph">RUN</code> command shows sample vendor-specific <code class="codeph">PARMS</code> settings:</p>
<pre dir="ltr">RUN
{
  ALLOCATE CHANNEL c1 DEVICE TYPE sbt
    PARMS &#39;SBT_LIBRARY=/mydir/lib/libobk.so,
    ENV=(OB_DEVICE=drive1,OB_MEDIA_FAMILY=datafile_mf)&#39;;
}
</pre></div>
</li>
<li class="stepexpand"><span>Examine the RMAN output.</span>
<div>
<p>If you do not receive an error message, then the database successfully loaded the media management library. If you receive the <code class="codeph">ORA-27211</code> error, the media management library could not be loaded:</p>
<pre dir="ltr">RMAN-00571: ===========================================================
RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS ===============
RMAN-00571: ===========================================================
RMAN-03009: failure of allocate command on c1 channel at 11/30/2007 13:57:18
ORA-19554: error allocating device, device type: SBT_TAPE, device name: 
ORA-27211: Failed to load Media Management Library
Additional information: 25
</pre>
<p>In this case, check the media management installation to ensure that the library is correctly installed, and recheck the value for the <code class="codeph">SBT_LIBRARY</code> parameter as described in <span class="q">&#34;<a href="rcmconfb.htm#GUID-E9AE6653-6F60-4ED6-8AC1-7C6A31C9321F">Determining the Location of the Media Management Library</a>&#34;</span>.</p>
<p>If the database cannot locate a media management library in the location specified by the <code class="codeph">SBT_LIBRARY</code> parameter or the default location, then RMAN issues an <code class="codeph">ORA-27211</code> error and exits.</p>
</div>
</li>
</ol>
<div class="section">
<p>Whenever channel allocation fails, the database writes a trace file to the <code class="codeph">trace</code> subdirectory in the <a id="d21351e2756" class="indexterm-anchor"></a><a href="glossary.htm#GUID-BDCE90D1-13B7-4D2C-A761-1583A238A247"><span class="xrefglossterm">Automatic Diagnostic Repository (ADR)</span></a> home directory. The following shows sample output:</p>
<pre dir="ltr">SKGFQ OSD: Error in function sbtinit on line 2278
SKGFQ OSD: Look for SBT Trace messages in file /oracle/rdbms/log/sbtio.log
SBT Initialize failed for /oracle/lib/libobk.so
</pre>
<div class="infoboxnotealso" id="GUID-DCB869C0-C252-4A37-A618-7D505775B1B1__GUID-C5AC8D34-51FB-4E4C-A6CD-9E253A9B3CCE">
<p class="notep1">See Also:</p>
<p><a class="olink ADMIN005" target="_blank" href="../ADMIN/monitoring.htm#ADMIN005"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> to learn how to use the Automatic Diagnostic Repository to monitor database operations</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV570"></a><a id="BRADV171"></a><a id="BRADV89414"></a>
<div class="props_rev_3"><a id="GUID-4685176B-25B4-4C5A-94E6-2DE2B2A5DC24"></a>
<h4 id="BRADV-GUID-4685176B-25B4-4C5A-94E6-2DE2B2A5DC24" class="sect4">Testing Backup and Restore Operations on the Media Manager</h4>
<div>
<div class="section">
<p><a id="d21351e2843" class="indexterm-anchor"></a><a id="d21351e2847" class="indexterm-anchor"></a><a id="d21351e2853" class="indexterm-anchor"></a>After testing a channel allocation on the media manager, create and restore a test backup.</p>
<p>If the backup and restore operations succeed, then you are ready to use the media manager with RMAN. Possible failures include the following cases:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>The backup hangs.</p>
<p>A hanging backup usually indicates that the media manager is waiting to mount a tape. Check if there are any media manager jobs in tape mount request mode and fix the problem. Ensure that the steps in <span class="q">&#34;<a href="rcmconfb.htm#GUID-215D0081-288D-4A90-92C2-1E9CA8AF0CAB">Configuring RMAN to Make Backups to a Media Manager</a>&#34;</span> are correctly done.</p>
</li>
<li>
<p>The backup fails with <code class="codeph">ORA-27211: Failed to load Media Management Library</code>.</p>
<p>This error indicates that the media management software is not correctly configured. Ensure that the steps in <span class="q">&#34;<a href="rcmconfb.htm#GUID-215D0081-288D-4A90-92C2-1E9CA8AF0CAB">Configuring RMAN to Make Backups to a Media Manager</a>&#34;</span> are correctly done. Also, ensure that you have the <code class="codeph">PARMS</code> and <code class="codeph">FORMAT</code> strings required by your media management software.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-4685176B-25B4-4C5A-94E6-2DE2B2A5DC24__GUID-5E9A074B-7EEF-4313-BB1A-B2A50DB1D664">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmtroub.htm#GUID-B1E9715D-BD07-4B80-8158-33981138E679">Testing the Media Management API</a>&#34;</span> and <a href="rcmtroub.htm#GUID-ABFD58BD-5D3B-4A6C-AA46-E085AE234D73">Troubleshooting RMAN Operations</a></p>
</div>
</div>
<!-- class="section" -->
<div class="example" id="GUID-4685176B-25B4-4C5A-94E6-2DE2B2A5DC24__CHDDDJGD">
<p class="titleinexample">Example 5-6 Backing Up the Server Parameter File to Tape</p>
<p>You can use the command in this example (substituting the channel settings required by your media management vendor) to test whether a backup can be created on the media manager. If your database does not use a server parameter file, then back up the current control file instead.</p>
<pre dir="ltr">RUN
{
  ALLOCATE CHANNEL c1 DEVICE TYPE sbt
    PARMS &#39;SBT_LIBRARY=/mydir/lib/libobk.so,
    ENV=(OB_DEVICE=drive1,OB_MEDIA_FAMILY=datafile_mf)&#39;;
  BACKUP SPFILE;
  # If your database does not use a server parameter file, use:
  # BACKUP CURRENT CONTROLFILE;
}
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-4685176B-25B4-4C5A-94E6-2DE2B2A5DC24__CHDDDCBE">
<p class="titleinexample">Example 5-7 Restoring the Server Parameter File from Tape</p>
<p>This example restores the backup created in <a href="rcmconfb.htm#GUID-4685176B-25B4-4C5A-94E6-2DE2B2A5DC24__CHDDDJGD">Example 5-6</a> to a temporary directory. If the backup to the media manager succeeds, then attempt to restore the server parameter file as an initialization parameter file.</p>
<pre dir="ltr">RUN
{
  ALLOCATE CHANNEL c1 DEVICE TYPE sbt
    PARMS &#39;SBT_LIBRARY=/mydir/lib/libobk.so,
    ENV=(OB_DEVICE=drive1,OB_MEDIA_FAMILY=datafile_mf)&#39;;
  RESTORE SPFILE TO PFILE &#39;/tmp/test_restore.f&#39;;
  # If your database does not use a server parameter file, use:
  # RESTORE CURRENT CONTROLFILE TO &#39;/tmp/test_restore.f&#39;;
}
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<a id="BRADV89415"></a>
<div class="props_rev_3"><a id="GUID-DB37EEF2-426B-4060-BA36-FEE38C11ADB8"></a>
<h3 id="BRADV-GUID-DB37EEF2-426B-4060-BA36-FEE38C11ADB8" class="sect3">Configuring SBT Channels for Use with a Media Manager</h3>
<div>
<p>You can configure RMAN channels for use with a media manager. For an overview of configured channels and how they are used, refer to the section <span class="q">&#34;<a href="rcmconfa.htm#GUID-EF072AB8-AE89-4847-90B1-2214FD2336B3">Configuring Advanced Channel Options</a>&#34;</span>.</p>
<p>The following topics provide information about configuring channels for use with a media manager:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfb.htm#GUID-91DF2C07-F857-445A-AB71-8ED824520228">About Media Manager Backup Piece Names</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-4DD4BBA1-9374-44BF-B56B-F3995EBD761E">Configuring Automatic SBT Channels</a></p>
</li>
</ul>
</div>
<a id="BRADV89416"></a>
<div class="props_rev_3"><a id="GUID-91DF2C07-F857-445A-AB71-8ED824520228"></a>
<h4 id="BRADV-GUID-91DF2C07-F857-445A-AB71-8ED824520228" class="sect4">About Media Manager Backup Piece Names</h4>
<div>
<p><a id="d21351e3074" class="indexterm-anchor"></a><a id="d21351e3078" class="indexterm-anchor"></a>A <a href="glossary.htm#GUID-AED62318-D45A-49FA-B4B4-DAD98647FCF6"><span class="xrefglossterm">backup piece</span></a> name is determined by the <a class="olink RCMRF195" target="_blank" href="../RCMRF/rcmsubcl012.htm#RCMRF195"><code class="codeph">FORMAT</code></a> string specified in <a id="d21351e3092" class="indexterm-anchor"></a><a id="d21351e3096" class="indexterm-anchor"></a>the <code class="codeph">BACKUP</code> command, <code class="codeph">CONFIGURE</code> <code class="codeph">CHANNEL</code> command, or <code class="codeph">ALLOCATE</code> <code class="codeph">CHANNEL</code> command. The media manager considers the backup piece name as the name of the backup file, so every backup piece must have a unique name in the <a href="glossary.htm#GUID-BF263385-102C-44FF-AE86-40FBA05CE30C"><span class="xrefglossterm">media management catalog</span></a>.</p>
<p>You can use the <a id="d21351e3124" class="indexterm-anchor"></a>substitution variables in a <code class="codeph">FORMAT</code> parameter to generate unique backup piece names. For example, <code class="codeph">%d</code> specifies the name of the database, whereas <code class="codeph">%t</code> specifies the backup time stamp. For most purposes, you can use <code class="codeph">%U</code>, in which case RMAN automatically generates a unique file name. The backup piece name <code class="codeph">12i1nk47_1_1</code> is an example. If you do not specify the <code class="codeph">FORMAT</code> parameter, then RMAN automatically generates a unique file name with the <code class="codeph">%U</code> substitution variable.</p>
<p>Your media manager may impose restrictions on file names and sizes. In this case, you may need more control over the naming of backup pieces so that they obey media manager restrictions. For example, some media managers only support a 14-character backup piece name, and some require special <code class="codeph">FORMAT</code> strings. The unique names generated by the <code class="codeph">%U</code> substitution variable do not exceed 14 characters.</p>
<p>Some <a id="d21351e3159" class="indexterm-anchor"></a>media managers may have limits on the maximum size of files that they can back up or restore. You must ensure that RMAN does not produce backup sets larger than those limits. To limit backup piece sizes, use the parameter <a id="d21351e3164" class="indexterm-anchor"></a><code class="codeph">MAXPIECESIZE</code>, which you can set in the <code class="codeph">CONFIGURE</code> <code class="codeph">CHANNEL</code> and <code class="codeph">ALLOCATE</code> <code class="codeph">CHANNEL</code> commands.</p>
<div class="infoboxnotealso" id="GUID-91DF2C07-F857-445A-AB71-8ED824520228__GUID-3099C718-8B8F-4F1F-AF39-0BE09910F7FC">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink RCMRF104" target="_blank" href="../RCMRF/rcmsubcl001.htm#RCMRF104"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> and <span class="q">&#34;<a href="rcmcncpt.htm#GUID-DD7E7E32-B0F7-4FA0-91C3-0811610A13D9">About Number and Size of RMAN Backup Pieces</a>&#34;</span> to learn how to set <code class="codeph">MAXPIECESIZE</code></p>
</li>
<li>
<p><a class="olink RCMRF195" target="_blank" href="../RCMRF/rcmsubcl012.htm#RCMRF195"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for the complete list of variables allowable in format strings with the <code class="codeph">BACKUP</code> command</p>
</li>
<li>
<p>Your media management documentation to determine the string character limit for the media manager</p>
</li>
</ul>
</div>
</div>
</div>
<a id="BRADV571"></a><a id="BRADV89417"></a>
<div class="props_rev_3"><a id="GUID-4DD4BBA1-9374-44BF-B56B-F3995EBD761E"></a>
<h4 id="BRADV-GUID-4DD4BBA1-9374-44BF-B56B-F3995EBD761E" class="sect4">Configuring Automatic SBT Channels</h4>
<div>
<div class="section">
<p>The easiest technique for backing up to a media manager is to configure automatic <a id="d21351e3287" class="indexterm-anchor"></a><a href="glossary.htm#GUID-2E48CE71-9547-4196-B715-5CE59033262E"><span class="xrefglossterm">SBT</span></a> channels. As explained in <span class="q">&#34;<a href="rcmconfb.htm#GUID-3845B630-DD47-4147-BA6E-8D677CAF1CC2">Configuring the Default Device for Backups: Disk or SBT</a>&#34;</span>, you can use a tape device as your default backup destination.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To configure channels for use with a media manager:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Configure a generic SBT channel.</span>
<div>
<p>In the configuration, enter all parameters that you tested <span class="q">&#34;<a href="rcmconfb.htm#GUID-4685176B-25B4-4C5A-94E6-2DE2B2A5DC24">Testing Backup and Restore Operations on the Media Manager</a>&#34;</span>. The following example configures vendor-specific channel parameters and sets the default device:</p>
<pre dir="ltr">CONFIGURE CHANNEL DEVICE TYPE sbt 
  PARMS &#39;ENV=(OB_RESOURCE_WAIT_TIME=1minute,OB_DEVICE=tape1)&#39;;
</pre></div>
</li>
<li class="stepexpand"><span>Configure the default device type to SBT, as shown in the following command:</span>
<div>
<pre dir="ltr">CONFIGURE DEFAULT DEVICE TYPE TO sbt;
</pre>
<p>If you use multiple tape devices, then you must specify the channel parallelism as described in <span class="q">&#34;<a href="rcmconfb.htm#GUID-C6D6E615-892F-4586-B14D-1BA42CB0C457">Configuring Parallel Channels for Disk and SBT Devices</a>&#34;</span>. The following configuration enables you to back up to two tape drives in parallel:</p>
<pre dir="ltr">CONFIGURE DEVICE TYPE sbt PARALLELISM 2;
</pre>
<p>Optionally, check your channel configuration by running the following command:</p>
<pre dir="ltr">SHOW CHANNEL FOR DEVICE TYPE sbt;
</pre></div>
</li>
<li class="stepexpand"><span>Make a test backup to tape.</span>
<div>
<p>The following command backs up the server parameter file to tape:</p>
<pre dir="ltr">BACKUP SPFILE;
</pre></div>
</li>
<li class="stepexpand"><span>List your backups to ensure that the test backup went to the media manager:</span>
<div>
<pre dir="ltr">LIST BACKUP OF SPFILE;
</pre></div>
</li>
</ol>
</div>
</div>
</div>
</div>
<a id="BRADV453"></a>
<div class="props_rev_3"><a id="GUID-6F28089E-6D4E-4D6B-B96E-043C35D029D5"></a>
<h2 id="BRADV-GUID-6F28089E-6D4E-4D6B-B96E-043C35D029D5" class="sect2">Configuring RMAN to Make Backups to Recovery Appliance</h2>
<div>
<p>RMAN commands can be used to back up target databases to <a href="glossary.htm#GUID-238433D1-4ED8-412E-978F-24197B953D94"><span class="xrefglossterm">Zero Data Loss Recovery Appliance (Recovery Appliance)</span></a>. Certain configuration steps are required to use the Recovery Appliance as a centralized repository for the target database backups.</p>
<p>To configure RMAN to create backups to Recovery Appliance:</p>
<ol>
<li>
<p>Ensure that the prerequisites described in <a href="rcmconfb.htm#GUID-0E1C6F92-651D-44D5-8501-726DBA71DA1E">Prerequisites for Using Recovery Appliance</a> are met.</p>
</li>
<li>
<p>Complete the steps listed in <a href="rcmconfb.htm#GUID-2215E132-8873-4F8A-A7F7-2952E6C4534B">Steps to Configure RMAN for Backups to Recovery Appliance</a>.</p>
</li>
</ol>
<div class="infoboxnotealso" id="GUID-6F28089E-6D4E-4D6B-B96E-043C35D029D5__GUID-563CF01C-655B-4131-9282-330E6F76E5D4">
<p class="notep1">See Also:</p>
<p><a class="olink AMPDB909" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=AMPDB909"><span class="italic">Zero Data Loss Recovery Appliance Protected Database Configuration Guide</span></a></p>
</div>
</div>
<a id="BRADV456"></a>
<div class="props_rev_3"><a id="GUID-0E1C6F92-651D-44D5-8501-726DBA71DA1E"></a>
<h3 id="BRADV-GUID-0E1C6F92-651D-44D5-8501-726DBA71DA1E" class="sect3">Prerequisites for Using Recovery Appliance</h3>
<div>
<p>Before you can use RMAN to back up a target database to Recovery Appliance, you must install the Recovery Appliance backup module in the Oracle home of the target database. The backup module can be installed in the default location or a user-specified location. Installing the Recovery Appliance backup module creates the shared library used to transfer backups to the Recovery Appliance and the Oracle wallet containing credentials used to authenticate the target database with Recovery Appliance.</p>
<div class="infoboxnotealso" id="GUID-0E1C6F92-651D-44D5-8501-726DBA71DA1E__GUID-35BA9C4E-C0A7-4A7B-847A-47CE164DE8FE">
<p class="notep1">See Also:</p>
<p><a class="olink AMPDB715" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=AMPDB715"><span class="italic">Zero Data Loss Recovery Appliance Protected Database Configuration Guide</span></a> for information about installing the Recovery Appliance backup module</p>
</div>
</div>
</div>
<a id="BRADV468"></a>
<div class="props_rev_3"><a id="GUID-2215E132-8873-4F8A-A7F7-2952E6C4534B"></a>
<h3 id="BRADV-GUID-2215E132-8873-4F8A-A7F7-2952E6C4534B" class="sect3">Steps to Configure RMAN for Backups to Recovery Appliance</h3>
<div>
<ol>
<li class="stepexpand"><span>Determine the location of the Recovery Appliance backup module as described in <span class="q">&#34;<a href="rcmconfb.htm#GUID-7E328C2A-9E45-42B7-9C0B-DC1A855A0C46">Determining the Location of the Recovery Appliance Backup Module</a>&#34;</span>.</span></li>
<li class="stepexpand"><span>Specify Recovery Appliance configuration parameters that must be used by RMAN to create backups to Recovery Appliance.</span>
<div>
<p>See <span class="q">&#34;<a href="rcmconfb.htm#GUID-9CC5C3DE-C972-4A3C-8AB7-1C1B7D9773AD">Specifying Recovery Appliance Configuration Settings for RMAN Backups</a>&#34;</span>.</p>
</div>
</li>
<li class="stepexpand"><span>Allocate one or more RMAN channels that will be used by RMAN to backup the database to Recovery Appliance.</span>
<div>
<p>You must specify the <code class="codeph">SBT_LIBRARY</code> and the <code class="codeph">ENV</code> parameters while using Recovery Appliance as shown in <a href="rcmconfb.htm#GUID-7E328C2A-9E45-42B7-9C0B-DC1A855A0C46__CHDECBDB">Example 5-8</a> and <a href="rcmconfb.htm#GUID-9CC5C3DE-C972-4A3C-8AB7-1C1B7D9773AD__CHDCJBCH">Example 5-9</a>. <code class="codeph">SBT_LIBRARY</code> provides the location of the Recovery Appliance backup module and <code class="codeph">ENV</code> provides the configuration parameters.</p>
<div class="infoboxnotealso" id="GUID-2215E132-8873-4F8A-A7F7-2952E6C4534B__GUID-9EA3486E-DBAD-4255-AC82-A946149EF1C5">
<p class="notep1">See Also:</p>
<p><a class="olink AMPDB" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=AMPDB"><span class="italic">Zero Data Loss Recovery Appliance Protected Database Configuration Guide</span></a></p>
</div>
<p>Instead of allocating RMAN channels, you can also configure an RMAN SBT channel that will be used to back up to Recovery Appliance. In this case, the channel configuration is persistent and the settings are applicable until they are reset (using <code class="codeph">CONFIGURE</code> command) or overridden for a particular operation using an <code class="codeph">ALLOCATE</code> statement.</p>
</div>
</li>
</ol>
</div>
</div>
<a id="BRADV479"></a><a id="BRADV478"></a>
<div class="props_rev_3"><a id="GUID-7E328C2A-9E45-42B7-9C0B-DC1A855A0C46"></a>
<h3 id="BRADV-GUID-7E328C2A-9E45-42B7-9C0B-DC1A855A0C46" class="sect3">Determining the Location of the Recovery Appliance Backup Module</h3>
<div>
<div class="section">
<p>Before using RMAN to back up target databases to Recovery Appliance, you need to determine the location of the Recovery Appliance backup module on the target database host. This location is used while configuring or allocating RMAN channels for Recovery Appliance. The <code class="codeph">SBT_LIBRARY</code> parameter in the <code class="codeph">CONFIGURE</code> or <code class="codeph">ALLOCATE</code> command specifies the location of the Recovery Appliance backup module. When RMAN attempts to back up to Recovery Appliance, it loads the shared library indicated by the <code class="codeph">SBT_LIBRARY</code> parameter.</p>
<p>You can specify an absolute path name or a file name for the <code class="codeph">SBT_LIBRARY</code> parameter. If you specify a file name, then RMAN searches for the file in an operating system-specific location. By default, the Recovery Appliance backup module is located in <code class="codeph">$ORACLE_HOME/lib/libra.so</code> on UNIX/Linux and in <code class="codeph">%ORACLE_HOME\database\lib\libra.sso</code> on Windows.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-7E328C2A-9E45-42B7-9C0B-DC1A855A0C46__CHDECBDB">
<p class="titleinexample">Example 5-8 Specifying the Recovery Appliance Backup Module Location During Channel Configuration</p>
<p>The following command configures an RMAN SBT channel by specifying the absolute path name of the Recovery Appliance backup module on Linux:</p>
<pre dir="ltr">CONFIGURE CHANNEL DEVICE TYPE sbt PARAMS &#39;SBT_LIBRARY=/u01/oracle/lib/libra.so&#39;;
</pre></div>
<!-- class="example" --></div>
</div>
<a id="BRADV483"></a><a id="BRADV481"></a>
<div class="props_rev_3"><a id="GUID-9CC5C3DE-C972-4A3C-8AB7-1C1B7D9773AD"></a>
<h3 id="BRADV-GUID-9CC5C3DE-C972-4A3C-8AB7-1C1B7D9773AD" class="sect3">Specifying Recovery Appliance Configuration Settings for RMAN Backups</h3>
<div>
<div class="section">
<p>The client configuration file, stored on the protected database, contains the configuration settings that are used by the Recovery Appliance backup module to communicate with the Recovery Appliance. This file is created automatically when the Recovery Appliance backup module is installed. It must contain the location of the Oracle wallet that stores credentials required to authenticate the target database with Recovery Appliance. Other optional settings may be included.</p>
<p>When using Recovery Appliance, you can include the client configuration settings in an RMAN command. Use the <code class="codeph">ENV</code> parameter of the RMAN <code class="codeph">CONFIGURE CHANNEL</code> or <code class="codeph">ALLOCATE CHANNEL</code> command to directly specify client configuration parameters for Recovery Appliance.</p>
<div class="infoboxnotealso" id="GUID-9CC5C3DE-C972-4A3C-8AB7-1C1B7D9773AD__GUID-5AE3F87A-6AEF-41F4-BC93-289F0B2655A4">
<p class="notep1">See Also:</p>
<p><a class="olink AMPDB" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=AMPDB"><span class="italic">Zero Data Loss Recovery Appliance Protected Database Configuration Guide</span></a></p>
</div>
</div>
<!-- class="section" -->
<div class="example" id="GUID-9CC5C3DE-C972-4A3C-8AB7-1C1B7D9773AD__CHDCJBCH">
<p class="titleinexample">Example 5-9 Specifying Recovery Appliance Client Configuration Settings</p>
<p>The following command specifies the Recovery Appliance client configuration settings directly as part of the <code class="codeph">CONFIGURE CHANNEL</code> command:</p>
<pre dir="ltr">CONFIGURE CHANNEL DEVICE TYPE &#39;SBT_TAPE&#39; PARAMS &#39;SBT_LIBRARY= libra.so, 
ENV=(BA_WALLET=location=file:/home/oracle/product/12.1.0/dbhome_1/wallet credential_alias=ra-scan:1521/zdlra5:dedicated)&#39;;
</pre>
<p>In this example, <code class="codeph">ra-scan</code> is the SCAN of the Recovery Appliance and <code class="codeph">zdlra5</code> is the service name of the Recovery Appliance metadata database.</p>
</div>
<!-- class="example" --></div>
</div>
</div>
<a id="BRADV8183"></a>
<div class="props_rev_3"><a id="GUID-302339EC-EE0F-45FB-9862-BB2BA138AA13"></a>
<h2 id="BRADV-GUID-302339EC-EE0F-45FB-9862-BB2BA138AA13" class="sect2">Configuring the Fast Recovery Area</h2>
<div>
<p>As explained in <span class="q">&#34;<a href="rcmarchi.htm#GUID-06A2CC19-9D45-4360-98D4-79FB32EE6153">About the Fast Recovery Area</a>&#34;</span>, the <a id="d21351e3933" class="indexterm-anchor"></a><a href="glossary.htm#GUID-6E3CDD76-A573-4E5C-B12D-59C232C96C19"><span class="xrefglossterm">fast recovery area</span></a> feature enables you to set up a disk area where the database can create and manage a variety of files related to backup and recovery. Use of the fast recovery area is strongly recommended. Consider configuring a fast recovery area as a first step in implementing a <a id="d21351e3941" class="indexterm-anchor"></a>backup strategy.</p>
<p>This section outlines the functions of the fast recovery area, identifies the files stored there, explains the rules for file management, and introduces the most important configuration options. This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfb.htm#GUID-061CCF1D-2C8D-4460-B469-9C32893A590A">Overview of Files in the Fast Recovery Area</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-233338E2-3EE6-4248-A2B6-16A7899DB14F">Enabling the Fast Recovery Area</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-A90518CA-CBCA-4B8F-AC98-373445371FD4">Disabling the Fast Recovery Area</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-B6AB2CA1-573D-40E0-906F-9A8F3FA5597E">Configuring Locations for Control Files and Redo Logs</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-AE300A8D-0485-436B-B9D2-D20F7D4B9EA5">Configuring RMAN File Creation in the Fast Recovery Area</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-302339EC-EE0F-45FB-9862-BB2BA138AA13__GUID-7FE96601-CF64-4723-AAAC-7BE2EC7C09FD">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmmaint.htm#GUID-A60E5493-8988-40E5-9E70-36AE6A0DFD69">Maintaining the Fast Recovery Area</a>&#34;</span></p>
</div>
</div>
<a id="BRADV173"></a><a id="BRADV89418"></a>
<div class="props_rev_3"><a id="GUID-061CCF1D-2C8D-4460-B469-9C32893A590A"></a>
<h3 id="BRADV-GUID-061CCF1D-2C8D-4460-B469-9C32893A590A" class="sect3">Overview of Files in the Fast Recovery Area</h3>
<div>
<p>The <a id="d21351e4051" class="indexterm-anchor"></a>fast recovery area can contain control files, online redo logs, archived redo logs, flashback logs, and RMAN backups. Files in the recovery area are <span class="italic">permanent</span> or t<span class="italic">ransient.</span> Permanent files are active files used by the database instance. All files that are not permanent are transient. In general, Oracle Database eventually deletes transient files after they become obsolete under the <a id="d21351e4062" class="indexterm-anchor"></a><a href="glossary.htm#GUID-ECF0ADBB-3255-43A2-A425-26850EA598EA"><span class="xrefglossterm">backup retention policy</span></a> or have been backed up to tape.</p>
<p>The fast recovery area is an Oracle Database managed space that can be used to hold RMAN disk backups, control file autobackups and archived redo log files. The files placed in this location are maintained by Oracle Database and the generated file names are maintained in Oracle Managed Files (OMF) format.</p>
<p><a href="rcmconfb.htm#GUID-061CCF1D-2C8D-4460-B469-9C32893A590A__CHDIJCHG" title="Describes the files in the flash recovery area, the classification of each file as permanent or temporary, and how database availability is affected if the flash recovery area is inaccessible.">Table 5-2</a> describes the files in the recovery area, the classification of each file as permanent or temporary, and how database availability is affected.</p>
<div class="tblformalwide" id="GUID-061CCF1D-2C8D-4460-B469-9C32893A590A__CHDIJCHG">
<p class="titleintable">Table 5-2 Files in the Fast Recovery Area</p>
<table class="cellalignment553" title="Files in the Fast Recovery Area" summary="Describes the files in the flash recovery area, the classification of each file as permanent or temporary, and how database availability is affected if the flash recovery area is inaccessible.">
<thead>
<tr class="cellalignment501">
<th class="cellalignment532" id="d21351e4087">Files</th>
<th class="cellalignment531" id="d21351e4090">Type</th>
<th class="cellalignment533" id="d21351e4093">Database Behavior When Fast Recovery Area Is Inaccessible</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment501">
<td class="cellalignment535" id="d21351e4098" headers="d21351e4087">
<p><a id="d21351e4100" class="indexterm-anchor"></a><a id="d21351e4104" class="indexterm-anchor"></a>Multiplexed copies of the current control file</p>
</td>
<td class="cellalignment534" headers="d21351e4098 d21351e4090">
<p>Permanent</p>
</td>
<td class="cellalignment536" headers="d21351e4098 d21351e4093">
<p>The instance fails if the database cannot write to a multiplexed copy of the control file stored in the fast recovery area. Failure occurs even if accessible multiplexed copies are located outside the recovery area.</p>
<p><span class="bold">See Also:</span> <span class="q">&#34;<a href="rcmconfb.htm#GUID-652242E6-F0DC-468D-8966-216472CE6136">Configuring Control File Locations</a>&#34;</span> to learn how to configure control files in the recovery area</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment535" id="d21351e4123" headers="d21351e4087">
<p>Online redo log files</p>
</td>
<td class="cellalignment534" headers="d21351e4123 d21351e4090">
<p>Permanent</p>
</td>
<td class="cellalignment536" headers="d21351e4123 d21351e4093">
<p>Instance availability is not affected if a mirrored copy of the online redo log exists in an accessible location outside the fast recovery area. Otherwise, the instance fails.</p>
<p><span class="bold">See Also:</span> <span class="q">&#34;<a href="rcmconfb.htm#GUID-F8A849BE-8276-4786-9B29-387E296B10DA">Configuring Online Redo Log Locations</a>&#34;</span> to learn how to configure online redo logs in the recovery area</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment535" id="d21351e4142" headers="d21351e4087">
<p>Archived redo log files</p>
</td>
<td class="cellalignment534" headers="d21351e4142 d21351e4090">
<p>Transient</p>
</td>
<td class="cellalignment536" headers="d21351e4142 d21351e4093">
<p>Instance availability is not affected if the log is archived to an accessible location outside the fast recovery area. Otherwise, the database eventually halts because it cannot archive the online redo logs.</p>
<p><span class="bold">See Also:</span> <span class="q">&#34;<a href="rcmconfb.htm#GUID-84988C3B-8F97-460A-8882-C26979F53836">Configuring Archived Redo Log Locations</a>&#34;</span> to learn how to configure archived redo logs in the recovery area</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment535" id="d21351e4161" headers="d21351e4087">
<p>Foreign archived redo log files</p>
</td>
<td class="cellalignment534" headers="d21351e4161 d21351e4090">
<p>Transient</p>
</td>
<td class="cellalignment536" headers="d21351e4161 d21351e4093">
<p>Instance availability is not affected.</p>
<p><span class="bold">Note:</span> Foreign archived redo logs are received by a logical standby database for a LogMiner session. Unlike a normal archived log, a <a href="glossary.htm#GUID-E2428029-4C01-4DFF-8C08-028EF57CF8C7"><span class="xrefglossterm">foreign archived redo log</span></a> is associated with a different DBID. For this reason, it cannot be backed up or restored on a logical standby database.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment535" id="d21351e4179" headers="d21351e4087">
<p>Image copies of data files and control files</p>
</td>
<td class="cellalignment534" headers="d21351e4179 d21351e4090">
<p>Transient</p>
</td>
<td class="cellalignment536" headers="d21351e4179 d21351e4093">
<p>Instance availability is not affected.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment535" id="d21351e4189" headers="d21351e4087">
<p>Backup pieces</p>
</td>
<td class="cellalignment534" headers="d21351e4189 d21351e4090">
<p>Transient</p>
</td>
<td class="cellalignment536" headers="d21351e4189 d21351e4093">
<p>Instance availability is not affected.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment535" id="d21351e4199" headers="d21351e4087">
<p>Flashback logs</p>
</td>
<td class="cellalignment534" headers="d21351e4199 d21351e4090">
<p>Transient</p>
</td>
<td class="cellalignment536" headers="d21351e4199 d21351e4093">
<p>Instance availability is not affected if guaranteed restore points are not defined. In this case, the database automatically disables Flashback Database, writes a message to the alert log, and continues with database processing. If guaranteed restore points are configured, the instance fails because of interdependencies on the flashback logs.</p>
<p>The <a href="glossary.htm#GUID-DD883C9B-0441-48D3-9DDC-755597782971"><span class="xrefglossterm">Oracle Flashback Database</span></a> feature, which provides a convenient alternative to <a href="glossary.htm#GUID-FCC8BB91-79B6-4AF1-974A-43E75CD161E3"><span class="xrefglossterm">database point-in-time recovery (DBPITR)</span></a>, generates <a href="glossary.htm#GUID-725ED3D7-5077-4F16-85AA-CDAD5BFCE554"><span class="xrefglossterm">flashback logs</span></a>. These logs are transient files and must be stored in the fast recovery area. Unlike other transient files, flashback logs cannot be backed up to other media. If the fast recovery area has insufficient space to store flashback logs and meet other backup retention requirements, then the recovery area may delete flashback logs.</p>
<p><span class="bold">See Also:</span> <span class="q">&#34;<a href="flashdb.htm#GUID-FC98B2D7-9F18-4A62-BE4A-E97A0AA10BF4">Enabling Flashback Database</a>&#34;</span> to learn how to enable flashback logging</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>If you are on a Windows platform, then you can use the <a id="d21351e4233" class="indexterm-anchor"></a><a href="glossary.htm#GUID-105781E5-32FB-4702-9248-9041B0EFBED4"><span class="xrefglossterm">Volume Shadow Copy Service (VSS)</span></a> with the <a id="d21351e4239" class="indexterm-anchor"></a><a href="glossary.htm#GUID-CB860FA8-E039-4EC5-BAAC-F59091EA8F18"><span class="xrefglossterm">Oracle VSS writer</span></a>. In this case, the fast recovery area automates management of files that are backed up in a VSS snapshot and deletes them as needed.</p>
<div class="infoboxnotealso" id="GUID-061CCF1D-2C8D-4460-B469-9C32893A590A__GUID-A6EDB752-79F6-4F44-AE93-87DA5B784531">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmflash.htm#GUID-5463669A-DC89-4FF4-ACCE-136A72DF687B">Performing Flashback and Database Point-in-Time Recovery</a></p>
</li>
<li>
<p><a class="olink NTQRF" target="_blank" href="../NTQRF/toc.htm"><span class="italic">Oracle Database Platform Guide for Microsoft Windows</span></a> to learn about making backups in a VSS environment</p>
</li>
</ul>
</div>
</div>
<a id="BRADV89419"></a>
<div class="props_rev_3"><a id="GUID-5713C139-8CD8-4CC8-BFFB-81213EC0F8E1"></a>
<h4 id="BRADV-GUID-5713C139-8CD8-4CC8-BFFB-81213EC0F8E1" class="sect4">Fast Recovery Area with Oracle Managed Files and Automatic Storage Management</h4>
<div>
<p>The <a id="d21351e4329" class="indexterm-anchor"></a><a id="d21351e4333" class="indexterm-anchor"></a>fast recovery area can be used with <a href="glossary.htm#GUID-0D4135A3-3812-4D16-9560-0068BB6C6976"><span class="xrefglossterm">Oracle Managed Files (OMF)</span></a> and <a href="glossary.htm#GUID-94080845-3FF3-4FB4-91EB-AEA1749411DC"><span class="xrefglossterm">Automatic Storage Management (ASM)</span></a>. Because the fast recovery area is built on top of OMF, it can be stored anywhere that Oracle Managed Files can. You can also use the recovery area with ASM.</p>
<p>Even if you choose not to set up the fast recovery area in ASM storage, you can still use Oracle Managed Files to manage your backup files in an ASM disk group. However, you lose a major benefit of the fast recovery area: the automatic deletion of files no longer needed to meet your recoverability goals as space is needed for more recent backups. Nevertheless, the other automatic features of OMF still function.</p>
<p>When your store backups, using OMF on top of ASM without using a fast recovery area is supported but discouraged. It is awkward to directly manipulate files under ASM.</p>
</div>
</div>
<a id="BRADV89420"></a>
<div class="props_rev_3"><a id="GUID-0454CE22-F2A1-4053-8DC6-AC1714814352"></a>
<h4 id="BRADV-GUID-0454CE22-F2A1-4053-8DC6-AC1714814352" class="sect4">How Oracle Manages Disk Space in the Fast Recovery Area</h4>
<div>
<p><a id="d21351e4419" class="indexterm-anchor"></a>Space in the fast recovery area is balanced among backups and archived logs that must be kept according to the retention policy, and other files that may be subject to deletion. Oracle Database does not delete eligible files from the fast recovery area until the space must be reclaimed for some other purpose. Files recently moved to tape are often still available on disk for use in recovery. The recovery area can thus serve as a cache for tape. When the fast recovery area is full, Oracle Database automatically deletes eligible files to reclaim space in the recovery area as needed.</p>
<div class="infoboxnotealso" id="GUID-0454CE22-F2A1-4053-8DC6-AC1714814352__GUID-DCA9EA14-81E1-4A6F-A732-5CF7B5B9D14D">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmmaint.htm#GUID-2D7B9EF4-C306-4377-82F2-DDE3549FB63C">Deletion Rules for the Fast Recovery Area</a>&#34;</span> and <span class="q">&#34;<a href="rcmmaint.htm#GUID-3F11ECB5-1321-45F5-A557-BB1A5BAF011F">Responding to a Full Fast Recovery Area</a>&#34;</span></p>
</div>
</div>
</div>
</div>
<a id="BRADV572"></a><a id="BRADV89425"></a>
<div class="props_rev_3"><a id="GUID-233338E2-3EE6-4248-A2B6-16A7899DB14F"></a>
<h3 id="BRADV-GUID-233338E2-3EE6-4248-A2B6-16A7899DB14F" class="sect3">Enabling the Fast Recovery Area</h3>
<div>
<div class="section">
<p>You enable the fast recovery area by setting two initialization parameters. These parameters enable the fast recovery area with or without having to shut down and restart the database instance.</p>
<p>You set the size of the fast recovery area with the parameter <code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code> first, and then you set the physical location of the flash recovery files with the parameter <code class="codeph">DB_RECOVERY_FILE_DEST</code>.</p>
<p><a href="rcmconfb.htm#GUID-233338E2-3EE6-4248-A2B6-16A7899DB14F__CHDDJJHE" title="This table describes the DB_RECOVERY_FILE_DEST_SIZE and DB_RECOVERY_FILE_DEST parameters.">Table 5-3</a> discusses both the mandatory and optional parameters for enabling the fast recovery area.</p>
<p>In an Oracle Real Application Clusters (Oracle RAC) database, all instances must have the same values for these initialization parameters. The location must be on a cluster file system, ASM, or a shared directory.</p>
<div class="tblformalwide" id="GUID-233338E2-3EE6-4248-A2B6-16A7899DB14F__CHDDJJHE">
<p class="titleintable">Table 5-3 Initialization Parameters for the Fast Recovery Area</p>
<table class="cellalignment553" title="Initialization Parameters for the Fast Recovery Area" summary="This table describes the DB_RECOVERY_FILE_DEST_SIZE and DB_RECOVERY_FILE_DEST parameters.">
<thead>
<tr class="cellalignment501">
<th class="cellalignment516" id="d21351e4540">Initialization Parameter</th>
<th class="cellalignment554" id="d21351e4543">Required</th>
<th class="cellalignment555" id="d21351e4546">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment501">
<td class="cellalignment518" id="d21351e4551" headers="d21351e4540">
<p><a class="olink REFRN10235" target="_blank" href="../REFRN/GUID-FA2F9735-DD0E-4026-96F0-80AF0E5E6E64.htm#REFRN10235"><code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code></a></p>
</td>
<td class="cellalignment556" headers="d21351e4551 d21351e4543">
<p>Yes</p>
</td>
<td class="cellalignment557" headers="d21351e4551 d21351e4546">
<p>Specifies the <a href="glossary.htm#GUID-925AC655-2953-4F1F-9E5A-F8EA6D9DA552"><span class="xrefglossterm">disk quota</span></a>, which is maximum storage in bytes of data to be used by the recovery area for this database. You must set this parameter <span class="italic">before</span> <code class="codeph">DB_RECOVERY_FILE_DEST</code>.</p>
<p>The <code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code> setting does not include the following kinds of disk overhead:</p>
<ul style="list-style-type: disc;">
<li>
<p>Block 0 or the operating system block header of each Oracle Database file is not included.</p>
<p>Allow an extra 10% for this data when computing the actual disk usage required for the fast recovery area.</p>
</li>
<li>
<p><code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code> does not indicate the real size occupied on disk when the underlying file system is mirrored, compressed, or affected by overhead not known to Oracle Database.</p>
<p>For example, if the recovery area is on a two-way mirrored ASM disk group, each file of <span class="italic">x</span> bytes occupies 2<span class="italic">x</span> bytes on the ASM disk group. In this case, set <code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code> to no more than half the size of the disks for the ASM disk group. Likewise, when using a three-way mirrored ASM disk group, <code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code> must be no more than one third the size of the disks in the disk group, and so on.</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment518" id="d21351e4606" headers="d21351e4540">
<p><a class="olink REFRN10234" target="_blank" href="../REFRN/GUID-A137E048-DFBA-49D8-97F2-3A657F4FD84C.htm#REFRN10234"><code class="codeph">DB_RECOVERY_FILE_DEST</code></a></p>
</td>
<td class="cellalignment556" headers="d21351e4606 d21351e4543">
<p>Yes</p>
</td>
<td class="cellalignment557" headers="d21351e4606 d21351e4546">
<p>Specifies the recovery area location, which can be a file system directory or ASM disk group, but not a raw disk. The location must be large enough for the disk quota.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment518" id="d21351e4620" headers="d21351e4540">
<p><a class="olink REFRN10233" target="_blank" href="../REFRN/GUID-33F44036-F1BB-4CBF-8AF3-486415E58F2B.htm#REFRN10233"><code class="codeph">DB_FLASHBACK_RETENTION_TARGET</code></a></p>
</td>
<td class="cellalignment556" headers="d21351e4620 d21351e4543">
<p>No</p>
</td>
<td class="cellalignment557" headers="d21351e4620 d21351e4546">
<p>Specifies the upper limit (in minutes) on how far back in time the database may be flashed back. This parameter is required only for Flashback Database.</p>
<p>This parameter indirectly determines how much flashback log data is kept in the recovery area. The size of flashback logs generated by the database can vary considerably depending on the database workload. If more blocks are affected by database updates during a given interval, then more disk space is used by the flashback log data generated for that interval.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="infoboxnotealso" id="GUID-233338E2-3EE6-4248-A2B6-16A7899DB14F__GUID-13EC7E8A-AB4C-46A3-B85C-89C94E6066C7">
<p class="notep1">See Also:</p>
<p><a class="olink SQLRF00902" target="_blank" href="../SQLRF/statements_2017.htm#SQLRF00902"><span class="italic">Oracle Database SQL Language Reference</span></a> for <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> syntax, and <a class="olink ADMIN002" target="_blank" href="../ADMIN/create.htm#ADMIN002"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for details on setting and changing database initialization parameters</p>
</div>
</div>
<!-- class="section" --></div>
<a id="BRADV89422"></a>
<div class="props_rev_3"><a id="GUID-F8BFD7F3-345D-4A9E-9596-86AEAB29507D"></a>
<h4 id="BRADV-GUID-F8BFD7F3-345D-4A9E-9596-86AEAB29507D" class="sect4">Considerations When Setting the Size of the Fast Recovery Area</h4>
<div>
<p><a id="d21351e4723" class="indexterm-anchor"></a>The larger the fast recovery area is, the more useful it becomes. Ideally, the fast recovery area is large enough to contain the files listed in <a href="rcmconfb.htm#GUID-061CCF1D-2C8D-4460-B469-9C32893A590A__CHDIJCHG" title="Describes the files in the flash recovery area, the classification of each file as permanent or temporary, and how database availability is affected if the flash recovery area is inaccessible.">Table 5-2</a>. The recovery area should be able to contain a copy of all data files in the database and the incremental backups used by your chosen backup strategy.</p>
<p>If providing this much space is impractical, then it is best to create an area large enough to keep a backup of the most important tablespaces and all the archived logs not yet on tape. At an absolute minimum, the fast recovery area must be large enough to contain the archived redo logs not yet on tape. If the recovery area has insufficient space to store new flashback logs and meet other backup retention requirements, then to make room, the recovery area may delete older flashback logs.</p>
<p>Formulas for estimating a useful fast recovery area size depend on whether:</p>
<ul style="list-style-type: disc;">
<li>
<p>Your database has a small or large number of data blocks that change frequently</p>
</li>
<li>
<p>You store backups only on disk, or on disk and tape</p>
</li>
<li>
<p>You use a redundancy-based <a href="glossary.htm#GUID-ECF0ADBB-3255-43A2-A425-26850EA598EA"><span class="xrefglossterm">backup retention policy</span></a>, or a recovery window-based retention policy</p>
</li>
<li>
<p>You plan to use Flashback Database or a <a id="d21351e4754" class="indexterm-anchor"></a><a href="glossary.htm#GUID-CC1A7D5D-50B6-4F90-89DE-855B21C299F2"><span class="xrefglossterm">guaranteed restore point</span></a> as alternatives to <a href="glossary.htm#GUID-491BEF3A-18F0-4670-B078-2D84765141E8"><span class="xrefglossterm">point-in-time recovery</span></a> in response to logical errors</p>
</li>
</ul>
<p>If you plan to enable flashback logging, then the volume of flashback log generation is approximately the same order of magnitude as redo log generation. For example, if you intend to set <a id="d21351e4766" class="indexterm-anchor"></a><code class="codeph">DB_FLASHBACK_RETENTION_TARGET</code> to 24 hours, and if the database generates 20 gigabytes of redo in a day, then a general rule of thumb is to allow 20 GB to 30 GB of disk space for the flashback logs. The same rule applies to guaranteed restore points when flashback logging is enabled. For example, if the database generates 20 GB of redo every day, and if the guaranteed restore point is kept for a day, then plan to allocate 20 to 30 GB.</p>
<p>Suppose that you want to determine the size of a fast recovery area when the backup retention policy is set to <code class="codeph">REDUNDANCY 1</code> and you intend to follow Oracle&#39;s suggested strategy of using an <a href="glossary.htm#GUID-F879F805-CAD5-4798-B9C1-A9C877D4FBC8"><span class="xrefglossterm">incremental forever</span></a>. In this example, you use the following formula to estimate the disk quota, where <span class="italic">n</span> is the interval in days between incremental updates and <span class="italic">y</span> is the delay in applying the foreign archived redo logs on a logical standby database:</p>
<pre dir="ltr">Disk Quota =
Size of a copy of database +
Size of an incremental backup +
Size of (n+1) days of archived redo logs +
Size of (y+1) days of foreign archived redo logs (for logical standby) +
Size of control file +
Size of an online redo log member * number of log groups +
Size of flashback logs (based on DB_FLASHBACK_RETENTION_TARGET value)
</pre></div>
</div>
<a id="BRADV90060"></a>
<div class="props_rev_3"><a id="GUID-ED4F069D-EFEB-4739-97C4-1C80326AB223"></a>
<h4 id="BRADV-GUID-ED4F069D-EFEB-4739-97C4-1C80326AB223" class="sect4">Considerations When Setting the Location of the Fast Recovery Area</h4>
<div>
<p><a id="d21351e4857" class="indexterm-anchor"></a>Place the fast recovery area on a separate disk from the <a href="glossary.htm#GUID-B2954743-3455-4045-9200-891927E38048"><span class="xrefglossterm">database area</span></a>, where the database maintains active database files such as data files, control files, and online redo logs. Keeping the fast recovery area on the same disk as the database area exposes you to loss of both your live database files and backups if a media failure occurs.</p>
<p>Oracle recommends that <code class="codeph">DB_RECOVERY_FILE_DEST</code> be set to a different value from <code class="codeph">DB_CREATE_FILE_DEST</code> or any of the <code class="codeph">DB_CREATE_ONLINE_LOG_DEST_</code><span class="italic"><code class="codeph">n</code></span> initialization parameters. The database writes a warning to the alert log if <code class="codeph">DB_RECOVERY_FILE_DEST</code> equals these parameters.</p>
<p>Multiple databases can have the same value for <code class="codeph">DB_RECOVERY_FILE_DEST</code>, but one of the following must be true:</p>
<ul style="list-style-type: disc;">
<li>
<p>No two databases for which the <a class="olink REFRN10242" target="_blank" href="../REFRN/GUID-3547C937-5DDA-49FF-A9F9-14FF306545D8.htm#REFRN10242"><code class="codeph">DB_UNIQUE_NAME</code></a> initialization parameters are specified have the same value for <code class="codeph">DB_UNIQUE_NAME</code>.</p>
</li>
<li>
<p>For those databases where no <code class="codeph">DB_UNIQUE_NAME</code> is provided, no two databases have the same value for <a class="olink REFRN10041" target="_blank" href="../REFRN/GUID-D8A5CD6B-2C72-47EF-B7D8-A6FC69934314.htm#REFRN10041"><code class="codeph">DB_NAME</code></a>.</p>
</li>
</ul>
<p>When databases share a single recovery area in this way, the location should be large enough to hold the files for all databases. Add the values for <code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code> for the databases, then allow for overhead such as mirroring or compression.</p>
</div>
</div>
<a id="BRADV573"></a><a id="BRADV89424"></a>
<div class="props_rev_3"><a id="GUID-CD308CD0-2230-4F2A-8ADB-E2401010AED9"></a>
<h4 id="BRADV-GUID-CD308CD0-2230-4F2A-8ADB-E2401010AED9" class="sect4">Setting the Fast Recovery Area Location and Initial Size</h4>
<div>
<div class="section">
<p><a href="rcmconfb.htm#GUID-233338E2-3EE6-4248-A2B6-16A7899DB14F__CHDDJJHE" title="This table describes the DB_RECOVERY_FILE_DEST_SIZE and DB_RECOVERY_FILE_DEST parameters.">Table 5-3</a> lists the initialization parameters that you must set to enable the fast recovery area. This section explains how to specify a location for the recovery area and set its initial size.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To determine the optimum size for the fast recovery area:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand" id="GUID-CD308CD0-2230-4F2A-8ADB-E2401010AED9__CHDJBFCA"><span>If you plan to use flashback logging or guaranteed restore points, then <a id="d21351e5000" class="indexterm-anchor"></a>query <code class="codeph">V$ARCHIVED_LOG</code> to determine how much redo the database generates in the time to which you intend to set <code class="codeph">DB_FLASHBACK_RETENTION_TARGET</code>.</span></li>
<li class="stepexpand"><span>Set the recovery area size.</span>
<div>
<p>If you plan to use flashback logging or guaranteed restore points, then ensure that the size value obtained from Step <a href="rcmconfb.htm#GUID-CD308CD0-2230-4F2A-8ADB-E2401010AED9__CHDJBFCA">1</a> is incorporated into the setting. Set the <code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code> initialization parameter by any of the following means:</p>
<ul style="list-style-type: disc;">
<li>
<p>Shut down the database and set the <code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code> parameter in the initialization parameter file of the database, as shown in the following example:</p>
<pre dir="ltr">DB_RECOVERY_FILE_DEST_SIZE = 10G
</pre></li>
<li>
<p>Specify the parameter with the SQL statement <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> <code class="codeph">SET</code> when the database is open, as shown in the following examples:</p>
<pre dir="ltr">ALTER SYSTEM SET 
  DB_RECOVERY_FILE_DEST_SIZE = 10G 
  SCOPE=BOTH SID=&#39;*&#39;;
</pre>
<div class="infobox-note" id="GUID-CD308CD0-2230-4F2A-8ADB-E2401010AED9__GUID-3AA22A42-23DF-4C20-B730-DA72EE78825D">
<p class="notep1">Note:</p>
<p>The <code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code> and <code class="codeph">DB_RECOVERY_FILE_DEST</code> settings must be persistent across database startup and shutdown. If a server parameter file is used, then setting <code class="codeph">SCOPE=BOTH</code> results in the settings being persistent. However, if a server parameter file is not used, then the changes made by the <code class="codeph">ALTER SYSTEM</code> command are not persistent. You must also add these parameters to the initialization parameter file.</p>
</div>
</li>
<li>
<p>Use the Database Configuration Assistant to set the size.</p>
</li>
</ul>
</div>
</li>
<li class="stepexpand"><span>Set the recovery area location.</span>
<div>
<p>Set the initialization parameters by any of the following means:</p>
<ul style="list-style-type: disc;">
<li>
<p>Set <code class="codeph">DB_RECOVERY_FILE_DEST</code> in the parameter file of the database, as shown in the following example:</p>
<pre dir="ltr">DB_RECOVERY_FILE_DEST = &#39;/u01/oradata/rcv_area&#39;
</pre></li>
<li>
<p>Specify <code class="codeph">DB_RECOVERY_FILE_DEST</code> with the SQL statement <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> <code class="codeph">SET</code> when the database is open.</p>
<p>The following example sets the fast recovery area to an Automatic Storage Management (ASM) disk group named <code class="codeph">disk1</code>:</p>
<pre dir="ltr">ALTER SYSTEM SET
  DB_RECOVERY_FILE_DEST = &#39;+disk1&#39; 
  SCOPE=BOTH SID=&#39;*&#39;;
</pre>
<p>The following example sets the fast recovery area to the file system directory <code class="codeph">/disk1/fast_recovery_area</code>:</p>
<pre dir="ltr">ALTER SYSTEM SET 
  DB_RECOVERY_FILE_DEST = &#39;/disk1/fast_recovery_area&#39;
  SCOPE = BOTH SID = &#39;*&#39;;
</pre></li>
<li>
<p>Use the Database Configuration Assistant to set the location.</p>
</li>
</ul>
<p>If you do <span class="italic">not</span> plan to use flashback logging, then open the database (if it is closed) and do not complete the rest of the steps in this procedure.</p>
</div>
</li>
<li class="stepexpand"><span>If flashback logging is enabled, then run the database under a normal workload for the time period specified by <code class="codeph">DB_FLASHBACK_RETENTION_TARGET</code>.</span>
<div>
<p>In this way, the database can generate a representative sample of flashback logs.</p>
</div>
</li>
<li class="stepexpand"><span><a id="d21351e5126" class="indexterm-anchor"></a>Query <a id="d21351e5133" class="indexterm-anchor"></a>the <a class="olink REFRN30300" target="_blank" href="../REFRN/GUID-4DFB54C5-271D-41D9-AEE5-7389BB219544.htm#REFRN30300"><code class="codeph">V$FLASHBACK_DATABASE_LOG</code></a> view as follows:</span>
<div>
<pre dir="ltr">SELECT ESTIMATED_FLASHBACK_SIZE 
FROM   V$FLASHBACK_DATABASE_LOG;
</pre>
<p>The result is an estimate of the disk space needed to meet the current flashback retention target, based on the database workload since Flashback Database was enabled.</p>
</div>
</li>
<li class="stepexpand"><span>If necessary, adjust the flashback log space requirement based on the actual size of flashback logs generated during the time period specified by <code class="codeph">DB_FLASHBACK_RETENTION_TARGET</code>.</span></li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-CD308CD0-2230-4F2A-8ADB-E2401010AED9__GUID-9C15DCEE-436A-48BA-9319-A2180BA39871">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmmaint.htm#GUID-26C1A1E8-5555-4399-9DD1-39BA90E45A0C">Managing Space for Flashback Logs in the Fast Recovery Area</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="BRADV528"></a>
<div class="props_rev_3"><a id="GUID-A90518CA-CBCA-4B8F-AC98-373445371FD4"></a>
<h3 id="BRADV-GUID-A90518CA-CBCA-4B8F-AC98-373445371FD4" class="sect3">Disabling the Fast Recovery Area</h3>
<div>
<div class="section">
<p>If you have enabled Flashback Database or use the fast recovery area for archive logs, then take the appropriate steps from those that follow below. Otherwise, skip to Step 3:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>If Flashback Database is enabled, then disable it before you disable the fast recovery area.</span>
<div>
<pre dir="ltr">ALTER DATABASE FLASHBACK OFF;
</pre></div>
</li>
<li class="stepexpand"><span>If you are using the fast recovery area for archive logs, then set the initialization parameter <code class="codeph">LOG_ARCHIVE_DEST_</code><span class="italic">n</span> to use a non-fast recovery area location.</span>
<div>
<p>For example, to change the fast recovery area for <code class="codeph">LOG_ARCHIVE_DEST_1</code> to a non-fast recovery area location, use the command <code class="codeph">ALTER SYSTEM SET</code>:</p>
<pre dir="ltr">LOG_ARCHIVE_DEST_1=&#39;LOCATION=USE_DB_RECOVERY_FILE_DEST&#39;
</pre>
<pre dir="ltr">ALTER SYSTEM SET LOG_ARCHIVE_DEST_1=&#39;LOCATION=/ORACLE/DBS/&#39;;
</pre></div>
</li>
<li class="stepexpand"><span>Disable the fast recovery area initialization parameter.</span>
<div>
<pre dir="ltr">ALTER SYSTEM SET DB_RECOVERY_FILE_DEST=&#39;&#39;; 
</pre></div>
</li>
</ol>
</div>
</div>
<a id="BRADV89428"></a>
<div class="props_rev_3"><a id="GUID-B6AB2CA1-573D-40E0-906F-9A8F3FA5597E"></a>
<h3 id="BRADV-GUID-B6AB2CA1-573D-40E0-906F-9A8F3FA5597E" class="sect3">Configuring Locations for Control Files and Redo Logs</h3>
<div>
<p>As explained in <span class="q">&#34;<a href="rcmconfb.htm#GUID-061CCF1D-2C8D-4460-B469-9C32893A590A">Overview of Files in the Fast Recovery Area</a>&#34;</span>, the only permanent files are <a id="d21351e5340" class="indexterm-anchor"></a><a id="d21351e5344" class="indexterm-anchor"></a>multiplexed copies of the current <a id="d21351e5347" class="indexterm-anchor"></a>control file and <a id="d21351e5352" class="indexterm-anchor"></a>online redo logs.</p>
<p>The following sections explain how to set locations for control files and the redo logs:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfb.htm#GUID-F8A849BE-8276-4786-9B29-387E296B10DA">Configuring Online Redo Log Locations</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-652242E6-F0DC-468D-8966-216472CE6136">Configuring Control File Locations</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-84988C3B-8F97-460A-8882-C26979F53836">Configuring Archived Redo Log Locations</a></p>
</li>
</ul>
</div>
<a id="BRADV89429"></a>
<div class="props_rev_3"><a id="GUID-F8A849BE-8276-4786-9B29-387E296B10DA"></a>
<h4 id="BRADV-GUID-F8A849BE-8276-4786-9B29-387E296B10DA" class="sect4">Configuring Online Redo Log Locations</h4>
<div>
<div class="section">
<p>The initialization parameters that determine where online redo log files are created are <code class="codeph">DB_CREATE_ONLINE_LOG_DEST_</code><span class="italic"><code class="codeph">n</code></span>, <code class="codeph">DB_RECOVERY_FILE_DEST</code>, and <code class="codeph">DB_CREATE_FILE_DEST</code>. Details of the effect of combinations of these parameters on online redo log creation can be found in <a class="olink SQLRF01204" target="_blank" href="../SQLRF/statements_5005.htm#SQLRF01204"><span class="italic">Oracle Database SQL Language Reference</span></a> in the description of the <code class="codeph">LOGFILE</code> clause of the <code class="codeph">CREATE</code> <code class="codeph">DATABASE</code> statement.</p>
<p>The following SQL statements can create online redo logs in the fast recovery area:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><a class="olink SQLRF01204" target="_blank" href="../SQLRF/statements_5005.htm#SQLRF01204"><code class="codeph">CREATE DATABASE</code></a></p>
</li>
<li>
<p><a class="olink SQLRF00802" target="_blank" href="../SQLRF/statements_1006.htm#SQLRF00802"><code class="codeph">ALTER DATABASE ADD LOGFILE</code></a></p>
</li>
<li>
<p><a class="olink SQLRF00802" target="_blank" href="../SQLRF/statements_1006.htm#SQLRF00802"><code class="codeph">ALTER DATABASE ADD STANDBY LOGFILE</code></a></p>
</li>
<li>
<p><a class="olink SQLRF00802" target="_blank" href="../SQLRF/statements_1006.htm#SQLRF00802"><code class="codeph">ALTER DATABASE OPEN RESETLOGS</code></a></p>
</li>
</ul>
<p>The default size of an online log created in the fast recovery area is 100 megabytes. The log member file names are automatically generated by the database.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV89430"></a>
<div class="props_rev_3"><a id="GUID-652242E6-F0DC-468D-8966-216472CE6136"></a>
<h4 id="BRADV-GUID-652242E6-F0DC-468D-8966-216472CE6136" class="sect4">Configuring Control File Locations</h4>
<div>
<div class="section">
<p>The initialization parameters <code class="codeph">CONTROL_FILES</code>, <code class="codeph">DB_CREATE_ONLINE_LOG_DEST_</code><span class="italic"><code class="codeph">n</code></span>, <code class="codeph">DB_RECOVERY_FILE_DEST</code>, and <code class="codeph">DB_CREATE_FILE_DEST</code> all interact to determine the location where the database control files are created. For a full description of how these parameters interact, see the &#34;Semantics&#34; section of the description of <code class="codeph">CREATE CONTROLFILE</code> in <a class="olink SQLRF01203" target="_blank" href="../SQLRF/statements_5004.htm#SQLRF01203"><span class="italic">Oracle Database SQL Language Reference.</span></a></p>
<p>If the database creates an Oracle managed control file, and if the database uses a server parameter file, then the database sets the <code class="codeph">CONTROL_FILES</code> initialization parameter in the server parameter file. If the database uses a client-side initialization parameter file, then you must set the <code class="codeph">CONTROL_FILES</code> initialization parameter manually in the initialization parameter file.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV89431"></a>
<div class="props_rev_3"><a id="GUID-84988C3B-8F97-460A-8882-C26979F53836"></a>
<h4 id="BRADV-GUID-84988C3B-8F97-460A-8882-C26979F53836" class="sect4">Configuring Archived Redo Log Locations</h4>
<div>
<div class="section">
<p>Oracle recommends that you the use fast recovery area as an archiving location because the archived logs are automatically managed by the database. The generated file names for the archived logs in the fast recovery area are for Oracle-managed files and are not determined by the parameter <code class="codeph">LOG_ARCHIVE_FORMAT</code>. Whatever archiving scheme you choose, it is always advisable to create multiple copies of archived redo logs.</p>
<p>You have the following basic options for archiving redo logs, listed from most to least recommended:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Enable archiving to the fast recovery area <span class="italic">only</span> and use disk mirroring to create the redundancy needed to protect the archived redo logs.</span>
<div>
<p>If <code class="codeph">DB_RECOVERY_FILE_DEST</code> is specified and <a id="d21351e5695" class="indexterm-anchor"></a>no <code class="codeph">LOG_ARCHIVE_DEST_</code><span class="italic"><code class="codeph">n</code></span> is specified, then <code class="codeph">LOG_ARCHIVE_DEST_10</code> is implicitly set to the recovery area. You can override this behavior by setting <code class="codeph">LOG_ARCHIVE_DEST_10</code> to an empty string.</p>
</div>
</li>
<li class="stepexpand"><span>Enable archiving to the fast recovery area and set other <code class="codeph">LOG_ARCHIVE_DEST_</code><span class="italic"><code class="codeph">n</code></span> initialization parameter to locations outside the fast recovery area.</span>
<div>
<p>If a fast recovery area is configured, then you can add the fast recovery area as an archiving destination by setting any <code class="codeph">LOG_ARCHIVE_DEST_</code><span class="italic"><code class="codeph">n</code></span> parameter to <code class="codeph">LOCATION=USE_DB_RECOVERY_FILE_DEST</code>.</p>
</div>
</li>
<li class="stepexpand"><span>Set <code class="codeph">LOG_ARCHIVE_DEST_</code><span class="italic"><code class="codeph">n</code></span> initialization parameters to archive <span class="italic">only</span> to non-fast recovery area locations.</span></li>
</ol>
<div class="section">
<p>If you use the fast recovery area, then you cannot use the <code class="codeph">LOG_ARCHIVE_DEST</code> and <code class="codeph">LOG_ARCHIVE_DUPLEX_DEST</code> initialization parameters. Using either of these parameters prevents you from starting the instance. Instead, set the <code class="codeph">LOG_ARCHIVE_DEST_</code><span class="italic"><code class="codeph">n</code></span> parameters. After your database is using <code class="codeph">LOG_ARCHIVE_DEST_</code><span class="italic"><code class="codeph">n</code></span>, you can configure a recovery area.</p>
<p>Note also that if you enable archiving but do not set any value for <code class="codeph">LOG_ARCHIVE_DEST</code>, <code class="codeph">LOG_ARCHIVE_DEST_</code><span class="italic"><code class="codeph">n</code></span>, or <code class="codeph">DB_RECOVERY_FILE_DEST</code>, then the redo logs are archived to a default location that is platform-specific. For example, on Solaris the default is <code class="codeph">?/dbs</code>.</p>
<div class="infoboxnotealso" id="GUID-84988C3B-8F97-460A-8882-C26979F53836__GUID-C221286C-8693-4A94-B359-4C62D1768359">
<p class="notep1">See Also:</p>
<p><a class="olink REFRN10086" target="_blank" href="../REFRN/GUID-10BD97BF-6295-4E85-A1A3-854E15E05A44.htm#REFRN10086"><span class="italic">Oracle Database Reference</span></a> for details on the semantics of the <code class="codeph">LOG_ARCHIVE_DEST_</code><span class="italic"><code class="codeph">n</code></span> parameters</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="BRADV89432"></a>
<div class="props_rev_3"><a id="GUID-AE300A8D-0485-436B-B9D2-D20F7D4B9EA5"></a>
<h3 id="BRADV-GUID-AE300A8D-0485-436B-B9D2-D20F7D4B9EA5" class="sect3">Configuring RMAN File Creation in the Fast Recovery Area</h3>
<div>
<p><a id="d21351e5863" class="indexterm-anchor"></a>Certain RMAN commands or implicit actions (such as control file autobackups) can create files in the fast recovery area. This section explains how to control whether a command creates files in the fast recovery area or in another destination. The commands are:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><code class="codeph">BACKUP</code></a></p>
<p><a id="d21351e5876" class="indexterm-anchor"></a><a id="d21351e5880" class="indexterm-anchor"></a><a id="d21351e5884" class="indexterm-anchor"></a>If you do not specify the <a class="olink RCMRF195" target="_blank" href="../RCMRF/rcmsubcl012.htm#RCMRF195"><code class="codeph">FORMAT</code></a> clause for disk backups, then RMAN creates backup pieces and image copies in the fast recovery area, with names in Oracle Managed Files (OMF) format. If a fast recovery area is enabled, and if you <span class="italic">do</span> specify <code class="codeph">FORMAT</code> on <code class="codeph">BACKUP</code> or a channel, then RMAN creates the backup in a platform-specific location rather than in the recovery area.</p>
</li>
<li>
<p>Control File Autobackup</p>
<p>RMAN can create control file autobackups in the fast recovery area. Use the RMAN command <a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><code class="codeph">CONFIGURE</code></a> <code class="codeph">CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK CLEAR</code> to clear any configured format option for the control file autobackup location on disk. RMAN creates control file autobackups in the fast recovery area when no other destination is configured.</p>
</li>
<li>
<p><a class="olink RCMRF149" target="_blank" href="../RCMRF/rcmsynta2008.htm#RCMRF149"><code class="codeph">RESTORE</code></a> <code class="codeph">ARCHIVELOG</code></p>
<p>Explicitly or implicitly set <a id="d21351e5925" class="indexterm-anchor"></a>a <code class="codeph">LOG_ARCHIVE_DEST_</code><span class="italic"><code class="codeph">n</code></span> parameter to <code class="codeph">LOCATION=USE_DB_RECOVERY_FILE_DEST</code>. If you do not specify <a class="olink RCMRF153" target="_blank" href="../RCMRF/rcmsynta2014.htm#RCMRF153"><code class="codeph">SET</code></a> <code class="codeph">ARCHIVELOG DESTINATION</code> to override this behavior, then RMAN restores archived redo log files to the fast recovery area.</p>
</li>
<li>
<p><a class="olink RCMRF140" target="_blank" href="../RCMRF/rcmsynta2001.htm#RCMRF140"><code class="codeph">RECOVER</code></a> <code class="codeph">DATABASE</code> or <code class="codeph">RECOVER TABLESPACE</code>, <code class="codeph">RECOVER ... BLOCK</code>, and <a class="olink RCMRF194" target="_blank" href="../RCMRF/rcmsynta023.htm#RCMRF194"><code class="codeph">FLASHBACK DATABASE</code></a></p>
<p>These commands restore archived redo log files from backup for use during media recovery, as required by the command. RMAN restores any redo log files needed during these operations to the fast recovery area and deletes them after they are applied during media recovery.</p>
<p>To direct the restored archived logs to the fast recovery area, set a <code class="codeph">LOG_ARCHIVE_DEST_</code><span class="italic"><code class="codeph">n</code></span> parameter to <code class="codeph">LOCATION = USE_DB_RECOVERY_FILE_DEST</code>. Verify that you are not using <code class="codeph">SET ARCHIVELOG DESTINATION</code> to direct restored logs to some other destination.</p>
</li>
</ul>
</div>
</div>
</div>
<a id="BRADV8400"></a>
<div class="props_rev_3"><a id="GUID-03DE4CF6-9D9F-4806-B5CA-CAA4CF5F2133"></a>
<h2 id="BRADV-GUID-03DE4CF6-9D9F-4806-B5CA-CAA4CF5F2133" class="sect2">Configuring the Backup Retention Policy</h2>
<div>
<p><a id="d21351e6050" class="indexterm-anchor"></a>As explained in <span class="q">&#34;<a href="rcmcncpt.htm#GUID-3F68F554-FBC9-4375-85DE-7F844C48C8FF">About Backup Retention Policies</a>&#34;</span>, the <a href="glossary.htm#GUID-ECF0ADBB-3255-43A2-A425-26850EA598EA"><span class="xrefglossterm">backup retention policy</span></a> specifies which backups must be retained to meet your data recovery requirements. This policy can be based on a <a id="d21351e6064" class="indexterm-anchor"></a><a href="glossary.htm#GUID-1C595EF7-B8A1-4AA3-8C45-44E9FC8BAB9E"><span class="xrefglossterm">recovery window</span></a> or <a href="glossary.htm#GUID-57A71B9A-2353-4669-A152-EFAD9AFF3ED3"><span class="xrefglossterm">redundancy</span></a>. <a id="d21351e6075" class="indexterm-anchor"></a><a id="d21351e6079" class="indexterm-anchor"></a>Use the <a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><code class="codeph">CONFIGURE RETENTION POLICY</code></a> command to specify the retention policy.<a id="d21351e6089" class="indexterm-anchor"></a><a id="d21351e6093" class="indexterm-anchor"></a><a id="d21351e6099" class="indexterm-anchor"></a></p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfb.htm#GUID-E9AEAC34-6C40-40A1-BAF5-3EAE20417715">Configuring a Redundancy-Based Retention Policy</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-95ABBB30-713E-4781-B5C3-6ADBEB658DE3">Configuring a Recovery Window-Based Retention Policy</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-B668D2BC-8807-4308-AAB4-F3B85EA2B6C4">Disabling the Retention Policy</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-03DE4CF6-9D9F-4806-B5CA-CAA4CF5F2133__GUID-6AF9B1F6-A96B-4E6C-8104-E80DF89C3B19">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">CONFIGURE</code> syntax</p>
</div>
</div>
<a id="BRADV89436"></a>
<div class="props_rev_3"><a id="GUID-E9AEAC34-6C40-40A1-BAF5-3EAE20417715"></a>
<h3 id="BRADV-GUID-E9AEAC34-6C40-40A1-BAF5-3EAE20417715" class="sect3">Configuring a Redundancy-Based Retention Policy</h3>
<div>
<div class="section">
<p><a id="d21351e6201" class="indexterm-anchor"></a>The <code class="codeph">REDUNDANCY</code> parameter of the <code class="codeph">CONFIGURE</code> <code class="codeph">RETENTION</code> <code class="codeph">POLICY</code> command specifies how many full or level 0 backups of each data file and control file that RMAN keeps. If the number of full or level 0 backups for a specific data file or control file exceeds the <code class="codeph">REDUNDANCY</code> setting, then RMAN considers the extra backups as obsolete. The default retention policy is <code class="codeph">REDUNDANCY 1</code>.</p>
<p>As you produce more backups, RMAN keeps track of which ones to retain and which are obsolete. RMAN retains all archived logs and incremental backups that are needed to recover the nonobsolete backups.</p>
<p>Assume that you make a full backup of data file 7 on Monday, Tuesday, Wednesday, and Thursday. You now have four full backups of this data file. If <code class="codeph">REDUNDANCY</code> is <code class="codeph">2</code>, then the Monday and Tuesday backups are obsolete. If you make another backup on Friday, then the Wednesday backup of data file 7 becomes obsolete.</p>
<p>Assume a different case in which <code class="codeph">REDUNDANCY</code> is <code class="codeph">1</code>. You run a level 0 database backup at noon on Monday, a level 1 cumulative backup at noon on Tuesday and Wednesday, and a level 0 backup at noon on Thursday. Immediately after each daily backup you run the command <code class="codeph">DELETE OBSOLETE</code>. The Wednesday <code class="codeph">DELETE</code> command does not remove the Tuesday level 1 backup because this backup is not redundant: the Tuesday level 1 backup could be used to recover the Monday level 0 backup to a time between noon on Tuesday and noon on Wednesday. However, the <code class="codeph">DELETE</code> command on Thursday removes the previous level 0 and level 1 backups.</p>
<p>Run the <code class="codeph">CONFIGURE</code> <code class="codeph">RETENTION</code> <code class="codeph">POLICY</code> command at the RMAN prompt, as in the following example:</p>
<pre dir="ltr">CONFIGURE RETENTION POLICY TO REDUNDANCY 3;
</pre>
<div class="infoboxnotealso" id="GUID-E9AEAC34-6C40-40A1-BAF5-3EAE20417715__GUID-7C476B44-A877-4269-BC42-0EE9F412EAC6">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmmaint.htm#GUID-DB5F52FF-58DE-4486-B0B3-D0EAEA26A776">Deleting Obsolete RMAN Backups Based on Retention Policies</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV89437"></a>
<div class="props_rev_3"><a id="GUID-95ABBB30-713E-4781-B5C3-6ADBEB658DE3"></a>
<h3 id="BRADV-GUID-95ABBB30-713E-4781-B5C3-6ADBEB658DE3" class="sect3">Configuring a Recovery Window-Based Retention Policy</h3>
<div>
<div class="section">
<p><a id="d21351e6341" class="indexterm-anchor"></a><a id="d21351e6345" class="indexterm-anchor"></a>The <a id="d21351e6350" class="indexterm-anchor"></a><code class="codeph">RECOVERY</code> <code class="codeph">WINDOW</code> parameter of the <code class="codeph">CONFIGURE</code> command specifies the number of days between the current time and the earliest point of recoverability. RMAN does not consider any full or <a href="glossary.htm#GUID-DF84C185-E97D-4D3C-BF4E-41A9090C5F4C"><span class="xrefglossterm">level 0 incremental backup</span></a> as obsolete if it falls within the recovery window. Additionally, RMAN retains all archived logs and level 1 incremental backups that are needed to recover to a random point within the window.</p>
<p>Run the <code class="codeph">CONFIGURE</code> <code class="codeph">RETENTION</code> <code class="codeph">POLICY</code> command at the RMAN prompt. This example ensures that you can recover the database to any point within the last week:</p>
<pre dir="ltr">CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 7 DAYS;
</pre>
<p>RMAN does not automatically delete backups rendered obsolete by the recovery window. Instead, RMAN shows them as <code class="codeph">OBSOLETE</code> in the <code class="codeph">REPORT</code> <code class="codeph">OBSOLETE</code> output and in <code class="codeph">the OBSOLETE</code> column <a id="d21351e6394" class="indexterm-anchor"></a>of <code class="codeph">V$BACKUP_FILES</code>. RMAN deletes obsolete files if you run the <code class="codeph">DELETE</code> <code class="codeph">OBSOLETE</code> command.</p>
<div class="infoboxnotealso" id="GUID-95ABBB30-713E-4781-B5C3-6ADBEB658DE3__GUID-272BEAC2-C0C4-4D92-A532-4829E88EFDB5">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmmaint.htm#GUID-DB5F52FF-58DE-4486-B0B3-D0EAEA26A776">Deleting Obsolete RMAN Backups Based on Retention Policies</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV89438"></a>
<div class="props_rev_3"><a id="GUID-B668D2BC-8807-4308-AAB4-F3B85EA2B6C4"></a>
<h3 id="BRADV-GUID-B668D2BC-8807-4308-AAB4-F3B85EA2B6C4" class="sect3">Disabling the Retention Policy</h3>
<div>
<div class="section">
<p><a id="d21351e6484" class="indexterm-anchor"></a>When you disable the retention policy, RMAN does not consider any backup as obsolete. To disable the retention policy, run this command:</p>
<pre dir="ltr">CONFIGURE RETENTION POLICY TO NONE;
</pre>
<p>Configuring the retention policy to <code class="codeph">NONE</code> is different from clearing it. Clearing returns the default setting of <code class="codeph">REDUNDANCY 1</code>, whereas <code class="codeph">NONE</code> disables it.</p>
<p>If you disable the retention policy and run <a class="olink RCMRF147" target="_blank" href="../RCMRF/rcmsynta2006.htm#RCMRF147"><code class="codeph">REPORT OBSOLETE</code></a> or <a class="olink RCMRF121" target="_blank" href="../RCMRF/rcmsynta015.htm#RCMRF121"><code class="codeph">DELETE OBSOLETE</code></a> commands without passing a retention policy option to the command, then RMAN issues an error because no retention policy exists to determine which backups are obsolete.</p>
<div class="infobox-note" id="GUID-B668D2BC-8807-4308-AAB4-F3B85EA2B6C4__GUID-E3884D59-4FAC-4FA6-BF76-485FE9D27657">
<p class="notep1">Caution:</p>
<p>If you are using a fast recovery area, then do not run your database with the retention policy disabled. If files are never considered obsolete, then a file can only be deleted from the fast recovery area if it has been backed up to some other disk location or to a tertiary storage device such as tape. This action is likely to use all of the space in your recovery area, which interferes with the normal operation of your database. See <span class="q">&#34;<a href="rcmconfb.htm#GUID-0454CE22-F2A1-4053-8DC6-AC1714814352">How Oracle Manages Disk Space in the Fast Recovery Area</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="BRADV138"></a>
<div class="props_rev_3"><a id="GUID-914A65A7-872E-465B-95E5-0FD5ADAF6A9C"></a>
<h2 id="BRADV-GUID-914A65A7-872E-465B-95E5-0FD5ADAF6A9C" class="sect2">Backup Optimization and the CONFIGURE command</h2>
<div>
<p><a id="d21351e6591" class="indexterm-anchor"></a><a id="d21351e6595" class="indexterm-anchor"></a>Run the <a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><code class="codeph">CONFIGURE</code></a> command to enable and disable backup optimization. Backup optimization skips the backup of files in certain circumstances if the identical file or an identical version of the file has been backed up.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfb.htm#GUID-ABA3E439-57C2-4AE7-BCEF-39A6663E7AA2">Overview of Backup Optimization</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-66D03493-7AD5-46D1-B7A3-2CAD69E0B8FE">Effect of Retention Policies on Backup Optimization for SBT Backups</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-D78276FA-E505-4542-9D78-2335B5F94922">Configuring Backup Optimization</a></p>
</li>
</ul>
</div>
<a id="BRADV574"></a><a id="BRADV113"></a>
<div class="props_rev_3"><a id="GUID-ABA3E439-57C2-4AE7-BCEF-39A6663E7AA2"></a>
<h3 id="BRADV-GUID-ABA3E439-57C2-4AE7-BCEF-39A6663E7AA2" class="sect3">Overview of Backup Optimization</h3>
<div>
<p><a id="d21351e6693" class="indexterm-anchor"></a><a id="d21351e6699" class="indexterm-anchor"></a><a id="d21351e6703" class="indexterm-anchor"></a>If you enable <a href="glossary.htm#GUID-C75B395F-CA6E-4286-826B-67AABE99606A"><span class="xrefglossterm">backup optimization</span></a>, then <a id="d21351e6712" class="indexterm-anchor"></a><a id="d21351e6716" class="indexterm-anchor"></a>the <a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><code class="codeph">BACKUP</code></a> command skips backing up files when the identical file has been backed up to the specified device type. <a href="rcmconfb.htm#GUID-ABA3E439-57C2-4AE7-BCEF-39A6663E7AA2__CHDFJABD" title="This table is described in the preceding text.">Table 5-4</a> describes criteria that RMAN uses to determine whether a file is identical to a file that it already backed up.</p>
<div class="tblformal" id="GUID-ABA3E439-57C2-4AE7-BCEF-39A6663E7AA2__CHDFJABD">
<p class="titleintable">Table 5-4 Criteria to Determine an Identical File</p>
<table class="cellalignment515" title="Criteria to Determine an Identical File" summary="This table is described in the preceding text.">
<thead>
<tr class="cellalignment501">
<th class="cellalignment522" id="d21351e6740">Type of File</th>
<th class="cellalignment525" id="d21351e6743">Criteria to Determine an Identical File</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment501">
<td class="cellalignment524" id="d21351e6748" headers="d21351e6740">
<p>Data file</p>
</td>
<td class="cellalignment526" headers="d21351e6748 d21351e6743">
<p>The data file must have the same <a href="glossary.htm#GUID-2ABBEADC-F98C-4CF9-AD5B-065337E2733B"><span class="xrefglossterm">DBID</span></a>, <a href="glossary.htm#GUID-5FE755DB-A906-465A-A3E4-D067A77DA15C"><span class="xrefglossterm">checkpoint</span></a> SCN, creation SCN, and <code class="codeph">RESETLOGS</code> SCN and time as a data file in a backup. The data file must be offline-normal, read-only, or closed normally.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment524" id="d21351e6766" headers="d21351e6740">
<p>Archived log</p>
</td>
<td class="cellalignment526" headers="d21351e6766 d21351e6743">
<p>Same DBID, thread, sequence number, and <code class="codeph">RESETLOGS</code> SCN and time</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment524" id="d21351e6776" headers="d21351e6740">
<p>Backup set</p>
</td>
<td class="cellalignment526" headers="d21351e6776 d21351e6743">
<p>Same DBID, backup set record ID, and stamp</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>If RMAN determines that a file is identical and it has been backed up, then it is a candidate to be skipped. RMAN must do further checking to determine whether to skip the file, however, because both the retention policy and the backup duplexing feature are factors in the algorithm that determines whether RMAN has sufficient backups on the specified device type.</p>
<p><a id="d21351e6785" class="indexterm-anchor"></a><a id="d21351e6789" class="indexterm-anchor"></a>RMAN uses backup optimization when the following conditions are true:</p>
<ul style="list-style-type: disc;">
<li>
<p>The <code class="codeph">CONFIGURE</code> <code class="codeph">BACKUP</code> <code class="codeph">OPTIMIZATION</code> <code class="codeph">ON</code> command has been run to enable backup optimization.</p>
</li>
<li>
<p>You run <code class="codeph">BACKUP</code> <code class="codeph">DATABASE</code>, <code class="codeph">BACKUP</code> <code class="codeph">ARCHIVELOG</code> with <code class="codeph">ALL</code> or <code class="codeph">LIKE</code> options, or <code class="codeph">BACKUP</code> <code class="codeph">BACKUPSET</code> <code class="codeph">ALL</code>, <code class="codeph">BACKUP RECOVERY AREA</code>, <code class="codeph">BACKUP RECOVERY FILES</code>, or <code class="codeph">BACKUP DATAFILECOPY</code>.</p>
<div class="infobox-note" id="GUID-ABA3E439-57C2-4AE7-BCEF-39A6663E7AA2__GUID-70E9BFDD-00CF-4E67-BF7E-8C4E39E3B801">
<p class="notep1">Note:</p>
<p>When <code class="codeph">TO DESTINATION</code> is used with <code class="codeph">BACKUP RECOVERY AREA</code> or <code class="codeph">BACKUP RECOVERY FILES</code>, RMAN only skips backups of files that have identical backups in the <code class="codeph">TO DESTINATION</code> location that you provide.</p>
</div>
</li>
<li>
<p>Only one type of channel is allocated, do not mix disk and <a href="glossary.htm#GUID-2E48CE71-9547-4196-B715-5CE59033262E"><span class="xrefglossterm">SBT</span></a> channels in the same backup command.</p>
</li>
</ul>
<div class="infobox-note" id="GUID-ABA3E439-57C2-4AE7-BCEF-39A6663E7AA2__GUID-1A7B36F3-0D08-489A-B420-21A34435DDDA">
<p class="notep1">Note:</p>
<p>In <a id="d21351e6876" class="indexterm-anchor"></a><a href="glossary.htm#GUID-06FF333B-92A2-4190-BF2C-09EBBEFA114D"><span class="xrefglossterm">backup undo optimization</span></a>, RMAN excludes undo changes (that are not needed for recovery of a backup) for transactions that have been committed. You can enable and disable backup optimization, but backup undo optimization is built-in behavior.</p>
</div>
<p><a id="d21351e6883" class="indexterm-anchor"></a><a id="d21351e6887" class="indexterm-anchor"></a>For example, assume that you have configured backup optimization. These commands back up to tape the database, all archived logs, and all backup sets:</p>
<pre dir="ltr">BACKUP DEVICE TYPE sbt DATABASE PLUS ARCHIVELOG;
BACKUP DEVICE TYPE sbt BACKUPSET ALL;
</pre>
<p>If no backed-up file has changed since the last backup, then RMAN does not back up the files again. RMAN also does not signal an error if it skips all files specified in the command because the files have already been backed up.</p>
<p>You can override optimization at any time by specifying the <code class="codeph">FORCE</code> option on the <code class="codeph">BACKUP</code> command. For example, you can run:</p>
<pre dir="ltr">BACKUP DATABASE FORCE;
BACKUP ARCHIVELOG ALL FORCE;
</pre>
<div class="infoboxnotealso" id="GUID-ABA3E439-57C2-4AE7-BCEF-39A6663E7AA2__GUID-FB5C53D4-DA48-43C8-AAC4-04258900594D">
<p class="notep1">See Also:</p>
<p>The <code class="codeph">CONFIGURE</code> entry in <a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for a complete description of the backup optimization rules</p>
</div>
</div>
</div>
<a id="BRADV89462"></a>
<div class="props_rev_3"><a id="GUID-66D03493-7AD5-46D1-B7A3-2CAD69E0B8FE"></a>
<h3 id="BRADV-GUID-66D03493-7AD5-46D1-B7A3-2CAD69E0B8FE" class="sect3">Effect of Retention Policies on Backup Optimization for SBT Backups</h3>
<div>
<p><a id="d21351e6987" class="indexterm-anchor"></a><a id="d21351e6991" class="indexterm-anchor"></a>Backup optimization is not always applied when backing up to <a href="glossary.htm#GUID-2E48CE71-9547-4196-B715-5CE59033262E"><span class="xrefglossterm">SBT</span></a> devices. The exceptions to normal backup optimization behavior for recovery window-based and redundancy-based retention policies are described in the following sections.</p>
<div class="infobox-note" id="GUID-66D03493-7AD5-46D1-B7A3-2CAD69E0B8FE__GUID-B19188E6-6414-4EC8-AC87-882F46DE758C">
<p class="notep1">Note:</p>
<p>Use caution when enabling backup optimization if you use a media manager with its own internal expiration policy. Run the <a class="olink RCMRF119" target="_blank" href="../RCMRF/rcmsynta014.htm#RCMRF119"><code class="codeph">CROSSCHECK</code></a> command periodically to synchronize the RMAN repository with the media manager. Otherwise, RMAN may skip backups due to optimization without recognizing that the media manager has discarded backups stored on tape.</p>
</div>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfb.htm#GUID-27CE5FE2-DAF0-4E96-B7DF-933616E64C45">About Backup Optimization for SBT Backups with Recovery Window Retention Policy</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-56FA660A-E096-405C-B51B-AA927EC5DD0B">About Backup Optimization for SBT Backups With Redundancy Retention Policy</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-D78276FA-E505-4542-9D78-2335B5F94922">Configuring Backup Optimization</a></p>
</li>
</ul>
</div>
<a id="BRADV89463"></a>
<div class="props_rev_3"><a id="GUID-27CE5FE2-DAF0-4E96-B7DF-933616E64C45"></a>
<h4 id="BRADV-GUID-27CE5FE2-DAF0-4E96-B7DF-933616E64C45" class="sect4">About Backup Optimization for SBT Backups with Recovery Window Retention Policy</h4>
<div>
<p>Suppose that backup optimization is enabled, and a recovery window <a href="glossary.htm#GUID-ECF0ADBB-3255-43A2-A425-26850EA598EA"><span class="xrefglossterm">backup retention policy</span></a> is in effect. In this case, when performing SBT backups RMAN always backs up data files whose most recent backup is older than the <a href="glossary.htm#GUID-1C595EF7-B8A1-4AA3-8C45-44E9FC8BAB9E"><span class="xrefglossterm">recovery window</span></a>. For example, assume the following scenario:</p>
<ul style="list-style-type: disc;">
<li>
<p>Today is February 21.</p>
</li>
<li>
<p>The recovery window is 7 days.</p>
</li>
<li>
<p>The most recent backup of tablespace <code class="codeph">tools</code> to tape is January 3.</p>
</li>
<li>
<p>Tablespace <code class="codeph">tools</code> is read-only.</p>
</li>
</ul>
<p>On February 21, when you issue a command to back up tablespace <code class="codeph">tools</code> to tape, RMAN backs it up even though it did not change after the January 3 backup (because it is read-only). RMAN makes the backup because no backup of the tablespace exists within the 7-day recovery window.</p>
<p>This behavior enables the media manager to expire old tapes. Otherwise, the media manager is forced to keep the January 3 backup of tablespace <code class="codeph">TOOLS</code> indefinitely. By making a more recent backup of tablespace <code class="codeph">tools</code> on February 21, RMAN enables the media manager to expire the tape containing the January 3 backup.</p>
</div>
</div>
<a id="BRADV575"></a><a id="BRADV89464"></a>
<div class="props_rev_3"><a id="GUID-56FA660A-E096-405C-B51B-AA927EC5DD0B"></a>
<h4 id="BRADV-GUID-56FA660A-E096-405C-B51B-AA927EC5DD0B" class="sect4">About Backup Optimization for SBT Backups With Redundancy Retention Policy</h4>
<div>
<p><a id="d21351e7206" class="indexterm-anchor"></a>Assume that you configure a retention policy for redundancy. In this case, RMAN only skips backups of offline or read-only data files to SBT when there are <span class="italic"><code class="codeph">r</code></span> + 1 backups of the files, where <span class="italic"><code class="codeph">r</code></span> is set in <code class="codeph">CONFIGURE</code> <code class="codeph">RETENTION</code> <code class="codeph">POLICY</code> <code class="codeph">TO</code> <code class="codeph">REDUNDANCY</code> <span class="italic"><code class="codeph">r</code></span>.</p>
<p>For example, assume that you enable backup optimization and set the following retention policy:</p>
<pre dir="ltr">CONFIGURE DEFAULT DEVICE TYPE TO sbt;
CONFIGURE BACKUP OPTIMIZATION ON;
CONFIGURE RETENTION POLICY TO REDUNDANCY 2;
</pre>
<p>With these settings, RMAN only skips backups when three identical files are backed up. Also assume that you have never backed up the <code class="codeph">users</code> tablespace, which is read/write, and that you perform the actions described in the following table over the course of the week.</p>
<div class="tblformal" id="GUID-56FA660A-E096-405C-B51B-AA927EC5DD0B__G1028781">
<p class="titleintable">Table 5-5 Effect of Redundancy Setting on Backup Optimization</p>
<table class="cellalignment515" title="Effect of Redundancy Setting on Backup Optimization" summary="This table describes the effects of the redundancy setting on daily backups performed over a week.">
<thead>
<tr class="cellalignment501">
<th class="cellalignment520" id="d21351e7260">Day</th>
<th class="cellalignment520" id="d21351e7263">Action</th>
<th class="cellalignment520" id="d21351e7266">Result</th>
<th class="cellalignment520" id="d21351e7269">Redundant Backup</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment501">
<td class="cellalignment501" id="d21351e7274" headers="d21351e7260">
<p>Monday</p>
</td>
<td class="cellalignment501" headers="d21351e7274 d21351e7263">
<p>Take <code class="codeph">users</code> offline normal.</p>
</td>
<td class="cellalignment501" headers="d21351e7274 d21351e7266">&nbsp;</td>
<td class="cellalignment501" headers="d21351e7274 d21351e7269">&nbsp;</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment501" id="d21351e7286" headers="d21351e7260">
<p>Tuesday</p>
</td>
<td class="cellalignment501" headers="d21351e7286 d21351e7263">
<p><code class="codeph">BACKUP</code> <code class="codeph">DATABASE</code></p>
</td>
<td class="cellalignment501" headers="d21351e7286 d21351e7266">
<p>The <code class="codeph">users</code> tablespace is backed up.</p>
</td>
<td class="cellalignment501" headers="d21351e7286 d21351e7269">&nbsp;</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment501" id="d21351e7304" headers="d21351e7260">
<p>Wednesday</p>
</td>
<td class="cellalignment501" headers="d21351e7304 d21351e7263">
<p><code class="codeph">BACKUP</code> <code class="codeph">DATABASE</code></p>
</td>
<td class="cellalignment501" headers="d21351e7304 d21351e7266">
<p>The <code class="codeph">users</code> tablespace is backed up.</p>
</td>
<td class="cellalignment501" headers="d21351e7304 d21351e7269">&nbsp;</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment501" id="d21351e7322" headers="d21351e7260">
<p>Thursday</p>
</td>
<td class="cellalignment501" headers="d21351e7322 d21351e7263">
<p><code class="codeph">BACKUP</code> <code class="codeph">DATABASE</code></p>
</td>
<td class="cellalignment501" headers="d21351e7322 d21351e7266">
<p>The <code class="codeph">users</code> tablespace is backed up.</p>
</td>
<td class="cellalignment501" headers="d21351e7322 d21351e7269">
<p>Tuesday backup</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment501" id="d21351e7342" headers="d21351e7260">
<p>Friday</p>
</td>
<td class="cellalignment501" headers="d21351e7342 d21351e7263">
<p><code class="codeph">BACKUP</code> <code class="codeph">DATABASE</code></p>
</td>
<td class="cellalignment501" headers="d21351e7342 d21351e7266">
<p>The <code class="codeph">users</code> tablespace is <span class="italic">not</span> backed up.</p>
</td>
<td class="cellalignment501" headers="d21351e7342 d21351e7269">
<p>Tuesday backup</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment501" id="d21351e7365" headers="d21351e7260">
<p>Saturday</p>
</td>
<td class="cellalignment501" headers="d21351e7365 d21351e7263">
<p><code class="codeph">BACKUP</code> <code class="codeph">DATABASE</code></p>
</td>
<td class="cellalignment501" headers="d21351e7365 d21351e7266">
<p>The <code class="codeph">users</code> tablespace is <span class="italic">not</span> backed up.</p>
</td>
<td class="cellalignment501" headers="d21351e7365 d21351e7269">
<p>Tuesday backup</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment501" id="d21351e7388" headers="d21351e7260">
<p>Sunday</p>
</td>
<td class="cellalignment501" headers="d21351e7388 d21351e7263">
<p><code class="codeph">DELETE</code> <code class="codeph">OBSOLETE</code></p>
</td>
<td class="cellalignment501" headers="d21351e7388 d21351e7266">
<p>The Tuesday backup is deleted.</p>
</td>
<td class="cellalignment501" headers="d21351e7388 d21351e7269">&nbsp;</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment501" id="d21351e7403" headers="d21351e7260">
<p>Monday</p>
</td>
<td class="cellalignment501" headers="d21351e7403 d21351e7263">
<p><code class="codeph">BACKUP</code> <code class="codeph">DATABASE</code></p>
</td>
<td class="cellalignment501" headers="d21351e7403 d21351e7266">
<p>The <code class="codeph">users</code> tablespace is backed up.</p>
</td>
<td class="cellalignment501" headers="d21351e7403 d21351e7269">
<p>Wednesday backup</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>The backups on Tuesday, Wednesday, and Thursday back up the offline <code class="codeph">users</code> tablespace to satisfy the condition that three backups must exist (one more than redundancy setting). The Friday and Saturday backups do not back up the <code class="codeph">users</code> tablespace because of backup optimization. The Tuesday backup of <code class="codeph">users</code> is obsolete beginning on Thursday.</p>
<p>On Sunday, you delete all obsolete backups, which removes the Tuesday backup of <code class="codeph">users</code>. The Tuesday backup is obsolete because of the retention policy setting. The whole database backup on Monday then backs up the <code class="codeph">users</code> tablespace to satisfy the condition that three backups must exist (one more than redundancy setting). In this way, you can recycle your tapes over time.</p>
<div class="infoboxnotealso" id="GUID-56FA660A-E096-405C-B51B-AA927EC5DD0B__GUID-90BB0C1C-D460-4BAE-A87E-37DA4B8F3936">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmconfb.htm#GUID-914A65A7-872E-465B-95E5-0FD5ADAF6A9C">Backup Optimization and the CONFIGURE command</a>&#34;</span></p>
</div>
</div>
</div>
</div>
<a id="BRADV178"></a><a id="BRADV89465"></a>
<div class="props_rev_3"><a id="GUID-D78276FA-E505-4542-9D78-2335B5F94922"></a>
<h3 id="BRADV-GUID-D78276FA-E505-4542-9D78-2335B5F94922" class="sect3">Configuring Backup Optimization</h3>
<div>
<div class="section">
<p><a id="d21351e7519" class="indexterm-anchor"></a><a id="d21351e7523" class="indexterm-anchor"></a><a id="d21351e7527" class="indexterm-anchor"></a>By default, backup optimization is configured to <code class="codeph">OFF</code>. You can use the <a class="olink RCMRF154" target="_blank" href="../RCMRF/rcmsynta2015.htm#RCMRF154"><code class="codeph">SHOW BACKUP OPTIMIZATION</code></a> command to view the current settings of backup optimization.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To configure backup optimization:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to a target database and a recovery catalog (if used).</span></li>
<li class="stepexpand"><span>Run the <code class="codeph">SHOW</code> <code class="codeph">BACKUP</code> <code class="codeph">OPTIMIZATION</code> command to determine whether optimization is currently enabled.</span>
<div>
<p>For example, enter the following command:</p>
<pre dir="ltr">SHOW BACKUP OPTIMIZATION;
</pre>
<p>Sample output for <code class="codeph">SHOW</code> <code class="codeph">BACKUP</code> <code class="codeph">OPTIMIZATION</code> follows:</p>
<pre dir="ltr">RMAN configuration parameters for database with db_unique_name PROD1 are:
CONFIGURE BACKUP OPTIMIZATION OFF;
</pre></div>
</li>
<li class="stepexpand"><span>Enable backup optimization by running the following command:</span>
<div>
<pre dir="ltr">CONFIGURE BACKUP OPTIMIZATION ON;
</pre></div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-D78276FA-E505-4542-9D78-2335B5F94922__GUID-AF31A555-4E85-477F-B639-82F9FA95B1CF">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmbckad.htm#GUID-BC32C333-F0EB-4F17-AD79-8882E224D2F4">Using Backup Optimization to Skip Files</a>&#34;</span> for examples of how to optimize RMAN backups</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="BRADV89439"></a>
<div class="props_rev_3"><a id="GUID-FA142760-8ACB-43DA-939C-8407618D2D0F"></a>
<h2 id="BRADV-GUID-FA142760-8ACB-43DA-939C-8407618D2D0F" class="sect2">Configuring an Archived Redo Log Deletion Policy</h2>
<div>
<p>You can use RMAN to create a persistent configuration that governs when archived redo logs are eligible for deletion from disk.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfb.htm#GUID-30772A33-4C40-42D2-89AE-FDAC92DF44C9">About Archived Redo Log Deletion Policies</a></p>
</li>
<li>
<p><a href="rcmconfb.htm#GUID-97829620-DD75-4993-BE83-E67F5CA5BB18">Enabling an Archived Redo Log Deletion Policy</a></p>
</li>
</ul>
</div>
<a id="BRADV89440"></a>
<div class="props_rev_3"><a id="GUID-30772A33-4C40-42D2-89AE-FDAC92DF44C9"></a>
<h3 id="BRADV-GUID-30772A33-4C40-42D2-89AE-FDAC92DF44C9" class="sect3">About Archived Redo Log Deletion Policies</h3>
<div>
<p><a id="d21351e7743" class="indexterm-anchor"></a><a id="d21351e7745" class="indexterm-anchor"></a>You can use the <code class="codeph">CONFIGURE ARCHIVELOG DELETION POLICY</code> command to specify when archived redo logs are eligible for deletion. This deletion policy applies to all archiving destinations, including the <a href="glossary.htm#GUID-6E3CDD76-A573-4E5C-B12D-59C232C96C19"><span class="xrefglossterm">fast recovery area</span></a>.</p>
<p>Archived redo logs can be deleted automatically by the database or by user-initiated RMAN commands. Only logs in the fast recovery area can be deleted automatically by the database. For archived redo log files in the fast recovery area, the database retains them as long as possible and automatically deletes eligible logs when additional disk space is required. You can manually delete eligible logs from any location, whether inside or outside the fast recovery area, when you issue <a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><code class="codeph">BACKUP</code></a> <code class="codeph">... DELETE INPUT</code> or <code class="codeph">DELETE ARCHIVELOG</code> commands.</p>
</div>
<a id="BRADV99962"></a>
<div class="props_rev_3"><a id="GUID-E084E268-856C-4358-B2AA-09AEA3389929"></a>
<h4 id="BRADV-GUID-E084E268-856C-4358-B2AA-09AEA3389929" class="sect4">When the Archived Redo Log Deletion Policy Is Disabled</h4>
<div>
<p>By default, there is no <a href="glossary.htm#GUID-3492E0C3-F42C-45E6-84E2-63E30A3489A4"><span class="xrefglossterm">archived redo log deletion policy</span></a> and this is why the archive redo log policy is set to the <code class="codeph">NONE</code> clause. In this particular case, the fast recovery area considers archived redo log files in the recovery area as eligible for deletion if they have been backed up at least once to disk or SBT or the logs are obsolete according to the backup retention policy. The backup retention policy considers logs obsolete only if the logs are not needed by a guaranteed restore point and the logs are not needed by Oracle Flashback Database. Archived redo logs are needed by Flashback Database if the logs were created later than <code class="codeph">SYSDATE-&#39;DB_FLASHBACK_RETENTION_TARGET&#39;</code>.</p>
<div class="infoboxnotealso" id="GUID-E084E268-856C-4358-B2AA-09AEA3389929__GUID-7BE87898-28BF-4AB3-A1F1-A135BFB11609">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p>The <code class="codeph">CONFIGURE ARCHIVELOG DELETION POLICY</code> entry in <a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for detailed information about policy options</p>
</li>
<li>
<p><a class="olink SBYDB" target="_blank" href="../SBYDB/toc.htm"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> to learn how to configure an archived log deletion policy in a Data Guard environment</p>
</li>
</ul>
</div>
</div>
</div>
<a id="BRADV99963"></a>
<div class="props_rev_3"><a id="GUID-CDE80DA3-FCDE-4829-925F-E78193597A1C"></a>
<h4 id="BRADV-GUID-CDE80DA3-FCDE-4829-925F-E78193597A1C" class="sect4">When the Archived Redo Log Deletion Policy Is Enabled</h4>
<div>
<p>You can use the <code class="codeph">CONFIGURE ARCHIVELOG DELETION POLICY BACKED UP</code> <span class="italic"><code class="codeph">integer</code></span> <code class="codeph">TIMES TO DEVICE TYPE</code> command to enable an archived log deletion policy. This configuration specifies that archived logs are eligible for deletion only when the specified number of archived log backups exist on the specified device type.</p>
<p>If the deletion policy is configured with the <code class="codeph">BACKED UP</code> <span class="italic"><code class="codeph">integer</code></span> <code class="codeph">TIMES</code> clause, then a <code class="codeph">BACKUP ARCHIVELOG</code> command copies the logs unless <span class="italic"><code class="codeph">integer</code></span> backups exist on the specified device type. If <span class="italic"><code class="codeph">integer</code></span> backups of the logs exist, then the <code class="codeph">BACKUP ARCHIVELOG</code> command skips the logs. In this way, the archived log deletion policy functions as a default <code class="codeph">NOT BACKED UP</code> <span class="italic"><code class="codeph">integer</code></span> <code class="codeph">TIMES</code> clause on the <code class="codeph">BACKUP ARCHIVELOG</code> command. You can override the deletion policy by specifying the <code class="codeph">FORCE</code> option on the <code class="codeph">BACKUP</code> command.</p>
<p>The archived log deletion policy also has options specific to a <a id="d21351e7995" class="indexterm-anchor"></a>Data Guard environment. For example, if you specify the <code class="codeph">APPLIED ON STANDBY</code> clause, then RMAN can delete logs after they have been applied at all mandatory remote destinations. If you specify <code class="codeph">SHIPPED TO STANDBY</code>, then RMAN can delete logs when they have been transferred to all mandatory standby destinations.</p>
<div class="infoboxnotealso" id="GUID-CDE80DA3-FCDE-4829-925F-E78193597A1C__GUID-C556AF0A-B7C2-4036-8DB0-6BD4694F1943">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p>The <code class="codeph">CONFIGURE ARCHIVELOG DELETION POLICY</code> entry in <a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for detailed information about policy options</p>
</li>
<li>
<p><a class="olink SBYDB04700" target="_blank" href="../SBYDB/rman.htm#SBYDB04700"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> to learn how to configure an archived log deletion policy in a Data Guard environment</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<a id="BRADV576"></a><a id="BRADV89441"></a>
<div class="props_rev_3"><a id="GUID-97829620-DD75-4993-BE83-E67F5CA5BB18"></a>
<h3 id="BRADV-GUID-97829620-DD75-4993-BE83-E67F5CA5BB18" class="sect3">Enabling an Archived Redo Log Deletion Policy</h3>
<div>
<div class="section">
<p><a id="d21351e8097" class="indexterm-anchor"></a><a id="d21351e8101" class="indexterm-anchor"></a>This section explains how to configure an archived redo log deletion policy. By default the policy is set to <code class="codeph">NONE</code>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To enable an archived redo log deletion policy:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to a target database and a recovery catalog (if used).</span></li>
<li class="stepexpand"><span>Run the <code class="codeph">CONFIGURE ARCHIVELOG DELETION POLICY</code> command with the desired options.</span>
<div>
<p>The following example specifies that archived redo logs are eligible to be deleted from the fast recovery area and all local archiving destinations when logs have been backed up at least twice to tape:</p>
<pre dir="ltr">CONFIGURE ARCHIVELOG DELETION POLICY
  TO BACKED UP 2 TIMES TO SBT;
</pre></div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-97829620-DD75-4993-BE83-E67F5CA5BB18__GUID-61840FA9-A7A6-4930-B826-DFA0D1F16A77">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="rcmbckba.htm#GUID-E99C2A06-868F-458A-88F1-B257EADD63CB">Deleting Archived Redo Logs After Backups in non-CDBs</a>&#34;</span></p>
</li>
<li>
<p><a class="olink SBYDB" target="_blank" href="../SBYDB/toc.htm"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> to learn how to manage archived redo logs in a Data Guard environment</p>
</li>
<li>
<p><a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for a complete explanation of the <code class="codeph">CONFIGURE ARCHIVELOG DELETION POLICY</code> command and the conditions under which archived logs are eligible for deletion</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="BRADV89455"></a>
<div class="props_rev_3"><a id="GUID-FDA66A53-B2AA-4C59-A142-C2F04016FAEF"></a>
<h2 id="BRADV-GUID-FDA66A53-B2AA-4C59-A142-C2F04016FAEF" class="sect2">Configuring RMAN in a Data Guard Environment</h2>
<div>
<div class="section">
<p><a id="d21351e8221" class="indexterm-anchor"></a>If you use RMAN in a Data Guard environment, then you can use the <code class="codeph">CONFIGURE</code> command to register and configure settings for the physical databases in this environment. RMAN uses the <a id="d21351e8229" class="indexterm-anchor"></a><code class="codeph">DB_UNIQUE_NAME</code> initialization parameter to distinguish one database from another. Thus, it is critical that you maintain the uniqueness of the <code class="codeph">DB_UNIQUE_NAME</code> in the Data Guard environment.</p>
<p>RMAN must be connected to a recovery catalog when you create or alter a configuration for a database in the Data Guard environment. If you use the <code class="codeph">SET DBID</code> command to set the DBID in the <a href="glossary.htm#GUID-01D29658-41E1-4D45-9C7F-A761D56885B9"><span class="xrefglossterm">RMAN session</span></a>, then you can configure a standby database even when RMAN is not connected as <code class="codeph">TARGET</code> to a database in the Data Guard environment. You can even create a configuration for a standby database that has not yet been created.</p>
<p>You can use the following forms of the <code class="codeph">CONFIGURE</code> command:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">CONFIGURE DB_UNIQUE_NAME</code> <a id="d21351e8261" class="indexterm-anchor"></a><a id="d21351e8265" class="indexterm-anchor"></a>defines a connection to a <a href="glossary.htm#GUID-009B3F56-8C1E-4CF6-AF0F-A9D2C2E4B9C2"><span class="xrefglossterm">physical standby database</span></a> and implicitly registers the new database.</p>
<p>New standby databases are also automatically registered when RMAN connects as <code class="codeph">TARGET</code> to a standby database for the first time.</p>
</li>
<li>
<p><code class="codeph">CONFIGURE FOR DB_UNIQUE_NAME</code> configures settings for a database in the Data Guard environment.</p>
<p>For example, you can configure channels, default devices, and so on for a specified database or for all databases in the environment. You can use <code class="codeph">SHOW ALL FOR DB_UNIQUE_NAME</code> to show the configuration for a specific standby database or <code class="codeph">SHOW ALL FOR DB_UNIQUE_NAME ALL</code> to show configurations for all known databases.</p>
</li>
</ul>
<p>A Data Guard environment involves many considerations that are only relevant for Data Guard. For example, you can configure an <a href="glossary.htm#GUID-3492E0C3-F42C-45E6-84E2-63E30A3489A4"><span class="xrefglossterm">archived redo log deletion policy</span></a> based on whether archived logs are transferred to or applied on a standby database.</p>
<div class="infoboxnotealso" id="GUID-FDA66A53-B2AA-4C59-A142-C2F04016FAEF__GUID-C6CE7B9E-7228-4B3A-B9D2-B52DD4A350B8">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink SBYDB04700" target="_blank" href="../SBYDB/rman.htm#SBYDB04700"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> to learn how to configure the RMAN environment for use with a standby database</p>
</li>
<li>
<p><a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for a complete explanation of the <code class="codeph">CONFIGURE ARCHIVELOG DELETION POLICY</code> command and the conditions under which archived logs are eligible for deletion</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment500">
<tr>
<td class="cellalignment512">
<table class="cellalignment505">
<tr>
<td class="cellalignment504"><a href="rcmcnctg.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment504"><a href="rcmconfa.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment514">
<table class="cellalignment503">
<tr>
<td class="cellalignment504"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment504"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment504"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment504"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment504"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment504"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>