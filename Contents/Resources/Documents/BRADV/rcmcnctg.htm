<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-2666"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Starting%20and%20Interacting%20with%20the%20RMAN%C2%A0Client"></a><title>Starting and Interacting with the RMAN&nbsp;Client</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="pluggable databases, PDBs, multitenant container databases, CDBs, connecting to, connecting, to PDBs, to CDBs, about backup and recovery of, about, backing up PDBs, backing up CDBs, restrictions when connected to, restrictions"/>
<meta name="dcterms.created" content="2017-06-07T23:52:16Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Backup and Recovery User&#39;s Guide"/>
<meta name="dcterms.identifier" content="E50658-09"/>
<meta name="dcterms.isVersionOf" content="BRADV"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="rcmarchi.htm" title="Previous" type="text/html"/>
<link rel="Next" href="rcmconfb.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E50658-09.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-E4E287F5-5F36-431A-B069-F360A5B4BC7C"></a> <span id="PAGE" style="display:none;">13/48</span> <!-- End Header -->
<a id="BRADV005"></a>
<h1 id="BRADV-GUID-E4E287F5-5F36-431A-B069-F360A5B4BC7C" class="sect1"><span class="enumeration_chapter">4</span> Starting and Interacting with the RMAN&nbsp;Client</h1>
<div>
<p>This chapter explains how to start the RMAN command-line interface and make database connections. This chapter contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmcnctg.htm#GUID-D5B0BB45-DDB0-4778-B8A1-CD41247A323C">Overview of Interacting with the RMAN Client</a></p>
</li>
<li>
<p><a href="rcmcnctg.htm#GUID-92CF0473-8B35-48A8-BA49-4DC52A7ECBC0">Starting and Exiting RMAN</a></p>
</li>
<li>
<p><a href="rcmcnctg.htm#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C">Making Database Connections with RMAN</a></p>
</li>
<li>
<p><a href="rcmcnctg.htm#GUID-507D61EC-3D28-4C67-8013-BE724AD89FFD">Specifying the Location of RMAN Output</a></p>
</li>
<li>
<p><a href="rcmcnctg.htm#GUID-F600535A-D46A-4BB1-88FD-266396ECE795">Setting Globalization Support Environment Variables for RMAN</a></p>
</li>
<li>
<p><a href="rcmcnctg.htm#GUID-D7BEDDA1-26CF-47E0-B55F-85E3CA238ECA">Entering RMAN Commands</a></p>
</li>
<li>
<p><a href="rcmcnctg.htm#GUID-2273E896-C08B-498F-B96C-55400CCD1A17">Using the RMAN Pipe Interface</a></p>
</li>
</ul>
</div>
<div class="sect2"><a id="GUID-D5B0BB45-DDB0-4778-B8A1-CD41247A323C"></a>
<h2 id="BRADV-GUID-D5B0BB45-DDB0-4778-B8A1-CD41247A323C" class="sect2">Overview of Interacting with the RMAN Client</h2>
<div>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmcnctg.htm#GUID-10B522E4-BA12-4B74-A77A-E189BFF6E59C">About RMAN Database Connection Types</a></p>
</li>
<li>
<p><a href="rcmcnctg.htm#GUID-BF676275-B5A4-46BE-8CDC-544906C416D2">About Authentication for RMAN Database Connections</a></p>
</li>
</ul>
</div>
<a id="BRADV151"></a><a id="BRADV89390"></a>
<div class="props_rev_3"><a id="GUID-10B522E4-BA12-4B74-A77A-E189BFF6E59C"></a>
<h3 id="BRADV-GUID-10B522E4-BA12-4B74-A77A-E189BFF6E59C" class="sect3">About RMAN Database Connection Types</h3>
<div>
<p><a id="d18035e254" class="indexterm-anchor"></a><a id="d18035e258" class="indexterm-anchor"></a>To perform useful work, the RMAN client must connect to a database. <a href="rcmcnctg.htm#GUID-10B522E4-BA12-4B74-A77A-E189BFF6E59C__CEGHGAFD" title="Types of RMAN database connections">Table 4-1</a> describes the types of database connections that you can make with RMAN.</p>
<div class="tblformal" id="GUID-10B522E4-BA12-4B74-A77A-E189BFF6E59C__CEGHGAFD">
<p class="titleintable">Table 4-1 Overview of RMAN Database Connections</p>
<table class="cellalignment515" title="Overview of RMAN Database Connections" summary="Types of RMAN database connections">
<thead>
<tr class="cellalignment501">
<th class="cellalignment532" id="d18035e279">Type of Database Connection</th>
<th class="cellalignment531" id="d18035e282">Keyword</th>
<th class="cellalignment533" id="d18035e285">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment501">
<td class="cellalignment535" id="d18035e290" headers="d18035e279">
<p><a href="glossary.htm#GUID-272C4366-303F-4629-9679-1379AAC3FBC1"><span class="xrefglossterm">target database</span></a></p>
</td>
<td class="cellalignment534" headers="d18035e290 d18035e282">
<p><code class="codeph">TARGET</code></p>
</td>
<td class="cellalignment536" headers="d18035e290 d18035e285">
<p>A database to be backed up or recovered by RMAN</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment535" id="d18035e303" headers="d18035e279">
<p><a href="glossary.htm#GUID-C54D9858-2461-412B-95FF-80FBACD58AB0"><span class="xrefglossterm">recovery catalog database</span></a></p>
</td>
<td class="cellalignment534" headers="d18035e303 d18035e282">
<p><code class="codeph">CATALOG</code></p>
</td>
<td class="cellalignment536" headers="d18035e303 d18035e285">
<p>A database that provides an optional backup store for the RMAN repository in addition to the control file.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment535" id="d18035e316" headers="d18035e279">
<p><a href="glossary.htm#GUID-4B8BBEA0-2F0F-4C5E-AE69-F1EE4DBA1B46"><span class="xrefglossterm">auxiliary instance</span></a> or <a href="glossary.htm#GUID-C179BB7F-F134-4D10-AADB-335526DB2BBA"><span class="xrefglossterm">auxiliary database</span></a></p>
</td>
<td class="cellalignment534" headers="d18035e316 d18035e282">
<p><code class="codeph">AUXILIARY</code></p>
</td>
<td class="cellalignment536" headers="d18035e316 d18035e285">
<p>A <a href="glossary.htm#GUID-009B3F56-8C1E-4CF6-AF0F-A9D2C2E4B9C2"><span class="xrefglossterm">physical standby database</span></a>, or a database instance created for performing a specific task such as creating a <a href="glossary.htm#GUID-FFB6CFD5-300C-4290-B3C0-BFD930ACA30C"><span class="xrefglossterm">duplicate database</span></a>, transporting tablespaces, or performing <a href="glossary.htm#GUID-8A257409-B3DC-41FD-A2AF-D47560FF9F18"><span class="xrefglossterm">tablespace point-in-time recovery (TSPITR)</span></a>.</p>
<p>For many tasks that use an auxiliary database, RMAN creates an automatic auxiliary instance for use during the task, connects to it, performs the task, and then destroys it when the task is completed. You do not give any explicit command to connect to automatic auxiliary instances.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="BRADV89391"></a>
<div class="props_rev_3"><a id="GUID-BF676275-B5A4-46BE-8CDC-544906C416D2"></a>
<h3 id="BRADV-GUID-BF676275-B5A4-46BE-8CDC-544906C416D2" class="sect3">About Authentication for RMAN Database Connections</h3>
<div>
<p><a id="d18035e415" class="indexterm-anchor"></a><a id="d18035e421" class="indexterm-anchor"></a>Users connecting with RMAN to a target or auxiliary database require either the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> system privilege. These privileges are not required when connecting to the recovery catalog. You must grant the <code class="codeph">RECOVERY_CATALOG_OWNER</code> role to the catalog schema owner. Users can also connect to the recovery catalog using the VPC credentials that have been created by the recovery catalog owner.</p>
<p>The same authentication options that are available with SQL*Plus are available with RMAN. The most common ways to authenticate with the target and auxiliary databases are:</p>
<ul style="list-style-type: disc;">
<li>
<p>Operating system authentication</p>
<p>The prerequisites for connecting using operating system authentication are described in <a href="rcmcnctg.htm#GUID-703C639F-D05F-4130-8489-02E2BA6F1D26">Authentication Using the Operating System</a>.</p>
</li>
<li>
<p>Password file authentication</p>
<p>The prerequisites for connecting using password file authentication are described in <a href="rcmcnctg.htm#GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D">Authentication Using a Password File</a>.</p>
</li>
</ul>
<p>Neither of these methods requires the database to be open. Operating system authentication is used only to connect locally. Password file authentication can be used to connect locally or remotely.</p>
<div class="infoboxnotealso" id="GUID-BF676275-B5A4-46BE-8CDC-544906C416D2__GUID-EA573EA5-7154-4ED5-8AFC-0CC60546C206">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink ADMIN00102" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=ADMIN00102"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> to learn about database connection options when using SQL*Plus</p>
</li>
<li>
<p><a class="olink DBSEG785" target="_blank" href="../DBSEG/authorization.htm#DBSEG785"><span class="italic">Oracle Database Security Guide</span></a> for details about the <code class="codeph">SYSDBA</code> and <code class="codeph">SYSBACKUP</code> system privileges</p>
</li>
</ul>
</div>
</div>
<a id="BRADV638"></a><a id="BRADV639"></a><a id="BRADV661"></a><a id="BRADV90309"></a>
<div class="props_rev_3"><a id="GUID-703C639F-D05F-4130-8489-02E2BA6F1D26"></a>
<h4 id="BRADV-GUID-703C639F-D05F-4130-8489-02E2BA6F1D26" class="sect4">Authentication Using the Operating System</h4>
<div>
<div class="section">
<p>The following are the prerequisites for connecting to a database using operating system authentication (OS authentication):</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>You must set the <code class="codeph">ORACLE_SID</code> environment variable, specifying the system identifier (SID) for the database.</p>
<p>For example, to set the SID to <code class="codeph">prod</code> in some UNIX shells, you enter:</p>
<pre dir="ltr">% ORACLE_SID=prod; export ORACLE_SID
</pre></li>
<li>
<p>You must be a member of the OSDBA operating system group to connect with the <code class="codeph">SYSDBA</code> privilege or the OSBACKUPDBA operating system group to connect with the <code class="codeph">SYSBACKUP</code> privilege.</p>
<p>On UNIX and Linux, the OSDBA group is typically named <code class="codeph">dba</code>, and the OSBACKUPDBA group is typically named <code class="codeph">backupdba</code>. These names are assigned during database installation.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-703C639F-D05F-4130-8489-02E2BA6F1D26__GUID-AF5076A7-EA39-4DD7-9B20-B49C2F43A924">
<p class="notep1">See Also:</p>
<p><a class="olink ADMIN11053" target="_blank" href="../ADMIN/dba.htm#ADMIN11053"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for a discussion of operating system groups</p>
</div>
<p>The following examples illustrate how to connect to a target database with operating system authentication.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-703C639F-D05F-4130-8489-02E2BA6F1D26__GUID-51A530F9-E2B6-423C-B27A-35909FFB5502">
<p class="titleinexample">Example 4-1 OS Authentication with the SYSDBA Privilege - Explicit</p>
<pre dir="ltr">% rman target &#39;&#34;/ as sysdba&#34;&#39;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-703C639F-D05F-4130-8489-02E2BA6F1D26__GUID-E6DF9A7D-9BA1-4DD0-8A9B-7C6D27602294">
<p class="titleinexample">Example 4-2 OS Authentication with the SYSBACKUP Privilege - Explicit</p>
<pre dir="ltr">% rman target &#39;&#34;/ as sysbackup&#34;&#39;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-703C639F-D05F-4130-8489-02E2BA6F1D26__GUID-40F466F4-7510-4A7B-BDFF-545ADAD1B315">
<p class="titleinexample">Example 4-3 OS Authentication with the SYSDBA Privilege - Implicit</p>
<pre dir="ltr">rman target /
</pre>
<p>If neither <code class="codeph">AS SYSBACKUP</code> nor <code class="codeph">AS SYSDBA</code> is specified in the connection string, then the default used is <code class="codeph">AS SYSDBA</code>.</p>
</div>
<!-- class="example" --></div>
</div>
<a id="BRADV662"></a><a id="BRADV663"></a><a id="BRADV664"></a><a id="BRADV90306"></a>
<div class="props_rev_3"><a id="GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D"></a>
<h4 id="BRADV-GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D" class="sect4">Authentication Using a Password File</h4>
<div>
<div class="section">
<p>If a database uses a <a href="glossary.htm#GUID-AFB3C6E2-4C77-460F-A64D-A980EBF628EB"><span class="xrefglossterm">password file</span></a> to authenticate administrative users, then RMAN can connect using a password. Use a password file for either local or remote access.</p>
<p>The database must use a password file for you to connect remotely using a net service name.</p>
<div class="infobox-note" id="GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D__GUID-DF96C77B-2DE4-4A80-A3D8-8DFF1AD61763">
<p class="notep1">Caution:</p>
<p>Good security practice requires that passwords not be entered in plain text on the command line. Enter passwords in RMAN only when requested by an RMAN prompt. See <a class="olink DBSEG0032" target="_blank" href="../DBSEG/authentication.htm#DBSEG0032"><span class="italic">Oracle Database Security Guide</span></a> to learn about password protection.</p>
</div>
<p>The database creates an entry in the password file when you grant the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege to a user. You can then connect to the target or auxiliary database as this user even if the database is not open.</p>
<p>To support connecting through the password file with the<a id="d18035e719" class="indexterm-anchor"></a> <code class="codeph">SYSBACKUP</code> privilege, the password file must be created in or upgraded to the format for Oracle Database 12<span class="italic">c</span> Release 1 (12.1) or later.</p>
<p>If neither <code class="codeph">AS SYSBACKUP</code> nor <code class="codeph">AS SYSDBA</code> is specified in the connection string, then the default used is <code class="codeph">AS SYSDBA</code>. In this case, no enclosing quotes are required.</p>
<div class="infoboxnotealso" id="GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D__GUID-34DE1A91-6906-4DDE-899F-EB7675F14886">
<p class="notep1">See Also:</p>
<p><a class="olink ADMIN11056" target="_blank" href="../ADMIN/dba.htm#ADMIN11056"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> to learn about password files</p>
</div>
</div>
<!-- class="section" -->
<div class="example" id="GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D__GUID-DE1E5ADD-DDC7-43FD-B624-7DC03E5CDFAE">
<p class="titleinexample">Example 4-4 Password File Authentication as SYSDBA - Explicit</p>
<p>In this example, the <code class="codeph">sdba</code> user has been granted the <code class="codeph">SYSDBA</code> privilege:</p>
<pre dir="ltr">% rman target &#39;&#34;sdba@prod1 as sysdba&#34;&#39; 

target database Password: <span class="italic">password</span>
connected to target database: PROD1 (DBID=39525561)
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D__GUID-AC37F03B-9694-4441-A07C-DBFD69CE0C46">
<p class="titleinexample">Example 4-5 Password File Authentication as SYSBACKUP - Explicit</p>
<p>In this example, the <code class="codeph">sbu</code> user is granted the <code class="codeph">SYSBACKUP</code> privilege in the target database:</p>
<pre dir="ltr">% rman target &#39;&#34;sbu@prod1 as sysbackup&#34;&#39; 

target database Password: <span class="italic">password</span>
connected to target database: PROD1 (DBID=39525561)
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D__GUID-30F46410-1428-470B-8E2D-F3311430D42F">
<p class="titleinexample">Example 4-6 Password File Authentication as SYSDBA - Implicit</p>
<pre dir="ltr">% rman target sbu@prod1

target database Password: <span class="italic">password</span>
connected to target database: PROD1 (DBID=39525561)
</pre></div>
<!-- class="example" --></div>
</div>
</div>
</div>
<a id="BRADV8121"></a>
<div class="props_rev_3"><a id="GUID-92CF0473-8B35-48A8-BA49-4DC52A7ECBC0"></a>
<h2 id="BRADV-GUID-92CF0473-8B35-48A8-BA49-4DC52A7ECBC0" class="sect2">Starting and Exiting RMAN</h2>
<div>
<div class="section">
<p>The RMAN executable is automatically installed with the database and is typically located in the same directory as the other database executables. For example, the RMAN client on Linux is located in <code class="codeph">$ORACLE_HOME/bin</code>. You have the following basic options for starting RMAN:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Start the RMAN executable at the operating system command line without specifying any connection options, as in the following example:</p>
<pre dir="ltr">% rman
</pre>
<p>See <span class="q">&#34;<span><a href="rcmcnctg.htm#GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305">Making Database Connections from the RMAN Prompt</a></span>&#34;</span>.</p>
</li>
<li>
<p>Start the RMAN executable at the operating system command line, as in the following examples:</p>
<pre dir="ltr">% rman TARGET /
% rman TARGET sbu@prod NOCATALOG
</pre>
<p>See <span class="q">&#34;<span><a href="rcmcnctg.htm#GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B">Making RMAN Database Connections from the Operating System Command Line</a></span>&#34;</span>.</p>
</li>
</ul>
<p>To quit RMAN and terminate the program, enter <code class="codeph">EXIT</code> or <code class="codeph">QUIT</code> at the RMAN prompt:</p>
<pre dir="ltr">RMAN&gt; EXIT
</pre>
<div class="infoboxnotealso" id="GUID-92CF0473-8B35-48A8-BA49-4DC52A7ECBC0__GUID-9283C17C-0D6E-407B-B7B7-55E7776BE872">
<p class="notep1">See Also:</p>
<p><span><a class="olink RCMRF111" target="_blank" href="../RCMRF/rcmsynta2011.htm#RCMRF111">Oracle Database Backup and Recovery Reference</a></span> for RMAN command-line syntax</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV8123"></a>
<div class="props_rev_3"><a id="GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C"></a>
<h2 id="BRADV-GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C" class="sect2">Making Database Connections with RMAN</h2>
<div>
<p><a id="d18035e975" class="indexterm-anchor"></a><a id="d18035e981" class="indexterm-anchor"></a>This section explains how to connect the RMAN client to Oracle Database. It contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><span><a href="rcmcnctg.htm#GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305">Making Database Connections from the RMAN Prompt</a></span></p>
</li>
<li>
<p><span><a href="rcmcnctg.htm#GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B">Making RMAN Database Connections from the Operating System Command Line</a></span></p>
</li>
<li>
<p><span><a href="rcmcnctg.htm#GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75">Connecting RMAN to an Auxiliary Database</a></span></p>
</li>
<li>
<p><span><a href="rcmcnctg.htm#GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD">Making RMAN Connections to a CDB</a></span></p>
</li>
<li>
<p><span><a href="rcmcnctg.htm#GUID-243F06D7-4CEC-4472-BA6B-79D8C9EEF07F">Making RMAN Database Connections Within Command Files</a></span></p>
</li>
<li>
<p><span><a href="rcmcnctg.htm#GUID-B7F7CDF4-3F34-4D20-AD36-10E2067DD7C6">Diagnosing RMAN Connection Problems</a></span></p>
</li>
</ul>
</div>
<a id="BRADV564"></a><a id="BRADV666"></a><a id="BRADV667"></a><a id="BRADV668"></a><a id="BRADV669"></a><a id="BRADV89393"></a>
<div class="props_rev_3"><a id="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305"></a>
<h3 id="BRADV-GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305" class="sect3">Making Database Connections from the RMAN Prompt</h3>
<div>
<div class="section">
<p>If you start RMAN without a connect string on the operating system command line, then you must issue a <span><a class="olink RCMRF114" target="_blank" href="../RCMRF/rcmsynta010.htm#RCMRF114"><code class="codeph">CONNECT TARGET</code></a></span> command at the RMAN prompt to connect to a target database.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To make a database connection from the RMAN prompt:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>On the operating system command line, start the RMAN client without making a database connection.</span>
<div>
<pre dir="ltr">% rman
RMAN&gt;
</pre></div>
</li>
<li class="stepexpand"><span>At the RMAN prompt, enter one or more<span><code class="codeph">CONNECT</code></span> commands.</span></li>
</ol>
<div class="example" id="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305__GUID-9A4A3808-0461-4DC2-B2D0-D6E15E2D7FB8">
<p class="titleinexample">Example 4-7 Connecting With OS Authentication - Implicit</p>
<pre dir="ltr">RMAN&gt; connect target /
</pre>
<p>Because no system privilege is specified,<span><code class="codeph">AS</code></span><span><code class="codeph">SYSDBA</code></span> is assumed.</p>
</div>
<!-- class="example" -->
<div class="example" id="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305__GUID-897C3FAD-3098-41AC-98DF-2F460553C3FC">
<p class="titleinexample">Example 4-8 Connecting with OS Authentication - Explicit</p>
<pre dir="ltr">RMAN&gt; connect target &#34;/ as sysdba&#34;
</pre>
<p>When including a system privilege, the enclosing quotation marks (single or double) are required.</p>
</div>
<!-- class="example" -->
<div class="example" id="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305__GUID-C868A577-6A88-42E3-A4E1-DEA3416EC1CC">
<p class="titleinexample">Example 4-9 Connecting with Password File Authentication</p>
<pre dir="ltr">RMAN&gt; connect target &#34;sbu@prod AS SYSBACKUP&#34;

target database Password: password
connected to target database: PROD (DBID=39525561)
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305__GUID-6BDE5844-E75F-465C-B068-3645DBAA2F40">
<p class="titleinexample">Example 4-10 Connecting to Target and a Recovery Catalog</p>
<p>In this example, the target connection uses operating system authentication, and the recovery catalog database connection uses a net service name and password file authentication. The recovery catalog owner is user <span><code class="codeph">rco</code></span>. RMAN prompts for the password of the recovery catalog user.</p>
<pre dir="ltr">RMAN&gt; connect target /
RMAN&gt; connect catalog rco@catdb

recovery catalog database Password: password
connected to recovery catalog database
</pre></div>
<!-- class="example" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305__GUID-64D3E2BC-1157-4B18-A852-4F36D6C6C4EF">
<p class="notep1">See Also:</p>
<p><span><a class="olink RCMRF114" target="_blank" href="../RCMRF/rcmsynta010.htm#RCMRF114">Oracle Database Backup and Recovery Reference</a></span> to learn about the <span><code class="codeph">CONNECT</code></span> command</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV153"></a><a id="BRADV563"></a><a id="BRADV155"></a><a id="BRADV89392"></a>
<div class="props_rev_3"><a id="GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B"></a>
<h3 id="BRADV-GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B" class="sect3">Making RMAN Database Connections from the Operating System Command Line</h3>
<div>
<div class="section">
<p>To connect to a target database from the operating system command line, enter the <code class="codeph">rman</code> command followed by the connection information. You can begin executing commands after the RMAN prompt is displayed.</p>
<p>Use the <code class="codeph">CATALOG</code> keyword to connect to a recovery catalog. You can also start RMAN without specifying <code class="codeph">NOCATALOG</code> or <code class="codeph">CATALOG</code>. If you do not specify <code class="codeph">NOCATALOG</code> on the command line, and if you do not specify <a class="olink RCMRF114" target="_blank" href="../RCMRF/rcmsynta010.htm#RCMRF114"><code class="codeph">CONNECT CATALOG</code></a> after RMAN has started, then RMAN defaults to <code class="codeph">NOCATALOG</code> mode the first time that you run a command that requires the use of the RMAN repository.</p>
<div class="infobox-note" id="GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B__GUID-74F8AC49-CE11-4835-89D5-EB5B6B9692A8">
<p class="notep1">Note:</p>
<p>After you have executed a command that uses the RMAN repository in <code class="codeph">NOCATALOG</code> mode, you must exit and restart RMAN to be able to connect to a recovery catalog.</p>
</div>
<p>If you connect to the target database on the operating system command line, then you can begin executing commands after the RMAN prompt is displayed.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B__CHDHAFFI">
<p class="titleinexample">Example 4-11 Connecting to a Target Database from the System Prompt</p>
<p>This example illustrates a connection to a target database that uses operating system authentication. The <code class="codeph">NOCATALOG</code> option indicates that a recovery catalog is not used in the session.</p>
<pre dir="ltr">% rman TARGET / NOCATALOG

connected to target database: PROD (DBID=39525561)
using target database control file instead of recovery catalog
 
RMAN&gt;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B__CHDIGBFC">
<p class="titleinexample">Example 4-12 Connecting to a Target Database from the System Prompt by Using Net Service Names</p>
<p>This example illustrates a connection to a target database that uses a net service name and password file authentication. RMAN prompts for the password.</p>
<pre dir="ltr">% rman TARGET sbu@prod NOCATALOG

target database Password: <span class="italic">password</span>
connected to target database: PROD (DBID=39525561)

RMAN&gt;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B__BABJAFDA">
<p class="titleinexample">Example 4-13 Connecting to Target and a Recovery Catalog from the System Prompt</p>
<p>This example illustrates a connection that uses Oracle Net authentication for the target and recovery catalog databases. In both cases RMAN prompts for a password.</p>
<pre dir="ltr">% rman TARGET sbu@prod CATALOG rco@catdb

target database Password: <span class="italic">password</span>
connected to target database: PROD (DBID=39525561)
recovery catalog database Password: <span class="italic">password</span>
connected to recovery catalog database

RMAN&gt;
</pre></div>
<!-- class="example" --></div>
</div>
<a id="BRADV565"></a><a id="BRADV670"></a><a id="BRADV128"></a>
<div class="props_rev_3"><a id="GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75"></a>
<h3 id="BRADV-GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75" class="sect3">Connecting RMAN to an Auxiliary Database</h3>
<div>
<div class="section">
<p><a id="d18035e1387" class="indexterm-anchor"></a><a id="d18035e1393" class="indexterm-anchor"></a>To use the <span><a class="olink RCMRF126" target="_blank" href="../RCMRF/rcmsynta020.htm#RCMRF126"><code class="codeph">DUPLICATE</code></a></span> command, you must connect to an <span><a href="glossary.htm#GUID-4B8BBEA0-2F0F-4C5E-AE69-F1EE4DBA1B46"><span class="xrefglossterm">auxiliary instance</span></a></span>. To perform RMAN <span><a href="glossary.htm#GUID-8A257409-B3DC-41FD-A2AF-D47560FF9F18"><span class="xrefglossterm">tablespace point-in-time recovery (TSPITR)</span></a></span>, you may also need to connect to an auxiliary instance.</p>
<div class="infobox-note" id="GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75__GUID-B547AB32-C47E-4F95-A2D2-52C0371A79FA">
<p class="notep1">Note:</p>
<p>When you use the <code class="codeph">DUPLICATE ... FROM ACTIVE DATABASE</code> command, a net service name is required. See <span class="q">&#34;<span><a href="rcmdupdb.htm#GUID-CFB68ABE-BE7D-4F88-897D-7D07BA46EBCA">Step 7: Creating an Initialization Parameter File and Starting the Auxiliary Instance</a></span>&#34;</span> for more details.<a id="d18035e1428" class="indexterm-anchor"></a><a id="d18035e1430" class="indexterm-anchor"></a></p>
</div>
<p><a id="d18035e1435" class="indexterm-anchor"></a>The form of an auxiliary connection is identical to a target database connection, except that you use the <code class="codeph">AUXILIARY</code> keyword instead of the <code class="codeph">TARGET</code> keyword.</p>
<div class="infoboxnotealso" id="GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75__GUID-3DFB19B7-3BD7-4AA5-B1B9-0953800D5575">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span><a href="rcmdupdb.htm#GUID-94E3F324-33F7-451E-83E1-18523E916CD3" title="RMAN enables you to duplicate PDBs with the DUPLICATE command. You can duplicate a single PDB, a set of PDBs, or a set of tablespaces within a PDB. This example shows how to use a script to automate the process of duplicating a target database.">Duplicating a Database</a></span> for more details on using the<span><a class="olink RCMRF126" target="_blank" href="../RCMRF/rcmsynta020.htm#RCMRF126"><code class="codeph">DUPLICATE</code></a></span> command</p>
</li>
<li>
<p><span><a href="rcmtspit.htm#GUID-CAACDB53-7C3A-45B4-8249-C5D855D47571">Performing RMAN Tablespace Point-in-Time Recovery (TSPITR)</a></span> for more details on performing TSPITR</p>
</li>
</ul>
</div>
</div>
<!-- class="section" -->
<div class="example" id="GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75__BABIABJA">
<p class="titleinexample">Example 4-14 Connecting to Target and Auxiliary Databases from the RMAN Prompt</p>
<p>This example illustrates a connection to a target database using operating system authentication, and the auxiliary database connection uses a net service name and password file authentication.</p>
<pre dir="ltr">% rman
RMAN&gt; CONNECT TARGET /
RMAN&gt; CONNECT AUXILIARY sbu@aux

auxiliary database Password: <span class="italic">password</span>
connected to auxiliary database: AUX (DBID=30472568)
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75__CEGHDGEE">
<p class="titleinexample">Example 4-15 Connecting to Target and Auxiliary Databases from the System Prompt</p>
<p>This example illustrates a connection to a target database and an auxiliary database from the system prompt. The target connection uses operating system authentication and the auxiliary connection uses a net service name and password file authentication.</p>
<pre dir="ltr">% rman target / auxiliary sbu@aux

auxiliary database Password: <span class="italic">password</span>
connected to auxiliary database: AUX (DBID=30472568)
</pre></div>
<!-- class="example" --></div>
</div>
<a id="BRADV671"></a>
<div class="props_rev_3"><a id="GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD"></a>
<h3 id="BRADV-GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD" class="sect3">Making RMAN Connections to a CDB</h3>
<div>
<p>This section describes how to connect the RMAN client to multitenant container databases (<a href="glossary.htm#GUID-3D253996-C2C0-449A-AFA2-85A9DA323FD3"><span class="xrefglossterm">CDB</span></a>s) and pluggable databases (<a href="glossary.htm#GUID-993BFB3F-3305-481C-999D-26132095DEC9"><span class="xrefglossterm">PDB</span></a>s). It contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmcnctg.htm#GUID-01DF892F-FED5-4ADE-9152-9C3CF0921DBA">About Performing Operations on CDBs and PDBs</a></p>
</li>
<li>
<p><a href="rcmcnctg.htm#GUID-7CB295E4-C934-4C87-A08E-7E502C8AD9AA">Restrictions When Connected to a PDB</a></p>
</li>
<li>
<p><a href="rcmcnctg.htm#GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D">Connecting as Target to the Root</a></p>
</li>
<li>
<p><a href="rcmcnctg.htm#GUID-E95C5C27-C036-4773-B77C-E4120526F422">Connecting as Target to a PDB</a></p>
</li>
</ul>
</div>
<a id="BRADV672"></a>
<div class="props_rev_3"><a id="GUID-01DF892F-FED5-4ADE-9152-9C3CF0921DBA"></a>
<h4 id="BRADV-GUID-01DF892F-FED5-4ADE-9152-9C3CF0921DBA" class="sect4">About Performing Operations on CDBs and PDBs</h4>
<div>
<p>You can perform RMAN operations on a whole CDB, the <a href="glossary.htm#GUID-EA3DB8F4-F68E-4FC5-A599-32A4886FFF8A"><span class="xrefglossterm">root</span></a> only, or one or more PDBs. You make RMAN connections to CDBs according to the following rules:</p>
<ul style="list-style-type: disc;">
<li>
<p>To perform operations on the whole CDB (for example, to back up the whole CDB) you connect as target to the root.</p>
</li>
<li>
<p>To perform operations on the root only (for example, to back up the root) you connect as target to the root.</p>
</li>
<li>
<p>To perform operations on a single PDB, you can connect as target either to the root or directly to the PDB.</p>
<ul style="list-style-type: disc;">
<li>
<p>If you connect to the root, you must use the <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> syntax in your RMAN commands. For example, to back up a PDB, you use the <code class="codeph">BACKUP</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code> command.</p>
</li>
<li>
<p>If instead you connect directly to a PDB, you can use the same commands that you would use when connecting to a <a href="glossary.htm#GUID-62A96A52-3B97-455A-A443-75B999DCAC94"><span class="xrefglossterm">non-CDB</span></a>. For example, to back up a PDB, you would use the <code class="codeph">BACKUP</code> <code class="codeph">DATABASE</code> command.</p>
</li>
</ul>
</li>
<li>
<p>To perform operations on two or more PDBs with a single command, you connect as target to the root.</p>
<p>For example, to back up both the <code class="codeph">sales</code> and <code class="codeph">hr</code> PDBs, you connect to the root and submit the following command:</p>
<pre dir="ltr">BACKUP PLUGGABLE DATABASE sales, hr;
</pre></li>
</ul>
<div class="infobox-note" id="GUID-01DF892F-FED5-4ADE-9152-9C3CF0921DBA__GUID-E1777870-69B4-4B2B-AE2C-FA5A1FC95E35">
<p class="notep1">Note:</p>
<p>If you connect as target to a CDB with operating system authentication, you are connected to the root.</p>
</div>
</div>
</div>
<a id="BRADV673"></a>
<div class="props_rev_3"><a id="GUID-7CB295E4-C934-4C87-A08E-7E502C8AD9AA"></a>
<h4 id="BRADV-GUID-7CB295E4-C934-4C87-A08E-7E502C8AD9AA" class="sect4">Restrictions When Connected to a PDB</h4>
<div>
<p>The following operations are not available when you connect as target directly to a PDB:</p>
<ul style="list-style-type: disc;">
<li>
<p>Back up archived logs</p>
</li>
<li>
<p>Delete archived logs</p>
</li>
<li>
<p>Delete archived log backups</p>
</li>
<li>
<p>Restore archived logs (RMAN does restore archived logs when required during media recovery.)</p>
</li>
<li>
<p>Point-in-time recovery (PITR)</p>
</li>
<li>
<p>TSPITR</p>
</li>
<li>
<p>Table recovery</p>
</li>
<li>
<p>Duplicate database</p>
</li>
<li>
<p>Flashback operations</p>
</li>
<li>
<p>Running Data Recovery Advisor</p>
</li>
<li>
<p>Report/delete obsolete</p>
</li>
<li>
<p>Register database</p>
</li>
<li>
<p>Import catalog</p>
</li>
<li>
<p>Reset database</p>
</li>
<li>
<p>Configuring the RMAN environment (using the <code class="codeph">CONFIGURE</code> command)</p>
</li>
</ul>
<div class="infobox-note" id="GUID-7CB295E4-C934-4C87-A08E-7E502C8AD9AA__GUID-AA473940-CB22-462F-A592-5A6C157FEEEE">
<p class="notep1">Note:</p>
<p>When you connect as <code class="codeph">TARGET</code> to a PDB, you cannot connect to a recovery catalog.</p>
</div>
</div>
</div>
<a id="BRADV675"></a><a id="BRADV676"></a><a id="BRADV677"></a><a id="BRADV674"></a>
<div class="props_rev_3"><a id="GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D"></a>
<h4 id="BRADV-GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D" class="sect4">Connecting as Target to the Root</h4>
<div>
<div class="section">
<p>There are several ways to connect as target to the root. The three most common ways are as follows:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Connecting locally as a common user, as shown in <a href="rcmcnctg.htm#GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D__CEGDEDBA">Example 4-16</a></p>
</li>
<li>
<p>Connecting with operating system authentication, as shown in <a href="rcmcnctg.htm#GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D__CEGEEBBD">Example 4-17</a></p>
</li>
<li>
<p>Connecting as a common user through Oracle Net Services, using a net service name, as shown in <a href="rcmcnctg.htm#GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D__CEGGHBDB">Example 4-18</a></p>
</li>
</ul>
<p>In all cases, you must connect as a user with the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D__CEGDEDBA">
<p class="titleinexample">Example 4-16 Connecting Locally to the Root</p>
<p>This example connects locally to the root using the <code class="codeph">SYS</code> user, which is a common user. The connection is established using the <code class="codeph">SYSDBA</code> privilege.</p>
<pre dir="ltr">rman target sys

target database Password: <span class="italic">password</span>
connected to target database: CDB (DBID=659628168)
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D__CEGEEBBD">
<p class="titleinexample">Example 4-17 Connecting to the Root with Operating System Authentication</p>
<p>This example connects locally to the root using operating system authentication. The connection is established as the <code class="codeph">SYS</code> user with <code class="codeph">SYSDBA</code> privilege.</p>
<pre dir="ltr">rman target /
 
connected to target database: CDB (DBID=659628168)
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D__CEGGHBDB">
<p class="titleinexample">Example 4-18 Connecting to the Root with a Net Service Name</p>
<p>This example assumes that there is a <code class="codeph">sales</code> net service name that resolves to a database service for the root, and that there is a common user named <code class="codeph">c##bkuser</code> that has the <code class="codeph">SYSBACKUP</code> privilege.</p>
<pre dir="ltr">rman target c##bkuser@sales
 
target database Password: <span class="italic">password</span>
connected to target database: CDB (DBID=659628168)
</pre></div>
<!-- class="example" --></div>
</div>
<a id="BRADV701"></a><a id="BRADV678"></a>
<div class="props_rev_3"><a id="GUID-E95C5C27-C036-4773-B77C-E4120526F422"></a>
<h4 id="BRADV-GUID-E95C5C27-C036-4773-B77C-E4120526F422" class="sect4">Connecting as Target to a PDB</h4>
<div>
<div class="section">
<p>To connect as target to a PDB, you must:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Connect with a net service name that resolves to a database service for that PDB.</p>
</li>
<li>
<p>Connect as a <a href="glossary.htm#GUID-43EA1A4C-E5EB-4926-99EC-1DDA0E74A07C"><span class="xrefglossterm">local user</span></a> or <a href="glossary.htm#GUID-2B102186-15BD-443C-B375-8CB0D442CF5F"><span class="xrefglossterm">common user</span></a> with the <code class="codeph">SYSDBA</code> privilege.</p>
</li>
</ul>
<p><a href="rcmcnctg.htm#GUID-E95C5C27-C036-4773-B77C-E4120526F422__CEGDIEHF">Example 4-19</a> illustrates a connection to a PDB. It assumes the following</p>
<ul style="list-style-type: disc;">
<li>
<p>You want to perform RMAN operations on a PDB named <code class="codeph">hrpdb</code>.</p>
</li>
<li>
<p>The net service name <code class="codeph">hrpdb</code> resolves to a database service for the <code class="codeph">hrpdb</code> PDB.</p>
</li>
<li>
<p>The local user <code class="codeph">hrbkup</code> was created in the <code class="codeph">hrpdb</code> PDB and granted the <code class="codeph">SYSDBA</code> privilege.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="example" id="GUID-E95C5C27-C036-4773-B77C-E4120526F422__CEGDIEHF">
<p class="titleinexample">Example 4-19 Connecting As Target to a PDB</p>
<pre dir="ltr">rman target hrbkup@hrpdb
 
target database Password: <span class="italic">password</span>
connected to target database: CDB (DBID=659628168)
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<a id="BRADV129"></a>
<div class="props_rev_3"><a id="GUID-243F06D7-4CEC-4472-BA6B-79D8C9EEF07F"></a>
<h3 id="BRADV-GUID-243F06D7-4CEC-4472-BA6B-79D8C9EEF07F" class="sect3">Making RMAN Database Connections Within Command Files</h3>
<div>
<div class="section">
<p><a id="d18035e2250" class="indexterm-anchor"></a><a id="d18035e2254" class="indexterm-anchor"></a><a id="d18035e2260" class="indexterm-anchor"></a>If you create an RMAN command file that uses a <a class="olink RCMRF114" target="_blank" href="../RCMRF/rcmsynta010.htm#RCMRF114"><code class="codeph">CONNECT</code></a> command with database level credentials (user name and password), then anyone with read access to this file can learn the password. There is no secure way to incorporate a <code class="codeph">CONNECT</code> string with a password into a command file.</p>
<p>If you create an RMAN command file that uses a <code class="codeph">CONNECT</code> command, then RMAN does not echo the connect string when you run the command file with the <a class="olink RCMRF100" target="_blank" href="../RCMRF/rcmsynta001.htm#RCMRF100"><code class="codeph">@</code></a> command. This behavior prevents connect strings from appearing in any log files that contain RMAN output. For example, suppose that you create a command file <code class="codeph">listbkup.rman</code> as follows:</p>
<pre dir="ltr">cat &gt; listbkup.rman &lt;&lt; EOF
CONNECT TARGET /
LIST BACKUP;
EOF
</pre>
<p>You execute this script by running RMAN with the <code class="codeph">@</code> command line option as follows:</p>
<pre dir="ltr">% rman @listbkup.rman
</pre>
<p>When the command file executes, RMAN replaces the connection string with an asterisk, as shown in the following output:</p>
<pre dir="ltr">RMAN&gt; CONNECT TARGET *
2&gt; LIST BACKUP;
3&gt;
connected to target database: RDBMS (DBID=771530996)

using target database control file instead of recovery catalog

List of Backup Sets
===================
. . .
</pre></div>
<!-- class="section" --></div>
</div>
<a id="BRADV89394"></a>
<div class="props_rev_3"><a id="GUID-B7F7CDF4-3F34-4D20-AD36-10E2067DD7C6"></a>
<h3 id="BRADV-GUID-B7F7CDF4-3F34-4D20-AD36-10E2067DD7C6" class="sect3">Diagnosing RMAN Connection Problems</h3>
<div>
<p>When you are diagnosing errors that RMAN encounters in connecting to the target, catalog and auxiliary databases, consider using SQL*Plus to connect to the databases directly. This action can reveal underlying problems with the connection information or the databases.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmcnctg.htm#GUID-E7230A40-996A-4D20-86E8-C636F85DA98E">Diagnosing Target and Auxiliary Database Connection Problems</a></p>
</li>
<li>
<p><a href="rcmcnctg.htm#GUID-88350C4F-36B9-4B8C-8F53-6320A6E7036B">Diagnosing Recovery Catalog Connection Problems</a></p>
</li>
</ul>
</div>
<a id="BRADV89395"></a>
<div class="props_rev_3"><a id="GUID-E7230A40-996A-4D20-86E8-C636F85DA98E"></a>
<h4 id="BRADV-GUID-E7230A40-996A-4D20-86E8-C636F85DA98E" class="sect4">Diagnosing Target and Auxiliary Database Connection Problems</h4>
<div>
<div class="section">
<p>RMAN connects to target and auxiliary databases using the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege. Thus, when you use SQL*Plus to diagnose connection problems to the target or auxiliary databases, request a <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> connection to reproduce RMAN behavior.</p>
<p>For example, suppose that the following RMAN command encountered connection errors:</p>
<pre dir="ltr">RMAN&gt; CONNECT TARGET /
</pre>
<p>You reproduce the preceding connection attempt with the SQL*Plus command as follows:</p>
<pre dir="ltr">SQL&gt; CONNECT / AS SYSBACKUP
</pre></div>
<!-- class="section" --></div>
</div>
<a id="BRADV89396"></a>
<div class="props_rev_3"><a id="GUID-88350C4F-36B9-4B8C-8F53-6320A6E7036B"></a>
<h4 id="BRADV-GUID-88350C4F-36B9-4B8C-8F53-6320A6E7036B" class="sect4">Diagnosing Recovery Catalog Connection Problems</h4>
<div>
<div class="section">
<p>When RMAN connects to the recovery catalog database, it does not use the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege. When you use SQL*Plus to diagnose connection problems to the recovery catalog database, you must enter the database connect string exactly as it was entered into RMAN. Do not specify <code class="codeph">AS SYSBACKUP</code> or <code class="codeph">AS SYSDBA</code>.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<a id="BRADV89382"></a>
<div class="props_rev_3"><a id="GUID-507D61EC-3D28-4C67-8013-BE724AD89FFD"></a>
<h2 id="BRADV-GUID-507D61EC-3D28-4C67-8013-BE724AD89FFD" class="sect2">Specifying the Location of RMAN Output</h2>
<div>
<div class="section">
<p>By default, RMAN writes command output to standard output. To redirect output to a log file, enter the <code class="codeph">LOG</code> parameter on the command line when you start RMAN, as in the following example:</p>
<pre dir="ltr">% rman LOG /tmp/rman.log
</pre>
<p>In this case, RMAN displays command input but does not display the RMAN output. The easiest way to send RMAN output both to a log file and to standard output is to use the Linux <code class="codeph">tee</code> command or its equivalent. For example, the following technique enables both input and output to be visible in the RMAN command-line interface:</p>
<pre dir="ltr">% rman | tee rman.log
RMAN&gt;
</pre>
<div class="infoboxnotealso" id="GUID-507D61EC-3D28-4C67-8013-BE724AD89FFD__GUID-06B4D6E7-E0B0-4B1F-803E-D8E42DFEA7B3">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF111" target="_blank" href="../RCMRF/rcmsynta2011.htm#RCMRF111"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> to learn about RMAN command-line options</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV8122"></a>
<div class="props_rev_3"><a id="GUID-F600535A-D46A-4BB1-88FD-266396ECE795"></a>
<h2 id="BRADV-GUID-F600535A-D46A-4BB1-88FD-266396ECE795" class="sect2">Setting Globalization Support Environment Variables for RMAN</h2>
<div>
<div class="section">
<p><a id="d18035e2719" class="indexterm-anchor"></a><a id="d18035e2723" class="indexterm-anchor"></a><a id="d18035e2727" class="indexterm-anchor"></a><a id="d18035e2731" class="indexterm-anchor"></a><a id="d18035e2735" class="indexterm-anchor"></a><a id="d18035e2737" class="indexterm-anchor"></a>Before invoking RMAN, it may be useful to set the <code class="codeph">NLS_DATE_FORMAT</code> and <code class="codeph">NLS_LANG</code> environment variables. These variables determine the format used for the time parameters in RMAN commands such as <a class="olink RCMRF149" target="_blank" href="../RCMRF/rcmsynta2008.htm#RCMRF149"><code class="codeph">RESTORE</code></a>, <a class="olink RCMRF140" target="_blank" href="../RCMRF/rcmsynta2001.htm#RCMRF140"><code class="codeph">RECOVER</code></a>, and <a class="olink RCMRF147" target="_blank" href="../RCMRF/rcmsynta2006.htm#RCMRF147"><code class="codeph">REPORT</code></a>.</p>
<p>The following example shows typical language and date format settings:</p>
<pre dir="ltr">NLS_LANG=american
NLS_DATE_FORMAT=&#39;Mon DD YYYY HH24:MI:SS&#39;
</pre>
<p><a id="d18035e2767" class="indexterm-anchor"></a><a id="d18035e2771" class="indexterm-anchor"></a>If you are going to use RMAN to connect to an unmounted database and mount the database later while RMAN is still connected, then set the <code class="codeph">NLS_LANG</code> environment variable so that it also specifies the character set used by the database.</p>
<p>A database that is not mounted assumes the default character set, which is <code class="codeph">US7ASCII</code>. If your character set is different from the default, then RMAN returns errors after the database is mounted. For example, if the character set is <code class="codeph">WE8DEC</code>, then to avoid errors, you can set the <code class="codeph">NLS_LANG</code> variable as follows:</p>
<pre dir="ltr">NLS_LANG=american_america.we8dec
</pre>
<p>For the environment variable <a class="olink REFRN10119" target="_blank" href="../REFRN/GUID-FC23EEEE-AA9F-4B3C-8CBB-888C9C0CA27F.htm#REFRN10119"><code class="codeph">NLS_DATE_FORMAT</code></a> to be applied and override the defaults set for the server in the server initialization file, the environment variable <code class="codeph">NLS_LANG</code> must also be set.</p>
<div class="infoboxnotealso" id="GUID-F600535A-D46A-4BB1-88FD-266396ECE795__GUID-DBEF3432-12AB-4B27-93DF-BE054C10D710">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink REFRN" target="_blank" href="../REFRN/toc.htm"><span class="italic">Oracle Database Reference</span></a> for more information about the <code class="codeph">NLS_LANG</code> and <code class="codeph">NLS_DATE_FORMAT</code> parameters</p>
</li>
<li>
<p><a class="olink NLSPG" target="_blank" href="../NLSPG/toc.htm"><span class="italic">Oracle Database Globalization Support Guide</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV89383"></a>
<div class="props_rev_3"><a id="GUID-D7BEDDA1-26CF-47E0-B55F-85E3CA238ECA"></a>
<h2 id="BRADV-GUID-D7BEDDA1-26CF-47E0-B55F-85E3CA238ECA" class="sect2">Entering RMAN Commands</h2>
<div>
<p>You can enter RMAN commands either directly from the RMAN prompt or read them in from a text file.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmcnctg.htm#GUID-924C370B-C300-4FCF-A164-45EF1AAC4AE4">Entering RMAN Commands at the RMAN Prompt</a></p>
</li>
<li>
<p><a href="rcmcnctg.htm#GUID-5FF51A4E-BC27-41A9-AA83-FF6E761C2535">Using Command Files with RMAN</a></p>
</li>
<li>
<p><a href="rcmcnctg.htm#GUID-95DBA7A2-8D4F-428D-8ABC-A104FC064ABC">Entering Comments in RMAN Command Files</a></p>
</li>
<li>
<p><a href="rcmcnctg.htm#GUID-A9321B2D-6CFF-4616-B629-67960A8F87DD">Using Substitution Variables in Command Files</a></p>
</li>
<li>
<p><a href="rcmcnctg.htm#GUID-86BB8661-9779-4057-93A5-1ADC09C896CE">Checking RMAN Syntax</a></p>
</li>
</ul>
</div>
<a id="BRADV89384"></a>
<div class="props_rev_3"><a id="GUID-924C370B-C300-4FCF-A164-45EF1AAC4AE4"></a>
<h3 id="BRADV-GUID-924C370B-C300-4FCF-A164-45EF1AAC4AE4" class="sect3">Entering RMAN Commands at the RMAN Prompt</h3>
<div>
<div class="section">
<p>When the RMAN client is ready for your commands, it displays the command prompt, as in this example:</p>
<pre dir="ltr">RMAN&gt; 
</pre>
<p>Enter commands for RMAN to execute. For example:</p>
<pre dir="ltr">RMAN&gt; CONNECT TARGET
RMAN&gt; BACKUP DATABASE;
</pre>
<p>Most RMAN commands take several parameters and must end with a semicolon. Some commands, such as <a class="olink RCMRF158" target="_blank" href="../RCMRF/rcmsynta2020.htm#RCMRF158"><code class="codeph">STARTUP</code></a>, <a class="olink RCMRF155" target="_blank" href="../RCMRF/rcmsynta2016.htm#RCMRF155"><code class="codeph">SHUTDOWN</code></a>, and <a class="olink RCMRF114" target="_blank" href="../RCMRF/rcmsynta010.htm#RCMRF114"><code class="codeph">CONNECT</code></a>, can be used with or without a semicolon.</p>
<p>When you enter a line of text that is not a complete command, RMAN prompts for continuation input with a line number. For example:</p>
<pre dir="ltr">RMAN&gt; BACKUP DATABASE
2&gt; INCLUDE CURRENT 
3&gt; CONTROLFILE
4&gt; ;
</pre></div>
<!-- class="section" --></div>
</div>
<a id="BRADV89385"></a>
<div class="props_rev_3"><a id="GUID-5FF51A4E-BC27-41A9-AA83-FF6E761C2535"></a>
<h3 id="BRADV-GUID-5FF51A4E-BC27-41A9-AA83-FF6E761C2535" class="sect3">Using Command Files with RMAN</h3>
<div>
<div class="section">
<p>For repetitive tasks, you can create a text file containing RMAN commands, and start the RMAN client with the <code class="codeph">@</code> argument, followed by a file name. For example, create a text file <code class="codeph">cmdfile1</code> in the current directory containing one line of text as shown here:</p>
<pre dir="ltr">BACKUP DATABASE PLUS ARCHIVELOG;
</pre>
<p>You can run this command file from the command line as shown in this example, and the command contained in it is executed:</p>
<pre dir="ltr">% rman TARGET / @cmdfile1
</pre>
<p>After the command completes, RMAN exits.</p>
<p>You can also use the <a class="olink RCMRF100" target="_blank" href="../RCMRF/rcmsynta001.htm#RCMRF100"><code class="codeph">@</code></a> command at the RMAN command prompt to execute the contents of a command file during an <a href="glossary.htm#GUID-01D29658-41E1-4D45-9C7F-A761D56885B9"><span class="xrefglossterm">RMAN session</span></a>. RMAN reads the file and executes the commands in it. For example:</p>
<pre dir="ltr">RMAN&gt; @cmdfile1
</pre>
<p>After the command file contents have been executed, RMAN displays the following message:</p>
<pre dir="ltr">RMAN&gt;  **end-of-file**
</pre>
<p>Unlike the case where a command file is executed from the operating system command line, RMAN does not exit.</p>
<div class="infoboxnotealso" id="GUID-5FF51A4E-BC27-41A9-AA83-FF6E761C2535__GUID-0EC863A4-0B8F-4A64-BE86-31E7B9FDFE78">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF111" target="_blank" href="../RCMRF/rcmsynta2011.htm#RCMRF111"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for RMAN command-line syntax</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV99960"></a>
<div class="props_rev_3"><a id="GUID-95DBA7A2-8D4F-428D-8ABC-A104FC064ABC"></a>
<h3 id="BRADV-GUID-95DBA7A2-8D4F-428D-8ABC-A104FC064ABC" class="sect3">Entering Comments in RMAN Command Files</h3>
<div>
<div class="section">
<p><a id="d18035e3202" class="indexterm-anchor"></a>The comment character in RMAN is a pound sign (<code class="codeph">#</code>). All text from the pound sign to the end of the line is ignored. For example, the contents of the following command file back up the database and archived redo log files and include comments:</p>
<pre dir="ltr"># Command file name: mybackup.rman
# The following command backs up the database
BACKUP DATABASE;
# The following command backs up the archived redo logs
BACKUP ARCHIVELOG ALL;
</pre>
<p>The following example shows how you can break a single RMAN command across multiple lines:</p>
<pre dir="ltr">RMAN&gt; BACKUP # this is a comment
2&gt; SPFILE;
</pre></div>
<!-- class="section" --></div>
</div>
<a id="BRADV561"></a><a id="BRADV89386"></a>
<div class="props_rev_3"><a id="GUID-A9321B2D-6CFF-4616-B629-67960A8F87DD"></a>
<h3 id="BRADV-GUID-A9321B2D-6CFF-4616-B629-67960A8F87DD" class="sect3">Using Substitution Variables in Command Files</h3>
<div>
<div class="section">
<p>When running a command file, you can specify one or more values in a <code class="codeph">USING</code> clause for use in substitution variables in a command file. In this way, you can make your command files dynamic.</p>
<p>As in SQL*Plus, <code class="codeph">&amp;1</code> indicates where to place the first value, <code class="codeph">&amp;2</code> where to place the second value, and so on. The substitution variable syntax is <code class="codeph">&amp;</code><span class="italic"><code class="codeph">integer</code></span> followed by an optional period, for example, <code class="codeph">&amp;1.3</code>. The optional period is part of the variable and replaced with the value, thus enabling the substitution text to be immediately followed by another integer. For example, if you pass the value <code class="codeph">mybackup</code> to a command file containing the variable <code class="codeph">&amp;1.3</code>, then the result of the substitution is <code class="codeph">mybackup3</code>.</p>
<p>The following procedure explains how to create and use a dynamic shell script that calls a command file containing substitution variables.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To create and use a dynamic shell script:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Create an RMAN command file that uses substitution variables.</span>
<div>
<p>The following example shows the contents of a command file named <code class="codeph">quarterly_backup.cmd</code>, which is run every quarter. The script uses substitution variables for the name of the tape set, for a string in the <code class="codeph">FORMAT</code> specification, and for the name of the restore point to be created.</p>
<pre dir="ltr"># quarterly_backup.cmd
CONNECT TARGET /
RUN
{
  ALLOCATE CHANNEL c1
    DEVICE TYPE sbt
    PARMS &#39;ENV=(OB_MEDIA_FAMILY=&amp;1)&#39;;
  BACKUP DATABASE 
    TAG &amp;2 
    FORMAT &#39;/disk2/bck/&amp;1%U.bck&#39;
    KEEP FOREVER 
    RESTORE POINT &amp;3;
}
EXIT;
</pre></div>
</li>
<li class="stepexpand"><span>Create a shell script that you can use to run the RMAN command file created in the previous step.</span>
<div>
<p>The following example creates a shell script named <code class="codeph">runbackup.sh</code>. The example creates shell variables for the format and restore point name and accepts the values for these variables as command-line arguments to the script.</p>
<pre dir="ltr">#!/bin/tcsh
# name: runbackup.sh
# usage: use the tag name and number of copies as arguments
set media_family = $argv[1]
set format = $argv[2]set restore_point = $argv[3]
rman @&#39;/disk1/scripts/quarterly_backup.cmd&#39; USING $media_family $format $restore_point
</pre></div>
</li>
<li class="stepexpand"><span>Execute the shell script created in the previous step, specifying the desired arguments on the command line.</span>
<div>
<p>The following example runs the <code class="codeph">runbackup.sh</code> shell script and passes it <code class="codeph">archival_backup</code> as the media family name, <code class="codeph">bck0906</code> as the format string, and <code class="codeph">FY06Q3</code> as the restore point name.</p>
<pre dir="ltr">% runbackup.sh archival_backup bck0906 FY06Q3
</pre></div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-A9321B2D-6CFF-4616-B629-67960A8F87DD__GUID-AD3A08A6-E27C-4CF1-B619-696C0121BD52">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF100" target="_blank" href="../RCMRF/rcmsynta001.htm#RCMRF100"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">@</code> syntax</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV89387"></a>
<div class="props_rev_3"><a id="GUID-86BB8661-9779-4057-93A5-1ADC09C896CE"></a>
<h3 id="BRADV-GUID-86BB8661-9779-4057-93A5-1ADC09C896CE" class="sect3">Checking RMAN Syntax</h3>
<div>
<p>You may want to test RMAN commands for syntactic correctness without executing them. Use the command-line argument <span><code class="codeph">CHECKSYNTAX</code></span> to start the RMAN client in a mode in which it only parses the commands that you enter and returns an <code class="codeph">RMAN-00558</code> error for commands that are not legal RMAN syntax.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><span><a href="rcmcnctg.htm#GUID-E7549936-0286-46EC-A6B2-EAC3B538AE19">Checking RMAN Syntax at the Command Line</a></span></p>
</li>
<li>
<p><span><a href="rcmcnctg.htm#GUID-F8ADDD5A-CAB0-4128-8DDD-9B8FD524362E">Checking RMAN Syntax in Command Files</a></span></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-86BB8661-9779-4057-93A5-1ADC09C896CE__GUID-9D5C4FCA-AFD7-4C80-873A-B4150D62D25D">
<p class="notep1">See Also:</p>
<p><span class="italic"><a class="olink RCMRF111" target="_blank" href="../RCMRF/rcmsynta2011.htm#RCMRF111">Oracle Database Backup and Recovery Reference</a></span> to learn about the <code class="codeph">CHECKSYNTAX</code> command-line option</p>
</div>
</div>
<a id="BRADV562"></a><a id="BRADV89388"></a>
<div class="props_rev_3"><a id="GUID-E7549936-0286-46EC-A6B2-EAC3B538AE19"></a>
<h4 id="BRADV-GUID-E7549936-0286-46EC-A6B2-EAC3B538AE19" class="sect4">Checking RMAN Syntax at the Command Line</h4>
<div>
<div class="section">
<p>You can check the syntax of RMAN commands interactively without actually executing the commands.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To check RMAN syntax at the command line:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN with the <code class="codeph">CHECKSYNTAX</code> parameter:</span>
<div>
<pre dir="ltr">% rman CHECKSYNTAX
</pre></div>
</li>
<li class="stepexpand"><span>Enter the RMAN commands to be tested.</span></li>
</ol>
<div class="section">
<p>The following example shows a sample interactive session, with user-entered text in bold.</p>
<pre dir="ltr">RMAN&gt; <span class="bold">run [ backup database; ]</span>
 
RMAN-00571: ===========================================================
RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS ===============
RMAN-00571: ===========================================================
RMAN-00558: error encountered while parsing input commands
RMAN-01006: error signaled during parse 
 RMAN-02001: unrecognized punctuation symbol &#34;[&#34;
 
RMAN&gt; <span class="bold">run { backup database; }</span>

The command has no syntax errors

RMAN&gt;
</pre></div>
<!-- class="section" --></div>
</div>
<a id="BRADV149"></a><a id="BRADV150"></a><a id="BRADV89389"></a>
<div class="props_rev_3"><a id="GUID-F8ADDD5A-CAB0-4128-8DDD-9B8FD524362E"></a>
<h4 id="BRADV-GUID-F8ADDD5A-CAB0-4128-8DDD-9B8FD524362E" class="sect4">Checking RMAN Syntax in Command Files</h4>
<div>
<div class="p">
<p>To test commands in a command file, start RMAN with the <code class="codeph">CHECKSYNTAX</code> parameter and use the<span><a class="olink RCMRF100" target="_blank" href="../RCMRF/rcmsynta001.htm#RCMRF100"><code class="codeph">@</code></a></span> command to name the command file to be passed.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To test commands in a command file:</p>
<ol>
<li>
<p>Use a text editor to create a command file.</p>
<p>Assume that you create the <code class="codeph">/tmp/goodcmdfile</code> with the following contents:</p>
<pre dir="ltr"># command file with legal syntax
RESTORE DATABASE; 
RECOVER DATABASE;
</pre>
<p>Assume that you create another command file, <code class="codeph">/tmp/badcmdfile</code>, with the following contents:</p>
<pre dir="ltr"># command file with bad syntax commands
RESTORE DATABASE
RECOVER DATABASE
</pre></li>
<li>
<p>Run the command file from the RMAN prompt in the following format, where <span class="italic"><code class="codeph">filename</code></span> is the name of the command file:</p>
<pre dir="ltr">% rman CHECKSYNTAX @<span class="italic">filename</span>
</pre></li>
</ol>
<p>The following example shows the output when you run <code class="codeph">/tmp/goodcmdfile</code> with <code class="codeph">CHECKSYNTAX</code>:</p>
<pre dir="ltr">RMAN&gt; # command file with legal syntax
2&gt; restore database;
3&gt; recover database;
4&gt;
The cmdfile has no syntax errors
 
Recovery Manager complete.
</pre>
<p>In contrast, the following example shows the output when you run <span><code class="codeph">/tmp/badcmdfile</code></span> with <span><code class="codeph">CHECKSYNTAX</code></span>:</p>
<pre dir="ltr">RMAN&gt; #command file with syntax error
2&gt; restore database
3&gt; recover
RMAN-00571: ===========================================================
RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS===============
RMAN-00571: ===========================================================
RMAN-00558: error encountered while parsing input commands
RMAN-01005: syntax error: found &#34;recover&#34;: expecting one of: &#34;archivelog, 
      channel, check, controlfile, clone, database, datafile, device, 
      from, force, high, (, preview, ;, skip, spfile, standby, tablespace, 
      until, validate&#34;
RMAN-01007: at line 3 column 1 file: /tmp/badcmdfile
</pre>
<p>As explained in <span class="q">&#34;<span><a href="rcmcnctg.htm#GUID-A9321B2D-6CFF-4616-B629-67960A8F87DD">Using Substitution Variables in Command Files</a></span>&#34;</span>, you make your command files dynamic by including substitution variables. When you check the syntax of a command file that contains substitution variables, RMAN prompts you to enter values. <span><a href="rcmcnctg.htm#GUID-F8ADDD5A-CAB0-4128-8DDD-9B8FD524362E__BABCBGJD">Example 4-20</a></span> illustrates what happens if you enter invalid values when checking the syntax of a dynamic command file. The text in bold indicates text entered at the prompt.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-F8ADDD5A-CAB0-4128-8DDD-9B8FD524362E__BABCBGJD">
<p class="titleinexample">Example 4-20 Checking the Syntax of a Command File with Bad Syntax</p>
<pre dir="ltr">RMAN&gt; CONNECT TARGET *
2&gt; BACKUP TAG 
Enter value for 1: <span class="bold">mybackup</span>
abc COPIES 
Enter value for 2: <span class="bold">mybackup</span>
abc
RMAN-00571: ===========================================================
RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS ===============
RMAN-00571: ===========================================================
RMAN-00558: error encountered while parsing input commands
RMAN-01009: syntax error: found &#34;identifier&#34;: expecting one of: &#34;integer&#34;
RMAN-01008: the bad identifier was: mybackup
RMAN-01007: at line 2 column 25 file: /tmp/whole_db.cmd
</pre>
<p>RMAN indicates a syntax error because the string<span><code class="codeph">mybackup</code></span> is not a valid argument for <span><code class="codeph">COPIES</code></span>.</p>
</div>
<!-- class="example" --></div>
</div>
</div>
</div>
<a id="BRADV1130"></a>
<div class="props_rev_3"><a id="GUID-2273E896-C08B-498F-B96C-55400CCD1A17"></a>
<h2 id="BRADV-GUID-2273E896-C08B-498F-B96C-55400CCD1A17" class="sect2">Using the RMAN Pipe Interface</h2>
<div>
<p><a id="d18035e3818" class="indexterm-anchor"></a><a id="d18035e3822" class="indexterm-anchor"></a><a id="d18035e3826" class="indexterm-anchor"></a>The RMAN pipe interface is an alternative method for issuing commands to RMAN and receiving the output from those commands. With this interface, RMAN obtains commands and sends output by using the <a id="d18035e3829" class="indexterm-anchor"></a><a id="d18035e3833" class="indexterm-anchor"></a><code class="codeph">DBMS_PIPE</code> PL/SQL package instead of the operating system shell. Using this interface, it is possible to write a portable programmatic interface to RMAN.</p>
<p>The pipe interface is invoked by using the <code class="codeph">PIPE</code> command-line parameter for the RMAN client. RMAN uses two private pipes: one for receiving commands and the other for sending output. The names of the pipes are derived from the value of the <code class="codeph">PIPE</code> parameter. For example, you can invoke RMAN with the following command:</p>
<pre dir="ltr">% rman PIPE abc TARGET /
</pre>
<p>RMAN opens the two pipes in the target database: <code class="codeph">ORA$RMAN_ABC_IN</code>, which RMAN uses to receive user commands, and <code class="codeph">ORA$RMAN_ABC_OUT</code>, which RMAN uses to send all output back to RMAN. All messages on both the input and output pipes are of type <code class="codeph">VARCHAR2</code>.</p>
<p>RMAN does not permit the pipe interface to be used with public pipes, because they are a potential security problem. With a public pipe, any user who knows the name of the pipe can send commands to RMAN and intercept its output.</p>
<p>If the pipes are not initialized, then RMAN creates them as private pipes. If you want to put commands on the input pipe before starting RMAN, you must first create the pipe by calling <a id="d18035e3863" class="indexterm-anchor"></a><a id="d18035e3867" class="indexterm-anchor"></a><a id="d18035e3871" class="indexterm-anchor"></a><code class="codeph">DBMS_PIPE.CREATE_PIPE</code>. Whenever a pipe is not explicitly created as a private pipe, the first access to the pipe automatically creates it as a public pipe, and RMAN returns an error if it is told to use a public pipe.</p>
<div class="infobox-note" id="GUID-2273E896-C08B-498F-B96C-55400CCD1A17__GUID-0CDC83B2-0F0E-49A9-AE04-5813A686F0A0">
<p class="notep1">Note:</p>
<p>If multiple RMAN sessions can run against the target database, then you must use unique pipe names for each <a href="glossary.htm#GUID-01D29658-41E1-4D45-9C7F-A761D56885B9"><span class="xrefglossterm">RMAN session</span></a>. The <code class="codeph">DBMS_PIPE.UNIQUE_SESSION_NAME</code> function is one method that you can use to generate unique pipe names.</p>
</div>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmcnctg.htm#GUID-2C7C92ED-41ED-4A51-848E-34E695B107D4">Executing Multiple RMAN Commands in Succession Through a Pipe: Example</a></p>
</li>
<li>
<p><a href="rcmcnctg.htm#GUID-5C6E3722-C0EC-4F1E-9D21-8205C5804C1F">Executing RMAN Commands in a Single Job Through a Pipe: Example</a></p>
</li>
</ul>
</div>
<a id="BRADV158"></a><a id="BRADV89397"></a>
<div class="props_rev_3"><a id="GUID-2C7C92ED-41ED-4A51-848E-34E695B107D4"></a>
<h3 id="BRADV-GUID-2C7C92ED-41ED-4A51-848E-34E695B107D4" class="sect3">Executing Multiple RMAN Commands in Succession Through a Pipe: Example</h3>
<div>
<div class="section">
<p>This scenario assumes that the application controlling RMAN wants to run multiple commands in succession. After each command is sent down the pipe and executed and the output returned, RMAN pauses and waits for the next command.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To execute RMAN commands through a pipe:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN by connecting to a target database (required) and specifying the <code class="codeph">PIPE</code> option. For example, enter:</span>
<div>
<pre dir="ltr">% rman PIPE abc TARGET /
</pre>
<p>You can also specify the <code class="codeph">TIMEOUT</code> option, which forces RMAN to exit automatically if it does not receive any input from the input pipe in the specified number of seconds. For example, enter:</p>
<pre dir="ltr">% rman PIPE abc TARGET / TIMEOUT 60
</pre></div>
</li>
<li class="stepexpand"><span>Connect to the target database and put the desired commands on the input pipe by using <code class="codeph">DBMS_PIPE.PACK_MESSAGE</code> and <code class="codeph">DBMS_PIPE.SEND_MESSAGE</code>. In pipe mode, RMAN issues message <code class="codeph">RMAN-00572</code> when it is ready to accept input instead of displaying the standard RMAN prompt.</span></li>
<li class="stepexpand"><span>Read the RMAN output from the output pipe by using <code class="codeph">DBMS_PIPE.RECEIVE_MESSAGE</code> and <code class="codeph">DBMS_PIPE.UNPACK_MESSAGE</code>.</span></li>
<li class="stepexpand"><span>Repeat Steps 2 and 3 to execute further commands with the same RMAN instance that was started in Step 1.</span></li>
<li class="stepexpand"><span>If you used the <code class="codeph">TIMEOUT</code> option when starting RMAN, then RMAN terminates automatically after not receiving any input for the specified length of time. To force RMAN to terminate immediately, send the <code class="codeph">EXIT</code> command.</span></li>
</ol>
</div>
</div>
<a id="BRADV159"></a><a id="BRADV89398"></a>
<div class="props_rev_3"><a id="GUID-5C6E3722-C0EC-4F1E-9D21-8205C5804C1F"></a>
<h3 id="BRADV-GUID-5C6E3722-C0EC-4F1E-9D21-8205C5804C1F" class="sect3">Executing RMAN Commands in a Single Job Through a Pipe: Example</h3>
<div>
<div class="section">
<p>This scenario assumes that the application controlling RMAN wants to run one or more commands as a single job. After running the commands that are on the pipe, RMAN exits.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To execute RMAN commands in a single job through a pipe:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>After connecting to the target database, create a pipe (if it does not already exist under the name <code class="codeph">ORA$RMAN_</code><span class="italic">pipe</span><code class="codeph">_IN</code>).</span></li>
<li class="stepexpand"><span>Put the desired commands on the input pipe. In pipe mode, RMAN issues message <code class="codeph">RMAN-00572</code> when it is ready to accept input instead of displaying the standard RMAN prompt.</span></li>
<li class="stepexpand"><span>Start RMAN with the <code class="codeph">PIPE</code> option, and specify <code class="codeph">TIMEOUT</code> <code class="codeph">0</code>. For example, enter:</span>
<div>
<pre dir="ltr">% rman PIPE abc TARGET / TIMEOUT 0
</pre></div>
</li>
<li class="stepexpand"><span>RMAN reads the commands that were put on the pipe and executes them by using <code class="codeph">DBMS_PIPE.PACK_MESSAGE</code> and <code class="codeph">DBMS_PIPE.SEND_MESSAGE</code>. When it has exhausted the input pipe, RMAN exits immediately.</span></li>
<li class="stepexpand"><span>Read RMAN output from the output pipe by using <code class="codeph">DBMS_PIPE.RECEIVE_MESSAGE</code> and <code class="codeph">DBMS_PIPE.UNPACK_MESSAGE</code>.</span>
<div>
<div class="infoboxnotealso" id="GUID-5C6E3722-C0EC-4F1E-9D21-8205C5804C1F__GUID-DD748A83-B525-4264-A5BD-0BCFA09C1636">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS038" target="_blank" href="../ARPLS/d_pipe.htm#ARPLS038"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for documentation on the <code class="codeph">DBMS_PIPE</code> package</p>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment500">
<tr>
<td class="cellalignment512">
<table class="cellalignment505">
<tr>
<td class="cellalignment504"><a href="rcmarchi.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment504"><a href="rcmconfb.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment514">
<table class="cellalignment503">
<tr>
<td class="cellalignment504"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment504"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment504"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment504"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment504"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment504"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>