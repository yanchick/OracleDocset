<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-2672"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Performing%20Flashback%20and%20Database%20Point-in-Time%20Recovery"></a><title>Performing Flashback and Database Point-in-Time Recovery</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="recovery, database, point-in-time, database point-in-time recovery, Flashback Database, FLASHBACK TABLE statement, Flashback Table, using, flashback, CDB, CDBs, rewinding beyond PDB point-in-time recovery, PDBs, point-in-time recovery and fast recovery area, fast recovery area, PDB point-in-time recovery, point-in-time recovery, of CDBs, performing point-in-time recovery, of PDBs"/>
<meta name="dcterms.created" content="2017-06-07T23:52:16Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Backup and Recovery User&#39;s Guide"/>
<meta name="dcterms.identifier" content="E50658-09"/>
<meta name="dcterms.isVersionOf" content="BRADV"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="rcmcomre.htm" title="Previous" type="text/html"/>
<link rel="Next" href="rcmblock.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E50658-09.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-5463669A-DC89-4FF4-ACCE-136A72DF687B"></a> <span id="PAGE" style="display:none;">30/48</span> <!-- End Header -->
<a id="BRADV80055"></a>
<h1 id="BRADV-GUID-5463669A-DC89-4FF4-ACCE-136A72DF687B" class="sect1"><span class="enumeration_chapter">18</span> Performing Flashback and Database Point-in-Time Recovery</h1>
<div>
<p>This chapter explains how to investigate unwanted database changes, and select and perform an appropriate recovery strategy based upon Oracle Flashback Technology and database backups. It contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmflash.htm#GUID-94B90ECF-69C9-40D4-A318-DC4AE9776557">Overview of Oracle Flashback Technology and Database Point-in-Time Recovery</a></p>
</li>
<li>
<p><a href="rcmflash.htm#GUID-FF315DFC-ABBC-410D-ABDB-75FA89D43255">Rewinding a Table with Flashback Table</a></p>
</li>
<li>
<p><a href="rcmflash.htm#GUID-55EA5EB0-89E2-4561-A9D0-01A6242A2A87">Rewinding a DROP TABLE Operation with Flashback Drop</a></p>
</li>
<li>
<p><a href="rcmflash.htm#GUID-953FA30D-BED2-4DBA-8361-9DA1B8FF073F">Rewinding a Database with Flashback Database</a></p>
</li>
<li>
<p><a href="rcmflash.htm#GUID-7D3EE2F7-77A2-4264-8875-CC0AEC64ABE0">Performing Database Point-in-Time Recovery</a></p>
</li>
<li>
<p><a href="rcmflash.htm#GUID-F9C8CB5E-5954-4114-99D0-D121BA616058">Flashback and Database Point-in-Time Recovery Scenarios</a></p>
</li>
</ul>
</div>
<a id="BRADV89737"></a>
<div class="props_rev_3"><a id="GUID-94B90ECF-69C9-40D4-A318-DC4AE9776557"></a>
<h2 id="BRADV-GUID-94B90ECF-69C9-40D4-A318-DC4AE9776557" class="sect2">Overview of Oracle Flashback Technology and Database Point-in-Time Recovery</h2>
<div>
<p>This section explains the purpose and basic concepts of <a href="glossary.htm#GUID-B9B3A008-D1DB-4B83-B825-70E8B79A9920"><span class="xrefglossterm">Oracle Flashback Technology</span></a> and database point-in-time recovery.</p>
</div>
<a id="BRADV89738"></a>
<div class="props_rev_3"><a id="GUID-D8DA9312-0556-4B1A-835C-0A8FF789E1A9"></a>
<h3 id="BRADV-GUID-D8DA9312-0556-4B1A-835C-0A8FF789E1A9" class="sect3">Purpose of Flashback and Database Point-in-Time Recovery</h3>
<div>
<p><a id="d73614e252" class="indexterm-anchor"></a>Typically, the following situations call for flashback features or point-in-time recovery:</p>
<ul style="list-style-type: disc;">
<li>
<p>A user error or corruption removes needed data or introduces corrupted data. For example, a user or DBA might erroneously delete or update the contents of one or more tables, drop database objects that are still needed during an update to an application, or run a large batch update that fails midway.</p>
</li>
<li>
<p>A database upgrade fails or an upgrade script goes awry.</p>
</li>
<li>
<p>A complete database recovery after a media failure cannot succeed because you do not have all of the needed redo logs or incremental backups.</p>
</li>
</ul>
<p>In these situations, you can use point-in-time recovery or flashback features to return the database or database object to its state at a previous point in time.</p>
</div>
</div>
<a id="BRADV89739"></a>
<div class="props_rev_3"><a id="GUID-15D5CF76-8622-4117-8954-3D872A0B0A86"></a>
<h3 id="BRADV-GUID-15D5CF76-8622-4117-8954-3D872A0B0A86" class="sect3">Basic Concepts of Point-in-Time Recovery and Flashback Features</h3>
<div>
<p>The most basic solution to unwanted database changes is RMAN <a href="glossary.htm#GUID-FCC8BB91-79B6-4AF1-974A-43E75CD161E3"><span class="xrefglossterm">database point-in-time recovery (DBPITR)</span></a>. DBPITR is sometimes called <a href="glossary.htm#GUID-2D291374-0883-4A17-8A8E-0A4E2C8CC790"><span class="xrefglossterm">incomplete recovery</span></a> because it does not use all of the available redo or completely recover all changes to your database. In this case, you restore a whole database backup and then apply redo logs or incremental backups to re-create all changes up to a point in time before the unwanted change.</p>
<p>If unwanted database changes are extensive but confined to specific tablespaces, then you can use<a id="d73614e349" class="indexterm-anchor"></a><a id="d73614e353" class="indexterm-anchor"></a> <a href="glossary.htm#GUID-8A257409-B3DC-41FD-A2AF-D47560FF9F18"><span class="xrefglossterm">tablespace point-in-time recovery (TSPITR)</span></a> to return these tablespaces to an earlier <a href="glossary.htm#GUID-BBD8C5A5-1CB0-4BF6-9614-81DD64ABE59E"><span class="xrefglossterm">system change number (SCN)</span></a> while the unaffected tablespaces remain available. RMAN TSPITR is an advanced technique described in <a href="rcmtspit.htm#GUID-CAACDB53-7C3A-45B4-8249-C5D855D47571">Performing RMAN Tablespace Point-in-Time Recovery (TSPITR)</a> .</p>
<p>If unwanted database changes are limited to specific tables or table partitions, then you can use a previously created RMAN backup to return only these objects to a point in time before the unwanted changes occurred. Recovering tables or table partitions to a specific point in time is described in <a href="rcmresind.htm#GUID-87B7F772-335F-4179-81C9-91678D026D01">Recovering Tables and Table Partitions from RMAN Backups</a>.</p>
<p>Oracle Database also provides a set of features collectively known as <a id="d73614e376" class="indexterm-anchor"></a>Flashback Technology that supports viewing past states of data, and winding and rewinding data back and forth in time, without requiring the restore of the database from backup. Depending on the changes to your database, Flashback Technology can often reverse the unwanted changes more quickly and with less impact on database availability.</p>
</div>
<a id="BRADV89740"></a>
<div class="props_rev_3"><a id="GUID-0B058026-43E6-4D39-A67A-B7289636B57F"></a>
<h4 id="BRADV-GUID-0B058026-43E6-4D39-A67A-B7289636B57F" class="sect4">Basic Concepts of Database Point-in-Time Recovery for non-CDBs</h4>
<div>
<p><a id="d73614e448" class="indexterm-anchor"></a>DBPITR works at the physical level to return the data files to their state at a target time in the past. In an RMAN DBPITR operation, you specify a target SCN, log sequence, restore point, or time. RMAN restores the database from backups created before the target time, and then applies incremental backups and logs to re-create all changes between the time of the data file backups and the end point of recovery. When the end point is specified as an SCN, the database applies the redo logs and stops after each redo thread or the specified SCN, whichever occurs first. When the end point is specified as a time, the database internally determines a suitable SCN for the specified time and then recovers to this SCN.</p>
<p>If your backup strategy is properly designed and your database is running in <code class="codeph">ARCHIVELOG</code> mode, then DBPITR is an option in nearly all circumstances. RMAN simplifies DBPITR in comparison to the user-managed DBPITR described in <span class="q">&#34;<a href="osrecvry.htm#GUID-2BF2BE5E-3D1B-4F0C-9F10-25D5342F6DB3">Performing Incomplete Database Recovery</a>&#34;</span>. Given a target SCN, data files are restored from backup and recovered efficiently with no intervention from the user. Nevertheless, RMAN DBPITR has the following disadvantages:</p>
<ul style="list-style-type: disc;">
<li>
<p>You cannot return selected objects to their earlier state, only the entire database.</p>
</li>
<li>
<p>Your entire database is unavailable during the DBPITR.</p>
</li>
<li>
<p>DBPITR can be time-consuming because RMAN must restore all data files. Also, RMAN may need to restore redo logs and incremental backups to recover the data files. If backups are on tape, then this process can take even longer.</p>
</li>
</ul>
</div>
</div>
<a id="BRADV758"></a>
<div class="props_rev_3"><a id="GUID-35D290AC-CC01-4984-93D6-AE41A3D0D3B6"></a>
<h4 id="BRADV-GUID-35D290AC-CC01-4984-93D6-AE41A3D0D3B6" class="sect4">Basic Concepts of Point-in-Time Recovery for PDBs</h4>
<div>
<p>RMAN provides support for point-in-time recovery for one or more pluggable databases (<a href="glossary.htm#GUID-993BFB3F-3305-481C-999D-26132095DEC9"><span class="xrefglossterm">PDB</span></a>s). The process of performing recovery is similar to that of DBPITR. You use the <code class="codeph">RECOVER</code> command to perform point-in-time recovery of one or more PDBs. However, to recover PDBs, you must connect to the root as a user with <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege. See <span class="q">&#34;<a href="rcmflash.htm#GUID-031D9695-A9D2-4381-A840-39BD3CC19946">Performing Point-in-Time Recovery of CDBs and PDBs</a>&#34;</span>.</p>
</div>
</div>
<a id="BRADV8702"></a>
<div class="props_rev_3"><a id="GUID-F2DE2466-1C9C-4FA7-8930-CD5D6DB62928"></a>
<h4 id="BRADV-GUID-F2DE2466-1C9C-4FA7-8930-CD5D6DB62928" class="sect4">Basic Concepts of Flashback Technology</h4>
<div>
<p>The flashback features of the Oracle Database are more efficient than media recovery in most circumstances in which they are available. You can use them to investigate past states of the database.</p>
</div>
<a id="BRADV89741"></a>
<div class="props_rev_3"><a id="GUID-3F4DF6A3-137F-4487-B267-0F14E4B7657E"></a>
<h5 id="BRADV-GUID-3F4DF6A3-137F-4487-B267-0F14E4B7657E" class="sect5">About Physical Flashback Features Useful in Backup and Recovery</h5>
<div>
<p><a href="glossary.htm#GUID-DD883C9B-0441-48D3-9DDC-755597782971"><span class="xrefglossterm">Oracle Flashback Database</span></a>, which is explained in <span class="q">&#34;<a href="rcmflash.htm#GUID-953FA30D-BED2-4DBA-8361-9DA1B8FF073F">Rewinding a Database with Flashback Database</a>&#34;</span>, is the most efficient alternative to DBPITR. Unlike the other flashback features, it operates at a physical level and reverts the current data files to their contents at a past time. The result is like the result of a DBPITR, including the <code class="codeph">OPEN RESETLOGS</code>, but Flashback Database is typically faster because it does not require you to restore data files and requires only limited application of redo compared to media recovery.</p>
<p>As explained in <span class="q">&#34;<a href="rcmconfb.htm#GUID-302339EC-EE0F-45FB-9862-BB2BA138AA13">Configuring the Fast Recovery Area</a>&#34;</span>, a <a href="glossary.htm#GUID-6E3CDD76-A573-4E5C-B12D-59C232C96C19"><span class="xrefglossterm">fast recovery area</span></a> is required for Flashback Database. To enable logging for Flashback Database, you must set the <a class="olink REFRN10233" target="_blank" href="../REFRN/GUID-33F44036-F1BB-4CBF-8AF3-486415E58F2B.htm#REFRN10233"><code class="codeph">DB_FLASHBACK_RETENTION_TARGET</code></a> initialization parameter and issue the <code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> <code class="codeph">FLASHBACK</code> <code class="codeph">ON</code> statement.</p>
<p>During normal operation, the database periodically writes old images of data file blocks to the <a href="glossary.htm#GUID-725ED3D7-5077-4F16-85AA-CDAD5BFCE554"><span class="xrefglossterm">flashback logs</span></a>. Flashback logs are written sequentially and often in bulk. In some respects, flashback logging is like a continuous backup. The database automatically creates, deletes, and resizes flashback logs in the recovery area<a id="d73614e748" class="indexterm-anchor"></a>. Flashback logs are not archived. You need only be aware of flashback logs for monitoring performance and determining disk space allocation for the recovery area.</p>
<p>When you perform a Flashback Database operation, the database uses flashback logs<a id="d73614e753" class="indexterm-anchor"></a> to access past versions of data blocks and also uses some data in the archived redo logs. Consequently, you cannot enable Flashback Database <span class="italic">after</span> a failure is discovered and then use Flashback Database to rewind through this failure. You can use the related capability of guaranteed restore points to protect the contents of your database at a fixed point in time, such as immediately before a risky database change.</p>
</div>
</div>
<a id="BRADV89742"></a>
<div class="props_rev_3"><a id="GUID-8FA281D7-9297-4445-985F-4EC4F951CA39"></a>
<h5 id="BRADV-GUID-8FA281D7-9297-4445-985F-4EC4F951CA39" class="sect5">About Logical Flashback Features Useful in Backup and Recovery</h5>
<div>
<p>The remaining <a id="d73614e829" class="indexterm-anchor"></a>flashback features operate at the logical level. The logical features documented in this chapter are as follows:</p>
<ul style="list-style-type: disc;">
<li>
<p><a id="d73614e837" class="indexterm-anchor"></a>Flashback Table</p>
<p>You can recover a table or set of tables to a specified earlier point in time without taking any part of the database offline. In many cases, Flashback Table eliminates the need to perform more complicated point-in-time recovery operations. Flashback Table restores tables while automatically maintaining associated attributes such as current indexes, triggers, and constraints, and not requiring you to find and restore application-specific properties.</p>
<p><span class="q">&#34;<a href="rcmflash.htm#GUID-FF315DFC-ABBC-410D-ABDB-75FA89D43255">Rewinding a Table with Flashback Table</a>&#34;</span> explains how to use this feature.</p>
<div class="infoboxnotealso" id="GUID-8FA281D7-9297-4445-985F-4EC4F951CA39__GUID-8167CE57-0E2B-4ACC-B6EC-DA3418C81593">
<p class="notep1">See Also:</p>
<p><a href="rcmresind.htm#GUID-87B7F772-335F-4179-81C9-91678D026D01">Recovering Tables and Table Partitions from RMAN Backups</a> for information about recovering tables using previously-created RMAN backups</p>
</div>
</li>
<li>
<p><a id="d73614e856" class="indexterm-anchor"></a>Flashback Drop</p>
<p>You can reverse the effects of a <code class="codeph">DROP</code> <code class="codeph">TABLE</code> statement.</p>
<p><span class="q">&#34;<a href="rcmflash.htm#GUID-55EA5EB0-89E2-4561-A9D0-01A6242A2A87">Rewinding a DROP TABLE Operation with Flashback Drop</a>&#34;</span> explains how to use this feature.</p>
</li>
</ul>
<p>All logical flashback features except Flashback Drop rely on <strong class="term">undo data</strong>. Used primarily for providing read consistency for SQL queries and rolling back transactions, undo records contain the information required to reconstruct data as it existed at a past time and examine the record of changes since that past time.</p>
<p>Flashback Drop relies on a mechanism called the <a id="d73614e880" class="indexterm-anchor"></a><a href="glossary.htm#GUID-6D99D402-0A6E-4718-98E9-19528F3012B2"><span class="xrefglossterm">recycle bin</span></a>, which the database uses to manage dropped database objects until the space they occupied is needed for new data. There is no fixed amount of space allocated to the recycle bin, and no guarantee regarding how long dropped objects remain in the recycle bin. Depending on system activity, a dropped object may remain in the recycle bin for seconds or for months.</p>
<div class="infoboxnotealso" id="GUID-8FA281D7-9297-4445-985F-4EC4F951CA39__GUID-D5746CEC-3E83-4D44-A4B8-4CEC4FDC35F2">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink CNCPT305" target="_blank" href="../CNCPT/logical.htm#CNCPT305"><span class="italic">Oracle Database Concepts</span></a> and <a class="olink ADMIN013" target="_blank" href="../ADMIN/undo.htm#ADMIN013"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for more information about undo data and automatic undo management</p>
</li>
<li>
<p><a class="olink ADFNS1008" target="_blank" href="../ADFNS/adfns_flashback.htm#ADFNS1008"><span class="italic">Oracle Database Development Guide</span></a> to learn how to use the logical flashback features</p>
</li>
<li>
<p><span class="q">&#34;<a href="flashdb.htm#GUID-FAA04D1F-36E2-4B20-954F-845E42386775">Overview of Flashback Database_ Restore Points and Guaranteed Restore Points</a>&#34;</span> for more information about setting up your database to use Flashback Database, and on the related restore points feature</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<a id="BRADV81517"></a>
<div class="props_rev_3"><a id="GUID-FF315DFC-ABBC-410D-ABDB-75FA89D43255"></a>
<h2 id="BRADV-GUID-FF315DFC-ABBC-410D-ABDB-75FA89D43255" class="sect2">Rewinding a Table with Flashback Table</h2>
<div>
<p>Flashback Table uses information in the undo tablespace rather than restored backups to retrieve the table. When a Flashback Table operation occurs, new rows are deleted and old rows are reinserted. The rest of your database remains available while the flashback of the table is being performed.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmflash.htm#GUID-AA471072-D35C-410E-8C68-14E0DF8FB5D1">Prerequisites for Flashback Table</a></p>
</li>
<li>
<p><a href="rcmflash.htm#GUID-A7D05B55-F5EA-46BC-A025-09F423349BAF">Performing a Flashback Table Operation</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-FF315DFC-ABBC-410D-ABDB-75FA89D43255__GUID-961184FB-C9A8-41AE-B78C-3BDAB99BFAD0">
<p class="notep1">See Also:</p>
<p><a class="olink ADMIN013" target="_blank" href="../ADMIN/undo.htm#ADMIN013"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for more information about Automatic Undo Management</p>
</div>
</div>
<a id="BRADV89743"></a>
<div class="props_rev_3"><a id="GUID-AA471072-D35C-410E-8C68-14E0DF8FB5D1"></a>
<h3 id="BRADV-GUID-AA471072-D35C-410E-8C68-14E0DF8FB5D1" class="sect3">Prerequisites for Flashback Table</h3>
<div>
<p><a id="d73614e1079" class="indexterm-anchor"></a>To use the Flashback Table feature on one or more tables, use <a id="d73614e1084" class="indexterm-anchor"></a>the <code class="codeph">FLASHBACK</code> <code class="codeph">TABLE</code> SQL statement with a target time or SCN.</p>
<p>You must have the following privileges to use the Flashback Table feature:</p>
<ul style="list-style-type: disc;">
<li>
<p>You must have been granted the <code class="codeph">FLASHBACK ANY TABLE</code> system privilege or you must have the <code class="codeph">FLASHBACK</code> object privilege on the table.</p>
</li>
<li>
<p>You must have <code class="codeph">READ</code> or <code class="codeph">SELECT</code>, <code class="codeph">INSERT</code>, <code class="codeph">DELETE</code>, and <code class="codeph">ALTER</code> privileges on the table.</p>
</li>
<li>
<p>To flash back a table to a restore point, you must have the <code class="codeph">SELECT ANY DICTIONARY</code> or <code class="codeph">FLASHBACK ANY TABLE</code> system privilege or the <code class="codeph">SELECT_CATALOG_ROLE</code> role.</p>
</li>
</ul>
<p>For an object to be eligible to be flashed back, the following prerequisites must be met:</p>
<ul style="list-style-type: disc;">
<li>
<p>The object must <span class="bold">not</span> be included the following categories: tables that are part of a cluster, materialized views, Advanced Queuing (AQ) tables, static data dictionary tables, system tables, remote tables, object tables, nested tables, or individual table partitions or subpartitions.</p>
</li>
<li>
<p>The structure of the table must not have been changed between the current time and the target flashback time.</p>
<p>The following Data Definition Language (DDL) operations change the structure of a table: upgrading, moving, or truncating a table; adding a constraint to a table, adding a table to a cluster; modifying or dropping a column; adding, dropping, merging, splitting, coalescing, or truncating a partition or subpartition (except adding a range partition).</p>
</li>
<li>
<p>Row movement must be enabled on the table, which indicates that rowids change after the flashback occurs.</p>
<p>This restriction exists because if rowids before the flashback were stored by the application, then there is no guarantee that the rowids correspond to the same rows after the flashback. If your application depends on rowids, then you cannot use Flashback Table.</p>
</li>
<li>
<p>The undo data in the <a href="glossary.htm#GUID-675711E4-849C-4D86-993A-D5AA94444D3A"><span class="xrefglossterm">undo tablespace</span></a> must extend far enough back in time to satisfy the flashback target time or SCN.</p>
<p>The point to which you can perform Flashback Table is determined by the <a href="glossary.htm#GUID-C297DDAF-1A4D-40DA-B89C-46A31D5271E9"><span class="xrefglossterm">undo retention period</span></a>, which is the minimal time for which undo data is kept before being recycled, and tablespace characteristics. The undo data contains information about data blocks before they were changed. The flashback operation uses undo to re-create the original data.</p>
<p>To ensure that the undo information is retained for Flashback Table operations, Oracle suggests setting the <code class="codeph">UNDO_RETENTION</code> parameter to 86400 seconds (24 hours) or greater for the undo tablespace.</p>
</li>
</ul>
<div class="infobox-note" id="GUID-AA471072-D35C-410E-8C68-14E0DF8FB5D1__GUID-203F9373-627B-40EC-9445-48D5342A92A4">
<p class="notep1">Note:</p>
<p><code class="codeph">FLASHBACK</code> <code class="codeph">TABLE</code> <code class="codeph">...</code> <code class="codeph">TO</code> <code class="codeph">BEFORE</code> <code class="codeph">DROP</code> is a use of the Flashback Drop feature, not Flashback Table, and therefore is not subject to these prerequisites. See <span class="q">&#34;<a href="rcmflash.htm#GUID-55EA5EB0-89E2-4561-A9D0-01A6242A2A87">Rewinding a DROP TABLE Operation with Flashback Drop</a>&#34;</span> for more information.</p>
</div>
</div>
</div>
<a id="BRADV341"></a><a id="BRADV89744"></a>
<div class="props_rev_3"><a id="GUID-A7D05B55-F5EA-46BC-A025-09F423349BAF"></a>
<h3 id="BRADV-GUID-A7D05B55-F5EA-46BC-A025-09F423349BAF" class="sect3">Performing a Flashback Table Operation</h3>
<div>
<div class="section">
<p>In this scenario, assume that you want to perform a flashback of the <code class="codeph">hr.temp_employees</code> table after a user made some incorrect updates.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To perform a flashback of temp_employees:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Ensure that the prerequisites described in <a href="rcmflash.htm#GUID-AA471072-D35C-410E-8C68-14E0DF8FB5D1">Prerequisites for Flashback Table</a> are met.</span></li>
<li class="stepexpand"><span>Connect SQL*Plus to the target database and identify the current SCN.</span>
<div>
<p>You cannot roll back a <code class="codeph">FLASHBACK TABLE</code> statement, but you can issue another <code class="codeph">FLASHBACK TABLE</code> statement and specify a time just before the current time. Therefore, it is advisable to record the current SCN. You can obtain it by <a id="d73614e1303" class="indexterm-anchor"></a>querying <code class="codeph">V$DATABASE</code> as follows:</p>
<pre dir="ltr">SELECT CURRENT_SCN FROM V$DATABASE;
</pre></div>
</li>
<li class="stepexpand"><span>Identify the time, SCN, or restore point to which you want to return the table.</span>
<div>
<p>If you have created restore points, then you can list available restore points by executing the following <a id="d73614e1317" class="indexterm-anchor"></a>query:</p>
<pre dir="ltr">SELECT NAME, SCN, TIME FROM V$RESTORE_POINT;
</pre></div>
</li>
<li class="stepexpand"><span>Ensure that enough undo data exists to rewind the table to the specified target.</span>
<div>
<p>If the <code class="codeph">UNDO_RETENTION</code> intialization parameter is set, and the undo retention guarantee is on, then you can use the following query to determine how long undo data is being <a id="d73614e1331" class="indexterm-anchor"></a>retained:</p>
<pre dir="ltr">SELECT NAME, VALUE/60 MINUTES_RETAINED
FROM   V$PARAMETER
WHERE  NAME = &#39;undo_retention&#39;;
</pre></div>
</li>
<li class="stepexpand"><span>Ensure that row movement is enabled for all objects that you are rewinding with Flashback Table.</span>
<div>
<p>You can enable row movement for a table with the following SQL statement, where <span class="italic">table</span> is the name of the table that you are rewinding:</p>
<pre dir="ltr">ALTER TABLE <span class="italic">table </span>ENABLE ROW MOVEMENT;
</pre></div>
</li>
<li class="stepexpand"><span>Determine whether the table that you intend to flash back has dependencies on other tables. If dependencies exist, then decide whether to flash back these tables as well.</span>
<div>
<p>You can issue the following SQL query to determine the dependencies, where <span class="italic">schema_name</span> is the schema for the table to be flashed back and <span class="italic">table_name</span> is the name of the table:</p>
<pre dir="ltr">SELECT other.owner, other.table_name
FROM   sys.all_constraints this, sys.all_constraints other
WHERE  this.owner = <span class="italic">schema_name</span>
AND    this.table_name = <span class="italic">table_name</span>
AND    this.r_owner = other.owner
AND    this.r_constraint_name = other.constraint_name
AND    this.constraint_type=&#39;R&#39;;
</pre></div>
</li>
<li class="stepexpand" id="GUID-A7D05B55-F5EA-46BC-A025-09F423349BAF__CHDHCAGI"><span>Execute a <code class="codeph">FLASHBACK TABLE</code> statement for the objects to flash back.</span>
<div>
<p>The following SQL statement returns the <code class="codeph">hr.temp_employees</code> table to the restore point named <code class="codeph">temp_employees_update</code>:</p>
<pre dir="ltr">FLASHBACK TABLE hr.temp_employees
  TO RESTORE POINT temp_employees_update;
</pre>
<p>The following SQL statement rewinds the <code class="codeph">hr.temp_employees</code> table to its state when the database was at the time specified by the SCN:</p>
<pre dir="ltr">FLASHBACK TABLE hr.temp_employees
  TO SCN 123456;
</pre>
<p>As shown in the following example, you can also specify the target point in time with <code class="codeph">TO_TIMESTAMP</code>:</p>
<pre dir="ltr">FLASHBACK TABLE hr.temp_employees
  TO TIMESTAMP TO_TIMESTAMP(&#39;2013-10-17 09:30:00&#39;, &#39;YYYY-MM-DD HH:MI:SS&#39;);
</pre>
<div class="infobox-note" id="GUID-A7D05B55-F5EA-46BC-A025-09F423349BAF__GUID-4A748F8A-A374-45BE-852B-18EE762998F8">
<p class="notep1">Note:</p>
<p>The mapping of time stamps to SCNs is not always exact. When you use time stamps with the <code class="codeph">FLASHBACK</code> <code class="codeph">TABLE</code> statement, the time to which the table is flashed back can vary by up to approximately 3 seconds of the time specified for <code class="codeph">TO_TIMESTAMP</code>. If an exact point in time is required, then use an SCN rather than a time.</p>
</div>
</div>
</li>
<li class="stepexpand"><span>Optionally, query the table to check the data.</span></li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-A7D05B55-F5EA-46BC-A025-09F423349BAF__GUID-919EDDE7-195F-46D0-84CE-4D3DA06E31E3">
<p class="notep1">See Also:</p>
<a href="rcmflash.htm#GUID-3F9961EC-EF49-4E19-BAFD-3A11EDDE53C8">Keeping Triggers Enabled During Flashback Table</a></div>
</div>
<!-- class="section" --></div>
<a id="BRADV89745"></a>
<div class="props_rev_3"><a id="GUID-3F9961EC-EF49-4E19-BAFD-3A11EDDE53C8"></a>
<h4 id="BRADV-GUID-3F9961EC-EF49-4E19-BAFD-3A11EDDE53C8" class="sect4">Keeping Triggers Enabled During Flashback Table</h4>
<div>
<div class="section">
<p>By default, the database disables triggers on the affected table before performing a <code class="codeph">FLASHBACK TABLE</code> operation. After the operation, the database returns the triggers to the state they were in before the operation (enabled or disabled). To keep triggers enabled during the flashback of the table, add an <code class="codeph">ENABLE TRIGGERS</code> clause to the <code class="codeph">FLASHBACK TABLE</code> statement in Step <a href="rcmflash.htm#GUID-A7D05B55-F5EA-46BC-A025-09F423349BAF__CHDHCAGI">7</a>.</p>
<p>For example, assume that at 17:00 an HR administrator discovers that an employee is missing from the <code class="codeph">hr.temp_employees</code> table. This employee was included in the table at 14:00, the last time the report was run. Therefore, someone accidentally deleted the record for this employee between 14:00 and 17:00. The HR administrator uses Flashback Table to return the table to its state at 14:00, respecting any triggers set on the <code class="codeph">hr.temp_employees</code> table, by using the SQL statement in the following example:</p>
<pre dir="ltr">FLASHBACK TABLE hr.temp_employees
  TO TIMESTAMP TO_TIMESTAMP(&#39;2013-03-03 14:00:00&#39; , &#39;YYYY-MM-DD HH:MI:SS&#39;) 
  ENABLE TRIGGERS;
</pre>
<div class="infoboxnotealso" id="GUID-3F9961EC-EF49-4E19-BAFD-3A11EDDE53C8__GUID-5C47F87D-FBB4-4080-9D69-9AA1BD8E3B55">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink ADMIN01512" target="_blank" href="../ADMIN/tables.htm#ADMIN01512"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> to learn how to recover tables with the Flashback Table feature</p>
</li>
<li>
<p><a class="olink SQLRF01802" target="_blank" href="../SQLRF/statements_9013.htm#SQLRF01802"><span class="italic">Oracle Database SQL Language Reference</span></a> for a simple Flashback Table scenario</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<a id="BRADV81511"></a>
<div class="props_rev_3"><a id="GUID-55EA5EB0-89E2-4561-A9D0-01A6242A2A87"></a>
<h2 id="BRADV-GUID-55EA5EB0-89E2-4561-A9D0-01A6242A2A87" class="sect2">Rewinding a DROP TABLE Operation with Flashback Drop</h2>
<div>
<p>This section explains how to retrieve objects from the recycle bin with the <code class="codeph">FLASHBACK TABLE ... TO BEFORE DROP</code> statement.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmflash.htm#GUID-D953DEDB-4C98-4BA9-B5FE-CCBA68679C3F">About Flashback Drop</a></p>
</li>
<li>
<p><a href="rcmflash.htm#GUID-F5B66BE0-4941-4513-821B-74F7ACB6489E">Prerequisites of Flashback Drop</a></p>
</li>
<li>
<p><a href="rcmflash.htm#GUID-6AED5A17-B29C-4F92-80C0-49F06A62DE4F">Performing a Flashback Drop Operation</a></p>
</li>
</ul>
</div>
<a id="BRADV89746"></a>
<div class="props_rev_3"><a id="GUID-D953DEDB-4C98-4BA9-B5FE-CCBA68679C3F"></a>
<h3 id="BRADV-GUID-D953DEDB-4C98-4BA9-B5FE-CCBA68679C3F" class="sect3">About Flashback Drop</h3>
<div>
<p><a id="d73614e1691" class="indexterm-anchor"></a><a id="d73614e1693" class="indexterm-anchor"></a>Flashback Drop reverses the effects of a <code class="codeph">DROP TABLE</code> operation. Flashback Drop is faster than other recovery mechanisms that can be used in this situation, such as point-in-time recovery, and does not lead to downtime or loss of recent transactions.</p>
<p>When you drop a table, the database does not immediately remove the space associated with the table. Instead, the table is renamed and, along with any associated objects, placed in the recycle bin. System-generated recycle bin object names are unique. You can query objects in the recycle bin, just as you can query other objects.</p>
<p>A flashback operation retrieves the table from the recycle bin. When retrieving dropped tables, you can specify either the original user-specified name of the table or the system-generated name.</p>
<p>When you drop a table, the table and all of its dependent objects go into the recycle bin together. Likewise, when you perform Flashback Drop, the objects are generally all retrieved together. When you restore a table from the recycle bin, dependent objects such as indexes do not get their original names back; they retain their system-generated recycle bin names. Oracle Database retrieves all indexes defined on the table except for bitmap join indexes, and all triggers and constraints defined on the table except for referential integrity constraints that reference other tables.</p>
<p>Some dependent objects such as indexes may possibly have been reclaimed because of space pressure. In such cases, the reclaimed dependent objects are not retrievable from the recycle bin.</p>
</div>
</div>
<a id="BRADV89747"></a>
<div class="props_rev_3"><a id="GUID-F5B66BE0-4941-4513-821B-74F7ACB6489E"></a>
<h3 id="BRADV-GUID-F5B66BE0-4941-4513-821B-74F7ACB6489E" class="sect3">Prerequisites of Flashback Drop</h3>
<div>
<p>The following list summarizes the user privileges required for the operations related to Flashback Drop and the recycle bin:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">DROP</code></p>
<p>Any user with <code class="codeph">DROP</code> privileges over an object can drop the object, placing it in the recycle bin.</p>
</li>
<li>
<p><code class="codeph">FLASHBACK TABLE ... TO BEFORE DROP</code></p>
<p>Privileges for this statement are tied to the privileges for <code class="codeph">DROP</code>. That is, any user who can drop an object can perform Flashback Drop to retrieve the dropped object from the recycle bin.</p>
</li>
<li>
<p><code class="codeph">PURGE</code></p>
<p>Privileges for a purge of the recycle bin are tied to the <code class="codeph">DROP</code> privileges. Any user having <code class="codeph">DROP</code> <code class="codeph">TABLE</code>, <code class="codeph">DROP</code> <code class="codeph">ANY</code> <code class="codeph">TABLE</code>, or <code class="codeph">PURGE</code> <code class="codeph">DBA_RECYCLE_BIN</code> privileges can purge the objects from the recycle bin.</p>
</li>
<li>
<p><code class="codeph">READ</code> or <code class="codeph">SELECT</code> and <code class="codeph">FLASHBACK</code> for objects in the Recycle Bin</p>
<p>Users must have the <code class="codeph">READ</code> or <code class="codeph">SELECT</code> and <code class="codeph">FLASHBACK</code> privileges over an object in the recycle bin to query the object in the recycle bin. Any users who had the <code class="codeph">READ</code> or <code class="codeph">SELECT</code> privilege over an object before it was dropped continue to have the <code class="codeph">READ</code> or <code class="codeph">SELECT</code> privilege over the object in the recycle bin. Users must have <code class="codeph">FLASHBACK</code> privilege to query any object in the recycle bin, because these are objects from a past state of the database.</p>
</li>
</ul>
<p>Objects must meet the following prerequisites to be eligible for retrieval from the recycle bin:</p>
<ul style="list-style-type: disc;">
<li>
<p>The <a id="d73614e1871" class="indexterm-anchor"></a>recycle bin is only available for non-system, locally managed tablespaces. If a table is in a non-system, locally managed tablespace, but one or more of its dependent segments (objects) is in a dictionary-managed tablespace, then these objects are protected by the recycle bin.</p>
</li>
<li>
<p>Tables that have fine-grained auditing (FGA) and Virtual Private Database (VPD) policies defined over them are not protected by the recycle bin.</p>
</li>
<li>
<p>Partitioned index-organized tables are not protected by the recycle bin.</p>
</li>
<li>
<p>The table must not have been purged, either by a user or by Oracle Database during a space reclamation operation.</p>
</li>
</ul>
</div>
</div>
<a id="BRADV342"></a><a id="BRADV89748"></a>
<div class="props_rev_3"><a id="GUID-6AED5A17-B29C-4F92-80C0-49F06A62DE4F"></a>
<h3 id="BRADV-GUID-6AED5A17-B29C-4F92-80C0-49F06A62DE4F" class="sect3">Performing a Flashback Drop Operation</h3>
<div>
<div class="section">
<p>Use the <code class="codeph">FLASHBACK</code> <code class="codeph">TABLE</code> <code class="codeph">...</code> <code class="codeph">TO</code> <code class="codeph">BEFORE</code> <code class="codeph">DROP</code> statement to recover objects from the recycle bin. You can specify either the name of the table in the <a id="d73614e1975" class="indexterm-anchor"></a><a id="d73614e1979" class="indexterm-anchor"></a>recycle bin or the original table name.</p>
<p>This section assumes a scenario in which you drop the wrong table. Many times you have been asked to drop tables in the test databases, but in this case you accidentally connect to the production database instead and drop <code class="codeph">hr.employee_demo</code>. You decide to use <code class="codeph">FLASHBACK TABLE</code> to retrieve the dropped object.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To retrieve a dropped table:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Ensure that the prerequisites described in <a href="rcmflash.htm#GUID-F5B66BE0-4941-4513-821B-74F7ACB6489E">Prerequisites of Flashback Drop</a> are met.</span></li>
<li class="stepexpand"><span>Connect SQL*Plus to the target database and obtain the name of the dropped table in the recycle bin.</span>
<div>
<p>You can use the SQL*Plus command <code class="codeph">SHOW RECYCLEBIN</code> as follows:</p>
<pre dir="ltr">SHOW RECYCLEBIN;

ORIGINAL NAME    RECYCLEBIN NAME                   TYPE         DROP TIME
---------------- --------------------------------- ------------ -------------
EMPLOYEE_DEMO    BIN$gk3lsj/3akk5hg3j2lkl5j3d==$0  TABLE    2013-04-11:17:08:54
</pre>
<p>The <code class="codeph">ORIGINAL NAME</code> column shows the original name of the object, whereas the <code class="codeph">RECYCLEBIN NAME</code> column shows the name of the object as it exists in the bin.</p>
<p>Alternatively, you can query <code class="codeph">USER_RECYCLEBIN</code> or <code class="codeph">DBA_RECYCLEBIN</code> to obtain the table name. The following example queries the <code class="codeph">RECYCLEBIN</code> view to determine the original names of dropped objects:</p>
<pre dir="ltr">SELECT object_name AS recycle_name, original_name, type 
FROM   recyclebin;

RECYCLE_NAME                      ORIGINAL_NAME          TYPE
--------------------------------  ---------------------  ----------
BIN$gk3lsj/3akk5hg3j2lkl5j3d==$0  EMPLOYEE_DEMO          TABLE
BIN$JKS983293M1dsab4gsz/I249==$0  I_EMP_DEMO             INDEX
</pre>
<p>If you plan to manually restore original names for dependent objects, then ensure that you make note of each dependent object&#39;s system-generated recycle bin name before you restore the table.</p>
<div class="infobox-note" id="GUID-6AED5A17-B29C-4F92-80C0-49F06A62DE4F__GUID-0D3C2A73-76B9-410C-8654-0055FA9D0511">
<p class="notep1">Note:</p>
<p>Object views such as <code class="codeph">DBA_TABLES</code> do not display the recycle bin objects.</p>
</div>
</div>
</li>
<li class="stepexpand"><span>Optionally, query the table in the recycle bin.</span>
<div>
<p>You must use the recycle bin name of the object in your query rather than the object&#39;s original name. The following example queries the table with the recycle bin name of <code class="codeph">BIN$gk3lsj/3akk5hg3j2lkl5j3d==$0</code>:</p>
<pre dir="ltr">SELECT * 
FROM  &#34;BIN$gk3lsj/3akk5hg3j2lkl5j3d==$0&#34;;
</pre>
<p>Quotation marks are required because of the special characters in the recycle bin name.</p>
<div class="infobox-note" id="GUID-6AED5A17-B29C-4F92-80C0-49F06A62DE4F__GUID-F65AC0E0-BB55-49FA-B1DA-4BACCA92084C">
<p class="notep1">Note:</p>
<p>If you have the necessary privileges, then you can also use Flashback Query on tables in the recycle bin, but only by using the recycle bin name rather than the original table name. You cannot use Data Manipulation Language (DML) or DDL statements on objects in the recycle bin.</p>
</div>
</div>
</li>
<li class="stepexpand"><span>Retrieve the dropped table.</span>
<div>
<p>Use the <code class="codeph">FLASHBACK TABLE ... TO BEFORE DROP</code> statement. The following example restores the <code class="codeph">BIN$gk3lsj/3akk5hg3j2lkl5j3d==$0</code> table, changes its name back to <code class="codeph">hr.employee_demo</code>, and purges its entry from the recycle bin:</p>
<pre dir="ltr">FLASHBACK TABLE &#34;BIN$gk3lsj/3akk5hg3j2lkl5j3d==$0&#34; TO BEFORE DROP;
</pre>
<p>The table name is enclosed in quotation marks because of the possibility of special characters appearing in the recycle bin object names.</p>
<p>Alternatively, you can use the original name of the table:</p>
<pre dir="ltr">FLASHBACK TABLE HR.EMPLOYEE_DEMO TO BEFORE DROP;
</pre>
<p>You can also assign a new name to the restored table by specifying the <code class="codeph">RENAME TO</code> clause. For example:</p>
<pre dir="ltr">FLASHBACK TABLE &#34;BIN$gk3lsj/3akk5hg3j2lkl5j3d==$0&#34; TO BEFORE DROP 
  RENAME TO hr.emp_demo;
</pre></div>
</li>
<li class="stepexpand"><span>Optionally, verify that all dependent objects retained their system-generated recycle bin names.</span>
<div>
<p>The following query determines the names of the indexes of the retrieved <code class="codeph">hr.employee_demo</code> table:</p>
<pre dir="ltr">SELECT INDEX_NAME 
FROM   USER_INDEXES 
WHERE  TABLE_NAME = &#39;EMPLOYEE_DEMO&#39;;

INDEX_NAME
------------------------------
BIN$JKS983293M1dsab4gsz/I249==$0
</pre></div>
</li>
<li class="stepexpand"><span>Optionally, rename the retrieved indexes to their original names.</span>
<div>
<p>The following statement renames the index to its original name of <code class="codeph">i_emp_demo</code>:</p>
<pre dir="ltr">ALTER INDEX &#34;BIN$JKS983293M1dsab4gsz/I249==$0&#34; RENAME TO I_EMP_DEMO;
</pre></div>
</li>
<li class="stepexpand"><span>If the retrieved table had referential constraints before it was placed in the recycle bin, then re-create them.</span>
<div>
<p>This step must be performed manually because the recycle bin does not preserve referential constraints on a table.</p>
</div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-6AED5A17-B29C-4F92-80C0-49F06A62DE4F__GUID-FA2CD6BF-F83C-4CEC-80E6-57FCEA964621">
<p class="notep1">See Also:</p>
<p><a href="rcmflash.htm#GUID-C4927875-8F00-4AC7-8DDE-A56C3EEFE8AE">Retrieving Objects Using Flashback Drop When Multiple Objects Share the Same Original Name</a></p>
</div>
</div>
<!-- class="section" --></div>
<a id="BRADV343"></a><a id="BRADV344"></a><a id="BRADV89749"></a>
<div class="props_rev_3"><a id="GUID-C4927875-8F00-4AC7-8DDE-A56C3EEFE8AE"></a>
<h4 id="BRADV-GUID-C4927875-8F00-4AC7-8DDE-A56C3EEFE8AE" class="sect4">Retrieving Objects Using Flashback Drop When Multiple Objects Share the Same Original Name</h4>
<div>
<div class="section">
<p>You can create, and then drop, several objects with the same original name. All dropped objects are stored in the recycle bin. For example, consider the SQL statements in <a href="rcmflash.htm#GUID-C4927875-8F00-4AC7-8DDE-A56C3EEFE8AE__CHDHFEHA">Example 18-1</a>.</p>
<div class="infoboxnotealso" id="GUID-C4927875-8F00-4AC7-8DDE-A56C3EEFE8AE__GUID-2A284595-F74F-4908-80B5-F074EB8268DB">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink ADMIN01511" target="_blank" href="../ADMIN/tables.htm#ADMIN01511"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> to learn how to use Flashback Drop and manage the recycle bin</p>
</li>
<li>
<p><a class="olink SQLRF01802" target="_blank" href="../SQLRF/statements_9013.htm#SQLRF01802"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about the <code class="codeph">FLASHBACK TABLE</code> statement</p>
</li>
</ul>
</div>
</div>
<!-- class="section" -->
<div class="example" id="GUID-C4927875-8F00-4AC7-8DDE-A56C3EEFE8AE__CHDHFEHA">
<p class="titleinexample">Example 18-1 Dropping Multiple Objects with the Same Name</p>
<pre dir="ltr">CREATE TABLE temp_employees ( <span class="italic">...columns</span> ); # temp_employees version 1
DROP TABLE temp_employees;

CREATE TABLE temp_employees ( <span class="italic">...columns</span> ); # temp_employees version 2
DROP TABLE temp_employees;

CREATE TABLE temp_employees ( <span class="italic">...columns</span> ); # temp_employees version 3
DROP TABLE temp_employees;
</pre>
<p>In <a href="rcmflash.htm#GUID-C4927875-8F00-4AC7-8DDE-A56C3EEFE8AE__CHDHFEHA">Example 18-1</a>, each table <code class="codeph">temp_employees</code> is assigned a unique name in the recycle bin when it is dropped. You can use a <code class="codeph">FLASHBACK TABLE ... TO BEFORE DROP</code> statement with the original name of the table, as shown in this example:</p>
<pre dir="ltr">FLASHBACK TABLE temp_employees TO BEFORE DROP;
</pre>
<p>The most recently dropped table with this original name is retrieved from the recycle bin, with its original name. <a href="rcmflash.htm#GUID-C4927875-8F00-4AC7-8DDE-A56C3EEFE8AE__CHDHFEBA">Example 18-2</a> shows the retrieval from the recycle bin of all three dropped <code class="codeph">temp_employees</code> tables from the previous example, with each assigned a new name.</p>
</div>
<!-- class="example" -->
<div class="example" id="GUID-C4927875-8F00-4AC7-8DDE-A56C3EEFE8AE__CHDHFEBA">
<p class="titleinexample">Example 18-2 Renaming Dropped Tables</p>
<pre dir="ltr">FLASHBACK TABLE temp_employees TO BEFORE DROP 
  RENAME TO temp_employees_VERSION_3;
FLASHBACK TABLE temp_employees TO BEFORE DROP 
  RENAME TO temp_employees_VERSION_2;
FLASHBACK TABLE temp_employees TO BEFORE DROP 
  RENAME TO temp_employees_VERSION_1;
</pre>
<p>Because the original name in <code class="codeph">FLASHBACK</code> <code class="codeph">TABLE</code> refers to the most recently dropped table with this name, the last table dropped is the first retrieved.</p>
<p>You can also retrieve any table from the recycle bin, regardless of any collisions among original names, by using the unique recycle bin name of the table. For example, assume that you query the recycle bin as follows (sample output included):</p>
<pre dir="ltr">SELECT object_name, original_name, createtime 
FROM   recyclebin;    

OBJECT_NAME                    ORIGINAL_NAME   CREATETIME
------------------------------ --------------- -------------------
BIN$yrMKlZaLMhfgNAgAIMenRA==$0 TEMP_EMPLOYEES  2013-02-05:21:05:52
BIN$yrMKlZaVMhfgNAgAIMenRA==$0 TEMP_EMPLOYEES  2013-02-05:21:25:13
BIN$yrMKlZaQMhfgNAgAIMenRA==$0 TEMP_EMPLOYEES  2013-02-05:22:05:53
</pre>
<p>You can use the following command to retrieve the middle table:</p>
<pre dir="ltr">FLASHBACK TABLE BIN$yrMKlZaVMhfgNAgAIMenRA==$0 TO BEFORE DROP;
</pre></div>
<!-- class="example" --></div>
</div>
</div>
</div>
<a id="BRADV81330"></a>
<div class="props_rev_3"><a id="GUID-953FA30D-BED2-4DBA-8361-9DA1B8FF073F"></a>
<h2 id="BRADV-GUID-953FA30D-BED2-4DBA-8361-9DA1B8FF073F" class="sect2">Rewinding a Database with Flashback Database</h2>
<div>
<p>This section explains the most common scenario for using Flashback Database to reverse unwanted changes to your database.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmflash.htm#GUID-6520BA73-8BFF-4D79-9970-589A2FDA0C82">Prerequisites of Flashback Database</a></p>
</li>
<li>
<p><a href="rcmflash.htm#GUID-3EB4D790-77C7-49CB-8D96-0940394E6BC8">Performing a Flashback Database Operation</a></p>
</li>
<li>
<p><a href="rcmflash.htm#GUID-0D37F61D-CA1B-48BB-97A0-3A33D527DBC6">Performing Flashback Database Operations on a CDB When a PDB Was Recovered Using DBPITR</a></p>
</li>
<li>
<p><a href="rcmflash.htm#GUID-93BF7DBC-2520-4C7D-B059-663F963B68DA">Monitoring Flashback Database</a></p>
</li>
</ul>
</div>
<a id="BRADV89751"></a>
<div class="props_rev_3"><a id="GUID-6520BA73-8BFF-4D79-9970-589A2FDA0C82"></a>
<h3 id="BRADV-GUID-6520BA73-8BFF-4D79-9970-589A2FDA0C82" class="sect3">Prerequisites of Flashback Database</h3>
<div>
<p><a id="d73614e2433" class="indexterm-anchor"></a>To use the <code class="codeph">FLASHBACK</code> <code class="codeph">DATABASE</code> command to return your database contents to points in time within the flashback window, your database must have been previously configured for flashback logging as described in <span class="q">&#34;<a href="flashdb.htm#GUID-FAA04D1F-36E2-4B20-954F-845E42386775">Overview of Flashback Database_ Restore Points and Guaranteed Restore Points</a>&#34;</span>. To return the database to a guaranteed restore point, you must have previously defined a guaranteed restore point as described in <span class="q">&#34;<a href="flashdb.htm#GUID-2C846D84-EDCC-4FAA-9F6A-05CD0C6C7C09">Using Normal and Guaranteed Restore Points</a>&#34;</span>.</p>
<p>Flashback Database works by undoing changes to the data files that exist at the moment that you run the command. Note the following important prerequisites:</p>
<ul style="list-style-type: disc;">
<li>
<p>No current data files are lost or damaged. You can only use <code class="codeph">FLASHBACK DATABASE</code> to rewind changes to a data file made by an Oracle database, not to repair media failures.</p>
</li>
<li>
<p>You are not trying to recover from accidental deletion of data files, undo a shrink data file operation, or undo a change to the database name.</p>
</li>
<li>
<p>You are not trying to use <code class="codeph">FLASHBACK</code> <code class="codeph">DATABASE</code> to return to a point in time before the restore or re-creation of a control file. If the database control file is restored from backup or re-created, then all accumulated flashback log information is discarded.</p>
</li>
<li>
<p>You are not trying to use <code class="codeph">FLASHBACK</code> <code class="codeph">DATABASE</code> to undo a compatibility change.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-6520BA73-8BFF-4D79-9970-589A2FDA0C82__GUID-880F43E7-D0BE-4E33-9F13-9E50CEF4426A">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF194" target="_blank" href="../RCMRF/rcmsynta023.htm#RCMRF194"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for a complete list of command prerequisites and usage notes for <code class="codeph">FLASHBACK DATABASE</code></p>
</div>
</div>
</div>
<a id="BRADV345"></a><a id="BRADV89752"></a>
<div class="props_rev_3"><a id="GUID-3EB4D790-77C7-49CB-8D96-0940394E6BC8"></a>
<h3 id="BRADV-GUID-3EB4D790-77C7-49CB-8D96-0940394E6BC8" class="sect3">Performing a Flashback Database Operation</h3>
<div>
<div class="section">
<p>This section presents a basic technique for performing a flashback of the database, specifying the desired target point in time with a time expression, the name of a normal or guaranteed restore point, or an SCN.</p>
<p>This scenario assumes that you are rewinding the database to a point in time within the current database <a id="d73614e2567" class="indexterm-anchor"></a><a href="glossary.htm#GUID-4CCAB7DD-FEA7-4237-AF2C-304BA3BD52B1"><span class="xrefglossterm">incarnation</span></a>. To return the database to the point in time immediately before the most <a id="d73614e2575" class="indexterm-anchor"></a>recent <code class="codeph">OPEN</code> <code class="codeph">RESETLOGS</code> operation, see <span class="q">&#34;<a href="rcmflash.htm#GUID-7E39909E-E2D5-4D08-ADD8-0D5FEF028489">Rewinding an OPEN RESETLOGS Operation with Flashback Database</a>&#34;</span>.</p>
<p>By default, an SCN used in a <code class="codeph">FLASHBACK DATABASE</code> command refers to an SCN in the <a id="d73614e2596" class="indexterm-anchor"></a><a href="glossary.htm#GUID-9FA6E4CA-C9C0-47E8-8FDF-2C2A313F8944"><span class="xrefglossterm">direct ancestral path</span></a> of the database incarnations. As explained in <span class="q">&#34;<a href="rcmrvcon.htm#GUID-9942AC94-A35D-4A06-9A45-A5A43B82B23D">About Database Incarnations</a>&#34;</span>, an incarnation is in this path if it was not abandoned after the database was previously opened with the <code class="codeph">RESETLOGS</code> option. To retrieve changes in abandoned incarnations, see <span class="q">&#34;<a href="rcmflash.htm#GUID-CECE183D-C000-485A-99DA-371768A79011">Rewinding the Database to an SCN in an Abandoned Incarnation Branch</a>&#34;</span>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To perform a Flashback Database operation:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Ensure that the prerequisites described in <a href="rcmflash.htm#GUID-6520BA73-8BFF-4D79-9970-589A2FDA0C82">Prerequisites of Flashback Database</a> are met.</span></li>
<li class="stepexpand"><span>Connect SQL*Plus to the target database and determine the desired SCN, restore point, or point in time for <a id="d73614e2629" class="indexterm-anchor"></a>the <code class="codeph">FLASHBACK</code> <code class="codeph">DATABASE</code> command.</span>
<div>
<p><a id="d73614e2640" class="indexterm-anchor"></a>Obtain the earliest SCN in the flashback database window as <a id="d73614e2645" class="indexterm-anchor"></a>follows:</p>
<pre dir="ltr">SELECT OLDEST_FLASHBACK_SCN, OLDEST_FLASHBACK_TIME
FROM   V$FLASHBACK_DATABASE_LOG;
</pre>
<p>The most recent SCN that can be reached with Flashback Database is the current SCN of the database. The following query returns the current SCN:</p>
<pre dir="ltr">SELECT CURRENT_SCN
FROM   V$DATABASE;
</pre>
<p>You can query available guaranteed restore points as follows (sample output included):</p>
<pre dir="ltr">SELECT NAME, SCN, TIME, DATABASE_INCARNATION#,
       GUARANTEE_FLASHBACK_DATABASE
FROM   V$RESTORE_POINT
WHERE  GUARANTEE_FLASHBACK_DATABASE=&#39;YES&#39;;
 
NAME                   SCN TIME                  DATABASE_INCARNATION# GUA
--------------- ---------- --------------------- --------------------- ---
BEFORE_CHANGES     5753126 04-MAR-12 12.39.45 AM                     2 YES
</pre>
<div class="infobox-note" id="GUID-3EB4D790-77C7-49CB-8D96-0940394E6BC8__GUID-53270E0A-7FA0-4E47-B7F1-C623688E40C6">
<p class="notep1">Note:</p>
<p>If the flashback window does not extend far enough back into the past to reach the desired target time, and if you do not have a guaranteed restore point at the desired time, then you can achieve similar results by using database point-in-time recovery, as described in <span class="q">&#34;<a href="rcmflash.htm#GUID-7D3EE2F7-77A2-4264-8875-CC0AEC64ABE0">Performing Database Point-in-Time Recovery</a>&#34;</span>.</p>
</div>
</div>
</li>
<li class="stepexpand"><span>Shut down the database consistently, ensure that it is not opened by any instance, and then mount it:</span>
<div>
<pre dir="ltr">SHUTDOWN IMMEDIATE;
STARTUP MOUNT;
</pre></div>
</li>
<li class="stepexpand"><span>Repeat the query in Step 2 of this procedure.</span>
<div>
<p>Some flashback logging data is generated when the database is shut down. If flashback logs were deleted due to space pressure in the fast recovery area, then your target SCN may not be reachable.</p>
<div class="infobox-note" id="GUID-3EB4D790-77C7-49CB-8D96-0940394E6BC8__GUID-E7475A65-085D-4DA5-AC8C-FB3054E15F49">
<p class="notep1">Note:</p>
<p>If you run <code class="codeph">FLASHBACK</code> <code class="codeph">DATABASE</code> when your target SCN is outside the flashback window, then <code class="codeph">FLASHBACK</code> <code class="codeph">DATABASE</code> fails with an <code class="codeph">ORA-38729</code> error. In this case your database does not change.</p>
</div>
</div>
</li>
<li class="stepexpand"><span>Start RMAN and connect to the target database.</span>
<div>
<div class="infoboxnotealso" id="GUID-3EB4D790-77C7-49CB-8D96-0940394E6BC8__GUID-02E26C06-6FAD-4939-8F93-F86EB4835D70">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmcnctg.htm#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C">Making Database Connections with RMAN</a>&#34;</span></p>
</div>
</div>
</li>
<li class="stepexpand"><span>Run the <code class="codeph">SHOW</code> command to see which channels are preconfigured.</span>
<div>
<p>During the flashback operation, RMAN may need to restore archived redo logs from backup. Enter the following command to see whether channels are configured (sample output is included):</p>
<pre dir="ltr">SHOW ALL;

RMAN configuration parameters for database with db_unique_name PROD1 are:
.
.
.
CONFIGURE DEFAULT DEVICE TYPE TO DISK; # default
CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO BACKUPSET; # default
CONFIGURE DEVICE TYPE SBT_TAPE PARALLELISM 1 BACKUP TYPE TO BACKUPSET; # default
CONFIGURE CHANNEL DEVICE TYPE &#39;SBT_TAPE&#39; PARMS  &#34;SBT_LIBRARY=/usr/local/oracle/backup/lib/libobk.so&#34;;
</pre>
<p>If the necessary devices and channels are configured, then no action is necessary. Otherwise, use the <code class="codeph">CONFIGURE</code> command to configure automatic channels, or include <code class="codeph">ALLOCATE CHANNEL</code> commands within a <code class="codeph">RUN</code> block.</p>
</div>
</li>
<li class="stepexpand"><span>Run the RMAN <code class="codeph">FLASHBACK DATABASE</code> command.</span>
<div>
<p>You can specify the target time by using a form of the command shown in the following examples:</p>
<pre dir="ltr">FLASHBACK DATABASE TO SCN 46963;

FLASHBACK DATABASE 
  TO RESTORE POINT BEFORE_CHANGES;

FLASHBACK DATABASE TO TIME   
  &#34;TO_DATE(&#39;09/20/12&#39;,&#39;MM/DD/YY&#39;)&#34;;
</pre>
<p>When the <code class="codeph">FLASHBACK</code> <code class="codeph">DATABASE</code> command completes, the database is left mounted and recovered to the specified target time.</p>
</div>
</li>
<li class="stepexpand"><span>Open the database read-only in SQL*Plus and run some queries to verify the database contents.</span>
<div>
<p>Open the database read-only as follows:</p>
<pre dir="ltr">ALTER DATABASE OPEN READ ONLY;
</pre>
<p>If you are satisfied with the state of the database, then end the procedure with Step 9. If you are <span class="italic">not</span> satisfied with the state of the database, skip to Step 10.</p>
</div>
</li>
<li class="stepexpand" id="GUID-3EB4D790-77C7-49CB-8D96-0940394E6BC8__CHDGDJAC"><span>If you are satisfied with the results, then perform either of the following mutually exclusive actions:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p>Make the database available for updates by opening the database with the <code class="codeph">RESETLOGS</code> option. If the database is currently open read-only, then execute the following commands in SQL*Plus:</p>
<pre dir="ltr">SHUTDOWN IMMEDIATE
STARTUP MOUNT
ALTER DATABASE OPEN RESETLOGS;
</pre>
<div class="infobox-note" id="GUID-3EB4D790-77C7-49CB-8D96-0940394E6BC8__GUID-FF820FDC-E2BB-4A02-A447-7B5FD1D6CE59">
<p class="notep1">Note:</p>
<p>After you perform this <code class="codeph">OPEN</code> <code class="codeph">RESETLOGS</code> operation, all changes to the database after the target SCN for <code class="codeph">FLASHBACK</code> <code class="codeph">DATABASE</code> are abandoned. Nevertheless, you can use the technique in <span class="q">&#34;<a href="rcmflash.htm#GUID-CECE183D-C000-485A-99DA-371768A79011">Rewinding the Database to an SCN in an Abandoned Incarnation Branch</a>&#34;</span> to return the database to that range of SCNs while they remain in the flashback window.</p>
</div>
</li>
<li>
<p>Use Oracle Data Pump Export to make a logical backup of the objects whose state was corrupted. Afterward, use RMAN to recover the database to the present time:</p>
<pre dir="ltr">RECOVER DATABASE;
</pre>
<p>This step undoes the effect of the Flashback Database by reapplying all changes in the redo logs to the database, returning it to the most recent SCN.</p>
<p>After reopening the database read/write, you can import the exported objects with the <a id="d73614e2801" class="indexterm-anchor"></a>Data Pump Import utility. See <a class="olink SUTIL100" target="_blank" href="../SUTIL/GUID-17FAE261-0972-4220-A2E4-44D479F519D4.htm#SUTIL100"><span class="italic">Oracle Database Utilities</span></a> to learn how to use Data Pump.</p>
</li>
</ul>
</div>
</li>
<li class="stepexpand" id="GUID-3EB4D790-77C7-49CB-8D96-0940394E6BC8__CHDHCDBD"><span>If you find that you used the wrong restore point, time, or SCN for the flashback, then mount the database and perform one of the following mutually exclusive options:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p>If your chosen target time was not far enough in the past, then use another <code class="codeph">FLASHBACK</code> <code class="codeph">DATABASE</code> command to rewind the database further back in time:</p>
<pre dir="ltr">FLASHBACK DATABASE TO SCN 42963;  #earlier than current SCN 
</pre></li>
</ul>
<ul style="list-style-type: disc;">
<li>
<p>If you chose a target SCN that is too far in the past, then use <code class="codeph">RECOVER</code> <code class="codeph">DATABASE</code> <code class="codeph">UNTIL</code> to wind the database forward in time to the desired SCN:</p>
<pre dir="ltr">RECOVER DATABASE UNTIL SCN 56963; #later than current SCN 
</pre></li>
</ul>
<ul style="list-style-type: disc;">
<li>
<p>If you want to completely undo the effect of the <code class="codeph">FLASHBACK</code> <code class="codeph">DATABASE</code> command, then you can perform complete recovery of the database by using the <code class="codeph">RECOVER</code> <code class="codeph">DATABASE</code> command without an <code class="codeph">UNTIL</code> clause or <code class="codeph">SET UNTIL</code> command:</p>
<pre dir="ltr">RECOVER DATABASE;
</pre>
<p>The <code class="codeph">RECOVER DATABASE</code> command reapplies all changes to the database, returning it to the most recent SCN.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<a id="BRADV801"></a><a id="BRADV800"></a>
<div class="props_rev_3"><a id="GUID-0D37F61D-CA1B-48BB-97A0-3A33D527DBC6"></a>
<h3 id="BRADV-GUID-0D37F61D-CA1B-48BB-97A0-3A33D527DBC6" class="sect3">Performing Flashback Database Operations on a CDB When a PDB Was Recovered Using DBPITR</h3>
<div>
<div class="section">
<p>To maintain backward compatibility in Oracle Database 12<span class="italic">c</span> Release 1 (12.1), Flashback Database operations on a <a href="glossary.htm#GUID-3E156A59-F6CC-4A2A-9749-DB7D1CE25F13"><span class="xrefglossterm">multitenant container database (CDB)</span></a> may not be permitted if point-in-time recovery has been performed on any of its <a href="glossary.htm#GUID-993BFB3F-3305-481C-999D-26132095DEC9"><span class="xrefglossterm">PDB</span></a>s. When point-in-time recovery is performed on a PDB, you cannot directly rewind the CDB to a point that is earlier than the point at which DBPITR for the PDB was performed. If you attempt to do so, the following error is displayed:</p>
<p><code class="codeph">ORA-39866: Data files for pluggable database &lt;PDB_name&gt; must be offline to flashback across a PDB point-in-time recovery</code></p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To perform a flashback of a CDB to a point that is beyond the point in time to which a DBPITR operation was performed on the PDB:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to the root as a user with the <code class="codeph">SYSBACKUP</code> or <code class="codeph">SYSDBA</code> privilege.</span>
<div>
<div class="infoboxnotealso" id="GUID-0D37F61D-CA1B-48BB-97A0-3A33D527DBC6__GUID-DAB667EA-07F7-46C1-86A7-123124844FEE">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmcnctg.htm#GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD">Making RMAN Connections to a CDB</a>&#34;</span></p>
</div>
</div>
</li>
<li class="stepexpand"><span>Determine the target time to which the CDB must be recovered.</span></li>
<li class="stepexpand"><span>Take all files that correspond to the PDB for which PITR was performed offline.</span>
<div>
<p>Use the <code class="codeph">ALTER PLUGGABLE DATABASE</code> command to take the files offline</p>
</div>
</li>
<li class="stepexpand"><span>Rewind the CDB to the desired target time. This operation does not affect the PDB whose files are offline.</span>
<div>
<p>Use the <code class="codeph">FLASHBACK DATABASE</code> command to rewind the CDB.</p>
</div>
</li>
<li class="stepexpand"><span>Recover the PDB for which PITR was performed.</span>
<div>
<p>Use the <code class="codeph">RESTORE PLUGGABLE DATABASE</code> and <code class="codeph">RECOVER PLUGGABLE DATABASE</code> commands.</p>
</div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-0D37F61D-CA1B-48BB-97A0-3A33D527DBC6__GUID-58B3CD8F-76AD-427D-B0B6-9E8209B093D0">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmflash.htm#GUID-C17EC2DE-3B5F-483B-85FB-D7E4999542D0">Example: Rewinding a CDB to a Point that is Beyond the Point in Time to Which a PDB Was Recovered</a>&#34;</span> for the commands used perform each step</p>
</div>
</div>
<!-- class="section" --></div>
<a id="BRADV802"></a>
<div class="props_rev_3"><a id="GUID-C17EC2DE-3B5F-483B-85FB-D7E4999542D0"></a>
<h4 id="BRADV-GUID-C17EC2DE-3B5F-483B-85FB-D7E4999542D0" class="sect4">Example: Rewinding a CDB to a Point that is Beyond the Point in Time to Which a PDB Was Recovered</h4>
<div>
<div class="section">
<p>Assume that a CDB contains the following PDBs: <code class="codeph">pdb1</code>, <code class="codeph">pdb2</code>, <code class="codeph">pdb3</code>, and <code class="codeph">pdb4</code>. DBPITR was performed on <code class="codeph">pdb2</code> and this PDB was opened with the <code class="codeph">RESETLOGS</code> option when the SCN was 128756. You can perform a flashback of the whole CDB to a point in time when the SCN is greater than 128756. However, you cannot directly perform a flashback of the whole CDB to a point when the SCN is lower than 128756. Use the following steps to flashback the whole CDB to a point in time when the SCN was 128048:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Connect to the root as a user with the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege.</span>
<div>
<div class="infoboxnotealso" id="GUID-C17EC2DE-3B5F-483B-85FB-D7E4999542D0__GUID-C0A4483A-B83E-4C38-9E31-ABD14346D9E6">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmcnctg.htm#GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD">Making RMAN Connections to a CDB</a>&#34;</span></p>
</div>
</div>
</li>
<li class="stepexpand"><span>Determine the target time to which a Flashback Database operation must be performed on the CDB.</span>
<div>
<p>In this example, the target time is the time when the SCN was 128048.</p>
</div>
</li>
<li class="stepexpand"><span>Take all the files corresponding to <code class="codeph">pdb2</code> offline using the following command:</span>
<div>
<pre dir="ltr">ALTER PLUGGABLE DATABASE PDB2 DATAFILE ALL OFFLINE;
</pre></div>
</li>
<li class="stepexpand"><span>Shut down the CDB and bring it to a mounted state as follows:</span>
<div>
<pre dir="ltr">SHUTDOWN;
STARTUP MOUNT;
</pre></div>
</li>
<li class="stepexpand"><span>Rewind the CDB to the desired point in time.</span>
<div>
<p>The following command performs a flashback of the whole CDB to the point when the SCN was 128048.</p>
<pre dir="ltr">FLASHBACK DATABASE TO SCN 128048;
</pre></div>
</li>
<li class="stepexpand"><span>Make the CDB available for updates by opening the CDB with the <code class="codeph">RESETLOGS</code> option.</span>
<div>
<p>Open the CDB as follows:</p>
<pre dir="ltr">ALTER DATABASE OPEN RESETLOGS;
</pre></div>
</li>
<li class="stepexpand"><span>Restore and recover the PDB <code class="codeph">pdb2</code>. This includes restoring the PDB, making its file online, and then performing a complete recovery of the PDB.</span>
<div>
<p>The following commands restore and recover <code class="codeph">pdb2</code> and then open this PDB:</p>
<pre dir="ltr">RESTORE PLUGGABLE DATABASE PDB2;
ALTER PLUGGABLE DATABASE PDB2 DATAFILE ALL ONLINE;
RECOVER PLUGGABLE DATABASE PDB2;
ALTER PLUGGABLE DATABASE PDB2 OPEN;
</pre></div>
</li>
</ol>
</div>
</div>
</div>
<a id="BRADV604"></a><a id="BRADV603"></a>
<div class="props_rev_3"><a id="GUID-93BF7DBC-2520-4C7D-B059-663F963B68DA"></a>
<h3 id="BRADV-GUID-93BF7DBC-2520-4C7D-B059-663F963B68DA" class="sect3">Monitoring Flashback Database</h3>
<div>
<div class="section">
<p>When you use Flashback Database to rewind a database to a past target time, Flashback Database determines which blocks changed after the target time and restores them from the flashback logs. This is called the <span class="bold">restore phase</span>. After this phase completes, Flashback Database then uses redo logs to reapply changes that were made after these blocks were written to the flashback logs. This is called the <span class="bold">recovery phase</span>.</p>
<p>The progress of Flashback Database during the restore phase can be monitored by querying the <code class="codeph">V$SESSION_LONGOPS</code> view. The <code class="codeph">opname</code> is <code class="codeph">Flashback Database</code>. Under the column <code class="codeph">TOTALWORK</code> is the number of megabytes of flashback logs that must be read. The column <code class="codeph">SOFAR</code> in <a href="rcmflash.htm#GUID-93BF7DBC-2520-4C7D-B059-663F963B68DA__CHDBEJEJ">Example 18-3</a> lists the number of megabytes that have been currently read.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-93BF7DBC-2520-4C7D-B059-663F963B68DA__CHDBEJEJ">
<p class="titleinexample">Example 18-3 Tracking Flashback Database Progress - Restore Phase</p>
<pre dir="ltr">SQL&gt; SELECT sofar, totalwork, units FROM v$session_longops WHERE opname = &#39;Flashback Database&#39;;
 
SOFAR  TOTALWORK  UNITS
-----  ---------- --------------------------------
   17          60 Megabytes
</pre>
<p>The progress of Flashback Database during the recovery phase can be monitored by querying the view <code class="codeph">V$RECOVERY_PROGRESS</code>.</p>
<div class="infoboxnotealso" id="GUID-93BF7DBC-2520-4C7D-B059-663F963B68DA__GUID-63FBF987-0E46-457E-81D1-01B5CE01523C">
<p class="notep1">See Also:</p>
<p>The <a class="olink REFRN30199" target="_blank" href="../REFRN/GUID-B200FEC9-574F-4636-8DA6-2A560369760E.htm#REFRN30199"><span class="italic">Oracle Database Reference</span></a> for information about the view <code class="codeph">V$RECOVERY_PROGRESS</code></p>
</div>
</div>
<!-- class="example" --></div>
</div>
</div>
<a id="BRADV84152"></a>
<div class="props_rev_3"><a id="GUID-7D3EE2F7-77A2-4264-8875-CC0AEC64ABE0"></a>
<h2 id="BRADV-GUID-7D3EE2F7-77A2-4264-8875-CC0AEC64ABE0" class="sect2">Performing Database Point-in-Time Recovery</h2>
<div>
<p><a id="d73614e3380" class="indexterm-anchor"></a><a id="d73614e3382" class="indexterm-anchor"></a><a id="d73614e3384" class="indexterm-anchor"></a><a id="d73614e3388" class="indexterm-anchor"></a><a id="d73614e3392" class="indexterm-anchor"></a>RMAN DBPITR restores the database from backups before the target time for recovery, then uses incremental backups and redo to roll the database forward to the target time. You can recover to an SCN, time, log sequence number, or restore point. Oracle recommends that you create restore points at important times to make point-in-time recovery more manageable if it ever becomes necessary.</p>
<p>Oracle recommends that you perform Flashback Database rather than database point-in-time recovery if possible. Media recovery with backups are the last option when flashback technologies cannot be used to undo the most recent changes.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmflash.htm#GUID-2CF6EEFB-0344-4FD6-9BBB-F2D241172BC6">Prerequisites of Database Point-in-Time Recovery</a></p>
</li>
<li>
<p><a href="rcmflash.htm#GUID-5B964EB6-B498-4A0D-B480-5C6E0BACFA5D">Performing Database Point-in-Time Recovery</a></p>
</li>
<li>
<p><a href="rcmflash.htm#GUID-031D9695-A9D2-4381-A840-39BD3CC19946">Performing Point-in-Time Recovery of CDBs and PDBs</a></p>
</li>
</ul>
</div>
<a id="BRADV89753"></a>
<div class="props_rev_3"><a id="GUID-2CF6EEFB-0344-4FD6-9BBB-F2D241172BC6"></a>
<h3 id="BRADV-GUID-2CF6EEFB-0344-4FD6-9BBB-F2D241172BC6" class="sect3">Prerequisites of Database Point-in-Time Recovery</h3>
<div>
<p><a id="d73614e3484" class="indexterm-anchor"></a>The prerequisites for database point-in-time recovery (DBPITR) are as follows:</p>
<ul style="list-style-type: disc;">
<li>
<p>Your database must be running in <code class="codeph">ARCHIVELOG</code> mode.</p>
</li>
<li>
<p>You must have backups of all data files from before the target SCN for DBPITR and archived logs for the period between the SCN of the backups and the target SCN.</p>
</li>
<li>
<p>If the backups were encrypted using transparent encryption, and if a password-based software keystore was used, then the keystore password must be provided before the restore operation is performed. Use the <code class="codeph">SET</code> command with the <code class="codeph">DECRYPTION WALLET OPEN IDENTIFIED BY</code> option to specify the password that must be used to open the password-based keystore. Note that this command is not required when an auto-login software keystore is used.</p>
<div class="infoboxnotealso" id="GUID-2CF6EEFB-0344-4FD6-9BBB-F2D241172BC6__GUID-01DAD118-76C5-4914-B6EE-1668B9A5DE63">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF" target="_blank" href="../RCMRF/toc.htm"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for the syntax and usage of the <code class="codeph">SET</code> command</p>
</div>
</li>
</ul>
<p>For a complete account of command prerequisites and usage notes, refer to the <code class="codeph">RECOVER</code> entry in <a class="olink RCMRF140" target="_blank" href="../RCMRF/rcmsynta2001.htm#RCMRF140"><span class="italic">Oracle Database Backup and Recovery Reference</span></a>.</p>
</div>
</div>
<a id="BRADV346"></a><a id="BRADV89754"></a>
<div class="props_rev_3"><a id="GUID-5B964EB6-B498-4A0D-B480-5C6E0BACFA5D"></a>
<h3 id="BRADV-GUID-5B964EB6-B498-4A0D-B480-5C6E0BACFA5D" class="sect3">Performing Database Point-in-Time Recovery</h3>
<div>
<div class="section">
<p>This section explains the basic steps of DBPITR. The procedure makes the following assumptions:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>You are performing <a id="d73614e3605" class="indexterm-anchor"></a>DBPITR within the current database <a href="glossary.htm#GUID-4CCAB7DD-FEA7-4237-AF2C-304BA3BD52B1"><span class="xrefglossterm">incarnation</span></a>. If your target time is not in the current incarnation, then see <span class="q">&#34;<a href="rcmflash.htm#GUID-F1818201-98E5-4B70-BDFE-A61AB84397E6">Recovering the Database to an Ancestor Incarnation</a>&#34;</span> for more information about DBPITR to ancestor incarnations.</p>
</li>
<li>
<p>The control file is current. If you must restore a backup control file, then see <span class="q">&#34;<a href="rcmadvre.htm#GUID-77C2B092-4BEB-4BAC-91F9-7368EA16A2B6">Performing Recovery with a Backup Control File</a>&#34;</span>.</p>
</li>
<li>
<p>Your database is using the current server parameter file. If you must restore a backup server parameter file, then see <span class="q">&#34;<a href="rcmadvre.htm#GUID-2B93E1AF-5ED1-4FAE-91BB-63362CADF7AD">Restoring the Server Parameter File</a>&#34;</span>.</p>
</li>
</ul>
<p>When performing DBPITR, you can avoid errors by using the <code class="codeph">SET</code> <code class="codeph">UNTIL</code> command to set the target time at the beginning of the procedure, rather than specifying the <code class="codeph">UNTIL</code> clause on the <code class="codeph">RESTORE</code> and <code class="codeph">RECOVER</code> commands individually. This ensures that the data files restored from backup have time stamps early enough to be used in the subsequent <code class="codeph">RECOVER</code> operation.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To perform DBPITR:</p>
</div>
<!-- class="section" -->
<div class="section">
<ol>
<li>
<p>Ensure that the prerequisites described in <a href="rcmflash.htm#GUID-2CF6EEFB-0344-4FD6-9BBB-F2D241172BC6">Prerequisites of Database Point-in-Time Recovery</a> are met.</p>
</li>
<li>
<p>Determine the time, SCN, restore point, or log sequence that ends recovery.</p>
<p>You can use the Flashback Query features to help you identify when the logical corruption occurred. If you have a <a href="glossary.htm#GUID-2298E7F2-79F8-451F-B180-8A58300E29CB"><span class="xrefglossterm">flashback data archive</span></a> enabled for a table, then you can query data that existed far in the past.</p>
<p>You can also use the alert log to try to determine the time of the event from which you must recover.</p>
<p>Alternatively, you can use a SQL query to determine the log sequence number that contains the target SCN and then recover through this log. For example, run the following query to list the logs in the current database incarnation (sample output included)<a id="d73614e3683" class="indexterm-anchor"></a>:</p>
<pre dir="ltr">SELECT RECID, STAMP, THREAD#, SEQUENCE#, FIRST_CHANGE#
       FIRST_TIME, NEXT_CHANGE#
FROM   V$ARCHIVED_LOG
WHERE  RESETLOGS_CHANGE# =
       ( SELECT RESETLOGS_CHANGE#
         FROM   V$DATABASE_INCARNATION
         WHERE  STATUS = &#39;CURRENT&#39;);

RECID      STAMP      THREAD#    SEQUENCE#  FIRST_CHAN FIRST_TIM NEXT_CHANG
---------- ---------- ---------- ---------- ---------- --------- ----------
         1  344890611          1          1      20037 24-SEP-13      20043
         2  344890615          1          2      20043 24-SEP-13      20045
         3  344890618          1          3      20045 24-SEP-13      20046
</pre>
<p>For example, if you discover that a user accidentally dropped a tablespace at 9:02 a.m., then you can recover to 9 a.m., just before the drop occurred. You lose all changes to the database made after this time.</p>
</li>
<li>
<p>If you are using a target time expression instead of a target SCN, then ensure that the time format environment variables are appropriate before invoking RMAN.</p>
<p>The following are sample Globalization Support settings:</p>
<pre dir="ltr">NLS_LANG = american_america.us7ascii
NLS_DATE_FORMAT=&#34;Mon DD YYYY HH24:MI:SS&#34;
</pre></li>
<li>
<p>Connect RMAN to the target database and, if applicable, the recovery catalog database. Bring the database to a mounted state:</p>
<pre dir="ltr">SHUTDOWN IMMEDIATE;
STARTUP MOUNT;
</pre>
<div class="infoboxnotealso" id="GUID-5B964EB6-B498-4A0D-B480-5C6E0BACFA5D__GUID-8E05CFC8-31C6-45A1-B53D-7918C2AD5786">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmcnctg.htm#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C">Making Database Connections with RMAN</a>&#34;</span></p>
</div>
</li>
<li>
<p>Perform the following operations within a <code class="codeph">RUN</code> block:</p>
<ol>
<li>
<p>For DBPITR, use <code class="codeph">SET</code> <code class="codeph">UNTIL</code> to specify the target time, SCN, or log sequence number, or use <code class="codeph">SET</code> <code class="codeph">TO</code> to specify a restore point. If specifying a time, then use the date format specified in the <code class="codeph">NLS_LANG</code> and <code class="codeph">NLS_DATE_FORMAT</code> environment variables.</p>
</li>
<li>
<p>If automatic channels are not configured, then manually allocate disk and tape channels as needed.</p>
</li>
<li>
<p>Restore and recover the database.</p>
</li>
</ol>
<p>The following example performs DBPITR on the target database until SCN 1000:</p>
<pre dir="ltr">RUN
{ 
  SET UNTIL SCN 1000;    
  RESTORE DATABASE;
  RECOVER DATABASE;
}
</pre>
<p>As shown in the following examples, you can also use time expressions, restore points, or log sequence numbers to specify the <code class="codeph">SET</code> <code class="codeph">UNTIL</code> time:</p>
<pre dir="ltr">SET UNTIL TIME &#39;Nov 15 2013 09:00:00&#39;;
SET UNTIL SEQUENCE 9923;  
SET TO RESTORE POINT before_update;
</pre>
<p>If the operation completes without errors, then DBPITR has succeeded.</p>
</li>
<li id="GUID-5B964EB6-B498-4A0D-B480-5C6E0BACFA5D__CHDDBIJB">
<p>Perform either of the following mutually exclusive actions:</p>
<ul style="list-style-type: disc;">
<li>
<p>Open your database for read/write, abandoning all changes after the target SCN. In this case, you must shut down the database, mount it, and then execute the following command:</p>
<pre dir="ltr">ALTER DATABASE OPEN RESETLOGS;
</pre>
<p>The <code class="codeph">OPEN RESETLOGS</code> operation fails if a data file is offline unless the data file went offline normally or is read-only. You can bring files in read-only or offline normal tablespaces online after the <code class="codeph">RESETLOGS</code> because they do not need any redo.</p>
</li>
<li>
<p>Export one or more objects from your database with Data Pump Export. You can then recover the database to the current point in time and reimport the exported objects, thus returning these objects to their state before the unwanted change without abandoning all other changes.</p>
</li>
</ul>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV804"></a><a id="BRADV640"></a>
<div class="props_rev_3"><a id="GUID-031D9695-A9D2-4381-A840-39BD3CC19946"></a>
<h3 id="BRADV-GUID-031D9695-A9D2-4381-A840-39BD3CC19946" class="sect3">Performing Point-in-Time Recovery of CDBs and PDBs</h3>
<div>
<p>RMAN enables you to perform point-in-time recovery (PITR) of <a href="glossary.htm#GUID-3D253996-C2C0-449A-AFA2-85A9DA323FD3"><span class="xrefglossterm">CDB</span></a>s and <a href="glossary.htm#GUID-993BFB3F-3305-481C-999D-26132095DEC9"><span class="xrefglossterm">PDB</span></a>s. PITR for PDBs can only be performed using RMAN. If you are not using a recovery catalog, it is recommended that you turn on control file auto backups. Otherwise, PITR for PDBs may not work effectively when RMAN needs to undo data file additions or deletions.</p>
<p>The information in this chapter about PITR applies to CDBs, with the differences described in the following sections.</p>
<div class="section" id="GUID-031D9695-A9D2-4381-A840-39BD3CC19946__CHDIGGIB">
<p class="subhead3">About DBPITR of PDBs and the Fast Recovery Area</p>
</div>
<!-- class="section" -->
<p>When you perform DBPITR of a PDB, all the data files for this PDB are recovered in-place. However, to recover the PDB to the specified target time, RMAN also needs the <code class="codeph">UNDO</code> tablespace as it existed at the target time. Because the <code class="codeph">UNDO</code> tablespace is shared by all PDBs, it cannot be recovered in-place. RMAN restores the <code class="codeph">UNDO</code>, <code class="codeph">SYSTEM</code>, and <code class="codeph">SYSAUX</code> tablespaces in the root to an auxiliary database and then uses the undo information to recover the PDB to the target time.If a fast recovery is configured, Oracle Database uses it as the auxiliary destination. If the fast recovery area is not configured, then you must use the <code class="codeph">AUXILIARY DESTINATION</code> clause to specify the location used for auxiliary database files. Ensure that there is sufficient space in the fast recovery area to restore the root tablespaces and the undo tablespace. If the fast recovery area does not have the required space, use an alternate location by specifying the <code class="codeph">AUXILIARY DESTINATION</code> clause.</p>
<div class="p">The following sections contain the steps to perform point-in-time recovery in CDBs and PDBs:
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmflash.htm#GUID-7572C8E9-05B8-4BCC-823F-BD6763C51B11">Performing Point-in-Time Recovery of a Whole CDB</a></p>
</li>
<li>
<p><a href="rcmflash.htm#GUID-26CD7EC8-12AC-4073-BB8D-A68502112E48">Performing Point-in-Time Recovery of PDBs</a></p>
</li>
</ul>
</div>
</div>
<a id="BRADV806"></a><a id="BRADV805"></a>
<div class="props_rev_3"><a id="GUID-7572C8E9-05B8-4BCC-823F-BD6763C51B11"></a>
<h4 id="BRADV-GUID-7572C8E9-05B8-4BCC-823F-BD6763C51B11" class="sect4">Performing Point-in-Time Recovery of a Whole CDB</h4>
<div>
<div class="section">
<p>The steps to perform PITR of a whole CDB are similar to the ones used for <a href="glossary.htm#GUID-62A96A52-3B97-455A-A443-75B999DCAC94"><span class="xrefglossterm">non-CDB</span></a>s, with the differences described in this section.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To perform point-in-time recovery of a whole CDB:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Connect to the root as a <a href="glossary.htm#GUID-2B102186-15BD-443C-B375-8CB0D442CF5F"><span class="xrefglossterm">common user</span></a> with the common <code class="codeph">SYSBACKUP</code> or <code class="codeph">SYSDBA</code> privilege.</span>
<div>
<div class="infoboxnotealso" id="GUID-7572C8E9-05B8-4BCC-823F-BD6763C51B11__GUID-DF55F8BB-14DE-423F-95A1-33325C06F959">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmcnctg.htm#GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D">Connecting as Target to the Root</a>&#34;</span></p>
</div>
</div>
</li>
<li class="stepexpand"><span>Follow the procedures described in <span class="q">&#34;<a href="rcmflash.htm#GUID-5B964EB6-B498-4A0D-B480-5C6E0BACFA5D">Performing Database Point-in-Time Recovery</a>&#34;</span>.</span></li>
<li class="stepexpand"><span>Open all the PDBs.</span>
<div>
<p>PDBs are not opened when the CDB is opened. The following command, when connected to the <a href="glossary.htm#GUID-EA3DB8F4-F68E-4FC5-A599-32A4886FFF8A"><span class="xrefglossterm">root</span></a>, opens all the PDBs.</p>
<pre dir="ltr">ALTER PLUGGABLE DATABASE ALL OPEN;
</pre>
<p>You can open each PDB separately.</p>
</div>
</li>
</ol>
</div>
</div>
<a id="BRADV644"></a><a id="BRADV807"></a>
<div class="props_rev_3"><a id="GUID-26CD7EC8-12AC-4073-BB8D-A68502112E48"></a>
<h4 id="BRADV-GUID-26CD7EC8-12AC-4073-BB8D-A68502112E48" class="sect4">Performing Point-in-Time Recovery of PDBs</h4>
<div>
<div class="section">
<p>The steps to perform point-in-time recovery of PDBs are similar to the ones for performing DBPITR, with the differences described in this section. When you recover one or more PDBs to a specified point-in-time, the remaining PDBs in the CDB are not affected and they can be open and operational. After recovery, the old backups of the PDB remain valid and can be used if a media failure occurs. You do not need to create new backups.</p>
<p>If you have performed point-in-time recovery for a PDB, then you cannot directly flashback the whole CDB to a point that is beyond the point in time to which the PDB was recovered. You must use the steps described in <span class="q">&#34;<a href="rcmflash.htm#GUID-0D37F61D-CA1B-48BB-97A0-3A33D527DBC6">Performing Flashback Database Operations on a CDB When a PDB Was Recovered Using DBPITR</a>&#34;</span>.</p>
<p>When performing DBPITR on one or more PDBs in a CDB, backups of the root and the seed database (<code class="codeph">PDB$SEED</code>) of the CDB that contains the PDBs are required.</p>
<p>In a Data Guard environment, you may need to flash back the entire standby database or restore the PDB for the standby database to follow a primary database with a PDB that was restored to a point in time.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To perform DBPITR on a PDB:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Connect to the root as a user with the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege.</span>
<div>
<div class="infoboxnotealso" id="GUID-26CD7EC8-12AC-4073-BB8D-A68502112E48__GUID-FF6A9F6D-1D09-430D-B7D5-8ACD6F7D3F8A">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmcnctg.htm#GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD">Making RMAN Connections to a CDB</a>&#34;</span></p>
</div>
</div>
</li>
<li class="stepexpand"><span>Follow the procedures in <span class="q">&#34;<a href="rcmflash.htm#GUID-7D3EE2F7-77A2-4264-8875-CC0AEC64ABE0">Performing Database Point-in-Time Recovery</a>&#34;</span>, with the following differences:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p>Use the <code class="codeph">PLUGGABLE DATABASE</code> option in the RMAN <code class="codeph">RESTORE</code> and <code class="codeph">RECOVER</code> commands</p>
</li>
<li>
<p>Use the <code class="codeph">ALTER PLUGGABLE DATABASE</code> command instead of the <code class="codeph">ALTER DATABASE</code> command.</p>
</li>
<li>
<p>Close the PDB for which PITR is being performed. The root is still open.</p>
</li>
</ul>
</div>
</li>
</ol>
<div class="section">
<p>The following example recovers a PDB named <code class="codeph">PDB5</code> up to SCN 1066, and then opens it for read/write access. Connect to the root and enter the following commands:</p>
<pre dir="ltr">ALTER PLUGGABLE DATABASE pdb5 CLOSE;
run 
{
   SET UNTIL SCN 1066;
   RESTORE PLUGGABLE DATABASE pdb5;
   RECOVER PLUGGABLE DATABASE pdb5;
}
ALTER PLUGGABLE DATABASE pdb5 OPEN RESETLOGS;
</pre>
<p>This example assumes that a <span class="bold"><a href="glossary.htm#GUID-6E3CDD76-A573-4E5C-B12D-59C232C96C19"><span class="xrefglossterm">fast recovery area</span></a></span> is being used. If you do not use a fast recovery area, then you must specify the temporary location of the auxiliary set files by using the <code class="codeph">AUXILIARY DESTINATION</code> clause. See <span class="q">&#34;<a href="rcmflash.htm#GUID-031D9695-A9D2-4381-A840-39BD3CC19946__CHDIGGIB">About DBPITR of PDBs and the Fast Recovery Area</a>&#34;</span> for information about the fast recovery area usage during point-in-time recovery of PDBs.</p>
<p><code class="codeph">RESETLOGS</code> creates a new PDB incarnation. You can query the <code class="codeph">V$PDB_INCARNATION</code> view for the incarnation number as described in <span class="q">&#34;<a href="rcmrvcon.htm#GUID-195FE6CA-9CEB-4ED1-9810-F7323F119D87">About Incarnations of PDBs</a>&#34;</span>.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<a id="BRADV89755"></a>
<div class="props_rev_3"><a id="GUID-F9C8CB5E-5954-4114-99D0-D121BA616058"></a>
<h2 id="BRADV-GUID-F9C8CB5E-5954-4114-99D0-D121BA616058" class="sect2">Flashback and Database Point-in-Time Recovery Scenarios</h2>
<div>
<p>This section describes variations on the basic scenarios described in <span class="q">&#34;<a href="rcmflash.htm#GUID-953FA30D-BED2-4DBA-8361-9DA1B8FF073F">Rewinding a Database with Flashback Database</a>&#34;</span> and <span class="q">&#34;<a href="rcmflash.htm#GUID-7D3EE2F7-77A2-4264-8875-CC0AEC64ABE0">Performing Database Point-in-Time Recovery</a>&#34;</span>.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmflash.htm#GUID-7E39909E-E2D5-4D08-ADD8-0D5FEF028489">Rewinding an OPEN RESETLOGS Operation with Flashback Database</a></p>
</li>
<li>
<p><a href="rcmflash.htm#GUID-CECE183D-C000-485A-99DA-371768A79011">Rewinding the Database to an SCN in an Abandoned Incarnation Branch</a></p>
</li>
<li>
<p><a href="rcmflash.htm#GUID-F1818201-98E5-4B70-BDFE-A61AB84397E6">Recovering the Database to an Ancestor Incarnation</a></p>
</li>
</ul>
</div>
<a id="BRADV347"></a><a id="BRADV85442"></a>
<div class="props_rev_3"><a id="GUID-7E39909E-E2D5-4D08-ADD8-0D5FEF028489"></a>
<h3 id="BRADV-GUID-7E39909E-E2D5-4D08-ADD8-0D5FEF028489" class="sect3">Rewinding an OPEN RESETLOGS Operation with Flashback Database</h3>
<div>
<div class="section">
<p><a id="d73614e4397" class="indexterm-anchor"></a>The procedure for using Flashback Database to reverse an unwanted <code class="codeph">ALTER DATABASE OPEN RESETLOGS</code> statement is similar to the general case described in <span class="q">&#34;<a href="rcmflash.htm#GUID-3EB4D790-77C7-49CB-8D96-0940394E6BC8">Performing a Flashback Database Operation</a>&#34;</span>. Rather than specifying a particular SCN or point in time for the <code class="codeph">FLASHBACK</code> <code class="codeph">DATABASE</code> command, however, you use <code class="codeph">FLASHBACK</code> <code class="codeph">DATABASE</code> <code class="codeph">TO</code> <code class="codeph">BEFORE</code> <code class="codeph">RESETLOGS</code>.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To undo an OPEN RESETLOGS operation:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Connect SQL*Plus to the target database and verify that the beginning of the flashback window is earlier than the time of the most recent <code class="codeph">OPEN</code> <code class="codeph">RESETLOGS</code>.</span>
<div>
<p>Run the following queries<a id="d73614e4448" class="indexterm-anchor"></a><a id="d73614e4450" class="indexterm-anchor"></a>:</p>
<pre dir="ltr">SELECT RESETLOGS_CHANGE# 
FROM   V$DATABASE;

SELECT OLDEST_FLASHBACK_SCN 
FROM   V$FLASHBACK_DATABASE_LOG;
</pre>
<p>If <code class="codeph">V$DATABASE.RESETLOGS_CHANGE#</code> is greater than <code class="codeph">V$FLASHBACK_DATABASE_LOG.OLDEST_FLASHBACK_SCN</code>, then you can use Flashback Database to reverse the <code class="codeph">OPEN</code> <code class="codeph">RESETLOGS</code>. operation</p>
</div>
</li>
<li class="stepexpand"><span>Shut down the database, mount it, and recheck the flashback window. If the resetlogs SCN is still within the flashback window, then proceed to the next step.</span></li>
<li class="stepexpand"><span>Connect RMAN to the target database.</span>
<div>
<div class="infoboxnotealso" id="GUID-7E39909E-E2D5-4D08-ADD8-0D5FEF028489__GUID-C4408226-1932-48C3-8499-217B3F39113E">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmcnctg.htm#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C">Making Database Connections with RMAN</a>&#34;</span></p>
</div>
</div>
</li>
<li class="stepexpand"><span>Perform a flashback to the SCN immediately before the <code class="codeph">RESETLOGS</code>.</span>
<div>
<p>Use the following form of the <code class="codeph">FLASHBACK</code> <code class="codeph">DATABASE</code> command:</p>
<pre dir="ltr">FLASHBACK DATABASE TO BEFORE RESETLOGS;
</pre>
<p>As with other uses of <code class="codeph">FLASHBACK</code> <code class="codeph">DATABASE</code>, if the target SCN is before the beginning of the flashback database window, an error is returned and the database is not modified. If the command completes successfully, then the database is left mounted and recovered to the most recent SCN before the <code class="codeph">OPEN RESETLOGS</code> operation in the previous incarnation.</p>
</div>
</li>
<li class="stepexpand"><span>Open the database read-only in SQL*Plus and perform queries as needed to ensure that the effects of the logical corruption have been reversed.</span>
<div>
<p>Open the database read-only as follows:</p>
<pre dir="ltr">ALTER DATABASE OPEN READ ONLY;
</pre></div>
</li>
<li class="stepexpand"><span>To make the database available for updates again, shut down the database, mount it, and then execute the following command:</span>
<div>
<pre dir="ltr">ALTER DATABASE OPEN RESETLOGS;
</pre></div>
</li>
</ol>
</div>
<a id="BRADV89757"></a>
<div class="props_rev_3"><a id="GUID-FFA88389-D132-48BA-9BB6-CAEED6CDA228"></a>
<h4 id="BRADV-GUID-FFA88389-D132-48BA-9BB6-CAEED6CDA228" class="sect4">About Undoing an OPEN RESETLOGS on Standby Databases with Flashback Database</h4>
<div>
<p>Flashback Database across <code class="codeph">OPEN RESETLOGS</code> may be used to perform the following functions in a Data Guard environment:</p>
<ul style="list-style-type: disc;">
<li>
<p>Flashback to undo logical standby switchovers</p>
<p>In this case, the database reverts to its role (primary or standby) at the target time for the Flashback Database operation.</p>
</li>
<li>
<p>Undo of a physical standby activation</p>
<p>You can temporarily activate a physical standby database, use it for testing or reporting purposes, and then use Flashback Database to return it to its role as a physical standby.</p>
</li>
<li>
<p>Ongoing use of a standby database for testing</p>
<p>The use of Flashback Database means that you do not require the use of storage snapshots.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-FFA88389-D132-48BA-9BB6-CAEED6CDA228__GUID-F49D6FC3-3FA9-4B5A-8873-7BA30607B1B0">
<p class="notep1">See Also:</p>
<p><a class="olink SBYDB00717" target="_blank" href="../SBYDB/role_management.htm#SBYDB00717"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> for details on these advanced applications of Flashback Database with Data Guard</p>
</div>
</div>
</div>
</div>
<a id="BRADV348"></a><a id="BRADV89758"></a>
<div class="props_rev_3"><a id="GUID-CECE183D-C000-485A-99DA-371768A79011"></a>
<h3 id="BRADV-GUID-CECE183D-C000-485A-99DA-371768A79011" class="sect3">Rewinding the Database to an SCN in an Abandoned Incarnation Branch</h3>
<div>
<div class="section">
<p><a id="d73614e4690" class="indexterm-anchor"></a>The effect of Flashback Database or DBPITR followed by an <code class="codeph">OPEN</code> <code class="codeph">RESETLOGS</code> operation is to return the database to a previous SCN, and to abandon changes after this point. Therefore, some SCNs after that point can refer either to changes that were abandoned or changes in the current history of the database. In this way, a target SCN specified in <code class="codeph">FLASHBACK DATABASE</code> can be ambiguous.</p>
<p>Unlike SCNs, time expressions and restore points are not ambiguous. A time expression is always associated with the incarnation that was current at that time. A restore point is always associated with the current incarnation when it was created. This is true even for times and restore points that correspond to abandoned database incarnations. The database incarnation is automatically reset to the incarnation that was current at the specified time or when the restore point was created.</p>
<p>You may want to use Flashback Database to rewind the database to an SCN in the parent incarnation that is later than the SCN of the <code class="codeph">OPEN RESETLOGS</code> operation at which the current incarnation path branched from the old incarnation. <a href="rcmrvcon.htm#GUID-EC2E2F24-0AD3-486D-9289-407E7F1F5C9C__CHDCJGGD">Figure 14-1</a> shows how SCNs can be generated in an incarnation branch even after an <code class="codeph">OPEN RESETLOGS</code> operation creates a new incarnation. As shown in the diagram, the database could be at SCN 3000 in incarnation 3 when you must return to the abandoned SCN 1500 in incarnation 1.</p>
<p>If the SCN to which you are rewinding is in the <a id="d73614e4718" class="indexterm-anchor"></a><a href="glossary.htm#GUID-9FA6E4CA-C9C0-47E8-8FDF-2C2A313F8944"><span class="xrefglossterm">direct ancestral path</span></a>, or if you are rewinding the database to a <a id="d73614e4724" class="indexterm-anchor"></a><a href="glossary.htm#GUID-A5A5E7B1-72B6-4F50-8E11-04C03EB5FFAE"><span class="xrefglossterm">restore point</span></a>, then an explicit <code class="codeph">RESET DATABASE</code> command is not necessary for Flashback Database. However, an explicit <code class="codeph">RESET</code> <code class="codeph">DATABASE</code> <code class="codeph">TO</code> <code class="codeph">INCARNATION</code> command is required when you use <code class="codeph">FLASHBACK DATABASE</code> to rewind the database to an SCN in an abandoned database incarnation.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To rewind the database to an SCN in an abandoned incarnation branch:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Use SQL*Plus to connect to the target database and verify that the flashback logs contain enough information to flash back to the SCN.</span>
<div>
<p>For example, execute the following query:</p>
<pre dir="ltr">SELECT OLDEST_FLASHBACK_SCN
FROM   V$FLASHBACK_DATABASE_LOG;
</pre></div>
</li>
<li class="stepexpand"><span>Determine the target incarnation number for the Flashback Database operation, that is, the incarnation key for the parent incarnation.</span>
<div>
<p>For example, execute the following query:</p>
<pre dir="ltr">SELECT PRIOR_INCARNATION# 
FROM   V$DATABASE_INCARNATION 
WHERE  STATUS = &#39;CURRENT&#39;;
</pre></div>
</li>
<li class="stepexpand"><span>Start RMAN and connect to the target database.</span>
<div>
<div class="infoboxnotealso" id="GUID-CECE183D-C000-485A-99DA-371768A79011__GUID-F8DCAAA4-E08E-4DED-AFD9-A40EC2E95999">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmcnctg.htm#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C">Making Database Connections with RMAN</a>&#34;</span></p>
</div>
</div>
</li>
<li class="stepexpand"><span>Shut down the database, and then mount it as follows:</span>
<div>
<pre dir="ltr">SHUTDOWN IMMEDIATE;
STARTUP MOUNT;
</pre></div>
</li>
<li class="stepexpand"><span>Set the database incarnation to the parent incarnation.</span>
<div>
<p>For example, use the following command to return to incarnation 1:</p>
<pre dir="ltr">RESET DATABASE TO INCARNATION 1;
</pre></div>
</li>
<li class="stepexpand"><span>Run the <code class="codeph">FLASHBACK</code> <code class="codeph">DATABASE</code> command, specifying the target SCN.</span>
<div>
<p>For example, use the following command to rewind the database to SCN 1500:</p>
<pre dir="ltr">FLASHBACK DATABASE TO SCN 1500;
</pre></div>
</li>
<li class="stepexpand"><span>Open the database read-only in SQL*Plus and perform queries as needed to ensure that the effects of the logical corruption have been reversed.</span>
<div>
<p>Open the database read-only as follows:</p>
<pre dir="ltr">ALTER DATABASE OPEN READ ONLY;
</pre></div>
</li>
<li class="stepexpand"><span>To make the database available for updates again, shut down the database, mount it, and then execute the following command:</span>
<div>
<pre dir="ltr">ALTER DATABASE OPEN RESETLOGS;
</pre></div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-CECE183D-C000-485A-99DA-371768A79011__GUID-6FA70F22-A044-4401-899F-599067B7B5BF">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="rcmrvcon.htm#GUID-9942AC94-A35D-4A06-9A45-A5A43B82B23D">About Database Incarnations</a>&#34;</span> for useful background information about database incarnations, abandoned changes, and the effects of <code class="codeph">ALTER DATABASE OPEN</code> <code class="codeph">RESETLOGS</code></p>
</li>
<li>
<p><a class="olink RCMRF148" target="_blank" href="../RCMRF/rcmsynta2007.htm#RCMRF148"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for details about the <code class="codeph">RESET</code> <code class="codeph">DATABASE</code> command</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV349"></a><a id="BRADV84153"></a>
<div class="props_rev_3"><a id="GUID-F1818201-98E5-4B70-BDFE-A61AB84397E6"></a>
<h3 id="BRADV-GUID-F1818201-98E5-4B70-BDFE-A61AB84397E6" class="sect3">Recovering the Database to an Ancestor Incarnation</h3>
<div>
<div class="section">
<p>The procedure for DBPITR within the current incarnation is different from DBPITR to an SCN in a noncurrent incarnation. In the latter case, you must explicitly execute the <code class="codeph">RESET DATABASE</code> to reset the database to the incarnation that was current at the target SCN. Also, you must restore a control file from the database incarnation containing the target SCN.</p>
<p>When RMAN is connected to a recovery catalog, a <code class="codeph">RESTORE CONTROLFILE</code> command only searches the current database incarnation for the closest time specified in the <code class="codeph">UNTIL</code> clause. To restore a control file from a noncurrent incarnation, you must execute <code class="codeph">LIST INCARNATION</code> to identify the target database incarnation and specify this incarnation in the <code class="codeph">RESET DATABASE TO INCARNATION</code> command.</p>
<p>When RMAN is connected to a recovery catalog, you cannot execute the <code class="codeph">RESET DATABASE TO INCARNATION</code> command before the database is mounted. Thus, you must execute <code class="codeph">SET UNTIL</code>, restore the control file from autobackup, and then mount it.</p>
<p><a id="d73614e4950" class="indexterm-anchor"></a><a id="d73614e4954" class="indexterm-anchor"></a>Assume the following situation:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>RMAN is connected to a recovery catalog.</p>
</li>
<li>
<p>You have a backup of target database <code class="codeph">trgt</code> from October 2, 2013.</p>
</li>
<li>
<p>DBPITR was performed on this database on October 10, 2013 to correct an earlier error. The <code class="codeph">OPEN</code> <code class="codeph">RESETLOGS</code> operation after that DBPITR started a new incarnation.</p>
</li>
</ul>
<p>On October 25, you discover that you need crucial data that was dropped from the database at 8:00 a.m. on October 8, 2013. This time is before the beginning of the current incarnation.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To perform DBPITR to a noncurrent incarnation:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to a target database and recovery catalog.</span>
<div>
<div class="infoboxnotealso" id="GUID-F1818201-98E5-4B70-BDFE-A61AB84397E6__GUID-2A708BA3-4771-4E4E-9A8E-08779F0C6257">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmcnctg.htm#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C">Making Database Connections with RMAN</a>&#34;</span></p>
</div>
</div>
</li>
<li class="stepexpand"><span>Determine which database incarnation was current at the time of the backup.</span>
<div>
<p>Use <code class="codeph">LIST</code> <code class="codeph">INCARNATION</code> to find the primary key of the incarnation that was current at the target time:</p>
<pre dir="ltr">LIST INCARNATION OF DATABASE trgt;

List of Database Incarnations
DB Key  Inc Key   DB Name   DB ID       STATUS     Reset SCN    Reset Time
------- -------   -------   ------      -------    ----------   ----------
1       2         TRGT      1224038686  PARENT     1            02-OCT-13
1       582       TRGT      1224038686  CURRENT    59727        10-OCT-13
</pre>
<p>Look at the <code class="codeph">Reset SCN</code> and <code class="codeph">Reset Time</code> columns to identify the correct incarnation, and note the incarnation key in the <code class="codeph">Inc</code> <code class="codeph">Key</code> column. In this example, the backup was made 2 October 2013. In this case, the incarnation key value is 2.</p>
</div>
</li>
<li class="stepexpand"><span>Ensure that the database is started but not mounted.</span>
<div>
<pre dir="ltr">STARTUP FORCE NOMOUNT;
</pre></div>
</li>
<li class="stepexpand"><span>Reset the target database to the incarnation obtained in Step 2.</span>
<div>
<p>In this example, specify the incarnation current at the time of the backup of 2 October. Use the value from the <code class="codeph">Inc Key</code> column to identify the incarnation.</p>
<pre dir="ltr">RESET DATABASE TO INCARNATION 2;
</pre></div>
</li>
<li class="stepexpand"><span>Restore and recover the database, performing the following actions in the <code class="codeph">RUN</code> command:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p>Set the end time for recovery to the time just before the loss of the data.</p>
</li>
<li>
<p>Allocate any channels required that are not configured.</p>
</li>
<li>
<p>Restore the control file from the October 2 backup and mount it.</p>
</li>
<li>
<p>Restore the data files and recover the database. Use the <code class="codeph">RECOVER DATABASE</code> <code class="codeph">...</code> <code class="codeph">UNTIL</code> command to perform DBPITR, bringing the database to the target time of 7:55 a.m. on October 8, just before the data was lost.</p>
</li>
</ul>
<p>The following example shows all of the steps required in this case:</p>
<pre dir="ltr">RUN
{
  SET UNTIL TIME &#39;Oct 8 2013 07:55:00&#39;; 
  RESTORE CONTROLFILE;
  # without recovery catalog, use RESTORE CONTROLFILE FROM AUTOBACKUP
  ALTER DATABASE MOUNT; 
  RESTORE DATABASE;
  RECOVER DATABASE;
}
ALTER DATABASE OPEN RESETLOGS;
</pre>
<div class="infoboxnotealso" id="GUID-F1818201-98E5-4B70-BDFE-A61AB84397E6__GUID-13F6CB08-29CA-40C5-86AF-1279D7FE6D81">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF148" target="_blank" href="../RCMRF/rcmsynta2007.htm#RCMRF148"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for details about the <code class="codeph">RESET</code> <code class="codeph">DATABASE</code> command</p>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment500">
<tr>
<td class="cellalignment512">
<table class="cellalignment505">
<tr>
<td class="cellalignment504"><a href="rcmcomre.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment504"><a href="rcmblock.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment514">
<table class="cellalignment503">
<tr>
<td class="cellalignment504"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment504"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment504"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment504"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment504"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment504"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>