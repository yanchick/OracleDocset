<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-2661"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Backing%20Up%20the%20Database%3A%20Advanced%20Topics"></a><title>Backing Up the Database: Advanced Topics</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="backups, incremental, incremental backups, using RMAN, Recovery Manager"/>
<meta name="dcterms.created" content="2017-06-07T23:52:16Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Backup and Recovery User&#39;s Guide"/>
<meta name="dcterms.identifier" content="E50658-09"/>
<meta name="dcterms.isVersionOf" content="BRADV"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="rcmbckba.htm" title="Previous" type="text/html"/>
<link rel="Next" href="part_mai.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E50658-09.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-A4FABEF4-677C-42ED-9DF8-3731ADA12E5F"></a> <span id="PAGE" style="display:none;">20/48</span> <!-- End Header -->
<a id="BRADV007"></a>
<h1 id="BRADV-GUID-A4FABEF4-677C-42ED-9DF8-3731ADA12E5F" class="sect1"><span class="enumeration_chapter">10</span> Backing Up the Database: Advanced Topics</h1>
<div>
<p>This chapter explains advanced RMAN backup procedures. This chapter contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmbckad.htm#GUID-14E97C71-7205-44AD-A711-C5B0053EEA58">Limiting the Size of RMAN Backup Sets</a></p>
</li>
<li>
<p><a href="rcmbckad.htm#GUID-BC32C333-F0EB-4F17-AD79-8882E224D2F4">Using Backup Optimization to Skip Files</a></p>
</li>
<li>
<p><a href="rcmbckad.htm#GUID-CBF7B516-AEBB-433F-A57C-EECAEF153C12">Skipping Offline, Read-Only, and Inaccessible Files</a></p>
</li>
<li>
<p><a href="rcmbckad.htm#GUID-4CFE9BA0-E298-42B8-9FB6-D36751C09D54">Duplexing Backup Sets</a></p>
</li>
<li>
<p><a href="rcmbckad.htm#GUID-EEA8D192-E7CD-4457-A0E3-5062EA2E8D0C">Making Split Mirror Backups with RMAN</a></p>
</li>
<li>
<p><a href="rcmbckad.htm#GUID-ECBE4965-57F7-49F0-BECD-734196F417F5">Encrypting RMAN Backups</a></p>
</li>
<li>
<p><a href="rcmbckad.htm#GUID-DE4C87D6-4BE4-4B5A-A00F-CA17F301A975">Restarting RMAN Backups</a></p>
</li>
<li>
<p><a href="rcmbckad.htm#GUID-AC3D62EE-FF00-43B9-97CC-3EDF295D2C7D">Managing Backup Windows</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-A4FABEF4-677C-42ED-9DF8-3731ADA12E5F__GUID-632DB451-4ED1-443E-9B9B-4B253757ADCC">
<p class="notep1">See Also:</p>
<p><a href="rcmbckba.htm#GUID-93BAB347-063F-439E-BDF3-109AB8D1F8E7" title="To create incremental backups for use in an incrementally updated backup strategy, use the BACKUP ... FOR RECOVER OF COPY WITH TAG form of the BACKUP command. The command is best understood in a sample script that implements the strategy.">Backing Up the Database</a> for basic backup procedures</p>
</div>
</div>
<a id="BRADV89540"></a>
<div class="props_rev_3"><a id="GUID-14E97C71-7205-44AD-A711-C5B0053EEA58"></a>
<h2 id="BRADV-GUID-14E97C71-7205-44AD-A711-C5B0053EEA58" class="sect2">Limiting the Size of RMAN Backup Sets</h2>
<div>
<p><a id="d45900e211" class="indexterm-anchor"></a>As explained in <span class="q">&#34;<a href="rcmconfa.htm#GUID-0A131C1F-85F1-4FED-8EFB-D747679A184A">Configuring the Maximum Size of Backup Sets</a>&#34;</span>, you can use the <code class="codeph">CONFIGURE</code> command to create persistent settings that govern backup set size. This control is helpful when backing up very large files. If you do not have a backup set size persistently configured, then you can also use <a id="d45900e224" class="indexterm-anchor"></a>the<a id="d45900e229" class="indexterm-anchor"></a> <code class="codeph">BACKUP</code> <code class="codeph">... MAXSETSIZE</code> command to limit the size of backup sets.</p>
<p>You can use the <code class="codeph">CONFIGURE</code> command, but not the <code class="codeph">BACKUP</code> command, to set a limit for the size of individual backup pieces. This control is especially useful when you use a media manager that has restrictions on the sizes of files, or when you must back up very large files. See <span class="q">&#34;<a href="rcmconfa.htm#GUID-B5C38414-33DD-4A0F-B0FD-B63F1AC74B33">Configuring the Maximum Size of Backup Pieces</a>&#34;</span> for more information.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmbckad.htm#GUID-04C958FE-A0D3-41A2-B777-73868CDAD4B7">About Backup Set Size</a></p>
</li>
<li>
<p><a href="rcmbckad.htm#GUID-DD5D76A0-2C93-4847-8E79-8E75ACAF4119">Limiting the Size of Backup Sets with BACKUP ... MAXSETSIZE</a></p>
</li>
<li>
<p><a href="rcmbckad.htm#GUID-F2D9FF2D-9E1C-4D38-AD8E-88B6B32F02B4">Dividing the Backup of a Large Data File into Sections</a></p>
</li>
</ul>
</div>
<a id="BRADV89541"></a>
<div class="props_rev_3"><a id="GUID-04C958FE-A0D3-41A2-B777-73868CDAD4B7"></a>
<h3 id="BRADV-GUID-04C958FE-A0D3-41A2-B777-73868CDAD4B7" class="sect3">About Backup Set Size</h3>
<div>
<p>The <code class="codeph">MAXSETSIZE</code> parameter of the <code class="codeph">BACKUP</code> command specifies a maximum size for a backup set in units of bytes (default), kilobytes, megabytes, or gigabytes. Thus, to limit a backup set to 305 MB, specify <code class="codeph">MAXSETSIZE 305M</code>. RMAN attempts to limit all backup sets to this size.</p>
<p>You can use <code class="codeph">BACKUP ... MAXSETSIZE</code> to limit the size of backup sets so that the database is divided among multiple backup sets. If the backup fails part way through, then you can use the restartable backup feature to back up only those files that were not backed up during the previous attempt. See <span class="q">&#34;<a href="rcmbckad.htm#GUID-DE4C87D6-4BE4-4B5A-A00F-CA17F301A975">Restarting RMAN Backups</a>&#34;</span> to learn how to restart RMAN backups.</p>
<p>In some cases the <code class="codeph">MAXSETSIZE</code> value may be too small to contain the largest file that you are backing up. When determining whether <code class="codeph">MAXSETSIZE</code> is too small, RMAN uses the size of the original data file rather than the file size after compression. RMAN displays an error stack such as the following:</p>
<pre dir="ltr">RMAN-00571: ===========================================================
RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS ===============
RMAN-00571: ===========================================================
RMAN-03002: failure of backup command at 11/03/13 14:40:33
RMAN-06182: archive log larger than MAXSETSIZE: thread 1 seq 1
            /oracle/oradata/trgt/arch/archive1_1.dbf
</pre>
<div class="infoboxnotealso" id="GUID-04C958FE-A0D3-41A2-B777-73868CDAD4B7__GUID-3ADD80EE-82BC-4C6E-9EFF-00936157DD05">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> to learn about the <code class="codeph">CONFIGURE MAXSETSIZE</code> command</p>
</div>
</div>
</div>
<a id="BRADV256"></a><a id="BRADV89542"></a>
<div class="props_rev_3"><a id="GUID-DD5D76A0-2C93-4847-8E79-8E75ACAF4119"></a>
<h3 id="BRADV-GUID-DD5D76A0-2C93-4847-8E79-8E75ACAF4119" class="sect3">Limiting the Size of Backup Sets with BACKUP ... MAXSETSIZE</h3>
<div>
<div class="section">
<p>Backup piece size is an issue in those situations where it exceeds the maximum file size of the file system or media management software. Use the <code class="codeph">MAXSETSIZE</code> parameter of the <code class="codeph">CONFIGURE</code> <code class="codeph">CHANNEL</code> or <code class="codeph">ALLOCATE</code> <code class="codeph">CHANNEL</code> command to limit the size of backup pieces.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To limit the size of backup sets:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to a target database and recovery catalog (if used).</span>
<div>
<div class="infoboxnotealso" id="GUID-DD5D76A0-2C93-4847-8E79-8E75ACAF4119__GUID-9FC0EDA5-E2EC-49A4-BA1B-0B7A336C5347">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmcnctg.htm#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C">Making Database Connections with RMAN</a>&#34;</span></p>
</div>
</div>
</li>
<li class="stepexpand"><span>Execute the <code class="codeph">BACKUP</code> command with the <code class="codeph">MAXSETSIZE</code> parameter.</span>
<div>
<p>The following example backs up archived logs to tape, limiting the size of each backup set to 100 MB:</p>
<pre dir="ltr">BACKUP DEVICE TYPE sbt
  MAXSETSIZE 100M
  ARCHIVELOG ALL;
</pre></div>
</li>
</ol>
</div>
</div>
<a id="BRADV257"></a><a id="BRADV89543"></a>
<div class="props_rev_3"><a id="GUID-F2D9FF2D-9E1C-4D38-AD8E-88B6B32F02B4"></a>
<h3 id="BRADV-GUID-F2D9FF2D-9E1C-4D38-AD8E-88B6B32F02B4" class="sect3">Dividing the Backup of a Large Data File into Sections</h3>
<div>
<div class="section">
<p><a id="d45900e568" class="indexterm-anchor"></a>If <a id="d45900e571" class="indexterm-anchor"></a>you specify the <code class="codeph">SECTION SIZE</code> parameter on the <code class="codeph">BACKUP</code> command, then RMAN creates a backup set in which each backup piece contains the blocks from one file section. A <a href="glossary.htm#GUID-FDECFF77-1833-4BD3-A23C-AA4806E28241"><span class="xrefglossterm">file section</span></a> is a contiguous range of blocks in a file. This type of backup is called a <a href="glossary.htm#GUID-6D6DDA5E-F1EF-4273-8649-137F1FC89EB6"><span class="xrefglossterm">multisection backup</span></a>.</p>
<div class="infobox-note" id="GUID-F2D9FF2D-9E1C-4D38-AD8E-88B6B32F02B4__GUID-5F174118-D4F3-4E06-A762-309DFB865E83">
<p class="notep1">Note:</p>
<p>You cannot specify <code class="codeph">SECTION SIZE</code> with <code class="codeph">MAXPIECESIZE</code>.</p>
</div>
<p>The purpose of multisection backups is to enable RMAN channels to back up a single large file in parallel. RMAN divides the work among multiple channels, with each channel backing up one file section in a file. Backing up a file in separate sections can improve the performance of backups of large data files.</p>
<p>If a multisection backup completes successfully, then no backup set generated during the backup contains a partial data file. If a multisection backup is unsuccessful, then the RMAN metadata can contain a record for a partial backup set. RMAN does not consider partial backups for restore and recovery. You must use the <code class="codeph">DELETE</code> command to delete the partial backup set.</p>
<p>If you specify a section size that is larger than the size of the file, then RMAN does not use multisection backup for the file. If you specify a small section size that would produce more than 256 sections, then RMAN increases the section size to a value that results in exactly 256 sections.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To make a multisection backup:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to a target database and recovery catalog (if used).</span></li>
<li class="stepexpand"><span>If necessary, configure channel parallelism so that RMAN can make the backup parallel.</span></li>
<li class="stepexpand"><span><a id="d45900e618" class="indexterm-anchor"></a>Execute <code class="codeph">BACKUP</code> with the <code class="codeph">SECTION SIZE</code> parameter.</span>
<div>
<p>For example, suppose that the <code class="codeph">users</code> tablespace contains a single data file of 900 MB. Also assume that three SBT channels are configured, with the parallelism setting for the SBT device set to 3. You can break up the data file in this tablespace into file sections as shown in the following example:</p>
<pre dir="ltr">BACKUP
  SECTION SIZE 300M
  TABLESPACE users; 
</pre>
<p>In this example, each of the three SBT channels backs up a 300 MB file section of the <code class="codeph">users</code> data file.</p>
</div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-F2D9FF2D-9E1C-4D38-AD8E-88B6B32F02B4__GUID-05A5DBC1-CDCC-471C-9BFA-3C1D79C0E655">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmvalid.htm#GUID-044FA44E-2AEF-4BEB-A73D-EF9EA3253415__CHDDJJAI">Make Parallel the Validation of a Data File</a>&#34;</span> to learn how to validate sections of a large data file</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="BRADV258"></a><a id="BRADV89546"></a>
<div class="props_rev_3"><a id="GUID-BC32C333-F0EB-4F17-AD79-8882E224D2F4"></a>
<h2 id="BRADV-GUID-BC32C333-F0EB-4F17-AD79-8882E224D2F4" class="sect2">Using Backup Optimization to Skip Files</h2>
<div>
<div class="section">
<p><a id="d45900e720" class="indexterm-anchor"></a>As explained in <span class="q">&#34;<a href="rcmconfb.htm#GUID-914A65A7-872E-465B-95E5-0FD5ADAF6A9C">Backup Optimization and the CONFIGURE command</a>&#34;</span>, you run the <a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><code class="codeph">CONFIGURE BACKUP OPTIMIZATION</code></a> command to enable <a href="glossary.htm#GUID-C75B395F-CA6E-4286-826B-67AABE99606A"><span class="xrefglossterm">backup optimization</span></a>. When certain criteria are met, RMAN skips backups of files that are identical to files that are already backed up.</p>
<div class="infoboxnotealso" id="GUID-BC32C333-F0EB-4F17-AD79-8882E224D2F4__GUID-A1626397-C2F6-472A-BA27-35C6CDE3E9E2">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="rcmconfb.htm#GUID-27CE5FE2-DAF0-4E96-B7DF-933616E64C45">About Backup Optimization for SBT Backups with Recovery Window Retention Policy</a>&#34;</span> for a scenario involving backup optimization and recovery windows</p>
</li>
<li>
<p><a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for a detailed description of criteria used by <code class="codeph">CONFIGURE BACKUP OPTIMIZATION</code> to determine whether a file is identical and can potentially be skipped</p>
</li>
</ul>
</div>
<p>For the following scenarios, assume that you configure backup optimization and a retention policy as shown in the following example.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-BC32C333-F0EB-4F17-AD79-8882E224D2F4__CHDFIEBH">
<p class="titleinexample">Example 10-1 Configuring Backup Optimization</p>
<pre dir="ltr">CONFIGURE DEFAULT DEVICE TYPE TO sbt;
CONFIGURE BACKUP OPTIMIZATION ON;
CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 4 DAYS;
</pre>
<p>With RMAN configured as shown in <a href="rcmbckad.htm#GUID-BC32C333-F0EB-4F17-AD79-8882E224D2F4__CHDFIEBH">Example 10-1</a>, you run the following command every night to back up the database to tape:</p>
<pre dir="ltr">BACKUP DATABASE;
</pre>
<p>Because backup optimization is configured, RMAN skips backups of offline and read-only data files only if the most recent backups were made on or after the earliest point in the recovery window. RMAN does not skip backups when the most recent backups are older than the window. For example, optimization ensures you do not end up with a new backup of a read-only data file every night, so long as one backup set containing this file exists within the recovery window.</p>
</div>
<!-- class="example" --></div>
<a id="BRADV89548"></a>
<div class="props_rev_3"><a id="GUID-844430C0-E453-461F-8DDE-2943670D7745"></a>
<h3 id="BRADV-GUID-844430C0-E453-461F-8DDE-2943670D7745" class="sect3">Optimizing a Daily Archived Log Backup to a Single Tape: Scenario</h3>
<div>
<div class="section">
<p>Assume that you want to back up all the archived logs every night, but you do not want to have multiple copies of each log sequence number. With RMAN configured as shown in <a href="rcmbckad.htm#GUID-BC32C333-F0EB-4F17-AD79-8882E224D2F4__CHDFIEBH">Example 10-1</a>, you run the following command in a script nightly at 1 a.m.:</p>
<pre dir="ltr">BACKUP DEVICE TYPE sbt 
  ARCHIVELOG ALL;
</pre>
<p>RMAN skips all logs except those produced in the last 24 hours. In this way, you keep only one copy of each archived log on tape.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV259"></a><a id="BRADV89549"></a>
<div class="props_rev_3"><a id="GUID-352C9B7E-FC3C-4B08-92B4-5B506FB09DDC"></a>
<h3 id="BRADV-GUID-352C9B7E-FC3C-4B08-92B4-5B506FB09DDC" class="sect3">Optimizing a Daily Archived Log Backup to Multiple Media Families: Scenario</h3>
<div>
<div class="section">
<p>In Oracle Secure Backup, a <strong class="term">media family</strong> is a named group of volumes with a set of shared, user-defined attributes. In this scenario, you back up logs that are not on tape to one media family, then back up the same logs to a second media family. Finally, you delete old logs.</p>
<p>With RMAN configured as shown in <a href="rcmbckad.htm#GUID-352C9B7E-FC3C-4B08-92B4-5B506FB09DDC__CHDIACHH">Example 10-2</a>, run the following script at the same time every night to back up the logs generated during the previous day to two separate media families.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-352C9B7E-FC3C-4B08-92B4-5B506FB09DDC__CHDIACHH">
<p class="titleinexample">Example 10-2 Backing Up Archived Redo Logs to Multiple Media Families</p>
<pre dir="ltr"># The following command backs up just the logs that are not on tape. The 
# first copies are saved to the tapes from the media family &#34;log_family1&#34;.
RUN
{
  ALLOCATE CHANNEL c1 DEVICE TYPE sbt
    PARMS &#39;ENV=(OB_MEDIA_FAMILY=log_family1)&#39;;
  BACKUP ARCHIVELOG ALL;
}
# Make one more copy of the archived logs and save them to tapes from a 
# different media family
RUN
{
  ALLOCATE CHANNEL c2 DEVICE TYPE sbt 
    PARMS &#39;ENV=(OB_MEDIA_FAMILY=log_family2)&#39;;
  BACKUP ARCHIVELOG
    NOT BACKED UP 2 TIMES;
}
</pre>
<p>If your goal is to delete logs from disk that have been backed up two times to SBT, then the simplest way to achieve the goal is with an <a href="glossary.htm#GUID-3492E0C3-F42C-45E6-84E2-63E30A3489A4"><span class="xrefglossterm">archived redo log deletion policy</span></a>. The following one-time configuration specifies that archived redo logs are eligible for deletion from disk if two archived log backups exist on tape:</p>
<pre dir="ltr">CONFIGURE ARCHIVELOG DELETION POLICY 
  TO BACKED UP 2 TIMES TO DEVICE TYPE sbt;
</pre>
<p>After running the script in <a href="rcmbckad.htm#GUID-352C9B7E-FC3C-4B08-92B4-5B506FB09DDC__CHDIACHH">Example 10-2</a>, you can delete unneeded logs by executing <code class="codeph">DELETE ARCHIVELOG ALL</code>.</p>
</div>
<!-- class="example" --></div>
</div>
<a id="BRADV260"></a><a id="BRADV89550"></a>
<div class="props_rev_3"><a id="GUID-8EC304D5-40D2-493B-A2CD-D0629347373C"></a>
<h3 id="BRADV-GUID-8EC304D5-40D2-493B-A2CD-D0629347373C" class="sect3">Creating a Weekly Secondary Backup of Archived Logs: Example</h3>
<div>
<div class="section">
<p>Assume a more sophisticated scenario in which your goal is to back up the archived logs to tape every day. You are worried about tape failure, however, so you want to ensure that you have more than one copy of each log sequence number on a separate tape before you perform your weekly deletion of logs from disk. This scenario assumes that the database is not using a fast recovery area.</p>
<p>First, perform a one-time configuration as follows:</p>
<pre dir="ltr">CONFIGURE BACKUP OPTIMIZATION ON;
CONFIGURE DEVICE TYPE sbt PARALLELISM 1;
CONFIGURE default DEVICE TYPE TO sbt;
CONFIGURE CHANNEL DEVICE TYPE sbt PARMS &#39;ENV=(OB_MEDIA_FAMILY=first_copy);
</pre>
<p>Because you have optimization enabled, you can run the following command every evening to back up all archived logs to the <code class="codeph">first_copy</code> media family that have not already been backed up:</p>
<pre dir="ltr">BACKUP ARCHIVELOG ALL TAG first_copy;
</pre>
<p>Every Friday evening you create an additional backup of all archived logs in a different media family. After the backup, you want to delete all archived logs that have at least two copies on tape. So you run the following script:</p>
<pre dir="ltr">RUN
{
  # manually allocate a channel, to specify that the backup run by this
  # channel goes to both media families &#34;first_copy&#34; and &#34;second_copy&#34;
  ALLOCATE CHANNEL c1 DEVICE TYPE sbt
      PARMS &#39;ENV=(OB_MEDIA_FAMILY=second_copy)&#39;;
  ALLOCATE CHANNEL c2 DEVICE TYPE sbt
      PARMS &#39;ENV=(OB_MEDIA_FAMILY=first_copy)&#39;;
  BACKUP 
    CHANNEL c1 
    ARCHIVELOG 
    UNTIL TIME &#39;SYSDATE&#39; 
    NOT BACKED UP 2 TIMES # back up only logs without 2 backups on tape
    TAG SECOND_COPY; 
  BACKUP 
    CHANNEL c2 
    ARCHIVELOG 
    UNTIL TIME &#39;SYSDATE&#39; 
    NOT BACKED UP 2 TIMES # back up only logs without 2 backups on tape
    TAG FIRST_COPY;
}

# now delete from disk all logs that have been backed up to tape at least twice
DELETE 
  ARCHIVELOG ALL
  BACKED UP 2 TIMES TO DEVICE TYPE sbt;
</pre>
<p>The following table explains the effects of the daily and weekly backup scripts.</p>
<div class="tblformal" id="GUID-8EC304D5-40D2-493B-A2CD-D0629347373C__GUID-69C35398-F334-40A0-955D-82A4363D1EEA">
<p class="titleintable">Table 10-1 Effects of Daily and Weekly Scripts</p>
<table class="cellalignment515" title="Effects of Daily and Weekly Scripts" summary="This table describes daily backup activity under the strategy described in this section.">
<thead>
<tr class="cellalignment501">
<th class="cellalignment531" id="d45900e1050">Script</th>
<th class="cellalignment564" id="d45900e1053">Tape Contents After Script</th>
<th class="cellalignment564" id="d45900e1056">Disk Contents After Script</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment501">
<td class="cellalignment534" id="d45900e1061" headers="d45900e1050">
<p>Daily</p>
</td>
<td class="cellalignment565" headers="d45900e1061 d45900e1053">
<p>Archived logs that have not yet been backed up are now in media family <code class="codeph">first_copy</code>.</p>
</td>
<td class="cellalignment565" headers="d45900e1061 d45900e1056">
<p>All archived logs created since the last <code class="codeph">DELETE</code> command are still on disk.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment534" id="d45900e1077" headers="d45900e1050">
<p>Weekly</p>
</td>
<td class="cellalignment565" headers="d45900e1077 d45900e1053">
<p>Archived logs that have fewer than two backups on tape are now in media families <code class="codeph">first_copy</code> and <code class="codeph">second_copy</code>.</p>
</td>
<td class="cellalignment565" headers="d45900e1077 d45900e1056">
<p>All archived logs that have been backed up at least twice to tape are deleted.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>After the weekly backup, you can send the tape from the media family <code class="codeph">second_copy</code> to offsite storage. Use this tape backup only if the primary tape from pool <code class="codeph">first_copy</code> is damaged. Because the secondary tape is offsite, you do not want RMAN to use it for recovery, so you can mark the backup as unavailable:</p>
<pre dir="ltr">CHANGE BACKUP OF ARCHIVELOG TAG SECOND_COPY UNAVAILABLE;
</pre>
<div class="infoboxnotealso" id="GUID-8EC304D5-40D2-493B-A2CD-D0629347373C__GUID-92E9657D-B095-4AB4-99BA-043F5A0F88C9">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmmaint.htm#GUID-F5C3D045-279B-4AB3-8A91-3231A716402C" title="You can delete backups and recovery catalog records for backups.">Maintaining RMAN Backups and Repository&nbsp;Records</a> to learn how to change the status of and delete backups</p>
</li>
<li>
<p><a class="olink RCMRF110" target="_blank" href="../RCMRF/rcmsynta008.htm#RCMRF110"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> to learn about the <code class="codeph">CHANGE</code> and <code class="codeph">DELETE</code> commands</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="BRADV261"></a><a id="BRADV262"></a><a id="BRADV89569"></a>
<div class="props_rev_3"><a id="GUID-CBF7B516-AEBB-433F-A57C-EECAEF153C12"></a>
<h2 id="BRADV-GUID-CBF7B516-AEBB-433F-A57C-EECAEF153C12" class="sect2">Skipping Offline, Read-Only, and Inaccessible Files</h2>
<div>
<div class="section">
<p><a id="d45900e1200" class="indexterm-anchor"></a><a id="d45900e1204" class="indexterm-anchor"></a>By default, the <code class="codeph">BACKUP</code> command terminates when it cannot access a data file. You can specify parameters to prevent termination, as listed in <a href="rcmbckad.htm#GUID-CBF7B516-AEBB-433F-A57C-EECAEF153C12__CHDBBJBF" title="Descriptions of SKIP INACCESSIBLE, SKIP OFFLINE, and SKIP READONLY">Table 10-2</a>.</p>
<div class="tblformal" id="GUID-CBF7B516-AEBB-433F-A57C-EECAEF153C12__CHDBBJBF">
<p class="titleintable">Table 10-2 BACKUP ... SKIP Options</p>
<table class="cellalignment515" title="BACKUP ... SKIP Options" summary="Descriptions of SKIP INACCESSIBLE, SKIP OFFLINE, and SKIP READONLY">
<thead>
<tr class="cellalignment501">
<th class="cellalignment522" id="d45900e1225">If you specify...</th>
<th class="cellalignment525" id="d45900e1228">Then RMAN skips...</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment501">
<td class="cellalignment524" id="d45900e1233" headers="d45900e1225">
<p><code class="codeph">SKIP</code> <code class="codeph">INACCESSIBLE</code></p>
</td>
<td class="cellalignment526" headers="d45900e1233 d45900e1228">
<p>Data files that RMAN cannot read.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment524" id="d45900e1244" headers="d45900e1225">
<p><code class="codeph">SKIP</code> <code class="codeph">OFFLINE</code></p>
</td>
<td class="cellalignment526" headers="d45900e1244 d45900e1228">
<p>Offline data files. Some offline data files can still be read because they exist on disk. Others have been deleted or moved and so cannot be read, making them inaccessible.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment524" id="d45900e1255" headers="d45900e1225">
<p><code class="codeph">SKIP</code> <code class="codeph">READONLY</code></p>
</td>
<td class="cellalignment526" headers="d45900e1255 d45900e1228">
<p>Data files in read-only tablespaces.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>The following example uses an automatic channel to back up the database, and skips all data files that might cause the backup job to terminate.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-CBF7B516-AEBB-433F-A57C-EECAEF153C12__GUID-CA56E6B3-34A6-4DDD-871E-57D6A92B4301">
<p class="titleinexample">Example 10-3 Skipping Files During an RMAN Backup</p>
<pre dir="ltr">BACKUP DATABASE
  SKIP INACCESSIBLE
  SKIP READONLY
  SKIP OFFLINE;
</pre></div>
<!-- class="example" --></div>
</div>
<a id="BRADV145"></a>
<div class="props_rev_3"><a id="GUID-4CFE9BA0-E298-42B8-9FB6-D36751C09D54"></a>
<h2 id="BRADV-GUID-4CFE9BA0-E298-42B8-9FB6-D36751C09D54" class="sect2">Duplexing Backup Sets</h2>
<div>
<p><a id="d45900e1341" class="indexterm-anchor"></a><a id="d45900e1345" class="indexterm-anchor"></a><a id="d45900e1347" class="indexterm-anchor"></a>RMAN can make up to four copies of a backup set simultaneously, each an exact duplicate of the others. A copy of a <a href="glossary.htm#GUID-614D6594-1A1A-46EE-A041-312ADAB7E151"><span class="xrefglossterm">duplexed backup set</span></a> is a copy of each backup piece in the backup set, with each copy getting a unique copy number (for example, <code class="codeph">0tcm8u2s_1_1</code> and <code class="codeph">0tcm8u2s_1_2</code>). It is not possible to duplex backup sets to the <a href="glossary.htm#GUID-6E3CDD76-A573-4E5C-B12D-59C232C96C19"><span class="xrefglossterm">fast recovery area</span></a>.</p>
<p>You can use <a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><code class="codeph">BACKUP</code></a> <code class="codeph">...</code> <code class="codeph">COPIES</code> or <a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><code class="codeph">CONFIGURE</code></a> <code class="codeph">...</code> <code class="codeph">BACKUP</code> <code class="codeph">COPIES</code> to duplex backup sets. RMAN can duplex backups to either disk or tape, but cannot duplex backups to tape and disk simultaneously. For <code class="codeph">DISK</code> channels, specify multiple values in the <code class="codeph">FORMAT</code> option to direct the multiple copies to different physical disks. For <a href="glossary.htm#GUID-2E48CE71-9547-4196-B715-5CE59033262E"><span class="xrefglossterm">SBT</span></a> channels, if you use a media manager that supports Version 2 of the SBT API, then the media manager automatically writes each copy to a separate medium (for example, a separate tape). When backing up to tape, ensure that the number of copies does not exceed the number of available tape devices.</p>
<p>Duplexing applies only to backup sets, not image copies. It is an error to specify the <code class="codeph">BACKUP... COPIES</code> when creating image copy backups, and the <code class="codeph">CONFIGURE... BACKUP COPIES</code> setting is ignored for image copy backups.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmbckad.htm#GUID-1A6816FF-3E17-443C-B271-9C298CC987FF">Duplexing Backup Sets with CONFIGURE BACKUP COPIES</a></p>
</li>
<li>
<p><a href="rcmbckad.htm#GUID-D0F9ADCE-DA22-475B-BDB6-A565E76A26F9">Duplexing Backup Sets with BACKUP ... COPIES</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-4CFE9BA0-E298-42B8-9FB6-D36751C09D54__GUID-90262080-C43E-4359-B388-79853D9798A8">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmcncpt.htm#GUID-763A9C75-90A5-48FD-9CB6-707D030A00F5">About Multiple Copies of RMAN Backups</a>&#34;</span> for a conceptual overview of RMAN backup copies</p>
</div>
</div>
<a id="BRADV263"></a><a id="BRADV89570"></a>
<div class="props_rev_3"><a id="GUID-1A6816FF-3E17-443C-B271-9C298CC987FF"></a>
<h3 id="BRADV-GUID-1A6816FF-3E17-443C-B271-9C298CC987FF" class="sect3">Duplexing Backup Sets with CONFIGURE BACKUP COPIES</h3>
<div>
<div class="section">
<p>As explained in <span class="q">&#34;<a href="rcmconfa.htm#GUID-2A285F87-552A-4F36-A5B9-F25A69611B4B">Configuring Backup Duplexing</a>&#34;</span>, the <code class="codeph">CONFIGURE</code> <code class="codeph">...</code> <code class="codeph">BACKUP</code> <code class="codeph">COPIES</code> command specifies the number of identical backup sets to create on the specified device type. This setting applies to all backup sets except control file autobackups (because the autobackup of a control file always produces one copy) and backup sets when backed up with the <code class="codeph">BACKUP BACKUPSET</code> command.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To duplex a backup with CONFIGURE ... BACKUP COPIES:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Configure the number of copies on the desired device type for data files and archived redo logs on the desired device types.</span>
<div>
<p>By default, <code class="codeph">CONFIGURE</code> <code class="codeph">...</code> <code class="codeph">BACKUP</code> <code class="codeph">COPIES</code> is set to <code class="codeph">1</code> for each device type. The following example configures duplexing for data files and archived logs on tape and also duplexing for data files (but not archived redo logs) on disk:</p>
<pre dir="ltr">CONFIGURE DEVICE TYPE sbt PARALLELISM 1;
CONFIGURE DEFAULT DEVICE TYPE TO sbt;
CONFIGURE CHANNEL DEVICE TYPE DISK FORMAT &#39;/disk1/%U&#39;, &#39;/disk2/%U&#39;;
CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE sbt TO 2;
CONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE sbt TO 2;
CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE DISK TO 2;
</pre></div>
</li>
<li class="stepexpand"><span>Execute the <code class="codeph">BACKUP</code> command.</span>
<div>
<p>The following command backs up the database and archived logs to tape, making two copies of each data file and archived log:</p>
<pre dir="ltr">BACKUP AS BACKUPSET DATABASE PLUS ARCHIVELOG;
</pre>
<p>Because of the configured formats for the disk channel, the following command backs up the database to disk, placing one copy of the backup sets produced in the <code class="codeph">/disk1</code> directory and the other in the <code class="codeph">/disk2</code> directory:</p>
<pre dir="ltr">BACKUP DEVICE TYPE DISK AS BACKUPSET DATABASE;
</pre>
<p>If the <code class="codeph">FORMAT</code> clause were not configured on <code class="codeph">CONFIGURE CHANNNEL</code>, then you specify <code class="codeph">FORMAT</code> on the <code class="codeph">BACKUP</code> command itself. For example, you issue the following command:</p>
<pre dir="ltr">BACKUP AS BACKUPSET DATABASE 
  FORMAT &#39;/disk1/%U&#39;, 
         &#39;/disk2/%U&#39;;
</pre></div>
</li>
<li class="stepexpand"><span>Issue a <a class="olink RCMRF132" target="_blank" href="../RCMRF/rcmsynta027.htm#RCMRF132"><code class="codeph">LIST</code></a> <code class="codeph">BACKUP</code> command to see a listing of backup sets and pieces.</span>
<div>
<p>For example, enter the following command:</p>
<pre dir="ltr">LIST BACKUP SUMMARY;
</pre>
<p>The <code class="codeph">#Copies</code> column shows the number of backup sets, which may have been produced by duplexing or by multiple backup commands.</p>
</div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-1A6816FF-3E17-443C-B271-9C298CC987FF__GUID-0F3F7988-4281-46D4-B4E3-DE0D7E294755">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmconfa.htm#GUID-2A285F87-552A-4F36-A5B9-F25A69611B4B">Configuring Backup Duplexing</a>&#34;</span> to learn about the <code class="codeph">CONFIGURE BACKUP COPIES</code> command, and <span class="q">&#34;<a href="rcmconfb.htm#GUID-AD92E09D-0788-4AB5-8792-5F969C8D237A">About Configuring the Environment for RMAN Backups</a>&#34;</span> to learn about basic backup configuration options</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV264"></a><a id="BRADV89571"></a>
<div class="props_rev_3"><a id="GUID-D0F9ADCE-DA22-475B-BDB6-A565E76A26F9"></a>
<h3 id="BRADV-GUID-D0F9ADCE-DA22-475B-BDB6-A565E76A26F9" class="sect3">Duplexing Backup Sets with BACKUP ... COPIES</h3>
<div>
<div class="section">
<p><a id="d45900e1729" class="indexterm-anchor"></a>The <code class="codeph">COPIES</code> option of the <code class="codeph">BACKUP</code> command overrides every other <code class="codeph">COPIES</code> or <code class="codeph">DUPLEX</code> setting to control duplexing of backup sets.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To duplex a backup with BACKUP ... COPIES:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Specify the number of identical copies with the <code class="codeph">COPIES</code> option of the <code class="codeph">BACKUP</code> command. For example, run the following to make three copies of each backup set in the default <code class="codeph">DISK</code> location:</span>
<div>
<pre dir="ltr">BACKUP AS BACKUPSET DEVICE TYPE DISK 
  COPIES 3 
  INCREMENTAL LEVEL 0 
  DATABASE;
</pre>
<p>Because you specified <code class="codeph">COPIES</code> in the <code class="codeph">BACKUP</code> command, RMAN makes three backup sets of each data file regardless of the <code class="codeph">CONFIGURE</code> <code class="codeph">DATAFILE</code> <code class="codeph">COPIES</code> setting.</p>
</div>
</li>
<li class="stepexpand"><span>Issue a <code class="codeph">LIST</code> <code class="codeph">BACKUP</code> command to see a listing of backup sets and pieces (the <code class="codeph">#Copies</code> column shows the number of copies, which may have been produced through duplexing or through multiple invocations of the <code class="codeph">BACKUP</code> command). For example, enter:</span>
<div>
<pre dir="ltr">LIST BACKUP SUMMARY;
</pre></div>
</li>
</ol>
</div>
</div>
</div>
<a id="BRADV265"></a><a id="BRADV146"></a>
<div class="props_rev_3"><a id="GUID-EEA8D192-E7CD-4457-A0E3-5062EA2E8D0C"></a>
<h2 id="BRADV-GUID-EEA8D192-E7CD-4457-A0E3-5062EA2E8D0C" class="sect2">Making Split Mirror Backups with RMAN</h2>
<div>
<div class="section">
<p><a id="d45900e1871" class="indexterm-anchor"></a><a id="d45900e1875" class="indexterm-anchor"></a><a id="d45900e1881" class="indexterm-anchor"></a><a id="d45900e1887" class="indexterm-anchor"></a>Many sites keep a backup of the database stored on disk in case a <a href="glossary.htm#GUID-ABDE7EEF-D4B3-4867-A69C-3B24614AF430"><span class="xrefglossterm">media failure</span></a> occurs on the primary database or an incorrect user action requires <a href="glossary.htm#GUID-491BEF3A-18F0-4670-B078-2D84765141E8"><span class="xrefglossterm">point-in-time recovery</span></a>. A data file backup on disk simplifies the restore step of recovery, making recovery much quicker and more reliable.</p>
<div class="infobox-note" id="GUID-EEA8D192-E7CD-4457-A0E3-5062EA2E8D0C__GUID-6CDE9417-57DC-4D23-A64F-AAF9874A4842">
<p class="notep1">Caution:</p>
<p>Never make backups, split mirror or otherwise, of online redo logs. Restoring online redo log backups can create two archived logs with the same sequence number but different contents. Also, it is best to use the <a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><code class="codeph">BACKUP</code></a> <code class="codeph">CONTROLFILE</code> command rather than a split mirror to make control file backups.</p>
</div>
<p>One way of creating a data file backup on disk is to use disk <a href="glossary.htm#GUID-305BF676-5718-47C7-9902-A6E3A200A0DF"><span class="xrefglossterm">mirroring</span></a>. For example, the operating system can maintain three identical copies of each file in the database. In this configuration, you can split off a mirrored copy of the database to use as a backup.</p>
<p>RMAN does not automate the splitting of mirrors, but can make use of split mirrors in backup and recovery. For example, RMAN can treat a split mirror of a data file as a data file copy, and can also back up this copy to disk or tape. The procedure in this section explains how to make a <a href="glossary.htm#GUID-ECF69578-264C-4BFD-80BA-18135E703AF1"><span class="xrefglossterm">split mirror backup</span></a> with the <code class="codeph">ALTER SYSTEM SUSPEND</code>/<code class="codeph">RESUME</code> functionality.</p>
<p>Some mirroring technology does not require Oracle Database to suspend all I/O before a mirror can be separated and used as a backup. Refer to your storage manager, volume manager, or file system documentation for information about whether you must suspend I/O from the database instance.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">To make a split mirror backup of a tablespace by using SUSPEND/RESUME:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and then place the tablespaces to back up into backup mode with the <a class="olink SQLRF01002" target="_blank" href="../SQLRF/statements_3002.htm#SQLRF01002"><code class="codeph">ALTER TABLESPACE ... BEGIN BACKUP</code></a> statement. (To place all tablespaces in backup mode, you can the <a class="olink SQLRF00802" target="_blank" href="../SQLRF/statements_1006.htm#SQLRF00802"><code class="codeph">ALTER DATABASE BEGIN BACKUP</code></a> instead.)</span>
<div>
<p>For example, to place tablespace <code class="codeph">users</code> in backup mode, you connect RMAN to a target database and run the following <code class="codeph">SQL</code> command:</p>
<pre dir="ltr">ALTER TABLESPACE users BEGIN BACKUP; 
</pre></div>
</li>
<li class="stepexpand"><span>Suspend I/O if your mirroring software or hardware requires it. For example, enter the following command in RMAN:</span>
<div>
<pre dir="ltr">ALTER SYSTEM SUSPEND;
</pre></div>
</li>
<li class="stepexpand"><span>Split the mirrors for the underlying data files contained in these tablespaces.</span></li>
<li class="stepexpand"><span>Take the database out of the suspended state. For example, enter the following command in RMAN:</span>
<div>
<pre dir="ltr">ALTER SYSTEM RESUME;
</pre></div>
</li>
<li class="stepexpand"><span>Take the tablespaces out of backup mode. For example, enter:</span>
<div>
<pre dir="ltr">ALTER TABLESPACE users END BACKUP;
</pre>
<p>You can also use <code class="codeph">ALTER DATABASE END BACKUP</code> to take all tablespaces out of backup mode.</p>
</div>
</li>
<li class="stepexpand"><span>Catalog the user-managed mirror copies as data file copies with the <a class="olink RCMRF109" target="_blank" href="../RCMRF/rcmsynta007.htm#RCMRF109"><code class="codeph">CATALOG</code></a> command. For example, enter:</span>
<div>
<pre dir="ltr">CATALOG DATAFILECOPY &#39;/dk2/oradata/trgt/users01.dbf&#39;; # catalog split mirror
</pre></div>
</li>
<li class="stepexpand"><span>Back up the data file copies. For example, run the <code class="codeph">BACKUP</code> <code class="codeph">DATAFILECOPY</code> command at the prompt:</span>
<div>
<pre dir="ltr">BACKUP DATAFILECOPY &#39;/dk2/oradata/trgt/users01.dbf&#39;;
</pre></div>
</li>
<li class="stepexpand"><span>When you are ready to <a href="glossary.htm#GUID-108043D5-E36A-426F-B124-EB49460C2473"><span class="xrefglossterm">resilver a split mirror</span></a>, first use the <a class="olink RCMRF110" target="_blank" href="../RCMRF/rcmsynta008.htm#RCMRF110"><code class="codeph">CHANGE</code></a> <code class="codeph">...</code> <code class="codeph">UNCATALOG</code> command to uncatalog the data file copies you cataloged in Step 6. For example, enter:</span>
<div>
<pre dir="ltr">CHANGE DATAFILECOPY &#39;/dk2/oradata/trgt/users01.dbf&#39; UNCATALOG;
</pre></div>
</li>
<li class="stepexpand"><span>Resilver the split mirror for the affected data files.</span>
<div>
<div class="infoboxnotealso" id="GUID-EEA8D192-E7CD-4457-A0E3-5062EA2E8D0C__GUID-F3946A3B-C46D-4013-A64F-685C169E0C5C">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="osbackup.htm#GUID-F41318F6-A2F2-4518-9DB5-9EBB904EFB47">Making User-Managed Backups in SUSPEND Mode</a>&#34;</span></p>
</li>
<li>
<p><a class="olink ADMIN004" target="_blank" href="../ADMIN/start.htm#ADMIN004"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for more information about the <code class="codeph">SUSPEND</code>/<code class="codeph">RESUME</code> feature</p>
</li>
<li>
<p><a class="olink SQLRF009" target="_blank" href="../SQLRF/statements_2.htm#SQLRF009"><span class="italic">Oracle Database SQL Language Reference</span></a> for the <a class="olink SQLRF00902" target="_blank" href="../SQLRF/statements_2017.htm#SQLRF00902"><code class="codeph">ALTER SYSTEM</code></a> <code class="codeph">SUSPEND</code> syntax</p>
</li>
</ul>
</div>
</div>
</li>
</ol>
</div>
</div>
<a id="BRADV72450"></a>
<div class="props_rev_3"><a id="GUID-ECBE4965-57F7-49F0-BECD-734196F417F5"></a>
<h2 id="BRADV-GUID-ECBE4965-57F7-49F0-BECD-734196F417F5" class="sect2">Encrypting RMAN Backups</h2>
<div>
<p><a id="d45900e2139" class="indexterm-anchor"></a><a id="d45900e2143" class="indexterm-anchor"></a>As explained in <span class="q">&#34;<a href="rcmconfa.htm#GUID-21D5FCCE-7AF1-4CF8-BC53-2496ECE3C56E">Configuring Backup Encryption</a>&#34;</span>, you can protect RMAN backup sets with <a href="glossary.htm#GUID-65A13E9F-7391-4A6A-8379-B2EA64D0EA9E"><span class="xrefglossterm">backup encryption</span></a>. Encrypted backups cannot be read if they are obtained by unauthorized users. The RMAN backup encryption feature requires the Enterprise Edition of the database.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmbckad.htm#GUID-4637E7A1-DD0A-41DB-A242-41A6A8850122">About RMAN Backup Encryption Settings</a></p>
</li>
<li>
<p><a href="rcmbckad.htm#GUID-66452E9B-2DB5-4337-AE46-12DCDB4AC712">Making Transparent-Mode Encrypted Backups</a></p>
</li>
<li>
<p><a href="rcmbckad.htm#GUID-D36B54F4-5BFF-4FCE-9EDE-82CFF02B92A2">Making Password-Mode Encrypted Backups</a></p>
</li>
<li>
<p><a href="rcmbckad.htm#GUID-DACE2E21-536D-4272-925F-1418F68B8A24">Making Dual-Mode Encrypted Backups</a></p>
</li>
</ul>
</div>
<a id="BRADV89573"></a>
<div class="props_rev_3"><a id="GUID-4637E7A1-DD0A-41DB-A242-41A6A8850122"></a>
<h3 id="BRADV-GUID-4637E7A1-DD0A-41DB-A242-41A6A8850122" class="sect3">About RMAN Backup Encryption Settings</h3>
<div>
<p>Backup encryption is performed based on the encryption settings specified with the following commands:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">CONFIGURE</code> <code class="codeph">ENCRYPTION</code></p>
<p>You can use this command to persistently configure transparent encryption. You cannot persistently configure dual mode or password mode encryption.</p>
</li>
<li>
<p><code class="codeph">SET</code> <code class="codeph">ENCRYPTION</code></p>
<p>You can use this command to configure dual mode or password mode encryption at the <a href="glossary.htm#GUID-01D29658-41E1-4D45-9C7F-A761D56885B9"><span class="xrefglossterm">RMAN session</span></a> level.</p>
</li>
</ul>
<div class="infobox-note" id="GUID-4637E7A1-DD0A-41DB-A242-41A6A8850122__GUID-FD6FE073-3A41-4F20-BCB9-2EE1C0544FF8">
<p class="notep1">Note:</p>
<p>Keystore-based encryption is more secure than password-based encryption because no passwords are involved. Use password-based encryption only when absolutely necessary because your backups must be transportable.</p>
</div>
<p>The database uses a new encryption key for every encrypted backup. The backup encryption key is then encrypted with either the password, the database master key, or both, depending on the chosen encryption mode. Individual backup encryption keys or passwords are never stored in clear text.</p>
<p>A single restore operation can process backups encrypted in different modes. For each backup piece that it restores, RMAN checks whether it is encrypted. Transparently encrypted backups need no intervention if the Oracle keystore is open and available.</p>
<p>If password encryption is detected, then RMAN searches for a matching key in the list of passwords entered in the <code class="codeph">SET DECRYPTION</code> command. If RMAN finds a usable key, then the restore operation proceeds. Otherwise, RMAN searches for a key in the Oracle keystore. If RMAN finds a usable key, then the restore operation proceeds; otherwise, RMAN signals an error that the backup piece cannot be decrypted.</p>
<div class="infobox-note" id="GUID-4637E7A1-DD0A-41DB-A242-41A6A8850122__GUID-4D82942B-F33A-4C59-A04D-50186D8CB558">
<p class="notep1">Note:</p>
<p>If RMAN restores a set of backups created with different passwords, then all required passwords must be included with <code class="codeph">SET</code> <code class="codeph">DECRYPTION</code>.</p>
</div>
<p>RMAN encryption is a CPU-intensive operation and can affect backup performance. The actual amount of CPU utilization during encryption depends on whether both input and output devices for disk and SBT produce and consume data faster than the CPU can encrypt it. Here are a few guidelines for managing and trying to maximize CPU performance:</p>
<ul style="list-style-type: disc;">
<li>
<p>Because encrypted backups consume more CPU resources than unencrypted backups, you can improve performance of encrypted backups to disk by using more RMAN channels. A general rule is to use the same number of channels as the number of CPU cores in your system. For example, use two channels for a dual-core processor.</p>
</li>
<li>
<p>If both the disk subsystem and SBT-subsystem are fast, you can expect very high CPU utilization. You may want to consider slowing the rate of the backup by setting the RMAN <code class="codeph">READRATE</code> parameter. For example, you can set an upper limit for block reads so that RMAN does not consume excessive disk bandwidth and thereby degrade online performance.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-4637E7A1-DD0A-41DB-A242-41A6A8850122__GUID-9D3AFCB8-C121-4770-B248-D227A6977802">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="rcmcomre.htm#GUID-5E09344A-76D0-4188-A39D-CBA07F0B5C25">Performing Complete Database Recovery</a>&#34;</span> to learn how to restore password-encrypted backups</p>
</li>
<li>
<p><span class="q">&#34;<a href="rcmreprt.htm#GUID-323B8278-BD20-4278-9770-53E1CF6AC986">Determining the Encryption Status of Backup Pieces</a>&#34;</span></p>
</li>
<li>
<p><a class="olink RCMRF153" target="_blank" href="../RCMRF/rcmsynta2014.htm#RCMRF153"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> to learn about the <code class="codeph">ENCRYPTION</code> and <code class="codeph">DECRYPTION</code> options of the <code class="codeph">SET</code> command</p>
</li>
</ul>
</div>
</div>
</div>
<a id="BRADV89574"></a>
<div class="props_rev_3"><a id="GUID-66452E9B-2DB5-4337-AE46-12DCDB4AC712"></a>
<h3 id="BRADV-GUID-66452E9B-2DB5-4337-AE46-12DCDB4AC712" class="sect3">Making Transparent-Mode Encrypted Backups</h3>
<div>
<div class="section">
<p><a id="d45900e2406" class="indexterm-anchor"></a><a id="d45900e2408" class="indexterm-anchor"></a>If you have configured transparent encryption with the <code class="codeph">CONFIGURE</code> command as explained in <span class="q">&#34;<a href="rcmconfa.htm#GUID-BAA3CFF0-C95C-4AF2-90DD-764754325D73">Configuring RMAN Backup Encryption Modes</a>&#34;</span>, then no additional commands are required to create encrypted backups. Make RMAN backups as normal.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV266"></a><a id="BRADV89575"></a>
<div class="props_rev_3"><a id="GUID-D36B54F4-5BFF-4FCE-9EDE-82CFF02B92A2"></a>
<h3 id="BRADV-GUID-D36B54F4-5BFF-4FCE-9EDE-82CFF02B92A2" class="sect3">Making Password-Mode Encrypted Backups</h3>
<div>
<div class="section">
<p><a id="d45900e2493" class="indexterm-anchor"></a><a id="d45900e2495" class="indexterm-anchor"></a>You can set an encryption password in an RMAN session by executing the <a class="olink RCMRF153" target="_blank" href="../RCMRF/rcmsynta2014.htm#RCMRF153"><code class="codeph">SET ENCRYPTION BY PASSWORD</code></a> command. If transparent encryption is configured, then specify the <code class="codeph">ONLY</code> keyword to indicate that the backups are protected with a password and not with the configured transparent encryption.</p>
<div class="infobox-note" id="GUID-D36B54F4-5BFF-4FCE-9EDE-82CFF02B92A2__GUID-D95A7DBB-3EFE-4352-8BE0-A25C80BD23CD">
<p class="notep1">Note:</p>
<p>Create a password that is secure. See <a class="olink DBSEG33223" target="_blank" href="../DBSEG/authentication.htm#DBSEG33223"><span class="italic">Oracle Database Security Guide</span></a> for more information.</p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To make password-mode encrypted backups:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to a target database and recovery catalog (if used).</span></li>
<li class="stepexpand"><span>Execute the <code class="codeph">SET ENCRYPTION ON IDENTIFIED BY</code> <span class="italic"><code class="codeph">password</code></span> <code class="codeph">ONLY</code> command.</span>
<div>
<p>The following example sets the encryption password for all tablespaces (where <span class="italic">password</span> is a placeholder for the actual password that you enter) in the backup and specifies <code class="codeph">ONLY</code> to indicate that the encryption is password-only:</p>
<pre dir="ltr">SET ENCRYPTION IDENTIFIED BY <span class="italic">password</span> ONLY ON FOR ALL TABLESPACES;
</pre></div>
</li>
<li class="stepexpand"><span>Back up the database.</span>
<div>
<p>For example, enter the following command:</p>
<pre dir="ltr">BACKUP DATABASE PLUS ARCHIVELOG;
</pre></div>
</li>
</ol>
</div>
</div>
<a id="BRADV267"></a><a id="BRADV89576"></a>
<div class="props_rev_3"><a id="GUID-DACE2E21-536D-4272-925F-1418F68B8A24"></a>
<h3 id="BRADV-GUID-DACE2E21-536D-4272-925F-1418F68B8A24" class="sect3">Making Dual-Mode Encrypted Backups</h3>
<div>
<div class="section">
<p><a id="d45900e2629" class="indexterm-anchor"></a><a id="d45900e2631" class="indexterm-anchor"></a>Use the <a class="olink RCMRF153" target="_blank" href="../RCMRF/rcmsynta2014.htm#RCMRF153"><code class="codeph">SET ENCRYPTION BY PASSWORD</code></a> command at the RMAN prompt to make password-protected backups. If transparent encryption is configured, then <span class="italic">omit</span> the <code class="codeph">ONLY</code> keyword to indicate that the backups are protected with both a password and the configured transparent encryption.</p>
<div class="infobox-note" id="GUID-DACE2E21-536D-4272-925F-1418F68B8A24__GUID-56A52898-79F9-4747-962D-6EFF50F8A8C9">
<p class="notep1">Note:</p>
<p>Create a password that is secure. See <a class="olink DBSEG33223" target="_blank" href="../DBSEG/authentication.htm#DBSEG33223"><span class="italic">Oracle Database Security Guide</span></a> for more information.</p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To make dual-mode encrypted backups:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to a target database and recovery catalog (if used).</span></li>
<li class="stepexpand"><span>Execute the <code class="codeph">SET ENCRYPTION BY PASSWORD</code> command, making sure to omit the <code class="codeph">ONLY</code> keyword.</span>
<div>
<p>The following example sets the encryption password for all tablespaces (where <span class="italic">password</span> is a placeholder for the actual password that you enter) in the backup and omits <code class="codeph">ONLY</code> to indicate dual-mode encryption:</p>
<pre dir="ltr">SET ENCRYPTION IDENTIFIED BY <span class="italic">password</span> ON FOR ALL TABLESPACES;
</pre></div>
</li>
<li class="stepexpand"><span>Back up the database.</span>
<div>
<p>For example, enter the following command:</p>
<pre dir="ltr">BACKUP DATABASE PLUS ARCHIVELOG;
</pre></div>
</li>
</ol>
</div>
</div>
</div>
<a id="BRADV148"></a>
<div class="props_rev_3"><a id="GUID-DE4C87D6-4BE4-4B5A-A00F-CA17F301A975"></a>
<h2 id="BRADV-GUID-DE4C87D6-4BE4-4B5A-A00F-CA17F301A975" class="sect2">Restarting RMAN Backups</h2>
<div>
<p>With the <a href="glossary.htm#GUID-6445ABEC-C5B3-4AD0-A17C-791ECAA706BB"><span class="xrefglossterm">restartable backup</span></a> feature, RMAN backs up only those files that were not backed up after a specified date.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmbckad.htm#GUID-BBF25920-4071-4126-80BB-212F2B80C29B">About Restartable Backups</a></p>
</li>
<li>
<p><a href="rcmbckad.htm#GUID-AE002ED5-2B57-4878-A759-E8F565F2610E">Restarting a Backup After It Partially Completes</a></p>
</li>
</ul>
</div>
<a id="BRADV114"></a>
<div class="props_rev_3"><a id="GUID-BBF25920-4071-4126-80BB-212F2B80C29B"></a>
<h3 id="BRADV-GUID-BBF25920-4071-4126-80BB-212F2B80C29B" class="sect3">About Restartable Backups</h3>
<div>
<p><a id="d45900e2849" class="indexterm-anchor"></a><a id="d45900e2851" class="indexterm-anchor"></a>The minimum unit of restartability is a data file. However, if a backup set contains one backup piece, and if this piece contains blocks from multiple data files, then the unit of restartability is the backup piece. The unit of restartability for image copies is a data file.</p>
<p>The benefit of restartable backups is that if the backup generates multiple backup sets, then the backup sets that completed successfully do not have to be rerun. However, if the entire database is written into one backup set, and if the backup fails halfway through, then the entire backup has to be restarted.</p>
<p>Any <a id="d45900e2860" class="indexterm-anchor"></a><a id="d45900e2866" class="indexterm-anchor"></a><a id="d45900e2870" class="indexterm-anchor"></a>I/O errors that RMAN encounters when reading files or writing to the backup pieces or image copies cause RMAN to terminate the backup job in progress. For example, if RMAN tries to back up a data file but the data file is not on disk, then RMAN terminates the backup. If multiple channels are being used or redundant copies of backups are being created, however, then RMAN may be able to continue the backup without user intervention.</p>
<p>RMAN can back up only those files that have not been backed up since a specified date. Use this feature after a backup fails to back up the parts of the database missed by the failed backup.</p>
<p>You can restart a backup by specifying the <code class="codeph">SINCE TIME</code> clause on the <a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><code class="codeph">BACKUP</code></a> command. If the <code class="codeph">SINCE</code> <code class="codeph">TIME</code> is later than the completion time, then RMAN backs up the file. If you use <code class="codeph">BACKUP DATABASE NOT BACKED UP</code> without the <code class="codeph">SINCE</code> <code class="codeph">TIME</code> parameter, then RMAN only backs up files that have never been backed up.</p>
<div class="infoboxnotealso" id="GUID-BBF25920-4071-4126-80BB-212F2B80C29B__GUID-37553B13-8202-4F1C-849D-373D61663740">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">BACKUP ... NOT BACKED UP</code> syntax</p>
</div>
</div>
</div>
<a id="BRADV268"></a><a id="BRADV89577"></a>
<div class="props_rev_3"><a id="GUID-AE002ED5-2B57-4878-A759-E8F565F2610E"></a>
<h3 id="BRADV-GUID-AE002ED5-2B57-4878-A759-E8F565F2610E" class="sect3">Restarting a Backup After It Partially Completes</h3>
<div>
<div class="section">
<p>Use the <code class="codeph">SINCE</code> <code class="codeph">TIME</code> parameter of the <code class="codeph">BACKUP</code> command to specify a date after which a new backup is required. If the <code class="codeph">SINCE</code> <code class="codeph">TIME</code> is later than the completion time, then RMAN backs up the file. If you use <code class="codeph">BACKUP DATABASE NOT BACKED UP</code> without the <code class="codeph">SINCE</code> <code class="codeph">TIME</code> parameter, then RMAN only backs up files that have never been backed up.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To only back up files that were not backed up after a specified date:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to a target database and recovery catalog (if used).</span></li>
<li class="stepexpand"><span>Execute the <code class="codeph">BACKUP ... NOT BACKED UP SINCE TIME</code> command.</span>
<div>
<p>Specify a valid date in the <code class="codeph">SINCE</code> <code class="codeph">TIME</code> parameter. The following example uses the default configured channel to back up all database files and archived redo logs that have not been backed up in the last two weeks:</p>
<pre dir="ltr">BACKUP 
  NOT BACKED UP SINCE TIME &#39;SYSDATE-14&#39;
  DATABASE PLUS ARCHIVELOG;
</pre></div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-AE002ED5-2B57-4878-A759-E8F565F2610E__GUID-4FBE8C43-D1D7-453A-8587-41248F910200">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for an example of how to use the <code class="codeph">BACKUP</code> command to restart a backup that did not complete</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="BRADV301"></a>
<div class="props_rev_3"><a id="GUID-AC3D62EE-FF00-43B9-97CC-3EDF295D2C7D"></a>
<h2 id="BRADV-GUID-AC3D62EE-FF00-43B9-97CC-3EDF295D2C7D" class="sect2">Managing Backup Windows</h2>
<div>
<p>This section explains how to use backup windows to set limits for the time span in which a backup job can complete.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmbckad.htm#GUID-C506BFE1-E4DB-40FD-AB66-D4E00323E029">About Backup Windows</a></p>
</li>
<li>
<p><a href="rcmbckad.htm#GUID-83D2ABBB-192C-4475-88AF-7A4B9F13C234">Specifying a Backup Duration</a></p>
</li>
<li>
<p><a href="rcmbckad.htm#GUID-B01BBEBF-2286-4DAE-A48B-7A695123B3D9">Permitting Partial Backups in a Backup Window</a></p>
</li>
<li>
<p><a href="rcmbckad.htm#GUID-87D29BAC-CD55-4DEB-8F80-056A600CF196">Minimizing Backup Load and Duration</a></p>
</li>
</ul>
</div>
<a id="BRADV89578"></a>
<div class="props_rev_3"><a id="GUID-C506BFE1-E4DB-40FD-AB66-D4E00323E029"></a>
<h3 id="BRADV-GUID-C506BFE1-E4DB-40FD-AB66-D4E00323E029" class="sect3">About Backup Windows</h3>
<div>
<p><a id="d45900e3207" class="indexterm-anchor"></a>A <a href="glossary.htm#GUID-AFA8E2DB-2901-40FF-9E2D-1457810048C2"><span class="xrefglossterm">backup window</span></a> is a period of time during which a backup must complete. For example, you may want to restrict your database backups to a window of time when user activity on your system is low, such as between 2:00 a.m. and 6:00 a.m.</p>
<p>RMAN backs up the least recently backed up files first. By default, RMAN backs up the files at the maximum possible speed. Specifying a window does not mean that RMAN backs up data faster than normal to ensure that the backup completes before the window ends.</p>
<p>By default, if the backup is not complete within the <code class="codeph">DURATION</code> time, then RMAN interrupts the backup and reports an error. If the <code class="codeph">BACKUP</code> command is in a <a class="olink RCMRF151" target="_blank" href="../RCMRF/rcmsynta2012.htm#RCMRF151"><code class="codeph">RUN</code></a> command, then the <code class="codeph">RUN</code> command terminates. Any completed backup sets are retained and can be used in restore operations, even if the entire backup is not complete. Thus, if you retry a job that was interrupted when the available duration expired, each successive attempt covers more of the files needing backup. Any incomplete backup sets are discarded.</p>
</div>
</div>
<a id="BRADV269"></a><a id="BRADV89579"></a>
<div class="props_rev_3"><a id="GUID-83D2ABBB-192C-4475-88AF-7A4B9F13C234"></a>
<h3 id="BRADV-GUID-83D2ABBB-192C-4475-88AF-7A4B9F13C234" class="sect3">Specifying a Backup Duration</h3>
<div>
<div class="section">
<p>Use the <code class="codeph">DURATION</code> parameter of the <a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><code class="codeph">BACKUP</code></a> command to specify how long a given backup job is allowed to run.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To specify a backup duration:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span><a id="d45900e3318" class="indexterm-anchor"></a><a id="d45900e3322" class="indexterm-anchor"></a>Start RMAN and connect to a target database and recovery catalog (if used).</span></li>
<li class="stepexpand"><span>Execute the <code class="codeph">BACKUP DURATION</code> command.</span>
<div>
<p>For example, run the following command at 2:00 a.m. to specify that the backup runs until 6:00 a.m.:</p>
<pre dir="ltr">BACKUP 
  DURATION 4:00 
  TABLESPACE users;
</pre></div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-83D2ABBB-192C-4475-88AF-7A4B9F13C234__GUID-C6D6487C-CB73-410C-B3F5-3E7711A0D3B8">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for the syntax of the <code class="codeph">BACKUP</code> command</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV270"></a><a id="BRADV89580"></a>
<div class="props_rev_3"><a id="GUID-B01BBEBF-2286-4DAE-A48B-7A695123B3D9"></a>
<h3 id="BRADV-GUID-B01BBEBF-2286-4DAE-A48B-7A695123B3D9" class="sect3">Permitting Partial Backups in a Backup Window</h3>
<div>
<div class="section">
<p>When you specify <code class="codeph">PARTIAL</code>, RMAN does not report an error when a backup is interrupted because of the end of the backup window. Instead, RMAN displays a message showing which files are not backed up. If the <code class="codeph">BACKUP</code> command is part of a <code class="codeph">RUN</code> block, then the remaining commands in the <code class="codeph">RUN</code> block continue to execute.</p>
<p>If you specify <code class="codeph">FILESPERSET 1</code>, then RMAN puts each file into its own backup set. When a backup is interrupted at the end of the backup window, only the backup of the file currently being backed up is lost. All backup sets completed during the window are saved, minimizing the lost work caused by the end of the backup window.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To prevent RMAN from issuing an error when a backup partially completes:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to a target database and recovery catalog (if used).</span></li>
<li class="stepexpand"><span>Execute the <a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><code class="codeph">BACKUP DURATION</code></a> command with the <code class="codeph">PARTIAL</code> option.</span>
<div>
<p>For example, you run the following command at 2:00 a.m. to specify that the backup runs until 6:00 a.m. and that each data file is in a separate backup set:</p>
<pre dir="ltr">BACKUP 
  DURATION 4:00 PARTIAL 
  TABLESPACE users 
  FILESPERSET 1;
</pre></div>
</li>
</ol>
</div>
</div>
<a id="BRADV271"></a><a id="BRADV272"></a><a id="BRADV89581"></a>
<div class="props_rev_3"><a id="GUID-87D29BAC-CD55-4DEB-8F80-056A600CF196"></a>
<h3 id="BRADV-GUID-87D29BAC-CD55-4DEB-8F80-056A600CF196" class="sect3">Minimizing Backup Load and Duration</h3>
<div>
<div class="section">
<p>When using <code class="codeph">DURATION</code> you can run the backup with the maximum possible performance, or run as slowly as possible while still finishing within the allotted time, to minimize the performance impact of backup tasks. To maximize performance, use the <code class="codeph">MINIMIZE TIME</code> option with <code class="codeph">DURATION</code>, as shown in <a href="rcmbckad.htm#GUID-87D29BAC-CD55-4DEB-8F80-056A600CF196__CIHIHEHB">Example 10-4</a>.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-87D29BAC-CD55-4DEB-8F80-056A600CF196__CIHIHEHB">
<p class="titleinexample">Example 10-4 Using MINIMIZE TIME with BACKUP DURATION</p>
<pre dir="ltr">BACKUP 
  DURATION 4:00 PARTIAL 
  MINIMIZE TIME 
  DATABASE 
  FILESPERSET 1;
</pre>
<p>To extend the backup to use the full time available, use the <code class="codeph">MINIMIZE LOAD</code> option, as in <a href="rcmbckad.htm#GUID-87D29BAC-CD55-4DEB-8F80-056A600CF196__CHDBGBHG">Example 10-5</a>.</p>
</div>
<!-- class="example" -->
<div class="example" id="GUID-87D29BAC-CD55-4DEB-8F80-056A600CF196__CHDBGBHG">
<p class="titleinexample">Example 10-5 Using MINIMIZE LOAD with BACKUP DURATION</p>
<p>In this example, RMAN monitors the progress of the running backup, and periodically estimates how long the backup takes to complete at its present rate. If RMAN estimates that the backup will finish before the end of the backup window, then it slows down the rate of backup so that the full available duration is used. This reduces the overhead on the database associated with the backup.</p>
<pre dir="ltr">BACKUP 
  DURATION 4:00 
  MINIMIZE LOAD 
  DATABASE 
  FILESPERSET 1;
</pre>
<p>Note these issues when using <code class="codeph">DURATION</code> and <code class="codeph">MINIMIZE LOAD</code> with a tape backup:</p>
<ul style="list-style-type: disc;">
<li>
<p>Efficient backup to tape requires tape streaming. If you use <code class="codeph">MINIMIZE LOAD</code>, then RMAN may reduce the rate of backup to the point where tape streaming is not optimal.</p>
</li>
<li>
<p>RMAN holds the tape resource for the entire duration of the backup window. This prevents the use of the tape resource for any other purpose during the backup window.</p>
</li>
</ul>
<p>Because of these concerns, it is not recommended that you use <code class="codeph">MINIMIZE LOAD</code> when backing up to tape.</p>
<div class="infoboxnotealso" id="GUID-87D29BAC-CD55-4DEB-8F80-056A600CF196__GUID-3E2F2D69-ED89-4D18-B550-04DB8200C9D2">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmtunin.htm#GUID-AD7E0880-DEDB-4339-80E6-125F40591F8F">Media Manager Component of the Write Phase for SBT</a>&#34;</span> for more details on efficient tape handling</p>
</div>
</div>
<!-- class="example" --></div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment500">
<tr>
<td class="cellalignment512">
<table class="cellalignment505">
<tr>
<td class="cellalignment504"><a href="rcmbckba.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment504"><a href="part_mai.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment514">
<table class="cellalignment503">
<tr>
<td class="cellalignment504"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment504"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment504"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment504"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment504"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment504"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>