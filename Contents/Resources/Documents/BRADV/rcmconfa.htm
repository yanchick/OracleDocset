<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-2668"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Configuring%20the%20RMAN%20Environment%3A%20Advanced%20Topics"></a><title>Configuring the RMAN Environment: Advanced Topics</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="Oracle Advanced Compression option"/>
<meta name="dcterms.created" content="2017-06-07T23:52:16Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Backup and Recovery User&#39;s Guide"/>
<meta name="dcterms.identifier" content="E50658-09"/>
<meta name="dcterms.isVersionOf" content="BRADV"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="rcmconfb.htm" title="Previous" type="text/html"/>
<link rel="Next" href="flashdb.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E50658-09.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-2210B194-FDA8-4BB4-BC1E-DBE7DBEACB4A"></a> <span id="PAGE" style="display:none;">15/48</span> <!-- End Header -->
<a id="BRADV006"></a>
<h1 id="BRADV-GUID-2210B194-FDA8-4BB4-BC1E-DBE7DBEACB4A" class="sect1"><span class="enumeration_chapter">6</span> Configuring the RMAN Environment: Advanced Topics</h1>
<div>
<p>This chapter describes how to perform setup and configuration tasks. This chapter contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfa.htm#GUID-EF072AB8-AE89-4847-90B1-2214FD2336B3">Configuring Advanced Channel Options</a></p>
</li>
<li>
<p><a href="rcmconfa.htm#GUID-AC052271-068A-4E4B-8001-525D417DE865">Configuring Advanced Backup Options</a></p>
</li>
<li>
<p><a href="rcmconfa.htm#GUID-9C633A44-5533-467E-9108-14BC088A1F82">Configuring Auxiliary Instance Data File Names</a></p>
</li>
<li>
<p><a href="rcmconfa.htm#GUID-B7B61600-6DED-413D-B134-1DAE79627A01">Configuring the Snapshot Control File Location</a></p>
</li>
<li>
<p><a href="rcmconfa.htm#GUID-58576D80-BCC4-45EC-B048-AB23A78A7AEE">Configuring RMAN for Use with a Shared Server</a></p>
</li>
<li>
<p><a href="rcmconfa.htm#GUID-AE80F99C-5368-4FC3-83C5-7261BF9174F0">Enabling Lost Write Detection</a></p>
</li>
</ul>
</div>
<a id="BRADV134"></a>
<div class="props_rev_3"><a id="GUID-EF072AB8-AE89-4847-90B1-2214FD2336B3"></a>
<h2 id="BRADV-GUID-EF072AB8-AE89-4847-90B1-2214FD2336B3" class="sect2">Configuring Advanced Channel Options</h2>
<div>
<p>Whereas <a id="d29134e169" class="indexterm-anchor"></a><a id="d29134e173" class="indexterm-anchor"></a><span class="q">&#34;<a href="rcmconfb.htm#GUID-911248BA-A742-426C-9B90-51214CFAF36B">Configuring Channels</a>&#34;</span> explains the basics for configuring channels, this section explains more advanced <a href="glossary.htm#GUID-D7D8E7D7-3CD3-4FCF-AF75-AF2BE11A366F"><span class="xrefglossterm">channel</span></a> topics. This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfa.htm#GUID-42F31F53-07AF-4A81-9387-849D17F90C9A">About Channel Control Options</a></p>
</li>
<li>
<p><a href="rcmconfa.htm#GUID-F4DDECAD-AC08-4BBF-A27C-2E045BF89366">Configuring Specific Channel Parameters</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-EF072AB8-AE89-4847-90B1-2214FD2336B3__GUID-1B604FFD-B09E-4195-B889-E47D89A4D9F1">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmarchi.htm#GUID-282FD0B6-8593-4775-9965-DB47534D349C">About RMAN Channels</a>&#34;</span> for a conceptual overview of configured and allocated channels, and <a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">CONFIGURE</code> syntax</p>
</div>
</div>
<a id="BRADV578"></a><a id="BRADV89456"></a>
<div class="props_rev_3"><a id="GUID-42F31F53-07AF-4A81-9387-849D17F90C9A"></a>
<h3 id="BRADV-GUID-42F31F53-07AF-4A81-9387-849D17F90C9A" class="sect3">About Channel Control Options</h3>
<div>
<p>Whether you allocate channels manually or use <a id="d29134e283" class="indexterm-anchor"></a><a href="glossary.htm#GUID-8473579D-F533-48AA-B7E7-DB4AB8E812D6"><span class="xrefglossterm">automatic channel allocation</span></a>, you can use channel commands and options to control behavior. <a href="rcmconfa.htm#GUID-42F31F53-07AF-4A81-9387-849D17F90C9A__CHDHFEBJ" title="Summarizes channel control options">Table 6-1</a> summarizes the ways in which you can control channel behavior. Unless noted, all channel parameters are supported in <a id="d29134e294" class="indexterm-anchor"></a><a id="d29134e298" class="indexterm-anchor"></a><a id="d29134e302" class="indexterm-anchor"></a><a id="d29134e304" class="indexterm-anchor"></a>both <code class="codeph">CONFIGURE CHANNEL</code> and <code class="codeph">ALLOCATE CHANNEL</code> commands.</p>
<div class="tblformal" id="GUID-42F31F53-07AF-4A81-9387-849D17F90C9A__CHDHFEBJ">
<p class="titleintable">Table 6-1 Channel Control Options</p>
<table class="cellalignment515" title="Channel Control Options" summary="Summarizes channel control options">
<thead>
<tr class="cellalignment501">
<th class="cellalignment545" id="d29134e326">Type of Channel Control</th>
<th class="cellalignment546" id="d29134e329">Commands</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment501">
<td class="cellalignment547" id="d29134e334" headers="d29134e326">
<p>Limit I/O bandwidth consumption</p>
</td>
<td class="cellalignment548" headers="d29134e334 d29134e329">
<p>Use the <code class="codeph">RATE</code> channel parameter to act as a throttling mechanism for backups.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment547" id="d29134e344" headers="d29134e326">
<p>Limit backup sets and pieces</p>
</td>
<td class="cellalignment548" headers="d29134e344 d29134e329">
<p>Use the <code class="codeph">MAXPIECESIZE</code> channel parameter to set limits on the size of backup pieces. You can also use the <code class="codeph">MAXSETSIZE</code> parameter on <a id="d29134e356" class="indexterm-anchor"></a><a id="d29134e360" class="indexterm-anchor"></a>the <code class="codeph">BACKUP</code> and <code class="codeph">CONFIGURE</code> commands to set a limit for the size of backup sets.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment547" id="d29134e370" headers="d29134e326">
<p>Vendor-specific instructions</p>
</td>
<td class="cellalignment548" headers="d29134e370 d29134e329">
<p>Use the <code class="codeph">PARMS</code> channel parameter to specify vendor-specific information for a <a href="glossary.htm#GUID-26FF62D0-5938-481D-B7B9-929BC971813E"><span class="xrefglossterm">media management software</span></a>. You can also use the <code class="codeph">SEND</code> command to send vendor-specific commands to a media manager.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment547" id="d29134e387" headers="d29134e326">
<p>Channel parallel backup and restore operations</p>
</td>
<td class="cellalignment548" headers="d29134e387 d29134e329">
<p>Use <code class="codeph">CONFIGURE DEVICE TYPE ... PARALLELISM</code> for persistent channel parallelism or multiple <code class="codeph">ALLOCATE CHANNEL</code> commands for job-level parallelism.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment547" id="d29134e400" headers="d29134e326">
<p>Connection settings for database instances</p>
</td>
<td class="cellalignment548" headers="d29134e400 d29134e329">
<p>Specify which instance performs an operation with the <code class="codeph">CONNECT</code> channel parameter.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="infoboxnotealso" id="GUID-42F31F53-07AF-4A81-9387-849D17F90C9A__GUID-55E2EF58-DBDA-4DC7-8C0E-4F7AD8C454B4">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF102" target="_blank" href="../RCMRF/rcmsynta004.htm#RCMRF102"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">ALLOCATE</code> <code class="codeph">CHANNEL</code> syntax, and <a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">CONFIGURE</code> syntax</p>
</div>
</div>
</div>
<a id="BRADV89457"></a>
<div class="props_rev_3"><a id="GUID-F4DDECAD-AC08-4BBF-A27C-2E045BF89366"></a>
<h3 id="BRADV-GUID-F4DDECAD-AC08-4BBF-A27C-2E045BF89366" class="sect3">Configuring Specific Channel Parameters</h3>
<div>
<div class="section">
<p><a id="d29134e500" class="indexterm-anchor"></a><a id="d29134e504" class="indexterm-anchor"></a>In addition to configuring parameters that apply to all channels of a particular type, you can also configure parameters that apply to one specific channel. Run the <code class="codeph">CONFIGURE CHANNEL</code> <span class="italic"><code class="codeph">n</code></span> command (where <span class="italic"><code class="codeph">n</code></span> is a positive integer less than 255) to configure a specific channel.</p>
<p>When manually numbering channels, you must specify one or more channel options (for example, <code class="codeph">MAXPIECESIZE</code> or <a class="olink RCMRF195" target="_blank" href="../RCMRF/rcmsubcl012.htm#RCMRF195"><code class="codeph">FORMAT</code></a>) for each channel. When you use that specific numbered channel in a backup, the configured settings for that channel are used instead of the configured generic channel settings.</p>
<p>Configure specific channels by number when it is necessary to control the parameters set for each channel separately. This technique is necessary in the following situations:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>When running an <a id="d29134e537" class="indexterm-anchor"></a><a id="d29134e541" class="indexterm-anchor"></a>Oracle Real Application Clusters (Oracle RAC) database in which individual nodes do not have access to the full set of backups. Each channel must be configured with a node-specific connect string so that all backups are accessible by at least one channel.</p>
</li>
<li>
<p>When using a media manager that requires different <code class="codeph">PARMS</code> settings on each channel.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-F4DDECAD-AC08-4BBF-A27C-2E045BF89366__GUID-3EBDC58F-B3B5-4BC5-B488-7B7BA9A46895">
<p class="notep1">See Also:</p>
<p><a class="olink RACAD320" target="_blank" href="../RACAD/GUID-1051C520-07B2-431B-9B9B-E500B22547C1.htm#RACAD320"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> to learn about RMAN backups in an Oracle RAC environment</p>
</div>
</div>
<!-- class="section" --></div>
<a id="BRADV183"></a><a id="BRADV89458"></a>
<div class="props_rev_3"><a id="GUID-45919A66-85EE-4197-BD54-FE6D15DE6958"></a>
<h4 id="BRADV-GUID-45919A66-85EE-4197-BD54-FE6D15DE6958" class="sect4">Configuring Specific Channels: Examples</h4>
<div>
<p>The following example sends disk backups to two different disks. Configure disk channels as follows:</p>
<pre dir="ltr">CONFIGURE DEFAULT DEVICE TYPE TO disk;        # backup goes to disk
CONFIGURE DEVICE TYPE disk PARALLELISM 2;     # two channels used in parallel
CONFIGURE CHANNEL 1 DEVICE TYPE DISK FORMAT &#39;/disk1/%U&#39; # 1st channel to disk1 
CONFIGURE CHANNEL 2 DEVICE TYPE DISK FORMAT &#39;/disk2/%U&#39; # 2nd channel to disk2
BACKUP DATABASE; # backup - first channel goes to disk1 and second to disk2
</pre>
<p><a href="rcmconfa.htm#GUID-45919A66-85EE-4197-BD54-FE6D15DE6958__CHDFCEGA">Example 6-1</a> configures channels to create parallel database backups. You have two tape drives and want each drive to use tapes from a different tape media family. The backup data is divided between the two tape devices. Each configured channel backs up approximately half the total data.</p>
<div class="example" id="GUID-45919A66-85EE-4197-BD54-FE6D15DE6958__CHDFCEGA">
<p class="titleinexample">Example 6-1 Configuring Channel Parallelism for Tape Devices</p>
<pre dir="ltr">CONFIGURE DEFAULT DEVICE TYPE TO sbt;    # backup goes to sbt
CONFIGURE DEVICE TYPE sbt PARALLELISM 2; # two sbt channels allocated by default
# Configure channel 1 to pool named first_pool
CONFIGURE CHANNEL 1 DEVICE TYPE sbt 
  PARMS &#39;ENV=(OB_MEDIA_FAMILY=first_pool)&#39;; 
# configure channel 2 to pool named second_pool
CONFIGURE CHANNEL 2 DEVICE TYPE sbt 
  PARMS &#39;ENV=(OB_MEDIA_FAMILY=second_pool)&#39;; 
BACKUP DATABASE; # first stream goes to &#39;first_pool&#39; and second to &#39;second_pool&#39;
</pre></div>
<!-- class="example" --></div>
</div>
<a id="BRADV89459"></a>
<div class="props_rev_3"><a id="GUID-CD9FE2BB-4F7E-46DA-A4FA-70D3F992A154"></a>
<h4 id="BRADV-GUID-CD9FE2BB-4F7E-46DA-A4FA-70D3F992A154" class="sect4">Relationship Between CONFIGURE CHANNEL and Parallelism Setting</h4>
<div>
<p>The <code class="codeph">PARALLELISM</code> setting is not constrained by the number of specifically configured channels. For example, if you back up to 20 different tape devices, then you can configure 20 different SBT channels, each with a manually assigned number (from 1 to 20) and each with a different set of channel options. In such a situation, you can set <code class="codeph">PARALLELISM</code> to any value up to the number of devices, in this instance 20.</p>
<p>RMAN always numbers parallel channels starting with <code class="codeph">1</code> and ending with the <code class="codeph">PARALLELISM</code> setting. For example, if the default device is SBT and parallelism is set to 3, then RMAN names the channels as follows:</p>
<pre dir="ltr">ORA_SBT_TAPE_1
ORA_SBT_TAPE_2
ORA_SBT_TAPE_3
</pre>
<p>RMAN always uses the name <code class="codeph">ORA_SBT_TAPE_</code><span class="italic">n</span> even if you configure <code class="codeph">DEVICE</code> <code class="codeph">TYPE</code> <code class="codeph">sbt</code> (not the synonymous <code class="codeph">sbt_tape</code>). RMAN always allocates the number of channels specified in <code class="codeph">PARALLELISM</code>, using specifically configured channels if you have configured them and generic channels if you have not. If you configure specific channels with numbers higher than the parallelism setting, then this setting prevents RMAN from using them.</p>
<div class="infoboxnotealso" id="GUID-CD9FE2BB-4F7E-46DA-A4FA-70D3F992A154__GUID-38745B78-0E3B-4418-A239-18EC55845E33">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmarchi.htm#GUID-282FD0B6-8593-4775-9965-DB47534D349C">About RMAN Channels</a>&#34;</span> to learn about channels</p>
</div>
</div>
</div>
</div>
</div>
<a id="BRADV89460"></a>
<div class="props_rev_3"><a id="GUID-AC052271-068A-4E4B-8001-525D417DE865"></a>
<h2 id="BRADV-GUID-AC052271-068A-4E4B-8001-525D417DE865" class="sect2">Configuring Advanced Backup Options</h2>
<div>
<p><span class="q">&#34;<a href="rcmconfb.htm#GUID-AD92E09D-0788-4AB5-8792-5F969C8D237A">About Configuring the Environment for RMAN Backups</a>&#34;</span> explains the basics for configuring RMAN to make backups. This section explains more advanced configuration options. This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfa.htm#GUID-0A131C1F-85F1-4FED-8EFB-D747679A184A">Configuring the Maximum Size of Backup Sets</a></p>
</li>
<li>
<p><a href="rcmconfa.htm#GUID-B5C38414-33DD-4A0F-B0FD-B63F1AC74B33">Configuring the Maximum Size of Backup Pieces</a></p>
</li>
<li>
<p><a href="rcmconfa.htm#GUID-2A285F87-552A-4F36-A5B9-F25A69611B4B">Configuring Backup Duplexing</a></p>
</li>
<li>
<p><a href="rcmconfa.htm#GUID-9E83A7FF-6D4B-4385-8BF0-D5E65E808078">Configuring Tablespaces for Exclusion from Whole Database Backups</a></p>
</li>
<li>
<p><a href="rcmconfa.htm#GUID-3117DA93-EC34-488D-A4FB-29E6CD4D168A">Configuring Compression Options</a></p>
</li>
<li>
<p><a href="rcmconfa.htm#GUID-21D5FCCE-7AF1-4CF8-BC53-2496ECE3C56E">Configuring Backup Encryption</a></p>
</li>
</ul>
</div>
<a id="BRADV137"></a>
<div class="props_rev_3"><a id="GUID-0A131C1F-85F1-4FED-8EFB-D747679A184A"></a>
<h3 id="BRADV-GUID-0A131C1F-85F1-4FED-8EFB-D747679A184A" class="sect3">Configuring the Maximum Size of Backup Sets</h3>
<div>
<div class="section">
<p><a id="d29134e931" class="indexterm-anchor"></a><a id="d29134e935" class="indexterm-anchor"></a><a id="d29134e939" class="indexterm-anchor"></a><a id="d29134e943" class="indexterm-anchor"></a><a id="d29134e947" class="indexterm-anchor"></a>In tape backups, it is possible for a <a id="d29134e952" class="indexterm-anchor"></a><a id="d29134e954" class="indexterm-anchor"></a><a href="glossary.htm#GUID-EA6CE3E8-6986-4512-AF66-710D80376093"><span class="xrefglossterm">multiplexed backup set</span></a> to span multiple tapes, which means that blocks from each data file in the backup set are written to multiple tapes. If one tape of a multivolume backup set fails, then you lose the data on all the tapes rather than just one. If a backup is not a <a href="glossary.htm#GUID-6D6DDA5E-F1EF-4273-8649-137F1FC89EB6"><span class="xrefglossterm">multisection backup</span></a>, then a backup set always includes a whole data file rather than a partial data file. You can use <code class="codeph">MAXSETSIZE</code> to specify that each backup set fits on one tape rather than spanning multiple tapes.</p>
<p><a id="d29134e971" class="indexterm-anchor"></a><a id="d29134e975" class="indexterm-anchor"></a>The <a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><code class="codeph">CONFIGURE MAXSETSIZE</code></a> command limits the size of backup sets created on a channel. This <code class="codeph">CONFIGURE</code> setting applies to any channel, whether manually allocated or configured, <a id="d29134e988" class="indexterm-anchor"></a><a id="d29134e992" class="indexterm-anchor"></a>when the <a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><code class="codeph">BACKUP</code></a> command is used to create backup sets. The default value is given in bytes and is rounded down to the lowest kilobyte value.</p>
<p>The value set by the <code class="codeph">CONFIGURE MAXSETSIZE</code> command is a default for the given channel. You can override the configured <code class="codeph">MAXSETSIZE</code> value by specifying a <code class="codeph">MAXSETSIZE</code> option for an individual <code class="codeph">BACKUP</code> command.</p>
<p>Assume that you issue the following commands at the RMAN prompt:</p>
<pre dir="ltr">CONFIGURE DEFAULT DEVICE TYPE TO sbt;
CONFIGURE CHANNEL DEVICE TYPE sbt PARMS &#39;ENV=(OB_MEDIA_FAMILY=first_pool)&#39;; 
CONFIGURE MAXSETSIZE TO 7500K;
BACKUP TABLESPACE users;
BACKUP TABLESPACE tools MAXSETSIZE 5G;
</pre>
<p>The results are as follows:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>The backup of the <code class="codeph">users</code> tablespace uses the configured <a href="glossary.htm#GUID-2E48CE71-9547-4196-B715-5CE59033262E"><span class="xrefglossterm">SBT</span></a> channel and the configured default <code class="codeph">MAXSETSIZE</code> setting of <code class="codeph">7500K</code>.</p>
</li>
<li>
<p>The backup of the <code class="codeph">tools</code> tablespace uses the <code class="codeph">MAXSETSIZE</code> setting of <code class="codeph">5G</code> specified in the <code class="codeph">BACKUP</code> command.</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-0A131C1F-85F1-4FED-8EFB-D747679A184A__GUID-904019A7-E3C3-4411-A4A1-9C578F9CA731">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="rcmbckad.htm#GUID-DD5D76A0-2C93-4847-8E79-8E75ACAF4119">Limiting the Size of Backup Sets with BACKUP ... MAXSETSIZE</a>&#34;</span></p>
</li>
<li>
<p><a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">BACKUP</code> syntax</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV89461"></a>
<div class="props_rev_3"><a id="GUID-B5C38414-33DD-4A0F-B0FD-B63F1AC74B33"></a>
<h3 id="BRADV-GUID-B5C38414-33DD-4A0F-B0FD-B63F1AC74B33" class="sect3">Configuring the Maximum Size of Backup Pieces</h3>
<div>
<div class="section">
<p><a id="d29134e1141" class="indexterm-anchor"></a>Backup piece size is an issue when it exceeds the maximum file size permitted by the file system or media management software. <a id="d29134e1146" class="indexterm-anchor"></a><a id="d29134e1150" class="indexterm-anchor"></a><a id="d29134e1154" class="indexterm-anchor"></a><a id="d29134e1158" class="indexterm-anchor"></a>You can use the <code class="codeph">MAXPIECESIZE</code> parameter of the <code class="codeph">CONFIGURE</code> <code class="codeph">CHANNEL</code> or <code class="codeph">ALLOCATE</code> <code class="codeph">CHANNEL</code> command to limit the size of backup pieces.</p>
<p>For example, to limit the backup piece size to 2 gigabytes or less, you can configure the automatic <code class="codeph">DISK</code> channel as follows and then run <code class="codeph">BACKUP</code> <code class="codeph">DATABASE</code>:</p>
<pre dir="ltr">CONFIGURE CHANNEL DEVICE TYPE DISK MAXPIECESIZE 2G;
BACKUP DATABASE;
</pre>
<div class="infobox-note" id="GUID-B5C38414-33DD-4A0F-B0FD-B63F1AC74B33__GUID-2A536D8D-18F6-4FC5-9C50-440F54755CAA">
<p class="notep1">Note:</p>
<p>In version 2.0 of the media management <a id="d29134e1195" class="indexterm-anchor"></a>API, media management vendors can specify the maximum size of a backup piece that can be written to their media manager. RMAN respects this limit regardless of the settings that you configure for <code class="codeph">MAXPIECESIZE</code>.</p>
</div>
<div class="infoboxnotealso" id="GUID-B5C38414-33DD-4A0F-B0FD-B63F1AC74B33__GUID-CC7629E9-40D9-4931-A07D-A59EB0412F9D">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> to learn about the <code class="codeph">CONFIGURE CHANNEL ... MAXPIECESIZE</code> command</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV139"></a>
<div class="props_rev_3"><a id="GUID-2A285F87-552A-4F36-A5B9-F25A69611B4B"></a>
<h3 id="BRADV-GUID-2A285F87-552A-4F36-A5B9-F25A69611B4B" class="sect3">Configuring Backup Duplexing</h3>
<div>
<div class="section">
<p><a id="d29134e1282" class="indexterm-anchor"></a><a id="d29134e1286" class="indexterm-anchor"></a><a id="d29134e1288" class="indexterm-anchor"></a><a id="d29134e1292" class="indexterm-anchor"></a><a id="d29134e1294" class="indexterm-anchor"></a>You can use the <a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><code class="codeph">CONFIGURE ... BACKUP COPIES</code></a> command to specify how many copies of each backup piece are created on the specified device type for the specified type of file. This type of backup is known as a <a href="glossary.htm#GUID-614D6594-1A1A-46EE-A041-312ADAB7E151"><span class="xrefglossterm">duplexed backup set</span></a>. The <code class="codeph">CONFIGURE</code> settings for duplexing only affect backups of data files, control files, and archived logs into backup sets, and do not affect image copies.</p>
<div class="infobox-note" id="GUID-2A285F87-552A-4F36-A5B9-F25A69611B4B__GUID-412DEA7F-0BEA-48AD-B474-5D98BD527CB3">
<p class="notep1">Note:</p>
<p>A <a href="glossary.htm#GUID-7CDA6567-DFB0-450D-8771-B033E9872AF7"><span class="xrefglossterm">control file autobackup</span></a> is <span class="italic">never</span> duplexed.</p>
</div>
<p>RMAN can duplex backups to either disk or tape, but cannot duplex backups to tape and disk simultaneously. When backing up to tape, ensure that the number of copies does not exceed the number of available tape devices. The following examples show possible duplexing configurations:</p>
<pre dir="ltr"># Makes 2 disk copies of each data file and control file backup set
# (autobackups excluded)
CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE DISK TO 2;
# Makes 3 copies of every archived redo log backup to tape
CONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE sbt TO 3;
</pre>
<p>To return a <code class="codeph">BACKUP</code> <code class="codeph">COPIES</code> configuration to its default value, run the same <code class="codeph">CONFIGURE</code> command with the <code class="codeph">CLEAR</code> option, as in the following example:</p>
<pre dir="ltr">CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE sbt CLEAR;
</pre>
<p>By default, <code class="codeph">CONFIGURE</code> <code class="codeph">...</code> <code class="codeph">BACKUP</code> <code class="codeph">COPIES</code> is set to <code class="codeph">1</code> for each device type.</p>
<div class="infobox-note" id="GUID-2A285F87-552A-4F36-A5B9-F25A69611B4B__GUID-159A0982-84C5-47A6-88FC-64F3164DA28B">
<p class="notep1">Note:</p>
<p>If you do not want to create a persistent copies configuration, then you can specify copies with the <code class="codeph">BACKUP</code> <code class="codeph">COPIES</code> and the <a class="olink RCMRF153" target="_blank" href="../RCMRF/rcmsynta2014.htm#RCMRF153"><code class="codeph">SET BACKUP COPIES</code></a> commands.</p>
</div>
<div class="infoboxnotealso" id="GUID-2A285F87-552A-4F36-A5B9-F25A69611B4B__GUID-3EDB47F1-2AB9-42B7-8EA2-503CF6CCE585">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="rcmcncpt.htm#GUID-763A9C75-90A5-48FD-9CB6-707D030A00F5">About Multiple Copies of RMAN Backups</a>&#34;</span> for an overview of duplexed backups</p>
</li>
<li>
<p><span class="q">&#34;<a href="rcmbckad.htm#GUID-4CFE9BA0-E298-42B8-9FB6-D36751C09D54">Duplexing Backup Sets</a>&#34;</span> to learn how to create duplexed backups</p>
</li>
<li>
<p><a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">BACKUP</code> syntax</p>
</li>
<li>
<p><a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">CONFIGURE</code> syntax</p>
</li>
<li>
<p><a class="olink RCMRF153" target="_blank" href="../RCMRF/rcmsynta2014.htm#RCMRF153"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">SET</code> syntax</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV140"></a>
<div class="props_rev_3"><a id="GUID-9E83A7FF-6D4B-4385-8BF0-D5E65E808078"></a>
<h3 id="BRADV-GUID-9E83A7FF-6D4B-4385-8BF0-D5E65E808078" class="sect3">Configuring Tablespaces for Exclusion from Whole Database Backups</h3>
<div>
<div class="section">
<p><a id="d29134e1488" class="indexterm-anchor"></a>Sometimes you may want to omit a specified tablespace from part of the regular backup schedule. Here are some possible scenarios to consider:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>A tablespace is easy to rebuild, so it is more cost-effective to rebuild it than back it up every day.</p>
</li>
<li>
<p>A tablespace contains temporary or test data that you do not need to back up.</p>
</li>
<li>
<p>A tablespace does not change often and therefore should be backed up on a different schedule from other backups.</p>
</li>
</ul>
<p><a id="d29134e1505" class="indexterm-anchor"></a><a id="d29134e1509" class="indexterm-anchor"></a><a id="d29134e1513" class="indexterm-anchor"></a><a id="d29134e1517" class="indexterm-anchor"></a>You can run <a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><code class="codeph">CONFIGURE EXCLUDE FOR TABLESPACE</code></a> to exclude the specified tablespace from <a id="d29134e1527" class="indexterm-anchor"></a><a id="d29134e1531" class="indexterm-anchor"></a>the <a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><code class="codeph">BACKUP DATABASE</code></a> command. The exclusion condition applies to any data files that you add to this tablespace in the future.</p>
<p>For example, you can exclude testing tablespaces <code class="codeph">cwmlite</code> and <code class="codeph">example</code> from whole database backups as follows:</p>
<pre dir="ltr">CONFIGURE EXCLUDE FOR TABLESPACE cwmlite;
CONFIGURE EXCLUDE FOR TABLESPACE example;
</pre>
<p>If you run the following command, then RMAN backs up all tablespaces in the database except <code class="codeph">cwmlite</code> and <code class="codeph">example</code>:</p>
<pre dir="ltr">BACKUP DATABASE;
</pre>
<p>You can still back up the configured tablespaces by explicitly specifying them in a <code class="codeph">BACKUP</code> command or by specifying the <code class="codeph">NOEXCLUDE</code> option on a <code class="codeph">BACKUP</code> <code class="codeph">DATABASE</code> command. For example, you can enter one of the following commands:</p>
<pre dir="ltr">BACKUP DATABASE NOEXCLUDE; #backs up database, including cwmlite and example
BACKUP TABLESPACE cwmlite, example;  # backs up only cwmlite and example
</pre>
<p>You can disable the exclusion feature for <code class="codeph">cwmlite</code> and <code class="codeph">example</code> as follows:</p>
<pre dir="ltr">CONFIGURE EXCLUDE FOR TABLESPACE cwmlite CLEAR;
CONFIGURE EXCLUDE FOR TABLESPACE example CLEAR;
</pre>
<p>RMAN includes these tablespaces in future whole database backups.</p>
<div class="infoboxnotealso" id="GUID-9E83A7FF-6D4B-4385-8BF0-D5E65E808078__GUID-5AB38908-B940-4228-B8B5-94F4788302F5">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">BACKUP</code> and <code class="codeph">CONFIGURE</code> syntax</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV89466"></a>
<div class="props_rev_3"><a id="GUID-3117DA93-EC34-488D-A4FB-29E6CD4D168A"></a>
<h3 id="BRADV-GUID-3117DA93-EC34-488D-A4FB-29E6CD4D168A" class="sect3">Configuring Compression Options</h3>
<div>
<p><a id="d29134e1672" class="indexterm-anchor"></a><a id="d29134e1676" class="indexterm-anchor"></a>RMAN supports precompression processing and <a href="glossary.htm#GUID-90E07DCF-D038-4770-8A1A-06AF137C3762"><span class="xrefglossterm">binary compression</span></a> of backup sets. The <code class="codeph">CONFIGURE COMPRESSION ALGORITHM</code> command enables you to configure compression options.</p>
<p>This following topics contain additional information about compression:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfa.htm#GUID-1715CC25-E958-4AA1-B362-1818468DC290">About RMAN Precompression Block Processing</a></p>
</li>
<li>
<p><a href="rcmconfa.htm#GUID-1E61757C-0A4D-4407-BF8E-7D048B216278">About RMAN Supported Compression Levels</a></p>
</li>
</ul>
</div>
<a id="BRADV184"></a>
<div class="props_rev_3"><a id="GUID-1715CC25-E958-4AA1-B362-1818468DC290"></a>
<h4 id="BRADV-GUID-1715CC25-E958-4AA1-B362-1818468DC290" class="sect4">About RMAN Precompression Block Processing</h4>
<div>
<p>Better backup compression ratios are achieved by consolidating the free space in each data block, and setting that free space to binary zeroes. This precompression processing stage has the most benefit for data blocks that have been the subject of many deletes and inserts operations. Conversely, it has no effect on data blocks that are still in their initial loaded state.</p>
<p>The <code class="codeph">OPTIMIZE FOR LOAD</code> option controls precompression processing. By specifying the default, <code class="codeph">OPTIMIZE FOR LOAD TRUE</code>, you ensure that RMAN optimizes CPU usage and avoids precompression block processing. By specifying <code class="codeph">OPTIMIZE FOR LOAD FALSE</code>, RMAN uses additional CPU resources to perform precompression block processing.</p>
<div class="infoboxnotealso" id="GUID-1715CC25-E958-4AA1-B362-1818468DC290__GUID-27579522-1054-419B-A250-4823EB94E2B6">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink RCMRF" target="_blank" href="../RCMRF/toc.htm"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">CONFIGURE</code> and <code class="codeph">SET</code> syntax</p>
</li>
</ul>
</div>
</div>
</div>
<a id="BRADV834"></a>
<div class="props_rev_3"><a id="GUID-1E61757C-0A4D-4407-BF8E-7D048B216278"></a>
<h4 id="BRADV-GUID-1E61757C-0A4D-4407-BF8E-7D048B216278" class="sect4">About RMAN Supported Compression Levels</h4>
<div>
<p>Oracle Database provides two categories of compression algorithms: a default compression algorithm and a group of compression algorithms available with the Oracle Advanced Compression option. The default algorithm is a standard feature of Oracle Database while the Oracle Advanced Compression option is a separately purchased option.</p>
<div class="infoboxnotealso" id="GUID-1E61757C-0A4D-4407-BF8E-7D048B216278__GUID-13296A82-18A2-4CB8-AD09-957A18486D82">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfa.htm#GUID-57B1288E-F426-4C65-AAF4-6D0F7D5C9BA6">About RMAN Default Compression</a></p>
</li>
<li>
<p><a href="rcmconfa.htm#GUID-0AA6DB13-ABA9-4BFB-9E42-38DADB9A0B45">About Oracle Advanced Compression Option</a></p>
</li>
</ul>
</div>
</div>
<a id="BRADV186"></a><a id="BRADV185"></a>
<div class="props_rev_3"><a id="GUID-57B1288E-F426-4C65-AAF4-6D0F7D5C9BA6"></a>
<h5 id="BRADV-GUID-57B1288E-F426-4C65-AAF4-6D0F7D5C9BA6" class="sect5">About RMAN Default Compression</h5>
<div>
<p>You can configure the default compression algorithm, which does not require the Oracle Advanced Compression option, with the following syntax:</p>
<div class="example" id="GUID-57B1288E-F426-4C65-AAF4-6D0F7D5C9BA6__GUID-6A01D728-D528-4E28-A6DD-83B818DB1BDA">
<p class="titleinexample">Example 6-2 Configuring Basic Compression for Backup</p>
<pre dir="ltr">CONFIGURE COMPRESSION ALGORITHM &#39;BASIC&#39;;
</pre></div>
<!-- class="example" --></div>
</div>
<a id="BRADV187"></a>
<div class="props_rev_3"><a id="GUID-0AA6DB13-ABA9-4BFB-9E42-38DADB9A0B45"></a>
<h5 id="BRADV-GUID-0AA6DB13-ABA9-4BFB-9E42-38DADB9A0B45" class="sect5">About Oracle Advanced Compression Option</h5>
<div>
<p>If you have enabled the Oracle Advanced Compression option, you can choose from the following compression levels:</p>
<div class="tblformal" id="GUID-0AA6DB13-ABA9-4BFB-9E42-38DADB9A0B45__GUID-547DA1BE-7E85-4A76-AA8E-FE99000E07B2">
<table class="cellalignment515" summary="List of compression values">
<thead>
<tr class="cellalignment501">
<th class="cellalignment549" id="d29134e2037">Compression Level</th>
<th class="cellalignment550" id="d29134e2040">Performance Benefits and Trade-Offs</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment501">
<td class="cellalignment551" id="d29134e2045" headers="d29134e2037">
<p><code class="codeph">HIGH</code></p>
</td>
<td class="cellalignment552" headers="d29134e2045 d29134e2040">
<p>Best suited for backups over slower networks where the limiting factor is network speed.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment551" id="d29134e2053" headers="d29134e2037">
<p><code class="codeph">MEDIUM</code></p>
</td>
<td class="cellalignment552" headers="d29134e2053 d29134e2040">
<p>Recommended for most environments. Good combination of compression ratios and speed.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment551" id="d29134e2061" headers="d29134e2037">
<p><code class="codeph">LOW</code></p>
</td>
<td class="cellalignment552" headers="d29134e2061 d29134e2040">
<p>Least effect on backup throughput.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>The compression ratio generally increases from low to high, with a trade-off of potentially consuming more CPU resources.</p>
<p>Because the performance of the various compression levels depends on the nature of the data in the database, network configuration, system resources and the type of computer system and its capabilities, Oracle cannot document universally applicable performance statistics. Which level is best for your environment depends on how balanced your system is regarding bandwidth into the CPU and the actual speed of the CPU. It is highly recommended that you run tests with the different compression levels on the data in your environment. Choosing a compression level based on your environment, network traffic characteristics (workload), and data set is the only way to ensure that the backup set compression level can satisfy your organization&#39;s performance requirements and applicable service level agreements.</p>
<div class="infobox-note" id="GUID-0AA6DB13-ABA9-4BFB-9E42-38DADB9A0B45__GUID-6CFDEBFC-604D-47EB-A82D-B5FECDDEAE91">
<p class="notep1">Note:</p>
<ul style="list-style-type: disc;">
<li>
<p>See <a class="olink DBLIC159" target="_blank" href="../DBLIC/options.htm#DBLIC159"><span class="italic">Oracle Database Licensing Information</span></a> for more information about the Oracle Advanced Compression option.</p>
</li>
<li>
<p>If you are backing up to tape and your tape device performs its own compression, then do not use both RMAN backup set compression and the media manager vendor&#39;s compression. See the discussion of tuning RMAN&#39;s tape backup performance in <a href="rcmtunin.htm#GUID-33D81037-2310-4021-8039-1A2C579AAA5A">Tuning RMAN Performance</a>.</p>
</li>
<li>
<p>Restoring a compressed backup is performed inline, and does not require decompression.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<a id="BRADV89467"></a>
<div class="props_rev_3"><a id="GUID-21D5FCCE-7AF1-4CF8-BC53-2496ECE3C56E"></a>
<h3 id="BRADV-GUID-21D5FCCE-7AF1-4CF8-BC53-2496ECE3C56E" class="sect3">Configuring Backup Encryption</h3>
<div>
<p>For improved security, you can configure <a id="d29134e2163" class="indexterm-anchor"></a><a href="glossary.htm#GUID-65A13E9F-7391-4A6A-8379-B2EA64D0EA9E"><span class="xrefglossterm">backup encryption</span></a> for RMAN backup sets. Encrypted backups cannot be read if they are obtained by unauthorized users.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfa.htm#GUID-6ED708C7-1092-45FC-80C6-236F062D0DAC">About Backup Encryption</a></p>
</li>
<li>
<p><a href="rcmconfa.htm#GUID-BAA3CFF0-C95C-4AF2-90DD-764754325D73">Configuring RMAN Backup Encryption Modes</a></p>
</li>
<li>
<p><a href="rcmconfa.htm#GUID-97ED7AA5-476C-4068-9C6C-97A0C0353864">Configuring the Backup Encryption Algorithm</a></p>
</li>
</ul>
</div>
<a id="BRADV89468"></a>
<div class="props_rev_3"><a id="GUID-6ED708C7-1092-45FC-80C6-236F062D0DAC"></a>
<h4 id="BRADV-GUID-6ED708C7-1092-45FC-80C6-236F062D0DAC" class="sect4">About Backup Encryption</h4>
<div>
<p><a id="d29134e2258" class="indexterm-anchor"></a>The <a class="olink REFRN30418" target="_blank" href="../REFRN/GUID-9761C75A-59B9-4ED7-98B1-55FBBA1858F1.htm#REFRN30418"><code class="codeph">V$RMAN_ENCRYPTION_ALGORITHMS</code></a> view contains a list of encryption algorithms supported by RMAN. If no encryption algorithm is specified, then the default encryption algorithm is 128-bit Advanced Encryption Standard (AES). RMAN encryption requires the<a id="d29134e2266" class="indexterm-anchor"></a> <a class="olink REFRN10019" target="_blank" href="../REFRN/GUID-6C57EE11-BD06-4BB8-A0F7-D6CDDD086FA9.htm#REFRN10019"><code class="codeph">COMPATIBLE</code></a> initialization parameter at a target database to be at least 10.2.0.</p>
<p>RMAN offers the following encryption modes:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfa.htm#GUID-00CCDDB4-E999-4956-AF30-15E7D622908B">Transparent Encryption of Backups</a></p>
<p>This is the default mode and uses the Oracle software keystore. A keystore is a password-protected container used to store a Transparent Data Encryption (TDE) key. In previous releases, this container was referred to as a wallet.</p>
</li>
<li>
<p><a href="rcmconfa.htm#GUID-8D85E7DF-53FE-4AF8-811B-CA836B737B36">Password Encryption of Backups</a></p>
<p>This mode uses only password protection. You must provide a password when creating and restoring encrypted backups.</p>
</li>
<li>
<p><a href="rcmconfa.htm#GUID-433BCC86-BA70-4D37-B9C3-92BACFAE72E8">Dual Mode Encryption of Backups</a></p>
<p>This mode requires either the keystore or a password.</p>
</li>
</ul>
<div class="infobox-note" id="GUID-6ED708C7-1092-45FC-80C6-236F062D0DAC__GUID-DFB3F9BF-87A5-4E6A-ABB6-2711A7BB9432">
<p class="notep1">Note:</p>
<p>Keystore-based encryption is more secure than password-based encryption because no passwords are involved. Use password-based encryption only when it is absolutely necessary because your backups must be transportable.</p>
</div>
<p>Encrypted backups are decrypted automatically during restore and recovery, if the required decryption keys are available. Each backup set gets a separate key. The key is stored in encrypted form in the backup piece. The backup is decrypted with keys obtained by a user-supplied password or the Oracle software keystore.</p>
<p>The <a href="glossary.htm#GUID-8879C26C-4DF5-4040-BC7A-37CF7C482C56"><span class="xrefglossterm">Oracle Secure Backup</span></a> <a href="glossary.htm#GUID-26FF62D0-5938-481D-B7B9-929BC971813E"><span class="xrefglossterm">media management software</span></a> is the only supported interface for making encrypted RMAN backups directly to tape. RMAN issues an <code class="codeph">ORA-19919</code> error if you attempt to create encrypted RMAN backups using a media manager other than Oracle Secure Backup.</p>
<p><a id="d29134e2317" class="indexterm-anchor"></a><a id="d29134e2321" class="indexterm-anchor"></a><a id="d29134e2325" class="indexterm-anchor"></a>When you use the <a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><code class="codeph">BACKUP</code></a> <code class="codeph">BACKUPSET</code> command with encrypted backup sets, the backup sets are backed up in encrypted form. Because <code class="codeph">BACKUP</code> <code class="codeph">BACKUPSET</code> copies an already-encrypted backup set to disk or tape, no decryption key is needed during <code class="codeph">BACKUP</code> <code class="codeph">BACKUPSET</code>. The data is never decrypted during any part of the operation. The <code class="codeph">BACKUP</code> <code class="codeph">BACKUPSET</code> command can neither encrypt nor decrypt backup sets.<a id="d29134e2357" class="indexterm-anchor"></a></p>
<div class="infoboxnotealso" id="GUID-6ED708C7-1092-45FC-80C6-236F062D0DAC__GUID-9C3073D0-226D-4529-85EB-C8BEE2FF1315">
<p class="notep1">See Also:</p>
<p><a class="olink ASOAG600" target="_blank" href="../ASOAG/asopart1.htm#ASOAG600"><span class="italic">Oracle Database Advanced Security Guide</span></a> for details about configuring the Oracle keystore</p>
</div>
</div>
<a id="BRADV89469"></a>
<div class="props_rev_3"><a id="GUID-00CCDDB4-E999-4956-AF30-15E7D622908B"></a>
<h5 id="BRADV-GUID-00CCDDB4-E999-4956-AF30-15E7D622908B" class="sect5">Transparent Encryption of Backups</h5>
<div>
<p><a id="d29134e2435" class="indexterm-anchor"></a>Transparent <a id="d29134e2440" class="indexterm-anchor"></a><a id="d29134e2444" class="indexterm-anchor"></a>encryption can create and restore encrypted backups with no DBA intervention, if the required Oracle key management infrastructure is available. Transparent encryption is best suited for day-to-day backup operations, where backups are restored to the same database from which they were created. Transparent encryption is the default for RMAN encryption.</p>
<p>When you use transparent encryption, you must first configure an Oracle software keystore for each database as described in <a class="olink ASOAG600" target="_blank" href="../ASOAG/asopart1.htm#ASOAG600"><span class="italic">Oracle Database Advanced Security Guide</span></a>. Transparent backup encryption supports both the auto-login software keystore and password-based software keystore. When you use the auto-login software keystore, encrypted backup operations can be performed at any time, because the auto-login keystore is always open. When you use the password-based software keystore, the keystore must be opened before you can perform backup encryption.</p>
<div class="infobox-note" id="GUID-00CCDDB4-E999-4956-AF30-15E7D622908B__GUID-604DB61F-B710-4E6C-A560-A2135C536A70">
<p class="notep1">Caution:</p>
<p>If you use an auto-login keystore, do not back it up along with your encrypted backup data, because users can read the encrypted backups if they obtain both the backups and the autologin keystore. It is safe to back up the Oracle keystore because that form of the keystore cannot be used without the keystore password.</p>
</div>
<p>After the Oracle keystore is configured, encrypted backups can be created and restored with no further DBA intervention. If some columns in the database are encrypted with Transparent Data Encryption (TDE) column encryption, and if those columns are backed up using backup encryption, then those columns are encrypted a second time during the backup. When the backup sets are decrypted during a restore operation, the encrypted columns are returned to their original encrypted form.</p>
<p>Because the Oracle key management infrastructure archives all previous master keys in the <a id="d29134e2461" class="indexterm-anchor"></a>Oracle keystore, changing or resetting the current database master key does not affect your ability to restore encrypted backups performed with an older master key. You can reset the database master key at any time. RMAN can restore all encrypted backups that were ever created by this database.</p>
<div class="infobox-note" id="GUID-00CCDDB4-E999-4956-AF30-15E7D622908B__GUID-37439C97-6B49-461B-9D69-6A5A2722218D">
<p class="notep1">Caution:</p>
<p>If you lose your Oracle keystore, then you are unable to restore any transparently encrypted backups.</p>
</div>
</div>
</div>
<a id="BRADV89470"></a>
<div class="props_rev_3"><a id="GUID-8D85E7DF-53FE-4AF8-811B-CA836B737B36"></a>
<h5 id="BRADV-GUID-8D85E7DF-53FE-4AF8-811B-CA836B737B36" class="sect5">Password Encryption of Backups</h5>
<div>
<p><a id="d29134e2536" class="indexterm-anchor"></a><a id="d29134e2538" class="indexterm-anchor"></a>Password <a id="d29134e2543" class="indexterm-anchor"></a>encryption requires that the DBA provide a password when creating and restoring encrypted backups. Restoring a password-encrypted backup requires the same password that was used to create the backup.</p>
<p>Password encryption is useful for backups that are restored at remote locations, but which must remain secure in transit. Password encryption cannot be persistently configured. You do not need to configure an Oracle keystore if password encryption is used exclusively.</p>
<div class="infobox-note" id="GUID-8D85E7DF-53FE-4AF8-811B-CA836B737B36__GUID-7D76607A-D4F7-49FC-9ACA-3A595CC669BC">
<p class="notep1">Caution:</p>
<p>If you forget or lose the password that you used to encrypt a password-encrypted backup, then you are unable to restore the backup.</p>
</div>
<p>To use password encryption, use <a id="d29134e2553" class="indexterm-anchor"></a><a id="d29134e2557" class="indexterm-anchor"></a>the <a class="olink RCMRF153" target="_blank" href="../RCMRF/rcmsynta2014.htm#RCMRF153"><code class="codeph">SET</code></a> <code class="codeph">ENCRYPTION</code> <code class="codeph">ON</code> <code class="codeph">IDENTIFIED</code> <code class="codeph">BY</code> <span class="italic"><code class="codeph">password</code></span> <code class="codeph">ONLY</code> command in your RMAN scripts.</p>
</div>
</div>
<a id="BRADV89471"></a>
<div class="props_rev_3"><a id="GUID-433BCC86-BA70-4D37-B9C3-92BACFAE72E8"></a>
<h5 id="BRADV-GUID-433BCC86-BA70-4D37-B9C3-92BACFAE72E8" class="sect5">Dual Mode Encryption of Backups</h5>
<div>
<p><a id="d29134e2656" class="indexterm-anchor"></a><a id="d29134e2658" class="indexterm-anchor"></a>Dual-mode <a id="d29134e2663" class="indexterm-anchor"></a>encrypted backups can be restored either transparently or by specifying a password. Dual-mode encrypted backups are useful when you create backups that are normally restored on-site using the Oracle keystore, but which occasionally must be restored offsite, where the Oracle keystore is not available.</p>
<p>When restoring a dual-mode encrypted backup, you can use either the Oracle keystore or a password for decryption.</p>
<div class="infobox-note" id="GUID-433BCC86-BA70-4D37-B9C3-92BACFAE72E8__GUID-CE254F20-989F-4BEF-81F6-25EBC150E798">
<p class="notep1">Caution:</p>
<p>If you forget or lose the password that you used to encrypt a dual-mode encrypted backup and you also lose your Oracle keystore, then you are unable to restore the backup.</p>
</div>
<p>To create dual-mode encrypted backup sets, specify the <code class="codeph">SET</code> <code class="codeph">ENCRYPTION</code> <code class="codeph">ON</code> <code class="codeph">IDENTIFIED</code> <code class="codeph">BY</code> <span class="italic"><code class="codeph">password</code></span> command in your RMAN scripts.</p>
</div>
</div>
</div>
<a id="BRADV579"></a><a id="BRADV89472"></a>
<div class="props_rev_3"><a id="GUID-BAA3CFF0-C95C-4AF2-90DD-764754325D73"></a>
<h4 id="BRADV-GUID-BAA3CFF0-C95C-4AF2-90DD-764754325D73" class="sect4">Configuring RMAN Backup Encryption Modes</h4>
<div>
<div class="section">
<p>You can use the <code class="codeph">CONFIGURE</code> command to persistently configure transparent encryption of backups. You can use the command to specify the following:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Whether to use transparent encryptions for backups of all database files</p>
</li>
<li>
<p>Whether to use transparent encryptions for backups of specific tablespaces</p>
</li>
<li>
<p>Which algorithm to use for encrypting backups</p>
</li>
</ul>
<p>You can also use the <code class="codeph">SET</code> <code class="codeph">ENCRYPTION</code> command to perform the following actions:</p>
<ul style="list-style-type: disc;">
<li>
<p>Override the encryption settings specified by <a id="d29134e2791" class="indexterm-anchor"></a><a id="d29134e2795" class="indexterm-anchor"></a>the <a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><code class="codeph">CONFIGURE</code></a> <code class="codeph">ENCRYPTION</code> command. For example, you can use <code class="codeph">SET</code> <code class="codeph">ENCRYPTION</code> <code class="codeph">OFF</code> to create an unencrypted backup, even though a database is configured for encrypted backups.</p>
</li>
<li>
<p>Set a password for backup encryption, persisting until the RMAN client exits. Because of the sensitive nature of passwords, RMAN does not permit configuration of passwords that persist across RMAN sessions.</p>
</li>
</ul>
<p>Using or not using persistent configuration settings controls whether archived redo log backups are encrypted. Backup sets containing archived redo log files are encrypted if any of the following are true:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">SET</code> <code class="codeph">ENCRYPTION</code> <code class="codeph">ON</code> is in effect when the archive log backup is being created.</p>
</li>
<li>
<p>Encryption is configured for backups of the whole database or at least one tablespace.</p>
</li>
</ul>
<p>This behavior ensures that the redo associated with any encrypted backup of a data file is also encrypted.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To configure the environment so that all RMAN backups are encrypted:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Set up the Oracle keystore as explained in <a class="olink ASOAG600" target="_blank" href="../ASOAG/asopart1.htm#ASOAG600"><span class="italic">Oracle Database Advanced Security Guide</span></a>.</span></li>
<li class="stepexpand"><span>Issue the following RMAN command:</span>
<div>
<pre dir="ltr">CONFIGURE ENCRYPTION FOR DATABASE ON;
</pre>
<p>At this stage, all RMAN backup sets created by this database use transparent encryption by default.</p>
</div>
</li>
</ol>
<div class="section">
<p>You can explicitly override the persistent encryption configuration for an <a href="glossary.htm#GUID-01D29658-41E1-4D45-9C7F-A761D56885B9"><span class="xrefglossterm">RMAN session</span></a> with the following command:</p>
<pre dir="ltr">SET ENCRYPTION ON;
</pre>
<p>The encryption setting remains in effect until you issue the <code class="codeph">SET</code> <code class="codeph">ENCRYPTION</code> <code class="codeph">OFF</code> command during an RMAN session, or change the persistent setting again with the following command:</p>
<pre dir="ltr">CONFIGURE ENCRYPTION FOR DATABASE OFF;
</pre></div>
<!-- class="section" --></div>
</div>
<a id="BRADV580"></a><a id="BRADV90077"></a>
<div class="props_rev_3"><a id="GUID-97ED7AA5-476C-4068-9C6C-97A0C0353864"></a>
<h4 id="BRADV-GUID-97ED7AA5-476C-4068-9C6C-97A0C0353864" class="sect4">Configuring the Backup Encryption Algorithm</h4>
<div>
<div class="section">
<p>You can use the <code class="codeph">CONFIGURE</code> command to persistently configure the default algorithm to use for encryption when writing backup sets. Possible values are listed <a id="d29134e2958" class="indexterm-anchor"></a>in <code class="codeph">V$RMAN_ENCRYPTION_ALGORITHMS</code>. The default algorithm is AES 128-bit.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To configure the default backup encryption algorithm:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to a target database and a recovery catalog (if used).</span></li>
<li class="stepexpand"><span>Ensure that the target database is mounted or open.</span></li>
<li class="stepexpand"><span>Execute the <code class="codeph">CONFIGURE ENCRYPTION ALGORITHM</code> command, specifying a valid value from <code class="codeph">V$RMAN_ENCRYPTION_ALGORITHMS.ALGORITHM_NAME</code>.</span>
<div>
<p>The following example configures the algorithm to AES 256-bit encryption:</p>
<pre dir="ltr">CONFIGURE ENCRYPTION ALGORITHM TO &#39;AES256&#39;;
</pre></div>
</li>
</ol>
</div>
</div>
</div>
</div>
<a id="BRADV14011"></a>
<div class="props_rev_3"><a id="GUID-9C633A44-5533-467E-9108-14BC088A1F82"></a>
<h2 id="BRADV-GUID-9C633A44-5533-467E-9108-14BC088A1F82" class="sect2">Configuring Auxiliary Instance Data File Names</h2>
<div>
<div class="section">
<p>Assume that you are performing data file <a href="glossary.htm#GUID-8A257409-B3DC-41FD-A2AF-D47560FF9F18"><span class="xrefglossterm">tablespace point-in-time recovery (TSPITR)</span></a> or performing data transfer with RMAN. In this case, you may want to set the names of data files in the <a href="glossary.htm#GUID-4B8BBEA0-2F0F-4C5E-AE69-F1EE4DBA1B46"><span class="xrefglossterm">auxiliary instance</span></a> before starting the TSPITR or database duplication. The command is as follows, where <span class="italic"><code class="codeph">datafileSpec</code></span> identifies some data file by its original name or data file number, and <span class="italic"><code class="codeph">filename</code></span> is the new path for the specified file:</p>
<pre dir="ltr">CONFIGURE AUXNAME FOR <span class="italic">datafileSpec</span> TO &#39;<span class="italic">filename</span>&#39;;
</pre>
<p>For example, you might configure a new auxiliary name for data file <code class="codeph">2</code> as follows:</p>
<pre dir="ltr">CONFIGURE AUXNAME FOR DATAFILE 2 TO &#39;/newdisk/datafiles/df2.df&#39;;
</pre>
<p>As with other settings, the <a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><code class="codeph">CONFIGURE</code></a> command setting persists across RMAN sessions until cleared with <code class="codeph">CONFIGURE</code> <code class="codeph">...</code> <code class="codeph">CLEAR</code>, as shown in the following example:</p>
<pre dir="ltr">CONFIGURE AUXNAME FOR DATAFILE 2 CLEAR;
</pre>
<p>If you are performing TSPITR or running the <a class="olink RCMRF126" target="_blank" href="../RCMRF/rcmsynta020.htm#RCMRF126"><code class="codeph">DUPLICATE</code></a> command, then by using<a id="d29134e3120" class="indexterm-anchor"></a><a id="d29134e3124" class="indexterm-anchor"></a> <code class="codeph">CONFIGURE AUXNAME</code> you can preconfigure the file names for use on the auxiliary database without manually specifying the auxiliary file names during the procedure.</p>
<p>When renaming files with the <code class="codeph">DUPLICATE</code> command, <code class="codeph">CONFIGURE AUXNAME</code> is an alternative to <a class="olink RCMRF153" target="_blank" href="../RCMRF/rcmsynta2014.htm#RCMRF153"><code class="codeph">SET NEWNAME</code></a> command. The difference is that after you set the <code class="codeph">AUXNAME</code> the first time, you do not need to reset the file name when you issue another <code class="codeph">DUPLICATE</code> command; the <code class="codeph">AUXNAME</code> setting remains in effect until you issue <code class="codeph">CONFIGURE AUXNAME</code> <code class="codeph">...</code> <code class="codeph">CLEAR</code>. In contrast, you must reissue the <code class="codeph">SET NEWNAME</code> command every time you rename files.</p>
<p>See <a href="rcmtspit.htm#GUID-CAACDB53-7C3A-45B4-8249-C5D855D47571">Performing RMAN Tablespace Point-in-Time Recovery (TSPITR)</a> , for more details on using <code class="codeph">CONFIGURE</code> <code class="codeph">AUXNAME</code> for TSPITR, and <a href="rcmdupdb.htm#GUID-94E3F324-33F7-451E-83E1-18523E916CD3" title="RMAN enables you to duplicate PDBs with the DUPLICATE command. You can duplicate a single PDB, a set of PDBs, or a set of tablespaces within a PDB. This example shows how to use a script to automate the process of duplicating a target database.">Duplicating a Database</a>, for more details on using <code class="codeph">CONFIGURE</code> <code class="codeph">AUXNAME</code> in performing database duplication.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV141"></a>
<div class="props_rev_3"><a id="GUID-B7B61600-6DED-413D-B134-1DAE79627A01"></a>
<h2 id="BRADV-GUID-B7B61600-6DED-413D-B134-1DAE79627A01" class="sect2">Configuring the Snapshot Control File Location</h2>
<div>
<p><a id="d29134e3265" class="indexterm-anchor"></a><a id="d29134e3269" class="indexterm-anchor"></a><a id="d29134e3273" class="indexterm-anchor"></a><a id="d29134e3277" class="indexterm-anchor"></a>When RMAN needs a read-consistent version of the control file, it creates a temporary <a id="d29134e3284" class="indexterm-anchor"></a><a href="glossary.htm#GUID-C49B814B-6834-4CC0-911D-60F7CA87669F"><span class="xrefglossterm">snapshot control file</span></a>. RMAN needs a snapshot control file when resynchronizing with the recovery catalog or when making a backup of the current control file.</p>
<p>The default location for the snapshot control file is platform-specific and depends on the Oracle home of each target database. For example, the default file name on some Linux platforms is <code class="codeph">$ORACLE_HOME/dbs/snapcf_@.f</code>. If a <a id="d29134e3295" class="indexterm-anchor"></a><a href="glossary.htm#GUID-6E3CDD76-A573-4E5C-B12D-59C232C96C19"><span class="xrefglossterm">fast recovery area</span></a> is configured for a target database, then the default location for the snapshot control file is <span class="italic">not</span> the fast recovery area.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmconfa.htm#GUID-E6B5F469-175A-43F2-8021-EBCFAF53454E">Viewing the Configured Location of the Snapshot Control File</a></p>
</li>
<li>
<p><a href="rcmconfa.htm#GUID-8A31E7A9-A606-4535-A317-6DAD2E1AAE39">Setting the Location of the Snapshot Control File</a></p>
</li>
</ul>
</div>
<a id="BRADV89474"></a>
<div class="props_rev_3"><a id="GUID-E6B5F469-175A-43F2-8021-EBCFAF53454E"></a>
<h3 id="BRADV-GUID-E6B5F469-175A-43F2-8021-EBCFAF53454E" class="sect3">Viewing the Configured Location of the Snapshot Control File</h3>
<div>
<div class="section">
<p>You can see the current snapshot location by running the <a class="olink RCMRF154" target="_blank" href="../RCMRF/rcmsynta2015.htm#RCMRF154"><code class="codeph">SHOW</code></a> command. This example shows a snapshot location that is determined by the default rule:</p>
<pre dir="ltr">RMAN&gt; SHOW SNAPSHOT CONTROLFILE NAME;
CONFIGURE SNAPSHOT CONTROLFILE NAME TO &#39;/oracle/dbs/snapcf_trgt.f&#39;; # default
</pre>
<p>This example shows a snapshot control file that has a nondefault file name:</p>
<pre dir="ltr">RMAN&gt; SHOW SNAPSHOT CONTROLFILE NAME;
CONFIGURE SNAPSHOT CONTROLFILE NAME TO &#39;/oracle/oradata/trgt/snap_trgt.ctl&#39;;
</pre></div>
<!-- class="section" --></div>
</div>
<a id="BRADV89475"></a>
<div class="props_rev_3"><a id="GUID-8A31E7A9-A606-4535-A317-6DAD2E1AAE39"></a>
<h3 id="BRADV-GUID-8A31E7A9-A606-4535-A317-6DAD2E1AAE39" class="sect3">Setting the Location of the Snapshot Control File</h3>
<div>
<div class="section">
<p>Use the <a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><code class="codeph">CONFIGURE</code></a> <code class="codeph">SNAPSHOT</code> <code class="codeph">CONTROLFILE</code> <code class="codeph">NAME</code> <code class="codeph">TO</code> <code class="codeph">&#39;</code><span class="italic"><code class="codeph">filepath</code></span><code class="codeph">&#39;</code> command to change the name and path of the snapshot control file. Subsequent snapshot control files that RMAN creates use the specified name and path.</p>
<p><a id="d29134e3502" class="indexterm-anchor"></a>In an Oracle Real Application Clusters (Oracle RAC) environment, the snapshot control file location must be on shared storage&mdash;that is, storage that is accessible to all Oracle RAC instances.</p>
<p>For example, start RMAN, connect to the target database, and then enter:</p>
<pre dir="ltr">CONFIGURE SNAPSHOT CONTROLFILE NAME TO &#39;/oracle/oradata/trgt/snap_trgt.ctl&#39;;
</pre>
<p>You can also set the snapshot control file name to a <a href="glossary.htm#GUID-D6545038-B176-4D0E-9B4B-E4187A063984"><span class="xrefglossterm">raw device</span></a>.</p>
<p>To reset the snapshot control file location to the default, run the <code class="codeph">CONFIGURE</code> <code class="codeph">SNAPSHOT</code> <code class="codeph">CONTROLFILE</code> <code class="codeph">NAME</code> <code class="codeph">CLEAR</code> command.</p>
<div class="infoboxnotealso" id="GUID-8A31E7A9-A606-4535-A317-6DAD2E1AAE39__GUID-B19AEA8A-A449-40C3-A0E3-1B2C5E0B3FAC">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="rcmcatdb.htm#GUID-87642B50-AF67-482E-A93D-291B8D2EED92">Resynchronizing the Recovery Catalog</a>&#34;</span></p>
</li>
<li>
<p><a class="olink RACAD320" target="_blank" href="../RACAD/GUID-1051C520-07B2-431B-9B9B-E500B22547C1.htm#RACAD320"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for details about handling snapshot control files in Oracle RAC configurations</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="BRADV190"></a><a id="BRADV142"></a>
<div class="props_rev_3"><a id="GUID-58576D80-BCC4-45EC-B048-AB23A78A7AEE"></a>
<h2 id="BRADV-GUID-58576D80-BCC4-45EC-B048-AB23A78A7AEE" class="sect2">Configuring RMAN for Use with a Shared Server</h2>
<div>
<div class="section">
<p><a id="d29134e3622" class="indexterm-anchor"></a><a id="d29134e3626" class="indexterm-anchor"></a><a id="d29134e3630" class="indexterm-anchor"></a>RMAN cannot connect to a target database through a shared server dispatcher. RMAN requires a dedicated server process. If your target database is configured for a shared server, then you must modify your Oracle Net configuration to provide dedicated server processes for RMAN connections.</p>
<p>To ensure that RMAN does not connect to a dispatcher when a target database is configured for a shared server, the net service name used by RMAN must include <code class="codeph">(SERVER=DEDICATED)</code> in the <code class="codeph">CONNECT_DATA</code> attribute of the connect string.</p>
<p>Oracle Net configuration varies greatly from system to system. The following procedure illustrates only one method. This scenario assumes that the following service name in <code class="codeph">tnsnames.ora</code> file connects to a target database using the shared server architecture, where <code class="codeph">inst1</code> is a value of the <a class="olink REFRN10194" target="_blank" href="../REFRN/GUID-AC956707-D568-4F8A-BF2E-99BA41E0A64F.htm#REFRN10194"><code class="codeph">SERVICE_NAMES</code></a> initialization parameter:</p>
<pre dir="ltr">inst1_shs =
  (DESCRIPTION=
    (ADDRESS=(PROTOCOL=tcp)(HOST=inst1_host)(port=1521))
    (CONNECT_DATA=(SERVICE_NAME=inst1)(SERVER=shared))
  ) 
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">To use RMAN with a shared server:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Create a net service name in the <code class="codeph">tnsnames.ora</code> file that connects to the nonshared SID. For example, enter:</span>
<div>
<pre dir="ltr">inst1_ded =
  (DESCRIPTION=
    (ADDRESS=(PROTOCOL=tcp)(HOST=inst1_host)(port=1521))
    (CONNECT_DATA=(SERVICE_NAME=inst1)(SERVER=dedicated))
  )
</pre></div>
</li>
<li class="stepexpand"><span>Start SQL*Plus and then connect using both the shared server and dedicated server service names to confirm the mode of each session.</span>
<div>
<p>For example, connect with <code class="codeph">SYSBACKUP</code> or <code class="codeph">SYSDBA</code> privilege to <code class="codeph">inst1_ded</code> and then execute the following <code class="codeph">SELECT</code> statement (sample output included)<a id="d29134e3689" class="indexterm-anchor"></a>:</p>
<pre dir="ltr">SQL&gt; SELECT SERVER 
  2  FROM   V$SESSION 
  3  WHERE  SID = (SELECT DISTINCT SID FROM V$MYSTAT);

SERVER   
---------
DEDICATED
1 row selected.
</pre>
<p>To connect to a shared server session, connect with <code class="codeph">SYSBACKUP</code> or <code class="codeph">SYSDBA</code> privilege to <code class="codeph">inst1_shs</code> and then execute the following <code class="codeph">SELECT</code> statement (sample output included):</p>
<pre dir="ltr">SQL&gt; SELECT SERVER 
  2  FROM   V$SESSION 
  3  WHERE  SID = (SELECT DISTINCT SID FROM V$MYSTAT);

SERVER   
---------
SHARED 
1 row selected.
  
</pre></div>
</li>
<li class="stepexpand"><span>Start RMAN and connect to the target database using the dedicated service name. Optionally, connect to a recovery catalog.</span>
<div>
<div class="infoboxnotealso" id="GUID-58576D80-BCC4-45EC-B048-AB23A78A7AEE__GUID-61A96258-EE48-4955-9739-C0421D000A02">
<p class="notep1">See Also:</p>
<p>Your platform-specific Oracle documentation and your <a class="olink NETRF" target="_blank" href="../NETRF/toc.htm"><span class="italic">Oracle Database Net Services Reference</span></a> for a complete description of Oracle Net connect string syntax</p>
</div>
</div>
</li>
</ol>
</div>
</div>
<a id="BRADV89476"></a>
<div class="props_rev_3"><a id="GUID-AE80F99C-5368-4FC3-83C5-7261BF9174F0"></a>
<h2 id="BRADV-GUID-AE80F99C-5368-4FC3-83C5-7261BF9174F0" class="sect2">Enabling Lost Write Detection</h2>
<div>
<p>A data block <a id="d29134e3793" class="indexterm-anchor"></a><a href="glossary.htm#GUID-1F17C8A1-28F1-409C-91AD-F6D2A68D4B21"><span class="xrefglossterm">lost write</span></a> occurs when an I/O subsystem acknowledges the completion of the block write, but the write did not occur in the persistent storage. On a subsequent block read, the I/O subsystem returns the stale version of the data block, which might be used to update other blocks of the database, thereby corrupting it.</p>
<p><a id="d29134e3800" class="indexterm-anchor"></a>You can set the <a class="olink REFRN10268" target="_blank" href="../REFRN/GUID-52B4045A-5500-4C02-AFEB-80121659C0EE.htm#REFRN10268"><code class="codeph">DB_LOST_WRITE_PROTECT</code></a> initialization parameter to <code class="codeph">TYPICAL</code> or <code class="codeph">FULL</code> so that a database records buffer cache block reads in the redo log. The default setting is <code class="codeph">NONE</code>. When the parameter is set to <code class="codeph">TYPICAL</code>, the instance logs buffer cache reads for read/write tablespaces in the redo log, but not read-only tablespaces. When set to <code class="codeph">FULL</code>, the instance also records reads for read-only tablespaces. The performance overhead for <code class="codeph">TYPICAL</code> mode is approximately 5 to 10% and potentially higher for <code class="codeph">FULL</code> mode.</p>
<p>Lost write detection is most effective when used with Data Guard. In this case, you set <code class="codeph">DB_LOST_WRITE_PROTECT</code> in both primary and standby databases. When a standby database applies redo during managed recovery, it reads the corresponding blocks and compares the SCNs with the SCNs in the redo log. If the block SCN on the primary database is lower than on the standby database, then it detects a lost write on the primary database and throws an external error (<code class="codeph">ORA-752</code>). If the SCN is higher, it detects a lost write on the standby database and throws an internal error (<code class="codeph">ORA-600 [3020]</code>). In either case, the standby database writes the reason for the failure in the alert log and trace file.</p>
<p>To repair a lost write on a primary database, you must initiate failover to the standby database. To repair a lost write on a standby database, you must re-create the entire standby database or restore a backup of only the affected files.</p>
<p>Enabling lost write detection is also useful when you are not using Data Guard. In this case, you can encounter a lost write in two ways: during normal database operation or during media recovery. In the first case, there is no direct way to detect the error. Indirect symptoms such as inconsistent tables cannot be unambiguously traced to the lost write. If you retained a backup made <span class="italic">before</span> the suspected lost write, however, then you can restore this backup to an alternative location and recover it. To diagnose the problem, recover the database or tablespace to the SCN of the stale block read, which then generates the lost write error (<code class="codeph">ORA-752</code>).</p>
<p>If a lost write error is encountered during media recovery, the only response is to open the database with the <code class="codeph">RESETLOGS</code> option. The database is in a consistent state, but all data after the <code class="codeph">RESETLOGS</code> SCN is lost. If you recover a backup made after database creation, you have no guarantee that other stale blocks have not corrupted the database. This possibility exists because the restored backup may have been made after an earlier lost write. To guarantee that no lost writes have corrupted the database, you must perform media recovery from database creation, which is not a practical strategy for most database environments.</p>
<div class="infoboxnotealso" id="GUID-AE80F99C-5368-4FC3-83C5-7261BF9174F0__GUID-81D36D44-3763-4BBC-A650-8C162F526B28">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink SBYDB00930" target="_blank" href="../SBYDB/scenarios.htm#SBYDB00930"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> to learn how to use a standby database for lost write detection and repair</p>
</li>
<li>
<p><a class="olink REFRN" target="_blank" href="../REFRN/toc.htm"><span class="italic">Oracle Database Reference</span></a> to learn about the <code class="codeph">DB_LOST_WRITE_PROTECT</code> initialization parameter</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment500">
<tr>
<td class="cellalignment512">
<table class="cellalignment505">
<tr>
<td class="cellalignment504"><a href="rcmconfb.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment504"><a href="flashdb.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment514">
<table class="cellalignment503">
<tr>
<td class="cellalignment504"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment504"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment504"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment504"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment504"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment504"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>