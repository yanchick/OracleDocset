<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-2670"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Duplicating%20a%20Database%3A%20Advanced%20Topics"></a><title>Duplicating a Database: Advanced Topics</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="dcterms.created" content="2017-06-07T23:52:16Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Backup and Recovery User&#39;s Guide"/>
<meta name="dcterms.identifier" content="E50658-09"/>
<meta name="dcterms.isVersionOf" content="BRADV"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="rcmdupdb.htm" title="Previous" type="text/html"/>
<link rel="Next" href="rcmttbsb.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E50658-09.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-B8397CAE-C272-4B5F-88DE-879017D67A23"></a> <span id="PAGE" style="display:none;">40/48</span> <!-- End Header -->
<a id="BRADV441"></a>
<h1 id="BRADV-GUID-B8397CAE-C272-4B5F-88DE-879017D67A23" class="sect1"><span class="enumeration_chapter">26</span> Duplicating a Database: Advanced Topics</h1>
<div>
<p>This chapter explains advanced forms of database duplication that are not covered in <a href="rcmdupdb.htm#GUID-94E3F324-33F7-451E-83E1-18523E916CD3" title="RMAN enables you to duplicate PDBs with the DUPLICATE command. You can duplicate a single PDB, a set of PDBs, or a set of tablespaces within a PDB. This example shows how to use a script to automate the process of duplicating a target database.">Duplicating a Database</a>.</p>
<p>This chapter contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmdupad.htm#GUID-7847194E-9A3F-46CB-97E5-FD02FE0CE15F">Specifying Alternative Names for Duplicate Database Files</a></p>
</li>
<li>
<p><a href="rcmdupad.htm#GUID-FA3D3776-53EB-495C-9726-3446D32E8B3A">Making Disk Backups Accessible Without Shared Disk</a></p>
</li>
<li>
<p><a href="rcmdupad.htm#GUID-D98BB0FD-15C4-4691-BA86-8A85D072F824">Duplicating a Database When No Server Parameter File Exists</a></p>
</li>
<li>
<p><a href="rcmdupad.htm#GUID-A5A19480-D601-487C-8595-54FB38356A19">Starting the Auxiliary Instance When No Server Parameter File Exists</a></p>
</li>
<li>
<p><a href="rcmdupad.htm#GUID-0C6616AE-FF8A-41E1-B0DE-EED457E020FC">Duplicating a Subset of the Source Database Tablespaces</a></p>
</li>
</ul>
</div>
<a id="BRADV442"></a>
<div class="props_rev_3"><a id="GUID-7847194E-9A3F-46CB-97E5-FD02FE0CE15F"></a>
<h2 id="BRADV-GUID-7847194E-9A3F-46CB-97E5-FD02FE0CE15F" class="sect2">Specifying Alternative Names for Duplicate Database Files</h2>
<div>
<p><span class="q">&#34;<a href="rcmdupdb.htm#GUID-85F678A1-AC25-416F-8A3A-E5FC8D99D771">Step 2: Choosing a Strategy for Naming Duplicate Files</a>&#34;</span> explains the recommended strategy of using the same names for the duplicate and source database files. In all other cases, you must choose an alternative naming strategy for the duplicate files. The strategy that you use depends on whether the source and duplicate databases use Oracle Managed Files (OMF) or Oracle Automatic Storage Management (ASM).</p>
<p>If the source data files use OMF, then you cannot rename them using <code class="codeph">DB_FILE_NAME_CONVERT</code>. <span class="q">&#34;<a href="rcmtspit.htm#GUID-AEA2C5F4-214B-4795-86DE-69BC307832EE">Using Non-ASM Storage</a> &#34;</span> discusses the details and options of OMF-managed data files.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmdupad.htm#GUID-AB6533D2-B24D-4EB8-84CF-4CA865DAB0C2">Specifying Non-OMF or Non-ASM Alternative Names for Duplicate Database Files</a></p>
</li>
<li>
<p><a href="rcmdupad.htm#GUID-87D83E5C-F194-4B8F-9FA5-8F47B205A695">Specifying OMF or ASM Alternative Names for Duplicate Database Files</a></p>
</li>
</ul>
</div>
<a id="BRADV443"></a>
<div class="props_rev_3"><a id="GUID-AB6533D2-B24D-4EB8-84CF-4CA865DAB0C2"></a>
<h3 id="BRADV-GUID-AB6533D2-B24D-4EB8-84CF-4CA865DAB0C2" class="sect3">Specifying Non-OMF or Non-ASM Alternative Names for Duplicate Database Files</h3>
<div>
<p>This section explains how to specify names for the duplicate files when the following condition is true:</p>
<p>The source and auxiliary hosts either use different directory structures or use the same structure but you want to name the duplicate files differently.</p>
<p><a href="rcmdupad.htm#GUID-9693D878-75CA-4E17-A972-F97E33F0BE0F__CIHJJJAJ" title="A list of the substitution varibales for SET NEWNAME.">Table 26-1</a> summarizes the formats available for naming each type of file.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmdupad.htm#GUID-9693D878-75CA-4E17-A972-F97E33F0BE0F">Using SET NEWNAME to Name File System Data Files and Temp Files</a></p>
</li>
<li>
<p><a href="rcmdupad.htm#GUID-B94F21DD-6535-4E07-BA88-6C9911CBDD4D">Using CONFIGURE AUXNAME to Name File System Data Files and OMF/ASM Target Data Files</a></p>
</li>
</ul>
</div>
<a id="BRADV444"></a><a id="BRADV541"></a><a id="BRADV89956"></a>
<div class="props_rev_3"><a id="GUID-9693D878-75CA-4E17-A972-F97E33F0BE0F"></a>
<h4 id="BRADV-GUID-9693D878-75CA-4E17-A972-F97E33F0BE0F" class="sect4">Using SET NEWNAME to Name File System Data Files and Temp Files</h4>
<div>
<div class="section">
<p>As shown in <a href="rcmdupad.htm#GUID-9693D878-75CA-4E17-A972-F97E33F0BE0F__CIHJJJAJ" title="A list of the substitution varibales for SET NEWNAME.">Table 26-1</a>, one way to name duplicate data files is to use the<a id="d103537e372" class="indexterm-anchor"></a> <code class="codeph">SET NEWNAME</code> command before executing the <code class="codeph">DUPLICATE</code> command. RMAN supports the following commands, listed in order of precedence:</p>
<ol>
<li>
<p><code class="codeph">SET NEWNAME FOR DATAFILE</code> and <code class="codeph">SET NEWNAME FOR TEMPFILE</code></p>
</li>
<li>
<p><code class="codeph">SET NEWNAME FOR TABLESPACE</code></p>
</li>
<li>
<p><code class="codeph">SET NEWNAME FOR DATABASE</code></p>
</li>
</ol>
<p>The order of precedence means that <code class="codeph">SET NEWNAME FOR TABLESPACE</code> specifies names for files not named by <code class="codeph">SET NEWNAME FOR DATAFILE</code> and <code class="codeph">SET NEWNAME FOR TEMPFILE,</code> whereas <code class="codeph">SET NEWNAME FOR DATABASE</code> specifies names for files not named by <code class="codeph">SET NEWNAME FOR TABLESPACE</code>, <code class="codeph">SET NEWNAME FOR DATAFILE</code>, or <code class="codeph">SET NEWNAME FOR TEMPFILE</code>.</p>
<p>When using <code class="codeph">SET NEWNAME FOR DATAFILE</code>, you can specify a full path as a literal, as in <code class="codeph">/oradata1/system01.dbf</code>. When using <code class="codeph">SET</code> with <code class="codeph">FOR DATABASE</code> or <code class="codeph">FOR TABLESPACE</code>, however, you must use at least one of these substitution variables described in <a href="rcmdupad.htm#GUID-9693D878-75CA-4E17-A972-F97E33F0BE0F__CIHJJJAJ" title="A list of the substitution varibales for SET NEWNAME.">Table 26-1</a>: <code class="codeph">%b</code>, <code class="codeph">%f</code>, <code class="codeph">%U</code>. (<code class="codeph">%I</code> and <code class="codeph">%N</code> are optional.)</p>
<div class="tblformal" id="GUID-9693D878-75CA-4E17-A972-F97E33F0BE0F__CIHJJJAJ">
<p class="titleintable">Table 26-1 Substitution Variables for SET NEWNAME</p>
<table class="cellalignment515" title="Substitution Variables for SET NEWNAME" summary="A list of the substitution varibales for SET NEWNAME.">
<thead>
<tr class="cellalignment501">
<th class="cellalignment532" id="d103537e471">Variable</th>
<th class="cellalignment543" id="d103537e474">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment501">
<td class="cellalignment535" id="d103537e479" headers="d103537e471">
<p><a id="d103537e481" class="indexterm-anchor"></a><code class="codeph">%b</code></p>
</td>
<td class="cellalignment544" headers="d103537e479 d103537e474">
<p>Specifies the file name stripped of directory paths. For example, if a data file is named <code class="codeph">/oradata/prod/financial.dbf</code>, then <code class="codeph">%b</code> results in <code class="codeph">financial.dbf</code>.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment535" id="d103537e500" headers="d103537e471">
<p><a id="d103537e502" class="indexterm-anchor"></a><code class="codeph">%f</code></p>
</td>
<td class="cellalignment544" headers="d103537e500 d103537e474">
<p>Specifies the absolute file number of the data file for which the new name is generated. For example, if data file <code class="codeph">2</code> is duplicated, then <code class="codeph">%f</code> generates the value <code class="codeph">2</code>.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment535" id="d103537e521" headers="d103537e471">
<p><a id="d103537e523" class="indexterm-anchor"></a><code class="codeph">%I</code></p>
</td>
<td class="cellalignment544" headers="d103537e521 d103537e474">
<p>Specifies the DBID.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment535" id="d103537e533" headers="d103537e471">
<p><a id="d103537e535" class="indexterm-anchor"></a><code class="codeph">%N</code></p>
</td>
<td class="cellalignment544" headers="d103537e533 d103537e474">
<p>Specifies the tablespace name.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment535" id="d103537e545" headers="d103537e471">
<p><a id="d103537e547" class="indexterm-anchor"></a><code class="codeph">%U</code></p>
</td>
<td class="cellalignment544" headers="d103537e545 d103537e474">
<p>Specifies the following format: <code class="codeph">data-D-%d_id-%I_TS-%N_FNO-%f</code></p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p><span class="bold">To use SET NEWNAME to specify new file names:</span></p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Follow Steps 1 through 4 in <span class="q">&#34;<a href="rcmdupdb.htm#GUID-5C007067-E891-45AF-9985-50C052889078">Basic Steps of Database Duplication</a>&#34;</span>.</span></li>
<li class="stepexpand"><span>Within a <code class="codeph">RUN</code> command, issue the <code class="codeph">SET NEWNAME</code> command before issuing <code class="codeph">DUPLICATE</code>.</span>
<div>
<p>The following example illustrates a script that specifies new names for data files <code class="codeph">1</code> through <code class="codeph">5</code> and temp file <code class="codeph">1</code>. The script does not set a new name for data file <code class="codeph">6</code> because it is in the <code class="codeph">TOOLS</code> tablespace, which is excluded from the duplicate database.</p>
<pre dir="ltr">RUN
{
  SET NEWNAME FOR DATAFILE 1 TO &#39;/oradata1/system01.dbf&#39;; 
  SET NEWNAME FOR DATAFILE 2 TO &#39;/oradata2/sysaux01.dbf&#39;;
  SET NEWNAME FOR DATAFILE 3 TO &#39;/oradata3/undotbs01.dbf&#39;;
  SET NEWNAME FOR DATAFILE 4 TO &#39;/oradata4/users01.dbf&#39;; 
  SET NEWNAME FOR DATAFILE 5 TO &#39;/oradata5/users02.dbf&#39;;
  SET NEWNAME FOR TEMPFILE 1 TO &#39;/oradatat/temp01.dbf&#39;; 
  DUPLICATE TARGET DATABASE TO dupdb
    SKIP TABLESPACE tools
    LOGFILE
      GROUP 1 (&#39;/duplogs/redo01a.log&#39;, 
               &#39;/duplogs/redo01b.log&#39;) SIZE 4M REUSE, 
      GROUP 2 (&#39;/duplogs/redo02a.log&#39;, 
               &#39;/duplogs/redo02b.log&#39;) SIZE 4M REUSE;
}
</pre>
<p>The following example uses one <code class="codeph">SET NEWNAME</code> command to name all data files in the tablespace <code class="codeph">users</code>. After the example completes, the file names for tablespace <code class="codeph">users</code> are set to: <code class="codeph">/oradata4/users01.dbf</code> and <code class="codeph">/oradata5/users02.dbf</code>.</p>
<pre dir="ltr">RUN
{
  SET NEWNAME FOR TABLESPACE users TO &#39;/oradata%f/%b&#39;;
  SET NEWNAME FOR DATAFILE 1 TO &#39;/oradata1/system01.dbf&#39;; 
  SET NEWNAME FOR DATAFILE 2 TO &#39;/oradata2/sysaux01.dbf&#39;;
  SET NEWNAME FOR DATAFILE 3 TO &#39;/oradata3/undotbs01.dbf&#39;; 
  SET NEWNAME FOR TEMPFILE 1 TO &#39;/oradatat/temp01.dbf&#39;; 
  DUPLICATE TARGET DATABASE TO dupdb
    SKIP TABLESPACE tools
    LOGFILE
      GROUP 1 (&#39;/duplogs/redo01a.log&#39;, 
               &#39;/duplogs/redo01b.log&#39;) SIZE 4M REUSE, 
      GROUP 2 (&#39;/duplogs/redo02a.log&#39;, 
               &#39;/duplogs/redo02b.log&#39;) SIZE 4M REUSE;
}
</pre>
<p>The following command uses a single <code class="codeph">SET</code> command to name all data files in the database.</p>
<pre dir="ltr">RUN
{
  SET NEWNAME FOR DATABASE TO &#39;/oradata/%U&#39;; 
  DUPLICATE TARGET DATABASE TO dupdb
    SKIP TABLESPACE tools
    LOGFILE
      GROUP 1 (&#39;/duplogs/redo01a.log&#39;, 
               &#39;/duplogs/redo01b.log&#39;) SIZE 4M REUSE, 
      GROUP 2 (&#39;/duplogs/redo02a.log&#39;, 
               &#39;/duplogs/redo02b.log&#39;) SIZE 4M REUSE;
}
</pre></div>
</li>
</ol>
<div class="section">
<p>Assume the following:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">DBID</code> is <code class="codeph">87650928</code></p>
</li>
<li>
<p>Database name is <code class="codeph">PROD</code></p>
</li>
</ul>
<p><a href="rcmdupad.htm#GUID-9693D878-75CA-4E17-A972-F97E33F0BE0F__CIHHIEGD" title="Before and After results from SET NEWNAME DATABASE">Table 26-2</a> shows the results from previous example.</p>
<div class="tblformalwide" id="GUID-9693D878-75CA-4E17-A972-F97E33F0BE0F__CIHHIEGD">
<p class="titleintable">Table 26-2 Results from SET NEWNAME FOR DATABASE Command</p>
<table class="cellalignment553" title="Results from SET NEWNAME FOR DATABASE Command" summary="Before and After results from SET NEWNAME DATABASE">
<thead>
<tr class="cellalignment501">
<th class="cellalignment571" id="d103537e662">Before SET NEWNAME DATABASE</th>
<th class="cellalignment571" id="d103537e665">Tablespace Name</th>
<th class="cellalignment570" id="d103537e668">Data File Number</th>
<th class="cellalignment574" id="d103537e671">After SET NEWNAME DATABASE TO &#39;/oradata/%U&#39;;</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment501">
<td class="cellalignment573" id="d103537e676" headers="d103537e662">
<p><code class="codeph">.../system01.dbf</code></p>
</td>
<td class="cellalignment573" headers="d103537e676 d103537e665">
<p><code class="codeph">SYSTEM</code></p>
</td>
<td class="cellalignment572" headers="d103537e676 d103537e668">
<p>1</p>
</td>
<td class="cellalignment575" headers="d103537e676 d103537e671">
<p><code class="codeph">/oradata/data-D-PROD_id-87650928_TS-SYSTEM_FNO-1</code></p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment573" id="d103537e692" headers="d103537e662">
<p><code class="codeph">.../sysaux01.dbf</code></p>
</td>
<td class="cellalignment573" headers="d103537e692 d103537e665">
<p><code class="codeph">SYSAUX</code></p>
</td>
<td class="cellalignment572" headers="d103537e692 d103537e668">
<p>2</p>
</td>
<td class="cellalignment575" headers="d103537e692 d103537e671">
<p><code class="codeph">/oradata/data-D-PROD_id-87650928_TS-SYSAUX_FNO-2</code></p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment573" id="d103537e708" headers="d103537e662">
<p><code class="codeph">.../undotbs01.dbf</code></p>
</td>
<td class="cellalignment573" headers="d103537e708 d103537e665">
<p><code class="codeph">UNDOTS</code></p>
</td>
<td class="cellalignment572" headers="d103537e708 d103537e668">
<p>3</p>
</td>
<td class="cellalignment575" headers="d103537e708 d103537e671">
<p><code class="codeph">/oradata/data-D-PROD_id-87650928_TS-UNDOTS_FNO-3</code></p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment573" id="d103537e724" headers="d103537e662">
<p><code class="codeph">.../users01.dbf</code></p>
</td>
<td class="cellalignment573" headers="d103537e724 d103537e665">
<p><code class="codeph">USERS</code></p>
</td>
<td class="cellalignment572" headers="d103537e724 d103537e668">
<p>4</p>
</td>
<td class="cellalignment575" headers="d103537e724 d103537e671">
<p><code class="codeph">/oradata/data-D-PROD_id-87650928_TS-USERS_FNO-4</code></p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment573" id="d103537e740" headers="d103537e662">
<p><code class="codeph">.../users02.dbf</code></p>
</td>
<td class="cellalignment573" headers="d103537e740 d103537e665">
<p><code class="codeph">USERS</code></p>
</td>
<td class="cellalignment572" headers="d103537e740 d103537e668">
<p>5</p>
</td>
<td class="cellalignment575" headers="d103537e740 d103537e671">
<p><code class="codeph">/oradata/data-D-PROD_id-87650928_TS-USERS_FNO-5</code></p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment573" id="d103537e756" headers="d103537e662">
<p><code class="codeph">.../temp01.dbf</code></p>
</td>
<td class="cellalignment573" headers="d103537e756 d103537e665">
<p><code class="codeph">TEMP</code></p>
</td>
<td class="cellalignment572" headers="d103537e756 d103537e668">
<p>1</p>
</td>
<td class="cellalignment575" headers="d103537e756 d103537e671">
<p><code class="codeph">/oradata/data-D-PROD_id-87650928_TS-TEMP_FNO-1</code></p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="infoboxnotealso" id="GUID-9693D878-75CA-4E17-A972-F97E33F0BE0F__GUID-41DEE22B-9D2D-4C1F-8261-6CA3BC82426F">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF153" target="_blank" href="../RCMRF/rcmsynta2014.htm#RCMRF153"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for details on substitution variables usable in <code class="codeph">SET</code> <code class="codeph">NEWNAME</code></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV89958"></a>
<div class="props_rev_3"><a id="GUID-B94F21DD-6535-4E07-BA88-6C9911CBDD4D"></a>
<h4 id="BRADV-GUID-B94F21DD-6535-4E07-BA88-6C9911CBDD4D" class="sect4">Using CONFIGURE AUXNAME to Name File System Data Files and OMF/ASM Target Data Files</h4>
<div>
<div class="section">
<p>The <code class="codeph">CONFIGURE AUXNAME</code> command is an alternative to the <code class="codeph">SET NEWNAME</code> command. The difference is that after you configure the auxiliary name the first time, additional <code class="codeph">DUPLICATE</code> commands reuse the configured settings. In contrast, you must reissue the <code class="codeph">SET NEWNAME</code> command every time you execute the <code class="codeph">DUPLICATE</code> command.</p>
<p><span class="bold">To use CONFIGURE AUXNAME to specify names for duplicate data files:</span></p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Issue a <code class="codeph">CONFIGURE AUXNAME</code> command for each file to name in the duplicate database.</span>
<div>
<p>For example, enter the following commands at the RMAN prompt to specify names for files data files 1 through 5:</p>
<pre dir="ltr">CONFIGURE AUXNAME FOR DATAFILE 1 TO &#39;/oradata1/system01.dbf&#39;; 
CONFIGURE AUXNAME FOR DATAFILE 2 TO &#39;/oradata2/sysaux01.dbf&#39;;
CONFIGURE AUXNAME FOR DATAFILE 3 TO &#39;/oradata3/undotbs01.dbf&#39;;
CONFIGURE AUXNAME FOR DATAFILE 4 TO &#39;/oradata4/users01.dbf&#39;; 
CONFIGURE AUXNAME FOR DATAFILE 5 TO &#39;/oradata5/users02.dbf&#39;;
</pre></div>
</li>
<li class="stepexpand"><span>Issue a <code class="codeph">DUPLICATE</code> command.</span>
<div>
<p>For example, enter the following command at the RMAN prompt:</p>
<pre dir="ltr">SET NEWNAME FOR TEMPFILE 1 TO &#39;/oradatat/temp01.dbf&#39;; 
DUPLICATE TARGET DATABASE
  TO dupdb
  SKIP TABLESPACE tools
  LOGFILE
    GROUP 1 (&#39;/duplogs/redo01a.log&#39;,
             &#39;/duplogs/redo01b.log&#39;) SIZE 4M REUSE,
    GROUP 2 (&#39;/duplogs/redo02a.log&#39;,
             &#39;/duplogs/redo02b.log&#39;) SIZE 4M REUSE;
</pre>
<p>RMAN uses the <code class="codeph">CONFIGURE AUXNAME</code> settings to name data files 1 through 5.</p>
</div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-B94F21DD-6535-4E07-BA88-6C9911CBDD4D__GUID-F7F5E935-EF0A-4EDA-96A8-7167C46DE2F2">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF113" target="_blank" href="../RCMRF/rcmsynta009.htm#RCMRF113"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for details on using <code class="codeph">CONFIGURE</code> <code class="codeph">AUXNAME</code></p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="BRADV448"></a>
<div class="props_rev_3"><a id="GUID-87D83E5C-F194-4B8F-9FA5-8F47B205A695"></a>
<h3 id="BRADV-GUID-87D83E5C-F194-4B8F-9FA5-8F47B205A695" class="sect3">Specifying OMF or ASM Alternative Names for Duplicate Database Files</h3>
<div>
<p>The following sections discuss requirements for creating a duplicate database when some or all files of the duplicate database use OMF or ASM.</p>
<div class="infoboxnotealso" id="GUID-87D83E5C-F194-4B8F-9FA5-8F47B205A695__GUID-D5EC83B0-E39F-4BA5-97AE-2C2B6D28ACCE">
<p class="notep1">See Also:</p>
<p><a class="olink OSTMG036" target="_blank" href="../OSTMG/GUID-BC612D35-5399-4A35-843E-CF76E3D3CDB5.htm#OSTMG036"><span class="italic">Oracle Automatic Storage Management Administrator&#39;s Guide</span></a> for an introduction to ASM and OMF</p>
</div>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmdupad.htm#GUID-1DEFFB79-719E-4935-BF9A-AAD0769ECE8F">Settings and Restrictions for OMF Initialization Parameters</a></p>
</li>
<li>
<p><a href="rcmdupad.htm#GUID-C8CA30C1-276C-4FDC-8A26-C392D0CACDEF">Setting Initialization Parameters for ASM</a></p>
</li>
<li>
<p><a href="rcmdupad.htm#GUID-D7EA0379-3CF6-4B95-8C5A-754F25244E32">Using SET NEWNAME to Create OMF or ASM Files</a></p>
</li>
<li>
<p><a href="rcmdupad.htm#GUID-DA7B2562-A2B7-4F6C-AFFC-1D8C822EB02D">Using DB_FILE_NAME_CONVERT to Generate Names for Non-OMF or ASM Data Files</a></p>
</li>
<li>
<p><a href="rcmdupad.htm#GUID-A2CDA611-CF8E-4321-84E3-EB34E03EC385">Using LOG_FILE_NAME_CONVERT to Generate Names for Non-OMF or ASM Log Files</a></p>
</li>
</ul>
</div>
<a id="BRADV449"></a><a id="BRADV544"></a><a id="BRADV89943"></a>
<div class="props_rev_3"><a id="GUID-1DEFFB79-719E-4935-BF9A-AAD0769ECE8F"></a>
<h4 id="BRADV-GUID-1DEFFB79-719E-4935-BF9A-AAD0769ECE8F" class="sect4">Settings and Restrictions for OMF Initialization Parameters</h4>
<div>
<p>When creating a duplicate database that uses Oracle Managed Files, you must set initialization parameters in the auxiliary instance. If you use the <code class="codeph">SPFILE</code> clause of <code class="codeph">DUPLICATE</code> to name the files, then you can set initialization parameters in the <code class="codeph">SPFILE</code> clause. <a href="rcmdupad.htm#GUID-1DEFFB79-719E-4935-BF9A-AAD0769ECE8F__CIHBHAAE" title="Relevant initialization parameters for Oracle Managed Files">Table 26-3</a> describes the relevant parameters and recommended settings and <a href="rcmdupad.htm#GUID-1DEFFB79-719E-4935-BF9A-AAD0769ECE8F__CIHIFDBE" title="List of Initialization Parameter Restrictions for Oracle Managed Files">Table 26-4</a> lists the restrictions on setting other initialization parameters</p>
<div class="infobox-note" id="GUID-1DEFFB79-719E-4935-BF9A-AAD0769ECE8F__GUID-5DE4C256-DEE0-4DB6-9682-A48A78F661F6">
<p class="notep1">See:</p>
<p><a class="olink REFRN" target="_blank" href="../REFRN/toc.htm"><span class="italic">Oracle Database Reference</span></a> for more information about these parameters.</p>
</div>
<div class="tblformalwide" id="GUID-1DEFFB79-719E-4935-BF9A-AAD0769ECE8F__CIHBHAAE">
<p class="titleintable">Table 26-3 Initialization Parameters for Oracle Managed Files</p>
<table class="cellalignment553" title="Initialization Parameters for Oracle Managed Files" summary="Relevant initialization parameters for Oracle Managed Files">
<thead>
<tr class="cellalignment501">
<th class="cellalignment532" id="d103537e1127">Initialization Parameter</th>
<th class="cellalignment532" id="d103537e1130">Purpose</th>
<th class="cellalignment564" id="d103537e1133">Recommendation</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment501">
<td class="cellalignment535" id="d103537e1138" headers="d103537e1127">
<p><a class="olink REFRN10034" target="_blank" href="../REFRN/GUID-8E6EE3CE-0F39-4A6C-BF3C-F7C07902678D.htm#REFRN10034"><code class="codeph">DB_CREATE_FILE_DEST</code></a></p>
</td>
<td class="cellalignment535" headers="d103537e1138 d103537e1130">
<p>Specifies the default location for Oracle managed data files. This location is also the default location for Oracle managed control files and online logs if no <code class="codeph">DB_CREATE_ONLINE_LOG_DEST</code> initialization parameters are specified.</p>
</td>
<td class="cellalignment565" headers="d103537e1138 d103537e1133">
<p>Set this parameter to the location for the Oracle Managed Files. Any database files for which no other location is specified are created in <code class="codeph">DB_CREATE_FILE_DEST</code> by <code class="codeph">DUPLICATE</code>. You can override the default for specific files using <code class="codeph">SET NEWNAME</code>, as described in <span class="q">&#34;<a href="rcmdupad.htm#GUID-D7EA0379-3CF6-4B95-8C5A-754F25244E32">Using SET NEWNAME to Create OMF or ASM Files</a>&#34;</span>.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment535" id="d103537e1168" headers="d103537e1127">
<p><a class="olink REFRN10035" target="_blank" href="../REFRN/GUID-0749E9E4-8BCD-443E-B617-6508BF0D3484.htm#REFRN10035"><code class="codeph">DB_CREATE_ONLINE_LOG_DEST_</code><span class="italic">n</span></a></p>
</td>
<td class="cellalignment535" headers="d103537e1168 d103537e1130">
<p>Specifies the default location for Oracle managed control files and online redo logs. If multiple parameters are set, then one control file and one online redo log is created in each location.</p>
</td>
<td class="cellalignment565" headers="d103537e1168 d103537e1133">
<p>Set these parameters (<code class="codeph">_1</code>, <code class="codeph">_2</code>, and so on) only if you want to multiplex the control files and online redo log files in multiple locations.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment535" id="d103537e1189" headers="d103537e1127">
<p><a class="olink REFRN10234" target="_blank" href="../REFRN/GUID-A137E048-DFBA-49D8-97F2-3A657F4FD84C.htm#REFRN10234"><code class="codeph">DB_RECOVERY_FILE_DEST</code></a></p>
</td>
<td class="cellalignment535" headers="d103537e1189 d103537e1130">
<p>Specifies the default location for the fast recovery area. The fast recovery area contains multiplexed copies of current control files and online redo log files.</p>
</td>
<td class="cellalignment565" headers="d103537e1189 d103537e1133">
<p>Set this parameter if you want a multiplexed copy of the control file and online redo log file in the recovery area.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="tblformalwide" id="GUID-1DEFFB79-719E-4935-BF9A-AAD0769ECE8F__CIHIFDBE">
<p class="titleintable">Table 26-4 Initialization Parameter Restrictions for Oracle Managed Files</p>
<table class="cellalignment553" title="Initialization Parameter Restrictions for Oracle Managed Files" summary="List of Initialization Parameter Restrictions for Oracle Managed Files">
<thead>
<tr class="cellalignment501">
<th class="cellalignment532" id="d103537e1212">Initialization Parameter</th>
<th class="cellalignment532" id="d103537e1215">Purpose</th>
<th class="cellalignment564" id="d103537e1218">Restriction</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment501">
<td class="cellalignment535" id="d103537e1223" headers="d103537e1212">
<p><a class="olink REFRN10021" target="_blank" href="../REFRN/GUID-1D609657-4283-40DA-8A57-8097E719281C.htm#REFRN10021"><code class="codeph">CONTROL_FILES</code></a></p>
</td>
<td class="cellalignment535" headers="d103537e1223 d103537e1215">
<p>Specifies one or more names of control files, separated by commas.</p>
</td>
<td class="cellalignment565" headers="d103537e1223 d103537e1218">
<p>Do not set this parameter if you want the duplicate database control files in an OMF format. Oracle recommends that you use a server parameter file at the duplicate database when using control files in an OMF format.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment535" id="d103537e1236" headers="d103537e1212">
<p><a class="olink REFRN10038" target="_blank" href="../REFRN/GUID-E8B4E0EA-B073-4349-9EA9-E053F499FB9E.htm#REFRN10038"><code class="codeph">DB_FILE_NAME_CONVERT</code></a></p>
</td>
<td class="cellalignment535" headers="d103537e1236 d103537e1215">
<p>Converts the file name of a new data file on the primary database to a file name on the duplicate database.</p>
</td>
<td class="cellalignment565" headers="d103537e1236 d103537e1218">
<p>Do not set this parameter. Omitting this parameter enables the database to generate valid Oracle managed file names for the duplicate data files.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment535" id="d103537e1249" headers="d103537e1212">
<p><a class="olink REFRN10098" target="_blank" href="../REFRN/GUID-3D5894EF-C33D-4687-978F-F640174F6FCC.htm#REFRN10098"><code class="codeph">LOG_FILE_NAME_CONVERT</code></a></p>
</td>
<td class="cellalignment535" headers="d103537e1249 d103537e1215">
<p>Converts the file name of a new log file on the primary database to the file name of a log file on the standby database.</p>
</td>
<td class="cellalignment565" headers="d103537e1249 d103537e1218">
<p>Do not set this parameter. Omitting this parameter allows the database to generate valid Oracle managed online redo log file names.</p>
<p>To direct duplicate database online redo log files to Oracle managed storage, you can use the <code class="codeph">DB_CREATE_FILE_DEST</code>, <code class="codeph">DB_RECOVERY_FILE_DEST</code>, or <code class="codeph">DB_CREATE_ONLINE_LOG_DEST_</code><span class="italic"><code class="codeph">n</code></span> initialization parameters to identify an Oracle managed location for the online logs.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="BRADV89944"></a>
<div class="props_rev_3"><a id="GUID-C8CA30C1-276C-4FDC-8A26-C392D0CACDEF"></a>
<h4 id="BRADV-GUID-C8CA30C1-276C-4FDC-8A26-C392D0CACDEF" class="sect4">Setting Initialization Parameters for ASM</h4>
<div>
<p>The procedure for creating a duplicate database to an ASM location is similar to the procedure described in <span class="q">&#34;<a href="rcmdupad.htm#GUID-1DEFFB79-719E-4935-BF9A-AAD0769ECE8F">Settings and Restrictions for OMF Initialization Parameters</a> &#34;</span>. The difference is that you must identify the initialization parameters that control the location where files are created and set these parameters to an ASM disk group. For example, set <code class="codeph">DB_CREATE_FILE_DEST</code>, <code class="codeph">DB_CREATE_ONLINE_DEST_</code><span class="italic"><code class="codeph">n</code></span>, and <code class="codeph">CONTROL_FILES</code> to <code class="codeph">+DISK1</code>.</p>
</div>
<a id="BRADV450"></a><a id="BRADV89945"></a>
<div class="props_rev_3"><a id="GUID-2FF32CAC-47C4-4E67-854D-8088368B5B83"></a>
<h5 id="BRADV-GUID-2FF32CAC-47C4-4E67-854D-8088368B5B83" class="sect5">Duplicating a Database from a File System to ASM: Example</h5>
<div>
<div class="section">
<p>In this example, you use active database duplication. If the source database uses a server parameter file (or a backup is available), then you can create a temporary initialization parameter file on the destination host and set only the <code class="codeph">DB_NAME</code> parameter.</p>
<p>Assume that the source database <code class="codeph">prod</code> is on <code class="codeph">host1</code> and stores its data files in a non-ASM file system. The control files for <code class="codeph">prod</code> are located in <code class="codeph">/oracle/oradata/prod/</code>. You want to duplicate the source database to database <code class="codeph">dupdb</code> on remote host <code class="codeph">host2</code>. You want to store the duplicate database files in ASM disk group <code class="codeph">+DISK1</code>.</p>
<p>After connecting RMAN to the target, duplicate, and recovery catalog databases, run the RMAN script shown in <a href="rcmdupad.htm#GUID-2FF32CAC-47C4-4E67-854D-8088368B5B83__CHDJJAAG">Example 26-1</a> to duplicate the database.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-2FF32CAC-47C4-4E67-854D-8088368B5B83__CHDJJAAG">
<p class="titleinexample">Example 26-1 Duplicating from a File System to ASM (Active)</p>
<pre dir="ltr">DUPLICATE TARGET DATABASE TO dupdb
  FROM ACTIVE DATABASE
  SPFILE 
    PARAMETER_VALUE_CONVERT &#39;/oracle/oradata/prod/&#39;, &#39;+DISK1&#39;
    SET DB_CREATE_FILE_DEST +DISK1;
</pre>
<p>When the <code class="codeph">DUPLICATE</code> command completes, the duplicate database is created, with data files, online redo log files, and control files in ASM disk group <code class="codeph">+DISK1</code>.</p>
</div>
<!-- class="example" --></div>
</div>
<a id="BRADV451"></a><a id="BRADV89946"></a>
<div class="props_rev_3"><a id="GUID-B580192D-CFBC-4501-8DD8-7A4E9AF4777C"></a>
<h5 id="BRADV-GUID-B580192D-CFBC-4501-8DD8-7A4E9AF4777C" class="sect5">Duplicating a Database from ASM to ASM: Example</h5>
<div>
<div class="section">
<p>In this example, you use active database duplication. If the source database uses a server parameter file (or a backup is available), then you can create a temporary initialization parameter file on the destination host and set only the <code class="codeph">DB_NAME</code> parameter.</p>
<p>Assume that the source database <code class="codeph">prod</code> is on <code class="codeph">host1</code> and stores its data files in ASM disk group <code class="codeph">+DISK1</code>. You want to duplicate the target to database <code class="codeph">dupdb</code> on remote host <code class="codeph">host2</code>. You want to store the data files for <code class="codeph">dupdb</code> in ASM. Specifically, you want to store the data files and control files in disk group <code class="codeph">+DISK2</code>.</p>
<p>In the <code class="codeph">DUPLICATE</code> command, set <code class="codeph">PARAMETER_VALUE_CONVERT</code> to convert all directory locations from <code class="codeph">+DISK1</code> to <code class="codeph">+DISK2</code>. The new file names in <code class="codeph">+DISK2</code> are generated by ASM and do not match the original file names in disk group <code class="codeph">+DISK1</code>.</p>
<p>After connecting to the target, duplicate, and catalog databases, run the RMAN script shown in <a href="rcmdupad.htm#GUID-B580192D-CFBC-4501-8DD8-7A4E9AF4777C__CHDBIBBJ">Example 26-2</a> to duplicate the database.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-B580192D-CFBC-4501-8DD8-7A4E9AF4777C__CHDBIBBJ">
<p class="titleinexample">Example 26-2 Duplicating from ASM to ASM (Active)</p>
<pre dir="ltr">DUPLICATE TARGET DATABASE
  TO dupdb
  FROM ACTIVE DATABASE
  SPFILE PARAMETER_VALUE_CONVERT &#39;+DISK1&#39;,&#39;+DISK2&#39;
     SET DB_RECOVERY_FILE_DEST_SIZE=&#39;750G&#39;;
</pre>
<p>When the <code class="codeph">DUPLICATE</code> command completes, the duplicate database is created, with data files, online redo logs, and control files in the larger ASM disk group <code class="codeph">+DISK2</code>.</p>
</div>
<!-- class="example" --></div>
</div>
</div>
<a id="BRADV89957"></a>
<div class="props_rev_3"><a id="GUID-D7EA0379-3CF6-4B95-8C5A-754F25244E32"></a>
<h4 id="BRADV-GUID-D7EA0379-3CF6-4B95-8C5A-754F25244E32" class="sect4">Using SET NEWNAME to Create OMF or ASM Files</h4>
<div>
<div class="section">
<p>To name Oracle managed data files, you can use the same <code class="codeph">SET NEWNAME</code> commands described in <span class="q">&#34;<a href="rcmdupad.htm#GUID-9693D878-75CA-4E17-A972-F97E33F0BE0F">Using SET NEWNAME to Name File System Data Files and Temp Files</a>&#34;</span>, but with <code class="codeph">TO NEW</code> instead of <code class="codeph">TO &#39;</code><span class="italic"><code class="codeph">filename</code></span><code class="codeph">&#39;</code>. RMAN creates the specified data files or temp files with Oracle Managed File names in the location specified by <code class="codeph">DB_CREATE_FILE_DEST</code>.</p>
<p><span class="bold">To use SET NEWNAME to specify names for Oracle Managed Files:</span></p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Set the <code class="codeph">DB_CREATE_FILE_DEST</code> initialization parameter at the auxiliary instance to the desired location</span></li>
<li class="stepexpand"><span>Enclose the <code class="codeph">DUPLICATE</code> command in a <code class="codeph">RUN</code> block and use <code class="codeph">SET NEWNAME</code> with the <code class="codeph">TO NEW</code> option for Oracle Managed Files.</span>
<div>
<p>The following example illustrates a script that specifies literal names for data files 1-5. The only Oracle Managed Files in the source database are the data files in the <code class="codeph">users</code> tablespace. Therefore, <code class="codeph">TO NEW</code> is specified in the <code class="codeph">SET NEWNAME</code> command for these files.</p>
<pre dir="ltr">RUN
{
  SET NEWNAME FOR TABLESPACE users TO NEW;
  SET NEWNAME FOR DATAFILE 3 TO NEW;
  SET NEWNAME FOR DATAFILE 1 TO &#39;/oradata1/system01.dbf&#39;; 
  SET NEWNAME FOR DATAFILE 2 TO &#39;/oradata2/sysaux01.dbf&#39;;
  SET NEWNAME FOR TEMPFILE 1 TO &#39;/oradatat/temp01&#39;;  
  DUPLICATE TARGET DATABASE TO dupdb
    SKIP TABLESPACE tools
    LOGFILE
      GROUP 1 (&#39;/duplogs/redo01a.log&#39;, 
               &#39;/duplogs/redo01b.log&#39;) SIZE 4M REUSE, 
      GROUP 2 (&#39;/duplogs/redo02a.log&#39;, 
               &#39;/duplogs/redo02b.log&#39;) SIZE 4M REUSE;
}
</pre>
<p>As shown in the following example, you can also use <code class="codeph">SET</code> <code class="codeph">NEWNAME</code> to direct individual data files, temp files, or tablespaces to a specified ASM disk group.</p>
<pre dir="ltr">RUN
{
   SET NEWNAME FOR DATAFILE 1 TO &#34;+DGROUP1&#34;;
   SET NEWNAME FOR DATAFILE 2 TO &#34;+DGROUP2&#34;;
   .
   .
   .
   DUPLICATE TARGET DATABASE 
     TO dupdb
     FROM ACTIVE DATABASE
     SPFILE SET DB_CREATE_FILE_DEST +DGROUP3;
}
</pre></div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-D7EA0379-3CF6-4B95-8C5A-754F25244E32__GUID-B3B8A1DE-3AFD-4A7A-B18D-EFDE8B8E6F97">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF153" target="_blank" href="../RCMRF/rcmsynta2014.htm#RCMRF153"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for details on using <code class="codeph">SET</code> <code class="codeph">NEWNAME</code></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV614"></a>
<div class="props_rev_3"><a id="GUID-DA7B2562-A2B7-4F6C-AFFC-1D8C822EB02D"></a>
<h4 id="BRADV-GUID-DA7B2562-A2B7-4F6C-AFFC-1D8C822EB02D" class="sect4">Using DB_FILE_NAME_CONVERT to Generate Names for Non-OMF or ASM Data Files</h4>
<div>
<div class="section">
<p>Another technique to generate names besides using <code class="codeph">SET NEWNAME</code> or <code class="codeph">CONFIGURE AUXNAME</code> commands is to use <code class="codeph">DB_FILE_NAME_CONVERT</code> to transform target file names. For example, you can change the target file name from <code class="codeph">/oracle/</code> to <code class="codeph">/dup/oracle/</code>. <code class="codeph">DB_FILE_NAME_CONVERT</code> allows you to specify multiple conversion file name pairs. It can also be used to produce names for data files and temp files.</p>
<p>You can specify <code class="codeph">DB_FILE_NAME_CONVERT</code> in the <code class="codeph">DUPLICATE</code> command or you can set it in the initialization parameter of the auxiliary instance.</p>
</div>
<!-- class="section" --></div>
<a id="BRADV615"></a>
<div class="props_rev_3"><a id="GUID-C94A3ECC-BFC4-4250-BCB3-98DAB171EB12"></a>
<h5 id="BRADV-GUID-C94A3ECC-BFC4-4250-BCB3-98DAB171EB12" class="sect5">Restrictions on Using DB_FILE_NAME_CONVERT During Database Duplication</h5>
<div>
<p>You cannot use the <code class="codeph">DB_FILE_NAME_CONVERT</code> clause of the <code class="codeph">DUPLICATE</code> command to control generation of new names for files at the duplicate instance that are in the Oracle Managed Files (OMF) format at the source database instance. See <a class="olink RCMRF" target="_blank" href="../RCMRF/toc.htm"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for details on this restriction.</p>
</div>
</div>
</div>
<a id="BRADV616"></a>
<div class="props_rev_3"><a id="GUID-A2CDA611-CF8E-4321-84E3-EB34E03EC385"></a>
<h4 id="BRADV-GUID-A2CDA611-CF8E-4321-84E3-EB34E03EC385" class="sect4">Using LOG_FILE_NAME_CONVERT to Generate Names for Non-OMF or ASM Log Files</h4>
<div>
<p>If the <code class="codeph">LOG_FILE</code> clause has been omitted and no Oracle Managed Files initialization parameters <code class="codeph">DB_CREATE_FILE_DEST</code>, <code class="codeph">DB_CREATE_ONLINE_DEST_n</code>, or <code class="codeph">DB_RECOVERY_FILE_DEST</code> are specified, then <code class="codeph">LOG_FILE_NAME_CONVERT</code> can transform target file names. This works in much the same way as the <code class="codeph">DB_FILE_NAME_CONVERT</code> and can transform target file names from <code class="codeph">log_*</code> to <code class="codeph">duplog_*</code>. You can specify multiple conversion file name pairs with this parameter.</p>
<p>When you specify <code class="codeph">LOG_FILE_NAME_CONVERT</code>, RMAN uses the <code class="codeph">REUSE</code> parameter when creating the online redo logs. If an online redo log file exists at the named location and is of the correct size, then it is reused for the duplicate.</p>
</div>
<a id="BRADV617"></a>
<div class="props_rev_3"><a id="GUID-F2AA79B3-F317-42BA-9493-62426F66C131"></a>
<h5 id="BRADV-GUID-F2AA79B3-F317-42BA-9493-62426F66C131" class="sect5">Restrictions on Using LOG_FILE_NAME_CONVERT During Database Duplication</h5>
<div>
<ul style="list-style-type: disc;">
<li>
<p>Do not specify <code class="codeph">LOG_FILE_NAME_CONVERT</code> if you set Oracle Managed Files initialization parameters.</p>
</li>
<li>
<p><code class="codeph">LOG_FILE_NAME_CONVERT</code> cannot be specified as a <code class="codeph">DUPLICATE</code> clause, it can only be specified in the initialization parameter of the auxiliary instance.</p>
</li>
<li>
<p>You cannot use the <code class="codeph">LOG_FILE_NAME_CONVERT</code> initialization parameter to control generation of new names for files at the duplicate instance that are in the Oracle Managed Files (OMF) format at the source database instance.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<a id="BRADV99994"></a>
<div class="props_rev_3"><a id="GUID-FA3D3776-53EB-495C-9726-3446D32E8B3A"></a>
<h2 id="BRADV-GUID-FA3D3776-53EB-495C-9726-3446D32E8B3A" class="sect2">Making Disk Backups Accessible Without Shared Disk</h2>
<div>
<div class="section">
<p><span class="q">&#34;<a href="rcmdupdb.htm#GUID-F0644DE7-0D8B-4FF6-8645-7A696052EF82">Step 4: Making Backups Accessible to the Duplicate Instance</a>&#34;</span> recommends using the shared disk technique to make backups available to the auxiliary instance. When NFS or shared disk is not an option, then the path that stores the backups must exist on <span class="italic">both</span> the source and destination hosts unless the <code class="codeph">BACKUP LOCATION</code> option is used for the DUPLICATE command without a target or recovery catalog connection.</p>
<p>Assume that you maintain two hosts, <code class="codeph">srchost</code> and <code class="codeph">dsthost</code>. The database on <code class="codeph">srchost</code> is <code class="codeph">srcdb</code>. The RMAN backups of <code class="codeph">srcdb</code> reside in <code class="codeph">/dsk1/bkp</code> on host <code class="codeph">srchost</code>. The directory <code class="codeph">/dsk1/bkp</code> is in use on the destination host, so you intend to store backups in <code class="codeph">/dsk2/dup</code> on the destination host.</p>
<p><span class="bold">To transfer the backups from the source host to the destination host:</span></p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Create a directory in the source host that has the same name as the directory on the destination host that will contain the backups.</span>
<div>
<p>For example, if you intend to store the RMAN backups in <code class="codeph">/dsk2/dup</code> on the destination host, then create <code class="codeph">/dsk2/dup</code> on the source host.</p>
</div>
</li>
<li class="stepexpand"><span>On the source host, copy the backups to the directory created in the previous step, and then catalog the backups. You can use either of the following approaches:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p>Connect RMAN to the source database as <code class="codeph">TARGET</code> and use the <code class="codeph">BACKUP</code> command to back up the backups, as explained in <span class="q">&#34;<a href="rcmbckba.htm#GUID-731ADA67-235E-481D-AC17-9F9067AD55BF">Backing Up RMAN Backups</a>&#34;</span>. For example, use the <code class="codeph">BACKUP COPY OF DATABASE</code> command to copy the backups in <code class="codeph">/dsk1/bkp</code> on the source host to <code class="codeph">/dsk2/dup</code> on the source host. In this case, RMAN automatically catalogs the backups in the new location.</p>
<p>If you are duplicating a pluggable database (<a href="glossary.htm#GUID-993BFB3F-3305-481C-999D-26132095DEC9"><span class="xrefglossterm">PDB</span></a>), then use the <code class="codeph">PLUGGABLE DATABASE</code> syntax of the <code class="codeph">BACKUP COPY OF</code> command to copy only the backups of the PDB.</p>
</li>
<li>
<p>Use an operating system utility to copy the backups in <code class="codeph">/dsk1/bkp</code> on the source host to <code class="codeph">/dsk2/dup</code> on the source host. Afterward, connect RMAN to the source database as <code class="codeph">TARGET</code> and use the <code class="codeph">CATALOG</code> command to update the source control file with the location of the manually transferred backups.</p>
</li>
</ul>
</div>
</li>
<li class="stepexpand"><span>Manually transfer the backups in the new directory on the source host to the identically named directory on the destination host.</span>
<div>
<p>For example, use FTP to transfer the backups in <code class="codeph">/dsk2/dup</code> on the source host to <code class="codeph">/dsk2/dup</code> on the destination host.</p>
</div>
</li>
</ol>
<div class="section">
<p>The auxiliary channel can search for backups in <code class="codeph">/dsk2/dup</code> on the destination host and restore them.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV455"></a><a id="BRADV454"></a>
<div class="props_rev_3"><a id="GUID-D98BB0FD-15C4-4691-BA86-8A85D072F824"></a>
<h2 id="BRADV-GUID-D98BB0FD-15C4-4691-BA86-8A85D072F824" class="sect2">Duplicating a Database When No Server Parameter File Exists</h2>
<div>
<div class="section">
<p>The procedure in <span class="q">&#34;<a href="rcmdupdb.htm#GUID-CFB68ABE-BE7D-4F88-897D-7D07BA46EBCA">Step 7: Creating an Initialization Parameter File and Starting the Auxiliary Instance</a>&#34;</span> assumes that you use the <code class="codeph">SPFILE</code> clause of the <code class="codeph">DUPLICATE</code> command. If the source database does <span class="italic">not</span> use a server parameter file, then you must set all necessary parameters for the auxiliary instance in a text-based initialization parameter file.</p>
<p><a href="rcmdupad.htm#GUID-D98BB0FD-15C4-4691-BA86-8A85D072F824__CHDCAAIA" title="Describes the DB_NAME and CONTROL_FILES parameters.">Table 26-5</a> describes a subset of the possible initialization parameters. See <a class="olink REFRN" target="_blank" href="../REFRN/toc.htm"><span class="italic">Oracle Database Reference</span></a> provides more information about these parameters. See <a href="rcmdupad.htm#GUID-9693D878-75CA-4E17-A972-F97E33F0BE0F__CIHJJJAJ" title="A list of the substitution varibales for SET NEWNAME.">Table 26-1</a> to learn about options for naming duplicate files.</p>
<div class="tblformalwide" id="GUID-D98BB0FD-15C4-4691-BA86-8A85D072F824__CHDCAAIA">
<p class="titleintable">Table 26-5 Auxiliary Instance Initialization Parameters</p>
<table class="cellalignment553" title="Auxiliary Instance Initialization Parameters" summary="Describes the DB_NAME and CONTROL_FILES parameters.">
<thead>
<tr class="cellalignment501">
<th class="cellalignment522" id="d103537e2461">Initialization Parameter</th>
<th class="cellalignment574" id="d103537e2464">Value</th>
<th class="cellalignment571" id="d103537e2467">Status</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment501">
<td class="cellalignment524" id="d103537e2472" headers="d103537e2461">
<p><a class="olink REFRN10041" target="_blank" href="../REFRN/GUID-D8A5CD6B-2C72-47EF-B7D8-A6FC69934314.htm#REFRN10041"><code class="codeph">DB_NAME</code></a></p>
</td>
<td class="cellalignment575" headers="d103537e2472 d103537e2464">
<p>The same name used in the <code class="codeph">DUPLICATE</code> command. If you are using <code class="codeph">DUPLICATE</code> to create a standby database, then the name must be the same as the primary database.</p>
<p>The <code class="codeph">DB_NAME</code> setting for the duplicate database must be unique among databases in its Oracle home.</p>
</td>
<td class="cellalignment573" headers="d103537e2472 d103537e2467">
<p>Required</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment524" id="d103537e2496" headers="d103537e2461">
<p><a class="olink REFRN10021" target="_blank" href="../REFRN/GUID-1D609657-4283-40DA-8A57-8097E719281C.htm#REFRN10021"><code class="codeph">CONTROL_FILES</code></a></p>
</td>
<td class="cellalignment575" headers="d103537e2496 d103537e2464">
<p>Control file locations</p>
</td>
<td class="cellalignment573" headers="d103537e2496 d103537e2467">
<p>Required</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment524" id="d103537e2509" headers="d103537e2461">
<p><a class="olink REFRN10031" target="_blank" href="../REFRN/GUID-6DD6D804-D03D-4C57-A764-826EE0F3836B.htm#REFRN10031"><code class="codeph">DB_BLOCK_SIZE</code></a></p>
</td>
<td class="cellalignment575" headers="d103537e2509 d103537e2464">
<p>The block size for the duplicate database. This block size must match the block size of the source database. If the source database parameter file contains a value for the <code class="codeph">DB_BLOCK_SIZE</code> initialization parameter, then you must specify the same value for the auxiliary instance. If no <code class="codeph">DB_BLOCK_SIZE</code> is specified in the source database initialization parameter file, however, then do not specify <code class="codeph">DB_BLOCK_SIZE</code> in the auxiliary instance.</p>
</td>
<td class="cellalignment573" headers="d103537e2509 d103537e2467">
<p>Required if this initialization parameter is set in the source database</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment524" id="d103537e2531" headers="d103537e2461">
<p><a class="olink REFRN10038" target="_blank" href="../REFRN/GUID-E8B4E0EA-B073-4349-9EA9-E053F499FB9E.htm#REFRN10038"><code class="codeph">DB_FILE_NAME_CONVERT</code></a></p>
</td>
<td class="cellalignment575" headers="d103537e2531 d103537e2464">
<p>Pairs of strings for converting the names of data files and temp files. You can also specify <code class="codeph">DB_FILE_NAME_CONVERT</code> on the <code class="codeph">DUPLICATE</code> command itself. See <span class="q">&#34;<a href="rcmdupad.htm#GUID-DA7B2562-A2B7-4F6C-AFFC-1D8C822EB02D">Using DB_FILE_NAME_CONVERT to Generate Names for Non-OMF or ASM Data Files</a>&#34;</span>.</p>
</td>
<td class="cellalignment573" headers="d103537e2531 d103537e2467">
<p>Optional</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment524" id="d103537e2555" headers="d103537e2461">
<p><a class="olink REFRN10098" target="_blank" href="../REFRN/GUID-3D5894EF-C33D-4687-978F-F640174F6FCC.htm#REFRN10098"><code class="codeph">LOG_FILE_NAME_CONVERT</code></a></p>
</td>
<td class="cellalignment575" headers="d103537e2555 d103537e2464">
<p>Pairs of strings for naming online redo log files. See <span class="q">&#34;<a href="rcmdupad.htm#GUID-A2CDA611-CF8E-4321-84E3-EB34E03EC385">Using LOG_FILE_NAME_CONVERT to Generate Names for Non-OMF or ASM Log Files</a>&#34;</span>.</p>
</td>
<td class="cellalignment573" headers="d103537e2555 d103537e2467">
<p>Optional</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment524" id="d103537e2573" headers="d103537e2461">
<p><a class="olink REFRN10034" target="_blank" href="../REFRN/GUID-8E6EE3CE-0F39-4A6C-BF3C-F7C07902678D.htm#REFRN10034"><code class="codeph">DB_CREATE_FILE_DEST</code></a></p>
</td>
<td class="cellalignment575" headers="d103537e2573 d103537e2464">
<p>Location for Oracle managed data files.</p>
</td>
<td class="cellalignment573" headers="d103537e2573 d103537e2467">
<p>Optional</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment524" id="d103537e2586" headers="d103537e2461">
<p><a class="olink REFRN10035" target="_blank" href="../REFRN/GUID-0749E9E4-8BCD-443E-B617-6508BF0D3484.htm#REFRN10035"><code class="codeph">DB_CREATE_ONLINE_LOG_DEST</code>_<span class="italic"><code class="codeph">n</code></span></a></p>
</td>
<td class="cellalignment575" headers="d103537e2586 d103537e2464">
<p>Location for Oracle managed online redo log files</p>
</td>
<td class="cellalignment573" headers="d103537e2586 d103537e2467">
<p>Optional</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment524" id="d103537e2603" headers="d103537e2461">
<p><a class="olink REFRN10234" target="_blank" href="../REFRN/GUID-A137E048-DFBA-49D8-97F2-3A657F4FD84C.htm#REFRN10234"><code class="codeph">DB_RECOVERY_FILE_DEST</code></a></p>
</td>
<td class="cellalignment575" headers="d103537e2603 d103537e2464">
<p>Location for fast recovery area</p>
</td>
<td class="cellalignment573" headers="d103537e2603 d103537e2467">
<p>Optional</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment524" id="d103537e2616" headers="d103537e2461">
<p>Oracle Real Application Cluster (Oracle RAC) parameters:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="italic">&lt;INSTANCESIDn&gt;</span>.<code class="codeph">INSTANCE_NAME</code></p>
</li>
<li>
<p><span class="italic">&lt;INSTANCESIDn&gt;</span>.<code class="codeph">INSTANCE_NUMBER</code></p>
</li>
<li>
<p><span class="italic">&lt;INSTANCESIDn&gt;</span>.<code class="codeph">THREAD</code></p>
</li>
<li>
<p><span class="italic">&lt;INSTANCESIDn</span>&gt;.<code class="codeph">UNDO_TABLESPACE</code></p>
</li>
<li>
<p><span class="italic">&lt;INSTANCESIDn</span>&gt;.<code class="codeph">LOCAL_LISTENER</code></p>
</li>
</ul>
</td>
<td class="cellalignment575" headers="d103537e2616 d103537e2464">
<p>Set these parameters for each instance of the Oracle RAC database.</p>
</td>
<td class="cellalignment573" headers="d103537e2616 d103537e2467">
<p>Required for Oracle RAC configuration</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p><span class="bold">To create an initialization parameter file when not planning to use the SPFILE clause:</span></p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Use an operating system utility to make a copy of the initialization parameter file of the source database in the operating system-specific default location.</span></li>
<li class="stepexpand"><span>In the copied initialization parameter file, manually change <code class="codeph">DB_NAME</code> to the name of the duplicate database. If you are using <code class="codeph">DUPLICATE</code> to create a standby database, then the name must be the same as the primary database.</span></li>
<li class="stepexpand"><span>If necessary, change other initialization parameters, including the parameters that enable you to connect through Oracle Net, as needed. You must verify that all paths are accessible on the host where the database is being duplicated.</span>
<div>
<p>The following example shows a sample initialization parameter file.</p>
<pre dir="ltr">DB_NAME=dupdb
CONTROL_FILES=(/dup/oracle/oradata/prod/control01.ctl,
               /dup/oracle/oradata/prod/control02.ctl)
DB_FILE_NAME_CONVERT=(/oracle/oradata/prod/,/dup/oracle/oradata/prod/)
LOG_FILE_NAME_CONVERT=(/oracle/oradata/prod/redo,/dup/oracle/oradata/prod/redo)
</pre></div>
</li>
</ol>
</div>
</div>
<a id="BRADV457"></a>
<div class="props_rev_3"><a id="GUID-A5A19480-D601-487C-8595-54FB38356A19"></a>
<h2 id="BRADV-GUID-A5A19480-D601-487C-8595-54FB38356A19" class="sect2">Starting the Auxiliary Instance When No Server Parameter File Exists</h2>
<div>
<div class="section">
<p><span class="q">&#34;<a href="rcmdupdb.htm#GUID-CFB68ABE-BE7D-4F88-897D-7D07BA46EBCA">Step 7: Creating an Initialization Parameter File and Starting the Auxiliary Instance</a>&#34;</span> assumes that the source database instance uses a server parameter file. This scenario assumes that the source database does not currently use a server parameter file or RMAN cannot restore a backup server parameter file. In this case, you must start the auxiliary instance with a text-based initialization parameter file.</p>
<p><span class="bold">To start the auxiliary instance in preparation for database duplication:</span></p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Copy the text-based initialization parameter file to the default location on the host containing the SQL*Plus client.</span></li>
<li class="stepexpand"><span>Start SQL*Plus and connect to the auxiliary instance with <code class="codeph">SYSOPER</code> privileges.</span></li>
<li class="stepexpand"><span>Start the auxiliary instance in <code class="codeph">NOMOUNT</code> mode, using the text-based initialization parameter file:</span>
<div>
<pre dir="ltr">SQL&gt; STARTUP NOMOUNT
</pre></div>
</li>
<li class="stepexpand"><span>Copy the text-based initialization parameter file for the auxiliary instance to the same host as the RMAN client used to perform the duplication. You must specify the location of this text-based initialization parameter file in the <code class="codeph">PFILE</code> clause of the <code class="codeph">DUPLICATE</code> command.</span></li>
</ol>
</div>
</div>
<a id="BRADV458"></a><a id="BRADV459"></a><a id="BRADV89951"></a>
<div class="props_rev_3"><a id="GUID-0C6616AE-FF8A-41E1-B0DE-EED457E020FC"></a>
<h2 id="BRADV-GUID-0C6616AE-FF8A-41E1-B0DE-EED457E020FC" class="sect2">Duplicating a Subset of the Source Database Tablespaces</h2>
<div>
<div class="section">
<p>It is not always necessary to duplicate all tablespaces of a database. For example, you may plan to generate reports that require only a subset of tablespaces from your source database.</p>
<div class="infobox-note" id="GUID-0C6616AE-FF8A-41E1-B0DE-EED457E020FC__GUID-EBF00A8B-BFB0-4428-842C-AC8CDCBD50AE">
<p class="notep1">Note:</p>
<p>When excluding tablespaces in backup-based duplication <span class="italic">without</span> a target connection or <span class="italic">without</span> a target and a recovery catalog connection, RMAN has special prerequisites. See the Prerequisites section of the <code class="codeph">DUPLICATE</code> entry in <span><a class="olink RCMRF126" target="_blank" href="../RCMRF/rcmsynta020.htm#RCMRF126">Oracle Database Backup and Recovery Reference</a></span> for details.</p>
</div>
<p><a id="d103537e2882" class="indexterm-anchor"></a><span><a href="rcmdupad.htm#GUID-0C6616AE-FF8A-41E1-B0DE-EED457E020FC__CIHCHJFC" title="A list of the options to exclude tablespaces from the duplicate database">Table 26-6</a></span> explains <code class="codeph">DUPLICATE</code> command options for specifying subsets of tablespaces for the duplicate database.</p>
<div class="tblformal" id="GUID-0C6616AE-FF8A-41E1-B0DE-EED457E020FC__CIHCHJFC">
<p class="titleintable">Table 26-6 Options to Specify Subsets of Tablespaces for the Duplicate Database</p>
<table class="cellalignment515" title="Options to Specify Subsets of Tablespaces for the Duplicate Database" summary="A list of the options to exclude tablespaces from the duplicate database">
<thead>
<tr class="cellalignment501">
<th class="cellalignment564" id="d103537e2905">DUPLICATE Options</th>
<th class="cellalignment533" id="d103537e2908">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment501">
<td class="cellalignment565" id="d103537e2913" headers="d103537e2905">
<p><code class="codeph">SKIP READONLY</code></p>
</td>
<td class="cellalignment536" headers="d103537e2913 d103537e2908">
<p>Excludes the data files of read-only tablespaces from the duplicate database</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment565" id="d103537e2921" headers="d103537e2905">
<p><code class="codeph">SKIP TABLESPACE</code> <span class="italic"><code class="codeph">&#39;tablespace_name &#39;, ...</code></span></p>
</td>
<td class="cellalignment536" headers="d103537e2921 d103537e2908">
<p>Excludes the specified tablespaces from the duplicate database. You cannot exclude the <code class="codeph">SYSTEM</code> and <code class="codeph">SYSAUX</code> tablespaces, tablespaces with <code class="codeph">SYS</code> objects, undo tablespaces, tablespaces with undo segments, tablespaces with materialized views, or tablespaces in such a way that the duplicated tablespaces are not self-contained.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment565" id="d103537e2941" headers="d103537e2905">
<p><code class="codeph">TABLESPACE</code> <span class="italic"><code class="codeph">&#39;tablespace_name &#39;, ...</code></span></p>
</td>
<td class="cellalignment536" headers="d103537e2941 d103537e2908">
<p>Automatically includes the <code class="codeph">SYSTEM</code>, <code class="codeph">SYSAUX</code>, and undo tablespaces. The included tablespaces must be self-contained and the resulting skipped tablespaces must not contain <code class="codeph">SYS</code> objects or materialized views.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">To specify a subset of tablespaces for a duplicate database:</p>
</div>
<!-- class="section" -->
<ol>
<li><span>Ensure that you have completed Steps 1 through 4 in <span class="q">&#34;<span><a href="rcmdupdb.htm#GUID-5C007067-E891-45AF-9985-50C052889078">Basic Steps of Database Duplication</a></span>&#34;</span>.</span></li>
<li><span>Run the <code class="codeph">DUPLICATE</code> command with one or more of the options in <span><a href="rcmdupad.htm#GUID-0C6616AE-FF8A-41E1-B0DE-EED457E020FC__CIHCHJFC" title="A list of the options to exclude tablespaces from the duplicate database">Table 26-6</a></span>.</span></li>
</ol>
<div class="section">
<p>Other factors that influence what tablespaces are copied include the <code class="codeph">OFFLINE NORMAL</code> option. When tablespaces are taken offline with the <code class="codeph">OFFLINE NORMAL</code> option before duplication, RMAN does not duplicate the associated data files, and issues <code class="codeph">DROP TABLESPACE</code> statement for these tablespaces on the duplicate database. Therefore, you do not have to specify options to exclude these tablespaces.</p>
<div class="infobox-note" id="GUID-0C6616AE-FF8A-41E1-B0DE-EED457E020FC__GUID-0FDC3C0D-D6F4-423D-8AA9-882A62769631">
<p class="notep1">Note:</p>
<p>RMAN does duplicate tablespaces that are taken offline with any other option besides <code class="codeph">NORMAL</code> (unless they are named in a <code class="codeph">SKIP TABLESPACE</code> option). Only <code class="codeph">OFFLINE NORMAL</code> tablespaces are skipped automatically. As with online tablespaces, RMAN requires a valid backup for these tablespaces when you use backup-based duplication.</p>
</div>
</div>
<!-- class="section" --></div>
<a id="BRADV460"></a><a id="BRADV461"></a><a id="BRADV89952"></a>
<div class="props_rev_3"><a id="GUID-49ECB6F0-9014-4CF0-8047-7615F7B6B16F"></a>
<h3 id="BRADV-GUID-49ECB6F0-9014-4CF0-8047-7615F7B6B16F" class="sect3">Excluding Specified Tablespaces During Database Duplication</h3>
<div>
<div class="example" id="GUID-49ECB6F0-9014-4CF0-8047-7615F7B6B16F__CIHCBHHJ">
<p class="titleinexample">Example 26-3 Excluding Read-Only Tablespaces</p>
<p>This example shows how to skip read-only tablespaces.</p>
<pre dir="ltr">DUPLICATE TARGET DATABASE TO dupdb
  FROM ACTIVE DATABASE
  SKIP READONLY
  NOFILENAMECHECK;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-49ECB6F0-9014-4CF0-8047-7615F7B6B16F__CIHGHJAF">
<p class="titleinexample">Example 26-4 Excluding Specified Tablespaces</p>
<p>This example shows how to skip a tablespace named <code class="codeph">tools</code>.</p>
<pre dir="ltr">DUPLICATE TARGET DATABASE 
  TO dupdb
  FROM ACTIVE DATABASE
  SKIP TABLESPACE tools
  NOFILENAMECHECK;
</pre></div>
<!-- class="example" --></div>
</div>
<a id="BRADV462"></a><a id="BRADV463"></a><a id="BRADV89954"></a>
<div class="props_rev_3"><a id="GUID-74D9281A-691E-4657-8350-ECF90D3931F6"></a>
<h3 id="BRADV-GUID-74D9281A-691E-4657-8350-ECF90D3931F6" class="sect3">Including Specified Tablespaces During Database Duplication</h3>
<div>
<div class="section">
<p><a id="d103537e3168" class="indexterm-anchor"></a>You can use the <code class="codeph">TABLESPACE</code> option to specify which tablespaces to include in the specified database. Unlike the <code class="codeph">SKIP TABLESPACE</code> option, which specifies which tablespaces to exclude from the duplicate database, this option specifies which tablespaces to include and then skips the remaining tablespaces. The duplicated subset of tablespaces must be self-contained. The resulting set of skipped tablespaces must not have undo segments or materialized views.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-74D9281A-691E-4657-8350-ECF90D3931F6__BGBCJJFE">
<p class="titleinexample">Example 26-5 Including Specified Tablespaces</p>
<p>This example is a variation of <span><a href="rcmdupdb.htm#GUID-F32840E6-F8C5-43D6-9B65-A3DF71665B06__BGBEEAEH">Example 25-1</a></span> except with the <code class="codeph">users</code> tablespace included, which is assumed to be self-contained, and all other tablespaces excluded, except for <code class="codeph">SYSTEM</code> and <code class="codeph">SYSAUX</code> tablespaces and tablespaces with undo segments.</p>
<pre dir="ltr">DUPLICATE TARGET DATABASE 
  TO dupdb
  FROM ACTIVE DATABASE
  TABLESPACE users
  NOFILENAMECHECK;
</pre>
<p>Assume that you perform backup-based duplication with a target connection, but no recovery catalog connection. Assume that you want to specify a subset of tablespaces for duplication. If the target database is not open in this scenario, then RMAN has no way to obtain the names of the tablespaces with undo segments. Thus, you must specify the <code class="codeph">UNDO TABLESPACE</code> option for these tablespaces as shown in <span><a href="rcmdupad.htm#GUID-74D9281A-691E-4657-8350-ECF90D3931F6__BGBJGECI">Example 26-6</a></span>.</p>
</div>
<!-- class="example" -->
<div class="example" id="GUID-74D9281A-691E-4657-8350-ECF90D3931F6__BGBJGECI">
<p class="titleinexample">Example 26-6 Including Specified Tablespaces</p>
<pre dir="ltr">DUPLICATE TARGET DATABASE TO dupdb
  TABLESPACE users
  UNDO TABLESPACE undotbs
  NOFILENAMECHECK;
</pre></div>
<!-- class="example" --></div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment500">
<tr>
<td class="cellalignment512">
<table class="cellalignment505">
<tr>
<td class="cellalignment504"><a href="rcmdupdb.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment504"><a href="rcmttbsb.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment514">
<table class="cellalignment503">
<tr>
<td class="cellalignment504"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment504"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment504"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment504"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment504"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment504"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>