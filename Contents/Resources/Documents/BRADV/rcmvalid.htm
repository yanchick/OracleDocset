<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-2684"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Validating%20Database%20Files%20and%20Backups"></a><title>Validating Database Files and Backups</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="validating, CDBs, PDBs"/>
<meta name="dcterms.created" content="2017-06-07T23:52:16Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Backup and Recovery User&#39;s Guide"/>
<meta name="dcterms.identifier" content="E50658-09"/>
<meta name="dcterms.isVersionOf" content="BRADV"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="rcmrepai.htm" title="Previous" type="text/html"/>
<link rel="Next" href="rcmcomre.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E50658-09.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-CC967929-9610-410D-B881-66E71353D84C"></a> <span id="PAGE" style="display:none;">28/48</span> <!-- End Header -->
<a id="BRADV90063"></a>
<h1 id="BRADV-GUID-CC967929-9610-410D-B881-66E71353D84C" class="sect1"><span class="enumeration_chapter">16</span> Validating Database Files and Backups</h1>
<div>
<p>This chapter explains how to check the integrity of database files and backups. This chapter contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmvalid.htm#GUID-B9656BE1-8D1A-47DB-A1CF-4B34EADC22D3">Overview of RMAN Validation</a></p>
</li>
<li>
<p><a href="rcmvalid.htm#GUID-044FA44E-2AEF-4BEB-A73D-EF9EA3253415">Checking for Block Corruption with the VALIDATE Command</a></p>
</li>
<li>
<p><a href="rcmvalid.htm#GUID-6BD7EA93-053E-4934-A453-6DA6726D093B">Validating Database Files with BACKUP VALIDATE</a></p>
</li>
<li>
<p><a href="rcmvalid.htm#GUID-18A4B00E-0D9B-410D-8ABB-2AC78DB99AA4">Validating Backups Before Restoring Them</a></p>
</li>
<li>
<p><a href="rcmvalid.htm#GUID-38C5D149-AA48-473F-A69A-58EF4E9F665F">Validating CDBs and PDBs</a></p>
</li>
</ul>
</div>
<a id="BRADV115"></a>
<div class="props_rev_3"><a id="GUID-B9656BE1-8D1A-47DB-A1CF-4B34EADC22D3"></a>
<h2 id="BRADV-GUID-B9656BE1-8D1A-47DB-A1CF-4B34EADC22D3" class="sect2">Overview of RMAN Validation</h2>
<div>
<p>This section explains the basic concepts and tasks involved in RMAN validation.</p>
</div>
<a id="BRADV90064"></a>
<div class="props_rev_3"><a id="GUID-89FBF3FB-6F07-492C-90EC-A03DE728D6EE"></a>
<h3 id="BRADV-GUID-89FBF3FB-6F07-492C-90EC-A03DE728D6EE" class="sect3">Purpose of RMAN Validation</h3>
<div>
<p>The main purpose of RMAN <a href="glossary.htm#GUID-A7DFFD0D-F709-43CD-BD1A-E5F08D88DB77"><span class="xrefglossterm">validation</span></a> is to check for corrupt blocks and missing files. You can also use RMAN to determine whether backups can be restored. You can use the following RMAN commands to perform validation:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">VALIDATE</code></p>
</li>
<li>
<p><code class="codeph">BACKUP ... VALIDATE</code></p>
</li>
<li>
<p><code class="codeph">RESTORE ... VALIDATE</code></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-89FBF3FB-6F07-492C-90EC-A03DE728D6EE__GUID-BF4628FC-833B-4F91-8871-94631935AF7B">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink RCMRF162" target="_blank" href="../RCMRF/rcmsynta2025.htm#RCMRF162"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">VALIDATE</code> syntax</p>
</li>
<li>
<p><a class="olink RCMRF149" target="_blank" href="../RCMRF/rcmsynta2008.htm#RCMRF149"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">RESTORE ... VALIDATE</code> syntax</p>
</li>
</ul>
</div>
</div>
</div>
<a id="BRADV90065"></a>
<div class="props_rev_3"><a id="GUID-BADB95CC-6C69-4B8B-B665-4A5A79B686B1"></a>
<h3 id="BRADV-GUID-BADB95CC-6C69-4B8B-B665-4A5A79B686B1" class="sect3">Basic Concepts of RMAN Validation</h3>
<div>
<p><a id="d68235e342" class="indexterm-anchor"></a>The <a id="d68235e347" class="indexterm-anchor"></a>database prevents operations that result in unusable backup files or corrupted restored data files. The database automatically does the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>Blocks access to data files while they are being restored or recovered</p>
</li>
<li>
<p>Permits only one restore operation for each data file at a time</p>
</li>
<li>
<p>Ensures that incremental backups are applied in the correct order</p>
</li>
<li>
<p>Stores information in backup files to allow detection of corruption</p>
</li>
<li>
<p>Checks a block every time it is read or written in an attempt to report a corruption as soon as it has been detected</p>
</li>
</ul>
</div>
<a id="BRADV89566"></a>
<div class="props_rev_3"><a id="GUID-AC61DB02-C1ED-4132-B404-E4282B88AD7C"></a>
<h4 id="BRADV-GUID-AC61DB02-C1ED-4132-B404-E4282B88AD7C" class="sect4">About Checksums and Corrupt Blocks</h4>
<div>
<p>A <a id="d68235e436" class="indexterm-anchor"></a><a href="glossary.htm#GUID-7C9E5924-57D2-401A-96F7-1EC54492EB2E"><span class="xrefglossterm">corrupt block</span></a> is a block that has been changed so that it differs from what Oracle Database expects to find. Block corruptions can be caused by several different failures including, but not limited to the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>Faulty disks and disk controllers</p>
</li>
<li>
<p>Faulty memory</p>
</li>
<li>
<p>Oracle Database software defects</p>
</li>
</ul>
<p><code class="codeph">DB_BLOCK_CHECKSUM</code> <a id="d68235e456" class="indexterm-anchor"></a>is a database initialization parameter that controls the writing of checksums for the blocks in data files and online redo log files in the database (not backups). If <code class="codeph">DB_BLOCK_CHECKSUM</code> is <code class="codeph">typical</code>, then the database computes a checksum for each block during normal operations and stores it in the header of the block before writing it to disk. When the database reads the block from disk later, it recomputes the checksum and compares it to the stored value. If the values do not match, then the block is corrupt.</p>
<p>By default, the <code class="codeph">BACKUP</code> command computes a checksum for each block and stores it in the backup. The <code class="codeph">BACKUP</code> command ignores the values of <code class="codeph">DB_BLOCK_CHECKSUM</code> because this initialization parameter applies to data files in the database, not backups.</p>
</div>
</div>
<a id="BRADV991"></a>
<div class="props_rev_3"><a id="GUID-01E155AC-7665-4B81-8C99-DE65EB688C6C"></a>
<h4 id="BRADV-GUID-01E155AC-7665-4B81-8C99-DE65EB688C6C" class="sect4">About Physical and Logical Block Corruption</h4>
<div>
<p>In a <a id="d68235e546" class="indexterm-anchor"></a><a href="glossary.htm#GUID-6035D1EA-C660-4F45-B1AC-FE6B15810C54"><span class="xrefglossterm">physical corruption</span></a>, which is also called a media corruption, the database does not recognize the block at all: the <a href="glossary.htm#GUID-36837841-FB21-45C7-A99A-FFC35D04FB0B"><span class="xrefglossterm">checksum</span></a> is invalid, the block contains all zeros, or the header and footer of the block do not match.</p>
<div class="infobox-note" id="GUID-01E155AC-7665-4B81-8C99-DE65EB688C6C__GUID-AE3CF202-AA4C-4E7E-A07F-CE43AB9CDD08">
<p class="notep1">Note:</p>
<p>By default, the <code class="codeph">BACKUP</code> command computes a checksum for each block and stores it in the backup. If you specify the <code class="codeph">NOCHECKSUM</code> option, then RMAN does not perform a checksum of the blocks when creating the backup.</p>
</div>
<p>In a <a id="d68235e567" class="indexterm-anchor"></a><a href="glossary.htm#GUID-E55A74E5-8AD7-478F-A458-E4CB2E389009"><span class="xrefglossterm">logical corruption</span></a>, the contents of the block are logically inconsistent. Examples of logical corruption include corruption of a row piece or index entry. If RMAN detects logical corruption, then it logs the block in the alert log and server session trace file.</p>
<p>By default, RMAN does not check for logical corruption. If you specify <code class="codeph">CHECK LOGICAL</code> on the <code class="codeph">BACKUP</code> command, however, then RMAN tests data and index blocks for logical corruption, such as corruption of a row piece or index entry, and log them in the alert log located in the <a id="d68235e581" class="indexterm-anchor"></a><a href="glossary.htm#GUID-BDCE90D1-13B7-4D2C-A761-1583A238A247"><span class="xrefglossterm">Automatic Diagnostic Repository (ADR)</span></a>. If you use RMAN with the following configuration when backing up or restoring files, then it detects all types of block corruption that are possible to detect:</p>
<ul style="list-style-type: disc;">
<li>
<p>In the initialization parameter file of a database, set <code class="codeph">DB_BLOCK_CHECKSUM=typical</code> so that the database calculates data file checksums automatically (not for backups, but for data files in use by the database)</p>
</li>
<li>
<p>Do not precede the <code class="codeph">BACKUP</code> command with <code class="codeph">SET MAXCORRUPT</code> so that RMAN does not tolerate any unmarked block corruptions.</p>
</li>
<li>
<p>In a <code class="codeph">BACKUP</code> command, do <span class="italic">not</span> specify the <code class="codeph">NOCHECKSUM</code> option so that RMAN calculates a checksum when writing backups</p>
</li>
<li>
<p>In <code class="codeph">BACKUP</code> and <code class="codeph">RESTORE</code> commands, specify the <code class="codeph">CHECK</code> <code class="codeph">LOGICAL</code> option so that RMAN checks for logical and physical corruption</p>
</li>
</ul>
</div>
</div>
<a id="BRADV89567"></a>
<div class="props_rev_3"><a id="GUID-AB58202A-2674-46A7-937C-12AF482684F1"></a>
<h4 id="BRADV-GUID-AB58202A-2674-46A7-937C-12AF482684F1" class="sect4">About Limits for Corrupt Blocks in RMAN Backups</h4>
<div>
<p><a id="d68235e700" class="indexterm-anchor"></a>You can use the <code class="codeph">SET MAXCORRUPT</code> command to set the total number of unmarked corruptions permitted in a file for RMAN backups. The default is zero, meaning that RMAN does not tolerate unmarked corrupt blocks of any kind.</p>
<p>If the <code class="codeph">MAXCORRUPT</code> limit is exceeded when RMAN encounters an unmarked corrupt block during a backup, then RMAN terminates the backup. Otherwise, RMAN writes the newly detected corrupt block to the backup with a special header indicating that the block is marked corrupt. You can use the <code class="codeph">VALIDATE</code> command to determine which blocks are marked as corrupt and to find any unmarked corrupt blocks.</p>
<p>Because RMAN allows marked corrupt blocks in a backup, and because RMAN can be instructed to allow unmarked corrupt blocks to be marked as corrupt in the backup (when <code class="codeph">MAXCORRUPT</code> is used), it is possible to restore a data file that has several blocks marked as corrupt. If you backup this restored data file (assuming no new corruptions have happened), even without <code class="codeph">MAXCORRUPT</code> setting, the backup succeeds. This is because the previously marked corruptions do not stop RMAN from completing the backup.</p>
<div class="infoboxnotealso" id="GUID-AB58202A-2674-46A7-937C-12AF482684F1__GUID-B399F994-1A8C-4F95-B7A7-8F42AB5F119D">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF153" target="_blank" href="../RCMRF/rcmsynta2014.htm#RCMRF153"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">SET</code> <code class="codeph">MAXCORRUPT</code> syntax</p>
</div>
</div>
</div>
<a id="BRADV336"></a><a id="BRADV994"></a>
<div class="props_rev_3"><a id="GUID-C9F93B27-D13F-465D-A32C-CF6B092CE2F0"></a>
<h4 id="BRADV-GUID-C9F93B27-D13F-465D-A32C-CF6B092CE2F0" class="sect4">About Detecting Block Corruption</h4>
<div>
<p>Oracle Database supports different techniques for detecting, repairing, and monitoring block corruption. The technique depends on whether the corruption is <a href="glossary.htm#GUID-8D895C8A-D749-48C1-92A6-A31D5BFCFE4D"><span class="xrefglossterm">interblock corruption</span></a> or <a href="glossary.htm#GUID-F0CE8BEB-71A3-4313-ABEF-244E6C8BCC05"><span class="xrefglossterm">intrablock corruption</span></a>. In intrablock corruption, the corruption occurs within the block itself. This corruption can be either physical or logical. In an interblock corruption, the corruption occurs between blocks and can only be logical.</p>
<p>For example, <a id="d68235e818" class="indexterm-anchor"></a>the <a class="olink REFRN30048" target="_blank" href="../REFRN/GUID-6CA088AF-B7B0-4CA1-8DC6-95372368BACC.htm#REFRN30048"><code class="codeph">V$DATABASE_BLOCK_CORRUPTION</code></a> view records intrablock corruptions, while the <a id="d68235e826" class="indexterm-anchor"></a><a href="glossary.htm#GUID-BDCE90D1-13B7-4D2C-A761-1583A238A247"><span class="xrefglossterm">Automatic Diagnostic Repository (ADR)</span></a> tracks all types of corruptions. <a id="d68235e832" class="indexterm-anchor"></a><a id="d68235e836" class="indexterm-anchor"></a><a id="d68235e840" class="indexterm-anchor"></a><a href="rcmvalid.htm#GUID-C9F93B27-D13F-465D-A32C-CF6B092CE2F0__CHDEICIB" title="Describes how the database handles block corruption.">Table 16-1</a> summarizes how the database treats different types of block corruption.</p>
<div class="tblformalwide" id="GUID-C9F93B27-D13F-465D-A32C-CF6B092CE2F0__CHDEICIB">
<p class="titleintable">Table 16-1 Detection, Repair, and Monitoring of Block Corruption</p>
<table class="cellalignment553" title="Detection, Repair, and Monitoring of Block Corruption" summary="Describes how the database handles block corruption.">
<thead>
<tr class="cellalignment501">
<th class="cellalignment531" id="d68235e863">Response</th>
<th class="cellalignment564" id="d68235e866">Intrablock Corruption</th>
<th class="cellalignment564" id="d68235e869">Interblock Corruption</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment501">
<td class="cellalignment534" id="d68235e874" headers="d68235e863">
<p>Detection</p>
</td>
<td class="cellalignment565" headers="d68235e874 d68235e866">
<p>All database utilities detect intrablock corruption, including RMAN (for example, the <code class="codeph">BACKUP</code> command) and the DBVERIFY utility. If a database process can encounter the <code class="codeph">ORA-1578</code> error, then it can detect the corruption and monitor it.</p>
</td>
<td class="cellalignment565" headers="d68235e874 d68235e869">
<p>Only DBVERIFY and the <code class="codeph">ANALYZE</code> statement detect interblock corruption.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment534" id="d68235e893" headers="d68235e863">
<p>Tracking</p>
</td>
<td class="cellalignment565" headers="d68235e893 d68235e866">
<p>The <code class="codeph">V$DATABASE_BLOCK_CORRUPTION</code> view displays blocks marked corrupt by Oracle Database components such as RMAN commands, <code class="codeph">ANALYZE</code>, SQL queries, and so on. Any process that encounters an intrablock corruption records the block corruption in this view and in ADR.</p>
</td>
<td class="cellalignment565" headers="d68235e893 d68235e869">
<p>The database monitors this type of block corruption in ADR.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment534" id="d68235e909" headers="d68235e863">
<p>Repair</p>
</td>
<td class="cellalignment565" headers="d68235e909 d68235e866">
<p>Repair techniques include <a id="d68235e915" class="indexterm-anchor"></a><a href="glossary.htm#GUID-923A509A-1C36-4EA4-91C8-6E4F372722C0"><span class="xrefglossterm">block media recovery</span></a>, restoring data files, recovering with incremental backups, and block newing. Block media recovery can repair physical corruptions, but not logical corruptions.</p>
<p>Any RMAN command that fixes or detects that a block is repaired updates <code class="codeph">V$DATABASE_BLOCK_CORRUPTION</code>. For example, RMAN updates the repository at end of successful block media recovery. If a <code class="codeph">BACKUP</code>, <code class="codeph">RESTORE</code>, or <code class="codeph">VALIDATE</code> command detects that a block is no longer corrupted, then it removes the repaired block from the view.</p>
</td>
<td class="cellalignment565" headers="d68235e909 d68235e869">
<p>You must fix interblock corruption using manual techniques such as dropping an object, rebuilding an index, and so on.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="infoboxnotealso" id="GUID-C9F93B27-D13F-465D-A32C-CF6B092CE2F0__GUID-2850888D-BB01-48E6-818A-33C79E0F4709">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmcomre.htm#GUID-D908719C-9D46-4084-850C-0F81C25094EB">Performing Complete Database Recovery</a></p>
</li>
<li>
<p><a href="rcmblock.htm#GUID-1E226393-17D0-4AB0-A05D-91210255D8FF">Performing Block Media Recovery</a></p>
</li>
<li>
<p><a class="olink ADMIN11257" target="_blank" href="../ADMIN/diag.htm#ADMIN11257"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> to learn about ADR</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<a id="BRADV337"></a><a id="BRADV613"></a><a id="BRADV338"></a><a id="BRADV89563"></a>
<div class="props_rev_3"><a id="GUID-044FA44E-2AEF-4BEB-A73D-EF9EA3253415"></a>
<h2 id="BRADV-GUID-044FA44E-2AEF-4BEB-A73D-EF9EA3253415" class="sect2">Checking for Block Corruption with the VALIDATE Command</h2>
<div>
<div class="section">
<p><a id="d68235e1030" class="indexterm-anchor"></a><a id="d68235e1036" class="indexterm-anchor"></a><a id="d68235e1040" class="indexterm-anchor"></a><a id="d68235e1044" class="indexterm-anchor"></a><a id="d68235e1048" class="indexterm-anchor"></a><a id="d68235e1052" class="indexterm-anchor"></a><a id="d68235e1056" class="indexterm-anchor"></a><a id="d68235e1060" class="indexterm-anchor"></a><a id="d68235e1066" class="indexterm-anchor"></a><a id="d68235e1072" class="indexterm-anchor"></a><a id="d68235e1078" class="indexterm-anchor"></a><a id="d68235e1083" class="indexterm-anchor"></a><a id="d68235e1087" class="indexterm-anchor"></a><a id="d68235e1091" class="indexterm-anchor"></a><a id="d68235e1095" class="indexterm-anchor"></a>You can use the <a class="olink RCMRF162" target="_blank" href="../RCMRF/rcmsynta2025.htm#RCMRF162"><code class="codeph">VALIDATE</code></a> command to manually check for physical and logical corruptions in database files. This command performs the same types of checks as<a id="d68235e1105" class="indexterm-anchor"></a><a id="d68235e1107" class="indexterm-anchor"></a><a id="d68235e1111" class="indexterm-anchor"></a> <code class="codeph">BACKUP VALIDATE</code>, but <code class="codeph">VALIDATE</code> can check a larger selection of objects. For example, you can validate individual blocks with the <code class="codeph">VALIDATE DATAFILE ... BLOCK</code> command.</p>
<p>When validating whole files, RMAN checks every block of the input files. If the backup validation discovers previously unmarked corrupt blocks, then RMAN updates the <a id="d68235e1128" class="indexterm-anchor"></a><a id="d68235e1132" class="indexterm-anchor"></a><a id="d68235e1134" class="indexterm-anchor"></a><code class="codeph">V$DATABASE_BLOCK_CORRUPTION</code> view with rows describing the corruptions.</p>
<p>Use <code class="codeph">VALIDATE BACKUPSET</code> when you suspect that one or more backup pieces in a backup set are missing or have been damaged. This command checks every block in a backup set to ensure that the backup can be restored. If RMAN finds block corruption, then it issues an error and terminates the validation. The command <code class="codeph">VALIDATE BACKUPSET</code> enables you to choose which backups to check, whereas the <code class="codeph">VALIDATE</code> option of the <code class="codeph">RESTORE</code> command lets RMAN choose.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">To use VALIDATE to check database files and backups:</p>
</div>
<!-- class="section" -->
<div class="section">
<ol>
<li>
<p>Start RMAN and connect to a target database.</p>
<div class="infoboxnotealso" id="GUID-044FA44E-2AEF-4BEB-A73D-EF9EA3253415__GUID-5425CB18-E8EB-4A55-82EB-8E27F1642EAC">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmcnctg.htm#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C">Making Database Connections with RMAN</a>&#34;</span></p>
</div>
</li>
<li>
<p>Execute the <code class="codeph">VALIDATE</code> command with the desired options.</p>
<p>For example, to validate all data files and control files (and the server parameter file if one is in use), execute the following command at the RMAN prompt:</p>
<pre dir="ltr">RMAN&gt; VALIDATE DATABASE;
</pre>
<p>Alternatively, you can validate a particular backup set by using the form of the command shown in the following example (sample output included).</p>
<pre dir="ltr">RMAN&gt; VALIDATE BACKUPSET 22;

Starting validate at 17-AUG-13
using channel ORA_DISK_1
allocated channel: ORA_SBT_TAPE_1
channel ORA_SBT_TAPE_1: SID=89 device type=SBT_TAPE
channel ORA_SBT_TAPE_1: Oracle Secure Backup
channel ORA_DISK_1: starting validation of datafile backup set
channel ORA_DISK_1: reading from backup piece
/disk1/oracle/work/orcva/RDBMS/backupset/2013_08_16/o1_mf_nnndf_
TAG20130816T153034_2g774bt2_.bkp
channel ORA_DISK_1: piece
handle=/disk1/oracle/work/orcva/RDBMS/backupset/2013_08_16/o1_mf_nnndf_
TAG20130816T153034_2g774bt2_.bkp tag=TAG20130816T153034
channel ORA_DISK_1: restored backup piece 1
channel ORA_DISK_1: validation complete, elapsed time: 00:00:01
Finished validate at 17-AUG-13
</pre>
<p>The following example illustrates how you can check individual <a id="d68235e1183" class="indexterm-anchor"></a>data blocks within a data file for corruption.</p>
<pre dir="ltr">RMAN&gt; VALIDATE DATAFILE 1 BLOCK 10;
 
Starting validate at 17-AUG-13
using channel ORA_DISK_1
channel ORA_DISK_1: starting validation of datafile
channel ORA_DISK_1: specifying datafile(s) for validation
input datafile file number=00001 name=/disk1/oracle/dbs/tbs_01.f
channel ORA_DISK_1: validation complete, elapsed time: 00:00:01
List of Datafiles
=================
File Status Marked Corrupt Empty Blocks Blocks Examined High SCN
---- ------ -------------- ------------ --------------- ----------
1    OK     0              2            127             481907
  File Name: /disk1/oracle/dbs/tbs_01.f
  Block Type Blocks Failing Blocks Processed
  ---------- -------------- ----------------
  Data       0              36
  Index      0              31
  Other      0              58

Finished validate at 17-AUG-13
</pre></li>
</ol>
</div>
<!-- class="section" -->
<div class="section" id="GUID-044FA44E-2AEF-4BEB-A73D-EF9EA3253415__CHDDJJAI">
<p class="subhead2">Make Parallel the Validation of a Data File</p>
</div>
<!-- class="section" -->
<div class="section">
<p><a id="d68235e1193" class="indexterm-anchor"></a><a id="d68235e1197" class="indexterm-anchor"></a>If you must validate a large data file, then RMAN can make the work parallel by dividing the file into sections and processing each <a id="d68235e1200" class="indexterm-anchor"></a><a href="glossary.htm#GUID-FDECFF77-1833-4BD3-A23C-AA4806E28241"><span class="xrefglossterm">file section</span></a> in parallel. If multiple channels are configured or allocated, and if you want the channels to make parallel the validation, then specify <a id="d68235e1206" class="indexterm-anchor"></a>the <code class="codeph">SECTION SIZE</code> parameter of the <code class="codeph">VALIDATE</code> command.</p>
<p>If you specify a section size that is larger than the size of the file, then RMAN does not create file sections. If you specify a small section size that would produce more than 256 sections, then RMAN increases the section size to a value that results in exactly 256 sections.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">To make parallel the validation of a data file:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to a target database. The target database must be mounted or open.</span></li>
<li class="stepexpand"><span>Run <code class="codeph">VALIDATE</code> with the <code class="codeph">SECTION SIZE</code> parameter.</span>
<div>
<p>The following example allocates two channels and validates a large data file. The section size is 1200 MB.</p>
<pre dir="ltr">RUN
{
  ALLOCATE CHANNEL c1 DEVICE TYPE DISK;
  ALLOCATE CHANNEL c2 DEVICE TYPE DISK;
  VALIDATE DATAFILE 1 SECTION SIZE 1200M;
}
</pre></div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-044FA44E-2AEF-4BEB-A73D-EF9EA3253415__GUID-DF933C00-C1F8-459A-B8EA-8A76045853FC">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="rcmbckad.htm#GUID-F2D9FF2D-9E1C-4D38-AD8E-88B6B32F02B4">Dividing the Backup of a Large Data File into Sections</a>&#34;</span></p>
</li>
<li>
<p><a class="olink RCMRF162" target="_blank" href="../RCMRF/rcmsynta2025.htm#RCMRF162"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> to learn about the <code class="codeph">VALIDATE</code> command</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV339"></a><a id="BRADV89562"></a>
<div class="props_rev_3"><a id="GUID-6BD7EA93-053E-4934-A453-6DA6726D093B"></a>
<h2 id="BRADV-GUID-6BD7EA93-053E-4934-A453-6DA6726D093B" class="sect2">Validating Database Files with BACKUP VALIDATE</h2>
<div>
<div class="section">
<p><a id="d68235e1331" class="indexterm-anchor"></a><a id="d68235e1337" class="indexterm-anchor"></a><a id="d68235e1341" class="indexterm-anchor"></a><a id="d68235e1345" class="indexterm-anchor"></a><a id="d68235e1349" class="indexterm-anchor"></a><a id="d68235e1353" class="indexterm-anchor"></a><a id="d68235e1357" class="indexterm-anchor"></a><a id="d68235e1363" class="indexterm-anchor"></a><a id="d68235e1369" class="indexterm-anchor"></a><a id="d68235e1375" class="indexterm-anchor"></a><a id="d68235e1379" class="indexterm-anchor"></a><a id="d68235e1384" class="indexterm-anchor"></a><a id="d68235e1388" class="indexterm-anchor"></a><a id="d68235e1392" class="indexterm-anchor"></a>You can use the <code class="codeph">BACKUP VALIDATE</code> command to do the following:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Check data files for physical and logical block corruption</p>
</li>
<li>
<p>Confirm that all database files exist and are in the correct locations</p>
</li>
</ul>
<p>When you run <code class="codeph">BACKUP VALIDATE</code>, RMAN reads the files to be backed up in their entirety, as it does during a real backup. RMAN does not, however, actually produce any backup sets or image copies.</p>
<p>You cannot use the <code class="codeph">BACKUPSET</code>, <code class="codeph">MAXCORRUPT</code>, or <code class="codeph">PROXY</code> parameters with <code class="codeph">BACKUP VALIDATE</code>. To validate specific backup sets, run the <code class="codeph">VALIDATE</code> command.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">To validate files with the BACKUP VALIDATE command:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to a target database and recovery catalog (if used).</span></li>
<li class="stepexpand"><span>Run the <code class="codeph">BACKUP VALIDATE</code> command.</span>
<div>
<p>For example, you can validate that all database files and archived logs can be backed up by running a command as shown in the following example. This command checks for physical corruptions only.</p>
<pre dir="ltr">BACKUP VALIDATE 
  DATABASE 
  ARCHIVELOG ALL;
</pre>
<p>To check for logical corruptions in addition to physical corruptions, run the following variation of the preceding command:</p>
<pre dir="ltr">BACKUP VALIDATE 
  CHECK LOGICAL 
  DATABASE 
  ARCHIVELOG ALL;
</pre>
<p>In the preceding examples, the RMAN client displays the same output as when really backing up the files. If RMAN cannot back up one or more of the files, then it issues an error message. For example, RMAN may show output similar to the following:</p>
<pre dir="ltr">RMAN-00571: ===========================================================
RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS ===============
RMAN-00571: ===========================================================
RMAN-03002: failure of backup command at 08/29/2013 14:33:47
ORA-19625: error identifying file /oracle/oradata/trgt/arch/archive1_6.dbf
ORA-27037: unable to obtain file status
SVR4 Error: 2: No such file or directory
Additional information: 3
</pre></div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-6BD7EA93-053E-4934-A453-6DA6726D093B__GUID-E0DE2F03-0410-4A85-9F5A-A477C28FACCE">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink RCMRF107" target="_blank" href="../RCMRF/rcmsynta006.htm#RCMRF107"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">BACKUP</code> syntax</p>
</li>
<li>
<p><a href="rcmblock.htm#GUID-1E226393-17D0-4AB0-A05D-91210255D8FF">Performing Block Media Recovery</a> to learn how to repair corrupt blocks discovered by <code class="codeph">BACKUP</code> <code class="codeph">VALIDATE</code></p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV340"></a><a id="BRADV8156"></a>
<div class="props_rev_3"><a id="GUID-18A4B00E-0D9B-410D-8ABB-2AC78DB99AA4"></a>
<h2 id="BRADV-GUID-18A4B00E-0D9B-410D-8ABB-2AC78DB99AA4" class="sect2">Validating Backups Before Restoring Them</h2>
<div>
<div class="section">
<p><a id="d68235e1551" class="indexterm-anchor"></a>You can run <code class="codeph">RESTORE</code> <code class="codeph">...</code> <code class="codeph">VALIDATE</code> to test whether RMAN can restore a specific file or set of files from a backup. RMAN chooses which backups to use.</p>
<p>The database must be mounted or open for this command. You do not have to take data files offline when validating the restore of data files, because validation of backups of the data files only reads the backups and does not affect the production data files.</p>
<p>When validating files on disk or tape, RMAN reads all blocks in the backup piece or image copy. RMAN also validates offsite backups. The validation is identical to a real restore operation except that RMAN does not write output files.</p>
<div class="infobox-note" id="GUID-18A4B00E-0D9B-410D-8ABB-2AC78DB99AA4__GUID-B4246061-54BF-43AF-8430-0AEFF88084DE">
<p class="notep1">Note:</p>
<p>As an additional test measure, you can perform a <a id="d68235e1572" class="indexterm-anchor"></a><a href="glossary.htm#GUID-20FF4FE0-3ABD-4773-A857-6CF062C7D028"><span class="xrefglossterm">trial recovery</span></a> with <a id="d68235e1578" class="indexterm-anchor"></a>the <code class="codeph">RECOVER ... TEST</code> command. A trial recovery applies redo in a way similar to normal recovery, but it is in memory only and it rolls back its changes after the trial.</p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">To validate backups with the RESTORE command:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Run the <code class="codeph">RESTORE</code> command with the <code class="codeph">VALIDATE</code> option.</span>
<div>
<p>This following example illustrates validating the restore of the database and all archived redo logs:</p>
<pre dir="ltr">RESTORE DATABASE VALIDATE;
RESTORE ARCHIVELOG ALL VALIDATE;
</pre>
<p>If you do <span class="italic">not</span> see an RMAN error stack, then skip the subsequent steps. The lack of error messages means that RMAN had confirmed that it can use these backups successfully during a real restore and recovery.</p>
</div>
</li>
<li class="stepexpand"><span>If you see error messages in the output and the <code class="codeph">RMAN-06026</code> message, then investigate the cause of the problem. If possible, correct the problem that is preventing RMAN from validating the backups and retry the validation.</span>
<div>
<p>The following error means that RMAN cannot restore one or more of the specified files from your available backups:</p>
<pre dir="ltr">RMAN-06026: some targets not found - aborting restore
</pre>
<p>The following sample output shows that RMAN encountered a problem reading the specified backup:</p>
<pre dir="ltr">RMAN-03009: failure of restore command on c1 channel at 12-DEC-12 23:22:30
ORA-19505: failed to identify file &#34;oracle/dbs/1fafv9gl_1_1&#34;
ORA-27037: unable to obtain file status
SVR4 Error: 2: No such file or directory
Additional information: 3
</pre></div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-18A4B00E-0D9B-410D-8ABB-2AC78DB99AA4__GUID-74D0C130-60D7-4280-B4C9-54FD839256EF">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF149" target="_blank" href="../RCMRF/rcmsynta2008.htm#RCMRF149"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> to learn about the <code class="codeph">RESTORE ... VALIDATE</code> command</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV635"></a>
<div class="props_rev_3"><a id="GUID-38C5D149-AA48-473F-A69A-58EF4E9F665F"></a>
<h2 id="BRADV-GUID-38C5D149-AA48-473F-A69A-58EF4E9F665F" class="sect2">Validating CDBs and PDBs</h2>
<div>
<p>RMAN enables you to validate multitenant container databases (<a href="glossary.htm#GUID-3D253996-C2C0-449A-AFA2-85A9DA323FD3"><span class="xrefglossterm">CDB</span></a>s) and pluggable databases (<a href="glossary.htm#GUID-993BFB3F-3305-481C-999D-26132095DEC9"><span class="xrefglossterm">PDB</span></a>s). All of the procedures in this chapter apply to CDBs, with the differences described in the following sections:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmvalid.htm#GUID-3875BD93-150E-410B-B5B5-0AB4D1061759">Validating a Whole CDB</a></p>
</li>
<li>
<p><a href="rcmvalid.htm#GUID-83212DB5-4D0F-4EC0-950C-985FC053263E">Validating PDBs</a></p>
</li>
</ul>
</div>
<a id="BRADV744"></a>
<div class="props_rev_3"><a id="GUID-3875BD93-150E-410B-B5B5-0AB4D1061759"></a>
<h3 id="BRADV-GUID-3875BD93-150E-410B-B5B5-0AB4D1061759" class="sect3">Validating a Whole CDB</h3>
<div>
<div class="section">
<p>The steps to validate a CDB are similar to the ones used to validate a <a href="glossary.htm#GUID-62A96A52-3B97-455A-A443-75B999DCAC94"><span class="xrefglossterm">non-CDB</span></a>. The only difference is that you must connect to the <a href="glossary.htm#GUID-EA3DB8F4-F68E-4FC5-A599-32A4886FFF8A"><span class="xrefglossterm">root</span></a> as a <a href="glossary.htm#GUID-2B102186-15BD-443C-B375-8CB0D442CF5F"><span class="xrefglossterm">common user</span></a> with the common <code class="codeph">SYSBACKUP</code> or <code class="codeph">SYSDBA</code> privilege. Then, use the <code class="codeph">VALIDATE DATABASE</code> and <code class="codeph">RESTORE DATABASE VALIDATE</code> commands.</p>
<div class="infoboxnotealso" id="GUID-3875BD93-150E-410B-B5B5-0AB4D1061759__GUID-5F233E57-1CD3-43A6-B139-F855D0B048D0">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmcnctg.htm#GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD">Making RMAN Connections to a CDB</a>&#34;</span></p>
</div>
<p>The following command, when connected to the root, validates the whole CDB:</p>
<pre dir="ltr">VALIDATE DATABASE;
</pre>
<p>The following command validates the root:</p>
<pre dir="ltr">VALIDATE DATABASE ROOT;
</pre></div>
<!-- class="section" --></div>
</div>
<a id="BRADV745"></a>
<div class="props_rev_3"><a id="GUID-83212DB5-4D0F-4EC0-950C-985FC053263E"></a>
<h3 id="BRADV-GUID-83212DB5-4D0F-4EC0-950C-985FC053263E" class="sect3">Validating PDBs</h3>
<div>
<div class="section">
<p>Use one of the following techniques to validate PDBs:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Connect to the root and use the <code class="codeph">VALIDATE PLUGGABLE DATABASE</code> or <code class="codeph">RESTORE PLUGGABLE DATABASE VALIDATE</code> command. This enables you to validate one or more PDBs.</p>
<p>The following command, when connected to the root, validates the PDBs <code class="codeph">hr_pdb</code> and <code class="codeph">sales_pdb</code>.</p>
<pre dir="ltr">VALIDATE PLUGGABLE DATABASE hr_pdb, sales_pdb;
</pre></li>
<li>
<p>Connect to the PDB and use the <code class="codeph">VALIDATE DATABASE</code> and <code class="codeph">RESTORE DATABASE VALIDATE</code> commands to validate only one PDB. The commands used here are the same commands that you would use for a non-CDB.</p>
<p>The following command, when connected to a PDB, validates the restore of the database.</p>
<pre dir="ltr">RESTORE DATABASE VALIDATE;
</pre></li>
</ul>
<div class="infoboxnotealso" id="GUID-83212DB5-4D0F-4EC0-950C-985FC053263E__GUID-4A45786F-3945-440E-80EC-A6889A183F4D">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmcnctg.htm#GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD">Making RMAN Connections to a CDB</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment500">
<tr>
<td class="cellalignment512">
<table class="cellalignment505">
<tr>
<td class="cellalignment504"><a href="rcmrepai.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment504"><a href="rcmcomre.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment514">
<table class="cellalignment503">
<tr>
<td class="cellalignment504"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment504"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment504"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment504"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment504"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment504"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>