<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-2677"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Reporting%20on%20RMAN%20Operations"></a><title>Reporting on RMAN Operations</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="CDBs, reporting, reporting, in CDBs, PDBs, in PDBs, LIST command, commands, Recovery Manager, LIST, Data Recovery Advisor, backups, generating reports for, reports, RMAN, REPORT, Recovery Manager, reports, REPORT command"/>
<meta name="dcterms.created" content="2017-06-07T23:52:16Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Backup and Recovery User&#39;s Guide"/>
<meta name="dcterms.identifier" content="E50658-09"/>
<meta name="dcterms.isVersionOf" content="BRADV"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="part_mai.htm" title="Previous" type="text/html"/>
<link rel="Next" href="rcmmaint.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E50658-09.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-550638CC-0D16-4B1A-83C7-5D10181DC7C1"></a> <span id="PAGE" style="display:none;">22/48</span> <!-- End Header -->
<a id="BRADV8004"></a>
<h1 id="BRADV-GUID-550638CC-0D16-4B1A-83C7-5D10181DC7C1" class="sect1"><span class="enumeration_chapter">11</span> Reporting on RMAN Operations</h1>
<div>
<p><a id="d48989e67" class="indexterm-anchor"></a><a id="d48989e71" class="indexterm-anchor"></a><a id="d48989e73" class="indexterm-anchor"></a>This chapter describes how to report on RMAN operations. This chapter contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmreprt.htm#GUID-AAAE5ACE-EE63-4AD1-8F63-B0F4F6F1D1B2">Overview of RMAN Reporting</a></p>
</li>
<li>
<p><a href="rcmreprt.htm#GUID-1B911001-C106-4267-9265-F649946DBF52" title="The primary purpose of the LIST command is to list backup and copies.">Listing Backups and Recovery-Related Objects</a></p>
</li>
<li>
<p><a href="rcmreprt.htm#GUID-A1FDD9FE-74B8-4146-AFC4-6BD5402C8B5D" title="The REPORT command provides various reports of RMAN backups.">Reporting on Backups and Database Schema</a></p>
</li>
<li>
<p><a href="rcmreprt.htm#GUID-9E60E2AC-6667-49B5-9D31-6480BEF026B9">Using V$ Views to Query Backup Metadata</a></p>
</li>
<li>
<p><a href="rcmreprt.htm#GUID-C48F1F48-E11D-4DA4-AB54-6D7EB4CA8957">Querying Recovery Catalog Views</a></p>
</li>
</ul>
</div>
<a id="BRADV8135"></a>
<div class="props_rev_3"><a id="GUID-AAAE5ACE-EE63-4AD1-8F63-B0F4F6F1D1B2"></a>
<h2 id="BRADV-GUID-AAAE5ACE-EE63-4AD1-8F63-B0F4F6F1D1B2" class="sect2">Overview of RMAN Reporting</h2>
<div>
<p>This section explains the purpose and basic concepts of RMAN reporting.</p>
</div>
<a id="BRADV89582"></a>
<div class="props_rev_3"><a id="GUID-0FC15229-684C-4279-8E60-CC0B4079FB5F"></a>
<h3 id="BRADV-GUID-0FC15229-684C-4279-8E60-CC0B4079FB5F" class="sect3">Purpose of RMAN Reporting</h3>
<div>
<p>As part of your backup and recovery strategy, you should periodically run reports that indicate what you have backed up. You can determine which data files need backups or which files were not backed up recently. Also, you can preview which backups RMAN must restore if a problem occurs.</p>
<p>Another important aspect of backup and recovery is monitoring space usage. If you back up to disk, then it is possible for the disk to fill, which can create performance problems or even cause the database to halt. You can use RMAN to determine whether a backup is an <a href="glossary.htm#GUID-A4D8B0BE-D3B9-4DD9-A7B3-BC0D88D25DC0"><span class="xrefglossterm">obsolete backup</span></a> and can therefore be deleted.</p>
<p>You may also need to obtain historical information about RMAN jobs. For example, you may want to know how many backup jobs have been issued, the status of each backup job (for example, whether it failed or completed), when a job started and finished, and what type of backup was performed.</p>
</div>
</div>
<a id="BRADV89583"></a>
<div class="props_rev_3"><a id="GUID-1C655AF1-B3CD-452C-BC3C-A566912311FF"></a>
<h3 id="BRADV-GUID-1C655AF1-B3CD-452C-BC3C-A566912311FF" class="sect3">Basic Concepts of RMAN Reporting</h3>
<div>
<p>RMAN always stores its <a href="glossary.htm#GUID-F5643EDD-CE1B-4A9F-9E6E-ADDFD6452341"><span class="xrefglossterm">RMAN repository</span></a> of metadata in the control file of each target database on which it performs operations. For example, suppose that you use RMAN to back up the <code class="codeph">prod1</code> and <code class="codeph">prod2</code> databases. RMAN stores the metadata for backups of <code class="codeph">prod1</code> in the control file of <code class="codeph">prod1</code>, and the metadata for backups of <code class="codeph">prod2</code> in the control file of <code class="codeph">prod2</code>.</p>
<p>Optionally, you can use RMAN with a <a href="glossary.htm#GUID-CBFA8015-2DFF-42B1-A818-D6C5B92C608F"><span class="xrefglossterm">recovery catalog</span></a>. In this case, RMAN maintains an additional repository of metadata in a set of tables in a separate <a href="glossary.htm#GUID-C54D9858-2461-412B-95FF-80FBACD58AB0"><span class="xrefglossterm">recovery catalog database</span></a>. For example, you could create a recovery catalog in <code class="codeph">prod3</code>. You can register multiple target databases in this recovery catalog. For example, if you register <code class="codeph">prod1</code> and <code class="codeph">prod2</code> in the recovery catalog stored in <code class="codeph">prod3</code>, then RMAN stores metadata about its backups of <code class="codeph">prod1</code> and <code class="codeph">prod2</code> in the <a href="glossary.htm#GUID-3EF7A531-FA6D-483B-AE34-F87D31DCE572"><span class="xrefglossterm">recovery catalog schema</span></a>.</p>
<p>You can access metadata from the RMAN repository in several different ways:</p>
<ul style="list-style-type: disc;">
<li>
<p><a id="d48989e393" class="indexterm-anchor"></a><a id="d48989e397" class="indexterm-anchor"></a><a id="d48989e399" class="indexterm-anchor"></a><a id="d48989e403" class="indexterm-anchor"></a><a id="d48989e405" class="indexterm-anchor"></a>The RMAN <code class="codeph">LIST</code> and <code class="codeph">REPORT</code> commands provide extensive information about available backups and how they can be used to restore and recover your database.</p>
<p>The <code class="codeph">LIST</code> command is described in <span class="q">&#34;<a href="rcmreprt.htm#GUID-1B911001-C106-4267-9265-F649946DBF52" title="The primary purpose of the LIST command is to list backup and copies.">Listing Backups and Recovery-Related Objects</a>&#34;</span> and <code class="codeph">REPORT</code> is described in <span class="q">&#34;<a href="rcmreprt.htm#GUID-A1FDD9FE-74B8-4146-AFC4-6BD5402C8B5D" title="The REPORT command provides various reports of RMAN backups.">Reporting on Backups and Database Schema</a>&#34;</span>.</p>
</li>
<li>
<p>When the database is open, several <code class="codeph">V$</code> views provide direct access to RMAN repository records in the control file of each target database.</p>
<p>Some <code class="codeph">V$</code> views such <a id="d48989e455" class="indexterm-anchor"></a><a id="d48989e457" class="indexterm-anchor"></a><a id="d48989e459" class="indexterm-anchor"></a>as <code class="codeph">V$DATAFILE_HEADER</code>, <code class="codeph">V$PROCESS</code>, and <code class="codeph">V$SESSION</code> contain information not found in the recovery catalog views. The <code class="codeph">V$</code> views are documented in <a class="olink REFRN" target="_blank" href="../REFRN/toc.htm"><span class="italic">Oracle Database Reference</span></a>.</p>
</li>
<li>
<p><a id="d48989e482" class="indexterm-anchor"></a>If your database is registered in a recovery catalog, then <code class="codeph">RC_</code> views provide direct access to the RMAN repository data stored in the recovery catalog.</p>
<p>The <code class="codeph">RC_</code> views mostly correspond to the <code class="codeph">V$</code> views. The <code class="codeph">RC_</code> views are documented in <a class="olink RCMRF003" target="_blank" href="../RCMRF/rcviews.htm#RCMRF003"><span class="italic">Oracle Database Backup and Recovery Reference</span></a>.</p>
</li>
<li>
<p><a id="d48989e506" class="indexterm-anchor"></a><a id="d48989e510" class="indexterm-anchor"></a><a id="d48989e512" class="indexterm-anchor"></a><a id="d48989e516" class="indexterm-anchor"></a>The <code class="codeph">RESTORE</code> <code class="codeph">... PREVIEW</code> and <code class="codeph">RESTORE ... VALIDATE HEADER</code> commands list the backups that RMAN can restore to the specified time.</p>
<p><code class="codeph">RESTORE ... PREVIEW</code> queries the metadata but does not read the backup files. The <code class="codeph">RESTORE ... VALIDATE HEADER</code> command performs the same work, but in addition to listing the files needed for restore and recovery operations, the command validates the backup file headers to determine whether the files on disk or in the media management catalog correspond to the metadata in the RMAN repository. These commands are documented in <span class="q">&#34;<a href="rcmcomre.htm#GUID-8837082E-3409-4D00-9836-3B9617720349">Previewing Backups Used in Restore Operations</a>&#34;</span>.</p>
</li>
</ul>
<p>As explained in <a href="rcmmaint.htm#GUID-F5C3D045-279B-4AB3-8A91-3231A716402C" title="You can delete backups and recovery catalog records for backups.">Maintaining RMAN Backups and Repository&nbsp;Records</a>, the RMAN repository can sometimes fail to reflect the reality on disk and tape. For example, a user may delete a backup with an operating system utility, so that the RMAN repository incorrectly reports the backup as available.</p>
<p>You can use commands such as <code class="codeph">CHANGE</code>, <code class="codeph">CROSSCHECK</code>, and <code class="codeph">DELETE</code> to update the RMAN repository to reflect the actual state of available backups. Otherwise, the output of the commands and views may be misleading, which means that RMAN may not be able to find the backups to restore and recover your database.</p>
<div class="infoboxnotealso" id="GUID-1C655AF1-B3CD-452C-BC3C-A566912311FF__GUID-37B22BAE-190E-4F12-8F03-544F873C9DD3">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="rcmmaint.htm#GUID-EFF8F8D1-D67C-4202-9C8E-DE74ADFF1FFB">Crosschecking the RMAN Repository</a>&#34;</span> to learn how to keep the RMAN repository current</p>
</li>
<li>
<p><a class="olink RCMRF132" target="_blank" href="../RCMRF/rcmsynta027.htm#RCMRF132"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">LIST</code> syntax</p>
</li>
<li>
<p><a class="olink RCMRF147" target="_blank" href="../RCMRF/rcmsynta2006.htm#RCMRF147"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">REPORT</code> syntax</p>
</li>
<li>
<p><a class="olink RCMRF149" target="_blank" href="../RCMRF/rcmsynta2008.htm#RCMRF149"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code class="codeph">RESTORE</code> syntax</p>
</li>
</ul>
</div>
</div>
</div>
<a id="BRADV89584"></a>
<div class="props_rev_3"><a id="GUID-06F4023A-3517-4BDB-BEA3-1E7186A5492D"></a>
<h3 id="BRADV-GUID-06F4023A-3517-4BDB-BEA3-1E7186A5492D" class="sect3">Reporting in a Data Guard Environment</h3>
<div>
<div class="section">
<p><a id="d48989e669" class="indexterm-anchor"></a>As explained in <span class="q">&#34;<a href="rcmarchi.htm#GUID-E514F9D2-D96E-4087-B8C5-5A8EB6A44E6B">About RMAN File Management in a Data Guard Environment</a>&#34;</span>, every backup is associated with the primary or standby database that created it. For example, if you backed up the database with <a id="d48989e679" class="indexterm-anchor"></a>the <code class="codeph">DB_UNIQUE_NAME</code> of <code class="codeph">standby1</code>, then the <code class="codeph">standby1</code> database is associated with this backup.</p>
<p>In a Data Guard environment, you can use the <code class="codeph">LIST</code>, <code class="codeph">REPORT</code>, and <code class="codeph">SHOW</code> commands just as you can when not using Data Guard. You can run these commands with the <code class="codeph">FOR DB_UNIQUE_NAME</code> clause to show the backups associated with a specified database. For example, the following command lists archived redo logs associated only with <code class="codeph">sfstandby</code>:</p>
<pre dir="ltr">LIST ARCHIVELOG ALL FOR DB_UNIQUE_NAME sfstandby;
</pre>
<p>If you use the <code class="codeph">LIST</code>, <code class="codeph">REPORT</code>, and <code class="codeph">SHOW</code> commands in a Data Guard environment <span class="italic">without</span> specifying the <code class="codeph">FOR DB_UNIQUE_NAME</code> clause, then RMAN shows the files that are accessible to the target database. <span class="q">&#34;<a href="rcmarchi.htm#GUID-3DDC5739-0A55-4F04-BE4C-4705E300C87F">About Association of Backups in a Data Guard Environment</a>&#34;</span> explains when backups are considered accessible to RMAN.</p>
<p>In a Data Guard environment, you must use RMAN with a recovery catalog. RMAN stores the metadata for all backup and recovery files in the Data Guard environment in the recovery catalog. When running the RMAN reporting commands, you can either connect RMAN as <code class="codeph">TARGET</code> to a mounted or open database, or identify the database with the <code class="codeph">SET DBID</code> command.</p>
<div class="infoboxnotealso" id="GUID-06F4023A-3517-4BDB-BEA3-1E7186A5492D__GUID-5A2B1EA5-91EA-44DA-B934-1A2D9D01597D">
<p class="notep1">See Also:</p>
<p><a class="olink SBYDB04700" target="_blank" href="../SBYDB/rman.htm#SBYDB04700"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> to report on RMAN operations in a Data Guard environment</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV631"></a>
<div class="props_rev_3"><a id="GUID-D14C8A12-E9A6-484D-A8AD-7E40BA714740"></a>
<h3 id="BRADV-GUID-D14C8A12-E9A6-484D-A8AD-7E40BA714740" class="sect3">Reporting in CDBs and PDBs</h3>
<div>
<p>You can view reports on the metadata related to a <a href="glossary.htm#GUID-3E156A59-F6CC-4A2A-9749-DB7D1CE25F13"><span class="xrefglossterm">multitenant container database (CDB)</span></a>, the <a href="glossary.htm#GUID-EA3DB8F4-F68E-4FC5-A599-32A4886FFF8A"><span class="xrefglossterm">root</span></a> only, or one or more pluggable databases (<a href="glossary.htm#GUID-993BFB3F-3305-481C-999D-26132095DEC9"><span class="xrefglossterm">PDB</span></a>s). The information in this chapter about reporting pertains to CDBs and PDBs, with the differences described in the following sections.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmreprt.htm#GUID-6CA4CD3A-D440-47AD-91A8-8FE5B70DED99">Reporting in CDBs</a></p>
</li>
<li>
<p><a href="rcmreprt.htm#GUID-9927031D-93FF-4758-8A2B-30A9874212D9">Reporting in PDBs</a></p>
</li>
</ul>
</div>
<a id="BRADV740"></a>
<div class="props_rev_3"><a id="GUID-6CA4CD3A-D440-47AD-91A8-8FE5B70DED99"></a>
<h4 id="BRADV-GUID-6CA4CD3A-D440-47AD-91A8-8FE5B70DED99" class="sect4">Reporting in CDBs</h4>
<div>
<div class="section">
<p>The steps to view reporting information for a CDB are similar to the ones used for a <a href="glossary.htm#GUID-62A96A52-3B97-455A-A443-75B999DCAC94"><span class="xrefglossterm">non-CDB</span></a>. The only difference is that you must connect to the root as a <a href="glossary.htm#GUID-2B102186-15BD-443C-B375-8CB0D442CF5F"><span class="xrefglossterm">common user</span></a> with the common <code class="codeph">SYSBACKUP</code> or common <code class="codeph">SYSDBA</code> privilege.</p>
<p>The <code class="codeph">LIST</code> and <code class="codeph">LIST BACKUP</code> OF commands will display backups of the whole CDB. The <code class="codeph">REPORT NEED BACKUP TABLESPACE</code> command displays information about the tablespaces in the root that need backup.</p>
<div class="infoboxnotealso" id="GUID-6CA4CD3A-D440-47AD-91A8-8FE5B70DED99__GUID-D86418B8-E318-4B1C-982F-B5BD44212D52">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmcnctg.htm#GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD">Making RMAN Connections to a CDB</a>&#34;</span></p>
</div>
<p>The following command, when connected to the root, displays all the data files in the CDB that need backup:</p>
<pre dir="ltr">REPORT NEED BACKUP; 
</pre>
<p>This command, when connected to the root, provides a summary list of backups of the whole CDB:</p>
<pre dir="ltr">LIST BACKUP SUMMARY;
</pre></div>
<!-- class="section" --></div>
</div>
<a id="BRADV741"></a>
<div class="props_rev_3"><a id="GUID-9927031D-93FF-4758-8A2B-30A9874212D9"></a>
<h4 id="BRADV-GUID-9927031D-93FF-4758-8A2B-30A9874212D9" class="sect4">Reporting in PDBs</h4>
<div>
<div class="section">
<p>Use one of the following techniques to view reporting information for PDBs:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Connect to the root and use the <code class="codeph">LIST ... PLUGGABLE DATABASE</code> or <code class="codeph">REPORT PLUGGABLE DATABASE</code> commands. This enables you to display information regarding one or more PDBs.</p>
<p>The following command, when connected to the root, provides a verbose list of backups in the PDBs <code class="codeph">hr_pdb</code> and <code class="codeph">sales_pdb</code>.</p>
<pre dir="ltr">LIST BACKUP OF PLUGGABLE DATABASE hr_pdb, sales_pdb;
</pre></li>
<li>
<p>Connect to the PDB and use the <code class="codeph">LIST BACKUP</code> or <code class="codeph">REPORT</code> commands. This approach displays information for only one PDB and also uses the same commands that are used for non-CDBs.</p>
<p>The following command, when connected to a particular PDB, displays all the data files in the PDB that need backup:</p>
<pre dir="ltr">REPORT NEED BACKUP; 
</pre>
<p>When connected to a PDB, you cannot view reporting information about obsolete backups or delete obsolete backups.</p>
<div class="infoboxnotealso" id="GUID-9927031D-93FF-4758-8A2B-30A9874212D9__GUID-E572A755-D4E3-4E0E-A1CB-FAD7EB1688D1">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmcnctg.htm#GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD">Making RMAN Connections to a CDB</a>&#34;</span></p>
</div>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<a id="BRADV8136"></a>
<div class="props_rev_3"><a id="GUID-1B911001-C106-4267-9265-F649946DBF52"></a>
<h2 id="BRADV-GUID-1B911001-C106-4267-9265-F649946DBF52" class="sect2">Listing Backups and Recovery-Related Objects</h2>
<div>
<p>The <a id="d48989e1156" class="indexterm-anchor"></a><a id="d48989e1160" class="indexterm-anchor"></a><a id="d48989e1162" class="indexterm-anchor"></a><a id="d48989e1166" class="indexterm-anchor"></a><code class="codeph">LIST</code> command uses the information in the RMAN repository to provide lists of backups and other objects relating to backup and recovery. This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmreprt.htm#GUID-2CD81DF5-F74C-43E1-A202-23D8811BB098" title="The primary purpose of the LIST command is to list backup and copies.">About the LIST Command</a></p>
</li>
<li>
<p><a href="rcmreprt.htm#GUID-EBE4B021-273E-4208-97FC-AA1F2AE092FF">Listing All Backups and Copies</a></p>
</li>
<li>
<p><a href="rcmreprt.htm#GUID-27C4AD72-0556-4388-AD65-8224C49E388F">Listing Selected Backups and Copies</a></p>
</li>
<li>
<p><a href="rcmreprt.htm#GUID-D46FAC21-3514-4A6D-967A-BDEA5E9CB0EB">Listing Database Incarnations</a></p>
</li>
</ul>
</div>
<a id="BRADV274"></a><a id="BRADV275"></a><a id="BRADV89585"></a>
<div class="props_rev_3"><a id="GUID-2CD81DF5-F74C-43E1-A202-23D8811BB098"></a>
<h3 id="BRADV-GUID-2CD81DF5-F74C-43E1-A202-23D8811BB098" class="sect3">About the LIST Command</h3>
<div>
<p>The primary purpose of the <code class="codeph">LIST</code> command is to list backup and copies.</p>
<p>For example, you can list:</p>
<ul style="list-style-type: disc;">
<li>
<p>Backups and proxy copies of a database, tablespace, data file, archived redo log, or control file</p>
</li>
<li>
<p>Backups that have expired</p>
</li>
<li>
<p>Backups restricted by time, path name, device type, tag, or recoverability</p>
</li>
<li>
<p>Archived redo log files and disk copies</p>
</li>
</ul>
<p>Besides backups and copies, RMAN can list other types of data. The following table summarizes several useful objects that you can list.</p>
<div class="tblformal" id="GUID-2CD81DF5-F74C-43E1-A202-23D8811BB098__CIHCGEIG">
<p class="titleintable">Table 11-1 LIST Objects</p>
<table class="cellalignment515" title="LIST Objects" summary="This table describes options for the LIST command and list contents.">
<thead>
<tr class="cellalignment501">
<th class="cellalignment520" id="d48989e1313">Contents of List</th>
<th class="cellalignment520" id="d48989e1316">Command</th>
<th class="cellalignment520" id="d48989e1319">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment501">
<td class="cellalignment501" id="d48989e1324" headers="d48989e1313">
<p>Backup sets and proxy copies</p>
</td>
<td class="cellalignment501" headers="d48989e1324 d48989e1316">
<p><code class="codeph">LIST BACKUP</code></p>
</td>
<td class="cellalignment501" headers="d48989e1324 d48989e1319">
<p>You can list all backup sets, copies, and proxy copies of a database, tablespace, data file, archived redo log, control file, or server parameter file.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment501" id="d48989e1335" headers="d48989e1313">
<p>Image copies</p>
</td>
<td class="cellalignment501" headers="d48989e1335 d48989e1316">
<p><code class="codeph">LIST COPY</code></p>
</td>
<td class="cellalignment501" headers="d48989e1335 d48989e1319">
<p>You can list data file copies and archived redo log files. By default, <code class="codeph">LIST COPY</code> displays copies of all database files and archived redo logs. Both usable and unusable image copies are included in the output, even those that cannot be restored or are expired or unavailable.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment501" id="d48989e1349" headers="d48989e1313">
<p>Archived redo log files</p>
</td>
<td class="cellalignment501" headers="d48989e1349 d48989e1316">
<p><code class="codeph">LIST ARCHIVELOG</code></p>
</td>
<td class="cellalignment501" headers="d48989e1349 d48989e1319">
<p>You can list archive redo log files. You can list all archive log redo log files or specify individual archive log files through SCN, time, or sequence number ranges. If you specify a range you can further restrict the list returned by specifying an incarnation number.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment501" id="d48989e1360" headers="d48989e1313">
<p>Database incarnations</p>
</td>
<td class="cellalignment501" headers="d48989e1360 d48989e1316">
<p><code class="codeph">LIST INCARNATION</code></p>
</td>
<td class="cellalignment501" headers="d48989e1360 d48989e1319">
<p>You can list all incarnations of a database. A new database <a href="glossary.htm#GUID-4CCAB7DD-FEA7-4237-AF2C-304BA3BD52B1"><span class="xrefglossterm">incarnation</span></a> is created when you open with the <code class="codeph">RESETLOGS</code> option.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment501" id="d48989e1377" headers="d48989e1313">
<p>Databases in a Data Guard environment</p>
</td>
<td class="cellalignment501" headers="d48989e1377 d48989e1316">
<p><code class="codeph">LIST DB_UNIQUE_NAME</code></p>
</td>
<td class="cellalignment501" headers="d48989e1377 d48989e1319">
<p>A database in a Data Guard environment is distinguished by its <code class="codeph">DB_UNIQUE_NAME</code> initialization parameter setting. You can list all databases that have the same DBID.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment501" id="d48989e1391" headers="d48989e1313">
<p>Backups and copies for a primary or standby database in a Data Guard environment</p>
</td>
<td class="cellalignment501" headers="d48989e1391 d48989e1316">
<p><code class="codeph">LIST ... FOR DB_UNIQUE_NAME</code></p>
</td>
<td class="cellalignment501" headers="d48989e1391 d48989e1319">
<p>You can list all backups and copies for a specified database in a Data Guard environment or for all databases in the environment.</p>
<p>RMAN restricts the output to files or objects associated exclusively with the database with the specified <code class="codeph">DB_UNIQUE_NAME</code>. For example, you can use <code class="codeph">LIST</code> with <code class="codeph">FOR DB_UNIQUE_NAME</code> to display the list of archived redo log files associated with a particular standby or primary database. Objects that are not owned by any database (<code class="codeph">SITE_KEY</code> column in the recovery catalog view is null) are not listed.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment501" id="d48989e1416" headers="d48989e1313">
<p>Restore points</p>
</td>
<td class="cellalignment501" headers="d48989e1416 d48989e1316">
<p><code class="codeph">LIST RESTORE POINT</code></p>
</td>
<td class="cellalignment501" headers="d48989e1416 d48989e1319">
<p>You can list restore points known to the RMAN repository.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment501" id="d48989e1427" headers="d48989e1313">
<p>Names of stored scripts</p>
</td>
<td class="cellalignment501" headers="d48989e1427 d48989e1316">
<p><code class="codeph">LIST SCRIPT NAMES</code></p>
</td>
<td class="cellalignment501" headers="d48989e1427 d48989e1319">
<p>You can list the names of recovery catalog scripts created with the <code class="codeph">CREATE SCRIPT</code> or <code class="codeph">REPLACE SCRIPT</code> command. A recovery catalog is required.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment501" id="d48989e1444" headers="d48989e1313">
<p>Failures for use with <a href="glossary.htm#GUID-5E618F7B-127F-4BE2-9ED5-E9D1B828434D"><span class="xrefglossterm">Data Recovery Advisor</span></a></p>
</td>
<td class="cellalignment501" headers="d48989e1444 d48989e1316">
<p><code class="codeph">LIST FAILURE</code></p>
</td>
<td class="cellalignment501" headers="d48989e1444 d48989e1319">
<p>A <a href="glossary.htm#GUID-046A9407-B78B-4BBA-BE2F-55D74EF4F2D8"><span class="xrefglossterm">failure</span></a> is a persistent data corruption mapped to a <a href="glossary.htm#GUID-76EA30CA-A51E-44C9-AB25-E1D89AF711B2"><span class="xrefglossterm">repair option</span></a>. <a href="rcmrepai.htm#GUID-8C219B50-1F7F-4F7A-95EE-5F029AE7EB2A">Diagnosing and Repairing Failures with Data Recovery Advisor</a> explains how to use <code class="codeph">LIST FAILURE</code> with the <code class="codeph">ADVISE</code> and <code class="codeph">REPAIR</code> commands.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>The <code class="codeph">LIST</code> command supports options that control how output is displayed. <a href="rcmreprt.htm#GUID-2CD81DF5-F74C-43E1-A202-23D8811BB098__CIHJDIAB" title="This table describes the most common LIST command options.">Table 11-2</a> summarizes the most common <code class="codeph">LIST</code> options.</p>
<div class="tblformal" id="GUID-2CD81DF5-F74C-43E1-A202-23D8811BB098__CIHJDIAB">
<p class="titleintable">Table 11-2 Most Common LIST Options</p>
<table class="cellalignment515" title="Most Common LIST Options" summary="This table describes the most common LIST command options.">
<thead>
<tr class="cellalignment501">
<th class="cellalignment520" id="d48989e1498">LIST Option</th>
<th class="cellalignment520" id="d48989e1501">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment501">
<td class="cellalignment501" id="d48989e1506" headers="d48989e1498">
<p><code class="codeph">LIST EXPIRED</code></p>
</td>
<td class="cellalignment501" headers="d48989e1506 d48989e1501">
<p>Lists backups or copies that are recorded in the RMAN repository but that were not present at the expected location on disk or tape during the most recent <a href="glossary.htm#GUID-F9B39FFF-D31F-4303-AF01-80A151B19D1F"><span class="xrefglossterm">crosscheck</span></a>. Such backups may have been deleted outside of RMAN.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment501" id="d48989e1517" headers="d48989e1498">
<p><code class="codeph">LIST ... BY FILE</code></p>
</td>
<td class="cellalignment501" headers="d48989e1517 d48989e1501">
<p>Lists backups of each data file, archived redo log file, control file, and server parameter file. Each row describes a backup of a file.</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment501" id="d48989e1525" headers="d48989e1498">
<p><code class="codeph">LIST ... SUMMARY</code></p>
</td>
<td class="cellalignment501" headers="d48989e1525 d48989e1501">
<p>Provides a one-line summary of each backup.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>The <code class="codeph">LIST</code> objects and options are not exhausted by the contents of the preceding tables. For example, you can list backups restricted by time, path name, device type, tag, or recoverability.</p>
<div class="infoboxnotealso" id="GUID-2CD81DF5-F74C-43E1-A202-23D8811BB098__GUID-C199A6F5-9D8F-4DAA-A7D2-19A7DD53AE2F">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF132" target="_blank" href="../RCMRF/rcmsynta027.htm#RCMRF132"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for a complete description of the <code class="codeph">LIST</code> command</p>
</div>
</div>
</div>
<a id="BRADV632"></a><a id="BRADV633"></a><a id="BRADV634"></a><a id="BRADV89586"></a>
<div class="props_rev_3"><a id="GUID-EBE4B021-273E-4208-97FC-AA1F2AE092FF"></a>
<h3 id="BRADV-GUID-EBE4B021-273E-4208-97FC-AA1F2AE092FF" class="sect3">Listing All Backups and Copies</h3>
<div>
<div class="section">
<p>Specify the desired objects with the <span class="italic"><code class="codeph">listObjList</code></span> or <span class="italic"><code class="codeph">recordSpec</code></span> clause (refer to <a class="olink RCMRF132" target="_blank" href="../RCMRF/rcmsynta027.htm#RCMRF132"><span class="italic">Oracle Database Backup and Recovery Reference</span></a>). If you do not specify an object, then RMAN displays copies of all database files and archived redo log files.</p>
<p>By default, RMAN serially lists each backup or proxy copy and then identifies the files included in the backup. You can also list backups by file.</p>
<p>By default, RMAN lists in verbose mode, which means that it provides extensive, multiline information. You can also list backups in a summary mode if the verbose mode generates too much output.</p>
<p>To view a summary report of all backups and copies, execute the <code class="codeph">LIST</code> command with the <code class="codeph">SUMMARY</code> option.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-EBE4B021-273E-4208-97FC-AA1F2AE092FF__CIHECIBA">
<p class="titleinexample">Example 11-1 Summary Listing of All Backups</p>
<p>This example shows a summary of all RMAN backups.</p>
<pre dir="ltr">RMAN&gt; <span class="bold">list backup summary;</span>

List of Backups
===============
Key     TY LV S Device Type Completion Time #Pieces #Copies Compressed Tag
------- -- -- - ----------- --------------- ------- ------- ---------- ---
1       B  A  A SBT_TAPE    21-OCT-13       1       1       NO         TAG20131021T094505
2       B  F  A SBT_TAPE    21-OCT-13       1       1       NO         TAG20131021T094513
3       B  A  A SBT_TAPE    21-OCT-13       1       1       NO         TAG20131021T094624
4       B  F  A SBT_TAPE    21-OCT-13       1       1       NO         TAG20131021T094639
5       B  F  A DISK        04-NOV-13       1       1       YES        TAG20131104T195949
</pre>
<p>To view verbose output for backups and copies, execute the <code class="codeph">LIST</code> command without the <code class="codeph">SUMMARY</code> option.</p>
</div>
<!-- class="example" -->
<div class="example" id="GUID-EBE4B021-273E-4208-97FC-AA1F2AE092FF__CIHDBBDB">
<p class="titleinexample">Example 11-2 Verbose Listings of Backups and Copies</p>
<p>This example lists RMAN backups and copies with the default verbose output.</p>
<pre dir="ltr">RMAN&gt; <span class="bold">list backup;</span>
</pre>
<pre dir="ltr">List of Backup Sets
===================

BS Key  Size       Device Type Elapsed Time Completion Time
------- ---------- ----------- ------------ ---------------
7       136M       DISK        00:00:20     04-NOV-13      
        BP Key: 7   Status: AVAILABLE  Compressed: NO  Tag: TAG20071104T200759
        Piece Name: /d2/RDBMS/backupset/2013_11_04/o1_mf_annnn_TAG20071104T200759_ztjxx3k8_.bkp

  List of Archived Logs in backup set 7
  Thrd Seq     Low SCN    Low Time  Next SCN   Next Time
  ---- ------- ---------- --------- ---------- ---------
  1    1       173832     21-OCT-13 174750     21-OCT-13
  1    2       174750     21-OCT-13 174755     21-OCT-13
  1    3       174755     21-OCT-13 174758     21-OCT-13

BS Key  Type LV Size       Device Type Elapsed Time Completion Time
------- ---- -- ---------- ----------- ------------ ---------------
8       Full    2M         DISK        00:00:01     04-NOV-13      
        BP Key: 8   Status: AVAILABLE  Compressed: NO  Tag: TAG20071104T200829
        Piece Name: /disk1/oracle/dbs/c-774627068-20131104-01
  Controlfile Included: Ckp SCN: 631510       Ckp time: 04-NOV-13
  SPFILE Included: Modification time: 21-OCT-13
</pre>
<pre dir="ltr">RMAN&gt; <span class="bold">list copy;</span>
</pre>
<pre dir="ltr">List of Datafile Copies
=======================
 
Key     File S Completion Time Ckp SCN    Ckp Time
------- ---- - --------------- ---------- ---------------
1       7    A 11-OCT-13       360072     11-OCT-13
        Name: /work/orcva/RDBMS/datafile/o1_mf_tbs_2_2lv7bf82_.dbf
        Tag: DF7COPY
 
2       8    A 11-OCT-13       360244     11-OCT-13
        Name: /work/orcva/RDBMS/datafile/o1_mf_tbs_2_2lv7qmcj_.dbf
        Tag: TAG20131011T184835
 
List of Control File Copies
===========================
 
Key     S Completion Time Ckp SCN    Ckp Time
------- - --------------- ---------- ---------------
3       A 11-OCT-13       360380     11-OCT-13
        Name: /d2/RDBMS/controlfile/o1_mf_TAG20131011T185335_2lv80zqd_.ctl
        Tag: TAG20131011T185335
 
List of Archived Log Copies for database with db_unique_name RDBMS
=====================================================================
 
Key     Thrd Seq     S Low Time
------- ---- ------- - ---------
1       1    1       A 11-OCT-13
        Name: /work/arc_dest/arcr_1_1_603561743.arc
 
2       1    2       A 11-OCT-13
        Name: /work/arc_dest/arcr_1_2_603561743.arc
 
3       1    3       A 11-OCT-13
        Name: /work/arc_dest/arcr_1_3_603561743.arc
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-EBE4B021-273E-4208-97FC-AA1F2AE092FF__CIHDFBDE">
<p class="titleinexample">Example 11-3 Listing Backups By File</p>
<p>This example illustrates how to list backups by file using <code class="codeph">LIST</code> with the <code class="codeph">BY</code> <code class="codeph">FILE</code> option.</p>
<pre dir="ltr">RMAN&gt; <span class="bold">list backup by file;</span>
</pre>
<pre dir="ltr">List of Datafile Backups
========================

File Key     TY LV S Ckp SCN    Ckp Time  #Pieces #Copies Compressed Tag
---- ------- -  -- - ---------- --------- ------- ------- ---------- ---
1    5       B  F  A 631092     04-NOV-13 1       1       YES        TAG20131104T195949
     2       B  F  A 175337     21-OCT-13 1       1       NO         TAG20131021T094513
2    5       B  F  A 631092     04-NOV-13 1       1       YES        TAG20131104T195949
     2       B  F  A 175337     21-OCT-13 1       1       NO         TAG20131021T094513

<span class="italic">... some rows omitted</span>

List of Archived Log Backups
============================

Thrd Seq     Low SCN    Low Time  BS Key  S #Pieces #Copies Compressed Tag
---- ------- ---------- --------- ------- - ------- ------- ---------- ---
1    1       173832     21-OCT-13 7       A 1       1       NO         TAG20131104T200759
                                  1       A 1       1       NO         TAG20131021T094505
1    2       174750     21-OCT-13 7       A 1       1       NO         TAG20131104T200759
                                  1       A 1       1       NO         TAG20131021T094505
<span class="italic">... some rows omitted</span>
1    38      575472     03-NOV-13 7       A 1       1       NO         TAG20131104T200759
1    39      617944     04-NOV-13 7       A 1       1       NO         TAG20131104T200759


List of Controlfile Backups
===========================
CF Ckp SCN Ckp Time  BS Key  S #Pieces #Copies Compressed Tag
---------- --------- ------- - ------- ------- ---------- ---
631510     04-NOV-13 8       A 1       1       NO         TAG20131104T200829
631205     04-NOV-13 6       A 1       1       NO         TAG20131104T200432

List of SPFILE Backups
======================
Modification Time BS Key  S #Pieces #Copies Compressed Tag
----------------- ------- - ------- ------- ---------- ---
21-OCT-13         8       A 1       1       NO         TAG20131104T200829
21-OCT-13         6       A 1       1       NO         TAG20131104T200432
</pre>
<div class="infoboxnotealso" id="GUID-EBE4B021-273E-4208-97FC-AA1F2AE092FF__GUID-FA459717-AF6B-4533-81F0-00B453E8A6F3">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF132" target="_blank" href="../RCMRF/rcmsynta027.htm#RCMRF132"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for an explanation of the various column headings in the <code class="codeph">LIST</code> output</p>
</div>
</div>
<!-- class="example" --></div>
</div>
<a id="BRADV277"></a><a id="BRADV89589"></a>
<div class="props_rev_3"><a id="GUID-27C4AD72-0556-4388-AD65-8224C49E388F"></a>
<h3 id="BRADV-GUID-27C4AD72-0556-4388-AD65-8224C49E388F" class="sect3">Listing Selected Backups and Copies</h3>
<div>
<div class="section">
<p>You can specify several different conditions to narrow your <code class="codeph">LIST</code> output.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To list selected backups and copies:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to a target database and recovery catalog (if used).</span></li>
<li class="stepexpand"><span>Run <code class="codeph">LIST</code> <code class="codeph">COPY</code> or <code class="codeph">LIST</code> <code class="codeph">BACKUP</code> with the <span class="italic"><code class="codeph">listObjList</code></span> or <span class="italic"><code class="codeph">recordSpec</code></span> clause. For example, enter any of the following commands:</span>
<div>
<pre dir="ltr"># lists backups of all files in database
LIST BACKUP OF DATABASE; 
# lists copy of specified datafile    
LIST COPY OF DATAFILE &#39;ora_home/oradata/trgt/system01.dbf&#39;; 
# lists specified backup set
LIST BACKUPSET 213; 
# lists datafile copy
LIST DATAFILECOPY &#39;/tmp/tools01.dbf&#39;;
</pre>
<p>You can also restrict the search by specifying the <span class="italic"><code class="codeph">maintQualifier</code></span> or <code class="codeph">RECOVERABLE</code> clause. For example, enter any of the following commands:</p>
<pre dir="ltr"># specify a backup set by tag
LIST BACKUPSET TAG &#39;weekly_full_db_backup&#39;;
# specify a backup or copy by device type
LIST COPY OF DATAFILE &#39;ora_home/oradata/trgt/system01.dbf&#39; DEVICE TYPE sbt;
# specify a backup by directory or path
LIST COPY LIKE &#39;/tmp/%&#39;;
# specify a backup or copy by a range of completion dates
LIST COPY OF DATAFILE 2 COMPLETED BETWEEN &#39;10-DEC-2012&#39; AND &#39;17-DEC-2012&#39;;
# specify logs backed up at least twice to tape
LIST ARCHIVELOG ALL BACKED UP 2 TIMES TO DEVICE TYPE sbt;
</pre></div>
</li>
<li class="stepexpand"><span>Examine the output.</span></li>
</ol>
<div class="section">
<p>The output depends upon the options that you pass to the <code class="codeph">LIST</code> command. For example, the following lists copies of data file <code class="codeph">1</code> contained in backup sets.</p>
<pre dir="ltr">RMAN&gt; LIST BACKUP OF DATAFILE 1;

List of Backup Sets
===================

BS Key  Type LV Size       Device Type Elapsed Time Completion Time
------- ---- -- ---------- ----------- ------------ ---------------
2       Full    230M       SBT_TAPE    00:00:49     21-OCT-13
        BP Key: 2   Status: AVAILABLE  Compressed: NO  Tag: TAG20131021T094513
        Handle: 02f4eatc_1_1   Media: /smrdir
  List of Datafiles in backup set 2
  File LV Type Ckp SCN    Ckp Time  Name
  ---- -- ---- ---------- --------- ----
  1       Full 175337     21-OCT-13 /oracle/dbs/tbs_01.f

BS Key  Type LV Size       Device Type Elapsed Time Completion Time
------- ---- -- ---------- ----------- ------------ ---------------
5       Full    233M       DISK        00:04:30     04-NOV-13
        BP Key: 5   Status: AVAILABLE  Compressed: NO  Tag: TAG20131104T195949
        Piece Name: /disk1/2013_11_04/o1_mf_nnndf_TAG20131104T195949_ztjxfvgz_.bkp
  List of Datafiles in backup set 5
  File LV Type Ckp SCN    Ckp Time  Name
  ---- -- ---- ---------- --------- ----
  1       Full 631092     04-NOV-13 /oracle/dbs/tbs_01.f
</pre>
<div class="infoboxnotealso" id="GUID-27C4AD72-0556-4388-AD65-8224C49E388F__GUID-788AC2C8-5DA8-4FD8-8633-35CADC2DE990">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink RCMRF133" target="_blank" href="../RCMRF/rcmsubcl014.htm#RCMRF133"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <span class="italic"><code class="codeph">listObjList</code></span> and <span class="italic"><code class="codeph">recordSpec</code></span> syntax</p>
</li>
<li>
<p><a class="olink RCMRF132" target="_blank" href="../RCMRF/rcmsynta027.htm#RCMRF132"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for an explanation of the columns in the <code class="codeph">LIST</code> output</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV89591"></a>
<div class="props_rev_3"><a id="GUID-D46FAC21-3514-4A6D-967A-BDEA5E9CB0EB"></a>
<h3 id="BRADV-GUID-D46FAC21-3514-4A6D-967A-BDEA5E9CB0EB" class="sect3">Listing Database Incarnations</h3>
<div>
<div class="section">
<p>Each time an <code class="codeph">OPEN</code> <code class="codeph">RESETLOGS</code> operation is performed on a database, this operation creates a <a id="d48989e1961" class="indexterm-anchor"></a><a id="d48989e1965" class="indexterm-anchor"></a>new <a href="glossary.htm#GUID-4CCAB7DD-FEA7-4237-AF2C-304BA3BD52B1"><span class="xrefglossterm">incarnation</span></a> of the database. Database incarnations and their effect on database recovery are explained in <span class="q">&#34;<a href="rcmrvcon.htm#GUID-9942AC94-A35D-4A06-9A45-A5A43B82B23D">About Database Incarnations</a>&#34;</span>.</p>
<p>When performing incremental backups, RMAN can use a backup from a previous incarnation or the current incarnation as a basis for subsequent incremental backups. When performing restore and recovery operations, RMAN can use backups from a previous incarnation just as it can use backups from the current incarnation, if all archived logs are available.</p>
<p><span class="bold">To list database incarnations:</span></p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to a target database and recovery catalog (if used).</span></li>
<li class="stepexpand"><span><a id="d48989e1992" class="indexterm-anchor"></a>Run the <code class="codeph">LIST</code> <code class="codeph">INCARNATION</code> command, as shown in the following example:</span>
<div>
<pre dir="ltr">LIST INCARNATION;
</pre>
<p>If you are using a recovery catalog, and if you register multiple target databases in the same catalog, then you can distinguish them by using the <code class="codeph">OF</code> <code class="codeph">DATABASE</code> option:</p>
<pre dir="ltr">LIST INCARNATION OF DATABASE prod3;
</pre>
<div class="infoboxnotealso" id="GUID-D46FAC21-3514-4A6D-967A-BDEA5E9CB0EB__GUID-7818143E-96E6-4384-A231-3336CDD5575A">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF132" target="_blank" href="../RCMRF/rcmsynta027.htm#RCMRF132"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for an explanation of the various column headings in the <code class="codeph">LIST</code> output</p>
</div>
<p>Following is a sample output of listing the incarnation of a particular database:</p>
<pre dir="ltr">RMAN&gt; LIST INCARNATION OF DATABASE rdbms;

List of Database Incarnations
DB Key  Inc Key DB Name  DB ID            STATUS  Reset SCN  Reset Time
------- ------- -------- ---------------- ------  ---------- ----------
1       1       RDBMS    774627068        PARENT  1          21-OCT-13
2       2       RDBMS    774627068        CURRENT 173832     21-OCT-13
</pre>
<p>The preceding output indicates that a <code class="codeph">RESETLOGS</code> operation was performed on database <code class="codeph">rdbms</code> at SCN 173832, resulting in a new incarnation. The incarnation is distinguished by incarnation key (represented in the <code class="codeph">Inc Key</code> column).</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<a id="BRADV8137"></a>
<div class="props_rev_3"><a id="GUID-A1FDD9FE-74B8-4146-AFC4-6BD5402C8B5D"></a>
<h2 id="BRADV-GUID-A1FDD9FE-74B8-4146-AFC4-6BD5402C8B5D" class="sect2">Reporting on Backups and Database Schema</h2>
<div>
<p>The RMAN <code class="codeph">REPORT</code> command analyzes the available backups and your database. This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmreprt.htm#GUID-84A456A0-3012-4710-B710-155C4F477671" title="The REPORT command provides various reports of RMAN backups.">About Reports of RMAN Backups</a></p>
</li>
<li>
<p><a href="rcmreprt.htm#GUID-797C90B8-FAD2-4D43-8870-70C2936BD452">Reporting on Files Needing a Backup Under a Retention Policy</a></p>
</li>
<li>
<p><a href="rcmreprt.htm#GUID-907FD8EB-D3C8-47B1-9076-A8A6109FE989">Reporting on Data Files Affected by Unrecoverable Operations</a></p>
</li>
<li>
<p><a href="rcmreprt.htm#GUID-DFC4A04F-E0AE-42E6-9B96-3815C62EF23F">Reporting on Obsolete Backups</a></p>
</li>
<li>
<p><a href="rcmreprt.htm#GUID-732DB3CD-0D09-4A52-A358-2E1E9F5E2C82">Reporting on the Database Schema</a></p>
</li>
</ul>
</div>
<a id="BRADV278"></a><a id="BRADV89593"></a>
<div class="props_rev_3"><a id="GUID-84A456A0-3012-4710-B710-155C4F477671"></a>
<h3 id="BRADV-GUID-84A456A0-3012-4710-B710-155C4F477671" class="sect3">About Reports of RMAN Backups</h3>
<div>
<p>The <code class="codeph">REPORT</code> command provides various reports of RMAN backups.</p>
<p>You can use the <code class="codeph">REPORT</code> command to answer important questions, such as:</p>
<ul style="list-style-type: disc;">
<li>
<p>Which files need a backup?</p>
</li>
<li>
<p>Which files have had unrecoverable operations performed on them?</p>
</li>
<li>
<p>Which backups are obsolete and can be deleted?</p>
</li>
<li>
<p>What was the physical schema of the target database or a database in the Data Guard environment at some previous time?</p>
</li>
<li>
<p>Which files have not been backed up recently?</p>
</li>
</ul>
<p>Reports enable you to confirm that your backup and recovery strategy is in fact meeting your requirements for database recoverability. The two major forms of <code class="codeph">REPORT</code> used to determine whether your database is recoverable are:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">REPORT NEED BACKUP</code></p>
<p>Reports which database files must be backed up to meet a configured or specified retention policy</p>
</li>
<li>
<p><code class="codeph">REPORT UNRECOVERABLE</code></p>
<p>Reports which database files require backup because they have been affected by some <code class="codeph">NOLOGGING</code> operation such as a direct-path <code class="codeph">INSERT</code></p>
</li>
</ul>
<p>The RMAN repository contains other information that you can access with the <code class="codeph">REPORT</code> command. The following table summarizes the <code class="codeph">REPORT</code> options.</p>
<div class="tblformal" id="GUID-84A456A0-3012-4710-B710-155C4F477671__CHDBIADB">
<p class="titleintable">Table 11-3 REPORT Options</p>
<table class="cellalignment515" title="REPORT Options" summary="This table describes REPORT command options.">
<thead>
<tr class="cellalignment501">
<th class="cellalignment520" id="d48989e2305">Contents of Report</th>
<th class="cellalignment520" id="d48989e2308">Command</th>
<th class="cellalignment520" id="d48989e2311">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment501">
<td class="cellalignment501" id="d48989e2316" headers="d48989e2305">
<p>Obsolete backups</p>
</td>
<td class="cellalignment501" headers="d48989e2316 d48989e2308">
<p><code class="codeph">REPORT OBSOLETE</code></p>
</td>
<td class="cellalignment501" headers="d48989e2316 d48989e2311">
<p>Full backups, data file copies, and archived redo logs recorded in the RMAN repository that can be deleted because they are no longer needed</p>
</td>
</tr>
<tr class="cellalignment501">
<td class="cellalignment501" id="d48989e2327" headers="d48989e2305">
<p>Database schema</p>
</td>
<td class="cellalignment501" headers="d48989e2327 d48989e2308">
<p><code class="codeph">REPORT SCHEMA</code></p>
</td>
<td class="cellalignment501" headers="d48989e2327 d48989e2311">
<p>The names of all data files (permanent and temporary) and tablespaces for the target database at the specified point in time. If you use RMAN in a Data Guard environment, then you can report the schema for a specified <code class="codeph">DB_UNIQUE_NAME</code>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="infoboxnotealso" id="GUID-84A456A0-3012-4710-B710-155C4F477671__GUID-C7A2339B-984E-4C28-BCF9-810944B2E981">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF147" target="_blank" href="../RCMRF/rcmsynta2006.htm#RCMRF147"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for a description of the <code class="codeph">REPORT</code> command</p>
</div>
</div>
</div>
<a id="BRADV89594"></a>
<div class="props_rev_3"><a id="GUID-797C90B8-FAD2-4D43-8870-70C2936BD452"></a>
<h3 id="BRADV-GUID-797C90B8-FAD2-4D43-8870-70C2936BD452" class="sect3">Reporting on Files Needing a Backup Under a Retention Policy</h3>
<div>
<div class="section">
<p><a id="d48989e2421" class="indexterm-anchor"></a><a id="d48989e2425" class="indexterm-anchor"></a><a id="d48989e2431" class="indexterm-anchor"></a><a id="d48989e2435" class="indexterm-anchor"></a><a id="d48989e2439" class="indexterm-anchor"></a><a id="d48989e2443" class="indexterm-anchor"></a>Use the <code class="codeph">REPORT</code> <code class="codeph">NEED</code> <code class="codeph">BACKUP</code> command to determine which database files need backup under a specific retention policy.</p>
<p><a id="d48989e2461" class="indexterm-anchor"></a>With no arguments, <code class="codeph">REPORT</code> <code class="codeph">NEED</code> <code class="codeph">BACKUP</code> reports which objects need backup under the currently configured retention policy. The output for a configured retention policy of <code class="codeph">REDUNDANCY 1</code> is similar to this example:</p>
<pre dir="ltr">RMAN&gt; REPORT NEED BACKUP;

RMAN retention policy will be applied to the command
RMAN retention policy is set to redundancy 1
Report of files with less than 1 redundant backups
File #bkps Name
---- ----- -----------------------------------------------------
2    0     /oracle/oradata/trgt/undotbs01.dbf
</pre>
<div class="infobox-note" id="GUID-797C90B8-FAD2-4D43-8870-70C2936BD452__GUID-8C1D7DB6-0733-48A0-A13A-DD796EB1CE71">
<p class="notep1">Note:</p>
<p>If you disable the retention policy using <code class="codeph">CONFIGURE</code> <code class="codeph">RETENTION</code> <code class="codeph">POLICY</code> <code class="codeph">TO</code> <code class="codeph">NONE</code>, then <code class="codeph">REPORT</code> <code class="codeph">NEED</code> <code class="codeph">BACKUP</code> returns an error message, because without a retention policy, RMAN cannot determine which files must be backed up.</p>
</div>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmreprt.htm#GUID-39CFF5D1-610D-43E5-838E-368D205B85A4">Using RMAN REPORT NEED BACKUP with Different Retention Policies</a></p>
</li>
<li>
<p><a href="rcmreprt.htm#GUID-EF685338-5D24-4CDE-8737-1BDCC1122A5E">Using RMAN REPORT NEED BACKUP with Tablespaces and Data Files</a></p>
</li>
<li>
<p><a href="rcmreprt.htm#GUID-2111DD16-E7E0-40F6-A07B-EC56AE6A163B">Using REPORT NEED BACKUP with Backups on Tape or Disk Only</a></p>
</li>
</ul>
</div>
<!-- class="section" --></div>
<a id="BRADV89595"></a>
<div class="props_rev_3"><a id="GUID-39CFF5D1-610D-43E5-838E-368D205B85A4"></a>
<h4 id="BRADV-GUID-39CFF5D1-610D-43E5-838E-368D205B85A4" class="sect4">Using RMAN REPORT NEED BACKUP with Different Retention Policies</h4>
<div>
<div class="section">
<p>You can specify different criteria for <code class="codeph">REPORT</code> <code class="codeph">NEED</code> <code class="codeph">BACKUP</code>, using one of the following forms of the command:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">REPORT</code> <code class="codeph">NEED</code> <code class="codeph">BACKUP</code> <code class="codeph">RECOVERY</code> <code class="codeph">WINDOW</code> <code class="codeph">OF</code> <span class="italic"><code class="codeph">n</code></span> <code class="codeph">DAYS</code></p>
<p>Displays objects requiring backup to satisfy a recovery window-based retention policy</p>
</li>
<li>
<p><code class="codeph">REPORT</code> <code class="codeph">NEED</code> <code class="codeph">BACKUP</code> <code class="codeph">REDUNDANCY</code> <span class="italic"><code class="codeph">n</code></span></p>
<p>Displays objects requiring backup to satisfy a redundancy-based retention policy</p>
</li>
<li>
<p><code class="codeph">REPORT</code> <code class="codeph">NEED</code> <code class="codeph">BACKUP</code> <code class="codeph">DAYS</code> <span class="italic"><code class="codeph">n</code></span></p>
<p>Displays files that require more than <span class="italic"><code class="codeph">n</code></span> days&#39; worth of archived redo log files for recovery</p>
</li>
<li>
<p><code class="codeph">REPORT</code> <code class="codeph">NEED</code> <code class="codeph">BACKUP</code> <code class="codeph">INCREMENTAL</code> <span class="italic"><code class="codeph">n</code></span></p>
<p>Displays files that require application of more than <span class="italic"><code class="codeph">n</code></span> incremental backups for recovery</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV89596"></a>
<div class="props_rev_3"><a id="GUID-EF685338-5D24-4CDE-8737-1BDCC1122A5E"></a>
<h4 id="BRADV-GUID-EF685338-5D24-4CDE-8737-1BDCC1122A5E" class="sect4">Using RMAN REPORT NEED BACKUP with Tablespaces and Data Files</h4>
<div>
<div class="section">
<p>The <code class="codeph">REPORT</code> <code class="codeph">NEED</code> <code class="codeph">BACKUP</code> command can check the entire database, skip specified tablespaces, or check only specific tablespaces or data files against different retention policies, as shown in the following examples:</p>
<pre dir="ltr">REPORT NEED BACKUP RECOVERY WINDOW OF 2 DAYS DATABASE SKIP TABLESPACE TBS_2;
REPORT NEED BACKUP REDUNDANCY 2 DATAFILE 1;
REPORT NEED BACKUP TABLESPACE TBS_3; # uses configured retention policy
REPORT NEED BACKUP INCREMENTAL 2; # checks entire database
</pre>
<div class="infoboxnotealso" id="GUID-EF685338-5D24-4CDE-8737-1BDCC1122A5E__GUID-54534F55-E894-4B4D-ABE2-FC497CD91E06">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF147" target="_blank" href="../RCMRF/rcmsynta2006.htm#RCMRF147"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for all possible options for <code class="codeph">REPORT</code> <code class="codeph">NEED</code> <code class="codeph">BACKUP</code> and an explanation of the various column headings in the output</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV89597"></a>
<div class="props_rev_3"><a id="GUID-2111DD16-E7E0-40F6-A07B-EC56AE6A163B"></a>
<h4 id="BRADV-GUID-2111DD16-E7E0-40F6-A07B-EC56AE6A163B" class="sect4">Using REPORT NEED BACKUP with Backups on Tape or Disk Only</h4>
<div>
<div class="section">
<p>You can limit the backups tested by the <code class="codeph">REPORT NEED BACKUP</code> command to disk-based or tape-based backups only, as shown in these examples:</p>
<pre dir="ltr">REPORT NEED BACKUP RECOVERY WINDOW OF 2 DAYS DATABASE DEVICE TYPE sbt;
REPORT NEED BACKUP DEVICE TYPE DISK;
REPORT NEED BACKUP TABLESPACE TBS_3 DEVICE TYPE sbt; 
</pre></div>
<!-- class="section" --></div>
</div>
</div>
<a id="BRADV279"></a><a id="BRADV89598"></a>
<div class="props_rev_3"><a id="GUID-907FD8EB-D3C8-47B1-9076-A8A6109FE989"></a>
<h3 id="BRADV-GUID-907FD8EB-D3C8-47B1-9076-A8A6109FE989" class="sect3">Reporting on Data Files Affected by Unrecoverable Operations</h3>
<div>
<div class="section">
<p>When a data file has been changed by an unrecoverable operation, such as a direct load insert, normal media recovery cannot be used to recover the file, because an unrecoverable operation does not generate redo. You must perform either a full or incremental backup of affected data files after such operations, to ensure that data blocks affected by the unrecoverable operation can be recovered using RMAN.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To identify data files affected by an unrecoverable operation:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to a target database and recovery catalog (if used).</span>
<div>
<div class="infoboxnotealso" id="GUID-907FD8EB-D3C8-47B1-9076-A8A6109FE989__GUID-FCDA1745-E123-473B-9C27-53D07D734C87">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmcnctg.htm#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C">Making Database Connections with RMAN</a>&#34;</span></p>
</div>
</div>
</li>
<li class="stepexpand"><span>Execute the <code class="codeph">REPORT</code> <code class="codeph">UNRECOVERABLE</code> command.</span>
<div>
<p>The following example includes sample output:</p>
<pre dir="ltr">RMAN&gt; REPORT UNRECOVERABLE;

Report of files that need backup due to unrecoverable operations
File Type of Backup Required Name
---- ----------------------- -----------------------------------
1    full                    /oracle/oradata/trgt/system01.dbf
</pre></div>
</li>
</ol>
</div>
</div>
<a id="BRADV280"></a><a id="BRADV89599"></a>
<div class="props_rev_3"><a id="GUID-DFC4A04F-E0AE-42E6-9B96-3815C62EF23F"></a>
<h3 id="BRADV-GUID-DFC4A04F-E0AE-42E6-9B96-3815C62EF23F" class="sect3">Reporting on Obsolete Backups</h3>
<div>
<div class="section">
<p><a id="d48989e3050" class="indexterm-anchor"></a><a id="d48989e3056" class="indexterm-anchor"></a><a id="d48989e3060" class="indexterm-anchor"></a>You can report backup sets, backup pieces, and data file copies that are obsolete that is, not needed to meet a specified retention policy by specifying the <code class="codeph">OBSOLETE</code> keyword.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To report obsolete backups:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to a target database and recovery catalog (if used).</span>
<div>
<div class="infoboxnotealso" id="GUID-DFC4A04F-E0AE-42E6-9B96-3815C62EF23F__GUID-FEFCC913-7A3B-4657-AE26-A765B124A26B">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmcnctg.htm#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C">Making Database Connections with RMAN</a>&#34;</span></p>
</div>
</div>
</li>
<li class="stepexpand"><span>Execute the <code class="codeph">CROSSCHECK</code> command to update the status of backups in the repository compared to their status on disk.</span>
<div>
<p>In the simplest case, you could crosscheck all backups on disk, tape or both, using any one of the following commands:</p>
<pre dir="ltr">CROSSCHECK BACKUP DEVICE TYPE DISK;
CROSSCHECK BACKUP DEVICE TYPE sbt;
CROSSCHECK BACKUP; # crosschecks all backups on all devices 
</pre>
<p>See <a href="rcmmaint.htm#GUID-F5C3D045-279B-4AB3-8A91-3231A716402C" title="You can delete backups and recovery catalog records for backups.">Maintaining RMAN Backups and Repository&nbsp;Records</a> for more details on how to update the RMAN repository record to contain the actual set of available backups.</p>
</div>
</li>
<li class="stepexpand"><span>Run <code class="codeph">REPORT</code> <code class="codeph">OBSOLETE</code> to identify which backups are obsolete because they are no longer needed for recovery.</span>
<div>
<p>If you do not specify any other options, then <code class="codeph">REPORT</code> <code class="codeph">OBSOLETE</code> displays the backups that are obsolete according to the current retention policy, as shown in the following example:</p>
<pre dir="ltr">RMAN&gt; REPORT OBSOLETE;

RMAN retention policy will be applied to the command
RMAN retention policy is set to redundancy 1
Report of obsolete backups and copies
Type                 Key    Completion Time    Filename/Handle
-------------------- ------ ------------------ --------------------
Datafile Copy        44     08-FEB-13          /backup/ora_df549738566_s70_s1
Datafile Copy        45     08-FEB-13          /backup/ora_df549738567_s71_s1
Datafile Copy        46     08-FEB-13          /backup/ora_df549738568_s72_s1
Backup Set           26     08-FEB-13
  Backup Piece       26     08-FEB-13          /backup/ora_df549738682_s76_s1
.
.
.
</pre>
<p>You can also check which backups are obsolete under different recovery window-based or redundancy-based retention policies, by using <code class="codeph">REPORT</code> <code class="codeph">OBSOLETE</code> with <code class="codeph">RECOVERY</code> <code class="codeph">WINDOW</code> and <code class="codeph">REDUNDANCY</code> options, as shown in these examples:</p>
<pre dir="ltr">REPORT OBSOLETE RECOVERY WINDOW OF 3 DAYS;
REPORT OBSOLETE REDUNDANCY 1;
</pre></div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-DFC4A04F-E0AE-42E6-9B96-3815C62EF23F__GUID-CE1EA233-EFF8-4C10-86BB-0A89EA57376A">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="rcmconfb.htm#GUID-03DE4CF6-9D9F-4806-B5CA-CAA4CF5F2133">Configuring the Backup Retention Policy</a>&#34;</span> for a conceptual overview of RMAN backup retention policy</p>
</li>
<li>
<p><span class="q">&#34;<a href="rcmmaint.htm#GUID-ABB66655-6FAC-4375-AFA0-2E40634085A5">Deleting Expired RMAN Backups and Copies</a>&#34;</span> for information about deleting RMAN backups and deleting records of RMAN backups from the RMAN repository</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV281"></a><a id="BRADV89600"></a>
<div class="props_rev_3"><a id="GUID-732DB3CD-0D09-4A52-A358-2E1E9F5E2C82"></a>
<h3 id="BRADV-GUID-732DB3CD-0D09-4A52-A358-2E1E9F5E2C82" class="sect3">Reporting on the Database Schema</h3>
<div>
<div class="section">
<p><a id="d48989e3229" class="indexterm-anchor"></a><a id="d48989e3233" class="indexterm-anchor"></a><a id="d48989e3237" class="indexterm-anchor"></a>The <code class="codeph">REPORT</code> <code class="codeph">SCHEMA</code> command lists and displays information about the database files, tablespaces, and so on. See <a class="olink RCMRF147" target="_blank" href="../RCMRF/rcmsynta2006.htm#RCMRF147"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for a description of the <code class="codeph">REPORT SCHEMA</code> output.</p>
<p>If you do not specify <code class="codeph">FOR DB_UNIQUE_NAME</code> with <code class="codeph">REPORT SCHEMA</code>, then a recovery catalog connection is optional, but a target database connection is required. In a Data Guard environment, you can specify <code class="codeph">REPORT SCHEMA FOR DB_UNIQUE_NAME</code> to report the schema for a database in the environment. In this case, an RMAN connection to a target database is not required. You can connect RMAN to the recovery catalog and set the DBID instead.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To report on the database schema:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start RMAN and connect to the desired databases.</span>
<div>
<div class="infoboxnotealso" id="GUID-732DB3CD-0D09-4A52-A358-2E1E9F5E2C82__GUID-FE5BFDF4-9EED-4B4E-A036-CA5349D3AAC5">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="rcmcnctg.htm#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C">Making Database Connections with RMAN</a>&#34;</span></p>
</div>
</div>
</li>
<li class="stepexpand"><span>If you did not connect RMAN to a target database in the previous step, and you intend to specify the <code class="codeph">FOR DB_UNIQUE_NAME</code> clause on <code class="codeph">REPORT SCHEMA</code>, then set the database DBID. For example, enter the following command:</span>
<div>
<pre dir="ltr">RMAN&gt; SET DBID 28014364;
</pre></div>
</li>
<li class="stepexpand"><span>Run the <code class="codeph">REPORT</code> <code class="codeph">SCHEMA</code> command as shown in the following example:</span>
<div>
<pre dir="ltr">RMAN&gt; REPORT SCHEMA;
 
Report of database schema for database with db_unique_name DGRDBMS
 
List of Permanent Datafiles
===========================
File Size(MB) Tablespace           RB segs Datafile Name
---- -------- -------------------- ------- ------------------------
1    450      SYSTEM               YES     /disk1/oracle/dbs/t_db1.f
2    141      SYSAUX               NO      /disk1/oracle/dbs/t_ax1.f
3    50       UD1                  YES     /disk1/oracle/dbs/t_undo1.f
4    50       TBS_11               NO      /disk1/oracle/dbs/tbs_111.f
5    50       TBS_11               NO      /disk1/oracle/dbs/tbs_112.f
 
List of Temporary Files
=======================
File Size(MB) Tablespace           Maxsize(MB) Tempfile Name
---- -------- -------------------- ----------- --------------------
1    40       TEMP                 32767       /disk1/oracle/dbs/t_tmp1.f
</pre>
<p>If you use a recovery catalog, then you can use the <span class="italic"><code class="codeph">atClause</code></span> to specify a past time, SCN, or log sequence number, as shown in these examples of the command:</p>
<pre dir="ltr">RMAN&gt; REPORT SCHEMA AT TIME &#39;SYSDATE-14&#39;;     # schema 14 days ago
RMAN&gt; REPORT SCHEMA AT SCN 1000;              # schema at scn 1000
RMAN&gt; REPORT SCHEMA AT SEQUENCE 100 THREAD 1; # schema at sequence 100
RMAN&gt; REPORT SCHEMA FOR DB_UNIQUE_NAME standby1; # schema for database standby1
</pre></div>
</li>
</ol>
</div>
</div>
</div>
<a id="BRADV90911"></a>
<div class="props_rev_3"><a id="GUID-9E60E2AC-6667-49B5-9D31-6480BEF026B9"></a>
<h2 id="BRADV-GUID-9E60E2AC-6667-49B5-9D31-6480BEF026B9" class="sect2">Using V$ Views to Query Backup Metadata</h2>
<div>
<p>In some cases, V$ views supply information that is not available through use of the <code class="codeph">LIST</code> and <code class="codeph">REPORT</code> commands. This section describes cases in which V$ views are particularly useful.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmreprt.htm#GUID-19ECED3C-ED0A-476F-BC59-38B7A5C5877E">Querying Details of Past and Current RMAN Jobs</a></p>
</li>
<li>
<p><a href="rcmreprt.htm#GUID-323B8278-BD20-4278-9770-53E1CF6AC986">Determining the Encryption Status of Backup Pieces</a></p>
</li>
</ul>
</div>
<a id="BRADV282"></a><a id="BRADV99967"></a>
<div class="props_rev_3"><a id="GUID-19ECED3C-ED0A-476F-BC59-38B7A5C5877E"></a>
<h3 id="BRADV-GUID-19ECED3C-ED0A-476F-BC59-38B7A5C5877E" class="sect3">Querying Details of Past and Current RMAN Jobs</h3>
<div>
<div class="section">
<p>An <a href="glossary.htm#GUID-8BEE0BFA-935F-4536-9DC3-333A658BF8DD"><span class="xrefglossterm">RMAN job</span></a> is the set of commands executed within an <a href="glossary.htm#GUID-01D29658-41E1-4D45-9C7F-A761D56885B9"><span class="xrefglossterm">RMAN session</span></a>. Thus, one RMAN job can contain multiple commands. For example, you may execute two separate <code class="codeph">BACKUP</code> commands and a <code class="codeph">RECOVER COPY</code> command in a single session. An <a href="glossary.htm#GUID-5CC2A883-9CE5-48B9-A6F7-6443FE0349E5"><span class="xrefglossterm">RMAN backup job</span></a> is the set of <code class="codeph">BACKUP</code> commands executed in one RMAN job. For example, a <code class="codeph">BACKUP DATABASE</code> and <code class="codeph">BACKUP ARCHIVELOG ALL</code> command executed in the same RMAN job constitute a single RMAN backup job.</p>
<p><a id="d48989e3505" class="indexterm-anchor"></a><a id="d48989e3509" class="indexterm-anchor"></a><a id="d48989e3513" class="indexterm-anchor"></a>The <a id="d48989e3518" class="indexterm-anchor"></a><a id="d48989e3520" class="indexterm-anchor"></a>views <code class="codeph">V$RMAN_BACKUP_JOB_DETAILS</code> and <code class="codeph">V$RMAN_BACKUP_SUBJOB_DETAILS</code> and their corresponding recovery catalog versions provide details of RMAN backup jobs. For example, the views show how long a backup took, how many backup jobs have been issued, the status of each backup job (for example, whether it failed or completed), when a job started and finished, and what type of backup was performed. The <code class="codeph">SESSION_KEY</code> column is the unique key for the RMAN session in which the backup job occurred.</p>
<p>RMAN backups often write less than they read. Because of RMAN compression, the <code class="codeph">OUTPUT_BYTES_PER_SEC</code> column cannot be used as the measurement of backup speed. The appropriate column to measure backup speed is <code class="codeph">INPUT_BYTES_PER_SEC</code>. The ratio between read and written data is described in the <code class="codeph">COMPRESSION_RATIO</code> column.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To query details about past and current RMAN jobs:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Connect SQL*Plus to the database whose backup history you intend to query.</span></li>
<li class="stepexpand"><span>Query the <code class="codeph">V$RMAN_BACKUP_JOB_DETAILS</code> view for information about the backup type, status, and start and end time.</span>
<div>
<p>The following query shows the backup job history ordered by session key, which is the primary key for the RMAN session:</p>
<pre dir="ltr">COL STATUS FORMAT a9
COL hrs    FORMAT 999.99
SELECT SESSION_KEY, INPUT_TYPE, STATUS,
       TO_CHAR(START_TIME,&#39;mm/dd/yy hh24:mi&#39;) start_time,
       TO_CHAR(END_TIME,&#39;mm/dd/yy hh24:mi&#39;)   end_time,
       ELAPSED_SECONDS/3600                   hrs
FROM V$RMAN_BACKUP_JOB_DETAILS
ORDER BY SESSION_KEY;
</pre>
<p>The following sample output shows the backup job history:</p>
<pre dir="ltr">SESSION_KEY INPUT_TYPE    STATUS    START_TIME     END_TIME           HRS
----------- ------------- --------- -------------- -------------- -------
          9 DATAFILE FULL COMPLETED 04/18/07 18:14 04/18/07 18:15     .02
         16 DB FULL       COMPLETED 04/18/07 18:20 04/18/07 18:22     .03
        113 ARCHIVELOG    COMPLETED 04/23/07 16:04 04/23/07 16:05     .01
</pre></div>
</li>
<li class="stepexpand"><span>Query the <code class="codeph">V$RMAN_BACKUP_JOB_DETAILS</code> view for the rate of backup jobs in an RMAN session.</span>
<div>
<p>The following query shows the backup job speed ordered by session key, which is the primary key for the RMAN session. The columns <code class="codeph">in_sec</code> and <code class="codeph">out_sec</code> display the data input and output per second.</p>
<pre dir="ltr">COL in_sec FORMAT a10
COL out_sec FORMAT a10
COL TIME_TAKEN_DISPLAY FORMAT a10
SELECT SESSION_KEY, 
       OPTIMIZED, 
       COMPRESSION_RATIO, 
       INPUT_BYTES_PER_SEC_DISPLAY in_sec,
       OUTPUT_BYTES_PER_SEC_DISPLAY out_sec, 
       TIME_TAKEN_DISPLAY
FROM   V$RMAN_BACKUP_JOB_DETAILS
ORDER BY SESSION_KEY;
</pre>
<p>The following sample output shows the speed of the backup jobs:</p>
<pre dir="ltr">SESSION_KEY OPT COMPRESSION_RATIO IN_SEC     OUT_SEC    TIME_TAKEN
----------- --- ----------------- ---------- ---------- ----------
          9 NO                  1     8.24M      8.24M  00:01:14
         16 NO         1.32732239     6.77M      5.10M  00:01:45
        113 NO                  1     2.99M      2.99M  00:00:44
</pre></div>
</li>
<li class="stepexpand"><span>Query the <code class="codeph">V$RMAN_BACKUP_JOB_DETAILS</code> view for the size of the backups in an RMAN session.</span>
<div>
<p>If you run <code class="codeph">BACKUP DATABASE</code>, then <code class="codeph">V$RMAN_BACKUP_JOB_DETAILS.OUTPUT_BYTES</code> shows the total size of backup sets written by the backup job for the database that you are backing up. To view backup set sizes for all registered databases, query <code class="codeph">V$RMAN_BACKUP_JOB_DETAILS</code>.</p>
<p>The following query shows the backup job size and throughput ordered by session key, which is the primary key for the RMAN session. The columns <code class="codeph">in_size</code> and <code class="codeph">out_size</code> display the data input and output per second.</p>
<pre dir="ltr">COL in_size  FORMAT a10
COL out_size FORMAT a10
SELECT SESSION_KEY, 
       INPUT_TYPE,
       COMPRESSION_RATIO, 
       INPUT_BYTES_DISPLAY in_size,
       OUTPUT_BYTES_DISPLAY out_size
FROM   V$RMAN_BACKUP_JOB_DETAILS
ORDER BY SESSION_KEY;
</pre>
<p>The following sample output shows the size of the backup jobs:</p>
<pre dir="ltr">SESSION_KEY INPUT_TYPE    COMPRESSION_RATIO IN_SIZE    OUT_SIZE
----------- ------------- ----------------- ---------- ----------
         10 DATAFILE FULL                 1   602.50M    602.58M
         17 DB FULL              1.13736669   634.80M    558.13M
</pre></div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-19ECED3C-ED0A-476F-BC59-38B7A5C5877E__GUID-6465A0E4-620B-4D90-9989-E494811AE0E5">
<p class="notep1">See Also:</p>
<p><a class="olink REFRN30391" target="_blank" href="../REFRN/GUID-6DD6941F-C612-4EB1-BE34-0CB5ECF331A5.htm#REFRN30391"><span class="italic">Oracle Database Reference</span></a> to learn about the <code class="codeph">V$RMAN_BACKUP_JOB_DETAILS</code> view</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV90912"></a>
<div class="props_rev_3"><a id="GUID-323B8278-BD20-4278-9770-53E1CF6AC986"></a>
<h3 id="BRADV-GUID-323B8278-BD20-4278-9770-53E1CF6AC986" class="sect3">Determining the Encryption Status of Backup Pieces</h3>
<div>
<div class="section">
<p>The <code class="codeph">ENCRYPTED</code> column of the <code class="codeph">V$BACKUP_PIECE</code> and <code class="codeph">V$RMAN_BACKUP_PIECE</code> views indicates whether a backup piece is encrypted (<code class="codeph">YES</code>) or unencrypted (<code class="codeph">NO</code>). For example, you can run the following query in SQL*Plus to determine which backup pieces are encrypted:</p>
<pre dir="ltr">COL BS_REC    FORMAT 99999
COL BP_REC    FORMAT 99999
COL MB        FORMAT 9999999
COL ENCRYPTED FORMAT A7
COL TAG       FORMAT A25

SELECT S.RECID AS &#34;BS_REC&#34;, P.RECID AS &#34;BP_REC&#34;, P.ENCRYPTED, 
       P.TAG, P.HANDLE AS &#34;MEDIA_HANDLE&#34;
FROM   V$BACKUP_PIECE P, V$BACKUP_SET S
WHERE  P.SET_STAMP = S.SET_STAMP
AND    P.SET_COUNT = S.SET_COUNT;
</pre>
<p>The following sample output shows that the backups are encrypted:</p>
<pre dir="ltr">BS_REC BP_REC ENCRYPT TAG
------ ------ ------- -------------------------
MEDIA_HANDLE
--------------------------------------------------------------------------------
     1      1 YES     TAG20070711T140124
/disk1/c-39525561-20070711-00
 
     2      2 YES     TAG20070711T140128
/disk1/c-39525561-20070711-01
 
     3      3 YES     TAG20070711T140130
/disk1/c-39525561-20070711-02
</pre>
<div class="infoboxnotealso" id="GUID-323B8278-BD20-4278-9770-53E1CF6AC986__GUID-97012501-608B-409E-A9D1-8399833B9B75">
<p class="notep1">See Also:</p>
<p><a class="olink REFRN30023" target="_blank" href="../REFRN/GUID-01D14739-4AF6-4006-AE3A-345DAF893D89.htm#REFRN30023"><span class="italic">Oracle Database Reference</span></a> to learn about the <code class="codeph">V$BACKUP_PIECE</code> view</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="BRADV89601"></a>
<div class="props_rev_3"><a id="GUID-C48F1F48-E11D-4DA4-AB54-6D7EB4CA8957"></a>
<h2 id="BRADV-GUID-C48F1F48-E11D-4DA4-AB54-6D7EB4CA8957" class="sect2">Querying Recovery Catalog Views</h2>
<div>
<p><a id="d48989e3801" class="indexterm-anchor"></a><a id="d48989e3803" class="indexterm-anchor"></a>The <code class="codeph">LIST</code>, <code class="codeph">REPORT</code>, and <code class="codeph">SHOW</code> commands provide the easiest means of accessing the data in the control file and the recovery catalog. Nevertheless, you can sometimes also obtain useful information from the recovery catalog views, which reside in the recovery catalog schema and use the <code class="codeph">RC_</code> prefix.</p>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rcmreprt.htm#GUID-09997497-FAAC-4877-8D0E-44333752FF46">About Recovery Catalog Views</a></p>
</li>
<li>
<p><a href="rcmreprt.htm#GUID-93421D43-DFBA-4267-BFEB-C9716B6B0963">Querying Catalog Views for the Target DB_KEY or DBID Values</a></p>
</li>
<li>
<p><a href="rcmreprt.htm#GUID-57512E48-D371-4B1C-A176-B5812BC265B2">Querying RC_BACKUP_FILES</a></p>
</li>
</ul>
</div>
<a id="BRADV89602"></a>
<div class="props_rev_3"><a id="GUID-09997497-FAAC-4877-8D0E-44333752FF46"></a>
<h3 id="BRADV-GUID-09997497-FAAC-4877-8D0E-44333752FF46" class="sect3">About Recovery Catalog Views</h3>
<div>
<p>RMAN obtains backup and recovery metadata from a target database control file and stores it in the tables of the recovery catalog. The recovery catalog views are derived from these tables. The recovery catalog views are not normalized or optimized for user queries.</p>
<p>In general, the recovery catalog views are not as user-friendly as the RMAN reporting commands. For example, when you start RMAN and connect to a target database, you obtain the information for this target database only when you issue <code class="codeph">LIST</code>, <code class="codeph">REPORT</code>, and <code class="codeph">SHOW</code> commands. If you have 10 different target databases registered in the same recovery catalog, then any query of the catalog views shows the metadata for all incarnations of all 10 databases. You often must perform complex selects and joins among the views to extract usable information about a database <a href="glossary.htm#GUID-4CCAB7DD-FEA7-4237-AF2C-304BA3BD52B1"><span class="xrefglossterm">incarnation</span></a>.</p>
<p>Most of the catalog views have a corresponding <code class="codeph">V$</code> view in the database. For example,<a id="d48989e3928" class="indexterm-anchor"></a> <code class="codeph">RC_BACKUP_PIECE</code> corresponds <a id="d48989e3934" class="indexterm-anchor"></a>to <code class="codeph">V$BACKUP_PIECE</code>. The primary difference between the recovery catalog view and corresponding <code class="codeph">V$</code> view is that each recovery catalog view contains metadata about <span class="italic">all</span> the target databases registered in the recovery catalog. The <code class="codeph">V$</code> view contains information only about itself.</p>
<div class="infoboxnotealso" id="GUID-09997497-FAAC-4877-8D0E-44333752FF46__GUID-73FD9B64-35DB-4678-96A4-681700E75ED4">
<p class="notep1">See Also:</p>
<p><a class="olink RCMRF003" target="_blank" href="../RCMRF/rcviews.htm#RCMRF003"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for a description of recovery catalog views</p>
</div>
</div>
<a id="BRADV89603"></a>
<div class="props_rev_3"><a id="GUID-C980FFD5-1D65-4AF7-B8EB-9FB29EF0B25D"></a>
<h4 id="BRADV-GUID-C980FFD5-1D65-4AF7-B8EB-9FB29EF0B25D" class="sect4">About Unique Identifiers for Registered Databases</h4>
<div>
<p>Most recovery catalog views contain the columns <code class="codeph">DB_KEY</code> and <code class="codeph">DBINC_KEY</code>. Each database registered in the recovery catalog can be uniquely identified by either the primary key, which is the <code class="codeph">DB_KEY</code> column value, or the <code class="codeph">DBID</code>, which is the 32-bit unique database identifier. Each incarnation of a database is uniquely identified by the <code class="codeph">DBINC_KEY</code> column.</p>
<p>You can use <code class="codeph">DB_KEY</code> and <code class="codeph">DBINC_KEY</code> to retrieve the records of a specific incarnation of a target database. Then, you can perform joins with most of the other catalog views to isolate records belonging to this incarnation.</p>
<p>An important difference between catalog and <code class="codeph">V$</code> views is that a different system of unique identifiers is used for backup and recovery files. For example, many <code class="codeph">V$</code> views such <a id="d48989e4058" class="indexterm-anchor"></a>as <code class="codeph">V$ARCHIVED_LOG</code> use the <code class="codeph">RECID</code> and <code class="codeph">STAMP</code> columns to form a concatenated primary key. The corresponding recovery catalog view uses a derived value as its primary keys and stores this value in a single column. For example, the primary key <a id="d48989e4071" class="indexterm-anchor"></a>in <code class="codeph">RC_ARCHIVED_LOG</code> is the <code class="codeph">AL_KEY</code> column. The <code class="codeph">AL_KEY</code> column value is the primary key that RMAN displays in the <code class="codeph">LIST</code> command output.</p>
</div>
</div>
<a id="BRADV89604"></a>
<div class="props_rev_3"><a id="GUID-7130E16B-67B7-430C-9990-26E5B9A916BD"></a>
<h4 id="BRADV-GUID-7130E16B-67B7-430C-9990-26E5B9A916BD" class="sect4">About Unique Identifiers in a Data Guard Environment</h4>
<div>
<p>Special considerations apply when querying the recovery catalog in a Data Guard environment. In a Data Guard environment, multiple databases share the same DBID. Several views contain a <code class="codeph">DB_UNIQUE_NAME</code> column, which indicates the <code class="codeph">DB_UNIQUE_NAME</code> of the database incarnation to which the record belongs. All databases in a Data Guard environment share the same DBID but have different <code class="codeph">DB_UNIQUE_NAME</code> values.</p>
<p>The value of <code class="codeph">DB_UNIQUE_NAME</code> is <code class="codeph">null</code> when the database name is not known to the catalog, as for Oracle9<span class="italic">i</span> databases that are registered in a recovery catalog. Also, the column value is <code class="codeph">null</code> when a database is upgraded to Oracle Database 11<span class="italic">g</span> but the recovery catalog schema has not reconciled the database names for all files.</p>
<p>In the recovery catalog views, the primary database and its associated standby databases share the same <code class="codeph">DB_KEY</code>. However, every database in a Data Guard environment has a unique <code class="codeph">RC_SITE.SITE_KEY</code> value. For example, a primary database <code class="codeph">prod</code> and its standby database <code class="codeph">standby1</code> might both have the <code class="codeph">DB_KEY</code> value of 1, whereas the <code class="codeph">SITE_KEY</code> of <code class="codeph">prod</code> is 3 and the <code class="codeph">SITE_KEY</code> of <code class="codeph">standby1</code> is 30.</p>
<p>Some recovery catalog views do not have a <code class="codeph">DB_UNIQUE_NAME</code> column, but include a <code class="codeph">SITE_KEY</code> column. You can use the <code class="codeph">SITE_KEY</code> column to join with <code class="codeph">RC_SITE.SITE_KEY</code> to determine the <code class="codeph">DB_UNIQUE_NAME</code> of the database associated with a file. As explained in <span class="q">&#34;<a href="rcmarchi.htm#GUID-E514F9D2-D96E-4087-B8C5-5A8EB6A44E6B">About RMAN File Management in a Data Guard Environment</a>&#34;</span>, every file in a Data Guard environment is associated with the primary or standby database that created it.</p>
<div class="infoboxnotealso" id="GUID-7130E16B-67B7-430C-9990-26E5B9A916BD__GUID-462F8DEA-17EA-49BD-B370-6043F0A16056">
<p class="notep1">See Also:</p>
<p><a class="olink SBYDB04700" target="_blank" href="../SBYDB/rman.htm#SBYDB04700"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> to learn how to report on and manage files in a Data Guard environment</p>
</div>
</div>
</div>
</div>
<a id="BRADV283"></a><a id="BRADV89605"></a>
<div class="props_rev_3"><a id="GUID-93421D43-DFBA-4267-BFEB-C9716B6B0963"></a>
<h3 id="BRADV-GUID-93421D43-DFBA-4267-BFEB-C9716B6B0963" class="sect3">Querying Catalog Views for the Target DB_KEY or DBID Values</h3>
<div>
<div class="section">
<p>The <code class="codeph">DB_KEY</code> value, which is the primary key for a registered database, is used only in the recovery catalog. The easiest way is to obtain the <code class="codeph">DB_KEY</code> is to use the DBID of the target database, which is displayed whenever you connect RMAN to a database as <code class="codeph">TARGET</code>. The DBID distinguishes databases registered in the RMAN recovery catalog.</p>
<p>Assume that you want to obtain information about a database registered in the recovery catalog.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To query the catalog for information about the current incarnation of a database:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Determine the DBID for the database whose records you want to view.</span>
<div>
<p>You can obtain the DBID by looking at the output displayed when RMAN connects to the database, <a id="d48989e4335" class="indexterm-anchor"></a>querying <code class="codeph">V$RMAN_OUTPUT</code>, or querying <a id="d48989e4341" class="indexterm-anchor"></a>a <code class="codeph">V$DATABASE</code> view. The following example connects SQL*Plus to the desired database and queries the DBID:</p>
<pre dir="ltr">SQL&gt; CONNECT / AS SYSBACKUP
SQL&gt; SELECT DBID 
  2  FROM   V$DATABASE;

     DBID
---------
598368217
</pre></div>
</li>
<li class="stepexpand"><span>Start SQL*Plus and connect to the recovery catalog database as the owner of the recovery catalog.</span></li>
<li class="stepexpand"><span>Obtain the database key for the database whose DBID you obtained in Step 1.</span>
<div>
<p>To obtain the <code class="codeph">DB_KEY</code> for a database run the following query, where <span class="italic"><code class="codeph">dbid_of_target</code></span> is the DBID obtained in Step 1:</p>
<pre dir="ltr">SELECT DB_KEY 
FROM   RC_DATABASE 
WHERE  DBID = <span class="italic">dbid_of_target</span>;
</pre></div>
</li>
<li class="stepexpand"><span>Query the records for the current incarnation of the database whose DBID you obtained in Step 1.</span>
<div>
<p>To obtain information about the current incarnation of a target database, specify the target database <code class="codeph">DB_KEY</code> value and perform a join with the <code class="codeph">RC_DATABASE_INCARNATION</code> view. Use a <code class="codeph">WHERE</code> condition to specify that the <code class="codeph">CURRENT_INCARNATION</code> column value is set to <code class="codeph">YES</code>. For example, to obtain information about backup sets in the current incarnation of a target database with the <code class="codeph">DB_KEY</code> value of <code class="codeph">1</code>, query as follows:</p>
<pre dir="ltr">SELECT BS_KEY, BACKUP_TYPE, COMPLETION_TIME
FROM   RC_DATABASE_INCARNATION i, RC_BACKUP_SET b
WHERE  i.DB_KEY = 1
AND    i.DB_KEY = b.DB_KEY
AND    i.CURRENT_INCARNATION = &#39;YES&#39;;
</pre></div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-93421D43-DFBA-4267-BFEB-C9716B6B0963__GUID-6871BCC1-759E-4FA7-BD1D-E9BF8891F5D2">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink RCMRF174" target="_blank" href="../RCMRF/rcviews028.htm#RCMRF174"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for details about the <code class="codeph">RC_DATABASE_INCARNATION</code> view</p>
</li>
<li>
<p><span class="q">&#34;<a href="rcmrvcon.htm#GUID-9942AC94-A35D-4A06-9A45-A5A43B82B23D">About Database Incarnations</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BRADV53532"></a>
<div class="props_rev_3"><a id="GUID-57512E48-D371-4B1C-A176-B5812BC265B2"></a>
<h3 id="BRADV-GUID-57512E48-D371-4B1C-A176-B5812BC265B2" class="sect3">Querying RC_BACKUP_FILES</h3>
<div>
<div class="section">
<p>You can query the <a id="d48989e4491" class="indexterm-anchor"></a>view <code class="codeph">RC_BACKUP_FILES</code> for information about all backups of any database registered in the recovery catalog. Before querying <code class="codeph">RC_BACKUP_FILES</code>, however, you must call the <code class="codeph">DBMS_RCVMAN.SETDATABASE</code> procedure. Specify the DBID of a database registered in the recovery catalog, as shown in the following example:</p>
<pre dir="ltr">SQL&gt; CALL DBMS_RCVMAN.SETDATABASE(null,null,null,2283997583);
</pre>
<p>The fourth parameter must be the DBID of a database registered in the recovery catalog. The other parameters must all be <code class="codeph">NULL</code>.</p>
<div class="infoboxnotealso" id="GUID-57512E48-D371-4B1C-A176-B5812BC265B2__GUID-E938298D-50D3-4713-9B77-FA6B06E63831">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink RCMRF1670" target="_blank" href="../RCMRF/rcviews013.htm#RCMRF1670"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for details about the <code class="codeph">RC_BACKUP_FILES</code> view</p>
</li>
<li>
<p><span class="q">&#34;<a href="rcmcomre.htm#GUID-34BB2E4B-B2FC-4701-BB65-BFED027DB865">Determining the DBID of the Database</a>&#34;</span> for techniques for determining the DBID of a database</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment500">
<tr>
<td class="cellalignment512">
<table class="cellalignment505">
<tr>
<td class="cellalignment504"><a href="part_mai.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment504"><a href="rcmmaint.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment514">
<table class="cellalignment503">
<tr>
<td class="cellalignment504"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment504"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment504"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment504"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment504"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment504"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>