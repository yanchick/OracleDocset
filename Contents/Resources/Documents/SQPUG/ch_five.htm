<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-103736"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Using%20Scripts%20in%20SQL%2APlus"></a><title>Using Scripts in SQL*Plus</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 737"/>
<meta name="dcterms.created" content="2013-07-17T10:55:16Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="SQL*Plus&reg; User&#39;s Guide and Reference"/>
<meta name="dcterms.identifier" content="E18404-12"/>
<meta name="dcterms.isVersionOf" content="SQPUG"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="ch_four.htm" title="Previous" type="text/html"/>
<link rel="Next" href="ch_six.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E18404-12.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">14/82</span> <!-- End Header -->
<div id="SQPUG015" class="chapter"><a id="CHDJCHGG"></a><a id="i1210079"></a>
<h1 class="chapter"><span class="secnum">5</span> Using Scripts in SQL*Plus</h1>
<p>This chapter helps you learn to write and edit scripts containing SQL*Plus commands, SQL commands, and PL/SQL blocks. It covers the following topics:</p>
<ul>
<li>
<p><a href="#i1210133">Editing Scripts</a></p>
</li>
<li>
<p><a href="#i1210247">Editing Scripts in SQL*Plus Command-Line</a></p>
</li>
<li>
<p><a href="#i1210024">Placing Comments in Scripts</a></p>
</li>
<li>
<p><a href="#i1210918">Running Scripts</a></p>
</li>
<li>
<p><a href="#i1211006">Nesting Scripts</a></p>
</li>
<li>
<p><a href="#i1211029">Exiting from a Script with a Return Code</a></p>
</li>
<li>
<p><a href="#i1211130">Defining Substitution Variables</a></p>
</li>
<li>
<p><a href="#i1211158">Using Predefined Variables</a></p>
</li>
<li>
<p><a href="#CACIFHGB">Using Substitution Variables</a></p>
</li>
<li>
<p><a href="#CACIIEDF">Passing Parameters through the START Command</a></p>
</li>
<li>
<p><a href="#CACHDBHG">Communicating with the User</a></p>
</li>
<li>
<p><a href="#i1211850">Using Bind Variables</a></p>
</li>
<li>
<p><a href="#i1211948">Fetching Iterative Results from a SELECT inside a PL/SQL Block</a></p>
</li>
</ul>
<p>Read this chapter while sitting at your computer and try out the examples shown. Before beginning, make sure you have access to the <a id="sthref343"></a><a id="sthref344"></a>sample schema described in <a href="qstart.htm#i1056581">SQL*Plus Overview</a>.</p>
<a id="i1210133"></a>
<div id="SQPUG409" class="sect1">
<h2 class="sect1">Editing Scripts</h2>
<p>In SQL*Plus command-line, the use of an external editor in combination with the @, @@ or START commands is an effective method of creating and executing generic scripts. You can write scripts which contain SQL*Plus, SQL and PL/SQL commands, <a id="sthref345"></a>which you can retrieve and edit. This is especially useful for storing complex commands or frequently used reports.</p>
<div id="SQPUG410" class="sect2"><a id="sthref346"></a>
<h3 class="sect2">Writing Scripts with a System Editor</h3>
<p>Your operating system<a id="sthref347"></a> may have one or more text editors<a id="sthref348"></a><a id="sthref349"></a> that you can use to write scripts. You can run your operating system&#39;s default text editor without leaving the SQL*Plus command-line by entering the EDIT<a id="sthref350"></a> command.</p>
<p>You can use the SQL*Plus DEFINE<a id="sthref351"></a> command to define the variable, <a id="sthref352"></a><a id="sthref353"></a>_EDITOR<a id="sthref354"></a>, to hold the name of your preferred text editor. For example, to define the editor used by EDIT to be vi, enter the following command:</p>
<pre>DEFINE _EDITOR = vi
</pre>
<p>You can include an editor definition in your user or site profile so that it is always enabled when you start SQL*Plus. See <a href="ch_two.htm#i1132910">SQL*Plus Configuration</a>, and the <a href="ch_twelve017.htm#BACGDCIH">DEFINE</a> and <a href="ch_twelve021.htm#i2675783">EDIT</a> commands for more information.</p>
<p>To create a script<a id="sthref355"></a> with a text editor, enter EDIT<a id="sthref356"></a> followed by the name of the file to edit or create, for example:</p>
<pre>EDIT SALES
</pre>
<p>EDIT adds the filename extension .SQL to the name unless you specify the file extension. When you save the script with the text editor, it is saved back into the same file. EDIT lets you create or modify scripts.</p>
<p>You must include a semicolon at the end of each SQL command and a slash (/) on a line by itself after each PL/SQL block in the file. You can include multiple SQL commands<a id="sthref357"></a> and PL/SQL blocks in a script<a id="sthref358"></a>.</p>
<div id="SQPUG411" class="example">
<p class="titleinexample"><a id="i1210192"></a>Example 5-1 Using a System Editor to Write a SQL Script</p>
<p>Suppose you have composed a query to display a list of salespeople and their commissions. You plan to run it once a month to keep track of how well each employee is doing.</p>
<p>To compose and save the query using your system editor, invoke your editor and create a file to hold your script:</p>
<pre>EDIT SALES<a id="sthref359"></a><a id="sthref360"></a>
</pre>
<p>Enter each of the following lines in your editor. Do not forget to include the semicolon at the end of the SQL statement:</p>
<pre>COLUMN LAST_NAME HEADING &#39;LAST NAME&#39;
COLUMN SALARY HEADING &#39;MONTHLY SALARY&#39; FORMAT $99,999
COLUMN COMMISSION_PCT HEADING &#39;COMMISSION %&#39; FORMAT 90.90
SELECT LAST_NAME, SALARY, COMMISSION_PCT
FROM EMP_DETAILS_VIEW
WHERE JOB_ID=&#39;SA_MAN&#39;;
</pre>
<p>The format model for the column COMMISSION_PCT tells SQL*Plus to display an initial zero for decimal values, and a zero instead of a blank when the value of COMMISSION_PCT is zero for a given row. Format models and the COLUMN command are described in more detail in the <a href="ch_twelve013.htm#BACHCABF">COLUMN</a> command and in the <a class="olink SQLRF" href="../SQLRF/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a>.</p>
<p>Now use your editor&#39;s save<a id="sthref361"></a> command to store your query in a file<a id="sthref362"></a> called SALES.SQL.</p>
</div>
<!-- class="example" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1210247"></a>
<div id="SQPUG412" class="sect1">
<h2 class="sect1">Editing Scripts in SQL*Plus Command-Line</h2>
<p>You can use a number of SQL*Plus commands to edit the SQL command<a id="sthref363"></a> or PL/SQL block<a id="sthref364"></a> currently stored in the buffer.</p>
<p><a href="#CCHBCFHJ">Table 5-1, &#34;SQL*Plus Editing Commands&#34;</a> lists the SQL*Plus commands that allow you to examine or change the command in the buffer without re-entering the command.</p>
<div id="SQPUG413" class="tblformal">
<p class="titleintable"><a id="sthref365"></a><a id="CCHBCFHJ"></a>Table 5-1 SQL*Plus Editing Commands</p>
<table class="cellalignment1447" title="SQL*Plus Editing Commands" summary="Shows command-line script editing commands, abbreviations, and descriptions." dir="ltr">
<thead>
<tr class="cellalignment1437">
<th class="cellalignment1448" id="r1c1-t2">Command</th>
<th class="cellalignment1448" id="r1c2-t2">Abbreviation</th>
<th class="cellalignment1448" id="r1c3-t2">Purpose</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r2c1-t2" headers="r1c1-t2">
<pre>APPEND<a id="sthref366"></a> <span class="italic">text</span>
</pre></td>
<td class="cellalignment1444" headers="r2c1-t2 r1c2-t2">
<pre>A <span class="italic">text</span>
</pre></td>
<td class="cellalignment1444" headers="r2c1-t2 r1c3-t2">
<p>adds <span class="italic">text</span> at the end of the current line</p>
</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r3c1-t2" headers="r1c1-t2">
<pre>CHANGE<a id="sthref367"></a>/old/new
</pre></td>
<td class="cellalignment1444" headers="r3c1-t2 r1c2-t2">
<pre>C/<span class="italic">old</span>/<span class="italic">new</span>
</pre></td>
<td class="cellalignment1444" headers="r3c1-t2 r1c3-t2">
<p>changes <span class="italic">old</span> to <span class="italic">new</span> in the current line</p>
</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r4c1-t2" headers="r1c1-t2">
<pre>CHANGE/<span class="italic">text</span>
</pre></td>
<td class="cellalignment1444" headers="r4c1-t2 r1c2-t2">
<pre>C/<span class="italic">text</span>
</pre></td>
<td class="cellalignment1444" headers="r4c1-t2 r1c3-t2">
<p>deletes <span class="italic">text</span> from the current line</p>
</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r5c1-t2" headers="r1c1-t2">
<pre>CLEAR<a id="sthref368"></a> BUFFER<a id="sthref369"></a>
</pre></td>
<td class="cellalignment1444" headers="r5c1-t2 r1c2-t2">
<pre>CL BUFF
</pre></td>
<td class="cellalignment1444" headers="r5c1-t2 r1c3-t2">
<p>deletes<a id="sthref370"></a> all lines<a id="sthref371"></a></p>
</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r6c1-t2" headers="r1c1-t2">
<pre>DEL<a id="sthref372"></a>
</pre></td>
<td class="cellalignment1444" headers="r6c1-t2 r1c2-t2">
<p>(none)</p>
</td>
<td class="cellalignment1444" headers="r6c1-t2 r1c3-t2">
<p>deletes the current line</p>
</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r7c1-t2" headers="r1c1-t2">
<pre>DEL <span class="italic">n</span>
</pre></td>
<td class="cellalignment1444" headers="r7c1-t2 r1c2-t2">
<p>(none)</p>
</td>
<td class="cellalignment1444" headers="r7c1-t2 r1c3-t2">
<p>deletes line <span class="italic">n<a id="sthref373"></a></span></p>
</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r8c1-t2" headers="r1c1-t2">
<pre>DEL *<a id="sthref374"></a> <a id="sthref375"></a>
</pre></td>
<td class="cellalignment1444" headers="r8c1-t2 r1c2-t2">
<p>(none)</p>
</td>
<td class="cellalignment1444" headers="r8c1-t2 r1c3-t2">
<p>deletes the current line<a id="sthref376"></a></p>
</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r9c1-t2" headers="r1c1-t2">
<pre>DEL <span class="italic">n</span> *
</pre></td>
<td class="cellalignment1444" headers="r9c1-t2 r1c2-t2">
<p>(none)</p>
</td>
<td class="cellalignment1444" headers="r9c1-t2 r1c3-t2">
<p>deletes line <span class="italic">n</span> through the current line</p>
</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r10c1-t2" headers="r1c1-t2">
<pre>DEL LAST
</pre></td>
<td class="cellalignment1444" headers="r10c1-t2 r1c2-t2">
<p>(none)</p>
</td>
<td class="cellalignment1444" headers="r10c1-t2 r1c3-t2">
<p>deletes the last line<a id="sthref377"></a></p>
</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r11c1-t2" headers="r1c1-t2">
<pre>DEL <span class="italic">m</span> <span class="italic">n</span>
</pre></td>
<td class="cellalignment1444" headers="r11c1-t2 r1c2-t2">
<p>(none)</p>
</td>
<td class="cellalignment1444" headers="r11c1-t2 r1c3-t2">
<p>deletes a range of lines (<span class="italic">m</span> to <span class="italic">n</span>)<a id="sthref378"></a></p>
</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r12c1-t2" headers="r1c1-t2">
<pre>DEL * <span class="italic">n</span>
</pre></td>
<td class="cellalignment1444" headers="r12c1-t2 r1c2-t2">
<p>(none)</p>
</td>
<td class="cellalignment1444" headers="r12c1-t2 r1c3-t2">
<p>deletes the current line through line <span class="italic">n</span></p>
</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r13c1-t2" headers="r1c1-t2">
<pre>INPUT<a id="sthref379"></a>
</pre></td>
<td class="cellalignment1444" headers="r13c1-t2 r1c2-t2">
<pre>I
</pre></td>
<td class="cellalignment1444" headers="r13c1-t2 r1c3-t2">
<p>adds one or more lines</p>
</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r14c1-t2" headers="r1c1-t2">
<pre>INPUT <span class="italic">text</span>
</pre></td>
<td class="cellalignment1444" headers="r14c1-t2 r1c2-t2">
<pre>I <span class="italic">text</span>
</pre></td>
<td class="cellalignment1444" headers="r14c1-t2 r1c3-t2">
<p>adds a line consisting of <span class="italic">text</span></p>
</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r15c1-t2" headers="r1c1-t2">
<pre>LIST<a id="sthref380"></a><a id="sthref381"></a>
</pre></td>
<td class="cellalignment1444" headers="r15c1-t2 r1c2-t2">
<pre>; or L
</pre></td>
<td class="cellalignment1444" headers="r15c1-t2 r1c3-t2">
<p>lists all lines<a id="sthref382"></a><a id="sthref383"></a> in the SQL buffer</p>
</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r16c1-t2" headers="r1c1-t2">
<pre>LIST <span class="italic">n</span>
</pre></td>
<td class="cellalignment1444" headers="r16c1-t2 r1c2-t2">
<pre>L <span class="italic">n</span> or <span class="italic">n</span>
</pre></td>
<td class="cellalignment1444" headers="r16c1-t2 r1c3-t2">
<p>lists line <span class="italic">n<a id="sthref384"></a></span></p>
</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r17c1-t2" headers="r1c1-t2">
<pre>LIST *<a id="sthref385"></a> <a id="sthref386"></a>
</pre></td>
<td class="cellalignment1444" headers="r17c1-t2 r1c2-t2">
<pre>L *
</pre></td>
<td class="cellalignment1444" headers="r17c1-t2 r1c3-t2">
<p>lists the current line<a id="sthref387"></a></p>
</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r18c1-t2" headers="r1c1-t2">
<pre>LIST <span class="italic">n</span> *
</pre></td>
<td class="cellalignment1444" headers="r18c1-t2 r1c2-t2">
<pre>L <span class="italic">n</span> *
</pre></td>
<td class="cellalignment1444" headers="r18c1-t2 r1c3-t2">
<p>lists line <span class="italic">n</span> through the current line</p>
</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r19c1-t2" headers="r1c1-t2">
<pre>LIST LAST
</pre></td>
<td class="cellalignment1444" headers="r19c1-t2 r1c2-t2">
<pre>L LAST
</pre></td>
<td class="cellalignment1444" headers="r19c1-t2 r1c3-t2">
<p>lists the last line<a id="sthref388"></a></p>
</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r20c1-t2" headers="r1c1-t2">
<pre>LIST <span class="italic">m</span> <span class="italic">n</span>
</pre></td>
<td class="cellalignment1444" headers="r20c1-t2 r1c2-t2">
<pre>L <span class="italic">m</span> <span class="italic">n</span>
</pre></td>
<td class="cellalignment1444" headers="r20c1-t2 r1c3-t2">
<p>lists a range of lines (<span class="italic">m</span> to <span class="italic">n</span>)<a id="sthref389"></a></p>
</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r21c1-t2" headers="r1c1-t2">
<pre>LIST * <span class="italic">n</span>
</pre></td>
<td class="cellalignment1444" headers="r21c1-t2 r1c2-t2">
<pre>L * <span class="italic">n</span>
</pre></td>
<td class="cellalignment1444" headers="r21c1-t2 r1c3-t2">
<p>lists the current line through line <span class="italic">n</span></p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<p>These are useful if you want to correct or modify a command you have entered.</p>
<div id="SQPUG414" class="sect2"><a id="sthref390"></a>
<h3 class="sect2">Listing the Buffer Contents</h3>
<p>The SQL buffer contains the last SQL or PL/SQL command. Any editing command other than LIST and DEL affects only a single line in the buffer<a id="sthref391"></a>. This line is called the current line. It is marked with an asterisk when you list the current command<a id="sthref392"></a> or block<a id="sthref393"></a>.</p>
<div id="SQPUG415" class="example">
<p class="titleinexample"><a id="sthref394"></a>Example 5-2 Listing the Buffer Contents</p>
<p>Suppose you want to list the current command. Use the LIST command as shown. (If you have exited SQL*Plus or entered another SQL command or PL/SQL block since following the steps in <a href="ch_four.htm#i1039424">Example 4-3, &#34;Entering a SQL Command&#34;</a>, perform the steps in that example again before continuing.)</p>
<pre>LIST
</pre></div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-2" summary="Shows output from example 5-2, LIST" dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t3">
<pre>SELECT EMPLOYEE_ID, LAST_NAME, JOB_ID, SALARY
  2  FROM EMP_DETAILS_VIEW
  3* WHERE SALARY&gt;12000
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Notice that the semicolon you entered at the end of the SELECT command is not listed. This semicolon<a id="sthref395"></a> is necessary to indicate the end of the command when you enter it, but it is not part of the SQL command and SQL*Plus does not store it in the SQL buffer.</p>
</div>
<!-- class="sect2" -->
<div id="SQPUG416" class="sect2"><a id="sthref396"></a>
<h3 class="sect2">Editing the Current Line</h3>
<p>The SQL*Plus CHANGE<a id="sthref397"></a> command enables you to edit<a id="sthref398"></a> the current line.<a id="sthref399"></a> Various actions determine which line<a id="sthref400"></a> is the current line:</p>
<ul>
<li>
<p>LIST<a id="sthref401"></a> a given line to make it the current line.</p>
</li>
<li>
<p>When you LIST<a id="sthref402"></a> or RUN<a id="sthref403"></a> the command in the buffer, the last line of the command becomes the current line. (Note, that using the slash (/) command to run the command in the buffer does not affect the current line.)</p>
</li>
<li>
<p>If you get an error<a id="sthref404"></a>, the error line automatically becomes the current line.</p>
</li>
</ul>
<div id="SQPUG417" class="example">
<p class="titleinexample"><a id="sthref405"></a>Example 5-3 Making an Error in Command Entry</p>
<p>Suppose you try to select the JOB_ID column but mistakenly enter it as JO_ID. Enter the following command, purposely misspelling JOB_ID in the first line:</p>
<pre>SELECT EMPLOYEE_ID, LAST_NAME, JO_ID, SALARY
FROM EMP_DETAILS_VIEW
WHERE JOB_ID=&#39;SA_MAN&#39;;
</pre>
<p>You see this message on your screen:</p>
</div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-3" summary="Shows error output from example 5-3, SELECT statement." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t4">
<pre>SELECT EMPLOYEE_ID, LAST_NAME, JO_ID, SALARY
                               *
ERROR at line 1:
ORA-00904: invalid column name
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Examine the error message; it indicates an invalid column name in line 1 of the query. The asterisk shows the point of error&mdash;the mis-typed column JOB_ID.</p>
<p>Instead of re-entering the entire command, you can correct the mistake by editing the command in the buffer. The line containing the error is now the current line. Use the CHANGE command to correct the mistake. This command has three parts, separated by slashes or any other non-alphanumeric character:</p>
<ul>
<li>
<p>the word CHANGE or the letter C</p>
</li>
<li>
<p>the sequence of characters you want to change</p>
</li>
<li>
<p>the replacement sequence of characters</p>
</li>
</ul>
<p>The CHANGE command finds the first occurrence in the current line of the character sequence to be changed and changes it to the new sequence. You do not need to use the CHANGE command to re-enter an entire line.</p>
<div id="SQPUG418" class="example">
<p class="titleinexample"><a id="i1210512"></a>Example 5-4 Correcting the Error</p>
<p>To change JO_ID to JOB_ID, change the line with the CHANGE command:</p>
<pre>CHANGE /JO_ID/JOB_ID
</pre>
<p>The corrected line appears on your screen:</p>
</div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-4" summary="Shows output from example 5-4, CHANGE command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t5">
<pre>1* SELECT EMPLOYEE_ID, FIRST_NAME, JOB_ID, SALARY
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Now that you have corrected the error, you can use the RUN command to run the command again:</p>
<pre>RUN
</pre>
<p>SQL*Plus correctly displays the query and its result:</p>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-4" summary="Shows output from example 5-4, RUN command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t6">
<pre>  1  SELECT EMPLOYEE_ID, LAST_NAME, JOB_ID, SALARY
  2  FROM EMP_DETAILS_VIEW
  3* WHERE JOB_ID=&#39;SA_MAN&#39;

EMPLOYEE_ID LAST_NAME                 JOB_ID     MONTHLY SALARY
----------- ------------------------- ---------- --------------
        145 Russell                   SA_MAN            $14,000
        146 Partners                  SA_MAN            $13,500
        147 Errazuriz                 SA_MAN            $12,000
        148 Cambrault                 SA_MAN            $11,000
        149 Zlotkey                   SA_MAN            $10,500
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Note that the column SALARY retains the format you gave it in <a href="ch_four.htm#i1039769">Example 4-4, &#34;Entering a SQL*Plus Command&#34;</a>. (If you have left SQL*Plus and started again since performing <a href="ch_four.htm#i1039769">Example 4-4, &#34;Entering a SQL*Plus Command&#34;</a> the column has reverted to its original format.)</p>
<p>See <a href="ch_twelve011.htm#i2673882">CHANGE</a> for information about the significance of case in a CHANGE command and on using wildcards to specify blocks of text in a CHANGE command.</p>
</div>
<!-- class="sect2" -->
<div id="SQPUG419" class="sect2"><a id="sthref406"></a>
<h3 class="sect2">Appending Text to a Line</h3>
<p>To add text<a id="sthref407"></a> to the end of a line<a id="sthref408"></a> in the buffer<a id="sthref409"></a>, use the APPEND<a id="sthref410"></a> command.</p>
<ol>
<li>
<p>Use the LIST command (or the line number) to list the line you want to change.</p>
</li>
<li>
<p>Enter APPEND followed by the text you want to add. If the text you want to add begins with a blank, separate the word APPEND from the first character of the text by two blanks: one to separate APPEND from the text, and one to go into the buffer with the text.</p>
</li>
</ol>
<div id="SQPUG420" class="example">
<p class="titleinexample"><a id="sthref411"></a>Example 5-5 Appending Text to a Line</p>
<p>To append a space and the clause DESC to line 4 of the current query, first list line 4:</p>
<pre>LIST 4
</pre></div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-5" summary="Shows output from example 5-5, LIST command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t7">
<pre>4* ORDER BY SALARY
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Next, enter the following command (be sure to type two spaces between APPEND and DESC):</p>
<pre>APPEND  DESC
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-5" summary="Shows output from example 5-5, APPEND command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t8">
<pre>4* ORDER BY SALARY DESC
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Type RUN to verify the query:</p>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-5" summary="Shows output from example 5-5, RUN command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t9">
<pre>  1  SELECT EMPLOYEE_ID, LAST_NAME, JOB_ID, SALARY
  2  FROM EMP_DETAILS_VIEW
  3  WHERE JOB_ID=&#39;SA_MAN&#39;
  4* ORDER BY SALARY DESC

EMPLOYEE_ID LAST_NAME                 JOB_ID     MONTHLY SALARY
----------- ------------------------- ---------- --------------
        145 Russell                   SA_MAN            $14,000
        146 Partners                  SA_MAN            $13,500
        147 Errazuriz                 SA_MAN            $12,000
        148 Cambrault                 SA_MAN            $11,000
        149 Zlotkey                   SA_MAN            $10,500
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" --></div>
<!-- class="sect2" -->
<div id="SQPUG421" class="sect2"><a id="sthref412"></a>
<h3 class="sect2">Adding a New Line</h3>
<p>To insert<a id="sthref413"></a> a new line<a id="sthref414"></a> after the current line, use the INPUT<a id="sthref415"></a> command.</p>
<p>To insert a line before line 1, enter a zero (&#34;0&#34;) and follow the zero with text. SQL*Plus inserts the line at the beginning of the buffer and all lines are renumbered starting at 1.</p>
<pre>0 SELECT EMPLOYEE_ID
</pre>
<div id="SQPUG422" class="example">
<p class="titleinexample"><a id="i1210576"></a>Example 5-6 Adding a Line</p>
<p>Suppose you want to add a fourth line to the SQL command you modified in <a href="#i1210512">Example 5-4, &#34;Correcting the Error&#34;</a>. Since line 3 is already the current line, enter INPUT and press Return.</p>
<pre>INPUT
</pre>
<p>SQL*Plus prompts you for the new line:</p>
</div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-6" summary="Shows prompt from example 5-6, INPUT command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t10">
<pre>4
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Enter the new line. Then press Return.</p>
<pre>4 ORDER BY SALARY
</pre>
<p>SQL*Plus prompts you again for a new line:</p>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-6" summary="Shows another new line prompt from example 5-6, INPUT command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t11">
<pre>5
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Press Return again to indicate that you will not enter any more lines, and then use RUN to verify and re-run the query.</p>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-6" summary="Shows output from example 5-6, RUN command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t12">
<pre>  1  SELECT EMPLOYEE_ID, LAST_NAME, JOB_ID, SALARY
  2  FROM EMP_DETAILS_VIEW
  3  WHERE JOB_ID=&#39;SA_MAN&#39;
  4* ORDER BY SALARY

EMPLOYEE_ID LAST_NAME                 JOB_ID     MONTHLY SALARY
----------- ------------------------- ---------- --------------
        149 Zlotkey                   SA_MAN            $10,500
        148 Cambrault                 SA_MAN            $11,000
        147 Errazuriz                 SA_MAN            $12,000
        146 Partners                  SA_MAN            $13,500
        145 Russell                   SA_MAN            $14,000
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" --></div>
<!-- class="sect2" -->
<div id="SQPUG423" class="sect2"><a id="sthref416"></a>
<h3 class="sect2">Deleting Lines</h3>
<p><a id="sthref417"></a>Use the DEL<a id="sthref418"></a> command to delete lines<a id="sthref419"></a> in the buffer. Enter DEL specifying the line numbers you want to delete.</p>
<p>Suppose you want to delete the current line to the last line inclusive. Use the DEL command as shown.</p>
<pre>DEL * LAST
</pre>
<p>DEL makes the following line of the buffer (if any) the current line.</p>
<p>See <a href="ch_twelve018.htm#i2675265">DEL</a> for more information.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1210024"></a>
<div id="SQPUG424" class="sect1">
<h2 class="sect1">Placing Comments in Scripts</h2>
<p>You can enter comments<a id="sthref420"></a> in a script<a id="sthref421"></a> in three ways:</p>
<ul>
<li>
<p>using the SQL*Plus REMARK command for single line comments.</p>
</li>
<li>
<p>using the SQL comment delimiters /*... */ for single or multi line comments.</p>
</li>
<li>
<p>using ANSI/ISO (American National Standards Institute/International Standards Organization) comments -&thinsp;- for single line comments.</p>
<p>Comments entered at the command-line are not stored in the SQL buffer.</p>
</li>
</ul>
<div id="SQPUG425" class="sect2"><a id="sthref422"></a>
<h3 class="sect2">Using the REMARK Command</h3>
<p>Use the REMARK<a id="sthref423"></a> command on a line by itself in a script, followed by comments<a id="sthref424"></a> on the same line. To continue the comments on additional lines, enter additional REMARK commands. Do not place a REMARK command between different lines of a single SQL command.</p>
<pre>REMARK Commission Report;
REMARK to be run monthly.;
COLUMN LAST_NAME HEADING &#39;LAST_NAME&#39;;
COLUMN SALARY HEADING &#39;MONTHLY SALARY&#39; FORMAT $99,999;
COLUMN COMMISSION_PCT HEADING &#39;COMMISSION %&#39; FORMAT 90.90;
REMARK Includes only salesmen;
SELECT LAST_NAME, SALARY, COMMISSION_PCT
FROM EMP_DETAILS_VIEW
WHERE JOB_ID=&#39;SA_MAN&#39;;
</pre></div>
<!-- class="sect2" -->
<div id="SQPUG426" class="sect2"><a id="sthref425"></a>
<h3 class="sect2">Using /*...*/</h3>
<p>Enter the SQL comment<a id="sthref426"></a> delimiters, /*...*/<a id="sthref427"></a>, on separate lines in your script, on the same line as a SQL command, or on a line in a PL/SQL block.</p>
<p>You must enter a space after the slash-asterisk(/*) beginning a comment.</p>
<p>The comments can span multiple lines, but cannot be nested within one another:</p>
<pre>/* Commission Report
 to be run monthly. */
COLUMN LAST_NAME HEADING &#39;LAST_NAME&#39;;
COLUMN SALARY HEADING &#39;MONTHLY SALARY&#39; FORMAT $99,999;
COLUMN COMMISSION_PCT HEADING &#39;COMMISSION %&#39; FORMAT 90.90;
REMARK Includes only salesmen;
SELECT LAST_NAME, SALARY, COMMISSION_PCT
FROM EMP_DETAILS_VIEW
/* Include only salesmen.*/
WHERE JOB_ID=&#39;SA_MAN&#39;; 
</pre></div>
<!-- class="sect2" -->
<div id="SQPUG427" class="sect2"><a id="sthref428"></a>
<h3 class="sect2">Using -&thinsp;-</h3>
<p>You can use ANSI/ISO &#34;-&thinsp;-&#34;<a id="sthref429"></a> style comments<a id="sthref430"></a> within SQL statements, PL/SQL blocks, or SQL*Plus commands. Since there is no ending delimiter, the comment cannot span multiple lines.</p>
<p>For PL/SQL and SQL, enter the comment after a command on a line, or on a line by itself:</p>
<pre>-- Commissions report to be run monthly
DECLARE --block for reporting monthly sales
</pre>
<p>For SQL*Plus commands, you can only include &#34;-&thinsp;-&#34; style comments if they are on a line by themselves. For example, these comments are legal:</p>
<pre>-- set maximum width for LONG to 777
SET LONG 777
</pre>
<p>This comment is illegal:</p>
<pre>SET LONG 777 -- set maximum width for LONG to 777
</pre>
<p>If you enter the following SQL*Plus command, SQL*Plus interprets it as a comment and does not execute the command:</p>
<pre>-- SET LONG 777
</pre></div>
<!-- class="sect2" -->
<a id="i1210782"></a>
<div id="SQPUG428" class="sect2">
<h3 class="sect2">Notes on Placing Comments</h3>
<p>SQL*Plus does not have a SQL or PL/SQL command parser. It scans the first few keywords of each new statement to determine the command type, SQL, PL/SQL or SQL*Plus. Comments in some locations can prevent SQL*Plus from correctly identifying the command type, giving unexpected results. The following usage notes may help you to use SQL*Plus comments more effectively:</p>
<ol>
<li>
<p>Do not put comments within the first few keywords of a statement. For example:</p>
<pre>CREATE OR REPLACE
  2  /* HELLO */
  3  PROCEDURE HELLO AS
  4  BEGIN
  5  DBMS_OUTPUT.PUT_LINE(&#39;HELLO&#39;);
  6  END;
  7  /

Warning: Procedure created with compilation errors.
</pre>
<p>The location of the comment prevents SQL*Plus from recognizing the command as a command. SQL*Plus submits the PL/SQL block to the server when it sees the slash &#34;/&#34; at the beginning of the comment, which it interprets as the &#34;/&#34; statement terminator. Move the comment to avoid this error. For example:</p>
<pre> CREATE OR REPLACE PROCEDURE
  2  /* HELLO */
  3  HELLO AS
  4  BEGIN
  5  DBMS_OUTPUT.PUT_LINE(&#39;HELLO&#39;);
  6  END;
  7  /

Procedure created.
</pre></li>
<li>
<p>Do not put comments after statement terminators (period, semicolon or slash). For example, if you enter:</p>
<pre>SELECT &#39;Y&#39; FROM DUAL; -- TESTING
</pre>
<p>You get the following error:</p>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from placing comments" summary="Shows error output from bad comment placement in SELECT statement." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t13">
<pre>SELECT &#39;Y&#39; FROM DUAL; -- TESTING
                    *
ERROR at line 1:
ORA-00911: invalid character
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>SQL*Plus expects no text after a statement terminator and is unable to process the command.</p>
</li>
<li>
<p>Do not put statement termination characters at the end of a comment line or after comments in a SQL statement or a PL/SQL block. For example, if you enter:</p>
<pre>SELECT *
-- COMMENT;
</pre>
<p>You get the following error:</p>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from placing comments" summary="Shows error output from bad comment placement in SELECT statement." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t14">
<pre>-- COMMENT
         *
ERROR at line 2:
ORA-00923: FROM keyword not found where expected
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>The semicolon is interpreted as a statement terminator and SQL*Plus submits the partially formed SQL command to the server for processing, resulting in an error.</p>
</li>
<li>
<p>Do not use ampersand characters &#39;&amp;&#39; in comments in a SQL statement or PL/SQL block. For example, if you enter a script such as:</p>
<pre>SELECT REGION_NAME, CITY
/* THIS &amp; THAT */
FROM EMP_DETAILS_VIEW
WHERE SALARY&gt;12000;
</pre>
<p>SQL*Plus interprets text after the ampersand character &#34;&amp;&#34; as a substitution variable and prompts for the value of the variable, &amp;that:</p>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from placing comments" summary="Shows output from comment containing ampersand interpreted as substitution variable." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t15">
<pre>Enter value for that: 
old   2: /* THIS &amp; THAT */
new   2: /* THIS  */

REGION_NAME               CITY
------------------------- ------------------------------
Americas                  Seattle
Americas                  Seattle
Americas                  Seattle
Europe                    Oxford
Europe                    Oxford
Americas                  Toronto
6 rows selected.
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>You can SET DEFINE OFF to prevent scanning for the substitution character.</p>
</li>
</ol>
<p>For more information on substitution and termination characters, see DEFINE, SQLTERMINATOR and SQLBLANKLINES in the <a href="ch_twelve039.htm#i2698538">SET</a> command.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1210918"></a>
<div id="SQPUG429" class="sect1">
<h2 class="sect1">Running Scripts</h2>
<p>The START<a id="sthref431"></a> command retrieves a script<a id="sthref432"></a> and runs the commands it contains. Use START<a id="sthref433"></a> to run a script<a id="sthref434"></a> containing SQL commands, PL/SQL blocks, and SQL*Plus commands. You can have many commands in the file. Follow the START command with the name of the file:</p>
<pre>START <span class="italic">file_name</span>
</pre>
<p>SQL*Plus assumes the file has a .SQL extension by default.</p>
<div id="SQPUG430" class="example">
<p class="titleinexample"><a id="sthref435"></a>Example 5-7 Running a Script</p>
<p>To retrieve and run the command stored in SALES.SQL, enter</p>
<pre>START SALES
</pre>
<p>SQL*Plus runs the commands in the file SALES and displays the results of the commands on your screen, formatting the query results according to the SQL*Plus commands in the file:</p>
</div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-7" summary="Shows output from example 5-7, START SALES." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t16">
<pre>LAST NAME                 MONTHLY SALARY COMMISSION %
------------------------- -------------- ------------
Russell                          $14,000         0.40
Partners                         $13,500         0.30
Errazuriz                        $12,000         0.30
Cambrault                        $11,000         0.30
Zlotkey                          $10,500         0.20
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>You can also use the @ (at sign)<a id="sthref436"></a> command to run a script<a id="sthref437"></a>:</p>
<pre>@SALES
</pre>
<p>The @<a id="sthref438"></a> and @@ commands list and run the commands in the specified script<a id="sthref439"></a> in the same manner as START<a id="sthref440"></a>. SET ECHO affects the @ and @@ commands in the same way as it affects the START command.</p>
<p>To see the commands as SQL*Plus &#34;enters&#34; them, you can SET ECHO<a id="sthref441"></a> ON. The ECHO system variable controls the listing of the commands in scripts run with the START, @ and @@ commands. Setting the ECHO variable OFF suppresses the listing.</p>
<p>START, @ and @@ leave the last SQL command or PL/SQL block of the script in the buffer.</p>
<div id="SQPUG431" class="sect2"><a id="sthref442"></a>
<h3 class="sect2">Running a Script as You Start SQL*Plus</h3>
<p>To run a <a id="sthref443"></a>script<a id="sthref444"></a> as you start SQL*Plus, use one of the following options:</p>
<ul>
<li>
<p>Follow the SQLPLUS command with your username, a slash, a space, @, and the name of the file:</p>
<pre>SQLPLUS HR @SALES
</pre>
<p>SQL*Plus starts, prompts for your password and runs the script.</p>
</li>
<li>
<p>Include your username as the first line of the file. Follow the SQLPLUS command with @ and the filename. SQL*Plus starts, prompts for your password and runs the file.</p>
</li>
</ul>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1211006"></a>
<div id="SQPUG432" class="sect1">
<h2 class="sect1">Nesting Scripts</h2>
<p>To run a series of scripts<a id="sthref445"></a> in<a id="sthref446"></a> sequence, first create a script containing several START commands, each followed by the name of a script in the sequence. Then run the script containing the START commands. For example, you could include the following START commands in a script named SALESRPT:</p>
<pre>START Q1SALES
START Q2SALES
START Q3SALES
START Q4SALES
START YRENDSLS
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
The @@ command may be useful in this example. See the <a href="ch_twelve003.htm#BACIEHDJ">@@ (double at sign)</a> command for more information.</div>
</div>
<!-- class="sect1" -->
<a id="i1211029"></a>
<div id="SQPUG433" class="sect1">
<h2 class="sect1">Exiting from a Script with a Return Code</h2>
<p>You can include an EXIT command in a script to return a value when the script finishes. See the <a href="ch_twelve023.htm#BACEFBGB">EXIT</a> command for more information.</p>
<p>You can include a WHENEVER SQLERROR command in a script to automatically exit SQL*Plus with a return code should your <a id="sthref447"></a>script<a id="sthref448"></a> generate a SQL error<a id="sthref449"></a>. Similarly, you can include a WHENEVER OSERROR command to automatically exit should an operating system error occur. See the <a href="ch_twelve052.htm#BACHCFEF">WHENEVER SQLERROR</a> command, and the <a href="ch_twelve051.htm#BACJJGEE">WHENEVER OSERROR</a> command for more information.</p>
</div>
<!-- class="sect1" -->
<a id="i1211130"></a>
<div id="SQPUG434" class="sect1">
<h2 class="sect1">Defining Substitution Variables</h2>
<p>You can define variables, called substitution variables,<a id="sthref450"></a> for repeated use in a single script by using the SQL*Plus DEFINE command<a id="sthref451"></a>. Note that you can also define substitution variables<a id="sthref452"></a> to use in titles and to save your keystrokes (by defining a long string as the value for a variable with a short name).</p>
<div id="SQPUG435" class="example">
<p class="titleinexample"><a id="sthref453"></a>Example 5-8 Defining a Substitution Variable</p>
<p>To define a substitution variable L_NAME and give it the value &#34;SMITH&#34;, enter the following command:</p>
<pre>DEFINE L_NAME = SMITH
</pre>
<p>To confirm the variable<a id="sthref454"></a> definition, enter DEFINE followed by the variable name:</p>
<pre>DEFINE L_NAME
</pre></div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-8" summary="Shows output from example 5-8, DEFINE L_NAME." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t18">
<pre>DEFINE L_NAME = &#34;SMITH&#34; (CHAR)
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>To list all substitution variable<a id="sthref455"></a> definitions, enter DEFINE by itself. Note that any substitution variable you define explicitly through DEFINE takes only CHAR values (that is, the value you assign to the variable is always treated as a CHAR datatype). You can define a substitution variable of datatype NUMBER implicitly through the ACCEPT command. You will learn more about the ACCEPT command.</p>
<p>To delete a substitution variable<a id="sthref456"></a>, use the SQL*Plus command UNDEFINE<a id="sthref457"></a><a id="sthref458"></a> followed by the variable name.</p>
</div>
<!-- class="sect1" -->
<a id="i1211158"></a>
<div id="SQPUG436" class="sect1">
<h2 class="sect1">Using Predefined Variables</h2>
<p>There are eight variables containing SQL*Plus information that are defined during SQL*Plus installation. These variables can be redefined, referenced or removed the same as any other variable. They are always available from session to session unless you explicitly remove or redefine them.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<p><a href="ch_twelve017.htm#i2675128">Predefined Variables</a> for a list of the predefined variables and examples of their use.</p>
</div>
</div>
<!-- class="sect1" -->
<a id="CACIFHGB"></a>
<div id="SQPUG437" class="sect1">
<h2 class="sect1">Using Substitution Variables</h2>
<p>Suppose you want to write a query like the one in SALES (see <a href="#i1210192">Example 5-1, &#34;Using a System Editor to Write a SQL Script&#34;</a>) to list the employees with various jobs, not just those whose job is SA_MAN. You could do that by editing a different value into the WHERE clause each time you run the command, but there is an easier way.</p>
<p>By using a substitution variable<a id="sthref459"></a> in place of the text, SA_MAN, in the WHERE clause, you can get the same results you would get if you had written the values into the command itself.</p>
<p>A substitution variable is preceded by one or two ampersands<a id="sthref460"></a><a id="sthref461"></a> (&amp;). When SQL*Plus encounters a substitution variable in a command, SQL*Plus executes the command as though it contained the value of the substitution variable, rather than the variable itself.</p>
<p>For example, if the variable SORTCOL has the value JOB_ID and the variable MYTABLE has the value EMP_DETAILS_VIEW, SQL*Plus executes the commands</p>
<pre>SELECT &amp;SORTCOL, SALARY
FROM &amp;MYTABLE
WHERE SALARY&gt;12000;
</pre>
<p>as if they were</p>
<pre>SELECT JOB_ID, SALARY
FROM EMP_DETAILS_VIEW
WHERE SALARY&gt;12000;
</pre>
<div id="SQPUG438" class="sect2"><a id="sthref462"></a>
<h3 class="sect2">Where and How to Use Substitution Variables</h3>
<p>You can use substitution variables<a id="sthref463"></a> anywhere in SQL and SQL*Plus commands, except as the first word entered. When SQL*Plus encounters an <a id="sthref464"></a>undefined substitution variable in a command, SQL*Plus prompts you for the value.<a id="sthref465"></a></p>
<p>You can enter any string at the prompt, even one containing blanks and punctuation. If the SQL command containing the reference should have quote marks around the variable and you do not include them there, the user must include the quotes when prompted.</p>
<p>SQL*Plus reads your response from the keyboard, even if you have redirected terminal input or output to a file. If a terminal is not available (if, for example, you run the script in batch mode), SQL*Plus uses the redirected file.</p>
<p>After you enter a value at the prompt, SQL*Plus lists the line containing the substitution variable twice: once before substituting the value you enter and once after substitution. You can suppress this listing by setting the SET<a id="sthref466"></a> command variable VERIFY<a id="sthref467"></a> to OFF.</p>
<div id="SQPUG439" class="example">
<p class="titleinexample"><a id="i1211231"></a>Example 5-9 Using Substitution Variables</p>
<p>Create a script named STATS, to be used to calculate a subgroup statistic (the maximum value) on a numeric column:</p>
<pre>SELECT &amp;GROUP_COL, MAX(&amp;NUMBER_COL) MAXIMUM
FROM &amp;TABLE
GROUP BY &amp;GROUP_COL
.
SAVE STATS
</pre></div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-9" summary="Shows output from example 5-9, SAVE STATS." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t20">
<pre>Created file STATS
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Now run the script STATS:</p>
<pre>@STATS
</pre>
<p>And respond to the prompts for values as shown:</p>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-9" summary="Shows prompts from example 5-9, @STATS." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t21">
<pre>Enter value for group_col: JOB_ID
old   1: SELECT   &amp;GROUP_COL,
new   1: SELECT   JOB_ID,
Enter value for number_col: SALARY
old   2:          MAX(&amp;NUMBER_COL) MAXIMUM
new   2:          MAX(SALARY) MAXIMUM
Enter value for table: EMP_DETAILS_VIEW
old   3: FROM     &amp;TABLE
new   3: FROM     EMP_DETAILS_VIEW
Enter value for group_col: JOB_ID
old   4: GROUP BY &amp;GROUP_COL
new   4: GROUP BY JOB_ID
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>SQL*Plus displays the following output:</p>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-9" summary="Shows output from example 5-9, @STATS." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t22">
<pre>JOB_ID        MAXIMUM
---------- ----------
AC_ACCOUNT       8300
AC_MGR          12000
AD_ASST          4400
AD_PRES         24000
AD_VP           17000
FI_ACCOUNT       9000
FI_MGR          12000
HR_REP           6500
IT_PROG          9000
MK_MAN          13000
MK_REP           6000

JOB_ID        MAXIMUM
---------- ----------
PR_REP          10000
PU_CLERK         3100
PU_MAN          11000
SA_MAN          14000
SA_REP          11500
SH_CLERK         4200
ST_CLERK         3600
ST_MAN           8200

19 rows selected.
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>If you wish to append characters immediately after a substitution variable<a id="sthref468"></a>, use a period to separate the variable from the character. For example:</p>
<pre>SELECT SALARY FROM EMP_DETAILS_VIEW WHERE EMPLOYEE_ID=&#39;&amp;X.5&#39;;
Enter value for X:  20
</pre>
<p>is interpreted as</p>
<pre>SELECT SALARY FROM EMP_DETAILS_VIEW WHERE EMPLOYEE_ID=&#39;205&#39;;
</pre></div>
<!-- class="sect2" -->
<div id="SQPUG440" class="sect2"><a id="sthref469"></a>
<h3 class="sect2">Avoiding Unnecessary Prompts for Values</h3>
<p>Suppose<a id="sthref470"></a> you<a id="sthref471"></a> wanted to expand the file STATS to include the minimum, sum, and average of the &#34;number&#34; column. You may have noticed that SQL*Plus prompted you twice for the value of GROUP_COL and once for the value of NUMBER_COL in <a href="#i1211231">Example 5-9, &#34;Using Substitution Variables&#34;</a>, and that each GROUP_COL or NUMBER_COL had a single ampersand in front of it. If you were to add three more functions&mdash;using a single ampersand before each&mdash;to the script, SQL*Plus would prompt you a total of four times for the value of the number column.</p>
<p><a id="sthref472"></a><a id="sthref473"></a>You can avoid being re-prompted for the group and number columns by adding a second ampersand in front of each GROUP_COL and NUMBER_COL in STATS. SQL*Plus automatically DEFINEs any substitution variable preceded by two ampersands, but does not DEFINE those preceded by only one ampersand. When you have defined a variable, SQL*Plus will not prompt for its value in the current session.</p>
<div id="SQPUG441" class="example">
<p class="titleinexample"><a id="sthref474"></a>Example 5-10 Using Double Ampersands</p>
<p>To expand the script STATS using double ampersands and then run the file, first suppress the display of each line before and after substitution:</p>
<pre>SET VERIFY OFF
</pre>
<p>Now retrieve and edit STATS by entering the following commands:</p>
<pre>GET STATS
</pre></div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-10" summary="Shows output from example 5-10, GET STATS." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t23">
<pre>SELECT   &amp;GROUP_COL,
MAX(&amp;NUMBER_COL) MAXIMUM
FROM     &amp;TABLE
GROUP BY &amp;GROUP_COL
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>2
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-10" summary="Shows output from example 5-10, 2." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t24">
<pre>2* MAX(&amp;NUMBER_COL) MAXIMUM
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>APPEND ,
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-10" summary="Shows output from example 5-10, APPEND command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t25">
<pre>2* MAX(&amp;NUMBER_COL) MAXIMUM,
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>CHANGE/&amp;/&amp;&amp;
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-10" summary="Shows output from example 5-10, CHANGE command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t26">
<pre>2* MAX(&amp;&amp;NUMBER_COL) MAXIMUM,
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>I
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-10" summary="Shows output from example 5-10, INSERT command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t27">
<pre>3i
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>MIN (&amp;&amp;NUMBER_COL) MINIMUM,
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-10" summary="Shows output from example 5-10, MINIMUM command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t28">
<pre>4i
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>SUM(&amp;&amp;NUMBER_COL)  TOTAL,
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-10" summary="Shows output from example 5-10, TOTAL command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t29">
<pre>5i
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>AVG(&amp;&amp;NUMBER_COL)  AVERAGE
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-10" summary="Shows output from example 5-10, AVERAGE command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t30">
<pre>6i
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>1
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-10" summary="Shows output from example 5-10, to display line 1." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t31">
<pre>1* SELECT   &amp;GROUP_COL,
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>CHANGE/&amp;/&amp;&amp;
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-10" summary="Shows output from example 5-10, CHANGE command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t32">
<pre>1* SELECT   &amp;&amp;GROUP_COL,
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>7
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-10" summary="Shows output from example 5-10, to display line 7." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t33">
<pre>7* GROUP BY &amp;GROUP_COL
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>CHANGE/&amp;/&amp;&amp;/
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-10" summary="Shows output from example 5-10, CHANGE command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t34">
<pre>7* GROUP BY &amp;&amp;GROUP_COL
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>SAVE STATS2
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-10" summary="Shows output from example 5-10, SAVE STATS." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t35">
<pre>Created file STATS2
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Finally, run the script STATS2 and respond to the prompts as follows:</p>
<pre>START STATS2
Enter value for group_col: JOB_ID
Enter value for number_col: SALARY
Enter value for table: EMP_DETAILS_VIEW
</pre>
<p>SQL*Plus displays the following output:</p>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-10" summary="Shows output from example 5-10, START STATS." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t36">
<pre>JOB_ID        MAXIMUM    MINIMUM      TOTAL    AVERAGE
---------- ---------- ---------- ---------- ----------
AC_ACCOUNT       8300       8300       8300       8300
AC_MGR          12000      12000      12000      12000
AD_ASST          4400       4400       4400       4400
AD_PRES         24000      24000      24000      24000
AD_VP           17000      17000      34000      17000
FI_ACCOUNT       9000       6900      39600       7920
FI_MGR          12000      12000      12000      12000
HR_REP           6500       6500       6500       6500
IT_PROG          9000       4200      28800       5760
MK_MAN          13000      13000      13000      13000
MK_REP           6000       6000       6000       6000

JOB_ID        MAXIMUM    MINIMUM      TOTAL    AVERAGE
---------- ---------- ---------- ---------- ----------
PR_REP          10000      10000      10000      10000
PU_CLERK         3100       2500      13900       2780
PU_MAN          11000      11000      11000      11000
SA_MAN          14000      10500      61000      12200
SA_REP          11500       6100     250500       8350
SH_CLERK         4200       2500      64300       3215
ST_CLERK         3600       2100      55700       2785
ST_MAN           8200       5800      36400       7280

19 rows selected.
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Note that you were prompted for the values of NUMBER_COL and GROUP_COL only once. If you were to run STATS2 again during the current session, you would be prompted for TABLE (because its name has a single ampersand and the variable is therefore not DEFINEd) but not for GROUP_COL or NUMBER_COL (because their names have double ampersands and the variables are therefore DEFINEd).</p>
<p>Before continuing, set the system variable VERIFY back to ON:</p>
<pre>SET VERIFY ON
</pre></div>
<!-- class="sect2" -->
<div id="SQPUG442" class="sect2"><a id="sthref475"></a>
<h3 class="sect2">Restrictions</h3>
<p>You cannot use substitution variables<a id="sthref476"></a> in the buffer editing commands, APPEND, CHANGE, DEL, and INPUT, nor in other commands where substitution would be meaningless. The buffer editing commands, APPEND, CHANGE, and INPUT, treat text beginning with &#34;&amp;&#34; or &#34;&amp;&amp;&#34; literally, like any other text string.</p>
</div>
<!-- class="sect2" -->
<div id="SQPUG443" class="sect2"><a id="sthref477"></a>
<h3 class="sect2">System Variables</h3>
<p><a id="sthref478"></a><a id="sthref479"></a>The following system variables, specified with the SQL*Plus SET command, affect substitution variables<a id="sthref480"></a>:</p>
<div class="inftblinformal">
<table class="cellalignment1443" title="System Variables that Affect Substitution Variables" summary="2 column table showing the system variables that affect substitution variables and their descriptions." dir="ltr">
<thead>
<tr class="cellalignment1437">
<th class="cellalignment1448" id="r1c1-t37">System Variable</th>
<th class="cellalignment1448" id="r1c2-t37">Affect on Substitution Variables</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r2c1-t37" headers="r1c1-t37">
<pre>SET CONCAT
</pre></td>
<td class="cellalignment1444" headers="r2c1-t37 r1c2-t37"><a id="sthref481"></a><a id="sthref482"></a>Defines the character that separates the name of a substitution variable or parameter from characters that immediately follow the variable or parameter&mdash;by default the period (.).</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r3c1-t37" headers="r1c1-t37">
<pre>SET DEFINE
</pre></td>
<td class="cellalignment1444" headers="r3c1-t37 r1c2-t37"><a id="sthref483"></a><a id="sthref484"></a><a id="sthref485"></a>Defines the substitution character (by default the ampersand &#34;&amp;&#34;) and turns substitution on and off.</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r4c1-t37" headers="r1c1-t37">
<pre>SET ESCAPE
</pre></td>
<td class="cellalignment1444" headers="r4c1-t37 r1c2-t37"><a id="sthref486"></a><a id="sthref487"></a>Defines an escape character you can use before the substitution character. The escape character instructs SQL*Plus to treat the substitution character as an ordinary character rather than as a request for variable substitution. The default escape character is a backslash (\).</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r5c1-t37" headers="r1c1-t37">
<pre>SET NUMFORMAT
</pre></td>
<td class="cellalignment1444" headers="r5c1-t37 r1c2-t37"><a id="sthref488"></a><a id="sthref489"></a>Sets the default format for displaying<a id="sthref490"></a> numbers, including numeric substitution variables.</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r6c1-t37" headers="r1c1-t37">
<pre>SET NUMWIDTH
</pre></td>
<td class="cellalignment1444" headers="r6c1-t37 r1c2-t37"><a id="sthref491"></a><a id="sthref492"></a>Sets the default width for displaying<a id="sthref493"></a> numbers, including numeric substitution variables.</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r7c1-t37" headers="r1c1-t37">
<pre>SET VERIFY ON
</pre></td>
<td class="cellalignment1444" headers="r7c1-t37 r1c2-t37"><a id="sthref494"></a><a id="sthref495"></a>Lists each line of the script before and after substitution.</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblinformal" -->
<p>See <a href="ch_twelve039.htm#i2698538">SET</a> for more information about system variables.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CACIIEDF"></a>
<div id="SQPUG444" class="sect1">
<h2 class="sect1">Passing Parameters through the START Command</h2>
<p>You can bypass the prompts for values<a id="sthref496"></a> associated with substitution variables by passing values to parameters<a id="sthref497"></a> in a script<a id="sthref498"></a> through the START<a id="sthref499"></a> command.</p>
<p>You do this by placing an ampersand<a id="sthref500"></a> (&amp;) followed by a numeral in the script in place of a substitution variable. Each time you run this script, START replaces each &amp;1 in the file with the first value (called an argument<a id="sthref501"></a>) after START<a id="sthref502"></a> filename, then replaces each &amp;2 with the second value, and so forth.</p>
<p>For example, you could include the following commands in a script called MYFILE:</p>
<pre>SELECT * FROM EMP_DETAILS_VIEW
WHERE JOB_ID=&#39;&amp;1&#39;
AND SALARY=&#39;&amp;2&#39;;
</pre>
<p>In the following START command, SQL*Plus would substitute PU_CLERK for &amp;1 and 3100 for &amp;2 in the script MYFILE:</p>
<pre>START MYFILE PU_CLERK 3100
</pre>
<p>When you use arguments with the START command, SQL*Plus DEFINEs each parameter in the script with the value of the appropriate argument.</p>
<div id="SQPUG445" class="example">
<p class="titleinexample"><a id="sthref503"></a>Example 5-11 Passing Parameters through START</p>
<p>To create a new script based on SALES that takes a parameter specifying the job to be displayed, enter</p>
<pre>GET SALES
</pre></div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-11" summary="Shows output from example 5-11, GET SALES." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t38">
<pre>1  COLUMN LAST_NAME HEADING &#39;LAST NAME&#39;
2  COLUMN SALARY  HEADING &#39;MONTHLY SALARY&#39; FORMAT $99,999
3  COLUMN COMMISSION_PCT HEADING &#39;COMMISSION %&#39; FORMAT 90.90
4  SELECT LAST_NAME, SALARY, COMMISSION_PCT
5  FROM EMP_DETAILS_VIEW
6* WHERE JOB_ID=&#39;SA_MAN&#39;
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>6
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-11" summary="Shows output from example 5-11 to display line 6." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t39">
<pre>6* WHERE JOB_ID=&#39;SA_MAN&#39;
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>CHANGE /SA_MAN/&amp;1
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-11" summary="Shows output from example 5-11, CHANGE command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t40">
<pre>6* WHERE JOB_ID=&#39;&amp;1&#39;
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>SAVE ONEJOB
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-11" summary="Shows output from example 5-11, SAVE ONEJOB." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t41">
<pre>Created file ONEJOB
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Now run the command with the parameter SA_MAN:</p>
<pre>START ONEJOB SA_MAN
</pre>
<p>SQL*Plus lists the line of the SQL command that contains the parameter, before and after replacing the parameter with its value, and then displays the output:</p>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-11" summary="Shows output from example 5-11, START ONEJOB SA_MAN." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t42">
<pre>old   3: WHERE JOB_ID=&#39;&amp;1&#39;
new   3: WHERE JOB_ID=&#39;SA_MAN&#39;

LAST NAME                 MONTHLY SALARY COMMISSION %
------------------------- -------------- ------------
Russell                          $14,000         0.40
Partners                         $13,500         0.30
Errazuriz                        $12,000         0.30
Cambrault                        $11,000         0.30
Zlotkey                          $10,500         0.20
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>You can use many parameters in a script. Within a script, you can refer to each parameter many times, and you can include the parameters in any order.</p>
<p>While you cannot use parameters when you run a command with RUN or slash (/), you could use substitution variables instead.</p>
<p>Before continuing, return the columns to their original heading by entering the following command:</p>
<pre>CLEAR COLUMN
</pre></div>
<!-- class="sect1" -->
<a id="CACHDBHG"></a>
<div id="SQPUG446" class="sect1">
<h2 class="sect1">Communicating with the User</h2>
<p>Three SQL*Plus commands&mdash;PROMPT, ACCEPT, and PAUSE&mdash;help you communicate with the end user. These commands enable you to send messages to the screen and receive input from the user, including a simple Return. You can also use PROMPT and ACCEPT to customize the prompts for values SQL*Plus automatically generates for substitution variables.</p>
<div id="SQPUG447" class="sect2"><a id="sthref504"></a>
<h3 class="sect2">Receiving a Substitution Variable Value</h3>
<p>Through PROMPT<a id="sthref505"></a> and ACCEPT<a id="sthref506"></a>, you can send messages to the end user and receive values from end-user input<a id="sthref507"></a>. PROMPT displays a message<a id="sthref508"></a> you specify on-screen to give directions or information to the user. ACCEPT prompts the user for a value<a id="sthref509"></a> and stores it in the substitution variabl<a id="sthref510"></a>e you specify. Use PROMPT in conjunction with ACCEPT when a prompt spans more than one line.</p>
<div id="SQPUG448" class="example">
<p class="titleinexample"><a id="i1211672"></a>Example 5-12 Prompting for and Accepting Input</p>
<p>To direct the user to supply a report title and to store the input in the variable MYTITLE for use in a subsequent query, first clear the buffer:</p>
<pre>CLEAR BUFFER
</pre>
<p>Next, set up a script as shown<a id="sthref511"></a> and save this file as PROMPT1:<a id="sthref512"></a></p>
<pre>PROMPT Enter a title of up to 30 characters
ACCEPT MYTITLE PROMPT &#39;Title: &#39;
TTITLE LEFT MYTITLE SKIP 2
SELECT EMPLOYEE_ID, FIRST_NAME, LAST_NAME, SALARY
FROM EMP_DETAILS_VIEW
WHERE JOB_ID=&#39;SA_MAN&#39;
  
SAVE PROMPT1
</pre></div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-12" summary="Shows output from example 5-12, SAVE PROMPT1." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t43">
<pre>Created file PROMPT1.sql
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>The TTITLE command sets the top title for your report. See <a href="ch_six.htm#i1082069">Defining Page and Report Titles and Dimensions</a> for more information about the TTITILE command.</p>
<p>Finally, run the script, responding to the prompt for the title as shown:</p>
<pre>START PROMPT1
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-12" summary="Shows output from example 5-12, START PROMPT1." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t44">
<pre>Enter a title of up to 30 characters
Title: Department Report
Department ReportEMPLOYEE_ID FIRST_NAME           LAST_NAME                     SALARY
----------- -------------------- ------------------------- ----------
        145 John                 Russell                        14000
        146 Karen                Partners                       13500
        147 Alberto              Errazuriz                      12000
        148 Gerald               Cambrault                      11000
        149 Eleni                Zlotkey                        10500
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Before continuing, turn the TTITLE command off:</p>
<pre>TTITLE OFF
</pre></div>
<!-- class="sect2" -->
<div id="SQPUG449" class="sect2"><a id="sthref513"></a>
<h3 class="sect2">Customizing Prompts for Substitution Variable</h3>
<p>If you want to customize the prompt for a substitution variable value<a id="sthref514"></a>, use PROMPT<a id="sthref515"></a> and ACCEPT<a id="sthref516"></a> in conjunction with the substitution variable, as shown in the following example.</p>
<div id="SQPUG450" class="example">
<p class="titleinexample"><a id="sthref517"></a>Example 5-13 Using PROMPT and ACCEPT in Conjunction with Substitution Variables</p>
<p>As you have seen in <a href="#i1211672">Example 5-12, &#34;Prompting for and Accepting Input&#34;</a>, SQL*Plus automatically generates a prompt for a value when you use a substitution variable. You can replace this prompt by including PROMPT and ACCEPT in the script with the query that references the substitution variable. First clear the buffer with:</p>
<pre>CLEAR BUFFER
</pre>
<p>To create such a file, enter the following:</p>
<pre>INPUT
PROMPT Enter a valid employee ID
PROMPT For Example 145, 206
ACCEPT ENUMBER NUMBER PROMPT &#39;Employee ID. :&#39;
SELECT FIRST_NAME, LAST_NAME, SALARY
FROM EMP_DETAILS_VIEW
WHERE EMPLOYEE_ID=&amp;ENUMBER;
</pre>
<p>Save this file as PROMPT2. Next, run this script. SQL*Plus prompts for the value of ENUMBER using the text you specified with PROMPT and ACCEPT:</p>
<pre>START PROMPT2
</pre>
<p>SQL*Plus prompts you to enter an Employee ID:</p>
</div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-13" summary="Shows prompt from example 5-13, START PROMPT2." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t45">
<pre>Enter a valid employee ID
For Example 145, 206

Employee ID. :
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>205
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-13" summary="Shows output from example 5-13 when value 205 entered." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t46">
<pre>old   3: WHERE EMPLOYEE_ID=&amp;ENUMBER
new   3: WHERE EMPLOYEE_ID=       205

Department Report

FIRST_NAME           LAST_NAME                     SALARY
-------------------- ------------------------- ----------
Shelley              Higgins                        12000
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>What would happen if you typed characters instead of numbers? Since you specified NUMBER<a id="sthref518"></a> after the variable name in the ACCEPT<a id="sthref519"></a> command, SQL*Plus will not accept a non-numeric value:</p>
<p>Try entering characters instead of numbers to the prompt for &#34;Employee ID.&#34;, SQL*Plus will respond with an error message and prompt you again to re-enter the correct number:</p>
<pre>START PROMPT2
</pre>
<p>When SQL*Plus prompts you to enter an Employee ID, enter the word &#34;one&#34; instead of a number:</p>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-13" summary="Shows prompt from example 5-13, START PROMPT2." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t47">
<pre>Enter a valid employee ID
For Example 145, 206

Employee ID. :
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>one
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-13" summary="Shows error output from example 5-13 when value &#34;one&#34; entered." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t48">
<pre>SP2-0425: &#34;one&#34; is not a valid number
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" --></div>
<!-- class="sect2" -->
<div id="SQPUG451" class="sect2"><a id="sthref520"></a>
<h3 class="sect2">Sending a Message and Accepting Return as Input</h3>
<p><a id="sthref521"></a>If you want to display a message on the user&#39;s screen and then have the user press Return after reading the message, use the SQL*Plus command PAUSE<a id="sthref522"></a>. For example, you might include the following lines in a script:</p>
<pre>PROMPT Before continuing, make sure you have your account card.
PAUSE Press RETURN to continue.
</pre></div>
<!-- class="sect2" -->
<div id="SQPUG452" class="sect2"><a id="sthref523"></a>
<h3 class="sect2">Clearing the Screen</h3>
<p>If you want to clear the screen<a id="sthref524"></a> before displaying a report (or at any other time), include the SQL*Plus CLEAR<a id="sthref525"></a> command with its SCREEN<a id="sthref526"></a> clause at the appropriate point in your script, using the following format:</p>
<pre>CLEAR SCREEN
</pre>
<p>Before continuing to the next section, reset all columns to their original formats and headings by entering the following command:</p>
<pre>CLEAR COLUMNS
</pre></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1211850"></a>
<div id="SQPUG453" class="sect1">
<h2 class="sect1">Using Bind Variables<a id="sthref527"></a><a id="sthref528"></a><a id="sthref529"></a><a id="sthref530"></a></h2>
<p>Bind variables are variables you create in SQL*Plus and then reference in PL/SQL or SQL. If you create a bind variable in SQL*Plus, you can use the variable as you would a declared variable in your PL/SQL subprogram and then access the variable from SQL*Plus. You can use bind variables for such things as storing return codes or debugging your PL/SQL subprograms.</p>
<p>Because bind variables are recognized by SQL*Plus, you can display their values in SQL*Plus or reference them in PL/SQL subprograms that you run in SQL*Plus.</p>
<div id="SQPUG454" class="sect2"><a id="sthref531"></a>
<h3 class="sect2">Creating Bind Variables</h3>
<p>You create bind variables in SQL*Plus with the VARIABLE command. For example</p>
<pre>VARIABLE ret_val NUMBER
</pre>
<p>This command creates a bind variable named ret_val with a datatype of NUMBER. See the <a href="ch_twelve050.htm#BACGHCJE">VARIABLE</a> command for more information. (To list all bind variables created in a session, type VARIABLE without any arguments.)</p>
</div>
<!-- class="sect2" -->
<div id="SQPUG455" class="sect2"><a id="sthref532"></a>
<h3 class="sect2">Referencing Bind Variables</h3>
<p>You reference bind variables in PL/SQL by typing a colon (:) followed immediately by the name of the variable. For example</p>
<pre>:ret_val := 1;
</pre>
<p>To change this bind variable in SQL*Plus, you must enter a PL/SQL block. For example:</p>
<pre>BEGIN
 :ret_val:=4;
END;
/
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output message" summary="Shows output message from PL/SQL block." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t49">
<pre>PL/SQL procedure successfully completed.
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>This command assigns a value to the bind variable named <span class="italic">ret_val</span>.</p>
</div>
<!-- class="sect2" -->
<div id="SQPUG456" class="sect2"><a id="sthref533"></a>
<h3 class="sect2">Displaying Bind Variables</h3>
<p>To display the value of a bind variable in SQL*Plus, you use the SQL*Plus PRINT command. For example:</p>
<pre>PRINT RET_VAL
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from PRINT bind variable" summary="Shows output from PRINT command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t50">
<pre>   RET_VAL
----------
         4
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>This command displays a bind variable named ret_val. See <a href="ch_twelve031.htm#BACDCBCD">PRINT</a> for more information about displaying bind variables.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<div id="SQPUG457" class="sect1"><a id="sthref534"></a>
<h2 class="sect1">Using REFCURSOR Bind Variables</h2>
<p>SQL*Plus REFCURSOR bind variables allow SQL*Plus to fetch and format the results of a <a id="sthref535"></a>SELECT statement contained in a PL/SQL block.</p>
<p>REFCURSOR bind variables can also be used to reference PL/SQL cursor variables in stored procedures. This enables you to store SELECT statements in the database and reference them from SQL*Plus.</p>
<p><a id="sthref536"></a><a id="sthref537"></a>A REFCURSOR bind variable can also be returned from a stored function.</p>
<div id="SQPUG458" class="example">
<p class="titleinexample"><a id="sthref538"></a>Example 5-14 Creating, Referencing, and Displaying REFCURSOR Bind Variables</p>
<p>To create, reference and display a REFCURSOR bind variable, first declare a local bind variable of the REFCURSOR datatype</p>
<p>Next, enter a PL/SQL block that uses the bind variable in an OPEN... FOR SELECT statement. This statement opens a cursor variable and executes a query. See the <a class="olink LNPLS" href="../LNPLS/toc.htm"><span class="italic">Oracle Database PL/SQL Language Reference</span></a> for information on the OPEN command and cursor variables.</p>
<p>In this example we are binding the SQL*Plus <span class="italic">employee_info</span> bind variable to the cursor variable.</p>
<pre>BEGIN
OPEN :employee_info FOR SELECT EMPLOYEE_ID, SALARY
FROM    EMP_DETAILS_VIEW WHERE JOB_ID=&#39;SA_MAN&#39; ;
END;
 /
</pre></div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output message" summary="Shows message after running PL/SQL block." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t51">
<pre>PL/SQL procedure successfully completed.
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>The results from the SELECT statement can now be displayed in SQL*Plus with the PRINT command.</p>
<pre>PRINT employee_info
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from PRINT REFCURSOR" summary="Shows output from PRINT employee_info." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t52">
<pre>EMPLOYEE_ID     SALARY
----------- ----------
        145      14000
        146      13500
        147      12000
        148      11000
        149      10500
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>The PRINT statement also closes the cursor. To reprint the results, the PL/SQL block must be executed again before using PRINT.</p>
<div id="SQPUG459" class="example">
<p class="titleinexample"><a id="sthref539"></a>Example 5-15 Using REFCURSOR Variables in Stored Procedures</p>
<p>A REFCURSOR bind variable is passed as a parameter to a procedure. The parameter has a REF CURSOR type. First, define the type.</p>
<pre>CREATE OR REPLACE PACKAGE EmpPack AS
  TYPE EmpInfoTyp IS REF CURSOR;
  PROCEDURE EmpInfoRpt (emp_cv IN OUT EmpInfoTyp);
END EmpPack;
/
</pre></div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-15" summary="Shows output from example 5-15, CREATE package command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t53">
<pre>Package created.
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Next, create the stored procedure containing an OPEN... FOR SELECT statement.</p>
<pre>CREATE OR REPLACE PACKAGE BODY EmpPack AS
  PROCEDURE EmpInfoRpt (emp_cv IN OUT EmpInfoTyp) AS
  BEGIN
    OPEN emp_cv FOR SELECT EMPLOYEE_ID, SALARY
    FROM EMP_DETAILS_VIEW
    WHERE JOB_ID=&#39;SA_MAN&#39; ;
  END;
END;
 /
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-15" summary="Shows output from example 5-15, CREATE procedure command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t54">
<pre>Procedure created.
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Execute the procedure with a SQL*Plus bind variable as the parameter.</p>
<pre>VARIABLE cv REFCURSOR
EXECUTE EmpPack.EmpInfoRpt(:cv)
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-15" summary="Shows message output from example 5-15." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t55">
<pre>PL/SQL procedure successfully completed.
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Now print the bind variable.</p>
<pre>PRINT cv
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-15" summary="Shows output from example 5-15, PRINT odcv." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t56">
<pre>EMPLOYEE_ID     SALARY
----------- ----------
        145      14000
        146      13500
        147      12000
        148      11000
        149      10500
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>The procedure can be executed multiple times using the same or a different REFCURSOR bind variable.</p>
<pre>VARIABLE pcv REFCURSOR
EXECUTE EmpInfo_rpt(:pcv)
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-15" summary="Shows message output from example 5-15." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t57">
<pre>PL/SQL procedure successfully completed.
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>PRINT pcv
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-15" summary="Shows output from example 5-15, PRINT pcv." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t58">
<pre>EMPLOYEE_ID     SALARY
----------- ----------
        145      14000
        146      13500
        147      12000
        148      11000
        149      10500
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<div id="SQPUG460" class="example">
<p class="titleinexample"><a id="sthref540"></a>Example 5-16 Using REFCURSOR Variables in Stored Functions</p>
<p>Create a stored function containing an OPEN... FOR SELECT statement:</p>
<pre>CREATE OR REPLACE FUNCTION EmpInfo_fn RETURN -
cv_types.EmpInfo IS
resultset cv_types.EmpInfoTyp;
BEGIN
OPEN resultset FOR SELECT EMPLOYEE_ID, SALARY
FROM EMP_DETAILS_VIEW
WHERE JOB_ID=&#39;SA_MAN&#39;;
RETURN(resultset);
END;
/
</pre></div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-16" summary="Shows output from example 5-16, CREATE function command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t59">
<pre>Function created.
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Execute the function.</p>
<pre>VARIABLE rc REFCURSOR
EXECUTE :rc := EmpInfo_fn
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-16" summary="Shows output from example 5-16, EXECUTE function command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t60">
<pre>PL/SQL procedure successfully completed.
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>Now print the bind variable.</p>
<pre>PRINT rc
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-16" summary="Shows output from example 5-16, PRINT rc." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t61">
<pre>EMPLOYEE_ID     SALARY
----------- ----------
        145      14000
        146      13500
        147      12000
        148      11000
        149      10500
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>The function can be executed multiple times using the same or a different REFCURSOR bind variable.</p>
<pre>EXECUTE :rc := EmpInfo_fn
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 5-16" summary="Shows output from example 5-16, EXECUTE command." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t62">
<pre>PL/SQL procedure successfully completed.
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" --></div>
<!-- class="sect1" -->
<a id="i1211948"></a>
<div id="SQPUG200" class="sect1">
<h2 class="sect1">Fetching Iterative Results from a SELECT inside a PL/SQL Block</h2>
<p>SQL*Plus can iteratively fetch and format the results of a <a id="sthref541"></a>SELECT statement contained in a PL/SQL block or stored procedure. You do not need to define local REFCURSOR variables.</p>
<div id="SQPUG461" class="example">
<p class="titleinexample"><a id="sthref542"></a>Example 5-17 Creating a PL/SQL Procedure</p>
<p>Create a PL/SQL procedure P4 which calls two statements.</p>
<pre>create procedure p4 as
    c1 sys_refcursor;
    c2 sys_refcursor;
begin
    open c1 for SELECT * FROM DEBT;
    dbms_sql.return_result(c1);
    open c2 for SELECT * FROM EMP;
    dbms_sql.return_result(c2);
end;
/
Procedure created.
</pre>
<p>Next, run the procedure to retrieve results iteratively from the SELECT statements in the procedure.</p>
<pre>exec p4
PL/SQL procedure successfully completed.
</pre></div>
<!-- class="example" -->
<p>The results from the SELECT statements are displayed.</p>
<pre>ResultSet #1
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from PRINT REFCURSOR" summary="Shows output from PRINT employee_info." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t63">
<pre>DEPTNO DNAME       LOC
------ ----------  ---------
10     ACCOUNTING  NEW YORK
20     RESEARCH    DALLAS
30     SALES       CHICAGO
40     OPERATIONS  BOSTON

4 rows selected
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>ResultSet #2
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from PRINT REFCURSOR" summary="Shows output from PRINT employee_info." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t64">
<pre>EMPNO ENAME  JOB       MGR  HIREDATE  SAL  COMM DEPTNO
----- ------ --------- ---- --------- ---- ---- --
7369  SMITH  CLERK     7902 17-DEC-80  800      20
7499  ALLEN  SALESMAN  7698 20-FEB-81 1600  300 30
7521  WARD   SALESMAN  7698 22-FEB-81 1250  500 30
7566  JONES  MANAGER   7839 02-APR-81 2975      20
7654  MARTIN SALESMAN  7698 28-SEP-81 1250 1400 30
7698  BLAKE  MANAGER   7839 01-MAY-81 2850      30
7782  CLARK  MANAGER   7839 09-JUN-81 2450      10
7788  SCOTT  ANALYST   7566 05-APR-11 3000      20
7839  KING   PRESIDENT      17-NOV-81 5000      10
7844  TURNER SALESMAN  7698 08-SEP-81 1500    0 30
7876  ADAMS  CLERK     7788 09-MAY-11 1100

14 rows selected
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1436">
<tr>
<td class="cellalignment1444">
<table class="cellalignment1441">
<tr>
<td class="cellalignment1440"><a href="ch_four.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1440"><a href="ch_six.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1446">
<table class="cellalignment1439">
<tr>
<td class="cellalignment1440"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1440"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1440"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1440"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1440"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1440"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>