<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-103734"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Tuning%20SQL%2APlus"></a><title>Tuning SQL*Plus</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 737"/>
<meta name="dcterms.created" content="2013-07-17T10:55:16Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="SQL*Plus&reg; User&#39;s Guide and Reference"/>
<meta name="dcterms.identifier" content="E18404-12"/>
<meta name="dcterms.isVersionOf" content="SQPUG"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="ch_seven.htm" title="Previous" type="text/html"/>
<link rel="Next" href="ch_nine.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E18404-12.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">17/82</span> <!-- End Header -->
<div id="SQPUG018" class="chapter"><a id="CHDGIEJI"></a><a id="i1037182"></a>
<h1 class="chapter"><span class="secnum">8</span> Tuning SQL*Plus</h1>
<p>This chapter provides information about how to tune SQL*Plus for better performance. It discusses the following topics:</p>
<ul>
<li>
<p><a href="#i1037226">Tracing Statements</a></p>
</li>
<li>
<p><a href="#i1037547">Collecting Timing Statistics</a></p>
</li>
<li>
<p><a href="#i1037566">Tracing Parallel and Distributed Queries</a></p>
</li>
<li>
<p><a href="#BABGFFAI">Execution Plan Output in Earlier Databases</a></p>
</li>
<li>
<p><a href="#i1037682">SQL*Plus Script Tuning</a></p>
</li>
</ul>
<p>For information about tuning Oracle Database, see the <a class="olink TGDBA" href="../TGDBA/toc.htm"><span class="italic">Oracle Database Performance Tuning Guide</span></a>.</p>
<a id="i1037226"></a>
<div id="SQPUG534" class="sect1">
<h2 class="sect1">Tracing Statements</h2>
<p>You can automatically get a report on the execution path used by the SQL optimizer and the statement execution statistics. The report is generated after successful SQL DML (that is, SELECT, DELETE, UPDATE and INSERT) statements. It is useful for monitoring and <a id="sthref889"></a><a id="sthref890"></a>tuning the <a id="sthref891"></a>performance of these statements.</p>
<p>SQL*Plus report output may differ for DML if dynamic sampling is in effect.</p>
<a id="i1037231"></a>
<div id="SQPUG535" class="sect2">
<h3 class="sect2">Controlling the Autotrace Report</h3>
<p>You can control the report by setting the <a id="sthref892"></a><a id="sthref893"></a><a id="sthref894"></a><a id="sthref895"></a>AUTOTRACE system variable.</p>
<div class="inftblinformal">
<table class="cellalignment1443" title="Autotrace Report Settings" summary="2 column table showing Autotrace settings and their results. The column headings are, Autotrace Setting and Result." dir="ltr">
<thead>
<tr class="cellalignment1437">
<th class="cellalignment1448" id="r1c1-t2"><span class="bold">Autotrace Setting</span></th>
<th class="cellalignment1448" id="r1c2-t2">Result</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r2c1-t2" headers="r1c1-t2">SET AUTOTRACE OFF</td>
<td class="cellalignment1444" headers="r2c1-t2 r1c2-t2">No AUTOTRACE report is generated. This is the default.</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r3c1-t2" headers="r1c1-t2">SET AUTOTRACE ON EXPLAIN</td>
<td class="cellalignment1444" headers="r3c1-t2 r1c2-t2">The AUTOTRACE report shows only the optimizer execution path.</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r4c1-t2" headers="r1c1-t2">SET AUTOTRACE ON STATISTICS</td>
<td class="cellalignment1444" headers="r4c1-t2 r1c2-t2">The AUTOTRACE report shows only the SQL statement execution statistics.</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r5c1-t2" headers="r1c1-t2">SET AUTOTRACE ON</td>
<td class="cellalignment1444" headers="r5c1-t2 r1c2-t2">The AUTOTRACE report includes both the optimizer execution path and the SQL statement execution statistics.</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r6c1-t2" headers="r1c1-t2">SET AUTOTRACE TRACEONLY</td>
<td class="cellalignment1444" headers="r6c1-t2 r1c2-t2">Like SET AUTOTRACE ON, but suppresses the printing of the user&#39;s query output, if any. If STATISTICS is enabled, query data is still fetched, but not printed.</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblinformal" -->
<p>To use this feature, you must create a <a id="sthref896"></a>PLAN_TABLE table in your <a id="sthref897"></a><a id="sthref898"></a>schema and then have the <a id="sthref899"></a>PLUSTRACE role granted to you. DBA privileges are required to grant the PLUSTRACE role. For information on how to grant a role and how to create the PLAN_TABLE table, see the <a class="olink SQLRF" href="../SQLRF/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a>.</p>
<p>For more information about the roles and the PLAN_TABLE, see the <a class="olink SQLRF" href="../SQLRF/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a> and the AUTOTRACE variable of the <a href="ch_twelve039.htm#i2698538">SET</a> command.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
SQL*Plus AUTOTRACE does not support switching containers with the ALTER SESSION SET CONTAINER option. Statistical data gathered in this case may be inconsistent.</div>
<div id="SQPUG536" class="example">
<p class="titleinexample"><a id="sthref900"></a>Example 8-1 Creating a PLAN_TABLE</p>
<p>Run the <a id="sthref901"></a><a id="sthref902"></a>following commands from your SQL*Plus session to create the PLAN_TABLE in the HR schema:</p>
<pre>CONNECT HR 
@$ORACLE_HOME/rdbms/admin/utlxplan.sql 
</pre></div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 8-1" summary="Shows output from example 8-1 after running UTLXPLAN.SQL." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t4">
<pre>Table created.
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<div id="SQPUG537" class="example">
<p class="titleinexample"><a id="sthref903"></a>Example 8-2 Creating the PLUSTRACE Role</p>
<p>Run the following commands from your SQL*Plus session to create the <a id="sthref904"></a><a id="sthref905"></a>PLUSTRACE role and grant it to the DBA:</p>
<pre>CONNECT / AS SYSDBA 
@$ORACLE_HOME/sqlplus/admin/plustrce.sql 

drop role plustrace;
</pre></div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 8-2" summary="Shows output from example 8-2 after dropping the plustrace role." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t5">
<pre>Role dropped.
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>create role plustrace;
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 8-2" summary="Shows output from example 8-2 after creating the plustrace role." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t6">
<pre>Role created.
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>grant plustrace to dba with admin option;
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 8-2" summary="Shows output from example 8-2 after granting plustrace role." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t7">
<pre>Grant succeeded.
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<div id="SQPUG538" class="example">
<p class="titleinexample"><a id="sthref906"></a>Example 8-3 Granting the PLUSTRACE Role</p>
<p>Run the following commands from your SQL*Plus session to grant the PLUSTRACE role to the HR user:</p>
<pre>CONNECT / AS SYSDBA 
GRANT PLUSTRACE TO HR; 
</pre></div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 8-2" summary="Shows output from example 8-3 after granting plustrace role." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t8">
<pre>Grant succeeded.
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" --></div>
<!-- class="sect2" -->
<a id="i1037329"></a>
<div id="SQPUG539" class="sect2">
<h3 class="sect2">Execution Plan</h3>
<p>The <a id="sthref907"></a><a id="sthref908"></a><a id="sthref909"></a>Execution Plan shows the SQL optimizer&#39;s query execution path. Execution Plan output is generated using EXPLAIN PLAN and DBMS_XPLAN.</p>
<p>For information about interpreting the output of DBMS_XPLAN, see the <a class="olink TGDBA" href="../TGDBA/toc.htm"><span class="italic">Oracle Database Performance Tuning Guide</span></a>.</p>
</div>
<!-- class="sect2" -->
<a id="i1037371"></a>
<div id="SQPUG540" class="sect2">
<h3 class="sect2">Statistics</h3>
<p>The statistics<a id="sthref910"></a><a id="sthref911"></a> are recorded by the server when your statement executes and indicate the system resources required to execute your statement. The results include the following statistics.</p>
<div class="inftblinformal">
<table class="cellalignment1443" title="Execution Plan Statistics" summary="2 column table showing the Execution Plan statistics recorded and their descriptions. The column headings are, Database Statistic Name, and Description." dir="ltr">
<thead>
<tr class="cellalignment1437">
<th class="cellalignment1448" id="r1c1-t9">Database Statistic Name</th>
<th class="cellalignment1448" id="r1c2-t9">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r2c1-t9" headers="r1c1-t9">recursive calls</td>
<td class="cellalignment1444" headers="r2c1-t9 r1c2-t9">Number of recursive calls generated at both the user and system level. Oracle Database maintains tables used for internal processing. When Oracle Database needs to make a change to these tables, it internally generates an internal SQL statement, which in turn generates a recursive call.</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r3c1-t9" headers="r1c1-t9">db block gets</td>
<td class="cellalignment1444" headers="r3c1-t9 r1c2-t9">Number of times a CURRENT block was requested.</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r4c1-t9" headers="r1c1-t9">consistent gets</td>
<td class="cellalignment1444" headers="r4c1-t9 r1c2-t9">Number of times a consistent read was requested for a block</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r5c1-t9" headers="r1c1-t9">physical reads</td>
<td class="cellalignment1444" headers="r5c1-t9 r1c2-t9">Total number of data blocks read from disk. This number equals the value of &#34;physical reads direct&#34; plus all reads into buffer cache.</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r6c1-t9" headers="r1c1-t9">redo size</td>
<td class="cellalignment1444" headers="r6c1-t9 r1c2-t9">Total amount of redo generated in bytes</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r7c1-t9" headers="r1c1-t9">bytes sent through Oracle Net Services to client</td>
<td class="cellalignment1444" headers="r7c1-t9 r1c2-t9">Total number of bytes sent to the client from the foreground processes.</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r8c1-t9" headers="r1c1-t9">bytes received through Oracle Net Services from client</td>
<td class="cellalignment1444" headers="r8c1-t9 r1c2-t9">Total number of bytes received from the client over Oracle Net.</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r9c1-t9" headers="r1c1-t9">Oracle Net Services round-trips to/from client</td>
<td class="cellalignment1444" headers="r9c1-t9 r1c2-t9">Total number of Oracle Net messages sent to and received from the client</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r10c1-t9" headers="r1c1-t9">sorts (memory)</td>
<td class="cellalignment1444" headers="r10c1-t9 r1c2-t9">Number of sort operations that were performed completely in memory and did not require any disk writes</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r11c1-t9" headers="r1c1-t9">sorts (disk)</td>
<td class="cellalignment1444" headers="r11c1-t9 r1c2-t9">Number of sort operations that required at least one disk write</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r12c1-t9" headers="r1c1-t9">rows processed</td>
<td class="cellalignment1444" headers="r12c1-t9 r1c2-t9">Number of rows processed during the operation</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblinformal" -->
<p>The client referred to in the statistics is SQL*Plus. Oracle Net refers to the generic process communication between SQL*Plus and the server, regardless of whether Oracle Net is installed. You cannot change the default format of the statistics report.</p>
<p>For a more complete list of database statistics, see the <a class="olink REFRN" href="../REFRN/toc.htm"><span class="italic">Oracle Database Reference</span></a>. For more information about the statistics and how to interpret them, see Chapter 3, &#34;Gathering Optimizer Statistics&#34; in the <a class="olink TGDBA" href="../TGDBA/toc.htm"><span class="italic">Oracle Database Performance Tuning Guide</span></a>.</p>
<div id="SQPUG541" class="example">
<p class="titleinexample"><a id="sthref912"></a>Example 8-4 Tracing Statements for Performance Statistics and Query Execution Path</p>
<p><a id="sthref913"></a><a id="sthref914"></a>If the SQL buffer contains the following statement:</p>
<pre>SELECT E.LAST_NAME, E.SALARY, J.JOB_TITLE
FROM EMPLOYEES E, JOBS J
WHERE E.JOB_ID=J.JOB_ID AND E.SALARY&gt;12000;
</pre>
<p>The statement can be automatically traced when it is run:</p>
<pre>SET AUTOTRACE ON
/
</pre></div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 8-4" summary="Shows output from example 8-4 with AUTOTRACE ON." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t10">
<pre>LAST_NAME                     SALARY JOB_TITLE
------------------------- ---------- -----------------------------------
King                           24000 President
De Haan                        17000 Administration Vice President
Kochhar                        17000 Administration Vice President
Partners                       13500 Sales Manager
Russell                        14000 Sales Manager
Hartstein                      13000 Marketing Manager
6 rows selected.
 
Execution Plan
----------------------------------------------------------
Plan hash value: 2988506077
------------------------------------------------------------------------------
| Id  | Operation          | Name     | Rows | Bytes | Cost (%CPU)| Time     |
------------------------------------------------------------------------------
|   0 | SELECT STATEMENT   |          |    6 |   360 |     6  (17)| 00:00:01 |
|*  1 |  HASH JOIN         |          |    6 |   360 |     6  (17)| 00:00:01 |
|*  2 |   TABLE ACCESS FULL| EMPLOYEES|    6 |   204 |     3   (0)| 00:00:01 |
|   3 |   TABLE ACCESS FULL| JOBS     |   19 |   494 |     2   (0)| 00:00:01 |
------------------------------------------------------------------------------
 
Predicate Information (identified by operation id):
---------------------------------------------------
   1 - access(&#34;E&#34;.&#34;JOB_ID&#34;=&#34;J&#34;.&#34;JOB_ID&#34;)
   2 - filter(&#34;E&#34;.&#34;SALARY&#34;&gt;12000)
 
Note
-----
   - dynamic sampling used for this statement
 
Statistics
----------------------------------------------------------
          0  recursive calls
          0  db block gets
         10  consistent gets
          0  physical reads
          0  redo size
        706  bytes sent via Oracle Net Services to client
        496  bytes received via Oracle Net Services from client
          2  Oracle Net Services roundtrips to/from client
          0  sorts (memory)
          0  sorts (disk)
          6  rows processed
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<div id="SQPUG542" class="example">
<p class="titleinexample"><a id="sthref915"></a>Example 8-5 Tracing Statements Without Displaying Query Data</p>
<p>To trace the same statement without displaying the query data, enter:</p>
<pre>SET AUTOTRACE TRACEONLY
/
</pre></div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 8-5" summary="Shows output from example 8-5 with AUTOTRACE TRACEONLY." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t11">
<pre>6 rows selected.
 
Execution Plan
----------------------------------------------------------
Plan hash value: 2988506077
 
------------------------------------------------------------------------------
| Id  | Operation          | Name     | Rows | Bytes | Cost (%CPU)| Time     |
------------------------------------------------------------------------------
|   0 | SELECT STATEMENT   |          |    6 |   360 |     6  (17)| 00:00:01 |
|*  1 |  HASH JOIN         |          |    6 |   360 |     6  (17)| 00:00:01 |
|*  2 |   TABLE ACCESS FULL| EMPLOYEES|    6 |   204 |     3   (0)| 00:00:01 |
|   3 |   TABLE ACCESS FULL| JOBS     |   19 |   494 |     2   (0)| 00:00:01 |
------------------------------------------------------------------------------
 
Predicate Information (identified by operation id):
---------------------------------------------------
   1 - access(&#34;E&#34;.&#34;JOB_ID&#34;=&#34;J&#34;.&#34;JOB_ID&#34;)
   2 - filter(&#34;E&#34;.&#34;SALARY&#34;&gt;12000)
 
Note
-----
   - dynamic sampling used for this statement
 
Statistics
----------------------------------------------------------
          0  recursive calls
          0  db block gets
         10  consistent gets
          0  physical reads
          0  redo size
        706  bytes sent via Oracle Net Services to client
        496  bytes received via Oracle Net Services from client
          2  Oracle Net Services roundtrips to/from client
          0  sorts (memory)
          0  sorts (disk)
          6  rows processed
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>This option is useful when you are tuning a large query, but do not want to see the query report.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Your output may vary depending on the server version and configuration.</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1037547"></a>
<div id="SQPUG543" class="sect1">
<h2 class="sect1">Collecting Timing Statistics</h2>
<p>Use the SQL*Plus TIMING<a id="sthref916"></a><a id="sthref917"></a> command to collect and display data on the amount of computer resources used to run one or more commands<a id="sthref918"></a> or blocks. TIMING collects data for an elapsed period of time, saving the data on commands run during the period in a timer.</p>
<p>See the <a href="ch_twelve047.htm#BACJGJGI">TIMING</a> command, and <a href="#i1037226">Tracing Statements</a> for information about using AUTOTRACE to collect statistics.</p>
<p>To delete all timers, enter CLEAR TIMING.</p>
</div>
<!-- class="sect1" -->
<a id="i1037566"></a>
<div id="SQPUG544" class="sect1">
<h2 class="sect1">Tracing Parallel and Distributed Queries</h2>
<p>When you trace a <a id="sthref919"></a><a id="sthref920"></a>statement in a parallel or distributed query, the Execution Plan output depends on the statement you use.</p>
<div id="SQPUG545" class="example">
<p class="titleinexample"><a id="sthref921"></a>Example 8-6 Tracing Statements With Parallel Query Option</p>
<p><a id="sthref922"></a>To trace a parallel query running the parallel query option:</p>
<pre>create table D2_t1 (unique1 number) parallel -
(degree 6);
</pre></div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 8-7" summary="Shows output from example 8-7 after creating a table." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t13">
<pre>Table created.
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>create table D2_t2 (unique1 number) parallel -
(degree 6);
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 8-7" summary="Shows output from example 8-7 after creating a table." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t14">
<pre>Table created.
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>create unique index d2_i_unique1 on d2_t1(unique1);
</pre>
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 8-7" summary="Shows output from example 8-7 after creating an index." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t15">
<pre>Index created.
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<pre>set long 500 longchunksize 500
SET AUTOTRACE ON EXPLAIN
SELECT /*+ INDEX(B,D2_I_UNIQUE1) USE_NL(B) ORDERED -
*/ COUNT (A.UNIQUE1)
FROM D2_T2 A, D2_T1 B
WHERE A.UNIQUE1 = B.UNIQUE1;
</pre>
<div class="inftblruleinformalwidemax">
<table class="cellalignment1443" title="Output from example 8-7" summary="Shows output from example 8-7 with AUTOTRACE ON EXPLAIN." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t16">
<pre>Execution Plan
----------------------------------------------------------
Plan hash value: 107954098
 
--------------------------------------------------------------------------------------------------------------
| Id  | Operation                 | Name    | Rows |Bytes| Cost(%CPU)| Time     |    TQ  |IN-OUT| PQ Distrib |
--------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT          |         |    1 |  26 |    1   (0)| 00:00:01 |        |      |            |
|   1 |  SORT AGGREGATE           |         |    1 |  26 |           |          |        |      |            |
|   2 |   PX COORDINATOR          |         |      |     |           |          |        |      |            |
|   3 |    PX SEND QC (RANDOM)    | :TQ10001|    1 |  26 |           |          |  Q1,01 | P-&gt;S | QC (RAND)  |
|   4 |     SORT AGGREGATE        |         |    1 |  26 |           |          |  Q1,01 | PCWP |            |
|   5 |      NESTED LOOPS         |         |    1 |  26 |    1   (0)| 00:00:01 |  Q1,01 | PCWP |            |
|   6 |       PX RECEIVE          |         |      |     |           |          |  Q1,01 | PCWP |            |
|   7 |        PX SEND BROADCAST  | :TQ10000|      |     |           |          |  Q1,00 | P-&gt;P | BROADCAST  |
|   8 |         PX BLOCK ITERATOR |         |    1 |  13 |    0   (0)| 00:00:01 |  Q1,00 | PCWC |            |
|   9 |          TABLE ACCESS FULL| D2_T2   |    1 |  13 |    0   (0)| 00:00:01 |  Q1,00 | PCWP |            |
|  10 |       PX BLOCK ITERATOR   |         |    1 |  13 |    2   (0)| 00:00:01 |  Q1,01 | PCWC |            |
|* 11 |        TABLE ACCESS FULL  | D2_T1   |    1 |  13 |    2   (0)| 00:00:01 |  Q1,01 | PCWP |            |
--------------------------------------------------------------------------------------------------------------
 
Predicate Information (identified by operation id):
---------------------------------------------------
  11 - filter(&#34;A&#34;.&#34;UNIQUE1&#34;=&#34;B&#34;.&#34;UNIQUE1&#34;)
 
Note
-----
   - dynamic sampling used for this statement
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformalwidemax" -->
<div id="SQPUG546" class="example">
<p class="titleinexample"><a id="sthref923"></a>Example 8-7 To monitor disk reads and buffer gets.</p>
<pre>SET AUTOTRACE TRACEONLY STATISTICS
</pre>
<p>The following shows typical results:</p>
</div>
<!-- class="example" -->
<div class="inftblruleinformal">
<table class="cellalignment1443" title="Output from example 8-8" summary="Shows output from example 8-7 with AUTOTRACE TRACEONLY STATISTICS." dir="ltr">
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r1c1-t17">
<pre>Statistics
----------------------------------------------------------
        467  recursive calls
         27  db block gets
        147  consistent gets
         20  physical reads
       4548  redo size
        502  bytes sent via Oracle Net Services to client
        496  bytes received via Oracle Net Services from client
          2  Oracle Net Services roundtrips to/from client
         14  sorts (memory)
          0  sorts (disk)
          1  rows processed
</pre></td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblruleinformal" -->
<p>If consistent gets or physical reads are high relative to the amount of data returned, it indicates that the query is expensive and needs to be reviewed for optimization. For example, if you are expecting less than 1,000 rows back and consistent gets is 1,000,000 and physical reads is 10,000, further optimization is needed.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can also monitor disk reads and buffer gets using V$SQL or TKPROF.</div>
</div>
<!-- class="sect1" -->
<a id="BABGFFAI"></a>
<div id="SQPUG547" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Execution Plan Output in Earlier Databases</h2>
<p>Execution Plan output from Oracle Database 9<span class="italic">i</span> Release 2 (9.2) or earlier is different.</p>
<p>Each line of the Execution Plan has a sequential line number. SQL*Plus also displays the line number of the parent operation.</p>
<p>The Execution Plan consists of four columns displayed in the following order:</p>
<div class="inftblinformal">
<table class="cellalignment1443" title="Execution Plan Column Descriptions" summary="2 column table showing the columns output from the execution plan and their descriptions. The column headings are, Column Name and Description." dir="ltr">
<thead>
<tr class="cellalignment1437">
<th class="cellalignment1448" id="r1c1-t19">Column Name</th>
<th class="cellalignment1448" id="r1c2-t19">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r2c1-t19" headers="r1c1-t19"><code>ID_PLUS_EXP</code></td>
<td class="cellalignment1444" headers="r2c1-t19 r1c2-t19">Shows the line number of each execution step.</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r3c1-t19" headers="r1c1-t19"><code>PARENT_ID_PLUS_EXP</code></td>
<td class="cellalignment1444" headers="r3c1-t19 r1c2-t19">Shows the relationship between each step and its parent. This column is useful for large reports.</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r4c1-t19" headers="r1c1-t19"><code>PLAN_PLUS_EXP</code></td>
<td class="cellalignment1444" headers="r4c1-t19 r1c2-t19">Shows each step of the report.</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r5c1-t19" headers="r1c1-t19"><code>OBJECT_NODE_PLUS_EXP</code></td>
<td class="cellalignment1444" headers="r5c1-t19 r1c2-t19">Shows database links or parallel query servers used.</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblinformal" -->
<p>The format of the columns may be altered with the COLUMN command. For example, to stop the PARENT_ID_PLUS_EXP column being displayed, enter</p>
<pre>COLUMN PARENT_ID_PLUS_EXP NOPRINT
</pre>
<p>The Execution Plan output is generated using the EXPLAIN PLAN command.</p>
<p>When you trace a <a id="sthref924"></a><a id="sthref925"></a>statement in a parallel or distributed query, the Execution Plan shows the cost based optimizer estimates of the number of rows (the cardinality). In general, the cost, cardinality and bytes at each node represent cumulative results. For example, the cost of a join node accounts for not only the cost of completing the join operations, but also the entire costs of accessing the relations in that join.</p>
<p>Lines marked with an asterisk (*) denote a parallel or remote operation. Each operation is explained in the second part of the report. See the <a class="olink TGDBA" href="../TGDBA/toc.htm"><span class="italic">Oracle Database Performance Tuning Guide</span></a> for more information on parallel and distributed operations.</p>
<p>The second section of this report consists of three columns displayed in the following order</p>
<div class="inftblinformal">
<table class="cellalignment1443" title="Tracing Queries Report Output" summary="2 column table showing the columns displayed in the second part of a Tracing Report. The column headings are, Column Name, and Description." dir="ltr">
<thead>
<tr class="cellalignment1437">
<th class="cellalignment1448" id="r1c1-t20">Column Name</th>
<th class="cellalignment1448" id="r1c2-t20">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r2c1-t20" headers="r1c1-t20"><code>ID_PLUS_EXP</code></td>
<td class="cellalignment1444" headers="r2c1-t20 r1c2-t20">Shows the line number of each execution step.</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r3c1-t20" headers="r1c1-t20"><code>OTHER_TAG_PLUS_EXP</code></td>
<td class="cellalignment1444" headers="r3c1-t20 r1c2-t20">Describes the function of the SQL statement in the OTHER_PLUS_EXP column.</td>
</tr>
<tr class="cellalignment1437">
<td class="cellalignment1444" id="r4c1-t20" headers="r1c1-t20"><code>OTHER_PLUS_EXP</code></td>
<td class="cellalignment1444" headers="r4c1-t20 r1c2-t20">Shows the text of the query for the parallel server or remote database.</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblinformal" -->
<p>The format of the columns may be altered with the COLUMN command.</p>
</div>
<!-- class="sect1" -->
<a id="i1037682"></a>
<div id="SQPUG548" class="sect1">
<h2 class="sect1">SQL*Plus Script Tuning</h2>
<p>Most performance benefit comes from tuning SQL queries executed in a script. This is done with tools like SQL*Plus&#39;s AUTOTRACE command. It involves restructuring queries to make best use of the Oracle Database SQL optimizer. For information about Tuning SQL statements, see the <a class="olink TGDBA" href="../TGDBA/toc.htm"><span class="italic">Oracle Database Performance Tuning Guide</span></a>.</p>
<p>The performance gains made by tuning SQL*Plus-specific commands are smaller, but could be important for some applications. The following <a id="sthref926"></a><a id="sthref927"></a><a id="sthref928"></a>system variables and commands can influence SQL*Plus performance.</p>
<div id="SQPUG549" class="sect2"><a id="sthref929"></a>
<h3 class="sect2">COLUMN NOPRINT</h3>
<p>COLUMN NOPRINT<a id="sthref930"></a><a id="sthref931"></a> turns off screen output and printing <a id="sthref932"></a>of the column heading and all values selected for the column.</p>
<p>It is better to remove an unneeded column from a SELECT then it is to use COLUMN NOPRINT to stop it displaying. Removing the column from the query means the SQL engine does not need to process it, or need to transfer the column data back to SQL*Plus.</p>
</div>
<!-- class="sect2" -->
<div id="SQPUG550" class="sect2"><a id="sthref933"></a>
<h3 class="sect2">SET APPINFO OFF</h3>
<p><a id="sthref934"></a><a id="sthref935"></a><a id="sthref936"></a>Sets automatic <a id="sthref937"></a>registering of scripts through the <a id="sthref938"></a>DBMS_APPLICATION_INFO package. Setting APPINFO OFF prevents administrators monitoring the performance and resource usage of scripts.</p>
<p>If many SQL scripts are being called, then turning APPINFO OFF stops internal SQL*Plus calls to the database DBMS_APPLICATION_INFO package.</p>
</div>
<!-- class="sect2" -->
<div id="SQPUG551" class="sect2"><a id="sthref939"></a>
<h3 class="sect2">SET ARRAYSIZE</h3>
<p><a id="sthref940"></a><a id="sthref941"></a><a id="sthref942"></a>Sets the number of<a id="sthref943"></a> rows that SQL*Plus will fetch from the database at one time. Valid values are 1 to 5000.</p>
<p>The effectiveness of setting ARRAYSIZE depends on how well Oracle Database fills network packets and your network latency and throughput. In recent versions of SQL*Plus and Oracle Database, ARRAYSIZE may have little effect. Overlarge sizes can easily take more SQL*Plus memory which may decrease overall performance.</p>
</div>
<!-- class="sect2" -->
<div id="SQPUG552" class="sect2"><a id="sthref944"></a>
<h3 class="sect2">SET DEFINE OFF</h3>
<p>SET DEFINE OFF disables the parsing of commands to replace <a id="sthref945"></a><a id="sthref946"></a>substitution variables with their values.</p>
</div>
<!-- class="sect2" -->
<div id="SQPUG553" class="sect2"><a id="sthref947"></a>
<h3 class="sect2">SET FLUSH OFF</h3>
<p>SET FLUSH OFF <a id="sthref948"></a><a id="sthref949"></a>enables the operating system to buffer output. ON disables buffering and flushes <a id="sthref950"></a>output to the screen. Any benefit from setting FLUSH either ON or OFF depends on your operating system and data. The gain may be marginal.</p>
<p>Use OFF only when you run a script that does not require user interaction and whose output you do not need to see until the script finishes running.</p>
</div>
<!-- class="sect2" -->
<div id="SQPUG554" class="sect2"><a id="sthref951"></a>
<h3 class="sect2">SET LINESIZE</h3>
<p>SET LINESIZE sets the total number of <a id="sthref952"></a>characters that SQL*Plus displays on one line before beginning a new line.</p>
<p>Keep LINESIZE as small as possible to avoid extra memory allocations and memory copying.</p>
<p>However, if LINESIZE is too small, columns that cannot fit next to each other are put on separate lines. This may reduce performance significantly.</p>
</div>
<!-- class="sect2" -->
<div id="SQPUG555" class="sect2"><a id="sthref953"></a>
<h3 class="sect2">SET LONGCHUNKSIZE</h3>
<p>SET LONGCHUNKSIZE sets <a id="sthref954"></a>the size of the increments SQL*Plus uses to retrieve a BLOB<a id="sthref955"></a>, BFILE, CLOB<a id="sthref956"></a>, LONG<a id="sthref957"></a>, NCLOB<a id="sthref958"></a> or XMLType<a id="sthref959"></a> value.</p>
<p>Experiment with different sizes if LONGS or LOBs are being fetched.</p>
</div>
<!-- class="sect2" -->
<div id="SQPUG556" class="sect2"><a id="sthref960"></a>
<h3 class="sect2">SET PAGESIZE</h3>
<p><a id="sthref961"></a><a id="sthref962"></a>Sets<a id="sthref963"></a> the number of lines on each page<a id="sthref964"></a> of output.</p>
<p>Increase PAGESIZE to avoid printing headings frequently, or set it to 0 to prevent headings being displayed.</p>
</div>
<!-- class="sect2" -->
<div id="SQPUG557" class="sect2"><a id="sthref965"></a>
<h3 class="sect2">SET SERVEROUTPUT</h3>
<p>SET SERVEROUTPUT OFF suppresses the display output (<a id="sthref966"></a>DBMS_OUTPUT.PUT_LINE) of stored procedures or PL/SQL blocks in SQL*Plus.</p>
<p>Setting SERVEROUTPUT OFF stops internal SQL*Plus calls to the DBMS_OUTPUT package done after user SQL statements.</p>
</div>
<!-- class="sect2" -->
<div id="SQPUG558" class="sect2"><a id="sthref967"></a>
<h3 class="sect2">SET SQLPROMPT</h3>
<p><a id="sthref968"></a><a id="sthref969"></a><a id="sthref970"></a><a id="sthref971"></a>Sets the SQL*Plus command prompt.</p>
<p>Use the default prompt, &#34;SQL&gt; &#34; to stop variable substitution occurring each time the prompt is displayed.</p>
</div>
<!-- class="sect2" -->
<div id="SQPUG559" class="sect2"><a id="sthref972"></a>
<h3 class="sect2">SET TAB</h3>
<p><a id="sthref973"></a><a id="sthref974"></a>Determines how SQL*Plus formats white space in terminal output.<a id="sthref975"></a></p>
<p>Setting TAB ON causes multiple spaces to be compressed in terminal output. Unless this significantly reduces the written data, the processing required may marginally outweigh any benefit.</p>
</div>
<!-- class="sect2" -->
<div id="SQPUG560" class="sect2"><a id="sthref976"></a>
<h3 class="sect2">SET TERMOUT</h3>
<p>SET <a id="sthref977"></a><a id="sthref978"></a>TERMOUT OFF suppresses the display so that you can spool output from a script without seeing it on the screen.</p>
<p>If both spooling to file and writing to terminal are not required, use SET TERMOUT OFF in SQL scripts to disable terminal output.</p>
</div>
<!-- class="sect2" -->
<div id="SQPUG561" class="sect2"><a id="sthref979"></a>
<h3 class="sect2">SET TRIMOUT ON SET TRIMSPOOL ON</h3>
<p>SET <a id="sthref980"></a>TRIMOUT ON or SET <a id="sthref981"></a>TRIMSPOOL ON removes trailing blanks at the end of each displayed or spooled line.</p>
<p>Setting these variables ON can reduce the amount of data written. However, if LINESIZE is optimal, it may be faster to set the variables OFF. The SQL*Plus output line is blank filled throughout the query processing routines so removing the spaces could take extra effort.</p>
</div>
<!-- class="sect2" -->
<div id="SQPUG562" class="sect2"><a id="sthref982"></a>
<h3 class="sect2">UNDEFINE</h3>
<p>Deletes substitution variables that you defined either explicitly (with the DEFINE command) or implicitly (with an argument to the START command or COLUMN NEW_VAL|OLD_VAL).</p>
<p>Use the UNDEFINE command to remove unnecessary substitution variables. This can reduce the time taken for any operation that uses &#39;&amp;&#39;, new_value or old_value variables.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1436">
<tr>
<td class="cellalignment1444">
<table class="cellalignment1441">
<tr>
<td class="cellalignment1440"><a href="ch_seven.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1440"><a href="ch_nine.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1446">
<table class="cellalignment1439">
<tr>
<td class="cellalignment1440"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1440"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1440"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1440"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1440"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1440"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>