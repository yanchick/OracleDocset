<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-91967"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Creating%20a%20Logical%20Standby%20Database"></a><title>Creating a Logical Standby Database</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="primary database, prerequisite conditions for, logical standby database creation, checklist, tasks for creating standby databases, standby databases, creating, checklist of tasks, DBMS_LOGSTDBY.BUILD procedure, building a dictionary in the redo data, LogMiner dictionary, using DBMS_LOGSTDBY.BUILD procedure to build, dictionary, building a LogMiner, redo data, building a dictionary in, adjusting, initialization parameter file, for logical standby database, starting, logical standby databases, verifying"/>
<meta name="dcterms.created" content="2017-07-21T12:09:00Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Data Guard Concepts and Administration"/>
<meta name="dcterms.identifier" content="E48552-08"/>
<meta name="dcterms.isVersionOf" content="SBYDB"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="create_ps.htm" title="Previous" type="text/html"/>
<link rel="Next" href="create_fs.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E48552-08.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-3666CA35-D993-44B6-8D70-A2B8B9EC8B2E"></a> <span id="PAGE" style="display:none;">10/35</span> <!-- End Header -->
<a id="SBYDB00300"></a>
<h1 id="SBYDB-GUID-3666CA35-D993-44B6-8D70-A2B8B9EC8B2E" class="sect1"><span class="enumeration_chapter">4</span> Creating a Logical Standby Database</h1>
<div>
<p>See the following topics for information about creating a logical standby database. <a id="d9977e68" class="indexterm-anchor"></a><a id="d9977e72" class="indexterm-anchor"></a></p>
<ul style="list-style-type: disc;">
<li>
<p><a href="create_ls.htm#GUID-ACF65D75-F057-4C09-9D59-DFAE7D647579">Prerequisite Conditions for Creating a Logical Standby Database</a></p>
</li>
<li>
<p><a href="create_ls.htm#GUID-2A3EDE02-DE51-4813-891C-248AA5F1C027">Step-by-Step Instructions for Creating a Logical Standby Database</a></p>
</li>
<li>
<p><a href="create_ls.htm#GUID-DC0A53BC-D29E-4878-BF3F-0AC4503AFA3C">Post-Creation Steps</a></p>
</li>
<li>
<p><a href="create_ls.htm#GUID-E2BB4836-32D1-4D57-9B32-75B1239170E2">Creating a Logical Standby of a CDB</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-3666CA35-D993-44B6-8D70-A2B8B9EC8B2E__GUID-F13D846B-013D-42F8-B9F4-C658F70C212D">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink ADMIN11117" target="_blank" href="../ADMIN/create.htm#ADMIN11117"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about creating and using server parameter files</p>
</li>
<li>
<p>Oracle Enterprise Manager Cloud Control online help system for information about using the Oracle Data Guard broker graphical user interface (GUI) to automatically create a logical standby database.</p>
</li>
</ul>
</div>
<div class="infobox-note" id="GUID-3666CA35-D993-44B6-8D70-A2B8B9EC8B2E__GUID-311085FA-B5ED-4CA6-9D06-3A7C0249ED76">
<p class="notep1">Note:</p>
<p>If you are working in a multitenant container database (CDB) environment, then see <a href="create_ls.htm#GUID-E2BB4836-32D1-4D57-9B32-75B1239170E2">Creating a Logical Standby of a CDB</a> for information about behavioral differences from non-CDB environments. For instance, in a CDB environment, many DBA views have analogous CDB views that you should use instead. For example, the view <code class="codeph">CDB_LOGSTDBY_NOT_UNIQUE</code> contains the same data as shown in <code class="codeph">DBA_LOGSTDBY_NOT_UNIQUE</code> view, but it has an additional column indicating the PDB name.</p>
</div>
</div>
<a id="SBYDB5020"></a><a id="SBYDB4730"></a>
<div class="props_rev_3"><a id="GUID-ACF65D75-F057-4C09-9D59-DFAE7D647579"></a>
<h2 id="SBYDB-GUID-ACF65D75-F057-4C09-9D59-DFAE7D647579" class="sect2"><span class="enumeration_section">4.1</span> Prerequisite Conditions for Creating a Logical Standby Database</h2>
<div>
<p>Before you create a logical standby database, you must first ensure the primary database is properly configured. Perform the following tasks on the primary database to prepare for logical standby database creation:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="create_ls.htm#GUID-5F1713AF-8813-4132-A9F7-D91A84231C9C">Determine Support for Data Types and Storage Attributes for Tables</a></p>
</li>
<li>
<p><a href="create_ls.htm#GUID-C238335E-8383-43F1-B5B1-709A2A619C30">Ensure Table Rows in the Primary Database Can Be Uniquely Identified</a></p>
</li>
</ul>
<p>A logical standby database uses standby redo logs (SRLs) for redo received from the primary database, and also writes to online redo logs (ORLs) as it applies changes to the standby database. Thus, logical standby databases often require additional <code class="codeph">ARC</code><span class="italic">n</span> processes to simultaneously archive SRLs and ORLs. Additionally, because archiving of ORLs takes precedence over archiving of SRLs, a greater number of SRLs may be needed on a logical standby during periods of very high workload.</p>
</div>
<a id="SBYDB4731"></a>
<div class="props_rev_3"><a id="GUID-5F1713AF-8813-4132-A9F7-D91A84231C9C"></a>
<h3 id="SBYDB-GUID-5F1713AF-8813-4132-A9F7-D91A84231C9C" class="sect3"><span class="enumeration_section">4.1.1</span> Determine Support for Data Types and Storage Attributes for Tables</h3>
<div>
<div class="section">
<p>Before setting up a logical standby database, ensure the logical standby database can maintain the data types and tables in your primary database. See <a href="data_support.htm#GUID-291FD74A-165A-4E80-9E1F-66996F1FC6CA">Unsupported Tables</a> for information about specific SQL queries you can use to determine if there are any unsupported data types or storage attributes.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="SBYDB00308"></a>
<div class="props_rev_3"><a id="GUID-C238335E-8383-43F1-B5B1-709A2A619C30"></a>
<h3 id="SBYDB-GUID-C238335E-8383-43F1-B5B1-709A2A619C30" class="sect3"><span class="enumeration_section">4.1.2</span> Ensure Table Rows in the Primary Database Can Be Uniquely Identified</h3>
<div>
<div class="section">
<p>The physical organization in a logical standby database is different from that of the primary database, even though the logical standby database is created from a backup copy of the primary database. Thus, ROWIDs contained in the redo records generated by the primary database cannot be used to identify the corresponding row in the logical standby database.</p>
<p>Oracle uses primary-key or unique-constraint/index supplemental logging to logically identify a modified row in the logical standby database. When database-wide primary-key and unique-constraint/index supplemental logging is enabled, each <code class="codeph">UPDATE</code> statement also writes the column values necessary in the redo log to uniquely identify the modified row in the logical standby database.</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>If a table has a primary key defined, then the primary key is logged along with the modified columns as part of the <code class="codeph">UPDATE</code> statement to identify the modified row.</p>
</li>
<li>
<p>In the absence of a primary key, the shortest nonnull unique-constraint/index is logged along with the modified columns as part of the <code class="codeph">UPDATE</code> statement to identify the modified row.</p>
</li>
<li>
<p>If there is no primary key and no nonnull unique constraint/index, then all columns with a declared maximum length of 4000 bytes are logged as part of the <code class="codeph">UPDATE</code> statement to help identify the modified row. There are some requirements and restrictions with respect to supported data types. See the following sections for more information:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="data_support.htm#GUID-BD53979B-3120-45CD-803F-2E6675A9DAFD">Supported Table Storage Types</a></p>
</li>
<li>
<p><a href="data_support.htm#GUID-55806A96-6216-41A2-AB52-20704DAAF5C7">Unsupported Table Storage Types</a></p>
</li>
</ul>
</li>
<li>
<p>A function-based index, even though it is declared as unique, cannot be used to uniquely identify a modified row. However, logical standby databases support replication of tables that have function-based indexes defined, as long as modified rows can be uniquely identified.</p>
</li>
</ul>
<p>Oracle recommends that you add a primary key or a nonnull unique index to tables in the primary database, whenever possible, to ensure that SQL Apply can efficiently apply redo data updates to the logical standby database.</p>
<p>Perform the following steps to ensure SQL Apply can uniquely identify rows of each table being replicated in the logical standby database.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Query the <code class="codeph">DBA_LOGSTDBY_NOT_UNIQUE</code> view to display a list of tables that SQL Apply may not be able to uniquely identify. For example:</span>
<div>
<pre dir="ltr">SQL&gt; SELECT OWNER, TABLE_NAME FROM DBA_LOGSTDBY_NOT_UNIQUE
  2&gt; WHERE (OWNER, TABLE_NAME) NOT IN 
  3&gt; (SELECT DISTINCT OWNER, TABLE_NAME FROM DBA_LOGSTDBY_UNSUPPORTED) 
  4&gt; AND BAD_COLUMN = &#39;Y&#39;;
</pre>
<p>This query may take a few minutes to run.</p>
</div>
</li>
<li class="stepexpand"><span>If your application ensures the rows in a table are unique, then you can create a disabled primary key <code class="codeph">RELY</code> constraint on the table. This avoids the overhead of maintaining a primary key on the primary database.</span></li>
</ol>
<div class="section">
<p>To create a disabled <code class="codeph">RELY</code> constraint on a primary database table, <a id="d9977e432" class="indexterm-anchor"></a>use the <code class="codeph">ALTER TABLE</code> statement with a <code class="codeph">RELY DISABLE</code> clause. The following example creates a disabled <code class="codeph">RELY</code> constraint on a table named <code class="codeph">mytab</code>, for which rows can be uniquely identified using the <code class="codeph">id</code> and <code class="codeph">name</code> columns:</p>
<pre dir="ltr">SQL&gt; ALTER TABLE mytab ADD PRIMARY KEY (id, name) RELY DISABLE;
</pre>
<p>When you specify the <code class="codeph">RELY</code> constraint, the system assumes that rows are unique. Because you are telling the system to rely on the information, but are not validating it on every modification done to the table, you must be careful to select columns for the disabled <code class="codeph">RELY</code> constraint that uniquely identify each row in the table. If such uniqueness is not present, then SQL Apply does not correctly maintain the table.</p>
<p>To improve the performance of SQL Apply, add a unique-constraint/index to the columns to identify the row on the logical standby database. Failure to do so results in full table scans during <code class="codeph">UPDATE</code> or <code class="codeph">DELETE</code> statements carried out on the table by SQL Apply.</p>
<div class="infoboxnotealso" id="GUID-C238335E-8383-43F1-B5B1-709A2A619C30__GUID-713EB1CD-C32C-4D2F-919A-5348816FB65B">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink REFRN23123" target="_blank" href="../REFRN/GUID-439EACDC-EAEE-4ABE-B0CB-4964388DD065.htm#REFRN23123"><span class="italic">Oracle Database Reference</span></a> for information about the <code class="codeph">DBA_LOGSTDBY_NOT_UNIQUE</code> view</p>
</li>
<li>
<p><a class="olink SQLRF01001" target="_blank" href="../SQLRF/statements_3001.htm#SQLRF01001"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about the <code class="codeph">ALTER TABLE</code> statement syntax</p>
</li>
<li>
<p><a href="manage_ls.htm#GUID-10287018-12F8-4727-AB2D-C720571AF4B6">Create a Primary Key RELY Constraint</a> for information about <code class="codeph">RELY</code> constraints and actions you can take to increase performance on a logical standby database</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="SBYDB5021"></a><a id="SBYDB00310"></a>
<div class="props_rev_3"><a id="GUID-2A3EDE02-DE51-4813-891C-248AA5F1C027"></a>
<h2 id="SBYDB-GUID-2A3EDE02-DE51-4813-891C-248AA5F1C027" class="sect2"><span class="enumeration_section">4.2</span> Step-by-Step Instructions for Creating a Logical Standby Database</h2>
<div>
<p>This section lists the tasks you perform to create a logical standby database.</p>
<div class="tblformalwide" id="GUID-2A3EDE02-DE51-4813-891C-248AA5F1C027__BEIFEFEE">
<p class="titleintable">Table 4-1 Creating a Logical Standby Database</p>
<table class="cellalignment2262" title="Creating a Logical Standby Database" summary="This 2 column table describes the steps to create a logical standby database. Column 1 is the task. Column 2 is the database.">
<thead>
<tr class="cellalignment2253">
<th class="cellalignment2319" id="d9977e602">Task</th>
<th class="cellalignment2320" id="d9977e605">Database</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2253">
<td class="cellalignment2321" id="d9977e610" headers="d9977e602">
<p><a href="create_ls.htm#GUID-39D01B49-BA52-488E-B418-4BCFDE7692AF">Create a Physical Standby Database</a></p>
</td>
<td class="cellalignment2322" headers="d9977e610 d9977e605">
<p>Primary</p>
</td>
</tr>
<tr class="cellalignment2253">
<td class="cellalignment2321" id="d9977e619" headers="d9977e602">
<p><a href="create_ls.htm#GUID-CDD78A3A-EB1C-493D-A0EF-ED6EBABDF0B7">Stop Redo Apply on the Physical Standby Database</a></p>
</td>
<td class="cellalignment2322" headers="d9977e619 d9977e605">
<p>Standby</p>
</td>
</tr>
<tr class="cellalignment2253">
<td class="cellalignment2321" id="d9977e628" headers="d9977e602">
<p><a href="create_ls.htm#GUID-BA252F0F-B5B9-4AA6-8593-250A7FA7283F">Prepare the Primary Database to Support a Logical Standby Database</a></p>
</td>
<td class="cellalignment2322" headers="d9977e628 d9977e605">
<p>Primary</p>
</td>
</tr>
<tr class="cellalignment2253">
<td class="cellalignment2321" id="d9977e637" headers="d9977e602">
<p><a href="create_ls.htm#GUID-69BC7C26-F66F-4CB5-BBF6-08350C3E615F">Transition to a Logical Standby Database</a></p>
</td>
<td class="cellalignment2322" headers="d9977e637 d9977e605">
<p>Standby</p>
</td>
</tr>
<tr class="cellalignment2253">
<td class="cellalignment2321" id="d9977e646" headers="d9977e602">
<p><a href="create_ls.htm#GUID-68777C01-83F6-4CCF-9BA2-547ED180138D">Open the Logical Standby Database</a></p>
</td>
<td class="cellalignment2322" headers="d9977e646 d9977e605">
<p>Standby</p>
</td>
</tr>
<tr class="cellalignment2253">
<td class="cellalignment2321" id="d9977e655" headers="d9977e602">
<p><a href="create_ls.htm#GUID-930CFC64-4EFD-4CF3-A5D0-062FBBD069E1">Verify the Logical Standby Database Is Performing Properly</a></p>
</td>
<td class="cellalignment2322" headers="d9977e655 d9977e605">
<p>Standby</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
<a id="SBYDB4732"></a>
<div class="props_rev_3"><a id="GUID-39D01B49-BA52-488E-B418-4BCFDE7692AF"></a>
<h3 id="SBYDB-GUID-39D01B49-BA52-488E-B418-4BCFDE7692AF" class="sect3"><span class="enumeration_section">4.2.1</span> Creating a Logical Standby Task 1: Create a Physical Standby Database</h3>
<div>
<div class="section">
<p>You create a logical standby database by first creating a physical standby database and then transitioning it to a logical standby database. Follow the instructions in <a href="create_ps.htm#GUID-B511FB6E-E3E7-436D-94B5-071C37550170">Creating a Physical Standby Database</a> to create a physical standby database.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="SBYDB4733"></a>
<div class="props_rev_3"><a id="GUID-CDD78A3A-EB1C-493D-A0EF-ED6EBABDF0B7"></a>
<h3 id="SBYDB-GUID-CDD78A3A-EB1C-493D-A0EF-ED6EBABDF0B7" class="sect3"><span class="enumeration_section">4.2.2</span> Creating a Logical Standby Task 2: Stop Redo Apply on the Physical Standby Database</h3>
<div>
<div class="section">
<p>You can run Redo Apply on the new physical standby database for any length of time before converting it to a logical standby database. However, before converting to a logical standby database, stop Redo Apply on the physical standby database. Stopping Redo Apply is necessary to avoid applying changes past the redo that contains the LogMiner dictionary (described in <a href="create_ls.htm#GUID-E5D227F2-C456-44F3-AEEA-2C8340439EF3">Build a Dictionary in the Redo Data</a>).</p>
<p>To stop Redo Apply, issue the following statement on the physical standby database:</p>
<pre dir="ltr">SQL&gt; ALTER DATABASE RECOVER MANAGED STANDBY DATABASE CANCEL;
</pre></div>
<!-- class="section" --></div>
</div>
<a id="SBYDB4734"></a>
<div class="props_rev_3"><a id="GUID-BA252F0F-B5B9-4AA6-8593-250A7FA7283F"></a>
<h3 id="SBYDB-GUID-BA252F0F-B5B9-4AA6-8593-250A7FA7283F" class="sect3"><span class="enumeration_section">4.2.3</span> Creating a Logical Standby Task 3: Prepare the Primary Database to Support a Logical Standby Database</h3>
<div>
<p>This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="create_ls.htm#GUID-408C8876-F7CC-4112-9C08-58352577ECB4">Prepare the Primary Database for Role Transitions</a></p>
</li>
<li>
<p><a href="create_ls.htm#GUID-E5D227F2-C456-44F3-AEEA-2C8340439EF3">Build a Dictionary in the Redo Data</a></p>
</li>
</ul>
</div>
<a id="SBYDB5022"></a><a id="SBYDB4735"></a>
<div class="props_rev_3"><a id="GUID-408C8876-F7CC-4112-9C08-58352577ECB4"></a>
<h4 id="SBYDB-GUID-408C8876-F7CC-4112-9C08-58352577ECB4" class="sect4"><span class="enumeration_section">4.2.3.1</span> Prepare the Primary Database for Role Transitions</h4>
<div>
<div class="section">
<p>In <a href="create_ps.htm#GUID-0FD317D6-1A49-4DB3-A141-D00CB3089E84">Set Primary Database Initialization Parameters</a>, you set up several standby role initialization parameters to take effect when the primary database is transitioned to the <span class="italic">physical</span> standby role.</p>
<div class="infobox-note" id="GUID-408C8876-F7CC-4112-9C08-58352577ECB4__GUID-D5FB5416-B7D7-48AA-834B-6195A83E89A2">
<p class="notep1">Note:</p>
<p>This step is necessary only if you plan to perform switchovers.</p>
</div>
<p>If you plan to transition the primary database to the <span class="italic">logical</span> standby role, then you must also modify the parameters shown in bold typeface in <a href="create_ls.htm#GUID-408C8876-F7CC-4112-9C08-58352577ECB4__I91919">Example 4-1</a>, so that no parameters need to change after a role transition:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Change the <code class="codeph">VALID_FOR</code> attribute in the original <code class="codeph">LOG_ARCHIVE_DEST_1</code> destination to archive redo data only from the online redo log and not from the standby redo log.</p>
</li>
<li>
<p>Include the <code class="codeph">LOG_ARCHIVE_DEST_3</code> destination on the primary database. This parameter only takes effect when the primary database is transitioned to the logical standby role.</p>
</li>
</ul>
<p>The following table describes the archival processing defined by the changed initialization parameters shown in <a href="create_ls.htm#GUID-408C8876-F7CC-4112-9C08-58352577ECB4__I91919">Example 4-1</a>.</p>
<div class="tblformalwide" id="GUID-408C8876-F7CC-4112-9C08-58352577ECB4__GUID-DBB3E671-47EA-4401-88EE-691B17BFA568">
<table class="cellalignment2262" summary="This 3 column table describes how archiving behavior for the Chicago database is controlled by LOG_ARCHIVE_DEST_n parameter when in the primary or the logical standby database role..">
<thead>
<tr class="cellalignment2253">
<th class="cellalignment2301" id="d9977e1018">LOG_ARCHIVE_DEST_n</th>
<th class="cellalignment2287" id="d9977e1021">When the Chicago Database Is Running in the Primary Role</th>
<th class="cellalignment2271" id="d9977e1024">When the Chicago Database Is Running in the Logical Standby Role</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2253">
<td class="cellalignment2303" id="d9977e1029" headers="d9977e1018">
<p><code class="codeph">LOG_ARCHIVE_DEST_1</code></p>
</td>
<td class="cellalignment2289" headers="d9977e1029 d9977e1021">
<p>Directs archiving of redo data generated by the primary database from the local online redo log files to the local archived redo log files in <code class="codeph">/arch1/chicago/</code>.</p>
</td>
<td class="cellalignment2273" headers="d9977e1029 d9977e1024">
<p>Directs archiving of redo data generated by the logical standby database from the local online redo log files to the local archived redo log files in <code class="codeph">/arch1/chicago/</code>.</p>
</td>
</tr>
<tr class="cellalignment2253">
<td class="cellalignment2303" id="d9977e1046" headers="d9977e1018">
<p><code class="codeph">LOG_ARCHIVE_DEST_3</code></p>
</td>
<td class="cellalignment2289" headers="d9977e1046 d9977e1021">
<p>Is ignored; <code class="codeph">LOG_ARCHIVE_DEST_3</code> is valid only when <code class="codeph">chicago</code> is running in the standby role.</p>
</td>
<td class="cellalignment2273" headers="d9977e1046 d9977e1024">
<p>Directs archiving of redo data from the standby redo log files to the local archived redo log files in <code class="codeph">/arch2/chicago/</code>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
<!-- class="section" -->
<div class="example" id="GUID-408C8876-F7CC-4112-9C08-58352577ECB4__I91919">
<p class="titleinexample">Example 4-1 Primary Database: Logical Standby Role Initialization Parameters</p>
<pre dir="ltr">LOG_ARCHIVE_DEST_1=
 &#39;LOCATION=/arch1/chicago/ 
  VALID_FOR=(<span class="bold">ONLINE_LOGFILES</span>,ALL_ROLES)
  DB_UNIQUE_NAME=chicago&#39;
<span class="bold">LOG_ARCHIVE_DEST_3=</span>
 <span class="bold">&#39;LOCATION=/arch2/chicago/</span>
  <span class="bold">VALID_FOR=(STANDBY_LOGFILES,STANDBY_ROLE)</span> 
  <span class="bold">DB_UNIQUE_NAME=chicago&#39;</span>
<span class="bold">LOG_ARCHIVE_DEST_STATE_3=ENABLE</span>
</pre>
<p>To dynamically set these initialization parameters, use the SQL <code class="codeph">ALTER SYSTEM SET</code> statement and include the <code class="codeph">SCOPE=BOTH</code> clause so that the changes take effect immediately and persist after the database is shut down and started up again.</p>
</div>
<!-- class="example" --></div>
</div>
<a id="SBYDB4736"></a>
<div class="props_rev_3"><a id="GUID-E5D227F2-C456-44F3-AEEA-2C8340439EF3"></a>
<h4 id="SBYDB-GUID-E5D227F2-C456-44F3-AEEA-2C8340439EF3" class="sect4"><span class="enumeration_section">4.2.3.2</span> Build a Dictionary in the Redo Data</h4>
<div>
<div class="section">
<p>A LogMiner dictionary must be built into the redo data so that the LogMiner component of SQL Apply can properly interpret changes it sees in the redo. As part of building the LogMiner dictionary, <a id="d9977e1186" class="indexterm-anchor"></a><a id="d9977e1190" class="indexterm-anchor"></a><a id="d9977e1194" class="indexterm-anchor"></a>supplemental logging is automatically set up to log primary key and unique-constraint/index columns. The supplemental logging information ensures each update contains enough information to logically identify each row that is modified by the statement.</p>
<p>To build the LogMiner dictionary, issue the following statement:</p>
<pre dir="ltr">SQL&gt; EXECUTE DBMS_LOGSTDBY.BUILD;
</pre>
<p>The <code class="codeph">DBMS_LOGSTDBY.BUILD</code> procedure waits for all existing transactions to complete. Long-running transactions executed on the primary database affect the timeliness of this command.</p>
<div class="infobox-note" id="GUID-E5D227F2-C456-44F3-AEEA-2C8340439EF3__GUID-5E22C5B2-F247-423F-9A26-C172D71B2BF0">
<p class="notep1">Note:</p>
<p>In databases created using Oracle Database 11<span class="italic">g</span> Release 2 (11.2) or later, supplemental logging information is automatically propagated to any existing physical standby databases. However, for databases in earlier releases, or if the database was created using an earlier release and then upgraded to 11.2, you must check whether supplemental logging is enabled at the physical standby(s) if it is also enabled at the primary database. If it is not enabled at the physical standby(s), then before performing a switchover or failover, you must enable supplemental logging on all existing physical standby databases. To do so, issue the following SQL statement on each physical standby:</p>
<pre dir="ltr">SQL&gt;  ALTER DATABASE ADD SUPPLEMENTAL LOG DATA (PRIMARY KEY, UNIQUE INDEX) COLUMNS;
</pre>
<p>If you do not do this, then any logical standby that is also in the same Oracle Data Guard configuration is unusable if a switchover or failover is performed to one of the physical standby databases. If a switchover or failover has already occurred and supplemental logging was not enabled, then you must recreate all logical standby databases.</p>
</div>
<div class="infoboxnotealso" id="GUID-E5D227F2-C456-44F3-AEEA-2C8340439EF3__GUID-3927954B-64E8-437B-BFA0-FB0E76B39EE5">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p>The <code class="codeph">DBMS_LOGSTDBY.BUILD</code> PL/SQL package in <a class="olink ARPLS66834" target="_blank" href="../ARPLS/d_lsbydb.htm#ARPLS66834"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a></p>
</li>
<li>
<p>The <code class="codeph">UNDO_RETENTION</code> initialization parameter in <a class="olink REFRN10225" target="_blank" href="../REFRN/GUID-D238E854-A2C5-463E-A146-31F61300124E.htm#REFRN10225"><span class="italic">Oracle Database Reference</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="SBYDB4737"></a>
<div class="props_rev_3"><a id="GUID-69BC7C26-F66F-4CB5-BBF6-08350C3E615F"></a>
<h3 id="SBYDB-GUID-69BC7C26-F66F-4CB5-BBF6-08350C3E615F" class="sect3"><span class="enumeration_section">4.2.4</span> Creating a Logical Standby Task 4: Transition to a Logical Standby Database</h3>
<div>
<p>This section describes how to prepare the physical standby database to transition to a logical standby database. It contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="create_ls.htm#GUID-715EBEC1-21B9-4DA9-80A5-ED58033F94C8">Convert to a Logical Standby Database</a></p>
</li>
<li>
<p><a href="create_ls.htm#GUID-31F89C7C-174C-49E4-9A5E-3B9F538BD739">Adjust Initialization Parameters for the Logical Standby Database</a></p>
</li>
</ul>
</div>
<a id="SBYDB4738"></a>
<div class="props_rev_3"><a id="GUID-715EBEC1-21B9-4DA9-80A5-ED58033F94C8"></a>
<h4 id="SBYDB-GUID-715EBEC1-21B9-4DA9-80A5-ED58033F94C8" class="sect4"><span class="enumeration_section">4.2.4.1</span> Convert to a Logical Standby Database</h4>
<div>
<div class="section">
<p>The redo logs contain the information necessary to <a id="d9977e1393" class="indexterm-anchor"></a><a id="d9977e1397" class="indexterm-anchor"></a><a id="d9977e1401" class="indexterm-anchor"></a>convert your physical standby database to a logical standby database.</p>
<div class="infobox-note" id="GUID-715EBEC1-21B9-4DA9-80A5-ED58033F94C8__GUID-1D8D1ACD-06B1-47AC-8FAD-5AB07FE8F633">
<p class="notep1">Note:</p>
<p>If you have an Oracle RAC physical standby database, then shut down all but one instance, set <code class="codeph">CLUSTER_DATABASE</code> to <code class="codeph">FALSE</code>, and start the standby database as a single instance in <code class="codeph">MOUNT EXCLUSIVE</code> mode, as follows:</p>
<pre dir="ltr">SQL&gt; ALTER SYSTEM SET CLUSTER_DATABASE=FALSE SCOPE=SPFILE;
SQL&gt; SHUTDOWN ABORT;
SQL&gt; STARTUP MOUNT EXCLUSIVE; 
</pre></div>
<p>To continue applying redo data to the physical standby database until it is ready to convert to a logical standby database, issue the following SQL statement:</p>
<pre dir="ltr">SQL&gt; <a id="d9977e1426" class="indexterm-anchor"></a>ALTER DATABASE RECOVER TO LOGICAL STANDBY <span class="italic">db_name</span>;
</pre>
<p>For <span class="italic">db_name</span>, specify a database name that is different from the primary database to identify the new logical standby database. If you are using a server parameter file (spfile) at the time you issue this statement, then the database updates the file with appropriate information about the new logical standby database. If you are not using an spfile, then the database issues a message reminding you to set the name of the <code class="codeph">DB_NAME</code> parameter after shutting down the database.</p>
<div class="infobox-note" id="GUID-715EBEC1-21B9-4DA9-80A5-ED58033F94C8__GUID-EF5F2825-F586-4617-9E53-192099643DDA">
<p class="notep1">Note:</p>
<p>If you are creating a logical standby database in the context of performing a rolling upgrade<a id="d9977e1445" class="indexterm-anchor"></a> of Oracle software with a physical standby database, then issue the following command instead:</p>
<pre dir="ltr">SQL&gt; ALTER DATABASE RECOVER TO LOGICAL STANDBY KEEP IDENTITY;
</pre>
<p>A logical standby database created with the <code class="codeph">KEEP IDENTITY</code> clause<a id="d9977e1457" class="indexterm-anchor"></a> retains the same <code class="codeph">DB_NAME</code> and <code class="codeph">DBID</code> as that of its primary database. Such a logical standby database can only participate in one switchover operation, and thus should only be created in the context of a rolling upgrade with a physical standby database.</p>
<p>The <code class="codeph">KEEP IDENTITY</code> clause is available only if the database being upgraded is running Oracle Database release 11.1 or later.</p>
</div>
<p>The statement waits, applying redo data until the LogMine<a id="d9977e1473" class="indexterm-anchor"></a><a id="d9977e1477" class="indexterm-anchor"></a>r dictionary is found in the log files. This may take several minutes, depending on how long it takes redo generated in <a href="create_ls.htm#GUID-E5D227F2-C456-44F3-AEEA-2C8340439EF3">Build a Dictionary in the Redo Data</a> to be transmitted to the standby database, and how much redo data needs to be applied. If a dictionary build is not successfully performed on the primary database, then this command never completes. You can cancel the SQL statement by issuing the <a id="d9977e1486" class="indexterm-anchor"></a><a id="d9977e1490" class="indexterm-anchor"></a><code class="codeph">ALTER DATABASE RECOVER MANAGED STANDBY DATABASE CANCEL</code> statement from another SQL session.</p>
<div class="infobox-note" id="GUID-715EBEC1-21B9-4DA9-80A5-ED58033F94C8__GUID-4B5A4365-5F88-4AAD-8F1E-DF9E45A5219A">
<p class="notep1">Caution:</p>
<p>In releases prior to Oracle Database 11<span class="italic">g</span>, you needed to create a new password file before you opened the logical standby database. This is no longer needed. Creating a new password file at the logical standby database causes redo transport services to not work properly.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="SBYDB5023"></a><a id="SBYDB4739"></a>
<div class="props_rev_3"><a id="GUID-31F89C7C-174C-49E4-9A5E-3B9F538BD739"></a>
<h4 id="SBYDB-GUID-31F89C7C-174C-49E4-9A5E-3B9F538BD739" class="sect4"><span class="enumeration_section">4.2.4.2</span> Adjust Initialization Parameters for the Logical Standby Database</h4>
<div>
<div class="section">
<div class="infobox-note" id="GUID-31F89C7C-174C-49E4-9A5E-3B9F538BD739__GUID-B8EC917A-CE11-414F-8F36-3D612E811DA8">
<p class="notep1">Note:</p>
<p>If you started with an Oracle RAC physical standby database, then set <code class="codeph">CLUSTER_DATABASE</code> back to <code class="codeph">TRUE</code>, as follows:</p>
<pre dir="ltr">SQL&gt; ALTER SYSTEM SET CLUSTER_DATABASE=TRUE SCOPE=SPFILE; 
</pre></div>
<p>On the logical standby database, shutdown the instance and issue the <code class="codeph">STARTUP MOUNT</code> statement to start and mount the database. Do not open the database; it should remain closed to user access until later in the creation process. For example:</p>
<pre dir="ltr">SQL&gt; SHUTDOWN;
SQL&gt; STARTUP MOUNT;
</pre>
<p>You need to modify the <code class="codeph">LOG_ARCHIVE_DEST_</code><span class="italic"><code class="codeph">n</code></span> parameters because, unlike physical standby databases, logical standby databases are open databases that generate redo data and have multiple log files (online redo log files, archived redo log files, and standby redo log files). It is good practice to specify separate local destinations for:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Archived redo log files that store redo data generated by the logical standby database. In <a href="create_ls.htm#GUID-31F89C7C-174C-49E4-9A5E-3B9F538BD739__I87417">Example 4-2</a>, this is configured as the <code class="codeph">LOG_ARCHIVE_DEST_1=LOCATION=/arch1/boston</code> destination.</p>
</li>
<li>
<p>Archived redo log files that store redo data received from the primary database. In <a href="create_ls.htm#GUID-31F89C7C-174C-49E4-9A5E-3B9F538BD739__I87417">Example 4-2</a>, this is configured as the <code class="codeph">LOG_ARCHIVE_DEST_3=LOCATION=/arch2/boston</code> destination.</p>
</li>
</ul>
<p><a href="create_ls.htm#GUID-31F89C7C-174C-49E4-9A5E-3B9F538BD739__I87417">Example 4-2</a> shows the initialization parameters that were modified for the logical standby database. The parameters shown are valid for the Boston logical standby database when it is running in either the primary or standby database role.</p>
<div class="infobox-note" id="GUID-31F89C7C-174C-49E4-9A5E-3B9F538BD739__GUID-8941C4D9-CA66-4639-8C05-D2E8AF4317AE">
<p class="notep1">Note:</p>
<p>If database compatibility is set to 11.1 or later, you can use the fast recovery area to store remote archived logs. To do this, you need to set only the following parameters (assuming you have already set the <code class="codeph">DB_RECOVERY_FILE_DEST</code> and <code class="codeph">DB_RECOVERY_FILE_DEST_SIZE</code> parameters):</p>
<pre dir="ltr">LOG_ARCHIVE_DEST_1=
  &#39;LOCATION=USE_DB_RECOVERY_FILE_DEST
   DB_UNIQUE_NAME=boston&#39;
</pre>
<p>Because you are using the fast recovery area, it is not necessary to specify the <code class="codeph">VALID_FOR</code> parameter. Its default value is (<code class="codeph">ALL_LOGFILES,ALL_ROLES</code>) and that is the desired behavior in this case. <code class="codeph">LOG_ARCHIVE_DEST_1</code> is used for all log files, both online (primary) and standby.</p>
</div>
<p>The following table describes the archival processing defined by the initialization parameters shown in <a href="create_ls.htm#GUID-31F89C7C-174C-49E4-9A5E-3B9F538BD739__I87417">Example 4-2</a>.</p>
<div class="tblformalwide" id="GUID-31F89C7C-174C-49E4-9A5E-3B9F538BD739__GUID-B07FCDBE-0319-41D0-B92F-2C10A2DF7765">
<table class="cellalignment2262" summary="This 3 column table describes the archival processing when the Boston database is in the primary and in the logical standby database role.">
<thead>
<tr class="cellalignment2253">
<th class="cellalignment2274" id="d9977e1665">LOG_ARCHIVE_DEST_n</th>
<th class="cellalignment2287" id="d9977e1668">When the Boston Database Is Running in the Primary Role</th>
<th class="cellalignment2311" id="d9977e1671">When the Boston Database Is Running in the Logical Standby Role</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2253">
<td class="cellalignment2276" id="d9977e1676" headers="d9977e1665">
<p><code class="codeph">LOG_ARCHIVE_DEST_1</code></p>
</td>
<td class="cellalignment2289" headers="d9977e1676 d9977e1668">
<p>Directs archival of redo data generated by the primary database from the local online redo log files to the local archived redo log files in <code class="codeph">/arch1/boston/</code>.</p>
</td>
<td class="cellalignment2313" headers="d9977e1676 d9977e1671">
<p>Directs archival of redo data generated by the logical standby database from the local online redo log files to the local archived redo log files in <code class="codeph">/arch1/boston/</code>.</p>
</td>
</tr>
<tr class="cellalignment2253">
<td class="cellalignment2276" id="d9977e1693" headers="d9977e1665">
<p><code class="codeph">LOG_ARCHIVE_DEST_2</code></p>
</td>
<td class="cellalignment2289" headers="d9977e1693 d9977e1668">
<p>Directs transmission of redo data to the remote logical standby database <code class="codeph">chicago</code>.</p>
</td>
<td class="cellalignment2313" headers="d9977e1693 d9977e1671">
<p>Is ignored; <code class="codeph">LOG_ARCHIVE_DEST_2</code> is valid only when <code class="codeph">boston</code> is running in the primary role.</p>
</td>
</tr>
<tr class="cellalignment2253">
<td class="cellalignment2276" id="d9977e1713" headers="d9977e1665">
<p><code class="codeph">LOG_ARCHIVE_DEST_3</code></p>
</td>
<td class="cellalignment2289" headers="d9977e1713 d9977e1668">
<p>Is ignored; <code class="codeph">LOG_ARCHIVE_DEST_3</code> is valid only when <code class="codeph">boston</code> is running in the standby role.</p>
</td>
<td class="cellalignment2313" headers="d9977e1713 d9977e1671">
<p>Directs archival of redo data received from the primary database to the local archived redo log files in <code class="codeph">/arch2/boston/</code>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="infobox-note" id="GUID-31F89C7C-174C-49E4-9A5E-3B9F538BD739__GUID-4D1D29EB-4F20-40D8-BDBE-FB85AC68CC9B">
<p class="notep1">Note:</p>
<p>The <code class="codeph">DB_FILE_NAME_CONVERT</code> initialization parameter is not honored once a physical standby database is converted to a logical standby database. If necessary, register a skip handler and provide SQL Apply with a replacement DDL string to execute by converting the path names of the primary database data files to the standby data file path names. See the <a class="olink ARPLS363" target="_blank" href="../ARPLS/d_lsbydb.htm#ARPLS363"><code class="codeph">DBMS_LOGSTDBY</code></a> package in <a class="olink ARPLS363" target="_blank" href="../ARPLS/d_lsbydb.htm#ARPLS363"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a>. for information about the <code class="codeph">SKIP</code> procedure.</p>
</div>
</div>
<!-- class="section" -->
<div class="example" id="GUID-31F89C7C-174C-49E4-9A5E-3B9F538BD739__I87417">
<p class="titleinexample">Example 4-2 Modifying Initialization Parameters for a Logical Standby Database</p>
<pre dir="ltr">LOG_ARCHIVE_DEST_1=
  &#39;LOCATION=/arch1/boston/
   VALID_FOR=(ONLINE_LOGFILES,ALL_ROLES)
   DB_UNIQUE_NAME=boston&#39;
LOG_ARCHIVE_DEST_2=
  &#39;SERVICE=chicago ASYNC
   VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE)
   DB_UNIQUE_NAME=chicago&#39;
LOG_ARCHIVE_DEST_3=
  &#39;LOCATION=/arch2/boston/
   VALID_FOR=(STANDBY_LOGFILES,STANDBY_ROLE)
   DB_UNIQUE_NAME=boston&#39;
LOG_ARCHIVE_DEST_STATE_1=ENABLE
LOG_ARCHIVE_DEST_STATE_2=ENABLE
LOG_ARCHIVE_DEST_STATE_3=ENABLE
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<a id="SBYDB4740"></a>
<div class="props_rev_3"><a id="GUID-68777C01-83F6-4CCF-9BA2-547ED180138D"></a>
<h3 id="SBYDB-GUID-68777C01-83F6-4CCF-9BA2-547ED180138D" class="sect3"><span class="enumeration_section">4.2.5</span> Creating a Logical Standby Task 5: Open the Logical Standby Database</h3>
<div>
<div class="section">
<p>To open the new logical standby database, use the following statement (do not supply the <code class="codeph">RESETLOGS</code> option if the logical standby was created using the <code class="codeph">KEEP</code> <code class="codeph">IDENTITY</code> option):</p>
<pre dir="ltr">SQL&gt; ALTER DATABASE OPEN RESETLOGS;
</pre>
<div class="infobox-note" id="GUID-68777C01-83F6-4CCF-9BA2-547ED180138D__GUID-F2C47D1B-C918-419C-9E78-8F5BE945DEBB">
<p class="notep1">Note:</p>
<p>If you started with an Oracle RAC physical standby database, then you can start up all other standby instances at this point.</p>
</div>
<div class="infobox-note" id="GUID-68777C01-83F6-4CCF-9BA2-547ED180138D__GUID-B64C5B78-0AAA-4321-817F-B9460BEDAAF3">
<p class="notep1">Caution:</p>
<p>If you are co-locating the logical standby database on the same computer system as the primary database, then you must issue the following SQL statement before starting SQL Apply for the first time, so that SQL Apply skips the file operations performed at the primary database. The reason this is necessary is that SQL Apply has access to the same directory structure as the primary database, and data files that belong to the primary database could possibly be damaged if SQL Apply attempted to re-execute certain file-specific operations.</p>
<pre dir="ltr">SQL&gt; EXECUTE DBMS_LOGSTDBY.SKIP(&#39;ALTER TABLESPACE&#39;);
</pre>
<p>The <code class="codeph">DB_FILENAME_CONVERT</code> parameter that you set up while co-locating the physical standby database on the same system as the primary database, is ignored by SQL Apply. See <a class="olink ARPLS363" target="_blank" href="../ARPLS/d_lsbydb.htm#ARPLS363"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about <code class="codeph">DBMS_LOGSTDBY.SKIP</code> and equivalent behavior in the context of a logical standby database.</p>
</div>
<p>Because this is the first time the database is being opened, the database&#39;s global name is adjusted automatically to match the new <code class="codeph">DB_NAME</code> initialization parameter. (This is not true if the logical standby was created using the <code class="codeph">KEEP</code> <code class="codeph">IDENTITY</code> option.)</p>
<div class="infobox-note" id="GUID-68777C01-83F6-4CCF-9BA2-547ED180138D__GUID-43C93E0C-DBE7-4812-9330-96376901BC11">
<p class="notep1">Note:</p>
<p>If you are creating the logical standby database to perform a rolling upgrade of the Oracle Database software, and you are concerned about updates to objects that may not be supported by SQL Apply, then Oracle recommends that you use the <code class="codeph">DBMS_LOGSTDBY</code> PL/SQL procedure. At the logical standby database, run the following procedures to capture and record the information as events in the <code class="codeph">DBA_LOGSTDBY_EVENTS</code> table:</p>
<pre dir="ltr">EXEC DBMS_LOGSTDBY.APPLY_SET(&#39;MAX_EVENTS_RECORDED&#39;,
DBMS_LOGSTDBY.MAX_EVENTS);

EXEC DBMS_LOGSTDBY.APPLY_SET(&#39;RECORD_UNSUPPORTED_OPERATIONS&#39;, &#39;TRUE&#39;);
</pre>
<p>This captures information about any transactions running on the primary that are not supported by logical standby. When the upgrade is complete and before you switch production to the new version, check this table. If nothing is recorded, then you know everything was replicated. If something is recorded, then you can choose to either take corrective action or abandon the upgrade.</p>
<p><span class="bold">See Also:</span></p>
<ul style="list-style-type: disc;">
<li>
<p><a href="manage_ls.htm#GUID-D6EEF87A-211C-476C-9CBC-126858F7026A">Customizing Logging of Events in the DBA_LOGSTDBY_EVENTS View</a> for more information about the <code class="codeph">DBA_LOGSTDBY_EVENTS</code> view</p>
</li>
<li>
<p><a class="olink ARPLS363" target="_blank" href="../ARPLS/d_lsbydb.htm#ARPLS363"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for complete information about the <code class="codeph">DBMS_LOGSTDBY</code> package</p>
</li>
</ul>
</div>
<p>Issue the following statement to begin applying redo data to the logical standby database: <a id="d9977e1914" class="indexterm-anchor"></a><a id="d9977e1920" class="indexterm-anchor"></a></p>
<pre dir="ltr">SQL&gt;  <a id="d9977e1926" class="indexterm-anchor"></a><a id="d9977e1930" class="indexterm-anchor"></a><a id="d9977e1934" class="indexterm-anchor"></a>ALTER DATABASE START LOGICAL STANDBY APPLY IMMEDIATE;
</pre></div>
<!-- class="section" --></div>
</div>
<a id="SBYDB4741"></a>
<div class="props_rev_3"><a id="GUID-930CFC64-4EFD-4CF3-A5D0-062FBBD069E1"></a>
<h3 id="SBYDB-GUID-930CFC64-4EFD-4CF3-A5D0-062FBBD069E1" class="sect3"><span class="enumeration_section">4.2.6</span> Creating a Logical Standby Task 6: Verify the Logical Standby Database Is Performing Properly</h3>
<div>
<div class="section">
<p>See the following sections for help verifying that the logical standby database is performing properly:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><a href="log_transport.htm#GUID-0EC71C7D-A80B-40AA-93E5-28BB7E24ED31">Redo Transport Services</a></p>
</li>
<li>
<p><a href="manage_ls.htm#GUID-4177C717-4244-4E33-ACE7-15D53EAB2443">Managing a Logical Standby Database</a></p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="SBYDB4742"></a>
<div class="props_rev_3"><a id="GUID-DC0A53BC-D29E-4878-BF3F-0AC4503AFA3C"></a>
<h2 id="SBYDB-GUID-DC0A53BC-D29E-4878-BF3F-0AC4503AFA3C" class="sect2"><span class="enumeration_section">4.3</span> Creating a Logical Standby: Post-Creation Steps</h2>
<div>
<div class="section">
<div class="infobox-note" id="GUID-DC0A53BC-D29E-4878-BF3F-0AC4503AFA3C__GUID-A811AFEC-58F3-443D-996E-AA3FEF5BC345">
<p class="notep1">Note:</p>
<p>The conversion of the physical standby database to a logical standby database happens in two phases:</p>
<ol>
<li>
<p>As part of the <code class="codeph">ALTER DATABASE RECOVER TO LOGICAL STANDBY</code> statement (unless you have specified the <code class="codeph">KEEP IDENTITY</code> clause), the DBID of the database is changed.</p>
</li>
<li>
<p>As part of the first successful invocation of <code class="codeph">ALTER DATABASE START LOGICAL STANDBY APPLY</code> statement, the control file is updated to make it consistent with that of the newly created logical standby database.</p>
<p>After you have successfully invoked the <code class="codeph">ALTER DATABASE START LOGICAL STANDBY APPLY</code> statement, take a full backup of the logical standby database, because the backups taken from the primary database cannot be used to restore the logical standby database.</p>
</li>
</ol>
</div>
<p>At this point, the logical standby database is running and can provide the maximum performance level of data protection. The following list describes additional preparations you can take on the logical standby database:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Upgrade the data protection mode</p>
<p>The Oracle Data Guard configuration is initially set up in the maximum performance mode (the default).</p>
</li>
<li>
<p>Enable Flashback Database</p>
<p>Flashback Database removes the need to re-create the primary database after a failover. Flashback Database enables you to return a database to its state at a time in the recent past much faster than traditional point-in-time recovery, because it does not require restoring data files from backup nor the extensive application of redo data. You can enable Flashback Database on the primary database, the standby database, or both. See <a href="scenarios.htm#GUID-1163448F-6B18-4A44-AA8D-7CDF0D1360FB">Converting a Failed Primary Into a Standby Database Using Flashback Database</a> and <a href="scenarios.htm#GUID-BAA5ED38-29A0-4E8D-8435-AA083D19C13E">Using Flashback Database After Issuing an Open Resetlogs Statement</a> for scenarios showing how to use Flashback Database in an Oracle Data Guard environment. Also, see <a class="olink BRADV71000" target="_blank" href="../BRADV/flashdb.htm#BRADV71000"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> for more information about Flashback Database.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="SBYDB5139"></a>
<div class="props_rev_3"><a id="GUID-E2BB4836-32D1-4D57-9B32-75B1239170E2"></a>
<h2 id="SBYDB-GUID-E2BB4836-32D1-4D57-9B32-75B1239170E2" class="sect2"><span class="enumeration_section">4.4</span> Creating a Logical Standby of a CDB</h2>
<div>
<p>You can create a logical standby<a id="d9977e2221" class="indexterm-anchor"></a> of a multitenant container<a id="d9977e2228" class="indexterm-anchor"></a> database (CDB) just as you can create a logical standby of a regular primary database. The following are some of the behavioral differences to be aware of when you create and use a logical standby of a CDB:</p>
<ul style="list-style-type: disc;">
<li>
<p>The database role is defined at the CDB level, not at the pluggable database (PDB) container level.</p>
</li>
<li>
<p>If you execute a switchover or failover operation, then the entire CDB undergoes the role change.</p>
</li>
<li>
<p>Any DDL related to role changes must be executed while connected to the root container of the CDB.</p>
</li>
<li>
<p>As with a regular logical standby, a logical standby of a CDB operates a single pool of processes that mine the redo stream once, but the responsibility is shared for updating all of the PDBs and the root container of the CDB.</p>
</li>
<li>
<p>You are not required to have the same set of PDBs at the primary and standby. However, only tables that exist in the same container at both the primary and standby are replicated.</p>
</li>
<li>
<p>In general, logical standby PL/SQL interfaces which modify global configuration attributes, such as <code class="codeph">DBMS_LOGSTDBY.APPLY_SET</code>, are executed in the root container. However, <code class="codeph">DBMS_LOGSTDBY.INSTANTIATE_TABLE</code> must be called inside the container where the table of interest resides, and the <code class="codeph">DBMS_LOGSTDBY.SKIP</code> procedure must be called inside the container of interest.</p>
</li>
<li>
<p>Logical standby views are enhanced to provide container names where appropriate. Many DBA views have analogous CDB views whose names begin with CDB. For example, the view <code class="codeph">CDB_LOGSTDBY_NOT_UNIQUE</code> contains the same data as shown in <code class="codeph">DBA_LOGSTDBY_NOT_UNIQUE</code> view, but it has an additional column indicating the PDB name. When the <code class="codeph">CDB_LOGSTDBY_NOT_UNIQUE</code> view is queried in the root it shows data for all databases in the CDB.</p>
</li>
<li>
<p>In a logical standby of a CDB, the syntax of SQL statements is generally the same as for noncontainer databases. However, the effect of some statements, including the following, may be different:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">ALTER DATABASE RECOVER TO LOGICAL STANDBY</code> functions only in the CDB; it is not allowed in a PDB.</p>
</li>
<li>
<p>A role is associated with an entire CDB; individual PDBs do not have their own roles. Therefore, the following role change DDL associated with logical standbys affect the entire CDB:</p>
<p><code class="codeph">ALTER DATABASE [PREPARE|COMMIT] TO SWITCHOVER</code></p>
<p><code class="codeph">ALTER DATABASE ACTIVATE LOGICAL STANDBY</code></p>
</li>
<li>
<p><code class="codeph">ALTER DATABASE [START|STOP] LOGICAL STANDBY APPLY</code> functions only in the root container and affects the entire CDB. This statement is not allowed on a PDB.</p>
</li>
<li>
<p><code class="codeph">ALTER DATABASE GUARD</code> functions only in the root container and affects the entire CDB. For example, if an <code class="codeph">ALTER DATABASE GUARD ALL</code> statement is issued, then user activity in the root and in all PDBs is restricted.</p>
</li>
<li>
<p>To administer a multitenant environment, you must have the <code class="codeph">CDB_DBA</code> role.</p>
</li>
</ul>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-E2BB4836-32D1-4D57-9B32-75B1239170E2__GUID-22CA4301-DC88-4EC8-A090-D7966107018F">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink CNCPT89249" target="_blank" href="../CNCPT/cdblogic.htm#CNCPT89249"><span class="italic">Oracle Database Concepts</span></a> for more information about CDBs</p>
</li>
<li>
<p><a class="olink ARPLS66850" target="_blank" href="../ARPLS/d_lsbydb.htm#ARPLS66850"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information about using the <code class="codeph">DBMS_LOGSTDBY.SKIP</code> procedure in containers</p>
</li>
<li>
<p><a class="olink DBSEG800" target="_blank" href="../DBSEG/release_changes.htm#DBSEG800"><span class="italic">Oracle Database Security Guide</span></a> for more information about privileges and roles in CDBs and PDBs</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2252">
<tr>
<td class="cellalignment2259">
<table class="cellalignment2257">
<tr>
<td class="cellalignment2256"><a href="create_ps.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2256"><a href="create_fs.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2261">
<table class="cellalignment2255">
<tr>
<td class="cellalignment2256"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2256"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2256"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2256"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2256"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2256"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>