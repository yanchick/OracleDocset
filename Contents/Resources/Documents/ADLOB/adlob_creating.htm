<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-132"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Operations%20Specific%20to%20Persistent%20and%20Temporary%20LOBs"></a><title>Operations Specific to Persistent and Temporary LOBs</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="dcterms.created" content="2017-03-16T22:27:47Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database SecureFiles and Large Objects Developer&#39;s Guide"/>
<meta name="dcterms.identifier" content="E17605-12"/>
<meta name="dcterms.isVersionOf" content="ADLOB"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2015, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="part_api.htm" title="Previous" type="text/html"/>
<link rel="Next" href="adlob_data_interface.htm" title="Next" type="text/html"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-7B3D15D3-A182-4ED1-A265-8EE15E793C46"></a> <span id="PAGE" style="display:none;">28/34</span> <!-- End Header -->
<a id="ADLOB45635"></a>
<h1 id="ADLOB-GUID-7B3D15D3-A182-4ED1-A265-8EE15E793C46" class="sect1"><span class="enumeration_chapter">19</span> Operations Specific to Persistent and Temporary LOBs</h1>
<div>
<p>LOB operations between persistent and temporary LOB instances can differ.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="adlob_creating.htm#GUID-45C84AD5-42D3-45BD-A04C-FCA37D0BFE6E">Persistent LOB Operations</a></p>
</li>
<li>
<p><a href="adlob_creating.htm#GUID-DE7A5AA6-6A30-4F5D-A1E7-37E71584A31E">Temporary LOB Operations</a></p>
</li>
<li>
<p><a href="adlob_creating.htm#GUID-18AE018F-3943-418D-B2C5-2555A19112E0">Creating Persistent and Temporary LOBs in PL/SQL</a></p>
</li>
<li>
<p><a href="adlob_creating.htm#GUID-20481180-4E23-4693-B1CD-32C2E77EBFBA">Freeing Temporary LOBs in OCI</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-7B3D15D3-A182-4ED1-A265-8EE15E793C46__GUID-6765CD7C-52BB-46FC-8C2B-6E12053135E0">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="adlob_lob_ops.htm#GUID-5BEE64AC-5528-45DC-AB57-A8EDE8E4DE65" title="You can convert a BLOB instance to a CLOB using the PL/SQL procedure DBMS_LOB.CONVERTTOCLOB.">Using LOB APIs</a> gives details and examples of API usage for LOB APIs that can be used with either temporary or persistent LOBs.</p>
</li>
<li>
<p><a href="adlob_bfile_ops.htm#GUID-043A9B91-69C8-44D4-A38A-E872B0A2B9A9" title="You can determine whether a pattern exists in a BFILE using the INSTRoperation.">LOB APIs for BFILE Operations</a> gives details and examples for usage of LOB APIs that operate on BFILEs.</p>
</li>
</ul>
</div>
</div>
<a id="ADLOB45636"></a>
<div class="props_rev_3"><a id="GUID-45C84AD5-42D3-45BD-A04C-FCA37D0BFE6E"></a>
<h2 id="ADLOB-GUID-45C84AD5-42D3-45BD-A04C-FCA37D0BFE6E" class="sect2">Persistent LOB Operations</h2>
<div>
<p>This section describes operations that apply only to persistent LOBs.</p>
</div>
<a id="ADLOB45637"></a>
<div class="props_rev_3"><a id="GUID-92061E43-8CB8-4A82-9FDE-F3F42ABD551E"></a>
<h3 id="ADLOB-GUID-92061E43-8CB8-4A82-9FDE-F3F42ABD551E" class="sect3">Inserting a LOB into a Table</h3>
<div>
<div class="section">
<p>You can insert LOB instances into persistent LOB columns using any of the methods described in <a href="adlob_ddl.htm#GUID-17F0F935-FD78-4F41-B6DF-86409522D667" title="You can insert a row by initializing a LOB locator bind variable.">DDL and DML Statements with LOBs</a>.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="ADLOB45638"></a>
<div class="props_rev_3"><a id="GUID-1247D9C9-AB93-4635-A878-24D6AD928E5D"></a>
<h3 id="ADLOB-GUID-1247D9C9-AB93-4635-A878-24D6AD928E5D" class="sect3">Selecting a LOB from a Table</h3>
<div>
<div class="section">
<p>You can select a persistent LOB from a table just as you would any other data type. In the following example, persistent LOB instances of different types are selected into PL/SQL variables.</p>
<pre dir="ltr">declare
  blob1 BLOB;
  blob2 BLOB;
  clob1 CLOB;
  nclob1 NCLOB;
BEGIN
  SELECT ad_photo INTO blob1 FROM print_media WHERE Product_id = 2268 
        FOR UPDATE;
  SELECT ad_photo INTO blob2 FROM print_media WHERE Product_id = 3106;

  SELECT ad_sourcetext INTO clob1 FROM Print_media
      WHERE product_id=3106 and ad_id=13001 FOR UPDATE;

  SELECT ad_fltextn INTO nclob1 FROM Print_media
      WHERE product_id=3060 and ad_id=11001 FOR UPDATE;

END;
/
show errors;
</pre></div>
<!-- class="section" --></div>
</div>
</div>
<a id="ADLOB45639"></a>
<div class="props_rev_3"><a id="GUID-DE7A5AA6-6A30-4F5D-A1E7-37E71584A31E"></a>
<h2 id="ADLOB-GUID-DE7A5AA6-6A30-4F5D-A1E7-37E71584A31E" class="sect2">Temporary LOB Operations</h2>
<div>
<p>This section describes operations that apply only to temporary LOB instances.</p>
</div>
<a id="ADLOB1005"></a>
<div class="props_rev_3"><a id="GUID-1216E5A8-792D-46CE-B68E-4CAFB70E5CC4"></a>
<h3 id="ADLOB-GUID-1216E5A8-792D-46CE-B68E-4CAFB70E5CC4" class="sect3">Creating and Freeing a Temporary LOB</h3>
<div>
<div class="section">
<p>To create a temporary LOB instance, you must declare a variable of the given LOB data type and pass the variable to the <code class="codeph">CREATETEMPORARY</code> API.</p>
<p>The temporary LOB instance exists in your application until it goes out of scope, your session terminates, or you explicitly free the instance. Freeing a temporary LOB instance is recommended to free system resources.</p>
<p>The following example demonstrates how to create and free a temporary LOB in the PL/SQL environment using the DBMS_LOB package.</p>
<pre dir="ltr">declare
  blob1 BLOB;
  blob2 BLOB;
  clob1 CLOB;
  nclob1 NCLOB;
BEGIN
  -- create temp LOBs
  DBMS_LOB.CREATETEMPORARY(blob1,TRUE, DBMS_LOB.SESSION);
  DBMS_LOB.CREATETEMPORARY(blob2,TRUE, DBMS_LOB.SESSION);
  DBMS_LOB.CREATETEMPORARY(clob1,TRUE, DBMS_LOB.SESSION);
  DBMS_LOB.CREATETEMPORARY(nclob1,TRUE, DBMS_LOB.SESSION);

  -- fill with data
  writeDataToLOB_proc(blob1);
  writeDataToLOB_proc(blob2);

  -- CHAR-&gt;LOB conversion
  clob1 := &#39;abcde&#39;;
  nclob1 := TO_NCLOB(clob1);

  -- Other APIs
  call_lob_apis(blob1, blob2, clob1, nclob1);

  -- free temp LOBs
  DBMS_LOB.FREETEMPORARY(blob1);
  DBMS_LOB.FREETEMPORARY(blob2);
  DBMS_LOB.FREETEMPORARY(clob1);
  DBMS_LOB.FREETEMPORARY(nclob1);

END;
/
show errors;
</pre></div>
<!-- class="section" --></div>
</div>
</div>
<a id="ADLOB45640"></a>
<div class="props_rev_3"><a id="GUID-18AE018F-3943-418D-B2C5-2555A19112E0"></a>
<h2 id="ADLOB-GUID-18AE018F-3943-418D-B2C5-2555A19112E0" class="sect2">Creating Persistent and Temporary LOBs in PL/SQL</h2>
<div>
<div class="section">
<p>The code example that follows illustrates how to create persistent and temporary LOBs in PL/SQL. This code is in the demonstration file:</p>
<pre dir="ltr"><span>$ORACLE_HOME/rdbms/demo/lobs/plsql/lobdemo.sql</span>
</pre>
<p>This demonstration file also calls procedures in separate PL/SQL files that illustrate usage of other LOB APIs. For a list of these files and links to more information about related LOB APIs, see <span class="q">&#34;<a href="adlob_demo.htm#GUID-6F195C50-2EC1-4F24-8DF4-F1EC25D0C7F2">PL/SQL LOB Demonstration Files</a>&#34;</span>.</p>
<pre dir="ltr">-----------------------------------------------------------------------------
-------------------------  Persistent LOB operations ------------------------
-----------------------------------------------------------------------------

declare
  blob1 BLOB;
  blob2 BLOB;
  clob1 CLOB;
  nclob1 NCLOB;
BEGIN
  SELECT ad_photo INTO blob1 FROM print_media WHERE Product_id = 2268 
        FOR UPDATE;
  SELECT ad_photo INTO blob2 FROM print_media WHERE Product_id = 3106;

  SELECT ad_sourcetext INTO clob1 FROM Print_media
      WHERE product_id=3106 and ad_id=13001 FOR UPDATE;

  SELECT ad_fltextn INTO nclob1 FROM Print_media
      WHERE product_id=3060 and ad_id=11001 FOR UPDATE;

  call_lob_apis(blob1, blob2, clob1, nclob1);
  rollback;
END;
/
show errors;

-----------------------------------------------------------------------------
-------------------------  Temporary LOB operations ------------------------
-----------------------------------------------------------------------------

declare
  blob1 BLOB;
  blob2 BLOB;
  clob1 CLOB;
  nclob1 NCLOB;
BEGIN
  -- create temp LOBs
  DBMS_LOB.CREATETEMPORARY(blob1,TRUE, DBMS_LOB.SESSION);
  DBMS_LOB.CREATETEMPORARY(blob2,TRUE, DBMS_LOB.SESSION);
  DBMS_LOB.CREATETEMPORARY(clob1,TRUE, DBMS_LOB.SESSION);
  DBMS_LOB.CREATETEMPORARY(nclob1,TRUE, DBMS_LOB.SESSION);

  -- fill with data
  writeDataToLOB_proc(blob1);
  writeDataToLOB_proc(blob2);

  -- CHAR-&gt;LOB conversion
  clob1 := &#39;abcde&#39;;
  nclob1 := TO_NCLOB(clob1);

  -- Other APIs
  call_lob_apis(blob1, blob2, clob1, nclob1);

  -- free temp LOBs
  DBMS_LOB.FREETEMPORARY(blob1);
  DBMS_LOB.FREETEMPORARY(blob2);
  DBMS_LOB.FREETEMPORARY(clob1);
  DBMS_LOB.FREETEMPORARY(nclob1);

END;
/
show errors;
</pre></div>
<!-- class="section" --></div>
</div>
<a id="ADLOB45641"></a>
<div class="props_rev_3"><a id="GUID-20481180-4E23-4693-B1CD-32C2E77EBFBA"></a>
<h2 id="ADLOB-GUID-20481180-4E23-4693-B1CD-32C2E77EBFBA" class="sect2">Freeing Temporary LOBs in OCI</h2>
<div>
<div class="section">
<p>Any time that your OCI program obtains a LOB locator from SQL or PL/SQL, check that the locator is temporary. If it is, free the locator when your application is finished with it. The locator can be from a define during a select or an out bind. A temporary LOB duration is always upgraded to session when it is shipped to the client side. The application must do the following before the locator is overwritten by the locator of the next row:</p>
<pre dir="ltr">OCILobIsTemporary(env, err, locator, is_temporary);
if(is_temporary)
    OCILobFreeTemporary(svc, err, locator);
</pre>
<div class="infoboxnotealso" id="GUID-20481180-4E23-4693-B1CD-32C2E77EBFBA__GUID-203832B6-0E04-4230-9AD0-43A75F46321C">
<p class="notep1">See Also:</p>
<p><a class="olink LNOCI162" target="_blank" href="../LNOCI/oci17msc002.htm#LNOCI162"><span class="italic">Oracle Call Interface Programmer&#39;s Guide</span></a> chapter 16, section &#34;LOB Functions.&#34;</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2782">
<tr>
<td class="cellalignment2794">
<table class="cellalignment2787">
<tr>
<td class="cellalignment2786"><a href="part_api.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2786"><a href="adlob_data_interface.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2015, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2796">
<table class="cellalignment2785">
<tr>
<td class="cellalignment2786"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2786"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2786"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2786"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2786"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2786"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>