<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-149"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/LOB%20Storage%20with%20Applications"></a><title>LOB Storage with Applications</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="LOB columns, initializing to NULL or Empty, LOBs, setting to NULL, setting, LOBs to NULL, internal LOBs, setting to empty, internal LOBs to empty, initializing a LOB column to a non-NULLvalue, varying-width character data, character data, varying width, CLOBs, columns, varying- width character data, datatype, varying-width columns, UCS2 Unicode character set, varying width character data, LOB storage, format of varying width character data, inline storage, out-of-line storage, inline and out-of-line storage properties, tablespace and storage characteristics, tablespace and LOB index, PCTVERSION, CACHE / NOCACHE, LOGGING / NOLOGGING, CHUNK, ENABLE | DISABLE STORAGE IN ROW, indexes on LOB columns, domain indexing, domain indexing on LOB columns, function-based indexes, on LOB columns, partitioned index-organized tables, restrictions for LOB columns, restrictions, index-organized tables and LOBs, index-organized tables, restrictions for LOB columns"/>
<meta name="dcterms.created" content="2017-03-16T22:27:47Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database SecureFiles and Large Objects Developer&#39;s Guide"/>
<meta name="dcterms.identifier" content="E17605-12"/>
<meta name="dcterms.isVersionOf" content="ADLOB"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2015, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="part_des.htm" title="Previous" type="text/html"/>
<link rel="Next" href="adlob_design.htm" title="Next" type="text/html"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-A81490D2-D92D-4513-81B3-FD672D0D267C"></a> <span id="PAGE" style="display:none;">18/34</span> <!-- End Header -->
<a id="ADLOB45259"></a>
<h1 id="ADLOB-GUID-A81490D2-D92D-4513-81B3-FD672D0D267C" class="sect1"><span class="enumeration_chapter">11</span> LOB Storage with Applications</h1>
<div>
<p>Applications that contain tables with LOB columns may use both <code class="codeph">SECUREFILE</code> and <code class="codeph">BASICFILE</code> LOBs. If a feature applies to only one kind of LOB, this is stated.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="adlob_tables.htm#GUID-F02AB4ED-3EF6-436D-B441-074034D1EB7A">Tables That Contain LOBs</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-FCF2526E-DB6D-4A77-AA4F-1DFB59E90784">Data Types for LOB Columns</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-517E1234-EFCD-4D16-B69B-23F72A18A77D">LOB Storage Parameters</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-DF2C343F-6937-4E9B-A15F-141A90AAC92E">LOB Columns Indexing</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-F4B2B0C3-6E8E-47A4-A46C-8014DAAD7B42">LOB Manipulation in Partitioned Tables</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-5E0E0772-C5CE-458A-AD07-E8DB32C24231">LOBs in Index Organized Tables</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-FD9C0216-EACF-4F21-B298-11336B4F4E75">Restrictions for LOBs in Partitioned Index-Organized Tables</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-FFA3FAB5-694E-49C5-A8AF-B21B441BEFCC">Updating LOBs in Nested Tables</a></p>
</li>
</ul>
</div>
<a id="ADLOB45260"></a>
<div class="props_rev_3"><a id="GUID-F02AB4ED-3EF6-436D-B441-074034D1EB7A"></a>
<h2 id="ADLOB-GUID-F02AB4ED-3EF6-436D-B441-074034D1EB7A" class="sect2">Tables That Contain LOBs</h2>
<div>
<p>When creating tables that contain LOBs, use these guidelines:</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="adlob_tables.htm#GUID-B30B5E05-1220-4880-A64D-3A6275E20C08">Persistent LOBs Initialized to NULL or Empty</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-138D2EC5-7097-4710-9F6E-5FE2F01E4B21">Initializing LOBs</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-B48DCD1B-0533-48FF-9F7C-AB673A35AE0A">Initializing Persistent LOB Columns and Attributes to a Value</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-F38219C8-6B10-49AF-AC9C-2548FC2D31A2">Initializing BFILEs to NULL or a File Name</a></p>
</li>
</ul>
</div>
<a id="ADLOB45261"></a>
<div class="props_rev_3"><a id="GUID-B30B5E05-1220-4880-A64D-3A6275E20C08"></a>
<h3 id="ADLOB-GUID-B30B5E05-1220-4880-A64D-3A6275E20C08" class="sect3">Persistent LOBs Initialized to NULL or Empty</h3>
<div>
<p>You can set a persistent LOB &mdash; &shy;that is, a LOB column in a table, or a LOB attribute in an object type that you defined&mdash; to be <code class="codeph">NULL</code> or empty:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Set a Persistent LOB to NULL:</span> A LOB set to <code class="codeph">NULL</code> has no locator. A <code class="codeph">NULL</code> value is stored in the row in the table, not a locator. This is the same process as for all other data types.</p>
</li>
<li>
<p><span class="bold">Set a Persistent LOB to Empty:</span> By contrast, an empty LOB stored in a table is a LOB of zero length that has a locator. So, if you <code class="codeph">SELECT</code> from an empty LOB column or attribute, then you get back a locator which you can use to populate the LOB with data using supported programmatic environments, such as OCI or <code class="codeph">PL/SQL(DBMS_LOB</code>). See <a href="adlob_api_overview.htm#GUID-54BD371D-4486-48FD-BBCE-6374D03E5697">Overview of Supplied LOB APIs</a> for more information on supported environments.</p>
</li>
</ul>
</div>
<a id="ADLOB45262"></a>
<div class="props_rev_3"><a id="GUID-2A9490EB-7791-4EDA-8218-F96AFEBDF92E"></a>
<h4 id="ADLOB-GUID-2A9490EB-7791-4EDA-8218-F96AFEBDF92E" class="sect4">Setting a Persistent LOB to NULL</h4>
<div>
<div class="section">
<p>You may want to set a persistent LOB value to <code class="codeph">NULL</code> upon inserting the row.</p>
<p>These are possible situations where this is useful:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>In cases where you do not have the LOB data at the time of the <code class="codeph">INSERT</code>.</p>
</li>
<li>
<p>If you want to use a <code class="codeph">SELECT</code> statement, such as the following, to determine whether or not the LOB holds a <code class="codeph">NULL</code> value:</p>
<pre dir="ltr">SELECT COUNT (*) FROM print_media WHERE ad_graphic IS NOT NULL; 

SELECT COUNT (*) FROM print_media WHERE ad_graphic IS NULL; 
</pre></li>
</ul>
<p>Note that you cannot call OCI or <code class="codeph">DBMS_LOB</code> functions on a <code class="codeph">NULL</code> <a id="d28838e405" class="indexterm-anchor"></a><a id="d28838e409" class="indexterm-anchor"></a><a id="d28838e411" class="indexterm-anchor"></a><a id="d28838e413" class="indexterm-anchor"></a>LOB, so you must then use an SQL <code class="codeph">UPDATE</code> statement to reset the LOB column to a non-<code class="codeph">NULL</code> (or empty) value.</p>
<p>The point is that you cannot make a function call from the supported programmatic environments on a LOB that is <code class="codeph">NULL.</code> These functions only work with a locator, and if the LOB column is <code class="codeph">NULL</code>, then there is no locator in the row.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="ADLOB45263"></a>
<div class="props_rev_3"><a id="GUID-6F7EDF6A-C374-4584-93D2-115EA892CF24"></a>
<h4 id="ADLOB-GUID-6F7EDF6A-C374-4584-93D2-115EA892CF24" class="sect4">Setting a Persistent LOB to Empty</h4>
<div>
<div class="section">
<p>You can initialize a persistent LOB to <code class="codeph">EMPTY</code> rather that <code class="codeph">NULL</code>. Doing so, enables you to obtain a locator for the LOB instance without populating the LOB with data.</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>You set a persistent LOB to <code class="codeph">EMPTY</code>, using the SQL function <code class="codeph">EMPTY_BLOB()</code> or <code class="codeph">EMPTY_CLOB()</code> in the <code class="codeph">INSERT</code> statement, as follows.</p>
<pre dir="ltr">INSERT INTO a_table VALUES (EMPTY_BLOB());
</pre></li>
</ul>
<p><a id="d28838e536" class="indexterm-anchor"></a>As an alternative, you can use the <code class="codeph">RETURNING</code> clause to obtain the LOB locator in one operation rather than calling a subsequent <code class="codeph">SELECT</code> statement:</p>
<pre dir="ltr">DECLARE
   Lob_loc  BLOB;
BEGIN
   INSERT INTO a_table VALUES (EMPTY_BLOB()) RETURNING blob_col INTO Lob_loc;
<span class="italic">   /* Now use the locator Lob_loc to populate the BLOB with data */</span>
END;
</pre></div>
<!-- class="section" --></div>
</div>
</div>
<a id="ADLOB45264"></a>
<div class="props_rev_3"><a id="GUID-138D2EC5-7097-4710-9F6E-5FE2F01E4B21"></a>
<h3 id="ADLOB-GUID-138D2EC5-7097-4710-9F6E-5FE2F01E4B21" class="sect3">Initializing LOBs</h3>
<div>
<div class="section">
<p>You can initialize the LOBs in <code class="codeph">print_media</code> by using the following <code class="codeph">INSERT</code> statement:</p>
<pre dir="ltr">INSERT INTO print_media VALUES (1001, EMPTY_CLOB(), EMPTY_CLOB(), NULL,
    EMPTY_BLOB(), EMPTY_BLOB(), NULL, NULL, NULL, NULL);
</pre>
<p>This sets the value of <code class="codeph">ad_sourcetext</code><span class="italic">,</span> <code class="codeph">ad_fltextn</code><span class="italic">,</span> <code class="codeph">ad_composite</code><span class="italic">,</span> and <code class="codeph">ad_photo</code> to an empty value, and sets <code class="codeph">ad_graphic</code> to <code class="codeph">NULL</code>.</p>
<p>See <a href="adlob_working.htm#GUID-D71F0CBE-0717-41A2-BCD4-71E1DDF895D1" title="Many Oracle LOB examples use the print_media table of the Oracle Database Sample Schema PM.">Table for LOB Examples: The PM Schema print_media Table</a>for the <code class="codeph">print_media</code> table.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="ADLOB45265"></a>
<div class="props_rev_3"><a id="GUID-B48DCD1B-0533-48FF-9F7C-AB673A35AE0A"></a>
<h3 id="ADLOB-GUID-B48DCD1B-0533-48FF-9F7C-AB673A35AE0A" class="sect3">Initializing Persistent LOB Columns and Attributes to a Value</h3>
<div>
<div class="section">
<p>You can initialize the LOB column or LOB attributes to a value that contains more than 4G bytes of data, the limit before release 10.2.</p>
<div class="infoboxnotealso" id="GUID-B48DCD1B-0533-48FF-9F7C-AB673A35AE0A__GUID-9C508C22-8374-42BA-8F66-8D56528791DD">
<p class="notep1">See Also:</p>
<p><a href="adlob_data_interface.htm#GUID-4BFDD493-F3FE-451C-9B03-21669D635586">Data Interface for Persistent LOBs</a></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADLOB45266"></a>
<div class="props_rev_3"><a id="GUID-F38219C8-6B10-49AF-AC9C-2548FC2D31A2"></a>
<h3 id="ADLOB-GUID-F38219C8-6B10-49AF-AC9C-2548FC2D31A2" class="sect3">Initializing BFILEs to NULL or a File Name</h3>
<div>
<div class="section">
<p>A <code class="codeph">BFILE</code> can be initialized to <code class="codeph">NULL</code> or to a filename. To do so, you can use the <code class="codeph">BFILENAME()</code> function.</p>
<div class="infoboxnotealso" id="GUID-F38219C8-6B10-49AF-AC9C-2548FC2D31A2__GUID-9C4A1F06-F4CB-4967-95AF-C1EA5A8DEE2A">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="adlob_bfile_ops.htm#GUID-8E287C3F-32D5-4AF6-9858-FDBCFA28A480">BFILENAME and Initialization</a>&#34;</span>.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADLOB101"></a>
<div class="props_rev_3"><a id="GUID-D3001FAF-1C46-4913-964B-61BCC14039B8"></a>
<h3 id="ADLOB-GUID-D3001FAF-1C46-4913-964B-61BCC14039B8" class="sect3">Restriction on First Extent of a LOB Segment</h3>
<div>
<p>The first extent of any segment requires <span class="italic">at least 2 blocks</span> (if <code class="codeph">FREELIST GROUPS</code> was 0). That is, the initial extent size of the segment should be at least 2 blocks. LOBs segments are different because they need <span class="italic">at least 3 blocks</span> in the first extent if the LOB is a BasicFiles LOB and 16 blocks if the LOB is a SecureFiles LOB.</p>
<p>If you try to create a LOB segment in a permanent dictionary managed tablespace with initial = 2 blocks, then it still works because it is possible for segments in permanent dictionary-managed tablespaces to override the default storage setting of the tablespaces.</p>
<p>But if uniform, locally managed tablespaces or dictionary managed tablespaces of the temporary type, or locally managed temporary tablespaces have an extent size of 2 blocks, then LOB segments cannot be created in these tablespaces. This is because in these tablespace types, extent sizes are fixed and the default storage setting of the tablespaces is not ignored.</p>
</div>
</div>
</div>
<a id="ADLOB45267"></a>
<div class="props_rev_3"><a id="GUID-FCF2526E-DB6D-4A77-AA4F-1DFB59E90784"></a>
<h2 id="ADLOB-GUID-FCF2526E-DB6D-4A77-AA4F-1DFB59E90784" class="sect2">Data Types for LOB Columns</h2>
<div>
<p>When selecting a data type, consider the following three topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="adlob_tables.htm#GUID-4362287B-6452-4E37-B34D-477A8ACEA4C9">LOBs Compared to LONG and LONG RAW Types</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-710BFEBD-ECCE-4598-BB69-31D6EDCD7C4F">Varying-Width Character Data Storage in LOBs</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-AABE1311-0928-4D4D-9C1C-926EBF977B61">Converting Character Sets Implicitly with LOBs</a></p>
</li>
</ul>
</div>
<a id="ADLOB45269"></a><a id="ADLOB45268"></a>
<div class="props_rev_3"><a id="GUID-4362287B-6452-4E37-B34D-477A8ACEA4C9"></a>
<h3 id="ADLOB-GUID-4362287B-6452-4E37-B34D-477A8ACEA4C9" class="sect3">LOBs Compared to LONG and LONG RAW Types</h3>
<div>
<div class="section">
<p><a href="adlob_tables.htm#GUID-4362287B-6452-4E37-B34D-477A8ACEA4C9__g1017705" title="This table is described in the preceding text">Table 11-1</a> lists the similarities and differences between LOBs, LONGs, and LONG RAW types.</p>
</div>
<!-- class="section" -->
<div class="tblformal" id="GUID-4362287B-6452-4E37-B34D-477A8ACEA4C9__g1017705">
<p class="titleintable">Table 11-1 LOBs Vs. LONG RAW</p>
<table class="cellalignment2789" title="LOBs Vs. LONG RAW" summary="This table is described in the preceding text">
<thead>
<tr class="cellalignment2783">
<th class="cellalignment2797" id="d28838e1056">LOB Data Type</th>
<th class="cellalignment2798" id="d28838e1059">LONG and LONG RAW Data Type</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2783">
<td class="cellalignment2799" id="d28838e1064" headers="d28838e1056">
<p>You can store multiple LOBs in a single row</p>
</td>
<td class="cellalignment2800" headers="d28838e1064 d28838e1059">
<p>You can store only one <code class="codeph">LONG</code> or <code class="codeph">LONG</code> <code class="codeph">RAW</code> in each row.</p>
</td>
</tr>
<tr class="cellalignment2783">
<td class="cellalignment2799" id="d28838e1080" headers="d28838e1056">
<p><code class="codeph">LOB</code>s can be attributes of a user-defined data type</p>
</td>
<td class="cellalignment2800" headers="d28838e1080 d28838e1059">
<p>This is not possible with either a <code class="codeph">LONG</code> or <code class="codeph">LONG</code> <code class="codeph">RAW</code></p>
</td>
</tr>
<tr class="cellalignment2783">
<td class="cellalignment2799" id="d28838e1097" headers="d28838e1056">
<p>Only the LOB locator is stored in the table column; <code class="codeph">BLOB</code> and <code class="codeph">CLOB</code> data can be stored in separate tablespaces and <code class="codeph">BFILE</code> data is stored as an external file.</p>
<p>For inline LOBs, the database stores LOBs that are less than approximately 4000 bytes of data in the table column.</p>
</td>
<td class="cellalignment2800" headers="d28838e1097 d28838e1059">
<p>In the case of a <code class="codeph">LONG</code> or <code class="codeph">LONG</code> <code class="codeph">RAW</code> the entire value is stored in the table column.</p>
</td>
</tr>
<tr class="cellalignment2783">
<td class="cellalignment2799" id="d28838e1124" headers="d28838e1056">
<p>When you access a LOB column, you can choose to fetch the locator or the data.</p>
</td>
<td class="cellalignment2800" headers="d28838e1124 d28838e1059">
<p>When you access a <code class="codeph">LONG</code> or <code class="codeph">LONG</code> <code class="codeph">RAW,</code> the entire value is returned.</p>
</td>
</tr>
<tr class="cellalignment2783">
<td class="cellalignment2799" id="d28838e1140" headers="d28838e1056">
<p>A LOB can be up to 128 terabytes or more in size depending on your block size.</p>
</td>
<td class="cellalignment2800" headers="d28838e1140 d28838e1059">
<p>A <code class="codeph">LONG</code> or <code class="codeph">LONG</code> <code class="codeph">RAW</code> instance is limited to 2 gigabytes in size.</p>
</td>
</tr>
<tr class="cellalignment2783">
<td class="cellalignment2799" id="d28838e1156" headers="d28838e1056">
<p>There is greater flexibility in manipulating data in a random, piece-wise manner with LOBs. LOBs can be accessed at random offsets.</p>
</td>
<td class="cellalignment2800" headers="d28838e1156 d28838e1059">
<p>Less flexibility in manipulating data in a random, piece-wise manner with <code class="codeph">LONG or LONG RAW data.</code><code class="codeph">LONG</code>s must be accessed from the beginning to the desired location<code class="codeph">.</code></p>
</td>
</tr>
<tr class="cellalignment2783">
<td class="cellalignment2799" id="d28838e1170" headers="d28838e1056">
<p>You can replicate LOBs in both local and distributed environments.</p>
</td>
<td class="cellalignment2800" headers="d28838e1170 d28838e1059">
<p>Replication in both local and distributed environments is not possible with a <code class="codeph">LONG</code> or <code class="codeph">LONG</code> <code class="codeph">RAW</code> (see <a class="olink REPLN500" target="_blank" href="../REPLN/repplan.htm#REPLN500"><span class="italic">Oracle Database Advanced Replication)</span></a></p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="ADLOB45270"></a>
<div class="props_rev_3"><a id="GUID-710BFEBD-ECCE-4598-BB69-31D6EDCD7C4F"></a>
<h3 id="ADLOB-GUID-710BFEBD-ECCE-4598-BB69-31D6EDCD7C4F" class="sect3">Varying-Width Character Data Storage in LOBs</h3>
<div>
<p>Varying-width character data in <code class="codeph">CLOB</code> and <code class="codeph">NCLOB</code> data types is stored in an internal format that is compatible with UCS2 Unicode character set format. This ensures that there is no storage loss of character data in a varying-width format. Also note the following if you are using LOBs to store varying-width character data:</p>
<ul style="list-style-type: disc;">
<li>
<p>You can create tables containing <code class="codeph">CLOB</code> and <code class="codeph">NCLOB</code> columns even if you use a varying-width <code class="codeph">CHAR</code> or <code class="codeph">NCHAR</code> database character set.</p>
</li>
<li>
<p>You can create a table containing a data type that has a <code class="codeph">CLOB</code> attribute regardless of whether you use a varying-width <code class="codeph">CHAR</code> database character set.</p>
</li>
</ul>
</div>
</div>
<a id="ADLOB45271"></a>
<div class="props_rev_3"><a id="GUID-AABE1311-0928-4D4D-9C1C-926EBF977B61"></a>
<h3 id="ADLOB-GUID-AABE1311-0928-4D4D-9C1C-926EBF977B61" class="sect3">Converting Character Sets Implicitly with LOBs</h3>
<div>
<div class="section">
<p>For <code class="codeph">CLOB</code> and <code class="codeph">NCLOB</code> instances used in OCI (Oracle Call Interface), or any of the programmatic environments that access OCI functionality, character set conversions are implicitly performed when translating from one character set to another.</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Use the <code class="codeph">DBMS_LOB.LOADCLOBFROMFILE</code> API to perform an implicit conversion from binary data to character data when loading to a <code class="codeph">CLOB</code> or <code class="codeph">NCLOB</code>.</p>
</li>
</ul>
<p>With the exception of <code class="codeph">DBMS_LOB.LOADCLOBFROMFILE</code>, LOB APIs do not perform implicit conversions from binary data to character data.</p>
<p>For example, when you use the <code class="codeph">DBMS_LOB.LOADFROMFILE</code> API to populate a <code class="codeph">CLOB</code> or <code class="codeph">NCLOB</code>, you are populating the LOB with binary data from a <code class="codeph">BFILE</code>. In this case, you must perform character set conversions on the <code class="codeph">BFILE</code> data before calling <code class="codeph">DBMS_LOB.LOADFROMFILE</code>.</p>
<div class="infoboxnotealso" id="GUID-AABE1311-0928-4D4D-9C1C-926EBF977B61__GUID-AD48511D-F922-408F-A5B0-67C48FC94FAC">
<p class="notep1">See Also:</p>
<p><a class="olink NLSPG002" target="_blank" href="../NLSPG/ch2charset.htm#NLSPG002"><span class="italic">Oracle Database Globalization Support Guide</span></a> for more detail on character set conversions.</p>
</div>
<div class="infobox-note" id="GUID-AABE1311-0928-4D4D-9C1C-926EBF977B61__GUID-42B7C4B8-5E40-4655-BF7E-D282522536B8">
<p class="notep1">Note:</p>
<p>The database character set cannot be changed from a single-byte to a multibyte character set if there are populated user-defined <code class="codeph">CLOB</code> columns in the database tables. The national character set cannot be changed between <code class="codeph">AL16UTF16</code> and <code class="codeph">UTF8</code> if there are populated user-defined <code class="codeph">NCLOB</code> columns in the database tables.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="ADLOB45272"></a>
<div class="props_rev_3"><a id="GUID-517E1234-EFCD-4D16-B69B-23F72A18A77D"></a>
<h2 id="ADLOB-GUID-517E1234-EFCD-4D16-B69B-23F72A18A77D" class="sect2">LOB Storage Parameters</h2>
<div>
<p>You should consider certain LOB storage characteristics when designing tables with LOB storage. For a discussion of <code class="codeph">SECUREFILE</code> parameters:</p>
<div class="infoboxnotealso" id="GUID-517E1234-EFCD-4D16-B69B-23F72A18A77D__GUID-F6341725-7994-42D1-83E6-8EDA0BDA7C24">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="adlob_smart.htm#GUID-D4B9A527-6DF8-4451-B88B-B973E961D9F7" title="The CREATE TABLE statement works with LOB storage using parameters that are specific to SecureFiles or BasicFiles LOB storage, or both.">CREATE TABLE with LOB Storage</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="adlob_smart.htm#GUID-E82DC080-8AA0-46F5-B6C6-DDAB7105BC9F" title="You can modify LOB storage with an ALTER TABLE statement and specific LOB-related parameters.">ALTER TABLE with LOB Storage</a>&#34;</span></p>
</li>
</ul>
</div>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="adlob_tables.htm#GUID-B82B3C24-1FAF-4661-96A0-28241FD2A052">Inline and Out-of-Line LOB Storage</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-D3BD47D3-DD6A-4DC9-9BAF-5DBB60918087">Defining Tablespace and Storage Characteristics for Persistent LOBs</a></p>
</li>
</ul>
</div>
<a id="ADLOB45273"></a>
<div class="props_rev_3"><a id="GUID-B82B3C24-1FAF-4661-96A0-28241FD2A052"></a>
<h3 id="ADLOB-GUID-B82B3C24-1FAF-4661-96A0-28241FD2A052" class="sect3">Inline and Out-of-Line LOB Storage</h3>
<div>
<p>LOB columns store locators that reference the location of the actual LOB value.</p>
<p>Actual LOB values are stored either in the table row (inline) or outside of the table row (out-of-line), depending on the column properties you specify when you create the table, and depending the size of the LOB.</p>
<p>LOB values are stored out-of-line when any of the following situations apply:</p>
<ul style="list-style-type: disc;">
<li>
<p>If you explicitly specify <a id="d28838e1647" class="indexterm-anchor"></a><code class="codeph">DISABLE</code> <code class="codeph">STORAGE</code> <code class="codeph">IN</code> <code class="codeph">ROW</code> for the LOB storage clause when you create the table.</p>
</li>
<li>
<p>If the size of the LOB is greater than <a id="d28838e1664" class="indexterm-anchor"></a>approximately 4000 bytes (4000 minus system control information), regardless of the LOB storage properties for the column.</p>
</li>
<li>
<p>If you update a LOB that is stored out-of-line and the resulting LOB is less than approximately 4000 bytes, it is still stored out-of-line.</p>
</li>
</ul>
<p>LOB values are stored inline when any of the following conditions apply:</p>
<ul style="list-style-type: disc;">
<li>
<p>When the size of the LOB stored in the given row is small, approximately 4000 bytes or less, and you either explicitly specify <a id="d28838e1678" class="indexterm-anchor"></a><code class="codeph">ENABLE</code> <code class="codeph">STORAGE</code> <code class="codeph">IN</code> <code class="codeph">ROW</code> or the LOB storage clause when you create the table, or when you do not specify this parameter (which is the default).</p>
</li>
<li>
<p><a id="d28838e1694" class="indexterm-anchor"></a>When the LOB value is <code class="codeph">NULL</code> (regardless of the LOB storage properties for the column).</p>
</li>
</ul>
<p>Using the default LOB storage properties (inline storage) can allow for better database performance; it avoids the overhead of creating and managing out-of-line storage for smaller LOB values. If LOB values stored in your database are frequently small in size, then using inline storage is recommended.</p>
<div class="infobox-note" id="GUID-B82B3C24-1FAF-4661-96A0-28241FD2A052__GUID-B7BB0C04-C07C-4B16-B3C1-B0B618C319FE">
<p class="notep1">Note:</p>
<ul style="list-style-type: disc;">
<li>
<p><a id="d28838e1706" class="indexterm-anchor"></a>LOB locators are always stored in the row.</p>
</li>
<li>
<p><a id="d28838e1711" class="indexterm-anchor"></a>A LOB locator always exists for any LOB instance regardless of the LOB storage properties or LOB value - <code class="codeph">NULL</code>, empty, or otherwise.</p>
</li>
<li>
<p><a id="d28838e1719" class="indexterm-anchor"></a>If the LOB is created with <code class="codeph">DISABLE STORAGE IN ROW</code> properties and the BasicFiles LOB holds any data, then a minimum of one <code class="codeph">CHUNK</code> of out-of-line storage space is used; even when the size of the LOB is less than the <code class="codeph">CHUNK</code> size.</p>
</li>
<li>
<p><a id="d28838e1735" class="indexterm-anchor"></a>If a LOB column is initialized with <code class="codeph">EMPTY_CLOB()</code> or <code class="codeph">EMPTY_BLOB()</code>, then no LOB value exists, not even <code class="codeph">NULL</code>. The row holds a LOB locator only. No additional LOB storage is used.</p>
</li>
<li>
<p><a id="d28838e1749" class="indexterm-anchor"></a>LOB storage properties do not affect <code class="codeph">BFILE</code> columns. <code class="codeph">BFILE</code> data is always stored in operating system files outside the database.</p>
</li>
</ul>
</div>
</div>
</div>
<a id="ADLOB45274"></a>
<div class="props_rev_3"><a id="GUID-D3BD47D3-DD6A-4DC9-9BAF-5DBB60918087"></a>
<h3 id="ADLOB-GUID-D3BD47D3-DD6A-4DC9-9BAF-5DBB60918087" class="sect3">Defining Tablespace and Storage Characteristics for Persistent LOBs</h3>
<div>
<div class="section">
<p>When defining LOBs in a table, you can explicitly indicate the tablespace and storage characteristics for each <span class="italic">persistent LOB</span> column.</p>
<p>To create a BasicFiles LOB, the <code class="codeph">BASICFILE</code> keyword is optional but is recommended for clarity, as shown in the following example:</p>
<pre dir="ltr">CREATE TABLE ContainsLOB_tab (n NUMBER, c CLOB)  
      lob (c) STORE AS BASICFILE segname (TABLESPACE lobtbs1 CHUNK 4096 
                        PCTVERSION 5 
                        NOCACHE LOGGING 
                        STORAGE (MAXEXTENTS 5) 
                       ); 
</pre>
<p>For SecureFiles, the <code class="codeph">SECUREFILE</code> keyword is necessary, as shown in the following example (assuming <code class="codeph">TABLESPACE lobtbs1</code> is <code class="codeph">ASSM</code>):</p>
<pre dir="ltr">CREATE TABLE ContainsLOB_tab1 (n NUMBER, c CLOB)
      lob (c) STORE AS SECUREFILE sfsegname (TABLESPACE lobtbs1
                       RETENTION AUTO
                       CACHE LOGGING
                       STORAGE (MAXEXTENTS 5)
                     );
</pre>
<div class="infobox-note" id="GUID-D3BD47D3-DD6A-4DC9-9BAF-5DBB60918087__GUID-173834AE-0048-4526-97D5-80BEEB58EC88">
<p class="notep1">Note:</p>
<p>There are no tablespace or storage characteristics that you can specify for <span class="italic">external</span> LOBs (<code class="codeph">BFILE</code>s) as they are not stored in the database.</p>
</div>
<p>If you must modify the LOB storage parameters on an existing LOB column, then use the <code class="codeph">ALTER</code> <code class="codeph">TABLE</code> <code class="codeph">... MOVE</code> statement. You can change the <code class="codeph">RETENTION</code>, <code class="codeph">PCTVERSION</code>, <code class="codeph">CACHE</code>, <code class="codeph">NOCACHE</code> <code class="codeph">LOGGING</code>, <code class="codeph">NOLOGGING</code>, or <code class="codeph">STORAGE</code> settings. You can also change the <code class="codeph">TABLESPACE</code> using the <code class="codeph">ALTER TABLE ... MOVE</code> statement.</p>
</div>
<!-- class="section" --></div>
<a id="ADLOB45275"></a>
<div class="props_rev_3"><a id="GUID-96AEB423-5231-4E3A-B520-2C5FB95170E7"></a>
<h4 id="ADLOB-GUID-96AEB423-5231-4E3A-B520-2C5FB95170E7" class="sect4">Assigning a LOB Data Segment Name</h4>
<div>
<div class="section">
<p>As shown in the previous example, specifying a name for the LOB data segment makes for a much more intuitive working environment. When querying the LOB data dictionary views <code class="codeph">USER_LOBS</code>, <code class="codeph">ALL_LOBS</code>, <code class="codeph">DBA_LOBS</code> (see <a class="olink REFRN" target="_blank" href="../REFRN/toc.htm"><span class="italic">Oracle Database Reference</span></a>), you see the LOB data segment that you chose instead of system-generated names.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="ADLOB45276"></a>
<div class="props_rev_3"><a id="GUID-ADF08322-C5CA-4348-831A-6F172F06E9C1"></a>
<h3 id="ADLOB-GUID-ADF08322-C5CA-4348-831A-6F172F06E9C1" class="sect3">LOB Storage Characteristics for LOB Column or Attribute</h3>
<div>
<p>LOB storage characteristics that can be specified for a LOB column or a LOB attribute include the following:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">TABLESPACE</code></p>
</li>
<li>
<p><code class="codeph">PCTVERSION</code> or <code class="codeph">RETENTION</code></p>
<p>Note that you can specify either <code class="codeph">PCTVERSION</code> or <code class="codeph">RETENTION</code> for BasicFiles LOBs, but not both. For SecureFiles, only the <code class="codeph">RETENTION</code> parameter can be specified.</p>
</li>
<li>
<p><code class="codeph">CACHE</code>/<code class="codeph">NOCACHE/CACHE READS</code></p>
</li>
<li>
<p><code class="codeph">LOGGING/NOLOGGING</code></p>
</li>
<li>
<p><code class="codeph">CHUNK</code></p>
</li>
<li>
<p><code class="codeph">ENABLE</code>/<code class="codeph">DISABLE</code> <code class="codeph">STORAGE</code> <code class="codeph">IN</code> <code class="codeph">ROW</code></p>
</li>
<li>
<p><code class="codeph">STORAGE</code></p>
</li>
</ul>
<p>For most users, defaults for these storage characteristics are sufficient. If you want to fine-tune LOB storage, then consider the following guidelines.</p>
<div class="infoboxnotealso" id="GUID-ADF08322-C5CA-4348-831A-6F172F06E9C1__GUID-FFCB481B-393A-4BE9-A35E-EEA53E2BE693">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">STORAGE</code> clause in <a class="olink SQLRF30013" target="_blank" href="../SQLRF/clauses009.htm#SQLRF30013"><span class="italic">Oracle Database SQL Language Reference</span></a></p>
</li>
<li>
<p><code class="codeph">RETENTION</code> parameter in <a class="olink SQLRF54529" target="_blank" href="../SQLRF/statements_7002.htm#SQLRF54529"><span class="italic">Oracle Database SQL Language Reference</span></a></p>
</li>
</ul>
</div>
</div>
</div>
<a id="ADLOB45277"></a>
<div class="props_rev_3"><a id="GUID-4AA058A3-E537-4A0F-B4C8-8AC299FB6019"></a>
<h3 id="ADLOB-GUID-4AA058A3-E537-4A0F-B4C8-8AC299FB6019" class="sect3">TABLESPACE and LOB Index</h3>
<div>
<p>The LOB index is an internal structure that is strongly associated with LOB storage. This implies that a user may not drop the LOB index and rebuild it.</p>
<div class="infobox-note" id="GUID-4AA058A3-E537-4A0F-B4C8-8AC299FB6019__GUID-CC085188-AB68-4455-AAE8-E79F60C2021B">
<p class="notep1">Note:</p>
<p>The LOB index cannot be altered.</p>
</div>
<p>The system determines which tablespace to use for LOB data and LOB index depending on your specification in the LOB storage clause:</p>
<ul style="list-style-type: disc;">
<li>
<p>If you do <span class="italic">not</span> specify a tablespace for the LOB data, then the tablespace of the table is used for the LOB data and index.</p>
</li>
<li>
<p>If you specify a tablespace for the LOB data, then both the LOB data and index use the tablespace that was specified.</p>
</li>
</ul>
</div>
<a id="ADLOB45278"></a>
<div class="props_rev_3"><a id="GUID-6688329D-2718-4E6C-8947-DB212D435103"></a>
<h4 id="ADLOB-GUID-6688329D-2718-4E6C-8947-DB212D435103" class="sect4">Tablespace for LOB Index in Non-Partitioned Table</h4>
<div>
<p>When creating a table, if you specify a tablespace for the LOB index for a non-partitioned table, then your specification of the tablespace is ignored and the LOB index is co-located with the LOB data. Partitioned LOBs do not include the LOB index syntax.</p>
<p>Specifying a separate tablespace for the LOB storage segments enables a decrease in contention on the tablespace of the table.</p>
</div>
</div>
</div>
<a id="ADLOB45280"></a><a id="ADLOB45279"></a>
<div class="props_rev_3"><a id="GUID-8181A78E-C8ED-4BFD-BE2C-73B340B78EBD"></a>
<h3 id="ADLOB-GUID-8181A78E-C8ED-4BFD-BE2C-73B340B78EBD" class="sect3">PCTVERSION</h3>
<div>
<p>When a BasicFiles LOB is modified, a new version of the BasicFiles LOB page is produced in order to support consistent read of prior versions of the BasicFiles LOB value.</p>
<p><code class="codeph">PCTVERSION</code> is the percentage of all used BasicFiles LOB data space that can be occupied by old versions of BasicFiles LOB data pages. As soon as old versions of BasicFiles LOB data pages start to occupy more than the <code class="codeph">PCTVERSION</code> amount of used BasicFiles LOB space, Oracle Database tries to reclaim the old versions and reuse them. In other words, <code class="codeph">PCTVERSION</code> is the percent of used BasicFiles LOB data blocks that is available for versioning old BasicFiles LOB data.</p>
<p><code class="codeph">PCTVERSION</code> has a default of 10 (%), a minimum of 0, and a maximum of 100.</p>
<p>To decide what value <code class="codeph">PCTVERSION</code> should be set to, consider the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>How often BasicFiles LOBs are updated?</p>
</li>
<li>
<p>How often the updated BasicFiles LOBs are read?</p>
</li>
</ul>
<p><a href="adlob_tables.htm#GUID-8181A78E-C8ED-4BFD-BE2C-73B340B78EBD__g1017753" title="This table is described in the preceding text">Table 11-2</a> provides some guidelines for determining a suitable <code class="codeph">PCTVERSION</code> value given an update percentage of &#39;X&#39;.</p>
<div class="tblformal" id="GUID-8181A78E-C8ED-4BFD-BE2C-73B340B78EBD__g1017753">
<p class="titleintable">Table 11-2 Recommended PCTVERSION Settings</p>
<table class="cellalignment2789" title="Recommended PCTVERSION Settings" summary="This table is described in the preceding text">
<thead>
<tr class="cellalignment2783">
<th class="cellalignment2801" id="d28838e2414">BasicFiles LOB Update Pattern</th>
<th class="cellalignment2802" id="d28838e2417">BasicFiles LOB Read Pattern</th>
<th class="cellalignment2803" id="d28838e2420">PCTVERSION</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2783">
<td class="cellalignment2804" id="d28838e2425" headers="d28838e2414">
<p>Updates X% of LOB data</p>
</td>
<td class="cellalignment2805" headers="d28838e2425 d28838e2417">
<p>Reads updated LOBs</p>
</td>
<td class="cellalignment2806" headers="d28838e2425 d28838e2420">
<p>X%</p>
</td>
</tr>
<tr class="cellalignment2783">
<td class="cellalignment2804" id="d28838e2435" headers="d28838e2414">
<p>Updates X% of LOB data</p>
</td>
<td class="cellalignment2805" headers="d28838e2435 d28838e2417">
<p>Reads LOBs but not the updated LOBs</p>
</td>
<td class="cellalignment2806" headers="d28838e2435 d28838e2420">
<p>0%</p>
</td>
</tr>
<tr class="cellalignment2783">
<td class="cellalignment2804" id="d28838e2445" headers="d28838e2414">
<p>Updates X% of LOB data</p>
</td>
<td class="cellalignment2805" headers="d28838e2445 d28838e2417">
<p>Reads both updated and non-updated LOBs</p>
</td>
<td class="cellalignment2806" headers="d28838e2445 d28838e2420">
<p>2X%</p>
</td>
</tr>
<tr class="cellalignment2783">
<td class="cellalignment2804" id="d28838e2455" headers="d28838e2414">
<p>Never updates LOB</p>
</td>
<td class="cellalignment2805" headers="d28838e2455 d28838e2417">
<p>Reads LOBs</p>
</td>
<td class="cellalignment2806" headers="d28838e2455 d28838e2420">
<p>0%</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>If your application requires several BasicFiles LOB updates concurrent with heavy reads of BasicFiles LOB columns, then consider using a higher value for <code class="codeph">PCTVERSION</code>, such as 20%.</p>
<p>Setting <code class="codeph">PCTVERSION</code> to twice the default value allows more free pages to be used for old versions of data pages. Because large queries may require consistent reads of BasicFiles LOB columns, it may be useful to retain old versions of BasicFiles LOB pages. In this case, BasicFiles LOB storage may grow because the database does not reuse free pages aggressively.</p>
<p>If persistent BasicFiles LOB instances in your application are created and written just once and are primarily read-only afterward, then updates are infrequent. In this case, consider using a lower value for <code class="codeph">PCTVERSION</code>, such as 5% or lower.</p>
<p>The more infrequent and smaller the BasicFiles LOB updates are, the less space must be reserved for old copies of BasicFiles LOB data. If existing BasicFiles LOBs are known to be read-only, then you could safely set <code class="codeph">PCTVERSION</code> to 0% because there would never be any pages needed for old versions of data.</p>
</div>
</div>
<a id="ADLOB45281"></a>
<div class="props_rev_3"><a id="GUID-8FB3E176-1024-4531-9706-BA9C75C7CD28"></a>
<h3 id="ADLOB-GUID-8FB3E176-1024-4531-9706-BA9C75C7CD28" class="sect3">RETENTION Parameter for BasicFiles LOBs</h3>
<div>
<p>You can specify the <code class="codeph">RETENTION</code> parameter in the LOB storage clause of the <code class="codeph">CREATE TABLE</code> or <code class="codeph">ALTER TABLE</code> statement as an alternative to the <code class="codeph">PCTVERSION</code> parameter,. Doing so, configures the LOB column to store old versions of LOB data for a <span class="italic">period of time</span>, rather than using a percentage of the table space. For example:</p>
<pre dir="ltr">CREATE TABLE ContainsLOB_tab (n NUMBER, c CLOB)  
      lob (c) STORE AS BASICFILE segname (TABLESPACE lobtbs1 CHUNK 4096 
                        RETENTION 
                        NOCACHE LOGGING 
                        STORAGE (MAXEXTENTS 5) 
                       ); 
</pre>
<p>The <code class="codeph">RETENTION</code> parameter is designed for use with <code class="codeph">UNDO</code> features of the database, such as Flashback Versions Query. When a LOB column has the <code class="codeph">RETENTION</code> property set, old versions of the LOB data are retained for the amount of time specified by the <code class="codeph">UNDO_RETENTION</code> parameter.</p>
<p>Note the following with respect to the <code class="codeph">RETENTION</code> parameter:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">UNDO</code> SQL is not enabled for LOB columns as it is with other data types. You must set the <code class="codeph">RETENTION</code> property on a LOB column to use Undo SQL on LOB data.</p>
</li>
<li>
<p>You cannot set the value of the <code class="codeph">RETENTION</code> parameter explicitly. The amount of time for retention of LOB versions in determined by the <code class="codeph">UNDO_RETENTION</code> parameter.</p>
</li>
<li>
<p>Usage of the <code class="codeph">RETENTION</code> parameter is only supported in Automatic Undo Management mode. You must configure your table for use with Automatic Undo Management before you can set <code class="codeph">RETENTION</code> on a LOB column. <a id="d28838e2612" class="indexterm-anchor"></a><a id="d28838e2614" class="indexterm-anchor"></a>ASSM is required for LOB <code class="codeph">RETENTION</code> to be in effect for BasicFiles LOBs. The <code class="codeph">RETENTION</code> parameter of the SQL (in the <code class="codeph">STORE</code> <code class="codeph">AS</code> clause) is silently ignored if the BasicFiles LOB resides in an MSSM tablespace.</p>
</li>
<li>
<p>The LOB storage clause can specify <code class="codeph">RETENTION</code> or <code class="codeph">PCTVERSION</code>, but not both.</p>
<div class="infoboxnotealso" id="GUID-8FB3E176-1024-4531-9706-BA9C75C7CD28__GUID-17252E5F-5368-4B80-AC65-5194D99B5192">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink ADFNS1008" target="_blank" href="../ADFNS/adfns_flashback.htm#ADFNS1008"><span class="italic">Oracle Database Development Guide</span></a> for more information on using flashback features of the database.</p>
</li>
<li>
<p><a class="olink SQLRF30013" target="_blank" href="../SQLRF/clauses009.htm#SQLRF30013"><span class="italic">Oracle Database SQL Language Reference</span></a> for details on LOB storage clause syntax.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<a id="ADLOB45282"></a>
<div class="props_rev_3"><a id="GUID-9569D544-FF47-4753-8763-E456C628A559"></a>
<h3 id="ADLOB-GUID-9569D544-FF47-4753-8763-E456C628A559" class="sect3">RETENTION Parameter for SecureFiles LOBs</h3>
<div>
<p>Specifying the <code class="codeph">RETENTION</code> parameter for SecureFiles indicates that the database manages consistent read data for the SecureFiles storage dynamically, taking into account factors such as the <code class="codeph">UNDO</code> mode of the database.</p>
<ul style="list-style-type: disc;">
<li>
<p>Specify <code class="codeph">MAX</code> if the database is in <code class="codeph">FLASHBACK</code> mode to limit the size of the LOB <code class="codeph">UNDO</code> retention in bytes. If you specify <code class="codeph">MAX</code>, then you must also specify the <code class="codeph">MAXSIZE</code> clause in the <code class="codeph">storage_clause</code>.</p>
</li>
<li>
<p>Specify <code class="codeph">AUTO</code> if you want to retain <code class="codeph">UNDO</code> sufficient for consistent read purposes only. This is the default.</p>
</li>
<li>
<p>Specify <code class="codeph">NONE</code> if no <code class="codeph">UNDO</code> is required for either consistent read or flashback purposes.</p>
</li>
</ul>
<p>The default <code class="codeph">RETENTION</code> for SecureFiles is <code class="codeph">AUTO</code>.</p>
</div>
</div>
<a id="ADLOB45284"></a><a id="ADLOB45283"></a>
<div class="props_rev_3"><a id="GUID-0299AFF9-7A92-47E3-A83E-59F2574A0ADF"></a>
<h3 id="ADLOB-GUID-0299AFF9-7A92-47E3-A83E-59F2574A0ADF" class="sect3">CACHE / NOCACHE / CACHE READS</h3>
<div>
<p>When creating tables that contain LOBs, use the cache options according to the guidelines in <a href="adlob_tables.htm#GUID-0299AFF9-7A92-47E3-A83E-59F2574A0ADF__g1017777" title="This table is described in the preceding text">Table 11-3</a>:</p>
<div class="tblformal" id="GUID-0299AFF9-7A92-47E3-A83E-59F2574A0ADF__g1017777">
<p class="titleintable">Table 11-3 When to Use CACHE, NOCACHE, and CACHE READS</p>
<table class="cellalignment2789" title="When to Use CACHE, NOCACHE, and CACHE READS" summary="This table is described in the preceding text">
<thead>
<tr class="cellalignment2783">
<th class="cellalignment2807" id="d28838e2865">Cache Mode</th>
<th class="cellalignment2801" id="d28838e2868">Read</th>
<th class="cellalignment2801" id="d28838e2871">Write</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2783">
<td class="cellalignment2808" id="d28838e2876" headers="d28838e2865">
<p><code class="codeph">CACHE READS</code></p>
</td>
<td class="cellalignment2804" headers="d28838e2876 d28838e2868">
<p>Frequently</p>
</td>
<td class="cellalignment2804" headers="d28838e2876 d28838e2871">
<p>Once or occasionally</p>
</td>
</tr>
<tr class="cellalignment2783">
<td class="cellalignment2808" id="d28838e2887" headers="d28838e2865">
<p><code class="codeph">CACHE</code></p>
</td>
<td class="cellalignment2804" headers="d28838e2887 d28838e2868">
<p>Frequently</p>
</td>
<td class="cellalignment2804" headers="d28838e2887 d28838e2871">
<p>Frequently</p>
</td>
</tr>
<tr class="cellalignment2783">
<td class="cellalignment2808" id="d28838e2898" headers="d28838e2865">
<p><code class="codeph">NOCACHE</code> (default)</p>
</td>
<td class="cellalignment2804" headers="d28838e2898 d28838e2868">
<p>Once or occasionally</p>
</td>
<td class="cellalignment2804" headers="d28838e2898 d28838e2871">
<p>Never</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
<a id="ADLOB45285"></a>
<div class="props_rev_3"><a id="GUID-F6D60D84-6A90-443C-87D7-7171BAB2B1E7"></a>
<h4 id="ADLOB-GUID-F6D60D84-6A90-443C-87D7-7171BAB2B1E7" class="sect4">CACHE / NOCACHE / CACHE READS: LOB Values and Buffer Cache</h4>
<div>
<ul style="list-style-type: disc;">
<li>
<p>CACHE: LOB pages are placed in the buffer cache for faster access.</p>
</li>
<li>
<p>NOCACHE: As a parameter in the <code class="codeph">STORE AS</code> clause, <code class="codeph">NOCACHE</code> specifies that LOB values are not brought into the buffer cache.</p>
</li>
<li>
<p>CACHE READS: LOB values are brought into the buffer cache only during read and not during write operations.</p>
</li>
</ul>
<p><code class="codeph">NOCACHE</code> is the default for both SecureFiles and BasicFiles LOBs.</p>
<div class="infobox-note" id="GUID-F6D60D84-6A90-443C-87D7-7171BAB2B1E7__GUID-651BBC04-26BA-44CD-98C8-442DA37F61CC">
<p class="notep1">Note:</p>
<p>Using the <code class="codeph">CACHE</code> option results in improved performance when reading and writing data from the LOB column. However, it can potentially age other non-LOB pages out of the buffer cache prematurely.</p>
</div>
</div>
</div>
</div>
<a id="ADLOB45286"></a>
<div class="props_rev_3"><a id="GUID-3543D99F-A826-4750-8E94-7BAE754E0792"></a>
<h3 id="ADLOB-GUID-3543D99F-A826-4750-8E94-7BAE754E0792" class="sect3">LOGGING / NOLOGGING Parameter for BasicFiles LOBs</h3>
<div>
<p>The [<code class="codeph">NO</code>]<code class="codeph">LOGGING</code> parameter is applied to using LOBs in the same manner as for other table operations. In the usual case, if the [<code class="codeph">NO</code>]<code class="codeph">LOGGING</code> clause is omitted, then this means that neither <code class="codeph">NO</code><code class="codeph">LOGGING</code> nor <code class="codeph">LOGGING</code> is specified and the logging attribute of the table or table partition defaults to the logging attribute of the tablespace in which it resides.</p>
<p>For LOBs, there is a further alternative depending on how <code class="codeph">CACHE</code> is stipulated.</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">CACHE</span> <span class="bold">is specified</span> and [<code class="codeph">NO</code>]<code class="codeph">LOGGING</code> clause is omitted. <code class="codeph">LOGGING</code> is automatically implemented (because you cannot have <code class="codeph">CACHE</code> <code class="codeph">NOLOGGING</code>).</p>
</li>
<li>
<p><span class="bold">CACHE</span> <span class="bold">is not specified</span> and [<code class="codeph">NO</code>]<code class="codeph">LOGGING</code> clause is omitted. The process defaults in the same way as it does for tables and partitioned tables. That is, the [<code class="codeph">NO</code>]<code class="codeph">LOGGING</code> value is obtained from the tablespace in which the LOB segment resides.</p>
</li>
</ul>
<p>The following issues should also be kept in mind.</p>
</div>
<a id="ADLOB45287"></a>
<div class="props_rev_3"><a id="GUID-34BAE5A1-E016-4AE4-A805-BE7FDFB785DD"></a>
<h4 id="ADLOB-GUID-34BAE5A1-E016-4AE4-A805-BE7FDFB785DD" class="sect4">LOBs <span class="bold">Always Generate Undo for</span> LOB <span class="bold">Index Pages</span></h4>
<div>
<p>Regardless of whether <code class="codeph">LOGGING</code> or <code class="codeph">NOLOGGING</code> is set, LOBs never generate rollback information (undo) for LOB data pages because old LOB data is stored in versions.</p>
<p>Rollback information that is created for LOBs tends to be small because it is only for the LOB index page changes.</p>
</div>
</div>
<a id="ADLOB45288"></a>
<div class="sect4"><a id="GUID-6B0BA57E-A7F1-4182-BA3C-B1CF36C9D4F7"></a>
<h4 id="ADLOB-GUID-6B0BA57E-A7F1-4182-BA3C-B1CF36C9D4F7" class="sect4"><span class="bold">When</span> LOGGING <span class="bold">is Set Oracle Generates Full Redo for</span> LOB <span class="bold">Data Pages</span></h4>
<div>
<p><code class="codeph">NOLOGGING</code> is intended to be used when a customer does not care about media recovery.</p>
<p>Thus, if the disk/tape/storage media fails, then you cannot recover your changes from the log because the changes were never logged.</p>
</div>
<a id="ADLOB45289"></a>
<div class="props_rev_3"><a id="GUID-5F05A5C6-E45E-4751-8E41-6781EFD09458"></a>
<h5 id="ADLOB-GUID-5F05A5C6-E45E-4751-8E41-6781EFD09458" class="sect5">NOLOGGING is Useful for Bulk Loads or Inserts.</h5>
<div>
<p>For instance, when loading data into the LOB, if you do not care about redo and can just start the load over if it fails, set the LOB data segment storage characteristics to <code class="codeph">NOCACHE</code> <code class="codeph">NOLOGGING</code>. This provides good performance for the initial load of data.</p>
<p>Once you have completed loading data, if necessary, use <code class="codeph">ALTER</code> <code class="codeph">TABLE</code> to modify the LOB storage characteristics for the LOB data segment for normal LOB operations, for example, to <code class="codeph">CACHE</code> or <code class="codeph">NOCACHE</code> <code class="codeph">LOGGING</code>.</p>
<div class="infobox-note" id="GUID-5F05A5C6-E45E-4751-8E41-6781EFD09458__GUID-092EB5A5-B02F-4334-BC69-8DC64AF87632">
<p class="notep1">Note:</p>
<p><code class="codeph">CACHE</code> implies that you also get <code class="codeph">LOGGING</code>.</p>
</div>
</div>
</div>
</div>
</div>
<a id="ADLOB45290"></a>
<div class="props_rev_3"><a id="GUID-29BA6DC0-C48E-4AC9-8A64-1FD99B7D36CC"></a>
<h3 id="ADLOB-GUID-29BA6DC0-C48E-4AC9-8A64-1FD99B7D36CC" class="sect3">LOGGING/FILESYSTEM_LIKE_LOGGING for SecureFiles LOBs</h3>
<div>
<p>The <code class="codeph">NOLOGGING</code> and <code class="codeph">LOGGING</code> parameters are applied to using LOBs in the same manner as for other table operations.</p>
<p>In the usual case, if the <code class="codeph">logging_clause</code> is omitted, then the SecureFiles inherits its logging attribute from the tablespace in which it resides. In this case, if <code class="codeph">NOLOGGING</code> is the default value, the SecureFiles defaults to <code class="codeph">FILESYSTEM_LIKE_LOGGING</code>.</p>
<div class="infobox-note" id="GUID-29BA6DC0-C48E-4AC9-8A64-1FD99B7D36CC__GUID-54DF22E7-AD66-49FD-B5F0-F0C91D5A4908">
<p class="notep1">Note:</p>
<p>Using the <code class="codeph">CACHE</code> option results in improved performance when reading and writing data from the LOB column. However, it can potentially age other non-LOB pages out of the buffer cache prematurely.</p>
</div>
</div>
<a id="ADLOB45291"></a>
<div class="props_rev_3"><a id="GUID-7F10CD88-C74A-40DE-B3E3-148228CB318F"></a>
<h4 id="ADLOB-GUID-7F10CD88-C74A-40DE-B3E3-148228CB318F" class="sect4">CACHE Implies LOGGING</h4>
<div>
<p>For SecureFiles, there is a further alternative depending on how <code class="codeph">CACHE</code> is specified:</p>
<ul style="list-style-type: disc;">
<li>
<p>If <code class="codeph">CACHE</code> is specified and the <code class="codeph">LOGGING</code> clause is omitted, then <code class="codeph">LOGGING</code> is used.</p>
</li>
<li>
<p>If <code class="codeph">CACHE</code> is not specified and the logging_clause is omitted. Then the process defaults in the same way as it does for tables and partitioned tables. That is, the <code class="codeph">LOGGING</code> value is obtained from the tablespace in which the LOB value resides. If the tablespace is <code class="codeph">NOLOGGING</code>, then the SecureFiles defaults to <code class="codeph">FILESYSTEM_LIKE_LOGGING</code>.</p>
</li>
</ul>
<p>Keep the following issues in mind.</p>
</div>
</div>
<a id="ADLOB45292"></a>
<div class="props_rev_3"><a id="GUID-D4E7E0CF-8FB4-4219-B5BF-7D4119CA4274"></a>
<h4 id="ADLOB-GUID-D4E7E0CF-8FB4-4219-B5BF-7D4119CA4274" class="sect4">SecureFiles and an Efficient Method of Generating REDO and UNDO</h4>
<div>
<p>This means that Oracle Database determines if it is more efficient to generate <code class="codeph">REDO</code> and <code class="codeph">UNDO</code> for the change to a block, similar to heap blocks, or if it generates a version and full <code class="codeph">REDO</code> of the new block similar to BasicFiles LOBs.</p>
</div>
</div>
<a id="ADLOB45293"></a>
<div class="props_rev_3"><a id="GUID-965E951A-5B7B-4F78-8710-146F61FA8D2C"></a>
<h4 id="ADLOB-GUID-965E951A-5B7B-4F78-8710-146F61FA8D2C" class="sect4">FILESYSTEM_LIKE_LOGGING is Useful for Bulk Loads or Inserts</h4>
<div>
<p>For instance, when loading data into the LOB, if you do not care about <code class="codeph">REDO</code> and can just start the load over if it fails, set the LOB data segment storage characteristics to <code class="codeph">FILESYSTEM_LIKE_LOGGING</code>. This provides good performance for the initial load of data.</p>
<p>Once you have completed loading data, if necessary, use <code class="codeph">ALTER</code> <code class="codeph">TABLE</code> to modify the LOB storage characteristics for the LOB data segment for normal LOB operations. For example, to <code class="codeph">CACHE</code> or <code class="codeph">NOCACHE</code> <code class="codeph">LOGGING</code>.</p>
</div>
</div>
</div>
<a id="ADLOB45294"></a>
<div class="props_rev_3"><a id="GUID-A3D50A10-E688-4DB3-A3EB-07AC7D0019A6"></a>
<h3 id="ADLOB-GUID-A3D50A10-E688-4DB3-A3EB-07AC7D0019A6" class="sect3">CHUNK</h3>
<div>
<p>A chunk is one or more Oracle blocks.</p>
<p>You can specify the chunk size for the BasicFiles LOB when creating the table that contains the LOB. This corresponds to the data size used by Oracle Database when accessing or modifying the LOB value. Part of the chunk is used to store system-related information and the rest stores the LOB value. The API you are using has a function that returns the amount of space used in the LOB chunk to store the LOB value. In PL/SQL use <code class="codeph">DBMS_LOB.GETCHUNKSIZE</code>. In OCI, use <code class="codeph">OCILobGetChunkSize()</code>.</p>
<div class="infobox-note" id="GUID-A3D50A10-E688-4DB3-A3EB-07AC7D0019A6__GUID-36DF509D-44E8-4DB2-8BB8-D95EC7A78BB0">
<p class="notep1">Note:</p>
<p>If the tablespace block size is the same as the database block size, then <code class="codeph">CHUNK</code> is also a multiple of the database block size. The default <code class="codeph">CHUNK</code> size is equal to the size of one tablespace block, and the maximum value is 32K.</p>
</div>
<div class="infoboxnotealso" id="GUID-A3D50A10-E688-4DB3-A3EB-07AC7D0019A6__GUID-935B92CA-0CFE-48B5-AE69-F94DE9AE9682">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="adlob_design.htm#GUID-FD6659DC-8792-4D7C-AC07-9EABEA02DF91">Terabyte-Size LOB Support</a>&#34;</span> for information about maximum LOB sizes</p>
</div>
</div>
<a id="ADLOB45295"></a>
<div class="props_rev_3"><a id="GUID-D2B33837-A830-492D-954F-032B44C331AF"></a>
<h4 id="ADLOB-GUID-D2B33837-A830-492D-954F-032B44C331AF" class="sect4">The Value of CHUNK</h4>
<div>
<p>Once the value of <code class="codeph">CHUNK</code> is chosen (when the LOB column is created), it cannot be changed.</p>
<p>Because you cannot change the value <code class="codeph">CHUNK</code>, it is important that you choose a value which optimizes your storage and performance requirements. For SecureFiles, <code class="codeph">CHUNK</code> is an advisory size and is provided for backward compatibility purposes.</p>
</div>
<a id="ADLOB45297"></a><a id="ADLOB45296"></a>
<div class="props_rev_3"><a id="GUID-99B90EA0-666D-430B-9D0F-44699629D0F4"></a>
<h5 id="ADLOB-GUID-99B90EA0-666D-430B-9D0F-44699629D0F4" class="sect5">Space Considerations</h5>
<div>
<p>The value of <code class="codeph">CHUNK</code> does not matter for LOBs that are stored inline.</p>
<p>Inline storage occurs when <code class="codeph">ENABLE</code> <code class="codeph">STORAGE</code> <code class="codeph">IN</code> <code class="codeph">ROW</code> is set, and the size of the LOB locator and the LOB data is less than approximately 4000 bytes. However, when the LOB data is stored out-of-line, it always takes up space in multiples of the <code class="codeph">CHUNK</code> parameter. This can lead to a large waste of space if your data is small, but the <code class="codeph">CHUNK</code> is set to a large number. <a href="adlob_tables.htm#GUID-99B90EA0-666D-430B-9D0F-44699629D0F4__CIHFGJEE" title="Data Size vs CHUNK size">Table 11-4</a> illustrates this point:</p>
<div class="tblformalwide" id="GUID-99B90EA0-666D-430B-9D0F-44699629D0F4__CIHFGJEE">
<p class="titleintable">Table 11-4 Data Size and CHUNK Size</p>
<table class="cellalignment2809" title="Data Size and CHUNK Size" summary="Data Size vs CHUNK size">
<thead>
<tr class="cellalignment2783">
<th class="cellalignment2810" id="d28838e4015">Data Size</th>
<th class="cellalignment2811" id="d28838e4018">CHUNK Size</th>
<th class="cellalignment2812" id="d28838e4021">Disk Space Used to Store the LOB</th>
<th class="cellalignment2803" id="d28838e4024">Space Utilization (Percent)</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2783">
<td class="cellalignment2813" id="d28838e4029" headers="d28838e4015">
<p>3500 enable storage in row</p>
</td>
<td class="cellalignment2814" headers="d28838e4029 d28838e4018">
<p>irrelevant</p>
</td>
<td class="cellalignment2815" headers="d28838e4029 d28838e4021">
<p>3500 in row</p>
</td>
<td class="cellalignment2806" headers="d28838e4029 d28838e4024">
<p>100</p>
</td>
</tr>
<tr class="cellalignment2783">
<td class="cellalignment2813" id="d28838e4042" headers="d28838e4015">
<p>3500 disable storage in row</p>
</td>
<td class="cellalignment2814" headers="d28838e4042 d28838e4018">
<p>32 KB</p>
</td>
<td class="cellalignment2815" headers="d28838e4042 d28838e4021">
<p>32 KB</p>
</td>
<td class="cellalignment2806" headers="d28838e4042 d28838e4024">
<p>10</p>
</td>
</tr>
<tr class="cellalignment2783">
<td class="cellalignment2813" id="d28838e4055" headers="d28838e4015">
<p>3500 disable storage in row</p>
</td>
<td class="cellalignment2814" headers="d28838e4055 d28838e4018">
<p>4 KB</p>
</td>
<td class="cellalignment2815" headers="d28838e4055 d28838e4021">
<p>4 KB</p>
</td>
<td class="cellalignment2806" headers="d28838e4055 d28838e4024">
<p>90</p>
</td>
</tr>
<tr class="cellalignment2783">
<td class="cellalignment2813" id="d28838e4068" headers="d28838e4015">
<p>33 KB</p>
</td>
<td class="cellalignment2814" headers="d28838e4068 d28838e4018">
<p>32 KB</p>
</td>
<td class="cellalignment2815" headers="d28838e4068 d28838e4021">
<p>64 KB</p>
</td>
<td class="cellalignment2806" headers="d28838e4068 d28838e4024">
<p>51</p>
</td>
</tr>
<tr class="cellalignment2783">
<td class="cellalignment2813" id="d28838e4081" headers="d28838e4015">
<p>2 GB +10</p>
</td>
<td class="cellalignment2814" headers="d28838e4081 d28838e4018">
<p>32 KB</p>
</td>
<td class="cellalignment2815" headers="d28838e4081 d28838e4021">
<p>2 GB + 32 KB</p>
</td>
<td class="cellalignment2806" headers="d28838e4081 d28838e4024">
<p>99+</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="ADLOB45298"></a>
<div class="props_rev_3"><a id="GUID-AFD8D735-D009-4D1D-8D49-0365437CBFF5"></a>
<h5 id="ADLOB-GUID-AFD8D735-D009-4D1D-8D49-0365437CBFF5" class="sect5">Performance Considerations</h5>
<div>
<p>It is more efficient to access LOBs in big chunks.</p>
<p>You can set <code class="codeph">CHUNK</code> to the data size most frequently accessed or written. For example, if only one block of LOB data is accessed at a time, then set <code class="codeph">CHUNK</code> to the size of one block. If you have big LOBs, and read or write big amounts of data, then choose a large value for <code class="codeph">CHUNK</code>.</p>
</div>
</div>
</div>
<a id="ADLOB45299"></a>
<div class="props_rev_3"><a id="GUID-F83BB44C-C37B-40F1-94D4-8A50D61E1C6A"></a>
<h4 id="ADLOB-GUID-F83BB44C-C37B-40F1-94D4-8A50D61E1C6A" class="sect4">Set INITIAL and NEXT to Larger than CHUNK</h4>
<div>
<p>If you explicitly specify storage characteristics for the LOB, then make sure that <code class="codeph">INITIAL</code> and <code class="codeph">NEXT</code> for the LOB data segment storage are set to a size that is larger than the <code class="codeph">CHUNK</code> size.</p>
<p>For example, if the database block size is 2KB and you specify a <code class="codeph">CHUNK</code> of 8KB, then make sure that <code class="codeph">INITIAL</code> and <code class="codeph">NEXT</code> are bigger than 8KB and preferably considerably bigger (for example, at least 16KB).</p>
<p>Put another way: If you specify a value for <code class="codeph">INITIAL,</code> <code class="codeph">NEXT</code>, or the LOB <code class="codeph">CHUNK</code> size, then make sure they are set in the following manner:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">CHUNK</code> &lt;= <code class="codeph">NEXT</code></p>
</li>
<li>
<p><code class="codeph">CHUNK</code> &lt;= <code class="codeph">INITIAL</code></p>
</li>
</ul>
</div>
</div>
</div>
<a id="ADLOB45300"></a>
<div class="props_rev_3"><a id="GUID-2FEF93D4-621B-41FF-829A-E45339DFB11C"></a>
<h3 id="ADLOB-GUID-2FEF93D4-621B-41FF-829A-E45339DFB11C" class="sect3">ENABLE or DISABLE STORAGE IN ROW Clause</h3>
<div>
<p>You use the <code class="codeph">ENABLE</code> | <code class="codeph">DISABLE</code> <code class="codeph">STORAGE</code> <code class="codeph">IN</code> <code class="codeph">ROW</code> clause to indicate whether the LOB should be stored inline (in the row) or out-of-line.</p>
<div class="infobox-note" id="GUID-2FEF93D4-621B-41FF-829A-E45339DFB11C__GUID-3D0C17A5-47AE-4B7A-AA57-5A2A66A89A9B">
<p class="notep1">Note:</p>
<p>You may not alter this specification once you have made it: if you <code class="codeph">ENABLE STORAGE IN ROW</code>, then you cannot alter it to <code class="codeph">DISABLE STORAGE IN ROW</code> and vice versa.</p>
</div>
<p>The default is <code class="codeph">ENABLE</code> <code class="codeph">STORAGE</code> <code class="codeph">IN</code> <code class="codeph">ROW</code>.</p>
</div>
</div>
<a id="ADLOB45301"></a>
<div class="props_rev_3"><a id="GUID-B5F583AE-B96A-4D57-BA26-41D048FE28B5"></a>
<h3 id="ADLOB-GUID-B5F583AE-B96A-4D57-BA26-41D048FE28B5" class="sect3">Guidelines for ENABLE or DISABLE STORAGE IN ROW</h3>
<div>
<p>The maximum amount of LOB data stored in the row is the maximum <code class="codeph">VARCHAR2</code> size (4000). This includes the control information and the LOB value. If you indicate that the LOB should be stored in the row, once the LOB value and control information is larger than approximately 4000, then the LOB value is automatically moved out of the row.</p>
<p>This suggests the following guidelines:</p>
<p>The default, ENABLE STORAGE IN ROW, is usually the best choice for the following reasons:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Small LOBs:</span> If the LOB is small (less than approximately 4000 bytes), then the whole LOB can be read while reading the row without extra disk I/O.</p>
</li>
<li>
<p><span class="bold">Large LOBs:</span> If the LOB is big (greater than approximately 4000 bytes), then the control information is still stored in the row if ENABLE STORAGE IN ROW is set, even after moving the LOB data out of the row. This control information could enable us to read the out-of-line LOB data faster.</p>
</li>
</ul>
<p>However, in some cases <code class="codeph">DISABLE STORAGE IN ROW</code> is a better choice. This is because storing the LOB in the row increases the size of the row. This impacts performance if you are doing a lot of base table processing, such as full table scans, multi-row accesses (range scans), or many <code class="codeph">UPDATE</code>/<code class="codeph">SELECT</code> to columns other than the LOB columns.</p>
</div>
</div>
</div>
<a id="ADLOB45302"></a>
<div class="props_rev_3"><a id="GUID-DF2C343F-6937-4E9B-A15F-141A90AAC92E"></a>
<h2 id="ADLOB-GUID-DF2C343F-6937-4E9B-A15F-141A90AAC92E" class="sect2">LOB Columns Indexing</h2>
<div>
<p>There are different techniques you can use to index LOB columns.</p>
<div class="infobox-note" id="GUID-DF2C343F-6937-4E9B-A15F-141A90AAC92E__GUID-97D49844-1442-4B60-89F4-F5A68E2C0E4F">
<p class="notep1">Note:</p>
<p>After you move a LOB column any existing table indexes must be rebuilt.<a id="d28838e4551" class="indexterm-anchor"></a></p>
</div>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="adlob_tables.htm#GUID-12808065-C59B-4ED4-BAD8-1BF38C1FC73F">Domain Indexing on LOB Columns</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-FA3F48B2-17CB-4D51-A281-7C6844576424">Text Indexes on LOB Columns</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-1E54F133-F2E6-43E3-9EFA-4AF53D898C39">Function-Based Indexes on LOBs</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-FF748A89-941D-4131-A782-F400994223F9">Extensible Indexing on LOB Columns</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-3936617F-ACBD-4F81-9D69-FCE1ADC3787A">Oracle Text Indexing Support for XML</a></p>
</li>
</ul>
</div>
<a id="ADLOB45303"></a>
<div class="props_rev_3"><a id="GUID-12808065-C59B-4ED4-BAD8-1BF38C1FC73F"></a>
<h3 id="ADLOB-GUID-12808065-C59B-4ED4-BAD8-1BF38C1FC73F" class="sect3">Domain Indexing on LOB Columns</h3>
<div>
<p>You might be able to improve the performance of queries by building indexes specifically attuned to your domain. Extensibility interfaces provided with the database allow for domain indexing, a framework for implementing such domain specific indexes.</p>
<div class="infobox-note" id="GUID-12808065-C59B-4ED4-BAD8-1BF38C1FC73F__GUID-76A7AC0B-0C45-4DA1-A8C3-457B0D96DB53">
<p class="notep1">Note:</p>
<p>You cannot build a B-tree or bitmap index on a LOB column. <a id="d28838e4658" class="indexterm-anchor"></a><a id="d28838e4662" class="indexterm-anchor"></a></p>
</div>
<div class="infoboxnotealso" id="GUID-12808065-C59B-4ED4-BAD8-1BF38C1FC73F__GUID-E51D090B-1C34-4952-9ECB-D183CA453634">
<p class="notep1">See Also:</p>
<p><a class="olink ADDCI290" target="_blank" href="../ADDCI/dom_idx.htm#ADDCI290"><span class="italic">Oracle Database Data Cartridge Developer&#39;s Guide</span></a> for information on building domain specific indexes.</p>
</div>
</div>
</div>
<a id="ADLOB45304"></a>
<div class="props_rev_3"><a id="GUID-FA3F48B2-17CB-4D51-A281-7C6844576424"></a>
<h3 id="ADLOB-GUID-FA3F48B2-17CB-4D51-A281-7C6844576424" class="sect3">Text Indexes on LOB Columns</h3>
<div>
<p>Depending on the nature of the contents of the LOB column, one of the Oracle Text options could also be used for building indexes.</p>
<p>For example, if a text document is stored in a <code class="codeph">CLOB</code> column, then you can build a text index to speed up the performance of text-based queries over the <code class="codeph">CLOB</code> column.</p>
<div class="infoboxnotealso" id="GUID-FA3F48B2-17CB-4D51-A281-7C6844576424__GUID-C333FDAB-D3F3-4946-846A-3C234122BCAD">
<p class="notep1">See Also:</p>
<p><a class="olink CCAPP9083" target="_blank" href="../CCAPP/GUID-F488EE16-1E0A-445C-8424-499CE6317B2B.htm#CCAPP9083"><span class="italic">Oracle Text Application Developer&#39;s Guide</span></a> for an example of using a <code class="codeph">CLOB</code> column to store text data</p>
</div>
</div>
</div>
<a id="ADLOB45305"></a>
<div class="props_rev_3"><a id="GUID-1E54F133-F2E6-43E3-9EFA-4AF53D898C39"></a>
<h3 id="ADLOB-GUID-1E54F133-F2E6-43E3-9EFA-4AF53D898C39" class="sect3">Function-Based Indexes on LOBs</h3>
<div>
<p>A <a id="d28838e4826" class="indexterm-anchor"></a><a id="d28838e4830" class="indexterm-anchor"></a>function-based index is an index built on an expression. It extends your indexing capabilities beyond indexing on a column. A function-based index increases the variety of ways in which you can access data.</p>
<p>Function-based indexes cannot be built on nested tables or LOB columns. However, you can build function-based indexes on VARRAYs.</p>
<p>Like <a id="d28838e4837" class="indexterm-anchor"></a>extensible indexes and domain indexes on LOB columns, function-based indexes are also automatically updated when a DML operation is performed on the LOB column. Function-based indexes are also updated when any extensible index is updated.</p>
<div class="infoboxnotealso" id="GUID-1E54F133-F2E6-43E3-9EFA-4AF53D898C39__GUID-198FBEEB-A82B-4017-9427-F9B1DECD804F">
<p class="notep1">See Also:</p>
<p><a class="olink ADFNS00505" target="_blank" href="../ADFNS/adfns_indexes.htm#ADFNS00505"><span class="italic">Oracle Database Development Guide</span></a> for more information on using function-based indexes.</p>
</div>
</div>
</div>
<a id="ADLOB45306"></a>
<div class="props_rev_3"><a id="GUID-FF748A89-941D-4131-A782-F400994223F9"></a>
<h3 id="ADLOB-GUID-FF748A89-941D-4131-A782-F400994223F9" class="sect3">Extensible Indexing on LOB Columns</h3>
<div>
<p>The database provides <span class="italic">extensible indexing</span>, a feature which enables you to define new index types as required. This is based on the concept of cooperative indexing where a data cartridge and the database build and maintain indexes for data types such as text and spatial for example, for On-line-Analytical Processing (OLAP).</p>
<p>The cartridge is responsible for defining the index structure, maintaining the index content during load and update operations, and searching the index during query processing. The index structure can be stored in Oracle as heap-organized, or an index-organized table, or externally as an operating system file.</p>
<p>To support this structure, the database provides an <span class="italic">indextype</span>. The purpose of an indextype is to enable efficient search and retrieval functions for complex domains such as text, spatial, image, and OLAP by means of a data cartridge. An indextype is analogous to the sorted or bit-mapped index types that are built-in within the Oracle Server. The difference is that an indextype is implemented by the data cartridge developer, whereas the Oracle kernel implements built-in indexes. Once a new indextype has been implemented by a data cartridge developer, end users of the data cartridge can use it just as they would built-in indextypes.</p>
<p>When the database system handles the physical storage of domain indexes, data cartridges</p>
<ul style="list-style-type: disc;">
<li>
<p>Define the format and content of an index. This enables cartridges to define an index structure that can accommodate a complex data object.</p>
</li>
<li>
<p>Build, delete, and update a domain index. The cartridge handles building and maintaining the index structures. Note that this is a significant departure from the medicine indexing features provided for simple SQL data types. Also, because an index is modeled as a collection of tuples, in-place updating is directly supported.</p>
</li>
<li>
<p>Access and interpret the content of an index. This capability enables the data cartridge to become an integral component of query processing. That is, the content-related clauses for database queries are handled by the data cartridge.</p>
</li>
</ul>
<p>By supporting extensible indexes, the database significantly reduces the effort needed to develop high-performance solutions that access complex data types such as LOBs.</p>
</div>
<a id="ADLOB45307"></a>
<div class="sect4"><a id="GUID-D9B44BF2-1240-4155-92BB-32576598AF93"></a>
<h4 id="ADLOB-GUID-D9B44BF2-1240-4155-92BB-32576598AF93" class="sect4">Extensible Optimizer</h4>
<div>
<p>The extensible optimizer functionality allows authors of user-defined functions and indexes to create statistics collections, selectivity, and cost functions. This information is used by the optimizer in choosing a query plan. The cost-based optimizer is thus extended to use the user-supplied information.</p>
<p>Extensible indexing functionality enables you to define new operators, index types, and domain indexes. For such user-defined operators and domain indexes, the extensible optimizer functionality allows users to control the three main components used by the optimizer to select an execution plan: <span class="italic">statistics, selectivity,</span> and <span class="italic">cost</span>.</p>
<div class="infoboxnotealso" id="GUID-D9B44BF2-1240-4155-92BB-32576598AF93__GUID-636747F8-4C2A-4D91-A268-A96DFE372E04">
<p class="notep1">See Also:</p>
<p><a class="olink ADDCI4256" target="_blank" href="../ADDCI/introduction.htm#ADDCI4256"><span class="italic">Oracle Database Data Cartridge Developer&#39;s Guide</span></a></p>
</div>
</div>
</div>
</div>
<a id="ADLOB45308"></a>
<div class="props_rev_3"><a id="GUID-3936617F-ACBD-4F81-9D69-FCE1ADC3787A"></a>
<h3 id="ADLOB-GUID-3936617F-ACBD-4F81-9D69-FCE1ADC3787A" class="sect3">Oracle Text Indexing Support for XML</h3>
<div>
<p>You can create Oracle Text indexes on <code class="codeph">CLOB</code> columns and perform queries on XML data.</p>
<div class="infoboxnotealso" id="GUID-3936617F-ACBD-4F81-9D69-FCE1ADC3787A__GUID-6364DF32-18F2-469B-8B52-857C3BEFC11A">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink ADXDK" target="_blank" href="../ADXDK/toc.htm"><span class="italic">Oracle XML Developer&#39;s Kit Programmer&#39;s Guide</span></a></p>
</li>
<li>
<p><a class="olink CCREF" target="_blank" href="../CCREF/toc.htm"><span class="italic">Oracle Text Reference</span></a></p>
</li>
<li>
<p><a class="olink CCAPP" target="_blank" href="../CCAPP/toc.htm"><span class="italic">Oracle Text Application Developer&#39;s Guide</span></a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<a id="ADLOB45309"></a>
<div class="props_rev_3"><a id="GUID-F4B2B0C3-6E8E-47A4-A46C-8014DAAD7B42"></a>
<h2 id="ADLOB-GUID-F4B2B0C3-6E8E-47A4-A46C-8014DAAD7B42" class="sect2">LOB Manipulation in Partitioned Tables</h2>
<div>
<p>You can partition tables that contain LOB columns.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="adlob_tables.htm#GUID-A37C90DC-0DC7-4883-A6FF-59FBC7D44D56">About Manipulating LOBs in Partitioned Tables</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-96390DD8-BDC3-4B81-AD24-88F66D97E870">Partitioning a Table Containing LOB Columns</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-86D2A49E-A956-433D-9BF2-C63A01F27047">Creating an Index on a Table Containing Partitioned LOB Columns</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-43137298-9F9C-45D7-B253-05279E547EEC">Moving Partitions Containing LOBs</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-EE4CE357-4385-4CD5-ADFD-765855EC5EF0">Splitting Partitions Containing LOBs</a></p>
</li>
<li>
<p><a href="adlob_tables.htm#GUID-1D318F25-B9D8-4AD9-BFAE-8DA8C9378EE3">Merging Partitions Containing LOBs</a></p>
</li>
</ul>
</div>
<div class="props_rev_3"><a id="GUID-A37C90DC-0DC7-4883-A6FF-59FBC7D44D56"></a>
<h3 id="ADLOB-GUID-A37C90DC-0DC7-4883-A6FF-59FBC7D44D56" class="sect3">About Manipulating LOBs in Partitioned Tables</h3>
<div>
<p>As a result, LOBs can take advantage of all of the benefits of partitioning including the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>LOB segments can be spread between several tablespaces to balance I/O load and to make backup and recovery more manageable.</p>
</li>
<li>
<p>LOBs in a partitioned table become easier to maintain.</p>
</li>
<li>
<p>LOBs can be partitioned into logical groups to speed up operations on LOBs that are accessed as a group.</p>
</li>
</ul>
<p>This section describes some of the ways you can manipulate LOBs in partitioned tables.</p>
</div>
</div>
<a id="ADLOB45310"></a>
<div class="props_rev_3"><a id="GUID-96390DD8-BDC3-4B81-AD24-88F66D97E870"></a>
<h3 id="ADLOB-GUID-96390DD8-BDC3-4B81-AD24-88F66D97E870" class="sect3">Partitioning a Table Containing LOB Columns</h3>
<div>
<div class="section">
<p>LOBs are supported in RANGE partitioned, LIST partitioned, and HASH partitioned tables. Composite heap-organized tables can also have LOBs.</p>
<p>You can partition a table containing LOB columns using the following techniques:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>When the table is created using the <code class="codeph">PARTITION BY ...</code> clause of the <code class="codeph">CREATE TABLE</code> statement.</p>
</li>
<li>
<p>Adding a partition to an existing table using the <code class="codeph">ALTER TABLE ... ADD PARTITION</code> clause.</p>
</li>
<li>
<p>Exchanging partitions with a table that has partitioned LOB columns using the <code class="codeph">ALTER TABLE ... EXCHANGE PARTITION</code> clause. Note that <code class="codeph">EXCHANGE PARTITION</code> can only be used when both tables have the same storage attributes, for example, both tables store LOBs out-of-line.</p>
</li>
</ul>
<p>Creating LOB partitions at the same time you create the table (in the <code class="codeph">CREATE TABLE</code> statement) is recommended. If you create partitions on a LOB column when the table is created, then the column can hold LOBs stored either inline or out-of-line LOBs.</p>
<p>After a table is created, new LOB partitions can only be created on LOB columns that are stored out-of-line. Also, partition maintenance operations, <code class="codeph">SPLIT PARTITION</code> and <code class="codeph">MERGE PARTITIONS</code>, only work on LOB columns that store LOBs out-of-line.</p>
<div class="infoboxnotealso" id="GUID-96390DD8-BDC3-4B81-AD24-88F66D97E870__GUID-26D3482B-4E9A-42DB-88F6-B7938B412873">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="adlob_tables.htm#GUID-FD9C0216-EACF-4F21-B298-11336B4F4E75">Restrictions for LOBs in Partitioned Index-Organized Tables</a> &#34;</span> for additional information on LOB restrictions.</p>
</div>
<p>Note that once a table is created, storage attributes cannot be changed. See <span class="q">&#34;<a href="adlob_tables.htm#GUID-517E1234-EFCD-4D16-B69B-23F72A18A77D">LOB Storage Parameters</a>&#34;</span> for more information about LOB storage attributes.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="ADLOB45311"></a>
<div class="props_rev_3"><a id="GUID-86D2A49E-A956-433D-9BF2-C63A01F27047"></a>
<h3 id="ADLOB-GUID-86D2A49E-A956-433D-9BF2-C63A01F27047" class="sect3">Creating an Index on a Table Containing Partitioned LOB Columns</h3>
<div>
<div class="section">
<p><a id="d28838e5459" class="indexterm-anchor"></a>To improve the performance of queries, you can create indexes on partitioned LOB columns. For example:</p>
<pre dir="ltr">CREATE INDEX <span class="italic">index_name</span> 
   ON <span class="italic">table_name</span> (<span class="italic">LOB_column_1</span>, <span class="italic">LOB_column_2</span>, ...) LOCAL;
</pre>
<p>Note that only domain and function-based indexes are supported on LOB columns. Other types of indexes, such as unique indexes are not supported with LOBs.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="ADLOB45312"></a>
<div class="props_rev_3"><a id="GUID-43137298-9F9C-45D7-B253-05279E547EEC"></a>
<h3 id="ADLOB-GUID-43137298-9F9C-45D7-B253-05279E547EEC" class="sect3">Moving Partitions Containing LOBs</h3>
<div>
<div class="section">
<p><a id="d28838e5546" class="indexterm-anchor"></a>You can move a LOB partition into a different tablespace. This is useful if the tablespace is no longer large enough to hold the partition. To do so, use the <code class="codeph">ALTER TABLE ... MOVE PARTITION</code> clause. For example:</p>
<pre dir="ltr">ALTER TABLE <span class="italic">current_table</span> MOVE PARTITION <span class="italic">partition_name</span> 
   TABLESPACE <span class="italic">destination_table_space</span>
   LOB (<span class="italic">column_name</span>) STORE AS (TABLESPACE <span class="italic">current_tablespace</span>);
</pre></div>
<!-- class="section" --></div>
</div>
<a id="ADLOB45313"></a>
<div class="props_rev_3"><a id="GUID-EE4CE357-4385-4CD5-ADFD-765855EC5EF0"></a>
<h3 id="ADLOB-GUID-EE4CE357-4385-4CD5-ADFD-765855EC5EF0" class="sect3">Splitting Partitions Containing LOBs</h3>
<div>
<div class="section">
<p><a id="d28838e5637" class="indexterm-anchor"></a>You can split a partition containing LOBs into two equally sized partitions using the <code class="codeph">ALTER TABLE ... SPLIT PARTITION</code> clause. Doing so permits you to place one or both new partitions in a new tablespace. For example:</p>
<pre dir="ltr">ALTER TABLE <span class="italic">table_name</span> SPLIT PARTITION <span class="italic">partition_name</span>
   AT (<span class="italic">partition_range_upper_bound</span>)
   INTO (PARTITION <span class="italic">partition_name</span>, 
      PARTITION <span class="italic">new_partition_name</span> TABLESPACE <span class="italic">new_tablespace_name</span>
         LOB (<span class="italic">column_name</span>) STORE AS (TABLESPACE <span class="italic">tablespace_name</span>)
         ... ;
</pre></div>
<!-- class="section" --></div>
</div>
<a id="ADLOB45314"></a>
<div class="props_rev_3"><a id="GUID-1D318F25-B9D8-4AD9-BFAE-8DA8C9378EE3"></a>
<h3 id="ADLOB-GUID-1D318F25-B9D8-4AD9-BFAE-8DA8C9378EE3" class="sect3">Merging Partitions Containing LOBs</h3>
<div>
<div class="section">
<p>You can merge partitions that contain LOB columns using the <code class="codeph">ALTER TABLE ... MERGE PARTITIONS</code> clause.</p>
<p>This technique is useful for reclaiming unused partition space. For example:</p>
<pre dir="ltr">ALTER TABLE <span class="italic">table_name</span> 
   MERGE PARTITIONS <span class="italic">partition_1</span>, <span class="italic">partition_2</span> 
   INTO PARTITION <span class="italic">new_partition</span> TABLESPACE <span class="italic">new_tablespace_name</span>
      LOB (<span class="italic">column_name</span>) store as (TABLESPACE <span class="italic">tablespace_name</span>)
     ... ;
</pre></div>
<!-- class="section" --></div>
</div>
</div>
<a id="ADLOB45316"></a><a id="ADLOB45315"></a>
<div class="props_rev_3"><a id="GUID-5E0E0772-C5CE-458A-AD07-E8DB32C24231"></a>
<h2 id="ADLOB-GUID-5E0E0772-C5CE-458A-AD07-E8DB32C24231" class="sect2">LOBs in Index Organized Tables</h2>
<div>
<p>Index Organized Tables (IOTs) support internal and external LOB columns. For the most part, SQL DDL, DML, and piece wise operations on LOBs in IOTs produce the same results as those for normal tables. The only exception is the default semantics of LOBs during creation. The main differences are:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="italic"><span class="bold">Tablespace Mapping</span></span>: By default, or unless specified otherwise, the LOB data and index segments are created in the tablespace in which the primary key index segments of the index organized table are created.</p>
</li>
<li>
<p><span class="italic"><span class="bold">Inline as Compared to Out-of-Line Storage</span></span>: By default, all LOBs in an index organized table created without an overflow segment are stored out of line. In other words, if an index organized table is created without an overflow segment, then the LOBs in this table have their default storage attributes as <code class="codeph">DISABLE</code> <code class="codeph">STORAGE</code> <code class="codeph">IN</code> <code class="codeph">ROW</code>. If you forcibly try to specify an <code class="codeph">ENABLE</code> <code class="codeph">STORAGE</code> <code class="codeph">IN</code> <code class="codeph">ROW</code> clause for such LOBs, then SQL raises an error.</p>
<p>On the other hand, if an overflow segment has been specified, then LOBs in index organized tables exactly mimic their semantics in conventional tables (see <span class="q">&#34;<a href="adlob_tables.htm#GUID-D3BD47D3-DD6A-4DC9-9BAF-5DBB60918087">Defining Tablespace and Storage Characteristics for Persistent LOBs</a>&#34;</span>).</p>
</li>
</ul>
<div class="section">
<p class="subhead2">Example of Index Organized Table (IOT) with LOB Columns</p>
</div>
<!-- class="section" -->
<div class="section">
<p>Consider the following example:</p>
<pre dir="ltr">CREATE TABLE iotlob_tab (c1 INTEGER PRIMARY KEY, c2 BLOB, c3 CLOB, c4 
VARCHAR2(20)) 
  ORGANIZATION INDEX 
    TABLESPACE iot_ts 
    PCTFREE 10 PCTUSED 10 INITRANS 1 MAXTRANS 1 STORAGE (INITIAL 4K) 
    PCTTHRESHOLD 50 INCLUDING c2 
  OVERFLOW 
    TABLESPACE ioto_ts 
    PCTFREE 10 PCTUSED 10 INITRANS 1 MAXTRANS 1 STORAGE (INITIAL 8K) LOB (c2) 
    STORE AS lobseg (TABLESPACE lob_ts DISABLE STORAGE IN ROW 
                     CHUNK 16384 PCTVERSION 10 CACHE STORAGE (INITIAL 2M) 
                     INDEX lobidx_c1 (TABLESPACE lobidx_ts STORAGE (INITIAL 4K)));
</pre>
<p>Executing these statements results in the creation of an index organized table <code class="codeph">iotlob_tab</code> with the following elements:</p>
<ul style="list-style-type: disc;">
<li>
<p>A primary key index segment in the tablespace <code class="codeph">iot_ts</code><span class="italic">,</span></p>
</li>
<li>
<p>An overflow data segment in tablespace <code class="codeph">ioto_ts</code></p>
</li>
<li>
<p>Columns starting from column <code class="codeph">C3</code> being explicitly stored in the overflow data segment</p>
</li>
<li>
<p><code class="codeph">BLOB</code> (column <code class="codeph">C2</code>) data segments in the tablespace <code class="codeph">lob_ts</code></p>
</li>
<li>
<p><code class="codeph">BLOB</code> (column <code class="codeph">C2</code>) index segments in the tablespace <code class="codeph">lobidx_ts</code></p>
</li>
<li>
<p><code class="codeph">CLOB</code> (column <code class="codeph">C3</code>) data segments in the tablespace <code class="codeph">iot_ts</code></p>
</li>
<li>
<p><code class="codeph">CLOB</code> (column <code class="codeph">C3</code>) index segments in the tablespace <code class="codeph">iot_ts</code></p>
</li>
<li>
<p><code class="codeph">CLOB</code> (column <code class="codeph">C3</code>) stored in line by virtue of the IOT having an overflow segment</p>
</li>
<li>
<p><code class="codeph">BLOB</code> (column <code class="codeph">C2</code>) explicitly forced to be stored out of line</p>
<div class="infobox-note" id="GUID-5E0E0772-C5CE-458A-AD07-E8DB32C24231__GUID-9C49B6C6-040D-4B1C-AEF9-83D28943E2AA">
<p class="notep1">Note:</p>
<p>If no overflow had been specified, then both C2 and C3 would have been stored out of line by default.</p>
</div>
</li>
</ul>
<p>Other LOB features, such as <code class="codeph">BFILE</code>s and varying character width LOBs, are also supported in index organized tables, and their usage is the same as for conventional tables.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="ADLOB510"></a>
<div class="props_rev_3"><a id="GUID-FD9C0216-EACF-4F21-B298-11336B4F4E75"></a>
<h2 id="ADLOB-GUID-FD9C0216-EACF-4F21-B298-11336B4F4E75" class="sect2">Restrictions for LOBs in Partitioned Index-Organized Tables</h2>
<div>
<p>LOB columns are supported in range-, list-, and hash-partitioned index-organized tables with the following restrictions:</p>
<ul style="list-style-type: disc;">
<li>
<p>Composite partitioned index-organized tables are not supported.</p>
</li>
<li>
<p>Relational and object partitioned index-organized tables (partitioned by range, hash, or list) can hold LOBs stored as follows; however, partition maintenance operations, such as <code class="codeph">MOVE</code>, <code class="codeph">SPLIT</code>, and <code class="codeph">MERGE</code> are not supported with:</p>
<ul style="list-style-type: disc;">
<li>
<p>VARRAY data types stored as LOB data types</p>
</li>
<li>
<p>Abstract data types with LOB attributes</p>
</li>
<li>
<p>Nested tables with LOB types</p>
<div class="infoboxnotealso" id="GUID-FD9C0216-EACF-4F21-B298-11336B4F4E75__GUID-FF0F22FD-A4B5-4C81-9FD3-CFA6BF1DD951">
<p class="notep1">See Also:</p>
<p>Additional restrictions for LOB columns in general are given in <span class="q">&#34;<a href="adlob_working.htm#GUID-BA662EA5-4955-4582-B12E-3312FE4B1D6A" title="This section provides details on LOB rules and restrictions.">LOB Rules and Restrictions</a>&#34;</span>.</p>
</div>
</li>
</ul>
</li>
</ul>
</div>
</div>
<a id="ADLOB45317"></a>
<div class="props_rev_3"><a id="GUID-FFA3FAB5-694E-49C5-A8AF-B21B441BEFCC"></a>
<h2 id="ADLOB-GUID-FFA3FAB5-694E-49C5-A8AF-B21B441BEFCC" class="sect2">Updating LOBs in Nested Tables</h2>
<div>
<div class="section">
<p>To update LOBs in a nested table, you must lock the row containing the LOB explicitly. To do so, you must specify the FOR UPDATE clause in the subquery prior to updating the LOB value.</p>
<p>Note that locking the row of a parent table does not lock the row of a nested table containing LOB columns.</p>
<div class="infobox-note" id="GUID-FFA3FAB5-694E-49C5-A8AF-B21B441BEFCC__GUID-5FD08603-F948-4E5A-81F2-E7C2E2800E8F">
<p class="notep1">Note:</p>
<p>Nested tables containing LOB columns are the only data structures supported for creating collections of LOBs. You cannot create a <code class="codeph">VARRAY</code> of any LOB data type.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2782">
<tr>
<td class="cellalignment2794">
<table class="cellalignment2787">
<tr>
<td class="cellalignment2786"><a href="part_des.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2786"><a href="adlob_design.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2015, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2796">
<table class="cellalignment2785">
<tr>
<td class="cellalignment2786"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2786"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2786"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2786"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2786"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2786"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>