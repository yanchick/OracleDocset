<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-47010"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Understanding%20Administrator%20Security%20Best%20Practices"></a><title>Understanding Administrator Security Best Practices</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 737"/>
<meta name="dcterms.created" content="2014-07-11T14:38:38Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Application Express Application Builder User&#39;s Guide"/>
<meta name="dcterms.identifier" content="E17961-11"/>
<meta name="dcterms.isVersionOf" content="HTMDB"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="sec.htm" title="Previous" type="text/html"/>
<link rel="Next" href="sec_dev.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E17961-11.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">127/182</span> <!-- End Header --><a id="CCHECGBI"></a>
<div id="HTMDB25965" class="sect1"><!-- infolevel="all" infotype="General" -->
<h1 class="sect1"><span class="secnum">15.1</span> Understanding Administrator Security B<a id="sthref2489"></a>est Practices</h1>
<p>This section describes security best practices for Oracle Application Express administrators.</p>
<p class="subhead2"><a id="HTMDB28549"></a>Topics:</p>
<ul>
<li>
<p><a href="#BCGEIJJE">Security Considerations When Using the Embedded PL/SQL Gateway</a></p>
</li>
<li>
<p><a href="#BCGGCDGC">About Configuring Oracle HTTP Server with mod_plsql for Oracle Application Express</a></p>
</li>
<li>
<p><a href="#BCGBCJDC">Utilizing Secure Sockets Layer (SSL)</a></p>
</li>
<li>
<p><a href="#BCGCEIAI">Integrating with Oracle BI Publisher</a></p>
</li>
<li>
<p><a href="#BCGCCACG">About Setting Password Complexity Rules</a></p>
</li>
<li>
<p><a href="#BCGEFIIB">Advantages of the Oracle Application Express Runtime Environment</a></p>
</li>
<li>
<p><a href="#BCGIABAE">Understanding Session Timeout</a></p>
</li>
<li>
<p><a href="#BCGIIJBI">Enabling Network Services in Oracle Database 12<span class="italic">c</span></a></p>
</li>
</ul>
<a id="BCGEIJJE"></a>
<div id="HTMDB25966" class="sect2">
<h2 class="sect2"><span class="secnum">15.1.1</span> Security Considerations When Using the E<a id="sthref2490"></a><a id="sthref2491"></a>mbedded PL/SQL Gateway</h2>
<p>The embedded PL/SQL gateway runs in the database as part of the Oracle XML DB HTTP listener. The Oracle XML DB HTTP listener and embedded PL/SQL gateway provides the equivalent core features of Oracle HTTP Server and <code>mod_plsql</code>. Because the HTTP Listener runs in the same database where Oracle Application Express is installed, it is not possible to separate the HTTP listener from the database. For this reason, Oracle does not recommend the embedded PL/SQL gateway for applications that run on the Internet. Additionally, the embedded PL/SQL gateway does not provide the same flexibility of configuration and detailed logging as Oracle HTTP Server with <code>mod_plsql</code>.</p>
</div>
<!-- class="sect2" -->
<a id="BCGGCDGC"></a>
<div id="HTMDB25967" class="sect2">
<h2 class="sect2"><span class="secnum">15.1.2</span> About Configuring Oracle HTTP S<a id="sthref2492"></a><a id="sthref2493"></a>erver with mod_plsql for Oracle Application Express</h2>
<p>Oracle HTTP Server uses the <code>mod_plsql</code> plug-in to communicate with the Oracle Application Express engine within the Oracle database. <code>mod_plsql</code> functions act as a communication broker between the web server and the Oracle Application Express engine in the Oracle database.</p>
<p>Each <code>mod_plsql</code> request is associated with a set of configuration values used to access the database called a Database Access Descriptor (DAD). <code>mod_plsql</code> provides a DAD parameter called <code>PlsqlRequestValidationFunction</code> which enables you to allow or disallow further processing of a requested procedure. You can utilize this parameter to implement tighter security for your PL/SQL application by blocking package and procedure calls which should not be allowed to run from the DAD. Oracle recommends a DAD configuration for Oracle Application Express which utilizes the <code>PlsqlRequestValidationFunction</code> directive with a value of <code>wwv_flow_epg_include_modules.authorize</code>.</p>
<p>The purpose of the <code>PlsqlRequestValidationFunction</code> parameter is to control which procedures can be invoked through <code>mod_plsql</code>. By default, the only procedures permitted are the public entry points of Oracle Application Express. This can be extended using the validation functions shipped with Oracle Application Express. To learn more, see &#34;Restricting Access to Oracle Application Express by Database Access Descriptor (DAD)&#34; in <a class="olink AEADM209" href="../AEADM/adm_mg_service_set.htm#AEADM209"><span class="italic">Oracle Application Express Administration Guide</span></a>.</p>
</div>
<!-- class="sect2" -->
<a id="BCGBCJDC"></a>
<div id="HTMDB25968" class="sect2">
<h2 class="sect2"><span class="secnum">15.1.3</span> Utilizing Secure <a id="sthref2494"></a><a id="sthref2495"></a>Sockets Layer (SSL)</h2>
<p>Secure Sockets Layer (SSL) is a protocol for managing the security of data transmitted on the Internet. For web applications, SSL is implemented by using the HTTPS protocol. Oracle recommends that you run Oracle Application Express applications using SSL (HTTPS protocol) to prevent any sensitive data from being sent over an unencrypted (cleartext) communication channel.</p>
<p>You can configure both your Oracle Application Express instance and all related applications to require HTTPS by setting the Require HTTPS attribute to <span class="bold">Yes</span> on the Security Settings page in Oracle Application Express Administration Services.</p>
<p>Setting the Require HTTPS attribute to <span class="bold">Yes</span> and logging out prevents anyone from logging in to Oracle Application Express Administration Services and from logging into an Oracle Application Express workspace as a developer or administrator unless the protocol in use is HTTPS.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
&#34;Requiring HTTPS&#34; in <a class="olink AEADM297" href="../AEADM/adm_mg_service_set.htm#AEADM297"><span class="italic">Oracle Application Express Administration Guide</span></a></div>
</div>
<!-- class="sect2" -->
<a id="BCGCEIAI"></a>
<div id="HTMDB25969" class="sect2">
<h2 class="sect2"><span class="secnum">15.1.4</span> Integrating with Or<a id="sthref2496"></a><a id="sthref2497"></a>acle BI Publisher</h2>
<p>Oracle recommends that you employ Secure Sockets Layer (SSL) when integrating Oracle Application Express with Oracle BI Publisher. Once SSL (HTTPS protocol) is configured for your Oracle BI Publisher server, you must create a wallet and specify the HTTPS protocol for the Report Server in the internal administration Environment Settings.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
&#34;<a class="olink AEADM214" href="../AEADM/adm_mg_service_set.htm#AEADM214">Configuring Wallet Information</a>&#34; and &#34;<a class="olink AEADM219" href="../AEADM/adm_mg_service_set.htm#AEADM219">Configuring Report Printing</a>&#34; in <span class="italic">Oracle Application Express Administration Guide</span></div>
</div>
<!-- class="sect2" -->
<a id="BCGCCACG"></a>
<div id="HTMDB25970" class="sect2">
<h2 class="sect2"><span class="secnum">15.1.5</span> About Setting Pa<a id="sthref2498"></a><a id="sthref2499"></a>ssword Complexity Rules</h2>
<p>Workspace administrators and developers can create user accounts for the purpose of logging in to the Oracle Application Express development environment and for end-user authentication to applications developed within their workspaces. The Oracle Application Express administrator can create password complexity rules, or a policy, for the passwords of these accounts. These rules apply to all accounts in the installation, across all workspaces.</p>
<p>The following are example password complexity policies:</p>
<p>All passwords must:</p>
<ul>
<li>
<p>Contain at least one upper-case character</p>
</li>
<li>
<p>Contain at least one numeric digit</p>
</li>
<li>
<p>Must be at least six characters long</p>
</li>
</ul>
<p>Note that many other variations are possible. Oracle recommends administrators establish a password complexity policy for each Oracle Application Express instance. To learn more, see &#34;<a class="olink AEADM203" href="../AEADM/adm_mg_service_set.htm#AEADM203">Enabling Login Controls for All Workspaces</a>,&#34; &#34;<a class="olink AEADM204" href="../AEADM/adm_mg_service_set.htm#AEADM204">About Strong Password Policies</a>,&#34; and &#34;<a class="olink AEADM131" href="../AEADM/aadm_prefs.htm#AEADM131">Enabling Account Login Controls for a Workspace</a>&#34; in <span class="italic">Oracle Application Express Administration Guide</span>.</p>
<div id="HTMDB28550" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref2500"></a>
<h3 class="sect3"><span class="secnum">15.1.5.1</span> Restricting Password Reuse</h3>
<p>Site administrators can restrict password reuse for all administrator, developer, and end-user accounts based on a history of passwords previously used for the accounts.</p>
<p>To restrict password reuse:</p>
<ol>
<li>
<p>Start SQL*Plus and connect to the database where Oracle Application Express is installed having the <code>apex_administrator_role</code> role or as <code>SYS</code> specifying the <code>SYSDBA</code> role. For example:</p>
<ul>
<li>
<p>On Windows:</p>
<pre><span class="italic">SYSTEM_DRIVE:\</span> sqlplus /nolog
SQL&gt; CONNECT SYS as SYSDBA
Enter password: <span class="italic">SYS_password</span>
</pre></li>
<li>
<p>On UNIX and Linux:</p>
<pre>$ sqlplus /nolog
SQL&gt; CONNECT SYS as SYSDBA
Enter password: <span class="italic">SYS_password</span>
</pre></li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">Tip:</p>
The <code>APEX_ADMINISTRATOR_ROLE</code> must be granted directly to a user and not through another database role.</div>
</li>
<li>
<p>Execute the following statement:</p>
<pre>ALTER SESSION SET CURRENT_SCHEMA = APEX_040200;

</pre></li>
<li>
<p>Execute the following statement:</p>
<pre>BEGIN
APEX_INSTANCE_ADMIN.SET_PARAMETER(&#39;PASSWORD_HISTORY_DAYS&#39;,365);
COMMIT;
END;
/
</pre>
<p>This restricts new or updated passwords to those that have not been used for the account for the previous 365 days. Recording of previously used passwords (actually, hashed representations of passwords) begins upon installation of Oracle Application Express.</p>
</li>
<li>
<p>To disable this feature, run the block above, providing 0 for the parameter value. For example:</p>
<pre>BEGIN
APEX_INSTANCE_ADMIN.SET_PARAMETER(&#39;PASSWORD_HISTORY_DAYS&#39;,0);
COMMIT;
END;
/
</pre></li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">Tip:</p>
Developers can also use the <code>APEX_UTIL.STRONG_PASSWORD_CHECK</code> procedure and the <code>APEX_UTIL.STRONG_PASSWORD_VALIDATION</code> function described in <a class="olink AEAPI" href="../AEAPI/toc.htm"><span class="italic">Oracle Application Express API Reference</span></a>.</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="BCGEFIIB"></a>
<div id="HTMDB25971" class="sect2">
<h2 class="sect2"><span class="secnum">15.1.6</span> Advantages of <a id="sthref2501"></a>the Oracle Application Express Run<a id="sthref2502"></a>time Environment</h2>
<p>An Oracle Application Express runtime environment enables you to run production applications, but it does not provide a web interface for administration or direct development of these applications</p>
<p>Oracle recommends that you run any sensitive production Oracle Application Express applications with a runtime installation of Oracle Application Express. A runtime installation does not expose the web-based application development environment, thus preventing the use of Application Builder, SQL Workshop, and related utilities on a production installation. Additionally, a runtime environment only includes the Oracle Application Express database objects and privileges necessary to run applications, making it a more hardened environment.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
&#34;Managing a Runtime Environment&#34; in <a class="olink AEADM195" href="../AEADM/adm_mg_service_set.htm#AEADM195"><span class="italic">Oracle Application Express Administration Guide</span></a></div>
</div>
<!-- class="sect2" -->
<a id="BCGIABAE"></a>
<div id="HTMDB25972" class="sect2">
<h2 class="sect2"><span class="secnum">15.1.7</span> Understanding Se<a id="sthref2503"></a><a id="sthref2504"></a>ssion Timeout</h2>
<p>By configuring Session Timeout attributes, you can reduce your application&#39;s exposure. Users often leave their computers unattended for extended periods and do not close applications before departing. Therefore, an unauthorized person can easily assume the user&#39;s identity within the application. By setting the session and idle timeout, users are automatically logged out of their application after the specified timeout.</p>
<p>Session Timeout attributes include:</p>
<ul>
<li>
<p>Maximum Session Length in Seconds</p>
</li>
<li>
<p>Session Timeout URL</p>
</li>
<li>
<p>Maximum Session Idle Time in Seconds</p>
</li>
<li>
<p>Idle Timeout URL</p>
</li>
</ul>
<p>To learn more about configuring these attributes at an application-level, see <a href="bldr_attr.htm#CHDBBHCA">&#34;Session Timeout&#34;</a>. To learn more about configuring these attributes for an entire Oracle Application Express instance, see &#34;Configuring Session Timeout&#34; in <a class="olink AEADM293" href="../AEADM/adm_mg_service_set.htm#AEADM293"><span class="italic">Oracle Application Express Administration Guide</span></a>.</p>
</div>
<!-- class="sect2" -->
<a id="BCGIIJBI"></a>
<div id="HTMDB12006" class="sect2">
<h2 class="sect2"><span class="secnum">15.1.8</span> Enabling Network S<a id="sthref2505"></a><a id="sthref2506"></a><a id="sthref2507"></a><a id="sthref2508"></a><a id="sthref2509"></a><a id="sthref2510"></a>ervices in Oracle Database 12<span class="italic">c</span></h2>
<p>By default, the ability to interact with network services is disabled in Oracle Database 12<span class="italic">c</span>. Therefore, if you are running Oracle Application Express with Oracle Database 12<span class="italic">c</span>, you must use the new <code>DBMS_NETWORK_ACL_ADMIN</code> package to grant connect privileges to any host for the <code>APEX_040200</code> database user. Failing to grant these privileges results in issues with:</p>
<ul>
<li>
<p>Sending outbound mail in Oracle Application Express.</p>
<p>Users can call methods from the <code>APEX_MAIL</code> package, but issues arise when sending outbound email.</p>
</li>
<li>
<p>Using Web services in Oracle Application Express.</p>
</li>
<li>
<p>PDF/report printing.</p>
</li>
</ul>
<p class="subhead2"><a id="HTMDB28551"></a>Topics:</p>
<ul>
<li>
<p><a href="#BCGJBJBA">Granting Connect Privileges</a></p>
</li>
<li>
<p><a href="#BCGHBADA">Troubleshooting an Invalid ACL Error</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">Tip:</p>
To run the examples described in this section, the compatible initialization parameter of the database must be set to at least 11.1.0.0.0. By default Oracle Database 12<span class="italic">c</span> will already has the parameter set properly, but a database upgraded to Oracle Database 12<span class="italic">c</span> from a prior version may not. See &#34;Creating and Configuring an Oracle Database&#34; in <a class="olink ADMIN002" href="../ADMIN/create.htm#ADMIN002"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about changing database initialization parameters.</div>
<a id="BCGJBJBA"></a>
<div id="HTMDB25751" class="sect3">
<h3 class="sect3"><span class="secnum">15.1.8.1</span> Granting Connect Privileges</h3>
<p>The following example demonstrates how to grant connect privileges to any host for the <code>APEX_040200</code> database user. This example assumes you connected to the database where Oracle Application Express is installed as <code>SYS</code> specifying the <code>SYSDBA</code> role.</p>
<pre>DECLARE
  ACL_PATH  VARCHAR2(4000);
  ACL_ID    RAW(16);
BEGIN
  -- Look for the ACL currently assigned to &#39;*&#39; and give APEX_040200
  -- the &#34;connect&#34; privilege if APEX_040200 does not have the privilege yet.
 
  SELECT ACL INTO ACL_PATH FROM DBA_NETWORK_ACLS
   WHERE HOST = &#39;*&#39; AND LOWER_PORT IS NULL AND UPPER_PORT IS NULL;
 
  -- Before checking the privilege, ensure that the ACL is valid
  -- (for example, does not contain stale references to dropped users).
  -- If it does, the following exception will be raised:
  --
  -- ORA-44416: Invalid ACL: Unresolved principal &#39;APEX_040200&#39;
  -- ORA-06512: at &#34;XDB.DBMS_XDBZ&#34;, line ...
  --
  SELECT SYS_OP_R2O(extractValue(P.RES, &#39;/Resource/XMLRef&#39;)) INTO ACL_ID
    FROM XDB.XDB$ACL A, PATH_VIEW P
   WHERE extractValue(P.RES, &#39;/Resource/XMLRef&#39;) = REF(A) AND
         EQUALS_PATH(P.RES, ACL_PATH) = 1;
 
  DBMS_XDBZ.ValidateACL(ACL_ID);
   IF DBMS_NETWORK_ACL_ADMIN.CHECK_PRIVILEGE(ACL_PATH, &#39;APEX_040200&#39;, 
     &#39;connect&#39;) IS NULL THEN 
      DBMS_NETWORK_ACL_ADMIN.ADD_PRIVILEGE(ACL_PATH, 
     &#39;APEX_040200&#39;, TRUE, &#39;connect&#39;); 
  END IF;
 
EXCEPTION
  -- When no ACL has been assigned to &#39;*&#39;.
  WHEN NO_DATA_FOUND THEN
  DBMS_NETWORK_ACL_ADMIN.CREATE_ACL(&#39;power_users.xml&#39;,
    &#39;ACL that lets power users to connect to everywhere&#39;,
    &#39;APEX_040200&#39;, TRUE, &#39;connect&#39;);
  DBMS_NETWORK_ACL_ADMIN.ASSIGN_ACL(&#39;power_users.xml&#39;,&#39;*&#39;);
END;
/
COMMIT;
</pre>
<p>The following example demonstrates how to provide less privileged access to local network resources. This example would enable indexing the Oracle Application Express Online Help and could possibly enable email and PDF printing if those servers were also on the local host.</p>
<pre>DECLARE
  ACL_PATH  VARCHAR2(4000);
  ACL_ID    RAW(16);
BEGIN
  -- Look for the ACL currently assigned to &#39;localhost&#39; and give APEX_040200
  -- the &#34;connect&#34; privilege if APEX_040200 does not have the privilege yet.
  SELECT ACL INTO ACL_PATH FROM DBA_NETWORK_ACLS
   WHERE HOST = &#39;localhost&#39; AND LOWER_PORT IS NULL AND UPPER_PORT IS NULL;
 
  -- Before checking the privilege, ensure that the ACL is valid
  -- (for example, does not contain stale references to dropped users).
  -- If it does, the following exception will be raised:
  --
  -- ORA-44416: Invalid ACL: Unresolved principal &#39;APEX_040200&#39;
  -- ORA-06512: at &#34;XDB.DBMS_XDBZ&#34;, line ...
  --
 
  SELECT SYS_OP_R2O(extractValue(P.RES, &#39;/Resource/XMLRef&#39;)) INTO ACL_ID
    FROM XDB.XDB$ACL A, PATH_VIEW P
   WHERE extractValue(P.RES, &#39;/Resource/XMLRef&#39;) = REF(A) AND
         EQUALS_PATH(P.RES, ACL_PATH) = 1;
 
  DBMS_XDBZ.ValidateACL(ACL_ID);
   IF DBMS_NETWORK_ACL_ADMIN.CHECK_PRIVILEGE(ACL_PATH, &#39;APEX_040200&#39;, 
     &#39;connect&#39;) IS NULL THEN 
      DBMS_NETWORK_ACL_ADMIN.ADD_PRIVILEGE(ACL_PATH, 
     &#39;APEX_040200&#39;, TRUE, &#39;connect&#39;); 
  END IF;
 
EXCEPTION
  -- When no ACL has been assigned to &#39;localhost&#39;.
  WHEN NO_DATA_FOUND THEN
  DBMS_NETWORK_ACL_ADMIN.CREATE_ACL(&#39;local-access-users.xml&#39;,
    &#39;ACL that lets power users to connect to everywhere&#39;,
    &#39;APEX_040200&#39;, TRUE, &#39;connect&#39;);
  DBMS_NETWORK_ACL_ADMIN.ASSIGN_ACL(&#39;local-access-users.xml&#39;,&#39;localhost&#39;);
END;
/
COMMIT;
</pre></div>
<!-- class="sect3" -->
<a id="BCGHBADA"></a>
<div id="HTMDB25753" class="sect3">
<h3 class="sect3"><span class="secnum">15.1.8.2</span> Troubleshooting an Invalid ACL Error</h3>
<p>If you receive an <code>ORA-44416: Invalid ACL</code> error after running the previous script, use the following query to identify the invalid ACL:</p>
<pre>REM Show the dangling references to dropped users in the ACL that is assigned
REM to &#39;*&#39;.

SELECT ACL, PRINCIPAL
  FROM DBA_NETWORK_ACLS NACL, XDS_ACE ACE
 WHERE HOST = &#39;*&#39; AND LOWER_PORT IS NULL AND UPPER_PORT IS NULL AND
       NACL.ACLID = ACE.ACLID AND
       NOT EXISTS (SELECT NULL FROM ALL_USERS WHERE USERNAME = PRINCIPAL);
</pre>
<p>Next, run the following code to fix the ACL:</p>
<pre>DECLARE
  ACL_ID   RAW(16);
  CNT      NUMBER;
BEGIN
  -- Look for the object ID of the ACL currently assigned to &#39;*&#39;
  SELECT ACLID INTO ACL_ID FROM DBA_NETWORK_ACLS
   WHERE HOST = &#39;*&#39; AND LOWER_PORT IS NULL AND UPPER_PORT IS NULL;

  -- If just some users referenced in the ACL are invalid, remove just those
  -- users in the ACL. Otherwise, drop the ACL completely.
  SELECT COUNT(PRINCIPAL) INTO CNT FROM XDS_ACE
   WHERE ACLID = ACL_ID AND
         EXISTS (SELECT NULL FROM ALL_USERS WHERE USERNAME = PRINCIPAL);

  IF (CNT &gt; 0) THEN

    FOR R IN (SELECT PRINCIPAL FROM XDS_ACE
               WHERE ACLID = ACL_ID AND
                     NOT EXISTS (SELECT NULL FROM ALL_USERS
                                  WHERE USERNAME = PRINCIPAL)) LOOP
      UPDATE XDB.XDB$ACL
         SET OBJECT_VALUE =
               DELETEXML(OBJECT_VALUE,
                         &#39;/ACL/ACE[PRINCIPAL=&#34;&#39;||R.PRINCIPAL||&#39;&#34;]&#39;)
       WHERE OBJECT_ID = ACL_ID;
    END LOOP;

  ELSE
    DELETE FROM XDB.XDB$ACL WHERE OBJECT_ID = ACL_ID;
  END IF;

END;
/

REM commit the changes.

COMMIT;
</pre>
<p>Once the ACL has been fixed, you must run the first script in this section to apply the ACL to the <code>APEX_040200</code> user. See <a href="#BCGJBJBA">&#34;Granting Connect Privileges&#34;</a>.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment4579">
<tr>
<td class="cellalignment4588">
<table class="cellalignment4584">
<tr>
<td class="cellalignment4583"><a href="sec.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment4583"><a href="sec_dev.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment4590">
<table class="cellalignment4582">
<tr>
<td class="cellalignment4583"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment4583"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment4583"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment4583"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment4583"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment4583"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>