<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-619"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Using%20the%20Oracle%20Suggested%20Backup%20Strategy"></a><title>Using the Oracle Suggested Backup Strategy</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="dcterms.created" content="2017-01-17T07:25:11Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database 2 Day DBA"/>
<meta name="dcterms.identifier" content="E51671-10"/>
<meta name="dcterms.isVersionOf" content="ADMQS"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2004, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="GUID-E6AB87FC-DE6E-433C-AB61-F2055B6CC547.htm" title="Previous" type="text/html"/>
<link rel="Next" href="GUID-FBF51D7D-6BF2-42E0-A822-CC565A4B7549.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E51671-10.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-D77B0526-13F6-4570-9C74-6436B76DEA43"></a> <span id="PAGE" style="display:none;">254/340</span> <!-- End Header -->
<a id="ADMQS09322"></a>
<h1 id="ADMQS-GUID-D77B0526-13F6-4570-9C74-6436B76DEA43" class="sect1"><span class="enumeration_section">9.4.2.2</span> Using the Oracle Suggested Backup Strategy</h1>
<div>
<div class="section">
<p>The Oracle suggested backup strategy is a scheduled disk backup strategy that protects your data and provides efficient recoverability to any point in the user-specified recovery window (time period). It leverages the incrementally updated backup features to provide faster backups than whole database backups, and faster recoverability than is possible by applying multiple incremental backups to the last full backup.</p>
<p>Complete the following tasks, detailed in this section, to schedule a daily backup that implements the Oracle suggested backup strategy:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><a href="GUID-D77B0526-13F6-4570-9C74-6436B76DEA43.htm#GUID-15DFA81C-41A0-469E-AF85-43C434C6B1D1">Task 1 - Preparing to Use the Oracle Suggested Backup Strategy</a></p>
</li>
<li>
<p><a href="GUID-D77B0526-13F6-4570-9C74-6436B76DEA43.htm#GUID-7EF664B2-FD4E-439B-AD50-EAB5C1762C7D">Task 2 - Creating the Backup Script&mdash;UNIX and Linux</a></p>
</li>
<li>
<p><a href="GUID-D77B0526-13F6-4570-9C74-6436B76DEA43.htm#GUID-5C45D54D-B459-4449-B59C-D0213C024390">Task 3 - Testing the Backup Script</a></p>
</li>
<li>
<p><a href="GUID-D77B0526-13F6-4570-9C74-6436B76DEA43.htm#GUID-D3CFC309-9F8B-4C48-B7EB-97EA66FE8315">Task 4 - Scheduling the Daily Backup&mdash;UNIX and Linux</a></p>
</li>
</ul>
<p>This section also contains the following topic:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="GUID-D77B0526-13F6-4570-9C74-6436B76DEA43.htm#GUID-6C74BAA8-9EE5-4446-AF92-F098BD19170A">About the Oracle Suggested Backup Strategy</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-D77B0526-13F6-4570-9C74-6436B76DEA43__GUID-0C9180C0-7411-40E5-86DF-870A6D2CE271">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="GUID-939FF149-01ED-4C18-B223-026F4AF18137.htm#GUID-939FF149-01ED-4C18-B223-026F4AF18137">Incrementally Updated Backups: Rolling Forward Image Copies of Data Files</a>&#34;</span></p>
</div>
</div>
<!-- class="section" --></div>
<a id="ADMQS12224"></a>
<div class="props_rev_3"><a id="GUID-6C74BAA8-9EE5-4446-AF92-F098BD19170A"></a>
<h2 id="ADMQS-GUID-6C74BAA8-9EE5-4446-AF92-F098BD19170A" class="sect2"><span class="enumeration_section">9.4.2.2.1</span> About the Oracle Suggested Backup Strategy</h2>
<div>
<p>The Oracle suggested backup strategy is based on incrementally updated backups. This strategy starts with an image copy of each data file and then rolls forward the image copies each day by applying an incremental level 1 backup.</p>
<p><a id="d45899e86" class="indexterm-anchor"></a>For each data file, the strategy calls for backups as follows:</p>
<ul style="list-style-type: disc;">
<li>
<p>At the beginning of day 1 of the strategy (the time the first scheduled job actually runs), Oracle Recovery Manager (RMAN) creates an incremental level 0 image copy. It contains the data file contents at the beginning of day 1.</p>
<p>If a recovery is required, then the archived redo log files from day 1 can be used to recover to any point during day 1.</p>
</li>
<li>
<p>At the beginning of day 2, RMAN creates a differential incremental level 1 backup that contains the blocks changed during day 1.</p>
<p>If a recovery is required, then RMAN can apply this incremental level 1 to roll forward the level 0 backup to the beginning of day 2. RMAN can use archived redo log files to recover to any point during day 2.</p>
</li>
<li>
<p>At the beginning of each day <span class="italic">n</span> for day 3 and onward, RMAN applies the level 1 backup from the beginning of day <span class="italic">n</span>-1 to the level 0 backup. This action brings the data file copy to its state at the beginning of day <span class="italic">n</span>-1. Then, RMAN creates a new level 1 backup that contains the blocks changed during day <span class="italic">n</span>-1.</p>
<p>If a recovery is required, then RMAN can apply this incremental level 1 backup to the data file rolled forward on day <span class="italic">n</span>-1 to the beginning of day <span class="italic">n</span>. RMAN can use archived redo log files to recover the database to any point during day <span class="italic">n</span>.</p>
</li>
</ul>
<p>In this Oracle suggested backup strategy, the data file image copies and the level 1 incremental backups share the same tag. You can safely implement other backup strategies without interfering with the Oracle suggested backup strategy.</p>
<p>Oracle suggested backup strategies also use tape backups in addition to disk backups, but these are beyond the scope of this section.</p>
</div>
</div>
<a id="ADMQS12439"></a>
<div class="props_rev_3"><a id="GUID-15DFA81C-41A0-469E-AF85-43C434C6B1D1"></a>
<h2 id="ADMQS-GUID-15DFA81C-41A0-469E-AF85-43C434C6B1D1" class="sect2"><span class="enumeration_section">9.4.2.2.2</span> Task 1 - Preparing to Use the Oracle Suggested Backup Strategy</h2>
<div>
<div class="section">
<p>To use the Oracle suggested backup strategy, ensure that:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>The database is in <code>ARCHIVELOG</code> mode.</p>
</li>
<li>
<p>The fast recovery area size is configured, or a default device for storing backups is configured.</p>
</li>
<li>
<p>You have added a database host user to the OSBACKUPDBA operating system group, for operating system authentication.</p>
<div class="infoboxnotealso" id="GUID-15DFA81C-41A0-469E-AF85-43C434C6B1D1__GUID-E9F19E3C-EAF4-4B8F-9C29-A5EB59D042B6">
<p class="notep1">See Also:</p>
<p><span class="q">&#34;<a href="GUID-292CD2F6-ECDC-4F94-B750-97DD2D526B22.htm">Configuring Your Database for Basic Backup and Recovery</a>&#34;</span></p>
</div>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMQS12440"></a>
<div class="props_rev_3"><a id="GUID-7EF664B2-FD4E-439B-AD50-EAB5C1762C7D"></a>
<h2 id="ADMQS-GUID-7EF664B2-FD4E-439B-AD50-EAB5C1762C7D" class="sect2"><span class="enumeration_section">9.4.2.2.3</span> Task 2 - Creating the Backup Script&mdash;UNIX and Linux</h2>
<div>
<div class="section">
<p>This backup script implements the Oracle suggested backup strategy, enabling quick recovery to any time in the preceding 24 hours. This script can be used to back up a non-CDB or a whole multitenant container database (CDB).</p>
<p><span class="bold">To create the backup script for UNIX and Linux</span>:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Start a text editor and create and save a file with the following contents. Save the file in a directory that is accessible to the Oracle Database software and on which the Oracle software owner has the read permission.</p>
<div class="infobox-note" id="GUID-7EF664B2-FD4E-439B-AD50-EAB5C1762C7D__GUID-E6FC7183-16AB-4A9C-BDEC-454820F48A89">
<p class="notep1">Note:</p>
<p>In the following script, substitute the correct values for your installation for the <code>ORACLE_HOME</code> and <code>ORACLE_SID</code> environment variables.</p>
</div>
<pre dir="ltr">#!/bin/sh
export ORACLE_HOME=/u01/app/oracle/product/11.2.0/dbhome_1
export ORACLE_SID=orcl
PATH=$ORACLE_HOME/bin:$PATH
rman &lt;&lt;EOF
connect target /
RUN {
 ALLOCATE CHANNEL disk_iub DEVICE TYPE DISK;
 RECOVER COPY OF DATABASE WITH TAG daily_iub;
 BACKUP INCREMENTAL LEVEL 1 FOR RECOVER OF COPY WITH TAG daily_iub DATABASE;
}
exit
EOF
</pre></li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMQS12441"></a>
<div class="props_rev_3"><a id="GUID-5C45D54D-B459-4449-B59C-D0213C024390"></a>
<h2 id="ADMQS-GUID-5C45D54D-B459-4449-B59C-D0213C024390" class="sect2"><span class="enumeration_section">9.4.2.2.4</span> Task 3 - Testing the Backup Script</h2>
<div>
<div class="section">
<p>It is recommend that you run the script manually, to check for errors, before scheduling it. Your manual run of the script will start day one of the strategy, creating an incremental level 0 image copy of all datafiles.</p>
<p><span class="bold">To test the backup script</span>:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Log in to the database host as a user who is a member of the OSBACKUPDBA operating system group (typically the <code>backupdba</code> group).</span></li>
<li class="stepexpand"><span>In a command window, enter the following command:</span>
<div>
<pre dir="ltr"><span class="italic">full-script-path</span>
</pre>
<p>where <span class="italic"><code>full-script-path</code></span> is the full path and file name of the script you created in Task 2.</p>
<p>For example, if your script is in the file /u01/app/oracle/rman/daily_backup.sh, then enter this command:</p>
<pre dir="ltr">/u01/app/oracle/rman/daily_backup.sh
</pre></div>
</li>
</ol>
<div class="section">
<p>The script starts Oracle Recovery Manager (RMAN), which starts the backup. The output from RMAN includes warning messages similar to the following:</p>
<pre dir="ltr">...
no copy of datafile 1 found to recover
no copy of datafile 2 found to recover
...
no parent backup or copy of datafile 1 found
no parent backup or copy of datafile 2 found
...
</pre>
<p>These messages are normal for the first run of the script.</p>
<div class="infobox-note" id="GUID-5C45D54D-B459-4449-B59C-D0213C024390__GUID-B1FCF2CF-A40B-418D-9EE2-A7D099ECF594">
<p class="notep1">Note:</p>
<p>For the second run of the script, the output includes only these warning messages:</p>
<pre dir="ltr">no copy of datafile 1 found to recover
no copy of datafile 2 found to recover
...
</pre>
<p>Again, these messages are normal. For the third and subsequent script runs, no further warning messages are output.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="ADMQS09325"></a>
<div class="props_rev_3"><a id="GUID-D3CFC309-9F8B-4C48-B7EB-97EA66FE8315"></a>
<h2 id="ADMQS-GUID-D3CFC309-9F8B-4C48-B7EB-97EA66FE8315" class="sect2"><span class="enumeration_section">9.4.2.2.5</span> Task 4 - Scheduling the Daily Backup&mdash;UNIX and Linux</h2>
<div>
<div class="section">
<p>The following procedure uses the <code>cron</code> utility to schedule daily database backups at 2:00 a.m.</p>
<p><span class="bold">To schedule the Oracle-suggested disk backup strategy</span>:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Ensure that you are logged in to the database host as a user who is a member of the OSBACKUPDBA operating system group (typically the <code>backupdba</code> group).</span>
<div>
<p>The <code>cron</code> job will run as this host user.</p>
</div>
</li>
<li class="stepexpand"><span>Start a text editor, and create and save a file with the following contents into your home directory. Name the file .crontab. (Note the period at the front of the file name.)</span>
<div>
<pre dir="ltr">MAILTO=first.last@example.com
# MI HH DD MM DAY CMD
  00  2  *  *  *  <span class="italic">full-script-path</span>
</pre>
<p>where <span class="italic"><code>full-script-path</code></span> is the full path and file name of the script you created in Task 2.</p>
<p>For example, if the script is in the file /u01/app/oracle/rman/daily_backup.sh, then the .crontab file must contain:</p>
<pre dir="ltr">MAILTO=first.last@example.com
# MI HH DD MM DAY CMD
  00  2  *  *  *  /u01/app/oracle/rman/daily_backup.sh
</pre>
<div class="infobox-note" id="GUID-D3CFC309-9F8B-4C48-B7EB-97EA66FE8315__GUID-3D5A8BE7-83B4-4800-8806-F2374EE9109F">
<p class="notep1">Note:</p>
<p>Supply the desired e-mail address in the <code>MAILTO</code> line. This line is optional. Content written to stdout by the <code>cron</code> job is e-mailed to this address at the completion of the job.</p>
</div>
</div>
</li>
<li class="stepexpand"><span>In a command window, change directory to your home directory and enter the following command:</span>
<div>
<pre dir="ltr">crontab .crontab
</pre>
<p>This creates a crontab file for this user from the contents of .crontab.</p>
<div class="infobox-note" id="GUID-D3CFC309-9F8B-4C48-B7EB-97EA66FE8315__GUID-503726AA-B91D-4D3F-94B2-E01C0CF89DF0">
<p class="notep1">Caution:</p>
<p>The existing crontab file for this user is overwritten. If you want to preserve the contents of this file and add this new job, use this command, which enables you to edit the existing file:</p>
<pre dir="ltr">crontab -e
</pre></div>
</div>
</li>
<li class="stepexpand"><span>(Optional) Check the contents of the crontab file for this user with the following command:</span>
<div>
<pre dir="ltr">crontab -l

MAILTO=first.last@example.com
# MI HH DD MM DAY CMD
  00  2  *  *  *  /u01/app/oracle/rman/daily_backup.sh
</pre></div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-D3CFC309-9F8B-4C48-B7EB-97EA66FE8315__GUID-3CD92BD5-27FF-483A-9917-D8EF8FE218DA">
<p class="notep1">See Also:</p>
<p>Your operating system documentation for a description of the crontab command and crontab files</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment4647">
<tr>
<td class="cellalignment4654">
<table class="cellalignment4652">
<tr>
<td class="cellalignment4651"><a href="GUID-E6AB87FC-DE6E-433C-AB61-F2055B6CC547.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment4651"><a href="GUID-FBF51D7D-6BF2-42E0-A822-CC565A4B7549.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2004, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment4656">
<table class="cellalignment4650">
<tr>
<td class="cellalignment4651"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment4651"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment4651"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment4651"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment4651"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment4651"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>