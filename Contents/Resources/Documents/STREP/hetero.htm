<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-104196"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Oracle%20Streams%20Heterogeneous%20Information%C2%A0Sharing"></a><title>Oracle Streams Heterogeneous Information&nbsp;Sharing</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1044"/>
<meta name="dcterms.created" content="2015-02-12T7:14:20Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Streams Replication Administrator&#39;s Guide"/>
<meta name="dcterms.identifier" content="E53118-02"/>
<meta name="dcterms.isVersionOf" content="STREP"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="rep_tags.htm" title="Previous" type="text/html"/>
<link rel="Next" href="ptrep_admin.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E53118-02.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">16/28</span> <!-- End Header -->
<div id="STREP006" class="chapter"><a id="CHDHDFFB"></a> <a id="BHCEEADH"></a>
<h1 class="chapter"><span class="secnum">11</span> Oracle Streams Heterogeneous Information&nbsp;Sharing</h1>
<p><a id="sthref489"></a><a id="sthref490"></a>This chapter explains concepts relating to Oracle Streams support for information sharing between Oracle databases and non-Oracle databases.</p>
<p>This chapter contains these topics:</p>
<ul>
<li>
<p><a href="#i1006108">Oracle to Non-Oracle Data Sharing with Oracle Streams</a></p>
</li>
<li>
<p><a href="#i1006444">Non-Oracle to Oracle Data Sharing with Oracle Streams</a></p>
</li>
<li>
<p><a href="#i1006526">Non-Oracle to Non-Oracle Data Sharing with Oracle Streams</a></p>
<div class="infobox-note">
<p class="notep1">Note:</p>
A new feature called XStream is available in Oracle Database 11<span class="italic">g</span> Release 2 (11.2) and later. XStream enables Oracle Call Interface and Java applications to access the database changes in a stream. See <a class="olink XSTRM" href="../XSTRM/toc.htm"><span class="italic">Oracle Database XStream Guide</span></a> for information about XStream.</div>
</li>
</ul>
<a id="i1006108"></a>
<div id="STREP408" class="sect1">
<h2 class="sect1">Oracle to Non-Oracle Data Sharing with Oracle Streams<a id="sthref491"></a></h2>
<p>To share DML changes from an Oracle source database to a non-Oracle destination database, the Oracle database functions as a proxy and carries out some steps that would usually be done at the destination database. That is, the LCRs intended for the non-Oracle destination database are dequeued in the Oracle database itself and an apply process at the Oracle database applies the changes to the non-Oracle database across a network connection through an Oracle Database Gateway. <a href="#i1006118">Figure 11-1</a> shows an Oracle database sharing data with a non-Oracle database.</p>
<div id="STREP409" class="figure">
<p class="titleinfigure"><a id="i1006118"></a>Figure 11-1 Oracle to Non-Oracle Heterogeneous Data Sharing</p>
<img width="564" height="356" src="img/strep009.gif" alt="Description of Figure 11-1 follows"/><br/>
<a id="sthref492" href="img_text/strep009.htm">Description of &#34;Figure 11-1 Oracle to Non-Oracle Heterogeneous Data Sharing&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>You should configure the Oracle Database Gateway to use the transaction model <code dir="ltr">COMMIT_CONFIRM</code>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
The Oracle documentation for your specific Oracle Database Gateway for information about using the transaction model <code dir="ltr">COMMIT_CONFIRM</code> for your Oracle Database Gateway</div>
<div id="STREP410" class="sect2"><a id="sthref493"></a>
<h3 class="sect2">Change Capture and Staging in an Oracle to Non-Oracle Environment<a id="sthref494"></a><a id="sthref495"></a><a id="sthref496"></a><a id="sthref497"></a></h3>
<p>In an Oracle to non-Oracle environment, a capture process or a synchronous capture functions the same way as it would in an Oracle-only environment. That is, a capture process finds changes in the redo log, captures them based on its rules, and enqueues the captured changes as logical change records (LCRs) into an <code dir="ltr">ANYDATA</code> queue. A synchronous capture uses an internal mechanism to capture changes based on its rules and enqueue the captured changes as row LCRs into an <code dir="ltr">ANYDATA</code> queue. In addition, a single capture process or synchronous capture can capture changes that will be applied at both Oracle and non-Oracle databases.</p>
<p>Similarly, the <code dir="ltr">ANYDATA</code> queue that stages the LCRs functions the same way as it would in an Oracle-only environment, and you can propagate LCRs to any number of intermediate queues in Oracle databases before they are applied at a non-Oracle database.</p>
<div class="infoboxnotealso">
<p class="notep1"><span class="bold">See Also</span>:</p>
<ul>
<li>
<p><a class="olink STRMS" href="../STRMS/toc.htm"><span class="italic">Oracle Streams Concepts and Administration</span></a> for general information about capture processes, synchronous captures, staging, and propagations</p>
</li>
<li>
<p><a href="prep_rep.htm#g1024216">Chapter 1, &#34;Preparing for Oracle Streams Replication&#34;</a> for information about capture processes, synchronous captures, staging, and propagations in an Oracle Streams replication environment</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CHDIBIDC"></a>
<div id="STREP411" class="sect2">
<h3 class="sect2">Change Apply in an Oracle to Non-Oracle Environment<a id="sthref498"></a><a id="sthref499"></a></h3>
<p>An apply process running in an Oracle database uses Heterogeneous Services and an Oracle Database Gateway to apply changes encapsulated in LCRs directly to database objects in a non-Oracle database. The LCRs are not propagated to a queue in the non-Oracle database, as they would be in an Oracle-only Oracle Streams environment. Instead, the apply process applies the changes directly through a database link to the non-Oracle database.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle Streams apply processes do not support Generic Connectivity.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS004" href="../STRMS/strms_apply.htm#STRMS004"><span class="italic">Oracle Streams Concepts and Administration</span></a></div>
<a id="i1006155"></a>
<div id="STREP105" class="sect3">
<h4 class="sect3">Apply Process Configuration in an Oracle to Non-Oracle Environment</h4>
<p>This section describes the configuration of an apply process that will apply changes to a non-Oracle database.</p>
<div id="STREP412" class="sect4"><a id="sthref500"></a>
<h5 class="sect4">Before Creating an Apply Process in an Oracle to Non-Oracle Environment<a id="sthref501"></a><a id="sthref502"></a><a id="sthref503"></a><a id="sthref504"></a><a id="sthref505"></a></h5>
<p>Before you create an apply process that will apply changes to a non-Oracle database, configure Heterogeneous Services, the Oracle Database Gateway, and a database link.</p>
<p>Oracle Streams supports the following Oracle Database Gateways:</p>
<ul>
<li>
<p>Oracle Database Gateway for Sybase</p>
</li>
<li>
<p>Oracle Database Gateway for Informix</p>
</li>
<li>
<p>Oracle Database Gateway for SQL Server</p>
</li>
<li>
<p>Oracle Database Gateway for DRDA</p>
</li>
</ul>
<p>The database link will be used by the apply process to apply the changes to the non-Oracle database. The database link must be created with an explicit <code dir="ltr">CONNECT</code> <code dir="ltr">TO</code> clause.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink HETER" href="../HETER/toc.htm"><span class="italic">Oracle Database Heterogeneous Connectivity User&#39;s Guide</span></a> for more information about Heterogeneous Services and Oracle Database Gateway</p>
</li>
<li>
<p>The Oracle documentation for your Oracle Database Gateway</p>
</li>
</ul>
</div>
</div>
<!-- class="sect4" -->
<div id="STREP413" class="sect4"><!-- infolevel="all" infotype="General" --><a id="sthref506"></a>
<h5 class="sect4">Apply Process Creation in an Oracle to Non-Oracle Environment</h5>
<p>After the database link has been created and is working properly, create the apply process using the <code dir="ltr">CREATE_APPLY</code> procedure in the <code dir="ltr">DBMS_APPLY_ADM</code> package and specify the database link for the <code dir="ltr">apply_database_link</code> parameter. After you create an apply process, you can use apply process rules to specify which changes are applied at the non-Oracle database.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink ARPLS300" href="../ARPLS/d_apply.htm#ARPLS300"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information about the procedures in the <code dir="ltr">DBMS_APPLY_ADM</code> package</p>
</li>
<li>
<p><a class="olink STRMS006" href="../STRMS/strms_rules.htm#STRMS006"><span class="italic">Oracle Streams Concepts and Administration</span></a> for information about specifying apply process rules</p>
</li>
</ul>
</div>
</div>
<!-- class="sect4" -->
<div id="STREP414" class="sect4"><a id="sthref507"></a>
<h5 class="sect4">Substitute Key Columns in an Oracle to Non-Oracle Heterogeneous Environment<a id="sthref508"></a><a id="sthref509"></a></h5>
<p>If you use substitute key columns for any of the tables at the non-Oracle database, then specify the database link to the non-Oracle database when you run the <code dir="ltr">SET_KEY_COLUMNS</code> procedure in the <code dir="ltr">DBMS_APPLY_ADM</code> package.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS214" href="../STRMS/strms_adapply.htm#STRMS214"><span class="italic">Oracle Streams Concepts and Administration</span></a></div>
</div>
<!-- class="sect4" -->
<div id="STREP415" class="sect4"><a id="sthref510"></a>
<h5 class="sect4">Parallelism in an Oracle to Non-Oracle Heterogeneous Environment<a id="sthref511"></a><a id="sthref512"></a></h5>
<p>You must set the <code dir="ltr">parallelism</code> apply process parameter to <code dir="ltr">1</code>, the default setting, when an apply process is applying changes to a non-Oracle database. Currently, parallel apply to non-Oracle databases is not supported. However, you can use multiple apply processes to apply changes a non-Oracle database.</p>
</div>
<!-- class="sect4" -->
<a id="i1007324"></a>
<div id="STREP416" class="sect4">
<h5 class="sect4">Procedure DML Handlers in an Oracle to Non-Oracle Heterogeneous Environment<a id="sthref513"></a><a id="sthref514"></a><a id="sthref515"></a><a id="sthref516"></a></h5>
<p>If you use a procedure DML handler to process row LCRs for any of the tables at the non-Oracle database, then specify the database link to the non-Oracle database when you run the <code dir="ltr">SET_DML_HANDLER</code> procedure in the <code dir="ltr">DBMS_APPLY_ADM</code> package.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS175" href="../STRMS/strms_apply.htm#STRMS175"><span class="italic">Oracle Streams Concepts and Administration</span></a> for information about message processing options for an apply process</div>
</div>
<!-- class="sect4" -->
<div id="STREP417" class="sect4"><a id="sthref517"></a>
<h5 class="sect4">Message Handlers in an Oracle to Non-Oracle Heterogeneous Environment<a id="sthref518"></a><a id="sthref519"></a><a id="sthref520"></a><a id="sthref521"></a></h5>
<p>If you want to use a message handler to process user messages for a non-Oracle database, then, when you run the <code dir="ltr">CREATE_APPLY</code> procedure in the <code dir="ltr">DBMS_APPLY_ADM</code> package, specify the database link to the non-Oracle database using the <code dir="ltr">apply_database_link</code> parameter, and specify the message handler procedure using the <code dir="ltr">message_handler</code> parameter.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS" href="../STRMS/toc.htm"><span class="italic">Oracle Streams Concepts and Administration</span></a> for information about <a class="olink STRMS104" href="../STRMS/strms_apply.htm#STRMS104">message processing options</a> and <a class="olink STRMS009" href="../STRMS/strms_mapply.htm#STRMS009">managing message&nbsp;handlers</a></div>
</div>
<!-- class="sect4" -->
<div id="STREP418" class="sect4"><a id="sthref522"></a>
<h5 class="sect4">Error and Conflict Handlers in an Oracle to Non-Oracle Heterogeneous Environment<a id="sthref523"></a><a id="sthref524"></a><a id="sthref525"></a><a id="sthref526"></a></h5>
<p>Currently, error handlers and conflict handlers are not supported when sharing data from an Oracle database to a non-Oracle database. If an apply error occurs, then the transaction containing the LCR that caused the error is moved into the error queue in the Oracle database.</p>
</div>
<!-- class="sect4" --></div>
<!-- class="sect3" -->
<div id="STREP419" class="sect3"><a id="sthref527"></a>
<h4 class="sect3">Data Types Applied at Non-Oracle Databases<a id="sthref528"></a><a id="sthref529"></a><a id="sthref530"></a></h4>
<p>When applying changes to a non-Oracle database, an apply process applies changes made to columns of only the following data types:</p>
<ul>
<li>
<p><code dir="ltr">CHAR</code></p>
</li>
<li>
<p><code dir="ltr">VARCHAR2</code></p>
</li>
<li>
<p><code dir="ltr">NCHAR</code></p>
</li>
<li>
<p><code dir="ltr">NVARCHAR2</code></p>
</li>
<li>
<p><code dir="ltr">NUMBER</code></p>
</li>
<li>
<p><code dir="ltr">DATE</code></p>
</li>
<li>
<p><code dir="ltr">RAW</code></p>
</li>
<li>
<p><code dir="ltr">TIMESTAMP</code></p>
</li>
<li>
<p><code dir="ltr">TIMESTAMP</code> <code dir="ltr">WITH</code> <code dir="ltr">TIME</code> <code dir="ltr">ZONE</code></p>
</li>
<li>
<p><code dir="ltr">TIMESTAMP</code> <code dir="ltr">WITH</code> <code dir="ltr">LOCAL</code> <code dir="ltr">TIME</code> <code dir="ltr">ZONE</code></p>
</li>
<li>
<p><code dir="ltr">INTERVAL</code> <code dir="ltr">YEAR</code> <code dir="ltr">TO</code> <code dir="ltr">MONTH</code></p>
</li>
<li>
<p><code dir="ltr">INTERVAL</code> <code dir="ltr">DAY</code> <code dir="ltr">TO</code> <code dir="ltr">SECOND</code></p>
</li>
</ul>
<p>The apply process does not apply changes in columns of the following data types to non-Oracle databases: <code dir="ltr">CLOB</code>, <code dir="ltr">NCLOB</code>, <code dir="ltr">BLOB</code>, <code dir="ltr">BFILE</code>, <code dir="ltr">LONG</code>, <code dir="ltr">LONG</code> <code dir="ltr">RAW</code>, <code dir="ltr">ROWID</code>, <code dir="ltr">UROWID</code>, user-defined types (including object types, <code dir="ltr">REF</code>s, varrays, and nested tables), and Oracle-supplied types (including <code dir="ltr">Any</code> types, XML types, spatial types, and media types). The apply process raises an error when an LCR contains a data type that is not listed, and the transaction containing the LCR that caused the error is moved to the error queue in the Oracle database.</p>
<p>Each Oracle Database Gateway might have further limitations regarding data types. For a data type to be supported in an Oracle to non-Oracle environment, the data type must be supported by both Oracle Streams and the Oracle Database Gateway being used.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink SQLRF0021" href="../SQLRF/sql_elements001.htm#SQLRF0021"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about these data types</p>
</li>
<li>
<p>The Oracle documentation for your specific Oracle Database Gateway</p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" -->
<div id="STREP420" class="sect3"><a id="sthref531"></a>
<h4 class="sect3">Types of DML Changes Applied at Non-Oracle Databases<a id="sthref532"></a><a id="sthref533"></a></h4>
<p>When you specify that DML changes made to certain tables should be applied at a non-Oracle database, an apply process can apply only the following types of DML changes:</p>
<ul>
<li>
<p><code dir="ltr">INSERT</code></p>
</li>
<li>
<p><code dir="ltr">UPDATE</code></p>
</li>
<li>
<p><code dir="ltr">DELETE</code></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
The apply process cannot apply DDL changes at non-Oracle databases.</div>
</div>
<!-- class="sect3" -->
<a id="i1006303"></a>
<div id="STREP106" class="sect3">
<h4 class="sect3">Instantiation in an Oracle to Non-Oracle Environment<a id="sthref534"></a><a id="sthref535"></a></h4>
<p>Before you start an apply process that applies changes to a non-Oracle database, complete the following steps to instantiate each table at the non-Oracle database:</p>
<a id="i1006307"></a>
<ol>
<li>
<p>Use the <code dir="ltr">DBMS_HS_PASSTHROUGH</code> package or the tools supplied with the non-Oracle database to create the table at the non-Oracle database.</p>
<p>The following is an example that uses the <code dir="ltr">DBMS_HS_PASSTHROUGH</code> package to create the <code dir="ltr">hr.regions</code> table in the <code dir="ltr">het.example.com</code> non-Oracle database:</p>
<pre dir="ltr">DECLARE 
 ret INTEGER; 
BEGIN 
ret := DBMS_HS_PASSTHROUGH.EXECUTE_IMMEDIATE@het.example.com ( 
  &#39;CREATE TABLE regions (region_id INTEGER, region_name VARCHAR(50))&#39;); 
END; 
/ 
COMMIT; 
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink HETER" href="../HETER/toc.htm"><span class="italic">Oracle Database Heterogeneous Connectivity User&#39;s Guide</span></a> and the Oracle documentation for your specific Oracle Database Gateway for more information about Heterogeneous Services and Oracle Database Gateway</div>
</li>
<li>
<p>If the changes that will be shared between the Oracle and non-Oracle database are captured by a capture process or synchronous capture at the Oracle database, then prepare all tables that will share data for instantiation.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="instant.htm#i1009355">&#34;Preparing Database Objects for Instantiation at a Source Database&#34;</a></div>
</li>
<li id="i1006331">
<p>Create a PL/SQL procedure (or a C program) that performs the following actions:</p>
<ul>
<li>
<p>Gets the current SCN using the <code dir="ltr">GET_SYSTEM_CHANGE_NUMBER</code> function in the <code dir="ltr">DBMS_FLASHBACK</code> package.</p>
</li>
<li>
<p>Invokes the <code dir="ltr">ENABLE_AT_SYSTEM_CHANGE_NUMBER</code> procedure in the <code dir="ltr">DBMS_FLASHBACK</code> package to set the current session to the obtained SCN. This action ensures that all fetches are done using the same SCN.</p>
</li>
<li id="i1006335">
<p>Populates the table at the non-Oracle site by fetching row by row from the table at the Oracle database and then inserting row by row into the table at the non-Oracle database. All fetches should be done at the SCN obtained using the <code dir="ltr">GET_SYSTEM_CHANGE_NUMBER</code> function.</p>
</li>
</ul>
<p>For example, the following PL/SQL procedure gets the flashback SCN, fetches each row in the <code dir="ltr">hr.regions</code> table in the current Oracle database, and inserts them into the <code dir="ltr">hr.regions</code> table in the <code dir="ltr">het.example.com</code> non-Oracle database. Notice that flashback is disabled before the rows are inserted into the non-Oracle database.</p>
<pre dir="ltr">SET SERVEROUTPUT ON
CREATE OR REPLACE PROCEDURE insert_reg IS
  CURSOR c1 IS
    SELECT region_id, region_name FROM hr.regions;
  c1_rec c1 % ROWTYPE;
  scn NUMBER;
BEGIN
  scn := DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER();
  DBMS_FLASHBACK.ENABLE_AT_SYSTEM_CHANGE_NUMBER(
     query_scn  =&gt;  scn);
  /* Open c1 in flashback mode */
  OPEN c1;
  /* Disable Flashback */
  DBMS_FLASHBACK.DISABLE;
  LOOP
    FETCH c1 INTO c1_rec;
    EXIT WHEN c1%NOTFOUND;
   /*
     Note that all the DML operations inside the loop are performed
     with Flashback disabled
   */
   INSERT INTO hr.regions@het.example.com VALUES (
     c1_rec.region_id,
     c1_rec.region_name);
  END LOOP;
  COMMIT;
  DBMS_OUTPUT.PUT_LINE(&#39;SCN = &#39; || scn);
  EXCEPTION WHEN OTHERS THEN 
    DBMS_FLASHBACK.DISABLE; 
    RAISE;
END;
/
</pre>
<p>Make a note of the SCN returned.</p>
<p>If the Oracle Database Gateway you are using supports the Heterogeneous Services callback functionality, then you can replace the loop in the previous example with the following SQL statement:</p>
<pre dir="ltr">INSERT INTO hr.region@het.example.com SELECT * FROM hr.region@!;
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
The user who creates and runs the procedure in the previous example must have <code dir="ltr">EXECUTE</code> privilege on the <code dir="ltr">DBMS_FLASHBACK</code> package and all privileges on the tables involved.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink HETER" href="../HETER/toc.htm"><span class="italic">Oracle Database Heterogeneous Connectivity User&#39;s Guide</span></a> and the Oracle documentation for your specific Oracle Database Gateway for information about callback functionality and your Oracle Database Gateway</div>
</li>
<li>
<p>Set the instantiation SCN for the table at the non-Oracle database. Specify the SCN you obtained in Step <a href="#i1006331">3</a> in the <code dir="ltr">SET_TABLE_INSTANTIATION_SCN</code> procedure in the <code dir="ltr">DBMS_APPLY_ADM</code> package to instruct the apply process to skip all LCRs with changes that occurred before the SCN you obtained in Step <a href="#i1006331">3</a>. Ensure that you set the <code dir="ltr">apply_database_link</code> parameter to the database link for the remote non-Oracle database.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="instant.htm#i1009604">&#34;Setting Instantiation SCNs at a Destination Database&#34;</a> and <a class="olink ARPLS325" href="../ARPLS/d_apply.htm#ARPLS325"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information about the <code dir="ltr">SET_TABLE_INSTANTIATION_SCN</code> procedure</div>
</li>
</ol>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1006400"></a>
<div id="STREP421" class="sect2">
<h3 class="sect2">Transformations in an Oracle to Non-Oracle Environment<a id="sthref536"></a><a id="sthref537"></a></h3>
<p>In an Oracle to non-Oracle environment, you can specify rule-based transformations during capture or apply the same way as you would in an Oracle-only environment. In addition, if your environment propagates LCRs to one or more intermediate Oracle databases before they are applied at a non-Oracle database, then you can specify a rule-based transformation during propagation from a queue at an Oracle database to another queue at an Oracle database.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS106" href="../STRMS/strms_transform.htm#STRMS106"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information about rule-based transformations</div>
</div>
<!-- class="sect2" -->
<div id="STREP422" class="sect2"><a id="sthref538"></a>
<h3 class="sect2">Messaging Gateway and Oracle Streams</h3>
<p>Messaging Gateway is a feature of the Oracle database that provides propagation between Oracle queues and non-Oracle message queuing systems. Messages enqueued into an Oracle queue are automatically propagated to a non-Oracle queue, and the messages enqueued into a non-Oracle queue are automatically propagated to an Oracle queue. It provides guaranteed message delivery to the non-Oracle messaging system and supports the native message format for the non-Oracle messaging system. It also supports specification of user-defined transformations that are invoked while propagating from an Oracle queue to the non-Oracle messaging system or from the non-Oracle messaging system to an Oracle queue.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADQUE1700" href="../ADQUE/mg_intro.htm#ADQUE1700"><span class="italic">Oracle Database Advanced Queuing User&#39;s Guide</span></a> for more information about the Messaging Gateway</div>
</div>
<!-- class="sect2" -->
<div id="STREP423" class="sect2"><a id="sthref539"></a>
<h3 class="sect2">Error Handling in an Oracle to Non-Oracle Environment<a id="sthref540"></a><a id="sthref541"></a></h3>
<p>If the apply process encounters an unhandled error when it tries to apply an LCR at a non-Oracle database, then the transaction containing the LCR is placed in the error queue in the Oracle database that is running the apply process. The apply process detects data conflicts in the same way as it does in an Oracle-only environment, but automatic conflict resolution is not supported currently in an Oracle to non-Oracle environment. Therefore, any data conflicts encountered are treated as apply errors.</p>
</div>
<!-- class="sect2" -->
<div id="STREP424" class="sect2"><a id="sthref542"></a>
<h3 class="sect2">Example Oracle to Non-Oracle Streams Environment</h3>
<p><a class="olink STREX003" href="../STREX/repsingdemo.htm#STREX003"><span class="italic">Oracle Streams Extended Examples</span></a> contains a detailed example that includes sharing data in an Oracle to non-Oracle Streams environment.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1006444"></a>
<div id="STREP425" class="sect1">
<h2 class="sect1">Non-Oracle to Oracle Data Sharing with Oracle Streams<a id="sthref543"></a></h2>
<p>To capture and propagate changes from a non-Oracle database to an Oracle database, a custom application is required. This application gets the changes made to the non-Oracle database by reading from transaction logs, by using triggers, or by some other method. The application must assemble and order the transactions and must convert each change into a logical change record (LCR). Next, the application must enqueue the LCRs in an Oracle database using the <code dir="ltr">DBMS_STREAMS_MESSAGING</code> package or the <code dir="ltr">DBMS_AQ</code> package. The application must commit after enqueuing all LCRs in each transaction. <a href="#i1006454">Figure 11-2</a> shows a non-Oracle databases sharing data with an Oracle database.</p>
<div id="STREP426" class="figure">
<p class="titleinfigure"><a id="i1006454"></a>Figure 11-2 Non-Oracle to Oracle Heterogeneous Data Sharing</p>
<img width="668" height="348" src="img/strep014.gif" alt="Description of Figure 11-2 follows"/><br/>
<a id="sthref544" href="img_text/strep014.htm">Description of &#34;Figure 11-2 Non-Oracle to Oracle Heterogeneous Data Sharing&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<div id="STREP427" class="sect2"><a id="sthref545"></a>
<h3 class="sect2">Change Capture in a Non-Oracle to Oracle Environment<a id="sthref546"></a><a id="sthref547"></a></h3>
<p>Because the custom user application is responsible for assembling changes at the non-Oracle database into LCRs and enqueuing the LCRs at the Oracle database, the application is completely responsible for change capture. Therefore, the application must construct LCRs that represent changes at the non-Oracle database and then enqueue these LCRs into the queue at the Oracle database. The application can enqueue multiple transactions concurrently, but the transactions must be committed in the same order as the transactions on the non-Oracle source database.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="man_lcrs.htm#i1009981">&#34;Constructing and Enqueuing LCRs&#34;</a> for more information about constructing and enqueuing LCRs</div>
</div>
<!-- class="sect2" -->
<div id="STREP428" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref548"></a>
<h3 class="sect2">Staging in a Non-Oracle to Oracle Environment<a id="sthref549"></a><a id="sthref550"></a></h3>
<p>To ensure the same transactional consistency at both the Oracle database where changes are applied and the non-Oracle database where changes originate, you must use a transactional queue to stage the LCRs at the Oracle database. For example, suppose a single transaction contains three row changes, and the custom application enqueues three row LCRs, one for each change, and then commits. With a transactional queue, a commit is performed by the apply process after the third row&nbsp;LCR, retaining the consistency of the transaction. If you use a nontransactional queue, then a commit is performed for each row LCR by the apply process. The <code dir="ltr">SET_UP_QUEUE</code> procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package creates a transactional queue automatically.</p>
<p>Also, the queue at the Oracle database should be a commit-time queue. A commit-time queue orders LCRs by approximate commit system change number (approximate CSCN) of the transaction that includes the LCRs. Commit-time queues preserve transactional dependency ordering between LCRs in the queue, if the application that enqueued the LCRs commits the transactions in the correct order. Also, commit-time queues ensure consistent browses of LCRs in a queue.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS" href="../STRMS/toc.htm"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information about <a class="olink STRMS149" href="../STRMS/strms_adqueue.htm#STRMS149">transactional queues</a> and <a class="olink STRMS148" href="../STRMS/strms_adqueue.htm#STRMS148">commit-time queues</a></div>
</div>
<!-- class="sect2" -->
<div id="STREP429" class="sect2"><a id="sthref551"></a>
<h3 class="sect2">Change Apply in a Non-Oracle to Oracle Environment<a id="sthref552"></a><a id="sthref553"></a></h3>
<p>In a non-Oracle to Oracle environment, the apply process functions the same way as it would in an Oracle-only environment. That is, it dequeues each LCR from its associated queue based on apply process rules, performs any rule-based transformation, and either sends the LCR to a handler or applies it directly. Error handling and conflict resolution also function the same as they would in an Oracle-only environment. So, you can specify a prebuilt update conflict handler or create a custom conflict handler to resolve conflicts.</p>
<p>The apply process should be configured to apply persistent LCRs, not captured LCRs. So, the apply process should be created using the <code dir="ltr">CREATE_APPLY</code> procedure in the <code dir="ltr">DBMS_APPLY_ADM</code> package, and the <code dir="ltr">apply_captured</code> parameter should be set to <code dir="ltr">FALSE</code> when you run this procedure. After the apply process is created, you can use procedures in the <code dir="ltr">DBMS_STREAMS_ADM</code> package to add rules for LCRs to the apply process rule&nbsp;sets.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink STRMS" href="../STRMS/toc.htm"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information about apply processes, rules, and rule-based transformations</p>
</li>
<li>
<p><a href="conflict.htm#g1013001">Chapter 9, &#34;Oracle Streams Conflict Resolution&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<div id="STREP430" class="sect2"><a id="sthref554"></a>
<h3 class="sect2">Instantiation from a Non-Oracle Database to an Oracle Database<a id="sthref555"></a><a id="sthref556"></a></h3>
<p>There is no automatic way to instantiate tables that exist at a non-Oracle database at an Oracle database. However, you can perform the following general procedure to instantiate a table manually:</p>
<ol>
<li>
<p>At the non-Oracle database, use a non-Oracle utility to export the table to a flat file.</p>
</li>
<li>
<p>At the Oracle database, create an empty table that matches the table at the non-Oracle database.</p>
</li>
<li>
<p>At the Oracle database, use SQL*Loader to load the contents of the flat file into the table.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SUTIL" href="../SUTIL/toc.htm"><span class="italic">Oracle Database Utilities</span></a> for information about using SQL*Loader</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1006526"></a>
<div id="STREP431" class="sect1">
<h2 class="sect1">Non-Oracle to Non-Oracle Data Sharing with Oracle Streams<a id="sthref557"></a></h2>
<p>Oracle Streams supports data sharing between two non-Oracle databases through a combination of non-Oracle to Oracle data sharing and Oracle to non-Oracle data sharing. Such an environment would use Oracle Streams in an Oracle database as an intermediate database between two non-Oracle databases.</p>
<p>For example, a non-Oracle to non-Oracle environment can consist of the following databases:</p>
<ul>
<li>
<p>A non-Oracle database named <code dir="ltr">het1.example.com</code></p>
</li>
<li>
<p>An Oracle database named <code dir="ltr">dbs1.example.com</code></p>
</li>
<li>
<p>A non-Oracle database named <code dir="ltr">het2.example.com</code></p>
</li>
</ul>
<p>A user application assembles changes at <code dir="ltr">het1.example.com</code> and enqueues them in <code dir="ltr">dbs1.example.com</code>. Next, the apply process at <code dir="ltr">dbs1.example.com</code> applies the changes to <code dir="ltr">het2.example.com</code> using Heterogeneous Services and an Oracle Database Gateway. Another apply process at <code dir="ltr">dbs1.example.com</code> could apply some or all of the changes in the queue locally at <code dir="ltr">dbs1.example.com</code>. One or more propagations at <code dir="ltr">dbs1.example.com</code> could propagate some or all of the changes in the queue to other Oracle databases.</p>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment91">
<tr>
<td class="cellalignment98">
<table class="cellalignment96">
<tr>
<td class="cellalignment95"><a href="rep_tags.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment95"><a href="ptrep_admin.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment100">
<table class="cellalignment94">
<tr>
<td class="cellalignment95"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment95"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment95"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment95"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment95"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment95"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>