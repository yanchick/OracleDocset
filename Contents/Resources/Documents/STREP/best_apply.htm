<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-104185"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Best%20Practices%20for%20Apply"></a><title>Best Practices for Apply</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1044"/>
<meta name="dcterms.created" content="2015-02-12T7:14:20Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Streams Replication Administrator&#39;s Guide"/>
<meta name="dcterms.identifier" content="E53118-02"/>
<meta name="dcterms.isVersionOf" content="STREP"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="best_prop.htm" title="Previous" type="text/html"/>
<link rel="Next" href="ptrep_ap.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E53118-02.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">25/28</span> <!-- End Header -->
<div id="STREP534" class="chapter"><a id="CDDGEIFJ"></a>
<h1 class="chapter"><span class="secnum">18</span> Best Practices for Apply</h1>
<p><a id="sthref781"></a>This chapter describes the best practices for applying changes with an apply process in an Oracle Streams replication environment. This chapter includes these topics:</p>
<ul>
<li>
<p><a href="#CDDGHBCJ">Best Practices for Destination Database Configuration</a></p>
</li>
<li>
<p><a href="#CDDGCHJA">Best Practices for Apply Process Configuration</a></p>
</li>
<li>
<p><a href="#CDDHDIBG">Best Practices for Apply Process Operation</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="best_gen.htm#CHDIAIGF">&#34;Best Practices for Oracle Real Application Clusters and Oracle Streams&#34;</a></div>
<a id="CDDGHBCJ"></a>
<div id="STREP535" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Best Practices for Destination Database Configuration<a id="sthref782"></a></h2>
<p>In an Oracle Streams replication environment, a destination database is a database where an apply process applies changes. This section contains these topics:</p>
<ul>
<li>
<p><a href="#CDDGIFIF">Grant Required Privileges to the Apply User</a></p>
</li>
<li>
<p><a href="#CDDDBCJD">Set Instantiation SCN Values</a></p>
</li>
<li>
<p><a href="#CDDBHCJF">Configure Conflict Resolution</a></p>
</li>
</ul>
<a id="CDDGIFIF"></a>
<div id="STREP536" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Grant Required Privileges to the Apply User<a id="sthref783"></a><a id="sthref784"></a></h3>
<p>The apply user is the user in whose security domain an apply process performs the following actions:</p>
<ul>
<li>
<p>Dequeues messages that satisfy its rule sets</p>
</li>
<li>
<p>Runs custom rule-based transformations configured for apply process rules</p>
</li>
<li>
<p>Applies messages directly to database objects</p>
</li>
<li>
<p>Runs apply handlers configured for the apply process</p>
</li>
</ul>
<p>The apply user for an apply process is configured when you create an apply process, and the apply user can be modified when you alter an apply process. Grant the following privileges to the apply user:</p>
<ul>
<li>
<p>If the apply process applies data manipulation language (DML) changes to a table, then grant <code dir="ltr">INSERT</code>, <code dir="ltr">UPDATE</code>, and <code dir="ltr">DELETE</code> privileges on the table to the apply user.</p>
</li>
<li>
<p>If the apply process applies data definition language (DDL) changes to a table, then grant <code dir="ltr">CREATE</code> <code dir="ltr">TABLE</code> or <code dir="ltr">CREATE</code> <code dir="ltr">ANY</code> <code dir="ltr">TABLE</code>, <code dir="ltr">CREAT</code> <code dir="ltr">INDEX</code> or <code dir="ltr">CREATE</code> <code dir="ltr">ANY</code> <code dir="ltr">INDEX</code>, and <code dir="ltr">CREATE</code> <code dir="ltr">PROCEDURE</code> or <code dir="ltr">CREATE</code> <code dir="ltr">ANY</code> <code dir="ltr">PROCEDURE</code> to the apply user.</p>
</li>
<li>
<p>Grant <code dir="ltr">EXECUTE</code> privilege on the rule sets used by the apply process.</p>
</li>
<li>
<p>Grant <code dir="ltr">EXECUTE</code> privilege on all custom rule-based transformation functions specified for rules in the positive rule set of the apply process.</p>
</li>
<li>
<p>Grant <code dir="ltr">EXECUTE</code> privilege on any apply handlers used by the apply process.</p>
</li>
<li>
<p>Grant privileges to dequeue messages from the apply process&#39;s queue.</p>
</li>
</ul>
<p>These privileges can be granted directly to the apply user, or they can be granted through roles.</p>
<p>In addition, the apply user must be granted <code dir="ltr">EXECUTE</code> privilege on all packages, including Oracle-supplied packages, that are invoked in subprograms run by the apply process. These privileges must be granted directly to the apply user. They cannot be granted through roles.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink DBSEG004" href="../DBSEG/authorization.htm#DBSEG004"><span class="italic">Oracle Database Security Guide</span></a> for general information about granting privileges</p>
</li>
<li>
<p><a class="olink STRMS012" href="../STRMS/strms_mrules.htm#STRMS012"><span class="italic">Oracle Streams Concepts and Administration</span></a> for information about granting privileges on rule sets</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CDDDBCJD"></a>
<div id="STREP537" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Set Instantiation SCN Values<a id="sthref785"></a><a id="sthref786"></a></h3>
<p>An instantiation SCN value must be set for each database object to which an apply process applies changes. Confirm that an instantiation SCN is set for all such objects, and set any required instantiation SCN values that are not set.</p>
<p>Instantiation SCN values can be set in various ways, including during export/import, by Recovery Manager (RMAN), or manually. To set instantiation SCN values manually, use one of the following procedures in the <code dir="ltr">DBMS_APPLY_ADM</code> package:</p>
<ul>
<li>
<p><a class="olink ARPLS325" href="../ARPLS/d_apply.htm#ARPLS325"><code dir="ltr">SET_TABLE_INSTANTIATION_SCN</code></a></p>
</li>
<li>
<p><a class="olink ARPLS589" href="../ARPLS/d_apply.htm#ARPLS589"><code dir="ltr">SET_SCHEMA_INSTANTIATION_SCN</code></a></p>
</li>
<li>
<p><a class="olink ARPLS538" href="../ARPLS/d_apply.htm#ARPLS538"><code dir="ltr">SET_GLOBAL_INSTANTIATION_SCN</code></a></p>
</li>
</ul>
<p>For example, to set the instantiation SCN manually for each table in the a schema, run the <code dir="ltr">SET_SCHEMA_INSTANTIATION_SCN</code> procedure with the <code dir="ltr">recursive</code> parameter set to <code dir="ltr">TRUE</code>. If an apply process applies data definition language (DDL) changes, then set the instantiation SCN values at a level higher than table level using either the <code dir="ltr">SET_SCHEMA_INSTANTIATION_SCN</code> or <code dir="ltr">SET_GLOBAL_INSTANTIATION_SCN</code> procedure.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="instant.htm#g1012655">Chapter 8, &#34;Instantiation and Oracle Streams Replication&#34;</a> for more information about instantiation and setting instantiation SCN values</div>
</div>
<!-- class="sect2" -->
<a id="CDDBHCJF"></a>
<div id="STREP538" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Configure Conflict Resolution<a id="sthref787"></a><a id="sthref788"></a></h3>
<p>If updates will be performed at multiple databases for the same shared database object, then ensure that you configure conflict resolution for that object. To simplify conflict resolution for tables with LOB columns, create an error handler to handle errors for the table. When registering the error handler using the <code dir="ltr">DBMS_APPLY_ADM.SET_DML_HANDLER</code> procedure, ensure that you set the <code dir="ltr">assemble_lobs</code> parameter to <code dir="ltr">TRUE</code>.</p>
<p>If you configure conflict resolution at a destination database, then additional supplemental logging is required at the source database. Specifically, the columns specified in a column list for conflict resolution during apply must be conditionally logged if more than one column at the source database is used in the column list at the destination database.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="conflict.htm#g1013001">Chapter 9, &#34;Oracle Streams Conflict Resolution&#34;</a></p>
</li>
<li>
<p><a href="prep_rep.htm#i1008208">&#34;Specifying Supplemental Logging&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CDDGCHJA"></a>
<div id="STREP539" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Best Practices for Apply Process Configuration<a id="sthref789"></a><a id="sthref790"></a></h2>
<p>The following sections describe best practices for configuring apply processes:</p>
<ul>
<li>
<p><a href="#CDDDBFHD">Set Apply Process Parallelism</a></p>
</li>
<li>
<p><a href="#CDDECIHJ">Consider Allowing Apply Processes to Continue When They Encounter Errors</a></p>
</li>
</ul>
<a id="CDDDBFHD"></a>
<div id="STREP540" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Set Apply Process Parallelism<a id="sthref791"></a><a id="sthref792"></a></h3>
<p>Set the parallelism of an apply process by specifying the <code dir="ltr">parallelism</code> parameter in the <code dir="ltr">DBMS_APPLY_ADM.SET_PARAMETER</code> procedure. The <code dir="ltr">parallelism</code> parameter controls the number of processes that concurrently apply changes. The default setting for the <code dir="ltr">parallelism</code> apply process parameter is <code dir="ltr">4</code>.</p>
<p>Typically, apply process parallelism is set to either <code dir="ltr">1</code>, <code dir="ltr">4</code>, <code dir="ltr">8</code>, or <code dir="ltr">16</code>. The setting that is best for a particular apply process depends on the load applied and the processing power of the computer system running the database. Follow these guidelines when setting apply process parallelism:</p>
<ul>
<li>
<p>If the load is heavy for the apply process and the computer system running the database has excellent processing power, then set apply process parallelism to <code dir="ltr">8</code> or&nbsp;<code dir="ltr">16</code>. Multiple high-speed CPUs provide excellent processing power.</p>
</li>
<li>
<p>If the is light for the apply process, then set apply process parallelism to <code dir="ltr">1</code> or&nbsp;<code dir="ltr">4</code>.</p>
</li>
<li>
<p>If the computer system running the database has less than optimal processing power, then set apply process parallelism to <code dir="ltr">1</code> or&nbsp;<code dir="ltr">4</code>.</p>
</li>
</ul>
<p>Ensure that the <code dir="ltr">PROCESSES</code> initialization parameter is set appropriately when you set the <code dir="ltr">parallelism</code> apply process parameter.</p>
<p>In addition, if parallelism is greater than 1 for an apply process, then ensure that any database objects whose changes are applied by the apply process have the appropriate settings for the <code dir="ltr">INITRANS</code> and <code dir="ltr">PCTFREE</code> parameters. The <code dir="ltr">INITRANS</code> parameter specifies the initial number of concurrent transaction entries allocated within each data block allocated to the database object. Set the <code dir="ltr">INITRANS</code> parameter to the parallelism of the apply process or higher. The <code dir="ltr">PCTFREE</code> parameter specifies the percentage of space in each data block of the database object reserved for future updates to rows of the object. The <code dir="ltr">PCTFREE</code> parameter should be set to 10 or higher. You can modify these parameters for a table using the <code dir="ltr">ALTER</code> <code dir="ltr">TABLE</code> statement</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink STRMS004" href="../STRMS/strms_apply.htm#STRMS004"><span class="italic">Oracle Streams Concepts and Administration</span></a></p>
</li>
<li>
<p><a class="olink ARPLS314" href="../ARPLS/d_apply.htm#ARPLS314"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a></p>
</li>
<li>
<p><a class="olink SQLRF01001" href="../SQLRF/statements_3001.htm#SQLRF01001"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about the <code dir="ltr">ALTER</code> <code dir="ltr">TABLE</code> statement</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CDDECIHJ"></a>
<div id="STREP541" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Consider Allowing Apply Processes to Continue When They Encounter Errors<a id="sthref793"></a><a id="sthref794"></a></h3>
<p>When the <code dir="ltr">disable_on_error</code> apply process parameter is set to <code dir="ltr">Y</code>, the apply process is disabled on the first unresolved error, even if the error is not irrecoverable. When the <code dir="ltr">disable_on_error</code> apply process parameter is set to <code dir="ltr">N</code>, the apply process continues regardless of unresolved errors. The default setting for this parameter is <code dir="ltr">Y</code>. If you do not want an apply process to become disabled when it encounters errors, then set the <code dir="ltr">disable_on_error</code> parameter to <code dir="ltr">N</code>.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CDDHDIBG"></a>
<div id="STREP542" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Best Practices for Apply Process Operation<a id="sthref795"></a><a id="sthref796"></a></h2>
<p>The following section describes best practices for operating existing apply processes.</p>
<a id="CDDFCHCA"></a>
<div id="STREP543" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Manage Apply Errors<a id="sthref797"></a><a id="sthref798"></a></h3>
<p>The error queue contains all of the current apply errors for a database. If there are multiple apply processes in a database, then the error queue contains the apply errors for each apply process. If an apply process encounters an error when it tries to apply a logical change record (LCR) in a transaction, then all of the LCRs in the transaction are moved to the error queue. To view information about apply errors, query the <code dir="ltr">DBA_APPLY_ERROR</code> data dictionary view or use Oracle Enterprise Manager Cloud Control.</p>
<p>The <code dir="ltr">MESSAGE_NUMBER</code> column in the <code dir="ltr">DBA_APPLY_ERROR</code> view indicates the LCR within the transaction that resulted in the error. When apply errors are encountered, correct the problem(s) that caused the error(s), and either retry or delete the error transaction in the error queue.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS" href="../STRMS/toc.htm"><span class="italic">Oracle Streams Concepts and Administration</span></a> for information about <a class="olink STRMS112" href="../STRMS/strms_mapply.htm#STRMS112">managing apply errors</a> and for information about <a class="olink STRMS143" href="../STRMS/strms_apmon.htm#STRMS143">displaying detailed information for the column values of each LCR in an error transaction</a></div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment91">
<tr>
<td class="cellalignment98">
<table class="cellalignment96">
<tr>
<td class="cellalignment95"><a href="best_prop.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment95"><a href="ptrep_ap.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment100">
<table class="cellalignment94">
<tr>
<td class="cellalignment95"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment95"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment95"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment95"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment95"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment95"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>