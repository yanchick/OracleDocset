<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-104242"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Preparing%20for%20Oracle%20Streams%20Replication"></a><title>Preparing for Oracle Streams Replication</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1044"/>
<meta name="dcterms.created" content="2015-02-12T7:14:19Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Streams Replication Administrator&#39;s Guide"/>
<meta name="dcterms.identifier" content="E53118-02"/>
<meta name="dcterms.isVersionOf" content="STREP"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="ptrep_config.htm" title="Previous" type="text/html"/>
<link rel="Next" href="config_simple.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E53118-02.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">6/28</span> <!-- End Header -->
<div id="STREP011" class="chapter"><a id="g1024216"></a> <a id="i1007573"></a>
<h1 class="chapter"><span class="secnum">1</span> Preparing for Oracle Streams Replication</h1>
<p><a id="sthref6"></a><a id="sthref7"></a><a id="sthref8"></a>This chapter contains information about preparing for an Oracle Streams replication environment. This chapter also describes best practices to follow when you are preparing for an Oracle Streams replication environment.</p>
<p>This chapter contains these topics:</p>
<ul>
<li>
<p><a href="#i1007907">Overview of Oracle Streams Replication</a></p>
</li>
<li>
<p><a href="#CACJBCAE">Decisions to Make Before Configuring Oracle Streams Replication</a></p>
</li>
<li>
<p><a href="#CACGBCIB">Tasks to Complete Before Configuring Oracle Streams Replication</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS" href="../STRMS/toc.htm"><span class="italic">Oracle Streams Concepts and Administration</span></a> for general information about Oracle Streams. This document assumes that you understand the concepts described in <a class="olink STRMS" href="../STRMS/toc.htm"><span class="italic">Oracle Streams Concepts and Administration</span></a>.</div>
<a id="i1007907"></a>
<div id="STREP220" class="sect1"><a id="BABFIDJE"></a>
<h2 class="sect1">Overview of Oracle Streams Replication</h2>
<p><span class="bold">Replication</span> is the process of sharing database objects and data at multiple databases. To maintain replicated database objects and data at multiple databases, a change to one of these database objects at a database is shared with the other databases. Through this process, the database objects and data are kept synchronized at all of the databases in the replication environment. In an Oracle Streams replication environment, the database where a change originates is called the <span class="bold">source database</span>, and a database where a change is shared is called a <span class="bold">destination database</span>.</p>
<p>When you use Oracle Streams, replication of a data manipulation language (DML) or data definition language (DDL) change typically includes three steps:</p>
<a id="i1008102"></a>
<ol>
<li id="BABBFEDJ">
<p>A capture process, a synchronous capture, or an application creates one or more logical change records (LCRs) and enqueues them. An LCR is a message with a specific format that describes a database change. A capture process reformats changes captured from the redo log into LCRs, a synchronous capture uses an internal mechanism to reformat changes into LCRs, and an application can construct LCRs. If the change was a DML operation, then each row LCR encapsulates a row change resulting from the DML operation to a replicated table at the source database. If the change was a DDL operation, then a DDL LCR encapsulates the DDL change that was made to a replicated database object at a source database.</p>
</li>
<li id="i1008108">
<p>A propagation propagates the staged LCRs to another queue, which usually resides in a database that is separate from the database where the LCRs were captured. An LCR can be propagated to several different queues before it arrives at a destination database.</p>
</li>
<li id="i1008119">
<p>At a destination database, an apply process consumes the change. An apply process can dequeue the LCR and apply it directly to the replicated database object, or an apply process can dequeue the LCR and send it to an apply handler. In an Oracle Streams replication environment, an apply handler performs customized processing of an LCR. An apply handler can apply the change in the LCR to the replicated database object, or it can consume the LCR in some other way.</p>
</li>
</ol>
<p>Step <a href="#BABBFEDJ">1</a> and Step <a href="#i1008119">3</a> are required, but Step <a href="#i1008108">2</a> is optional because, in some cases, a capture process or a synchronous capture can enqueue a change into a queue, and an apply process can dequeue the change from the same queue. An application can also enqueue an LCR directly at a destination database. In addition, in a heterogeneous replication environment in which an Oracle database shares information with a non-Oracle database, an apply process can apply changes directly to a non-Oracle database without propagating LCRs.</p>
<p><a href="#i1009526">Figure 1-1</a> illustrates the information flow in an Oracle Streams replication environment.</p>
<div id="STREP221" class="figure">
<p class="titleinfigure"><a id="i1009526"></a>Figure 1-1 Oracle Streams Information Flow</p>
<img width="600" height="88" src="img/strep022.gif" alt="Description of Figure 1-1 follows"/><br/>
<a id="sthref9" href="img_text/strep022.htm">Description of &#34;Figure 1-1 Oracle Streams Information Flow&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>This document describes how to use Oracle Streams for replication and includes the following information:</p>
<ul>
<li>
<p>Conceptual information relating to Oracle Streams replication</p>
</li>
<li>
<p>Instructions for configuring an Oracle Streams replication environment</p>
</li>
<li>
<p>Instructions for administering, monitoring, and troubleshooting an Oracle Streams replication environment</p>
</li>
<li>
<p>Examples that create and maintain Oracle Streams replication environments</p>
</li>
</ul>
<p>Replication is one form of information sharing. Oracle Streams enables replication, and it also enables other forms of information sharing, such as messaging, event management and notification, data warehouse loading, and data protection.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS115" href="../STRMS/strms_over.htm#STRMS115"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information about Oracle Streams</div>
<div id="STREP591" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref10"></a>
<h3 class="sect2">Common Reasons to Use Oracle Streams Replication</h3>
<p>The following are some of the most common reasons for using Oracle Streams replication:</p>
<ul>
<li>
<p><span class="bold">Availability:</span> Replication provides fast, local access to shared data because it balances activity over multiple sites. Some users can access one server while other users access different servers, thereby reducing the load at all servers. Also, users can access data from the replication site that has the lowest access cost, which is typically the site that is geographically closest to them.</p>
</li>
<li>
<p><span class="bold">Performance and Network Load Reduction:</span> Replication provides fast, local access to shared data because it balances activity over multiple sites. Some users can access one server while other users access different servers, thereby reducing the load at all servers. Applications can access various regional servers instead of accessing one central server. This configuration can reduce network load dramatically.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<div id="STREP222" class="sect2"><a id="sthref11"></a>
<h3 class="sect2">Rules in an Oracle Streams Replication Environment<a id="sthref12"></a><a id="sthref13"></a></h3>
<p>A <span class="bold">rule</span> is a database object that enables a client to perform an action when an event occurs and a condition is satisfied. Rules are evaluated by a <span class="bold">rules engine</span>, which is a built-in part of Oracle Database. Rules control the information flow in an Oracle Streams replication environment. Each of the following components is a client of the rules engine:</p>
<ul>
<li>
<p>Capture process</p>
</li>
<li>
<p>Synchronous capture</p>
</li>
<li>
<p>Propagation</p>
</li>
<li>
<p>Apply process</p>
</li>
</ul>
<p>You control the behavior of each of these Oracle Streams clients using rules. A <span class="bold">rule set</span> contains a collection of rules. You can associate a positive and a negative rule set with a capture process, a propagation, and an apply process, but a synchronous capture can have only a positive rule set.</p>
<p>In a replication environment, an Oracle Streams client performs an action if a logical change record (LCR) satisfies its rule sets. In general, an LCR satisfies the rule sets for an Oracle Streams client if <span class="italic">no rules</span> in the negative rule set evaluate to <code dir="ltr">TRUE</code> for the LCR, and <span class="italic">at least one rule</span> in the positive rule set evaluates to <code dir="ltr">TRUE</code> for the LCR. If an Oracle Streams client is associated with both a positive and negative rule set, then the negative rule set is always evaluated first.</p>
<p>Specifically, you control the information flow in an Oracle Streams replication environment in the following ways:</p>
<ul>
<li>
<p>Specify the changes that a capture process captures from the redo log or discards. That is, if a change found in the redo log satisfies the rule sets for a capture process, then the capture process captures the change. If a change found in the redo log does not satisfy the rule sets for a capture process, then the capture process discards the change.</p>
</li>
<li>
<p>Specify the changes that a synchronous capture captures or discards. That is, if a DML change made to a table satisfies the rule set for a synchronous capture, then the synchronous capture captures the change. If a DML change made to a table does not satisfy the rule set for a synchronous capture, then the synchronous capture discards the change.</p>
</li>
<li>
<p>Specify the LCRs that a propagation propagates from one queue to another or discards. That is, if an LCR in a queue satisfies the rule sets for a propagation, then the propagation sends the LCR. If an LCR in a queue does not satisfy the rule sets for a propagation, then the propagation discards the LCR.</p>
</li>
<li>
<p>Specify the LCRs that an apply process dequeues or discards. That is, if an LCR in a queue satisfies the rule sets for an apply process, then the apply process dequeues and processes the LCR. If an LCR in a queue does not satisfy the rule sets for an apply process, then the apply process discards the&nbsp;LCR.</p>
</li>
</ul>
<p><a id="sthref14"></a>You can use the Oracle-supplied PL/SQL package <code dir="ltr">DBMS_STREAMS_ADM</code> to create rules for an Oracle Streams replication environment. You can specify these system-created rules at the following levels:</p>
<ul>
<li>
<p>Table level - Contains a rule condition that evaluates to <code dir="ltr">TRUE</code> for changes made to a particular table</p>
</li>
<li>
<p>Schema level - Contains a rule condition that evaluates to <code dir="ltr">TRUE</code> for changes made to a particular schema and the database objects in the schema</p>
</li>
<li>
<p>Global level - Contains a rule condition that evaluates to <code dir="ltr">TRUE</code> for all changes made to a database</p>
</li>
</ul>
<p>In addition, a single system-created rule can evaluate to <code dir="ltr">TRUE</code> for DML changes or for DDL changes, but not both. So, for example, to replicate both DML and DDL changes to a particular table, you need both a table-level DML rule and a table-level DDL rule for the table.</p>
<p>Oracle Streams also supports subsetting of table data with subset rules. If a replicated table in a database contains only a subset of the data, then you can configure Oracle Streams so that only the appropriate subset of the data is replicated. For example, a particular database might maintain data for employees in a particular department only. One or more other databases in the replication environment might contain all of the data in the employees table. In this case, you can use subset rules to replicate changes to the data for employees in that department with the subset table, but not changes to employees in other departments.</p>
<p>Subsetting can be done at any point in the Oracle Streams information flow. That is, a capture process or synchronous capture can use a subset rule to capture a subset of changes to a particular table, a propagation can use a subset rule to propagate a subset of changes to a particular table, and an apply process can use a subset rule to apply a subset of changes to a particular table.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Synchronous captures only use table rules. Synchronous captures ignore schema and global rules.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS006" href="../STRMS/strms_rules.htm#STRMS006"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information about how rules are used in Oracle Streams</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CACJBCAE"></a>
<div id="STREP223" class="sect1">
<h2 class="sect1">Decisions to Make Before Configuring Oracle Streams Replication</h2>
<p>Make the following decisions before configuring Oracle Streams replication:</p>
<ul>
<li>
<p><a href="#BABFCICA">Decide Which Type of Replication Environment to Configure</a></p>
</li>
<li>
<p><a href="#CACJGEFE">Decide Whether to Configure Local or Downstream Capture for the Source Database</a></p>
</li>
<li>
<p><a href="#CACDCDJG">Decide Whether Changes Are Allowed at One Database or at Multiple Databases</a></p>
</li>
<li>
<p><a href="#BABIADHG">Decide Whether the Replication Environment Will Have Nonidentical Replicas</a></p>
</li>
<li>
<p><a href="#BABBHGIH">Decide Whether the Replication Environment Will Use Apply Handlers</a></p>
</li>
<li>
<p><a href="#CACIGHCH">Decide Whether to Maintain DDL Changes</a></p>
</li>
<li>
<p><a href="#BABICDIH">Decide How to Configure the Replication Environment</a></p>
</li>
</ul>
<a id="BABFCICA"></a>
<div id="STREP224" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Decide Which Type of Replication Environment to Configure<a id="sthref15"></a><a id="sthref16"></a><a id="sthref17"></a><a id="sthref18"></a></h3>
<p>Before configuring a replication environment, first decide how many databases will be included in the replication environment, which database objects will be replicated, and how database changes will flow through the replication environment.</p>
<p>The following sections describe the most common types of replication environments:</p>
<ul>
<li>
<p><a href="#CEGJEHDJ">About Two-Database Replication Environments</a></p>
</li>
<li>
<p><a href="#CEGDHBAH">About Hub-And-Spoke Replication Environments</a></p>
</li>
<li>
<p><a href="#CEGECGDJ">About N-Way Replication Environments</a></p>
</li>
</ul>
<p>If these common replication environments do not meet your requirements, then you can configure almost any type of custom replication environment with Oracle Streams. For example, a custom replication environment might send database changes through several intermediary databases before the changes are applied at a destination database.</p>
<a id="CEGJEHDJ"></a>
<div id="STREP647" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">About Two-Database Replication Environments<a id="sthref19"></a><a id="sthref20"></a></h4>
<p>A <span class="bold">two-database replication environment</span> is one in which only two databases share the replicated database objects. The changes made to replicated database objects at one database are captured and sent directly to the other database, where they are applied. In a two-database replication environment, only one database might allow changes to the database objects, or both databases might allow changes to them.</p>
<p>If only one database allows changes to the replicated database objects, then the other database contains read-only replicas of these database objects. This is a <span class="bold">one-way replication environment</span> and typically has the following basic components:</p>
<ul>
<li>
<p>The first database has a capture process or synchronous capture to capture changes to the replicated database objects.</p>
</li>
<li>
<p>The first database has a propagation that sends the captured changes to the other database.</p>
</li>
<li>
<p>The second database has an apply process to apply changes from the first database.</p>
</li>
<li>
<p>For the best performance, each capture process and apply process has its own queue.</p>
</li>
</ul>
<p><a href="#CEGGDFBD">Figure 1-2</a> shows a two-database replication environment configured for one-way replication.</p>
<div id="STREP648" class="figure">
<p class="titleinfigure"><a id="CEGGDFBD"></a>Figure 1-2 One-Way Replication in a Two-Database Replication Environment</p>
<img width="260" height="92" src="img/strep510.gif" alt="Description of Figure 1-2 follows"/><br/>
<a id="sthref21" href="img_text/strep510.htm">Description of &#34;Figure 1-2 One-Way Replication in a Two-Database Replication Environment&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>In a two-database replication environment, both databases can allow changes to the replicated database objects. In this case, both databases capture changes to these database objects and send the changes to the other database, where they are applied. This is a <span class="bold">bi-directional replication environment</span> and typically has the following basic components:</p>
<ul>
<li>
<p>Each database has a capture process or synchronous capture to capture changes to the replicated database objects.</p>
</li>
<li>
<p>Each database has a propagation that sends the captured changes to the other database.</p>
</li>
<li>
<p>Each database has an apply process to apply changes from the other database.</p>
</li>
<li>
<p>For the best performance, each capture process and apply process has its own queue.</p>
</li>
</ul>
<p><a href="#CEGBEHCC">Figure 1-3</a> show a two-database replication environment configured for bi-directional replication.</p>
<div id="STREP649" class="figure">
<p class="titleinfigure"><a id="CEGBEHCC"></a>Figure 1-3 Bi-Directional Replication in a Two-Database Replication Environment</p>
<img width="260" height="92" src="img/strep511.gif" alt="Description of Figure 1-3 follows"/><br/>
<a id="sthref22" href="img_text/strep511.htm">Description of &#34;Figure 1-3 Bi-Directional Replication in a Two-Database Replication Environment&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>Typically, in a bi-directional replication environment, you should configure conflict resolution to keep the replicated database objects synchronized. You can configure a two-database replication environment using Setup Streams Replication Wizard in Oracle Enterprise Manager Cloud Control or the configuration procedures in the <code dir="ltr">DBMS_STREAMS_ADM</code> package.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="config_simple.htm#CIABHACH">&#34;Examples That Configure Two-Database Replication with Local Capture&#34;</a></p>
</li>
<li>
<p><a href="config_simple.htm#CIAFJECH">&#34;Examples That Configure Two-Database Replication with Downstream Capture&#34;</a></p>
</li>
<li>
<p><a href="config_simple.htm#CACCGDDC">&#34;Example That Configures Two-Database Replication with Synchronous Captures&#34;</a></p>
</li>
<li>
<p><a href="conflict.htm#g1013001">Chapter 9, &#34;Oracle Streams Conflict Resolution&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" -->
<a id="CEGDHBAH"></a>
<div id="STREP650" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">About Hub-And-Spoke Replication Environments<a id="sthref23"></a><a id="sthref24"></a></h4>
<p>A <span class="bold">hub-and-spoke replication environment</span> is one in which a central database, or hub, communicates with secondary databases, or spokes. The spokes do not communicate directly with each other. In a hub-and-spoke replication environment, the spokes might or might not allow changes to the replicated database objects.</p>
<p>If the spokes do not allow changes, then they contain read-only replicas of the database objects at the hub. This type of hub-and-spoke replication environment typically has the following basic components:</p>
<ul>
<li>
<p>The hub has a capture process or synchronous capture to capture changes to the replicated database objects.</p>
</li>
<li>
<p>The hub has propagations that send the captured changes to each of the spokes.</p>
</li>
<li>
<p>Each spoke has an apply process to apply changes from the hub.</p>
</li>
<li>
<p>For the best performance, each capture process and apply process has its own queue.</p>
</li>
</ul>
<p><a href="#CEGGEIIJ">Figure 1-4</a> shows a hub-and-spoke replication environment with read-only spokes.</p>
<div id="STREP651" class="figure">
<p class="titleinfigure"><a id="CEGGEIIJ"></a>Figure 1-4 Hub-and-Spoke Replication Environment with Read-Only Spokes</p>
<img width="260" height="357" src="img/strep502.gif" alt="Description of Figure 1-4 follows"/><br/>
<a id="sthref25" href="img_text/strep502.htm">Description of &#34;Figure 1-4 Hub-and-Spoke Replication Environment with Read-Only Spokes&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>If the spokes allow changes to the database objects, then typically the changes are captured and sent back to the hub, and the hub replicates the changes with the other spokes. This type of hub-and-spoke replication environment typically has the following basic components:</p>
<ul>
<li>
<p>The hub has a capture process or synchronous capture to capture changes to the replicated database objects.</p>
</li>
<li>
<p>The hub has propagations that send the captured changes to each of the spokes.</p>
</li>
<li>
<p>Each spoke has a capture process or synchronous capture to capture changes to the replicated database objects.</p>
</li>
<li>
<p>Each spoke has a propagation that sends changes made at the spoke back to the hub.</p>
</li>
<li>
<p>Each spoke has an apply process to apply changes from the hub and from the other spokes.</p>
</li>
<li>
<p>The hub has a separate apply process to apply changes from each spoke. A different apply process must apply changes from each spoke.</p>
</li>
<li>
<p>For the best performance, each capture process and apply process has its own queue.</p>
</li>
</ul>
<p><a href="#CEGFHGFF">Figure 1-5</a> shows a hub-and-spoke replication environment with read/write spokes.</p>
<div id="STREP652" class="figure">
<p class="titleinfigure"><a id="CEGFHGFF"></a>Figure 1-5 Hub-and-Spoke Replication Environment with Read/Write Spokes</p>
<img width="261" height="357" src="img/strep503.gif" alt="Description of Figure 1-5 follows"/><br/>
<a id="sthref26" href="img_text/strep503.htm">Description of &#34;Figure 1-5 Hub-and-Spoke Replication Environment with Read/Write Spokes&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>Typically, in a hub-and-spoke replication environment that allows changes at spoke databases, you should configure conflict resolution to keep the replicated database objects synchronized. Some hub-and-spoke replication environments allow changes to the replicated database objects at some spokes but not at others.</p>
<p>For example, an insurance company might use this configuration to share customer data between its headquarters and local sales offices. A networked version of this configuration can be especially useful in cases of limited connectivity between the end spokes and the hub. Suppose local sales offices have direct connectivity to regional offices, which in turn connect to headquarters, but the local offices have no direct connectivity to headquarters. This type of networked routing can eliminate some complexity that results when there are direct connections between all locations. The hub-and-spoke configuration is also useful in data warehousing environments, where detailed data is maintained at each store or spoke, and higher-level data can be shared with the data warehouse or hub.</p>
<p>You can configure a hub-and-spoke replication environment using the Setup Streams Replication Wizard in Oracle Enterprise Manager Cloud Control or the configuration procedures in the <code dir="ltr">DBMS_STREAMS_ADM</code> package.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="config_simple.htm#CIAFABEC">&#34;Example That Configures Hub-and-Spoke Replication&#34;</a></p>
</li>
<li>
<p><a href="conflict.htm#g1013001">Chapter 9, &#34;Oracle Streams Conflict Resolution&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" -->
<a id="CEGECGDJ"></a>
<div id="STREP653" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">About N-Way Replication Environments<a id="sthref27"></a><a id="sthref28"></a></h4>
<p>An <span class="bold">n-way replication environment</span> is one in which each database communicates directly with each other database in the environment. The changes made to replicated database objects at one database are captured and sent directly to each of the other databases in the environment, where they are applied.</p>
<p>An n-way replication environment typically has the following basic components:</p>
<ul>
<li>
<p>Each database has one or more capture processes or synchronous captures to capture changes to the replicated database objects.</p>
</li>
<li>
<p>Each database has propagations that send the captured changes to each of the other databases.</p>
</li>
<li>
<p>Each database has apply processes that apply changes from each of the other databases. A different apply process must apply changes from each source database.</p>
</li>
<li>
<p>For the best performance, each capture process and apply process has its own queue.</p>
</li>
</ul>
<p><a href="#CEGEAJGI">Figure 1-6</a> shows an n-way replication environment.</p>
<div id="STREP654" class="figure">
<p class="titleinfigure"><a id="CEGEAJGI"></a>Figure 1-6 N-Way Replication Environment</p>
<img width="260" height="225" src="img/strep501.gif" alt="Description of Figure 1-6 follows"/><br/>
<a id="sthref29" href="img_text/strep501.htm">Description of &#34;Figure 1-6 N-Way Replication Environment&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p><a id="sthref30"></a><a id="sthref31"></a><a id="sthref32"></a>You can configure an n-way replication environment by using the following Oracle-supplied packages:</p>
<ul>
<li>
<p><code dir="ltr">DBMS_STREAMS_ADM</code> can perform most of the configuration actions, including setting up queues, creating capture processes or synchronous captures, creating propagations, creating apply processes, and configuring rules and rule sets for the replication environment.</p>
</li>
<li>
<p><code dir="ltr">DBMS_CAPTURE_ADM</code> can start any capture processes you configured in the replication environment.</p>
</li>
<li>
<p><code dir="ltr">DBMS_APPLY_ADM</code> can configure apply processes, configure conflict resolution, and start apply processes, as well as other configuration tasks.</p>
</li>
</ul>
<p>An n-way configuration is frequently used by organizations that must provide scalability and availability of data. Often, these applications use a &#34;follow the sun&#34; model, with replicas located around the globe. For example, an organization might have call centers in the United States, Europe, and Asia, each with a complete copy of the customer data. Customer calls can be routed to the appropriate call center depending on the time of day. Each call center has fast, local access to the data. If a site becomes unavailable for any reason, then transactions can be routed to a surviving location. This type of configuration can also be used to provide load balancing between multiple locations.</p>
<p>Typically, in an n-way replication environment, you should configure conflict resolution to keep the replicated database objects synchronized.</p>
<p>Configuring an n-way replication environment is beyond the scope of this guide. See <a class="olink STREX004" href="../STREX/repmultdemo.htm#STREX004"><span class="italic">Oracle Streams Extended Examples</span></a> for a detailed example that configures an n-way replication environment.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="conflict.htm#g1013001">Chapter 9, &#34;Oracle Streams Conflict Resolution&#34;</a></div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CACJGEFE"></a>
<div id="STREP225" class="sect2">
<h3 class="sect2">Decide Whether to Configure Local or Downstream Capture for the Source Database<a id="sthref33"></a><a id="sthref34"></a><a id="sthref35"></a><a id="sthref36"></a><a id="sthref37"></a></h3>
<p>Local capture means that a capture process runs on the source database. Downstream capture means that a capture process runs on a database other than the source database. The primary reason to use downstream capture is to reduce the load on the source database, thereby improving its performance.</p>
<p>The database that captures changes made to the source database is called the <span class="bold">capture database</span>. One of the following databases can be the capture database:</p>
<ul>
<li>
<p>Source database (local capture)</p>
</li>
<li>
<p>Destination database (downstream capture)</p>
</li>
<li>
<p>A third database (downstream capture)</p>
</li>
</ul>
<p><a href="#CACEBJEH">Figure 1-7</a> shows the role of the capture database.</p>
<div id="STREP226" class="figure">
<p class="titleinfigure"><a id="CACEBJEH"></a>Figure 1-7 The Capture Database</p>
<img width="521" height="656" src="img/strep052.gif" alt="Description of Figure 1-7 follows"/><br/>
<a id="sthref38" href="img_text/strep052.htm">Description of &#34;Figure 1-7 The Capture Database&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>If the source database or a third database is the capture database, then a propagation sends changes from the capture database to the destination database. If the destination database is the capture database, then this propagation between databases is not needed because the capture process and apply process use the same queue.</p>
<p><a id="sthref39"></a><a id="sthref40"></a>If you decide to configure a downstream capture process, then you must decide which type of downstream capture process you want to configure. The following types are available:</p>
<ul>
<li>
<p>A <span class="bold">real-time downstream capture process</span> configuration means that redo transport services at the source database sends redo data to the downstream database, and a remote file server process (RFS) at the downstream database receives the redo data over the network and stores the redo data in the standby redo log.</p>
</li>
<li>
<p>An <span class="bold">archived-log downstream capture process</span> configuration means that archived redo log files from the source database are copied to the downstream database, and the capture process captures changes in these archived redo log files. These log files can be transferred automatically using redo transport services, or they can be transferred manually using a method such at FTP.</p>
</li>
</ul>
<p>The advantage of real-time downstream capture over archived-log downstream capture is that real-time downstream capture reduces the amount of time required to capture changes made at the source database. The time is reduced because the real-time downstream capture process does not need to wait for the redo log file to be archived before it can capture changes from it. You can configure multiple real-time downstream capture processes that captures changes from the same source database, but you cannot configure real-time downstream capture for multiple source databases at one downstream database.</p>
<p>The advantage of archived-log downstream capture over real-time downstream capture is that archived-log downstream capture allows downstream capture processes from multiple source databases at a downstream database. You can copy redo log files from multiple source databases to a single downstream database and configure multiple archived-log downstream capture processes to capture changes in these redo log files.</p>
<p>If you decide to configure a real-time downstream capture process, then you must complete the steps in <a href="#i1014093">&#34;Configuring Log File Transfer to a Downstream Capture Database&#34;</a> and <a href="#BEHEGACH">&#34;Adding Standby Redo Logs for Real-Time Downstream Capture&#34;</a>.</p>
<p>If you decide to configure an archived-log downstream capture process that uses archived redo log files that were transferred to the downstream database automatically by redo transport services, then you must complete the steps in <a href="#i1014093">&#34;Configuring Log File Transfer to a Downstream Capture Database&#34;</a>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
When the RMAN <code dir="ltr">DUPLICATE</code> or <code dir="ltr">CONVERT</code> <code dir="ltr">DATABASE</code> command is used for database instantiation with one of these procedures, the destination database cannot be the capture database.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink STRMS129" href="../STRMS/strms_capture.htm#STRMS129"><span class="italic">Oracle Streams Concepts and Administration</span></a> for information about local capture and downstream capture</p>
</li>
<li>
<p><a href="#CACDCDJG">&#34;Decide Whether Changes Are Allowed at One Database or at Multiple Databases&#34;</a></p>
</li>
<li>
<p><a href="instant.htm#BABDGBCG">&#34;Recovery Manager (RMAN) and Oracle Streams Instantiation&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CACDCDJG"></a>
<div id="STREP227" class="sect2">
<h3 class="sect2">Decide Whether Changes Are Allowed at One Database or at Multiple Databases<a id="sthref41"></a><a id="sthref42"></a><a id="sthref43"></a><a id="sthref44"></a><a id="sthref45"></a><a id="sthref46"></a></h3>
<p>A replication environment can limit changes to a particular replicated database object to one database only. In this case, the replicated database object is read/write at one database and read-only at the other databases in the replication environment. Or, a replication environment can allow changes to a replicated database object at two or more databases.</p>
<p>When two or more databases can change a replicated database object, conflicts are possible. A conflict is a mismatch between the old values in an LCR and the expected data in a table. Conflicts can occur in an Oracle Streams replication environment that permits concurrent data manipulation language (DML) operations on the same data at multiple databases. Conflicts typically result when two or more databases make changes to the same row in a replicated table at nearly the same time. If conflicts are not resolved, then they can result in inconsistent data at replica databases.</p>
<p>Typically, conflicts are possible in the following common types of replication environments:</p>
<ul>
<li>
<p>Bi-directional replication in a two database environment where the replicated database objects at both databases are read/write</p>
</li>
<li>
<p>Hub-and-spoke replication where the replicated database objects are read/write at the hub and at one or more spokes</p>
</li>
<li>
<p>N-way replication where the replicated database objects are read/write at multiple databases</p>
</li>
</ul>
<p><a href="#BABFCICA">&#34;Decide Which Type of Replication Environment to Configure&#34;</a> describes these common types of replication environments in more detail.</p>
<p>Oracle Streams provides prebuilt conflict handlers to resolve conflicts automatically. You can also build your own custom conflict handler to resolve data conflicts specific to your business rules. Such a conflict handler can be part of a procedure DML handler or an error handler.</p>
<p>If conflicts are possible in the replication environment you plan to configure, then plan to create conflict handlers to resolve these conflicts.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#BABDCFHC">&#34;Configuring Network Connectivity and Database Links&#34;</a></p>
</li>
<li>
<p><a href="#CACCBEBG">&#34;Ensuring That Each Source Database Is In ARCHIVELOG Mode&#34;</a></p>
</li>
<li>
<p><a href="conflict.htm#g1013001">Chapter 9, &#34;Oracle Streams Conflict Resolution&#34;</a></p>
</li>
<li>
<p><a href="#CACJGEFE">&#34;Decide Whether to Configure Local or Downstream Capture for the Source Database&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABIADHG"></a>
<div id="STREP228" class="sect2">
<h3 class="sect2">Decide Whether the Replication Environment Will Have Nonidentical Replicas<a id="sthref47"></a><a id="sthref48"></a><a id="sthref49"></a></h3>
<p>Oracle Streams replication supports sharing database objects that are not identical at multiple databases. Different databases in the Oracle Streams environment can contain replicated database objects with different structures. In Oracle Streams replication, a <span class="bold">rule-based transformation</span> is any modification to a logical change record (LCR) that results when a rule in a positive rule set evaluates to <code dir="ltr">TRUE</code>. You can configure rule-based transformations during capture, propagation, or apply to make any necessary changes to LCRs so that they can be applied at a destination database.</p>
<p>For example, a table at a source database can have the same data as a table at a destination database, but some column names can be different. In this case, a rule-based transformation can change the names of the columns in LCRs from the source database so that they can be applied successfully at the destination database.</p>
<p>There are two types of rule-based transformations: declarative and custom. <span class="bold">Declarative rule-based transformations</span> cover a set of common transformation scenarios for row LCRs, including renaming a schema, renaming a table, adding a column, renaming a column, keeping a list of columns, and deleting a column. You specify such a transformation using a procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package. Oracle Streams performs declarative transformations internally, without invoking PL/SQL.</p>
<p>A <span class="bold">custom rule-based transformation</span> requires a user-defined PL/SQL function to perform the transformation. Oracle Streams invokes the PL/SQL function to perform the transformation. A custom rule-based transformation can modify captured LCRs, persistent LCRs, or user messages. For example, a custom rule-based transformation can change the data type of a particular column in an LCR. A custom rule-based transformation must be defined as a PL/SQL function that takes an <code dir="ltr">ANYDATA</code> object as input and returns an <code dir="ltr">ANYDATA</code> object.</p>
<p>Rule-based transformations can be done at any point in the Oracle Streams information flow. That is, a capture process or a synchronous capture can perform a rule-based transformation on a change when a rule in its positive rule set evaluates to <code dir="ltr">TRUE</code> for the change. Similarly, a propagation or an apply process can perform a rule-based transformation on an LCR when a rule in its positive rule set evaluates to <code dir="ltr">TRUE</code> for the LCR.</p>
<p>If you plan to have nonidentical copies of database objects in your replication environment, then plan to create rule-based transformations that will modify LCRs so that they can be applied successfully at destination databases.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Throughout this document, &#34;rule-based transformation&#34; is used when the text applies to both declarative and custom rule-based transformations. This document distinguishes between the two types of rule-based transformations when necessary.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS106" href="../STRMS/strms_transform.htm#STRMS106"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information about rule-based transformations</div>
</div>
<!-- class="sect2" -->
<a id="BABBHGIH"></a>
<div id="STREP229" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Decide Whether the Replication Environment Will Use Apply Handlers<a id="sthref50"></a><a id="sthref51"></a></h3>
<p>When you use an apply handler, an apply process passes a message to either a collection of SQL statements or a user-created PL/SQL procedure for processing.</p>
<p>The following types of apply handlers are possible:</p>
<ul>
<li>
<p>A statement DML handler uses a collection of SQL statement to process row logical change records (row LCRs).</p>
</li>
<li>
<p>A procedure DML handler uses a PL/SQL procedure to process row LCRs.</p>
</li>
<li>
<p>A DDL handler uses a PL/SQL procedure to process DDL LCRs.</p>
</li>
<li>
<p>A message handler uses a PL/SQL procedure to process user messages.</p>
</li>
<li>
<p>A precommit handlers uses a PL/SQL procedure to process the commit information for a transaction.</p>
</li>
<li>
<p>An error handler uses a PL/SQL procedure to process row LCRs that have caused apply errors.</p>
</li>
</ul>
<p>An apply handler can process a message in a customized way. For example, a handler might audit the changes made to a table or enqueue an LCR into a queue after the change in the LCR has been applied. An application can then process the re-enqueued LCR. A handler might also be used to audit the changes made to a database.</p>
<p>If you must process LCRs in a customized way in your replication environment, then decide which apply handlers you should use to accomplish your goals. Next, create the PL/SQL procedures that will perform the custom processing and specify these procedures as apply handlers when your environment is configured.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS175" href="../STRMS/strms_apply.htm#STRMS175"><span class="italic">Oracle Streams Concepts and Administration</span></a></div>
</div>
<!-- class="sect2" -->
<a id="CACIGHCH"></a>
<div id="STREP163" class="sect2">
<h3 class="sect2">Decide Whether to Maintain DDL Changes<a id="sthref52"></a><a id="sthref53"></a><a id="sthref54"></a></h3>
<p>Replication environments typically maintain data manipulation language (DML) changes to the replicated database objects. DML changes include <code dir="ltr">INSERT</code>, <code dir="ltr">UPDATE</code>, <code dir="ltr">DELETE</code>, and LOB update operations. You must decide whether you want the replication environment to maintain data definition language (DDL) changes as well. Examples of statements that result in DDL changes are <code dir="ltr">CREATE</code> <code dir="ltr">TABLE</code>, <code dir="ltr">ALTER</code> <code dir="ltr">TABLE</code>, <code dir="ltr">ALTER</code> <code dir="ltr">TABLESPACE</code>, and <code dir="ltr">ALTER</code> <code dir="ltr">DATABASE</code>.</p>
<p>Some Oracle Streams replication environments assume that the database objects are the same at each database. In this case, maintaining DDL changes with Oracle Streams makes it easy to keep the shared database objects synchronized. However, some Oracle Streams replication environments require that shared database objects are different at different databases. For example, a table can have a different name or shape at two different databases. In these environments, rule-based transformations and apply handlers can modify changes so that they can be shared between databases, and you might not want to maintain DDL changes with Oracle Streams. In this case, you should make DDL changes manually at each database that required them.</p>
<p>When replicating data definition language (DDL) changes, do not allow system-generated names for constraints or indexes. Modifications to these database objects will most likely fail at the destination database because the object names at the different databases will not match. Also, storage clauses might cause problems if the destination databases are not identical. If you decide not to replicate DDL in your Oracle Streams environment, then any table structure changes must be performed manually at each database in the environment.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="config_simple.htm#CIAJGGBA">&#34;Data Definition Language (DDL) Changes&#34;</a></p>
</li>
<li>
<p><a href="#BABIADHG">&#34;Decide Whether the Replication Environment Will Have Nonidentical Replicas&#34;</a></p>
</li>
<li>
<p><a class="olink STRMS203" href="../STRMS/strms_adapply.htm#STRMS203"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information about rule-based transformations</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABICDIH"></a>
<div id="STREP230" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Decide How to Configure the Replication Environment</h3>
<p>There are three options for configuring an Oracle Streams replication environment:</p>
<ul>
<li>
<p>Run the Setup Streams Replication wizard to configure replication between two databases. You can run the wizard multiple times to configure a replication environment with more than two databases.</p>
<p>The wizard walks you through the process of configuring your replication environment, but there are some limits to the types of replication environments that can be configured with the wizard. For example, the wizard currently cannot configure synchronous capture.</p>
<p>See <a href="config_simple.htm#CACIAHGH">&#34;Configuring Replication Using the Setup Streams Replication Wizard&#34;</a> and the Oracle Enterprise Manager Cloud Control online help for more information about the replication configuration wizards.</p>
</li>
<li>
<p>Run a configuration procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> supplied PL/SQL package to configure replication between two databases. You can run the procedure multiple times to configure a replication environment with more than two databases.</p>
<p>The following procedures configure Oracle Streams replication:</p>
<ul>
<li>
<p>The <a class="olink ARPLS825" href="../ARPLS/d_streams_adm.htm#ARPLS825"><code dir="ltr">MAINTAIN_GLOBAL</code> procedure</a> configures an Oracle Streams environment that replicates changes at the database level between two databases.</p>
</li>
<li>
<p>The <a class="olink ARPLS826" href="../ARPLS/d_streams_adm.htm#ARPLS826"><code dir="ltr">MAINTAIN_SCHEMAS</code> procedure</a> configures an Oracle Streams environment that replicates changes to specified schemas between two databases.</p>
</li>
<li>
<p>The <a class="olink ARPLS863" href="../ARPLS/d_streams_adm.htm#ARPLS863"><code dir="ltr">MAINTAIN_SIMPLE_TTS</code> procedure</a> clones a simple tablespace from a source database at a destination database and uses Oracle Streams to maintain this tablespace at both databases.</p>
</li>
<li>
<p>The <a class="olink ARPLS827" href="../ARPLS/d_streams_adm.htm#ARPLS827"><code dir="ltr">MAINTAIN_TABLES</code> procedure</a> configures an Oracle Streams environment that replicates changes to specified tables between two databases.</p>
</li>
<li>
<p>The <a class="olink ARPLS864" href="../ARPLS/d_streams_adm.htm#ARPLS864"><code dir="ltr">MAINTAIN_TTS</code> procedure</a> clones a set of tablespaces from a source database at a destination database and uses Oracle Streams to maintain these tablespaces at both databases.</p>
</li>
</ul>
<p>These procedures configure multiple Oracle Streams components with a single procedure call, and they automatically follow Oracle Streams best practices. They are ideal for configuring one-way, bi-directional, and hub-and-spoke replication environments.</p>
<p>See <a href="config_simple.htm#CACJHHAA">&#34;Configuring Replication Using the DBMS_STREAMS_ADM Package&#34;</a> and <a class="olink ARPLS878" href="../ARPLS/d_streams_adm.htm#ARPLS878"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information about these procedures.</p>
</li>
<li>
<p>Configure each Oracle Streams component separately. These components include queues, capture processes, synchronous captures, propagations, and apply processes. Choose this option if you plan to configure an n-way replication environment, or if you plan to configure another type of replication environment that cannot be configured with the wizards or configuration procedures.</p>
<p>See <a href="config_flex.htm#BABBDABC">Chapter 3, &#34;Flexible Oracle Streams Replication Configuration&#34;</a> for information about configuring each component of a replication environment separately.</p>
</li>
</ul>
<p>Your configuration options might be limited by the type of replication environment you want to configure. See <a href="#BABFCICA">&#34;Decide Which Type of Replication Environment to Configure&#34;</a>.</p>
<p><a href="#BABIHAFH">Table 1-1</a> lists the configuration options that are available for each type of replication environment.</p>
<div id="STREP231" class="tblhruleformalwide">
<p class="titleintable"><a id="sthref55"></a><a id="BABIHAFH"></a>Table 1-1 Oracle Streams Replication Configuration Options</p>
<table class="cellalignment103" title="Oracle Streams Replication Configuration Options" summary="This table lists types of Oracle Streams replication environments, the configuration option for each type of environment, and more information about the configuration option." dir="ltr">
<thead>
<tr class="cellalignment92">
<th class="cellalignment104" id="r1c1-t16">Type of Replication Environment</th>
<th class="cellalignment104" id="r1c2-t16">Configuration Options and Examples</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment92">
<td class="cellalignment98" id="r2c1-t16" headers="r1c1-t16">
<p>One-way replication in a two database replication environment<a id="sthref56"></a><a id="sthref57"></a></p>
</td>
<td class="cellalignment98" headers="r2c1-t16 r1c2-t16">
<p>Setup Streams Replication Wizard in Oracle Enterprise Manager Cloud Control. Examples:</p>
<ul>
<li>
<p>&#34;Tutorial: Configuring Two-Database Replication with Local Capture Processes&#34; in the Oracle Enterprise Manager Cloud Control online help</p>
</li>
<li>
<p>&#34;Tutorial: Configuring Two-Database Replication with a Downstream Capture Process&#34; in the Oracle Enterprise Manager Cloud Control online help</p>
</li>
</ul>
<p>A configuration procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> supplied PL/SQL package. Examples:</p>
<ul>
<li>
<p><a href="config_simple.htm#CIAJEFAJ">&#34;Configuring Two-Database Schema Replication with Local Capture&#34;</a></p>
</li>
<li>
<p><a href="config_simple.htm#CACICGDG">&#34;Configuring Two-Database Table Replication with Local Capture&#34;</a></p>
</li>
<li>
<p><a href="config_simple.htm#i1015381">&#34;Configuring Tablespace Replication with Downstream Capture at Destination&#34;</a></p>
</li>
<li>
<p><a href="config_simple.htm#CIAFFGIH">&#34;Configuring Schema Replication with Downstream Capture at Destination&#34;</a></p>
</li>
</ul>
<p>Configure each Oracle Streams component individually. Examples:</p>
<ul>
<li>
<p><a class="olink STREX" href="../STREX/toc.htm"><span class="italic">Oracle Streams Extended Examples</span></a></p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment92">
<td class="cellalignment98" id="r3c1-t16" headers="r1c1-t16">
<p>Bi-directional replication in a two database replication environment<a id="sthref58"></a><a id="sthref59"></a></p>
</td>
<td class="cellalignment98" headers="r3c1-t16 r1c2-t16">
<p>Setup Streams Replication Wizard in Oracle Enterprise Manager Cloud Control. Example:</p>
<ul>
<li>
<p>&#34;Tutorial: Configuring Two-Database Replication with Local Capture Processes&#34; in the Oracle Enterprise Manager Cloud Control online help</p>
</li>
</ul>
<p>A configuration procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> supplied PL/SQL package. Examples:</p>
<ul>
<li>
<p><a href="config_simple.htm#CACGFIJH">&#34;Configuring Two-Database Global Replication with Local Capture&#34;</a></p>
</li>
<li>
<p><a href="config_simple.htm#CIAJEFAJ">&#34;Configuring Two-Database Schema Replication with Local Capture&#34;</a></p>
</li>
<li>
<p><a href="config_simple.htm#CACHEGGE">&#34;Configuring Schema Replication with Downstream Capture at Third Database&#34;</a></p>
</li>
</ul>
<p>Configure each Oracle Streams component individually. Example:</p>
<ul>
<li>
<p><a href="config_simple.htm#CACCGDDC">&#34;Example That Configures Two-Database Replication with Synchronous Captures&#34;</a></p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment92">
<td class="cellalignment98" id="r4c1-t16" headers="r1c1-t16">
<p>Hub-and-spoke replication with a read/write hub and read-only spokes<a id="sthref60"></a><a id="sthref61"></a></p>
</td>
<td class="cellalignment98" headers="r4c1-t16 r1c2-t16">
<p>A configuration procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> supplied PL/SQL package.</p>
<p>Configure each Oracle Streams component individually.</p>
</td>
</tr>
<tr class="cellalignment92">
<td class="cellalignment98" id="r5c1-t16" headers="r1c1-t16">
<p>Hub-and-spoke replication with a read/write hub and one or more read/write spokes</p>
</td>
<td class="cellalignment98" headers="r5c1-t16 r1c2-t16">
<p>Setup Streams Replication Wizard in Oracle Enterprise Manager Cloud Control. Example:</p>
<ul>
<li>
<p>&#34;Tutorial: Configuring Hub-and-Spoke Replication with Local Capture Processes&#34; in the Oracle Enterprise Manager Cloud Control online help</p>
</li>
</ul>
<p>A configuration procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> supplied PL/SQL package. Example:</p>
<ul>
<li>
<p><a href="config_simple.htm#CIAFABEC">&#34;Example That Configures Hub-and-Spoke Replication&#34;</a></p>
</li>
</ul>
<p>Configure each Oracle Streams component individually.</p>
</td>
</tr>
<tr class="cellalignment92">
<td class="cellalignment98" id="r6c1-t16" headers="r1c1-t16">
<p>N-way replication with multiple read/write databases<a id="sthref62"></a><a id="sthref63"></a></p>
</td>
<td class="cellalignment98" headers="r6c1-t16 r1c2-t16">
<p>Configure each Oracle Streams component individually. Example:</p>
<ul>
<li>
<p><a class="olink STREX004" href="../STREX/repmultdemo.htm#STREX004"><span class="italic">Oracle Streams Extended Examples</span></a></p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment92">
<td class="cellalignment98" id="r7c1-t16" headers="r1c1-t16">
<p>Custom replication environment</p>
</td>
<td class="cellalignment98" headers="r7c1-t16 r1c2-t16">
<p>Configure each Oracle Streams component individually. See <a href="config_flex.htm#BABBDABC">Chapter 3, &#34;Flexible Oracle Streams Replication Configuration&#34;</a> for instructions. Examples:</p>
<ul>
<li>
<p><a class="olink STREX" href="../STREX/toc.htm"><span class="italic">Oracle Streams Extended Examples</span></a></p>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblhruleformalwide" -->
<p>Before configuring the replication environment, complete the tasks in <a href="#CACGBCIB">&#34;Tasks to Complete Before Configuring Oracle Streams Replication&#34;</a>.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CACGBCIB"></a>
<div id="STREP232" class="sect1">
<h2 class="sect1">Tasks to Complete Before Configuring Oracle Streams Replication</h2>
<p>The following sections describe tasks to complete before configuring Oracle Streams replication:</p>
<ul>
<li>
<p><a href="#BABHEJGG">Configuring an Oracle Streams Administrator on All Databases</a></p>
</li>
<li>
<p><a href="#BABDCFHC">Configuring Network Connectivity and Database Links</a></p>
</li>
<li>
<p><a href="#CACCBEBG">Ensuring That Each Source Database Is In ARCHIVELOG Mode</a></p>
</li>
<li>
<p><a href="#BABFJJIH">Setting Initialization Parameters Relevant to Oracle Streams</a></p>
</li>
<li>
<p><a href="#BABBFJEB">Configuring the Oracle Streams Pool</a></p>
</li>
<li>
<p><a href="#i1008208">Specifying Supplemental Logging</a></p>
</li>
<li>
<p><a href="#i1014093">Configuring Log File Transfer to a Downstream Capture Database</a></p>
</li>
<li>
<p><a href="#BEHEGACH">Adding Standby Redo Logs for Real-Time Downstream Capture</a></p>
</li>
</ul>
<a id="BABHEJGG"></a>
<div id="STREP200" class="sect2">
<h3 class="sect2">Configuring an Oracle Streams Administrator on All Databases</h3>
<p>To configure and manage an Oracle Streams environment, either create a new user with the appropriate privileges or grant these privileges to an existing user. You should not use the <code dir="ltr">SYS</code> or <code dir="ltr">SYSTEM</code> user as an Oracle Streams administrator, and the Oracle Streams administrator should not use the <code dir="ltr">SYSTEM</code> tablespace as its default tablespace.</p>
<p>Typically, the user name for the Oracle Streams administrator is <code dir="ltr">strmadmin</code>, but any user with the proper privileges can be an Oracle Streams administrator. The examples in this section use <code dir="ltr">strmadmin</code> for the Oracle Streams administrator user name.</p>
<p>Create a separate tablespace for the Oracle Streams administrator at each participating Oracle Streams database. This tablespace stores any objects created in the Oracle Streams administrator schema, including any spillover of messages from the buffered queues owned by the schema.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
The Oracle Enterprise Manager Cloud Control online help for instructions about creating an Oracle Streams administrator using Oracle Enterprise Manager Cloud Control</div>
<p>Complete the following steps to configure an Oracle Streams administrator at each database in the environment that will use Oracle Streams:</p>
<ol>
<li>
<p>In SQL*Plus, connect as an administrative user who can create users, grant privileges, and create tablespaces. Remain connected as this administrative user for all subsequent steps.</p>
<p>See <a class="olink ADMIN00102" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=ADMIN00102"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about connecting to a database in SQL*Plus.</p>
</li>
<li>
<p>Either create a tablespace for the Oracle Streams administrator or use an existing tablespace. For example, the following statement creates a new tablespace for the Oracle Streams administrator:</p>
<pre dir="ltr">CREATE TABLESPACE streams_tbs DATAFILE &#39;/usr/oracle/dbs/streams_tbs.dbf&#39; 
  SIZE 25M REUSE AUTOEXTEND ON MAXSIZE UNLIMITED;
</pre></li>
<li id="i1011116">
<p>Create a new user to act as the Oracle Streams administrator or use an existing user. For example, to create a user named <code dir="ltr">strmadmin</code> and specify that this user uses the <code dir="ltr">streams_tbs</code> tablespace, run the following statement:</p>
<pre dir="ltr">CREATE USER strmadmin IDENTIFIED BY <span class="italic">password</span> 
   DEFAULT TABLESPACE streams_tbs
   QUOTA UNLIMITED ON streams_tbs;
</pre>
<div class="infobox-note">
<p class="notep1"><span class="bold">Note</span>:</p>
Enter an appropriate password for the administrative user.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink DBSEG33223" href="../DBSEG/authentication.htm#DBSEG33223"><span class="italic">Oracle Database Security Guide</span></a> for guidelines for choosing passwords</div>
</li>
<li>
<p>Grant the Oracle Streams administrator <code dir="ltr">DBA</code> role:</p>
<pre dir="ltr">GRANT DBA TO strmadmin;
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
The <code dir="ltr">DBA</code> role is required for a user to create or alter capture processes, synchronous captures, and apply processes. When the user does not need to perform these tasks, <code dir="ltr">DBA</code> role can be revoked from the user.</div>
</li>
<li id="BABDBGJE">
<p>Run the <code dir="ltr">GRANT_ADMIN_PRIVILEGE</code> procedure in the <code dir="ltr">DBMS_STREAMS_AUTH</code> package.</p>
<p>A user must have explicit <code dir="ltr">EXECUTE</code> privilege on a package to execute a subprogram in the package inside of a user-created subprogram, and a user must have explicit <code dir="ltr">READ</code> or <code dir="ltr">SELECT</code> privilege on a data dictionary view to query the view inside of a user-created subprogram. These privileges cannot be through a role. You can run the <code dir="ltr">GRANT_ADMIN_PRIVILEGE</code> procedure to grant such privileges to the Oracle Streams administrator, or you can grant them directly.</p>
<p>Depending on the parameter settings for the <code dir="ltr">GRANT_ADMIN_PRIVILEGE</code> procedure, it either grants the privileges for an Oracle Streams administrator directly, or it generates a script that you can edit and then run to grant these privileges.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ARPLS515" href="../ARPLS/d_streams_aut.htm#ARPLS515"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information about this procedure</div>
<p><span class="bold">Use the</span> <span class="bold">GRANT_ADMIN_PRIVILEGE</span> <span class="bold">procedure to grant privileges directly:</span></p>
<p>Run the following procedure:</p>
<pre dir="ltr">BEGIN
  DBMS_STREAMS_AUTH.GRANT_ADMIN_PRIVILEGE(
    grantee          =&gt; &#39;strmadmin&#39;,    
    grant_privileges =&gt; TRUE);
END;
/
</pre>
<p><span class="bold">Use the</span> <span class="bold">GRANT_ADMIN_PRIVILEGE</span> <span class="bold">procedure to generate a script:</span></p>
<p>Complete the following steps:</p>
<a id="i1009333"></a>
<ol>
<li id="BABIJJBA">
<p>Use the SQL statement <code dir="ltr">CREATE</code> <code dir="ltr">DIRECTORY</code> to create a directory object for the directory into which you want to generate the script. A directory object is similar to an alias for the directory. For example, to create a directory object called <code dir="ltr">strms_dir</code> for the <code dir="ltr">/usr/admin</code> directory on your computer system, run the following procedure:</p>
<pre dir="ltr">CREATE DIRECTORY strms_dir AS &#39;/usr/admin&#39;;
</pre></li>
<li>
<p>Run the <code dir="ltr">GRANT_ADMIN_PRIVILEGE</code> procedure to generate a script named <code dir="ltr">grant_strms_privs.sql</code> and place this script in the <code dir="ltr">/usr/admin</code> directory on your computer system:</p>
<pre dir="ltr">BEGIN
  DBMS_STREAMS_AUTH.GRANT_ADMIN_PRIVILEGE(
    grantee          =&gt; &#39;strmadmin&#39;,    
    grant_privileges =&gt; FALSE,
    file_name        =&gt; &#39;grant_strms_privs.sql&#39;,
    directory_name   =&gt; &#39;strms_dir&#39;);
END;
/
</pre>
<p>Notice that the <code dir="ltr">grant_privileges</code> parameter is set to <code dir="ltr">FALSE</code> so that the procedure does not grant the privileges directly. Also, notice that the directory object created in Step <a href="#BABIJJBA">a</a> is specified for the <code dir="ltr">directory_name</code> parameter.</p>
</li>
<li>
<p>Edit the generated script if necessary and save your changes.</p>
</li>
<li>
<p>Execute the script in SQL*Plus:</p>
<pre dir="ltr">SET ECHO ON
SPOOL grant_strms_privs.out
@/usr/admin/grant_strms_privs.sql
SPOOL OFF
</pre></li>
<li>
<p>Check the spool file to ensure that all of the grants executed successfully. If there are errors, then edit the script to correct the errors and rerun it.</p>
</li>
</ol>
</li>
<li>
<p>If necessary, grant the following additional privileges:</p>
<ul>
<li>
<p>If you plan to use Oracle Enterprise Manager Cloud Control to manage databases with Oracle Streams components, then configure the Oracle Streams administrator to be an Oracle Enterprise Manager administrative user. Doing so grants additional privileges required by Oracle Enterprise Manager Cloud Control, such as the privileges required to run Oracle Enterprise Manager Cloud Control jobs. See the Oracle Enterprise Manager Cloud Control online help for information about creating Oracle Enterprise Manager administrative users.</p>
</li>
<li>
<p>Grant the privileges for a remote Oracle Streams administrator to perform actions in the local database. Grant these privileges using the <code dir="ltr">GRANT_REMOTE_ADMIN_ACCESS</code> procedure in the <code dir="ltr">DBMS_STREAMS_AUTH</code> package. Grant this privilege if a remote Oracle Streams administrator will use a database link that connects to the local Oracle Streams administrator to perform administrative actions. Specifically, grant these privileges if either of the following conditions are true:</p>
<ul>
<li>
<p>You plan to configure a downstream capture process at a remote downstream database that captures changes originating at the local source database, and the downstream capture process will use a database link to perform administrative actions at the source database.</p>
</li>
<li>
<p>You plan to configure an apply process at the local database and use a remote Oracle Streams administrator to set the instantiation SCN values for replicated database objects at the local database.</p>
</li>
</ul>
</li>
<li>
<p>If no apply user is specified for an apply process, then grant the Oracle Streams administrator the necessary privileges to perform DML and DDL changes on the apply objects owned by other users. If an apply user is specified, then the apply user must have these privileges. These privileges can be granted directly or through a role.</p>
</li>
<li>
<p>If no apply user is specified for an apply process, then grant the Oracle Streams administrator <code dir="ltr">EXECUTE</code> privilege on any PL/SQL subprogram owned by another user that is executed by an Oracle Streams apply process. These subprograms can be used in apply handlers or error handlers. If an apply user is specified, then the apply user must have these privileges. These privileges must be granted directly. They cannot be granted through a role.</p>
</li>
<li>
<p>Grant the Oracle Streams administrator <code dir="ltr">EXECUTE</code> privilege on any PL/SQL function owned by another user that is specified in a custom rule-based transformation for a rule used by an Oracle Streams capture process, synchronous capture, propagation, apply process, or messaging client. For a capture process or synchronous capture, if a capture user is specified, then the capture user must have these privileges. For an apply process, if an apply user is specified, then the apply user must have these privileges. These privileges must be granted directly. They cannot be granted through a role.</p>
</li>
<li>
<p>Grant the Oracle Streams administrator privileges to alter database objects where appropriate. For example, if the Oracle Streams administrator must create a supplemental log group for a table in another schema, then the Oracle Streams administrator must have the necessary privileges to alter the table. These privileges can be granted directly or through a role.</p>
</li>
<li>
<p>If the Oracle Streams administrator does not own the queue used by an Oracle Streams capture process, synchronous capture, propagation, apply process, or messaging client, and is not specified as the queue user for the queue when the queue is created, then the Oracle Streams administrator must be configured as a secure queue user of the queue if you want the Oracle Streams administrator to be able to enqueue messages into or dequeue messages from the queue. The Oracle Streams administrator might also need <code dir="ltr">ENQUEUE</code> or <code dir="ltr">DEQUEUE</code> privileges on the queue, or both. See <a class="olink STRMS101" href="../STRMS/strms_mprop.htm#STRMS101"><span class="italic">Oracle Streams Concepts and Administration</span></a> for information about managing queues.</p>
</li>
<li>
<p>Grant the Oracle Streams administrator <code dir="ltr">EXECUTE</code> privilege on any object types that the Oracle Streams administrator might need to access. These privileges can be granted directly or through a role.</p>
</li>
<li>
<p>If the Oracle Streams administrator will use Data Pump to perform export and import operations on database objects in other schemas during an Oracle Streams instantiation, then grant the <code dir="ltr">EXP_FULL_DATABASE</code> and <code dir="ltr">IMP_FULL_DATABASE</code> roles to the Oracle Streams administrator.</p>
</li>
<li>
<p>If Oracle Database Vault is installed, then the user who performs the following actions must be granted the <code dir="ltr">BECOME</code> <code dir="ltr">USER</code> system privilege:</p>
<ul>
<li>
<p>Creates or alters a capture process</p>
</li>
<li>
<p>Creates or alters an apply process</p>
</li>
</ul>
<p>Granting the <code dir="ltr">BECOME</code> <code dir="ltr">USER</code> system privilege to the user who performs these actions is not required if Oracle Database Vault is not installed. You can revoke the <code dir="ltr">BECOME</code> <code dir="ltr">USER</code> system privilege from the user after the completing one of these actions, if necessary.</p>
</li>
</ul>
</li>
<li>
<p>Repeat all of the previous steps at each database in the environment that will use Oracle Streams.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="best_capture.htm#CFHHEDCA">&#34;Grant the Required Privileges to the Capture User&#34;</a></p>
</li>
<li>
<p><a href="best_apply.htm#CDDGIFIF">&#34;Grant Required Privileges to the Apply User&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABDCFHC"></a>
<div id="STREP203" class="sect2">
<h3 class="sect2">Configuring Network Connectivity and Database Links<a id="sthref64"></a><a id="sthref65"></a></h3>
<p>If you plan to use Oracle Streams to share information between databases, then configure network connectivity and database links between these databases:</p>
<ul>
<li>
<p>For Oracle databases, configure your network and Oracle Net so that the databases can communicate with each other.</p>
</li>
<li>
<p>For non-Oracle databases, configure an Oracle Database Gateway for communication between the Oracle database and the non-Oracle database.</p>
</li>
<li>
<p>If you plan to propagate messages from a source queue at a database to a destination queue at another database, then create a private database link between the database containing the source queue and the database containing the destination queue. Each database link should use a <code dir="ltr">CONNECT</code> <code dir="ltr">TO</code> clause for the user propagating messages between databases.</p>
</li>
</ul>
<p>A database link from the source database to the destination database is always required. The name of the database link must match the global name of the destination database.</p>
<p>A database link from the destination database to the source database is required in any of the following cases:</p>
<ul>
<li>
<p>The Oracle Streams replication environment will be bi-directional.</p>
</li>
<li>
<p>A Data Pump network import will be performed during instantiation.</p>
</li>
<li>
<p>The destination database is the capture database for downstream capture of source database changes.</p>
</li>
<li>
<p>The RMAN <code dir="ltr">DUPLICATE</code> or <code dir="ltr">CONVERT</code> <code dir="ltr">DATABASE</code> command will be used for database instantiation.</p>
<p>This database link is required because the <code dir="ltr">POST_INSTANTIATION_SETUP</code> procedure with a non-<code dir="ltr">NULL</code> setting for the <code dir="ltr">instantiation_scn</code> parameter runs the <code dir="ltr">SET_GLOBAL_INSTANTIATION_SCN</code> procedure in the <code dir="ltr">DBMS_APPLY_ADM</code> package at the destination database. The <code dir="ltr">SET_GLOBAL_INSTANTIATION_SCN</code> procedure requires the database link. This database link must be created after the RMAN instantiation and before running the <code dir="ltr">POST_INSTANTIATION_SETUP</code> procedure.</p>
</li>
</ul>
<p>In each of these cases, the name of the database link must match the global name of the source database.</p>
<p>If a third database is the capture database for downstream capture of source database changes, then the following database links are also required:</p>
<ul>
<li>
<p>A database link is required from the third database to the source database. The name of the database link must match the global name of the source database.</p>
</li>
<li>
<p>A database link is required from the third database to the destination database. The name of the database link must match the global name of the destination database.</p>
</li>
</ul>
<p>Each database link should be created in the Oracle Streams administrator&#39;s schema. For example, if the global name of the source database is <code dir="ltr">dbs1.example.com</code>, the global name of the destination database is <code dir="ltr">dbs2.example.com</code>, and the Oracle Streams administrator is <code dir="ltr">strmadmin</code> at each database, then the following statement creates the database link from the source database to the destination database:</p>
<pre dir="ltr">CONNECT strmadmin@dbs1.example.com
Enter password: <span class="italic">password</span>

CREATE DATABASE LINK dbs2.example.com CONNECT TO strmadmin 
   IDENTIFIED BY <span class="italic">password</span> USING &#39;dbs2.example.com&#39;;
</pre>
<p>If a database link is required from the destination database to the source database, then the following statement creates this database link:</p>
<pre dir="ltr">CONNECT strmadmin@dbs2.example.com
Enter password: <span class="italic">password</span>

CREATE DATABASE LINK dbs1.example.com CONNECT TO strmadmin 
   IDENTIFIED BY <span class="italic">password</span> USING &#39;dbs1.example.com&#39;;
</pre>
<p>If a third database is the capture database, then a database link is required from the third database to the source and destination databases. For example, if the third database is <code dir="ltr">dbs3.example.com</code>, then the following statements create the database links from the third database to the source and destination databases:</p>
<pre dir="ltr">CONNECT strmadmin@dbs3.example.com
Enter password: <span class="italic">password</span>

CREATE DATABASE LINK dbs1.example.com CONNECT TO strmadmin 
   IDENTIFIED BY <span class="italic">password</span> USING &#39;dbs1.example.com&#39;;

CREATE DATABASE LINK dbs2.example.com CONNECT TO strmadmin 
   IDENTIFIED BY <span class="italic">password</span> USING &#39;dbs2.example.com&#39;;
</pre>
<p>If an RMAN database instantiation is performed, then the database link at the source database is copied to the destination database during instantiation. This copied database link should be dropped at the destination database. In this case, if the replication is bi-directional, and a database link from the destination database to the source database is required, then this database link should be created after the instantiation.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink ADMIN029" href="../ADMIN/ds_admin.htm#ADMIN029"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for more information about database links</p>
</li>
<li>
<p><a class="olink HETER" href="../HETER/toc.htm"><span class="italic">Oracle Database Heterogeneous Connectivity User&#39;s Guide</span></a> for information about communication between an Oracle database and a non-Oracle database</p>
</li>
<li>
<p><a href="#CACDCDJG">&#34;Decide Whether Changes Are Allowed at One Database or at Multiple Databases&#34;</a></p>
</li>
<li>
<p><a href="#CACJGEFE">&#34;Decide Whether to Configure Local or Downstream Capture for the Source Database&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CACCBEBG"></a>
<div id="STREP233" class="sect2">
<h3 class="sect2">Ensuring That Each Source Database Is In ARCHIVELOG Mode<a id="sthref66"></a><a id="sthref67"></a></h3>
<p>In an Oracle Streams replication environment, each source database that generates changes that will be captured by a capture process must be in <code dir="ltr">ARCHIVELOG</code> mode. For downstream capture processes, the downstream database also must run in <code dir="ltr">ARCHIVELOG</code> mode if you plan to configure a real-time downstream capture process. The downstream database does not need to run in <code dir="ltr">ARCHIVELOG</code> mode if you plan to run only archived-log downstream capture processes on it.</p>
<p>If you are configuring Oracle Streams in an Oracle Real Application Clusters (Oracle RAC) environment, then the archive log files of all threads from all instances must be available to any instance running a capture process. This requirement pertains to both local and downstream capture processes.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Synchronous capture does not require <code dir="ltr">ARCHIVELOG</code> mode.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink ADMIN008" href="../ADMIN/archredo.htm#ADMIN008"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for instructions about running a database in <code dir="ltr">ARCHIVELOG</code> mode</p>
</li>
<li>
<p><a href="#CACDCDJG">&#34;Decide Whether Changes Are Allowed at One Database or at Multiple Databases&#34;</a></p>
</li>
<li>
<p><a href="#CACJGEFE">&#34;Decide Whether to Configure Local or Downstream Capture for the Source Database&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABFJJIH"></a>
<div id="STREP201" class="sect2">
<h3 class="sect2">Setting Initialization Parameters Relevant to Oracle Streams<a id="sthref68"></a></h3>
<p>Some initialization parameters are important for the configuration, operation, reliability, and performance of an Oracle Streams environment. Set these parameters appropriately for your Oracle Streams environment.</p>
<p><a href="#g1013089">Table 1-2</a> describes the initialization parameters that are relevant to Oracle Streams. This table specifies whether each parameter is modifiable. A modifiable initialization parameter can be modified using the <code dir="ltr">ALTER</code> <code dir="ltr">SYSTEM</code> statement while an instance is running. Some modifiable parameters can also be modified for a single session using the <code dir="ltr">ALTER</code> <code dir="ltr">SESSION</code> statement.</p>
<div id="STREP234" class="tblhruleformalwide">
<p class="titleintable"><a id="sthref69"></a><a id="g1013089"></a>Table 1-2 Initialization Parameters Relevant to Oracle Streams</p>
<table class="cellalignment103" title="Initialization Parameters Relevant to Oracle Streams " summary="This table lists the initialization parameters that are relevant to Streams. For each parameter, the table lists the possible values and a description." dir="ltr">
<thead>
<tr class="cellalignment92">
<th class="cellalignment104" id="r1c1-t26">Parameter</th>
<th class="cellalignment104" id="r1c2-t26">Values</th>
<th class="cellalignment104" id="r1c3-t26">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment92">
<td class="cellalignment98" id="r2c1-t26" headers="r1c1-t26">
<p><a class="olink REFRN10065" href="../REFRN/GUID-221D0483-D814-4963-84E1-7D39A25048ED.htm#REFRN10065"><code dir="ltr">GLOBAL_NAMES</code></a><a id="sthref70"></a><a id="sthref71"></a></p>
</td>
<td class="cellalignment98" headers="r2c1-t26 r1c2-t26">
<p><a id="i1006385"></a><span class="bold">Default:</span> <code dir="ltr">false</code></p>
<p><span class="bold">Range:</span> <code dir="ltr">true</code> or <code dir="ltr">false</code></p>
<p><span class="bold">Modifiable?:</span> Yes</p>
</td>
<td class="cellalignment98" headers="r2c1-t26 r1c3-t26">
<p>Specifies whether a database link is required to have the same name as the database to which it connects.</p>
<p>To use Oracle Streams to share information between databases, set this parameter to <code dir="ltr">true</code> at each database that is participating in your Oracle Streams environment.</p>
</td>
</tr>
<tr class="cellalignment92">
<td class="cellalignment98" id="r3c1-t26" headers="r1c1-t26">
<p><a class="olink REFRN10237" href="../REFRN/GUID-4DABDBE9-04B6-44D2-B93D-DAB15EA71427.htm#REFRN10237"><code dir="ltr">LOG_ARCHIVE_CONFIG</code></a><a id="sthref72"></a><a id="sthref73"></a></p>
</td>
<td class="cellalignment98" headers="r3c1-t26 r1c2-t26">
<p><span class="bold">Default:</span> <code dir="ltr">&#39;SEND, RECEIVE, NODG_CONFIG&#39;</code></p>
<p><span class="bold">Range</span>: Values:</p>
<ul>
<li>
<p><code dir="ltr">SEND</code></p>
</li>
<li>
<p><code dir="ltr">NOSEND</code></p>
</li>
<li>
<p><code dir="ltr">RECEIVE</code></p>
</li>
<li>
<p><code dir="ltr">NORECEIVE</code></p>
</li>
<li>
<p><code dir="ltr">DG_CONFIG</code></p>
</li>
<li>
<p><code dir="ltr">NODG_CONFIG</code></p>
</li>
</ul>
<p><span class="bold">Modifiable?:</span> Yes</p>
</td>
<td class="cellalignment98" headers="r3c1-t26 r1c3-t26">
<p>Enables or disables the sending of redo logs to remote destinations and the receipt of remote redo logs, and specifies the unique database names (<code dir="ltr">DB_UNIQUE_NAME</code>) for each database in the Data Guard configuration</p>
<p>To use downstream capture and copy the redo data to the downstream database using redo transport services, specify the <code dir="ltr">DB_UNIQUE_NAME</code> of the source database and the downstream database using the <code dir="ltr">DG_CONFIG</code> attribute. This parameter must be set at both the source database and the downstream database.</p>
</td>
</tr>
<tr class="cellalignment92">
<td class="cellalignment98" id="r4c1-t26" headers="r1c1-t26">
<p><a class="olink REFRN10086" href="../REFRN/GUID-10BD97BF-6295-4E85-A1A3-854E15E05A44.htm#REFRN10086"><code dir="ltr">LOG_ARCHIVE_DEST_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code></a><a id="sthref74"></a><a id="sthref75"></a></p>
</td>
<td class="cellalignment98" headers="r4c1-t26 r1c2-t26">
<p><span class="bold">Default:</span> None</p>
<p><span class="bold">Range</span>: None</p>
<p><span class="bold">Modifiable?:</span> Yes</p>
</td>
<td class="cellalignment98" headers="r4c1-t26 r1c3-t26">
<p>Defines up to 31 log archive destinations, where <code dir="ltr"><span class="codeinlineitalic">n</span></code> is <code dir="ltr">1</code>, <code dir="ltr">2</code>, <code dir="ltr">3</code>, ... <code dir="ltr">31</code>.</p>
<p>To use downstream capture and copy the redo data to the downstream database using redo transport services, at least one log archive destination must be set at the site running the downstream capture process.</p>
</td>
</tr>
<tr class="cellalignment92">
<td class="cellalignment98" id="r5c1-t26" headers="r1c1-t26">
<p><a class="olink REFRN10087" href="../REFRN/GUID-983A9C52-3046-4286-AEA7-800741EE0561.htm#REFRN10087"><code dir="ltr">LOG_ARCHIVE_DEST_STATE_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code></a><a id="sthref76"></a><a id="sthref77"></a></p>
</td>
<td class="cellalignment98" headers="r5c1-t26 r1c2-t26">
<p><span class="bold">Default:</span> <code dir="ltr">enable</code></p>
<p><span class="bold">Range</span>: One of the following:</p>
<ul>
<li>
<p><code dir="ltr">alternate</code></p>
</li>
<li>
<p><code dir="ltr">defer</code></p>
</li>
<li>
<p><code dir="ltr">enable</code></p>
</li>
</ul>
<p><span class="bold">Modifiable?:</span> Yes</p>
</td>
<td class="cellalignment98" headers="r5c1-t26 r1c3-t26">
<p>Specifies the availability state of the corresponding destination. The parameter suffix (<code dir="ltr">1</code> through <code dir="ltr">31</code>) specifies one of the corresponding <code dir="ltr">LOG_ARCHIVE_DEST_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code> destination parameters.</p>
<p>To use downstream capture and copy the redo data to the downstream database using redo transport services, ensure that the destination that corresponds to the <code dir="ltr">LOG_ARCHIVE_DEST_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code> destination for the downstream database is set to <code dir="ltr">enable</code>.</p>
</td>
</tr>
<tr class="cellalignment92">
<td class="cellalignment98" id="r6c1-t26" headers="r1c1-t26">
<p><a class="olink REFRN10094" href="../REFRN/GUID-17321A45-A53E-42E3-8367-4B13FB5EACA3.htm#REFRN10094"><code dir="ltr">LOG_BUFFER</code></a><a id="sthref78"></a><a id="sthref79"></a></p>
</td>
<td class="cellalignment98" headers="r6c1-t26 r1c2-t26">
<p><span class="bold">Default:</span> <code dir="ltr">5</code> <code dir="ltr">MB</code> to <code dir="ltr">32</code> <code dir="ltr">MB</code> depending on configuration</p>
<p><span class="bold">Range:</span> Operating system-dependent</p>
<p><span class="bold">Modifiable?:</span> No</p>
</td>
<td class="cellalignment98" headers="r6c1-t26 r1c3-t26">
<p>Specifies the amount of memory (in bytes) that Oracle uses when buffering redo entries to a redo log file. Redo log entries contain a record of the changes that have been made to the database block buffers.</p>
<p>If an Oracle Streams capture process is running on the database, then set this parameter properly so that the capture process reads redo log records from the redo log buffer rather than from the hard disk.</p>
</td>
</tr>
<tr class="cellalignment92">
<td class="cellalignment98" id="r7c1-t26" headers="r1c1-t26">
<p><a class="olink REFRN10284" href="../REFRN/GUID-C72F25D8-5CB1-4113-B3FA-14CE390E8F60.htm#REFRN10284"><code dir="ltr">MEMORY_MAX_TARGET</code></a><a id="sthref80"></a><a id="sthref81"></a></p>
</td>
<td class="cellalignment98" headers="r7c1-t26 r1c2-t26">
<p><span class="bold">Default:</span> <code dir="ltr">0</code></p>
<p><span class="bold">Range:</span> <code dir="ltr">0</code> to the physical memory size available to Oracle Database</p>
<p><span class="bold">Modifiable?:</span> No</p>
</td>
<td class="cellalignment98" headers="r7c1-t26 r1c3-t26">
<p>Specifies the maximum systemwide usable memory for an Oracle database.</p>
<p>If the <code dir="ltr">MEMORY_TARGET</code> parameter is set to a nonzero value, then set this parameter to a large nonzero value if you must specify the maximum memory usage of the Oracle database.</p>
<p><span class="bold">See Also:</span> <a href="#BABBFJEB">&#34;Configuring the Oracle Streams Pool&#34;</a></p>
</td>
</tr>
<tr class="cellalignment92">
<td class="cellalignment98" id="r8c1-t26" headers="r1c1-t26">
<p><a class="olink REFRN10285" href="../REFRN/GUID-186DE5CB-8104-4C8B-B673-6B831DFB42DB.htm#REFRN10285"><code dir="ltr">MEMORY_TARGET</code></a><a id="sthref82"></a><a id="sthref83"></a></p>
</td>
<td class="cellalignment98" headers="r8c1-t26 r1c2-t26">
<p><span class="bold">Default:</span> <code dir="ltr">0</code></p>
<p><span class="bold">Range:</span> <code dir="ltr">152</code> <code dir="ltr">MB</code> to <code dir="ltr">MEMORY_MAX_TARGET</code> setting</p>
<p><span class="bold">Modifiable?:</span> Yes</p>
</td>
<td class="cellalignment98" headers="r8c1-t26 r1c3-t26">
<p>Specifies the systemwide usable memory for an Oracle database.</p>
<p>Oracle recommends enabling the autotuning of the memory usage of an Oracle database by setting <code dir="ltr">MEMORY_TARGET</code> to a large nonzero value (if this parameter is supported on your platform).</p>
<p><span class="bold">See Also:</span> <a href="#BABBFJEB">&#34;Configuring the Oracle Streams Pool&#34;</a></p>
</td>
</tr>
<tr class="cellalignment92">
<td class="cellalignment98" id="r9c1-t26" headers="r1c1-t26">
<p><a class="olink REFRN10138" href="../REFRN/GUID-0B426902-11AD-4063-AED3-A815328DD0C4.htm#REFRN10138"><code dir="ltr">OPEN_LINKS</code></a><a id="sthref84"></a><a id="sthref85"></a></p>
</td>
<td class="cellalignment98" headers="r9c1-t26 r1c2-t26">
<p><span class="bold">Default:</span> <code dir="ltr">4</code></p>
<p><span class="bold">Range:</span> <code dir="ltr">0</code> to <code dir="ltr">255</code></p>
<p><span class="bold">Modifiable?:</span> No</p>
</td>
<td class="cellalignment98" headers="r9c1-t26 r1c3-t26">
<p>Specifies the maximum number of concurrent open connections to remote databases in one session. These connections include database links, plus external procedures and cartridges, each of which uses a separate process.</p>
<p>In an Oracle Streams environment, ensure that this parameter is set to the default value of <code dir="ltr">4</code> or higher.</p>
</td>
</tr>
<tr class="cellalignment92">
<td class="cellalignment98" id="r10c1-t26" headers="r1c1-t26">
<p><a class="olink REFRN10175" href="../REFRN/GUID-B757AF80-DA38-4167-A914-FE376A3AD4FE.htm#REFRN10175"><code dir="ltr">PROCESSES</code></a><a id="sthref86"></a><a id="sthref87"></a></p>
</td>
<td class="cellalignment98" headers="r10c1-t26 r1c2-t26">
<p><span class="bold">Default:</span> <code dir="ltr">100</code></p>
<p><span class="bold">Range:</span> <code dir="ltr">6</code> to operating system-dependent</p>
<p><span class="bold">Modifiable?:</span> No</p>
</td>
<td class="cellalignment98" headers="r10c1-t26 r1c3-t26">
<p>Specifies the maximum number of operating system user processes that can simultaneously connect to Oracle.</p>
<p>Ensure that the value of this parameter allows for all background processes, such as locks and slave processes. In Oracle Streams, capture processes, apply processes, XStream inbound servers, and XStream outbound servers use background processes. Propagations use background processes in combined capture and apply configurations. Propagations use Oracle Scheduler slave processes in configurations that do not use combined capture and apply.</p>
</td>
</tr>
<tr class="cellalignment92">
<td class="cellalignment98" id="r11c1-t26" headers="r1c1-t26">
<p><a class="olink REFRN10197" href="../REFRN/GUID-52804B5A-164F-44F3-8980-F2593B58D807.htm#REFRN10197"><code dir="ltr">SESSIONS</code></a><a id="sthref88"></a><a id="sthref89"></a></p>
</td>
<td class="cellalignment98" headers="r11c1-t26 r1c2-t26">
<p><span class="bold">Default:</span> Derived from:</p>
<p><code dir="ltr">(1.5 * PROCESSES) + 22</code></p>
<p><span class="bold">Range:</span> <code dir="ltr">1</code> to <code dir="ltr">2</code><sup>31</sup></p>
<p><span class="bold">Modifiable?:</span> No</p>
</td>
<td class="cellalignment98" headers="r11c1-t26 r1c3-t26">
<p>Specifies the maximum number of sessions that can be created in the system.</p>
<p>To run one or more capture processes, apply processes, XStream outbound servers, or XStream inbound servers in a database, you might need to increase the size of this parameter. Each background process in a database requires a session.</p>
</td>
</tr>
<tr class="cellalignment92">
<td class="cellalignment98" id="r12c1-t26" headers="r1c1-t26">
<p><a class="olink REFRN10198" href="../REFRN/GUID-920E478A-59E6-43DC-ACE3-B54D59E041A3.htm#REFRN10198"><code dir="ltr">SGA_MAX_SIZE</code></a><a id="sthref90"></a><a id="sthref91"></a></p>
</td>
<td class="cellalignment98" headers="r12c1-t26 r1c2-t26">
<p><span class="bold">Default:</span> Initial size of SGA at startup</p>
<p><span class="bold">Range:</span> <code dir="ltr">0</code> to operating system-dependent</p>
<p><span class="bold">Modifiable?:</span> No</p>
</td>
<td class="cellalignment98" headers="r12c1-t26 r1c3-t26">
<p>Specifies the maximum size of System Global Area (SGA) for the lifetime of a database instance.</p>
<p>If the <code dir="ltr">SGA_TARGET</code> parameter is set to a nonzero value, then set this parameter to a large nonzero value if you must specify the SGA size.</p>
<p><span class="bold">See Also:</span> <a href="#BABBFJEB">&#34;Configuring the Oracle Streams Pool&#34;</a></p>
</td>
</tr>
<tr class="cellalignment92">
<td class="cellalignment98" id="r13c1-t26" headers="r1c1-t26">
<p><a class="olink REFRN10256" href="../REFRN/GUID-4702FDB7-BADC-4997-BC49-1B91088234AE.htm#REFRN10256"><code dir="ltr">SGA_TARGET</code></a><a id="sthref92"></a><a id="sthref93"></a></p>
</td>
<td class="cellalignment98" headers="r13c1-t26 r1c2-t26">
<p><span class="bold">Default:</span> <code dir="ltr">0</code> (SGA autotuning is disabled)</p>
<p><span class="bold">Range:</span> <code dir="ltr">64</code> <code dir="ltr">MB</code> to operating system-dependent</p>
<p><span class="bold">Modifiable?:</span> Yes</p>
</td>
<td class="cellalignment98" headers="r13c1-t26 r1c3-t26">
<p>Specifies the total size of all System Global Area (SGA) components.</p>
<p>If <code dir="ltr">MEMORY_MAX_TARGET</code> and <code dir="ltr">MEMORY_TARGET</code> are set to <code dir="ltr">0</code> (zero), then Oracle recommends enabling the autotuning of SGA memory by setting <code dir="ltr">SGA_TARGET</code> to a large nonzero value.</p>
<p>If this parameter is set to a nonzero value, then the size of the Oracle Streams pool is managed by Automatic Shared Memory Management.</p>
<p><span class="bold">See Also:</span> <a href="#BABBFJEB">&#34;Configuring the Oracle Streams Pool&#34;</a></p>
</td>
</tr>
<tr class="cellalignment92">
<td class="cellalignment98" id="r14c1-t26" headers="r1c1-t26">
<p><a class="olink REFRN10202" href="../REFRN/GUID-6D9E390B-472A-46C4-B89B-E263492FCB4F.htm#REFRN10202"><code dir="ltr">SHARED_POOL_SIZE</code></a><a id="sthref94"></a><a id="sthref95"></a></p>
</td>
<td class="cellalignment98" headers="r14c1-t26 r1c2-t26">
<p><span class="bold">Default:</span></p>
<p>When <code dir="ltr">SGA_TARGET</code> is set to a nonzero value: If the parameter is not specified, then the default is <code dir="ltr">0</code> (internally determined by Oracle Database). If the parameter is specified, then the user-specified value indicates a minimum value for the shared memory pool.</p>
<p>When <code dir="ltr">SGA_TARGET</code> is not set (32-bit platforms): 64 MB, rounded up to the nearest granule size. When <code dir="ltr">SGA_TARGET</code> is not set (64-bit platforms): 128 MB, rounded up to the nearest granule size.</p>
<p><span class="bold">Range:</span> The granule size to operating system-dependent</p>
<p><span class="bold">Modifiable?:</span> Yes</p>
</td>
<td class="cellalignment98" headers="r14c1-t26 r1c3-t26">
<p>Specifies (in bytes) the size of the shared pool. The shared pool contains shared cursors, stored procedures, control structures, and other structures.</p>
<p>If the <code dir="ltr">MEMORY_MAX_TARGET</code>, <code dir="ltr">MEMORY_TARGET</code>, <code dir="ltr">SGA_TARGET</code>, and <code dir="ltr">STREAMS_POOL_SIZE</code> initialization parameters are set to zero, then Oracle Streams transfers an amount equal to 10% of the shared pool from the buffer cache to the Oracle Streams pool.</p>
<p><span class="bold">See Also:</span><a href="#BABBFJEB">&#34;Configuring the Oracle Streams Pool&#34;</a></p>
</td>
</tr>
<tr class="cellalignment92">
<td class="cellalignment98" id="r15c1-t26" headers="r1c1-t26">
<p><a class="olink REFRN10243" href="../REFRN/GUID-3FFF66CB-5A1E-43AF-B30A-A8E189BFF3FF.htm#REFRN10243"><code dir="ltr">STREAMS_POOL_SIZE</code></a><a id="sthref96"></a><a id="sthref97"></a></p>
</td>
<td class="cellalignment98" headers="r15c1-t26 r1c2-t26">
<p><span class="bold">Default:</span> <code dir="ltr">0</code></p>
<p><span class="bold">Range:</span> <code dir="ltr">0</code> to operating system-dependent limit</p>
<p><span class="bold">Modifiable?:</span> Yes</p>
</td>
<td class="cellalignment98" headers="r15c1-t26 r1c3-t26">
<p>Specifies (in bytes) the size of the Oracle Streams pool. The Oracle Streams pool contains buffered queue messages. In addition, the Oracle Streams pool is used for internal communications during parallel capture and apply.</p>
<p>If the <code dir="ltr">MEMORY_TARGET</code> or <code dir="ltr">MEMORY_MAX_TARGET</code> initialization parameter is set to a nonzero value, then the Oracle Streams pool size is set by Automatic Memory Management, and <code dir="ltr">STREAMS_POOL_SIZE</code> specifies the minimum size.</p>
<p>If the <code dir="ltr">SGA_TARGET</code> initialization parameter is set to a nonzero value, then the Oracle Streams pool size is set by Automatic Shared Memory Management, and <code dir="ltr">STREAMS_POOL_SIZE</code> specifies the minimum size.</p>
<p>This parameter is modifiable. If this parameter is reduced to zero when an instance is running, then Oracle Streams processes and jobs might not run.</p>
<p>Ensure that there is enough memory to accommodate the Oracle Streams components. The following are the minimum requirements:</p>
<ul>
<li>
<p>15 MB for each capture process parallelism</p>
</li>
<li>
<p>250 MB or more for each buffered queue. The buffered queue is where the buffered messages are stored.</p>
</li>
<li>
<p>1 MB for each apply process parallelism</p>
</li>
<li>
<p>1 MB for each XStream outbound server</p>
</li>
<li>
<p>1 MB for each XStream inbound server parallelism</p>
</li>
</ul>
<p>For example, if parallelism is set to 3 for a capture process, then at least 45 MB is required for the capture process. If a database has two buffered queues, then at least 20 MB is required for the buffered queues. If parallelism is set to 4 for an apply process, then at least 4 MB is required for the apply process.</p>
<p>You can use the <code dir="ltr">V$STREAMS_POOL_ADVICE</code> dynamic performance view to determine an appropriate setting for this parameter.</p>
<p><span class="bold">See Also:</span> <a href="#BABBFJEB">&#34;Configuring the Oracle Streams Pool&#34;</a></p>
</td>
</tr>
<tr class="cellalignment92">
<td class="cellalignment98" id="r16c1-t26" headers="r1c1-t26">
<p><a class="olink REFRN10218" href="../REFRN/GUID-1F65183A-5F77-42E1-8BC1-294910F3A731.htm#REFRN10218"><code dir="ltr">TIMED_STATISTICS</code></a><a id="sthref98"></a><a id="sthref99"></a></p>
</td>
<td class="cellalignment98" headers="r16c1-t26 r1c2-t26">
<p><span class="bold">Default:</span></p>
<p>If <code dir="ltr">STATISTICS_LEVEL</code> is set to <code dir="ltr">TYPICAL</code> or <code dir="ltr">ALL</code>, then <code dir="ltr">true</code></p>
<p>If <code dir="ltr">STATISTICS_LEVEL</code> is set to <code dir="ltr">BASIC</code>, then <code dir="ltr">false</code></p>
<p>The default for <code dir="ltr">STATISTICS_LEVEL</code> is <code dir="ltr">TYPICAL</code>.</p>
<p><span class="bold">Range:</span> <code dir="ltr">true</code> or <code dir="ltr">false</code></p>
<p><span class="bold">Modifiable?:</span> Yes</p>
</td>
<td class="cellalignment98" headers="r16c1-t26 r1c3-t26">
<p>Specifies whether statistics related to time are collected.</p>
<p>To collect elapsed time statistics in the dynamic performance views related to Oracle Streams, set this parameter to <code dir="ltr">true</code>. The views that include elapsed time statistics include: <code dir="ltr">V$STREAMS_CAPTURE</code>, <code dir="ltr">V$STREAMS_APPLY_COORDINATOR</code>, <code dir="ltr">V$STREAMS_APPLY_READER</code>, <code dir="ltr">V$STREAMS_APPLY_SERVER</code>.</p>
</td>
</tr>
<tr class="cellalignment92">
<td class="cellalignment98" id="r17c1-t26" headers="r1c1-t26">
<p><a class="olink REFRN10225" href="../REFRN/GUID-D238E854-A2C5-463E-A146-31F61300124E.htm#REFRN10225"><code dir="ltr">UNDO_RETENTION</code></a><a id="sthref100"></a><a id="sthref101"></a></p>
</td>
<td class="cellalignment98" headers="r17c1-t26 r1c2-t26">
<p><span class="bold">Default:</span> <code dir="ltr">900</code></p>
<p><span class="bold">Range:</span> <code dir="ltr">0</code> to 2<sup>31</sup> - 1</p>
<p><span class="bold">Modifiable?:</span> Yes</p>
</td>
<td class="cellalignment98" headers="r17c1-t26 r1c3-t26">
<p>Specifies (in seconds) the amount of committed undo information to retain in the database.</p>
<p>For a database running one or more capture processes, ensure that this parameter is set to specify an adequate undo retention period.</p>
<p>If you run one or more capture processes and you are unsure about the proper setting, then try setting this parameter to at least <code dir="ltr">3600</code>. If you encounter &#34;snapshot too old&#34; errors, then increase the setting for this parameter until these errors cease. Ensure that the undo tablespace has enough space to accommodate the <code dir="ltr">UNDO_RETENTION</code> setting.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblhruleformalwide" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink REFRN" href="../REFRN/toc.htm"><span class="italic">Oracle Database Reference</span></a> for more information about these initialization parameters</p>
</li>
<li>
<p><a class="olink SBYDB" href="../SBYDB/toc.htm"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> for more information about the <code dir="ltr">LOG_ARCHIVE_DEST_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code> parameter</p>
</li>
<li>
<p><a class="olink ADMIN013" href="../ADMIN/undo.htm#ADMIN013"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for more information about the <code dir="ltr">UNDO_RETENTION</code> parameter</p>
</li>
<li>
<p><a class="olink XSTRM" href="../XSTRM/toc.htm"><span class="italic">Oracle Database XStream Guide</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABBFJEB"></a>
<div id="STREP202" class="sect2">
<h3 class="sect2">Configuring the Oracle Streams Pool<a id="sthref102"></a></h3>
<p>The <span class="bold">Oracle Streams pool</span> is a portion of memory in the System Global Area (SGA) that is used by Oracle Streams. The Oracle Streams pool stores buffered queue messages in memory, and it provides memory for capture processes, apply processes, XStream outbound servers, and XStream inbound servers. The Oracle Streams pool always stores LCRs captured by a capture process, and it stores LCRs and messages that are enqueued into a buffered queue by applications.</p>
<p>The Oracle Streams pool is initialized the first time any one of the following actions occurs in a database:</p>
<ul>
<li>
<p>Messages are enqueued into a buffered queue.</p>
<p>Oracle Streams components manipulate messages in a buffered queue. These components include capture processes, propagations, apply processes, XStream outbound servers, and XStream inbound servers. Also, Data Pump export and import operations initialize the Oracle Streams pool because these operations use buffered queues.</p>
</li>
<li>
<p>Messages are dequeued from a persistent queue in a configuration that does not use Oracle Real Application Clusters (Oracle RAC).</p>
<p>The Oracle Streams pool is used to optimize dequeue operations from persistent queues. The Oracle Streams pool is not used to optimize dequeue operations from persistent queues in an Oracle RAC configuration.</p>
</li>
<li>
<p>A capture process is started.</p>
</li>
<li>
<p>A propagation is created.</p>
</li>
<li>
<p>An apply process is started.</p>
</li>
<li>
<p>An XStream outbound server is started.</p>
</li>
<li>
<p>An XStream inbound server is started.</p>
</li>
</ul>
<p>The size of the Oracle Streams pool is determined in one of the following ways:</p>
<ul>
<li>
<p><a href="#BCEDFAEE">Using Automatic Memory Management to Set the Oracle Streams Pool Size</a></p>
</li>
<li>
<p><a href="#CHDDCHHH">Using Automatic Shared Memory Management to Set the Oracle Streams Pool Size</a></p>
</li>
<li>
<p><a href="#CHDEADHH">Setting the Oracle Streams Pool Size Manually</a></p>
</li>
<li>
<p><a href="#CHDIGHAA">Using the Default Setting for the Oracle Streams Pool Size</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
If the Oracle Streams pool cannot be initialized, then an <code dir="ltr">ORA-00832</code> error is returned. If this happens, then first ensure that there is enough space in the SGA for the Oracle Streams pool. If necessary, reset the <code dir="ltr">SGA_MAX_SIZE</code> initialization parameter to increase the SGA size. Next, set one or more of the following initialization parameters: <code dir="ltr">MEMORY_TARGET</code>, <code dir="ltr">MEMORY_MAX_TARGET</code>, <code dir="ltr">SGA_TARGET</code>, and <code dir="ltr">STREAMS_POOL_SIZE</code>.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#BABFJJIH">&#34;Setting Initialization Parameters Relevant to Oracle Streams&#34;</a></p>
</li>
<li>
<p><a class="olink STRMS" href="../STRMS/toc.htm"><span class="italic">Oracle Streams Concepts and Administration</span></a></p>
</li>
<li>
<p><a class="olink XSTRM" href="../XSTRM/toc.htm"><span class="italic">Oracle Database XStream Guide</span></a></p>
</li>
</ul>
</div>
<a id="BCEDFAEE"></a>
<div id="STREP235" class="sect3">
<h4 class="sect3">Using Automatic Memory Management to Set the Oracle Streams Pool Size<a id="sthref103"></a><a id="sthref104"></a><a id="sthref105"></a><a id="sthref106"></a></h4>
<p>The Automatic Memory Management feature automatically manages the size of the Oracle Streams pool when the <code dir="ltr">MEMORY_TARGET</code> or <code dir="ltr">MEMORY_MAX_TARGET</code> initialization parameter is set to a nonzero value. When you use Automatic Memory Management, you can still set the following initialization parameters:</p>
<ul>
<li>
<p>If the <code dir="ltr">SGA_TARGET</code> initialization parameter also is set to a nonzero value, then Automatic Memory Management uses this value as a minimum for the system global area (SGA).</p>
</li>
<li>
<p>If the <code dir="ltr">STREAMS_POOL_SIZE</code> initialization parameter also is set to a nonzero value, then Automatic Memory Management uses this value as a minimum for the Oracle Streams pool.</p>
</li>
</ul>
<p>The current memory allocated to Oracle Streams pool by Automatic Memory Management can be viewed by querying the <code dir="ltr">V$MEMORY_DYNAMIC_COMPONENTS</code> view.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Currently, the <code dir="ltr">MEMORY_TARGET</code> and <code dir="ltr">MEMORY_MAX_TARGET</code> initialization parameters are not supported on some platforms.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink ADMIN00207" href="../ADMIN/memory.htm#ADMIN00207"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a></p>
</li>
<li>
<p><a class="olink REFRN" href="../REFRN/toc.htm"><span class="italic">Oracle Database Reference</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" -->
<a id="CHDDCHHH"></a>
<div id="STREP236" class="sect3">
<h4 class="sect3">Using Automatic Shared Memory Management to Set the Oracle Streams Pool Size<a id="sthref107"></a><a id="sthref108"></a></h4>
<p>The Automatic Shared Memory Management feature automatically manages the size of the Oracle Streams pool when the following conditions are met:</p>
<ul>
<li>
<p>The <code dir="ltr">MEMORY_TARGET</code> and <code dir="ltr">MEMORY_MAX_TARGET</code> initialization parameters are both set to <code dir="ltr">0</code> (zero).</p>
</li>
<li>
<p><code dir="ltr">SGA_TARGET</code> initialization parameter is set to a nonzero value.</p>
</li>
</ul>
<p>If you are using Automatic Shared Memory Management and the <code dir="ltr">STREAMS_POOL_SIZE</code> initialization parameter also is set to a nonzero value, then Automatic Shared Memory Management uses this value as a minimum for the Oracle Streams pool. You can set a minimum size if your environment needs a minimum amount of memory in the Oracle Streams pool to function properly. The current memory allocated to Oracle Streams pool by Automatic Shared Memory Management can be viewed by querying the <code dir="ltr">V$SGA_DYNAMIC_COMPONENTS</code> view.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink ADMIN00207" href="../ADMIN/memory.htm#ADMIN00207"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a></p>
</li>
<li>
<p><a class="olink REFRN10256" href="../REFRN/GUID-4702FDB7-BADC-4997-BC49-1B91088234AE.htm#REFRN10256"><span class="italic">Oracle Database Reference</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" -->
<a id="CHDEADHH"></a>
<div id="STREP237" class="sect3">
<h4 class="sect3">Setting the Oracle Streams Pool Size Manually<a id="sthref109"></a></h4>
<p>The Oracle Streams pool size is the value specified by the <code dir="ltr">STREAMS_POOL_SIZE</code> parameter, in bytes, if the following conditions are met.</p>
<ul>
<li>
<p>The <code dir="ltr">MEMORY_TARGET</code>, <code dir="ltr">MEMORY_MAX_TARGET</code>, and <code dir="ltr">SGA_TARGET</code> initialization parameters are all set to <code dir="ltr">0</code> (zero).</p>
</li>
<li>
<p>The <code dir="ltr">STREAMS_POOL_SIZE</code> initialization parameter is set to a nonzero value.</p>
</li>
</ul>
<p>If you plan to set the Oracle Streams pool size manually, then you can use the <code dir="ltr">V$STREAMS_POOL_ADVICE</code> dynamic performance view to determine an appropriate setting for the <code dir="ltr">STREAMS_POOL_SIZE</code> initialization parameter.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS147" href="../STRMS/strms_otmon.htm#STRMS147"><span class="italic">Oracle Streams Concepts and Administration</span></a></div>
</div>
<!-- class="sect3" -->
<a id="CHDIGHAA"></a>
<div id="STREP238" class="sect3">
<h4 class="sect3">Using the Default Setting for the Oracle Streams Pool Size</h4>
<p>The Oracle Streams pool size is set by default if all of the following parameters are set to <code dir="ltr">0</code> (zero): <code dir="ltr">MEMORY_TARGET</code>, <code dir="ltr">MEMORY_MAX_TARGET</code>, <code dir="ltr">SGA_TARGET</code>, and <code dir="ltr">STREAMS_POOL_SIZE</code>. When the Oracle Streams pool size is set by default, the first use of Oracle Streams in a database transfers an amount of memory equal to 10% of the shared pool from the buffer cache to the Oracle Streams pool. The buffer cache is set by the <code dir="ltr">DB_CACHE_SIZE</code> initialization parameter, and the shared pool size is set by the <code dir="ltr">SHARED_POOL_SIZE</code> initialization parameter.</p>
<p>For example, consider the following configuration in a database before Oracle Streams is used for the first time:</p>
<ul>
<li>
<p><code dir="ltr">DB_CACHE_SIZE</code> is set to 100 MB.</p>
</li>
<li>
<p><code dir="ltr">SHARED_POOL_SIZE</code> is set to 80 MB.</p>
</li>
<li>
<p><code dir="ltr">MEMORY_TARGET</code>, <code dir="ltr">MEMORY_MAX_TARGET</code>, <code dir="ltr">SGA_TARGET</code>, and <code dir="ltr">STREAMS_POOL_SIZE</code> are all set to zero.</p>
</li>
</ul>
<p>Given this configuration, the amount of memory allocated after Oracle Streams is used for the first time is the following:</p>
<ul>
<li>
<p>The buffer cache has 92 MB.</p>
</li>
<li>
<p>The shared pool has 80 MB.</p>
</li>
<li>
<p>The Oracle Streams pool has 8 MB.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#BABFJJIH">&#34;Setting Initialization Parameters Relevant to Oracle Streams&#34;</a> for more information about the <code dir="ltr">STREAMS_POOL_SIZE</code> initialization parameter</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1008208"></a>
<div id="STREP107" class="sect2">
<h3 class="sect2">Specifying Supplemental Logging<a id="sthref110"></a><a id="sthref111"></a><a id="sthref112"></a></h3>
<p>When you use a capture process to capture changes, supplemental logging must be specified for certain columns at a source database for changes to the columns to be applied successfully at a destination database. Supplemental logging places additional information in the redo log for these columns. A capture process captures this additional information and places it in logical change records (LCRs), and an apply process might need this additional information to apply changes properly.</p>
<p>This section contains these topics:</p>
<ul>
<li>
<p><a href="#BABJFDGC">Required Supplemental Logging in an Oracle Streams Replication Environment</a></p>
</li>
<li>
<p><a href="#i1012569">Specifying Table Supplemental Logging Using Unconditional Log Groups</a></p>
</li>
<li>
<p><a href="#i1012631">Specifying Table Supplemental Logging Using Conditional Log Groups</a></p>
</li>
<li>
<p><a href="#i1012632">Dropping a Supplemental Log Group</a></p>
</li>
<li>
<p><a href="#i1012633">Specifying Database Supplemental Logging of Key Columns</a></p>
</li>
<li>
<p><a href="#i1012634">Dropping Database Supplemental Logging of Key Columns</a></p>
</li>
<li>
<p><a href="#BABHBEAF">Procedures That Automatically Specify Supplemental Logging</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1"><span class="bold">Note</span>:</p>
Supplemental logging is not required when synchronous capture is used to capture changes to database objects.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS208" href="../STRMS/strms_cpmon.htm#STRMS208"><span class="italic">Oracle Streams Concepts and Administration</span></a> for queries that show supplemental logging specifications</div>
<a id="BABJFDGC"></a>
<div id="STREP239" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Required Supplemental Logging in an Oracle Streams Replication Environment</h4>
<p>There are two types of supplemental logging: <span class="bold">database supplemental logging</span> and <span class="bold">table supplemental logging</span>. Database supplemental logging specifies supplemental logging for an entire database, while table supplemental logging enables you to specify log groups for supplemental logging of a particular table. If you use table supplemental logging, then you can choose between two types of log groups: unconditional log groups and conditional log groups.</p>
<p><span class="bold">Unconditional log groups</span> log the before images of specified columns when the table is changed, regardless of whether the change affected any of the specified columns. Unconditional log groups are sometimes referred to as &#34;always log groups.&#34; <span class="bold">Conditional log groups</span> log the before images of all specified columns only if at least one of the columns in the log group is changed.</p>
<p>Supplementing logging at the database level, unconditional log groups at the table level, and conditional log groups at the table level determine which old values are logged for a change.</p>
<p>If you plan to use one or more apply processes to apply LCRs captured by a capture process, then you must enable supplemental logging <span class="italic">at the source database</span> for the following types of columns in tables <span class="italic">at the destination database</span>:</p>
<ul>
<li>
<p>Any columns at the source database that are used in a primary key in tables for which changes are applied at a destination database must be unconditionally logged in a log group or by database supplemental logging of primary key columns.</p>
</li>
<li>
<p>If the parallelism of any apply process that will apply the changes is greater than&nbsp;1, then any unique constraint column at a destination database that comes from multiple columns at the source database must be conditionally logged. Supplemental logging does not need to be specified if a unique constraint column comes from a single column at the source database.</p>
</li>
<li>
<p>If the parallelism of any apply process that will apply the changes is greater than&nbsp;1, then any foreign key column at a destination database that comes from multiple columns at the source database must be conditionally logged. Supplemental logging does not need to be specified if the foreign key column comes from a single column at the source database.</p>
</li>
<li>
<p>If the parallelism of any apply process that will apply the changes is greater than&nbsp;1, then any bitmap index column at a destination database that comes from multiple columns at the source database must be conditionally logged. Supplemental logging does not need to be specified if the bitmap index column comes from a single column at the source database.</p>
</li>
<li>
<p>Any columns at the source database that are used as substitute key columns for an apply process at a destination database must be unconditionally logged. You specify substitute key columns for a table using the <code dir="ltr">SET_KEY_COLUMNS</code> procedure in the <code dir="ltr">DBMS_APPLY_ADM</code> package.</p>
</li>
<li>
<p>The columns specified in a column list for conflict resolution during apply must be conditionally logged if multiple columns at the source database are used in the column list at the destination database.</p>
</li>
<li>
<p>Any columns at the source database that are used by a statement DML handler, change handler, procedure DML handler, or error handler at a destination database must be unconditionally logged.</p>
</li>
<li>
<p>Any columns at the source database that are used by a rule or a rule-based transformation must be unconditionally logged.</p>
</li>
<li>
<p>Any columns at the source database that are specified in a value dependency virtual dependency definition at a destination database must be unconditionally logged.</p>
</li>
<li>
<p>If you specify row subsetting for a table at a destination database, then any columns at the source database that are in the destination table or columns at the source database that are in the subset condition must be unconditionally logged. You specify a row subsetting condition for an apply process using the <code dir="ltr">dml_condition</code> parameter in the <code dir="ltr">ADD_SUBSET_RULES</code> procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package.</p>
</li>
</ul>
<p>If you do not use supplemental logging for these types of columns at a source database, then changes involving these columns might not apply properly at a destination database.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Columns of the following data types cannot be part of a supplemental log group: LOB, <code dir="ltr">LONG</code>, <code dir="ltr">LONG</code> <code dir="ltr">RAW</code>, user-defined types (including object types, <code dir="ltr">REF</code>s, varrays, nested tables), and Oracle-supplied types (including <code dir="ltr">Any</code> types, XML types, spatial types, and media types).</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="conflict.htm#i1006514">&#34;Column Lists&#34;</a></p>
</li>
<li>
<p><a href="#BABIADHG">&#34;Decide Whether the Replication Environment Will Have Nonidentical Replicas&#34;</a> for information about rule-based transformations</p>
</li>
<li>
<p><a href="#BABBHGIH">&#34;Decide Whether the Replication Environment Will Use Apply Handlers&#34;</a></p>
</li>
<li>
<p><a class="olink SQLRF0021" href="../SQLRF/sql_elements001.htm#SQLRF0021"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about data types</p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" -->
<a id="i1012569"></a>
<div id="STREP240" class="sect3">
<h4 class="sect3">Specifying Table Supplemental Logging Using Unconditional Log Groups<a id="sthref113"></a><a id="sthref114"></a><a id="sthref115"></a><a id="sthref116"></a></h4>
<p>The following sections describe creating an unconditional supplemental log group:</p>
<ul>
<li>
<p><a href="#i1012497">Specifying an Unconditional Supplemental Log Group for Primary Key Column(s)</a></p>
</li>
<li>
<p><a href="#i1012713">Specifying an Unconditional Supplemental Log Group for All Table Columns</a></p>
</li>
<li>
<p><a href="#i1012509">Specifying an Unconditional Supplemental Log Group that Includes Selected Columns</a></p>
</li>
</ul>
<a id="i1012497"></a>
<div id="STREP241" class="sect4">
<h5 class="sect4">Specifying an Unconditional Supplemental Log Group for Primary Key Column(s)</h5>
<p>To specify an unconditional supplemental log group that only includes the primary key column(s) for a table, use an <code dir="ltr">ALTER</code> <code dir="ltr">TABLE</code> statement with the <code dir="ltr">PRIMARY</code> <code dir="ltr">KEY</code> option in the <code dir="ltr">ADD</code> <code dir="ltr">SUPPLEMENTAL</code> <code dir="ltr">LOG</code> <code dir="ltr">DATA</code> clause.</p>
<p>For example, the following statement adds the primary key column of the <code dir="ltr">hr.regions</code> table to an unconditional log group:</p>
<pre dir="ltr">ALTER TABLE hr.regions ADD SUPPLEMENTAL LOG DATA (PRIMARY KEY) COLUMNS;
</pre>
<p>The log group has a system-generated name.</p>
</div>
<!-- class="sect4" -->
<a id="i1012713"></a>
<div id="STREP242" class="sect4">
<h5 class="sect4">Specifying an Unconditional Supplemental Log Group for All Table Columns</h5>
<p>To specify an unconditional supplemental log group that includes all of the columns in a table, use an <code dir="ltr">ALTER</code> <code dir="ltr">TABLE</code> statement with the <code dir="ltr">ALL</code> option in the <code dir="ltr">ADD</code> <code dir="ltr">SUPPLEMENTAL</code> <code dir="ltr">LOG</code> <code dir="ltr">DATA</code> clause.</p>
<p>For example, the following statement adds all of the columns in the <code dir="ltr">hr.regions</code> table to an unconditional log group:</p>
<pre dir="ltr">ALTER TABLE hr.regions ADD SUPPLEMENTAL LOG DATA (ALL) COLUMNS;
</pre>
<p>The log group has a system-generated name.</p>
</div>
<!-- class="sect4" -->
<a id="i1012509"></a>
<div id="STREP243" class="sect4">
<h5 class="sect4">Specifying an Unconditional Supplemental Log Group that Includes Selected Columns</h5>
<p>To specify an unconditional supplemental log group that contains columns that you select, use an <code dir="ltr">ALTER</code> <code dir="ltr">TABLE</code> statement with the <code dir="ltr">ALWAYS</code> specification for the <code dir="ltr">ADD</code> <code dir="ltr">SUPPLEMENTAL</code> <code dir="ltr">LOG</code> <code dir="ltr">GROUP</code> clause.These log groups can include key columns, if&nbsp;necessary.</p>
<p>For example, the following statement adds the <code dir="ltr">department_id</code> column and the <code dir="ltr">manager_id</code> column of the <code dir="ltr">hr.departments</code> table to an unconditional log group named <code dir="ltr">log_group_dep_pk</code>:</p>
<pre dir="ltr">ALTER TABLE hr.departments ADD SUPPLEMENTAL LOG GROUP log_group_dep_pk
  (department_id, manager_id) ALWAYS;
</pre>
<p>The <code dir="ltr">ALWAYS</code> specification makes this log group an unconditional log group.</p>
</div>
<!-- class="sect4" --></div>
<!-- class="sect3" -->
<a id="i1012631"></a>
<div id="STREP244" class="sect3">
<h4 class="sect3">Specifying Table Supplemental Logging Using Conditional Log Groups<a id="sthref117"></a><a id="sthref118"></a><a id="sthref119"></a><a id="sthref120"></a></h4>
<p>The following sections describe creating a conditional log group:</p>
<ul>
<li>
<p><a href="#i1012525">Specifying a Conditional Log Group Using the ADD SUPPLEMENTAL LOG DATA Clause</a></p>
</li>
<li>
<p><a href="#i1012537">Specifying a Conditional Log Group Using the ADD SUPPLEMENTAL LOG GROUP Clause</a></p>
</li>
</ul>
<a id="i1012525"></a>
<div id="STREP245" class="sect4">
<h5 class="sect4">Specifying a Conditional Log Group Using the ADD SUPPLEMENTAL LOG DATA Clause</h5>
<p>You can use the following options in the <code dir="ltr">ADD</code> <code dir="ltr">SUPPLEMENTAL</code> <code dir="ltr">LOG</code> <code dir="ltr">DATA</code> clause of an <code dir="ltr">ALTER</code> <code dir="ltr">TABLE</code> statement:</p>
<ul>
<li>
<p>The <code dir="ltr">FOREIGN</code> <code dir="ltr">KEY</code> option creates a conditional log group that includes the foreign key column(s) in the table.</p>
</li>
<li>
<p>The <code dir="ltr">UNIQUE</code> option creates a conditional log group that includes the unique key column(s) and bitmap index column(s) in the table.</p>
</li>
</ul>
<p>If you specify multiple options in a single <code dir="ltr">ALTER</code> <code dir="ltr">TABLE</code> statement, then a separate conditional log group is created for each option.</p>
<p>For example, the following statement creates two conditional log groups:</p>
<pre dir="ltr">ALTER TABLE hr.employees ADD SUPPLEMENTAL LOG DATA 
  (UNIQUE, FOREIGN KEY) COLUMNS;
</pre>
<p>One conditional log group includes the unique key columns and bitmap index columns for the table, and the other conditional log group includes the foreign key columns for the table. Both log groups have a system-generated name.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Specifying the <code dir="ltr">UNIQUE</code> option does not enable supplemental logging of bitmap join index columns.</div>
</div>
<!-- class="sect4" -->
<a id="i1012537"></a>
<div id="STREP246" class="sect4">
<h5 class="sect4">Specifying a Conditional Log Group Using the ADD SUPPLEMENTAL LOG GROUP Clause</h5>
<p>To specify a conditional supplemental log group that includes any columns you choose to add, you can use the <code dir="ltr">ADD</code> <code dir="ltr">SUPPLEMENTAL</code> <code dir="ltr">LOG</code> <code dir="ltr">GROUP</code> clause in the <code dir="ltr">ALTER</code> <code dir="ltr">TABLE</code> statement. To make the log group conditional, do not include the <code dir="ltr">ALWAYS</code> specification.</p>
<p>For example, suppose the <code dir="ltr">min_salary</code> and <code dir="ltr">max_salary</code> columns in the <code dir="ltr">hr.jobs</code> table are included in a column list for conflict resolution at a destination database. The following statement adds the <code dir="ltr">min_salary</code> and <code dir="ltr">max_salary</code> columns to a conditional log group named <code dir="ltr">log_group_jobs_cr</code>:</p>
<pre dir="ltr">ALTER TABLE hr.jobs ADD SUPPLEMENTAL LOG GROUP log_group_jobs_cr 
  (min_salary, max_salary);
</pre></div>
<!-- class="sect4" --></div>
<!-- class="sect3" -->
<a id="i1012632"></a>
<div id="STREP247" class="sect3">
<h4 class="sect3">Dropping a Supplemental Log Group<a id="sthref121"></a><a id="sthref122"></a></h4>
<p>To drop a conditional or unconditional supplemental log group, use the <code dir="ltr">DROP</code> <code dir="ltr">SUPPLEMENTAL</code> <code dir="ltr">LOG</code> <code dir="ltr">GROUP</code> clause in the <code dir="ltr">ALTER</code> <code dir="ltr">TABLE</code> statement. For example, to drop a supplemental log group named <code dir="ltr">log_group_jobs_cr</code>, run the following statement:</p>
<pre dir="ltr">ALTER TABLE hr.jobs DROP SUPPLEMENTAL LOG GROUP log_group_jobs_cr;
</pre></div>
<!-- class="sect3" -->
<a id="i1012633"></a>
<div id="STREP248" class="sect3">
<h4 class="sect3">Specifying Database Supplemental Logging of Key Columns<a id="sthref123"></a><a id="sthref124"></a></h4>
<p>You have the option of specifying supplemental logging for all primary key, unique key, bitmap index, and foreign key columns in a source database. You might choose this option if you configure a capture process to capture changes to an entire database. To specify supplemental logging for all primary key, unique key, bitmap index, and foreign key columns in a source database, issue the following SQL statement:</p>
<pre dir="ltr">ALTER DATABASE ADD SUPPLEMENTAL LOG DATA 
   (PRIMARY KEY, UNIQUE, FOREIGN KEY) COLUMNS;
</pre>
<p>If your primary key, unique key, bitmap index, and foreign key columns are the same at all source and destination databases, then running this command at the source database provides the supplemental logging needed for primary key, unique key, bitmap index, and foreign key columns at all destination databases. When you specify the <code dir="ltr">PRIMARY</code> <code dir="ltr">KEY</code> option, all columns of a row&#39;s primary key are placed in the redo log file any time the table is modified (unconditional logging). When you specify the <code dir="ltr">UNIQUE</code> option, any columns in a row&#39;s unique key and bitmap index are placed in the redo log file if any column belonging to the unique key or bitmap index is modified (conditional logging). When you specify the <code dir="ltr">FOREIGN</code> <code dir="ltr">KEY</code> option, all columns of a row&#39;s foreign key are placed in the redo log file if any column belonging to the foreign key is modified (conditional logging).</p>
<p>You can omit one or more of these options. For example, if you do not want to supplementally log all of the foreign key columns in the database, then you can omit the <code dir="ltr">FOREIGN</code> <code dir="ltr">KEY</code> option, as in the following example:</p>
<pre dir="ltr">ALTER DATABASE ADD SUPPLEMENTAL LOG DATA 
   (PRIMARY KEY, UNIQUE) COLUMNS;
</pre>
<p>In addition to <code dir="ltr">PRIMARY</code> <code dir="ltr">KEY</code>, <code dir="ltr">UNIQUE</code>, and <code dir="ltr">FOREIGN</code> <code dir="ltr">KEY</code>, you can also use the <code dir="ltr">ALL</code> option. The <code dir="ltr">ALL</code> option specifies that, when a row is changed, all the columns of that row (except for LOB, <code dir="ltr">LONG</code>, <code dir="ltr">LONG</code> <code dir="ltr">RAW</code>, user-defined type, and Oracle-supplied type columns) are placed in the redo log file (unconditional logging).</p>
<p>Supplemental logging statements are cumulative. If you issue two consecutive <code dir="ltr">ALTER</code> <code dir="ltr">DATABASE</code> <code dir="ltr">ADD</code> <code dir="ltr">SUPPLEMENTAL</code> <code dir="ltr">LOG</code> <code dir="ltr">DATA</code> statements, each with a different identification key, then both keys are supplementally logged.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Specifying the <code dir="ltr">UNIQUE</code> option does not enable supplemental logging of bitmap join index columns.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SQLRF0021" href="../SQLRF/sql_elements001.htm#SQLRF0021"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about data types</div>
</div>
<!-- class="sect3" -->
<a id="i1012634"></a>
<div id="STREP249" class="sect3">
<h4 class="sect3">Dropping Database Supplemental Logging of Key Columns<a id="sthref125"></a><a id="sthref126"></a></h4>
<p>To drop supplemental logging for all primary key, unique key, bitmap index, and foreign key columns in a source database, issue the <code dir="ltr">ALTER</code> <code dir="ltr">DATABASE</code> <code dir="ltr">DROP</code> <code dir="ltr">SUPPLEMENTAL</code> <code dir="ltr">LOG</code> <code dir="ltr">DATA</code> statement. To drop database supplemental logging for all primary key, unique key, bitmap index, and foreign key columns, issue the following SQL statement:</p>
<pre dir="ltr">ALTER DATABASE DROP SUPPLEMENTAL LOG DATA 
  (PRIMARY KEY, UNIQUE, FOREIGN KEY) COLUMNS;
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
Dropping database supplemental logging of key columns does not affect any existing table-level supplemental log groups.</div>
</div>
<!-- class="sect3" -->
<a id="BABHBEAF"></a>
<div id="STREP250" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Procedures That Automatically Specify Supplemental Logging</h4>
<p>The following procedures in the <code dir="ltr">DBMS_CAPTURE_ADM</code> package automatically specify supplemental logging:</p>
<ul>
<li>
<p><a class="olink ARPLS590" href="../ARPLS/d_cap_a.htm#ARPLS590"><code dir="ltr">BUILD</code></a></p>
</li>
<li>
<p><a class="olink ARPLS544" href="../ARPLS/d_cap_a.htm#ARPLS544"><code dir="ltr">PREPARE_GLOBAL_INSTANTIATION</code></a></p>
</li>
<li>
<p><a class="olink ARPLS545" href="../ARPLS/d_cap_a.htm#ARPLS545"><code dir="ltr">PREPARE_SCHEMA_INSTANTIATION</code></a></p>
</li>
<li>
<p><a class="olink ARPLS546" href="../ARPLS/d_cap_a.htm#ARPLS546"><code dir="ltr">PREPARE_TABLE_INSTANTIATION</code></a></p>
</li>
</ul>
<p>The <a class="olink ARPLS590" href="../ARPLS/d_cap_a.htm#ARPLS590"><code dir="ltr">BUILD</code></a> procedure automatically specifies database supplemental logging by running the <code dir="ltr">ALTER</code> <code dir="ltr">DATABASE</code> <code dir="ltr">ADD</code> <code dir="ltr">SUPPLEMENTAL</code> <code dir="ltr">LOG</code> <code dir="ltr">DATA</code> statement. In most cases, the <a class="olink ARPLS590" href="../ARPLS/d_cap_a.htm#ARPLS590"><code dir="ltr">BUILD</code></a> procedure is run automatically when a capture process is created.</p>
<p>The <a class="olink ARPLS544" href="../ARPLS/d_cap_a.htm#ARPLS544"><code dir="ltr">PREPARE_GLOBAL_INSTANTIATION</code></a>, <a class="olink ARPLS545" href="../ARPLS/d_cap_a.htm#ARPLS545"><code dir="ltr">PREPARE_SCHEMA_INSTANTIATION</code></a>, and <a class="olink ARPLS546" href="../ARPLS/d_cap_a.htm#ARPLS546"><code dir="ltr">PREPARE_TABLE_INSTANTIATION</code></a> procedures automatically specify supplemental logging of the primary key, unique key, bitmap index, and foreign key columns in the tables prepared for instantiation.</p>
<p>Certain procedures in the <code dir="ltr">DBMS_STREAMS_ADM</code> package automatically run a procedure listed previously. See <a href="instant.htm#BABEIIEJ">&#34;DBMS_STREAMS_ADM Package Procedures Automatically Prepare Objects&#34;</a> for information.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ARPLS73643" href="../ARPLS/d_xstrm_adm.htm#ARPLS73643"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information about these procedures</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1014093"></a>
<div id="STREP211" class="sect2">
<h3 class="sect2">Configuring Log File Transfer to a Downstream Capture Database<a id="sthref127"></a><a id="sthref128"></a></h3>
<p>If you decided to use a local capture process at the source database, then log file transfer is not required. However, if you decided to use downstream capture that uses redo transport services to transfer archived redo log files to the downstream database automatically, then configure log file transfer from the source database to the capture database before configuring the replication environment. See <a href="#CACJGEFE">&#34;Decide Whether to Configure Local or Downstream Capture for the Source Database&#34;</a> for information about the decision.</p>
<p>You must complete the steps in this section if you plan to configure downstream capture using either of the following methods:</p>
<ul>
<li>
<p>Running a configuration procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> supplied PL/SQL package to configure replication between two databases</p>
</li>
<li>
<p>Configuring each Oracle Streams component separately</p>
</li>
</ul>
<p>See <a href="#BABICDIH">&#34;Decide How to Configure the Replication Environment&#34;</a> for information about these methods.</p>
<div class="infoboxnotealso">
<p class="notep1">Tip:</p>
You can use Oracle Enterprise Manager Cloud Control to configure log file transfer and a downstream capture process. See the Oracle Enterprise Manager Cloud Control online help for instructions.</div>
<p>Complete the following steps to prepare the source database to transfer its redo log files to the capture database, and to prepare the capture database to accept these redo log files:</p>
<ol>
<li>
<p>Configure Oracle Net so that the source database can communicate with the downstream database.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink NETAG" href="../NETAG/toc.htm"><span class="italic">Oracle Database Net Services Administrator&#39;s Guide</span></a></div>
</li>
<li>
<p>Configure authentication at both databases to support the transfer of redo data.</p>
<p>Redo transport sessions are authenticated using either the Secure Sockets Layer (SSL) protocol or a remote login password file. If the source database has a remote login password file, then copy it to the appropriate directory on the downstream capture database system. The password file must be the same at the source database and the downstream capture database.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SBYDB00424" href="../SBYDB/create_ps.htm#SBYDB00424"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> for detailed information about authentication requirements for redo transport</div>
</li>
<li id="BEHGCCHI">
<p>At the source database, set the following initialization parameters to configure redo transport services to transmit redo data from the source database to the downstream database:</p>
<ul>
<li>
<p><code dir="ltr">LOG_ARCHIVE_DEST_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code> - Configure at least one <code dir="ltr">LOG_ARCHIVE_DEST_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code> initialization parameter to transmit redo data to the downstream database. Set the following attributes of this parameter in the following way:</p>
<ul>
<li>
<p><code dir="ltr">SERVICE</code> - Specify the network service name of the downstream database.</p>
</li>
<li>
<p><code dir="ltr">ASYNC</code> or <code dir="ltr">SYNC</code> - Specify a redo transport mode.</p>
<p>The advantage of specifying <code dir="ltr">ASYNC</code> is that it results in little or no effect on the performance of the source database. <code dir="ltr">ASYNC</code> is recommended to avoid affecting source database performance if the downstream database or network is performing poorly.</p>
<p>The advantage of specifying <code dir="ltr">SYNC</code> is that redo data is sent to the downstream database faster then when <code dir="ltr">ASYNC</code> is specified. Also, specifying <code dir="ltr">SYNC</code> <code dir="ltr">AFFIRM</code> results in behavior that is similar to <code dir="ltr">MAXIMUM</code> <code dir="ltr">AVAILABILITY</code> standby protection mode. Note that specifying an <code dir="ltr">ALTER</code> <code dir="ltr">DATABASE</code> <code dir="ltr">STANDBY</code> <code dir="ltr">DATABASE</code> <code dir="ltr">TO</code> <code dir="ltr">MAXIMIZE</code> <code dir="ltr">AVAILABILITY</code> SQL statement has no effect on an Oracle Streams capture process.</p>
</li>
<li>
<p><code dir="ltr">NOREGISTER</code> - Specify this attribute so that the location of the archived redo log files is not recorded in the downstream database control file.</p>
</li>
<li>
<p><code dir="ltr">VALID_FOR</code> - Specify either <code dir="ltr">(ONLINE_LOGFILE,PRIMARY_ROLE)</code> or <code dir="ltr">(ONLINE_LOGFILE,ALL_ROLES)</code>.</p>
</li>
<li>
<p><code dir="ltr">TEMPLATE</code> - If you are configuring an archived-log downstream capture process, then specify a directory and format template for archived redo logs at the downstream database. The <code dir="ltr">TEMPLATE</code> attribute overrides the <code dir="ltr">LOG_ARCHIVE_FORMAT</code> initialization parameter settings at the downstream database. The <code dir="ltr">TEMPLATE</code> attribute is valid only with remote destinations. Ensure that the format uses all of the following variables at each source database: <code dir="ltr">%t</code>, <code dir="ltr">%s</code>, and <code dir="ltr">%r</code>.</p>
<p>Do not specify the <code dir="ltr">TEMPLATE</code> attribute if you are configuring a real-time downstream capture process.</p>
</li>
<li>
<p><code dir="ltr">DB_UNIQUE_NAME</code> - The unique name of the downstream database. Use the name specified for the <code dir="ltr">DB_UNIQUE_NAME</code> initialization parameter at the downstream database.</p>
</li>
</ul>
<p>The following example is a <code dir="ltr">LOG_ARCHIVE_DEST_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code> setting that specifies the downstream database <code dir="ltr">dbs2</code> for a real-time downstream capture process:</p>
<pre dir="ltr">LOG_ARCHIVE_DEST_2=&#39;SERVICE=DBS2.EXAMPLE.COM ASYNC NOREGISTER
   VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE)
   DB_UNIQUE_NAME=dbs2&#39;
</pre>
<p>The following example is a <code dir="ltr">LOG_ARCHIVE_DEST_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code> setting that specifies the downstream database <code dir="ltr">dbs2</code> for an archived-log downstream capture process:</p>
<pre dir="ltr">LOG_ARCHIVE_DEST_2=&#39;SERVICE=DBS2.EXAMPLE.COM ASYNC NOREGISTER
   VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE)
   TEMPLATE=/usr/oracle/log_for_dbs1/dbs1_arch_%t_%s_%r.log
   DB_UNIQUE_NAME=dbs2&#39;
</pre>
<p>See <a href="#CACJGEFE">&#34;Decide Whether to Configure Local or Downstream Capture for the Source Database&#34;</a> for information about the differences between real-time and archived-log downstream capture.</p>
<div class="infoboxnotealso">
<p class="notep1">Tip:</p>
If you are configuring an archived-log downstream capture process, then specify a value for the <code dir="ltr">TEMPLATE</code> attribute that keeps log files from a remote source database separate from local database log files. In addition, if the downstream database contains log files from multiple source databases, then the log files from each source database should be kept separate from each other.</div>
</li>
<li>
<p><code dir="ltr">LOG_ARCHIVE_DEST_STATE_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code> - Set this initialization parameter that corresponds with the <code dir="ltr">LOG_ARCHIVE_DEST_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code> parameter for the downstream database to <code dir="ltr">ENABLE</code>.</p>
<p>For example, if the <code dir="ltr">LOG_ARCHIVE_DEST_2</code> initialization parameter is set for the downstream database, then set the <code dir="ltr">LOG_ARCHIVE_DEST_STATE_2</code> parameter in the following way:</p>
<pre dir="ltr">LOG_ARCHIVE_DEST_STATE_2=ENABLE 
</pre></li>
<li>
<p><code dir="ltr">LOG_ARCHIVE_CONFIG</code> - Set the <code dir="ltr">DG_CONFIG</code> attribute in this initialization parameter to include the <code dir="ltr">DB_UNIQUE_NAME</code> of the source database and the downstream database.</p>
<p>For example, if the <code dir="ltr">DB_UNIQUE_NAME</code> of the source database is <code dir="ltr">dbs1</code>, and the <code dir="ltr">DB_UNIQUE_NAME</code> of the downstream database is <code dir="ltr">dbs2</code>, then specify the following parameter:</p>
<pre dir="ltr">LOG_ARCHIVE_CONFIG=&#39;DG_CONFIG=(dbs1,dbs2)&#39;
</pre>
<p>By default, the <code dir="ltr">LOG_ARCHIVE_CONFIG</code> parameter enables a database to both send and receive redo.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink REFRN" href="../REFRN/toc.htm"><span class="italic">Oracle Database Reference</span></a> and <a class="olink SBYDB01100" href="../SBYDB/log_arch_dest_param.htm#SBYDB01100"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> for more information about these initialization parameters</div>
</li>
<li id="BEHJEDAG">
<p>At the downstream database, set the <code dir="ltr">DG_CONFIG</code> attribute in the <code dir="ltr">LOG_ARCHIVE_CONFIG</code> initialization parameter to include the <code dir="ltr">DB_UNIQUE_NAME</code> of the source database and the downstream database.</p>
<p>For example, if the <code dir="ltr">DB_UNIQUE_NAME</code> of the source database is <code dir="ltr">dbs1</code>, and the <code dir="ltr">DB_UNIQUE_NAME</code> of the downstream database is <code dir="ltr">dbs2</code>, then specify the following parameter:</p>
<pre dir="ltr">LOG_ARCHIVE_CONFIG=&#39;DG_CONFIG=(dbs1,dbs2)&#39;
</pre>
<p>By default, the <code dir="ltr">LOG_ARCHIVE_CONFIG</code> parameter enables a database to both send and receive redo.</p>
</li>
<li id="BEHEHBEE">
<p>If you reset any initialization parameters while the instance was running at a database in Step <a href="#BEHGCCHI">3</a> or Step <a href="#BEHJEDAG">4</a>, then you might want to reset them in the initialization parameter file as well, so that the new values are retained when the database is restarted.</p>
<p>If you did not reset the initialization parameters while the instance was running, but instead reset them in the initialization parameter file in Step <a href="#BEHGCCHI">3</a> or Step <a href="#BEHJEDAG">4</a>, then restart the database. The source database must be open when it sends redo log files to the downstream database, because the global name of the source database is sent to the downstream database only if the source database is open.</p>
</li>
</ol>
<p>When these steps are complete, you are ready to perform one of the following tasks:</p>
<ul>
<li>
<p>Configure an archived-log downstream capture process. In this case, see the instructions in the following sections:</p>
<ul>
<li>
<p><a href="config_simple.htm#CACJHHAA">&#34;Configuring Replication Using the DBMS_STREAMS_ADM Package&#34;</a></p>
</li>
<li>
<p><a href="ccap.htm#BEHFHAJH">&#34;Configuring an Archived-Log Downstream Capture Process&#34;</a></p>
</li>
</ul>
</li>
<li>
<p>Add standby redo logs files at the downstream database for a real-time downstream capture process. In this case, see the instructions in <a href="#BEHEGACH">&#34;Adding Standby Redo Logs for Real-Time Downstream Capture&#34;</a>.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="BEHEGACH"></a>
<div id="STREP251" class="sect2">
<h3 class="sect2">Adding Standby Redo Logs for Real-Time Downstream Capture<a id="sthref129"></a><a id="sthref130"></a><a id="sthref131"></a></h3>
<p>The example in this section adds standby redo logs at a downstream database. Standby redo logs are required to configure a real-time downstream capture process. In the example, the source database is <code dir="ltr">dbs1.example.com</code> and the downstream database is <code dir="ltr">dbs2.example.com</code></p>
<p>See <a href="#CACJGEFE">&#34;Decide Whether to Configure Local or Downstream Capture for the Source Database&#34;</a> for information about the differences between real-time and archived-log downstream capture. The steps in this section are required only if you are configuring real-time downstream capture. If you are configuring archived-log downstream capture, then do not complete the steps in this section.</p>
<div class="infoboxnotealso">
<p class="notep1">Tip:</p>
You can use Oracle Enterprise Manager Cloud Control to configure real-time downstream capture. See the Oracle Enterprise Manager Cloud Control online help for instructions.</div>
<p>Complete the following steps to add a standby redo log at the downstream database:</p>
<ol>
<li>
<p>Complete the steps in <a href="#i1014093">&#34;Configuring Log File Transfer to a Downstream Capture Database&#34;</a>.</p>
</li>
<li id="BABDJDGB">
<p>At the downstream database, set the following initialization parameters to configure archiving of the redo data generated locally:</p>
<ul>
<li>
<p>Set at least one archive log destination in the <code dir="ltr">LOG_ARCHIVE_DEST_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code> initialization parameter either to a directory or to the fast recovery area on the computer system running the downstream database. Set the following attributes of this parameter in the following way:</p>
<ul>
<li>
<p><code dir="ltr">LOCATION</code> - Specify either a valid path name for a disk directory or, to use a fast recovery area, specify <code dir="ltr">USE_DB_RECOVERY_FILE_DEST</code>. This location is the local destination for archived redo log files written from the standby redo logs. Log files from a remote source database should be kept separate from local database log files. See <a class="olink BRADV8183" href="../BRADV/rcmconfb.htm#BRADV8183"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> for information about configuring a fast recovery area.</p>
</li>
<li>
<p><code dir="ltr">VALID_FOR</code> - Specify either <code dir="ltr">(ONLINE_LOGFILE,PRIMARY_ROLE)</code> or <code dir="ltr">(ONLINE_LOGFILE,ALL_ROLES)</code>.</p>
</li>
</ul>
<p>The following example is a <code dir="ltr">LOG_ARCHIVE_DEST_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code> setting for the locally generated redo data at the real-time downstream capture database:</p>
<pre dir="ltr">LOG_ARCHIVE_DEST_1=&#39;LOCATION=/home/arc_dest/local_rl_dbs2
   VALID_FOR=(ONLINE_LOGFILE,PRIMARY_ROLE)&#39;
</pre>
<p>A real-time downstream capture configuration should keep archived standby redo log files separate from archived online redo log files generated by the downstream database. Specify <code dir="ltr">ONLINE_LOGFILE</code> instead of <code dir="ltr">ALL_LOGFILES</code> for the redo log type in the <code dir="ltr">VALID_FOR</code> attribute to accomplish this.</p>
<p>You can specify other attributes in the <code dir="ltr">LOG_ARCHIVE_DEST_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code> initialization parameter if necessary.</p>
</li>
<li>
<p>Set the <code dir="ltr">LOG_ARCHIVE_DEST_STATE_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code> initialization parameter that corresponds with the <code dir="ltr">LOG_ARCHIVE_DEST_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code> parameter previously set in this step to <code dir="ltr">ENABLE</code>.</p>
<p>For example, if the <code dir="ltr">LOG_ARCHIVE_DEST_1</code> initialization parameter is set, then set the <code dir="ltr">LOG_ARCHIVE_DEST_STATE_1</code> parameter in the following way:</p>
<pre dir="ltr">LOG_ARCHIVE_DEST_STATE_1=ENABLE 
</pre></li>
</ul>
</li>
<li id="BEHJHIBA">
<p>At the downstream database, set the following initialization parameters to configure the downstream database to receive redo data from the source database and write the redo data to the standby redo log at the downstream database:</p>
<ul>
<li>
<p>Set at least one archive log destination in the <code dir="ltr">LOG_ARCHIVE_DEST_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code> initialization parameter either to a directory or to the fast recovery area on the computer system running the downstream database. Set the following attributes of this parameter in the following way:</p>
<ul>
<li>
<p><code dir="ltr">LOCATION</code> - Specify either a valid path name for a disk directory or, to use a fast recovery area, specify <code dir="ltr">USE_DB_RECOVERY_FILE_DEST</code>. This location is the local destination for archived redo log files written from the standby redo logs. Log files from a remote source database should be kept separate from local database log files. See <a class="olink BRADV8183" href="../BRADV/rcmconfb.htm#BRADV8183"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> for information about configuring a fast recovery area.</p>
</li>
<li>
<p><code dir="ltr">VALID_FOR</code> - Specify either <code dir="ltr">(STANDBY_LOGFILE,PRIMARY_ROLE)</code> or <code dir="ltr">(STANDBY_LOGFILE,ALL_ROLES)</code>.</p>
</li>
</ul>
<p>The following example is a <code dir="ltr">LOG_ARCHIVE_DEST_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code> setting for the redo data received from the source database at the real-time downstream capture database:</p>
<pre dir="ltr">LOG_ARCHIVE_DEST_2=&#39;LOCATION=/home/arc_dest/srl_dbs1
   VALID_FOR=(STANDBY_LOGFILE,PRIMARY_ROLE)&#39;
</pre>
<p>You can specify other attributes in the <code dir="ltr">LOG_ARCHIVE_DEST_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code> initialization parameter if necessary.</p>
</li>
<li>
<p>Set the <code dir="ltr">LOG_ARCHIVE_DEST_STATE_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code> initialization parameter that corresponds with the <code dir="ltr">LOG_ARCHIVE_DEST_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code> parameter previously set in this step to <code dir="ltr">ENABLE</code>.</p>
<p>For example, if the <code dir="ltr">LOG_ARCHIVE_DEST_2</code> initialization parameter is set for the downstream database, then set the <code dir="ltr">LOG_ARCHIVE_DEST_STATE_2</code> parameter in the following way:</p>
<pre dir="ltr">LOG_ARCHIVE_DEST_STATE_2=ENABLE 
</pre></li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink REFRN" href="../REFRN/toc.htm"><span class="italic">Oracle Database Reference</span></a> and <a class="olink SBYDB" href="../SBYDB/toc.htm"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> for more information about these initialization parameters</div>
</li>
<li>
<p>If you reset any initialization parameters while an instance was running at a database in Step <a href="#BABDJDGB">2</a> or <a href="#BEHJHIBA">3</a>, then you might want to reset them in the relevant initialization parameter file as well, so that the new values are retained when the database is restarted.</p>
<p>If you did not reset the initialization parameters while an instance was running, but instead reset them in the initialization parameter file in Step <a href="#BABDJDGB">2</a> or <a href="#BEHJHIBA">3</a>, then restart the database. The source database must be open when it sends redo data to the downstream database, because the global name of the source database is sent to the downstream database only if the source database is open.</p>
</li>
<li>
<p>Create the standby redo log files.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The following steps outline the general procedure for adding standby redo log files to the downstream database. The specific steps and SQL statements used to add standby redo log files depend on your environment. For example, in an Oracle Real Application Clusters (Oracle RAC) environment, the steps are different. See <a class="olink SBYDB00400" href="../SBYDB/log_transport.htm#SBYDB00400"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> for detailed instructions about adding standby redo log files to a database.</div>
<ol>
<li>
<p>In SQL*Plus, connect to the source database <code dir="ltr">dbs1.example.com</code> as an administrative user.</p>
<p>See <a class="olink ADMIN00102" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=ADMIN00102"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about connecting to a database in SQL*Plus.</p>
</li>
<li>
<p>Determine the log file size used on the source database. The standby log file size must exactly match (or be larger than) the source database log file size. For example, if the source database log file size is 500 MB, then the standby log file size must be 500 MB or larger. You can determine the size of the redo log files at the source database (in bytes) by querying the <code dir="ltr">V$LOG</code> view at the source database.</p>
<p>For example, query the <code dir="ltr">V$LOG</code> view:</p>
<pre dir="ltr">SELECT BYTES FROM V$LOG;
</pre></li>
<li>
<p>Determine the number of standby log file groups required on the downstream database. The number of standby log file groups must be at least one more than the number of online log file groups on the source database. For example, if the source database has two online log file groups, then the downstream database must have at least three standby log file groups. You can determine the number of source database online log file groups by querying the <code dir="ltr">V$LOG</code> view at the source database.</p>
<p>For example, query the <code dir="ltr">V$LOG</code> view:</p>
<pre dir="ltr">SELECT COUNT(GROUP#) FROM V$LOG;
</pre></li>
<li>
<p>In SQL*Plus, connect to the downstream database <code dir="ltr">dbs2.example.com</code> as an administrative user.</p>
</li>
<li>
<p>Use the SQL statement <code dir="ltr">ALTER</code> <code dir="ltr">DATABASE</code> <code dir="ltr">ADD</code> <code dir="ltr">STANDBY</code> <code dir="ltr">LOGFILE</code> to add the standby log file groups to the downstream database.</p>
<p>For example, assume that the source database has two online redo log file groups and is using a log file size of 500 MB. In this case, use the following statements to create the appropriate standby log file groups:</p>
<pre dir="ltr">ALTER DATABASE ADD STANDBY LOGFILE GROUP 3
   (&#39;/oracle/dbs/slog3a.rdo&#39;, &#39;/oracle/dbs/slog3b.rdo&#39;) SIZE 500M;

ALTER DATABASE ADD STANDBY LOGFILE GROUP 4
   (&#39;/oracle/dbs/slog4.rdo&#39;, &#39;/oracle/dbs/slog4b.rdo&#39;) SIZE 500M;

ALTER DATABASE ADD STANDBY LOGFILE GROUP 5
   (&#39;/oracle/dbs/slog5.rdo&#39;, &#39;/oracle/dbs/slog5b.rdo&#39;) SIZE 500M;
</pre></li>
<li>
<p>Ensure that the standby log file groups were added successfully by running the following query:</p>
<pre dir="ltr">SELECT GROUP#, THREAD#, SEQUENCE#, ARCHIVED, STATUS
   FROM V$STANDBY_LOG;
</pre>
<p>You output should be similar to the following:</p>
<pre dir="ltr">    GROUP#    THREAD#  SEQUENCE# ARC STATUS
---------- ---------- ---------- --- ----------
         3          0          0 YES UNASSIGNED
         4          0          0 YES UNASSIGNED
         5          0          0 YES UNASSIGNED
</pre></li>
<li>
<p>Ensure that log files from the source database are appearing in the location specified in the <code dir="ltr">LOCATION</code> attribute in Step <a href="#BEHJHIBA">3</a>. You might need to switch the log file at the source database to see files in the directory.</p>
</li>
</ol>
</li>
</ol>
<p>When these steps are complete, you are ready to configure a real-time downstream capture process. See the instructions in the following sections:</p>
<ul>
<li>
<p><a href="config_simple.htm#CACJHHAA">&#34;Configuring Replication Using the DBMS_STREAMS_ADM Package&#34;</a></p>
</li>
<li>
<p><a href="ccap.htm#BEHFDAGE">&#34;Configuring a Real-Time Downstream Capture Process&#34;</a></p>
</li>
</ul>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment91">
<tr>
<td class="cellalignment98">
<table class="cellalignment96">
<tr>
<td class="cellalignment95"><a href="ptrep_config.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment95"><a href="config_simple.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment100">
<table class="cellalignment94">
<tr>
<td class="cellalignment95"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment95"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment95"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment95"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment95"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment95"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>