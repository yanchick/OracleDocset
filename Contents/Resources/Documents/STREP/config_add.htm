<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-104191"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Adding%20to%20an%20Oracle%20Streams%20Replication%20Environment"></a><title>Adding to an Oracle Streams Replication Environment</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1044"/>
<meta name="dcterms.created" content="2015-02-12T7:14:19Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Streams Replication Administrator&#39;s Guide"/>
<meta name="dcterms.identifier" content="E53118-02"/>
<meta name="dcterms.isVersionOf" content="STREP"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="config_flex.htm" title="Previous" type="text/html"/>
<link rel="Next" href="ccap.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E53118-02.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">9/28</span> <!-- End Header -->
<div id="STREP058" class="chapter"><a id="CBHGEGGH"></a>
<h1 class="chapter"><span class="secnum">4</span> Adding to an Oracle Streams Replication Environment</h1>
<p><a id="sthref223"></a><a id="sthref224"></a>This chapter contains instructions for adding database objects and databases to an existing Oracle Streams replication environment.</p>
<p>This chapter contains these topics:</p>
<ul>
<li>
<p><a href="#BABCEGAB">About Adding to an Oracle Streams Replication Environment</a></p>
</li>
<li>
<p><a href="#BABFHIIJ">Adding Multiple Components Using a Single Procedure</a></p>
</li>
<li>
<p><a href="#BABDFIBB">Adding Components Individually in Multiple Steps</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1"><span class="bold">Note</span>:</p>
Certain types of database objects are not supported by Oracle Streams. When you extend an Oracle Streams environment, ensure that no capture process attempts to capture changes to an unsupported database object. Also, ensure that no synchronous capture or apply process attempts to process changes to unsupported columns. To list unsupported database objects and unsupported columns, query the <code dir="ltr">DBA_STREAMS_UNSUPPORTED</code> and <code dir="ltr">DBA_STREAMS_COLUMNS</code> data dictionary views.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="config_simple.htm#CACFECJJ">Chapter 2, &#34;Simple Oracle Streams Replication Configuration&#34;</a></p>
</li>
<li>
<p><a href="config_flex.htm#BABBDABC">Chapter 3, &#34;Flexible Oracle Streams Replication Configuration&#34;</a></p>
</li>
<li>
<p><a class="olink STRMS172" href="../STRMS/strms_otmon.htm#STRMS172"><span class="italic">Oracle Streams Concepts and Administration</span></a> for instructions on determining which database objects are not supported by Oracle Streams</p>
</li>
</ul>
</div>
<a id="BABCEGAB"></a>
<div id="STREP610" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">About Adding to an Oracle Streams Replication Environment</h2>
<p>Sometimes it is necessary to extend an Oracle Streams replication environment when the needs of your organization change. You can extend an Oracle Streams replication environment by adding database objects or databases.</p>
<p>There are three ways to extend an Oracle Streams replication environment:</p>
<ul>
<li>
<p><a href="#BABBIBDA">About Using the Setup Streams Replication Wizard or a Single Configuration Procedure</a></p>
</li>
<li>
<p><a href="#BABGEBHH">About Adding the Oracle Streams Components Individually in Multiple Steps</a></p>
</li>
</ul>
<a id="BABBIBDA"></a>
<div id="STREP611" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">About Using the Setup Streams Replication Wizard or a Single Configuration Procedure</h3>
<p>There are two easy ways to extend an Oracle Streams replication environment:</p>
<ul>
<li>
<p>Run the Setup Streams Replication Wizard in Oracle Enterprise Manager Cloud Control</p>
</li>
<li>
<p>Run one of the following procedures in the <a class="olink ARPLS305" href="../ARPLS/d_streams_adm.htm#ARPLS305"><code dir="ltr">DBMS_STREAMS_ADM</code></a> package:</p>
<ul>
<li>
<p>The <a class="olink ARPLS825" href="../ARPLS/d_streams_adm.htm#ARPLS825"><code dir="ltr">MAINTAIN_GLOBAL</code> procedure</a> can add a new database to an environment that replicates changes to all of the database objects in the databases.</p>
</li>
<li>
<p>The <a class="olink ARPLS826" href="../ARPLS/d_streams_adm.htm#ARPLS826"><code dir="ltr">MAINTAIN_SCHEMAS</code> procedure</a> can add one or more new schemas to the existing databases in the replication environment, or it can add a new database that replicates schemas that are currently being replicated.</p>
</li>
<li>
<p>The <a class="olink ARPLS863" href="../ARPLS/d_streams_adm.htm#ARPLS863"><code dir="ltr">MAINTAIN_SIMPLE_TTS</code> procedure</a> can add a new simple tablespace to an existing replication environment, or it can add a new database that replicates a simple tablespace that is currently being replicated.</p>
</li>
<li>
<p>The <a class="olink ARPLS827" href="../ARPLS/d_streams_adm.htm#ARPLS827"><code dir="ltr">MAINTAIN_TABLES</code> procedure</a> can add one or more new tables to the existing databases in the replication environment, or it can add a new database that replicates tables that are currently being replicated.</p>
</li>
<li>
<p>The <a class="olink ARPLS864" href="../ARPLS/d_streams_adm.htm#ARPLS864"><code dir="ltr">MAINTAIN_TTS</code> procedure</a> can add a new set of tablespaces to an existing replication environment, or it can add a new database that replicates a set of tablespaces that are currently being replicated.</p>
</li>
</ul>
</li>
</ul>
<p>To use either of these methods to extend an Oracle Streams replication environment, the environment must meet the following conditions:</p>
<ul>
<li>
<p>It must be a two-database or hub-and-spoke replication environment that was configured by the Setup Streams Replication Wizard or by one of the configuration procedures in the <code dir="ltr">DBMS_STREAMS_ADM</code> package. See <a href="prep_rep.htm#BABFCICA">&#34;Decide Which Type of Replication Environment to Configure&#34;</a> for information about these types of replication environments.</p>
</li>
<li>
<p>It cannot use a synchronous capture at any database in the Oracle Streams replication environment. See <a class="olink STRMS168" href="../STRMS/strms_capture.htm#STRMS168"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information about synchronous capture.</p>
</li>
<li>
<p>If you are adding a database to the environment, then each database that captures changes must use a local capture process. No database can use a downstream capture process. If you are adding one or more database objects to the environment, then the databases can use either local or downstream capture processes. See <a href="prep_rep.htm#CACJGEFE">&#34;Decide Whether to Configure Local or Downstream Capture for the Source Database&#34;</a> for more information about downstream capture.</p>
</li>
<li>
<p>If you are adding database objects to the replication environment, then the database objects must exist at the database specified in the <code dir="ltr">source_database</code> parameter of the configuration procedure.</p>
</li>
</ul>
<p>If your environment meets these conditions, then you can use the Setup Streams Replication Wizard or a single procedure to extend the environment.</p>
<p>The following are additional requirements for cases in which the replicated database objects already exist at an intended destination database before you run the wizard or procedure:</p>
<ul>
<li>
<p>If you are adding database objects to the replication environment, and one or more of these database objects exist at a database other than the source database, then meet the following requirements:</p>
<ul>
<li>
<p>Before running the wizard or procedure, ensure that the replicated database objects at each destination database are consistent with replicated database objects at the source database.</p>
</li>
<li>
<p>After running the wizard or procedure, ensure that the instantiation SCN is set for each replicated database object at each destination database. See <a href="instant.htm#i1009604">&#34;Setting Instantiation SCNs at a Destination Database&#34;</a> and <a href="instant.htm#i1012704">&#34;Monitoring Instantiation&#34;</a><a href="instant.htm#i1012704">&#34;Monitoring Instantiation&#34;</a>.</p>
</li>
</ul>
</li>
<li>
<p>If you are adding a database to the replication environment, then any of the database objects that are replicated in the current environment exist at the added database, then meet the following requirements:</p>
<ul>
<li>
<p>Before running the wizard or procedure, ensure that the replicated database objects at each database being added are consistent with replicated database objects at the source database.</p>
</li>
<li>
<p>After running the wizard or procedure, ensure that the instantiation SCN is set for each replicated database object at the added database. See <a href="instant.htm#i1009604">&#34;Setting Instantiation SCNs at a Destination Database&#34;</a> and <a href="instant.htm#i1012704">&#34;Monitoring Instantiation&#34;</a><a href="instant.htm#i1012704">&#34;Monitoring Instantiation&#34;</a>.</p>
</li>
</ul>
</li>
</ul>
<p>For instructions about adding to a replication environment using the wizard or a single procedure, see the following documentation:</p>
<ul>
<li>
<p>The Oracle Enterprise Manager Cloud Control online help for instructions about using the Setup Streams Replication Wizard</p>
</li>
<li>
<p><a href="#BABFHIIJ">&#34;Adding Multiple Components Using a Single Procedure&#34;</a> for instructions about using a single procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ARPLS878" href="../ARPLS/d_streams_adm.htm#ARPLS878"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the procedures in the <code dir="ltr">DBMS_STREAMS_ADM</code> chapter</div>
</div>
<!-- class="sect2" -->
<a id="BABGEBHH"></a>
<div id="STREP612" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">About Adding the Oracle Streams Components Individually in Multiple Steps</h3>
<p>If you cannot extend the Oracle Streams replication environment by using the Setup Streams Replication Wizard or a configuration procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package, then you must complete the configuration steps manually. These steps include adding the necessary rules and Oracle Streams components to the environment, and other configuration steps.</p>
<p>If you must extend the Oracle Streams replication environment manually, then see the instructions in <a href="#BABDFIBB">&#34;Adding Components Individually in Multiple Steps&#34;</a>.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABFHIIJ"></a>
<div id="STREP613" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Adding Multiple Components Using a Single Procedure</h2>
<p>This section describes adding Oracle Streams components a single PL/SQL procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package. Oracle Streams components include queues, rules, rule sets, capture processes, synchronous captures, propagations, and apply processes.</p>
<p>This section contains these topics:</p>
<ul>
<li>
<p><a href="#BABJHGHG">Adding Database Objects to a Replication Environment Using a Single Procedure</a></p>
</li>
<li>
<p><a href="#BABICAIA">Adding a Database to a Replication Environment Using a Single Procedure</a></p>
</li>
</ul>
<a id="BABJHGHG"></a>
<div id="STREP614" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Adding Database Objects to a Replication Environment Using a Single Procedure<a id="sthref225"></a><a id="sthref226"></a><a id="sthref227"></a></h3>
<p>This topic includes an example that uses the <code dir="ltr">MAINTAIN_TABLES</code> procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package to add tables to an existing hub-and-spoke replication environment. When the example is complete, the Oracle Streams replication environment replicates the changes made to the added tables at the databases in the environment.</p>
<p>Specifically, the example in this topic extends the replication environment configured in <a href="config_simple.htm#CIAFABEC">&#34;Example That Configures Hub-and-Spoke Replication&#34;</a>. That configuration has the following characteristics:</p>
<ul>
<li>
<p>The <code dir="ltr">hr</code> schema is replicated at the <code dir="ltr">hub.example.com</code>, <code dir="ltr">spoke1.example.com</code>, and <code dir="ltr">spoke2.example.com</code> databases.</p>
</li>
<li>
<p>The <code dir="ltr">hub.example.com</code> database is the hub database in the hub-and-spoke environment, while the other databases are the spoke databases.</p>
</li>
<li>
<p>The spoke databases allow changes to the replicated schema, and each database has a local capture process to capture these changes.</p>
</li>
<li>
<p>Update conflict handlers are configured for each replicated table at each database to resolve conflicts</p>
</li>
</ul>
<p>This example adds the following tables to the environment:</p>
<ul>
<li>
<p><code dir="ltr">oe.orders</code></p>
</li>
<li>
<p><code dir="ltr">oe.order_items</code></p>
</li>
</ul>
<p>This example uses the tables in the <code dir="ltr">oe</code> sample schema. The <code dir="ltr">oe</code> sample schema is installed by default with Oracle Database.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Before you use a configuration procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package to extend an Oracle Streams replication environment, ensure that the environment meets the conditions described in <a href="#BABBIBDA">&#34;About Using the Setup Streams Replication Wizard or a Single Configuration Procedure&#34;</a>.</div>
<p>Complete the following steps:</p>
<ol>
<li>
<p>Ensure that the following directory objects exist, and remove any files related to the previous configuration from them, including Data Pump export dump files and export log files:</p>
<ul>
<li>
<p>The <code dir="ltr">hub_dir</code> directory object at the <code dir="ltr">hub.example.com</code> database.</p>
</li>
<li>
<p>The <code dir="ltr">spoke1_dir</code> directory object at the <code dir="ltr">spoke1.example.com</code> database.</p>
</li>
<li>
<p>The <code dir="ltr">spoke2_dir</code> directory object at the <code dir="ltr">spoke2.example.com</code> database.</p>
</li>
</ul>
</li>
<li id="BABJGCAJ">
<p>Stop the capture process at the hub database in the hub-and-spoke environment.</p>
<p>Use the <code dir="ltr">STOP_CAPTURE</code> procedure in the <code dir="ltr">DBMS_CAPTURE_ADM</code> package to stop a capture process.</p>
<p>In this example, stop the capture process at the <code dir="ltr">hub.example.com</code> database. The replicated database objects can remain open to changes while the capture process is stopped. These changes will be captured when the capture process is restarted.</p>
</li>
<li>
<p>In SQL*Plus, run the appropriate configuration procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package at the hub database to add each new database object for each spoke database.</p>
<p>You might need to run the procedure several times if the environment has multiple spoke databases. In this example, complete the following steps:</p>
<ol>
<li>
<p>Open SQL*Plus and connect to the <code dir="ltr">hub.example.com</code> database as the Oracle Streams administrator.</p>
<p>See <a class="olink ADMQS0361" href="../ADMQS/GUID-DE8A79BD-FAE4-4364-98FF-D2BD992A06E7.htm#ADMQS0361"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information about starting SQL*Plus.</p>
</li>
<li>
<p>Run the <code dir="ltr">MAINTAIN_TABLES</code> procedure to add the <code dir="ltr">oe.orders</code> and <code dir="ltr">oe.order_items</code> tables for replication between <code dir="ltr">hub.example.com</code> and <code dir="ltr">spoke1.example.com</code>:</p>
<pre dir="ltr">DECLARE
  tables DBMS_UTILITY.UNCL_ARRAY;
  BEGIN
    tables(1) := &#39;oe.orders&#39;;
    tables(2) := &#39;oe.order_items&#39;;
    DBMS_STREAMS_ADM.MAINTAIN_TABLES(
      table_names                  =&gt; tables,
      source_directory_object      =&gt; &#39;hub_dir&#39;,
      destination_directory_object =&gt; &#39;spoke1_dir&#39;,
      source_database              =&gt; &#39;hub.example.com&#39;,
      destination_database         =&gt; &#39;spoke1.example.com&#39;,
      capture_name                 =&gt; &#39;capture_hns&#39;,
      capture_queue_table          =&gt; &#39;source_hns_qt&#39;,
      capture_queue_name           =&gt; &#39;source_hns&#39;,
      propagation_name             =&gt; &#39;propagation_spoke1&#39;,
      apply_name                   =&gt; &#39;apply_spoke1&#39;,
      apply_queue_table            =&gt; &#39;destination_spoke1_qt&#39;,
      apply_queue_name             =&gt; &#39;destination_spoke1&#39;,
      bi_directional               =&gt; TRUE);
END;
/
</pre>
<p>The <code dir="ltr">MAINTAIN_TABLES</code> procedure can take some time to run because it is performing many configuration tasks. Do not allow data manipulation language (DML) or data definition language (DDL) changes to the specified tables at the destination database while the procedure is running. When the procedure completes, the new database objects are added to the environment, and the capture process that was stopped in Step <a href="#BABJGCAJ">2</a> is restarted.</p>
<p>When a configuration procedure is run, information about its progress is recorded in the following data dictionary views: <code dir="ltr">DBA_RECOVERABLE_SCRIPT</code>, <code dir="ltr">DBA_RECOVERABLE_SCRIPT_PARAMS</code>, <code dir="ltr">DBA_RECOVERABLE_SCRIPT_BLOCKS</code>, and <code dir="ltr">DBA_RECOVERABLE_SCRIPT_ERRORS</code>. If the procedure stops because it encounters an error, then see <a class="olink STREP149" href="../STREP/man_gen_rep.htm#STREP149"><span class="italic">Oracle Streams Replication Administrator&#39;s Guide</span></a> for instructions about using the <code dir="ltr">RECOVER_OPERATION</code> procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package to recover from these errors.</p>
<p>The parameter values that specify Oracle Streams component names must be the same as the values specified in the configuration procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package that configured the replication environment. The Oracle Streams component names specified include the capture process name, queue names, queue table names, the propagation name, and the apply process name. In this example, the Oracle Streams component names match the ones specified in <a href="config_simple.htm#CIAFABEC">&#34;Example That Configures Hub-and-Spoke Replication&#34;</a>.</p>
</li>
<li>
<p>Run the <code dir="ltr">MAINTAIN_TABLES</code> procedure to add the <code dir="ltr">oe.orders</code> and <code dir="ltr">oe.order_items</code> tables for replication between <code dir="ltr">hub.example.com</code> and <code dir="ltr">spoke2.example.com</code>:</p>
<pre dir="ltr">DECLARE
  tables DBMS_UTILITY.UNCL_ARRAY;
  BEGIN
    tables(1) := &#39;oe.orders&#39;;
    tables(2) := &#39;oe.order_items&#39;;
    DBMS_STREAMS_ADM.MAINTAIN_TABLES(
      table_names                  =&gt; tables,
      source_directory_object      =&gt; &#39;hub_dir&#39;,
      destination_directory_object =&gt; &#39;spoke2_dir&#39;,
      source_database              =&gt; &#39;hub.example.com&#39;,
      destination_database         =&gt; &#39;spoke2.example.com&#39;,
      capture_name                 =&gt; &#39;capture_hns&#39;,
      capture_queue_table          =&gt; &#39;source_hns_qt&#39;,
      capture_queue_name           =&gt; &#39;source_hns&#39;,
      propagation_name             =&gt; &#39;propagation_spoke2&#39;,
      apply_name                   =&gt; &#39;apply_spoke2&#39;,
      apply_queue_table            =&gt; &#39;destination_spoke2_qt&#39;,
      apply_queue_name             =&gt; &#39;destination_spoke2&#39;,
      bi_directional               =&gt; TRUE);
END;
/
</pre></li>
</ol>
</li>
<li>
<p>Set the instantiation SCN for the replicated tables at the spoke databases:</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
This step is required in this example because the replicated tables existed at the spoke databases before the <code dir="ltr">MAINTAIN_TABLES</code> procedure was run. If the replicated tables did not exist at the spoke databases before the <code dir="ltr">MAINTAIN_TABLES</code> procedure was run, then the procedure sets the instantiation SCN for the replicated tables and this step is not required. Ensure that the data in the shared table is consistent at the source and destination databases when the instantiation SCN is set and that no changes are made to the table at the source database until after the SCN that is used for the instantiation SCN.</div>
<ol>
<li>
<p>In SQL*Plus, connect to the <code dir="ltr">hub.example.com</code> database as the Oracle Streams administrator.</p>
<p>See <a class="olink ADMIN00102" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=ADMIN00102"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about connecting to a database in SQL*Plus.</p>
</li>
<li>
<p>Set the instantiation SCN for the <code dir="ltr">oe.orders</code> table at the <code dir="ltr">spoke1.example.com</code> database:</p>
<pre dir="ltr">DECLARE
  iscn  NUMBER;    -- Variable to hold instantiation SCN value
BEGIN
  iscn := DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER();
  DBMS_APPLY_ADM.SET_TABLE_INSTANTIATION_SCN@spoke1.example.com(
    source_object_name    =&gt; &#39;oe.orders&#39;,
    source_database_name  =&gt; &#39;hub.example.com&#39;,
    instantiation_scn     =&gt; iscn);
END;
/
</pre></li>
<li>
<p>Set the instantiation SCN for the <code dir="ltr">oe.order_items</code> table at the <code dir="ltr">spoke1.example.com</code> database:</p>
<pre dir="ltr">DECLARE
  iscn  NUMBER;    -- Variable to hold instantiation SCN value
BEGIN
  iscn := DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER();
  DBMS_APPLY_ADM.SET_TABLE_INSTANTIATION_SCN@spoke1.example.com(
    source_object_name    =&gt; &#39;oe.order_items&#39;,
    source_database_name  =&gt; &#39;hub.example.com&#39;,
    instantiation_scn     =&gt; iscn);
END;
/
</pre></li>
<li>
<p>Set the instantiation SCN for the <code dir="ltr">oe.orders</code> table at the <code dir="ltr">spoke2.example.com</code> database:</p>
<pre dir="ltr">DECLARE
  iscn  NUMBER;    -- Variable to hold instantiation SCN value
BEGIN
  iscn := DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER();
  DBMS_APPLY_ADM.SET_TABLE_INSTANTIATION_SCN@spoke2.example.com(
    source_object_name    =&gt; &#39;oe.orders&#39;,
    source_database_name  =&gt; &#39;hub.example.com&#39;,
    instantiation_scn     =&gt; iscn);
END;
/
</pre></li>
<li>
<p>Set the instantiation SCN for the <code dir="ltr">oe.order_items</code> table at the <code dir="ltr">spoke2.example.com</code> database:</p>
<pre dir="ltr">DECLARE
  iscn  NUMBER;    -- Variable to hold instantiation SCN value
BEGIN
  iscn := DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER();
  DBMS_APPLY_ADM.SET_TABLE_INSTANTIATION_SCN@spoke2.example.com(
    source_object_name    =&gt; &#39;oe.order_items&#39;,
    source_database_name  =&gt; &#39;hub.example.com&#39;,
    instantiation_scn     =&gt; iscn);
END;
/
</pre></li>
</ol>
</li>
<li>
<p>Configure latest time conflict resolution for the <code dir="ltr">orders</code> and <code dir="ltr">order_items</code> tables in the <code dir="ltr">oe</code> schema at the <code dir="ltr">hub.example.com</code>, <code dir="ltr">spoke1.example.com</code>, and <code dir="ltr">spoke2.example.com</code> databases. See <a href="conflict.htm#CHDDHEAF">&#34;Prebuilt Update Conflict Handlers&#34;</a> for instructions.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="BABICAIA"></a>
<div id="STREP615" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Adding a Database to a Replication Environment Using a Single Procedure<a id="sthref228"></a><a id="sthref229"></a><a id="sthref230"></a></h3>
<p>This topic includes an example that uses the <code dir="ltr">MAINTAIN_SCHEMAS</code> procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package to add a new spoke database to an existing hub-and-spoke replication environment. When the example is complete, the Oracle Streams replication environment replicates the changes made to the schema with the new database.</p>
<p>Specifically, the example in this topic extends the replication environment configured in <a href="config_simple.htm#CIAFABEC">&#34;Example That Configures Hub-and-Spoke Replication&#34;</a>. That configuration has the following characteristics:</p>
<ul>
<li>
<p>The <code dir="ltr">hr</code> schema is replicated at the <code dir="ltr">hub.example.com</code>, <code dir="ltr">spoke1.example.com</code>, and <code dir="ltr">spoke2.example.com</code> databases.</p>
</li>
<li>
<p>The <code dir="ltr">hub.example.com</code> database is the hub database in the hub-and-spoke environment, while the other databases are the spoke databases.</p>
</li>
<li>
<p>The spoke databases allow changes to the replicated schema, and each database has a local capture process to capture these changes.</p>
</li>
</ul>
<p>This example adds the <code dir="ltr">spoke3.example.com</code> database to the environment.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Before you use a configuration procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package to extend an Oracle Streams replication environment, ensure that the environment meets the conditions described in <a href="#BABBIBDA">&#34;About Using the Setup Streams Replication Wizard or a Single Configuration Procedure&#34;</a>.</div>
<p>Complete the following steps:</p>
<ol>
<li>
<p>Complete the following tasks to prepare the environment for the new database:</p>
<ol>
<li>
<p>Configure network connectivity so that the hub database can communicate with the new spoke database. In this example, configure network connectivity so that the <code dir="ltr">hub.example.com</code> database and the <code dir="ltr">spoke3.example.com</code> databases can communicate with each other.</p>
<p>See <a class="olink ADMQS004" href="../ADMQS/GUID-C6DD213A-D37E-4905-983D-F9DCA8AE286A.htm#ADMQS004"><span class="italic">Oracle Database 2 Day DBA</span></a> for information about configuring network connectivity between databases.</p>
</li>
<li>
<p>Configure an Oracle Streams administrator at the new spoke database. In this example, configure an Oracle Streams administrator at the <code dir="ltr">spoke3.example.com</code> database. See <a href="prep_rep.htm#BABHEJGG">&#34;Configuring an Oracle Streams Administrator on All Databases&#34;</a> for instructions. This example assumes that the Oracle Streams administrator is <code dir="ltr">strmadmin</code>.</p>
</li>
<li>
<p>Create a database link from the hub database to new spoke database and from new spoke database to the hub database. In this example, create the following database links:</p>
<ul>
<li>
<p>From the <code dir="ltr">hub.example.com</code> database to the <code dir="ltr">spoke3.example.com</code> database. Both the name and the service name of the database link must be <code dir="ltr">spoke3.example.com</code>.</p>
</li>
<li>
<p>From the <code dir="ltr">spoke3.example.com</code> database to the <code dir="ltr">hub.example.com</code> database. Both the name and the service name of the database link must be <code dir="ltr">hub.example.com</code>.</p>
</li>
</ul>
<p>Each database link should be created in the Oracle Streams administrator&#39;s schema. Also, each database link should connect to the Oracle Streams administrator at the destination database. See <a href="prep_rep.htm#BABDCFHC">&#34;Configuring Network Connectivity and Database Links&#34;</a> for instructions.</p>
</li>
<li>
<p>Set initialization parameters properly at the new spoke database. In this example, set initialization parameters properly at the <code dir="ltr">spoke3.example.com</code> database. See <a href="prep_rep.htm#BABFJJIH">&#34;Setting Initialization Parameters Relevant to Oracle Streams&#34;</a> for instructions.</p>
</li>
<li>
<p>Configure the new spoke database to run in <code dir="ltr">ARCHIVELOG</code> mode. For a capture process to capture changes generated at a source database, the source database must be running in <code dir="ltr">ARCHIVELOG</code> mode. In this example, configure the <code dir="ltr">spoke3.example.com</code> database to run in <code dir="ltr">ARCHIVELOG</code> mode. See <a class="olink ADMIN008" href="../ADMIN/archredo.htm#ADMIN008"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about configuring a database to run in <code dir="ltr">ARCHIVELOG</code> mode.</p>
</li>
<li>
<p>Ensure that the <code dir="ltr">hub_dir</code> directory objects exist at the <code dir="ltr">hub.example.com</code> database, and remove any files related to the previous configuration from it, including Data Pump export dump files and export log files.</p>
</li>
</ol>
</li>
<li>
<p>Open SQL*Plus and connect to the <code dir="ltr">spoke3.example.com</code> database as the Oracle Streams administrator.</p>
<p>See <a class="olink ADMQS0361" href="../ADMQS/GUID-DE8A79BD-FAE4-4364-98FF-D2BD992A06E7.htm#ADMQS0361"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information about starting SQL*Plus.</p>
</li>
<li>
<p><a id="sthref231"></a>Create a directory object to hold files that will be generated by the <code dir="ltr">MAINTAIN_SCHEMAS</code> procedure, including the Data Pump export dump file used for instantiation. The directory object can point to any accessible directory on the computer system. For example, the following statement creates a directory object named <code dir="ltr">spoke3_dir</code> that points to the /usr/spoke3_log_files directory:</p>
<pre dir="ltr">CREATE DIRECTORY spoke3_dir AS &#39;/usr/spoke3_log_files&#39;;
</pre></li>
<li id="BABJAHBD">
<p>Stop the capture process at the hub database in the hub-and-spoke environment.</p>
<p>Use the <code dir="ltr">STOP_CAPTURE</code> procedure in the <code dir="ltr">DBMS_CAPTURE_ADM</code> package to stop a capture process.</p>
<p>In this example, stop the capture process at the <code dir="ltr">hub.example.com</code> database. The replicated database objects can remain open to changes while the capture process is stopped. These changes will be captured when the capture process is restarted.</p>
</li>
<li>
<p>In SQL*Plus, run the appropriate configuration procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package at the hub database to add the new spoke database.</p>
<p>In this example, complete the following steps:</p>
<ol>
<li>
<p>Open SQL*Plus and connect to the <code dir="ltr">hub.example.com</code> database as the Oracle Streams administrator.</p>
</li>
<li>
<p>Run the <code dir="ltr">MAINTAIN_SCHEMAS</code> procedure to add the <code dir="ltr">spoke3.example.com</code> database to the Oracle Streams replication environment:</p>
<pre dir="ltr">BEGIN
  DBMS_STREAMS_ADM.MAINTAIN_SCHEMAS(
    schema_names                 =&gt; &#39;hr&#39;,
    source_directory_object      =&gt; &#39;hub_dir&#39;,
    destination_directory_object =&gt; &#39;spoke3_dir&#39;,
    source_database              =&gt; &#39;hub.example.com&#39;,
    destination_database         =&gt; &#39;spoke3.example.com&#39;,
    capture_name                 =&gt; &#39;capture_hns&#39;,
    capture_queue_table          =&gt; &#39;source_hns_qt&#39;,
    capture_queue_name           =&gt; &#39;source_hns&#39;,
    propagation_name             =&gt; &#39;propagation_spoke3&#39;,
    apply_name                   =&gt; &#39;apply_spoke3&#39;,
    apply_queue_table            =&gt; &#39;destination_spoke3_qt&#39;,
    apply_queue_name             =&gt; &#39;destination_spoke3&#39;,
    bi_directional               =&gt; TRUE);
END;
/
</pre>
<p>The <code dir="ltr">MAINTAIN_SCHEMAS</code> procedure can take some time to run because it is performing many configuration tasks. Do not allow data manipulation language (DML) or data definition language (DDL) changes to the database objects in the specified schema at the destination database while the procedure is running. When the procedure completes, the new database objects are added to the environment, and the capture process that was stopped in Step <a href="#BABJAHBD">4</a> is restarted.</p>
<p>The parameter values specified in <code dir="ltr">capture_name</code>, <code dir="ltr">capture_queue_table</code>, and <code dir="ltr">capture_queue_name</code> must be the same as the values specified in the configuration procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package that configured the replication environment. In this example, these parameter values match the ones specified in <a href="config_simple.htm#CIAFABEC">&#34;Example That Configures Hub-and-Spoke Replication&#34;</a>.</p>
<p>When a configuration procedure is run, information about its progress is recorded in the following data dictionary views: <code dir="ltr">DBA_RECOVERABLE_SCRIPT</code>, <code dir="ltr">DBA_RECOVERABLE_SCRIPT_PARAMS</code>, <code dir="ltr">DBA_RECOVERABLE_SCRIPT_BLOCKS</code>, and <code dir="ltr">DBA_RECOVERABLE_SCRIPT_ERRORS</code>. If the procedure stops because it encounters an error, then see <a class="olink STREP149" href="../STREP/man_gen_rep.htm#STREP149"><span class="italic">Oracle Streams Replication Administrator&#39;s Guide</span></a> for instructions about using the <code dir="ltr">RECOVER_OPERATION</code> procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package to recover from these errors.</p>
</li>
</ol>
</li>
<li>
<p>Configure latest time conflict resolution for all of the tables in the <code dir="ltr">hr</code> schema at the <code dir="ltr">spoke3.example.com</code> database. This schema includes the <code dir="ltr">countries</code>, <code dir="ltr">departments</code>, <code dir="ltr">employees</code>, <code dir="ltr">jobs</code>, <code dir="ltr">job_history</code>, <code dir="ltr">locations</code>, and <code dir="ltr">regions</code> tables. See <a href="conflict.htm#CHDDHEAF">&#34;Prebuilt Update Conflict Handlers&#34;</a> for instructions.</p>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABDFIBB"></a>
<div id="STREP616" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Adding Components Individually in Multiple Steps</h2>
<p>This section describes adding Oracle Streams components separately to extend a replication environment. Oracle Streams components include queues, rules, rule sets, capture processes, synchronous captures, propagations, and apply processes.</p>
<p>This section contains these topics:</p>
<ul>
<li>
<p><a href="#i1010163">Adding Replicated Objects to an Existing Single-Source Environment</a></p>
</li>
<li>
<p><a href="#i1010321">Adding a New Destination Database to a Single-Source Environment</a></p>
</li>
<li>
<p><a href="#i1010690">Adding Replicated Objects to an Existing Multiple-Source Environment</a></p>
</li>
<li>
<p><a href="#i1010925">Adding a New Database to an Existing Multiple-Source Environment</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
<ul>
<li>
<p>When possible, it is usually easier to extend an Oracle Streams replication environment using either a single procedure or the Setup Streams Replication Wizard in Oracle Enterprise Manager Cloud Control. See <a href="#BABFHIIJ">&#34;Adding Multiple Components Using a Single Procedure&#34;</a> for instructions about using a single procedure and the Oracle Enterprise Manager Cloud Control online help for instructions about using the wizard.</p>
</li>
<li>
<p>The instructions in the following sections assume you will use the <code dir="ltr">DBMS_STREAMS_ADM</code> package to configure your Oracle Streams environment. If you use other packages, then extra steps might be necessary for each task.</p>
</li>
</ul>
</div>
<a id="i1010163"></a>
<div id="STREP281" class="sect2">
<h3 class="sect2">Adding Replicated Objects to an Existing Single-Source Environment<a id="sthref232"></a><a id="sthref233"></a><a id="sthref234"></a></h3>
<p>You can add existing database objects to an existing single-source environment by adding the necessary rules to the appropriate capture processes, synchronous captures, propagations, and apply processes. Before creating or altering capture or propagation rules in a running Oracle Streams environment, ensure that any propagations or apply processes that will receive logical change records (LCRs) because of the new or altered rules are configured to handle these LCRs. That is, the propagations or apply processes should exist, and each one should be associated with rule sets that handle the LCRs appropriately. If these propagations and apply processes are not configured properly to handle these LCRs, then LCRs might be lost.</p>
<p>For example, suppose you want to add a table to an Oracle Streams replication environment that already captures, propagates, and applies changes to other tables. Assume that only one capture process or synchronous captures will capture changes to this table, and only one apply process will apply changes to this table. In this case, you must add one or more table rules to the following rule sets:</p>
<ul>
<li>
<p>The positive rule set for the apply process that will apply changes to the table</p>
</li>
<li>
<p>The positive rule set for each propagation that will propagate changes to the table</p>
</li>
<li>
<p>The positive rule set for the capture process or synchronous capture that will capture changes to the table</p>
</li>
</ul>
<p>If you perform administrative steps in the wrong order, you can lose LCRs. For example, if you add the rule to a capture process rule set first, without stopping the capture process, then the propagation will not propagate the changes if it does not have a rule that instructs it to do so, and the changes can be lost.</p>
<p>This example assumes that the replicated database objects are read-only at the destination databases. If the replicated database objects are read/write at the destination databases, then the replication environment will not stay synchronized because Oracle Streams is not configured to replicate the changes made to the replicated database objects at the destination databases.</p>
<p><a href="#i1013540">Figure 4-1</a> shows the additional configuration steps that must be completed to add replicated database objects to a single-source Oracle Streams environment.</p>
<div id="STREP282" class="figure">
<p class="titleinfigure"><a id="i1013540"></a>Figure 4-1 Example of Adding Replicated Objects to a Single-Source Environment</p>
<img width="423" height="485" src="img/strep041.gif" alt="Description of Figure 4-1 follows"/><br/>
<a id="sthref235" href="img_text/strep041.htm">Description of &#34;Figure 4-1 Example of Adding Replicated Objects to a Single-Source Environment&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>To avoid losing LCRs, complete the configuration in the following order:</p>
<ol>
<li>
<p>At each source database where replicated database objects are being added, specify supplemental logging for the added replicated database objects. See <a href="prep_rep.htm#i1008208">&#34;Specifying Supplemental Logging&#34;</a> for instructions.</p>
</li>
<li id="i1010179">
<p>Either stop the capture process, one of the propagations, or the apply processes:</p>
<ul>
<li>
<p>Use the <code dir="ltr">STOP_CAPTURE</code> procedure in the <code dir="ltr">DBMS_CAPTURE_ADM</code> package to stop a capture process.</p>
</li>
<li>
<p>Use the <code dir="ltr">STOP_PROPAGATION</code> procedure in the <code dir="ltr">DBMS_PROPAGATION_ADM</code> package to stop a propagation.</p>
</li>
<li>
<p>Use the <code dir="ltr">STOP_APPLY</code> procedure in the <code dir="ltr">DBMS_APPLY_ADM</code> package to stop an apply process.</p>
</li>
</ul>
<p>In general, it is best to stop the capture process so that messages do not accumulate in queues during the operation.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Synchronous captures cannot be stopped.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS" href="../STRMS/toc.htm"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information about completing these tasks with PL/SQL procedures</div>
</li>
<li>
<p>Add the relevant rules to the rule sets for the apply processes. To add rules to the rule set for an apply process, you can run one of the following procedures:</p>
<ul>
<li>
<p><a class="olink ARPLS308" href="../ARPLS/d_streams_adm.htm#ARPLS308"><code dir="ltr">DBMS_STREAMS_ADM.ADD_TABLE_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS329" href="../ARPLS/d_streams_adm.htm#ARPLS329"><code dir="ltr">DBMS_STREAMS_ADM.ADD_SUBSET_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS309" href="../ARPLS/d_streams_adm.htm#ARPLS309"><code dir="ltr">DBMS_STREAMS_ADM.ADD_SCHEMA_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS310" href="../ARPLS/d_streams_adm.htm#ARPLS310"><code dir="ltr">DBMS_STREAMS_ADM.ADD_GLOBAL_RULES</code></a></p>
</li>
</ul>
<p>Excluding the <code dir="ltr">ADD_SUBSET_RULES</code> procedure, these procedures can add rules to the positive or negative rule set for an apply process. The <code dir="ltr">ADD_SUBSET_RULES</code> procedure can add rules only to the positive rule set for an apply process.</p>
</li>
<li>
<p>Add the relevant rules to the rule sets for the propagations. To add rules to the rule set for a propagation, you can run one of the following procedures:</p>
<ul>
<li>
<p><a class="olink ARPLS316" href="../ARPLS/d_streams_adm.htm#ARPLS316"><code dir="ltr">DBMS_STREAMS_ADM.ADD_TABLE_PROPAGATION_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS394" href="../ARPLS/d_streams_adm.htm#ARPLS394"><code dir="ltr">DBMS_STREAMS_ADM.ADD_SUBSET_PROPAGATION_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS317" href="../ARPLS/d_streams_adm.htm#ARPLS317"><code dir="ltr">DBMS_STREAMS_ADM.ADD_SCHEMA_PROPAGATION_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS318" href="../ARPLS/d_streams_adm.htm#ARPLS318"><code dir="ltr">DBMS_STREAMS_ADM.ADD_GLOBAL_PROPAGATION_RULES</code></a></p>
</li>
</ul>
<p>Excluding the <code dir="ltr">ADD_SUBSET_PROPAGATION_RULES</code> procedure, these procedures can add rules to the positive or negative rule set for a propagation. The <code dir="ltr">ADD_SUBSET_PROPAGATION_RULES</code> procedure can add rules only to the positive rule set for a propagation.</p>
</li>
<li id="i1010217">
<p>Add the relevant rules to the rule sets used by the capture process or synchronous capture. To add rules to a rule set for an existing capture process, you can run one of the following procedures and specify the existing capture process:</p>
<ul>
<li>
<p><a class="olink ARPLS308" href="../ARPLS/d_streams_adm.htm#ARPLS308"><code dir="ltr">DBMS_STREAMS_ADM.ADD_TABLE_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS329" href="../ARPLS/d_streams_adm.htm#ARPLS329"><code dir="ltr">DBMS_STREAMS_ADM.ADD_SUBSET_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS309" href="../ARPLS/d_streams_adm.htm#ARPLS309"><code dir="ltr">DBMS_STREAMS_ADM.ADD_SCHEMA_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS310" href="../ARPLS/d_streams_adm.htm#ARPLS310"><code dir="ltr">DBMS_STREAMS_ADM.ADD_GLOBAL_RULES</code></a></p>
</li>
</ul>
<p>Excluding the <code dir="ltr">ADD_SUBSET_RULES</code> procedure, these procedures can add rules to the positive or negative rule set for a capture process. The <code dir="ltr">ADD_SUBSET_RULES</code> procedure can add rules only to the positive rule set for a capture process.</p>
<p>To add rules to a rule set for an existing synchronous capture, you can run one of the following procedures and specify the existing synchronous capture:</p>
<ul>
<li>
<p><a class="olink ARPLS308" href="../ARPLS/d_streams_adm.htm#ARPLS308"><code dir="ltr">DBMS_STREAMS_ADM.ADD_TABLE_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS329" href="../ARPLS/d_streams_adm.htm#ARPLS329"><code dir="ltr">DBMS_STREAMS_ADM.ADD_SUBSET_RULES</code></a></p>
</li>
</ul>
<p>When you use a procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package to add the capture process rules, it automatically runs the <code dir="ltr">PREPARE_TABLE_INSTANTIATION</code>, <code dir="ltr">PREPARE_SCHEMA_INSTANTIATION</code>, or <code dir="ltr">PREPARE_GLOBAL_INSTANTIATION</code> procedure in the <code dir="ltr">DBMS_CAPTURE_ADM</code> package for the specified table, specified schema, or entire database, respectively, if the capture process is a local capture process or a downstream capture process with a database link to the source database.</p>
<p>You must run the appropriate procedure to prepare for instantiation manually if any of the following conditions is true:</p>
<ul>
<li>
<p>You use <code dir="ltr">DBMS_RULE_ADM</code> to create or modify rules in a capture process rule set.</p>
</li>
<li>
<p>You do not add rules for the added objects to a capture process rule set, because the capture process already captures changes to these objects. In this case, rules for the objects can be added to propagations and apply processes in the environment, but not to the capture process.</p>
</li>
<li>
<p>You use a downstream capture process with no database link to the source database.</p>
</li>
</ul>
<p>If you must prepare for instantiation manually, then see <a href="instant.htm#i1009355">&#34;Preparing Database Objects for Instantiation at a Source Database&#34;</a> for instructions.</p>
<p>When you use a procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package to add the synchronous capture rules, it automatically runs the <code dir="ltr">PREPARE_SYNC_INSTANTIATION</code> function in the <code dir="ltr">DBMS_CAPTURE_ADM</code> package for the specified table.</p>
</li>
<li id="i1010237">
<p>At each destination database, either instantiate, or set the instantiation SCN for, each database object you are adding to the Oracle Streams environment. If the database objects do not exist at a destination database, then instantiate them using export/import, transportable tablespaces, or RMAN. If the database objects already exist at a destination database, then set the instantiation SCNs for them manually.</p>
<ul>
<li>
<p>To instantiate database objects using export/import, first export them at the source database. Next, import them at the destination database. See <a href="instant.htm#g1012655">Chapter 8, &#34;Instantiation and Oracle Streams Replication&#34;</a>.</p>
<p>Do not allow any changes to the database objects being exported while exporting these database objects at the source database. Do not allow changes to the database objects being imported while importing these database objects at the destination database.</p>
<p>You can specify a more stringent degree of consistency by using an export parameter such as <code dir="ltr">FLASHBACK_SCN</code> or <code dir="ltr">FLASHBACK_TIME</code>.</p>
</li>
<li>
<p>To set the instantiation SCN for a table, schema, or database manually, run the appropriate procedure or procedures in the <code dir="ltr">DBMS_APPLY_ADM</code> package at a destination database:</p>
<ul>
<li>
<p><code dir="ltr">SET_TABLE_INSTANTIATION_SCN</code></p>
</li>
<li>
<p><code dir="ltr">SET_SCHEMA_INSTANTIATION_SCN</code></p>
</li>
<li>
<p><code dir="ltr">SET_GLOBAL_INSTANTIATION_SCN</code></p>
</li>
</ul>
<p>When you run one of these procedures at a destination database, you must ensure that every added object at the destination database is consistent with the source database as of the instantiation SCN.</p>
<p>If you run <code dir="ltr">SET_GLOBAL_INSTANTIATION_SCN</code> at a destination database, then set the <code dir="ltr">recursive</code> parameter for this procedure to <code dir="ltr">TRUE</code> so that the instantiation SCN also is set for each schema at the destination database and for the tables owned by these schemas.</p>
<p>If you run <code dir="ltr">SET_SCHEMA_INSTANTIATION_SCN</code> at a destination database, then set the <code dir="ltr">recursive</code> parameter for this procedure to <code dir="ltr">TRUE</code> so that the instantiation SCN also is set for each table in the schema.</p>
<p>If you set the <code dir="ltr">recursive</code> parameter to <code dir="ltr">TRUE</code> in the <code dir="ltr">SET_GLOBAL_INSTANTIATION_SCN</code> procedure or the <code dir="ltr">SET_SCHEMA_INSTANTIATION_SCN</code> procedure, then a database link from the destination database to the source database is required. This database link must have the same name as the global name of the source database and must be accessible to the user who executes the procedure. See <a href="instant.htm#i1009455">&#34;Setting Instantiation SCNs Using the DBMS_APPLY_ADM Package&#34;</a> for instructions.</p>
<p>Alternatively, you can perform a metadata export/import to set the instantiation SCNs for existing database objects. If you choose this option, then ensure that no rows are imported. Also, ensure that every added object at the importing destination database is consistent with the source database that performed the export at the time of the export. If you are sharing DML changes only, then table level export/import is sufficient. If you are sharing DDL changes also, then additional considerations apply. See <a href="instant.htm#i1009393">&#34;Setting Instantiation SCNs Using Export/Import&#34;</a> for more information about performing a metadata export/import.</p>
</li>
</ul>
</li>
<li id="i1010271">
<p>Start any Oracle Streams client you stopped in Step <a href="#i1010179">2</a>:</p>
<ul>
<li>
<p>Use the <code dir="ltr">START_CAPTURE</code> procedure in the <code dir="ltr">DBMS_CAPTURE_ADM</code> package to start a capture process.</p>
</li>
<li>
<p>Use the <code dir="ltr">START_PROPAGATION</code> procedure in the <code dir="ltr">DBMS_PROPAGATION_ADM</code> package start a propagation.</p>
</li>
<li>
<p>Use the <code dir="ltr">START_APPLY</code> procedure in the <code dir="ltr">DBMS_APPLY_ADM</code> package to start an apply process.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS" href="../STRMS/toc.htm"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information about completing these tasks using PL/SQL procedures</div>
</li>
</ol>
<p>You must stop the capture process, disable one of the propagation jobs, or stop the apply process in Step <a href="#i1010179">2</a> to ensure that the table or schema is instantiated before the first LCR resulting from the added rule(s) reaches the apply process. Otherwise, LCRs could be lost or could result in apply errors, depending on whether the apply process rule(s) have been added.</p>
<p>If you are certain that the added table is not being modified at the source database during this procedure, and that there are no LCRs for the table already in the stream or waiting to be captured, then you can perform Step <a href="#i1010271">7</a> before Step <a href="#i1010237">6</a> to reduce the amount of time that an Oracle Streams process or propagation job is stopped.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STREX103" href="../STREX/repsingdemo.htm#STREX103"><span class="italic">Oracle Streams Extended Examples</span></a> for a detailed example that adds objects to an existing single-source environment</div>
</div>
<!-- class="sect2" -->
<a id="i1010321"></a>
<div id="STREP283" class="sect2">
<h3 class="sect2">Adding a New Destination Database to a Single-Source Environment<a id="sthref236"></a><a id="sthref237"></a><a id="sthref238"></a></h3>
<p>You can add a destination database to an existing single-source environment by creating one or more new apply processes at the new destination database and, if necessary, configuring one or more propagations to send changes to the new destination database. You might also need to add rules to existing propagations in the stream that send changes to the new destination database.</p>
<p>As in the example that describes <a href="#i1010163">&#34;Adding Replicated Objects to an Existing Single-Source Environment&#34;</a>, before creating or altering propagation rules in a running Oracle Streams replication environment, ensure that any propagations or apply processes that will receive logical change records (LCRs) because of the new or altered rules are configured to handle these LCRs. Otherwise, LCRs might be lost.</p>
<p>This example assumes that the replicated database objects are read-only at the destination databases. If the replicated database objects are read/write at the destination databases, then the replication environment will not stay synchronized because Oracle Streams is not configured to replicate the changes made to the replicated database objects at the destination databases.</p>
<p><a href="#i1013566">Figure 4-2</a> shows the additional configuration steps that must be completed to add a destination database to a single-source Oracle Streams environment.</p>
<div id="STREP284" class="figure">
<p class="titleinfigure"><a id="i1013566"></a>Figure 4-2 Example of Adding a Destination to a Single-Source Environment</p>
<img width="600" height="440" src="img/strep040.gif" alt="Description of Figure 4-2 follows"/><br/>
<a id="sthref239" href="img_text/strep040.htm">Description of &#34;Figure 4-2 Example of Adding a Destination to a Single-Source Environment&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>To avoid losing LCRs, you should complete the configuration in the following order:</p>
<ol>
<li>
<p>Complete the necessary tasks to prepare each database in your environment for Oracle Streams. See <a href="prep_rep.htm#CACGBCIB">&#34;Tasks to Complete Before Configuring Oracle Streams Replication&#34;</a>.</p>
<p>Some of these tasks might not be required at certain databases.</p>
</li>
<li>
<p>Create any necessary <code dir="ltr">ANYDATA</code> queues that do not already exist at the destination database. When you create an apply process, you associate the apply process with a specific <code dir="ltr">ANYDATA</code> queue. See <a href="cprop.htm#i1006170">&#34;Creating an ANYDATA Queue&#34;</a> for instructions.</p>
</li>
<li id="i1010369">
<p>Create one or more apply processes at the new destination database to apply the changes from its source database. Ensure that each apply process uses rule sets that are appropriate for applying changes. Do not start any of the apply processes at the new database. See <a href="capply.htm#CHDCACFH">Chapter 7, &#34;Configuring Implicit Apply&#34;</a> for instructions.</p>
<p>Keeping the apply processes stopped prevents changes made at the source databases from being applied before the instantiation of the new database is completed. Starting the apply processes might lead to incorrect data and errors.</p>
</li>
<li>
<p>Configure any necessary propagations to send changes from the source databases to the new destination database. Ensure that each propagation uses rule sets that are appropriate for propagating changes. See <a href="cprop.htm#BABIDDBA">&#34;Creating Oracle Streams Propagations Between ANYDATA Queues&#34;</a>.</p>
</li>
<li>
<p>At the source database, prepare for instantiation each database object for which changes will be applied by an apply process at the new destination database.</p>
<p>If you are using one or more capture processes, then run either the <code dir="ltr">PREPARE_TABLE_INSTANTIATION</code>, <code dir="ltr">PREPARE_SCHEMA_INSTANTIATION</code>, or <code dir="ltr">PREPARE_GLOBAL_INSTANTIATION</code> procedure in the <code dir="ltr">DBMS_CAPTURE_ADM</code> package for the specified table, specified schema, or entire database, respectively.</p>
<p>If you are using one or more synchronous captures, then run the <code dir="ltr">PREPARE_SYNC_INSTANTIATION</code> function in the <code dir="ltr">DBMS_CAPTURE_ADM</code> package for the specified table.</p>
<p>See <a href="instant.htm#i1009355">&#34;Preparing Database Objects for Instantiation at a Source Database&#34;</a>.</p>
</li>
<li>
<p>At the new destination database, either instantiate, or set the instantiation SCNs for, each database object for which changes will be applied by an apply process. If the database objects do not already exist at the new destination database, then instantiate them using export/import, transportable tablespaces, or RMAN. If the database objects exist at the new destination database, then set the instantiation SCNs for them.</p>
<ul>
<li>
<p>To instantiate database objects using export/import, first export them at the source database. Next, import them at the destination database. See <a href="instant.htm#g1012655">Chapter 8, &#34;Instantiation and Oracle Streams Replication&#34;</a>.</p>
<p>Do not allow any changes to the database objects being exported while exporting these database objects at the source database. Do not allow changes to the database objects being imported while importing these database objects at the destination database.</p>
<p>You can specify a more stringent degree of consistency by using an export parameter such as <code dir="ltr">FLASHBACK_SCN</code> or <code dir="ltr">FLASHBACK_TIME</code>.</p>
</li>
<li>
<p>To set the instantiation SCN for a table, schema, or database manually, run the appropriate procedure or procedures in the <code dir="ltr">DBMS_APPLY_ADM</code> package at the new destination database:</p>
<ul>
<li>
<p><code dir="ltr">SET_TABLE_INSTANTIATION_SCN</code></p>
</li>
<li>
<p><code dir="ltr">SET_SCHEMA_INSTANTIATION_SCN</code></p>
</li>
<li>
<p><code dir="ltr">SET_GLOBAL_INSTANTIATION_SCN</code></p>
</li>
</ul>
<p>When you run one of these procedures, you must ensure that the replicated database objects at the new destination database are consistent with the source database as of the instantiation SCN.</p>
<p>If you run <code dir="ltr">SET_GLOBAL_INSTANTIATION_SCN</code> at a destination database, then set the <code dir="ltr">recursive</code> parameter for this procedure to <code dir="ltr">TRUE</code> so that the instantiation SCN also is set for each schema at the destination database and for the tables owned by these schemas.</p>
<p>If you run <code dir="ltr">SET_SCHEMA_INSTANTIATION_SCN</code> at a destination database, then set the <code dir="ltr">recursive</code> parameter for this procedure to <code dir="ltr">TRUE</code> so that the instantiation SCN also is set for each table in the schema.</p>
<p>If you set the <code dir="ltr">recursive</code> parameter to <code dir="ltr">TRUE</code> in the <code dir="ltr">SET_GLOBAL_INSTANTIATION_SCN</code> procedure or the <code dir="ltr">SET_SCHEMA_INSTANTIATION_SCN</code> procedure, then a database link from the destination database to the source database is required. This database link must have the same name as the global name of the source database and must be accessible to the user who executes the procedure. See <a href="instant.htm#i1009455">&#34;Setting Instantiation SCNs Using the DBMS_APPLY_ADM Package&#34;</a> for instructions.</p>
<p>Alternatively, you can perform a metadata export/import to set the instantiation SCNs for existing database objects. If you choose this option, then ensure that no rows are imported. Also, ensure that the replicated database objects at the importing destination database are consistent with the source database that performed the export at the time of the export. If you are sharing DML changes only, then table level export/import is sufficient. If you are sharing DDL changes also, then additional considerations apply. See <a href="instant.htm#i1009393">&#34;Setting Instantiation SCNs Using Export/Import&#34;</a> for more information about performing a metadata export/import.</p>
</li>
</ul>
</li>
<li>
<p>Start the apply processes you created in Step <a href="#i1010369">3</a> using the <code dir="ltr">START_APPLY</code> procedure in the <code dir="ltr">DBMS_APPLY_ADM</code> package.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STREX104" href="../STREX/repsingdemo.htm#STREX104"><span class="italic">Oracle Streams Extended Examples</span></a> for detailed example that adds a database to an existing single-source environment</div>
</div>
<!-- class="sect2" -->
<a id="i1010690"></a>
<div id="STREP285" class="sect2">
<h3 class="sect2">Adding Replicated Objects to an Existing Multiple-Source Environment<a id="sthref240"></a><a id="sthref241"></a><a id="sthref242"></a></h3>
<p>You can add existing database objects to an existing multiple-source environment by adding the necessary rules to the appropriate capture processes, synchronous captures, propagations, and apply processes.</p>
<p>This example uses the following terms:</p>
<ul>
<li>
<p><span class="bold">Populated database:</span> A database that already contains the replicated database objects being added to the multiple-source environment. You must have at least one populated database to add the objects to the environment.</p>
</li>
<li>
<p><span class="bold">Export database:</span> A populated database on which you perform an export of the database objects you are adding to the environment. This export is used to instantiate the added database objects at the import databases. You might not have an export database if all of the databases in the environment are populated databases.</p>
</li>
<li>
<p><span class="bold">Import database:</span> A database that does not contain the replicated database objects before they are added to the multiple-source environment. You instantiate the replicated database objects at an import database by performing an import of these database objects. You might not have any import databases if all of the databases in the environment are populated databases.</p>
</li>
</ul>
<p>Before creating or altering capture or propagation rules in a running Oracle Streams replication environment, ensure that any propagations or apply processes that will receive logical change records (LCRs) because of the new or altered rules are configured to handle these LCRs. That is, the propagations or apply processes should exist, and each one should be associated with rule sets that handle the LCRs appropriately. If these propagations and apply processes are not configured properly to handle these LCRs, then LCRs can be lost.</p>
<p>For example, suppose you want to add a new table to an Oracle Streams replication environment that already captures, propagates, and applies changes to other tables. Assume multiple capture processes or synchronous captures in the environment will capture changes to this table, and multiple apply processes will apply changes to this table. In this case, you must add one or more table rules to the following rule sets:</p>
<ul>
<li>
<p>The positive rule set for each apply process that will apply changes to the table</p>
</li>
<li>
<p>The positive rule set for each propagation that will propagate changes to the table</p>
</li>
<li>
<p>The positive rule set for each capture process or synchronous capture that will capture changes to the table</p>
</li>
</ul>
<p>If you perform administrative steps in the wrong order, then you can lose LCRs. For example, if you add the rule to a capture process rule set first, without stopping the capture process, then the propagation will not propagate the changes if it does not have a rule that instructs it to do so, and the changes can be lost.</p>
<p><a href="#i1013618">Figure 4-3</a> shows the additional configuration steps that must be completed to add replicated database objects to a multiple-source Oracle Streams environment.</p>
<div id="STREP286" class="figure">
<p class="titleinfigure"><a id="i1013618"></a>Figure 4-3 Example of Adding Replicated Objects to a Multiple-Source Environment</p>
<img width="414" height="554" src="img/strep042.gif" alt="Description of Figure 4-3 follows"/><br/>
<a id="sthref243" href="img_text/strep042.htm">Description of &#34;Figure 4-3 Example of Adding Replicated Objects to a Multiple-Source Environment&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>When there are multiple source databases in an Oracle Streams replication environment, change cycling is possible. Change cycling happens when a change is sent back to the database where it originated. Typically, you should avoid change cycling. Before you configure your replication environment, see <a href="rep_tags.htm#g1014437">Chapter 10, &#34;Oracle Streams Tags&#34;</a>, and ensure that you configure the replication environment to avoid change cycling.</p>
<p>To avoid losing LCRs, complete the configuration in the following order:</p>
<ol>
<li>
<p>At each populated database, specify any necessary supplemental logging for the objects being added to the environment. See <a href="prep_rep.htm#i1008208">&#34;Specifying Supplemental Logging&#34;</a> for instructions.</p>
</li>
<li id="i1010718">
<p>Either stop all of the capture processes that will capture changes to the added objects, stop all of the propagations that will propagate changes to the added objects, or stop all of the apply process that will apply changes to the added objects:</p>
<ul>
<li>
<p>Use the <code dir="ltr">STOP_CAPTURE</code> procedure in the <code dir="ltr">DBMS_CAPTURE_ADM</code> package to stop a capture process.</p>
</li>
<li>
<p>Use the <code dir="ltr">STOP_PROPAGATION</code> procedure in the <code dir="ltr">DBMS_PROPAGATION_ADM</code> package to stop a propagation.</p>
</li>
<li>
<p>Use the <code dir="ltr">STOP_APPLY</code> procedure in the <code dir="ltr">DBMS_APPLY_ADM</code> package to stop an apply process.</p>
</li>
</ul>
<p>In general, it is best to stop the capture process so that messages do not accumulate in queues during the operation.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Synchronous captures cannot be stopped.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS" href="../STRMS/toc.htm"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information about completing these tasks using PL/SQL procedures</div>
</li>
<li>
<p>Add the relevant rules to the rule sets for the apply processes that will apply changes to the added objects. To add rules to the rule set for an apply process, you can run one of the following procedures:</p>
<ul>
<li>
<p><a class="olink ARPLS308" href="../ARPLS/d_streams_adm.htm#ARPLS308"><code dir="ltr">DBMS_STREAMS_ADM.ADD_TABLE_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS329" href="../ARPLS/d_streams_adm.htm#ARPLS329"><code dir="ltr">DBMS_STREAMS_ADM.ADD_SUBSET_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS309" href="../ARPLS/d_streams_adm.htm#ARPLS309"><code dir="ltr">DBMS_STREAMS_ADM.ADD_SCHEMA_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS310" href="../ARPLS/d_streams_adm.htm#ARPLS310"><code dir="ltr">DBMS_STREAMS_ADM.ADD_GLOBAL_RULES</code></a></p>
</li>
</ul>
<p>Excluding the <code dir="ltr">ADD_SUBSET_RULES</code> procedure, these procedures can add rules to the positive or negative rule set for an apply process. The <code dir="ltr">ADD_SUBSET_RULES</code> procedure can add rules only to the positive rule set for an apply process.</p>
</li>
<li>
<p>Add the relevant rules to the rule sets for the propagations that will propagate changes to the added objects. To add rules to the rule set for a propagation, you can run one of the following procedures:</p>
<ul>
<li>
<p><a class="olink ARPLS316" href="../ARPLS/d_streams_adm.htm#ARPLS316"><code dir="ltr">DBMS_STREAMS_ADM.ADD_TABLE_PROPAGATION_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS394" href="../ARPLS/d_streams_adm.htm#ARPLS394"><code dir="ltr">DBMS_STREAMS_ADM.ADD_SUBSET_PROPAGATION_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS317" href="../ARPLS/d_streams_adm.htm#ARPLS317"><code dir="ltr">DBMS_STREAMS_ADM.ADD_SCHEMA_PROPAGATION_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS318" href="../ARPLS/d_streams_adm.htm#ARPLS318"><code dir="ltr">DBMS_STREAMS_ADM.ADD_GLOBAL_PROPAGATION_RULES</code></a></p>
</li>
</ul>
<p>Excluding the <code dir="ltr">ADD_SUBSET_PROPAGATION_RULES</code> procedure, these procedures can add rules to the positive or negative rule set for a propagation. The <code dir="ltr">ADD_SUBSET_PROPAGATION_RULES</code> procedure can add rules only to the positive rule set for a propagation.</p>
</li>
<li>
<p>Add the relevant rules to the rule sets used by each capture process or synchronous capture that will capture changes to the added objects. To add rules to a rule set for an existing capture process, you can run one of the following procedures and specify the existing capture process:</p>
<ul>
<li>
<p><a class="olink ARPLS308" href="../ARPLS/d_streams_adm.htm#ARPLS308"><code dir="ltr">DBMS_STREAMS_ADM.ADD_TABLE_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS329" href="../ARPLS/d_streams_adm.htm#ARPLS329"><code dir="ltr">DBMS_STREAMS_ADM.ADD_SUBSET_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS309" href="../ARPLS/d_streams_adm.htm#ARPLS309"><code dir="ltr">DBMS_STREAMS_ADM.ADD_SCHEMA_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS310" href="../ARPLS/d_streams_adm.htm#ARPLS310"><code dir="ltr">DBMS_STREAMS_ADM.ADD_GLOBAL_RULES</code></a></p>
</li>
</ul>
<p>Excluding the <code dir="ltr">ADD_SUBSET_RULES</code> procedure, these procedures can add rules to the positive or negative rule set for a capture process. The <code dir="ltr">ADD_SUBSET_RULES</code> procedure can add rules only to the positive rule set for a capture process.</p>
<p>To add rules to a rule set for an existing synchronous capture, you can run one of the following procedures and specify the existing synchronous capture:</p>
<ul>
<li>
<p><a class="olink ARPLS308" href="../ARPLS/d_streams_adm.htm#ARPLS308"><code dir="ltr">DBMS_STREAMS_ADM.ADD_TABLE_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS329" href="../ARPLS/d_streams_adm.htm#ARPLS329"><code dir="ltr">DBMS_STREAMS_ADM.ADD_SUBSET_RULES</code></a></p>
</li>
</ul>
<p>When you use a procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package to add the capture process rules, it automatically runs the <code dir="ltr">PREPARE_TABLE_INSTANTIATION</code>, <code dir="ltr">PREPARE_SCHEMA_INSTANTIATION</code>, or <code dir="ltr">PREPARE_GLOBAL_INSTANTIATION</code> procedure in the <code dir="ltr">DBMS_CAPTURE_ADM</code> package for the specified table, specified schema, or entire database, respectively, if the capture process is a local capture process or a downstream capture process with a database link to the source database.</p>
<p>You must run the appropriate procedure to prepare for instantiation manually if any of the following conditions is true:</p>
<ul>
<li>
<p>You use <code dir="ltr">DBMS_RULE_ADM</code> to create or modify rules in a capture process rule set.</p>
</li>
<li>
<p>You do not add rules for the added objects to a capture process rule set, because the capture process already captures changes to these objects. In this case, rules for the objects can be added to propagations and apply processes in the environment, but not to the capture process.</p>
</li>
<li>
<p>You use a downstream capture process with no database link to the source database.</p>
</li>
</ul>
<p>If you must prepare for instantiation manually, then see <a href="instant.htm#i1009355">&#34;Preparing Database Objects for Instantiation at a Source Database&#34;</a> for instructions.</p>
<p>When you use a procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package to add the synchronous capture rules, it automatically runs the <code dir="ltr">PREPARE_SYNC_INSTANTIATION</code> function in the <code dir="ltr">DBMS_CAPTURE_ADM</code> package for the specified table.</p>
</li>
</ol>
<p>After completing these steps, complete the steps in each of the following sections that apply to your environment. You might need to complete the steps in only one of these sections or in both of these sections:</p>
<ul>
<li>
<p>For each populated database, complete the steps in <a href="#i1010790">&#34;Configuring Populated Databases When Adding Replicated Objects&#34;</a>. These steps are required only if your environment has multiple populated databases.</p>
</li>
<li>
<p>For each import database, complete the steps in <a href="#i1010816">&#34;Adding Replicated Objects to Import Databases in an Existing Environment&#34;</a>.</p>
</li>
</ul>
<a id="i1010790"></a>
<div id="STREP287" class="sect3">
<h4 class="sect3">Configuring Populated Databases When Adding Replicated Objects</h4>
<p>After completing the steps in <a href="#i1010690">&#34;Adding Replicated Objects to an Existing Multiple-Source Environment&#34;</a>, complete the following steps for each populated database if your environment has multiple populated databases:</p>
<ol>
<li>
<p>For each populated database, set the instantiation SCN for each added object at the other populated databases in the environment. These instantiation SCNs must be set, and only the changes made at a particular populated database that are committed after the corresponding SCN for that database will be applied at another populated database.</p>
<p>For each populated database, you can set these instantiation SCNs for each added database object in one of the following ways:</p>
<ul>
<li>
<p>Perform a metadata only export of the added database objects at the populated database and import the metadata at each of the other populated databases. Such an import sets the required instantiation SCNs for the database at the other databases. Ensure that no rows are imported. Also, ensure that the replicated database objects at each of the other populated databases are consistent with the populated database that performed the export at the time of the export.</p>
<p>If you are replicating DML changes only, then table level export/import is sufficient. If you are replicating DDL changes also, then additional considerations apply. See <a href="instant.htm#i1009393">&#34;Setting Instantiation SCNs Using Export/Import&#34;</a> for more information about performing a metadata export/import.</p>
</li>
<li>
<p>Set the instantiation SCNs manually for the added objects at each of the other populated databases. Ensure that every added database object at each populated database is consistent with the instantiation SCNs you set at that database. See <a href="instant.htm#i1009455">&#34;Setting Instantiation SCNs Using the DBMS_APPLY_ADM Package&#34;</a> for instructions.</p>
</li>
</ul>
</li>
</ol>
</div>
<!-- class="sect3" -->
<a id="i1010816"></a>
<div id="STREP288" class="sect3">
<h4 class="sect3">Adding Replicated Objects to Import Databases in an Existing Environment</h4>
<p>After completing the steps in <a href="#i1010690">&#34;Adding Replicated Objects to an Existing Multiple-Source Environment&#34;</a>, complete the following steps for the import databases:</p>
<a id="i1010825"></a>
<ol>
<li id="BABDGIJI">
<p>Pick the populated database that you will use as the export database. Do not perform the instantiations yet.</p>
</li>
<li>
<p>For each import database, set the instantiation SCNs for the added database objects at all of the other databases in the environment that will be a destination database of the import database. In this case, the import database will be the source database for these destination databases. The databases where you set the instantiation SCNs might be populated databases and other import databases.</p>
<ol>
<li>
<p>If one or more schemas will be created at an import database during instantiation or by a subsequent replicated DDL change, then run the <code dir="ltr">SET_GLOBAL_INSTANTIATION_SCN</code> procedure in the <code dir="ltr">DBMS_APPLY_ADM</code> package for this import database at all of the other databases in the environment.</p>
</li>
<li>
<p>If a schema exists at an import database, and one or more tables will be created in the schema during instantiation or by a subsequent replicated DDL change, then run the <code dir="ltr">SET_SCHEMA_INSTANTIATION_SCN</code> procedure in the <code dir="ltr">DBMS_APPLY_ADM</code> package for the schema for this import database at each of the other databases in the environment. Do this for each such schema.</p>
</li>
</ol>
<p>See <a href="instant.htm#i1009455">&#34;Setting Instantiation SCNs Using the DBMS_APPLY_ADM Package&#34;</a> for instructions.</p>
<p>Because you run these procedures before any tables are instantiated at the import databases, and because the local capture processes or synchronous captures are configured already for these import databases, you will not need to run the <code dir="ltr">SET_TABLE_INSTANTIATION_SCN</code> procedure for each table created during instantiation. Instantiation SCNs will be set automatically for these tables at all of the other databases in the environment that will be destination databases of the import database.</p>
</li>
<li id="i1010838">
<p>At the export database you chose in Step <a href="#BABDGIJI">1</a>, perform an export of the replicated database objects. Next, perform an import of the replicated database objects at each import database. See <a href="instant.htm#g1012655">Chapter 8, &#34;Instantiation and Oracle Streams Replication&#34;</a> and <a class="olink SUTIL" href="../SUTIL/toc.htm"><span class="italic">Oracle Database Utilities</span></a> for information about using export/import.</p>
<p>Do not allow any changes to the database objects being exported while exporting these database objects at the source database. Do not allow changes to the database objects being imported while importing these database objects at the destination database.</p>
<p>You can specify a more stringent degree of consistency by using an export parameter such as <code dir="ltr">FLASHBACK_SCN</code> or <code dir="ltr">FLASHBACK_TIME</code>.</p>
</li>
<li>
<p>For each populated database, except for the export database, set the instantiation SCNs for the added database objects at each import database that will be a destination database of the populated source database. These instantiation SCNs must be set, and only the changes made at a populated database that are committed after the corresponding SCN for that database will be applied at an import database.</p>
<p>For each populated database, you can set these instantiation SCNs for the added objects in one of the following ways:</p>
<ul>
<li>
<p>Perform a metadata only export of the added database objects at the populated database and import the metadata at each import database. Each import sets the required instantiation SCNs for the populated database at the import database. In this case, ensure that every added database object at the import database is consistent with the populated database at the time of the export.</p>
<p>If you are replicating DML changes only, then table level export/import is sufficient. If you are replicating DDL changes also, then additional considerations apply. See <a href="instant.htm#i1009393">&#34;Setting Instantiation SCNs Using Export/Import&#34;</a> for more information about performing a metadata export/import.</p>
</li>
<li>
<p>Set the instantiation SCNs manually for the added objects at each import database. Ensure that every added object at each import database is consistent with the populated database as of the corresponding instantiation SCN. See <a href="instant.htm#i1009455">&#34;Setting Instantiation SCNs Using the DBMS_APPLY_ADM Package&#34;</a> for instructions.</p>
</li>
</ul>
</li>
</ol>
</div>
<!-- class="sect3" -->
<div id="STREP289" class="sect3"><a id="sthref244"></a>
<h4 class="sect3">Finish Adding Objects to a Multiple-Source Environment Configuration</h4>
<p>Before completing the configuration, you should have completed the following tasks:</p>
<ul>
<li>
<p><a href="#i1010690">&#34;Adding Replicated Objects to an Existing Multiple-Source Environment&#34;</a></p>
</li>
<li>
<p><a href="#i1010790">&#34;Configuring Populated Databases When Adding Replicated Objects&#34;</a>, if your environment has multiple populated databases</p>
</li>
<li>
<p><a href="#i1010816">&#34;Adding Replicated Objects to Import Databases in an Existing Environment&#34;</a>, if your environment had import databases</p>
</li>
</ul>
<p>When all of the previous configuration steps are finished, complete the following steps:</p>
<ol>
<li>
<p>At each database, configure conflict resolution for the added database objects if conflicts are possible. See <a href="conflict.htm#g1013001">Chapter 9, &#34;Oracle Streams Conflict Resolution&#34;</a> for instructions.</p>
</li>
<li>
<p>Start each Oracle Streams client you stopped in Step&nbsp;<a href="#i1010718">2</a> in <a href="#i1010690">&#34;Adding Replicated Objects to an Existing Multiple-Source Environment&#34;</a>:</p>
<ul>
<li>
<p>Use the <code dir="ltr">START_CAPTURE</code> procedure in the <code dir="ltr">DBMS_CAPTURE_ADM</code> package to start a capture process.</p>
</li>
<li>
<p>Use the <code dir="ltr">START_PROPAGATION</code> procedure in the <code dir="ltr">DBMS_PROPAGATION_ADM</code> package start a propagation.</p>
</li>
<li>
<p>Use the <code dir="ltr">START_APPLY</code> procedure in the <code dir="ltr">DBMS_APPLY_ADM</code> package to start an apply process.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS" href="../STRMS/toc.htm"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information about completing these tasks using the PL/SQL procedures</div>
</li>
</ol>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1010925"></a>
<div id="STREP290" class="sect2">
<h3 class="sect2">Adding a New Database to an Existing Multiple-Source Environment<a id="sthref245"></a><a id="sthref246"></a><a id="sthref247"></a></h3>
<p><a href="#i1013628">Figure 4-4</a> shows the additional configuration steps that must be completed to add a source/destination database to a multiple-source Oracle Streams environment.</p>
<div id="STREP291" class="figure">
<p class="titleinfigure"><a id="i1013628"></a>Figure 4-4 Example of Adding a Database to a Multiple-Source Environment</p>
<img width="413" height="570" src="img/strep043.gif" alt="Description of Figure 4-4 follows"/><br/>
<a id="sthref248" href="img_text/strep043.htm">Description of &#34;Figure 4-4 Example of Adding a Database to a Multiple-Source Environment&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>When there are multiple source databases in an Oracle Streams replication environment, change cycling is possible. Change cycling happens when a change is sent back to the database where it originated. Typically, you should avoid change cycling. Before you configure your replication environment, see <a href="rep_tags.htm#g1014437">Chapter 10, &#34;Oracle Streams Tags&#34;</a>, and ensure that you configure the replication environment to avoid change cycling.</p>
<p>Complete the following steps to add a new source/destination database to an existing multiple-source Oracle Streams replication environment:</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Ensure that no changes are made to the database objects being replicated at the database you are adding to the Oracle Streams replication environment until the instantiation at the database is complete.</div>
<ol>
<li>
<p>Complete the necessary tasks to prepare each database in your environment for Oracle Streams. See <a href="prep_rep.htm#CACGBCIB">&#34;Tasks to Complete Before Configuring Oracle Streams Replication&#34;</a>.</p>
<p>Some of these tasks might not be required at certain databases.</p>
</li>
<li>
<p>Create any necessary <code dir="ltr">ANYDATA</code> queues that do not already exist. When you create a capture process, synchronous capture, or apply process, you associate the process with a specific <code dir="ltr">ANYDATA</code> queue. When you create a propagation, you associate it with a specific source queue and destination queue. See <a href="cprop.htm#i1006170">&#34;Creating an ANYDATA Queue&#34;</a> for instructions.</p>
</li>
<li id="i1010980">
<p>Create one or more apply processes at the new database to apply the changes from its source databases. Ensure that each apply process uses rule sets that are appropriate for applying changes. Do not start any apply process at the new database. See <a href="capply.htm#CHDCACFH">Chapter 7, &#34;Configuring Implicit Apply&#34;</a> for instructions.</p>
<p>Keeping the apply processes stopped prevents changes made at the source databases from being applied before the instantiation of the new database is completed. Starting the apply processes might lead to incorrect data and errors.</p>
</li>
<li id="i1010989">
<p>If the new database will be a source database, then, at all databases that will be destination databases for the changes made at the new database, create one or more apply processes to apply changes from the new database. Ensure that each apply process uses rule sets that are appropriate for applying changes. Do not start any of these new apply processes. See <a href="capply.htm#CHDCACFH">Chapter 7, &#34;Configuring Implicit Apply&#34;</a> for instructions.</p>
</li>
<li>
<p>Configure propagations at the databases that will be source databases of the new database to send changes to the new database. Ensure that each propagation uses rule sets that are appropriate for propagating changes. See <a href="cprop.htm#BABIDDBA">&#34;Creating Oracle Streams Propagations Between ANYDATA Queues&#34;</a>.</p>
</li>
<li>
<p>If the new database will be a source database, then configure propagations at the new database to send changes from the new database to each of its destination databases. Ensure that each propagation uses rule sets that are appropriate for propagating changes. See <a href="cprop.htm#BABIDDBA">&#34;Creating Oracle Streams Propagations Between ANYDATA Queues&#34;</a>.</p>
</li>
<li>
<p>If the new database will be a source database, and the replicated database objects already exist at the new database, then specify any necessary supplemental logging for the replicated database objects at the new database. See <a href="prep_rep.htm#i1008208">&#34;Specifying Supplemental Logging&#34;</a> for instructions.</p>
</li>
<li>
<p>At each source database for the new database, prepare for instantiation each database object for which changes will be applied by an apply process at the new database.</p>
<p>If you are using one or more capture processes, then run either the <code dir="ltr">PREPARE_TABLE_INSTANTIATION</code>, <code dir="ltr">PREPARE_SCHEMA_INSTANTIATION</code>, or <code dir="ltr">PREPARE_GLOBAL_INSTANTIATION</code> procedure in the <code dir="ltr">DBMS_CAPTURE_ADM</code> package for the specified table, specified schema, or entire database, respectively.</p>
<p>If you are using one or more synchronous captures, then run the <code dir="ltr">PREPARE_TABLE_INSTANTIATION</code> procedure in the <code dir="ltr">DBMS_CAPTURE_ADM</code> package for the specified table.</p>
<p>See <a href="instant.htm#i1009355">&#34;Preparing Database Objects for Instantiation at a Source Database&#34;</a> for instructions.</p>
</li>
<li id="i1011025">
<p>If the new database will be a source database, then create one or more capture processes or synchronous captures to capture the relevant changes. See <a href="ccap.htm#BEHECDFJ">Chapter 5, &#34;Configuring Implicit Capture&#34;</a> for instructions. If you plan to use capture processes, then Oracle recommends that you use only one capture process for each source database.</p>
<p>When you use a procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package to add the capture process rules, it automatically runs the <code dir="ltr">PREPARE_TABLE_INSTANTIATION</code>, <code dir="ltr">PREPARE_SCHEMA_INSTANTIATION</code>, or <code dir="ltr">PREPARE_GLOBAL_INSTANTIATION</code> procedure in the <code dir="ltr">DBMS_CAPTURE_ADM</code> package for the specified table, specified schema, or entire database, respectively, if the capture process is a local capture process or a downstream capture process with a database link to the source database.</p>
<p>You must run the appropriate procedure to prepare for instantiation manually if any of the following conditions is true:</p>
<ul>
<li>
<p>You use the <code dir="ltr">DBMS_RULE_ADM</code> package to add or modify rules.</p>
</li>
<li>
<p>You use an existing capture process and do not add capture process rules for any replicated database object.</p>
</li>
<li>
<p>You use a downstream capture process with no database link to the source database.</p>
</li>
</ul>
<p>If you must prepare for instantiation manually, then see <a href="instant.htm#i1009355">&#34;Preparing Database Objects for Instantiation at a Source Database&#34;</a> for instructions.</p>
<p>When you use a procedure in the <code dir="ltr">DBMS_STREAMS_ADM</code> package to add the synchronous capture rules, it automatically runs the <code dir="ltr">PREPARE_SYNC_INSTANTIATION</code> function in the <code dir="ltr">DBMS_CAPTURE_ADM</code> package for the specified table.</p>
</li>
<li>
<p>If the new database will be a source database, then start any capture process you created in Step <a href="#i1011025">9</a> using the <code dir="ltr">START_CAPTURE</code> procedure in the <code dir="ltr">DBMS_CAPTURE_ADM</code> package.</p>
</li>
</ol>
<p>After completing these steps, complete the steps in the appropriate section:</p>
<ul>
<li>
<p>If the objects that are to be replicated with the new database already exist at the new database, then complete the steps in <a href="#i1011070">&#34;Configuring Databases If the Replicated Objects Already Exist at the New Database&#34;</a>.</p>
</li>
<li>
<p>If the objects that are to be replicated with the new database do not already exist at the new database, complete the steps in <a href="#i1011141">&#34;Adding Replicated Objects to a New Database&#34;</a>.</p>
</li>
</ul>
<a id="i1011070"></a>
<div id="STREP292" class="sect3">
<h4 class="sect3">Configuring Databases If the Replicated Objects Already Exist at the New Database</h4>
<p>After completing the steps in <a href="#i1010925">&#34;Adding a New Database to an Existing Multiple-Source Environment&#34;</a>, complete the following steps if the objects that are to be replicated with the new database already exist at the new database:</p>
<ol>
<li>
<p>For each source database of the new database, set the instantiation SCNs at the new database. These instantiation SCNs must be set, and only the changes made at a source database that are committed after the corresponding SCN for that database will be applied at the new database.</p>
<p>For each source database of the new database, you can set these instantiation SCNs in one of the following ways:</p>
<ul>
<li>
<p>Perform a metadata only export of the replicated database objects at the source database, and import the metadata at the new database. The import sets the required instantiation SCNs for the source database at the new database. Ensure that no rows are imported. In this case, ensure that the replicated database objects at the new database are consistent with the source database at the time of the export.</p>
<p>If you are replicating DML changes only, then table level export/import is sufficient. If you are replicating DDL changes also, then additional considerations apply. See <a href="instant.htm#i1009393">&#34;Setting Instantiation SCNs Using Export/Import&#34;</a> for more information about performing a metadata export/import.</p>
</li>
<li>
<p>Set the instantiation SCNs manually at the new database for the replicated database objects. Ensure that the replicated database objects at the new database are consistent with the source database as of the corresponding instantiation SCN. See <a href="instant.htm#i1009455">&#34;Setting Instantiation SCNs Using the DBMS_APPLY_ADM Package&#34;</a> for instructions.</p>
</li>
</ul>
</li>
<li id="i1011096">
<p>For the new database, set the instantiation SCNs at each destination database of the new database. These instantiation SCNs must be set, and only the changes made at the new source database that are committed after the corresponding SCN will be applied at a destination database. If the new database is not a source database, then do not complete this step.</p>
<p>You can set these instantiation SCNs for the new database in one of the following ways:</p>
<ul>
<li>
<p>Perform a metadata only export at the new database and import the metadata at each destination database. Ensure that no rows are imported. The import sets the required instantiation SCNs for the new database at each destination database. In this case, ensure that the replicated database objects at each destination database are consistent with the new database at the time of the export.</p>
<p>If you are replicating DML changes only, then table level export/import is sufficient. If you are replicating DDL changes also, then additional considerations apply. See <a href="instant.htm#i1009393">&#34;Setting Instantiation SCNs Using Export/Import&#34;</a> for more information about performing a metadata export/import.</p>
</li>
<li>
<p>Set the instantiation SCNs manually at each destination database for the replicated database objects. Ensure that the replicated database objects at each destination database are consistent with the new database as of the corresponding instantiation SCN. See <a href="instant.htm#i1009455">&#34;Setting Instantiation SCNs Using the DBMS_APPLY_ADM Package&#34;</a> for instructions.</p>
</li>
</ul>
</li>
<li>
<p>At the new database, configure conflict resolution if conflicts are possible. See <a href="conflict.htm#g1013001">Chapter 9, &#34;Oracle Streams Conflict Resolution&#34;</a> for instructions.</p>
</li>
<li id="i1011114">
<p>Start the apply processes that you created at the new database in Step <a href="#i1010980">3</a> using the <code dir="ltr">START_APPLY</code> procedure in the <code dir="ltr">DBMS_APPLY_ADM</code> package.</p>
</li>
<li>
<p>Start the apply processes that you created at each of the other destination databases in Step <a href="#i1010989">4</a>. If the new database is not a source database, then do not complete this step.</p>
</li>
</ol>
</div>
<!-- class="sect3" -->
<a id="i1011141"></a>
<div id="STREP293" class="sect3">
<h4 class="sect3">Adding Replicated Objects to a New Database</h4>
<p>After completing the steps in <a href="#i1010925">&#34;Adding a New Database to an Existing Multiple-Source Environment&#34;</a>, complete the following steps if the database objects that are to be shared with the new database do not already exist at the new database:</p>
<ol>
<li>
<p>If the new database is a source database for other databases, then, at each destination database of the new source database, set the instantiation SCNs for the new database.</p>
<ol>
<li>
<p>If one or more schemas will be created at the new database during instantiation or by a subsequent replicated DDL change, then run the <code dir="ltr">SET_GLOBAL_INSTANTIATION_SCN</code> procedure in the <code dir="ltr">DBMS_APPLY_ADM</code> package for the new database at each destination database of the new database.</p>
</li>
<li>
<p>If a schema exists at the new database, and one or more tables will be created in the schema during instantiation or by a subsequent replicated DDL change, then run the <code dir="ltr">SET_SCHEMA_INSTANTIATION_SCN</code> procedure in the <code dir="ltr">DBMS_APPLY_ADM</code> package for the schema at each destination database of the new database. Do this for each such schema.</p>
</li>
</ol>
<p>See <a href="instant.htm#i1009455">&#34;Setting Instantiation SCNs Using the DBMS_APPLY_ADM Package&#34;</a> for instructions.</p>
<p>Because you run these procedures before any tables are instantiated at the new database, and because the local capture process or synchronous capture is configured already at the new database, you will not need to run the <code dir="ltr">SET_TABLE_INSTANTIATION_SCN</code> procedure for each table created during instantiation. Instantiation SCNs will be set automatically for these tables at all of the other databases in the environment that will be destination databases of the new database.</p>
<p>If the new database will not be a source database, then do not complete this step, and continue with the next step.</p>
</li>
<li id="i1011162">
<p>Pick one source database from which to instantiate the replicated database objects at the new database using export/import. First, perform an export of the replicated database objects. Next, perform an import of the replicated database objects at the new database. See <a href="instant.htm#g1012655">Chapter 8, &#34;Instantiation and Oracle Streams Replication&#34;</a> and <a class="olink SUTIL" href="../SUTIL/toc.htm"><span class="italic">Oracle Database Utilities</span></a> for information about using export/import.</p>
<p>Do not allow any changes to the database objects being exported while exporting these database objects at the source database. Do not allow changes to the database objects being imported while importing these database objects at the destination database.</p>
<p>You can specify a more stringent degree of consistency by using an export parameter such as <code dir="ltr">FLASHBACK_SCN</code> or <code dir="ltr">FLASHBACK_TIME</code>.</p>
</li>
<li>
<p>For each source database of the new database, except for the source database that performed the export for instantiation in Step <a href="#i1011162">2</a>, set the instantiation SCNs at the new database. These instantiation SCNs must be set, and only the changes made at a source database that are committed after the corresponding SCN for that database will be applied at the new database.</p>
<p>For each source database, you can set these instantiation SCNs in one of the following ways:</p>
<ul>
<li>
<p>Perform a metadata only export at the source database and import the metadata at the new database. The import sets the required instantiation SCNs for the source database at the new database. In this case, ensure that the replicated database objects at the new database are consistent with the source database at the time of the export.</p>
<p>If you are replicating DML changes only, then table level export/import is sufficient. If you are replicating DDL changes also, then additional considerations apply. See <a href="instant.htm#i1009393">&#34;Setting Instantiation SCNs Using Export/Import&#34;</a> for more information about performing a metadata export/import.</p>
</li>
<li>
<p>Set the instantiation SCNs manually at the new database for the replicated database objects. Ensure that the replicated database objects at the new database are consistent with the source database as of the corresponding instantiation SCN. See <a href="instant.htm#i1009455">&#34;Setting Instantiation SCNs Using the DBMS_APPLY_ADM Package&#34;</a> for instructions.</p>
</li>
</ul>
</li>
<li>
<p>At the new database, configure conflict resolution if conflicts are possible. See <a href="conflict.htm#g1013001">Chapter 9, &#34;Oracle Streams Conflict Resolution&#34;</a> for instructions.</p>
</li>
<li>
<p>Start the apply processes that you created in Step <a href="#i1010980">3</a> at the new database using the <code dir="ltr">START_APPLY</code> procedure in the <code dir="ltr">DBMS_APPLY_ADM</code> package.</p>
</li>
<li>
<p>Start the apply processes that you created in Step <a href="#i1010989">4</a> at each of the other destination databases. If the new database is not a source database, then do not complete this step.</p>
</li>
</ol>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment91">
<tr>
<td class="cellalignment98">
<table class="cellalignment96">
<tr>
<td class="cellalignment95"><a href="config_flex.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment95"><a href="ccap.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment100">
<table class="cellalignment94">
<tr>
<td class="cellalignment95"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment95"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment95"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment95"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment95"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment95"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>