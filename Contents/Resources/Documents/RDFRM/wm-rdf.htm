<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-88971"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Workspace%20Manager%20Support%20for%20RDF%20Data"></a><title>Workspace Manager Support for RDF Data</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="Workspace Manager, enabling support for RDF data, sdordfwm.sql script, removing support for RDF data, version-enabling an RDF model, version-enabling an RDF model, inferring from version-enabled RDF models, merging and refreshing workspaces, workspaces, merging and refreshing, restrictions and considerations with RDF data, usage flow example, restrictions with version-enabled models"/>
<meta name="dcterms.created" content="2017-06-29T10:38:43Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Spatial and Graph RDF Semantic Graph Developer&#39;s Guide"/>
<meta name="dcterms.identifier" content="E51611-08"/>
<meta name="dcterms.isVersionOf" content="RDFRM"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2005, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="fine-grained-access.htm" title="Previous" type="text/html"/>
<link rel="Next" href="rdf-jena.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E51611-08.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-7F300093-7ABC-4FF7-AFFC-248C94D02666"></a> <span id="PAGE" style="display:none;">13/28</span> <!-- End Header -->
<a id="RDFRM99965"></a>
<h1 id="RDFRM-GUID-7F300093-7ABC-4FF7-AFFC-248C94D02666" class="sect1"><span class="enumeration_chapter">6</span> Workspace Manager Support for RDF Data</h1>
<div>
<div class="infobox-note" id="GUID-7F300093-7ABC-4FF7-AFFC-248C94D02666__GUID-C493EED5-2785-4AF2-897A-43E6FE703D71">
<p class="notep1">Note:</p>
<p>Effective with Oracle Database Release 12<span class="italic">c</span> (12.1), Workspace Manager support in RDF Semantic Graph is deprecated, and will be removed in an upcoming major release.</p>
<p>You should not develop new RDF Semantic Graph applications that depend on version-enabled models, and you should transition existing RDF Semantic Graph applications that depend on Workspace Manager to use an alternative.</p>
<p>The specific alternative to using Workspace Manager with semantic data depends on the purpose of the application. For information about use cases and recommended alternatives, see My Oracle Support Note <a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1468273.1" target="_blank"><span>1468273.1</span></a>.</p>
</div>
<p>RDF data stored in the Oracle Database semantic data store can be version-enabled using Oracle Database Workspace Manager. Using Workspace Manager, you can create new versions of RDF data through data modification operations while maintaining a copy of the old data. For detailed usage and reference information about Workspace Manager, see <a class="olink ADWSM" target="_blank" href="../ADWSM/toc.htm"><span class="italic">Oracle Database Workspace Manager Developer&#39;s Guide</span></a>.</p>
<p>The unit of versioning for the semantic data store is a model, which is in turn associated with an application table that resides in a user schema. Traditional Workspace Manager interfaces are used to manage a version-enabled RDF model. (However, you cannot use version-enabling on a model that participates in a virtual model. Virtual models are described in <a href="rdf-overview.htm#GUID-8B957406-5ED1-4579-9C23-0EDE2FDF2964">Virtual Models</a>)</p>
<p>Creating the first version-enabled RDF model in a database re-creates an index on the underlying triple store that holds data for all RDF models. Thus, the time needed to create the first version-enabled RDF model depends on the amount of existing data in these models.</p>
<p>This chapter discuss the key characteristics of a version-enabled RDF model and provides some examples. It contains the following major sections:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="wm-rdf.htm#GUID-8C88A1ED-942B-450E-9A0A-91AC191AA2C2">Enabling Workspace Manager Support for RDF Data</a></p>
</li>
<li>
<p><a href="wm-rdf.htm#GUID-9061CD81-963B-4FED-9F45-4B6EE466905D">Version-Enabling an RDF Model</a></p>
</li>
<li>
<p><a href="wm-rdf.htm#GUID-431DF203-282A-4D6D-BD61-0B45D5273BC2">Inferring from Version-Enabled RDF Models</a></p>
</li>
<li>
<p><a href="wm-rdf.htm#GUID-CCF49CD5-059E-4808-9A5F-ABADD616EE0E">Merging and Refreshing Workspaces in Version-Enabled RDF Models</a></p>
</li>
<li>
<p><a href="wm-rdf.htm#GUID-B3E01314-A459-43A6-B76F-3911765308EF">Special Considerations When Using Workspace Manager Support for RDF Data</a></p>
</li>
<li>
<p><a href="wm-rdf.htm#GUID-D1C5BF14-5F93-4B4A-9F98-BFD10BD0485D">Usage Flow Example: Versioning Semantic Models</a></p>
</li>
</ul>
</div>
<a id="RDFRM99966"></a>
<div class="props_rev_3"><a id="GUID-8C88A1ED-942B-450E-9A0A-91AC191AA2C2"></a>
<h2 id="RDFRM-GUID-8C88A1ED-942B-450E-9A0A-91AC191AA2C2" class="sect2"><span class="enumeration_section">6.1</span> Enabling Workspace Manager Support for RDF Data</h2>
<div>
<p>Workspace Manager support for RDF data is not installed in the database by default. Instead, you must run a script named <code class="codeph">sdordfwm.sql</code> <span class="italic">after</span> you enable RDF Semantic Graph support in the database (explained in <a href="enabling-rdf.htm#GUID-8B3D00C9-E2B8-4074-BE88-055DD5E157BF">Enabling RDF Semantic Graph Support</a>). You only need to run <code class="codeph">sdordfwm.sql</code> once for the database. To run this script, connect to the database as SYSDBA and enter the following statement as appropriate for your operating system:</p>
<ul style="list-style-type: disc;">
<li>
<p>Linux: <code class="codeph">SQL&gt; @$ORACLE_HOME/md/admin/sdordfwm.sql</code></p>
</li>
<li>
<p>Windows: <code class="codeph">SQL&gt; @%ORACLE_HOME%\md\admin\sdordfwm.sql</code></p>
</li>
</ul>
<p>If you want to check whether Workspace Manager support is enabled for RDF data, enter the following query and see if the value returned is <code class="codeph">INSTALLED</code>:</p>
<pre dir="ltr">SELECT value FROM mdsys.rdf_parameter 
  WHERE namespace = &#39;COMPONENT&#39; and attribute = &#39;RDFOWM&#39;;
</pre></div>
<a id="RDFRM99967"></a>
<div class="props_rev_3"><a id="GUID-F90801CE-3DA8-47B4-BB00-E4F6E713431A"></a>
<h3 id="RDFRM-GUID-F90801CE-3DA8-47B4-BB00-E4F6E713431A" class="sect3"><span class="enumeration_section">6.1.1</span> Removing Workspace Manager Support for RDF Data</h3>
<div>
<div class="section">
<p>After you have enabled Workspace Manager support for RDF data, you might need to remove that support in certain circumstances. For example, before you downgrade or remove RDF Semantic Graph support in the database, you must remove the Workspace Manager support for RDF data. (For information about downgrading and removing RDF Semantic Graph support, see <a href="enabling-rdf.htm#GUID-D2F1EC6E-09A6-4845-A9E2-5EA2633F318E">Enabling_ Downgrading_ or Removing RDF Semantic Graph Support</a>.)</p>
<p>To remove Workspace Manager support for RDF data, perform the following steps:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Connect to the database as the SYS user with SYSDBA privileges (SYS AS SYSDBA, and enter the SYS account password when prompted).</span></li>
<li class="stepexpand"><span><a id="d38017e234" class="indexterm-anchor"></a>Start SQL*Plus, and enter the following statement:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p>Linux: <code class="codeph">@$ORACLE_HOME/md/admin/sdordfwm_rm.sql</code></p>
</li>
<li>
<p>Windows: <code class="codeph">@%ORACLE_HOME%\md\admin\sdordfwm_rm.sql</code></p>
</li>
</ul>
</div>
</li>
</ol>
<div class="section">
<p>After the <code class="codeph">sdordfwm_rm.sql</code> script completes successfully, you can downgrade or remove RDF Semantic Graph support in the database.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="RDFRM99968"></a>
<div class="props_rev_3"><a id="GUID-9061CD81-963B-4FED-9F45-4B6EE466905D"></a>
<h2 id="RDFRM-GUID-9061CD81-963B-4FED-9F45-4B6EE466905D" class="sect2"><span class="enumeration_section">6.2</span> Version-Enabling an RDF Model</h2>
<div>
<p>To version-enable an RDF model, you must create any necessary entailments (rules indexes) on it (using the <a href="sem-apis-ref.htm#GUID-BF52CEC0-1BD9-4908-9EF1-F001B0527257">SEM_APIS.CREATE_ENTAILMENT</a> procedure), and then version-enable its associated application table. For example, if an RDF model named <code class="codeph">contracts</code> is associated with an application table named CONTRACTS_RDF_DATA, you can perform the version enabling as shown in the following example:</p>
<pre dir="ltr">begin
  dbms_wm.enableVersioning (table_name =&gt; &#39;contracts_rdf_data&#39;); 
end;
/
</pre>
<p>The application table must have a primary key, and you cannot specify the HISTORY or VALID TIME options.</p>
<p>The data stored in the application table and the corresponding RDF data in the semantic data store are versioned logically. The standard data manipulation operations (insert, update, delete) on a version-enabled application table maintain the version information for both the affected application table rows and the corresponding RDF triples in the semantic data store. Queries accessing the RDF data using the SEM_MATCH operator take the state of the active workspace and the relevant versions of data into account when constructing the result set.</p>
<p>You cannot use continually refreshed workspaces and multiparent workspaces when working with RDF data. However, other workspace operations (such as creating new workspaces, creating savepoints, setting access modes, and refreshing and merging workspaces) proceed as you would expect.</p>
<p>You can use Workspace Manager locks on the application table rows to avoid conflicting data manipulation operations in concurrent workspaces. The conflicts in such cases are detected based on the primary keys for the locked rows, and they may not directly translate to any meaningful locks on the RDF data, such as a lock on a sub-graph or a node. (See <a href="wm-rdf.htm#GUID-CCF49CD5-059E-4808-9A5F-ABADD616EE0E">Merging and Refreshing Workspaces in Version-Enabled RDF Models</a> for best practices involving version-enabled RDF data.)</p>
</div>
</div>
<a id="RDFRM99970"></a><a id="RDFRM99969"></a>
<div class="props_rev_3"><a id="GUID-431DF203-282A-4D6D-BD61-0B45D5273BC2"></a>
<h2 id="RDFRM-GUID-431DF203-282A-4D6D-BD61-0B45D5273BC2" class="sect2"><span class="enumeration_section">6.3</span> Inferring from Version-Enabled RDF Models</h2>
<div>
<p>You can use an RDF model to create one or more entailments through inference using system-defined and user-defined rulebases. When such a model is version-enabled, the associated entailments that store the inferred data are also version-enabled.</p>
<p>However, unlike the RDF models, which are versioned logically, the entailments are versioned physically. Thus, a workspace with some unmerged changes to an RDF model may maintain a private version of the entailment, which duplicates all the inferred triples that may already exist in the entailment corresponding to the parent workspace. <a href="wm-rdf.htm#GUID-431DF203-282A-4D6D-BD61-0B45D5273BC2__CJGIDFFJ">Figure 6-1</a> shows a physically versioned entailment where private copies of the index are maintained for workspaces W1 and W2, which are child workspaces of the LIVE workspace.</p>
<div class="figure" id="GUID-431DF203-282A-4D6D-BD61-0B45D5273BC2__CJGIDFFJ">
<p class="titleinfigure">Figure 6-1 Physical Versioning of Entailment (Rules Index)</p>
<img width="338" height="192" src="img/GUID-6EBC5673-8690-4E30-9E32-87E1E0E04CF1-default.gif" alt="Description of Figure 6-1 follows" title="Description of Figure 6-1 follows"/><br/>
<a href="img_text/GUID-6EBC5673-8690-4E30-9E32-87E1E0E04CF1-default.htm">Description of &#34;Figure 6-1 Physical Versioning of Entailment (Rules Index)&#34;</a></div>
<!-- class="figure" -->
<p>A workspace created from a parent workspace with a valid entailment will share the entailment with its parent until some workspace-specific data manipulation operations occur on the corresponding models. The first data manipulation operation within a workspace creates a private copy of the entailment and marks it INVALID. Workspace-private versions of inference data can be rebuilt using the <a href="sem-apis-ref.htm#GUID-BF52CEC0-1BD9-4908-9EF1-F001B0527257">SEM_APIS.CREATE_ENTAILMENT</a> procedure, as shown in the following example:</p>
<pre dir="ltr">begin
  sem_apis.create_entailment(
            index_name_in   =&gt; &#39;contracts_rdfs&#39;,
            models_in       =&gt; SDO_RDF_Models(&#39;contracts&#39;),
            rulebases_in    =&gt; SDO_RDF_Rulebases(&#39;RDFS&#39;)); 
end;
/
</pre>
<p>Any subsequent additions to the RDF model within the workspace will mark the entailment as INCOMPLETE, although you can return it to a VALID status using the <a href="sem-apis-ref.htm#GUID-BF52CEC0-1BD9-4908-9EF1-F001B0527257">SEM_APIS.CREATE_ENTAILMENT</a> procedure. When a workspace is merged, the workspace-private entailment is dropped, and the corresponding index in the parent workspace is marked INVALID.</p>
</div>
</div>
<a id="RDFRM99971"></a>
<div class="props_rev_3"><a id="GUID-CCF49CD5-059E-4808-9A5F-ABADD616EE0E"></a>
<h2 id="RDFRM-GUID-CCF49CD5-059E-4808-9A5F-ABADD616EE0E" class="sect2"><span class="enumeration_section">6.4</span> Merging and Refreshing Workspaces in Version-Enabled RDF Models</h2>
<div>
<p>A workspace modifying data stored in a version-enabled RDF model may contain additional changes to other RDF models or relational tables. The semantics for the merging or refreshing relational data modified in a workspace remain unchanged. Similarly, the merging or refreshing of the application table is subject to conflict analysis based on the primary key defined in the application table. Triples added and deleted in concurrent workspaces are not flagged as conflicts unless they are associated with the same primary key in the application table. For example, a parent and a child workspace may assert the same triple with different primary keys, and during a workspace merge both the triples are accepted. You can avoid such conflicts by generating the application table primary keys from the triple components.</p>
<p>When you work with RDF data, the types of conflicts that must be flagged vary depending on the application requirements. The conflicts include physical conflicts that exist between two triples, and logical conflicts that exist in a graph to which the triples belong. For example, two concurrent workspaces asserting a triple that captures the value of a specific contract physically conflict with each other. Similarly, a workspace that assigned a new project to a department (with an appropriate triple) may logically conflict with other workspace that reduced the budget for the department.</p>
<p>You can avoid these conflicts by acquiring appropriate Workspace Manager locks on the application table rows using the DBMS_WM.lockRows subprogram. For example, while adding a new triple that describes a specific resource, the application logic may acquire row locks for all application table rows that describe the same resource; in this case, failure to acquire the lock indicates a conflict.</p>
<p>If business conflicts between concurrent workspaces can be manually detected and reconciled, you can use the <span class="italic">&lt;application table name&gt;</span>_DIFF Workspace Manager view to obtain a summary of all the changes in two workspaces. For a version-enabled application table named <code class="codeph">contracts_rdf_data</code>, the query in following example fetches the triples for all the rows that are modified either in <code class="codeph">W2</code> workspace or the <code class="codeph">LIVE</code> workspace:</p>
<pre dir="ltr">begin
  dbms_wm.SetDiffVersions(workspace1 =&gt; &#39;W2&#39;,
                          workspace2 =&gt; &#39;LIVE&#39;);
end;
/
 
SELECT appt.apptable_pkey, appt.triple.get_triple() triple, 
       wm_diffver, wm_code FROM contracts_rdf_data_diff appt;
</pre>
<p>For an explanation of the possible values for the WM_DIFFVER and WM_CODE columns, see the section about <span class="italic">xxx</span>_DIFF views in <a class="olink ADWSM99425" target="_blank" href="../ADWSM/long_views.htm#ADWSM99425"><span class="italic">Oracle Database Workspace Manager Developer&#39;s Guide</span></a>.</p>
<p>For any conflicts detected using this technique, you can resolve them by executing compensating data manipulation operations for the conflicting data modifications.</p>
</div>
</div>
<a id="RDFRM455"></a>
<div class="props_rev_3"><a id="GUID-B3E01314-A459-43A6-B76F-3911765308EF"></a>
<h2 id="RDFRM-GUID-B3E01314-A459-43A6-B76F-3911765308EF" class="sect2"><span class="enumeration_section">6.5</span> Special Considerations When Using Workspace Manager Support for RDF Data</h2>
<div>
<p>Certain RDF Semantic Graph features are not compatible with Workspace Manager for RDF data.</p>
<p>The following network-level features are not supported on semantic networks containing version-enabled RDF models:</p>
<ul style="list-style-type: disc;">
<li>
<p>Oracle Label Security (OLS) for RDF data</p>
</li>
<li>
<p>Virtual Private Database (VPD) for RDF data</p>
</li>
<li>
<p>Semantic indexing for documents</p>
</li>
<li>
<p><a href="sem-apis-ref.htm#GUID-C0D98303-0B3E-4DC5-A4F6-1CA371B10DC2">SEM_APIS.DROP_SEM_NETWORK</a> with the <code class="codeph">cascade</code> option</p>
</li>
</ul>
<p>The following model-level features are not supported on version-enabled RDF models:</p>
<ul style="list-style-type: disc;">
<li>
<p>Participation in virtual models</p>
</li>
<li>
<p>Incremental inference</p>
</li>
<li>
<p><a href="sem-apis-ref.htm#GUID-01791009-BE38-4B8C-B1DD-376D7668AF72">SEM_APIS.ALTER_MODEL</a></p>
</li>
<li>
<p><a href="sem-apis-ref.htm#GUID-47CAA34C-3284-4665-BB9B-D65EBF07ED4E">SEM_APIS.MERGE_MODELS</a></p>
</li>
<li>
<p><a href="sem-apis-ref.htm#GUID-F5D87A18-2285-49B3-BB10-673DC61732F9">SEM_APIS.REMOVE_DUPLICATES</a></p>
</li>
<li>
<p><a href="sem-apis-ref.htm#GUID-E54D4FCA-7B57-40D1-A16D-9B2D9B2D584A">SEM_APIS.RENAME_ENTAILMENT</a></p>
</li>
<li>
<p><a href="sem-apis-ref.htm#GUID-D4E93775-083A-4625-BB37-CA169669C24A">SEM_APIS.RENAME_MODEL</a></p>
</li>
<li>
<p><a href="sem-apis-ref.htm#GUID-15186D10-9EDF-494F-B8CD-D5B77D9CC522">SEM_APIS.SWAP_NAMES</a></p>
</li>
</ul>
<p>Version-enabled RDF models cannot be used in a CDB (multitenant container database) environment.</p>
</div>
</div>
<a id="RDFRM457"></a><a id="RDFRM456"></a>
<div class="props_rev_3"><a id="GUID-D1C5BF14-5F93-4B4A-9F98-BFD10BD0485D"></a>
<h2 id="RDFRM-GUID-D1C5BF14-5F93-4B4A-9F98-BFD10BD0485D" class="sect2"><span class="enumeration_section">6.6</span> Usage Flow Example: Versioning Semantic Models</h2>
<div>
<p><a href="wm-rdf.htm#GUID-D1C5BF14-5F93-4B4A-9F98-BFD10BD0485D__CFAIEFIF">Example 6-1</a> shows how entailments can be handled in different workspaces. Comments within the example explain the individual operations.</p>
<p>Note the following restrictions and considerations for version-enabled RDF models, which are reflected in <a href="wm-rdf.htm#GUID-D1C5BF14-5F93-4B4A-9F98-BFD10BD0485D__CFAIEFIF">Example 6-1</a>:</p>
<ul style="list-style-type: disc;">
<li>
<p>Incremental inference is not supported for entailments involving version-enabled RDF models.</p>
</li>
<li>
<p>Although an already created entailment can be made VALID by calling <a href="sem-apis-ref.htm#GUID-BF52CEC0-1BD9-4908-9EF1-F001B0527257">SEM_APIS.CREATE_ENTAILMENT</a>, a new entailment cannot be created once the application table corresponding to an RDF model has been version-enabled.</p>
</li>
<li>
<p>The pattern argument for SEM_MATCH needs to use the old (non-curly-brace) syntax.</p>
</li>
<li>
<p>The following option must be used in the <a href="sem-apis-ref.htm#GUID-BF52CEC0-1BD9-4908-9EF1-F001B0527257">SEM_APIS.CREATE_ENTAILMENT</a> invocation involving version-enabled models: <code class="codeph">&#39;EPT=1</code>&#39; (or <code class="codeph">options =&gt; &#39;USER_RULES=T,EPT=1</code>&#39; when user-defined rules are used) .</p>
</li>
</ul>
<div class="example" id="GUID-D1C5BF14-5F93-4B4A-9F98-BFD10BD0485D__CFAIEFIF">
<p class="titleinexample">Example 6-1 Versioning a Semantic Model</p>
<pre dir="ltr">set pagesize 10000
 
-- 1. Enabling Workspace Manager Support for RDF Data
conn / as sysdba
@?/md/admin/sdordfwm.sql
 
set echo on
column x format a10
column y format a10
 
column owner format a10
column index_name format a12
column index_view_name format a18
column status format a10
 
-- create sem network and a test user
exec sem_apis.create_sem_network(&#39;SYSAUX&#39;);
grant connect,resource,unlimited tablespace to rdfuser identified by rdfuser;
 
-- 2. Create table and model: then Insert triples (that will lead to some inferred triples, when entailed)
 
conn rdfuser/&lt;password&gt;
 
CREATE TABLE emp_rdf_data(id number,triple sdo_rdf_triple_s);
ALTER TABLE emp_rdf_data add CONSTRAINT emp_rdf_data_PK PRIMARY KEY (ID);
 
EXEC SEM_APIS.CREATE_SEM_MODEL(&#39;emp0&#39;,&#39;emp_rdf_data&#39;,&#39;triple&#39;);
 
insert into emp_rdf_data values (0.1, sdo_rdf_triple_s(&#39;emp0&#39;,&#39;&lt;Man&gt;&#39;,&#39;rdfs:subClassOf&#39;,&#39;&lt;Person&gt;&#39;));
insert into emp_rdf_data values (0.2, sdo_rdf_triple_s(&#39;emp0&#39;,&#39;&lt;Woman&gt;&#39;,&#39;rdfs:subClassOf&#39;,&#39;&lt;Person&gt;&#39;));
insert into emp_rdf_data values (1, sdo_rdf_triple_s(&#39;emp0&#39;,&#39;&lt;John&gt;&#39;,&#39;rdf:type&#39;,&#39;&lt;Man&gt;&#39;));
 
-- 3. Create entailments: one with user-def rules only and the other with OWL
 
exec sdo_rdf_inference.create_rulebase(&#39;family_rb&#39;);
 
insert into mdsys.rdfr_family_rb values (
&#39;R1&#39;,
&#39;(?x rdf:type &lt;Man&gt;)&#39;,
NULL,
&#39;(?x rdf:type &lt;Male&gt;)&#39;,
NULL);
 
insert into mdsys.rdfr_family_rb values (
&#39;R2&#39;,
&#39;(?x rdf:type &lt;Woman&gt;)&#39;,
NULL,
&#39;(?x rdf:type &lt;Female&gt;)&#39;,
NULL);
 
begin
sem_apis.create_entailment(
index_name_in =&gt; &#39;emp0_u_idx&#39;,
models_in =&gt; SDO_RDF_Models(&#39;emp0&#39;),
rulebases_in =&gt; SDO_RDF_Rulebases(&#39;family_rb&#39;),
options =&gt; &#39;USER_RULES=T,EPT=1&#39;);
end;
/
 
begin
sem_apis.create_entailment(
index_name_in =&gt; &#39;emp0_idx&#39;,
models_in =&gt; SDO_RDF_Models(&#39;emp0&#39;),
rulebases_in =&gt; SDO_RDF_Rulebases(&#39;owlprime&#39;),
options =&gt; &#39;EPT=1&#39;);
end;
/
 
select * from mdsys.rdf_rules_index_info;
select count(*) from mdsys.rdfi_emp0_u_idx;
select x,y from TABLE(SEM_MATCH(&#39;(?x rdf:type ?y)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;family_rb&#39;),null,null)) order by 1,2;
select count(*) from mdsys.rdfi_emp0_idx;
select x from TABLE(SEM_MATCH(&#39;(?x rdf:type &lt;Person&gt;)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;OWLPRIME&#39;),null,null)) order by 1;
 
-- 4. Activate versioning and re-try the queries
 
EXEC dbms_wm.enableVersioning (table_name =&gt; &#39;emp_rdf_data&#39;);
 
select * from mdsys.rdf_rules_index_info;
select count(*) from mdsys.rdfi_emp0_u_idx;
select x,y from TABLE(SEM_MATCH(&#39;(?x rdf:type ?y)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;family_rb&#39;),null,null)) order by 1,2;
select count(*) from mdsys.rdfi_emp0_idx;
select x from TABLE(SEM_MATCH(&#39;(?x rdf:type &lt;Person&gt;)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;OWLPRIME&#39;),null,null)) order by 1;
 
 
-- 4a. [fail] try to create a post-versioning entailment for testing
 
begin
sem_apis.create_entailment(
index_name_in =&gt; &#39;emp0_idx_2&#39;,
models_in =&gt; SDO_RDF_Models(&#39;emp0&#39;),
rulebases_in =&gt; SDO_RDF_Rulebases(&#39;owl2rl&#39;),
options =&gt; &#39;EPT=1&#39;);
end;
/
 
 
-- 5. Create Workspace and move into that workspace
 
exec dbms_wm.createworkspace(&#39;W1&#39;);
exec dbms_wm.gotoWorkspace(&#39;W1&#39;);
 
-- 5a. [fail] in this workspace, try to create a post-versioning entailment for testing
 
begin
sem_apis.create_entailment(
index_name_in =&gt; &#39;emp0_idx_3&#39;,
models_in =&gt; SDO_RDF_Models(&#39;emp0&#39;),
rulebases_in =&gt; SDO_RDF_Rulebases(&#39;rdfs&#39;),
options =&gt; &#39;EPT=1&#39;);
end;
/
 
-- 6. Workspace inherits the entailment from LIVE workspace (no physical copy yet)
 
select * from mdsys.rdf_rules_index_info;
select count(*) from mdsys.rdfi_emp0_u_idx;
select x,y from TABLE(SEM_MATCH(&#39;(?x rdf:type ?y)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;family_rb&#39;),null,null)) order by 1,2;
select count(*) from mdsys.rdfi_emp0_idx;
select x from TABLE(SEM_MATCH(&#39;(?x rdf:type &lt;Person&gt;)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;OWLPRIME&#39;),null,null)) order by 1;
 
-- 7. Insert some triples =&gt; causes LIVE entailments to be copied to this workspace and marked INVALID here
insert into emp_rdf_data values (2.1, sdo_rdf_triple_s(&#39;emp0&#39;,&#39;&lt;Mary&gt;&#39;,&#39;rdf:type&#39;,&#39;&lt;Woman&gt;&#39;));
commit;
 
select * from mdsys.rdf_rules_index_info;
select count(*) from mdsys.rdfi_emp0_u_idx;
select x,y from TABLE(SEM_MATCH(&#39;(?x rdf:type ?y)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;family_rb&#39;),null,null)) order by 1,2;
select count(*) from mdsys.rdfi_emp0_idx;
select x from TABLE(SEM_MATCH(&#39;(?x rdf:type &lt;Person&gt;)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;OWLPRIME&#39;),null,null)) order by 1;
 
-- 8. Go back to LIVE workspace to confirm that the LIVE entailments are still VALID
 
disconnect
connect rdfuser/rdfuser
select * from mdsys.rdf_rules_index_info;
select count(*) from mdsys.rdfi_emp0_u_idx;
select x,y from TABLE(SEM_MATCH(&#39;(?x rdf:type ?y)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;family_rb&#39;),null,null)) order by 1,2;
select count(*) from mdsys.rdfi_emp0_idx;
select x from TABLE(SEM_MATCH(&#39;(?x rdf:type &lt;Person&gt;)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;OWLPRIME&#39;),null,null)) order by 1;
 
-- 9. Back to new workspace: make its entailments VALID
 
exec dbms_wm.gotoWorkspace(&#39;W1&#39;);
 
begin
sem_apis.create_entailment(
index_name_in =&gt; &#39;emp0_u_idx&#39;,
models_in =&gt; SDO_RDF_Models(&#39;emp0&#39;),
rulebases_in =&gt; SDO_RDF_Rulebases(&#39;family_rb&#39;),
options =&gt; &#39;USER_RULES=T,EPT=1&#39;);
end;
/
 
begin
sem_apis.create_entailment(
index_name_in =&gt; &#39;emp0_idx&#39;,
models_in =&gt; SDO_RDF_Models(&#39;emp0&#39;),
rulebases_in =&gt; SDO_RDF_Rulebases(&#39;owlprime&#39;),
options =&gt; &#39;EPT=1&#39;);
end;
/
 
select * from mdsys.rdf_rules_index_info;
select count(*) from mdsys.rdfi_emp0_u_idx;
select x,y from TABLE(SEM_MATCH(&#39;(?x rdf:type ?y)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;family_rb&#39;),null,null)) order by 1,2;
select count(*) from mdsys.rdfi_emp0_idx;
select x from TABLE(SEM_MATCH(&#39;(?x rdf:type &lt;Person&gt;)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;OWLPRIME&#39;),null,null)) order by 1;
 
-- 10. Go back to LIVE workspace to confirm that the entailments there are still VALID
 
disconnect
connect rdfuser/rdfuser
select * from mdsys.rdf_rules_index_info;
select count(*) from mdsys.rdfi_emp0_u_idx;
select x,y from TABLE(SEM_MATCH(&#39;(?x rdf:type ?y)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;family_rb&#39;),null,null)) order by 1,2;
select count(*) from mdsys.rdfi_emp0_idx;
select x from TABLE(SEM_MATCH(&#39;(?x rdf:type &lt;Person&gt;)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;OWLPRIME&#39;),null,null)) order by 1;
 
-- 11. Insert a new row into LIVE model =&gt; causes LIVE entailments to become INVALID
 
insert into emp_rdf_data values (3, sdo_rdf_triple_s(&#39;emp0&#39;,&#39;&lt;Gary&gt;&#39;,&#39;rdf:type&#39;,&#39;&lt;Man&gt;&#39;));
commit;
 
select * from mdsys.rdf_rules_index_info;
select count(*) from mdsys.rdfi_emp0_u_idx;
select x,y from TABLE(SEM_MATCH(&#39;(?x rdf:type ?y)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;family_rb&#39;),null,null)) order by 1,2;
select count(*) from mdsys.rdfi_emp0_idx;
select x from TABLE(SEM_MATCH(&#39;(?x rdf:type &lt;Person&gt;)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;OWLPRIME&#39;),null,null)) order by 1;
 
-- 12. Back to new workspace: confirm that its entailment is still VALID
 
exec dbms_wm.gotoWorkspace(&#39;W1&#39;);
 
select * from mdsys.rdf_rules_index_info;
select count(*) from mdsys.rdfi_emp0_u_idx;
select x,y from TABLE(SEM_MATCH(&#39;(?x rdf:type ?y)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;family_rb&#39;),null,null)) order by 1,2;
select count(*) from mdsys.rdfi_emp0_idx;
select x from TABLE(SEM_MATCH(&#39;(?x rdf:type &lt;Person&gt;)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;OWLPRIME&#39;),null,null)) order by 1;
 
-- 13. Back to LIVE workspace: make the entailments VALID again
 
disconnect
connect rdfuser/rdfuser
 
begin
sem_apis.create_entailment(
index_name_in =&gt; &#39;emp0_u_idx&#39;,
models_in =&gt; SDO_RDF_Models(&#39;emp0&#39;),
rulebases_in =&gt; SDO_RDF_Rulebases(&#39;family_rb&#39;),
options =&gt; &#39;USER_RULES=T,EPT=1&#39;);
end;
/
 
begin
sem_apis.create_entailment(
index_name_in =&gt; &#39;emp0_idx&#39;,
models_in =&gt; SDO_RDF_Models(&#39;emp0&#39;),
rulebases_in =&gt; SDO_RDF_Rulebases(&#39;owlprime&#39;),
options =&gt; &#39;EPT=1&#39;);
end;
/
 
select * from mdsys.rdf_rules_index_info;
select count(*) from mdsys.rdfi_emp0_u_idx;
select x,y from TABLE(SEM_MATCH(&#39;(?x rdf:type ?y)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;family_rb&#39;),null,null)) order by 1,2;
select count(*) from mdsys.rdfi_emp0_idx;
select x from TABLE(SEM_MATCH(&#39;(?x rdf:type &lt;Person&gt;)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;OWLPRIME&#39;),null,null)) order by 1;
 
-- 14. Insert a new row into LIVE model =&gt; causes LIVE entailments to become INCOMPLETE
 
insert into emp_rdf_data values (4, sdo_rdf_triple_s(&#39;emp0&#39;,&#39;&lt;Lory&gt;&#39;,&#39;rdf:type&#39;,&#39;&lt;Man&gt;&#39;));
commit;
 
select * from mdsys.rdf_rules_index_info;
select count(*) from mdsys.rdfi_emp0_u_idx;
select x,y from TABLE(SEM_MATCH(&#39;(?x rdf:type ?y)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;family_rb&#39;),null,null)) order by 1,2;
select count(*) from mdsys.rdfi_emp0_idx;
select x from TABLE(SEM_MATCH(&#39;(?x rdf:type &lt;Person&gt;)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;OWLPRIME&#39;),null,null)) order by 1;
 
-- 15. make the entailments in LIVE workspace VALID again
 
begin
sem_apis.create_entailment(
index_name_in =&gt; &#39;emp0_u_idx&#39;,
models_in =&gt; SDO_RDF_Models(&#39;emp0&#39;),
rulebases_in =&gt; SDO_RDF_Rulebases(&#39;family_rb&#39;),
options =&gt; &#39;USER_RULES=T,EPT=1&#39;);
end;
/
 
begin
sem_apis.create_entailment(
index_name_in =&gt; &#39;emp0_idx&#39;,
models_in =&gt; SDO_RDF_Models(&#39;emp0&#39;),
rulebases_in =&gt; SDO_RDF_Rulebases(&#39;owlprime&#39;),
options =&gt; &#39;EPT=1&#39;);
end;
/
 
select * from mdsys.rdf_rules_index_info;
select count(*) from mdsys.rdfi_emp0_u_idx;
select x,y from TABLE(SEM_MATCH(&#39;(?x rdf:type ?y)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;family_rb&#39;),null,null)) order by 1,2;
select count(*) from mdsys.rdfi_emp0_idx;
select x from TABLE(SEM_MATCH(&#39;(?x rdf:type &lt;Person&gt;)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;OWLPRIME&#39;),null,null)) order by 1;
 
-- 16. merge workspace: this should make the LIVE entailments INVALID
conn rdfuser/&lt;password&gt;
exec dbms_wm.mergeWorkspace(&#39;W1&#39;);
 
select * from mdsys.rdf_rules_index_info;
select count(*) from mdsys.rdfi_emp0_u_idx;
select x,y from TABLE(SEM_MATCH(&#39;(?x rdf:type ?y)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;family_rb&#39;),null,null)) order by 1,2;
select count(*) from mdsys.rdfi_emp0_idx;
select x from TABLE(SEM_MATCH(&#39;(?x rdf:type &lt;Person&gt;)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;OWLPRIME&#39;),null,null)) order by 1;
 
-- 17. remove workspace
exec dbms_wm.removeWorkspace(&#39;W1&#39;);
 
-- 18. disable versioning, refresh the INVALID entailments to make them VALID, and then query
exec dbms_wm.disableVersioning(&#39;emp_rdf_data&#39;);
 
select * from mdsys.rdf_rules_index_info;
select count(*) from mdsys.rdfi_emp0_u_idx;
select x,y from TABLE(SEM_MATCH(&#39;(?x rdf:type ?y)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;family_rb&#39;),null,null)) order by 1,2;
select count(*) from mdsys.rdfi_emp0_idx;
select x from TABLE(SEM_MATCH(&#39;(?x rdf:type &lt;Person&gt;)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;OWLPRIME&#39;),null,null)) order by 1;
 
begin
sem_apis.create_entailment(
index_name_in =&gt; &#39;emp0_u_idx&#39;,
models_in =&gt; SDO_RDF_Models(&#39;emp0&#39;),
rulebases_in =&gt; SDO_RDF_Rulebases(&#39;family_rb&#39;),
options =&gt; &#39;USER_RULES=T,EPT=1&#39;);
end;
/
 
begin
sem_apis.create_entailment(
index_name_in =&gt; &#39;emp0_idx&#39;,
models_in =&gt; SDO_RDF_Models(&#39;emp0&#39;),
rulebases_in =&gt; SDO_RDF_Rulebases(&#39;owlprime&#39;),
options =&gt; &#39;EPT=1&#39;);
end;
/
 
select * from mdsys.rdf_rules_index_info;
select count(*) from mdsys.rdfi_emp0_u_idx;
select x,y from TABLE(SEM_MATCH(&#39;(?x rdf:type ?y)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;family_rb&#39;),null,null)) order by 1,2;
select count(*) from mdsys.rdfi_emp0_idx;
select x from TABLE(SEM_MATCH(&#39;(?x rdf:type &lt;Person&gt;)&#39;,sem_models(&#39;emp0&#39;),sem_rulebases(&#39;OWLPRIME&#39;),null,null)) order by 1;
 
-- cleanup
exec sem_apis.drop_entailment(&#39;EMP0_IDX&#39;);
exec sem_apis.drop_entailment(&#39;EMP0_U_IDX&#39;);
exec sem_apis.drop_sem_model(&#39;EMP0&#39;);
exec sem_apis.drop_rulebase(&#39;FAMILY_RB&#39;);
drop table emp_rdf_data;
conn / as sysdba
drop user rdfuser cascade;
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment4500">
<tr>
<td class="cellalignment4507">
<table class="cellalignment4505">
<tr>
<td class="cellalignment4504"><a href="fine-grained-access.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment4504"><a href="rdf-jena.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2005, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment4509">
<table class="cellalignment4503">
<tr>
<td class="cellalignment4504"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment4504"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment4504"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment4504"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment4504"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment4504"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>