<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-88557"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/RDF%20Semantic%20Graph%20Support%20for%20Apache%20Jena"></a><title>RDF Semantic Graph Support for Apache Jena</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="RDF Semantic Graph support for Apache Jena, setting up software environment, setting up SPARQL service, SPARQL, setting up service for RDF Semantic Graph support for Apache Jena, configuring the service, client identifiers, OLTP compression, Oracle Advanced Compression, OLTP compression, Advanced Compression, SEM_MATCH and RDF Semantic Graph support for Apache Jena queries compared, optimized handling of queries, optimized handling of SPARQL queries, optimized handling or property paths, property paths, optimized handling by RDF Semantic Graph support for Apache Jena, federated queries, functions supported in SPARQL queries, DOT files, outputting, .gv files (DOT files), virtual models, support in RDF Semantic Graph support for Apache Jena, support for virtual models, connection pooling, support for connection pooling, support for semantic model PL/SQL interfaces, PelletInfGraph class, support deprecated in RDF Semantic Graph support for Apache Jena, JavaScript Object Notation (JSON) format support, JSON format support, query examples, SPARQL Gateway, features and benefits overview, installing and configuring, using with semantic data, specifying timeout value for SPARQL query, timeout value, specifying for SPARQL query, specifying best effort for SPARQL query, best effort, specifying content type other than text/xml, customizing the default XSLT file, default.xslt file, customizing, XSLT file, customizing default for SPARQL Gateway, Java API, using as an XML data source to OBIEE, OBIEE, using SPARQL Gateway as an XML data source, Oracle Business Intelligence Enterprise Edition (OBIEE)"/>
<meta name="dcterms.created" content="2017-06-29T10:38:43Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Spatial and Graph RDF Semantic Graph Developer&#39;s Guide"/>
<meta name="dcterms.identifier" content="E51611-08"/>
<meta name="dcterms.isVersionOf" content="RDFRM"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2005, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="wm-rdf.htm" title="Previous" type="text/html"/>
<link rel="Next" href="rdf-sesame.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E51611-08.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8"></a> <span id="PAGE" style="display:none;">14/28</span> <!-- End Header -->
<a id="RDFRM234"></a>
<h1 id="RDFRM-GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8" class="sect1"><span class="enumeration_chapter">7</span> RDF Semantic Graph Support for Apache Jena</h1>
<div>
<div class="infobox-note" id="GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8__GUID-B557CA44-3766-4D22-BAB5-9F2AAD668F71">
<p class="notep1">Note:</p>
<p>This feature was previously referred to as the <span class="italic">Jena Adapter for Oracle Database</span> and the <span class="italic">Jena Adapter</span>.</p>
</div>
<p>RDF Semantic Graph support for Apache Jena (also referred to here as support for Apache Jena) provides a Java-based interface to Oracle Spatial and Graph RDF Semantic Graph by implementing the well-known Jena Graph, Model, and DatasetGraph APIs. (Apache Jena is an open source framework. For license and copyright conditions, see <a href="http://www.apache.org/licenses/" target="_blank"><code class="codeph">http://www.apache.org/licenses/</code></a> and <a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank"><code class="codeph">http://www.apache.org/licenses/LICENSE-2.0</code></a>. )</p>
<p>The DatasetGraph APIs are for managing named graph data, also referred to as <span class="bold">quads</span>. In addition, RDF Semantic Graph support for Apache Jena provides network analytical functions on top of semantic data through integrating with the Oracle Spatial and Graph Network Data Model Graph feature.</p>
<p>This chapter assumes that you are familiar with major concepts explained in <a href="rdf-overview.htm#GUID-F422BB9F-8473-4980-9D6C-848F708C10E0">RDF Semantic Graph Overview</a> and <a href="owl-concepts.htm#GUID-3EC5F30E-9175-4B7B-946C-3117BC30610A">OWL Concepts</a> . It also assumes that you are familiar with the overall capabilities and use of the Jena Java framework. For information about the Jena framework, see <a href="http://jena.apache.org/" target="_blank"><code class="codeph">http://jena.apache.org/</code></a>. If you use the network analytical function, you should also be familiar with the Network Data Model Graph feature, which is documented in <a class="olink TOPOL700" target="_blank" href="../TOPOL/network-data-model-graph-overview.htm#TOPOL700"><span class="italic">Oracle Spatial and Graph Topology Data Model and Network Data Model Graph Developer&#39;s Guide</span></a>.</p>
<p>Support for Apache Jena extends the semantic data management capabilities of Oracle Database RDF/OWL.</p>
<p>This chapter includes the following major topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rdf-jena.htm#GUID-17E0C43D-2625-4D69-BBD7-1BCF204684EA">Setting Up the Software Environment</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-BD74255C-3534-4019-979B-C43817B4C58D" title="This topic briefly describes how to configure and set up the Fuseki-based SPARQL service that connects to Oracle Database.">Setting Up the SPARQL Service</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-74757671-5D3E-4813-B8ED-035834F05307">Setting Up the RDF Semantic Graph Environment</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-4FF1C4D8-B1CE-4E88-8E84-703EBBAC2222">SEM_MATCH and RDF Semantic Graph Support for Apache Jena Queries Compared</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD">Retrieving User-Friendly Java Objects from SEM_MATCH or SQL-Based Query Results</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-F6416355-45C1-4FAF-83E4-7EBFA902EA7A">Optimized Handling of SPARQL Queries</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-9B0B74F2-9733-491E-A97C-BB485D33518C">Additions to the SPARQL Syntax to Support Other Features</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-D7D68CA5-24BF-4546-8679-8AF4AA96C38C">Functions Supported in SPARQL Queries through RDF Semantic Graph Support for Apache Jena</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-C94D34A5-436A-4ED7-97D0-BE315755F7AE">SPARQL Update Support</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-828999B9-6B4D-4BA1-AC00-953D20212F24">Analytical Functions for RDF Data</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-CBBCF550-832C-402A-89D2-0CDA62D27F0C">Support for Server-Side APIs</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E">Bulk Loading Using RDF Semantic Graph Support for Apache Jena</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-7EF14C6C-9D85-4BE8-8F51-732822CA178E">Automatic Variable Renaming</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-5A76E641-BF3D-435C-969E-17A61E775806">JavaScript Object Notation (JSON) Format Support</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-78916DE5-15D7-4E6B-B8CA-23DF0D89423C">Other Recommendations and Guidelines</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A">Example Queries Using RDF Semantic Graph Support for Apache Jena</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-649269C9-6EB8-489C-B139-073CB8BA768E">SPARQL Gateway and Semantic Data</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-2F00FBFD-B3F4-4E49-9476-25E5F364A9D7">Deploying Joseki in Apache Tomcat or JBoss</a></p>
</li>
</ul>
<div class="infobox-note" id="GUID-3F437E3E-3B74-4CCF-9F16-B2B07B3899E8__GUID-4F882250-0987-48C0-BE7D-5B3BA0C3F1C4">
<p class="notep1">Note:</p>
<p>The current RDF Semantic Graph support for Apache Jena release has been tested against Apache Jena 2.11.1 and Joseki 3.4.4. Because of the nature of open source projects, you should not use this support for Apache Jena with later versions of Jena or Joseki.</p>
</div>
</div>
<a id="RDFRM235"></a>
<div class="props_rev_3"><a id="GUID-17E0C43D-2625-4D69-BBD7-1BCF204684EA"></a>
<h2 id="RDFRM-GUID-17E0C43D-2625-4D69-BBD7-1BCF204684EA" class="sect2"><span class="enumeration_section">7.1</span> Setting Up the Software Environment</h2>
<div>
<p>To use the support for Apache Jena, you must first ensure that the system environment has the necessary software, including Oracle Database 11<span class="italic">g</span> Release 2 or later with the Spatial and Graph and Partitioning options and with RDF Semantic Graph support enabled, Apache Jena 2.11.1, and JDK 1.6 or later. You can set up the software environment by performing these actions:</p>
<ol>
<li>
<p>Install Oracle Database Enterprise Edition with the Oracle Spatial and Graph and Partitioning Options.</p>
</li>
<li>
<p>If you have not yet installed Oracle Database Release 11.2.0.3 or later, install the 11.2.0.2 Patch Set for Oracle Database Server (<a href="https://updates.oracle.com/Orion/PatchDetails/process_form?patch_num=10098816" target="_blank"><code class="codeph">https://updates.oracle.com/Orion/PatchDetails/process_form?patch_num=10098816</code></a>).</p>
</li>
<li>
<p>Enable the support for RDF Semantic Graph, as explained in <a href="enabling-rdf.htm#GUID-8B3D00C9-E2B8-4074-BE88-055DD5E157BF">Enabling RDF Semantic Graph Support</a>.</p>
</li>
<li>
<p>Download RDF Semantic Graph support for Apache Jena from My Oracle Support at <a href="http://support.oracle.com/" target="_blank"><code class="codeph">http://support.oracle.com/</code></a>. Search the Knowledge Base for bug identifier 17241927.</p>
<p>A full evaluation version of RDF Semantic Graph support for Apache Jena can be downloaded from OTN at <a href="http://www.oracle.com/technetwork/database-options/spatialandgraph/" target="_blank"><code class="codeph">http://www.oracle.com/technetwork/database-options/spatialandgraph/</code></a>. Click the <span class="bold">Downloads</span> tab, and then under Licensed Software click <span class="bold">RDF Semantic Graph Licensed Software</span>.</p>
</li>
<li>
<p>Unzip the kit into a temporary directory, such as (on a Linux system) <code class="codeph">/tmp/jena_adapter</code>. (If this temporary directory does not already exist, create it before the unzip operation.)</p>
<p>The RDF Semantic Graph support for Apache Jena has the following top-level directories:</p>
<pre dir="ltr">|-- META-INF
  |-- examples
  |-- jar
  |-- javadoc
  |-- joseki
  |-- joseki_web_app
  |-- protege_plugin
  |-- sparqlgateway
  |-- sparqlgateway_web_app
  |-- fuseki
  |-- web
</pre></li>
<li>
<p>If JDK 1.6 or later is not already installed, install it.</p>
</li>
<li>
<p>If the JAVA_HOME environment variable does not already refer to the JDK 1.6 or later installation, define it accordingly. For example:</p>
<pre dir="ltr">setenv JAVA_HOME /usr/local/packages/jdk16/
</pre></li>
<li>
<p>If the SPARQL service to support the SPARQL protocol is not set up, set it up as explained in <a href="rdf-jena.htm#GUID-BD74255C-3534-4019-979B-C43817B4C58D" title="This topic briefly describes how to configure and set up the Fuseki-based SPARQL service that connects to Oracle Database.">Setting Up the SPARQL Service</a>.</p>
</li>
</ol>
<p>After setting up the software environment, ensure that your RDF Semantic Graph environment can enable you to use the support for Apache Jena to perform queries, as explained in <a href="rdf-jena.htm#GUID-74757671-5D3E-4813-B8ED-035834F05307">Setting Up the RDF Semantic Graph Environment</a>.</p>
</div>
<a id="RDFRM742"></a>
<div class="props_rev_3"><a id="GUID-BDD428CF-5B6F-4DD7-92B2-96C1B45C33AE"></a>
<h3 id="RDFRM-GUID-BDD428CF-5B6F-4DD7-92B2-96C1B45C33AE" class="sect3"><span class="enumeration_section">7.1.1</span> If You Used a Previous Version of the Support for Apache Jena</h3>
<div>
<p>If you used a previous version of the support for Apache Jena, note the following important changes for this version:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">com.hp.hpl.jena.sparql.core.DataSourceImpl</code> is replaced by <code class="codeph">com.hp.hpl.jena.sparql.core.DatasetImpl</code>.</p>
<p>If you have <code class="codeph">import com.hp.hpl.jena.sparql.core.DataSourceImpl</code> in your Java source code, you will need to update it to <code class="codeph">import com.hp.hpl.jena.sparql.core.DatasetImpl</code>.</p>
<p>If you have <code class="codeph">DataSourceImpl.wrap</code> in your Java source code, you will need to update it to <code class="codeph">DatasetImpl.wrap&#34;</code>.</p>
</li>
<li>
<p><code class="codeph">joseki-config.ttl</code> is moved under the <code class="codeph">WEB-INF/classes</code> directory of <code class="codeph">joseki.war</code>. This configuration file was formerly placed under the top-level directory of <code class="codeph">joseki.war</code>. The following example shows the new placement:</p>
<pre dir="ltr">% /usr/local/packages/jdk16/bin/jar tf joseki.war
application.xml
index.html
joseki-config-ttl_now_under_WEB-INF_classes
META-INF/
META-INF/MANIFEST.MF
ojdbc6.jar
StyleSheets/
StyleSheets/joseki.css
update.html
WEB-INF/
WEB-INF/lib/
WEB-INF/lib/sdordfclient.jar
WEB-INF/lib/jena-arq-2.11.1.jar
WEB-INF/lib/log4j-1.2.16.jar
WEB-INF/lib/jcl-over-slf4j-1.6.4.jar
WEB-INF/lib/httpclient-4.2.3.jar
WEB-INF/lib/commons-codec-1.6.jar
WEB-INF/lib/slf4j-log4j12-1.6.4.jar
WEB-INF/lib/servlet-api-2.5-20081211.jar
WEB-INF/lib/xercesImpl-2.11.0.jar
WEB-INF/lib/slf4j-api-1.6.4.jar
WEB-INF/lib/jena-tdb-1.0.1.jar
WEB-INF/lib/jena-core-2.11.1.jar
WEB-INF/lib/httpcore-4.2.2.jar
WEB-INF/lib/joseki-3.4.4.oracle_build_jena211.jar
WEB-INF/lib/jena-iri-1.0.1.jar
WEB-INF/lib/sdordf.jar
WEB-INF/lib/xml-apis-1.4.01.jar
WEB-INF/web.xml
WEB-INF/classes/
<span class="bold">WEB-INF/classes/joseki-config.ttl</span>
xml-to-html.xsl
</pre></li>
</ul>
</div>
</div>
</div>
<a id="RDFRM236"></a>
<div class="props_rev_3"><a id="GUID-BD74255C-3534-4019-979B-C43817B4C58D"></a>
<h2 id="RDFRM-GUID-BD74255C-3534-4019-979B-C43817B4C58D" class="sect2"><span class="enumeration_section">7.2</span> Setting Up the SPARQL Service</h2>
<div>
<p>This section explains how to set up a SPARQL web service endpoint by deploying the <code class="codeph">joseki.war</code> file in WebLogic Server.</p>
<div class="infobox-note" id="GUID-BD74255C-3534-4019-979B-C43817B4C58D__GUID-BEA4FFAD-DADB-4D4E-9E23-D54678BA86F7">
<p class="notep1">Note:</p>
<p>If you want to deploy Joseki in Apache Tomcat or JBoss instead of WebLogic Server, see <a href="rdf-jena.htm#GUID-2F00FBFD-B3F4-4E49-9476-25E5F364A9D7">Deploying Joseki in Apache Tomcat or JBoss</a>.</p>
</div>
<ol>
<li>
<p>Download and Install Oracle WebLogic Server 11g or later.</p>
</li>
<li>
<p>Ensure that you have Java 6 or later installed, because it is required by Joseki 3.4.4.</p>
</li>
<li>
<p>Using the WebLogic Server Administration console, create a J2EE data source named <span class="italic">OracleSemDS</span>. During the data source creation, you can specify a user and password for the database schema that contains the relevant semantic data against which SPARQL queries are to be executed.</p>
<p>If you need help in creating this data source, see <a href="rdf-jena.htm#GUID-CC0618F7-318D-4F21-A78D-29CF31FDDB7F">Creating the Required Data Source Using WebLogic Server</a>.</p>
</li>
<li>
<p>Go to the <code class="codeph">autodeploy</code> directory of WebLogic Server and copy files, as follows. (For information about auto-deploying applications in development domains, see: <a href="http://docs.oracle.com/cd/E24329_01/web.1211/e24443/autodeploy.htm" target="_blank"><code class="codeph">http://docs.oracle.com/cd/E24329_01/web.1211/e24443/autodeploy.htm</code></a>)</p>
<pre dir="ltr">cd <span class="italic">&lt;domain_name&gt;</span>/autodeploy
cp -rf  /tmp/jena_adapter/joseki_web_app/joseki.war  <span class="italic">&lt;domain_name&gt;</span>/autodeploy
</pre>
<p>In the preceding example, <span class="italic">&lt;domain_name&gt;</span> is the name of a WebLogic Server domain.</p>
<p>Note that while you can run a WebLogic Server domain in two different modes, development and production, only development mode allows you use the auto-deployment feature.</p>
</li>
<li>
<p>Verify your deployment by using your Web browser to connect to a URL in the following format (assume that the Web application is deployed at port 7001): <code class="codeph">http://</code><span class="italic"><code class="codeph">&lt;hostname&gt;</code></span><code class="codeph">:7001/joseki</code></p>
<p>You should see a page titled <span class="italic">Oracle SPARQL Service Endpoint using Joseki</span>, and the first text box should contain an example SPARQL query.</p>
</li>
<li>
<p>Click <span class="bold">Submit Query</span>.</p>
<p>You should see a page titled <span class="italic">Oracle SPARQL Endpoint Query Results</span>. There may or may not be any results, depending on the underlying semantic model against which the query is executed.</p>
</li>
</ol>
<p>By default, the <code class="codeph">joseki-config.ttl</code> file contains an <code class="codeph">oracle:Dataset</code> definition using a model named <code class="codeph">M_NAMED_GRAPHS</code>. The following snippet shows the configuration. The <code class="codeph">oracle:allGraphs</code> predicate denotes that the SPARQL service endpoint will serve queries using all graphs stored in the <code class="codeph">M_NAMED_GRAPHS</code> model.</p>
<pre dir="ltr">&lt;#oracle&gt; rdf:type oracle:Dataset;
    joseki:poolSize     1 ;         ## Number of concurrent connections allowed to this dataset.
    oracle:connection
    [ a oracle:OracleConnection ;
    ];
    oracle:allGraphs [ oracle:firstModel &#34;M_NAMED_GRAPHS&#34; ] .
</pre>
<p>The <code class="codeph">M_NAMED_GRAPHS</code> model will be created automatically (if it does not already exist) upon the first SPARQL query request. You can add a few example triples and quads to test the named graph functions; for example:</p>
<pre dir="ltr">SQL&gt; CONNECT <span class="italic">username/password</span>
SQL&gt; INSERT INTO m_named_graphs_tpl VALUES(sdo_rdf_triple_s(&#39;m_named_graphs&#39;,&#39;&lt;urn:s&gt;&#39;,&#39;&lt;urn:p&gt;&#39;,&#39;&lt;urn:o&gt;&#39;));
SQL&gt; INSERT INTO m_named_graphs_tpl VALUES(sdo_rdf_triple_s(&#39;m_named_graphs:&lt;urn:G1&gt;&#39;,&#39;&lt;urn:g1_s&gt;&#39;,&#39;&lt;urn:g1_p&gt;&#39;,&#39;&lt;urn:g1_o&gt;&#39;));
SQL&gt; INSERT INTO m_named_graphs_tpl VALUES(sdo_rdf_triple_s(&#39;m_named_graphs:&lt;urn:G2&gt;&#39;,&#39;&lt;urn:g2_s&gt;&#39;,&#39;&lt;urn:g2_p&gt;&#39;,&#39;&lt;urn:g2_o&gt;&#39;));
SQL&gt; COMMIT;
</pre>
<p>After inserting the rows, go to <code class="codeph">http://</code><span class="italic"><code class="codeph">&lt;hostname&gt;</code></span><code class="codeph">:7001/joseki</code>, type the following SPARQL query, and click <span class="bold">Submit Query</span>:</p>
<pre dir="ltr">SELECT ?g ?s ?p ?o
WHERE 
  { GRAPH ?g { ?s ?p ?o} }
</pre>
<p>The result should be an HTML table with four columns and two sets of result bindings.</p>
<p>The <code class="codeph">http://</code><span class="italic"><code class="codeph">&lt;hostname&gt;</code></span><code class="codeph">:7001/joseki</code> page also contains a <span class="bold">JSON Output</span> option. If this option is selected (enabled), the SPARQL query response is converted to JSON format.</p>
</div>
<a id="RDFRM237"></a>
<div class="props_rev_3"><a id="GUID-CC0618F7-318D-4F21-A78D-29CF31FDDB7F"></a>
<h3 id="RDFRM-GUID-CC0618F7-318D-4F21-A78D-29CF31FDDB7F" class="sect3"><span class="enumeration_section">7.2.1</span> Creating the Required Data Source Using WebLogic Server</h3>
<div>
<div class="section">
<p>If you need help creating the required J2EE data source using the WebLogic Server admin console, you can follow these steps:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Login to: <code class="codeph">http://</code><span class="italic"><code class="codeph">&lt;hostname&gt;</code></span><code class="codeph">:7001/console</code></span></li>
<li class="stepexpand"><span>In the Domain Structure panel, click <span class="bold">Services</span>.</span></li>
<li class="stepexpand"><span>Click <span class="bold">JDBC</span></span></li>
<li class="stepexpand"><span>Click <span class="bold">Data Sources</span>.</span></li>
<li class="stepexpand"><span>In the Summary of JDBC Data Sources panel, click <span class="bold">New</span> under the Data Sources table.</span></li>
<li class="stepexpand"><span>In the Create a New JDBC Data Source panel, enter or select the following values.</span>
<div>
<p><span class="bold">Name</span>: <code class="codeph">OracleSemDS</code></p>
<p><span class="bold">JNDI Name</span>: <code class="codeph">OracleSemDS</code></p>
<p><span class="bold">Database Type</span>: <code class="codeph">Oracle</code></p>
<p><span class="bold">Database Driver</span>: <code class="codeph">Oracle&#39;s Driver (Thin) Versions: 9.0.1,9.2.0,10,11</code></p>
</div>
</li>
<li class="stepexpand"><span>Click <span class="bold">Next</span> twice.</span></li>
<li class="stepexpand"><span>In the Connection Properties panel, enter the appropriate values for the <span class="bold">Database Name</span>, <span class="bold">Host Name</span>, <span class="bold">Port</span>, <span class="bold">Database User Name</span> (schema that contains semantic data), <span class="bold">Password</span> fields.</span></li>
<li class="stepexpand"><span>Click <span class="bold">Next</span>.</span></li>
<li class="stepexpand"><span>Select (check) the target server or servers to which you want to deploy this <code class="codeph">OracleSemDS</code> data source.</span></li>
<li class="stepexpand"><span>Click <span class="bold">Finish</span>.</span>
<div>
<p>You should see a message that all changes have been activated and no restart is necessary.</p>
</div>
</li>
</ol>
</div>
</div>
<a id="RDFRM238"></a>
<div class="props_rev_3"><a id="GUID-266D140C-5D26-49EA-B723-7ECE12293369"></a>
<h3 id="RDFRM-GUID-266D140C-5D26-49EA-B723-7ECE12293369" class="sect3"><span class="enumeration_section">7.2.2</span> Configuring the Joseki-Based SPARQL Service</h3>
<div>
<p>By default, the SPARQL Service endpoint assumes that the queries are to be executed against a semantic model with a pre-set name. This semantic model is owned by the schema specified in the J2EE data source with a default JNDI name <span class="italic">OracleSemDS</span>. Note that you do not need to create this model explicitly using PL/SQL or Java; if the model does not exist in the network, it will be automatically created, along with the necessary application table and index.</p>
<div class="infobox-note" id="GUID-266D140C-5D26-49EA-B723-7ECE12293369__GUID-9B4BE5A2-DAFA-4DAC-8332-862185B12A82">
<p class="notep1">Note:</p>
<p>Effective with the support for Apache Jena release in November 2011, the application table index (<span class="italic">&lt;model_name&gt;</span>_idx) definition is changed to accommodate named graph data (quads).</p>
<p>For existing models created by an older version of the support for Apache Jena, you can migrate the application table index name and definition by using the <code class="codeph">static OracleUtils.migrateApplicationTableIndex(oracle, graph, dop)</code> method in the <code class="codeph">oracle.spatial.rdf.client.jena</code> package. (See the Javadoc for more information.) Note that the new index definition is <span class="italic">critical</span> to the performance of DML operations against the application table.</p>
</div>
<p>To change the default JNDI name or to use a default semantic model, you can configure the SPARQL service by editing the <code class="codeph">joseki-config.ttl</code> configuration file, which is embedded under the <code class="codeph">WEB-INF/classes</code> directory in the prebuilt application <code class="codeph">joseki_web_app/joseki.war</code>. (If you used a previous version of the support for Apache Jena, note that <code class="codeph">joseki-config.ttl</code> is now placed under the <code class="codeph">WEB-INF/classes</code> directory instead of under the top level directory of the web application.)</p>
<p>The supplied <code class="codeph">joseki-config.ttl</code> file includes a section similar to the following for the Oracle data set:</p>
<pre dir="ltr">#
## Datasets
#
[] ja:loadClass &#34;oracle.spatial.rdf.client.jena.assembler.OracleAssemblerVocab&#34; .
 
oracle:Dataset  rdfs:subClassOf  ja:RDFDataset .
 
&lt;#oracle&gt; rdf:type oracle:Dataset;
    joseki:poolSize     1 ;         ## Number of concurrent connections allowed to this dataset.
    oracle:connection
    [ a oracle:OracleConnection ;
      oracle:dataSourceName &#34;OracleSemDS&#34;
    ];
    oracle:defaultModel [ oracle:firstModel &#34;TEST_MODEL&#34; ] .
</pre>
<p>In this section of the file, you can:</p>
<ul style="list-style-type: disc;">
<li>
<p>Modify the <code class="codeph">joseki:poolSize</code> value, which specifies the number of concurrent connections allowed to this Oracle data set (<code class="codeph">&lt;#oracle&gt; rdf:type oracle:Dataset;</code>), which points to various RDF models in the database.</p>
</li>
<li>
<p>Customize the name of the data source. The default name of <span class="italic">OracleSemDS</span> can be changed depending on your application requirements. The name, however, must match the data source name specified in <a href="rdf-jena.htm#GUID-CC0618F7-318D-4F21-A78D-29CF31FDDB7F">Creating the Required Data Source Using WebLogic Server</a>.</p>
</li>
<li>
<p>Modify the name (or the object value of <code class="codeph">oracle:firstModel</code> predicate) of the <code class="codeph">defaultModel</code>, to use a different semantic model for queries. You can also specify multiple models, and one or more rulebases for this <code class="codeph">defaultModel</code>.</p>
<p>For example, the following specifies two models (named <code class="codeph">ABOX</code> and <code class="codeph">TBOX</code>) and an OWLPRIME rulebase for the default model. Note that models specified using the <code class="codeph">oracle:modelName</code> predicate must exist; they <span class="italic">will not</span> be created automatically.</p>
<pre dir="ltr">&lt;#oracle&gt; rdf:type oracle:Dataset;
    joseki:poolSize 1 ; ## Number of concurrent connections allowed to this dataset.
    oracle:connection
    [ a oracle:OracleConnection ;
      oracle:dataSourceName &#34;OracleSemDS&#34;
    ];
    oracle:defaultModel [ oracle:firstModel &#34;ABOX&#34;;
                                      oracle:modelName &#34;TBOX&#34;;
                                      oracle:rulebaseName &#34;OWLPRIME&#34; ] .
</pre></li>
<li>
<p>Specify named graphs in the dataset. For example, you can create a named graph called <code class="codeph">&lt;http://G1&gt;</code> based on two Oracle models and an entailment, as follows.</p>
<pre dir="ltr">&lt;#oracle&gt; rdf:type oracle:Dataset;
    joseki:poolSize 1 ; ## Number of concurrent connections allowed to this dataset.
      oracle:connection
      [ a oracle:OracleConnection ;
      ];
      oracle:namedModel [ oracle:firstModel &#34;ABOX&#34;;
                          oracle:modelName &#34;TBOX&#34;;
                          oracle:rulebaseName &#34;OWLPRIME&#34;;
                          <span class="bold">oracle:namedModelURI &lt;http://G1&gt;</span> ]  .
</pre>
<p>The object of <code class="codeph">namedModel</code> can take the same specifications as <code class="codeph">defaultModel</code>, so virtual models are supported here as well (see also the next item).</p>
</li>
<li>
<p>Use a virtual model for queries by adding <code class="codeph">oracle:useVM &#34;TRUE&#34;</code>, as shown in the following example. Note that if the specified virtual model does not exist, it <span class="italic">will</span> automatically be created on demand.</p>
<pre dir="ltr">&lt;#oracle&gt; rdf:type oracle:Dataset;
    joseki:poolSize 1 ; ## Number of concurrent connections allowed to this dataset.
    oracle:connection
    [ a oracle:OracleConnection ;
    ];
    oracle:defaultModel [ oracle:firstModel &#34;ABOX&#34;;
                                     oracle:modelName &#34;TBOX&#34;;
                                     oracle:rulebaseName &#34;OWLPRIME&#34;;
                                     <span class="bold">oracle:useVM &#34;TRUE&#34;</span>
    ] .
</pre>
<p>For more information, see <a href="rdf-jena.htm#GUID-449AF064-7F23-4E4D-8155-06BBBADFADCA">Virtual Models Support</a>.</p>
</li>
<li>
<p>Specify a virtual model as the default model to answer SPARQL queries by using the predicate <code class="codeph">oracle:virtualModelName</code>, as shown in the following example with a virtual model named <code class="codeph">TRIPLE_DATA_VM_0</code>:</p>
<pre dir="ltr">oracle:defaultModel [ oracle:virtualModelName &#34;TRIPLE_DATA_VM_0&#34; ] .
</pre>
<p>If the underlying data consists of quads, you can use <code class="codeph">oracle:virtualModelName</code> with <code class="codeph">oracle:allGraphs</code>. The presence of <code class="codeph">oracle:allGraphs</code> causes an instantiation of <code class="codeph">DatasetGraphOracleSem</code> objects to answer named graph queries. An example is as follows:</p>
<pre dir="ltr">oracle:allGraphs [ oracle:virtualModelName &#34;QUAD_DATA_VM_0&#34; ] .
</pre>
<p>Note that when a virtual model name is specified as the default graph, the endpoint can serve only query requests; SPARQL Update operations are not supported.</p>
</li>
<li>
<p>Set the <code class="codeph">queryOptions</code> and <code class="codeph">inferenceMaintenance</code> properties to change the query behavior and inference update mode. (See the Javadoc for information about <code class="codeph">QueryOptions</code> and <code class="codeph">InferenceMaintenanceMode</code>.)</p>
<p>By default, <code class="codeph">QueryOptions.ALLOW_QUERY_INVALID_AND_DUP</code> and <code class="codeph">InferenceMaintenanceMode.NO_UPDATE</code> are set, for maximum query flexibility and efficiency.</p>
</li>
</ul>
</div>
<a id="RDFRM239"></a>
<div class="props_rev_3"><a id="GUID-9A2D924D-47EC-4D27-8B86-B2AD49290A91"></a>
<h4 id="RDFRM-GUID-9A2D924D-47EC-4D27-8B86-B2AD49290A91" class="sect4"><span class="enumeration_section">7.2.2.1</span> Client Identifiers</h4>
<div>
<p>For every database connection created or used by the support for Apache Jena, a client identifier is associated with the connection. The client identifier can be helpful, especially in a Real Application Cluster (Oracle RAC) environment, for isolating RDF Semantic Graph support for Apache Jena-related activities from other database activities when you are doing performance analysis and tuning.</p>
<p>By default, the client identifier assigned is <code class="codeph">JenaAdapter</code>. However, you can specify a different value by setting the Java VM <code class="codeph">clientIdentifier</code> property using the following format:</p>
<pre dir="ltr">-Doracle.spatial.rdf.client.jena.clientIdentifier=<span class="italic">&lt;identificationString&gt;</span>
</pre>
<p>To start the tracing of only RDF Semantic Graph support for Apache Jena-related activities on the database side, you can use the DBMS_MONITOR.CLIENT_ID_TRACE_ENABLE procedure. For example:</p>
<pre dir="ltr">SQL&gt; EXECUTE DBMS_MONITOR.CLIENT_ID_TRACE_ENABLE(&#39;JenaAdapter&#39;, true, true);
</pre></div>
</div>
<a id="RDFRM458"></a>
<div class="props_rev_3"><a id="GUID-3949377A-BE8B-40CD-98D4-C959A593FBF3"></a>
<h4 id="RDFRM-GUID-3949377A-BE8B-40CD-98D4-C959A593FBF3" class="sect4"><span class="enumeration_section">7.2.2.2</span> Using OLTP Compression for Application Tables and Staging Tables</h4>
<div>
<p>By default, the support for Apache Jena creates the application tables and any staging tables (the latter used for bulk loading, as explained in <a href="rdf-jena.htm#GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E">Bulk Loading Using RDF Semantic Graph Support for Apache Jena</a>) using basic table compression with the following syntax:</p>
<pre dir="ltr">CREATE TABLE .... (... <span class="italic">column definitions</span> ...) ... compress;
</pre>
<p>However, if you are licensed to use the Oracle Advanced Compression option no the database, you can set the following JVM property to turn on OLTP compression, which compresses data during all DML operations against the underlying application tables and staging tables:</p>
<pre dir="ltr">-Doracle.spatial.rdf.client.jena.advancedCompression=&#34;compress for oltp&#34;
</pre></div>
</div>
</div>
<div class="sect3"><a id="GUID-3EB5694D-7BCF-45A7-A7C1-0EC0044C38CD"></a>
<h3 id="RDFRM-GUID-3EB5694D-7BCF-45A7-A7C1-0EC0044C38CD" class="sect3"><span class="enumeration_section">7.2.3</span> Configuring the Fuseki-Based SPARQL Service</h3>
<div>
<p>This topic briefly describes how to configure and set up the Fuseki-based SPARQL service that connects to Oracle Database.</p>
<p>The concepts and actions for using the Fuseki-based SPARQL service are similar to those for the Joseki-based SPARQL service, as explained in <a href="rdf-jena.htm#GUID-266D140C-5D26-49EA-B723-7ECE12293369">Configuring the Joseki-Based SPARQL Service</a>. The information in that topic about client identifiers and OLTP compression also applies to the the Fuseki-based SPARQL service, and the ways to <code class="codeph">defaultModel</code> and <code class="codeph">allGraphs</code> are the same.</p>
<p>An example <code class="codeph">oracle</code> service for the Fuseki-based service is provided in the <code class="codeph">config-oracle.ttl</code> file. For detailed information, see &#34;Fuseki: serving RDF data over HTTP&#34; (<a href="http://jena.apache.org/documentation/serving_data/" target="_blank"><code class="codeph">http://jena.apache.org/documentation/serving_data/</code></a>).</p>
<p>To start the Fuseki-based SPARQL service that connects to Oracle Database, enter the following command:</p>
<pre dir="ltr">cd fuseki/        
% ./fuseki-server  --config config-oracle.ttl
</pre>
<p>When Fuseki is running, you can check the status by going to a URL in the following format: <code class="codeph">http://your-hostname:3030/</code></p>
</div>
</div>
<a id="RDFRM240"></a>
<div class="props_rev_3"><a id="GUID-3B337ACC-28E7-45DF-A7BC-3D01A1337552"></a>
<h3 id="RDFRM-GUID-3B337ACC-28E7-45DF-A7BC-3D01A1337552" class="sect3"><span class="enumeration_section">7.2.4</span> Terminating Long-Running SPARQL Queries</h3>
<div>
<p>Because some applications need to be able to terminate long-running SPARQL queries, an abort framework has been introduced with RDF Semantic Graph support for Apache Jena and the Joseki setup. Basically, for queries that may take a long time to run, you must stamp each with a unique query ID (qid) value.</p>
<p>For example, the following SPARQL query selects out the subject of all triples. A query ID (qid) is set so that this query can be terminated upon request.</p>
<pre dir="ltr">PREFIX ORACLE_SEM_FS_NS:  &lt;http://example.com/semtech#qid=8761&gt;
SELECT ?subject WHERE {?subject ?property ?object }
</pre>
<p>The <code class="codeph">qid</code> attribute value is of long integer type. You can choose a value for the <code class="codeph">qid</code> for a particular query based on your own application needs.</p>
<p>To terminate a SPARQL query that has been submitted with a qid value, applications can send an abort request to a servlet in the following format and specify a matching QID value</p>
<pre dir="ltr">http://<span class="italic">&lt;hostname&gt;</span>:7001/joseki/querymgt?abortqid=8761
</pre></div>
</div>
<a id="RDFRM241"></a>
<div class="props_rev_3"><a id="GUID-E9E1A6CA-1753-4213-AF84-6B2B881529E4"></a>
<h3 id="RDFRM-GUID-E9E1A6CA-1753-4213-AF84-6B2B881529E4" class="sect3"><span class="enumeration_section">7.2.5</span> N-Triples Encoding for Non-ASCII Characters</h3>
<div>
<p>For any non-ASCII characters in the lexical representation of RDF resources, <code class="codeph">\uHHHH</code> N-Triples encoding is used when the characters are inserted into the Oracle database. (For details about N-Triples encoding, see <a href="http://www.w3.org/TR/rdf-testcases/#ntrip_grammar" target="_blank"><code class="codeph">http://www.w3.org/TR/rdf-testcases/#ntrip_grammar</code></a>.) Encoding of the constant resources in a SPARQL query is handled in a similar fashion.</p>
<p>Using <code class="codeph">\uHHHH</code> N-Triples encoding enables support for international characters, such as a mix of Norwegian and Swedish characters, in the Oracle database even if a supported Unicode character set is not being used.</p>
</div>
</div>
</div>
<a id="RDFRM242"></a>
<div class="props_rev_3"><a id="GUID-74757671-5D3E-4813-B8ED-035834F05307"></a>
<h2 id="RDFRM-GUID-74757671-5D3E-4813-B8ED-035834F05307" class="sect2"><span class="enumeration_section">7.3</span> Setting Up the RDF Semantic Graph Environment</h2>
<div>
<div class="section">
<p>To use the support for Apache Jena to perform queries, you can connect as any user (with suitable privileges) and use any models in the semantic network. If your RDF Semantic Graph environment already meets the requirements, you can go directly to compiling and running Java code that uses the support for Apache Jena. If your RDF Semantic Graph environment is not yet set up to be able to use the support for Apache Jena, you can perform actions similar to the following example steps:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Connect as SYS with the SYSDBA role:</span>
<div>
<pre dir="ltr">sqlplus sys/<span class="italic">&lt;password-for-sys&gt;</span> as sysdba
</pre></div>
</li>
<li class="stepexpand"><span>Create a tablespace for the system tables. For example:</span>
<div>
<pre dir="ltr">CREATE TABLESPACE rdf_users datafile &#39;rdf_users01.dbf&#39; 
    size 128M reuse autoextend on next 64M 
    maxsize unlimited segment space management auto;
</pre></div>
</li>
<li class="stepexpand"><span>Create the semantic network. For example:</span>
<div>
<pre dir="ltr">EXECUTE sem_apis.create_sem_network(&#39;RDF_USERS&#39;);
</pre></div>
</li>
<li class="stepexpand"><span>Create a database user (for connecting to the database to use the semantic network and the support for Apache Jena). For example:</span>
<div>
<pre dir="ltr">CREATE USER rdfusr IDENTIFIED BY &lt;password-for-udfusr&gt;
                   DEFAULT TABLESPACE rdf_users;
</pre></div>
</li>
<li class="stepexpand"><span>Grant the necessary privileges to this database user. For example:</span>
<div>
<pre dir="ltr">GRANT connect, resource TO rdfusr;
</pre></div>
</li>
<li class="stepexpand"><span>To use the support for Apache Jena with your own semantic data, perform the appropriate steps to store data, create a model, and create database indexes, as explained in <a href="rdf-overview.htm#GUID-7F590F2D-F382-4CD6-A95A-757010BB148F">Quick Start for Using Semantic Data</a>. Then perform queries by compiling and running Java code; see <a href="rdf-jena.htm#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A">Example Queries Using RDF Semantic Graph Support for Apache Jena</a> for information about example queries.</span>
<div>
<p>To use the support for Apache Jena with supplied example data, see <a href="rdf-jena.htm#GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A">Example Queries Using RDF Semantic Graph Support for Apache Jena</a>.</p>
</div>
</li>
</ol>
</div>
</div>
<a id="RDFRM243"></a>
<div class="props_rev_3"><a id="GUID-4FF1C4D8-B1CE-4E88-8E84-703EBBAC2222"></a>
<h2 id="RDFRM-GUID-4FF1C4D8-B1CE-4E88-8E84-703EBBAC2222" class="sect2"><span class="enumeration_section">7.4</span> SEM_MATCH and RDF Semantic Graph Support for Apache Jena Queries Compared</h2>
<div>
<p>There are two ways to query semantic data stored in Oracle Database: SEM_MATCH-based SQL statements and SPARQL queries through the support for Apache Jena. Queries using each approach are similar in appearance, but there are important behavioral differences. To ensure consistent application behavior, you must understand the differences and use care when dealing with query results coming from SEM_MATCH queries and SPARQL queries.</p>
<p>The following simple examples show the two approaches.</p>
<p><span class="bold">Query 1 (SEM_MATCH-based)</span></p>
<pre dir="ltr">select s, p, o
    from table(sem_match(&#39;{?s ?p ?o}&#39;, sem_models(&#39;Test_Model&#39;), ....))
</pre>
<p><span class="bold">Query 2 (SPARQL query through Support for Apache Jena)</span></p>
<pre dir="ltr">select ?s ?p ?o
where {?s ?p ?o}
</pre>
<p>These two queries perform the same kind of functions; however, there are some important differences. Query 1 (SEM_MATCH-based):</p>
<ul style="list-style-type: disc;">
<li>
<p>Reads all triples out of <code class="codeph">Test_Model</code>.</p>
</li>
<li>
<p>Does not differentiate among URI, bNode, plain literals, and typed literals, and it does not handle long literals.</p>
</li>
<li>
<p>Does not unescape certain characters (such as <code class="codeph">&#39;\n&#39;</code>).</p>
</li>
</ul>
<p>Query 2 (SPARQL query executed through the support for Apache Jena) also reads all triples out of <code class="codeph">Test_Model</code> (assume it executed a call to <code class="codeph">ModelOracleSem</code> referring to the same underlying <code class="codeph">Test_Model</code>). However, Query 2:</p>
<ul style="list-style-type: disc;">
<li>
<p>Reads out additional columns (as opposed to just the <code class="codeph">s</code>, <code class="codeph">p</code>, and <code class="codeph">o</code> columns with the SEM_MATCH table function), to differentiate URI, bNodes, plain literals, typed literals, and long literals. This is to ensure proper creation of Jena Node objects.</p>
</li>
<li>
<p>Unescapes those characters that are escaped when stored in Oracle Database</p>
</li>
</ul>
<p>Blank node handling is another difference between the two approaches:</p>
<ul style="list-style-type: disc;">
<li>
<p>In a SEM_MATCH-based query, blank nodes are always treated as constants.</p>
</li>
<li>
<p>In a SPARQL query, a blank node that <span class="italic">is not</span> wrapped inside <code class="codeph">&lt;</code> and <code class="codeph">&gt;</code> is treated as a variable when the query is executed through the support for Apache Jena. This matches the SPARQL standard semantics. However, a blank node that <span class="italic">is</span> wrapped inside <code class="codeph">&lt;</code> and <code class="codeph">&gt;</code> is treated as a constant when the query is executed, and the support for Apache Jena adds a proper prefix to the blank node label as required by the underlying data modeling.</p>
</li>
</ul>
<p>The maximum length for the name of a semantic model created using the support for Apache Jena API is 22 characters.</p>
</div>
</div>
<a id="RDFRM785"></a><a id="RDFRM786"></a><a id="RDFRM787"></a><a id="RDFRM71234"></a>
<div class="props_rev_3"><a id="GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD"></a>
<h2 id="RDFRM-GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD" class="sect2"><span class="enumeration_section">7.5</span> Retrieving User-Friendly Java Objects from SEM_MATCH or SQL-Based Query Results</h2>
<div>
<p>You can query a semantic graph using any of the following approaches:</p>
<ul style="list-style-type: disc;">
<li>
<p>SPARQL (through Java methods or web service end point)</p>
</li>
<li>
<p>SEM_MATCH (table function that has SPARQL queries embedded)</p>
</li>
<li>
<p>SQL (by querying the MDSYS.RDFM_<span class="italic">&lt;model&gt;</span> view and joining with MDSYS.RDF_VALUE$ and/or other tables)</p>
</li>
</ul>
<p>For Java developers, the results from the first approach are easy to consume. The results from the second and third approaches, however, can be difficult for Java developers because you must parse various columns to get properly typed Java objects that are mapped from typed RDF literals. RDF Semantic Graph support for Apache Jena supports several methods and helper functions to simplify the task of getting properly typed Java objects from a JDBC result set. These methods and helper functions are shown in the following examples:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rdf-jena.htm#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBGIBAE">Example 7-1</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBCBDFC">Example 7-2</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBHEEBA">Example 7-3</a></p>
</li>
</ul>
<p>These examples use a test table TGRAPH_TPL (and model TGRAPH based on it), into which a set of typed literals is added, as in the following code:</p>
<pre dir="ltr">create table tgraph_tpl(triple sdo_rdf_triple_s);
exec sem_apis.create_sem_model(&#39;tgraph&#39;,&#39;tgraph_tpl&#39;,&#39;triple&#39;);
truncate table tgraph_tpl;
 
-- Add some triples
insert into tgraph_tpl values(sdo_rdf_triple_s(&#39;tgraph&#39;,&#39;&lt;urn:s1&gt;&#39;,&#39;&lt;urn:p1&gt;&#39;, &#39;&lt;urn:o1&gt;&#39;));
insert into tgraph_tpl values(sdo_rdf_triple_s(&#39;tgraph&#39;,&#39;&lt;urn:s2&gt;&#39;,&#39;&lt;urn:p2&gt;&#39;, &#39;&#34;hello world&#34;&#39;));
insert into tgraph_tpl values(sdo_rdf_triple_s(&#39;tgraph&#39;,&#39;&lt;urn:s3&gt;&#39;,&#39;&lt;urn:p3&gt;&#39;, &#39;&#34;hello world&#34;@en&#39;));
insert into tgraph_tpl values(sdo_rdf_triple_s(&#39;tgraph&#39;,&#39;&lt;urn:s4&gt;&#39;,&#39;&lt;urn:p4&gt;&#39;, &#39;&#34; o1o &#34;^^&lt;http://www.w3.org/2001/XMLSchema#string&gt;&#39;));
insert into tgraph_tpl values(sdo_rdf_triple_s(&#39;tgraph&#39;,&#39;&lt;urn:s4&gt;&#39;,&#39;&lt;urn:p4&gt;&#39;, &#39;&#34;xyz&#34;^^&lt;http://mytype&gt;&#39;));
insert into tgraph_tpl values(sdo_rdf_triple_s(&#39;tgraph&#39;,&#39;&lt;urn:s5&gt;&#39;,&#39;&lt;urn:p5&gt;&#39;, &#39;&#34;123&#34;^^&lt;http://www.w3.org/2001/XMLSchema#integer&gt;&#39;));
insert into tgraph_tpl values(sdo_rdf_triple_s(&#39;tgraph&#39;,&#39;&lt;urn:s5&gt;&#39;,&#39;&lt;urn:p5&gt;&#39;, &#39;&#34;123.456&#34;^^&lt;http://www.w3.org/2001/XMLSchema#double&gt;&#39;));
insert into tgraph_tpl values(sdo_rdf_triple_s(&#39;tgraph&#39;,&#39;&lt;urn:s6&gt;&#39;,&#39;&lt;urn:p6&gt;&#39;, &#39;_:bn1&#39;));
 
-- Add some quads
insert into tgraph_tpl values(sdo_rdf_triple_s(&#39;tgraph:&lt;urn:g1&gt;&#39;,&#39;&lt;urn:s1&gt;&#39;,&#39;&lt;urn:p1&gt;&#39;, &#39;&lt;urn:o1&gt;&#39;));
insert into tgraph_tpl values(sdo_rdf_triple_s(&#39;tgraph:&lt;urn:g2&gt;&#39;,&#39;&lt;urn:s1&gt;&#39;,&#39;&lt;urn:p1&gt;&#39;, &#39;&lt;urn:o1&gt;&#39;));
insert into tgraph_tpl values(sdo_rdf_triple_s(&#39;tgraph:&lt;urn:g2&gt;&#39;,&#39;&lt;urn:s2&gt;&#39;,&#39;&lt;urn:p2&gt;&#39;, &#39;&#34;hello world&#34;&#39;));
insert into tgraph_tpl values(sdo_rdf_triple_s(&#39;tgraph:&lt;urn:g2&gt;&#39;,&#39;&lt;urn:s3&gt;&#39;,&#39;&lt;urn:p3&gt;&#39;, &#39;&#34;hello world&#34;@en&#39;));
insert into tgraph_tpl values(sdo_rdf_triple_s(&#39;tgraph:&lt;urn:g2&gt;&#39;,&#39;&lt;urn:s4&gt;&#39;,&#39;&lt;urn:p4&gt;&#39;, &#39;&#34; o1o &#34;^^&lt;http://www.w3.org/2001/XMLSchema#string&gt;&#39;));
insert into tgraph_tpl values(sdo_rdf_triple_s(&#39;tgraph:&lt;urn:g2&gt;&#39;,&#39;&lt;urn:s4&gt;&#39;,&#39;&lt;urn:p4&gt;&#39;, &#39;&#34;xyz&#34;^^&lt;http://mytype&gt;&#39;));
insert into tgraph_tpl values(sdo_rdf_triple_s(&#39;tgraph:&lt;urn:g2&gt;&#39;,&#39;&lt;urn:s5&gt;&#39;,&#39;&lt;urn:p5&gt;&#39;, &#39;&#34;123&#34;^^&lt;http://www.w3.org/2001/XMLSchema#integer&gt;&#39;));
insert into tgraph_tpl values(sdo_rdf_triple_s(&#39;tgraph:&lt;urn:g2&gt;&#39;,&#39;&lt;urn:s5&gt;&#39;,&#39;&lt;urn:p5&gt;&#39;, &#39;&#34;123.456&#34;^^&lt;http://www.w3.org/2001/XMLSchema#double&gt;&#39;));
insert into tgraph_tpl values(sdo_rdf_triple_s(&#39;tgraph:&lt;urn:g2&gt;&#39;,&#39;&lt;urn:s6&gt;&#39;,&#39;&lt;urn:p6&gt;&#39;, &#39;_:bn1&#39;));
insert into tgraph_tpl values(sdo_rdf_triple_s(&#39;tgraph:&lt;urn:g2&gt;&#39;,&#39;&lt;urn:s7&gt;&#39;,&#39;&lt;urn:p7&gt;&#39;, &#39;&#34;2002-10-10T12:00:00-05:00&#34;^^&lt;http://www.w3.org/2001/XMLSchema#dateTime&gt;&#39;));
</pre>
<div class="example" id="GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBGIBAE">
<p class="titleinexample">Example 7-1 SQL-Based Graph Query</p>
<p><a href="rdf-jena.htm#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBGIBAE">Example 7-1</a> runs a pure SQL-based graph query and constructs Jena objects.</p>
<pre dir="ltr">iTimeout = 0; // no time out
iDOP = 1;     // degree of parallelism
iStartColPos = 2;
queryString = &#34;select &#39;hello&#39;||rownum as extra, o.VALUE_TYPE,o.LITERAL_TYPE,o.LANGUAGE_TYPE,o.LONG_VALUE,o.VALUE_NAME &#34;
            + &#34;  from mdsys.rdfm_tgraph g, mdsys.rdf_value$ o where g.canon_end_node_id = o.value_id&#34;;
 
rs = oracle.executeQuery(queryString, iTimeout, iDOP, bindValues);  
 
while (rs.next()) {
  node = OracleSemIterator.retrieveNodeFromRS(rs, iStartColPos, OracleSemQueryPlan.CONST_FIVE_COL, translator);
  System.out.println(&#34;Result &#34; + node.getClass().getName() + &#34; = &#34; + node + &#34; &#34; + rs.getString(1));
}
</pre>
<p><a href="rdf-jena.htm#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBGIBAE">Example 7-1</a> might generate the following output:</p>
<pre dir="ltr">Result com.hp.hpl.jena.graph.Node_URI = urn:o1 hello1
Result com.hp.hpl.jena.graph.Node_URI = urn:o1 hello2
Result com.hp.hpl.jena.graph.Node_Literal = &#34;hello world&#34; hello3
Result com.hp.hpl.jena.graph.Node_Literal = &#34;hello world&#34;@en hello4
Result com.hp.hpl.jena.graph.Node_Literal = &#34; o1o &#34; hello5
Result com.hp.hpl.jena.graph.Node_Literal = &#34;xyz&#34; hello6
Result com.hp.hpl.jena.graph.Node_Literal = &#34;123&#34;^^http://www.w3.org/2001/XMLSchema#decimal hello7
Result com.hp.hpl.jena.graph.Node_Literal = &#34;1.23456E2&#34;^^http://www.w3.org/2001/XMLSchema#double hello8
Result com.hp.hpl.jena.graph.Node_Blank = m8g3C75726E3A67323Egmbn1 hello9
Result com.hp.hpl.jena.graph.Node_Literal = &#34;2002-10-10T17:00:00Z&#34;^^http://www.w3.org/2001/XMLSchema#dateTime hello10
Result com.hp.hpl.jena.graph.Node_Literal = &#34;1.23456E2&#34;^^http://www.w3.org/2001/XMLSchema#double hello11
Result com.hp.hpl.jena.graph.Node_URI = urn:o1 hello12
Result com.hp.hpl.jena.graph.Node_Literal = &#34;hello world&#34; hello13
Result com.hp.hpl.jena.graph.Node_Literal = &#34;hello world&#34;@en hello14
Result com.hp.hpl.jena.graph.Node_Literal = &#34; o1o &#34; hello15
Result com.hp.hpl.jena.graph.Node_Literal = &#34;xyz&#34; hello16
Result com.hp.hpl.jena.graph.Node_Literal = &#34;123&#34;^^http://www.w3.org/2001/XMLSchema#decimal hello17
Result com.hp.hpl.jena.graph.Node_Blank = m8mbn1 hello18
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBCBDFC">
<p class="titleinexample">Example 7-2 Hybrid Query Mixing SEM_MATCH with Regular SQL Constructs</p>
<p><a href="rdf-jena.htm#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBCBDFC">Example 7-2</a> uses the <code class="codeph">OracleSemIterator.retrieveNodeFromRS</code> API to construct a Jena object by reading the five consecutive columns (in the exact order of value type, literal type, language type, long value, and value name), and by performing the necessary unescaping and object instantiations. This example bypasses SEM_MATCH and directly joins the graph view with MDSYS.RDF_VALUE$.</p>
<pre dir="ltr">iStartColPos = 1;
queryString = &#34;select  g$RDFVTYP, g, count(1) as cnt &#34; 
            + &#34;  from table(sem_match(&#39;{ GRAPH ?g { ?s ?p ?o . } }&#39;,sem_models(&#39;tgraph&#39;),null,null,null,null,null)) &#34;
            + &#34; group by g$RDFVTYP, g&#34;;
 
rs = oracle.executeQuery(queryString, iTimeout, iDOP, bindValues);  
while (rs.next()) {
  node = OracleSemIterator.retrieveNodeFromRS(rs, iStartColPos, OracleSemQueryPlan.CONST_TWO_COL, translator);
  System.out.println(&#34;Result &#34; + node.getClass().getName() + &#34; = &#34; + node + &#34; &#34; + rs.getInt(iStartColPos + 2));
}
</pre>
<p><a href="rdf-jena.htm#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBCBDFC">Example 7-2</a> might generate the following output:</p>
<pre dir="ltr">Result com.hp.hpl.jena.graph.Node_URI = urn:g2 9
Result com.hp.hpl.jena.graph.Node_URI = urn:g1 1
</pre>
<p>In <a href="rdf-jena.htm#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBCBDFC">Example 7-2</a>:</p>
<ul style="list-style-type: disc;">
<li>
<p>The helper function <code class="codeph">executeQuery</code> in the <code class="codeph">Oracle</code> class is used to run the SQL statement, and the <code class="codeph">OracleSemIterator.retrieveNodeFromRS</code> API (also used in <a href="rdf-jena.htm#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBGIBAE">Example 7-1</a>) is used to construct Jena objects.</p>
</li>
<li>
<p>Only two columns are used in the output: value type (g$RDFVTYP) and value name (g), it is known that this g variable can never be a literal RDF resource.</p>
</li>
<li>
<p>The column order is significant. For a two-column variable, the first column must be the value type and the second column must be the value name.</p>
</li>
</ul>
</div>
<!-- class="example" -->
<div class="example" id="GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBHEEBA">
<p class="titleinexample">Example 7-3 SEM_MATCH Query</p>
<p><a href="rdf-jena.htm#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBHEEBA">Example 7-3</a> runs a SEM_MATCH query and constructs an iterator (instance of <code class="codeph">OracleSemIterator</code>) that returns a list of Jena objects.</p>
<pre dir="ltr">queryString = &#34;select  g$RDFVTYP, g, s$RDFVTYP, s, p$RDFVTYP, p, o$RDFVTYP,o$RDFLTYP,o$RDFLANG,o$RDFCLOB,o &#34;
            + &#34;  from table(sem_match(&#39;{ GRAPH ?g { ?s ?p ?o . } }&#39;,sem_models(&#39;tgraph&#39;),null,null,null,null,null))&#34;;
 
guide = new ArrayList&lt;String&gt;();
guide.add(OracleSemQueryPlan.CONST_TWO_COL);
guide.add(OracleSemQueryPlan.CONST_TWO_COL);
guide.add(OracleSemQueryPlan.CONST_TWO_COL);
guide.add(OracleSemQueryPlan.CONST_FIVE_COL);
 
rs = oracle.executeQuery(queryString, iTimeout, iDOP, bindValues); 
osi = new OracleSemIterator(rs); 
osi.setGuide(guide); 
osi.setTranslator(translator);
 
while (osi.hasNext()) {
  result = osi.next();
  System.out.println(&#34;Result &#34; + result.getClass().getName() + &#34; = &#34; + result);
}
</pre>
<p><a href="rdf-jena.htm#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBHEEBA">Example 7-3</a> might generate the following output:</p>
<pre dir="ltr">Result com.hp.hpl.jena.graph.query.Domain = [urn:g1, urn:s1, urn:p1, urn:o1]
Result com.hp.hpl.jena.graph.query.Domain = [urn:g2, urn:s1, urn:p1, urn:o1]
Result com.hp.hpl.jena.graph.query.Domain = [urn:g2, urn:s2, urn:p2, &#34;hello world&#34;]
Result com.hp.hpl.jena.graph.query.Domain = [urn:g2, urn:s3, urn:p3, &#34;hello world&#34;@en]
Result com.hp.hpl.jena.graph.query.Domain = [urn:g2, urn:s4, urn:p4, &#34; o1o &#34;]
Result com.hp.hpl.jena.graph.query.Domain = [urn:g2, urn:s4, urn:p4, &#34;xyz&#34;]
Result com.hp.hpl.jena.graph.query.Domain = [urn:g2, urn:s5, urn:p5, &#34;123&#34;^^http://www.w3.org/2001/XMLSchema#decimal]
Result com.hp.hpl.jena.graph.query.Domain = [urn:g2, urn:s5, urn:p5, &#34;1.23456E2&#34;^^http://www.w3.org/2001/XMLSchema#double]
Result com.hp.hpl.jena.graph.query.Domain = [urn:g2, urn:s6, urn:p6, m8g3C75726E3A67323Egmbn1]
Result com.hp.hpl.jena.graph.query.Domain = [urn:g2, urn:s7, urn:p7, &#34;2002-10-10T17:00:00Z&#34;^^http://www.w3.org/2001/XMLSchema#dateTime]
</pre>
<p>In <a href="rdf-jena.htm#GUID-996A56E5-868C-4A78-8BF7-3B51921F1DCD__BGBHEEBA">Example 7-3</a>:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">OracleSemIterator</code> takes in a JDBC result set. <code class="codeph">OracleSemIterator</code> needs guidance on parsing all the columns that represent the bind values of SPARQL variables. A guide is simply a list of string values. Two constants have been defined to differentiate a 2-column variable (for subject or predicate position) from a 5-column variable (for object position). A translator is also required.</p>
</li>
<li>
<p>Four variables are used in the output. The first three variables are not RDF literal resources, so CONST_TWO_COL is used as their guide. The last variable can be an RDF literal resource, so CONST_FIVE_COL is used as its guide.</p>
</li>
<li>
<p>The column order is significant, and it must be as shown in the example.</p>
</li>
</ul>
</div>
<!-- class="example" --></div>
</div>
<a id="RDFRM244"></a>
<div class="props_rev_3"><a id="GUID-F6416355-45C1-4FAF-83E4-7EBFA902EA7A"></a>
<h2 id="RDFRM-GUID-F6416355-45C1-4FAF-83E4-7EBFA902EA7A" class="sect2"><span class="enumeration_section">7.6</span> Optimized Handling of SPARQL Queries</h2>
<div>
<p>This section describes some performance-related features of the support for Apache Jena that can enhance SPARQL query processing. These features are performed automatically by default.</p>
<p>This section assumes that you are familiar with SPARQL, including the CONSTRUCT feature and property paths.</p>
</div>
<a id="RDFRM245"></a>
<div class="props_rev_3"><a id="GUID-981B14F0-2943-47A7-89F5-95828176E69C"></a>
<h3 id="RDFRM-GUID-981B14F0-2943-47A7-89F5-95828176E69C" class="sect3"><span class="enumeration_section">7.6.1</span> Compilation of SPARQL Queries to a Single SEM_MATCH Call</h3>
<div>
<p>SPARQL queries involving DISTINCT, OPTIONAL, FILTER, UNION, ORDER BY, and LIMIT are converted to a single Oracle SEM_MATCH table function. If a query cannot be converted directly to SEM_MATCH because it uses SPARQL features not supported by SEM_MATCH (for example, CONSTRUCT), the support for Apache Jena employs a hybrid approach and tries to execute the largest portion of the query using a single SEM_MATCH function while executing the rest using the Jena ARQ query engine.</p>
<p>For example, the following SPARQL query is directly translated to a single SEM_MATCH table function:</p>
<pre dir="ltr">PREFIX dc:  &lt;http://purl.org/dc/elements/1.1/&gt; 
PREFIX rdf:  &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt; 
PREFIX foaf: &lt;http://xmlns.com/foaf/0.1/&gt; 
SELECT ?person ?name 
  WHERE {
                 {?alice foaf:knows ?person . }
               UNION { 
                 ?person ?p ?name. OPTIONAL { ?person ?x ?name1 } 
                     }
        }
</pre>
<p>However, the following example query is not directly translatable to a single SEM_MATCH table function because of the CONSTRUCT keyword:</p>
<pre dir="ltr">PREFIX vcard: &lt;http://www.w3.org/2001/vcard-rdf/3.0#&gt; 
CONSTRUCT  { &lt;http://example.org/person#Alice&gt; vcard:FN ?obj } 
  WHERE  { { ?x &lt;http://pred/a&gt; ?obj.}
         UNION
         { ?x &lt;http://pred/b&gt; ?obj.}  }
</pre>
<p>In this case, the support for Apache Jena converts the inner UNION query into a single SEM_MATCH table function, and then passes on the result set to the Jena ARQ query engine for further evaluation.</p>
</div>
</div>
<a id="RDFRM246"></a>
<div class="props_rev_3"><a id="GUID-A9B1E88D-11C7-4C7F-B787-5D8EEC0D4D8A"></a>
<h3 id="RDFRM-GUID-A9B1E88D-11C7-4C7F-B787-5D8EEC0D4D8A" class="sect3"><span class="enumeration_section">7.6.2</span> Optimized Handling of Property Paths</h3>
<div>
<p>As defined in Jena, a property path is a possible route through an RDF graph between two graph nodes. Property paths are an extension of SPARQL and are more expressive than basic graph pattern queries, because regular expressions can be used over properties for pattern matching RDF graphs. For more information about property paths, see the documentation for the Jena ARQ query engine.</p>
<p>RDF Semantic Graph support for Apache Jena supports all Jena property path types through the integration with the Jena ARQ query engine, but it converts some common path types directly to native SQL hierarchical queries (not based on SEM_MATCH) to improve performance. The following types of property paths are directly converted to SQL by the support for Apache Jena when dealing with triple data:</p>
<ul style="list-style-type: disc;">
<li>
<p>Predicate alternatives: (p1 | p2 | &hellip; | p<span class="italic">n</span>) where p<span class="italic">i</span> is a property URI</p>
</li>
<li>
<p>Predicate sequences: (p1 / p2 / &hellip; / p<span class="italic">n</span>) where p<span class="italic">i</span> is a property URI</p>
</li>
<li>
<p>Reverse paths : ( ^ p ) where p is a predicate URI</p>
</li>
<li>
<p>Complex paths: p+, p*, p{0, <span class="italic">n</span>} where p could be an alternative, sequence, reverse path, or property URI</p>
</li>
</ul>
<p>Path expressions that cannot be captured in this grammar are not translated directly to SQL by the support for Apache Jena, and they are answered using the Jena query engine.</p>
<p>The following example contains a code snippet using a property path expression with path sequences:</p>
<pre dir="ltr">String m = &#34;PROP_PATH&#34;;
 
ModelOracleSem model = ModelOracleSem.createOracleSemModel(oracle, m);
 
GraphOracleSem graph = new GraphOracleSem(oracle, m);    
    
// populate the RDF Graph
    graph.add(Triple.create(Node.createURI(&#34;http://a&#34;),
    Node.createURI(&#34;http://p1&#34;),
    Node.createURI(&#34;http://b&#34;)));
 
graph.add(Triple.create(Node.createURI(&#34;http://b&#34;),
 Node.createURI(&#34;http://p2&#34;),
 Node.createURI(&#34;http://c&#34;)));
 
graph.add(Triple.create(Node.createURI(&#34;http://c&#34;),
 Node.createURI(&#34;http://p5&#34;),
 Node.createURI(&#34;http://d&#34;)));
 
String query =
&#34; SELECT ?s  &#34; +
&#34; WHERE {?s (&lt;http://p1&gt;/&lt;http://p2&gt;/&lt;http://p5&gt;)+ &lt;http://d&gt;.}&#34;;
   
QueryExecution qexec = 
      QueryExecutionFactory.create(QueryFactory.create(query, 
 Syntax.syntaxARQ), model);
 
try {
  ResultSet results = qexec.execSelect();
  ResultSetFormatter.out(System.out, results);
}
finally {
  if (qexec != null)
    qexec.close();
}
     
OracleUtils.dropSemanticModel(oracle, m);
model.close();
</pre></div>
</div>
</div>
<a id="RDFRM248"></a>
<div class="props_rev_3"><a id="GUID-9B0B74F2-9733-491E-A97C-BB485D33518C"></a>
<h2 id="RDFRM-GUID-9B0B74F2-9733-491E-A97C-BB485D33518C" class="sect2"><span class="enumeration_section">7.7</span> Additions to the SPARQL Syntax to Support Other Features</h2>
<div>
<p>RDF Semantic Graph support for Apache Jena allows you to pass in hints and additional query options. It implements these capabilities by overloading the SPARQL namespace prefix syntax by using Oracle-specific namespaces that contain query options. The namespaces are in the form <span class="italic"><code class="codeph">PREFIX ORACLE_SEM_</code></span>xx<code class="codeph">_NS</code>, where <span class="italic">xx</span> indicates the type of feature (such as <code class="codeph">HT</code> for hint or <code class="codeph">AP</code> for additional predicate)</p>
</div>
<a id="RDFRM249"></a>
<div class="props_rev_3"><a id="GUID-4532E905-83AD-4903-8A27-458C0D261D25"></a>
<h3 id="RDFRM-GUID-4532E905-83AD-4903-8A27-458C0D261D25" class="sect3"><span class="enumeration_section">7.7.1</span> SQL Hints</h3>
<div>
<p>SQL hints can be passed to a SEM_MATCH query including a line in the following form:</p>
<pre dir="ltr">PREFIX ORACLE_SEM_<span class="bold">HT</span>_NS: &lt;http://oracle.com/semtech#<span class="italic">hint</span>&gt;
</pre>
<p>Where <span class="italic">hint</span> can be any hint supported by SEM_MATCH. For example:</p>
<pre dir="ltr">PREFIX ORACLE_SEM_HT_NS: &lt;http://oracle.com/semtech#leading(t0,t1)&gt; 
SELECT ?book ?title ?isbn     
WHERE { ?book &lt;http://title&gt; ?title. ?book &lt;http://ISBN&gt; ?isbn }
</pre>
<p>In this example, <code class="codeph">t0,t1</code> refers to the first and second patterns in the query.</p>
<p>Note the slight difference in specifying hints when compared to SEM_MATCH. Due to restrictions of namespace value syntax, a comma (<code class="codeph">,</code>) must be used to separate <code class="codeph">t0</code> and <code class="codeph">t1</code> (or other hint components) instead of a space.</p>
<p>For more information about using SQL hints, see <a href="rdf-overview.htm#GUID-71464CC4-1C03-48A4-9A4C-0E671FF8F16E">Using the SEM_MATCH Table Function to Query Semantic Data</a>, specifically the material about the <code class="codeph">HINT0</code> keyword in the <code class="codeph">options</code> attribute.</p>
</div>
</div>
<a id="RDFRM250"></a>
<div class="props_rev_3"><a id="GUID-69EA9BB5-1703-4B38-8E7E-02A128D62F1D"></a>
<h3 id="RDFRM-GUID-69EA9BB5-1703-4B38-8E7E-02A128D62F1D" class="sect3"><span class="enumeration_section">7.7.2</span> Using Bind Variables in SPARQL Queries</h3>
<div>
<p>In Oracle Database, using bind variables can reduce query parsing time and increase query efficiency and concurrency. Bind variable support in SPARQL queries is provided through namespace pragma specifications similar to ORACLE_SEM_FS_NS.</p>
<p>Consider a case where an application runs two SPARQL queries, where the second (Query 2) depends on the partial or complete results of the first (Query 1). Some approaches that do not involve bind variables include:</p>
<ul style="list-style-type: disc;">
<li>
<p>Iterating through results of Query 1 and generating a set of queries. (However, this approach requires as many queries as the number of results of Query 1.)</p>
</li>
<li>
<p>Constructing a SPARQL filter expression based on results of Query 1.</p>
</li>
<li>
<p>Treating Query 1 as a subquery.</p>
</li>
</ul>
<p>Another approach in this case is to use bind variables, as in the following sample scenario:</p>
<pre dir="ltr"><span class="bold">Query 1</span>:
 
  SELECT ?x
    WHERE { ... <span class="italic">&lt;some complex query&gt;</span> ... };
 
 
<span class="bold">Query 2</span>:
 
  SELECT ?subject ?x
    WHERE {?subject &lt;urn:related&gt; ?x .};
</pre>
<p>The following example shows Query 2 with the syntax for using bind variables with the support for Apache Jena:</p>
<pre dir="ltr">PREFIX ORACLE_SEM_FS_NS: &lt;http://oracle.com/semtech#no_fall_back,s2s&gt;
PREFIX <span class="bold">ORACLE_SEM_UEAP_NS</span>: &lt;http://oracle.com/semtech#x$RDFVID%20in(<span class="bold">?,?,?</span>)&gt;
PREFIX <span class="bold">ORACLE_SEM_UEPJ_NS</span>: &lt;http://oracle.com/semtech#<span class="bold">x$RDFVID</span>&gt;
PREFIX <span class="bold">ORACLE_SEM_UEBV_NS</span>: &lt;http://oracle.com/semtech#<span class="bold">1,2,3</span>&gt;
SELECT ?subject ?x
WHERE {
  ?subject &lt;urn:related&gt;  ?x
};
</pre>
<p>This syntax includes using the following namespaces:</p>
<ul style="list-style-type: disc;">
<li>
<p>ORACLE_SEM_UEAP_NS is like ORACLE_SEM_AP_NS, but the value portion of ORACLE_SEM_UEAP_NS is URL Encoded. Before the value portion is used, it must be URL decoded, and then it will be treated as an additional predicate to the SPARQL query.</p>
<p>In this example, after URL decoding, the value portion (following the <code class="codeph">#</code> character) of this ORACLE_SEM_UEAP_NS prefix becomes &#34;<code class="codeph">x$RDFVID in(?,?,?)</code>&#34;. The three question marks imply a binding to three values coming from Query 1.</p>
</li>
<li>
<p>ORACLE_SEM_UEPJ_NS specifies the additional projections involved. In this case, because ORACLE_SEM_UEAP_NS references the x$RDFVID column, which does not appear in the SELECT clause of the query, it must be specified. Multiple projections are separated by commas.</p>
</li>
<li>
<p>ORACLE_SEM_UEBV_NS specifies the list of bind values that are URL encoded first, and then concatenated and delimited by commas.</p>
</li>
</ul>
<p>Conceptually, the preceding example query is equivalent to the following non-SPARQL syntax query, in which 1, 2, and 3 are treated as bind values:</p>
<pre dir="ltr">SELECT ?subject ?x
  WHERE {
    ?subject &lt;urn:related&gt;  ?x
  }
  AND ?x$RDFVID in (1,2,3);
</pre>
<p>In the preceding SPARQL example of Query 2, the three integers 1, 2, and 3 come from Query 1. You can use the <code class="codeph">oext:build-uri-for-id</code> function to generate such internal integer IDs for RDF resources. The following example gets the internal integer IDs from Query 1:</p>
<pre dir="ltr">PREFIX oext: &lt;http://oracle.com/semtech/jena-adaptor/ext/function#&gt;
SELECT ?x  (<span class="bold">oext:build-uri-for-id(?x)</span> as <span class="bold">?xid</span>)
WHERE { ... <span class="italic">&lt;some complex query&gt;</span> ... };
</pre>
<p>The values of <code class="codeph">?xid</code> have the form of &lt;rdfvid:<span class="italic">integer-value</span>&gt;. The application can strip out the angle brackets and the &#34;rdfvid:&#34; strings to get the integer values and pass them to Query 2.</p>
<p>Consider another case, with a single query structure but potentially many different constants. For example, the following SPARQL query finds the hobby for each user who has a hobby and who logs in to an application. Obviously, different users will provide different &lt;uri&gt; values to this SPARQL query, because users of the application are represented using different URIs.</p>
<pre dir="ltr">SELECT ?hobby
  WHERE { &lt;uri&gt; &lt;urn:hasHobby&gt; ?hobby };
</pre>
<p>One approach, which would not use bind variables, is to generate a different SPARQL query for each different &lt;uri&gt; value. For example, user Jane Doe might trigger the execution of the following SPARQL query:</p>
<pre dir="ltr">SELECT ?hobby WHERE {
&lt;http://www.example.com/Jane_Doe&gt; &lt;urn:hasHobby&gt; ?hobby };
</pre>
<p>However, another approach is to use bind variables, as in the following example specifying user Jane Doe:</p>
<pre dir="ltr">PREFIX ORACLE_SEM_FS_NS: &lt;http://oracle.com/semtech#no_fall_back,s2s&gt;
PREFIX ORACLE_SEM_UEAP_NS: &lt;http://oracle.com/semtech#subject$RDFVID%20in(ORACLE_ORARDF_RES2VID(?))&gt;
PREFIX ORACLE_SEM_UEPJ_NS: &lt;http://oracle.com/semtech#subject$RDFVID&gt;
PREFIX ORACLE_SEM_UEBV_NS: &lt;http://oracle.com/semtech#http%3a%2f%2fwww.example.com%2fJohn_Doe&gt;
SELECT ?subject ?hobby
  WHERE {
    ?subject &lt;urn:hasHobby&gt;  ?hobby
  };
</pre>
<p>Conceptually, the preceding example query is equivalent to the following non-SPARQL syntax query, in which <code class="codeph">http://www.example.com/Jane_Doe</code> is treated as a bind variable:</p>
<pre dir="ltr">SELECT ?subject ?hobby
WHERE {
  ?subject &lt;urn:hasHobby&gt;  ?hobby
}
AND ?subject$RDFVID in (ORACLE_ORARDF_RES2VID(&#39;http://www.example.com/Jane_Doe&#39;));
</pre>
<p>In this example, ORACLE_ORARDF_RES2VID is a function that translates URIs and literals into their internal integer ID representation. This function is created automatically when the support for Apache Jena is used to connect to an Oracle database.</p>
</div>
</div>
<a id="RDFRM251"></a>
<div class="props_rev_3"><a id="GUID-7F91AD9F-31F5-4B99-8300-B9F0844EC270"></a>
<h3 id="RDFRM-GUID-7F91AD9F-31F5-4B99-8300-B9F0844EC270" class="sect3"><span class="enumeration_section">7.7.3</span> Additional WHERE Clause Predicates</h3>
<div>
<p>The SEM_MATCH <code class="codeph">filter</code> attribute can specify additional selection criteria as a string in the form of a WHERE clause without the WHERE keyword. Additional WHERE clause predicates can be passed to a SEM_MATCH query including a line in the following form:</p>
<pre dir="ltr">PREFIX ORACLE_SEM_<span class="bold">AP</span>_NS: &lt;http://oracle.com/semtech#<span class="italic">pred</span>&gt;
</pre>
<p>Where <span class="italic">pred</span> reflects the WHERE clause content to be appended to the query. For example:</p>
<pre dir="ltr">PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;
PREFIX ORACLE_SEM_AP_NS:&lt;http://www.oracle.com/semtech#label$RDFLANG=&#39;fr&#39;&gt;  
SELECT DISTINCT ?inst ?label
  WHERE { ?inst a &lt;http://someCLass&gt;. ?inst rdfs:label ?label . }
  ORDER BY (?label) LIMIT 20
</pre>
<p>In this example, a restriction is added to the query that the language type of the label variable must be <code class="codeph">&#39;fr&#39;</code>.</p>
</div>
</div>
<a id="RDFRM252"></a>
<div class="props_rev_3"><a id="GUID-88A33746-DFB2-4968-9A66-90C124BCDDC6"></a>
<h3 id="RDFRM-GUID-88A33746-DFB2-4968-9A66-90C124BCDDC6" class="sect3"><span class="enumeration_section">7.7.4</span> Additional Query Options</h3>
<div>
<p>Additional query options can be passed to a SEM_MATCH query including a line in the following form:</p>
<pre dir="ltr">PREFIX ORACLE_SEM_<span class="bold">FS</span>_NS: &lt;http://oracle.com/semtech#<span class="italic">option</span>&gt;
</pre>
<p>Where <span class="italic">option</span> reflects a query option (or multiple query options delimited by commas) to be appended to the query. For example:</p>
<pre dir="ltr">PREFIX ORACLE_SEM_FS_NS:   
&lt;http://oracle.com/semtech#timeout=3,dop=4,INF_ONLY,ORDERED,ALLOW_DUP=T&gt;
SELECT * WHERE {?subject ?property ?object }
</pre>
<p>The following query options are supported:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">ALLOW_DUP=t</code> chooses a faster way to query multiple semantic models, although duplicate results may occur.</p>
</li>
<li>
<p><code class="codeph">BEST_EFFORT_QUERY=t</code>, when used with the <code class="codeph">TIMEOUT=</code><span class="italic"><code class="codeph">n</code></span> option, returns all matches found in <span class="italic">n</span> seconds for the SPARQL query.</p>
</li>
<li>
<p><code class="codeph">DEGREE=</code><span class="italic">n</span> specifies, at the statement level, the degree of parallelism (<span class="italic">n</span>) for the query. With multi-core or multi-CPU processors, experimenting with different <code class="codeph">DOP</code> values (such as 4 or 8) may improve performance.</p>
<p>Contrast <code class="codeph">DEGREE</code> with <code class="codeph">DOP</code>, which specifies parallelism at the session level. <code class="codeph">DEGREE</code> is recommended over <code class="codeph">DOP</code> for use with the support for Apache Jena, because <code class="codeph">DEGREE</code> involves less processing overhead.</p>
</li>
<li>
<p><code class="codeph">DOP=</code><span class="italic">n</span> specifies, at the session level, the degree of parallelism (<span class="italic">n</span>) for the query. With multi-core or multi-CPU processors, experimenting with different <code class="codeph">DOP</code> values (such as 4 or 8) may improve performance.</p>
</li>
<li>
<p><code class="codeph">INF_ONLY</code> causes only the inferred model to be queried.</p>
</li>
<li>
<p><code class="codeph">JENA_EXECUTOR</code> disables the compilation of SPARQL queries to SEM_MATCH (or native SQL); instead, the Jena native query executor will be used.</p>
</li>
<li>
<p><code class="codeph">JOIN=</code><span class="italic"><code class="codeph">n</code></span> specifies how results from a SPARQL SERVICE call to a federated query can be joined with other parts of the query. For information about federated queries and the <code class="codeph">JOIN</code> option, see <a href="rdf-jena.htm#GUID-4082C47A-EBE9-4659-B24B-C97624CD96A1">JOIN Option and Federated Queries</a>.</p>
</li>
<li>
<p><code class="codeph">NO_FALL_BACK</code> causes the underlying query execution engine not to fall back on the Jena execution mechanism if a SQL exception occurs.</p>
</li>
<li>
<p><code class="codeph">ODS=</code><span class="italic"><code class="codeph">n</code></span> specifies, at the statement level, the level of dynamic sampling. (For an explanation of dynamic sampling, see the section about estimating statistics with dynamic sampling in <a class="olink TGSQL450" target="_blank" href="../TGSQL/tgsql_astat.htm#TGSQL450"><span class="italic">Oracle Database SQL Tuning Guide</span></a>.) Valid values for <span class="italic">n</span> are 1 through 10. For example, you could try <code class="codeph">ODS=3</code> for complex queries.</p>
</li>
<li>
<p><code class="codeph">ORDERED</code> is translated to a LEADING SQL hint for the query triple pattern joins, while performing the necessary RDF_VALUE$ joins last.</p>
</li>
<li>
<p><code class="codeph">PLAIN_SQL_OPT=F</code> disables the native compilation of queries directly to SQL.</p>
</li>
<li>
<p><code class="codeph">QID=</code><span class="italic">n</span> specifies a query ID number; this feature can be used to cancel the query if it is not responding.</p>
</li>
<li>
<p><code class="codeph">RESULT_CACHE</code> uses the Oracle RESULT_CACHE directive for the query.</p>
</li>
<li>
<p><code class="codeph">REWRITE=F</code> disables ODCI_Table_Rewrite for the SEM_MATCH table function.</p>
</li>
<li>
<p><code class="codeph">S2S</code> (SPARQL to pure SQL) causes the underlying SEM_MATCH-based query or queries generated based on the SPARQL query to be further converted into SQL queries <span class="italic"><span class="bold">without</span></span> using the SEM_MATCH table function. The resulting SQL queries are executed by the Oracle cost-based optimizer, and the results are processed by the support for Apache Jena before being passed on to the client. For more information about the <code class="codeph">S2S</code> option, including benefits and usage information, see <a href="rdf-jena.htm#GUID-892FF8C6-4DCE-4568-A3AD-3B674D98EC2F">S2S Option Benefits and Usage Information</a>.</p>
<p><code class="codeph">S2S</code> is enabled by default for all SPARQL queries. If you want to disable <code class="codeph">S2S</code>, set the following JVM system property:</p>
<pre dir="ltr">-Doracle.spatial.rdf.client.jena.defaultS2S=false
</pre></li>
<li>
<p><code class="codeph">SKIP_CLOB=T</code> causes CLOB values not to be returned for the query.</p>
</li>
<li>
<p><code class="codeph">STRICT_DEFAULT=F</code> allows the default graph to include triples in named graphs. (By default, <code class="codeph">STRICT_DEFAULT=T</code> restricts the default graph to unnamed triples when no data set information is specified.)</p>
</li>
<li>
<p><code class="codeph">TIMEOUT=</code><span class="italic"><code class="codeph">n</code></span> (query timeout) specifies the number of seconds (<span class="italic">n</span>) that the query will run until it is terminated. The underlying SQL generated from a SPARQL query can return many matches and can use features like subqueries and assignments, all of which can take considerable time. The <code class="codeph">TIMEOUT</code> and <code class="codeph">BEST_EFFORT_QUERY=t</code> options can be used to prevent what you consider excessive processing time for the query.</p>
</li>
</ul>
</div>
<a id="RDFRM253"></a>
<div class="props_rev_3"><a id="GUID-4082C47A-EBE9-4659-B24B-C97624CD96A1"></a>
<h4 id="RDFRM-GUID-4082C47A-EBE9-4659-B24B-C97624CD96A1" class="sect4"><span class="enumeration_section">7.7.4.1</span> JOIN Option and Federated Queries</h4>
<div>
<p>A SPARQL federated query, as described in W3C documents, is a query &#34;over distributed data&#34; that entails &#34;querying one source and using the acquired information to constrain queries of the next source.&#34; For more information, see <span class="italic">SPARQL 1.1 Federation Extensions</span> (<a href="http://www.w3.org/2009/sparql/docs/fed/service" target="_blank"><code class="codeph">http://www.w3.org/2009/sparql/docs/fed/service</code></a>).</p>
<p>You can use the JOIN option (described in <a href="rdf-jena.htm#GUID-88A33746-DFB2-4968-9A66-90C124BCDDC6">Additional Query Options</a>) and the SERVICE keyword in a federated query that uses the support for Apache Jena. For example, assume the following query:</p>
<pre dir="ltr">SELECT ?s ?s1 ?o
 WHERE { ?s1 ?p1 ?s .
                    {
                     SERVICE &lt;http://sparql.org/books&gt; { ?s ?p ?o }
                    }
                 }
</pre>
<p>If the <span class="italic">local</span> query portion (<code class="codeph">?s1 ?p1 ?s,</code>) is very selective, you can specify <code class="codeph">join=2</code>, as shown in the following query:</p>
<pre dir="ltr">PREFIX ORACLE_SEM_FS_NS:   &lt;http://oracle.com/semtech#<span class="bold">join=2</span>&gt;
SELECT ?s ?s1 ?o
 WHERE { ?s1 ?p1 ?s .
                    {
                     SERVICE &lt;http://sparql.org/books&gt; { ?s ?p ?o }
                    }
                 }
</pre>
<p>In this case, the local query portion (<code class="codeph">?s1 ?p1 ?s,</code>) is executed locally against the Oracle database. Each binding of <code class="codeph">?s</code> from the results is then pushed into the SERVICE part (remote query portion), and a call is made to the service endpoint specified. Conceptually, this approach is somewhat like nested loop join.</p>
<p>If the <span class="italic">remote</span> query portion (<code class="codeph">?s ?s1 ?o</code>) is very selective, you can specify <code class="codeph">join=3</code>, as shown in the following query, so that the remote portion is executed first and results are used to drive the execution of local portion:</p>
<pre dir="ltr">PREFIX ORACLE_SEM_FS_NS:   &lt;http://oracle.com/semtech#<span class="bold">join=3</span>&gt;
SELECT ?s ?s1 ?o
 WHERE { ?s1 ?p1 ?s .
                    {
                     SERVICE &lt;http://sparql.org/books&gt; { ?s ?p ?o }
                    }
                  }
</pre>
<p>In this case, a single call is made to the remote service endpoint and each binding of <code class="codeph">?s</code> triggers a local query. As with <code class="codeph">join=2</code>, this approach is conceptually a nested loop based join, but the difference is that the order is switched.</p>
<p>If neither the local query portion nor the remote query portion is very selective, then we can choose join=1, as shown in the following query:</p>
<pre dir="ltr">PREFIX ORACLE_SEM_FS_NS:   &lt;http://oracle.com/semtech#<span class="bold">join=1</span>&gt;
SELECT ?s ?s1 ?o
 WHERE { ?s1 ?p1 ?s .
                    {
                     SERVICE &lt;http://sparql.org/books&gt; { ?s ?p ?o }
                    }
                }
</pre>
<p>In this case, the remote query portion and the local portion are executed independently, and the results are joined together by Jena. Conceptually, this approach is somewhat like a hash join.</p>
<p>For debugging or tracing federated queries, you can use the HTTP Analyzer in Oracle JDeveloper to see the underlying SERVICE calls.</p>
</div>
</div>
<a id="RDFRM254"></a>
<div class="props_rev_3"><a id="GUID-892FF8C6-4DCE-4568-A3AD-3B674D98EC2F"></a>
<h4 id="RDFRM-GUID-892FF8C6-4DCE-4568-A3AD-3B674D98EC2F" class="sect4"><span class="enumeration_section">7.7.4.2</span> S2S Option Benefits and Usage Information</h4>
<div>
<p>The <code class="codeph">S2S</code> option, described in <a href="rdf-jena.htm#GUID-88A33746-DFB2-4968-9A66-90C124BCDDC6">Additional Query Options</a>, provides the following potential benefits:</p>
<ul style="list-style-type: disc;">
<li>
<p>It works well with the <code class="codeph">RESULT_CACHE</code> option to improve query performance. Using the <code class="codeph">S2S</code> and <code class="codeph">RESULT_CACHE</code> options is especially helpful for queries that are executed frequently.</p>
</li>
<li>
<p>It reduces the parsing time of the SEM_MATCH table function, which can be helpful for applications that involve many dynamically generated SPARQL queries.</p>
</li>
<li>
<p>It eliminates the limit of 4000 bytes for the query body (the first parameter of the SEM_MATCH table function), which means that longer, more complex queries are supported.</p>
</li>
</ul>
<p>The S2S option causes an internal in-memory cache to be used for translated SQL query statements. The default size of this internal cache is 1024 (that is, 1024 SQL queries); however, you can adjust the size by using the following Java VM property:</p>
<pre dir="ltr">-Doracle.spatial.rdf.client.jena.queryCacheSize=<span class="italic">&lt;size&gt;</span>
</pre></div>
</div>
</div>
<a id="RDFRM255"></a>
<div class="props_rev_3"><a id="GUID-AF240C2D-C4B3-4AD7-B593-D481400DF489"></a>
<h3 id="RDFRM-GUID-AF240C2D-C4B3-4AD7-B593-D481400DF489" class="sect3"><span class="enumeration_section">7.7.5</span> Midtier Resource Caching</h3>
<div>
<p>When semantic data is stored, all of the resource values are hashed into IDs, which are stored in the triples table. The mappings from value IDs to full resource values are stored in the MDSYS.RDF_VALUE$ table. At query time, for each selected variable, Oracle Database must perform a join with the RDF_VALUE$ table to retrieve the resource.</p>
<p>However, to reduce the number of joins, you can use the midtier cache option, which causes an in-memory cache on the middle tier to be used for storing mappings between value IDs and resource values. To use this feature, include the following PREFIX pragma in the SPARQL query:</p>
<pre dir="ltr">PREFIX ORACLE_SEM_FS_NS: &lt;http://oracle.com/semtech#midtier_cache&gt;
</pre>
<p>To control the maximum size (in bytes) of the in-memory cache, use the <code class="codeph">oracle.spatial.rdf.client.jena.cacheMaxSize</code> system property. The default cache maximum size is 1GB.</p>
<p>Midtier resource caching is most effective for queries using ORDER BY or DISTINCT (or both) constructs, or queries with multiple projection variables. Midtier cache can be combined with the other options specified in <a href="rdf-jena.htm#GUID-88A33746-DFB2-4968-9A66-90C124BCDDC6">Additional Query Options</a>.</p>
<p>If you want to pre-populate the cache with all of the resources in a model, use the <code class="codeph">GraphOracleSem.populateCache</code> or <code class="codeph">DatasetGraphOracleSem.populateCache</code> method. Both methods take a parameter specifying the number of threads used to build the internal midtier cache. Running either method in parallel can significantly increase the cache building performance on a machine with multiple CPUs (cores).</p>
</div>
</div>
</div>
<a id="RDFRM256"></a>
<div class="props_rev_3"><a id="GUID-D7D68CA5-24BF-4546-8679-8AF4AA96C38C"></a>
<h2 id="RDFRM-GUID-D7D68CA5-24BF-4546-8679-8AF4AA96C38C" class="sect2"><span class="enumeration_section">7.8</span> Functions Supported in SPARQL Queries through RDF Semantic Graph Support for Apache Jena</h2>
<div>
<p>SPARQL queries through the support for Apache Jena can use the following kinds of functions:</p>
<ul style="list-style-type: disc;">
<li>
<p>Functions in the function library of the Jena ARQ query engine</p>
</li>
<li>
<p>Native Oracle Database functions for projected variables</p>
</li>
<li>
<p>User-defined functions</p>
</li>
</ul>
</div>
<a id="RDFRM257"></a>
<div class="props_rev_3"><a id="GUID-353E37B3-DBF6-4BDF-B722-9384FB75DDD3"></a>
<h3 id="RDFRM-GUID-353E37B3-DBF6-4BDF-B722-9384FB75DDD3" class="sect3"><span class="enumeration_section">7.8.1</span> Functions in the ARQ Function Library</h3>
<div>
<p>SPARQL queries through the support for Apache Jena can use functions in the function library of the Jena ARQ query engine. These queries are executed in the middle tier.</p>
<p>The following examples use the <code class="codeph">upper-case</code> and <code class="codeph">namespace</code> functions. In these examples, the prefix <code class="codeph">fn</code> is <code class="codeph">&lt;http://www.w3.org/2005/xpath-functions#&gt;</code> and the prefix <code class="codeph">afn</code> is <code class="codeph">&lt;http://jena.hpl.hp.com/ARQ/function#&gt;</code>.</p>
<pre dir="ltr">PREFIX  fn: &lt;http://www.w3.org/2005/xpath-functions#&gt;
PREFIX  afn: &lt;http://jena.hpl.hp.com/ARQ/function#&gt;
SELECT (fn:upper-case(?object) as ?object1)
WHERE { ?subject dc:title ?object }

PREFIX  fn: &lt;http://www.w3.org/2005/xpath-functions#&gt;
PREFIX  afn: &lt;http://jena.hpl.hp.com/ARQ/function#&gt;
SELECT ?subject (afn:namespace(?object) as ?object1)
WHERE { ?subject &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; ?object } 
</pre></div>
</div>
<a id="RDFRM258"></a>
<div class="props_rev_3"><a id="GUID-4952479F-822D-444E-93EC-F06D40BC422C"></a>
<h3 id="RDFRM-GUID-4952479F-822D-444E-93EC-F06D40BC422C" class="sect3"><span class="enumeration_section">7.8.2</span> Native Oracle Database Functions for Projected Variables</h3>
<div>
<p>SPARQL queries through the support for Apache Jena can use native Oracle Database functions for projected variables. These queries and the functions are executed inside the database. Note that the functions described in this section should not be used together with ARQ functions (described in <a href="rdf-jena.htm#GUID-353E37B3-DBF6-4BDF-B722-9384FB75DDD3">Functions in the ARQ Function Library</a>).</p>
<p>This section lists the supported native functions and provides some examples. In the examples, the prefix <code class="codeph">oext</code> is <code class="codeph">&lt;http://oracle.com/semtech/jena-adaptor/ext/function#&gt;</code>.</p>
<div class="infobox-note" id="GUID-4952479F-822D-444E-93EC-F06D40BC422C__GUID-2EA8D15C-93ED-4FF5-B71F-4B2007017E99">
<p class="notep1">Note:</p>
<p>In the preceding URL, note the spelling <code class="codeph">jena-adapt</code><span class="bold"><code class="codeph">or</code></span>, which is retained for compatibility with existing applications and which must be used in queries. The <span class="italic">adapt</span><span class="italic"><span class="bold">er</span></span> spelling is used in regular text, to follow Oracle documentation style guidelines.</p>
</div>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold"><code class="codeph">oext:upper-literal</code></span> converts literal values (except for long literals) to uppercase. For example:</p>
<pre dir="ltr">PREFIX  oext: &lt;http://oracle.com/semtech/jena-adaptor/ext/function#&gt;
SELECT (oext:upper-literal(?object) as ?object1)
WHERE { ?subject dc:title ?object }
</pre></li>
<li>
<p><span class="bold"><code class="codeph">oext:lower-literal</code></span> converts literal values (except for long literals) to lowercase. For example:</p>
<pre dir="ltr">PREFIX  oext: &lt;http://oracle.com/semtech/jena-adaptor/ext/function#&gt;
SELECT (oext:lower-literal(?object) as ?object1)
WHERE { ?subject dc:title ?object }
</pre></li>
<li>
<p><span class="bold"><code class="codeph">oext:build-uri-for-id</code></span> converts the value ID of a URI, bNode, or literal into a URI form. For example:</p>
<pre dir="ltr">PREFIX  oext: &lt;http://oracle.com/semtech/jena-adaptor/ext/function#&gt;
SELECT (oext:build-uri-for-id(?object) as ?object1)
WHERE { ?subject dc:title ?object }
</pre>
<p>An example of the output might be: <code class="codeph">&lt;rdfvid:1716368199350136353&gt;</code></p>
<p>One use of this function is to allow Java applications to maintain in memory a mapping of those value IDs to the lexical form of URIs, bNodes, or literals. The MDSYS.RDF_VALUE$ table provides such a mapping in Oracle Database.</p>
<p>For a given variable <code class="codeph">?var</code>, if only <code class="codeph">oext:build-uri-for-id(?var)</code> is projected, the query performance is likely to be faster because fewer internal table join operations are needed to answer the query.</p>
</li>
<li>
<p><span class="bold"><code class="codeph">oext:literal-strlen</code></span> returns the length of literal values (except for long literals). For example:</p>
<pre dir="ltr">PREFIX  oext: &lt;http://oracle.com/semtech/jena-adaptor/ext/function#&gt;
SELECT (oext:literal-strlen(?object) as ?objlen)
WHERE { ?subject dc:title ?object }
</pre></li>
</ul>
</div>
</div>
<a id="RDFRM260"></a><a id="RDFRM259"></a>
<div class="props_rev_3"><a id="GUID-199B0235-0ACC-43CD-842E-C3A8891E9197"></a>
<h3 id="RDFRM-GUID-199B0235-0ACC-43CD-842E-C3A8891E9197" class="sect3"><span class="enumeration_section">7.8.3</span> User-Defined Functions</h3>
<div>
<p>SPARQL queries through the support for Apache Jena can use user-defined functions that are stored in the database.</p>
<p>In the following example, assume that you want to define a string length function (<code class="codeph">my_strlen</code>) that handles long literals (CLOB) as well as short literals. On the SPARQL query side, this function can be referenced under the namespace of <code class="codeph">ouext</code>, which is <code class="codeph">http://oracle.com/semtech/jena-adaptor/ext/user-def-function#</code>.</p>
<pre dir="ltr">PREFIX  ouext: &lt;http://oracle.com/semtech/jena-adaptor/ext/user-def-function#&gt;
SELECT ?subject ?object (ouext:my_strlen(?object) as ?obj1)
WHERE { ?subject dc:title ?object }
</pre>
<p>Inside the database, functions including <code class="codeph">my_strlen</code>, <code class="codeph">my_strlen_cl</code>, <code class="codeph">my_strlen_la</code>, <code class="codeph">my_strlen_lt</code>, and <code class="codeph">my_strlen_vt</code> are defined to implement this capability. Conceptually, the return values of these functions are mapped as shown in <a href="rdf-jena.htm#GUID-199B0235-0ACC-43CD-842E-C3A8891E9197__CBBJIJEE" title="Mapping of functions and return values for my_strlen example">Table 7-1</a>.</p>
<div class="tblformal" id="GUID-199B0235-0ACC-43CD-842E-C3A8891E9197__CBBJIJEE">
<p class="titleintable">Table 7-1 Functions and Return Values for my_strlen Example</p>
<table class="cellalignment4510" title="Functions and Return Values for my_strlen Example" summary="Mapping of functions and return values for my_strlen example">
<thead>
<tr class="cellalignment4501">
<th class="cellalignment4536" id="d38717e3019">Function Name</th>
<th class="cellalignment4537" id="d38717e3022">Return Value</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4501">
<td class="cellalignment4538" id="d38717e3027" headers="d38717e3019">
<p>my_strlen</p>
</td>
<td class="cellalignment4539" headers="d38717e3027 d38717e3022">
<p>&lt;VAR&gt;</p>
</td>
</tr>
<tr class="cellalignment4501">
<td class="cellalignment4538" id="d38717e3034" headers="d38717e3019">
<p>my_strlen_cl</p>
</td>
<td class="cellalignment4539" headers="d38717e3034 d38717e3022">
<p>&lt;VAR&gt;$RDFCLOB</p>
</td>
</tr>
<tr class="cellalignment4501">
<td class="cellalignment4538" id="d38717e3041" headers="d38717e3019">
<p>my_strlen_la</p>
</td>
<td class="cellalignment4539" headers="d38717e3041 d38717e3022">
<p>&lt;VAR&gt;$RDFLANG</p>
</td>
</tr>
<tr class="cellalignment4501">
<td class="cellalignment4538" id="d38717e3048" headers="d38717e3019">
<p>my_strlen_lt</p>
</td>
<td class="cellalignment4539" headers="d38717e3048 d38717e3022">
<p>&lt;VAR&gt;$RDFLTYP</p>
</td>
</tr>
<tr class="cellalignment4501">
<td class="cellalignment4538" id="d38717e3055" headers="d38717e3019">
<p>my_strlen_vt</p>
</td>
<td class="cellalignment4539" headers="d38717e3055 d38717e3022">
<p>&lt;VAR&gt;$RDFVTYP</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>A set of functions (five in all) is used to implement a user-defined function that can be referenced from SPARQL, because this aligns with the internal representation of an RDF resource (in MDSYS.RDF_VALUE$). There are five major columns describing an RDF resource in terms of its value, language, literal type, long value, and value type, and these five columns can be selected out using SEM_MATCH. In this context, a user-defined function simply converts one RDF resource that is represented by five columns to another RDF resource.</p>
<p>These functions are defined as follows:</p>
<pre dir="ltr">create or replace function <span class="bold">my_strlen</span>(rdfvtyp in varchar2,
                              rdfltyp in varchar2,
                              rdflang in varchar2,
                              rdfclob in clob,
                              value   in varchar2
                              ) return varchar2
 as
   ret_val  varchar2(4000);
 begin
   -- value
   if (rdfvtyp = &#39;LIT&#39;) then
     if (rdfclob is null) then
       return length(value);
     else
       return dbms_lob.getlength(rdfclob);
     end if;
   else
     -- Assign -1 for non-literal values so that application can
     -- easily differentiate
     return &#39;-1&#39;;
   end if;
 end;
 /
 
 create or replace function <span class="bold">my_strlen_cl</span>(rdfvtyp in varchar2,
                              rdfltyp in varchar2,
                              rdflang in varchar2,
                              rdfclob in clob,
                              value   in varchar2
                              ) return clob
 as
 begin
   return null;
 end;
 /
 
 create or replace function <span class="bold">my_strlen_la</span>(rdfvtyp in varchar2,
                              rdfltyp in varchar2,
                              rdflang in varchar2,
                              rdfclob in clob,
                              value   in varchar2
                              ) return varchar2
 as
 begin
   return null;
 end;
 /
 
 create or replace function <span class="bold">my_strlen_lt</span>(rdfvtyp in varchar2,
                              rdfltyp in varchar2,
                              rdflang in varchar2,
                              rdfclob in clob,
                              value   in varchar2
                              ) return varchar2
 as
   ret_val  varchar2(4000);
 begin
   -- literal type
   return &#39;http://www.w3.org/2001/XMLSchema#integer&#39;;
 end;
 /
 
 create or replace function <span class="bold">my_strlen_vt</span>(rdfvtyp in varchar2,
                              rdfltyp in varchar2,
                              rdflang in varchar2,
                              rdfclob in clob,
                              value   in varchar2
                              ) return varchar2
 as
   ret_val  varchar2(3);
 begin
   return &#39;LIT&#39;;
 end;
 /
</pre>
<p>User-defined functions can also accept a parameter of VARCHAR2 type. The following five functions together define a <code class="codeph">my_shorten_str</code> function that accepts an integer (in VARCHAR2 form) for the substring length and returns the substring. (The substring in this example is 12 characters, and it must not be greater than 4000 bytes.)</p>
<pre dir="ltr">-- SPARQL query that returns the first 12 characters of literal values.
-- 
PREFIX  ouext: &lt;http://oracle.com/semtech/jena-adaptor/ext/user-def-function#&gt;
SELECT (ouext:my_shorten_str(?object, &#34;12&#34;) as ?obj1) ?subject
WHERE { ?subject dc:title ?object }
 
create or replace function <span class="bold">my_shorten_str</span>(rdfvtyp in varchar2,
                            rdfltyp in varchar2,
                            rdflang in varchar2,
                            rdfclob in clob,
                            value   in varchar2,
                            arg     in varchar2
                            ) return varchar2
as
 ret_val  varchar2(4000);
begin
 -- value
 if (rdfvtyp = &#39;LIT&#39;) then
   if (rdfclob is null) then
     return substr(value, 1, to_number(arg));
   else
     return dbms_lob.substr(rdfclob, to_number(arg), 1);
   end if;
 else
   return null;
 end if;
end;
/
 
create or replace function <span class="bold">my_shorten_str_cl</span>(rdfvtyp in varchar2,
                            rdfltyp in varchar2,
                            rdflang in varchar2,
                            rdfclob in clob,
                            value   in varchar2,
                            arg     in varchar2
                            ) return clob
as
 ret_val  clob;
begin
 -- lob
 return null;
end;
/
 
create or replace function <span class="bold">my_shorten_str_la</span>(rdfvtyp in varchar2,
                            rdfltyp in varchar2,
                            rdflang in varchar2,
                            rdfclob in clob,
                            value   in varchar2,
                            arg     in varchar2
                            ) return varchar2
as
 ret_val  varchar2(4000);
begin
 -- lang
 if (rdfvtyp = &#39;LIT&#39;) then
   return rdflang;
 else
   return null;
 end if;
end;
/
 
create or replace function <span class="bold">my_shorten_str_lt</span>(rdfvtyp in varchar2,
                            rdfltyp in varchar2,
                            rdflang in varchar2,
                            rdfclob in clob,
                            value   in varchar2,
                            arg     in varchar2
                            ) return varchar2
as
 ret_val  varchar2(4000);
begin
 -- literal type
 ret_val := rdfltyp;
 return ret_val;
end;
/
 
create or replace function <span class="bold">my_shorten_str_vt</span>(rdfvtyp in varchar2,
                            rdfltyp in varchar2,
                            rdflang in varchar2,
                            rdfclob in clob,
                            value   in varchar2,
                            arg     in varchar2
                            ) return varchar2
as
 ret_val  varchar2(3);
begin
 return &#39;LIT&#39;;
end;
/
</pre></div>
</div>
</div>
<a id="RDFRM460"></a><a id="RDFRM461"></a><a id="RDFRM459"></a>
<div class="props_rev_3"><a id="GUID-C94D34A5-436A-4ED7-97D0-BE315755F7AE"></a>
<h2 id="RDFRM-GUID-C94D34A5-436A-4ED7-97D0-BE315755F7AE" class="sect2"><span class="enumeration_section">7.9</span> SPARQL Update Support</h2>
<div>
<p>RDF Semantic Graph support for Apache Jena supports SPARQL Update (<code class="codeph">http://www.w3.org/TR/sparql11-update/</code>), also referred to as SPARUL. The primary programming APIs involve the Jena class <code class="codeph">UpdateAction</code> (in package <code class="codeph">com.hp.hpl.jena.update</code>) and RDF Semantic Graph support for Apache Jena classes <code class="codeph">GraphOracleSem</code> and <code class="codeph">DatasetGraphOracleSem</code>. <a href="rdf-jena.htm#GUID-C94D34A5-436A-4ED7-97D0-BE315755F7AE__BGBCBEDB">Example 7-4</a> shows a SPARQL Update operation removes all triples in named graph <code class="codeph">&lt;http://example/graph&gt;</code> from the relevant model stored in the database.</p>
<div class="example" id="GUID-C94D34A5-436A-4ED7-97D0-BE315755F7AE__BGBCBEDB">
<p class="titleinexample">Example 7-4 Simple SPARQL Update</p>
<pre dir="ltr">GraphOracleSem graphOracleSem = .... ;
DatasetGraphOracleSem dsgos = DatasetGraphOracleSem.createFrom(graphOracleSem);
 
// SPARQL Update operation
String szUpdateAction = &#34;DROP GRAPH &lt;http://example/graph&gt;&#34;;
 
// Execute the Update against a DatasetGraph instance (can be a Jena Model as well)
UpdateAction.parseExecute(szUpdateAction, dsgos);
</pre>
<p>Note that Oracle Database does not keep any information about an empty named graph. This implies if you invoke CREATE GRAPH <span class="italic">&lt;graph_name&gt;</span> without adding any triples into this graph, then no additional rows in the application table or the underlying RDF_LINK$ table will be created. To an Oracle database, you can safely skip the CREATE GRAPH step, as is the case in <a href="rdf-jena.htm#GUID-C94D34A5-436A-4ED7-97D0-BE315755F7AE__BGBCBEDB">Example 7-4</a>.</p>
</div>
<!-- class="example" -->
<div class="example" id="GUID-C94D34A5-436A-4ED7-97D0-BE315755F7AE__BGBHAHII">
<p class="titleinexample">Example 7-5 SPARQL Update with Insert and Delete Operations</p>
<p><a href="rdf-jena.htm#GUID-C94D34A5-436A-4ED7-97D0-BE315755F7AE__BGBHAHII">Example 7-5</a> shows a SPARQL Update operation (from ARQ 2.8.8) involving multiple insert and delete operations.</p>
<pre dir="ltr">PREFIX : &lt;http://example/&gt;
CREATE GRAPH &lt;http://example/graph&gt; ;
INSERT DATA { :r :p 123 } ;
INSERT DATA { :r :p 1066 } ;
DELETE DATA { :r :p 1066 } ;
INSERT DATA {
  GRAPH &lt;http://example/graph&gt; { :r :p 123 . :r :p 1066 }
} ;
DELETE DATA {
  GRAPH &lt;http://example/graph&gt;  { :r :p 123 }
}
</pre>
<p>After running the update operation in <a href="rdf-jena.htm#GUID-C94D34A5-436A-4ED7-97D0-BE315755F7AE__BGBHAHII">Example 7-5</a> against an empty <code class="codeph">DatasetGraphOracleSem</code>, running the SPARQL query <code class="codeph">SELECT ?s ?p ?o WHERE {?s ?p ?o}</code> generates the following response:</p>
<pre dir="ltr">-----------------------------------------------------------------------------------------------
| s                  | p                  | o                                                 |
===============================================================================================
| &lt;http://example/r&gt; | &lt;http://example/p&gt; | &#34;123&#34;^^&lt;http://www.w3.org/2001/XMLSchema#decimal&gt; |
-----------------------------------------------------------------------------------------------
</pre>
<p>Using the same data, running the SPARQL query <code class="codeph">SELECT ?g ?s ?p ?o where {GRAPH ?g {?s ?p ?o}}</code> generates the following response:</p>
<pre dir="ltr">-------------------------------------------------------------------------------------------------------------------------
| g                      | s                  | p                  | o                                                  |
=========================================================================================================================
| &lt;http://example/graph&gt; | &lt;http://example/r&gt; | &lt;http://example/p&gt; | &#34;1066&#34;^^&lt;http://www.w3.org/2001/XMLSchema#decimal&gt; |
-------------------------------------------------------------------------------------------------------------------------
</pre>
<p>In addition to using the Java API for SPARQL Update operations, you can configure Joseki to accept SPARQL Update operations by removing the comment (<code class="codeph">##</code>) characters at the start of the following lines in the <code class="codeph">joseki-config.ttl</code> file.</p>
<pre dir="ltr">## &lt;#serviceUpdate&gt;
##     rdf:type            joseki:Service ;
##     rdfs:label          &#34;SPARQL/Update&#34; ;
##     joseki:serviceRef   &#34;update/service&#34; ;
##     # dataset part
##     joseki:dataset      &lt;#oracle&gt;;
##     # Service part.    
##     # This processor will not allow either the protocol,
##     # nor the query, to specify the dataset.
##     joseki:processor    joseki:ProcessorSPARQLUpdate
##     .
## 
## &lt;#serviceRead&gt;
##     rdf:type            joseki:Service ;
##     rdfs:label          &#34;SPARQL&#34; ;
##     joseki:serviceRef   &#34;sparql/read&#34; ;
##     # dataset part
##     joseki:dataset      &lt;#oracle&gt; ;     ## Same dataset
##     # Service part. 
##     # This processor will not allow either the protocol,
##     # nor the query, to specify the dataset.
##     joseki:processor    joseki:ProcessorSPARQL_FixedDS ;
##     .
</pre>
<p>After you edit the <code class="codeph">joseki-config.ttl</code> file, you must restart the Joseki Web application. You can then try a simple update operation, as follows:</p>
<ol>
<li>
<p>In your browser, go to: <code class="codeph">http://</code><span class="italic"><code class="codeph">&lt;hostname&gt;</code></span><code class="codeph">:7001/joseki/update.html</code></p>
</li>
<li>
<p>Type or paste the following into the text box:</p>
<pre dir="ltr">PREFIX : &lt;http://example/&gt;
INSERT DATA {
  GRAPH &lt;http://example/g1&gt; { :r :p 455 }
}
</pre></li>
<li>
<p>Click <span class="bold">Perform SPARQL Update</span>.</p>
</li>
</ol>
<p>To verify that the update operation was successful, go to <code class="codeph">http://</code><span class="italic"><code class="codeph">&lt;hostname&gt;</code></span><code class="codeph">:7001/joseki</code> and enter the following query:</p>
<pre dir="ltr">SELECT *
WHERE
  {  GRAPH &lt;http://example/g1&gt; {?s ?p ?o}};
</pre>
<p>The response should contain the following triple:</p>
<pre dir="ltr">&lt;http://example/r&gt;     &lt;http://example/p&gt;    &#34;455&#34;^^&lt;http://www.w3.org/2001/XMLSchema#decimal&gt;
</pre>
<p>A SPARQL Update can also be sent using an HTTP POST operation to the <code class="codeph">http://</code><span class="italic"><code class="codeph">&lt;hostname&gt;</code></span><code class="codeph">:7001/joseki/update/</code>service. For example, you can use <code class="codeph">curl</code> (<a href="http://en.wikipedia.org/wiki/CURL" target="_blank"><code class="codeph">http://en.wikipedia.org/wiki/CURL</code></a>) to send an HTTP POST request to perform the update operation:</p>
<pre dir="ltr">curl --data &#34;request=PREFIX%20%3A%20%3Chttp%3A%2F%2Fexample%2F%3E%20%0AINSERT%20DATA%20%7B%0A%20%20GRAPH%20%3Chttp%3A%2F%2Fexample%2Fg1%3E%20%7B%20%3Ar%20%3Ap%20888%20%7D%0A%7D%0A&#34;  http://<span class="italic">hostname</span>:7001/joseki/update/service
</pre>
<p>In the preceding example, the URL encoded string is a simple INSERT operation into a named graph. After decoding, it reads as follows:</p>
<pre dir="ltr">PREFIX : &lt;http://example/&gt;
INSERT DATA {
  GRAPH &lt;http://example/g1&gt; { :r :p 888 }
</pre></div>
<!-- class="example" --></div>
</div>
<a id="RDFRM463"></a><a id="RDFRM464"></a><a id="RDFRM462"></a>
<div class="props_rev_3"><a id="GUID-828999B9-6B4D-4BA1-AC00-953D20212F24"></a>
<h2 id="RDFRM-GUID-828999B9-6B4D-4BA1-AC00-953D20212F24" class="sect2"><span class="enumeration_section">7.10</span> Analytical Functions for RDF Data</h2>
<div>
<p>You can perform analytical functions on RDF data by using the <code class="codeph">SemNetworkAnalyst</code> class in the <code class="codeph">oracle.spatial.rdf.client.jena</code> package. This support integrates the Network Data Model Graph logic with the underlying RDF data structures. Therefore, to use analytical functions on RDF data, you must be familiar with the Network Data Model Graph feature, which is documented in <a class="olink TOPOL700" target="_blank" href="../TOPOL/network-data-model-graph-overview.htm#TOPOL700"><span class="italic">Oracle Spatial and Graph Topology Data Model and Network Data Model Graph Developer&#39;s Guide</span></a>.</p>
<p>The required NDM Java libraries, including <code class="codeph">sdonm.jar</code> and <code class="codeph">sdoutl.jar</code>, are under the directory <code class="codeph">$ORACLE_HOME/md/jlib</code>. Note that <code class="codeph">xmlparserv2.jar</code> (under <code class="codeph">$ORACLE_HOME/xdk/lib</code>) must be included in the <code class="codeph">classpath</code> definition.</p>
<div class="example" id="GUID-828999B9-6B4D-4BA1-AC00-953D20212F24__BGBDIHEA">
<p class="titleinexample">Example 7-6 Performing Analytical functions on RDF Data</p>
<p><a href="rdf-jena.htm#GUID-828999B9-6B4D-4BA1-AC00-953D20212F24__BGBDIHEA">Example 7-6</a> uses the <code class="codeph">SemNetworkAnalyst</code> class, which internally uses the NDM <code class="codeph">NetworkAnalyst</code> API</p>
<pre dir="ltr">Oracle oracle = new Oracle(jdbcUrl, user, password);
GraphOracleSem graph = new GraphOracleSem(oracle, modelName);
 
Node nodeA = Node.createURI(&#34;http://A&#34;);
Node nodeB = Node.createURI(&#34;http://B&#34;);
Node nodeC = Node.createURI(&#34;http://C&#34;);
Node nodeD = Node.createURI(&#34;http://D&#34;);
Node nodeE = Node.createURI(&#34;http://E&#34;);
Node nodeF = Node.createURI(&#34;http://F&#34;);
Node nodeG = Node.createURI(&#34;http://G&#34;);
Node nodeX = Node.createURI(&#34;http://X&#34;);
 
// An anonymous node
Node ano = Node.createAnon(new AnonId(&#34;m1&#34;));
 
Node relL = Node.createURI(&#34;http://likes&#34;);
Node relD = Node.createURI(&#34;http://dislikes&#34;);
Node relK = Node.createURI(&#34;http://knows&#34;);
Node relC = Node.createURI(&#34;http://differs&#34;);
 
graph.add(new Triple(nodeA, relL, nodeB));
graph.add(new Triple(nodeA, relC, nodeD));
graph.add(new Triple(nodeB, relL, nodeC));
graph.add(new Triple(nodeA, relD, nodeC));
 
graph.add(new Triple(nodeB, relD, ano));
graph.add(new Triple(nodeC, relL, nodeD));
graph.add(new Triple(nodeC, relK, nodeE));
graph.add(new Triple(ano,   relL, nodeD));
graph.add(new Triple(ano,   relL, nodeF));
graph.add(new Triple(ano,   relD, nodeB));
 
// X only likes itself
graph.add(new Triple(nodeX, relL, nodeX));
 
graph.commitTransaction();
HashMap&lt;Node, Double&gt; costMap = new HashMap&lt;Node, Double&gt;();
costMap.put(relL, Double.valueOf((double)0.5));
costMap.put(relD, Double.valueOf((double)1.5));
costMap.put(relC, Double.valueOf((double)5.5));
 
graph.setDOP(4); // this allows the underlying LINK/NODE tables
                 // and indexes to be created in parallel.
 
SemNetworkAnalyst sna = SemNetworkAnalyst.getInstance(
    graph,   // network data source
    true,    // directed graph
    true,    // cleanup existing NODE and LINK table
    costMap
    );
 
psOut.println(&#34;From nodeA to nodeC&#34;);
Node[] nodeArray = sna.shortestPathDijkstra(nodeA, nodeC);
printNodeArray(nodeArray, psOut);
 
psOut.println(&#34;From nodeA to nodeD&#34;); 
nodeArray = sna.shortestPathDijkstra( nodeA, nodeD);
printNodeArray(nodeArray, psOut);
 
psOut.println(&#34;From nodeA to nodeF&#34;);
nodeArray = sna.shortestPathAStar(nodeA, nodeF);
printNodeArray(nodeArray, psOut);
 
psOut.println(&#34;From ano to nodeC&#34;);
nodeArray = sna.shortestPathAStar(ano, nodeC);
printNodeArray(nodeArray, psOut);
 
psOut.println(&#34;From ano to nodeX&#34;);
nodeArray = sna.shortestPathAStar(ano, nodeX);
printNodeArray(nodeArray, psOut);
 
graph.close();
oracle.dispose();
...
...
   
// A helper function to print out a path
public static void printNodeArray(Node[] nodeArray, PrintStream psOut)
{
  if (nodeArray == null) {
    psOut.println(&#34;Node Array is null&#34;);
    return;
  }
  if (nodeArray.length == 0) {psOut.println(&#34;Node Array is empty&#34;); }
  int iFlag = 0;
  psOut.println(&#34;printNodeArray: full path starts&#34;);
  for (int iHops = 0; iHops &lt; nodeArray.length; iHops++) {
    psOut.println(&#34;printNodeArray: full path item &#34; + iHops + &#34; = &#34;
        + ((iFlag == 0) ? &#34;[n] &#34;:&#34;[e] &#34;) + nodeArray[iHops]);
    iFlag = 1 - iFlag;
  }
}
</pre>
<p>In <a href="rdf-jena.htm#GUID-828999B9-6B4D-4BA1-AC00-953D20212F24__BGBDIHEA">Example 7-6</a>:</p>
<ul style="list-style-type: disc;">
<li>
<p>A <code class="codeph">GraphOracleSem</code> object is constructed and a few triples are added to the <code class="codeph">GraphOracleSem</code> object. These triples describe several individuals and their relationships including <span class="italic">likes</span>, <span class="italic">dislikes</span>, <span class="italic">knows</span>, and <span class="italic">differs</span>.</p>
</li>
<li>
<p>A cost mapping is constructed to assign a numeric cost value to different links/predicates (of the RDF graph). In this case, 0.5, 1.5, and 5.5 are assigned to predicates <span class="italic">likes</span>, <span class="italic">dislikes</span>, and <span class="italic">differs</span>, respectively. This cost mapping is optional. If the mapping is absent, then all predicates will be assigned the same cost 1. When cost mapping is specified, this mapping does not need to be complete; for predicates not included in the cost mapping, a default value of 1 is assigned.</p>
</li>
</ul>
<p>The output of <a href="rdf-jena.htm#GUID-828999B9-6B4D-4BA1-AC00-953D20212F24__BGBDIHEA">Example 7-6</a> is as follows. In this output, the shortest paths are listed for the given start and end nodes. Note that the return value of <code class="codeph">sna.shortestPathAStar(ano, nodeX)</code> is null because there is no path between these two nodes.</p>
<pre dir="ltr">From nodeA to nodeC
printNodeArray: full path starts
printNodeArray: full path item 0 = [n] http://A           ## &#34;n&#34; denotes Node             
printNodeArray: full path item 1 = [e] http://likes       ## &#34;e&#34; denotes Edge (Link)
printNodeArray: full path item 2 = [n] http://B
printNodeArray: full path item 3 = [e] http://likes
printNodeArray: full path item 4 = [n] http://C
 
From nodeA to nodeD
printNodeArray: full path starts
printNodeArray: full path item 0 = [n] http://A
printNodeArray: full path item 1 = [e] http://likes
printNodeArray: full path item 2 = [n] http://B
printNodeArray: full path item 3 = [e] http://likes
printNodeArray: full path item 4 = [n] http://C
printNodeArray: full path item 5 = [e] http://likes
printNodeArray: full path item 6 = [n] http://D
 
From nodeA to nodeF
printNodeArray: full path starts
printNodeArray: full path item 0 = [n] http://A
printNodeArray: full path item 1 = [e] http://likes
printNodeArray: full path item 2 = [n] http://B
printNodeArray: full path item 3 = [e] http://dislikes
printNodeArray: full path item 4 = [n] m1
printNodeArray: full path item 5 = [e] http://likes
printNodeArray: full path item 6 = [n] http://F
 
From ano to nodeC
printNodeArray: full path starts
printNodeArray: full path item 0 = [n] m1
printNodeArray: full path item 1 = [e] http://dislikes
printNodeArray: full path item 2 = [n] http://B
printNodeArray: full path item 3 = [e] http://likes
printNodeArray: full path item 4 = [n] http://C
 
From ano to nodeX
Node Array is null
</pre>
<p>The underlying RDF graph view (SEMM_<span class="italic">&lt;model_name&gt;</span> or RDFM_<span class="italic">&lt;model_name&gt;</span>) cannot be used directly by NDM functions, and so <code class="codeph">SemNetworkAnalyst</code> creates necessary tables that contain the nodes and links that are derived from a given RDF graph. These tables are not updated automatically when the RDF graph changes; rather, you can set the <code class="codeph">cleanup</code> parameter in <code class="codeph">SemNetworkAnalyst.getInstance</code> to <code class="codeph">true</code>, to remove old node and link tables and to rebuild updated tables.</p>
</div>
<!-- class="example" -->
<div class="example" id="GUID-828999B9-6B4D-4BA1-AC00-953D20212F24__BGBHAABI">
<p class="titleinexample">Example 7-7 Implementing NDM nearestNeighbors Function on Top of Semantic Data</p>
<p><a href="rdf-jena.htm#GUID-828999B9-6B4D-4BA1-AC00-953D20212F24__BGBHAABI">Example 7-7</a> implements the NDM <code class="codeph">nearestNeighbors</code> function on top of semantic data. This gets a <code class="codeph">NetworkAnalyst</code> object from the <code class="codeph">SemNetworkAnalyst</code> instance, gets the node ID, creates <code class="codeph">PointOnNet</code> objects, and processes <code class="codeph">LogicalSubPath</code> objects.</p>
<pre dir="ltr">%cat TestNearestNeighbor.java 
 
import java.io.*;
import java.util.*;
import com.hp.hpl.jena.query.*;
import com.hp.hpl.jena.rdf.model.Model;
import com.hp.hpl.jena.util.FileManager;
import com.hp.hpl.jena.util.iterator.*;
import com.hp.hpl.jena.graph.*;
import com.hp.hpl.jena.update.*;
import com.hp.hpl.jena.sparql.core.DatasetImpl;
 
import oracle.spatial.rdf.client.jena.*;
 
import oracle.spatial.rdf.client.jena.SemNetworkAnalyst;
import oracle.spatial.network.lod.LODGoalNode;
import oracle.spatial.network.lod.LODNetworkConstraint;
import oracle.spatial.network.lod.NetworkAnalyst;
import oracle.spatial.network.lod.PointOnNet;
import oracle.spatial.network.lod.LogicalSubPath;
 
 
/**
 * This class implements a nearestNeighbors function on top of semantic data
 * using public APIs provided in SemNetworkAnalyst and Oracle Spatial NDM
 */
public class TestNearestNeighbor
{
  public static void main(String[] args) throws Exception
  {
    String szJdbcURL = args[0];
    String szUser    = args[1];
    String szPasswd  = args[2];
 
    PrintStream psOut = System.out;
 
    Oracle oracle = new Oracle(szJdbcURL, szUser, szPasswd);
    
    String szModelName = &#34;test_nn&#34;;
    // First construct a TBox and load a few axioms
    ModelOracleSem model = ModelOracleSem.createOracleSemModel(oracle, szModelName);
    String insertString =  
      &#34; PREFIX my:  &lt;http://my.com/&gt; &#34; +
      &#34; INSERT DATA &#34;                             +
      &#34; { my:A   my:likes my:B .                &#34; +
      &#34;   my:A   my:likes my:C .                &#34; +
      &#34;   my:A   my:knows my:D .                &#34; +
      &#34;   my:A   my:dislikes my:X .             &#34; +
      &#34;   my:A   my:dislikes my:Y .             &#34; +
      &#34;   my:C   my:likes my:E .                &#34; +
      &#34;   my:C   my:likes my:F .                &#34; +
      &#34;   my:C   my:dislikes my:M .             &#34; +
      &#34;   my:D   my:likes my:G .                &#34; +
      &#34;   my:D   my:likes my:H .                &#34; +
      &#34;   my:F   my:likes my:M .                &#34; +
      &#34; }   &#34;;
    UpdateAction.parseExecute(insertString,  model);
 
    GraphOracleSem g = model.getGraph();
    g.commitTransaction();
    g.setDOP(4);
 
    HashMap&lt;Node, Double&gt; costMap = new HashMap&lt;Node, Double&gt;();
    costMap.put(Node.createURI(&#34;http://my.com/likes&#34;),    Double.valueOf(1.0));
    costMap.put(Node.createURI(&#34;http://my.com/dislikes&#34;), Double.valueOf(4.0));
    costMap.put(Node.createURI(&#34;http://my.com/knows&#34;),    Double.valueOf(2.0));
 
    SemNetworkAnalyst sna = SemNetworkAnalyst.getInstance(
        g,     // source RDF graph
        true,  // directed graph
        true,  // cleanup old Node/Link tables
        costMap
        );
 
    Node nodeStart = Node.createURI(&#34;http://my.com/A&#34;);
    long origNodeID = sna.getNodeID(nodeStart);
 
    long[] lIDs = {origNodeID};
 
    // translate from the original ID
    long nodeID = (sna.mapNodeIDs(lIDs))[0]; 
 
    NetworkAnalyst networkAnalyst = sna.getEmbeddedNetworkAnalyst();
 
    LogicalSubPath[] lsps = networkAnalyst.nearestNeighbors(
      new PointOnNet(nodeID),      // startPoint
      6,                           // numberOfNeighbors
      1,                           // searchLinkLevel
      1,                           // targetLinkLevel
      (LODNetworkConstraint) null, // constraint
      (LODGoalNode) null           // goalNodeFilter
      );
 
    if (lsps != null) {
      for (int idx = 0; idx &lt; lsps.length; idx++) {
        LogicalSubPath lsp = lsps[idx];
        Node[] nodePath = sna.processLogicalSubPath(lsp, nodeStart);
        psOut.println(&#34;Path &#34; + idx);
        printNodeArray(nodePath, psOut);
      }
    }
 
    g.close();
    sna.close();
    oracle.dispose();
  }
 
 
  public static void printNodeArray(Node[] nodeArray, PrintStream psOut)
  {
    if (nodeArray == null) {
      psOut.println(&#34;Node Array is null&#34;);
      return;
    }
    if (nodeArray.length == 0) {
      psOut.println(&#34;Node Array is empty&#34;);
    }
    int iFlag = 0;
    psOut.println(&#34;printNodeArray: full path starts&#34;);
    for (int iHops = 0; iHops &lt; nodeArray.length; iHops++) {
      psOut.println(&#34;printNodeArray: full path item &#34; + iHops + &#34; = &#34;
          + ((iFlag == 0) ? &#34;[n] &#34;:&#34;[e] &#34;) + nodeArray[iHops]);
      iFlag = 1 - iFlag;
    }
  }
}
</pre>
<p>The output of <a href="rdf-jena.htm#GUID-828999B9-6B4D-4BA1-AC00-953D20212F24__BGBHAABI">Example 7-7</a> is as follows.</p>
<pre dir="ltr">Path 0
printNodeArray: full path starts
printNodeArray: full path item 0 = [n] http://my.com/A
printNodeArray: full path item 1 = [e] http://my.com/likes
printNodeArray: full path item 2 = [n] http://my.com/C
 
Path 1
printNodeArray: full path starts
printNodeArray: full path item 0 = [n] http://my.com/A
printNodeArray: full path item 1 = [e] http://my.com/likes
printNodeArray: full path item 2 = [n] http://my.com/B
 
Path 2
printNodeArray: full path starts
printNodeArray: full path item 0 = [n] http://my.com/A
printNodeArray: full path item 1 = [e] http://my.com/knows
printNodeArray: full path item 2 = [n] http://my.com/D
 
Path 3
printNodeArray: full path starts
printNodeArray: full path item 0 = [n] http://my.com/A
printNodeArray: full path item 1 = [e] http://my.com/likes
printNodeArray: full path item 2 = [n] http://my.com/C
printNodeArray: full path item 3 = [e] http://my.com/likes
printNodeArray: full path item 4 = [n] http://my.com/E
 
Path 4
printNodeArray: full path starts
printNodeArray: full path item 0 = [n] http://my.com/A
printNodeArray: full path item 1 = [e] http://my.com/likes
printNodeArray: full path item 2 = [n] http://my.com/C
printNodeArray: full path item 3 = [e] http://my.com/likes
printNodeArray: full path item 4 = [n] http://my.com/F
 
Path 5
printNodeArray: full path starts
printNodeArray: full path item 0 = [n] http://my.com/A
printNodeArray: full path item 1 = [e] http://my.com/knows
printNodeArray: full path item 2 = [n] http://my.com/D
printNodeArray: full path item 3 = [e] http://my.com/likes
printNodeArray: full path item 4 = [n] http://my.com/H
</pre></div>
<!-- class="example" --></div>
<a id="RDFRM467"></a><a id="RDFRM465"></a>
<div class="props_rev_3"><a id="GUID-90A00E71-C53F-45DA-9F52-3B16C0EEA32C"></a>
<h3 id="RDFRM-GUID-90A00E71-C53F-45DA-9F52-3B16C0EEA32C" class="sect3"><span class="enumeration_section">7.10.1</span> Generating Contextual Information about a Path in a Graph</h3>
<div>
<p>It is sometimes useful to see contextual information about a path in a graph, in addition to the path itself. The <code class="codeph">buildSurroundingSubGraph</code> method in the <code class="codeph">SemNetworkAnalyst</code> class can output a DOT file (graph description language file, extension <code class="codeph">.gv</code>) into the specified <code class="codeph">Writer</code> object. For each node in the path, up to ten direct neighbors are used to produce a surrounding subgraph for the path. The following example shows the usage of generating a DOT file with contextual information, specifically the output from the analytical functions used in <a href="rdf-jena.htm#GUID-828999B9-6B4D-4BA1-AC00-953D20212F24__BGBDIHEA">Example 7-6</a>.</p>
<pre dir="ltr">nodeArray = sna.shortestPathDijkstra(nodeA, nodeD);
printNodeArray(nodeArray, psOut);
 
FileWriter dotWriter = new FileWriter(&#34;Shortest_Path_A_to_D.gv&#34;);
sna.buildSurroundingSubGraph(nodeArray, dotWriter);
</pre>
<p>The generated output DOT file from the preceding example is straightforward, as shown in the following example:</p>
<pre dir="ltr">% cat Shortest_Path_A_to_D.gv
digraph { rankdir = LR; charset=&#34;utf-8&#34;; 
 
&#34;Rhttp://A&#34; [ label=&#34;http://A&#34; shape=rectangle,color=red,style = filled, ];
&#34;Rhttp://B&#34; [ label=&#34;http://B&#34; shape=rectangle,color=red,style = filled, ];
&#34;Rhttp://A&#34; -&gt; &#34;Rhttp://B&#34; [ label=&#34;http://likes&#34;  color=red, style=bold, ];
&#34;Rhttp://C&#34; [ label=&#34;http://C&#34; shape=rectangle,color=red,style = filled, ];
&#34;Rhttp://A&#34; -&gt; &#34;Rhttp://C&#34; [ label=&#34;http://dislikes&#34; ];
&#34;Rhttp://D&#34; [ label=&#34;http://D&#34; shape=rectangle,color=red,style = filled, ];
&#34;Rhttp://A&#34; -&gt; &#34;Rhttp://D&#34; [ label=&#34;http://differs&#34; ];
&#34;Rhttp://B&#34; -&gt; &#34;Rhttp://C&#34; [ label=&#34;http://likes&#34;  color=red, style=bold, ];
&#34;Rm1&#34; [ label=&#34;m1&#34; shape=ellipse,color=blue, ];
&#34;Rhttp://B&#34; -&gt; &#34;Rm1&#34; [ label=&#34;http://dislikes&#34; ];
&#34;Rm1&#34; -&gt; &#34;Rhttp://B&#34; [ label=&#34;http://dislikes&#34; ];
&#34;Rhttp://C&#34; -&gt; &#34;Rhttp://D&#34; [ label=&#34;http://likes&#34;  color=red, style=bold, ];
&#34;Rhttp://E&#34; [ label=&#34;http://E&#34; shape=ellipse,color=blue, ];
&#34;Rhttp://C&#34; -&gt; &#34;Rhttp://E&#34; [ label=&#34;http://knows&#34; ];
&#34;Rm1&#34; -&gt; &#34;Rhttp://D&#34; [ label=&#34;http://likes&#34; ];
}
</pre>
<p>You can also use methods in the <code class="codeph">SemNetworkAnalyst</code> and <code class="codeph">GraphOracleSem</code> classes to produce more sophisticated visualization of the analytical function output.</p>
<p>You can convert the preceding DOT file into a variety of image formats. <a href="rdf-jena.htm#GUID-90A00E71-C53F-45DA-9F52-3B16C0EEA32C__BGBECIFH">Figure 7-1</a> is an image representing the information in the preceding DOT file.</p>
<div class="figure" id="GUID-90A00E71-C53F-45DA-9F52-3B16C0EEA32C__BGBECIFH">
<p class="titleinfigure">Figure 7-1 Visual Representation of Analytical Function Output</p>
<img width="776" height="191" src="img/GUID-DC9CD33E-DF61-4879-B85B-B913F0A4ACFC-print.jpg" alt="Description of Figure 7-1 follows" title="Description of Figure 7-1 follows"/><br/>
<a href="img_text/GUID-DC9CD33E-DF61-4879-B85B-B913F0A4ACFC-print.htm">Description of &#34;Figure 7-1 Visual Representation of Analytical Function Output&#34;</a></div>
<!-- class="figure" --></div>
</div>
</div>
<a id="RDFRM261"></a>
<div class="props_rev_3"><a id="GUID-CBBCF550-832C-402A-89D2-0CDA62D27F0C"></a>
<h2 id="RDFRM-GUID-CBBCF550-832C-402A-89D2-0CDA62D27F0C" class="sect2"><span class="enumeration_section">7.11</span> Support for Server-Side APIs</h2>
<div>
<p>This section describes some of the RDF Semantic Graph features that are exposed by RDF Semantic Graph support for Apache Jena. For comprehensive documentation of the API calls that support the available features, see the RDF Semantic Graph support for Apache Jena reference information (Javadoc). For additional information about the server-side features exposed by the support for Apache Jena, see the relevant chapters in this manual.</p>
</div>
<a id="RDFRM262"></a>
<div class="props_rev_3"><a id="GUID-449AF064-7F23-4E4D-8155-06BBBADFADCA"></a>
<h3 id="RDFRM-GUID-449AF064-7F23-4E4D-8155-06BBBADFADCA" class="sect3"><span class="enumeration_section">7.11.1</span> Virtual Models Support</h3>
<div>
<p>Virtual models (explained in <a href="rdf-overview.htm#GUID-8B957406-5ED1-4579-9C23-0EDE2FDF2964">Virtual Models</a>) are specified in the <code class="codeph">GraphOracleSem</code> constructor, and they are handled transparently. If a virtual model exists for the model-rulebase combination, it is used in query answering; if such a virtual model does not exist, it is created in the database.</p>
<div class="infobox-note" id="GUID-449AF064-7F23-4E4D-8155-06BBBADFADCA__GUID-59A0734B-5328-4629-822B-5CAE563976E2">
<p class="notep1">Note:</p>
<p>Virtual model support through the support for Apache Jena is available only with Oracle Database Release 11.2 or later.</p>
</div>
<p>The following example reuses an existing virtual model.</p>
<pre dir="ltr">String modelName = &#34;EX&#34;;
String m1 = &#34;EX_1&#34;;
 
ModelOracleSem defaultModel = 
  ModelOracleSem.createOracleSemModel(oracle, modelName);
 
// create these models in case they don&#39;t exist
ModelOracleSem model1 = ModelOracleSem.createOracleSemModel(oracle, m1);
 
String vmName = &#34;VM_&#34; + modelName;
 
 
//create a virtual model containing EX and EX_1
oracle.executeCall(
&#34;begin sem_apis.create_virtual_model(?,sem_models(&#39;&#34;+ m1 + &#34;&#39;,&#39;&#34;+ modelName+&#34;&#39;),null); end;&#34;,vmName);
 
String[] modelNames = {m1};
String[] rulebaseNames = {};
 
Attachment attachment = Attachment.createInstance(modelNames, rulebaseNames, 
InferenceMaintenanceMode.NO_UPDATE, QueryOptions.ALLOW_QUERY_VALID_AND_DUP);
 
// vmName is passed to the constructor, so GraphOracleSem will use the virtual 
// model named vmname (if the current user has read privileges on it)
<span class="bold">GraphOracleSem graph = new GraphOracleSem(oracle, modelName, attachment, vmName);</span>
graph.add(Triple.create(Node.createURI(&#34;urn:alice&#34;),
                        Node.createURI(&#34;http://xmlns.com/foaf/0.1/mbox&#34;),
                        Node.createURI(&#34;mailto:alice@example&#34;)));
ModelOracleSem model = new ModelOracleSem(graph);         
 
String queryString =
 
   &#34; SELECT ?subject ?object WHERE { ?subject ?p ?object } &#34;;
 
Query query = QueryFactory.create(queryString) ;
QueryExecution qexec = QueryExecutionFactory.create(query, model) ;
 
try {
   ResultSet results = qexec.execSelect() ;
   for ( ; results.hasNext() ; ) {
      QuerySolution soln = results.nextSolution() ;
      psOut.println(&#34;soln &#34; + soln);
   }
} 
finally { 
   qexec.close() ; 
}
 
OracleUtils.dropSemanticModel(oracle, modelName);
OracleUtils.dropSemanticModel(oracle, m1);
 
oracle.dispose();
</pre>
<p>You can also use the GraphOracleSem constructor to create a virtual model, as in the following example:</p>
<pre dir="ltr">GraphOracleSem graph = new GraphOracleSem(oracle, modelName, attachment, <span class="bold">true</span>);
</pre>
<p>In this example, the fourth parameter (<code class="codeph">true</code>) specifies that a virtual model needs to be created for the specified <code class="codeph">modelName</code> and <code class="codeph">attachment</code>.</p>
</div>
</div>
<a id="RDFRM263"></a>
<div class="props_rev_3"><a id="GUID-070FC139-0675-4A54-832A-01B8E4025DA1"></a>
<h3 id="RDFRM-GUID-070FC139-0675-4A54-832A-01B8E4025DA1" class="sect3"><span class="enumeration_section">7.11.2</span> Connection Pooling Support</h3>
<div>
<p>Oracle Database Connection Pooling is provided through the support for Apache Jena <code class="codeph">OraclePool</code> class. Once this class is initialized, it can return Oracle objects out of its pool of available connections. Oracle objects are essentially database connection wrappers. After <code class="codeph">dispose</code> is called on the Oracle object, the connection is returned to the pool. More information about using <code class="codeph">OraclePool</code> can be found in the API reference information (Javadoc).</p>
<p>The following example sets up an OraclePool object with five (5) initial connections.</p>
<pre dir="ltr">public static void main(String[] args) throws Exception
  {     
    String szJdbcURL = args[0];
    String szUser    = args[1];
    String szPasswd  = args[2];
    String szModelName = args[3];
 
    // test with connection properties 
    java.util.Properties prop = new java.util.Properties();
    prop.setProperty(&#34;MinLimit&#34;, &#34;2&#34;);     // the cache size is 2 at least 
    prop.setProperty(&#34;MaxLimit&#34;, &#34;10&#34;);
    prop.setProperty(&#34;InitialLimit&#34;, &#34;2&#34;); // create 2 connections at startup
    prop.setProperty(&#34;InactivityTimeout&#34;, &#34;1800&#34;);    //  seconds
    prop.setProperty(&#34;AbandonedConnectionTimeout&#34;, &#34;900&#34;);  //  seconds
    prop.setProperty(&#34;MaxStatementsLimit&#34;, &#34;10&#34;);
    prop.setProperty(&#34;PropertyCheckInterval&#34;, &#34;60&#34;); // seconds
 
    System.out.println(&#34;Creating OraclePool&#34;);
    <span class="bold">OraclePool op = new OraclePool(szJdbcURL, szUser, szPasswd, prop,</span> 
               <span class="bold">&#34;OracleSemConnPool&#34;);</span>
    System.out.println(&#34;Done creating OraclePool&#34;);
 
    // grab an Oracle and do something with it
    System.out.println(&#34;Getting an Oracle from OraclePool&#34;);
    Oracle oracle = op.getOracle();
    System.out.println(&#34;Done&#34;);
    System.out.println(&#34;Is logical connection:&#34; +
        oracle.getConnection().isLogicalConnection());
    GraphOracleSem g = new GraphOracleSem(oracle, szModelName);
    g.add(Triple.create(Node.createURI(&#34;u:John&#34;), 
                        Node.createURI(&#34;u:parentOf&#34;), 
                        Node.createURI(&#34;u:Mary&#34;)));
    g.close();
    // return the Oracle back to the pool
    oracle.dispose();
    
    // grab another Oracle and do something else 
    System.out.println(&#34;Getting an Oracle from OraclePool&#34;);
    oracle = op.getOracle();
    System.out.println(&#34;Done&#34;);
    System.out.println(&#34;Is logical connection:&#34; +
        oracle.getConnection().isLogicalConnection());
    g = new GraphOracleSem(oracle, szModelName);
    g.add(Triple.create(Node.createURI(&#34;u:John&#34;), 
                        Node.createURI(&#34;u:parentOf&#34;), 
                        Node.createURI(&#34;u:Jack&#34;)));
    g.close();
    
    OracleUtils.dropSemanticModel(oracle, szModelName); 
    
    // return the Oracle object back to the pool
    oracle.dispose();
}
</pre></div>
</div>
<a id="RDFRM265"></a><a id="RDFRM264"></a>
<div class="props_rev_3"><a id="GUID-C22BE3A3-04CB-479D-96AD-221F25FC257D"></a>
<h3 id="RDFRM-GUID-C22BE3A3-04CB-479D-96AD-221F25FC257D" class="sect3"><span class="enumeration_section">7.11.3</span> Semantic Model PL/SQL Interfaces</h3>
<div>
<p>Several semantic PL/SQL subprograms are available through the support for Apache Jena. <a href="rdf-jena.htm#GUID-C22BE3A3-04CB-479D-96AD-221F25FC257D__CBBJFIFG" title="Pl/SQL Subprograms and Corresponding Jena Adaptor Java Class and Methods">Table 7-2</a> lists the subprograms and their corresponding Java class and methods.</p>
<div class="tblformal" id="GUID-C22BE3A3-04CB-479D-96AD-221F25FC257D__CBBJFIFG">
<p class="titleintable">Table 7-2 PL/SQL Subprograms and Corresponding RDF Semantic Graph support for Apache Jena Java Class and Methods</p>
<table class="cellalignment4510" title="PL/SQL Subprograms and Corresponding RDF Semantic Graph support for Apache Jena Java Class and Methods" summary="Pl/SQL Subprograms and Corresponding Jena Adaptor Java Class and Methods">
<thead>
<tr class="cellalignment4501">
<th class="cellalignment4532" id="d38717e3812">PL/SQL Subprogram</th>
<th class="cellalignment4533" id="d38717e3815">Corresponding Java Class and Methods</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment4501">
<td class="cellalignment4534" id="d38717e3820" headers="d38717e3812">
<p><a href="sem-apis-ref.htm#GUID-9A9A58D0-314B-4775-B55E-B939B6606AD8">SEM_APIS.DROP_SEM_MODEL</a></p>
</td>
<td class="cellalignment4535" headers="d38717e3820 d38717e3815">
<p>OracleUtils.dropSemanticModel</p>
</td>
</tr>
<tr class="cellalignment4501">
<td class="cellalignment4534" id="d38717e3829" headers="d38717e3812">
<p><a href="sem-apis-ref.htm#GUID-47CAA34C-3284-4665-BB9B-D65EBF07ED4E">SEM_APIS.MERGE_MODELS</a></p>
</td>
<td class="cellalignment4535" headers="d38717e3829 d38717e3815">
<p>OracleUtils.mergeModels</p>
</td>
</tr>
<tr class="cellalignment4501">
<td class="cellalignment4534" id="d38717e3838" headers="d38717e3812">
<p><a href="sem-apis-ref.htm#GUID-15186D10-9EDF-494F-B8CD-D5B77D9CC522">SEM_APIS.SWAP_NAMES</a></p>
</td>
<td class="cellalignment4535" headers="d38717e3838 d38717e3815">
<p>OracleUtils.swapNames</p>
</td>
</tr>
<tr class="cellalignment4501">
<td class="cellalignment4534" id="d38717e3847" headers="d38717e3812">
<p><a href="sem-apis-ref.htm#GUID-F5D87A18-2285-49B3-BB10-673DC61732F9">SEM_APIS.REMOVE_DUPLICATES</a></p>
</td>
<td class="cellalignment4535" headers="d38717e3847 d38717e3815">
<p>OracleUtils.removeDuplicates</p>
</td>
</tr>
<tr class="cellalignment4501">
<td class="cellalignment4534" id="d38717e3856" headers="d38717e3812">
<p><a href="sem-apis-ref.htm#GUID-D4E93775-083A-4625-BB37-CA169669C24A">SEM_APIS.RENAME_MODEL</a></p>
</td>
<td class="cellalignment4535" headers="d38717e3856 d38717e3815">
<p>OracleUtils.renameModels</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>For information about these PL/SQL utility subprograms, see the reference information in <a href="sem-apis-ref.htm#GUID-F42AB976-445A-4DCD-974C-3B9ED810E3D5">SEM_APIS Package Subprograms</a>. For information about the corresponding Java class and methods, see the RDF Semantic Graph support for Apache Jena API Reference documentation (Javadoc).</p>
</div>
</div>
<a id="RDFRM468"></a><a id="RDFRM266"></a>
<div class="props_rev_3"><a id="GUID-9D4EE34E-FD90-46ED-9E6B-4BC1CDF4DE55"></a>
<h3 id="RDFRM-GUID-9D4EE34E-FD90-46ED-9E6B-4BC1CDF4DE55" class="sect3"><span class="enumeration_section">7.11.4</span> Inference Options</h3>
<div>
<p>You can add options to entailment calls by using the following methods in the <code class="codeph">Attachment</code> class (in package <code class="codeph">oracle.spatial.rdf.client.jena</code>):</p>
<pre dir="ltr">public void setUseLocalInference(boolean useLocalInference)
public boolean getUseLocalInference()
 
public void setDefGraphForLocalInference(String defaultGraphName)
public String getDefGraphForLocalInference()
 
public String getInferenceOption()
public void setInferenceOption(String inferenceOption)
</pre>
<div class="example" id="GUID-9D4EE34E-FD90-46ED-9E6B-4BC1CDF4DE55__BGBDCIID">
<p class="titleinexample">Example 7-8 Specifying Inference Options</p>
<p>For more information about these methods, see the Javadoc.</p>
<p><a href="rdf-jena.htm#GUID-9D4EE34E-FD90-46ED-9E6B-4BC1CDF4DE55__BGBDCIID">Example 7-8</a> enables parallel inference (with a degree of 4) and RAW format when creating an entailment. The example also uses the <code class="codeph">performInference</code> method to create the entailment (comparable to using the <a href="sem-apis-ref.htm#GUID-BF52CEC0-1BD9-4908-9EF1-F001B0527257">SEM_APIS.CREATE_ENTAILMENT</a> PL/SQL procedure).</p>
<pre dir="ltr">import java.io.*;
import com.hp.hpl.jena.query.*;
import com.hp.hpl.jena.rdf.model.Model;
import com.hp.hpl.jena.util.FileManager;
import com.hp.hpl.jena.util.iterator.*;
import oracle.spatial.rdf.client.jena.*;
import com.hp.hpl.jena.graph.*;
import com.hp.hpl.jena.update.*;
import com.hp.hpl.jena.sparql.core.DatasetImpl;
 
public class TestNewInference
{
  public static void main(String[] args) throws Exception
  {
    String szJdbcURL = args[0];
    String szUser    = args[1];
    String szPasswd  = args[2];
 
    PrintStream psOut = System.out;
 
    Oracle oracle = new Oracle(szJdbcURL, szUser, szPasswd);
    
    String szTBoxName = &#34;test_new_tbox&#34;;
    {
      // First construct a TBox and load a few axioms
      ModelOracleSem modelTBox = ModelOracleSem.createOracleSemModel(oracle, szTBoxName);
      String insertString =  
        &#34; PREFIX my:  &lt;http://my.com/&gt; &#34; +
        &#34; PREFIX rdfs:  &lt;http://www.w3.org/2000/01/rdf-schema#&gt; &#34; +
        &#34; INSERT DATA &#34;                                     +
        &#34; { my:C1  rdfs:subClassOf my:C2 .                &#34; +
        &#34;   my:C2  rdfs:subClassOf my:C3 .                &#34; +
        &#34;   my:C3  rdfs:subClassOf my:C4 .                &#34; +
        &#34; }   &#34;;
      UpdateAction.parseExecute(insertString,  modelTBox);
      modelTBox.close();
    }
 
    String szABoxName = &#34;test_new_abox&#34;;
    {
      // Construct an ABox and load a few quads
      ModelOracleSem modelABox = ModelOracleSem.createOracleSemModel(oracle, szABoxName);
      DatasetGraphOracleSem dataset = DatasetGraphOracleSem.createFrom(modelABox.getGraph());
      modelABox.close();
 
      String insertString =  
        &#34; PREFIX my:    &lt;http://my.com/&gt; &#34; +
        &#34; PREFIX rdf:   &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt; &#34; +
        &#34; INSERT DATA                                                 &#34; +
        &#34; { GRAPH my:G1 { my:I1  rdf:type my:C1 .                     &#34; +
        &#34;                 my:I2  rdf:type my:C2 .                     &#34; +
        &#34;               }                                             &#34; +
        &#34; };                                                          &#34; +
        &#34; INSERT DATA                                                 &#34; +
        &#34; { GRAPH my:G2 { my:J1  rdf:type my:C3 .                     &#34; +
        &#34;               }                                             &#34; +
        &#34; }    &#34;;
      UpdateAction.parseExecute(insertString,  dataset);
      dataset.close();
    }
 
 
    String[] attachedModels = new String[1];
    attachedModels[0] = szTBoxName;
 
    String[] attachedRBs = {&#34;OWL2RL&#34;};
 
    Attachment attachment = Attachment.createInstance(
        attachedModels, attachedRBs,
        InferenceMaintenanceMode.NO_UPDATE,
        QueryOptions.ALLOW_QUERY_INVALID);
 
    // We are going to run named graph based local inference
    attachment.setUseLocalInference(true);
 
    // Set the default graph (TBox)
    attachment.setDefGraphForLocalInference(szTBoxName);
 
    // Set the inference option to use parallel inference 
    // with a degree of 4, and RAW format.
    <span class="bold">attachment.setInferenceOption(&#34;DOP=4,RAW8=T&#34;);</span>
 
    GraphOracleSem graph = new GraphOracleSem(
        oracle, 
        szABoxName, 
        attachment
        );
    DatasetGraphOracleSem dsgos = DatasetGraphOracleSem.createFrom(graph);
    graph.close();
 
    // Invoke create_entailment PL/SQL API
    <span class="bold">dsgos.performInference();</span>
 
    psOut.println(&#34;TestNewInference: # of inferred graph &#34; + 
        Long.toString(dsgos.getInferredGraphSize()));
 
    String queryString = 
      &#34; SELECT ?g ?s ?p ?o WHERE {  GRAPH ?g {?s ?p ?o } } &#34; ;
 
    Query query = QueryFactory.create(queryString, Syntax.syntaxARQ);
    QueryExecution qexec = QueryExecutionFactory.create(
        query, DatasetImpl.wrap(dsgos));
    ResultSet results = qexec.execSelect();
 
    ResultSetFormatter.out(psOut, results);
 
    dsgos.close();
    oracle.dispose();
  }
}
</pre>
<p>The output of <a href="rdf-jena.htm#GUID-9D4EE34E-FD90-46ED-9E6B-4BC1CDF4DE55__BGBDCIID">Example 7-8</a> is as follows.</p>
<pre dir="ltr">TestNewInference: # of inferred graph 9
 
--------------------------------------------------------------------------------------------------------------------
| g                  | s                  | p                                                 | o                  |
====================================================================================================================
| &lt;http://my.com/G1&gt; | &lt;http://my.com/I2&gt; | &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; | &lt;http://my.com/C3&gt; |
| &lt;http://my.com/G1&gt; | &lt;http://my.com/I2&gt; | &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; | &lt;http://my.com/C2&gt; |
| &lt;http://my.com/G1&gt; | &lt;http://my.com/I2&gt; | &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; | &lt;http://my.com/C4&gt; |
| &lt;http://my.com/G1&gt; | &lt;http://my.com/I1&gt; | &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; | &lt;http://my.com/C3&gt; |
| &lt;http://my.com/G1&gt; | &lt;http://my.com/I1&gt; | &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; | &lt;http://my.com/C1&gt; |
| &lt;http://my.com/G1&gt; | &lt;http://my.com/I1&gt; | &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; | &lt;http://my.com/C2&gt; |
| &lt;http://my.com/G1&gt; | &lt;http://my.com/I1&gt; | &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; | &lt;http://my.com/C4&gt; |
| &lt;http://my.com/G2&gt; | &lt;http://my.com/J1&gt; | &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; | &lt;http://my.com/C3&gt; |
| &lt;http://my.com/G2&gt; | &lt;http://my.com/J1&gt; | &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; | &lt;http://my.com/C4&gt; |
--------------------------------------------------------------------------------------------------------------------
</pre>
<p>For information about using OWL inferencing, see <a href="owl-concepts.htm#GUID-30145814-CB5E-45ED-B220-677515F91AA9">Using OWL Inferencing</a>.</p>
</div>
<!-- class="example" --></div>
</div>
<a id="RDFRM267"></a>
<div class="props_rev_3"><a id="GUID-5DA9FC7D-DF28-43A0-826C-819D958A5724"></a>
<h3 id="RDFRM-GUID-5DA9FC7D-DF28-43A0-826C-819D958A5724" class="sect3"><span class="enumeration_section">7.11.5</span> PelletInfGraph Class Support Deprecated</h3>
<div>
<p>The support for the <code class="codeph">PelletInfGraph</code> class within the support for Apache Jena is deprecated. You should instead use the more optimized Oracle/Pellet integration through the PelletDb OWL 2 reasoner for Oracle Database.</p>
</div>
</div>
</div>
<a id="RDFRM269"></a><a id="RDFRM270"></a><a id="RDFRM271"></a><a id="RDFRM469"></a><a id="RDFRM268"></a>
<div class="props_rev_3"><a id="GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E"></a>
<h2 id="RDFRM-GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E" class="sect2"><span class="enumeration_section">7.12</span> Bulk Loading Using RDF Semantic Graph Support for Apache Jena</h2>
<div>
<p>To load thousands to hundreds of thousands of RDF/OWL data files into an Oracle database, you can use the <code class="codeph">prepareBulk</code> and <code class="codeph">completeBulk</code> methods in the <code class="codeph">OracleBulkUpdateHandler</code> Java class to simplify the task.</p>
<p>The <code class="codeph">addInBulk</code> method in the <code class="codeph">OracleBulkUpdateHandler</code> class can load triples of a graph or model into an Oracle database in bulk loading style. If the graph or model is a Jena in-memory graph or model, the operation is limited by the size of the physical memory. The <code class="codeph">prepareBulk</code> method bypasses the Jena in-memory graph or model and takes a direct input stream to an RDF data file, parses the data, and load the triples into an underlying staging table. If the staging table and an accompanying table for storing long literals do not already exist, they are created automatically.</p>
<p>The <code class="codeph">prepareBulk</code> method can be invoked multiple times to load multiple data files into the same underlying staging table. It can also be invoked concurrently, assuming the hardware system is balanced and there are multiple CPU cores and sufficient I/O capacity.</p>
<p>Once all the data files are processed by the <code class="codeph">prepareBulk</code> method, you can invoke <code class="codeph">completeBulk</code> to load all the data into the semantic network.</p>
<div class="example" id="GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E__BGBIAHIJ">
<p class="titleinexample">Example 7-9 Loading Data into the Staging Table (prepareBulk)</p>
<p><a href="rdf-jena.htm#GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E__BGBIAHIJ">Example 7-9</a> shows how to load all data files in directory <code class="codeph">dir_1</code> into the underlying staging table. Long literals are supported and will be stored in a separate table. The data files can be compressed using GZIP to save storage space, and the <code class="codeph">prepareBulk</code> method can detect automatically if a data file is compressed using GZIP or not.</p>
<pre dir="ltr">Oracle oracle = new Oracle(szJdbcURL, szUser, szPasswd);
GraphOracleSem graph = new GraphOracleSem(oracle, szModelName);
 
PrintStream psOut = System.out;

String dirname = &#34;dir_1&#34;;
File fileDir = new File(dirname);
String[] szAllFiles = fileDir.list();

// loop through all the files in a directory
for (int idx = 0; idx &lt; szAllFiles.length; idx++) {
  String szIndFileName = dirname + File.separator + szAllFiles[idx];
  psOut.println(&#34;process to [ID = &#34; + idx + &#34; ] file &#34; + szIndFileName);
  psOut.flush();
 
  try {
    InputStream is = new FileInputStream(szIndFileName);
    graph.getBulkUpdateHandler().prepareBulk(
        is,                    // input stream
        &#34;http://example.com&#34;,  // base URI
        &#34;RDF/XML&#34;,             // data file type: can be RDF/XML, N-TRIPLE, etc.
        &#34;SEMTS&#34;,               // tablespace
        null,                  // flags
        null,                  // listener
        null                   // staging table name.
        );
    is.close();
  }
  catch (Throwable t) {
    psOut.println(&#34;Hit exception &#34; + t.getMessage());
  }
}
 
graph.close();
oracle.dispose();
</pre>
<p>The code in <a href="rdf-jena.htm#GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E__BGBIAHIJ">Example 7-9</a>, starting from creating a new Oracle object and ending with disposing of the Oracle object, can be executed in parallel. Assume there is a quad-core CPU and enough I/O capacity on the database hardware system; you can divide up all the data files and save them into four separate directories: <code class="codeph">dir_1</code>, <code class="codeph">dir_2</code>, <code class="codeph">dir_3</code>, and <code class="codeph">dir_4</code>. Four Java threads of processes can be started to work on those directories separately and concurrently. (For more information, see <a href="rdf-jena.htm#GUID-143C26AB-2A65-4B6D-BE64-87A903D91ABD">Using prepareBulk in Parallel (Multithreaded) Mode</a>.)</p>
</div>
<!-- class="example" -->
<div class="example" id="GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E__BGBCCJJE">
<p class="titleinexample">Example 7-10 Loading Data from the Staging Table into the Semantic Network (completeBulk)</p>
<p>After all data files are processed, you can invoke, just once, the <code class="codeph">completeBulk</code> method to load the data from staging table into the semantic network, as shown in <a href="rdf-jena.htm#GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E__BGBCCJJE">Example 7-10</a>. Triples with long literals will be loaded also.</p>
<pre dir="ltr">graph.getBulkUpdateHandler().completeBulk(
  null,  // flags for invoking SEM_APIS.bulk_load_from_staging_table
  null   // staging table name
);
</pre>
<p>The <code class="codeph">prepareBulk</code> method can also take a Jena model as an input data source, in which case triples in that Jena model are loaded into the underlying staging table. For more information, see the Javadoc.</p>
</div>
<!-- class="example" -->
<div class="example" id="GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E__BGBEBAED">
<p class="titleinexample">Example 7-11 Using prepareBulk with RDFa</p>
<p><a id="d38717e4134" class="indexterm-anchor"></a><a id="d38717e4138" class="indexterm-anchor"></a>In addition to loading triples from Jena models and data files, the <code class="codeph">prepareBulk</code> method supports RDFa, as shown in <a href="rdf-jena.htm#GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E__BGBEBAED">Example 7-11</a>. (RDFa is explained in <a href="http://www.w3.org/TR/xhtml-rdfa-primer/" target="_blank"><code class="codeph">http://www.w3.org/TR/xhtml-rdfa-primer/</code></a>.)</p>
<pre dir="ltr">graph.getBulkUpdateHandler().prepareBulk(
  rdfaUrl,   // url to a web page using RDFa
  &#34;SEMTS&#34;,   // tablespace
  null,      // flags
  null,      // listener
  null       // staging table name
);
</pre>
<p>To parse RDFa, the relevant <code class="codeph">java-rdfa</code> libraries must be included in the classpath. No additional setup or API calls are required. (For information about java-rdfa, see <a href="http://www.rootdev.net/maven/projects/java-rdfa/" target="_blank"><code class="codeph">http://www.rootdev.net/maven/projects/java-rdfa/</code></a> and the other topics there under Project Information.)</p>
<p>Note that if the <code class="codeph">rdfaUrl</code> is located outside a firewall, you may need to set the following HTTP Proxy-related Java VM properties:</p>
<pre dir="ltr">-Dhttp.proxyPort=...
-Dhttp.proxyHost=...
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E__BGBFBJEF">
<p class="titleinexample">Example 7-12 Loading Quads into a DatasetGraph</p>
<p>The preceding examples in this section load triple data into a single graph. Loading quad data that may span across multiple named graphs (such as data in NQUADS format) requires the use of the <code class="codeph">DatasetGraphOracleSem</code> class. The <code class="codeph">DatasetGraphOracleSem</code> class does not use the <code class="codeph">BulkUpdateHandler</code> API, but does provide a similar <code class="codeph">prepareBulk</code> and <code class="codeph">completeBulk</code> interface, as shown in <a href="rdf-jena.htm#GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E__BGBFBJEF">Example 7-12</a>.</p>
<pre dir="ltr">Oracle oracle = new Oracle(szJdbcURL, szUser, szPasswd);
 
// Can only create DatasetGraphOracleSem from an existing GraphOracleSem
GraphOracleSem graph = new GraphOracleSem(oracle, szModelName);
DatasetGraphOracleSem dataset = DatasetGraphOracleSem.createFrom(graph);
 
// Don&#39;t need graph anymore, close it to free resources
graph.close();
 
try {
    InputStream is = new FileInputStream(szFileName);
    // load NQUADS file into a staging table. This file can be gzipp&#39;ed.
    dataset.prepareBulk(
        is,                // input stream
        &#34;http://my.base/&#34;, // base URI
        &#34;N-QUADS&#34;,         // data file type; can be &#34;TRIG&#34;
        &#34;SEMTS&#34;,           // tablespace
        null,              // flags
        null,              // listener
        null,              // staging table name
        false              // truncate staging table before load
    );
    // Load quads from staging table into the dataset
    dataset.completeBulk(
        null, // flags; can be &#34;PARSE PARALLEL_CREATE_INDEX PARALLEL=4 
              //                mbv_method=shadow&#34; on a quad core machine
        null  // staging table name
    );
} 
catch (Throwable t) {
    System.out.println(&#34;Hit exception &#34; + t.getMessage());
}
finally {
    dataset.close();
    oracle.dispose();
}
</pre></div>
<!-- class="example" --></div>
<a id="RDFRM471"></a><a id="RDFRM470"></a>
<div class="props_rev_3"><a id="GUID-143C26AB-2A65-4B6D-BE64-87A903D91ABD"></a>
<h3 id="RDFRM-GUID-143C26AB-2A65-4B6D-BE64-87A903D91ABD" class="sect3"><span class="enumeration_section">7.12.1</span> Using prepareBulk in Parallel (Multithreaded) Mode</h3>
<div>
<p><a href="rdf-jena.htm#GUID-1109AB37-AFD5-4172-B7E5-6F279782A22E__BGBIAHIJ">Example 7-9</a> provided a way to load, sequentially, a set of files under a file system directory to an Oracle Database table (staging table). <a href="rdf-jena.htm#GUID-143C26AB-2A65-4B6D-BE64-87A903D91ABD__BGBDJCHC">Example 7-13</a> loads, concurrently, a set of files to an Oracle table (staging table). The degree of parallelism is controlled by the input parameter <code class="codeph">iMaxThreads</code>.</p>
<p>On a balanced hardware setup with 4 or more CPU cores, setting <code class="codeph">iMaxThreads</code> to 8 (or 16) can improve significantly the speed of <code class="codeph">prepareBulk</code> operation when there are many data files to be processed.</p>
<div class="example" id="GUID-143C26AB-2A65-4B6D-BE64-87A903D91ABD__BGBDJCHC">
<p class="titleinexample">Example 7-13 Using prepareBulk with iMaxThreads</p>
<pre dir="ltr">public void testPrepareInParallel(String jdbcUrl, String user,
                       String password, String modelName,
                       String lang,
                       String tbs,
                       String dirname,
                       int iMaxThreads,
                       PrintStream psOut)
   throws SQLException, IOException,  InterruptedException
 {
   File dir = new File(dirname);
   File[] files = dir.listFiles();

   // create a set of physical Oracle connections and graph objects
   Oracle[] oracles = new Oracle[iMaxThreads];
   GraphOracleSem[] graphs = new GraphOracleSem[iMaxThreads];
   for (int idx = 0; idx &lt; iMaxThreads; idx++) {
     oracles[idx] = new Oracle(jdbcUrl, user, password);
     graphs[idx] = new GraphOracleSem(oracles[idx], modelName);
   }

   PrepareWorker[] workers = new PrepareWorker[iMaxThreads];
   Thread[] threads = new Thread[iMaxThreads];
   for (int idx = 0; idx &lt; iMaxThreads; idx++) {
     workers[idx] = new PrepareWorker(
         graphs[idx],
         files,
         idx,
         iMaxThreads,
         lang,
         tbs,
         psOut
         );
     threads[idx] = new Thread(workers[idx], workers[idx].getName());
     psOut.println(&#34;testPrepareInParallel: PrepareWorker &#34; + idx + &#34; running&#34;);
     threads[idx].start();
   }

   psOut.println(&#34;testPrepareInParallel: all threads started&#34;);

   for (int idx = 0; idx &lt; iMaxThreads; idx++) {
     threads[idx].join();
   }
   for (int idx = 0; idx &lt; iMaxThreads; idx++) {
     graphs[idx].close();
     oracles[idx].dispose();
   }
 }

 static class PrepareWorker implements Runnable
 {
   GraphOracleSem graph = null;
   int idx;
   int threads;
   File[] files = null;
   String lang = null;
   String tbs  = null;
   PrintStream psOut;

   public void run()
   {
     long lStartTime = System.currentTimeMillis();
     for (int idxFile = idx; idxFile &lt; files.length; idxFile += threads) {
       File file = files[idxFile];
       try {
         FileInputStream fis = new FileInputStream(file);
         graph.getBulkUpdateHandler().prepareBulk(
             fis,
             &#34;http://base.com/&#34;,
             lang,
             tbs,
             null,                   // flags
             new MyListener(psOut),  // listener
             null                    // table name
             );
         fis.close();
       }
       catch (Exception e) {
         psOut.println(&#34;PrepareWorker: thread [&#34;+getName()+&#34;] error &#34;+ e.getMessage());
       }
       psOut.println(&#34;PrepareWorker: thread [&#34;+getName()+&#34;] done to &#34;
           + idxFile + &#34;, file = &#34; + file.toString()
           + &#34; in (ms) &#34; + (System.currentTimeMillis() - lStartTime));
     }
   }

   public PrepareWorker(GraphOracleSem graph,
                        File[] files,
                        int idx,
                        int threads,
                        String lang,
                        String tbs,
                        PrintStream psOut)
   {
     this.graph   = graph;
     this.files   = files;
     this.psOut   = psOut;
     this.idx     = idx;
     this.threads = threads;
     this.files   = files;
     this.lang    = lang;
     this.tbs     = tbs ;
   }

   public String getName()
   {
     return &#34;PrepareWorker&#34; + idx;
   }
 } 
 
 static class MyListener implements StatusListener 
 {
   PrintStream m_ps = null;
   public MyListener(PrintStream ps) { m_ps = ps; }
   long lLastBatch = 0;

   public void statusChanged(long count)
   {
     if (count - lLastBatch &gt;= 10000) {
       m_ps.println(&#34;process to &#34; + Long.toString(count));
       lLastBatch = count;
     }
   }

   public int illegalStmtEncountered(Node graphNode, Triple triple, long count)
   {
     m_ps.println(&#34;hit illegal statement with object &#34; + triple.getObject().toString());
     return 0; // skip it
   }
 }
</pre></div>
<!-- class="example" --></div>
</div>
<a id="RDFRM473"></a><a id="RDFRM472"></a>
<div class="props_rev_3"><a id="GUID-3E030B40-C8C5-45B7-BA12-D925AAAF4D0B"></a>
<h3 id="RDFRM-GUID-3E030B40-C8C5-45B7-BA12-D925AAAF4D0B" class="sect3"><span class="enumeration_section">7.12.2</span> Handling Illegal Syntax During Data Loading</h3>
<div>
<p>You can skip illegal triples and quads when using <code class="codeph">prepareBulk</code>. This feature is useful if the source RDF data may contain syntax errors. In <a href="rdf-jena.htm#GUID-3E030B40-C8C5-45B7-BA12-D925AAAF4D0B__BGBHCIIA">Example 7-14</a>, a customized implementation of the <code class="codeph">StatusListener</code> interface (defined in package <code class="codeph">oracle.spatial.rdf.client.jena</code>) is passed as a parameter to prepareBulk. In this example, the <code class="codeph">illegalStmtEncountered</code> method prints the object field of the illegal triple, and returns 0 so that <code class="codeph">prepareBulk</code> can skip that illegal triple and move on.</p>
<div class="example" id="GUID-3E030B40-C8C5-45B7-BA12-D925AAAF4D0B__BGBHCIIA">
<p class="titleinexample">Example 7-14 Skipping Triples with Illegal Syntax</p>
<pre dir="ltr">....
 
Oracle oracle = new Oracle(jdbcUrl, user, password);
GraphOracleSem graph = new GraphOracleSem(oracle, modelName);
PrintStream psOut = System.err;
 
graph.getBulkUpdateHandler().prepareBulk(
  new FileInputStream(rdfDataFilename),
  &#34;http://base.com/&#34;,    // base 
  lang,                  // data format, can be &#34;N-TRIPLES&#34; &#34;RDF/XML&#34; ...
  tbs,                   // tablespace name
  null,                  // flags
  new MyListener(psOut), // call back to show progress and also process illegal triples/quads
  null,                  // tableName, if null use default names
  false                  // truncate existing staging tables
  );
 
 graph.close();
 oracle.dispose();
 .... 
 
 // A customized StatusListener interface implementation
  public class MyListener implements StatusListener
 {
   PrintStream m_ps = null;
   public MyListener(PrintStream ps) { m_ps = ps; }
 
   public void statusChanged(long count)
   {
     // m_ps.println(&#34;process to &#34; + Long.toString(count));
   }
 
  public int illegalStmtEncountered(Node graphNode, Triple triple, long count)
  {
    m_ps.println(&#34;hit illegal statement with object &#34; + triple.getObject().toString());
    return 0; // skip it
  }
 }
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<a id="RDFRM474"></a>
<div class="props_rev_3"><a id="GUID-7EF14C6C-9D85-4BE8-8F51-732822CA178E"></a>
<h2 id="RDFRM-GUID-7EF14C6C-9D85-4BE8-8F51-732822CA178E" class="sect2"><span class="enumeration_section">7.13</span> Automatic Variable Renaming</h2>
<div>
<p>Previously, variable names used in SPARQL queries were passed directly on to Oracle Database as a part of a SQL statement. If the variable names included a SQL or PL/SQL reserved keyword, the query failed to execute. For example, the following SPARQL query used to fail because the word date as a special meaning to the Oracle Database SQL processing engine.</p>
<pre dir="ltr">select ?date { :event  :happenedOn ?date }
</pre>
<p>Currently, this query does not fail, because a &#34;smart scan&#34; is performed and automatic replacement is done on certain reserved variable names (or variable names that are very long) before the query is sent to Oracle database for execution. The replacement is based on a list of reserved keywords that are stored in the following file embedded in <code class="codeph">sdordfclient.jar</code>:</p>
<pre dir="ltr">oracle/spatial/rdf/client/jena/oracle_sem_reserved_keywords.lst
</pre>
<p>This file contains over 100 entries, and you can edit the file to add entries if necessary.</p>
<p>The following are examples of SPARQL queries that use SQL or PL/SQL reserved keywords as variables, and that will succeed because of automatic variable renaming:</p>
<ul style="list-style-type: disc;">
<li>
<p>Query using <code class="codeph">SELECT</code> as a variable name:</p>
<pre dir="ltr">PREFIX foaf: &lt;http://xmlns.com/foaf/0.1/&gt;
select ?SELECT ?z
where
{    ?SELECT foaf:name ?y.
     optional {?SELECT foaf:knows ?z.}
}
</pre></li>
<li>
<p>Query using <code class="codeph">ARRAY</code> and <code class="codeph">DATE</code> as variable names:</p>
<pre dir="ltr">PREFIX x:    &lt;http://example.com#&gt;
construct {
    ?ARRAY x:date ?date .
}
where {
    ?ARRAY x:happenedOn ?date .
}
</pre></li>
</ul>
</div>
</div>
<a id="RDFRM475"></a>
<div class="props_rev_3"><a id="GUID-5A76E641-BF3D-435C-969E-17A61E775806"></a>
<h2 id="RDFRM-GUID-5A76E641-BF3D-435C-969E-17A61E775806" class="sect2"><span class="enumeration_section">7.14</span> JavaScript Object Notation (JSON) Format Support</h2>
<div>
<p>JavaScript Object Notation (JSON) format is supported for SPARQL query responses. JSON data format is simple, compact, and well suited for JavaScript programs.</p>
<p>For example, assume the following Java code snippet, which calls the <code class="codeph">ResultSetFormatter.outputAsJSON</code> method:</p>
<pre dir="ltr">Oracle oracle = new Oracle(jdbcUrl, user, password);
 
GraphOracleSem graph = new GraphOracleSem(oracle, modelName);
ModelOracleSem model = new ModelOracleSem(graph);
 
graph.add(new Triple(
                   Node.createURI(&#34;http://ds1&#34;),
                   Node.createURI(&#34;http://dp1&#34;),
                   Node.createURI(&#34;http://do1&#34;)
                   )
         );
 
graph.add(new Triple(
                   Node.createURI(&#34;http://ds2&#34;),
                   Node.createURI(&#34;http://dp2&#34;),
                   Node.createURI(&#34;http://do2&#34;)
                   )
         );
graph.commitTransaction();
 
Query q = QueryFactory.create(&#34;select ?s ?p ?o where {?s ?p ?o}&#34;,
                              Syntax.syntaxARQ);
QueryExecution qexec = QueryExecutionFactory.create(q, model);
 
ResultSet results = qexec.execSelect();
<span class="bold">ResultSetFormatter.outputAsJSON(System.out, results);</span>
</pre>
<p>The JSON output is as follows:</p>
<pre dir="ltr">{
  &#34;head&#34;: {
    &#34;vars&#34;: [ &#34;s&#34; , &#34;p&#34; , &#34;o&#34; ]
  } ,
  &#34;results&#34;: {
    &#34;bindings&#34;: [
      {
        &#34;s&#34;: { &#34;type&#34;: &#34;uri&#34; , &#34;value&#34;: &#34;http://ds1&#34; } ,
        &#34;p&#34;: { &#34;type&#34;: &#34;uri&#34; , &#34;value&#34;: &#34;http://dp1&#34; } ,
        &#34;o&#34;: { &#34;type&#34;: &#34;uri&#34; , &#34;value&#34;: &#34;http://do1&#34; }
      } ,
      {
        &#34;s&#34;: { &#34;type&#34;: &#34;uri&#34; , &#34;value&#34;: &#34;http://ds2&#34; } ,
        &#34;p&#34;: { &#34;type&#34;: &#34;uri&#34; , &#34;value&#34;: &#34;http://dp2&#34; } ,
        &#34;o&#34;: { &#34;type&#34;: &#34;uri&#34; , &#34;value&#34;: &#34;http://do2&#34; }
      }
    ]
  }
}
</pre>
<p>The preceding example can be changed as follows to query a remote SPARQL endpoint instead of directly against an Oracle database. (If the remote SPARQL endpoint is outside a firewall, then the HTTP Proxy probably needs to be set.)</p>
<pre dir="ltr">Query q = QueryFactory.create(&#34;select ?s ?p ?o where {?s ?p ?o}&#34;,
                              Syntax.syntaxARQ);
QueryExecution qe = QueryExecutionFactory.sparqlService(sparqlURL, q);
 
ResultSet results = qexec.execSelect();
ResultSetFormatter.outputAsJSON(System.out, results);
</pre>
<p>To extend the first example in this section to named graphs, the following code snippet adds two quads to the same Oracle model, executes a named graph-based SPARQL query, and serializes the query output into JSON format:</p>
<pre dir="ltr">DatasetGraphOracleSem dsgos = DatasetGraphOracleSem.createFrom(graph);
graph.close();
 
dsgos.add(new Quad(Node.createURI(&#34;http://g1&#34;),
                   Node.createURI(&#34;http://s1&#34;),
                   Node.createURI(&#34;http://p1&#34;),
                   Node.createURI(&#34;http://o1&#34;)
                   )
         );
dsgos.add(new Quad(Node.createURI(&#34;http://g2&#34;),
                   Node.createURI(&#34;http://s2&#34;),
                   Node.createURI(&#34;http://p2&#34;),
                   Node.createURI(&#34;http://o2&#34;)
                   )
         );
 
Query q1 = QueryFactory.create(
  &#34;select ?g ?s ?p ?o where { GRAPH ?g {?s ?p ?o} }&#34;);
 
QueryExecution qexec1 = QueryExecutionFactory.create(q1,
    DatasetImpl.wrap(dsgos));
 
ResultSet results1 = qexec1.execSelect();
<span class="bold">ResultSetFormatter.outputAsJSON(System.out, results1);</span>
 
dsgos.close();
oracle.dispose();
</pre>
<p>The JSON output is as follows:</p>
<pre dir="ltr">{
  &#34;head&#34;: {
    &#34;vars&#34;: [ &#34;g&#34; , &#34;s&#34; , &#34;p&#34; , &#34;o&#34; ]
  } ,
  &#34;results&#34;: {
    &#34;bindings&#34;: [
      {
        &#34;g&#34;: { &#34;type&#34;: &#34;uri&#34; , &#34;value&#34;: &#34;http://g1&#34; } ,
        &#34;s&#34;: { &#34;type&#34;: &#34;uri&#34; , &#34;value&#34;: &#34;http://s1&#34; } ,
        &#34;p&#34;: { &#34;type&#34;: &#34;uri&#34; , &#34;value&#34;: &#34;http://p1&#34; } ,
        &#34;o&#34;: { &#34;type&#34;: &#34;uri&#34; , &#34;value&#34;: &#34;http://o1&#34; }
      } ,
      {
        &#34;g&#34;: { &#34;type&#34;: &#34;uri&#34; , &#34;value&#34;: &#34;http://g2&#34; } ,
        &#34;s&#34;: { &#34;type&#34;: &#34;uri&#34; , &#34;value&#34;: &#34;http://s2&#34; } ,
        &#34;p&#34;: { &#34;type&#34;: &#34;uri&#34; , &#34;value&#34;: &#34;http://p2&#34; } ,
        &#34;o&#34;: { &#34;type&#34;: &#34;uri&#34; , &#34;value&#34;: &#34;http://o2&#34; }
      }
    ]
  }
}
</pre>
<p>You can also get a JSON response through HTTP against a Joseki-based SPARQL endpoint, as in the following example. Normally, when executing a SPARQL query against a SPARQL Web service endpoint, the <code class="codeph">Accept request-head</code> field is set to be <code class="codeph">application/sparql-results+xm</code>l. For JSON output format, replace the <code class="codeph">Accept request-head</code> field with <code class="codeph">application/sparql-results+json</code>.</p>
<pre dir="ltr">http://<span class="italic">hostname</span>:7001/joseki/oracle?query=&lt;URL_ENCODED_SPARQL_QUERY&gt;<span class="bold">&amp;output=json</span>
</pre></div>
</div>
<a id="RDFRM476"></a>
<div class="props_rev_3"><a id="GUID-78916DE5-15D7-4E6B-B8CA-23DF0D89423C"></a>
<h2 id="RDFRM-GUID-78916DE5-15D7-4E6B-B8CA-23DF0D89423C" class="sect2"><span class="enumeration_section">7.15</span> Other Recommendations and Guidelines</h2>
<div>
<p>This section contains various recommendations and other information related to SPARQL queries.</p>
</div>
<a id="RDFRM477"></a>
<div class="props_rev_3"><a id="GUID-E73236FF-6302-426F-8F93-F7A9E75A69AC"></a>
<h3 id="RDFRM-GUID-E73236FF-6302-426F-8F93-F7A9E75A69AC" class="sect3"><span class="enumeration_section">7.15.1</span> BOUND or !BOUND Instead of EXISTS or NOT EXISTS</h3>
<div>
<p>For better performance, use <code class="codeph">BOUND</code> or <code class="codeph">!BOUND</code> instead of <code class="codeph">EXISTS</code> or <code class="codeph">NOT EXISTS</code>.</p>
</div>
</div>
<a id="RDFRM478"></a>
<div class="props_rev_3"><a id="GUID-3224D3F5-C6FE-4B67-8E26-E9145C5A0E15"></a>
<h3 id="RDFRM-GUID-3224D3F5-C6FE-4B67-8E26-E9145C5A0E15" class="sect3"><span class="enumeration_section">7.15.2</span> SPARQL 1.1 SELECT Expressions</h3>
<div>
<p>You can use SPARQL 1.1 SELECT expressions without any significant performance overhead, even if the function is not currently supported within Oracle Database. Examples include the following:</p>
<pre dir="ltr">-- Query using MD5 and SHA1 functions
PREFIX foaf: &lt;http://xmlns.com/foaf/0.1/&gt;
PREFIX xsd:  &lt;http://www.w3.org/2001/XMLSchema#&gt;
PREFIX eg:   &lt;http://biometrics.example/ns#&gt;
SELECT ?name (md5(?name) as ?name_in_md5) (sha1(?email) as ?sha1) 
WHERE 
{ 
  ?x foaf:name  ?name ; eg:email ?email .
}

-- Query using CONCAT function
PREFIX foaf:   &lt;http://xmlns.com/foaf/0.1/&gt;
SELECT ( CONCAT(?G, &#34; &#34;, ?S) AS ?name )
WHERE  
{ 
  ?P foaf:givenName ?G ; foaf:surname ?S 
}
</pre></div>
</div>
<a id="RDFRM479"></a>
<div class="props_rev_3"><a id="GUID-BFF7D4AB-BE8C-4B1A-B057-5522917C9B50"></a>
<h3 id="RDFRM-GUID-BFF7D4AB-BE8C-4B1A-B057-5522917C9B50" class="sect3"><span class="enumeration_section">7.15.3</span> Syntax Involving Bnodes (Blank Nodes)</h3>
<div>
<p>Syntax involving bnodes can be used freely in query patterns. For example, the following bnode-related syntax is supported at the parser level, so each is equivalent to its full triple-query-pattern-based version.</p>
<pre dir="ltr">:x :q [ :p &#34;v&#34; ] .
 
(1 ?x 3 4) :p &#34;w&#34; .
 
(1 [:p :q] ( 2 ) ) .
</pre></div>
</div>
<a id="RDFRM480"></a>
<div class="props_rev_3"><a id="GUID-13FA5D35-7AD2-4DB8-A10E-120459C1761E"></a>
<h3 id="RDFRM-GUID-13FA5D35-7AD2-4DB8-A10E-120459C1761E" class="sect3"><span class="enumeration_section">7.15.4</span> Limit in the SERVICE Clause</h3>
<div>
<p>When writing a SPARQL 1.1 federated query, you can set a limit on returned rows in the subquery inside the SERVICE clause. This can effectively constrain the amount of data to be transported between the local repository and the remote SPARQL endpoint.</p>
<p>For example, the following query specifies <code class="codeph">limit 100</code> in the subquery in the SERVICE clause:</p>
<pre dir="ltr">PREFIX : &lt;http://example.com/&gt;
SELECT ?s ?o 
 WHERE 
     { 
       ?s :name &#34;CA&#34;  
       <span class="bold">SERVICE</span> &lt;http://REMOTE_SPARQL_ENDPOINT_HERE&gt;
          {
             select ?s  ?o 
                 {?s :info ?o} 
              <span class="bold">limit 100</span> 
           } 
     }
</pre></div>
</div>
<a id="RDFRM482"></a><a id="RDFRM483"></a><a id="RDFRM481"></a>
<div class="props_rev_3"><a id="GUID-84DF816D-B216-414E-BB47-A0068C7DCC04"></a>
<h3 id="RDFRM-GUID-84DF816D-B216-414E-BB47-A0068C7DCC04" class="sect3"><span class="enumeration_section">7.15.5</span> OracleGraphWrapperForOntModel Class for Better Performance</h3>
<div>
<p>The Jena <code class="codeph">OntModel</code> class lets you create, modify, and analyze an ontology stored in a Jena model. However, the <code class="codeph">OntModel</code> implementation is not optimized for semantic data stored in a database. This results in suboptimal performance when using <code class="codeph">OntModel</code> with an Oracle model. Therefore, the class <code class="codeph">OracleGraphWrapperForOntModel</code> has been created to alleviate this performance issue.</p>
<p>The <code class="codeph">OracleGraphWrapperForOntModel</code> class implements the Jena <code class="codeph">Graph</code> interface and represents a graph backed by an Oracle RDF/OWL model that is meant for use with the Jena <code class="codeph">OntModel</code> API. The <code class="codeph">OracleGraphWrapperForOntModel</code> class uses two semantic stores in a hybrid approach for persisting changes and responding to queries. Both semantic stores contain the same data, but one resides in memory while the other resides in the Oracle database.</p>
<p>When queried through <code class="codeph">OntModel</code>, the <code class="codeph">OracleGraphWrapperForOntModel</code> graph runs the queries against the in-memory store to improve performance. However, the <code class="codeph">OracleGraphWrapperForOntModel</code> class persists changes made through <code class="codeph">OntModel</code>, such as adding or removing classes, by applying changes to both stores.</p>
<p>Due to its hybrid approach, an <code class="codeph">OracleGraphWrapperForOntModel</code> graph requires that sufficient memory be allocated to the JVM to store a copy of the ontology in memory. In internal experiments, it was found that an ontology with approximately 3 million triples requires 6 or more GB of physical memory.</p>
<div class="example" id="GUID-84DF816D-B216-414E-BB47-A0068C7DCC04__BGBCIBHF">
<p class="titleinexample">Example 7-15 Using OntModel with Ontology Stored in Oracle Database</p>
<p><a href="rdf-jena.htm#GUID-84DF816D-B216-414E-BB47-A0068C7DCC04__BGBCIBHF">Example 7-15</a> shows how to use the <code class="codeph">OntModel</code> APIs with an existing ontology stored in an Oracle model.</p>
<pre dir="ltr">// Set up connection to Oracle semantic store and the Oracle model
// containing the ontology
Oracle oracle = new Oracle(szJdbcURL, szUser, szPasswd);
GraphOracleSem oracleGraph = new GraphOracleSem(oracle, szModelName);
 
// Create a new hybrid graph using the oracle graph to persist
// changes.  This method will copy all the data from the oracle graph
// into an in-memory graph, which may significantly increase JVM memory
// usage.
Graph hybridGraph = OracleGraphWrapperForOntModel.getInstance(oracleGraph);
 
// Build a model around the hybrid graph and wrap the model with Jena&#39;s
// OntModel
Model model = ModelFactory.createModelForGraph(hybridGraph);
OntModel ontModel = ModelFactory.createOntologyModel(ontModelSpec, model);
 
// Perform operations on the ontology
OntClass personClass = ontModel.createClass(&#34;&lt;http://someuri/person&gt;&#34;);
ontModel.createIndividual(personClass);
 
// Close resources (will also close oracleGraph)!
hybridGraph.close();
ontModel.close();
</pre>
<p>Note that any <code class="codeph">OntModel</code> object created using <code class="codeph">OracleGraphWrapperForOntModel</code> will not reflect changes made to the underlying Oracle model by another process, through a separate <code class="codeph">OntModel</code>, or through a separate Oracle graph referencing the same underlying model. All changes to an ontology should go through a single <code class="codeph">OntModel</code> object and its underlying <code class="codeph">OracleGraphWrapperForOntModel</code> graph until the model or graph have been closed.</p>
</div>
<!-- class="example" -->
<div class="example" id="GUID-84DF816D-B216-414E-BB47-A0068C7DCC04__BGBBFEHH">
<p class="titleinexample">Example 7-16 Using a Custom In-Memory Graph</p>
<p>If the default in-memory semantic store used by <code class="codeph">OracleGraphWrapperForOntModel</code> is not sufficient for an ontology and system, the class provides an interface for specifying a custom graph to use as the in-memory store. <a href="rdf-jena.htm#GUID-84DF816D-B216-414E-BB47-A0068C7DCC04__BGBBFEHH">Example 7-16</a> shows how to create an <code class="codeph">OracleGraphWrapperForOntModel</code> that uses a custom in-memory graph to answer queries from <code class="codeph">OntModel</code>.</p>
<pre dir="ltr">// Set up connection to Oracle semantic store and the Oracle model
// containing the ontology
Oracle oracle = new Oracle(szJdbcURL, szUser, szPasswd);
GraphOracleSem oracleGraph = new GraphOracleSem(oracle, szModelName);
 
// Create a custom in-memory graph to use instead of the default
// Jena in-memory graph for quickly answering OntModel queries.
// Note that this graph does not *need* to be in-memory, but in-memory
// is preferred.
GraphBase queryGraph = new CustomInMemoryGraphImpl();
 
// Create a new hybrid graph using the oracle graph to persist
// changes and the custom in-memory graph to answer queries. 
// Also set the degree of parallelism to use when copying data from
// the oracle graph to the querying graph.
int degreeOfParallelism = 4;
Graph hybridGraph = OracleGraphWrapperForOntModel.getInstance(oracleGraph, queryGraph, degreeOfParallelism);
 
// Build a model and wrap the model with Jena&#39;s OntModel
Model model = ModelFactory.createModelForGraph(hybridGraph);
OntModel ontModel = ModelFactory.createOntologyModel(ontModelSpec, model);
 
// Perform operations on the ontology
// ...
 
// Close resources (will close oracleGraph and queryGraph)!
hybridGraph.close();
ontModel.close();
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<a id="RDFRM272"></a>
<div class="props_rev_3"><a id="GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A"></a>
<h2 id="RDFRM-GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A" class="sect2"><span class="enumeration_section">7.16</span> Example Queries Using RDF Semantic Graph Support for Apache Jena</h2>
<div>
<p>This section includes example queries using the support for Apache Jena. Each example is self-contained: it typically creates a model, creates triples, performs a query that may involve inference, displays the result, and drops the model.</p>
<p>This section includes queries that do the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>Count asserted triples and asserted plus inferred triples in an example &#34;university&#34; ontology, both by referencing the ontology by a URL and by bulk loading the ontology from a local file</p>
</li>
<li>
<p>Run several SPARQL queries using a &#34;family&#34; ontology, including features such as LIMIT, OFFSET, TIMEOUT, DOP (degree of parallelism), ASK, DESCRIBE, CONSTRUCT, GRAPH, ALLOW_DUP (duplicate triples with multiple models), SPARUL (inserting data)</p>
</li>
<li>
<p>Use the ARQ built-in function</p>
</li>
<li>
<p>Use a SELECT cast query</p>
</li>
<li>
<p>Instantiate Oracle Database using OracleConnection</p>
</li>
<li>
<p>Use Oracle Database connection pooling</p>
</li>
</ul>
<p>To run a query, you must do the following:</p>
<ol>
<li>
<p>Include the code in a Java source file. The examples used in this section are supplied in files in the <code class="codeph">examples</code> directory of the support for Apache Jena download.</p>
</li>
<li>
<p>Compile the Java source file. For example:</p>
<pre dir="ltr">&gt; javac -classpath ../jar/&#39;*&#39; Test.java
</pre>
<div class="infobox-note" id="GUID-9F748C0E-437D-4EBD-80CF-BFA91F3CFE3A__GUID-2A9BF448-91E3-403D-B00A-61DBDA510A53">
<p class="notep1">Note:</p>
<p>The <code class="codeph">javac</code> and <code class="codeph">java</code> commands must each be on a single command line.</p>
</div>
</li>
<li>
<p>Run the compiled file. For example:</p>
<pre dir="ltr">&gt; java -classpath ./:../jar/&#39;*&#39;  Test jdbc:oracle:thin:@localhost:1521:orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1
</pre></li>
</ol>
</div>
<a id="RDFRM274"></a><a id="RDFRM273"></a>
<div class="props_rev_3"><a id="GUID-8A46A12A-0F46-4CFB-A3A2-1C7665BD05EF"></a>
<h3 id="RDFRM-GUID-8A46A12A-0F46-4CFB-A3A2-1C7665BD05EF" class="sect3"><span class="enumeration_section">7.16.1</span> Test.java: Query Family Relationships</h3>
<div>
<div class="example" id="GUID-8A46A12A-0F46-4CFB-A3A2-1C7665BD05EF__CBBHGFFA">
<p class="titleinexample">Example 7-17 Query Family Relationships</p>
<p><a href="rdf-jena.htm#GUID-8A46A12A-0F46-4CFB-A3A2-1C7665BD05EF__CBBHGFFA">Example 7-17</a> specifies that John is the father of Mary, and it selects and displays the subject and object in each <code class="codeph">fatherOf</code> relationship</p>
<pre dir="ltr">import oracle.spatial.rdf.client.jena.*;
import com.hp.hpl.jena.rdf.model.Model;
import com.hp.hpl.jena.graph.*;
import com.hp.hpl.jena.query.*;
public class Test {
 
  public static void main(String[] args) throws Exception
  {
    String szJdbcURL = args[0];
    String szUser    = args[1];
    String szPasswd  = args[2];
    String szModelName = args[3];
          
    Oracle oracle = new Oracle(szJdbcURL, szUser, szPasswd);
    Model model = ModelOracleSem.createOracleSemModel(
      oracle, szModelName);
 
    model.getGraph().add(Triple.create(
          Node.createURI(&#34;http://example.com/John&#34;),
          Node.createURI(&#34;http://example.com/fatherOf&#34;),
          Node.createURI(&#34;http://example.com/Mary&#34;)));
    Query query = QueryFactory.create(
        &#34;select ?f ?k WHERE {?f &lt;http://example.com/fatherOf&gt; ?k .}&#34;);
    QueryExecution qexec = QueryExecutionFactory.create(query, model);
    ResultSet results = qexec.execSelect();
    ResultSetFormatter.out(System.out, results, query);
    model.close();
    oracle.dispose();
  }
}
</pre>
<p>The following are the commands to compile and run <a href="rdf-jena.htm#GUID-8A46A12A-0F46-4CFB-A3A2-1C7665BD05EF__CBBHGFFA">Example 7-17</a>, as well as the expected output of the <code class="codeph">java</code> command.</p>
<pre dir="ltr">javac -classpath ../jar/&#39;*&#39; Test.java
java -classpath ./:../jar/&#39;*&#39;  Test jdbc:oracle:thin:@localhost:1521:orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1
 
---------------------------------------------------------
| f                         | k                         |
=========================================================
| &lt;http://example.com/John&gt; | &lt;http://example.com/Mary&gt; |
---------------------------------------------------------
</pre></div>
<!-- class="example" --></div>
</div>
<a id="RDFRM276"></a><a id="RDFRM275"></a>
<div class="props_rev_3"><a id="GUID-C736617D-BB68-4E5F-88D7-01D8521970FC"></a>
<h3 id="RDFRM-GUID-C736617D-BB68-4E5F-88D7-01D8521970FC" class="sect3"><span class="enumeration_section">7.16.2</span> Test6.java: Load OWL Ontology and Perform OWLPrime inference</h3>
<div>
<p><a href="rdf-jena.htm#GUID-C736617D-BB68-4E5F-88D7-01D8521970FC__CBBGDAED">Example 7-18</a> loads an OWL ontology and performs OWLPrime inference. Note that the OWL ontology is in RDF/XML format, and after it is loaded into Oracle it will be serialized out in N-TRIPLE form. The example also queries for the number of asserted and inferred triples.</p>
<p>The ontology in this example can be retrieved from <a href="http://swat.cse.lehigh.edu/onto/univ-bench.owl" target="_blank"><code class="codeph">http://swat.cse.lehigh.edu/onto/univ-bench.owl</code></a>, and it describes roles, resources, and relationships in a university environment.</p>
<div class="example" id="GUID-C736617D-BB68-4E5F-88D7-01D8521970FC__CBBGDAED">
<p class="titleinexample">Example 7-18 Load OWL Ontology and Perform OWLPrime inference</p>
<pre dir="ltr">import java.io.*;
import com.hp.hpl.jena.query.*;
import com.hp.hpl.jena.rdf.model.Model;
import com.hp.hpl.jena.util.FileManager;
import oracle.spatial.rdf.client.jena.*;
public class Test6 {
  public static void main(String[] args) throws Exception
  {
    String szJdbcURL = args[0];
    String szUser    = args[1];
    String szPasswd  = args[2];
    String szModelName = args[3];
    
    Oracle oracle = new Oracle(szJdbcURL, szUser, szPasswd);
    Model model = ModelOracleSem.createOracleSemModel(oracle, szModelName);
        
    // load UNIV ontology
    InputStream in = FileManager.get().open(&#34;./univ-bench.owl&#34; );
    model.read(in, null);
    OutputStream os = new FileOutputStream(&#34;./univ-bench.nt&#34;);
    model.write(os, &#34;N-TRIPLE&#34;);
    os.close();
 
    String queryString =
      &#34; SELECT ?subject ?prop ?object WHERE { ?subject ?prop ?object } &#34;;
 
    Query query = QueryFactory.create(queryString) ;
    QueryExecution qexec = QueryExecutionFactory.create(query, model) ;
 
    try {
      int iTriplesCount = 0;
      ResultSet results = qexec.execSelect() ;
      for ( ; results.hasNext() ; ) {
        QuerySolution soln = results.nextSolution() ;
        iTriplesCount++;
      }
      System.out.println(&#34;Asserted  triples count: &#34; + iTriplesCount);
    } 
    finally { 
      qexec.close() ; 
    }
    
    Attachment attachment = Attachment.createInstance(
        new String[] {}, &#34;OWLPRIME&#34;,
        InferenceMaintenanceMode.NO_UPDATE, QueryOptions.DEFAULT);
 
    GraphOracleSem graph = new GraphOracleSem(oracle, szModelName, attachment);
    graph.analyze();
    graph.performInference();
 
    query = QueryFactory.create(queryString) ;
    qexec = QueryExecutionFactory.create(query,new ModelOracleSem(graph)) ;
 
    try {
      int iTriplesCount = 0;
      ResultSet results = qexec.execSelect() ;
      for ( ; results.hasNext() ; ) {
        QuerySolution soln = results.nextSolution() ;
        iTriplesCount++;
      }
      System.out.println(&#34;Asserted + Infered triples count: &#34; + iTriplesCount);
    } 
    finally { 
      qexec.close() ; 
    }
    model.close();    
 
    OracleUtils.dropSemanticModel(oracle, szModelName);    
    oracle.dispose();
  }
}
</pre>
<p>The following are the commands to compile and run <a href="rdf-jena.htm#GUID-C736617D-BB68-4E5F-88D7-01D8521970FC__CBBGDAED">Example 7-18</a>, as well as the expected output of the <code class="codeph">java</code> command.</p>
<pre dir="ltr">javac -classpath ../jar/&#39;*&#39; Test6.java
java -classpath ./:../jar/&#39;*&#39;  Test6 jdbc:oracle:thin:@localhost:1521:orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1
Asserted  triples count: 293
Asserted + Infered triples count: 340
</pre>
<p>Note that this output reflects an older version of the LUBM ontology. The latest version of the ontology has more triples.</p>
</div>
<!-- class="example" --></div>
</div>
<a id="RDFRM278"></a><a id="RDFRM277"></a>
<div class="props_rev_3"><a id="GUID-94180C4E-ED1F-4C18-86C7-54F9655975F5"></a>
<h3 id="RDFRM-GUID-94180C4E-ED1F-4C18-86C7-54F9655975F5" class="sect3"><span class="enumeration_section">7.16.3</span> Test7.java: Bulk Load OWL Ontology and Perform OWLPrime inference</h3>
<div>
<p><a href="rdf-jena.htm#GUID-94180C4E-ED1F-4C18-86C7-54F9655975F5__CBBFBCDB">Example 7-19</a> loads the same OWL ontology as in <a href="rdf-jena.htm#GUID-C736617D-BB68-4E5F-88D7-01D8521970FC">Test6.java: Load OWL Ontology and Perform OWLPrime inference</a>, but stored in a local file using Bulk Loader. Ontologies can also be loaded using an incremental and batch loader; these two methods are also listed in the example for completeness.</p>
<div class="example" id="GUID-94180C4E-ED1F-4C18-86C7-54F9655975F5__CBBFBCDB">
<p class="titleinexample">Example 7-19 Bulk Load OWL Ontology and Perform OWLPrime inference</p>
<pre dir="ltr">import java.io.*;
import com.hp.hpl.jena.query.*;
import com.hp.hpl.jena.graph.*;
import com.hp.hpl.jena.rdf.model.*;
import com.hp.hpl.jena.util.*;
import oracle.spatial.rdf.client.jena.*;
 
public class Test7 
{
  public static void main(String[] args) throws Exception
  {
    String szJdbcURL = args[0];
    String szUser    = args[1];
    String szPasswd  = args[2];
    String szModelName = args[3];
    // in memory Jena Model
    Model model = ModelFactory.createDefaultModel();
    InputStream is = FileManager.get().open(&#34;./univ-bench.owl&#34;);
    model.read(is, &#34;&#34;, &#34;RDF/XML&#34;);
    is.close();
 
    Oracle oracle = new Oracle(szJdbcURL, szUser, szPasswd);
    ModelOracleSem modelDest = ModelOracleSem.createOracleSemModel(oracle, 
szModelName);
 
    GraphOracleSem g = modelDest.getGraph();
    g.dropApplicationTableIndex();
 
    int method = 2; // try bulk loader
    String tbs = &#34;SYSAUX&#34;; // can be customized
    if (method == 0) {
      System.out.println(&#34;start incremental&#34;);
      modelDest.add(model);
      System.out.println(&#34;end size &#34; + modelDest.size());
    }
    else if (method == 1) {
      System.out.println(&#34;start batch load&#34;);
      g.getBulkUpdateHandler().addInBatch(
          GraphUtil.findAll(model.getGraph()), tbs);
      System.out.println(&#34;end size &#34; + modelDest.size());
    }
    else {
      System.out.println(&#34;start bulk load&#34;);
      g.getBulkUpdateHandler().addInBulk(
          GraphUtil.findAll(model.getGraph()), tbs);
      System.out.println(&#34;end size &#34; + modelDest.size());
    }
    g.rebuildApplicationTableIndex();
 
    long lCount = g.getCount(Triple.ANY);
    System.out.println(&#34;Asserted  triples count: &#34; + lCount);
    model.close();    
    OracleUtils.dropSemanticModel(oracle, szModelName);
    oracle.dispose();
  }
}
</pre>
<p>The following are the commands to compile and run <a href="rdf-jena.htm#GUID-94180C4E-ED1F-4C18-86C7-54F9655975F5__CBBFBCDB">Example 7-19</a>, as well as the expected output of the <code class="codeph">java</code> command.</p>
<pre dir="ltr">javac -classpath ../jar/&#39;*&#39; Test7.java
java -classpath ./:../jar/&#39;*&#39;  Test7 jdbc:oracle:thin:@localhost:1521:orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1
start bulk load
end size 293
Asserted  triples count: 293
</pre>
<p>Note that this output reflects an older version of the LUBM ontology. The latest version of the ontology has more triples.</p>
</div>
<!-- class="example" --></div>
</div>
<a id="RDFRM280"></a><a id="RDFRM279"></a>
<div class="props_rev_3"><a id="GUID-74FAF9E7-2A45-4C07-A9C1-C4E074C9207A"></a>
<h3 id="RDFRM-GUID-74FAF9E7-2A45-4C07-A9C1-C4E074C9207A" class="sect3"><span class="enumeration_section">7.16.4</span> Test8.java: SPARQL OPTIONAL Query</h3>
<div>
<p><a href="rdf-jena.htm#GUID-74FAF9E7-2A45-4C07-A9C1-C4E074C9207A__CBBDCIJJ">Example 7-20</a> shows a SPARQL OPTIONAL query. It inserts triples that postulate the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>John is a parent of Mary.</p>
</li>
<li>
<p>John is a parent of Jack.</p>
</li>
<li>
<p>Mary is a parent of Jill.</p>
</li>
</ul>
<p>It then finds parent-child relationships, optionally including any grandchild (gkid) relationships.</p>
<div class="example" id="GUID-74FAF9E7-2A45-4C07-A9C1-C4E074C9207A__CBBDCIJJ">
<p class="titleinexample">Example 7-20 SPARQL OPTIONAL Query</p>
<pre dir="ltr">import java.io.*;
import com.hp.hpl.jena.query.*;
import com.hp.hpl.jena.rdf.model.Model;
import com.hp.hpl.jena.util.FileManager;
import oracle.spatial.rdf.client.jena.*;
import com.hp.hpl.jena.graph.*;
 
public class Test8 
{
  public static void main(String[] args) throws Exception
  {
    String szJdbcURL = args[0];
    String szUser    = args[1];
    String szPasswd  = args[2];
    String szModelName = args[3];
    
    Oracle oracle = new Oracle(szJdbcURL, szUser, szPasswd);
    ModelOracleSem model = ModelOracleSem.createOracleSemModel(oracle, 
szModelName);
    GraphOracleSem g = model.getGraph();
 
    g.add(Triple.create(
          Node.createURI(&#34;u:John&#34;), Node.createURI(&#34;u:parentOf&#34;), 
Node.createURI(&#34;u:Mary&#34;)));
    g.add(Triple.create(
          Node.createURI(&#34;u:John&#34;), Node.createURI(&#34;u:parentOf&#34;), 
Node.createURI(&#34;u:Jack&#34;)));
    g.add(Triple.create(
          Node.createURI(&#34;u:Mary&#34;), Node.createURI(&#34;u:parentOf&#34;), 
Node.createURI(&#34;u:Jill&#34;)));
        
    String queryString =
  &#34; SELECT ?s ?o ?gkid &#34; +
  &#34; WHERE { ?s &lt;u:parentOf&gt; ?o . <span class="bold">OPTIONAL</span> {?o &lt;u:parentOf&gt; ?gkid }} &#34;;
 
    Query query = QueryFactory.create(queryString) ;
    QueryExecution qexec = QueryExecutionFactory.create(query, model) ;
 
    try {
      int iMatchCount = 0;
      ResultSet results = qexec.execSelect() ;
      ResultSetFormatter.out(System.out, results, query);
    } 
    finally { 
      qexec.close() ; 
    }
    model.close();    
 
    OracleUtils.dropSemanticModel(oracle, szModelName);
    oracle.dispose();
  }
}
</pre>
<p>The following are the commands to compile and run <a href="rdf-jena.htm#GUID-74FAF9E7-2A45-4C07-A9C1-C4E074C9207A__CBBDCIJJ">Example 7-20</a>, as well as the expected output of the <code class="codeph">java</code> command.</p>
<pre dir="ltr">javac -classpath ../jar/&#39;*&#39; Test8.java
java -classpath ./:../jar/&#39;*&#39;  Test8 jdbc:oracle:thin:@localhost:1521:orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1
----------------------------------
| s        | o        | gkid     |
==================================
| &lt;u:John&gt; | &lt;u:Mary&gt; | &lt;u:Jill&gt; |
| &lt;u:Mary&gt; | &lt;u:Jill&gt; |          |
| &lt;u:John&gt; | &lt;u:Jack&gt; |          |
---------------------------------- 
</pre></div>
<!-- class="example" --></div>
</div>
<a id="RDFRM282"></a><a id="RDFRM281"></a>
<div class="props_rev_3"><a id="GUID-BA93593D-EA10-4688-820B-B726B80FA665"></a>
<h3 id="RDFRM-GUID-BA93593D-EA10-4688-820B-B726B80FA665" class="sect3"><span class="enumeration_section">7.16.5</span> Test9.java: SPARQL Query with LIMIT and OFFSET</h3>
<div>
<p><a href="rdf-jena.htm#GUID-BA93593D-EA10-4688-820B-B726B80FA665__CBBJFJFB">Example 7-21</a> shows a SPARQL query with LIMIT and OFFSET. It inserts triples that postulate the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>John is a parent of Mary.</p>
</li>
<li>
<p>John is a parent of Jack.</p>
</li>
<li>
<p>Mary is a parent of Jill.</p>
</li>
</ul>
<p>It then finds one parent-child relationship (LIMIT 1), skipping the first two parent-child relationships encountered (OFFSET 2), and optionally includes any grandchild (gkid) relationships for the one found.</p>
<div class="example" id="GUID-BA93593D-EA10-4688-820B-B726B80FA665__CBBJFJFB">
<p class="titleinexample">Example 7-21 SPARQL Query with LIMIT and OFFSET</p>
<pre dir="ltr">import java.io.*;
import com.hp.hpl.jena.query.*;
import com.hp.hpl.jena.rdf.model.Model;
import com.hp.hpl.jena.util.FileManager;
import oracle.spatial.rdf.client.jena.*;
import com.hp.hpl.jena.graph.*;
public class Test9 
{
  public static void main(String[] args) throws Exception
  {
    String szJdbcURL = args[0];
    String szUser    = args[1];
    String szPasswd  = args[2];
    String szModelName = args[3];
    
    Oracle oracle = new Oracle(szJdbcURL, szUser, szPasswd);
    ModelOracleSem model = ModelOracleSem.createOracleSemModel(oracle, 
szModelName);
    GraphOracleSem g = model.getGraph();
 
    g.add(Triple.create(Node.createURI(&#34;u:John&#34;), Node.createURI(&#34;u:parentOf&#34;),
                    Node.createURI(&#34;u:Mary&#34;)));
    g.add(Triple.create(Node.createURI(&#34;u:John&#34;), Node.createURI(&#34;u:parentOf&#34;),
                    Node.createURI(&#34;u:Jack&#34;)));
    g.add(Triple.create(Node.createURI(&#34;u:Mary&#34;), Node.createURI(&#34;u:parentOf&#34;),              
                    Node.createURI(&#34;u:Jill&#34;)));
        
    String queryString =
      &#34; SELECT ?s ?o ?gkid &#34; +
      &#34; WHERE { ?s &lt;u:parentOf&gt; ?o . <span class="bold">OPTIONAL</span> {?o &lt;u:parentOf&gt; ?gkid }} &#34; +
      &#34; <span class="bold">LIMIT 1 OFFSET 2</span>&#34;;
 
    Query query = QueryFactory.create(queryString) ;
    QueryExecution qexec = QueryExecutionFactory.create(query, model) ;
 
    int iMatchCount = 0;
    ResultSet results = qexec.execSelect() ;
    ResultSetFormatter.out(System.out, results, query);
    qexec.close() ; 
    model.close();    
 
    OracleUtils.dropSemanticModel(oracle, szModelName);
    oracle.dispose();
  }
}
</pre>
<p>The following are the commands to compile and run <a href="rdf-jena.htm#GUID-BA93593D-EA10-4688-820B-B726B80FA665__CBBJFJFB">Example 7-21</a>, as well as the expected output of the <code class="codeph">java</code> command.</p>
<pre dir="ltr">javac -classpath ../jar/&#39;*&#39; Test9.java
java -classpath ./:../jar/&#39;*&#39;  Test9 jdbc:oracle:thin:@localhost:1521:orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1
------------------------------
| s        | o        | gkid |
==============================
| &lt;u:John&gt; | &lt;u:Jack&gt; |      |
------------------------------ 
</pre></div>
<!-- class="example" --></div>
</div>
<a id="RDFRM284"></a><a id="RDFRM283"></a>
<div class="props_rev_3"><a id="GUID-FA8847E4-18A3-40D3-B62C-A5E3C10E3ECF"></a>
<h3 id="RDFRM-GUID-FA8847E4-18A3-40D3-B62C-A5E3C10E3ECF" class="sect3"><span class="enumeration_section">7.16.6</span> Test10.java: SPARQL Query with TIMEOUT and DOP</h3>
<div>
<p><a href="rdf-jena.htm#GUID-FA8847E4-18A3-40D3-B62C-A5E3C10E3ECF__CBBECFAE">Example 7-22</a> shows the SPARQL query from <a href="rdf-jena.htm#GUID-BA93593D-EA10-4688-820B-B726B80FA665">Test9.java: SPARQL Query with LIMIT and OFFSET</a> with additional features, including a timeout setting (TIMEOUT=1, in seconds) and parallel execution setting (DOP=4).</p>
<div class="example" id="GUID-FA8847E4-18A3-40D3-B62C-A5E3C10E3ECF__CBBECFAE">
<p class="titleinexample">Example 7-22 SPARQL Query with TIMEOUT and DOP</p>
<pre dir="ltr">import java.io.*;
import com.hp.hpl.jena.query.*;
import com.hp.hpl.jena.rdf.model.Model;
import com.hp.hpl.jena.util.FileManager;
import oracle.spatial.rdf.client.jena.*;
import com.hp.hpl.jena.graph.*;
 
public class Test10 {
  public static void main(String[] args) throws Exception  {
    String szJdbcURL = args[0];
    String szUser    = args[1];
    String szPasswd  = args[2];
    String szModelName = args[3];
    
    Oracle oracle = new Oracle(szJdbcURL, szUser, szPasswd);
    ModelOracleSem model = ModelOracleSem.createOracleSemModel(oracle, szModelName);
    GraphOracleSem g = model.getGraph();
 
    g.add(Triple.create(Node.createURI(&#34;u:John&#34;), Node.createURI(&#34;u:parentOf&#34;), 
                            Node.createURI(&#34;u:Mary&#34;)));
    g.add(Triple.create(Node.createURI(&#34;u:John&#34;), Node.createURI(&#34;u:parentOf&#34;), 
                        Node.createURI(&#34;u:Jack&#34;)));
    g.add(Triple.create(Node.createURI(&#34;u:Mary&#34;), Node.createURI(&#34;u:parentOf&#34;), 
                        Node.createURI(&#34;u:Jill&#34;)));
    String queryString =
        &#34; PREFIX ORACLE_SEM_FS_NS: &lt;http://oracle.com/semtech#<span class="bold">dop=4,timeout=1</span>&gt; &#34; 
      + &#34; SELECT ?s ?o ?gkid WHERE { ?s &lt;u:parentOf&gt; ?o . &#34; 
      + &#34; OPTIONAL {?o &lt;u:parentOf&gt; ?gkid }} &#34;
      + &#34; LIMIT 1 OFFSET 2&#34;;
 
    Query query = QueryFactory.create(queryString) ;
    QueryExecution qexec = QueryExecutionFactory.create(query, model) ;
 
    int iMatchCount = 0;
    ResultSet results = qexec.execSelect() ;
    ResultSetFormatter.out(System.out, results, query);
    qexec.close() ; 
    model.close();    
 
    OracleUtils.dropSemanticModel(oracle, szModelName);
    oracle.dispose();
  }
}
</pre>
<p>The following are the commands to compile and run <a href="rdf-jena.htm#GUID-FA8847E4-18A3-40D3-B62C-A5E3C10E3ECF__CBBECFAE">Example 7-22</a>, as well as the expected output of the <code class="codeph">java</code> command.</p>
<pre dir="ltr">javac -classpath ../jar/&#39;*&#39; Test10.java
java -classpath ./:../jar/&#39;*&#39;  Test10 jdbc:oracle:thin:@localhost:1521:orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1
------------------------------
| s        | o        | gkid |
==============================
| &lt;u:John&gt; | &lt;u:Jack&gt; |      |
------------------------------
</pre></div>
<!-- class="example" --></div>
</div>
<a id="RDFRM286"></a><a id="RDFRM285"></a>
<div class="props_rev_3"><a id="GUID-175B2596-AEC0-4E7D-A2E0-1F642062625C"></a>
<h3 id="RDFRM-GUID-175B2596-AEC0-4E7D-A2E0-1F642062625C" class="sect3"><span class="enumeration_section">7.16.7</span> Test11.java: Query Involving Named Graphs</h3>
<div>
<p><a href="rdf-jena.htm#GUID-175B2596-AEC0-4E7D-A2E0-1F642062625C__CBBDDEJG">Example 7-23</a> shows a query involving named graphs. It involves a default graph that has information about named graph URIs and their publishers. The query finds graph names, their publishers, and within each named graph finds the mailbox value using the <code class="codeph">foaf:mbox</code> predicate.</p>
<div class="example" id="GUID-175B2596-AEC0-4E7D-A2E0-1F642062625C__CBBDDEJG">
<p class="titleinexample">Example 7-23 Named Graph Based Query</p>
<pre dir="ltr">import java.io.*;
import com.hp.hpl.jena.graph.*;
import com.hp.hpl.jena.sparql.core.*;
import com.hp.hpl.jena.query.*;
import oracle.spatial.rdf.client.jena.*;
 
public class Test11
{
  public static void main(String[] args) throws Exception
  {
    String szJdbcURL = args[0];
    String szUser    = args[1];
    String szPasswd  = args[2];
    String szModelName = args[3];
    
    Oracle oracle = new Oracle(szJdbcURL, szUser, szPasswd);
    GraphOracleSem graph = new GraphOracleSem(oracle, szModelName);
    DatasetGraphOracleSem dataset = DatasetGraphOracleSem.createFrom(graph);
    
    // don&#39;t need the GraphOracleSem anymore, release resources
    graph.close();
    
    // add data to the default graph
    dataset.add(new Quad(
          Quad.defaultGraphIRI, // specifies default graph
          Node.createURI(&#34;http://example.org/bob&#34;),
          Node.createURI(&#34;http://purl.org/dc/elements/1.1/publisher&#34;),
          Node.createLiteral(&#34;Bob Hacker&#34;)));
    dataset.add(new Quad(
          Quad.defaultGraphIRI, // specifies default graph
          Node.createURI(&#34;http://example.org/alice&#34;),
          Node.createURI(&#34;http://purl.org/dc/elements/1.1/publisher&#34;),
          Node.createLiteral(&#34;alice Hacker&#34;)));
    
    // add data to the bob named graph
    dataset.add(new Quad(
          Node.createURI(&#34;http://example.org/bob&#34;), // graph name
          Node.createURI(&#34;urn:bob&#34;),
          Node.createURI(&#34;http://xmlns.com/foaf/0.1/name&#34;),
          Node.createLiteral(&#34;Bob&#34;)));
    dataset.add(new Quad(
          Node.createURI(&#34;http://example.org/bob&#34;), // graph name
          Node.createURI(&#34;urn:bob&#34;),
          Node.createURI(&#34;http://xmlns.com/foaf/0.1/mbox&#34;),
          Node.createURI(&#34;mailto:bob@example&#34;)));
    
    // add data to the alice named graph
    dataset.add(new Quad(
          Node.createURI(&#34;http://example.org/alice&#34;), // graph name
          Node.createURI(&#34;urn:alice&#34;),
          Node.createURI(&#34;http://xmlns.com/foaf/0.1/name&#34;),
          Node.createLiteral(&#34;Alice&#34;)));
    dataset.add(new Quad(
          Node.createURI(&#34;http://example.org/alice&#34;), // graph name
          Node.createURI(&#34;urn:alice&#34;),
          Node.createURI(&#34;http://xmlns.com/foaf/0.1/mbox&#34;),
          Node.createURI(&#34;mailto:alice@example&#34;)));
    
    DataSource ds = DatasetFactory.create(dataset);
    
    String queryString =  
          &#34; PREFIX foaf: &lt;http://xmlns.com/foaf/0.1/&gt; &#34;
        + &#34; PREFIX dc: &lt;http://purl.org/dc/elements/1.1/&gt; &#34;
        + &#34; SELECT ?who ?graph ?mbox &#34;
        + &#34; FROM NAMED &lt;http://example.org/alice&gt; &#34;
        + &#34; FROM NAMED &lt;http://example.org/bob&gt; &#34;
        + &#34; WHERE &#34;
        + &#34; { &#34; 
        + &#34;    ?graph dc:publisher ?who . &#34;
        + &#34;    GRAPH ?graph { ?x foaf:mbox ?mbox } &#34;
        + &#34; } &#34;;
    
    Query query = QueryFactory.create(queryString);
    QueryExecution qexec = QueryExecutionFactory.create(query, ds);
    
    ResultSet results = qexec.execSelect();
    ResultSetFormatter.out(System.out, results, query);
    
    qexec.close();
    dataset.close();
    
    oracle.dispose();
  }
}
</pre>
<p>The following are the commands to compile and run <a href="rdf-jena.htm#GUID-175B2596-AEC0-4E7D-A2E0-1F642062625C__CBBDDEJG">Example 7-23</a>, as well as the expected output of the <code class="codeph">java</code> command.</p>
<pre dir="ltr">javac -classpath ./:./jena-2.6.4.jar:./sdordfclient.jar:./ojdbc6.jar:./slf4j-api-1.5.8.jar:./slf4j-log4j12-1.5.8.jar:./arq-2.8.8.jar:./xercesImpl-2.7.1.jar Test11.java
java -classpath ./:../jar/&#39;*&#39;  Test11 jdbc:oracle:thin:@localhost:1521:orcl scott &lt;password-for-scott&gt; M1
------------------------------------------------------------------------
| who            | graph                      | mbox                   |
========================================================================
| &#34;alice Hacker&#34; | &lt;http://example.org/alice&gt; | &lt;mailto:alice@example&gt; |
| &#34;Bob Hacker&#34;   | &lt;http://example.org/bob&gt;   | &lt;mailto:bob@example&gt;   |
------------------------------------------------------------------------ 
</pre></div>
<!-- class="example" --></div>
</div>
<a id="RDFRM288"></a><a id="RDFRM287"></a>
<div class="props_rev_3"><a id="GUID-AEAC5A2F-BBEF-4778-8ABF-E951DB4FB8C4"></a>
<h3 id="RDFRM-GUID-AEAC5A2F-BBEF-4778-8ABF-E951DB4FB8C4" class="sect3"><span class="enumeration_section">7.16.8</span> Test12.java: SPARQL ASK Query</h3>
<div>
<p><a href="rdf-jena.htm#GUID-AEAC5A2F-BBEF-4778-8ABF-E951DB4FB8C4__CBBCFIAJ">Example 7-24</a> shows a SPARQL ASK query. It inserts a triple that postulates that John is a parent of Mary. It then finds whether John is a parent of Mary.</p>
<div class="example" id="GUID-AEAC5A2F-BBEF-4778-8ABF-E951DB4FB8C4__CBBCFIAJ">
<p class="titleinexample">Example 7-24 SPARQL ASK Query</p>
<pre dir="ltr">import java.io.*;
import com.hp.hpl.jena.query.*;
import com.hp.hpl.jena.rdf.model.Model;
import com.hp.hpl.jena.util.FileManager;
import oracle.spatial.rdf.client.jena.*;
import com.hp.hpl.jena.graph.*;
public class Test12
{
  public static void main(String[] args) throws Exception
  {
    String szJdbcURL = args[0];
    String szUser    = args[1];
    String szPasswd  = args[2];
    String szModelName = args[3];
    
    Oracle oracle = new Oracle(szJdbcURL, szUser, szPasswd);
    ModelOracleSem model = ModelOracleSem.createOracleSemModel(oracle, 
          szModelName);
    GraphOracleSem g = model.getGraph();
 
    g.add(Triple.create(Node.createURI(&#34;u:John&#34;), Node.createURI(&#34;u:parentOf&#34;), 
                        Node.createURI(&#34;u:Mary&#34;)));
    String queryString = &#34; <span class="bold">ASK</span> { &lt;u:John&gt; &lt;u:parentOf&gt; &lt;u:Mary&gt; } &#34;;
 
    Query query = QueryFactory.create(queryString) ;
    QueryExecution qexec = QueryExecutionFactory.create(query, model) ;
    boolean b = qexec.execAsk();
    System.out.println(&#34;ask result = &#34; + ((b)?&#34;TRUE&#34;:&#34;FALSE&#34;));
    qexec.close() ; 
    
    model.close();    
    OracleUtils.dropSemanticModel(oracle, szModelName);
    oracle.dispose();
  }
}
</pre>
<p>The following are the commands to compile and run <a href="rdf-jena.htm#GUID-AEAC5A2F-BBEF-4778-8ABF-E951DB4FB8C4__CBBCFIAJ">Example 7-24</a>, as well as the expected output of the <code class="codeph">java</code> command.</p>
<pre dir="ltr">javac -classpath ../jar/&#39;*&#39; Test12.java
java -classpath ./:../jar/&#39;*&#39;  Test12 jdbc:oracle:thin:@localhost:1521:orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1
ask result = TRUE
</pre></div>
<!-- class="example" --></div>
</div>
<a id="RDFRM290"></a><a id="RDFRM289"></a>
<div class="props_rev_3"><a id="GUID-AF589F89-86C1-4286-9364-EDD05217C9D9"></a>
<h3 id="RDFRM-GUID-AF589F89-86C1-4286-9364-EDD05217C9D9" class="sect3"><span class="enumeration_section">7.16.9</span> Test13.java: SPARQL DESCRIBE Query</h3>
<div>
<p><a href="rdf-jena.htm#GUID-AF589F89-86C1-4286-9364-EDD05217C9D9__CBBCDBJH">Example 7-25</a> shows a SPARQL DESCRIBE query. It inserts triples that postulate the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>John is a parent of Mary.</p>
</li>
<li>
<p>John is a parent of Jack.</p>
</li>
<li>
<p>Amy is a parent of Jack.</p>
</li>
</ul>
<p>It then finds all relationships that involve any parents of Jack.</p>
<div class="example" id="GUID-AF589F89-86C1-4286-9364-EDD05217C9D9__CBBCDBJH">
<p class="titleinexample">Example 7-25 SPARQL DESCRIBE Query</p>
<pre dir="ltr">import java.io.*;
import com.hp.hpl.jena.query.*;
import com.hp.hpl.jena.rdf.model.Model;
import com.hp.hpl.jena.util.FileManager;
import oracle.spatial.rdf.client.jena.*;
import com.hp.hpl.jena.graph.*;
 
public class Test13
{
  public static void main(String[] args) throws Exception
  {
    String szJdbcURL = args[0];
    String szUser    = args[1];
    String szPasswd  = args[2];
    String szModelName = args[3];
    
    Oracle oracle = new Oracle(szJdbcURL, szUser, szPasswd);
    ModelOracleSem model = ModelOracleSem.createOracleSemModel(oracle, szModelName);
    GraphOracleSem g = model.getGraph();
 
    g.add(Triple.create(Node.createURI(&#34;u:John&#34;), Node.createURI(&#34;u:parentOf&#34;), 
                    Node.createURI(&#34;u:Mary&#34;)));
    g.add(Triple.create(Node.createURI(&#34;u:John&#34;), Node.createURI(&#34;u:parentOf&#34;), 
 Node.createURI(&#34;u:Jack&#34;)));
    g.add(Triple.create(Node.createURI(&#34;u:Amy&#34;), Node.createURI(&#34;u:parentOf&#34;), 
 Node.createURI(&#34;u:Jack&#34;)));
    String queryString = &#34; <span class="bold">DESCRIBE</span> ?x WHERE {?x &lt;u:parentOf&gt; &lt;u:Jack&gt;}&#34;;
 
    Query query = QueryFactory.create(queryString) ;
    QueryExecution qexec = QueryExecutionFactory.create(query, model) ;
    Model m = qexec.execDescribe();
    System.out.println(&#34;describe result = &#34; + m.toString());
 
    qexec.close() ; 
    model.close();    
    OracleUtils.dropSemanticModel(oracle, szModelName);
    oracle.dispose();
  }
}
</pre>
<p>The following are the commands to compile and run <a href="rdf-jena.htm#GUID-AF589F89-86C1-4286-9364-EDD05217C9D9__CBBCDBJH">Example 7-25</a>, as well as the expected output of the <code class="codeph">java</code> command.</p>
<pre dir="ltr">javac -classpath ../jar/&#39;*&#39; Test13.java
java -classpath ./:../jar/&#39;*&#39;  Test13 jdbc:oracle:thin:@localhost:1521:orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1
describe result = &lt;ModelCom   {u:Amy @u:parentOf u:Jack; 
     u:John @u:parentOf u:Jack; u:John @u:parentOf u:Mary} |  [u:Amy, u:parentOf, u:Jack] [u:John, u:parentOf,
       u:Jack] [u:John, u:parentOf, u:Mary]&gt;
</pre></div>
<!-- class="example" --></div>
</div>
<a id="RDFRM292"></a><a id="RDFRM291"></a>
<div class="props_rev_3"><a id="GUID-55F97EB6-141A-46DC-AF20-4DB69AA83B49"></a>
<h3 id="RDFRM-GUID-55F97EB6-141A-46DC-AF20-4DB69AA83B49" class="sect3"><span class="enumeration_section">7.16.10</span> Test14.java: SPARQL CONSTRUCT Query</h3>
<div>
<p><a href="rdf-jena.htm#GUID-55F97EB6-141A-46DC-AF20-4DB69AA83B49__CBBEAHCH">Example 7-26</a> shows a SPARQL CONSTRUCT query. It inserts triples that postulate the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>John is a parent of Mary.</p>
</li>
<li>
<p>John is a parent of Jack.</p>
</li>
<li>
<p>Amy is a parent of Jack.</p>
</li>
<li>
<p>Each parent loves all of his or her children.</p>
</li>
</ul>
<p>It then constructs an RDF graph with information about who loves whom.</p>
<div class="example" id="GUID-55F97EB6-141A-46DC-AF20-4DB69AA83B49__CBBEAHCH">
<p class="titleinexample">Example 7-26 SPARQL CONSTRUCT Query</p>
<pre dir="ltr">import java.io.*;
import com.hp.hpl.jena.query.*;
import com.hp.hpl.jena.rdf.model.Model;
import com.hp.hpl.jena.util.FileManager;
import oracle.spatial.rdf.client.jena.*;
import com.hp.hpl.jena.graph.*;
 
public class Test14
{
  public static void main(String[] args) throws Exception
  {
    String szJdbcURL = args[0];
    String szUser    = args[1];
    String szPasswd  = args[2];
    String szModelName = args[3];
    
    Oracle oracle = new Oracle(szJdbcURL, szUser, szPasswd);
    ModelOracleSem model = ModelOracleSem.createOracleSemModel(oracle, szModelName);
    GraphOracleSem g = model.getGraph();
 
    g.add(Triple.create(Node.createURI(&#34;u:John&#34;), Node.createURI(&#34;u:parentOf&#34;), 
 Node.createURI(&#34;u:Mary&#34;)));
    g.add(Triple.create(Node.createURI(&#34;u:John&#34;), Node.createURI(&#34;u:parentOf&#34;), 
 Node.createURI(&#34;u:Jack&#34;)));
    g.add(Triple.create(Node.createURI(&#34;u:Amy&#34;), Node.createURI(&#34;u:parentOf&#34;), 
 Node.createURI(&#34;u:Jack&#34;)));
    String queryString = &#34; <span class="bold">CONSTRUCT</span> { ?s &lt;u:loves&gt; ?o } WHERE {?s &lt;u:parentOf&gt; ?o}&#34;;
 
    Query query = QueryFactory.create(queryString) ;
    QueryExecution qexec = QueryExecutionFactory.create(query, model) ;
    Model m = qexec.execConstruct();
    System.out.println(&#34;Construct result = &#34; + m.toString());
 
    qexec.close() ; 
    model.close();    
    OracleUtils.dropSemanticModel(oracle, szModelName);
    oracle.dispose();
  }
}
</pre>
<p>The following are the commands to compile and run <a href="rdf-jena.htm#GUID-55F97EB6-141A-46DC-AF20-4DB69AA83B49__CBBEAHCH">Example 7-26</a>, as well as the expected output of the <code class="codeph">java</code> command.</p>
<pre dir="ltr">javac -classpath ../jar/&#39;*&#39; Test14.java
java -classpath ./:../jar/&#39;*&#39;  Test14 jdbc:oracle:thin:@localhost:1521:orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1
Construct result = &lt;ModelCom   {u:Amy @u:loves u:Jack; 
  u:John @u:loves u:Jack; u:John @u:loves u:Mary} |  [u:Amy, u:loves, u:Jack] [u:John, u:loves,
    u:Jack] [u:John, u:loves, u:Mary]&gt;
</pre></div>
<!-- class="example" --></div>
</div>
<a id="RDFRM294"></a><a id="RDFRM293"></a>
<div class="props_rev_3"><a id="GUID-7B164F3A-550F-4363-B3F4-27EE2A43D6B6"></a>
<h3 id="RDFRM-GUID-7B164F3A-550F-4363-B3F4-27EE2A43D6B6" class="sect3"><span class="enumeration_section">7.16.11</span> Test15.java: Query Multiple Models and Specify &#34;Allow Duplicates&#34;</h3>
<div>
<p><a href="rdf-jena.htm#GUID-7B164F3A-550F-4363-B3F4-27EE2A43D6B6__CBBDECHB">Example 7-27</a> queries multiple models and uses the &#34;allow duplicates&#34; option. It inserts triples that postulate the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>John is a parent of Jack (in Model 1).</p>
</li>
<li>
<p>Mary is a parent of Jack (in Model 2).</p>
</li>
<li>
<p>Each parent loves all of his or her children.</p>
</li>
</ul>
<p>It then finds out who loves whom. It searches both models and allows for the possibility of duplicate triples in the models (although there are no duplicates in this example).</p>
<div class="example" id="GUID-7B164F3A-550F-4363-B3F4-27EE2A43D6B6__CBBDECHB">
<p class="titleinexample">Example 7-27 Query Multiple Models and Specify &#34;Allow Duplicates&#34;</p>
<pre dir="ltr">import java.io.*;
import com.hp.hpl.jena.query.*;
import com.hp.hpl.jena.rdf.model.Model;
import com.hp.hpl.jena.util.FileManager;
import oracle.spatial.rdf.client.jena.*;
import com.hp.hpl.jena.graph.*;
 
public class Test15
{
  public static void main(String[] args) throws Exception
  {
    String szJdbcURL = args[0];
    String szUser    = args[1];
    String szPasswd  = args[2];
    String szModelName1 = args[3];
    String szModelName2 = args[4];
    
    Oracle oracle = new Oracle(szJdbcURL, szUser, szPasswd);
    ModelOracleSem model1 = ModelOracleSem.createOracleSemModel(oracle, szModelName1);
    model1.getGraph().add(Triple.create(Node.createURI(&#34;u:John&#34;), 
                     Node.createURI(&#34;u:parentOf&#34;), Node.createURI(&#34;u:Jack&#34;)));
    model1.close();
 
    ModelOracleSem model2 = ModelOracleSem.createOracleSemModel(oracle, szModelName2);
    model2.getGraph().add(Triple.create(Node.createURI(&#34;u:Mary&#34;), 
                     Node.createURI(&#34;u:parentOf&#34;), Node.createURI(&#34;u:Jack&#34;)));
    model2.close();
 
    String[] modelNamesList = {szModelName2};
    String[] rulebasesList  = {};
    Attachment attachment = Attachment.createInstance(modelNamesList, rulebasesList, 
              InferenceMaintenanceMode.NO_UPDATE,
              <span class="bold">QueryOptions.ALLOW_QUERY_VALID_AND_DUP</span>);
 
    GraphOracleSem graph = new GraphOracleSem(oracle, szModelName1, attachment);
    ModelOracleSem model = new ModelOracleSem(graph);
 
    String queryString = &#34; CONSTRUCT { ?s &lt;u:loves&gt; ?o } WHERE {?s &lt;u:parentOf&gt; ?o}&#34;;
    Query query = QueryFactory.create(queryString) ;
    QueryExecution qexec = QueryExecutionFactory.create(query, model) ;
    Model m = qexec.execConstruct();
    System.out.println(&#34;Construct result = &#34; + m.toString());
 
    qexec.close() ; 
    model.close();    
    OracleUtils.dropSemanticModel(oracle, szModelName1);
    OracleUtils.dropSemanticModel(oracle, szModelName2);
    oracle.dispose();
  }
}
</pre>
<p>The following are the commands to compile and run <a href="rdf-jena.htm#GUID-7B164F3A-550F-4363-B3F4-27EE2A43D6B6__CBBDECHB">Example 7-27</a>, as well as the expected output of the <code class="codeph">java</code> command.</p>
<pre dir="ltr">javac -classpath ../jar/&#39;*&#39; Test15.java
java -classpath ./:../jar/&#39;*&#39;  Test15 jdbc:oracle:thin:@localhost:1521:orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1 M2
Construct result = &lt;ModelCom   {u:Mary @u:loves u:Jack; u:John @u:loves u:Jack} |  [u:Mary, u:loves, u:Jack] [u:John, u:loves, u:Jack]&gt;
</pre></div>
<!-- class="example" --></div>
</div>
<a id="RDFRM296"></a><a id="RDFRM295"></a>
<div class="props_rev_3"><a id="GUID-325FB548-0E9A-48A8-8DDA-71B37497938A"></a>
<h3 id="RDFRM-GUID-325FB548-0E9A-48A8-8DDA-71B37497938A" class="sect3"><span class="enumeration_section">7.16.12</span> Test16.java: SPARQL Update</h3>
<div>
<p><a href="rdf-jena.htm#GUID-325FB548-0E9A-48A8-8DDA-71B37497938A__CBBFJAHG">Example 7-28</a> inserts two triples into a model.</p>
<div class="example" id="GUID-325FB548-0E9A-48A8-8DDA-71B37497938A__CBBFJAHG">
<p class="titleinexample">Example 7-28 SPARQL Update</p>
<pre dir="ltr">import java.io.*;
import com.hp.hpl.jena.query.*;
import com.hp.hpl.jena.rdf.model.Model;
import com.hp.hpl.jena.util.FileManager;
import com.hp.hpl.jena.util.iterator.*;
import oracle.spatial.rdf.client.jena.*;
import com.hp.hpl.jena.graph.*;
import com.hp.hpl.jena.update.*;
 
public class Test16
{
  public static void main(String[] args) throws Exception
  {
    String szJdbcURL = args[0];
    String szUser    = args[1];
    String szPasswd  = args[2];
    String szModelName = args[3];
    
    Oracle oracle = new Oracle(szJdbcURL, szUser, szPasswd);
    ModelOracleSem model = ModelOracleSem.createOracleSemModel(oracle, szModelName);
    GraphOracleSem g = model.getGraph();
    String insertString =  
      &#34; PREFIX dc: &lt;http://purl.org/dc/elements/1.1/&gt; &#34;         + 
      &#34; INSERT DATA &#34;                                           +
      &#34; { &lt;http://example/book3&gt; dc:title    \&#34;A new book\&#34; ; &#34; +
      &#34;                         dc:creator  \&#34;A.N.Other\&#34; . &#34;   + 
      &#34; }   &#34;;
 
    UpdateAction.parseExecute(insertString,  model);
    ExtendedIterator ei = GraphUtil.findAll(g);
    while (ei.hasNext()) {
      System.out.println(&#34;Triple &#34; + ei.next().toString());
    }
    model.close();    
    OracleUtils.dropSemanticModel(oracle, szModelName);
    oracle.dispose();
  }
}
</pre>
<p>The following are the commands to compile and run <a href="rdf-jena.htm#GUID-325FB548-0E9A-48A8-8DDA-71B37497938A__CBBFJAHG">Example 7-28</a>, as well as the expected output of the <code class="codeph">java</code> command.</p>
<pre dir="ltr">javac -classpath ../jar/&#39;*&#39; Test16.java
java -classpath ./:../jar/&#39;*&#39;  Test16 jdbc:oracle:thin:@localhost:1521:orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1
Triple http://example/book3 @dc:title &#34;A new book&#34;
Triple http://example/book3 @dc:creator &#34;A.N.Other&#34;
</pre></div>
<!-- class="example" --></div>
</div>
<a id="RDFRM298"></a><a id="RDFRM297"></a>
<div class="props_rev_3"><a id="GUID-13A02D52-426D-436C-90AF-73B1AB44FA0F"></a>
<h3 id="RDFRM-GUID-13A02D52-426D-436C-90AF-73B1AB44FA0F" class="sect3"><span class="enumeration_section">7.16.13</span> Test17.java: SPARQL Query with ARQ Built-In Functions</h3>
<div>
<p><a href="rdf-jena.htm#GUID-13A02D52-426D-436C-90AF-73B1AB44FA0F__CBBBFAHI">Example 7-29</a> inserts data about two books, and it displays the book titles in all uppercase characters and the length of each title string.</p>
<div class="example" id="GUID-13A02D52-426D-436C-90AF-73B1AB44FA0F__CBBBFAHI">
<p class="titleinexample">Example 7-29 SPARQL Query with ARQ Built-In Functions</p>
<pre dir="ltr">import java.io.*;
import com.hp.hpl.jena.query.*;
import com.hp.hpl.jena.rdf.model.Model;
import com.hp.hpl.jena.util.FileManager;
import com.hp.hpl.jena.util.iterator.*;
import oracle.spatial.rdf.client.jena.*;
import com.hp.hpl.jena.graph.*;
import com.hp.hpl.jena.update.*;
 
public class Test17 {
  public static void main(String[] args) throws Exception  {
    String szJdbcURL = args[0];
    String szUser    = args[1];
    String szPasswd  = args[2];
    String szModelName = args[3];
    
    Oracle oracle = new Oracle(szJdbcURL, szUser, szPasswd);
    ModelOracleSem model = ModelOracleSem.createOracleSemModel(oracle, szModelName);
    GraphOracleSem g = model.getGraph();
    String insertString =  
      &#34; PREFIX dc: &lt;http://purl.org/dc/elements/1.1/&gt; &#34;         + 
      &#34; INSERT DATA &#34;                                           +
      &#34; { &lt;http://example/book3&gt; dc:title    \&#34;A new book\&#34; ; &#34; +
      &#34;                         dc:creator  \&#34;A.N.Other\&#34; . &#34;   + 
      &#34;   &lt;http://example/book4&gt; dc:title    \&#34;Semantic Web Rocks\&#34; ; &#34; +
      &#34;                         dc:creator  \&#34;TB\&#34; . &#34;   + 
      &#34; }   &#34;;
 
    UpdateAction.parseExecute(insertString,  model);
    String queryString = &#34;PREFIX  dc:   &lt;http://purl.org/dc/elements/1.1/&gt; &#34; +
      &#34; PREFIX  fn: &lt;http://www.w3.org/2005/xpath-functions#&gt; &#34; + 
      &#34; SELECT ?subject (<span class="bold">fn:upper-case</span>(?object) as ?object1)  &#34; + 
      &#34;                 (<span class="bold">fn:string-length</span>(?object) as ?strlen) &#34; + 
      &#34; WHERE { ?subject dc:title ?object } &#34; 
      ;
    Query query = QueryFactory.create(queryString, Syntax.syntaxARQ);
    QueryExecution qexec = QueryExecutionFactory.create(query, model);
    ResultSet results = qexec.execSelect();
    ResultSetFormatter.out(System.out, results, query);
    model.close();    
    OracleUtils.dropSemanticModel(oracle, szModelName);
    oracle.dispose();
  }
}
</pre>
<p>The following are the commands to compile and run <a href="rdf-jena.htm#GUID-13A02D52-426D-436C-90AF-73B1AB44FA0F__CBBBFAHI">Example 7-29</a>, as well as the expected output of the <code class="codeph">java</code> command.</p>
<pre dir="ltr">javac -classpath ../jar/&#39;*&#39; Test17.java
java -classpath ./:../jar/&#39;*&#39;  Test17 jdbc:oracle:thin:@localhost:1521:orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1
----------------------------------------------------------
| subject                | object1              | strlen |
==========================================================
| &lt;http://example/book3&gt; | &#34;A NEW BOOK&#34;         | 10     |
| &lt;http://example/book4&gt; | &#34;SEMANTIC WEB ROCKS&#34; | 18     |
----------------------------------------------------------
</pre></div>
<!-- class="example" --></div>
</div>
<a id="RDFRM300"></a><a id="RDFRM299"></a>
<div class="props_rev_3"><a id="GUID-58FFA706-81FB-45E7-B6E1-61D6D43A054C"></a>
<h3 id="RDFRM-GUID-58FFA706-81FB-45E7-B6E1-61D6D43A054C" class="sect3"><span class="enumeration_section">7.16.14</span> Test18.java: SELECT Cast Query</h3>
<div>
<p><a href="rdf-jena.htm#GUID-58FFA706-81FB-45E7-B6E1-61D6D43A054C__CBBBBIJG">Example 7-30</a> &#34;converts&#34; two Fahrenheit temperatures (18.1 and 32.0) to Celsius temperatures.</p>
<div class="example" id="GUID-58FFA706-81FB-45E7-B6E1-61D6D43A054C__CBBBBIJG">
<p class="titleinexample">Example 7-30 SELECT Cast Query</p>
<pre dir="ltr">import java.io.*;
import com.hp.hpl.jena.query.*;
import com.hp.hpl.jena.rdf.model.Model;
import com.hp.hpl.jena.util.FileManager;
import com.hp.hpl.jena.util.iterator.*;
import oracle.spatial.rdf.client.jena.*;
import com.hp.hpl.jena.graph.*;
import com.hp.hpl.jena.update.*;
 
public class Test18 {
  public static void main(String[] args) throws Exception  {
    String szJdbcURL = args[0];
    String szUser    = args[1];
    String szPasswd  = args[2];
    String szModelName = args[3];
    
    Oracle oracle = new Oracle(szJdbcURL, szUser, szPasswd);
    ModelOracleSem model = ModelOracleSem.createOracleSemModel(oracle, 
szModelName);
    GraphOracleSem g = model.getGraph();
    String insertString =  
      &#34; PREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt; &#34; +
      &#34; INSERT DATA &#34;                                     +
      &#34; { &lt;u:Object1&gt; &lt;u:temp&gt;    \&#34;18.1\&#34;^^xsd:float ; &#34; +
      &#34;               &lt;u:name&gt;    \&#34;Foo... \&#34; . &#34;         + 
      &#34;   &lt;u:Object2&gt; &lt;u:temp&gt;    \&#34;32.0\&#34;^^xsd:float ; &#34; +
      &#34;               &lt;u:name&gt;    \&#34;Bar... \&#34; . &#34;         + 
      &#34; }   &#34;;
 
    UpdateAction.parseExecute(insertString,  model);
    String queryString = 
      &#34; PREFIX  fn: &lt;http://www.w3.org/2005/xpath-functions#&gt; &#34; + 
      &#34; SELECT ?subject ((?temp - 32.0)*5/9 as ?celsius_temp) &#34; +
      &#34;WHERE { ?subject &lt;u:temp&gt; ?temp } &#34; 
      ;
    Query query = QueryFactory.create(queryString, Syntax.syntaxARQ);
    QueryExecution qexec = QueryExecutionFactory.create(query, model);
    ResultSet results = qexec.execSelect();
    ResultSetFormatter.out(System.out, results, query);
 
    model.close();    
    OracleUtils.dropSemanticModel(oracle, szModelName);
    oracle.dispose();
  }
}
</pre>
<p>The following are the commands to compile and run <a href="rdf-jena.htm#GUID-58FFA706-81FB-45E7-B6E1-61D6D43A054C__CBBBBIJG">Example 7-30</a>, as well as the expected output of the <code class="codeph">java</code> command.</p>
<pre dir="ltr">javac -classpath ../jar/&#39;*&#39; Test18.java
java -classpath ./:../jar/&#39;*&#39;  Test18 jdbc:oracle:thin:@localhost:1521:orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1
------------------------------------------------------------------------
| subject     | celsius_temp                                           |
========================================================================
| &lt;u:Object1&gt; | &#34;-7.7222223&#34;^^&lt;http://www.w3.org/2001/XMLSchema#float&gt; |
| &lt;u:Object2&gt; | &#34;0.0&#34;^^&lt;http://www.w3.org/2001/XMLSchema#float&gt;        |
------------------------------------------------------------------------
</pre></div>
<!-- class="example" --></div>
</div>
<a id="RDFRM302"></a><a id="RDFRM301"></a>
<div class="props_rev_3"><a id="GUID-92E455B0-DC5C-485C-A412-C28D898C8D0D"></a>
<h3 id="RDFRM-GUID-92E455B0-DC5C-485C-A412-C28D898C8D0D" class="sect3"><span class="enumeration_section">7.16.15</span> Test19.java: Instantiate Oracle Database Using OracleConnection</h3>
<div>
<p><a href="rdf-jena.htm#GUID-92E455B0-DC5C-485C-A412-C28D898C8D0D__CBBFBDEJ">Example 7-31</a> shows a different way to instantiate an Oracle object using a given <code class="codeph">OracleConnection</code> object. (In a J2EE Web application, users can normally get an <code class="codeph">OracleConnection</code> object from a J2EE data source.)</p>
<div class="example" id="GUID-92E455B0-DC5C-485C-A412-C28D898C8D0D__CBBFBDEJ">
<p class="titleinexample">Example 7-31 Instantiate Oracle Database Using OracleConnection</p>
<pre dir="ltr">import java.io.*;
import com.hp.hpl.jena.query.*;
import com.hp.hpl.jena.rdf.model.Model;
import com.hp.hpl.jena.util.FileManager;
import com.hp.hpl.jena.util.iterator.*;
import com.hp.hpl.jena.graph.*;
import com.hp.hpl.jena.update.*;
import oracle.spatial.rdf.client.jena.*;
import oracle.jdbc.pool.*;
import oracle.jdbc.*;
        
public class Test19 {
  public static void main(String[] args) throws Exception {
    String szJdbcURL = args[0];
    String szUser    = args[1];
    String szPasswd  = args[2];
    String szModelName = args[3];
 
    OracleDataSource ds = new OracleDataSource();
    ds.setURL(szJdbcURL);
    ds.setUser(szUser);
    ds.setPassword(szPasswd);
    OracleConnection conn = (OracleConnection) ds.getConnection();
    Oracle oracle = new Oracle(conn);
 
    ModelOracleSem model = ModelOracleSem.createOracleSemModel(oracle, 
szModelName);
    GraphOracleSem g = model.getGraph();
 
    g.add(Triple.create(Node.createURI(&#34;u:John&#34;), Node.createURI(&#34;u:parentOf&#34;), 
                        Node.createURI(&#34;u:Mary&#34;)));
    g.add(Triple.create(Node.createURI(&#34;u:John&#34;), Node.createURI(&#34;u:parentOf&#34;),   
                        Node.createURI(&#34;u:Jack&#34;)));
    g.add(Triple.create(Node.createURI(&#34;u:Mary&#34;), Node.createURI(&#34;u:parentOf&#34;), 
         Node.createURI(&#34;u:Jill&#34;)));
    String queryString =
       &#34; SELECT ?s ?o  WHERE { ?s &lt;u:parentOf&gt; ?o .} &#34;;
    Query query = QueryFactory.create(queryString) ;
    QueryExecution qexec = QueryExecutionFactory.create(query, model) ;
 
    ResultSet results = qexec.execSelect() ;
    ResultSetFormatter.out(System.out, results, query);
    qexec.close() ; 
    model.close();    
    OracleUtils.dropSemanticModel(oracle, szModelName);
    oracle.dispose();
  }
}
</pre>
<p>The following are the commands to compile and run <a href="rdf-jena.htm#GUID-92E455B0-DC5C-485C-A412-C28D898C8D0D__CBBFBDEJ">Example 7-31</a>, as well as the expected output of the <code class="codeph">java</code> command.</p>
<pre dir="ltr">javac -classpath ../jar/&#39;*&#39; Test19.java
java -classpath ./:../jar/&#39;*&#39;  Test19 jdbc:oracle:thin:@localhost:1521:orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1
-----------------------
| s        | o        |
=======================
| &lt;u:John&gt; | &lt;u:Mary&gt; |
| &lt;u:John&gt; | &lt;u:Jack&gt; |
| &lt;u:Mary&gt; | &lt;u:Jill&gt; |
-----------------------
</pre></div>
<!-- class="example" --></div>
</div>
<a id="RDFRM304"></a><a id="RDFRM303"></a>
<div class="props_rev_3"><a id="GUID-15F4439C-C1A5-4634-87CB-11F5347F25F9"></a>
<h3 id="RDFRM-GUID-15F4439C-C1A5-4634-87CB-11F5347F25F9" class="sect3"><span class="enumeration_section">7.16.16</span> Test20.java: Oracle Database Connection Pooling</h3>
<div>
<p><a href="rdf-jena.htm#GUID-15F4439C-C1A5-4634-87CB-11F5347F25F9__CBBGHEEI">Example 7-32</a> uses Oracle Database connection pooling.</p>
<div class="example" id="GUID-15F4439C-C1A5-4634-87CB-11F5347F25F9__CBBGHEEI">
<p class="titleinexample">Example 7-32 Oracle Database Connection Pooling</p>
<pre dir="ltr">import java.io.*;
import com.hp.hpl.jena.query.*;
import com.hp.hpl.jena.rdf.model.Model;
import com.hp.hpl.jena.util.FileManager;
import com.hp.hpl.jena.util.iterator.*;
import com.hp.hpl.jena.graph.*;
import com.hp.hpl.jena.update.*;
import oracle.spatial.rdf.client.jena.*;
import oracle.jdbc.pool.*;
import oracle.jdbc.*;
 
public class Test20
{
  public static void main(String[] args) throws Exception
  {
    String szJdbcURL = args[0];
    String szUser    = args[1];
    String szPasswd  = args[2];
    String szModelName = args[3];
 
    // test with connection properties (taken from some example)
    java.util.Properties prop = new java.util.Properties();
    prop.setProperty(&#34;MinLimit&#34;, &#34;2&#34;);     // the cache size is 2 at least 
    prop.setProperty(&#34;MaxLimit&#34;, &#34;10&#34;);
    prop.setProperty(&#34;InitialLimit&#34;, &#34;2&#34;); // create 2 connections at startup
    prop.setProperty(&#34;InactivityTimeout&#34;, &#34;1800&#34;);    //  seconds
    prop.setProperty(&#34;AbandonedConnectionTimeout&#34;, &#34;900&#34;);  //  seconds
    prop.setProperty(&#34;MaxStatementsLimit&#34;, &#34;10&#34;);
    prop.setProperty(&#34;PropertyCheckInterval&#34;, &#34;60&#34;); // seconds
 
    System.out.println(&#34;Creating OraclePool&#34;);
    OraclePool op = new OraclePool(szJdbcURL, szUser, szPasswd, prop, 
               &#34;OracleSemConnPool&#34;);
    System.out.println(&#34;Done creating OraclePool&#34;);
 
    // grab an Oracle and do something with it
    System.out.println(&#34;Getting an Oracle from OraclePool&#34;);
    Oracle oracle = op.getOracle();
    System.out.println(&#34;Done&#34;);
    System.out.println(&#34;Is logical connection:&#34; +
        oracle.getConnection().isLogicalConnection());
    GraphOracleSem g = new GraphOracleSem(oracle, szModelName);
    g.add(Triple.create(Node.createURI(&#34;u:John&#34;), Node.createURI(&#34;u:parentOf&#34;), 
                        Node.createURI(&#34;u:Mary&#34;)));
    g.close();
    // return the Oracle back to the pool
    oracle.dispose();
    
    // grab another Oracle and do something else 
    System.out.println(&#34;Getting an Oracle from OraclePool&#34;);
    oracle = op.getOracle();
    System.out.println(&#34;Done&#34;);
    System.out.println(&#34;Is logical connection:&#34; +
        oracle.getConnection().isLogicalConnection());
    g = new GraphOracleSem(oracle, szModelName);
    g.add(Triple.create(Node.createURI(&#34;u:John&#34;), Node.createURI(&#34;u:parentOf&#34;), 
                        Node.createURI(&#34;u:Jack&#34;)));
    g.close();
    
    OracleUtils.dropSemanticModel(oracle, szModelName); 
    
    // return the Oracle back to the pool
    oracle.dispose();
  }
}
</pre>
<p>The following are the commands to compile and run <a href="rdf-jena.htm#GUID-15F4439C-C1A5-4634-87CB-11F5347F25F9__CBBGHEEI">Example 7-32</a>, as well as the expected output of the <code class="codeph">java</code> command.</p>
<pre dir="ltr">javac -classpath ../jar/&#39;*&#39; Test20.java
java -classpath ./:../jar/&#39;*&#39;  Test20 jdbc:oracle:thin:@localhost:1521:orcl scott <span class="italic">&lt;password-for-scott&gt;</span> M1
Creating OraclePool
Done creating OraclePool
Getting an Oracle from OraclePool
Done
Is logical connection:true
Getting an Oracle from OraclePool
Done
Is logical connection:true
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<a id="RDFRM484"></a>
<div class="props_rev_3"><a id="GUID-649269C9-6EB8-489C-B139-073CB8BA768E"></a>
<h2 id="RDFRM-GUID-649269C9-6EB8-489C-B139-073CB8BA768E" class="sect2"><span class="enumeration_section">7.17</span> SPARQL Gateway and Semantic Data</h2>
<div>
<p>SPARQL Gateway is a J2EE web application that is included with the support for Apache Jena. It is designed to make semantic data (RDF/OWL/SKOS) easily available to applications that operate on relational and XML data, including Oracle Business Intelligence Enterprise Edition (OBIEE) 11<span class="italic">g</span>.</p>
<p>This section includes the following major topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rdf-jena.htm#GUID-39A0D5BE-8F6C-468D-9164-4C6B7431A7B9">SPARQL Gateway Features and Benefits Overview</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-C7E88D7F-642A-49D7-AB3D-FBEFFC176CD6">Installing and Configuring SPARQL Gateway</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-5C5AD7B1-7601-431D-9026-2AACDC6A48DE">Using SPARQL Gateway with Semantic Data</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-B51AE2DD-2BD3-46BE-997F-240CDE0DCC2E">Customizing the Default XSLT File</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431">Using the SPARQL Gateway Java API</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-81166E14-3CA8-45A7-A15B-EBDD11497AB6">Using the SPARQL Gateway Graphical Web Interface</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-66E24387-35FA-4F55-9E93-88F4570C6A54">Using SPARQL Gateway as an XML Data Source to OBIEE</a></p>
</li>
</ul>
</div>
<a id="RDFRM485"></a>
<div class="props_rev_3"><a id="GUID-39A0D5BE-8F6C-468D-9164-4C6B7431A7B9"></a>
<h3 id="RDFRM-GUID-39A0D5BE-8F6C-468D-9164-4C6B7431A7B9" class="sect3"><span class="enumeration_section">7.17.1</span> SPARQL Gateway Features and Benefits Overview</h3>
<div>
<p>SPARQL Gateway handles several challenges in exposing semantic data to a non-semantic application:</p>
<ul style="list-style-type: disc;">
<li>
<p>RDF syntax, SPARQL query syntax and SPARQL protocol must be understood.</p>
</li>
<li>
<p>The SPARQL query response syntax must be understood.</p>
</li>
<li>
<p>A transformation must convert a SPARQL query response to something that the application can consume.</p>
</li>
</ul>
<p>To address these challenges, SPARQL Gateway manages SPARQL queries and XSLT operations, executes SPARQL queries against any arbitrary standard-compliant SPARQL endpoints, and performs necessary XSL transformations before passing the response back to applications. Applications can then consume semantic data as if it is coming from an existing data source.</p>
<p>Different triple stores or quad stores often have different capabilities. For example, the SPARQL endpoint supported by Oracle Database, with RDF Semantic Graph support for Apache Jena and with Joseki, allows parallel execution, query timeout, dynamic sampling, result cache, and other features, in addition to the core function of parsing and answering a given standard-compliant SPARQL query. However, these features may not be available from another given semantic data store.</p>
<p>With the RDF Semantic Graph SPARQL Gateway, you get certain highly desirable capabilities, such as the ability to set a timeout on a long running query and the ability to get partial results from a complex query in a given amount of time. Waiting indefinitely for a query to finish is a challenge for end users, as is an application with a response time constraint. SPARQL Gateway provides both timeout and best effort query functions on top of a SPARQL endpoint. This effectively removes some uncertainty from consuming semantic data through SPARQL query executions. (See <a href="rdf-jena.htm#GUID-839B32F5-1F75-46BC-8ECD-2A3CC4F4F439">Specifying a Timeout Value</a> and <a href="rdf-jena.htm#GUID-4E44DB12-68EA-441D-8269-8C5E5B02D68F">Specifying Best Effort Query Execution</a>.)</p>
</div>
</div>
<a id="RDFRM486"></a>
<div class="props_rev_3"><a id="GUID-C7E88D7F-642A-49D7-AB3D-FBEFFC176CD6"></a>
<h3 id="RDFRM-GUID-C7E88D7F-642A-49D7-AB3D-FBEFFC176CD6" class="sect3"><span class="enumeration_section">7.17.2</span> Installing and Configuring SPARQL Gateway</h3>
<div>
<p>To install and configure SPARQL Gateway, follow these major steps, which are explained in their own topics:</p>
<ol>
<li>
<p><a href="rdf-jena.htm#GUID-6083DBEE-5A3C-473A-83FB-CC533B85C7CA">Download the RDF Semantic Graph Support for Apache Jena .zip File (if Not Already Done)</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-31483449-5E99-4400-8F37-3DBCCD74F10F">Deploy SPARQL Gateway in WebLogic Server</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-1B2C9D7D-6350-4A4D-8AE9-5D2770BCF6BD">Modify Proxy Settings_ if Necessary</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-B8F3817F-59B1-48C2-8EC5-7675251AD651">Configure the OracleSGDS Data Source_ if Necessary</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-E635224C-8499-462A-8F9C-E3EB7B8DF6F8">Add and Configure the SparqlGatewayAdminGroup Group_ if Desired</a></p>
</li>
</ol>
</div>
<a id="RDFRM487"></a>
<div class="props_rev_3"><a id="GUID-6083DBEE-5A3C-473A-83FB-CC533B85C7CA"></a>
<h4 id="RDFRM-GUID-6083DBEE-5A3C-473A-83FB-CC533B85C7CA" class="sect4"><span class="enumeration_section">7.17.2.1</span> Download the RDF Semantic Graph Support for Apache Jena .zip File (if Not Already Done)</h4>
<div>
<p>If you have not already done so, download the RDF Semantic Graph support for Apache Jena file from the RDF Semantic Graph page and unzip it into a temporary directory, as explained in <a href="rdf-jena.htm#GUID-17E0C43D-2625-4D69-BBD7-1BCF204684EA">Setting Up the Software Environment</a>.</p>
<p>Note that the SPARQL Gateway Java class implementations are embedded in <code class="codeph">sdordfclient.jar</code> (see <a href="rdf-jena.htm#GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431">Using the SPARQL Gateway Java API</a>).</p>
</div>
</div>
<a id="RDFRM488"></a>
<div class="props_rev_3"><a id="GUID-31483449-5E99-4400-8F37-3DBCCD74F10F"></a>
<h4 id="RDFRM-GUID-31483449-5E99-4400-8F37-3DBCCD74F10F" class="sect4"><span class="enumeration_section">7.17.2.2</span> Deploy SPARQL Gateway in WebLogic Server</h4>
<div>
<p>Deploy SPARQL Gateway in Oracle WebLogic Server, as follows:</p>
<ol>
<li>
<p>Go to the autodeploy directory of WebLogic Server, and copy over the prebuilt <code class="codeph">sparqlgateway.war</code> file as follows. (For information about auto-deploying applications in development domains, see: <a href="http://docs.oracle.com/cd/E11035_01/wls100/deployment/autodeploy.html" target="_blank"><code class="codeph">http://docs.oracle.com/cd/E11035_01/wls100/deployment/autodeploy.html</code></a>)</p>
<pre dir="ltr">cp -rf  /tmp/jena_adapter/sparqlgateway_web_app/sparqlgateway.war  <span class="italic">&lt;domain_name&gt;</span>/autodeploy/sparqgateway.war
  
</pre>
<p>In this example, <span class="italic">&lt;domain_name&gt;</span> is the name of a WebLogic Server domain.</p>
<p>You can customize the prebuilt application in the following ways:</p>
<ul style="list-style-type: disc;">
<li>
<p>Modify the <code class="codeph">WEB-INF/web.xml</code> file embedded in <code class="codeph">sparqlgateway_web_app/sparqlgateway.war</code> as needed. Be sure to specify appropriate values for the <code class="codeph">sparql_gateway_repository_filedir</code> and <code class="codeph">sparql_gateway_repository_url</code> parameters.</p>
</li>
<li>
<p>Add XSLT files or SPARQL query files to the top-level directory of <code class="codeph">sparqlgateway_web_app/sparqlgateway.war</code>, if necessary.</p>
<p>The following files are provided by Oracle in that directory: <code class="codeph">default.xslt</code>, <code class="codeph">noop.xslt</code>, and <code class="codeph">qb1.sparql</code>. The <code class="codeph">default.xslt</code> file is intended mainly for transforming SPARQL query responses (XML) to a format acceptable to Oracle.</p>
<p>(These files are described in <a href="rdf-jena.htm#GUID-668EAD23-D36E-4098-B3B9-BB1586AC9734">Storing SPARQL Queries and XSL Transformations</a>; using SPARQL Gateway with OBIEE is explained in <a href="rdf-jena.htm#GUID-66E24387-35FA-4F55-9E93-88F4570C6A54">Using SPARQL Gateway as an XML Data Source to OBIEE</a>.)</p>
</li>
</ul>
</li>
<li>
<p>Verify your deployment by using your Web browser to connect to a URL in the following format (assume that the Web application is deployed at port 7001):</p>
<pre dir="ltr">http://<span class="italic">&lt;hostname&gt;</span>:7001/sparqlgateway
</pre></li>
</ol>
</div>
</div>
<a id="RDFRM489"></a>
<div class="props_rev_3"><a id="GUID-1B2C9D7D-6350-4A4D-8AE9-5D2770BCF6BD"></a>
<h4 id="RDFRM-GUID-1B2C9D7D-6350-4A4D-8AE9-5D2770BCF6BD" class="sect4"><span class="enumeration_section">7.17.2.3</span> Modify Proxy Settings, if Necessary</h4>
<div>
<p>If your SPARQL Gateway is behind a firewall and you want SPARQL Gateway to communicate with SPARQL endpoints on the Internet as well as those inside the firewall, you probably need to use the following JVM settings:</p>
<pre dir="ltr">-Dhttp.proxyHost=&lt;<span class="italic">your_proxy_host&gt;</span>
-Dhttp.proxyPort=<span class="italic">&lt;your_proxy_port&gt;</span>
-Dhttp.nonProxyHosts=127.0.0.1|<span class="italic">&lt;hostname_1_for_sparql_endpoint_inside_firewall&gt;</span>|<span class="italic">&lt;hostname_2_for_sparql_endpoint_inside_firewall&gt;</span>|...|<span class="italic">&lt;hostname_n_for_sparql_endpoint_inside_firewall&gt;</span>
</pre>
<p>You can specify these settings in the <code class="codeph">startWebLogic.sh</code> script.</p>
</div>
</div>
<a id="RDFRM490"></a>
<div class="props_rev_3"><a id="GUID-B8F3817F-59B1-48C2-8EC5-7675251AD651"></a>
<h4 id="RDFRM-GUID-B8F3817F-59B1-48C2-8EC5-7675251AD651" class="sect4"><span class="enumeration_section">7.17.2.4</span> Configure the OracleSGDS Data Source, if Necessary</h4>
<div>
<p>If an Oracle database is used for storage of and access to SPARQL queries and XSL transformations for SPARQL Gateway, then you must configure a data source named <code class="codeph">OracleSGDS</code>.</p>
<p>To create this data source, follow the instructions in <a href="rdf-jena.htm#GUID-CC0618F7-318D-4F21-A78D-29CF31FDDB7F">Creating the Required Data Source Using WebLogic Server</a>; however, specify <span class="bold"><code class="codeph">OracleSGDS</code></span> as the data source name instead of <code class="codeph">OracleSemDS</code>.</p>
<p>If the <code class="codeph">OracleSGDS</code> data source is configured and available, SPARQL Gateway servlet will automatically create all the necessary tables and indexes upon initialization.</p>
</div>
</div>
<a id="RDFRM491"></a>
<div class="props_rev_3"><a id="GUID-E635224C-8499-462A-8F9C-E3EB7B8DF6F8"></a>
<h4 id="RDFRM-GUID-E635224C-8499-462A-8F9C-E3EB7B8DF6F8" class="sect4"><span class="enumeration_section">7.17.2.5</span> Add and Configure the SparqlGatewayAdminGroup Group, if Desired</h4>
<div>
<p>The following JSP files in SPARQL Gateway can help you to view, edit, and update SPARQL queries and XSL transformations that are stored in an Oracle database:</p>
<pre dir="ltr">http://<span class="italic">&lt;host&gt;</span>:7001/sparqlgateway/admin/sparql.jsp
http://<span class="italic">&lt;host&gt;</span>:7001/sparqlgateway/admin/xslt.jsp
</pre>
<p>These files are protected by HTTP Basic Authentication. In <code class="codeph">WEB-INF/weblogic.xml</code>, a principal named <code class="codeph">SparqlGatewayAdminGroup</code> is defined.</p>
<p>To be able to log in to either of these JSP pages, you must use the WebLogic Server to add a group named <code class="codeph">SparqlGatewayAdminGroup</code>, and create a new user or assign an existing user to this group.</p>
</div>
</div>
</div>
<a id="RDFRM492"></a>
<div class="props_rev_3"><a id="GUID-5C5AD7B1-7601-431D-9026-2AACDC6A48DE"></a>
<h3 id="RDFRM-GUID-5C5AD7B1-7601-431D-9026-2AACDC6A48DE" class="sect3"><span class="enumeration_section">7.17.3</span> Using SPARQL Gateway with Semantic Data</h3>
<div>
<p>The primary interface for an application to interact with SPARQL Gateway is through a URL with the following format:</p>
<pre dir="ltr">http://host:port/sparqlgateway/sg?<span class="italic">&lt;SPARQL_ENDPOINT&gt;</span>&amp;<span class="italic">&lt;SPARQL_QUERY&gt;</span>&amp;<span class="italic">&lt;XSLT&gt;</span>
</pre>
<p>In the preceding format:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="italic">&lt;SPARQL_ENDPOINT&gt;</span> specifies the <code class="codeph">ee</code> parameter, which contains a URL encoded form of a SPARQL endpoint.</p>
<p>For example, <code class="codeph">ee=http%3A%2F%2Fsparql.org%2Fbooks</code> is the URL encoded string for SPARQL endpoint <code class="codeph">http://sparql.org/books</code>. It means that SPARQL queries are to be executed against endpoint <code class="codeph">http://sparql.org/books</code>.</p>
</li>
<li>
<p><span class="italic">&lt;SPARQL_QUERY&gt;</span> specifies either the SPARQL query, or the location of the SPARQL query.</p>
<p>If it is feasible for an application to accept a very long URL, you can encode the whole SPARQL query and set <code class="codeph">eq=</code><span class="italic"><code class="codeph">&lt;encoded_SPARQL_query&gt;</code></span> in the URL If it is not feasible for an application to accept a very long URL, you can store the SPARQL queries and make them available to SPARQL Gateway using one of the approaches described in <a href="rdf-jena.htm#GUID-668EAD23-D36E-4098-B3B9-BB1586AC9734">Storing SPARQL Queries and XSL Transformations</a>.</p>
</li>
<li>
<p><span class="italic">&lt;XSLT&gt;</span> specifies either the XSL transformation, or the location of the XSL transformation.</p>
<p>If it is feasible for an application to accept a very long URL, you can encode the whole XSL transformation and set <code class="codeph">ex=</code><span class="italic"><code class="codeph">&lt;encoded_XSLT&gt;</code></span> in the URL If it is not feasible for an application to accept a very long URL, you can store the XSL transformations and make them available to SPARQL Gateway using one of the approaches described in <a href="rdf-jena.htm#GUID-668EAD23-D36E-4098-B3B9-BB1586AC9734">Storing SPARQL Queries and XSL Transformations</a>.</p>
</li>
</ul>
<p>Related topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rdf-jena.htm#GUID-668EAD23-D36E-4098-B3B9-BB1586AC9734">Storing SPARQL Queries and XSL Transformations</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-839B32F5-1F75-46BC-8ECD-2A3CC4F4F439">Specifying a Timeout Value</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-4E44DB12-68EA-441D-8269-8C5E5B02D68F">Specifying Best Effort Query Execution</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-096AD341-4C69-4643-A56E-FC18605024CA">Specifying a Content Type Other Than text/xml</a></p>
</li>
</ul>
</div>
<a id="RDFRM493"></a>
<div class="props_rev_3"><a id="GUID-668EAD23-D36E-4098-B3B9-BB1586AC9734"></a>
<h4 id="RDFRM-GUID-668EAD23-D36E-4098-B3B9-BB1586AC9734" class="sect4"><span class="enumeration_section">7.17.3.1</span> Storing SPARQL Queries and XSL Transformations</h4>
<div>
<p>If it is not feasible for an application to accept a very long URL, you can specify the location of the SPARQL query and the XSL transformation in the <span class="italic">&lt;SPARQL_QUERY&gt;</span> and <span class="italic">&lt;XSLT&gt;</span> portions of the URL format described in <a href="rdf-jena.htm#GUID-5C5AD7B1-7601-431D-9026-2AACDC6A48DE">Using SPARQL Gateway with Semantic Data</a>, using any of the following approaches:</p>
<ul style="list-style-type: disc;">
<li>
<p>Store the SPARQL queries and XSL transformations in the SPARQL Gateway Web application itself.</p>
<p>To do this, unpack the <code class="codeph">sparqlgateway.war</code> file, and store the SPARQL queries and XSL transformations in the top-level directory; then pack the <code class="codeph">sparqlgateway.war</code> file and redeploy it.</p>
<p>The <code class="codeph">sparqlgateway.war</code> file includes the following example files: <code class="codeph">qb1.sparql</code> (SPARQL query) and <code class="codeph">default.xslt</code> (XSL transformation).</p>
<div class="infoboxnotealso" id="GUID-668EAD23-D36E-4098-B3B9-BB1586AC9734__GUID-D69075CD-8481-4CC4-B9D1-FE5F28C22022">
<p class="notep1">Tip:</p>
<p>Use the file extension <code class="codeph">.sparql</code> for SPARQL query files, and the file extension <code class="codeph">.xslt</code> for XSL transformation files.</p>
</div>
<p>The syntax for specifying these files (using the provided example file names) is <span class="bold"><code class="codeph">wq</code></span><code class="codeph">=qb1</code>.sparql for a SPARQL query file and <span class="bold"><code class="codeph">wx</code></span><code class="codeph">=default.xslt</code> for an XSL transformation file.</p>
<p>If you want to customize the default XSL transformations, see the examples in <a href="rdf-jena.htm#GUID-B51AE2DD-2BD3-46BE-997F-240CDE0DCC2E">Customizing the Default XSLT File</a>.</p>
<p>If you specify <code class="codeph">wx=noop.xslt</code>, XSL transformation is not performed and the SPARQL response is returned &#34;as is&#34; to the client.</p>
</li>
<li>
<p>Store the SPARQL queries and XSL transformations in a file system directory, and make sure that the directory is accessible for the deployed SPARQL Gateway Web application.</p>
<p>By default, the directory is set to <code class="codeph">/tmp</code>, as shown in the following <code class="codeph">&lt;init-param&gt;</code> setting:</p>
<pre dir="ltr">&lt;init-param&gt;
   &lt;param-name&gt;sparql_gateway_repository_<span class="bold">filedir</span>&lt;/param-name&gt;
   &lt;param-value&gt;<span class="bold">/tmp/</span>&lt;/param-value&gt;
&lt;/init-param&gt;
</pre>
<p>It is recommended that you customize this directory before deploying the SPARQL Gateway. To change the directory setting, edit the text in between the <code class="codeph">&lt;param-value&gt;</code> and <code class="codeph">&lt;/param-value&gt;</code> tags.</p>
<p>The following example specifies a SPARQL query file and an XSL transformation file that are in the directory specified in the <code class="codeph">&lt;init-param&gt;</code> element for <code class="codeph">sparql_gateway_repository_filedir</code>:</p>
<pre dir="ltr"><span class="bold">fq</span>=qb1.sparql
<span class="bold">fx</span>=myxslt1.xslt
</pre></li>
<li>
<p>Make the SPARQL queries and XSL transformations accessible from a website.</p>
<p>By default, the website directory is set to <code class="codeph">http://127.0.0.1/queries/</code>, as shown in the following <code class="codeph">&lt;init-param&gt;</code> setting:</p>
<pre dir="ltr">&lt;init-param&gt;
   &lt;param-name&gt;sparql_gateway_repository_<span class="bold">url</span>&lt;/param-name&gt;
   &lt;param-value&gt;<span class="bold">http://127.0.0.1/queries/</span>&lt;/param-value&gt;
&lt;/init-param&gt;
</pre>
<p>Customize this directory before deploying the SPARQL Gateway. To change the website setting, edit the text in between the <code class="codeph">&lt;param-value&gt;</code> and <code class="codeph">&lt;/param-value&gt;</code> tags.</p>
<p>The following example specifies a SPARQL query file and an XSL transformation file that are in the URL specified in the <code class="codeph">&lt;init-param&gt;</code> element for <code class="codeph">sparql_gateway_repository_url</code>.</p>
<pre dir="ltr"><span class="bold">uq</span>=qb1.sparql
<span class="bold">ux</span>=myxslt1.xslt
</pre>
<p>Internally, SPARQL Gateway computes the appropriate complete URL, fetches the content, starts query execution, and applies the XSL transformation to the query response XML.</p>
</li>
<li>
<p>Store the SPARQL queries and XSL transformations in an Oracle database.</p>
<p>This approach requires that the J2EE data source <code class="codeph">OracleSGDS</code> be defined. After SPARQL Gateway retrieves a database connection from the OracleSGDS data source, a SPARQL query is read from the database table ORACLE_ORARDF_SG_QUERY using the integer ID provided.</p>
<p>The syntax for fetching a SPARQL query from an Oracle database is <span class="bold"><code class="codeph">dq=</code></span><code class="codeph">&lt;integer-id&gt;</code>, and the syntax for fetching an XSL transformation from an Oracle database is <span class="bold"><code class="codeph">dx=</code></span><code class="codeph">&lt;integer-id&gt;</code>.</p>
<p>Upon servlet initialization, the following tables are created automatically if they do not already exist (you do not need to create them manually):</p>
<ul style="list-style-type: disc;">
<li>
<p>ORACLE_ORARDF_SG_QUERY with a primary key of QID (integer type)</p>
</li>
<li>
<p>ORACLE_ORARDF_SG_XSLT with a primary key of XID (integer type)</p>
</li>
</ul>
</li>
</ul>
</div>
</div>
<a id="RDFRM494"></a>
<div class="props_rev_3"><a id="GUID-839B32F5-1F75-46BC-8ECD-2A3CC4F4F439"></a>
<h4 id="RDFRM-GUID-839B32F5-1F75-46BC-8ECD-2A3CC4F4F439" class="sect4"><span class="enumeration_section">7.17.3.2</span> Specifying a Timeout Value</h4>
<div>
<p>When you submit a potentially long-running query using the URL format described in <a href="rdf-jena.htm#GUID-5C5AD7B1-7601-431D-9026-2AACDC6A48DE">Using SPARQL Gateway with Semantic Data</a>, you can limit the execution time by specifying a timeout value in milliseconds. For example, the following shows the URL format and a timeout specification that the SPARQL query execution started from SPARQL Gateway is to be ended after 1000 milliseconds (1 second):</p>
<pre dir="ltr">http://<span class="italic">host:port</span>/sparqlgateway/sg?<span class="italic">&lt;SPARQL_ENDPOINT&gt;</span>&amp;<span class="italic">&lt;SPARQL_QUERY&gt;</span>&amp;<span class="italic">&lt;XSLT&gt;</span><span class="bold">&amp;t=1000</span>
</pre>
<p>If a query does not finish when timeout occurs, then an empty SPARQL response is constructed by SPARQL Gateway.</p>
<p>Note that even if SPARQL Gateway times out a query execution at the HTTP connection level, the query may still be running on the server side. The actual behavior will be vendor-dependent.</p>
</div>
</div>
<a id="RDFRM495"></a>
<div class="props_rev_3"><a id="GUID-4E44DB12-68EA-441D-8269-8C5E5B02D68F"></a>
<h4 id="RDFRM-GUID-4E44DB12-68EA-441D-8269-8C5E5B02D68F" class="sect4"><span class="enumeration_section">7.17.3.3</span> Specifying Best Effort Query Execution</h4>
<div>
<div class="infobox-note" id="GUID-4E44DB12-68EA-441D-8269-8C5E5B02D68F__GUID-D9F91EA8-67D7-419E-A0E8-1A3FC339646D">
<p class="notep1">Note:</p>
<p>You can specify best effort query execution only if you also specify a timeout value (described in <a href="rdf-jena.htm#GUID-839B32F5-1F75-46BC-8ECD-2A3CC4F4F439">Specifying a Timeout Value</a>).</p>
</div>
<p>When you submit a potentially long-running query using the URL format described in <a href="rdf-jena.htm#GUID-5C5AD7B1-7601-431D-9026-2AACDC6A48DE">Using SPARQL Gateway with Semantic Data</a>, if you specify a timeout value, you can also specify a &#34;best effort&#34; limitation on the query. For example, the following shows the URL format with a timeout specification of 1000 milliseconds (1 second) and a best effort specification (<code class="codeph">&amp;b=t</code>):</p>
<pre dir="ltr">http://<span class="italic">host:port</span>/sparqlgateway/sg?<span class="italic">&lt;SPARQL_ENDPOINT&gt;</span>&amp;<span class="italic">&lt;SPARQL_QUERY&gt;</span>&amp;<span class="italic">&lt;XSLT&gt;</span><span class="bold">&amp;t=1000</span><span class="bold">&amp;b=t</span>
</pre>
<p>The web.xml file includes two parameter settings that affect the behavior of the best effort option: <code class="codeph">sparql_gateway_besteffort_maxrounds</code> and <code class="codeph">sparql_gateway_besteffort_maxthreads</code>. The following show the default definitions:</p>
<pre dir="ltr">&lt;init-param&gt;
  &lt;param-name&gt;sparql_gateway_besteffort_maxrounds&lt;/param-name&gt;
  &lt;param-value&gt;10&lt;/param-value&gt;
&lt;/init-param&gt;
 
&lt;init-param&gt;
  &lt;param-name&gt;sparql_gateway_besteffort_maxthreads&lt;/param-name&gt;
  &lt;param-value&gt;3&lt;/param-value&gt;
&lt;/init-param&gt;
</pre>
<p>When a SPARQL SELECT query is executed in best effort style, a series of queries will be executed with an increasing LIMIT value setting in the SPARQL query body. (The core idea is based on the observation that a SPARQL query runs faster with a smaller LIMIT setting.) SPARQL Gateway starts query execution with a &#34;LIMIT 1&#34; setting. Ideally, this query can finish before the timeout is due. Assume that is the case, the next query will have its LIMIT setting is increased, and subsequent queries have higher limits. The maximum number of query executions is controlled by the <code class="codeph">sparql_gateway_besteffort_maxrounds</code> parameter.</p>
<p>If it is possible to run the series of queries in parallel, the <code class="codeph">sparql_gateway_besteffort_maxthreads</code> parameter controls the degree of parallelism.</p>
</div>
</div>
<a id="RDFRM496"></a>
<div class="props_rev_3"><a id="GUID-096AD341-4C69-4643-A56E-FC18605024CA"></a>
<h4 id="RDFRM-GUID-096AD341-4C69-4643-A56E-FC18605024CA" class="sect4"><span class="enumeration_section">7.17.3.4</span> Specifying a Content Type Other Than text/xml</h4>
<div>
<p>By default, SPARQL Gateway assumes that XSL transformations generate XML, and so the default content type set for HTTP response is <code class="codeph">text/xml</code>. However, if your application requires a response format other than XML, you can specify the format in an additional URL parameter (with syntax <code class="codeph">&amp;rt=</code>), using the following format:</p>
<pre dir="ltr">http://<span class="italic">host</span>:<span class="italic">port</span>/sparqlgateway/sg?<span class="italic">&lt;SPARQL_ENDPOINT&gt;</span>&amp;<span class="italic">&lt;SPARQL_QUERY&gt;</span>&amp;&lt;XSLT&gt;<span class="bold">&amp;rt=</span><span class="italic"><span class="bold">&lt;content_type&gt;</span></span>
</pre>
<p>Note that <span class="italic">&lt;content_type&gt;</span> must be URL encoded.</p>
</div>
</div>
</div>
<a id="RDFRM497"></a>
<div class="props_rev_3"><a id="GUID-B51AE2DD-2BD3-46BE-997F-240CDE0DCC2E"></a>
<h3 id="RDFRM-GUID-B51AE2DD-2BD3-46BE-997F-240CDE0DCC2E" class="sect3"><span class="enumeration_section">7.17.4</span> Customizing the Default XSLT File</h3>
<div>
<p>You can customize the default XSL transformation file (the one referenced using <code class="codeph">wx=default.xslt</code>). This section presents some examples of customizations.</p>
<p>The following example implements this namespace prefix replacement logic: if a variable binding returns a URI that starts with <code class="codeph">http://purl.org/goodrelations/v1#</code>, that portion is replaced by <code class="codeph">gr:</code>; and if a variable binding returns a URI that starts with <code class="codeph">http://www.w3.org/2000/01/rdf-schema#</code>, that portion is replaced by <code class="codeph">rdfs:</code>.</p>
<pre dir="ltr">&lt;xsl:when test=&#34;starts-with(text(),&#39;http://purl.org/goodrelations/v1#&#39;)&#34;&gt;
   &lt;xsl:value-of select=&#34;concat(&#39;gr:&#39;,substring-after(text(),&#39;http://purl.org/goodrelations/v1#&#39;))&#34;/&gt;
&lt;/xsl:when&gt;
...
&lt;xsl:when test=&#34;starts-with(text(),&#39;http://www.w3.org/2000/01/rdf-schema#&#39;)&#34;&gt;
   &lt;xsl:value-of select=&#34;concat(&#39;rdfs:&#39;,substring-after(text(),&#39;http://www.w3.org/2000/01/rdf-schema#&#39;))&#34;/&gt;
&lt;/xsl:when&gt;
</pre>
<p>The following example implements logic to trim a leading <code class="codeph">http://localhost/</code> or a leading <code class="codeph">http://127.0.0.1/</code>.</p>
<pre dir="ltr">&lt;xsl:when test=&#34;starts-with(text(),&#39;http://localhost/&#39;)&#34;&gt;
  &lt;xsl:value-of select=&#34;substring-after(text(),&#39;http://localhost/&#39;)&#34;/&gt;
&lt;/xsl:when&gt;
&lt;xsl:when test=&#34;starts-with(text(),&#39;http://127.0.0.1/&#39;)&#34;&gt;
  &lt;xsl:value-of select=&#34;substring-after(text(),&#39;http://127.0.0.1/&#39;)&#34;/&gt;
&lt;/xsl:when&gt;
</pre></div>
</div>
<a id="RDFRM499"></a><a id="RDFRM501"></a><a id="RDFRM502"></a><a id="RDFRM498"></a>
<div class="props_rev_3"><a id="GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431"></a>
<h3 id="RDFRM-GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431" class="sect3"><span class="enumeration_section">7.17.5</span> Using the SPARQL Gateway Java API</h3>
<div>
<p>In addition to a Web interface, the SPARQL Gateway administration service provides a convenient Java application programming interface (API) for managing SPARQL queries and their associated XSL transformations. The Java API is included in the RDF Semantic Graph support for Apache Jena library, <code class="codeph">sdordfclient.jar</code>.</p>
<p>Java API reference information is available in the <code class="codeph">javadoc_sparqlgateway.zip</code> file that is included in the SPARQL Gateway .zip file (described in <a href="rdf-jena.htm#GUID-6083DBEE-5A3C-473A-83FB-CC533B85C7CA">Download the RDF Semantic Graph Support for Apache Jena .zip File (if Not Already Done)</a>).</p>
<p>The main entry point for this API is the <code class="codeph">oracle.spatial.rdf.client.jena.SGDBHandler</code> class (SPARQL Gateway Database Handler), which provides the following static methods for managing queries and transformations:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">deleteSparqlQuery(Connection, int)</code></p>
</li>
<li>
<p><code class="codeph">deleteXslt(Connection, int)</code></p>
</li>
<li>
<p><code class="codeph">insertSparqlQuery(Connection, int, String, String, boolean)</code></p>
</li>
<li>
<p><code class="codeph">insertXslt(Connection, int, String, String, boolean)</code></p>
</li>
<li>
<p><code class="codeph">getSparqlQuery(Connection, int, StringBuilder, StringBuilder)</code></p>
</li>
<li>
<p><code class="codeph">getXslt(Connection, int, StringBuilder, StringBuilder)</code></p>
</li>
</ul>
<p>These methods manipulate and retrieve entries in the SPARQL Gateway associated tables that are stored in an Oracle Database instance. To use these methods, the necessary associated tables must already exist. If the tables do not exist, deploy the SPARQL Gateway on a Web server and access a URL in the following format:</p>
<pre dir="ltr">http://<span class="italic">&lt;host&gt;</span>:<span class="italic">&lt;port&gt;</span>/sparqlgateway/sg?
</pre>
<p>where <span class="italic">&lt;host&gt;</span> is the host name of the Web server and <span class="italic">&lt;port&gt;</span> is the listening port of the Web server. Accessing this URL will automatically create the necessary tables if they do not already exist.</p>
<p>Any changes made through the Java API affect the SPARQL Gateway Web service in the same way as changes made through the administration Web interface. This provides the flexibility to manage queries and transformations using the interface you find most convenient.</p>
<p>Note that the insert methods provided by the Java API will not replace existing queries or transformations stored in the tables. Attempting to replace an existing query or transformation will fail. To replace a query or transformation, you must remove the existing entry in the table using one of the delete methods, and then insert the new query or transformation using one of the insert methods.</p>
<p>The following examples demonstrate how to perform common management tasks using the Java API. The examples assume a connection has already been established to the underlying Oracle Database instance backing the SPARQL Gateway.</p>
<div class="example" id="GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431__BGBJHJCH">
<p class="titleinexample">Example 7-33 Storing a SPARQL Query and an XSL Transformation</p>
<p><a href="rdf-jena.htm#GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431__BGBJHJCH">Example 7-33</a> adds a query and an XSL transformation to the database backing the SPARQL Gateway. After the query and transformation are added, other programs can use the query and transformation through the gateway by specifying the appropriate query ID (<code class="codeph">qid</code>) and XSL transformation ID (<code class="codeph">xid</code>) in the request URL.</p>
<p>Note that Although <a href="rdf-jena.htm#GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431__BGBJHJCH">Example 7-33</a> inserts both a query and transformation, the query and transformation are not necessarily related and do not need to be used together when accessing SPARQL Gateway. Any query in the database can be used with any transformation in the database when submitting a request to SPARQL Gateway.</p>
<pre dir="ltr">String query = &#34;PREFIX ... SELECT ...&#34;; // full SPARQL query text
String xslt  = &#34;&lt;?xml ...&gt; ...&#34;;        // full XSLT transformation text
 
String queryDesc = &#34;Conference attendee information&#34;; // description of SPARQL query
String xsltDesc = &#34;BIEE table widget transformation&#34;; // description of XSLT transformation
 
int queryId = queryIdCounter++; // assign a unique ID to this query
int xsltId  = xsltIdCounter++;  // assign a unique ID to this transformation
 
// Inserting a query or transformation will fail if the table already contains
// an entry with the same ID.  Setting this boolean to true will ignore these
// exceptions (but the table will remain unchanged). Here we specify that we
// want an exception thrown if we encounter a duplicate ID.
boolean ignoreDupException = false;
 
// add the query
try {
  // Delete query if one already exists with this ID (this will <span class="bold">not</span> throw an
  // error if no such entry exists)
  SGDBHandler.deleteSparqlQuery( connection, queryId );
  SGDBHandler.insertSparqlQuery( connection, queryId, query, queryDesc, ignoreDupException );
} catch( SQLException sqle ) {
  // Handle exception
} catch( QueryException qe ) {
  // Handle query syntax exception
}
 
// add the XSLT
try {
  // Delete xslt if one already exists with this ID (this will <span class="bold">not</span> throw an
  // error if no such entry exists)
  SGDBHandler.deleteXslt( connection, xsltId );
  SGDBHandler.insertXslt( connection, xsltId, xslt, xsltDesc, ignoreDupException );
}  catch( SQLException sqle ) {
  // Handle database exception
} catch( TransformerConfigurationException tce ) {
  // Handle XSLT syntax exception
}
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431__BGBFGBGJ">
<p class="titleinexample">Example 7-34 Modifying a Query</p>
<p><a href="rdf-jena.htm#GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431__BGBFGBGJ">Example 7-34</a> retrieves an existing query from the database, modifies it, then stores the updated version of the query back in the database. These steps simulate editing a query and saving the changes. (Note that if the query does not exist, an exception is thrown.)</p>
<pre dir="ltr">StringBuilder query;
StringBuilder description;
 
// Populate these with the query text and description from the database
query = new StringBuilder( );
description = new StringBuilder( );
 
// Get the query from the database
try {
  SGDBHandler.getSparqlQuery( connection, queryId, query, description );
} catch( SQLException sqle ) {
  // Handle exception
  // NOTE: exception is thrown if query with specified ID does not exist
}
 
// The query and description should be populated now
 
// Modify the query 
String updatedQuery = query.toString( ).replaceAll(&#34;invite&#34;, &#34;attendee&#34;);
 
// Insert the query back into the database
boolean ignoreDup = false;
try {
  // First must delete the old query
  SGDBHandler.deleteSparqlQuery( connection, queryId );
  // Now we can add
  SGDBHandler.insertSparqlQuery( connection, queryId, updatedQuery, description.toString( ), ignoreDup );
} catch( SQLException sqle ) {
  // Handle exception
} catch( QueryException qe ) {
  // Handle query syntax exception
}
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431__BGBDCGFC">
<p class="titleinexample">Example 7-35 Retrieving and Printing an XSL Transformation</p>
<p><a href="rdf-jena.htm#GUID-62BFFBF3-55E2-42A1-977D-576DB3A55431__BGBDCGFC">Example 7-35</a> retrieves an existing XSL transformation and prints it to standard output. (Note that if the transformation does not exist, an exception is thrown.)</p>
<pre dir="ltr">StringBuilder xslt;
StringBuilder description;
 
// Populate these with the XSLT text and description from the database
xslt = new StringBuilder( );
description = new StringBuilder( );
 
try {
  SGDBHandler.getXslt( connection, xsltId, xslt, description );
} catch( SQLException sqle ) {
  // Handle exception
  // NOTE: exception is thrown if transformation with specified ID does not exist
}
 
// Print it to standard output
System.out.printf( &#34;XSLT description: %s\n&#34;, description.toString( ) );
System.out.printf( &#34;XSLT body:\n%s\n&#34;, xslt.toString( ) );
</pre></div>
<!-- class="example" --></div>
</div>
<a id="RDFRM503"></a>
<div class="props_rev_3"><a id="GUID-81166E14-3CA8-45A7-A15B-EBDD11497AB6"></a>
<h3 id="RDFRM-GUID-81166E14-3CA8-45A7-A15B-EBDD11497AB6" class="sect3"><span class="enumeration_section">7.17.6</span> Using the SPARQL Gateway Graphical Web Interface</h3>
<div>
<p>SPARQL Gateway provides several browser-based interfaces to help you test queries, navigate semantic data, and manage SPQARQL query and XSLT files:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rdf-jena.htm#GUID-D63AD358-38E1-4454-B0AE-45EE258F0AEB">Main Page (index.html)</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408">Navigation and Browsing Page (browse.jsp)</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-2F97F4B1-0E02-4EE2-A8EA-9FF113B4E26A">XSLT Management Page (xslt.jsp)</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-CC661535-E62C-493A-A4A7-3AA0F008E6CE">SPARQL Management Page (sparql.jsp)</a></p>
</li>
</ul>
</div>
<a id="RDFRM505"></a><a id="RDFRM506"></a><a id="RDFRM504"></a>
<div class="props_rev_3"><a id="GUID-D63AD358-38E1-4454-B0AE-45EE258F0AEB"></a>
<h4 id="RDFRM-GUID-D63AD358-38E1-4454-B0AE-45EE258F0AEB" class="sect4"><span class="enumeration_section">7.17.6.1</span> Main Page (index.html)</h4>
<div>
<p><code class="codeph">http://</code><span class="italic"><code class="codeph">&lt;host&gt;:&lt;port&gt;</code></span><code class="codeph">/sparqlgateway/index.html</code> provides a simple interface for executing SPARQL queries and then applying the transformations in the default.xslt file to the response. <a href="rdf-jena.htm#GUID-D63AD358-38E1-4454-B0AE-45EE258F0AEB__BGBHAFBF">Figure 7-2</a> shows this interface for executing a query.</p>
<div class="figure" id="GUID-D63AD358-38E1-4454-B0AE-45EE258F0AEB__BGBHAFBF">
<p class="titleinfigure">Figure 7-2 Graphical Interface Main Page (index.html)</p>
<img width="1070" height="609" src="img/GUID-49E1704C-4ABE-4A1A-97A4-2FD9CFF5F53B-print.jpg" alt="Description of Figure 7-2 follows" title="Description of Figure 7-2 follows"/><br/>
<a href="img_text/GUID-49E1704C-4ABE-4A1A-97A4-2FD9CFF5F53B-print.htm">Description of &#34;Figure 7-2 Graphical Interface Main Page (index.html)&#34;</a></div>
<!-- class="figure" -->
<p>Enter or select a <span class="bold">SPARQL Endpoint</span>, specify the <span class="bold">SPARQL SELECT Query Body,</span> and press <span class="bold">Submit Query</span>.</p>
<p>For example, if you specify <code class="codeph">http://dbpedia.org/sparql</code> as the SPARQL endpoint and use the SPARQL query body from <a href="rdf-jena.htm#GUID-D63AD358-38E1-4454-B0AE-45EE258F0AEB__BGBHAFBF">Figure 7-2</a>, the response will be similar to <a href="rdf-jena.htm#GUID-D63AD358-38E1-4454-B0AE-45EE258F0AEB__BGBDHAAF">Figure 7-3</a>. Note that the default transformations (in <code class="codeph">default.xslt</code>) have been applied to the XML output in this figure.</p>
<div class="figure" id="GUID-D63AD358-38E1-4454-B0AE-45EE258F0AEB__BGBDHAAF">
<p class="titleinfigure">Figure 7-3 SPARQL Query Main Page Response</p>
<img width="921" height="772" src="img/GUID-9D53FB45-F383-4BAD-BF0D-710C8D22077B-print.jpg" alt="Description of Figure 7-3 follows" title="Description of Figure 7-3 follows"/><br/>
<a href="img_text/GUID-9D53FB45-F383-4BAD-BF0D-710C8D22077B-print.htm">Description of &#34;Figure 7-3 SPARQL Query Main Page Response&#34;</a></div>
<!-- class="figure" --></div>
</div>
<a id="RDFRM508"></a><a id="RDFRM509"></a><a id="RDFRM510"></a><a id="RDFRM507"></a>
<div class="props_rev_3"><a id="GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408"></a>
<h4 id="RDFRM-GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408" class="sect4"><span class="enumeration_section">7.17.6.2</span> Navigation and Browsing Page (browse.jsp)</h4>
<div>
<p><code class="codeph">http://&lt;host&gt;:&lt;port&gt;/sparqlgateway/browse.jsp</code> provides navigation and browsing capabilities for semantic data. It works against any standard compliant SPARQL endpoint. <a href="rdf-jena.htm#GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408__BGBBDEBF">Figure 7-4</a> shows this interface for executing a query.</p>
<div class="figure" id="GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408__BGBBDEBF">
<p class="titleinfigure">Figure 7-4 Graphical Interface Navigation and Browsing Page (browse.jsp)</p>
<img width="676" height="486" src="img/GUID-E228951F-ED4B-426D-892A-BCE3ED1FDF15-print.jpg" alt="Description of Figure 7-4 follows" title="Description of Figure 7-4 follows"/><br/>
<a href="img_text/GUID-E228951F-ED4B-426D-892A-BCE3ED1FDF15-print.htm">Description of &#34;Figure 7-4 Graphical Interface Navigation and Browsing Page (browse.jsp)&#34;</a></div>
<!-- class="figure" -->
<p>Enter or select a <span class="bold">SPARQL Endpoint</span>, specify the <span class="bold">SPARQL SELECT Query Body,</span> optionally specify a <span class="bold">Timeout (ms)</span> value in milliseconds and the <span class="bold">Best Effort</span> option, and press <span class="bold">Submit Query</span>.</p>
<p>The SPARQL response is parsed and then presented in table form, as shown in <a href="rdf-jena.htm#GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408__BGBIHACE">Figure 7-5</a>.</p>
<div class="figure" id="GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408__BGBIHACE">
<p class="titleinfigure">Figure 7-5 Browsing and Navigation Page: Response</p>
<img width="938" height="217" src="img/GUID-085C1EB4-72B9-4B3E-8F3C-82C5C146A8B9-print.jpg" alt="Description of Figure 7-5 follows" title="Description of Figure 7-5 follows"/><br/>
<a href="img_text/GUID-085C1EB4-72B9-4B3E-8F3C-82C5C146A8B9-print.htm">Description of &#34;Figure 7-5 Browsing and Navigation Page: Response&#34;</a></div>
<!-- class="figure" -->
<p>In <a href="rdf-jena.htm#GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408__BGBIHACE">Figure 7-5</a>, note that URIs are clickable to allow navigation, and that when users move the cursor over a URI, tool tips are shown for the URIs which have been shortened for readability (as in <code class="codeph">http://purl.org.dc/elements/1.1/title</code> being displayed as the tool tip for <code class="codeph">dc:title</code> in the figure).</p>
<p>If you click the URI <code class="codeph">http://example.org/book/book5</code> in the output shown in <a href="rdf-jena.htm#GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408__BGBIHACE">Figure 7-5</a>, a new SPARQL query is automatically generated and executed. This generated SPARQL query has three query patterns that use this particular URI as subject, predicate, and object, as shown in <a href="rdf-jena.htm#GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408__BGBCHGIF">Figure 7-6</a>. Such a query can give you a good idea about how this URI is used and how it is related to other resources in the data set.</p>
<div class="figure" id="GUID-8F019E81-641B-4E97-ABC0-4E403FD7F408__BGBCHGIF">
<p class="titleinfigure">Figure 7-6 Query and Response from Clicking URI Link</p>
<img width="1006" height="663" src="img/GUID-430CB1CE-FF48-4184-952A-416D757213CA-print.jpg" alt="Description of Figure 7-6 follows" title="Description of Figure 7-6 follows"/><br/>
<a href="img_text/GUID-430CB1CE-FF48-4184-952A-416D757213CA-print.htm">Description of &#34;Figure 7-6 Query and Response from Clicking URI Link&#34;</a></div>
<!-- class="figure" -->
<p><a id="d38717e7664" class="indexterm-anchor"></a>When there are many matches of a query, the results are organized in pages and you can click on any page. The page size by default is 50 results. To display more (or fewer) than 50 rows per page in a response with the Browsing and Navigation Page (<code class="codeph">browse.jsp</code>), you can specify the <code class="codeph">&amp;resultsPerPage</code> parameter in the URL. For example, to allow 100 rows per page, include the following in the URL:</p>
<pre dir="ltr">&amp;resultsPerPage=100
</pre></div>
</div>
<a id="RDFRM512"></a><a id="RDFRM511"></a>
<div class="props_rev_3"><a id="GUID-2F97F4B1-0E02-4EE2-A8EA-9FF113B4E26A"></a>
<h4 id="RDFRM-GUID-2F97F4B1-0E02-4EE2-A8EA-9FF113B4E26A" class="sect4"><span class="enumeration_section">7.17.6.3</span> XSLT Management Page (xslt.jsp)</h4>
<div>
<p><code class="codeph">http://</code><span class="italic"><code class="codeph">&lt;host&gt;:&lt;port&gt;</code></span><code class="codeph">/sparqlgateway/admin/xslt.jsp</code> provides a simple XSLT management interface. You can enter an XSLT ID (integer) and click <span class="bold">Get XSLT</span> to retrieve both the Description and XSLT Body. You can modify the XSLT Body text and then save the changes by clicking <span class="bold">Save XSLT</span>. Note that there is a previewer to help you navigate among available XSLT definitions.</p>
<p><a href="rdf-jena.htm#GUID-2F97F4B1-0E02-4EE2-A8EA-9FF113B4E26A__BGBFJFEA">Figure 7-7</a> shows the XSLT Management Page.</p>
<div class="figure" id="GUID-2F97F4B1-0E02-4EE2-A8EA-9FF113B4E26A__BGBFJFEA">
<p class="titleinfigure">Figure 7-7 XSLT Management Page</p>
<img width="891" height="656" src="img/GUID-A174DA84-F4F8-4570-BBDD-2205F6D07B05-print.jpg" alt="Description of Figure 7-7 follows" title="Description of Figure 7-7 follows"/><br/>
<a href="img_text/GUID-A174DA84-F4F8-4570-BBDD-2205F6D07B05-print.htm">Description of &#34;Figure 7-7 XSLT Management Page&#34;</a></div>
<!-- class="figure" --></div>
</div>
<a id="RDFRM514"></a><a id="RDFRM513"></a>
<div class="props_rev_3"><a id="GUID-CC661535-E62C-493A-A4A7-3AA0F008E6CE"></a>
<h4 id="RDFRM-GUID-CC661535-E62C-493A-A4A7-3AA0F008E6CE" class="sect4"><span class="enumeration_section">7.17.6.4</span> SPARQL Management Page (sparql.jsp)</h4>
<div>
<p><code class="codeph">http://</code><span class="italic"><code class="codeph">&lt;host&gt;:&lt;port&gt;</code></span><code class="codeph">/sparqlgateway/admin/xslt.jsp</code> provides a simple SPARQL management interface. You can enter a SPARQL ID (integer) and click <span class="bold">Get SPARQL</span> to retrieve both the Description and SPARQL Body. You can modify the SPARQL Body text and then save the changes by clicking <span class="bold">Save SPARQL</span>. Note that there is a previewer to help you navigate among available SPARQL queries.</p>
<p><a href="rdf-jena.htm#GUID-CC661535-E62C-493A-A4A7-3AA0F008E6CE__BGBHIJEB">Figure 7-8</a> shows the SPARQL Management Page.</p>
<div class="figure" id="GUID-CC661535-E62C-493A-A4A7-3AA0F008E6CE__BGBHIJEB">
<p class="titleinfigure">Figure 7-8 SPARQL Management Page</p>
<img width="964" height="677" src="img/GUID-ACD22EF3-B326-4EAF-AA0C-A95E0F1E544A-print.jpg" alt="Description of Figure 7-8 follows" title="Description of Figure 7-8 follows"/><br/>
<a href="img_text/GUID-ACD22EF3-B326-4EAF-AA0C-A95E0F1E544A-print.htm">Description of &#34;Figure 7-8 SPARQL Management Page&#34;</a></div>
<!-- class="figure" --></div>
</div>
</div>
<a id="RDFRM516"></a><a id="RDFRM517"></a><a id="RDFRM518"></a><a id="RDFRM515"></a>
<div class="props_rev_3"><a id="GUID-66E24387-35FA-4F55-9E93-88F4570C6A54"></a>
<h3 id="RDFRM-GUID-66E24387-35FA-4F55-9E93-88F4570C6A54" class="sect3"><span class="enumeration_section">7.17.7</span> Using SPARQL Gateway as an XML Data Source to OBIEE</h3>
<div>
<div class="section">
<p>This section explains how to create an XML Data source for Oracle Business Intelligence Enterprise Edition (OBIEE), by integrating OBIEE with RDF using SPARQL Gateway as a bridge. (The specific steps and illustrations reflect the Oracle BI Administration Tool Version 11.1.1.3.0.100806.0408.000.)</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Start the Oracle BI Administration Tool.</span></li>
<li class="stepexpand"><span>Click <span class="bold">File</span>, then <span class="bold">Import Metadata</span>. The first page of the Import Metadata wizard is displayed, as shown in <a href="rdf-jena.htm#GUID-66E24387-35FA-4F55-9E93-88F4570C6A54__BGBDEFCG">Figure 7-9</a>.</span>
<div>
<div class="figure" id="GUID-66E24387-35FA-4F55-9E93-88F4570C6A54__BGBDEFCG">
<p class="titleinfigure">Figure 7-9 Import Metadata - Select Data Source</p>
<img width="816" height="500" src="img/GUID-F6DEA5AE-0F73-4561-8A81-049A95AED8A0-print.jpg" alt="Description of Figure 7-9 follows" title="Description of Figure 7-9 follows"/><br/>
<a href="img_text/GUID-F6DEA5AE-0F73-4561-8A81-049A95AED8A0-print.htm">Description of &#34;Figure 7-9 Import Metadata - Select Data Source&#34;</a></div>
<!-- class="figure" -->
<p><span class="bold">Connection Type</span>: Select <code class="codeph">XML</code>.</p>
<p><span class="bold">URL</span>: URL for an application to interact with SPARQL Gateway, as explained in <a href="rdf-jena.htm#GUID-5C5AD7B1-7601-431D-9026-2AACDC6A48DE">Using SPARQL Gateway with Semantic Data</a>. You can also include the timeout and best effort options.</p>
<p>Ignore the <span class="bold">User Name</span> and <span class="bold">Password</span> fields.</p>
</div>
</li>
<li class="stepexpand"><span>Click <span class="bold">Next</span>. The second page of the Import Metadata wizard is displayed, as shown in <a href="rdf-jena.htm#GUID-66E24387-35FA-4F55-9E93-88F4570C6A54__BGBCCHFH">Figure 7-10</a>.</span>
<div>
<div class="figure" id="GUID-66E24387-35FA-4F55-9E93-88F4570C6A54__BGBCCHFH">
<p class="titleinfigure">Figure 7-10 Import Metadata - Select Metadata Types</p>
<img width="816" height="498" src="img/GUID-F100C77A-3FB3-4204-9D85-2B2E9A432BA3-print.jpg" alt="Description of Figure 7-10 follows" title="Description of Figure 7-10 follows"/><br/>
<a href="img_text/GUID-F100C77A-3FB3-4204-9D85-2B2E9A432BA3-print.htm">Description of &#34;Figure 7-10 Import Metadata - Select Metadata Types&#34;</a></div>
<!-- class="figure" -->
<p>Select the desired metadata types to be imported. Be sure that <span class="bold">Tables</span> is included in the selected types.</p>
</div>
</li>
<li class="stepexpand"><span>Click <span class="bold">Next</span>. The third page of the Import Metadata wizard is displayed, as shown in <a href="rdf-jena.htm#GUID-66E24387-35FA-4F55-9E93-88F4570C6A54__BGBHEEIG">Figure 7-11</a>.</span>
<div>
<div class="figure" id="GUID-66E24387-35FA-4F55-9E93-88F4570C6A54__BGBHEEIG">
<p class="titleinfigure">Figure 7-11 Import Metadata - Select Metadata Objects</p>
<img width="817" height="497" src="img/GUID-4E4C4A71-F77C-454F-9122-4FC8045B81BF-print.jpg" alt="Description of Figure 7-11 follows" title="Description of Figure 7-11 follows"/><br/>
<a href="img_text/GUID-4E4C4A71-F77C-454F-9122-4FC8045B81BF-print.htm">Description of &#34;Figure 7-11 Import Metadata - Select Metadata Objects&#34;</a></div>
<!-- class="figure" -->
<p>In the <span class="bold">Data Source View</span>, expand the node that has the table icon, select the column names (mapped from projected variables defined in the SPARQL SELECT statement), and click the right-arrow (<span class="bold">&gt;</span>) button to move the selected columns to the <span class="bold">Repository View</span>.</p>
</div>
</li>
<li class="stepexpand"><span>Click <span class="bold">Finish</span>.</span></li>
<li class="stepexpand"><span>Complete the remaining steps for the usual BI Business Model work and Mapping and Presentation definition work, which are not specific to SPARQL Gateway or RDF data.</span></li>
</ol>
</div>
</div>
</div>
<a id="RDFRM743"></a>
<div class="props_rev_3"><a id="GUID-2F00FBFD-B3F4-4E49-9476-25E5F364A9D7"></a>
<h2 id="RDFRM-GUID-2F00FBFD-B3F4-4E49-9476-25E5F364A9D7" class="sect2"><span class="enumeration_section">7.18</span> Deploying Joseki in Apache Tomcat or JBoss</h2>
<div>
<p>If you choose not to deploy Joseki in Oracle WebLogic Server as described in <a href="rdf-jena.htm#GUID-BD74255C-3534-4019-979B-C43817B4C58D" title="This topic briefly describes how to configure and set up the Fuseki-based SPARQL service that connects to Oracle Database.">Setting Up the SPARQL Service</a>, you can deploy it in Apache Tomcat or JBoss as described in the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="rdf-jena.htm#GUID-38F73B74-30F0-44D6-B933-8F12E473FAB5">Deploying Joseki in Apache Tomcat 6.0.29 or 7.0.42</a></p>
</li>
<li>
<p><a href="rdf-jena.htm#GUID-A18AD59B-10B6-41E3-8791-EF9A8DE4A1F6">Deploying Joseki in JBoss 7.1.1</a></p>
</li>
</ul>
</div>
<a id="RDFRM744"></a>
<div class="props_rev_3"><a id="GUID-38F73B74-30F0-44D6-B933-8F12E473FAB5"></a>
<h3 id="RDFRM-GUID-38F73B74-30F0-44D6-B933-8F12E473FAB5" class="sect3"><span class="enumeration_section">7.18.1</span> Deploying Joseki in Apache Tomcat 6.0.29 or 7.0.42</h3>
<div>
<div class="section">
<p>To deploy Joseki in Apache Tomcat 6.0.29 or 7.0.42, follow these steps.</p>
<ol>
<li>
<p>Download and install Apache Tomcat 6.0.29 or 7.0.42.</p>
<p>The directory root for Apache Tomcat installation will be referred to in these instructions as $CATALINA_HOME.</p>
</li>
<li>
<p>Set up environment variables using the following as examples:</p>
<pre dir="ltr">setenv JAVA_HOME&lt; <span class="italic">your_path_here&gt;</span>/jdk16/
setenv PATH <span class="italic">&lt;your_path_here&gt;</span>/jdk16/bin/:$PATH 
setenv CATALINA_HOME <span class="italic">&lt;your_path_here&gt;</span>/apache-tomcat-6.0.29 <span class="italic"><span class="bold">OR</span></span>
setenv CATALINA_HOME <span class="italic">&lt;your_path_here&gt;</span>/apache-tomcat-7.0.42
</pre></li>
<li>
<p>Copy <code class="codeph">ojdbc6.jar</code> into <code class="codeph">${CATALINA_HOME}/lib</code>.</p>
</li>
<li>
<p>Modify <code class="codeph">tomcat-users.xml</code> so that it includes the following:</p>
<pre dir="ltr">&lt;tomcat-users&gt; 
&lt;role rolename=&#34;tomcat&#34;/&gt; 
&lt;role rolename=&#34;role1&#34;/&gt; 
&lt;user username=&#34;tomcat&#34; password=&#34;<span class="italic">&lt;tomcat-password&gt;</span>&#34; roles=&#34;tomcat,manager&#34;/&gt; 
&lt;user username=&#34;both&#34; password=&#34;<span class="italic">&lt;tomcat-password&gt;</span>&#34; roles=&#34;tomcat,role1&#34;/&gt; 
&lt;user username=&#34;role1&#34; password=&#34;<span class="italic">&lt;tomcat-password&gt;</span>&#34; roles=&#34;role1&#34;/&gt; 
&lt;/tomcat-users&gt;
</pre>
<p>However, if you are using Apache Tomcat version 7.0.42, replace roles=&#34;tomcat,manager&#34; with roles=&#34;tomcat,<span class="bold">manager-gui</span>&#34; in the preceding code.</p>
</li>
<li>
<p>Start Tomcat:</p>
<pre dir="ltr">$CATALINA_HOME/bin/startup.sh
</pre>
<p>If this file does not have executable permission, enter the following command and then again attempt to start Tomcat:</p>
<pre dir="ltr">chmod u+x $CATALINA_HOME/bin/startup.sh
</pre></li>
<li>
<p>In a browser go to: <code class="codeph">http://hostname:8080/manager/html</code></p>
<p>If authentication is required, enter <code class="codeph">tomcat</code> for the user and then enter the Tomcat password.</p>
</li>
<li>
<p>Deploy Joseki in Tomcat.</p>
<ol>
<li>
<p>In the Tomcat Manager page (<code class="codeph">http://</code><span class="italic"><code class="codeph">hostname</code></span>:<code class="codeph">8080/manager/html</code>), select <code class="codeph">Deploy directory or WAR file located on server</code>.</p>
</li>
<li>
<p>For <span class="bold">Context Path</span>, enter: <span class="bold">/joseki</span></p>
</li>
<li>
<p>For <span class="bold">WAR or Directory UR</span>L, enter the path to <code class="codeph">joseki.war</code>, for example: <code class="codeph">/tmp/jena_adapter/joseki_web_app/joseki.war</code></p>
</li>
<li>
<p>Click <span class="bold">Deploy</span>.</p>
</li>
</ol>
<p>A directory named <code class="codeph">joseki</code> has been created under <code class="codeph">apache-tomcat-6.0.29/webapps</code> or <code class="codeph">apache-tomcat-7.0.42/webapps</code>. This directory will be referred to as JOSEKI_HOME.</p>
</li>
<li>
<p>Verify that Joseki is installed properly by going to:</p>
<pre dir="ltr">http://<span class="italic">&lt;hostname&gt;</span>:8080/joseki
</pre></li>
<li>
<p>Create a J2EE data source named <span class="italic">OracleSemDS</span>.</p>
<p>During the data source creation, you can specify a user and password for the database schema that contains the relevant semantic data against which SPARQL queries are to be executed. To create a data source in Tomcat, make the following changes:</p>
<ul style="list-style-type: disc;">
<li>
<p>In the global <code class="codeph">$CATALINA_HOME/conf/server.xml</code> file, add the following resource in GlobalNamingResources (customize where needed):</p>
<pre dir="ltr">&lt;Resource name=&#34;OracleSemDS&#34; auth=&#34;Container&#34; type=&#34;oracle.jdbc.pool.OracleDataSource&#34; driverClassName=&#34;oracle.jdbc.OracleDriver&#34; factory=&#34;oracle.jdbc.pool.OracleDataSourceFactory&#34; url=&#34;jdbc:oracle:thin:@hostname:port:sid&#34; user=&#34;username&#34; password=&#34;password&#34; maxActive=&#34;30&#34; maxIdle=&#34;10&#34; maxWait=&#34;-1&#34;/&gt;
</pre></li>
<li>
<p>In the global <code class="codeph">$CATALINA_HOME/conf/context.xml</code> file, add the following link:</p>
<pre dir="ltr">&lt;ResourceLink global=&#34;OracleSemDS&#34; name=&#34;OracleSemDS&#34; type=&#34;oracle.jdbc.pool.OracleDataSource&#34;/&gt;
</pre></li>
</ul>
<p>For more information about setting up data sources, see the Tomcat documentation.</p>
</li>
<li>
<p>Shut down and restart Tomcat:</p>
<pre dir="ltr">$CATALINA_HOME/bin/shutdown.sh 
$CATALINA_HOME/bin/startup.sh
</pre></li>
<li>
<p>Verify your deployment by going to (assuming that the web application is deployed at port 8080):</p>
<pre dir="ltr">http://<span class="italic">&lt;hostname&gt;</span>:8080/joseki/querymgt?abortqid=0
</pre>
<p>You should see an XML response, which indicates a successful deployment of Joseki with the RDF Semantic Graph support for Apache Jena query management servlet.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="RDFRM745"></a>
<div class="props_rev_3"><a id="GUID-A18AD59B-10B6-41E3-8791-EF9A8DE4A1F6"></a>
<h3 id="RDFRM-GUID-A18AD59B-10B6-41E3-8791-EF9A8DE4A1F6" class="sect3"><span class="enumeration_section">7.18.2</span> Deploying Joseki in JBoss 7.1.1</h3>
<div>
<div class="section">
<p>To deploy Joseki in JBoss 7.1.1, follow these steps. (The steps have also been tested, with modifications as needed, against Red Hat JBoss Enterprise Application Platform 6.1.0.)</p>
<ol>
<li>
<p>Download and install JBoss Application Server 7.1.1.</p>
<p>These instructions assume that <code class="codeph">jboss-as-7.1.1.Final/</code> is the top-level directory of the JBoss installation.</p>
</li>
<li>
<p>Install the JDBC driver:</p>
<pre dir="ltr">create directory jboss-as-7.1.1.Final/modules/oracle/jdbc/main/
</pre></li>
<li>
<p>Copy <code class="codeph">ojdbc6.jar</code> into this directory</p>
</li>
<li>
<p>Create <code class="codeph">module.xml</code> in this directory with the following content:</p>
<pre dir="ltr">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
 &lt;module xmlns=&#34;urn:jboss:module:1.0&#34; name=&#34;oracle.jdbc&#34;&gt;
     &lt;resources&gt;
        &lt;resource-root path=&#34;ojdbc6.jar&#34;/&gt;
    &lt;/resources&gt;
    &lt;dependencies&gt;
        &lt;module name=&#34;javax.api&#34;/&gt;
         &lt;module name=&#34;javax.transaction.api&#34;/&gt;
     &lt;/dependencies&gt;
&lt;/module&gt;
</pre></li>
<li>
<p>Modify <code class="codeph">jboss-as-7.1.1.Final/standalone/configuration/standalone.xml</code> by adding the following line:</p>
<pre dir="ltr">&lt;driver name=&#34;OracleJDBCDriver&#34; module=&#34;oracle.jdbc&#34;/&gt;
</pre>
<p>The modified <code class="codeph">standalone.xml</code> file should include the following:</p>
<pre dir="ltr">...
       &lt;drivers&gt;
         &lt;driver name=&#34;OracleJDBCDriver&#34; module=&#34;oracle.jdbc&#34;/&gt;
         &lt;driver name=&#34;h2&#34; module=&#34;com.h2database.h2&#34;&gt;
              &lt;xa-datasource-class&gt;org.h2.jdbcx.JdbcDataSource&lt;/xa-datasource-class&gt;
          &lt;/driver&gt;
       &lt;/drivers&gt;
...
</pre></li>
<li>
<p>Create the necessary data source.</p>
<ol>
<li>
<p>Log into the JBoss AS Administration Console:</p>
<pre dir="ltr">http://<span class="italic">&lt;hostname&gt;</span>:9990/console/App.html#server-overview
</pre></li>
<li>
<p>Click <span class="bold">Datasource</span>.</p>
</li>
<li>
<p>Click <span class="bold">Profile</span>.</p>
</li>
<li>
<p>Click <span class="bold">Add</span>, and enter the following:</p>
<p><span class="bold">Name</span>: <code class="codeph">OracleSemDS</code></p>
<p><span class="bold">JNDI Name</span>: <code class="codeph">java:jboss/datasources/OracleSemDS</code></p>
</li>
<li>
<p>Select <span class="bold">OracleJDBCDriver</span>.</p>
</li>
<li>
<p>Click <span class="bold">Next</span>.</p>
<p>The following information is displayed:</p>
<pre dir="ltr">Connection URL: jdbc:oracle:thin:@hostname:port:sid     NOTE: customize
Username:    scott                                       NOTE: customize
Password:    tiger                                       NOTE: customize
Security Domain: (Leave empty)
</pre></li>
<li>
<p>Customize the information as needed and leave Security Domain blank, and click <span class="bold">Done</span>.</p>
</li>
</ol>
</li>
<li>
<p>Highlight this new data source, click <span class="bold">Enable</span>, then click <span class="bold">Confirm</span>.</p>
</li>
<li>
<p>Deploy the <code class="codeph">joseki.war</code> file using the JBoss Administration Console.</p>
<ol>
<li>
<p>Go to the following page:</p>
<pre dir="ltr">http://&lt;hostname&gt;:9990/console/App.html#deployments
</pre></li>
<li>
<p>Click <span class="bold">Deployments</span>.</p>
</li>
<li>
<p>Click <span class="bold">Manage Deployments</span>.</p>
</li>
<li>
<p>Click <span class="bold">Add</span> and specify the <code class="codeph">joseki.war</code> file.</p>
</li>
</ol>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment4500">
<tr>
<td class="cellalignment4507">
<table class="cellalignment4505">
<tr>
<td class="cellalignment4504"><a href="wm-rdf.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment4504"><a href="rdf-sesame.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2005, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment4509">
<table class="cellalignment4503">
<tr>
<td class="cellalignment4504"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment4504"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment4504"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment4504"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment4504"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment4504"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>