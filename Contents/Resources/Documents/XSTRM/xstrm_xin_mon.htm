<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-114718"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Monitoring%20XStream%20In"></a><title>Monitoring XStream In</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="description" content="You can monitor an XStream In configuration."/>
<meta name="keywords" content="XStream, monitoring, ALL_XSTREAM_INBOUND view, ALL_APPLY view, positions, XStream In, position, inbound servers, ALL_XSTREAM_INBOUND_PROGRESS view, applied low position, spill position, applied high position, processed low position, GET_SOURCE_DATABASE_NAME member function, GET_OBJECT_OWNER member function, GET_OBJECT_NAME member function, IS_NULL_TAG member function, GET_DDL_TEXT member function, logical change records (LCRs), getting information about, GET_VALUES member function, GET_COMMA, ALL_APPLY_ERROR view, GET_ERROR_MESSAGE function"/>
<meta name="dcterms.created" content="2017-06-13T10:02:49Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database XStream Guide"/>
<meta name="dcterms.identifier" content="E53119-03"/>
<meta name="dcterms.isVersionOf" content="XSTRM"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2009, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="xstrm_xin_man.htm" title="Previous" type="text/html"/>
<link rel="Next" href="xstrm_xin_trouble.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E53119-03.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-46B54351-BA11-412B-A23F-92F44739A8F6"></a> <span id="PAGE" style="display:none;">18/24</span> <!-- End Header -->
<a id="XSTRM72716"></a>
<h1 id="XSTRM-GUID-46B54351-BA11-412B-A23F-92F44739A8F6" class="sect1"><span class="enumeration_chapter">11</span> Monitoring XStream In</h1>
<div>
<p>You can monitor an XStream In configuration.</p>
<p>With XStream In, an Oracle Streams apply process functions as an inbound server. Therefore, you can also use the data dictionary views for apply processes to monitor inbound servers.</p>
<div class="infobox-note" id="GUID-46B54351-BA11-412B-A23F-92F44739A8F6__GUID-86BD077C-2A30-4AE7-A1E5-FC98A2535752">
<p class="notep1">Note:</p>
<p>Whenever possible, this chapter uses <code class="codeph">ALL_</code> static data dictionary views for query examples. In some cases, information in the <code class="codeph">ALL_</code> views is more limited than the information in the <code class="codeph">DBA_</code> views.</p>
<p>In SQL*Plus, trusted XStream administrators can query the <code class="codeph">ALL_</code> and <code class="codeph">DBA_</code> views. Untrusted XStream administrators can query the <code class="codeph">ALL_</code> views only.</p>
</div>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="xstrm_xin_mon.htm#GUID-7CF8AC35-4AB0-4466-B6F2-AE13B7CA7435">Displaying Session Information for Inbound Servers</a></strong><br/>
An example illustrates displaying session information for inbound servers.</li>
<li class="ulchildlink"><strong><a href="xstrm_xin_mon.htm#GUID-86433F0C-AA89-4277-B364-7E13287725EA">Displaying General Information About an Inbound Server</a></strong><br/>
An example illustrates displaying general information about an inbound server.</li>
<li class="ulchildlink"><strong><a href="xstrm_xin_mon.htm#GUID-58FD2C89-0214-472E-8AB5-56F773BB3B7B">Displaying the Status and Error Information for an Inbound Server</a></strong><br/>
An example illustrates displaying the status and error information for an inbound server.</li>
<li class="ulchildlink"><strong><a href="xstrm_xin_mon.htm#GUID-8F223E94-B47E-470E-913F-82FCAC0074EF">Displaying Apply Parameter Settings for an Inbound Server</a></strong><br/>
An example illustrates displaying apply parameter settings for an inbound server.</li>
<li class="ulchildlink"><strong><a href="xstrm_xin_mon.htm#GUID-00B0D22F-CD20-4404-AE18-5E7FB6E972BF">Displaying the Position Information for an Inbound Server</a></strong><br/>
An example illustrates displaying the position information for an inbound server.</li>
<li class="ulchildlink"><strong><a href="xstrm_xin_mon.htm#GUID-43A987B4-7F6C-4BC3-A813-F6E062175207">Checking for Apply Errors</a></strong><br/>
An example illustrates checking for apply errors.</li>
<li class="ulchildlink"><strong><a href="xstrm_xin_mon.htm#GUID-505C729C-5893-4B22-A981-33BF3084C67B">Displaying Detailed Information About Apply Errors</a></strong><br/>
SQL scripts display detailed information about the error transactions in the error queue in a database.</li>
</ul>
<div class="infoboxnotealso" id="GUID-46B54351-BA11-412B-A23F-92F44739A8F6__GUID-E30081A2-33F7-4917-A48F-1BA3EAFFB6CB">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="xstrm_xout_cncpt.htm#GUID-B59B1F79-91F6-4495-B946-5DCEB317E0D6" title="Become familiar with concepts related to XStream Out.">XStream Out Concepts</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="xstrm_intro.htm#GUID-21FC23DF-2881-4CFD-AF74-9A1173D768FF" title="There are several common XStream use cases.">XStream Use Cases</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="xstrm_xout_config.htm#GUID-1338E648-E214-4666-98A1-8B8D0085EB23" title="You can configure the Oracle Database components that are used by XStream Out.">Configuring XStream Out</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="xstrm_xin_trouble.htm#GUID-5A6A993B-2196-4D5A-BB8A-9E5A8E2B641D" title="You can diagnose and correct problems with an XStream In configuration.">Troubleshooting XStream In</a>&#34;</span></p>
</li>
<li>
<p><a class="olink STRMS940" target="_blank" href="../STRMS/strms_apmon.htm#STRMS940"><span><cite>Oracle Streams Concepts and Administration</cite></span></a></p>
</li>
</ul>
</div>
</div>
<a id="XSTRM72898"></a>
<div class="props_rev_3"><a id="GUID-7CF8AC35-4AB0-4466-B6F2-AE13B7CA7435"></a>
<h2 id="XSTRM-GUID-7CF8AC35-4AB0-4466-B6F2-AE13B7CA7435" class="sect2"><span class="enumeration_section">11.1</span> Displaying Session Information for Inbound Servers</h2>
<div>
<p>An example illustrates displaying session information for inbound servers.</p>
<div class="section">
<p>The query in this section displays the following session information about each XStream component in a database:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>The XStream component name</p>
</li>
<li>
<p>The session identifier</p>
</li>
<li>
<p>The serial number</p>
</li>
<li>
<p>The operating system process identification number</p>
</li>
<li>
<p>The XStream process number</p>
</li>
</ul>
<p>This query is especially useful for determining the session information for specific XStream components when there are multiple XStream In components configured in a database.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">To display this information for each XStream component in a database:</p>
<ol>
<li>
<p>Connect to the database as the XStream administrator.</p>
<p>See <a class="olink ADMIN00102" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=ADMIN00102"><span><cite>Oracle Database Administrator&rsquo;s Guide</cite></span></a> for information about connecting to a database in SQL*Plus.</p>
</li>
<li>
<p>Run the following query:</p>
<pre dir="ltr">COLUMN ACTION HEADING &#39;XStream Component&#39; FORMAT A30
COLUMN SID HEADING &#39;Session ID&#39; FORMAT 99999
COLUMN SERIAL# HEADING &#39;Session|Serial|Number&#39; FORMAT 99999999
COLUMN PROCESS HEADING &#39;Operating System|Process Number&#39; FORMAT A17
COLUMN PROCESS_NAME HEADING &#39;XStream|Process|Number&#39; FORMAT A7
 
SELECT /*+PARAM(&#39;_module_action_old_length&#39;,0)*/ ACTION,
       SID,
       SERIAL#,
       PROCESS,
       SUBSTR(PROGRAM,INSTR(PROGRAM,&#39;(&#39;)+1,4) PROCESS_NAME
  FROM V$SESSION
  WHERE MODULE =&#39;XStream&#39;;
</pre></li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<p>Your output for an XStream In configuration looks similar to the following:</p>
<pre dir="ltr">                                            Session                   XStream
                                             Serial Operating System  Process
XStream Component              Session ID    Number Process Number    Number
------------------------------ ---------- --------- ----------------- -------
XIN - Apply Reader                     19         9 27304             AS01
XIN - Apply Server                     22         5 27308             AS03
XIN - Apply Server                     25        31 27313             AS05
XIN - Apply Coordinator               112         7 27302             AP01
XIN - Apply Server                    113         5 27306             AS02
XIN - Propagation Receiver            114        17 27342             TNS
XIN - Apply Server                    115        39 27311             AS04
</pre>
<p>The row that shows <code class="codeph">TNS</code> for the XStream process number contains information about the session for the XStream client application that is attached to the inbound server.</p>
<div class="infobox-note" id="GUID-7CF8AC35-4AB0-4466-B6F2-AE13B7CA7435__GUID-DB840FD3-F031-4422-8E2F-55F9C0B5076B">
<p class="notep1">Note:</p>
<p>To run this query, a user must have the necessary privileges to query the <code class="codeph">V$SESSION</code> view.</p>
</div>
<div class="infoboxnotealso" id="GUID-7CF8AC35-4AB0-4466-B6F2-AE13B7CA7435__GUID-7850C59E-F31A-4BE5-BB96-CFDE2384CB2A">
<p class="notep1">See Also:</p>
<p><a class="olink REFRN30223" target="_blank" href="../REFRN/GUID-28E2DC75-E157-4C0A-94AB-117C205789B9.htm#REFRN30223"><span><cite>Oracle Database Reference</cite></span></a> for more information about the <code class="codeph">V$SESSION</code> view</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="XSTRM1443"></a>
<div class="props_rev_3"><a id="GUID-86433F0C-AA89-4277-B364-7E13287725EA"></a>
<h2 id="XSTRM-GUID-86433F0C-AA89-4277-B364-7E13287725EA" class="sect2"><span class="enumeration_section">11.2</span> Displaying General Information About an Inbound Server</h2>
<div>
<p>An example illustrates displaying general information about an inbound server.</p>
<div class="section">
<p>You can display the following information for an inbound server by running the query in this section:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>The inbound server name</p>
</li>
<li>
<p>The owner of the queue used by the inbound server</p>
</li>
<li>
<p>The name of the queue used by the inbound server</p>
</li>
<li>
<p>The apply user for the inbound server</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">To display general information about an inbound server:</p>
<ol>
<li>
<p>Connect to the database as the XStream administrator.</p>
<p>See <a class="olink ADMIN00102" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=ADMIN00102"><span><cite>Oracle Database Administrator&rsquo;s Guide</cite></span></a> for information about connecting to a database in SQL*Plus.</p>
</li>
<li>
<p>Run the following query:</p>
<pre dir="ltr">COLUMN SERVER_NAME HEADING &#39;Inbound Server Name&#39; FORMAT A20
COLUMN QUEUE_OWNER HEADING &#39;Queue Owner&#39; FORMAT A15
COLUMN QUEUE_NAME HEADING &#39;Queue Name&#39; FORMAT A15
COLUMN APPLY_USER HEADING &#39;Apply User&#39; FORMAT A15
 
SELECT SERVER_NAME, 
       QUEUE_OWNER,
       QUEUE_NAME,
       APPLY_USER
  FROM ALL_XSTREAM_INBOUND;
</pre></li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<p>Your output looks similar to the following:</p>
<pre dir="ltr">Inbound Server Name  Queue Owner     Queue Name      Apply User
-------------------- --------------- --------------- ---------------
XIN                  XSTRMADMIN      XIN_QUEUE       XSTRMADMIN
</pre>
<div class="infoboxnotealso" id="GUID-86433F0C-AA89-4277-B364-7E13287725EA__GUID-4DDBAA72-0659-46CC-AE7C-C41B687855D1">
<p class="notep1">See Also:</p>
<p><a class="olink REFRN20734" target="_blank" href="../REFRN/GUID-86441938-EBDA-4951-B716-6CF7A8EFD01F.htm#REFRN20734"><span><cite>Oracle Database Reference</cite></span></a></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="XSTRM1444"></a>
<div class="props_rev_3"><a id="GUID-58FD2C89-0214-472E-8AB5-56F773BB3B7B"></a>
<h2 id="XSTRM-GUID-58FD2C89-0214-472E-8AB5-56F773BB3B7B" class="sect2"><span class="enumeration_section">11.3</span> Displaying the Status and Error Information for an Inbound Server</h2>
<div>
<p>An example illustrates displaying the status and error information for an inbound server.</p>
<div class="section">
<p>The <code class="codeph">DBA_APPLY</code> view shows <code class="codeph">XStream</code> <code class="codeph">In</code> in the <code class="codeph">PURPOSE</code> column for an apply process that is functioning as an inbound server.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">To display the status of an inbound server:</p>
<ol>
<li>
<p>Connect to the database as the XStream administrator.</p>
<p>See <a class="olink ADMIN00102" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=ADMIN00102"><span><cite>Oracle Database Administrator&rsquo;s Guide</cite></span></a> for information about connecting to a database in SQL*Plus.</p>
</li>
<li>
<p>Run the following query:</p>
<pre dir="ltr">COLUMN APPLY_NAME HEADING &#39;Inbound Server|Name&#39; FORMAT A15
COLUMN STATUS HEADING &#39;Status&#39; FORMAT A8
COLUMN ERROR_NUMBER HEADING &#39;Error Number&#39; FORMAT 9999999
COLUMN ERROR_MESSAGE HEADING &#39;Error Message&#39; FORMAT A40

SELECT APPLY_NAME, 
       STATUS,
       ERROR_NUMBER,
       ERROR_MESSAGE
  FROM DBA_APPLY
  WHERE PURPOSE = &#39;XStream In&#39;;
</pre></li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<p>Your output looks similar to the following:</p>
<pre dir="ltr">Inbound Server
Name            Status   Error Number Error Message
--------------- -------- ------------ ----------------------------------------
XIN             ENABLED
</pre>
<p>This output shows that <code class="codeph">XIN</code> is an apply process that is functioning as an inbound server.</p>
<div class="infobox-note" id="GUID-58FD2C89-0214-472E-8AB5-56F773BB3B7B__GUID-4F3F8219-5454-4EA3-8ABC-1143A491AA27">
<p class="notep1">Note:</p>
<p>This example queries the <code class="codeph">DBA_APPLY</code> view. This view enables trusted users to see information for all apply users in the database. Untrusted users must query the <code class="codeph">ALL_APPLY</code> view, which limits information to the current user.</p>
</div>
<div class="infoboxnotealso" id="GUID-58FD2C89-0214-472E-8AB5-56F773BB3B7B__GUID-AE34290C-06E1-4068-ACCB-21C36574BEAA">
<p class="notep1">See Also:</p>
<p><a class="olink REFRN20005" target="_blank" href="../REFRN/GUID-ADE0F4DF-5900-4474-B5A9-9DC2C09C1AE8.htm#REFRN20005"><span><cite>Oracle Database Reference</cite></span></a></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="XSTRM72899"></a>
<div class="props_rev_3"><a id="GUID-8F223E94-B47E-470E-913F-82FCAC0074EF"></a>
<h2 id="XSTRM-GUID-8F223E94-B47E-470E-913F-82FCAC0074EF" class="sect2"><span class="enumeration_section">11.4</span> Displaying Apply Parameter Settings for an Inbound Server</h2>
<div>
<p>An example illustrates displaying apply parameter settings for an inbound server.</p>
<div class="section">
<p>Apply parameters determine how an inbound server operates.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">To display the apply parameter settings for an inbound server:</p>
<ol>
<li>
<p>Connect to the database as the XStream administrator.</p>
<p>See <a class="olink ADMIN00102" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=ADMIN00102"><span><cite>Oracle Database Administrator&rsquo;s Guide</cite></span></a> for information about connecting to a database in SQL*Plus.</p>
</li>
<li>
<p>Run the following query:</p>
<pre dir="ltr">COLUMN APPLY_NAME HEADING &#39;Inbound Server|Name&#39; FORMAT A15
COLUMN PARAMETER HEADING &#39;Parameter&#39; FORMAT A30
COLUMN VALUE HEADING &#39;Value&#39; FORMAT A22
COLUMN SET_BY_USER HEADING &#39;Set by|User?&#39; FORMAT A10

SELECT APPLY_NAME,
       PARAMETER, 
       VALUE,
       SET_BY_USER  
  FROM ALL_APPLY_PARAMETERS a, ALL_XSTREAM_INBOUND i
  WHERE a.APPLY_NAME=i.SERVER_NAME
  ORDER BY a.PARAMETER;
</pre></li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<p>Your output looks similar to the following:</p>
<pre dir="ltr">Inbound Server                                                        Set by
Name            Parameter                      Value                  User?
--------------- ------------------------------ ---------------------- ----------
XIN             ALLOW_DUPLICATE_ROWS           N                      NO
XIN             APPLY_SEQUENCE_NEXTVAL         Y                      NO
XIN             COMMIT_SERIALIZATION           DEPENDENT_TRANSACTIONS NO
XIN             COMPARE_KEY_ONLY               Y                      NO
XIN             COMPUTE_LCR_DEP_ON_ARRIVAL     N                      NO
XIN             DISABLE_ON_ERROR               Y                      NO
XIN             DISABLE_ON_LIMIT               N                      NO
XIN             EAGER_SIZE                     9500                   NO
XIN             ENABLE_XSTREAM_TABLE_STATS     Y                      NO
XIN             EXCLUDETAG                                            NO
XIN             EXCLUDETRANS                                          NO
XIN             EXCLUDEUSER                                           NO
XIN             EXCLUDEUSERID                                         NO
XIN             GETAPPLOPS                     Y                      NO
XIN             GETREPLICATES                  N                      NO
XIN             GROUPTRANSOPS                  250                    NO
XIN             HANDLECOLLISIONS               N                      NO
XIN             IGNORE_TRANSACTION                                    NO
XIN             MAXIMUM_SCN                    INFINITE               NO
XIN             MAX_PARALLELISM                50                     NO
XIN             MAX_SGA_SIZE                   INFINITE               NO
XIN             OPTIMIZE_PROGRESS_TABLE        Y                      NO
XIN             OPTIMIZE_SELF_UPDATES          Y                      NO
XIN             PARALLELISM                    4                      NO
XIN             PRESERVE_ENCRYPTION            Y                      NO
XIN             RTRIM_ON_IMPLICIT_CONVERSION   Y                      NO
XIN             STARTUP_SECONDS                0                      NO
XIN             SUPPRESSTRIGGERS               Y                      NO
XIN             TIME_LIMIT                     INFINITE               NO
XIN             TRACE_LEVEL                    0                      NO
XIN             TRANSACTION_LIMIT              INFINITE               NO
XIN             TXN_AGE_SPILL_THRESHOLD        900                    NO
XIN             TXN_LCR_SPILL_THRESHOLD        10000                  NO
XIN             WRITE_ALERT_LOG                Y                      NO
</pre>
<p>Inbound servers ignore some apply parameter settings. See <a class="olink ARPLS73395" target="_blank" href="../ARPLS/d_apply.htm#ARPLS73395"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about these apply parameters.</p>
<div class="infobox-note" id="GUID-8F223E94-B47E-470E-913F-82FCAC0074EF__GUID-F731C25E-FD79-496A-BEB8-271F0C7DD476">
<p class="notep1">Note:</p>
<p>If the <code class="codeph">Set</code> <code class="codeph">by</code> <code class="codeph">User?</code> column is <code class="codeph">NO</code> for a parameter, then the parameter is set to its default value. If the <code class="codeph">Set</code> <code class="codeph">by</code> <code class="codeph">User?</code> column is <code class="codeph">YES</code> for a parameter, then the parameter was set by a user and might or might not be set to its default value.</p>
</div>
<div class="infoboxnotealso" id="GUID-8F223E94-B47E-470E-913F-82FCAC0074EF__GUID-4E9AA80E-0AD9-407C-BE50-5D74A659A498">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="xstrm_xin_man.htm#GUID-238AFFE0-AA5A-4667-8323-0BA300821BB5" title="Apply parameters control the way an inbound server operates. You set an apply parameter for an inbound server using the SET_PARAMETER procedure in the DBMS_XSTREAM_ADM package.">Setting an Apply Parameter for an Inbound Server</a>&#34;</span></p>
</li>
<li>
<p><a class="olink ARPLS314" target="_blank" href="../ARPLS/d_apply.htm#ARPLS314"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about apply parameters</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="XSTRM1634"></a>
<div class="props_rev_3"><a id="GUID-00B0D22F-CD20-4404-AE18-5E7FB6E972BF"></a>
<h2 id="XSTRM-GUID-00B0D22F-CD20-4404-AE18-5E7FB6E972BF" class="sect2"><span class="enumeration_section">11.5</span> Displaying the Position Information for an Inbound Server</h2>
<div>
<p>An example illustrates displaying the position information for an inbound server.</p>
<div class="section">
<p>For an inbound server, you can view position information by querying the <code class="codeph">ALL_XSTREAM_INBOUND_PROGRESS</code> view. Specifically, you can display the following position information by running the query in this section:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>The inbound server name</p>
</li>
<li>
<p>The applied low position for the inbound server</p>
</li>
<li>
<p>The spill position for the inbound server</p>
</li>
<li>
<p>The applied high position for the inbound server</p>
</li>
<li>
<p>The processed low position for the inbound server</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">To display the position information for an inbound server:</p>
<ol>
<li>
<p>Connect to the database as the XStream administrator.</p>
<p>See <a class="olink ADMIN00102" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=ADMIN00102"><span><cite>Oracle Database Administrator&rsquo;s Guide</cite></span></a> for information about connecting to a database in SQL*Plus.</p>
</li>
<li>
<p>Run the following query:</p>
<pre dir="ltr">COLUMN SERVER_NAME HEADING &#39;Inbound|Server|Name&#39; FORMAT A10
COLUMN APPLIED_LOW_POSITION HEADING &#39;Applied Low|Position&#39; FORMAT A15
COLUMN SPILL_POSITION HEADING &#39;Spill Position&#39; FORMAT A15
COLUMN APPLIED_HIGH_POSITION HEADING &#39;Applied High|Position&#39; FORMAT A15
COLUMN PROCESSED_LOW_POSITION HEADING &#39;Processed Low|Position&#39; FORMAT A15
 
SELECT SERVER_NAME, 
       APPLIED_LOW_POSITION,
       SPILL_POSITION,
       APPLIED_HIGH_POSITION,
       PROCESSED_LOW_POSITION
  FROM ALL_XSTREAM_INBOUND_PROGRESS;
</pre></li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<p>Your output looks similar to the following:</p>
<pre dir="ltr">Inbound
Server     Applied Low                     Applied High    Processed Low
Name       Position        Spill Position  Position        Position
---------- --------------- --------------- --------------- ---------------
XIN        C10A            C11D            C10A            C11D
</pre>
<p>The values of the positions shown in the output were set by the client application that attaches to the inbound server. However, the inbound server determines which values are the current applied low position, spill position, applied high position, and processed low position.</p>
<div class="infoboxnotealso" id="GUID-00B0D22F-CD20-4404-AE18-5E7FB6E972BF__GUID-1F827D79-8AE7-4C4E-BF3B-77E210FA4221">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink REFRN20770" target="_blank" href="../REFRN/GUID-F25FFD1E-34D4-4FB9-861A-82EF9C03802D.htm#REFRN20770"><span><cite>Oracle Database Reference</cite></span></a></p>
</li>
<li>
<p><span class="q">&#34;<a href="xstrm_gen_cncpt.htm#GUID-077AAE24-54CF-4102-9969-9540608FFB65" title="Each LCR has a position attribute. The position of an LCR identifies its placement in the stream of LCRs in a transaction.">Position Order in an LCR Stream</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="xstrm_xin_cncpt.htm#GUID-25617A91-D3E3-4848-9B28-90F5C00743C9" title="A client application streams LCRs to an XStream In inbound server.">Position of LCRs and XStream In</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="XSTRM72900"></a>
<div class="props_rev_3"><a id="GUID-43A987B4-7F6C-4BC3-A813-F6E062175207"></a>
<h2 id="XSTRM-GUID-43A987B4-7F6C-4BC3-A813-F6E062175207" class="sect2"><span class="enumeration_section">11.6</span> Checking for Apply Errors</h2>
<div>
<p>An example illustrates checking for apply errors.</p>
<div class="section">
<p>Trusted users can check for apply errors by querying the <code class="codeph">DBA_APPLY_ERROR</code> data dictionary view or by using Oracle Enterprise Manager Cloud Control. Untrusted users can check for apply errors by querying the <code class="codeph">ALL_APPLY_ERROR</code> data dictionary view.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">To check for apply errors:</p>
<ol>
<li>
<p>Connect to the database as the XStream administrator.</p>
<p>See <a class="olink ADMIN00102" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=ADMIN00102"><span><cite>Oracle Database Administrator&rsquo;s Guide</cite></span></a> for information about connecting to a database in SQL*Plus.</p>
</li>
<li>
<p>Run the following query:</p>
<pre dir="ltr">COLUMN APPLY_NAME HEADING &#39;Inbound|Server|Name&#39; FORMAT A7
COLUMN SOURCE_DATABASE HEADING &#39;Source|Database&#39; FORMAT A8
COLUMN SOURCE_TRANSACTION_ID HEADING &#39;Source|Transaction|ID&#39; FORMAT A11
COLUMN MESSAGE_NUMBER HEADING &#39;Failed Message|in Error|Transaction&#39; FORMAT 99999999
COLUMN ERROR_NUMBER HEADING &#39;Error Number&#39; FORMAT 99999999
COLUMN ERROR_MESSAGE HEADING &#39;Error Message&#39; FORMAT A10
COLUMN MESSAGE_COUNT HEADING &#39;Messages in|Error|Transaction&#39; FORMAT 99999999

SELECT APPLY_NAME, 
       SOURCE_DATABASE, 
       SOURCE_TRANSACTION_ID, 
       MESSAGE_NUMBER,
       ERROR_NUMBER,
       ERROR_MESSAGE,
       MESSAGE_COUNT
  FROM ALL_APPLY_ERROR;
</pre></li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<div class="infobox-note" id="GUID-43A987B4-7F6C-4BC3-A813-F6E062175207__GUID-0ED52FBA-6D7B-4460-886B-53236148FA37">
<p class="notep1">Note:</p>
<p>Trusted users should replace <code class="codeph">ALL_APPLY_ERROR</code> with <code class="codeph">DBA_APPLY_ERROR</code> in the query.</p>
</div>
<p>If there are any apply errors, then your output looks similar to the following:</p>
<pre dir="ltr">Inbound          Source      Failed Message                         Messages in
Server  Source   Transaction       in Error                               Error
Name    Database ID             Transaction Error Number Error Mess Transaction
------- -------- ----------- -------------- ------------ ---------- -----------
XIN     OUTX.EXA 19.20.215                1         1031 ORA-01031:           1
        MPLE.COM                                          insuffici
                                                         ent privil
                                                         eges
XIN     OUTX.EXA 11.21.158                1         1031 ORA-01031:           1
        MPLE.COM                                          insuffici
                                                         ent privil
                                                         eges
</pre>
<p>If there are apply errors, then you can either try to reexecute the transactions that encountered the errors, or you can delete the transactions. To reexecute a transaction that encountered an error, first correct the condition that caused the transaction to raise an error.</p>
<p>If you want to delete a transaction that encountered an error, and if you are sharing data between multiple databases, then you might need to resynchronize data manually. Remember to set an appropriate session tag, if necessary, when you resynchronize data manually.</p>
<div class="infoboxnotealso" id="GUID-43A987B4-7F6C-4BC3-A813-F6E062175207__GUID-D9BDF9A0-2E5A-4843-A149-7C3DEF02D9A9">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="xstrm_xin_cncpt.htm#GUID-5602248A-8DE3-495B-B1E9-F1F61CC798C3" title="The error queue contains all of the current apply errors for a database. If there are multiple inbound servers in a database, then the error queue contains the apply errors for each inbound server.">The Error Queue for an Inbound Server</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="xstrm_xin_man.htm#GUID-52AE0882-647F-4C68-89DD-E1D658569BA7" title="Apply errors result when an inbound server tries to apply an LCR, and an error is raised.">Managing Apply Errors</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="XSTRM72901"></a>
<div class="props_rev_3"><a id="GUID-505C729C-5893-4B22-A981-33BF3084C67B"></a>
<h2 id="XSTRM-GUID-505C729C-5893-4B22-A981-33BF3084C67B" class="sect2"><span class="enumeration_section">11.7</span> Displaying Detailed Information About Apply Errors</h2>
<div>
<p>SQL scripts display detailed information about the error transactions in the error queue in a database.</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><strong><a href="xstrm_xin_mon.htm#GUID-594AF23D-BE6E-4EA1-BA18-25C4F5ADBB87">Step 1: Grant Explicit SELECT Privilege on the ALL_APPLY_ERROR View</a></strong><br/>
Running the <code class="codeph">GRANT_ADMIN_PRIVILEGE</code> procedure in the <code class="codeph">DBMS_XSTREAM_AUTH</code> package on a user grants the <code class="codeph">SELECT</code> privilege on the <code class="codeph">ALL_APPLY_ERROR</code> view to the user.</li>
<li class="ulchildlink"><strong><a href="xstrm_xin_mon.htm#GUID-04D3B1E9-8AF4-4D47-9857-87056038B667">Step 2: Create a Procedure that Prints the Value in an ANYDATA Object</a></strong><br/>
Create a procedure that prints the value in a specified <code class="codeph">ANYDATA</code> object for some selected data types. Optionally, you can add more data types to this procedure.</li>
<li class="ulchildlink"><strong><a href="xstrm_xin_mon.htm#GUID-E471ED4F-7EE1-4D5B-ACE5-2298F6EF30D7">Step 3: Create a Procedure that Prints a Specified LCR</a></strong><br/>
Create a procedure that prints a specified LCR.</li>
<li class="ulchildlink"><strong><a href="xstrm_xin_mon.htm#GUID-9BF31D03-3451-4C42-8B50-4E185C7B2007">Step 4: Create a Procedure that Prints All the LCRs in the Error Queue</a></strong><br/>
Create a procedure that prints all of the LCRs in all of the error queues.</li>
<li class="ulchildlink"><strong><a href="xstrm_xin_mon.htm#GUID-E7D5279F-3F3A-431B-B25F-5D3C699208DC">Step 5: Create a Procedure that Prints All the Error LCRs for a Transaction</a></strong><br/>
Create a procedure that prints all the LCRs in the error queue for a particular transaction.</li>
</ul>
<div class="infoboxnotealso" id="GUID-505C729C-5893-4B22-A981-33BF3084C67B__GUID-91920954-FFDF-4A04-873A-383CE15CED77">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="xstrm_xin_cncpt.htm#GUID-5602248A-8DE3-495B-B1E9-F1F61CC798C3" title="The error queue contains all of the current apply errors for a database. If there are multiple inbound servers in a database, then the error queue contains the apply errors for each inbound server.">The Error Queue for an Inbound Server</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="xstrm_xin_man.htm#GUID-52AE0882-647F-4C68-89DD-E1D658569BA7" title="Apply errors result when an inbound server tries to apply an LCR, and an error is raised.">Managing Apply Errors</a>&#34;</span></p>
</li>
</ul>
</div>
</div>
<div class="props_rev_3"><a id="GUID-594AF23D-BE6E-4EA1-BA18-25C4F5ADBB87"></a>
<h3 id="XSTRM-GUID-594AF23D-BE6E-4EA1-BA18-25C4F5ADBB87" class="sect3"><span class="enumeration_section">11.7.1</span> Step 1: Grant Explicit SELECT Privilege on the ALL_APPLY_ERROR View</h3>
<div>
<p>Running the <code class="codeph">GRANT_ADMIN_PRIVILEGE</code> procedure in the <code class="codeph">DBMS_XSTREAM_AUTH</code> package on a user grants the <code class="codeph">SELECT</code> privilege on the <code class="codeph">ALL_APPLY_ERROR</code> view to the user.</p>
<div class="section">
<p>The user who creates and runs the <code class="codeph">print_errors</code> and <code class="codeph">print_transaction</code> procedures described in the following sections must be granted explicit <code class="codeph">SELECT</code> privilege on the <code class="codeph">ALL_APPLY_ERROR</code> data dictionary view. This privilege cannot be granted through a role.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To grant explicit SELECT privilege on the <code class="codeph">ALL_APPLY_ERROR</code> view:</p>
<ol>
<li>
<p>In SQL*Plus, connect as an administrative user who can grant privileges.</p>
<p>See <a class="olink ADMIN00102" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=ADMIN00102"><span><cite>Oracle Database Administrator&rsquo;s Guide</cite></span></a> for information about connecting to a database in SQL*Plus.</p>
</li>
<li id="GUID-594AF23D-BE6E-4EA1-BA18-25C4F5ADBB87__CJHEGIFF">
<p>Grant <code class="codeph">SELECT</code> privilege on the <code class="codeph">ALL_APPLY_ERROR</code> data dictionary view to the appropriate user. For example, to grant this privilege to the <code class="codeph">xstrmadmin</code> user, run the following statement:</p>
<pre dir="ltr">GRANT SELECT ON ALL_APPLY_ERROR TO xstrmadmin;
</pre></li>
<li id="GUID-594AF23D-BE6E-4EA1-BA18-25C4F5ADBB87__CJHFIHID">
<p>Grant <code class="codeph">EXECUTE</code> privilege on the <code class="codeph">DBMS_APPLY_ADM</code> package. For example, to grant this privilege to the <code class="codeph">xstrmadmin</code> user, run the following statement:</p>
<pre dir="ltr">GRANT EXECUTE ON DBMS_APPLY_ADM TO xstrmadmin;
</pre></li>
<li>
<p>Connect to the database as the user to whom you granted the privilege in Step&nbsp;<a href="xstrm_xin_mon.htm#GUID-594AF23D-BE6E-4EA1-BA18-25C4F5ADBB87__CJHEGIFF">2</a> and <a href="xstrm_xin_mon.htm#GUID-594AF23D-BE6E-4EA1-BA18-25C4F5ADBB87__CJHFIHID">3</a>.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-04D3B1E9-8AF4-4D47-9857-87056038B667"></a>
<h3 id="XSTRM-GUID-04D3B1E9-8AF4-4D47-9857-87056038B667" class="sect3"><span class="enumeration_section">11.7.2</span> Step 2: Create a Procedure that Prints the Value in an ANYDATA Object</h3>
<div>
<p>Create a procedure that prints the value in a specified <code class="codeph">ANYDATA</code> object for some selected data types. Optionally, you can add more data types to this procedure.</p>
<div class="section">
<pre dir="ltr">CREATE OR REPLACE PROCEDURE print_any(data IN ANYDATA) IS
  tn  VARCHAR2(61);
  str VARCHAR2(4000);
  chr VARCHAR2(1000);
  num NUMBER;
  dat DATE;
  rw  RAW(4000);
  res NUMBER;
BEGIN
  IF data IS NULL THEN
    DBMS_OUTPUT.PUT_LINE(&#39;NULL value&#39;);
    RETURN;
  END IF;
  tn := data.GETTYPENAME();
  IF tn = &#39;SYS.VARCHAR2&#39; THEN
    res := data.GETVARCHAR2(str);
    DBMS_OUTPUT.PUT_LINE(SUBSTR(str,0,253));
  ELSIF tn = &#39;SYS.CHAR&#39; then
    res := data.GETCHAR(chr);
    DBMS_OUTPUT.PUT_LINE(SUBSTR(chr,0,253));
  ELSIF tn = &#39;SYS.VARCHAR&#39; THEN
    res := data.GETVARCHAR(chr);
    DBMS_OUTPUT.PUT_LINE(chr);
  ELSIF tn = &#39;SYS.NUMBER&#39; THEN
    res := data.GETNUMBER(num);
    DBMS_OUTPUT.PUT_LINE(num);
  ELSIF tn = &#39;SYS.DATE&#39; THEN
    res := data.GETDATE(dat);
    DBMS_OUTPUT.PUT_LINE(dat);
  ELSIF tn= &#39;SYS.TIMESTAMP&#39; THEN
    res := data.GETTIMESTAMP(dat);
    DBMS_OUTPUT.PUT_LINE(TO_CHAR(dat,&#39;DD-MON-RR HH.MI.SSXFF AM&#39;));
  ELSIF tn= &#39;SYS.TIMESTAMPTZ&#39; THEN
    res := data.GETTIMESTAMPTZ(dat);
    DBMS_OUTPUT.PUT_LINE(TO_CHAR(dat,&#39;DD-MON-RR HH.MI.SSXFF AM&#39;));
  ELSIF tn= &#39;SYS.TIMESTAMPLTZ&#39; THEN
    res := data.GETTIMESTAMPLTZ(dat);
    DBMS_OUTPUT.PUT_LINE(TO_CHAR(dat,&#39;DD-MON-RR HH.MI.SSXFF AM&#39;));
  ELSIF tn = &#39;SYS.RAW&#39; THEN
    -- res := data.GETRAW(rw);
    -- DBMS_OUTPUT.PUT_LINE(SUBSTR(DBMS_LOB.SUBSTR(rw),0,253));
    DBMS_OUTPUT.PUT_LINE(&#39;BLOB Value&#39;);
  ELSIF tn = &#39;SYS.BLOB&#39; THEN
    DBMS_OUTPUT.PUT_LINE(&#39;BLOB Found&#39;);
  ELSE
    DBMS_OUTPUT.PUT_LINE(&#39;typename is &#39; || tn);
  END IF;
END print_any;
/
</pre></div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-E471ED4F-7EE1-4D5B-ACE5-2298F6EF30D7"></a>
<h3 id="XSTRM-GUID-E471ED4F-7EE1-4D5B-ACE5-2298F6EF30D7" class="sect3"><span class="enumeration_section">11.7.3</span> Step 3: Create a Procedure that Prints a Specified LCR</h3>
<div>
<p>Create a procedure that prints a specified LCR.</p>
<div class="section">
<p>The procedure calls the <code class="codeph">print_any</code> procedure created in <span class="q">&#34;<a href="xstrm_xin_mon.htm#GUID-04D3B1E9-8AF4-4D47-9857-87056038B667" title="Create a procedure that prints the value in a specified ANYDATA object for some selected data types. Optionally, you can add more data types to this procedure.">Step 2: Create a Procedure that Prints the Value in an ANYDATA Object</a>&#34;</span>.</p>
<pre dir="ltr">CREATE OR REPLACE PROCEDURE print_lcr(lcr IN ANYDATA) IS
  typenm    VARCHAR2(61);
  ddllcr    SYS.LCR$_DDL_RECORD;
  proclcr   SYS.LCR$_PROCEDURE_RECORD;
  rowlcr    SYS.LCR$_ROW_RECORD;
  res       NUMBER;
  newlist   SYS.LCR$_ROW_LIST;
  oldlist   SYS.LCR$_ROW_LIST;
  ddl_text  CLOB;
  ext_attr  ANYDATA;
BEGIN
  typenm := lcr.GETTYPENAME();
  DBMS_OUTPUT.PUT_LINE(&#39;type name: &#39; || typenm);
  IF (typenm = &#39;SYS.LCR$_DDL_RECORD&#39;) THEN
    res := lcr.GETOBJECT(ddllcr);
    DBMS_OUTPUT.PUT_LINE(&#39;source database: &#39; || 
                         ddllcr.GET_SOURCE_DATABASE_NAME);
    DBMS_OUTPUT.PUT_LINE(&#39;owner: &#39; || ddllcr.GET_OBJECT_OWNER);
    DBMS_OUTPUT.PUT_LINE(&#39;object: &#39; || ddllcr.GET_OBJECT_NAME);
    DBMS_OUTPUT.PUT_LINE(&#39;is tag null: &#39; || ddllcr.IS_NULL_TAG);
    DBMS_LOB.CREATETEMPORARY(ddl_text, TRUE);
    ddllcr.GET_DDL_TEXT(ddl_text);
    DBMS_OUTPUT.PUT_LINE(&#39;ddl: &#39; || ddl_text);    
    -- Print extra attributes in DDL LCR
    ext_attr := ddllcr.GET_EXTRA_ATTRIBUTE(&#39;serial#&#39;);
      IF (ext_attr IS NOT NULL) THEN
        DBMS_OUTPUT.PUT_LINE(&#39;serial#: &#39; || ext_attr.ACCESSNUMBER());
      END IF;
    ext_attr := ddllcr.GET_EXTRA_ATTRIBUTE(&#39;session#&#39;);
      IF (ext_attr IS NOT NULL) THEN
        DBMS_OUTPUT.PUT_LINE(&#39;session#: &#39; || ext_attr.ACCESSNUMBER());
      END IF; 
    ext_attr := ddllcr.GET_EXTRA_ATTRIBUTE(&#39;thread#&#39;);
      IF (ext_attr IS NOT NULL) THEN
        DBMS_OUTPUT.PUT_LINE(&#39;thread#: &#39; || ext_attr.ACCESSNUMBER());
      END IF;   
    ext_attr := ddllcr.GET_EXTRA_ATTRIBUTE(&#39;tx_name&#39;);
      IF (ext_attr IS NOT NULL) THEN
        DBMS_OUTPUT.PUT_LINE(&#39;transaction name: &#39; || ext_attr.ACCESSVARCHAR2());
      END IF;
    ext_attr := ddllcr.GET_EXTRA_ATTRIBUTE(&#39;username&#39;);
      IF (ext_attr IS NOT NULL) THEN
        DBMS_OUTPUT.PUT_LINE(&#39;username: &#39; || ext_attr.ACCESSVARCHAR2());
      END IF;      
    DBMS_LOB.FREETEMPORARY(ddl_text);
  ELSIF (typenm = &#39;SYS.LCR$_ROW_RECORD&#39;) THEN
    res := lcr.GETOBJECT(rowlcr);
    DBMS_OUTPUT.PUT_LINE(&#39;source database: &#39; || 
                         rowlcr.GET_SOURCE_DATABASE_NAME);
    DBMS_OUTPUT.PUT_LINE(&#39;owner: &#39; || rowlcr.GET_OBJECT_OWNER);
    DBMS_OUTPUT.PUT_LINE(&#39;object: &#39; || rowlcr.GET_OBJECT_NAME);
    DBMS_OUTPUT.PUT_LINE(&#39;is tag null: &#39; || rowlcr.IS_NULL_TAG); 
    DBMS_OUTPUT.PUT_LINE(&#39;command_type: &#39; || rowlcr.GET_COMMAND_TYPE); 
    oldlist := rowlcr.GET_VALUES(&#39;old&#39;);
    FOR i IN 1..oldlist.COUNT LOOP
      IF oldlist(i) IS NOT NULL THEN
        DBMS_OUTPUT.PUT_LINE(&#39;old(&#39; || i || &#39;): &#39; || oldlist(i).column_name);
        print_any(oldlist(i).data);
      END IF;
    END LOOP;
    newlist := rowlcr.GET_VALUES(&#39;new&#39;, &#39;n&#39;);
    FOR i in 1..newlist.count LOOP
      IF newlist(i) IS NOT NULL THEN
        DBMS_OUTPUT.PUT_LINE(&#39;new(&#39; || i || &#39;): &#39; || newlist(i).column_name);
        print_any(newlist(i).data);
      END IF;
    END LOOP;
    -- Print extra attributes in row LCR
    ext_attr := rowlcr.GET_EXTRA_ATTRIBUTE(&#39;row_id&#39;);
      IF (ext_attr IS NOT NULL) THEN
        DBMS_OUTPUT.PUT_LINE(&#39;row_id: &#39; || ext_attr.ACCESSUROWID());
      END IF;
    ext_attr := rowlcr.GET_EXTRA_ATTRIBUTE(&#39;serial#&#39;);
      IF (ext_attr IS NOT NULL) THEN
        DBMS_OUTPUT.PUT_LINE(&#39;serial#: &#39; || ext_attr.ACCESSNUMBER());
      END IF;
    ext_attr := rowlcr.GET_EXTRA_ATTRIBUTE(&#39;session#&#39;);
      IF (ext_attr IS NOT NULL) THEN
        DBMS_OUTPUT.PUT_LINE(&#39;session#: &#39; || ext_attr.ACCESSNUMBER());
      END IF; 
    ext_attr := rowlcr.GET_EXTRA_ATTRIBUTE(&#39;thread#&#39;);
      IF (ext_attr IS NOT NULL) THEN
        DBMS_OUTPUT.PUT_LINE(&#39;thread#: &#39; || ext_attr.ACCESSNUMBER());
      END IF;   
    ext_attr := rowlcr.GET_EXTRA_ATTRIBUTE(&#39;tx_name&#39;);
      IF (ext_attr IS NOT NULL) THEN
        DBMS_OUTPUT.PUT_LINE(&#39;transaction name: &#39; || ext_attr.ACCESSVARCHAR2());
      END IF;
    ext_attr := rowlcr.GET_EXTRA_ATTRIBUTE(&#39;username&#39;);
      IF (ext_attr IS NOT NULL) THEN
        DBMS_OUTPUT.PUT_LINE(&#39;username: &#39; || ext_attr.ACCESSVARCHAR2());
      END IF;          
  ELSE
    DBMS_OUTPUT.PUT_LINE(&#39;Non-LCR Message with type &#39; || typenm);
  END IF;
END print_lcr;
/
</pre></div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-9BF31D03-3451-4C42-8B50-4E185C7B2007"></a>
<h3 id="XSTRM-GUID-9BF31D03-3451-4C42-8B50-4E185C7B2007" class="sect3"><span class="enumeration_section">11.7.4</span> Step 4: Create a Procedure that Prints All the LCRs in the Error Queue</h3>
<div>
<p>Create a procedure that prints all of the LCRs in all of the error queues.</p>
<div class="section">
<p>The procedure calls the <code class="codeph">print_lcr</code> procedure created in <span class="q">&#34;<a href="xstrm_xin_mon.htm#GUID-E471ED4F-7EE1-4D5B-ACE5-2298F6EF30D7" title="Create a procedure that prints a specified LCR.">Step 3: Create a Procedure that Prints a Specified LCR</a>&#34;</span>.</p>
<pre dir="ltr">CREATE OR REPLACE PROCEDURE print_errors IS
  CURSOR c IS
    SELECT LOCAL_TRANSACTION_ID,
           SOURCE_DATABASE,
           MESSAGE_NUMBER,
           MESSAGE_COUNT,
           ERROR_NUMBER,
           ERROR_MESSAGE
      FROM ALL_APPLY_ERROR
      ORDER BY SOURCE_DATABASE, SOURCE_COMMIT_SCN;
  i      NUMBER;
  txnid  VARCHAR2(30);
  source VARCHAR2(128);
  msgno  NUMBER;
  msgcnt NUMBER;
  errnum NUMBER := 0;
  errno  NUMBER;
  errmsg VARCHAR2(2000);
  lcr    ANYDATA;
  r      NUMBER;
BEGIN
  FOR r IN c LOOP
    errnum := errnum + 1;
    msgcnt := r.MESSAGE_COUNT;
    txnid  := r.LOCAL_TRANSACTION_ID;
    source := r.SOURCE_DATABASE;
    msgno  := r.MESSAGE_NUMBER;
    errno  := r.ERROR_NUMBER;
    errmsg := r.ERROR_MESSAGE;
DBMS_OUTPUT.PUT_LINE(&#39;*************************************************&#39;);
    DBMS_OUTPUT.PUT_LINE(&#39;----- ERROR #&#39; || errnum);
    DBMS_OUTPUT.PUT_LINE(&#39;----- Local Transaction ID: &#39; || txnid);
    DBMS_OUTPUT.PUT_LINE(&#39;----- Source Database: &#39; || source);
    DBMS_OUTPUT.PUT_LINE(&#39;----Error in Message: &#39;|| msgno);
    DBMS_OUTPUT.PUT_LINE(&#39;----Error Number: &#39;||errno);
    DBMS_OUTPUT.PUT_LINE(&#39;----Message Text: &#39;||errmsg);
    FOR i IN 1..msgcnt LOOP
      DBMS_OUTPUT.PUT_LINE(&#39;--message: &#39; || i);
        lcr := DBMS_APPLY_ADM.GET_ERROR_MESSAGE(i, txnid);
        print_lcr(lcr);
    END LOOP;
  END LOOP;
END print_errors;
/
</pre>
<p>To run this procedure after you create it, enter the following:</p>
<pre dir="ltr">SET SERVEROUTPUT ON SIZE 1000000

EXEC print_errors
</pre></div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-E7D5279F-3F3A-431B-B25F-5D3C699208DC"></a>
<h3 id="XSTRM-GUID-E7D5279F-3F3A-431B-B25F-5D3C699208DC" class="sect3"><span class="enumeration_section">11.7.5</span> Step 5: Create a Procedure that Prints All the Error LCRs for a Transaction</h3>
<div>
<p>Create a procedure that prints all the LCRs in the error queue for a particular transaction.</p>
<div class="section">
<p>The procedure calls the <code class="codeph">print_lcr</code> procedure created in <span class="q">&#34;<a href="xstrm_xin_mon.htm#GUID-E471ED4F-7EE1-4D5B-ACE5-2298F6EF30D7" title="Create a procedure that prints a specified LCR.">Step 3: Create a Procedure that Prints a Specified LCR</a>&#34;</span>.</p>
<pre dir="ltr">CREATE OR REPLACE PROCEDURE print_transaction(ltxnid IN VARCHAR2) IS
  i      NUMBER;
  txnid  VARCHAR2(30);
  source VARCHAR2(128);
  msgno  NUMBER;
  msgcnt NUMBER;
  errno  NUMBER;
  errmsg VARCHAR2(2000);
  lcr    ANYDATA;
BEGIN
  SELECT LOCAL_TRANSACTION_ID,
         SOURCE_DATABASE,
         MESSAGE_NUMBER,
         MESSAGE_COUNT,
         ERROR_NUMBER,
         ERROR_MESSAGE
      INTO txnid, source, msgno, msgcnt, errno, errmsg
      FROM ALL_APPLY_ERROR
      WHERE LOCAL_TRANSACTION_ID =  ltxnid;
  DBMS_OUTPUT.PUT_LINE(&#39;----- Local Transaction ID: &#39; || txnid);
  DBMS_OUTPUT.PUT_LINE(&#39;----- Source Database: &#39; || source);
  DBMS_OUTPUT.PUT_LINE(&#39;----Error in Message: &#39;|| msgno);
  DBMS_OUTPUT.PUT_LINE(&#39;----Error Number: &#39;||errno);
  DBMS_OUTPUT.PUT_LINE(&#39;----Message Text: &#39;||errmsg);
  FOR i IN 1..msgcnt LOOP
  DBMS_OUTPUT.PUT_LINE(&#39;--message: &#39; || i);
    lcr := DBMS_APPLY_ADM.GET_ERROR_MESSAGE(i, txnid); -- gets the LCR
    print_lcr(lcr);
  END LOOP;
END print_transaction;
/
</pre>
<p>To run this procedure after you create it, pass to it the local transaction identifier of an error transaction. For example, if the local transaction identifier is <code class="codeph">1.17.2485</code>, then enter the following:</p>
<pre dir="ltr">SET SERVEROUTPUT ON SIZE 1000000

EXEC print_transaction(&#39;1.17.2485&#39;)
</pre></div>
<!-- class="section" --></div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5143">
<tr>
<td class="cellalignment5150">
<table class="cellalignment5148">
<tr>
<td class="cellalignment5147"><a href="xstrm_xin_man.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5147"><a href="xstrm_xin_trouble.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2009, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5152">
<table class="cellalignment5146">
<tr>
<td class="cellalignment5147"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5147"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5147"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5147"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5147"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5147"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>