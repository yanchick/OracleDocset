<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-106198"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Deploying%20an%20Oracle%20Database%20Application"></a><title>Deploying an Oracle Database Application</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1023"/>
<meta name="dcterms.created" content="2014-07-01T1:46:13Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database 2 Day Developer&#39;s Guide"/>
<meta name="dcterms.identifier" content="E53088-01"/>
<meta name="dcterms.isVersionOf" content="TDDDG"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="sample_app.htm" title="Previous" type="text/html"/>
<link rel="Next" href="index.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E53088-01.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">16/17</span> <!-- End Header -->
<div id="TDDDG70000" class="chapter"><a id="CIHIGEDF"></a>
<h1 class="chapter"><span class="secnum">10</span> <a id="sthref735"></a>Deploying an Oracle Database Application</h1>
<p>This chapter contains:</p>
<ul>
<li>
<p><a href="#CEGEEAAC">About Development and Deployment Environments</a></p>
</li>
<li>
<p><a href="#CEGEJGJE">About Installation Scripts</a></p>
</li>
<li>
<p><a href="#BABIIBHE">Creating Installation Scripts</a></p>
</li>
<li>
<p><a href="#BABBJBEJ">Deploying the Sample Application</a></p>
</li>
<li>
<p><a href="#BABGHJDG">Checking the Validity of an Installation</a></p>
</li>
<li>
<p><a href="#BABICFHF">Archiving the Installation Scripts</a></p>
</li>
</ul>
<a id="CEGEEAAC"></a>
<div id="TDDDG72000" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">About Development and Deployment Environments</h2>
<p>The database on which you develop your application is called the <a id="sthref736"></a><span class="bold">development environment</span>. After developing your application, you can install it on other databases, called <a id="sthref737"></a><span class="bold">deployment environments</span>, where other users can run it.</p>
<p>The first deployment environment is the <a id="sthref738"></a><span class="bold">test environment</span>. In the test environment, you can thoroughly test the functionality of the application, determine whether it is structured correctly, and fix any problems before deploying it in the <a id="sthref739"></a><span class="bold">production environment</span>.</p>
<p>You might also deploy your application to an <a id="sthref740"></a><span class="bold">education environment</span>, either before or after deploying it to the production environment. An education environment provides a place for users to practice running the application without affecting other environments.</p>
<p>If the desired deployment environments do not exist in your organization, you can create them.</p>
</div>
<!-- class="sect1" -->
<a id="CEGEJGJE"></a>
<div id="TDDDG99980" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">About Installation Scripts</h2>
<p>A <span class="bold">script</span> is a series of SQL statements in a file whose name ends with <code>.sql</code> (for example, <code>create_app.sql</code>). When you run a script in a client program such as SQL*Plus or SQL&nbsp;Developer, the SQL statements run in the order in which they appear in the script. A script whose SQL statements create an application is called an <a id="sthref741"></a><span class="bold">installation script</span>. An installation script can either have all the SQL statements needed to create the application or it can be a <span class="bold">master script</span> that runs other scripts.</p>
<p>To deploy an application, you run one or more installation scripts in the deployment environment. For a new application, you must create the installation scripts. For an older application, the installation scripts might exist, but if they do not, you can create them.</p>
<p>This section contains:</p>
<ul>
<li>
<p><a href="#CEGGEBJI">About DDL Statements and Schema Object Dependencies</a></p>
</li>
<li>
<p><a href="#CEGCAHDD">About INSERT Statements and Constraints</a></p>
</li>
</ul>
<a id="CEGGEBJI"></a>
<div id="TDDDG99943" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">About DDL Statements and Schema Object Dependencies</h3>
<p>An installation script contains DDL statements that create schema objects and, optionally, <code>INSERT</code> statements that load data into the tables that its DDL statements create.</p>
<p>To create installation scripts correctly, and to run multiple installation scripts in the correct order, you must understand the <a id="sthref742"></a><a id="sthref743"></a>dependencies between the schema objects of your application.</p>
<p>If the definition of object A references object B, then A depends on B. Therefore, you must create B before you create A. Otherwise, the statement that creates B either fails or creates B in an invalid state, depending on the object type.</p>
<p>For a complex application, the order for creating the objects is rarely obvious. Usually, you must consult the database designer or a diagram of the design.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink ADFNS99967" href="../ADFNS/adfns_dependencies.htm#ADFNS99967"><span class="italic">Oracle Database Development Guide</span></a> for more information about schema object dependencies</p>
</li>
<li>
<p><a href="tdddg_objects.htm#CIHGAJDJ">&#34;About Data Definition Language (DDL) Statements&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CEGCAHDD"></a>
<div id="TDDDG99942" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">About INSERT Statements and Constraints</h3>
<p>When you run an installation script that contains <code>INSERT</code> statements, the <code>INSERT</code> statements insert data from the source tables (in the development environment) into the corresponding new tables in the deployment environment. For each source table in your application, you must determine whether any <a id="sthref744"></a>constraints could be violated when their data is inserted in the new table. If so, you must first disable those constraints, then insert the data, and then try to re-enable the constraints. If a data item violates a constraint, then you cannot re-enable that constraint until you correct the data item.</p>
<p>If you are simply inserting lookup data in correct order (as in <a href="sample_app.htm#BABCBIBH">&#34;Loading the Data&#34;</a>), then constraints are not violated. Therefore, you do not need to disable them first.</p>
<p>If you are inserting data from an outside source (such as a file, spreadsheet, or older application), or from many tables that have much dependent data, disable the constraints before inserting the data.</p>
<p>Some possible ways to disable and re-enable the constraints are:</p>
<ul>
<li>
<p>Using SQL&nbsp;Developer, disable and re-enable the constraints one at a time:</p>
<ol>
<li>
<p>In the Connections frame, select the appropriate table.</p>
</li>
<li>
<p>In the pane labeled with table name, select the subtab Constraints.</p>
</li>
<li>
<p>In the list of all constraints on the table, change <code>ENABLED</code> to <code>DISABLED</code> (or the reverse).</p>
</li>
</ol>
</li>
<li>
<p>Edit the installation script, adding SQL statements that disable and re-enable each constraint.</p>
</li>
<li>
<p>Create a SQL script with SQL statements that disable and enable each constraint.</p>
</li>
<li>
<p>Find the constraints in the Oracle Database data dictionary, and create a SQL script with the SQL statements to disable and enable each constraint.</p>
<p>For example, to find and enable the constraints used in the <code>EVALUATIONS</code>, <code>PERFORMANCE_PARTS</code>, and <code>SCORES</code> tables from <a href="tdddg_objects.htm#BABFEIDE">&#34;Creating Tables&#34;</a>, enter these statements into the Worksheet:</p>
<pre>SELECT &#39;ALTER TABLE &#39;|| TABLE_NAME || &#39; DISABLE CONSTRAINT &#39;|| 
  CONSTRAINT_NAME ||&#39;;&#39;
  FROM user_constraints
 WHERE table_name IN (&#39;EVALUATIONS&#39;,&#39;PERFORMANCE_PARTS&#39;,&#39;SCORES&#39;);
 
SELECT &#39;ALTER TABLE &#39;|| TABLE_NAME || &#39; ENABLE CONSTRAINT &#39;|| 
  CONSTRAINT_NAME ||&#39;;&#39;
  FROM user_constraints
 WHERE table_name IN (&#39;EVALUATIONS&#39;,&#39;PERFORMANCE_PARTS&#39;,&#39;SCORES&#39;);
</pre></li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="tdddg_dml.htm#BABCCIEG">&#34;About the INSERT Statement&#34;</a></p>
</li>
<li>
<p><a href="tdddg_objects.htm#BABJFCCE">&#34;Ensuring Data Integrity in Tables&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABIIBHE"></a>
<div id="TDDDG74000" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Creating Installation Scripts</h2>
<p><a id="sthref745"></a>If an installation script needs only DDL and <code>INSERT</code> statements, then you can create it with either SQL&nbsp;Developer or any text editor. In SQL&nbsp;Developer, you can use either the Cart or the Database Export wizard. Oracle recommends the Cart for installation scripts that you expect to run in multiple deployment environments and the Database Export wizard for installation scripts that you expect to run in only one deployment environment.</p>
<p>If an installation script needs SQL statements that are neither DDL nor <code>INSERT</code> statements, then you must create it with a text editor.</p>
<p>This section explains how to create installation scripts with the Cart and the Database Export wizard, when and how to edit installation scripts that create sequences and triggers, and how create installation scripts for the application in <a href="sample_app.htm#BABBDIEA">Chapter 9, &#34;Developing a Simple Oracle Database Application&#34;</a> (&#34;the sample application&#34;).</p>
<p>This section contains:</p>
<ul>
<li>
<p><a href="#CHDDAAFH">Creating Installation Scripts with the Cart</a></p>
</li>
<li>
<p><a href="#BABBIDCB">Creating an Installation Script with the Database Export Wizard</a></p>
</li>
<li>
<p><a href="#CEGEGHJJ">Editing Installation Scripts that Create Sequences</a></p>
</li>
<li>
<p><a href="#BABJCJIJ">Editing Installation Scripts that Create Triggers</a></p>
</li>
<li>
<p><a href="#CHDJIBIE">Creating Installation Scripts for the Sample Application</a></p>
</li>
</ul>
<a id="CHDDAAFH"></a>
<div id="TDDDG316" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Creating Installation Scripts with the Cart</h3>
<p>The <a id="sthref746"></a>Cart is a convenient tool for deploying Oracle Database objects from one or more database connections to a destination connection. You drag and drop objects from the navigator frame into the Cart window, specify the desired options, and click the Export Cart icon to display the Export Objects dialog box. After you complete the information in that dialog box, SQL&nbsp;Developer creates a <code>.zip</code> file containing scripts (including a master script) to create the objects in the schema of a desired destination connection.</p>
<p class="subhead2"><a id="TDDDG317"></a>To create installation scripts with the Cart:</p>
<ol>
<li>
<p>In the SQL&nbsp;Developer window, click the menu <span class="bold">View</span>.</p>
</li>
<li>
<p>From the View menu, select <span class="bold">Cart</span>.</p>
<p>The Cart window opens. The Export Cart icon is inactive (gray).</p>
<div class="infoboxnotealso">
<p class="notep1">Tip:</p>
In the Cart window, for information about Cart user preferences, press the key <span class="bold">F1</span>.</div>
</li>
<li>
<p>In the Connections frame, select the schema objects that you want the installation script to create and drag them into the Cart window.</p>
<p>In The Cart window, the Export Cart icon is now active (not gray).</p>
</li>
<li>
<p>For each Selected Object of Type <code>TABLE</code>, if you want the installation script to export data, then select the option <span class="bold">Data</span>.</p>
</li>
<li>
<p>Click <span class="bold">Export Cart</span>.</p>
</li>
<li>
<p>In the Export Objects dialog box, enter the desired values in the fields.</p>
<p>For information about these fields, see <a class="olink RPTUG45483" href="../RPTUG/dialogs.htm#RPTUG45483"><span class="italic">Oracle SQL Developer User&#39;s Guide</span></a>.</p>
</li>
<li>
<p>Click <span class="bold">Apply</span>.</p>
<p>SQL&nbsp;Developer creates a <code>.zip</code> file containing scripts (including a master script) to create the objects in the schema of a desired destination connection.</p>
</li>
<li>
<p>In the master script and the scripts that it runs, check that:</p>
<ul>
<li>
<p>Referenced objects are created before their dependent objects.</p>
</li>
<li>
<p>Tables are created before data is inserted into them.</p>
</li>
</ul>
<p>If the installation scripts create sequences, see <a href="#CEGEGHJJ">&#34;Editing Installation Scripts that Create Sequences&#34;</a>.</p>
<p>If the installation scripts create triggers, see <a href="#CEGEGHJJ">&#34;Editing Installation Scripts that Create Sequences&#34;</a>.</p>
<p>If necessary, edit the installation files in the Worksheet or any text editor.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink RPTUG45333" href="../RPTUG/intro.htm#RPTUG45333"><span class="italic">Oracle SQL Developer User&#39;s Guide</span></a> for more information about the Cart</div>
</div>
<!-- class="sect2" -->
<a id="BABBIDCB"></a>
<div id="TDDDG99974" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Creating an Installation Script with the Database Export Wizard</h3>
<p>To create an installation script in SQL&nbsp;Developer with the <a id="sthref747"></a>Database Export wizard, you specify the name of the installation script, the objects and data to export, and the desired options, and the wizard generates an installation script.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
In the following procedure, you might have to enlarge the SQL&nbsp;Developer windows to see all fields and options.</div>
<p class="subhead2"><a id="TDDDG272"></a>To create an installation script with the Database Export wizard:</p>
<ol>
<li>
<p>If you have not done so, create a directory for the installation script, separate from the Oracle Database installation directory (for example, <code>C:\my_exports</code>).</p>
</li>
<li>
<p>In the SQL&nbsp;Developer window, click the menu <span class="bold">Tools</span>.</p>
</li>
<li>
<p>From the menu, select <span class="bold">Database Export</span>.</p>
</li>
<li id="CEGHJJJD">
<p>In the Export Wizard - Step 1 of 5 (Source/Destination) window:</p>
<ol>
<li>
<p>In the Connection field, select your connection to the development environment.</p>
</li>
<li>
<p>Select the desired Export DDL options (and deselect any selected undesired options).</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Do not deselect Terminator, or the installation script will fail.</div>
</li>
<li>
<p>If you do <span class="italic">not</span> want the installation script to export data, then deselect Export Data.</p>
</li>
<li>
<p>In the Save As field, accept the default Single File and type the full path name of the installation script (for example, <code>C:\my_exports\hr_export.sql</code>).</p>
<p>The file name must end with .<code>sql</code>.</p>
</li>
<li id="CEGBCCGG">
<p>Click <span class="bold">Next</span>.</p>
</li>
</ol>
</li>
<li id="CEGDGCHE">
<p>In the Export Wizard - Step 2 of 5 (Types to Export) window:</p>
<ol>
<li>
<p>Deselect the check boxes for the types that you do <span class="italic">not</span> want to export.</p>
<p>Selecting or deselecting Toggle All selects or deselects all check boxes.</p>
</li>
<li>
<p>Click <span class="bold">Next</span>.</p>
</li>
</ol>
</li>
<li>
<p>In the Export Wizard - Step 3 of 5 (Specify Objects) window:</p>
<ol>
<li>
<p>Click <span class="bold">More</span>.</p>
</li>
<li>
<p>In the Schema field, select your schema from the menu.</p>
</li>
<li id="CHDIBFAC">
<p>In the Type field, select from the menu either <code>ALL OBJECTS</code> or a specific object type (for example, <code>TABLE</code>).</p>
</li>
<li>
<p>Click <span class="bold">Lookup</span>.</p>
<p>A list of objects appears in the left frame. If the value of the Type field is <code>ALL OBJECTS</code>, then the list contains all objects in the selected schema. If the value of the Type field is a specific object type, then the list contains all objects of that type in the selected schema.</p>
</li>
<li id="CHDGGCFJ">
<p>Move the objects that you want to export from the left frame to the right frame:</p>
<p>To move all objects, click <span class="bold">&gt;&gt;</span>. (To move all objects back, click <span class="bold">&lt;&lt;</span>.)</p>
<p>To move selected objects, select them and then click <span class="bold">&gt;</span>. (To move selected objects back, select them and click &lt;.)</p>
</li>
<li>
<p>(Optional) Repeat steps <a href="#CHDIBFAC">3</a> through <a href="#CHDGGCFJ">5</a> for other object types.</p>
</li>
<li>
<p>Click <span class="bold">Next</span>.</p>
<p>If you deselected Export Data in the Source/Destination window, then the Export Summary window appears&mdash;go to step&nbsp;<a href="#CEGBBJFF">3</a>.</p>
<p>If you did <span class="italic">not</span> deselect Export Data in the Source/Destination window, then the Export Wizard - Step 4 of 5 (Specify Data) window appears. The lower frame lists the objects that you specified in the Specify Objects window.</p>
</li>
</ol>
</li>
<li>
<p>In the Specify Data window:</p>
<ol>
<li>
<p>Move the objects whose data you <span class="italic">do not</span> want to export from the lower frame to the upper frame:</p>
<p>To move all objects, click the double upward arrow icon. (To move all objects back, click the double downward arrow icon.)</p>
<p>To move selected objects, select them and then click the single upward arrow icon.</p>
</li>
<li>
<p>Click <span class="bold">Next</span>.</p>
</li>
</ol>
</li>
<li id="CEGBBJFF">
<p>In the Export Wizard - Step 5 of 5 (Export Summary) window, click <span class="bold">Finish</span>.</p>
<p>The Exporting window opens, showing that exporting is occurring. When exporting is complete, the Exporting window closes, and the Worksheet shows the contents of the installation script that you specified in the Source/Destination window.</p>
</li>
<li>
<p>In the installation script, check that:</p>
<ul>
<li>
<p>Referenced objects are created before their dependent objects.</p>
</li>
<li>
<p>Tables are created before data is inserted into them.</p>
</li>
</ul>
<p>If necessary, edit the file in the Worksheet or any text editor.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink RPTUG30590" href="../RPTUG/dialogs.htm#RPTUG30590"><span class="italic">Oracle SQL Developer User&#39;s Guide</span></a> for more information about the Database Export wizard</div>
</div>
<!-- class="sect2" -->
<a id="CEGEGHJJ"></a>
<div id="TDDDG99938" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Editing Installation Scripts that Create Sequences</h3>
<p>For a <a id="sthref748"></a><a id="sthref749"></a><a id="sthref750"></a>sequence, SQL&nbsp;Developer generates a <code>CREATE</code> <code>SEQUENCE</code> statement whose <code>START</code> <code>WITH</code> value is relative to the current value of the sequence in the development environment.</p>
<p>If your application uses the sequence to generate unique keys, and you <span class="italic">will not</span> insert the data from the source tables into the corresponding new tables, then you might want to edit the <code>START</code> <code>WITH</code> value in the installation script.</p>
<p>You can edit the installation script in either the Worksheet or any text editor.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="tdddg_objects.htm#BABJIDEG">&#34;Tutorial: Creating a Sequence&#34;</a></div>
</div>
<!-- class="sect2" -->
<a id="BABJCJIJ"></a>
<div id="TDDDG74100" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Editing Installation Scripts that Create Triggers</h3>
<p>If your application has a <code>BEFORE</code> <code>INSERT</code> <a id="sthref751"></a><a id="sthref752"></a><a id="sthref753"></a><a id="sthref754"></a><a id="sthref755"></a>trigger on a source table, and you <span class="italic">will</span> insert the data from that source table into the corresponding new table, then you must decide if you want the trigger to fire before each <code>INSERT</code> statement in the installation script inserts data into the new table.</p>
<p>For example, <code>NEW_EVALUATION_TRIGGER</code> (created in <a href="tdddg_triggers.htm#BABCGBBD">&#34;Tutorial: Creating a Trigger that Generates a Primary Key for a Row Before It Is Inserted&#34;</a>) fires before a row is inserted into the <code>EVALUATIONS</code> table. The trigger generates the unique number for the primary key of that row, using <code>EVALUATIONS_SEQUENCE</code>.</p>
<p>The source <code>EVALUATIONS</code> table is populated with primary keys. If you do not want the installation script to put new primary key values in the new <code>EVALUATIONS</code> table, then you must edit the <code>CREATE</code> <code>TRIGGER</code> statement in the installation script as shown in bold font:</p>
<pre>CREATE OR REPLACE
TRIGGER NEW_EVALUATION_TRIGGER
BEFORE INSERT ON EVALUATIONS
FOR EACH ROW
BEGIN
  <span class="bold">IF :NEW.evaluation_id IS NULL THEN</span>
    :NEW.evaluation_id := evaluations_sequence.NEXTVAL
  <span class="bold">END IF;</span>
END;
</pre>
<p>Also, if the current value of the sequence is not greater than the maximum value in the primary key column, then you must make it greater.</p>
<p>You can edit the installation script in either the Worksheet or any text editor.</p>
<p>Two alternatives to editing the installation script are:</p>
<ul>
<li>
<p>Change the trigger definition in the source file and then re-create the installation script.</p>
<p>For information about changing triggers, see <a href="tdddg_triggers.htm#CHDBBCAJ">&#34;Changing Triggers&#34;</a>.</p>
</li>
<li>
<p>Disable the trigger before running the data installation script, and then re-enable it afterward.</p>
<p>For information about disabling and enabling triggers, see <a href="tdddg_triggers.htm#CHDHIADD">&#34;Disabling and Enabling Triggers&#34;</a>.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="tdddg_triggers.htm#BABDAGJJ">&#34;Creating Triggers&#34;</a></div>
</div>
<!-- class="sect2" -->
<a id="CHDJIBIE"></a>
<div id="TDDDG99936" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Creating Installation Scripts for the Sample Application</h3>
<p>This section explains how to create the following installation scripts for the application in <a href="sample_app.htm#BABBDIEA">Chapter 9, &#34;Developing a Simple Oracle Database Application&#34;</a> (&#34;the sample application&#34;):</p>
<ul>
<li>
<p><code><span class="codeinlinebold">schemas.sql</span></code>, which does in the deployment environment what you did in the development environment in <a href="sample_app.htm#BABJFIDE">&#34;Creating the Schemas for the Application&#34;</a> and <a href="sample_app.htm#BABEEEAA">&#34;Granting Privileges to the Schemas&#34;</a></p>
</li>
<li>
<p><code><span class="codeinlinebold">objects.sql</span></code>, which does in the deployment environment what you did in the development environment in <a href="sample_app.htm#BABFECBG">&#34;Creating the Schema Objects and Loading the Data&#34;</a></p>
</li>
<li>
<p><code><span class="codeinlinebold">employees.sql</span></code>, which does in the deployment environment what you did in the development environment in <a href="sample_app.htm#BABFFCIF">&#34;Creating the employees_pkg Package&#34;</a></p>
</li>
<li>
<p><code><span class="codeinlinebold">admin.sql</span></code>, which does in the deployment environment what you did in the development environment in <a href="sample_app.htm#BABIHFDD">&#34;Creating the admin_pkg Package&#34;</a></p>
</li>
<li>
<p><code><span class="codeinlinebold">create_app.sql</span></code>, a master script that runs the preceding scripts, thereby deploying the sample application in the deployment environment</p>
</li>
</ul>
<p>You can create the scripts in any order. To create <code>schemas.sql</code> and <code>create_app.sql</code>, you must use a text editor. To create the other scripts, you can use either a text editor or SQL&nbsp;Developer.</p>
<p>This section contains:</p>
<ul>
<li>
<p><a href="#CHDIAIHH">Creating Installation Script schemas.sql</a></p>
</li>
<li>
<p><a href="#CHDDDGGJ">Creating Installation Script objects.sql</a></p>
</li>
<li>
<p><a href="#CHDCDIGF">Creating Installation Script employees.sql</a></p>
</li>
<li>
<p><a href="#CHDDBBCC">Creating Installation Script admin.sql</a></p>
</li>
<li>
<p><a href="#CHDEIJFI">Creating Master Installation Script create_app.sql</a></p>
</li>
</ul>
<a id="CHDIAIHH"></a>
<div id="TDDDG118" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Creating Installation Script schemas.sql</h4>
<p>The installation script <code>schemas.sql</code> does in the deployment environment what you did in the development environment in <a href="sample_app.htm#BABJFIDE">&#34;Creating the Schemas for the Application&#34;</a> and <a href="sample_app.htm#BABEEEAA">&#34;Granting Privileges to the Schemas&#34;</a>.</p>
<p>To create <code>schemas.sql</code>, enter the following text in any text editor and save the file as <code>schemas.sql</code>.</p>
<div class="infobox-note">
<p class="notep1">Caution:</p>
Choose secure passwords. For guidelines for secure passwords, see <a class="olink DBSEG10005" href="../DBSEG/guidelines.htm#DBSEG10005"><span class="italic">Oracle Database Security Guide</span></a>.</div>
<pre>-----------------
-- Create schemas
-----------------
 
DROP USER app_data CASCADE;
 
CREATE USER app_data IDENTIFIED BY <span class="italic">password</span>
DEFAULT TABLESPACE USERS
QUOTA UNLIMITED ON USERS
ENABLE EDITIONS;
 
DROP USER app_code CASCADE;
 
CREATE USER app_code IDENTIFIED BY <span class="italic">password</span>
DEFAULT TABLESPACE USERS
QUOTA UNLIMITED ON USERS
ENABLE EDITIONS;
 
DROP USER app_admin CASCADE;
 
CREATE USER app_admin IDENTIFIED BY <span class="italic">password</span>
DEFAULT TABLESPACE USERS
QUOTA UNLIMITED ON USERS
ENABLE EDITIONS;
 
DROP USER app_user CASCADE;
 
CREATE USER app_user IDENTIFIED BY <span class="italic">password</span>
ENABLE EDITIONS;
 
DROP USER app_admin_user CASCADE;
 
CREATE USER app_admin_user IDENTIFIED BY <span class="italic">password</span>
ENABLE EDITIONS;
 
------------------------------
-- Grant privileges to schemas
------------------------------
 
GRANT CREATE SESSION TO app_data;
GRANT CREATE TABLE, CREATE VIEW, CREATE TRIGGER, CREATE SEQUENCE TO app_data;
GRANT SELECT ON HR.DEPARTMENTS TO app_data;
GRANT SELECT ON HR.EMPLOYEES TO app_data;
GRANT SELECT ON HR.JOB_HISTORY TO app_data;
GRANT SELECT ON HR.JOBS TO app_data;
 
GRANT CREATE SESSION, CREATE PROCEDURE, CREATE SYNONYM TO app_code;
 
GRANT CREATE SESSION, CREATE PROCEDURE, CREATE SYNONYM TO app_admin;
 
GRANT CREATE SESSION, CREATE SYNONYM TO app_user;
 
GRANT CREATE SESSION, CREATE SYNONYM TO app_admin_user;
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="sample_app.htm#BABFDGAI">&#34;Schemas for the Application&#34;</a> for descriptions of the schemas for the sample application</div>
</div>
<!-- class="sect3" -->
<a id="CHDDDGGJ"></a>
<div id="TDDDG318" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Creating Installation Script objects.sql</h4>
<p>The installation script <code>objects.sql</code> does in the deployment environment what you did in the development environment in <a href="sample_app.htm#BABFECBG">&#34;Creating the Schema Objects and Loading the Data&#34;</a>.</p>
<p>You can create <code>objects.sql</code> using either a text editor or SQL&nbsp;Developer.</p>
<p>To create <code>objects.sql</code> in any text editor, enter the following text and save the file as <code>objects.sql</code>. For <code><span class="codeinlineitalic">password</span></code>, use the password that <code>schema.sql</code> specifies when it creates the user <code>app_data</code>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The <code>INSERT</code> statements that load the data work only if the deployment environment has a standard <code>HR</code> schema. If it does not, then either use SQL&nbsp;Developer to create a script that loads the new tables (in the deployment environment) with data from the source tables (in the development environment) or modify the <code>INSERT</code> statements in the following script.</div>
<pre>------------------------
-- Create schema objects
------------------------
 
CONNECT app_data/<span class="italic">password</span>
 
CREATE TABLE jobs#
( job_id      VARCHAR2(10)
              CONSTRAINT jobs_pk PRIMARY KEY,
  job_title   VARCHAR2(35)
              CONSTRAINT jobs_job_title_not_null NOT NULL,
  min_salary  NUMBER(6)
              CONSTRAINT jobs_min_salary_not_null NOT NULL,
  max_salary  NUMBER(6)
              CONSTRAINT jobs_max_salary_not_null NOT NULL
)
/
 
CREATE TABLE departments#
( department_id    NUMBER(4)
                   CONSTRAINT departments_pk PRIMARY KEY,
  department_name  VARCHAR2(30)
                   CONSTRAINT dept_department_name_not_null NOT NULL
                   CONSTRAINT dept_department_name_unique UNIQUE,
  manager_id       NUMBER(6) 
)
/
 
CREATE TABLE employees#
( employee_id     NUMBER(6)
                  CONSTRAINT employees_pk PRIMARY KEY,
  first_name      VARCHAR2(20)
                  CONSTRAINT emp_first_name_not_null NOT NULL,
  last_name       VARCHAR2(25)
                  CONSTRAINT emp_last_name_not_null NOT NULL,
  email_addr      VARCHAR2(25) 
                  CONSTRAINT emp_email_addr_not_null NOT NULL,
  hire_date       DATE
                  DEFAULT TRUNC(SYSDATE)
                  CONSTRAINT emp_hire_date_not_null NOT NULL
                  CONSTRAINT emp_hire_date_check
                    CHECK(TRUNC(hire_date) = hire_date),
  country_code    VARCHAR2(5)
                  CONSTRAINT emp_country_code_not_null NOT NULL,
  phone_number    VARCHAR2(20)
                  CONSTRAINT emp_phone_number_not_null NOT NULL,
  job_id          CONSTRAINT emp_job_id_not_null NOT NULL
                  CONSTRAINT emp_to_jobs_fk REFERENCES jobs#,
  job_start_date  DATE
                  CONSTRAINT emp_job_start_date_not_null NOT NULL,
                  CONSTRAINT emp_job_start_date_check
                    CHECK(TRUNC(JOB_START_DATE) = job_start_date),
  salary          NUMBER(6)
                  CONSTRAINT emp_salary_not_null NOT NULL,
  manager_id      CONSTRAINT emp_mgrid_to_emp_empid_fk REFERENCES employees#,
  department_id   CONSTRAINT emp_to_dept_fk REFERENCES departments#
)
/
 
CREATE TABLE job_history#
( employee_id  CONSTRAINT job_hist_to_emp_fk REFERENCES employees#,
  job_id       CONSTRAINT job_hist_to_jobs_fk REFERENCES jobs#,
  start_date   DATE
               CONSTRAINT job_hist_start_date_not_null NOT NULL,
  end_date     DATE
               CONSTRAINT job_hist_end_date_not_null NOT NULL,
  department_id
             CONSTRAINT job_hist_to_dept_fk REFERENCES departments#
             CONSTRAINT job_hist_dept_id_not_null NOT NULL,
             CONSTRAINT job_history_pk PRIMARY KEY(employee_id,start_date),
             CONSTRAINT job_history_date_check CHECK( start_date &lt; end_date )
)
/
 
CREATE EDITIONING VIEW jobs AS SELECT * FROM jobs#
/
CREATE EDITIONING VIEW departments AS SELECT * FROM departments#
/
CREATE EDITIONING VIEW employees AS SELECT * FROM employees#
/
CREATE EDITIONING VIEW job_history AS SELECT * FROM job_history#
/
 
CREATE OR REPLACE TRIGGER employees_aiufer
AFTER INSERT OR UPDATE OF salary, job_id ON employees FOR EACH ROW
DECLARE
  l_cnt NUMBER;
BEGIN
  LOCK TABLE jobs IN SHARE MODE;  -- Ensure that jobs does not change
                                  -- during the following query.
  SELECT COUNT(*) INTO l_cnt
  FROM jobs
  WHERE job_id = :NEW.job_id
  AND :NEW.salary BETWEEN min_salary AND max_salary;
 
  IF (l_cnt&lt;&gt;1) THEN
    RAISE_APPLICATION_ERROR( -20002,
      CASE
        WHEN :new.job_id = :old.job_id
        THEN &#39;Salary modification invalid&#39;
        ELSE &#39;Job reassignment puts salary out of range&#39;
      END );
  END IF;
END;
/
 
CREATE OR REPLACE TRIGGER jobs_aufer
AFTER UPDATE OF min_salary, max_salary ON jobs FOR EACH ROW
WHEN (NEW.min_salary &gt; OLD.min_salary OR NEW.max_salary &lt; OLD.max_salary)
DECLARE
  l_cnt NUMBER;
BEGIN
  LOCK TABLE employees IN SHARE MODE;
 
  SELECT COUNT(*) INTO l_cnt
  FROM employees
  WHERE job_id = :NEW.job_id
  AND salary NOT BETWEEN :NEW.min_salary and :NEW.max_salary;
 
  IF (l_cnt&gt;0) THEN
    RAISE_APPLICATION_ERROR( -20001,
      &#39;Salary update would violate &#39; || l_cnt || &#39; existing employee records&#39; );
  END IF;
END;
/
 
CREATE SEQUENCE employees_sequence START WITH 210;
CREATE SEQUENCE departments_sequence START WITH 275;
 
------------
-- Load data
------------
 
<span class="bold">INSERT</span> INTO jobs (job_id, job_title, min_salary, max_salary)
SELECT job_id, job_title, min_salary, max_salary
  <span class="bold">FROM HR.JOBS</span>
/
 
<span class="bold">INSERT</span> INTO departments (department_id, department_name, manager_id)
SELECT department_id, department_name, manager_id
  <span class="bold">FROM HR.DEPARTMENTS</span>
/
 
<span class="bold">INSERT</span> INTO employees (employee_id, first_name, last_name, email_addr,
  hire_date, country_code, phone_number, job_id, job_start_date, salary,
  manager_id, department_id)
SELECT employee_id, first_name, last_name, email, hire_date,
  CASE WHEN phone_number LIKE &#39;011.%&#39;
    THEN &#39;+&#39; || SUBSTR( phone_number, INSTR( phone_number, &#39;.&#39; )+1,
      INSTR( phone_number, &#39;.&#39;, 1, 2 ) -  INSTR( phone_number, &#39;.&#39; ) - 1 )
    ELSE &#39;+1&#39;
  END country_code,
  CASE WHEN phone_number LIKE &#39;011.%&#39;
    THEN SUBSTR( phone_number, INSTR(phone_number, &#39;.&#39;, 1, 2 )+1 )
    ELSE phone_number
  END phone_number,
  job_id,
  NVL( (SELECT MAX(end_date+1)
        FROM HR.JOB_HISTORY jh
        WHERE jh.employee_id = employees.employee_id), hire_date),
  salary, manager_id, department_id  
  <span class="bold">FROM HR.EMPLOYEES</span>
/
 
<span class="bold">INSERT</span> INTO job_history (employee_id, job_id, start_date, end_date,
  department_id)
SELECT employee_id, job_id, start_date, end_date, department_id
  <span class="bold">FROM HR.JOB_HISTORY</span>
/
 
COMMIT;
 
-----------------------------
-- Add foreign key constraint
-----------------------------
 
ALTER TABLE departments#
ADD CONSTRAINT dept_to_emp_fk
FOREIGN KEY(manager_id) REFERENCES employees#;
 
----------------------------------------------
-- Grant privileges on schema objects to users
----------------------------------------------
 
GRANT SELECT, INSERT, UPDATE, DELETE ON employees TO app_code;
GRANT SELECT ON departments TO app_code;
GRANT SELECT ON jobs TO app_code;
GRANT SELECT, INSERT on job_history TO app_code;
GRANT SELECT ON employees_sequence TO app_code;
 
GRANT SELECT, INSERT, UPDATE, DELETE ON jobs TO app_admin;
GRANT SELECT, INSERT, UPDATE, DELETE ON departments TO app_admin;
GRANT SELECT ON employees_sequence TO app_admin;
GRANT SELECT ON departments_sequence TO app_admin;
 
GRANT SELECT ON jobs TO app_admin_user;
GRANT SELECT ON departments TO app_admin_user;
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="sample_app.htm#BABHIBIE">&#34;Schema Objects of the Application&#34;</a> for descriptions of the schema objects of the sample application</p>
</li>
<li>
<p><a href="#CHDDAAFH">&#34;Creating Installation Scripts with the Cart&#34;</a></p>
</li>
<li>
<p><a href="#BABBIDCB">&#34;Creating an Installation Script with the Database Export Wizard&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" -->
<a id="CHDCDIGF"></a>
<div id="TDDDG319" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Creating Installation Script employees.sql</h4>
<p>The installation script <code>employees.sql</code> does in the deployment environment what you did in the development environment in <a href="sample_app.htm#BABFFCIF">&#34;Creating the employees_pkg Package&#34;</a>.</p>
<p>You can create <code>employees.sql</code> using either a text editor or SQL&nbsp;Developer.</p>
<p>To create <code>employees.sql</code> in any text editor, enter the following text and save the file as <code>employees.sql</code>. For <code><span class="codeinlineitalic">password</span></code>, use the password that <code>schema.sql</code> specifies when it creates the user <code>app_code</code>.</p>
<pre>-----------------------
-- Create employees_pkg
-----------------------
 
CONNECT app_code/<span class="italic">password</span>
 
CREATE SYNONYM employees FOR app_data.employees;
CREATE SYNONYM departments FOR app_data.departments;
CREATE SYNONYM jobs FOR app_data.jobs;
CREATE SYNONYM job_history FOR app_data.job_history;
 
CREATE OR REPLACE PACKAGE employees_pkg
AS
  PROCEDURE get_employees_in_dept
    ( p_deptno     IN     employees.department_id%TYPE,
      p_result_set IN OUT SYS_REFCURSOR );
 
  PROCEDURE get_job_history
    ( p_employee_id  IN     employees.department_id%TYPE,
      p_result_set   IN OUT SYS_REFCURSOR );
 
  PROCEDURE show_employee
    ( p_employee_id  IN     employees.employee_id%TYPE,
      p_result_set   IN OUT SYS_REFCURSOR );
 
  PROCEDURE update_salary
    ( p_employee_id IN employees.employee_id%TYPE,
      p_new_salary  IN employees.salary%TYPE );
 
  PROCEDURE change_job
    ( p_employee_id IN employees.employee_id%TYPE,
      p_new_job     IN employees.job_id%TYPE,
      p_new_salary  IN employees.salary%TYPE := NULL,
      p_new_dept    IN employees.department_id%TYPE := NULL );
END employees_pkg;
/
 
CREATE OR REPLACE PACKAGE BODY employees_pkg
AS
  PROCEDURE get_employees_in_dept
    ( p_deptno     IN     employees.department_id%TYPE,
      p_result_set IN OUT SYS_REFCURSOR )
  IS
     l_cursor SYS_REFCURSOR;
  BEGIN
    OPEN p_result_set FOR
      SELECT e.employee_id,
        e.first_name || &#39; &#39; || e.last_name name,
        TO_CHAR( e.hire_date, &#39;Dy Mon ddth, yyyy&#39; ) hire_date,
        j.job_title,
        m.first_name || &#39; &#39; || m.last_name manager,
        d.department_name
      FROM employees e INNER JOIN jobs j ON (e.job_id = j.job_id)
        LEFT OUTER JOIN employees m ON (e.manager_id = m.employee_id)
        INNER JOIN departments d ON (e.department_id = d.department_id)
      WHERE e.department_id = p_deptno ;
  END get_employees_in_dept;
 
  PROCEDURE get_job_history
    ( p_employee_id  IN     employees.department_id%TYPE,
      p_result_set   IN OUT SYS_REFCURSOR )
  IS 
  BEGIN
    OPEN p_result_set FOR
      SELECT e.First_name || &#39; &#39; || e.last_name name, j.job_title,
        e.job_start_date start_date,
        TO_DATE(NULL) end_date
      FROM employees e INNER JOIN jobs j ON (e.job_id = j.job_id)
      WHERE e.employee_id = p_employee_id
      UNION ALL
      SELECT e.First_name || &#39; &#39; || e.last_name name,
        j.job_title,
        jh.start_date,
        jh.end_date
      FROM employees e INNER JOIN job_history jh
        ON (e.employee_id = jh.employee_id)
        INNER JOIN jobs j ON (jh.job_id = j.job_id)
      WHERE e.employee_id = p_employee_id
      ORDER BY start_date DESC;
  END get_job_history;
 
  PROCEDURE show_employee
    ( p_employee_id  IN     employees.employee_id%TYPE,
      p_result_set   IN OUT sys_refcursor )
  IS 
  BEGIN
    OPEN p_result_set FOR
      SELECT *
      FROM (SELECT TO_CHAR(e.employee_id) employee_id,
              e.first_name || &#39; &#39; || e.last_name name,
              e.email_addr,
              TO_CHAR(e.hire_date,&#39;dd-mon-yyyy&#39;) hire_date,
              e.country_code,
              e.phone_number,
              j.job_title,
              TO_CHAR(e.job_start_date,&#39;dd-mon-yyyy&#39;) job_start_date,
              to_char(e.salary) salary,
              m.first_name || &#39; &#39; || m.last_name manager,
              d.department_name
            FROM employees e INNER JOIN jobs j on (e.job_id = j.job_id)
              RIGHT OUTER JOIN employees m ON (m.employee_id = e.manager_id)
              INNER JOIN departments d ON (e.department_id = d.department_id)
            WHERE e.employee_id = p_employee_id)
      UNPIVOT (VALUE FOR ATTRIBUTE IN (employee_id, name, email_addr, hire_date,
        country_code, phone_number, job_title, job_start_date, salary, manager,
        department_name) );
  END show_employee;
 
  PROCEDURE update_salary
    ( p_employee_id IN employees.employee_id%type,
      p_new_salary  IN employees.salary%type )
  IS 
  BEGIN
    UPDATE employees
    SET salary = p_new_salary
    WHERE employee_id = p_employee_id;
  END update_salary;
 
  PROCEDURE change_job
    ( p_employee_id IN employees.employee_id%TYPE,
      p_new_job     IN employees.job_id%TYPE,
      p_new_salary  IN employees.salary%TYPE := NULL,
      p_new_dept    IN employees.department_id%TYPE := NULL )
  IS
  BEGIN
    INSERT INTO job_history (employee_id, start_date, end_date, job_id,
      department_id)
    SELECT employee_id, job_start_date, TRUNC(SYSDATE), job_id, department_id
      FROM employees
      WHERE employee_id = p_employee_id;
 
    UPDATE employees
    SET job_id = p_new_job,
      department_id = NVL( p_new_dept, department_id ),
      salary = NVL( p_new_salary, salary ),
      job_start_date = TRUNC(SYSDATE)
    WHERE employee_id = p_employee_id;
  END change_job;
END employees_pkg;
/
 
---------------------------------------------
-- Grant privileges on employees_pkg to users
---------------------------------------------
 
GRANT EXECUTE ON employees_pkg TO app_user;
GRANT EXECUTE ON employees_pkg TO app_admin_user;
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#CHDDAAFH">&#34;Creating Installation Scripts with the Cart&#34;</a></p>
</li>
<li>
<p><a href="#BABBIDCB">&#34;Creating an Installation Script with the Database Export Wizard&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" -->
<a id="CHDDBBCC"></a>
<div id="TDDDG320" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Creating Installation Script admin.sql</h4>
<p>The installation script <code>admin.sql</code> does in the deployment environment what you did in the development environment in <a href="sample_app.htm#BABIHFDD">&#34;Creating the admin_pkg Package&#34;</a>.</p>
<p>You can create <code>admin.sql</code> using either a text editor or SQL&nbsp;Developer.</p>
<p>To create <code>admin.sql</code> in any text editor, enter the following text and save the file as <code>admin.sql</code>. For <code><span class="codeinlineitalic">password</span></code>, use the password that <code>schema.sql</code> specifies when it creates the user <code>app_admin</code>.</p>
<pre>-------------------
-- Create admin_pkg
-------------------
 
CONNECT app_admin/<span class="italic">password</span>
 
CREATE SYNONYM departments FOR app_data.departments;
CREATE SYNONYM jobs FOR app_data.jobs;
CREATE SYNONYM departments_sequence FOR app_data.departments_sequence;
 
CREATE OR REPLACE PACKAGE admin_pkg
AS
  PROCEDURE update_job
    ( p_job_id      IN jobs.job_id%TYPE,
      p_job_title   IN jobs.job_title%TYPE := NULL,
      p_min_salary  IN jobs.min_salary%TYPE := NULL,
      p_max_salary  IN jobs.max_salary%TYPE := NULL );
 
  PROCEDURE add_job
    ( p_job_id      IN jobs.job_id%TYPE,
      p_job_title   IN jobs.job_title%TYPE,
      p_min_salary  IN jobs.min_salary%TYPE,
      p_max_salary  IN jobs.max_salary%TYPE );
 
  PROCEDURE update_department
    ( p_department_id     IN departments.department_id%TYPE,
      p_department_name   IN departments.department_name%TYPE := NULL,
      p_manager_id        IN departments.manager_id%TYPE := NULL,
      p_update_manager_id IN BOOLEAN := FALSE );
 
  FUNCTION add_department
    ( p_department_name   IN departments.department_name%TYPE,
      p_manager_id        IN departments.manager_id%TYPE )
    RETURN departments.department_id%TYPE;
 
END admin_pkg;
/
 
CREATE OR REPLACE PACKAGE BODY admin_pkg
AS
  PROCEDURE update_job
    ( p_job_id      IN jobs.job_id%TYPE,
      p_job_title   IN jobs.job_title%TYPE := NULL,
      p_min_salary  IN jobs.min_salary%TYPE := NULL,
      p_max_salary  IN jobs.max_salary%TYPE := NULL )
  IS
  BEGIN
    UPDATE jobs
    SET job_title  = NVL( p_job_title, job_title ),
        min_salary = NVL( p_min_salary, min_salary ),
        max_salary = NVL( p_max_salary, max_salary )
    WHERE job_id = p_job_id;
  END update_job;
 
  PROCEDURE add_job
    ( p_job_id      IN jobs.job_id%TYPE,
      p_job_title   IN jobs.job_title%TYPE,
      p_min_salary  IN jobs.min_salary%TYPE,
      p_max_salary  IN jobs.max_salary%TYPE )
  IS
  BEGIN
    INSERT INTO jobs ( job_id, job_title, min_salary, max_salary )
    VALUES ( p_job_id, p_job_title, p_min_salary, p_max_salary );
  END add_job;
 
  PROCEDURE update_department
    ( p_department_id     IN departments.department_id%TYPE,
      p_department_name   IN departments.department_name%TYPE := NULL,
      p_manager_id        IN departments.manager_id%TYPE := NULL,
      p_update_manager_id IN BOOLEAN := FALSE )
  IS
  BEGIN
    IF ( p_update_manager_id ) THEN
      UPDATE departments
      SET department_name = NVL( p_department_name, department_name ),
          manager_id = p_manager_id
      WHERE department_id = p_department_id;
    ELSE
      UPDATE departments
      SET department_name = NVL( p_department_name, department_name )
      WHERE department_id = p_department_id;
    END IF;
  END update_department;
 
  FUNCTION add_department
    ( p_department_name   IN departments.department_name%TYPE,
      p_manager_id        IN departments.manager_id%TYPE )
    RETURN departments.department_id%TYPE
  IS
    l_department_id departments.department_id%TYPE;
  BEGIN
    INSERT INTO departments ( department_id, department_name, manager_id )
    VALUES ( departments_sequence.NEXTVAL, p_department_name, p_manager_id );
 
    RETURN l_department_id;
  END add_department;
 
END admin_pkg;
/
 
----------------------------------------
-- Grant privileges on admin_pkg to user
----------------------------------------
 
GRANT EXECUTE ON admin_pkg TO app_admin_user;
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#CHDDAAFH">&#34;Creating Installation Scripts with the Cart&#34;</a></p>
</li>
<li>
<p><a href="#BABBIDCB">&#34;Creating an Installation Script with the Database Export Wizard&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" -->
<a id="CHDEIJFI"></a>
<div id="TDDDG321" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Creating Master Installation Script create_app.sql</h4>
<p>The master installation script <code>create_app.sql</code> runs the other four installation scripts for the sample application in the correct order, thereby deploying the sample application in the deployment environment.</p>
<p>To create <code>create_app.sql</code>, enter the following text in any text editor and save the file as <code>create_app.sql</code>:</p>
<pre>@schemas.sql
@objects.sql
@employees.sql
@admin.sql
</pre></div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABBJBEJ"></a>
<div id="TDDDG76000" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Deploying the Sample Application</h2>
<p>This section explains how to deploy the <a id="sthref756"></a>sample application using the installation scripts that you created in <a href="#CHDJIBIE">&#34;Creating Installation Scripts for the Sample Application&#34;</a>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
For the following procedures, you need the name and password of a user who has the <code>CREATE</code> <code>USER</code> and <code>DROP</code> <code>USER</code> system privileges.</div>
<p class="subhead2"><a id="TDDDG326"></a>To deploy the sample application using SQL*Plus:</p>
<ol>
<li>
<p>Copy the installation scripts that you created in <a href="#CHDJIBIE">&#34;Creating Installation Scripts for the Sample Application&#34;</a> to the deployment environment.</p>
</li>
<li>
<p>In the deployment environment, connect to Oracle Database as a user with the <code>CREATE</code> <code>USER</code> and <code>DROP</code> <code>USER</code> system privileges.</p>
</li>
<li>
<p>At the <code>SQL&gt;</code> prompt, run the master installation script:</p>
<pre>@create_app.sql
</pre>
<p>The master installation script runs the other four installation scripts for the sample application in the correct order, thereby deploying the sample application in the deployment environment.</p>
</li>
</ol>
<p class="subhead2"><a id="TDDDG120"></a>To deploy the sample application using SQL&nbsp;Developer:</p>
<ol>
<li>
<p>If necessary, create a connection to the deployment environment.</p>
<p>For Connection Name, enter a name that is <span class="italic">not</span> the name of the connection to the development environment.</p>
</li>
<li>
<p>Copy the installation scripts that you created in <a href="#CHDJIBIE">&#34;Creating Installation Scripts for the Sample Application&#34;</a> to the deployment environment.</p>
</li>
<li>
<p>Connect to Oracle Database as a user with the <code>CREATE</code> <code>USER</code> and <code>DROP</code> <code>USER</code> system privileges in the deployment environment.</p>
<p>A new pane appears. On its tab is the name of the connection to the deployment environment. The pane has two subpanes, Worksheet and Query Builder.</p>
</li>
<li>
<p>In the Worksheet pane, type the command for running the master installation script:</p>
<pre>@create_app.sql
</pre></li>
<li>
<p>Click the icon <span class="bold">Run Script</span>.</p>
<p>The master installation script runs the other four installation scripts for the sample application in the correct order, thereby deploying the sample application in the deployment environment. The output appears in the Script Output pane, under the Worksheet pane.</p>
<p>In the Connections frame, if you expand the connection to the deployment environment, and then expand the type of each object that the sample application uses, you see the objects of the sample application.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink SQPUG015" href="../SQPUG/ch_five.htm#SQPUG015"><span class="italic">SQL*Plus User&#39;s Guide and Reference</span></a> for more information about using scripts in SQL*Plus</p>
</li>
<li>
<p><a class="olink RPTUG10720" href="../RPTUG/intro.htm#RPTUG10720"><span class="italic">Oracle SQL Developer User&#39;s Guide</span></a> for more information about running scripts in SQL&nbsp;Developer</p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="BABGHJDG"></a>
<div id="TDDDG77000" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Checking the Validity of an Installation</h2>
<p><a id="sthref757"></a><a id="sthref758"></a>After installing your application in a deployment environment, you can check its validity in the following ways in SQL&nbsp;Developer:</p>
<ul>
<li>
<p>In the Connections frame:</p>
<ol>
<li>
<p>Expand the connection to the deployment environment.</p>
</li>
<li>
<p>Examine the definitions of the new objects.</p>
</li>
</ol>
</li>
<li>
<p>In the Reports pane:</p>
<ol>
<li>
<p>Expand <span class="bold">Data Dictionary Reports</span>.</p>
<p>A list of data dictionary reports appears.</p>
</li>
<li>
<p>Expand <span class="bold">All Objects</span>.</p>
<p>A list of objects reports appears.</p>
</li>
<li>
<p>Select <span class="bold">All Objects</span>.</p>
<p>The Select Connection window appears.</p>
</li>
<li>
<p>In the Connection field, select from the menu the connection to the deployment environment.</p>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
</li>
<li>
<p>In the Enter Bind Values window, select either <span class="bold">Owner</span> or <span class="bold">Object Name</span>.</p>
</li>
<li>
<p>Click <span class="bold">Apply</span>.</p>
<p>The message &#34;Displaying Results&#34; shows, followed by the results.</p>
<p>For each object, this report lists the Owner, Object Type, Object Name, Status (Valid or Invalid), Date Created, and Last DDL. Last DDL is the date of the last DDL operation that affected the object.</p>
</li>
<li>
<p>In the Reports pane, select <span class="bold">Invalid Objects</span>.</p>
</li>
<li>
<p>In the Enter Bind Values window, click <span class="bold">Apply</span>.</p>
<p>For each object whose Status is Invalid, this report lists the Owner, Object Type, and Object Name.</p>
</li>
</ol>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink RPTUG11000" href="../RPTUG/intro.htm#RPTUG11000"><span class="italic">Oracle SQL Developer User&#39;s Guide</span></a> for more information about SQL&nbsp;Developer reports</div>
</div>
<!-- class="sect1" -->
<a id="BABICFHF"></a>
<div id="TDDDG78000" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Archiving the Installation Scripts</h2>
<p><a id="sthref759"></a><a id="sthref760"></a>After verifying that the installation of your application is valid, Oracle recommends that you archive your installation scripts in a source code control system. Before doing so, add comments to each file, documenting its creation date and purpose. If you ever must deploy the same application to another environment, you can use these archived files.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SUTIL100" href="../SUTIL/GUID-17FAE261-0972-4220-A2E4-44D479F519D4.htm#SUTIL100"><span class="italic">Oracle Database Utilities</span></a> for information about Oracle Data Pump, which enables very high-speed movement of data and metadata from one database to another</div>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5832">
<tr>
<td class="cellalignment5839">
<table class="cellalignment5837">
<tr>
<td class="cellalignment5836"><a href="sample_app.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5836"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5841">
<table class="cellalignment5835">
<tr>
<td class="cellalignment5836"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5836"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5836"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5836"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5836"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5836"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>