<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-106199"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/About%20DML%20Statements%20and%20Transactions"></a><title>About DML Statements and Transactions</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1023"/>
<meta name="dcterms.created" content="2014-07-01T1:46:12Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database 2 Day Developer&#39;s Guide"/>
<meta name="dcterms.identifier" content="E53088-01"/>
<meta name="dcterms.isVersionOf" content="TDDDG"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="tdddg_connecting.htm" title="Previous" type="text/html"/>
<link rel="Next" href="tdddg_objects.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E53088-01.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">9/17</span> <!-- End Header -->
<div id="TDDDG99941" class="chapter"><a id="CHDEBAED"></a>
<h1 class="chapter"><span class="secnum">3</span> About DML Statements and Transactions</h1>
<p>This chapter contains:</p>
<ul>
<li>
<p><a href="#BCGBGBIE">About Data Manipulation Language (DML) Statements</a></p>
</li>
<li>
<p><a href="#BABEBGJG">About Transaction Control Statements</a></p>
</li>
<li>
<p><a href="#BABGBDCF">Committing Transactions</a></p>
</li>
<li>
<p><a href="#BABDBCBI">Rolling Back Transactions</a></p>
</li>
<li>
<p><a href="#BABJCEJH">Setting Savepoints in Transactions</a></p>
</li>
</ul>
<a id="BCGBGBIE"></a>
<div id="TDDDG23000" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">About Data Manipulation Language (DML) Statements</h2>
<p><a id="sthref147"></a><span class="bold">Data manipulation language (DML) statements</span> access and manipulate data in existing tables.</p>
<p>In the SQL*Plus environment, you can enter a DML statement after the <code>SQL&gt;</code> prompt.</p>
<p>In the SQL&nbsp;Developer environment, you can enter a DML statement in the Worksheet. Alternatively, you can use the SQL&nbsp;Developer Connections frame and tools to access and manipulate data.</p>
<p>To see the effect of a DML statement in SQL&nbsp;Developer, you might have to select the schema object type of the changed object in the Connections frame and then click the <a id="sthref148"></a>Refresh icon.</p>
<p>The effect of a DML statement is not permanent until you commit the transaction that includes it. A <span class="bold">transaction</span> is a sequence of SQL statements that Oracle Database treats as a unit (it can be a single DML statement). Until a transaction is committed, it can be rolled back (undone). For more information about transactions, see <a href="#BABEBGJG">&#34;About Transaction Control Statements&#34;</a>.</p>
<p>This section contains:</p>
<ul>
<li>
<p><a href="#BABCCIEG">About the INSERT Statement</a></p>
</li>
<li>
<p><a href="#BABJDEBJ">About the UPDATE Statement</a></p>
</li>
<li>
<p><a href="#BABIACDB">About the DELETE Statement</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SQLRF30001" href="../SQLRF/statements_1001.htm#SQLRF30001"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about DML statements</div>
<a id="BABCCIEG"></a>
<div id="TDDDG23100" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">About the INSERT Statement</h3>
<p><a id="sthref149"></a><a id="sthref150"></a><a id="sthref151"></a>The <code>INSERT</code> statement inserts rows into an existing table.</p>
<p>The simplest recommended form of the <code>INSERT</code> statement has this syntax:</p>
<pre>INSERT INTO <span class="italic">table_name</span> (<span class="italic">list_of_columns</span>)
VALUES (<span class="italic">list_of_values</span>);
</pre>
<p>Every column in <code><span class="codeinlineitalic">list_of_columns</span></code> must have a valid value in the corresponding position in <code><span class="codeinlineitalic">list_of_values</span></code>. Therefore, before you insert a row into a table, you must know what columns the table has, and what their valid values are. To get this information using SQL&nbsp;Developer, see <a href="tdddg_connecting.htm#CEGGHEHE">&#34;Tutorial: Viewing EMPLOYEES Table Properties and Data with SQL&nbsp;Developer&#34;</a>. To get this information using SQL*Plus, use the <code>DESCRIBE</code> statement. For example:</p>
<pre>DESCRIBE EMPLOYEES;
</pre>
<p>Result:</p>
<pre> Name                                      Null?    Type
 ----------------------------------------- -------- ------------
 
 EMPLOYEE_ID                               NOT NULL NUMBER(6)
 FIRST_NAME                                         VARCHAR2(20)
 LAST_NAME                                 NOT NULL VARCHAR2(25)
 EMAIL                                     NOT NULL VARCHAR2(25)
 PHONE_NUMBER                                       VARCHAR2(20)
 HIRE_DATE                                 NOT NULL DATE
 JOB_ID                                    NOT NULL VARCHAR2(10)
 SALARY                                             NUMBER(8,2)
 COMMISSION_PCT                                     NUMBER(2,2)
 MANAGER_ID                                         NUMBER(6)
 DEPARTMENT_ID                                      NUMBER(4)
</pre>
<p>The <code>INSERT</code> statement in <a href="#CHDHCEED">Example 3-1</a> inserts a row into the <code>EMPLOYEES</code> table for an employee for which all column values are known.</p>
<div id="TDDDG176" class="example">
<p class="titleinexample"><a id="CHDHCEED"></a>Example 3-1 Using the INSERT Statement When All Information Is Available</p>
<pre>INSERT INTO EMPLOYEES (
  EMPLOYEE_ID,
  FIRST_NAME,
  LAST_NAME,
  EMAIL,
  PHONE_NUMBER,
  HIRE_DATE,
  JOB_ID,
  SALARY,
  COMMISSION_PCT,
  MANAGER_ID,
  DEPARTMENT_ID
)
VALUES (
  10,              -- EMPLOYEE_ID
  &#39;George&#39;,        -- FIRST_NAME
  &#39;Gordon&#39;,        -- LAST_NAME
  &#39;GGORDON&#39;,       -- EMAIL
  &#39;650.506.2222&#39;,  -- PHONE_NUMBER
  &#39;01-JAN-07&#39;,     -- HIRE_DATE
  &#39;SA_REP&#39;,        -- JOB_ID
  9000,            -- SALARY
  .1,              -- COMMISSION_PCT
  148,             -- MANAGER_ID
  80               -- DEPARTMENT_ID
);
</pre>
<p>Result:</p>
<pre>1 row created.
</pre></div>
<!-- class="example" -->
<p>You need not know all column values to insert a row into a table, but you must know the values of all <code>NOT</code> <code>NULL</code> columns. If you do not know the value of a column that can be <code>NULL</code>, you can omit that column from <code><span class="codeinlineitalic">list_of_columns</span></code>. Its value defaults to <code>NULL</code>.</p>
<p>The <code>INSERT</code> statement in <a href="#CHDJCDJC">Example 3-2</a> inserts a row into the <code>EMPLOYEES</code> table for an employee for which all column values are known except <code>SALARY</code>. For now, <code>SALARY</code> can have the value <code>NULL</code>. When you know the salary, you can change it with the <code>UPDATE</code> statement (see <a href="#CHDCDCCB">Example 3-4</a>).</p>
<div id="TDDDG177" class="example">
<p class="titleinexample"><a id="CHDJCDJC"></a>Example 3-2 Using the INSERT Statement When Not All Information Is Available</p>
<pre>INSERT INTO EMPLOYEES (
  EMPLOYEE_ID,
  FIRST_NAME,
  LAST_NAME,
  EMAIL,
  PHONE_NUMBER,
  HIRE_DATE,
  JOB_ID,          <span class="bold">-- Omit SALARY; its value defaults to NULL.</span>
  COMMISSION_PCT,
  MANAGER_ID,
  DEPARTMENT_ID
)
VALUES (
  20,              -- EMPLOYEE_ID
  &#39;John&#39;,          -- FIRST_NAME
  &#39;Keats&#39;,         -- LAST_NAME
  &#39;JKEATS&#39;,        -- EMAIL
  &#39;650.506.3333&#39;,  -- PHONE_NUMBER
  &#39;01-JAN-07&#39;,     -- HIRE_DATE
  &#39;SA_REP&#39;,        -- JOB_ID
  .1,              -- COMMISSION_PCT
  148,             -- MANAGER_ID
  80               -- DEPARTMENT_ID
);
</pre>
<p>Result:</p>
<pre>1 row created.
</pre></div>
<!-- class="example" -->
<p>The <code>INSERT</code> statement in <a href="#CHDCJECE">Example 3-3</a> tries to insert a row into the <code>EMPLOYEES</code> table for an employee for which <code>LAST_NAME</code> is not known.</p>
<div id="TDDDG178" class="example">
<p class="titleinexample"><a id="CHDCJECE"></a>Example 3-3 Using the INSERT Statement Incorrectly</p>
<pre>INSERT INTO EMPLOYEES (
  EMPLOYEE_ID,
  FIRST_NAME,      <span class="bold">-- Omit LAST_NAME (error)</span>
  EMAIL,
  PHONE_NUMBER,
  HIRE_DATE,
  JOB_ID,
  COMMISSION_PCT,
  MANAGER_ID,
  DEPARTMENT_ID
)
VALUES (
  20,              -- EMPLOYEE_ID
  &#39;John&#39;,          -- FIRST_NAME
  &#39;JOHN&#39;,          -- EMAIL
  &#39;650.506.3333&#39;,  -- PHONE_NUMBER
  &#39;01-JAN-07&#39;,     -- HIRE_DATE
  &#39;SA_REP&#39;,        -- JOB_ID
  .1,              -- COMMISSION_PCT
  148,             -- MANAGER_ID
  80               -- DEPARTMENT_ID
);
</pre>
<p>Result:</p>
<pre>ORA-01400: cannot insert NULL into (&#34;HR&#34;.&#34;EMPLOYEES&#34;.&#34;LAST_NAME&#34;)
</pre></div>
<!-- class="example" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink SQLRF01604" href="../SQLRF/statements_9015.htm#SQLRF01604"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about the <code>INSERT</code> statement</p>
</li>
<li>
<p><a class="olink SQLRF0021" href="../SQLRF/sql_elements001.htm#SQLRF0021"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about data types</p>
</li>
<li>
<p><a href="tdddg_objects.htm#BABGCIFC">&#34;Tutorial: Adding Rows to Tables with the Insert Row Tool&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABJDEBJ"></a>
<div id="TDDDG23200" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">About the UPDATE Statement</h3>
<p><a id="sthref152"></a><a id="sthref153"></a>The <code>UPDATE</code> statement updates (changes the values of) a set of existing table rows.</p>
<p>A simple form of the <code>UPDATE</code> statement has this syntax:</p>
<pre>UPDATE <span class="italic">table_name</span>
SET <span class="italic">column_name</span> = <span class="italic">value</span> [, <span class="italic">column_name</span> = <span class="italic">value</span>]...
[ WHERE <span class="italic">condition</span> ];
</pre>
<p>Each <code><span class="codeinlineitalic">value</span></code> must be valid for its <code><span class="codeinlineitalic">column_name</span></code>. If you include the <code>WHERE</code> clause, the statement updates column values only in rows that satisfy <code><span class="codeinlineitalic">condition</span></code>.</p>
SQL&nbsp;DeveloperSQL*Plus
<p>The <code>UPDATE</code> statement in <a href="#CHDCDCCB">Example 3-4</a> updates the value of the <code>SALARY</code> column in the row that was inserted into the <code>EMPLOYEES</code> table in <a href="#CHDJCDJC">Example 3-2</a>, before the salary of the employee was known.</p>
<div id="TDDDG179" class="example">
<p class="titleinexample"><a id="CHDCDCCB"></a>Example 3-4 Using the UPDATE Statement to Add Data</p>
<pre>UPDATE EMPLOYEES
<span class="bold">SET SALARY = 8500</span>
WHERE LAST_NAME = &#39;Keats&#39;;
</pre>
<p>Result:</p>
<pre>1 row updated.
</pre></div>
<!-- class="example" -->
<p>The <code>UPDATE</code> statement in <a href="#CHDFBAAE">Example 3-5</a> updates the commission percentage for every employee in department 80.</p>
<div id="TDDDG180" class="example">
<p class="titleinexample"><a id="CHDFBAAE"></a>Example 3-5 Using the UPDATE Statement to Update Multiple Rows</p>
<pre>UPDATE EMPLOYEES
SET COMMISSION_PCT = COMMISSION_PCT + 0.05
WHERE DEPARTMENT_ID = 80;
</pre>
<p>Result:</p>
<pre>34 rows updated.
</pre></div>
<!-- class="example" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink SQLRF01708" href="../SQLRF/statements_10008.htm#SQLRF01708"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about the <code>UPDATE</code> statement</p>
</li>
<li>
<p><a class="olink SQLRF0021" href="../SQLRF/sql_elements001.htm#SQLRF0021"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about data types</p>
</li>
<li>
<p><a href="tdddg_objects.htm#CIHGJCJE">&#34;Tutorial: Changing Data in Tables in the Data Pane&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABIACDB"></a>
<div id="TDDDG23300" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">About the DELETE Statement</h3>
<p><a id="sthref154"></a><a id="sthref155"></a><a id="sthref156"></a>The <code>DELETE</code> statement deletes rows from a table.</p>
<p>A simple form of the <code>DELETE</code> statement has this syntax:</p>
<pre>DELETE FROM <span class="italic">table_name</span>
[ WHERE <span class="italic">condition</span> ];
</pre>
<p>If you include the <code>WHERE</code> clause, the statement deletes only rows that satisfy <code><span class="codeinlineitalic">condition</span></code>. If you omit the <code>WHERE</code> clause, the statement deletes all rows from the table, but the empty table still exists. To delete a table, use the <code>DROP</code> <code>TABLE</code> statement.</p>
<p>The <code>DELETE</code> statement in <a href="#CHDGGBII">Example 3-6</a> deletes the rows inserted in <a href="#CHDHCEED">Example 3-1</a> and <a href="#CHDJCDJC">Example 3-2</a>.</p>
<div id="TDDDG181" class="example">
<p class="titleinexample"><a id="CHDGGBII"></a>Example 3-6 Using the DELETE Statement</p>
<pre>DELETE FROM EMPLOYEES
WHERE HIRE_DATE = TO_DATE(&#39;01-JAN-07&#39;, &#39;dd-mon-yy&#39;);
</pre>
<p>Result:</p>
<pre>2 rows deleted.
</pre></div>
<!-- class="example" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink SQLRF01505" href="../SQLRF/statements_8005.htm#SQLRF01505"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about the <code>DELETE</code> statement</p>
</li>
<li>
<p><a class="olink SQLRF01806" href="../SQLRF/statements_9003.htm#SQLRF01806"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about the <code>DROP</code> <code>TABLE</code> statement</p>
</li>
<li>
<p><a href="tdddg_objects.htm#CIHJEAAH">&#34;Tutorial: Deleting Rows from Tables with the Delete Selected Row(s) Tool&#34;</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABEBGJG"></a>
<div id="TDDDG24000" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">About Transaction Control Statements</h2>
<p>A <a id="sthref157"></a><span class="bold">transaction</span> is a sequence of one or more SQL statements that Oracle Database treats as a unit: either all of the statements are performed, or none of them are.</p>
<p>You need transactions to model business processes that require that several operations be performed as a unit. For example, when a manager leaves the company, a row must be inserted into the <code>JOB_HISTORY</code> table to show when the manager left, and for every employee who reports to that manager, the value of <code>MANAGER_ID</code> must be updated in the <code>EMPLOYEES</code> table. To model this process in an application, you must group the <code>INSERT</code> and <code>UPDATE</code> statements into a single transaction.</p>
<p>The basic <a id="sthref158"></a><span class="bold">transaction control statements</span> are:</p>
<ul>
<li>
<p><code>SAVEPOINT</code>, which marks a <span class="bold">savepoint</span> in a transaction&mdash;a point to which you can later roll back. Savepoints are optional, and a transaction can have multiple savepoints.</p>
</li>
<li>
<p><code>COMMIT</code>, which ends the current transaction, makes its changes permanent, erases its savepoints, and releases its locks.</p>
</li>
<li>
<p><code>ROLLBACK</code>, which rolls back (undoes) either the entire current transaction or only the changes made after the specified savepoint.</p>
</li>
</ul>
<p>In the SQL*Plus environment, you can enter a transaction control statement after the <code>SQL&gt;</code> prompt.</p>
<p>In the SQL&nbsp;Developer environment, you can enter a transaction control statement in the Worksheet. SQL&nbsp;Developer also has Commit Changes and Rollback Changes icons, which are explained in <a href="#BABGBDCF">&#34;Committing Transactions&#34;</a> and <a href="#BABDBCBI">&#34;Rolling Back Transactions&#34;</a>.</p>
<div class="infobox-note">
<p class="notep1">Caution:</p>
If you do not explicitly commit a transaction, and the program terminates abnormally, then the database automatically rolls back the last uncommitted transaction.
<p>Oracle recommends that you explicitly end transactions in application programs, by either committing them or rolling them back.</p>
</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink CNCPT016" href="../CNCPT/transact.htm#CNCPT016"><span class="italic">Oracle Database Concepts</span></a> for more information about transaction management</p>
</li>
<li>
<p><a class="olink SQLRF30043" href="../SQLRF/statements_1001.htm#SQLRF30043"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about transaction control statements</p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="BABGBDCF"></a>
<div id="TDDDG24100" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Committing Transactions</h2>
<p><a id="sthref159"></a><a id="sthref160"></a>Committing a transaction makes its changes permanent, erases its savepoints, and releases its locks.<a id="sthref161"></a><a id="sthref162"></a></p>
<p>To explicitly commit a transaction, use either the <a id="sthref163"></a><code>COMMIT</code> statement or (in the SQL&nbsp;Developer environment) the <a id="sthref164"></a>Commit Changes icon.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle Database issues an <a id="sthref165"></a><a id="sthref166"></a><a id="sthref167"></a><a id="sthref168"></a>implicit <code>COMMIT</code> statement before and after any data definition language (DDL) statement. For information about DDL statements, see <a href="tdddg_objects.htm#CIHGAJDJ">&#34;About Data Definition Language (DDL) Statements&#34;</a>.</div>
<p>Before you commit a transaction:</p>
<ul>
<li>
<p><a id="sthref169"></a><a id="sthref170"></a>Your changes are visible to you, but not to other users of the database instance.</p>
</li>
<li>
<p>Your changes are not final&mdash;you can undo them with a <code>ROLLBACK</code> statement.</p>
</li>
</ul>
<p>After you commit a transaction:</p>
<ul>
<li>
<p>Your changes are visible to other users, and to their statements that run after you commit your transaction.</p>
</li>
<li>
<p>Your changes are final&mdash;you cannot undo them with a <code>ROLLBACK</code> statement.</p>
</li>
</ul>
<p><a href="#CHDFDCHE">Example 3-7</a> adds one row to the <code>REGIONS</code> table (a very simple transaction), checks the result, and then commits the transaction.</p>
<div id="TDDDG182" class="example">
<p class="titleinexample"><a id="CHDFDCHE"></a>Example 3-7 Committing a Transaction</p>
<p>Before transaction:</p>
<pre>SELECT * FROM REGIONS
ORDER BY REGION_ID;
 
</pre>
<p>Result:</p>
<pre> REGION_ID REGION_NAME
---------- -------------------------
         1 Europe
         2 Americas
         3 Asia
         4 Middle East and Africa
 
4 rows selected.
 
</pre>
<p>Transaction (add row to table):</p>
<pre>INSERT INTO regions (region_id, region_name) VALUES (5, &#39;Africa&#39;);
 
</pre>
<p>Result:</p>
<pre>1 row created.
 
</pre>
<p>Check that row was added:</p>
<pre>SELECT * FROM REGIONS
ORDER BY REGION_ID;
 
</pre>
<p>Result:</p>
<pre> REGION_ID REGION_NAME
---------- -------------------------
         1 Europe
         2 Americas
         3 Asia
         4 Middle East and Africa
         <span class="bold">5 Africa</span>
 
5 rows selected.
</pre>
<p>Commit transaction:</p>
<pre><span class="bold">COMMIT;</span>
</pre>
<p>Result:</p>
<pre>Commit complete.
</pre></div>
<!-- class="example" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SQLRF01110" href="../SQLRF/statements_4011.htm#SQLRF01110"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about the <code>COMMIT</code> statement</div>
</div>
<!-- class="sect1" -->
<a id="BABDBCBI"></a>
<div id="TDDDG24200" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Rolling Back Transactions</h2>
<p><a id="sthref171"></a><a id="sthref172"></a><a id="sthref173"></a><a id="sthref174"></a>Rolling back a transaction undoes its changes. You can roll back the entire current transaction, or you can roll it back only to a specified savepoint.</p>
<p>To roll back the current transaction only to a specified savepoint, you must use the <a id="sthref175"></a><code>ROLLBACK</code> statement with the <code>TO</code> <code>SAVEPOINT</code> clause.</p>
<p>To roll back the entire current transaction, use either the <code>ROLLBACK</code> statement without the <code>TO</code> <code>SAVEPOINT</code> clause, or (in the SQL&nbsp;Developer environment) the <a id="sthref176"></a>Rollback Changes icon.</p>
<p><a id="sthref177"></a><a id="sthref178"></a>Rolling back the entire current transaction:</p>
<ul>
<li>
<p>Ends the transaction</p>
</li>
<li>
<p>Reverses all of its changes</p>
</li>
<li>
<p>Erases all of its savepoints</p>
</li>
<li>
<p>Releases any transaction locks</p>
</li>
</ul>
<p>Rolling back the current transaction only to the specified savepoint:</p>
<ul>
<li>
<p>Does not end the transaction</p>
</li>
<li>
<p>Reverses only the changes made after the specified savepoint</p>
</li>
<li>
<p>Erases only the savepoints set after the specified savepoint (excluding the specified savepoint itself)</p>
</li>
<li>
<p>Releases all table and row locks acquired after the specified savepoint</p>
<p>Other transactions that have requested access to rows locked after the specified savepoint must continue to wait until the transaction is either committed or rolled back. Other transactions that have not requested the rows can request and access the rows immediately.</p>
</li>
</ul>
<p>To see the effect of a rollback in SQL&nbsp;Developer, you might have to click the <a id="sthref179"></a>Refresh icon.</p>
<p>As a result of <a href="#CHDFDCHE">Example 3-7</a>, the <code>REGIONS</code> table has a region called &#39;Middle East and Africa&#39; and a region called &#39;Africa&#39;. <a href="#CHDBAEDA">Example 3-8</a> corrects this problem (a very simple transaction) and checks the change, but then rolls back the transaction and checks the rollback.</p>
<div id="TDDDG183" class="example">
<p class="titleinexample"><a id="CHDBAEDA"></a>Example 3-8 Rolling Back an Entire Transaction</p>
<p>Before transaction:</p>
<pre>SELECT * FROM REGIONS
ORDER BY REGION_ID;
 
</pre>
<p>Result:</p>
<pre> REGION_ID REGION_NAME
---------- -------------------------
         1 Europe
         2 Americas
         3 Asia
         4 Middle East and Africa
         5 Africa
 
5 rows selected.
</pre>
<p>Transaction (change table):</p>
<pre>UPDATE REGIONS
SET REGION_NAME = &#39;Middle East&#39;
WHERE REGION_NAME = &#39;Middle East and Africa&#39;;
</pre>
<p>Result:</p>
<pre>1 row updated.
 
</pre>
<p>Check change:</p>
<pre>SELECT * FROM REGIONS
ORDER BY REGION_ID;
 
</pre>
<p>Result:</p>
<pre> REGION_ID REGION_NAME
---------- -------------------------
         1 Europe
         2 Americas
         3 Asia
         <span class="bold">4 Middle East</span>
         5 Africa
 
5 rows selected.
</pre>
<p>Roll back transaction:</p>
<pre><span class="bold">ROLLBACK;</span>
</pre>
<p>Result:</p>
<pre>Rollback complete.
</pre>
<p>Check rollback:</p>
<pre>SELECT * FROM REGIONS
ORDER BY REGION_ID;
 
</pre>
<p>Result:</p>
<pre> REGION_ID REGION_NAME
---------- -------------------------
         1 Europe
         2 Americas
         3 Asia
         <span class="bold">4 Middle East and Africa</span>
         5 Africa
 
5 rows selected.
</pre></div>
<!-- class="example" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SQLRF01610" href="../SQLRF/statements_9023.htm#SQLRF01610"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about the <code>ROLLBACK</code> statement</div>
</div>
<!-- class="sect1" -->
<a id="BABJCEJH"></a>
<div id="TDDDG24300" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Setting Savepoints in Transactions</h2>
<p><a id="sthref180"></a><a id="sthref181"></a><a id="sthref182"></a>The <code>SAVEPOINT</code> statement marks a <span class="bold">savepoint</span> in a transaction&mdash;a point to which you can later roll back. Savepoints are optional, and a transaction can have multiple savepoints.</p>
<p><a href="#CHDHFHDH">Example 3-9</a> does a transaction that includes several DML statements and several savepoints, and then rolls back the transaction to one savepoint, undoing only the changes made after that savepoint.</p>
<div id="TDDDG184" class="example">
<p class="titleinexample"><a id="CHDHFHDH"></a>Example 3-9 Rolling Back a Transaction to a Savepoint</p>
<p>Check <code>REGIONS</code> table before transaction:</p>
<pre>SELECT * FROM REGIONS
ORDER BY REGION_ID;
 
</pre>
<p>Result:</p>
<pre> REGION_ID REGION_NAME
---------- -------------------------
         1 Europe
         2 Americas
         3 Asia
         4 Middle East and Africa
         5 Africa
 
5 rows selected.
</pre>
<p>Check countries in region 4 before transaction:</p>
<pre>SELECT COUNTRY_NAME, COUNTRY_ID, REGION_ID
FROM COUNTRIES
WHERE REGION_ID = 4
ORDER BY COUNTRY_NAME;
 
</pre>
<p>Result:</p>
<pre>COUNTRY_NAME                             CO  REGION_ID
---------------------------------------- -- ----------
Egypt                                    EG          4
Israel                                   IL          4
Kuwait                                   KW          4
Nigeria                                  NG          4
Zambia                                   ZM          4
Zimbabwe                                 ZW          4
 
6 rows selected.
 
</pre>
<p>Check countries in region 5 before transaction:</p>
<pre>SELECT COUNTRY_NAME, COUNTRY_ID, REGION_ID
FROM COUNTRIES
WHERE REGION_ID = 5
ORDER BY COUNTRY_NAME;
 
</pre>
<p>Result:</p>
<pre>no rows selected
 
</pre>
<p>Transaction, with several savepoints:</p>
<pre>UPDATE REGIONS
SET REGION_NAME = &#39;Middle East&#39;
WHERE REGION_NAME = &#39;Middle East and Africa&#39;;

UPDATE COUNTRIES
  SET REGION_ID = 5
  WHERE COUNTRY_ID = &#39;ZM&#39;;
<span class="bold">SAVEPOINT zambia;</span>

UPDATE COUNTRIES
  SET REGION_ID = 5
  WHERE COUNTRY_ID = &#39;NG&#39;;
<span class="bold">SAVEPOINT nigeria;</span>
 
UPDATE COUNTRIES
  SET REGION_ID = 5
  WHERE COUNTRY_ID = &#39;ZW&#39;;
<span class="bold">SAVEPOINT zimbabwe;</span>

UPDATE COUNTRIES
  SET REGION_ID = 5
  WHERE COUNTRY_ID = &#39;EG&#39;;
<span class="bold">SAVEPOINT egypt;</span>
</pre>
<p>Check <code>REGIONS</code> table after transaction:</p>
<pre>SELECT * FROM REGIONS
ORDER BY REGION_ID;
 
</pre>
<p>Result:</p>
<pre> REGION_ID REGION_NAME
---------- -------------------------
         1 Europe
         2 Americas
         3 Asia
         4 Middle East
         5 Africa
 
5 rows selected.
</pre>
<p>Check countries in region 4 after transaction:</p>
<pre>SELECT COUNTRY_NAME, COUNTRY_ID, REGION_ID
FROM COUNTRIES
WHERE REGION_ID = 4
ORDER BY COUNTRY_NAME;
 
</pre>
<p>Result:</p>
<pre>COUNTRY_NAME                             CO  REGION_ID
---------------------------------------- -- ----------
Israel                                   IL          4
Kuwait                                   KW          4
 
2 rows selected.
 
</pre>
<p>Check countries in region 5 after transaction:</p>
<pre>SELECT COUNTRY_NAME, COUNTRY_ID, REGION_ID
FROM COUNTRIES
WHERE REGION_ID = 5
ORDER BY COUNTRY_NAME;
 
</pre>
<p>Result:</p>
<pre>COUNTRY_NAME                             CO  REGION_ID
---------------------------------------- -- ----------
Egypt                                    EG          5
Nigeria                                  NG          5
Zambia                                   ZM          5
Zimbabwe                                 ZW          5
 
4 rows selected.
 
<span class="bold">ROLLBACK TO SAVEPOINT nigeria;</span>
</pre>
<p>Check <code>REGIONS</code> table after rollback:</p>
<pre>SELECT * FROM REGIONS
ORDER BY REGION_ID;
 
</pre>
<p>Result:</p>
<pre> REGION_ID REGION_NAME
---------- -------------------------
         1 Europe
         2 Americas
         3 Asia
         4 Middle East
         5 Africa
 
5 rows selected.
</pre>
<p>Check countries in region 4 after rollback:</p>
<pre>SELECT COUNTRY_NAME, COUNTRY_ID, REGION_ID
FROM COUNTRIES
WHERE REGION_ID = 4
ORDER BY COUNTRY_NAME;
 
</pre>
<p>Result:</p>
<pre>COUNTRY_NAME                             CO  REGION_ID
---------------------------------------- -- ----------
Egypt                                    EG          4
Israel                                   IL          4
Kuwait                                   KW          4
Zimbabwe                                 ZW          4
 
4 rows selected.
 
</pre>
<p>Check countries in region 5 after rollback:</p>
<pre>SELECT COUNTRY_NAME, COUNTRY_ID, REGION_ID
FROM COUNTRIES
WHERE REGION_ID = 5
ORDER BY COUNTRY_NAME;
 
</pre>
<p>Result:</p>
<pre>COUNTRY_NAME                             CO  REGION_ID
---------------------------------------- -- ----------
Nigeria                                  NG          5
Zambia                                   ZM          5
 
2 rows selected.
</pre></div>
<!-- class="example" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SQLRF01701" href="../SQLRF/statements_10001.htm#SQLRF01701"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about the <code>SAVEPOINT</code> statement</div>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5832">
<tr>
<td class="cellalignment5839">
<table class="cellalignment5837">
<tr>
<td class="cellalignment5836"><a href="tdddg_connecting.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5836"><a href="tdddg_objects.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5841">
<table class="cellalignment5835">
<tr>
<td class="cellalignment5836"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5836"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5836"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5836"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5836"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5836"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>