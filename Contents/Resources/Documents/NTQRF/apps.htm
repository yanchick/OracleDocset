<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-78986"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Developing%20Applications%20for%20Windows"></a><title>Developing Applications for Windows</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1093"/>
<meta name="dcterms.created" content="2017-05-17T5:53:58Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Platform Guide"/>
<meta name="dcterms.identifier" content="E10714-16"/>
<meta name="dcterms.isVersionOf" content="NTQRF"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2017,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="registry.htm" title="Previous" type="text/html"/>
<link rel="Next" href="ap_raw.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E10714-16.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">21/28</span> <!-- End Header -->
<div id="NTQRF190" class="chapter"><a id="g1012237"></a> <a id="i1006516"></a>
<h1 class="chapter"><span class="secnum">17</span> Developing Applications for Windows</h1>
<p>This chapter points to sources of information on developing applications for Windows and outlines a procedure for building and debugging external procedures.</p>
<p>This chapter contains these topics:</p>
<ul>
<li>
<p><a href="#BACBICCJ">About Finding Information on Application Development for Windows</a></p>
</li>
<li>
<p><a href="#i1005844">About Building External Procedures</a></p>
</li>
<li>
<p><a href="#CIHIBGAA">Overview of Multithreaded Agent Architecture</a></p>
</li>
<li>
<p><a href="#i1006102">About Debugging External Procedures</a></p>
</li>
<li>
<p><a href="#BACCGJBI">About Accessing Text Files with UTL_FILE</a></p>
</li>
</ul>
<a id="BACBICCJ"></a>
<div id="NTQRF462" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><a id="sthref905"></a><a id="sthref906"></a>About Finding Information on Application Development for Windows</h2>
<p>This section describes where to find information on developing applications specifically for Windows. These products are included on your Oracle Database Server media.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle Objects for OLE (OO4O), Oracle COM Automation on Windows, and Oracle Counters for Windows Performance Monitor are not supported on Oracle Database 12<span class="italic">c</span> Release 1 (12.1) for 64-bit and 32-bit Windows. See <a class="olink UPGRD60000" href="../UPGRD/deprecated.htm#UPGRD60000"><span class="italic">Oracle Database Upgrade Guide</span></a> for a list of desupported features.</div>
<div id="NTQRF463" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref907"></a>
<h3 class="sect2">About Java Enhancements</h3>
<p>Oracle Database includes an integrated Java Virtual Machine and JIT Compiler. Oracle Database also provides Oracle Java Database Connectivity (JDBC) Drivers. For more information, refer to <a class="olink JJDEV" href="../JJDEV/toc.htm"><span class="italic">Oracle Database Java Developer&#39;s Guide</span></a> and <a class="olink JJDBC" href="../JJDBC/toc.htm"><span class="italic">Oracle Database JDBC Developer&#39;s Guide</span></a>.</p>
</div>
<!-- class="sect2" -->
<a id="CHDHBGJA"></a>
<div id="NTQRF469" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">About ODP.NET</h3>
<p>Oracle Data Provider for .NET (ODP.NET) is an implementation of a Microsoft ADO.NET data provider for Oracle Database. ODP.NET uses Oracle native APIs to offer fast and reliable access to Oracle data and features from any .NET application. ODP.NET also uses and inherits classes and interfaces available in the Microsoft .NET Framework Class Library. For more information, refer to <a class="olink ODPNT" href="../ODPNT/toc.htm"><span class="italic">Oracle Data Provider for .NET Developer&#39;s Guide for Microsoft Windows</span></a> and My Oracle Support Note 726240.1.</p>
</div>
<!-- class="sect2" -->
<div id="NTQRF664" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref908"></a>
<h3 class="sect2">About Oracle Developer Tools for Visual Studio</h3>
<p>The Oracle Developer Tools for Visual Studio (ODT) is a tightly integrated &#34;Add-in&#34; for Microsoft Visual Studio. ODT integrates with Visual Studio to make it easy to browse and edit Oracle schema objects using integrated visual designers and can automatically generate .NET code through a simple drag and drop. Developers can modify table data, execute Oracle SQL statements, edit and debug PL/SQL code, generate and edit SQL scripts, and develop and deploy .NET stored procedures. There are many more features included with these tools. For more information, visit the ODT web home at</p>
<p><code dir="ltr"><a href="http://www.oracle.com/technetwork/developer-tools/visual-studio/overview/index.html">http://www.oracle.com/technetwork/developer-tools/visual-studio/overview/index.html</a></code></p>
</div>
<!-- class="sect2" -->
<div id="NTQRF665" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref909"></a>
<h3 class="sect2">About Oracle Providers for ASP.NET</h3>
<p>Starting with .NET Framework 2.0, ASP.NET includes service providers that store state in databases. By storing this state in a database, applications can ensure high availability of data, while making the data equally available to all web servers. For more information, refer to <a class="olink ASPNT" href="../ASPNT/toc.htm"><span class="italic">Oracle Providers for ASP.NET Developer&#39;s Guide for Microsoft Windows</span></a>.</p>
</div>
<!-- class="sect2" -->
<div id="NTQRF464" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref910"></a>
<h3 class="sect2">About XML Support</h3>
<p>Oracle XML products include XML Developer&#39;s Kit (XDK) and Oracle XML SQL Utility. For more information, refer to:</p>
<ul>
<li>
<p><a class="olink ADXDK" href="../ADXDK/toc.htm"><span class="italic">Oracle XML Developer&#39;s Kit Programmer&#39;s Guide</span></a></p>
</li>
<li>
<p><a class="olink ADXDB" href="../ADXDB/toc.htm"><span class="italic">Oracle XML DB Developer&#39;s Guide</span></a></p>
</li>
<li>
<p><a class="olink JAXML" href="../JAXML/toc.htm"><span class="italic">Oracle Database XML Java API Reference</span></a></p>
</li>
<li>
<p><a class="olink CAXML" href="../CAXML/toc.htm"><span class="italic">Oracle Database XML C API Reference</span></a></p>
</li>
<li>
<p><a class="olink CPXML" href="../CPXML/toc.htm"><span class="italic">Oracle Database XML C++ API Reference</span></a></p>
</li>
<li>
<p><a class="olink SQLRF" href="../SQLRF/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a></p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<div id="NTQRF465" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref911"></a>
<h3 class="sect2">About Support for Internet Applications</h3>
<p><a id="sthref912"></a>Oracle Database support for internet applications includes Oracle WebCenter Portal, which enables you to publish your data to the web, Oracle Web Tier (Oracle HTTP Server), and PL/SQL Embedded Gateway, which offers <a href="glossary.htm#i432445"><span class="xrefglossterm">PL/SQL</span></a> procedures stored in Oracle Database that can be started through browsers. For more information, refer to:</p>
<ul>
<li>
<p><a class="olink INSWC" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=INSWC"><span class="italic">Oracle Fusion Middleware Installation Guide for Oracle WebCenter Portal</span></a></p>
</li>
<li>
<p><a class="olink JPSTT" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=JPSTT"><span class="italic">Oracle Fusion Middleware Tutorial for Oracle WebCenter Portal Developers</span></a></p>
</li>
<li>
<p><a class="olink OEMCG" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=OEMCG"><span class="italic">Oracle Enterprise Manager Grid Control Installation and Basic Configuration</span></a></p>
<p>Oracle Database provides built-in mechanisms that address the requirements of the largest PHP, Ruby, Python Web, and Rich Internet Applications. The features include extreme connectivity, scalability, caching, nonintrusive performance acceleration, advanced security, and high-availability.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<div id="NTQRF470" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref913"></a>
<h3 class="sect2">About Oracle Services for Microsoft Transaction Server</h3>
<p>With Oracle Services for <a href="glossary.htm#i432315"><span class="xrefglossterm">Microsoft Transaction Server</span></a>, Oracle Database can be a resource manager in Microsoft Distributed Transaction Coordinator (DTC) transactions. Oracle Services for Microsoft Transaction Server act as a proxy for Oracle Database to the DTC. For more information, refer to <a class="olink NTMTS" href="../NTMTS/toc.htm"><span class="italic">Oracle Services for Microsoft Transaction Server Developer&#39;s Guide for Microsoft Windows</span></a>.</p>
</div>
<!-- class="sect2" -->
<div id="NTQRF472" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref914"></a>
<h3 class="sect2">About Oracle Provider for OLE DB</h3>
<p>Refer to <a class="olink OLEDB" href="../OLEDB/toc.htm"><span class="italic">Oracle Provider for OLE DB Developer&#39;s Guide for Microsoft Windows</span></a> for information on OLE DB.</p>
</div>
<!-- class="sect2" -->
<div id="NTQRF701" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref915"></a>
<h3 class="sect2">About Oracle ODBC Driver</h3>
<p>Open Database Connectivity (ODBC) provides a common C programming interface for applications to access data from database management systems. Access to databases is managed by the ODBC Driver Manager. The driver manager provides the linkage between an ODBC application and an ODBC driver for a specific database management system.</p>
<p>Oracle ODBC Driver provides access to Oracle databases for applications written using the ODBC interface.</p>
<p>Oracle Technology Network has both Oracle home based ODBC driver and Instant Client enabled ODBC driver.</p>
<p>Download Instant Client enabled ODBC driver from</p>
<pre dir="ltr"><a href="http://www.oracle.com/technetwork/database/features/instant-client/index.html">http://www.oracle.com/technetwork/database/features/instant-client/index.html</a>
</pre></div>
<!-- class="sect2" -->
<div id="NTQRF471" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref916"></a>
<h3 class="sect2">About Pro*C/C++ and Pro*COBOL Applications</h3>
<p>Refer to the following guides for more information on Pro*C/C++ and Pro*COBOL applications:</p>
<ul>
<li>
<p><a class="olink LNPCC" href="../LNPCC/toc.htm"><span class="italic">Pro*C/C++ Programmer&#39;s Guide</span></a></p>
</li>
<li>
<p><a class="olink LNPCB" href="../LNPCB/toc.htm"><span class="italic">Pro*COBOL Programmer&#39;s Guide</span></a></p>
</li>
<li>
<p><a class="olink LNOCI" href="../LNOCI/toc.htm"><span class="italic">Oracle Call Interface Programmer&#39;s Guide</span></a></p>
</li>
</ul>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1005844"></a>
<div id="NTQRF478" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><a id="sthref917"></a><a id="sthref918"></a>About Building External Procedures</h2>
<p>This section describes how to create and use <a href="glossary.htm#i432249"><span class="xrefglossterm">external procedures</span></a> on Windows. The following files are located in <code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code><code dir="ltr">\rdbms\extproc</code>:</p>
<ul>
<li>
<p><code dir="ltr"><span class="codeinlinebold">extern.c</span></code> is the code example shown in <a href="#i1005976">&#34;Writing an External Procedure&#34;</a></p>
</li>
<li>
<p><code dir="ltr"><span class="codeinlinebold">make.bat</span></code> is the batch file that builds the <a href="glossary.htm#i432246"><span class="xrefglossterm">dynamic link library</span></a></p>
</li>
<li>
<p><code dir="ltr"><span class="codeinlinebold">extern.sql</span></code> automates the instructions described in <a href="#i1006021">&#34;Registering an External Procedure&#34;</a> and <a href="#i1006075">&#34;Executing an External Procedure&#34;</a></p>
</li>
</ul>
<div id="NTQRF479" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref919"></a>
<h3 class="sect2">External Procedures Overview</h3>
<p>External procedures are functions written in a third-generation language (C, for example) and callable from within PL/SQL or SQL as if they were a PL/SQL routine or function. External procedures let you take advantage of strengths and capabilities of a third-generation programming language in a PL/SQL environment.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle Database also provides a special purpose interface, the call specification, that lets you call external procedures from other languages, as long as they are callable by C.</div>
<p><a id="sthref920"></a>The main advantages of external procedures are:</p>
<ul>
<li>
<p>Performance, because some tasks are performed more efficiently in a third-generation language than in PL/SQL, which is better suited for SQL transaction processing</p>
</li>
<li>
<p>Code re-usability, because dynamic link libraries (DLLs) can be called directly from PL/SQL programs on the server or in client tools</p>
</li>
</ul>
<p>You can use external procedures to perform specific processes:</p>
<ul>
<li>
<p>Solving scientific and engineering problems</p>
</li>
<li>
<p>Analyzing data</p>
</li>
<li>
<p>Controlling real-time devices and processes</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Caution:</p>
Special security precautions are warranted when configuring a listener to handle external procedures. See <a href="ap_net.htm#CHDHEHCH">&#34;Modifying Configuration of External Procedures for Higher Security&#34;</a> and <a class="olink NETAG0132" href="../NETAG/advcfg.htm#NETAG0132"><span class="italic">Oracle Database Net Services Administrator&#39;s Guide</span></a> for more information.</div>
<p>To create and use an external procedure, perform the following sequential steps:</p>
<ul>
<li>
<p><a href="#i1005913">Installing and Configuring Oracle Database and Oracle Net Services</a></p>
</li>
<li>
<p><a href="#i1005976">Writing an External Procedure</a></p>
</li>
<li>
<p><a href="#BACBIJJJ">Building a DLL</a></p>
</li>
<li>
<p><a href="#i1006021">Registering an External Procedure</a></p>
</li>
<li>
<p><a href="#CIHJHDBE">Restricting Library-Related Privileges to Trusted Users Only</a></p>
</li>
<li>
<p><a href="#i1006075">Executing an External Procedure</a></p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<ul>
<li>
<p>You must have a C compiler and linker installed on your system to build DLLs.</p>
</li>
<li>
<p>You can combine the instructions described in the fourth and fifth tasks into one SQL script that automates the task of registering and executing your external procedure. See <code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code><code dir="ltr">\rdbms\extproc\extern.sql</code> for an example of a SQL script that combines these steps.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="i1005913"></a>
<div id="NTQRF480" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Installing and Configuring Oracle Database and Oracle Net Services</h3>
<p>This section describes installation and configuration of Oracle Database and <a href="glossary.htm#i433191"><span class="xrefglossterm">Oracle Net</span></a>.</p>
<div id="NTQRF481" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref921"></a>
<h4 class="sect3">Installing Oracle Database</h4>
<p>Follow the steps in <a class="olink NTDBI" href="../NTDBI/toc.htm"><span class="italic">Oracle Database Installation Guide for Microsoft Windows</span></a> to install these products on your Windows server:</p>
<ul>
<li>
<p><a id="sthref922"></a>Oracle Database Enterprise Edition, Oracle Database Standard Edition, Oracle Database Standard Edition One, Oracle Database Standard Edition 2, or Oracle Database Personal Edition. Each type contains PL/SQL, from which external procedures are called, and the PL/SQL external procedure program (<code dir="ltr">EXTPROC</code>), which runs external procedures.</p>
</li>
<li>
<p>Oracle Net Services</p>
</li>
<li>
<p><a href="glossary.htm#i432415"><span class="xrefglossterm">Oracle Protocol Support</span></a></p>
</li>
</ul>
</div>
<!-- class="sect3" -->
<a id="i1005946"></a>
<div id="NTQRF482" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><a id="sthref923"></a>Configuring Oracle Net Services</h4>
<p>During database server installation, Oracle Net Configuration Assistant configures <code dir="ltr">listener.ora</code> and <code dir="ltr">tnsnames.ora</code> files for external procedure calls.</p>
<p><a id="sthref924"></a><a id="sthref925"></a>When an application calls an external procedure, Oracle Net Listener starts an external procedure agent called <code dir="ltr">EXTPROC</code>. By default, the <code dir="ltr">extproc</code> process communicates directly through the server process. Using a network connection established by the listener, the application passes the following information to <code dir="ltr">EXTPROC</code>:</p>
<ul>
<li>
<p>DLL name</p>
</li>
<li>
<p>External procedure name</p>
</li>
<li>
<p>Parameters (if necessary)</p>
</li>
</ul>
<p><code dir="ltr">EXTPROC</code> then loads the DLL, runs the external procedure, and passes back any values returned by the external procedure.</p>
<p>If you overwrite default <code dir="ltr">listener.ora</code> and <code dir="ltr">tnsnames.ora</code> files, then you must manually configure the following files for the external procedure behavior described previously to occur:</p>
<ul>
<li>
<p><code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code><code dir="ltr">\network\admin\listener.ora</code></p>
</li>
<li>
<p><code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code><code dir="ltr">\network\admin\tnsnames.ora</code></p>
<div class="infobox-note">
<p class="notep1">Caution:</p>
Additional security may be required for the listener in a production environment. See <a class="olink NETAG010" href="../NETAG/listenercfg.htm#NETAG010"><span class="italic">Oracle Database Net Services Administrator&#39;s Guide</span></a> for more information.</div>
</li>
</ul>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1005976"></a>
<div id="NTQRF483" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><a id="sthref926"></a><a id="sthref927"></a>Writing an External Procedure</h3>
<p>Using a third-generation programming language, you can write functions to be built into DLLs and started by <code dir="ltr">EXTPROC</code>. The following is a simple Microsoft Visual C++ example of an external procedure called <code dir="ltr">FIND_MAX</code>:</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Because external procedures are built into DLLs, they must be explicitly exported. In this example, the <code dir="ltr">DLLEXPORT</code> storage class modifier exports the function <code dir="ltr">FIND_MAX</code> from a dynamic link library.</div>
<pre dir="ltr">#include &lt;windows.h&gt;
#define NullValue -1
/*
  This function tests if x is at least as big as y.
*/
long __declspec(dllexport) find_max(long   x, 
                                short   x_indicator, 
long    y, 
short y_indicator, 
                                short *ret_indicator)
{
   /* It can be tricky to debug DLL&#39;s that are being called by a process
      that is spawned only when needed, as in this case.  
      Therefore try using the DebugBreak(); command.  
      This will start your debugger.  Uncomment the line with DebugBreak(); 
      in it and you can step right into your code.
   */
   /* DebugBreak();  */

   /* First check to see if you have any nulls. */
   /* Just return a null if either x or y is null. */

   if ( x_indicator==NullValue || y_indicator==NullValue) {
      *ret_indicator = NullValue;   
      return(0);
   } else { 
      *ret_indicator = 0;       /* Signify that return value is not null. */
      if (x &gt;= y) return x;
      else return y;
   }
}
</pre></div>
<!-- class="sect2" -->
<a id="BACBIJJJ"></a>
<div id="NTQRF484" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><a id="sthref928"></a><a id="sthref929"></a>Building a DLL</h3>
<p>After writing your external procedures in a third-generation programming language, use the appropriate compiler and linker to build a DLL, making sure to export the external procedures as noted previously. See your compiler and linker documentation for instructions on building a DLL and exporting its functions.</p>
<p>You can build the external procedure <code dir="ltr">FIND_MAX</code>, created in <a href="#i1005976">&#34;Writing an External Procedure&#34;</a>, into a DLL called <code dir="ltr">extern.dll</code> by going to <code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code><code dir="ltr">\rdbms\extproc</code> and typing <code dir="ltr">make</code>. After building the DLL, you can move it to any directory on your system.</p>
<p>The default behavior of <code dir="ltr">EXTPROC</code> is to load DLLs only from <code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code><code dir="ltr">\bin</code> or <code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code><code dir="ltr">\lib</code>. To load DLLs from other directories, you must set environment variable <code dir="ltr">EXTPROC_DLLS</code> to a colon (:) separated list (semicolon-separated on Windows systems) of DLL names qualified with their complete paths. The preferred way to set this environment variable is through the <code dir="ltr">ENVS</code> parameter in <code dir="ltr">listener.ora</code>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADFNS010" href="../ADFNS/adfns_externproc.htm#ADFNS010"><span class="italic">Oracle Database Development Guide</span></a> for more information on <code dir="ltr">EXTPROC</code></div>
</div>
<!-- class="sect2" -->
<a id="i1006021"></a>
<div id="NTQRF485" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><a id="sthref930"></a><a id="sthref931"></a>Registering an External Procedure</h3>
<p>Once you have built a DLL containing your external procedures, you must register your external procedures with Oracle Database. Starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1), you can configure the <a id="sthref932"></a><a id="sthref933"></a><code dir="ltr">EXTPROC</code> process to be authenticated through a <code dir="ltr">CREDENTIAL</code> for better security.</p>
<p><a id="sthref934"></a>Oracle Database 12<span class="italic">c</span> Release 1 (12.1) supports two new extensions to the <code dir="ltr">CREATE LIBRARY</code> command. This includes a <code dir="ltr">CREDENTIAL</code> clause and a <code dir="ltr">DIRECTORY</code> object option. The <code dir="ltr">CREDENTIAL</code> clause defines the user the <code dir="ltr">EXTPROC</code> runs as while the <code dir="ltr">DIRECTORY</code> object option specifies the directory where the DLL can be located.</p>
<p><a id="sthref935"></a><a id="sthref936"></a>To create a PL/SQL library to map to the DLL:</p>
<ol>
<li>
<p>Set environment variable <code dir="ltr">EXTPROC_DLLS</code> in the <code dir="ltr">ENVS</code> parameter in <code dir="ltr">listener.ora</code>. For example:</p>
<pre dir="ltr">SID_LIST_LISTENER =
 (SID_LIST =
  (SID_DESC =
   (SID_NAME=PLSExtProc)
   (ENVS=EXTPROC_DLLS=C:\app\oracle\product\12.1.0\dbhome_1\rdbms\extproc\extern.dll)
   (ORACLE_HOME=C:\app\oracle\product\12.1.0\dbhome_1)
   (PROGRAM=extproc)
  )
 )
</pre></li>
<li>
<p>Start SQL*Plus:</p>
<pre dir="ltr">C:\&gt; sqlplus
</pre></li>
<li>
<p>Connect to the database with appropriate <a href="glossary.htm#i432581"><span class="xrefglossterm">username</span></a> and password.</p>
</li>
<li>
<p>Create the PL/SQL library using the <code dir="ltr">CREATE LIBRARY</code> command:</p>
<pre dir="ltr">DBMS_CREDENTIAL.CREATE_CREDENTIAL(...);
CREATE DIRECTORY DLL_LOC as ...;
CREATE LIBRARY externProcedures as &#39;extern.dll&#39; in DLL_LOC credential the_credential;
</pre>
<p>where <code dir="ltr">the_credential</code> is the name chosen during the <code dir="ltr">DBMS_CREDENTIAL.CREATE_CREDENTIAL</code> invocation</p>
<pre dir="ltr">SQL&gt; CREATE LIBRARY externProcedures AS &#39;C:\app\oracle\product\12.1.0\dbhome_1\rdbms\ extproc\extern.dll&#39;;
</pre>
<p>where <code dir="ltr">externProcedures</code> is an alias library (essentially a schema object in the database), and</p>
<pre dir="ltr">C:\app\oracle\product\12.1.0\dbhome_1\rdbms\extproc\extern.dll
</pre>
<p>is the path to the Windows operating system <code dir="ltr">dllextern.dll</code>. This example uses <code dir="ltr">C:\app\oracle\product\12.1.0</code> as your Oracle base and <code dir="ltr">dbhome_1</code> as your Oracle home.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<a id="sthref937"></a><a id="sthref938"></a>The DBA must grant the <code dir="ltr">EXECUTE</code> <a href="glossary.htm#i432451"><span class="xrefglossterm">privilege</span></a> on the PL/SQL library to users who want to call the library&#39;s external procedure from PL/SQL or SQL. Separate <code dir="ltr">EXECUTE</code> privilege on credential and directory object extensions are required for them to function properly.</div>
</li>
<li>
<p><a id="sthref939"></a><a id="sthref940"></a>Create a PL/SQL program unit specification.</p>
<p>Do this by writing a PL/SQL subprogram that uses the <code dir="ltr">EXTERNAL</code> clause instead of declarations and a <code dir="ltr">BEGIN...END</code> block. The <code dir="ltr">EXTERNAL</code> clause is the interface between PL/SQL and the external procedure. The <code dir="ltr">EXTERNAL</code> clause identifies the following information about the external procedure:</p>
<ul>
<li>
<p>Name</p>
</li>
<li>
<p>DLL alias</p>
</li>
<li>
<p>Programming language in which it was written</p>
</li>
<li>
<p>Calling standard (defaults to C if omitted)</p>
</li>
</ul>
<p>In the following example, <code dir="ltr">externProcedures</code> is a DLL alias. You need the <code dir="ltr">EXECUTE</code> privilege for this library. The external procedure to call is <code dir="ltr">find_max</code>. If enclosed in double quotation marks, it becomes case-sensitive. The <code dir="ltr">LANGUAGE</code> term specifies the language in which the external procedure was written.</p>
<pre dir="ltr">CREATE OR REPLACE FUNCTION PLS_MAX(
  x BINARY_INTEGER,
  y BINARY_INTEGER)
RETURN BINARY_INTEGER AS EXTERNAL
  LIBRARY externProcedures
  NAME &#34;find_max&#34;
  LANGUAGE C
  PARAMETERS (
    x long,                  -- stores value of x
    x_INDICATOR short,       -- used to determine if x is a NULL value
    y long,                  -- stores value of y
    y_INDICATOR short,        -- used to determine if y is a NULL value
  RETURN INDICATOR short );  -- need to pass pointer to return value&#39;s
                             -- indicator variable to determine if NULL
-- This means that my function will be defined as:
    -- long max(long x, short x_indicator,
    -- long y, short y_indicator, short * ret_indicator)
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CIHJHDBE"></a>
<div id="NTQRF666" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Restricting Library-Related Privileges to Trusted Users Only</h3>
<p>The <code dir="ltr">CREATE LIBRARY</code>, <code dir="ltr">CREATE ANY LIBRARY</code>, <code dir="ltr">ALTER ANY LIBRARY</code>, and <code dir="ltr">EXECUTE ANY LIBRARY</code> privileges, and grants of <code dir="ltr">EXECUTE ON</code> <code dir="ltr"><span class="codeinlineitalic">library_name</span></code> convey a great deal of power to users. If you plan to create PL/SQL interfaces to libraries, only grant the <code dir="ltr">EXECUTE</code> privilege to the PL/SQL interface. Do not grant <code dir="ltr">EXECUTE</code> on the underlying library. You must have the <code dir="ltr">EXECUTE</code> privilege on a library to create the PL/SQL interface to it. However, users have this privilege implicitly on libraries that they create in their own schemas. Explicit grants of <code dir="ltr">EXECUTE ON</code> <code dir="ltr"><span class="codeinlineitalic">library_name</span></code> are rarely required. Only make an explicit grant of these privileges to trusted users, and never to the <code dir="ltr">PUBLIC</code> role.</p>
</div>
<!-- class="sect2" -->
<a id="i1006075"></a>
<div id="NTQRF486" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><a id="sthref941"></a>Executing an External Procedure</h3>
<p>To run an external procedure, you must call the PL/SQL program unit (that is, the alias for the external function) that registered the external procedure. These calls can appear in any of the following:</p>
<ul>
<li>
<p>Anonymous blocks</p>
</li>
<li>
<p>Standalone and packaged subprograms</p>
</li>
<li>
<p>Methods of an object type</p>
</li>
<li>
<p>Database triggers</p>
</li>
<li>
<p>SQL statements (calls to packaged functions only)</p>
</li>
</ul>
<p>In <a href="#i1006021">&#34;Registering an External Procedure&#34;</a>, PL/SQL function <code dir="ltr">PLS_MAX</code> registered external procedure <code dir="ltr">find_max</code><span class="bold">.</span> Follow these steps to run <code dir="ltr">find_max</code>:</p>
<ol>
<li>
<p>Call PL/SQL function <code dir="ltr">PLS_MAX</code> from a PL/SQL routine named <code dir="ltr">UseIt</code>:</p>
<pre dir="ltr">SET SERVER OUTPUT ON
CREATE OR REPLACE PROCEDURE UseIt AS
                a integer;
                b integer;
                c integer;
BEGIN
                a := 1;
                b := 2;
                c := PLS_MAX(a,b);
                dbms_output.put_line(&#39;The maximum of &#39;||a||&#39; and &#39;||b||&#39; is  &#39;||c);
END;
</pre></li>
<li>
<p>Run the routine:</p>
<pre dir="ltr">SQL&gt; EXECUTE UseIt;
</pre></li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CIHIBGAA"></a>
<div id="NTQRF487" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Overview of Multithreaded Agent Architecture<a id="sthref942"></a></h2>
<p>An agent process is started for each session to access a system at the same time leading to several thousand agent processes concurrently. The agent processes operate regardless of whether each individual agent process is actually active at the moment. Agent processes and open connections can consume a disproportionate amount of system resources. This problem is addressed by using multithreaded agent architecture.</p>
<p>The multithreaded agent architecture uses a pool of shared agent threads. The tasks requested by the user sessions are put in a queue and are picked up by the first available multithreaded agent thread. Because only a small percentage of user connections are active at a given moment, using a multithreaded architecture allows for more efficient use of system resources.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p>Part III of <a class="olink ADFNS" href="../ADFNS/toc.htm"><span class="italic">Oracle Database Development Guide</span></a></p>
</li>
<li>
<p>&#34;Multithreaded Agents&#34; in <a class="olink HETER005" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=HETER005"><span class="italic">Oracle Database Heterogeneous Connectivity User&#39;s Guide</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="i1006102"></a>
<div id="NTQRF488" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><a id="sthref943"></a><a id="sthref944"></a>About Debugging External Procedures</h2>
<p>Usually, when an external procedure fails, its C prototype is faulty. That is, the prototype does not match the one generated internally by PL/SQL. This can happen if you specify an incompatible C data type. For example, to pass an <code dir="ltr">OUT</code> parameter of type <code dir="ltr">REAL</code>, you must specify <code dir="ltr">float</code> <code dir="ltr">*</code>. Specifying <code dir="ltr">float</code>, <code dir="ltr">double</code> <code dir="ltr">*</code>, or any other C data type will result in a mismatch.</p>
<p>In such cases, you might get a <code dir="ltr">lost</code> <code dir="ltr">RPC</code> <code dir="ltr">connection</code> <code dir="ltr">to</code> <code dir="ltr">external</code> <code dir="ltr">procedure</code> <code dir="ltr">agent</code> error, which means that agent <code dir="ltr">extproc</code> terminated abnormally because the external procedure caused a core dump. To avoid errors when declaring C prototype parameters, refer to <a class="olink ADDCI" href="../ADDCI/toc.htm"><span class="italic">Oracle Database Data Cartridge Developer&#39;s Guide.</span></a></p>
<div id="NTQRF489" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref945"></a>
<h3 class="sect2">Using Package DEBUG_EXTPROC</h3>
<p>To help you debug external procedures, PL/SQL provides utility package <code dir="ltr">DEBUG_</code><code dir="ltr">EXTPROC</code>. To install the package, run script <code dir="ltr">dbgextp.sql</code>, which you can find in the PL/SQL demo directory.</p>
<p>To use the package, follow instructions in <code dir="ltr">dbgextp.sql</code>. Your Oracle Database account must have <code dir="ltr">EXECUTE</code> privileges on the package and <code dir="ltr">CREATE</code> <code dir="ltr">LIBRARY</code> privileges.</p>
<p>To debug external procedures:</p>
<ol>
<li>
<p>From Windows Task Manager, in the Processes dialog, select <span class="bold">ExtProc.exe</span>.</p>
</li>
<li>
<p>Right click, and select <span class="bold">Debug</span>.</p>
</li>
<li>
<p>Click <span class="bold">OK</span> in the message window.</p>
<p>If you have built your DLL in a debug fashion with Microsoft Visual C++, then Visual C++ is activated.</p>
</li>
<li>
<p>In the Visual C++ window, select <span class="bold">Edit</span> <code dir="ltr">&gt;</code> <span class="bold">Breakpoints</span>.</p>
<p>Use the breakpoint identified in <code dir="ltr">dbgextp.sql</code> in the PL/SQL demo directory.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code><code dir="ltr">\rdbms\extproc\readme.doc</code> (explains how to run the sample and provides debugging advice)</p>
</li>
<li>
<p><a class="olink LNPLS" href="../LNPLS/toc.htm"><span class="italic">Oracle Database PL/SQL Language Reference</span></a></p>
</li>
<li>
<p><a class="olink JJDEV" href="../JJDEV/toc.htm"><span class="italic">Oracle Database Java Developer&#39;s Guide</span></a></p>
</li>
<li>
<p><a class="olink ADFNS010" href="../ADFNS/adfns_externproc.htm#ADFNS010"><span class="italic">Oracle Database Development Guide</span></a></p>
</li>
<li>
<p><a class="olink ADDCI" href="../ADDCI/toc.htm"><span class="italic">Oracle Database Data Cartridge Developer&#39;s Guide</span></a></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BACCGJBI"></a>
<div id="NTQRF490" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">About <a id="sthref946"></a><a id="sthref947"></a>Accessing Text Files with UTL_FILE</h2>
<p>Package <code dir="ltr">UTL_FILE</code> allows your PL/SQL programs to read and write operating system text files. It provides a restricted version of standard operating system stream file I/O, including open, put, get, and close operations. When you want to read or write a text file, you call the function <code dir="ltr">fopen</code>, which returns a file handle for use in subsequent procedure calls. For example, the procedure <code dir="ltr">put_line</code> writes a text string and line terminator to an open file, and the procedure <code dir="ltr">get_line</code> reads a line of text from an open file into an output buffer.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ARPLS069" href="../ARPLS/u_file.htm#ARPLS069"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a></div>
<p><code dir="ltr">FSEEK</code>, a <code dir="ltr">UTL_FILE</code> subprogram, adjusts the file pointer forward or backward within the file by the number of bytes specified. In order for <code dir="ltr">UTL_FILE.FSEEK</code> to work correctly, the lines in the file must have platform-specific line terminator characters. On Windows platforms the correct line terminator characters are <code dir="ltr">&lt;CR&gt;&lt;LF&gt;</code>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<span class="italic">Oracle Database Development Guide</span></div>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5009">
<tr>
<td class="cellalignment5016">
<table class="cellalignment5014">
<tr>
<td class="cellalignment5013"><a href="registry.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5013"><a href="ap_raw.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2017,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5018">
<table class="cellalignment5012">
<tr>
<td class="cellalignment5013"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5013"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5013"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5013"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5013"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5013"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>