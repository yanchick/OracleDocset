<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-5564"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Switchover%20and%20Failover%20Operations"></a><title>Switchover and Failover Operations</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="switchovers, overview, databases, during, switchover, before you perform a switchover, prerequisites, prerequisites, starting, starting, broker tasks, managing, manual failover, failovers, managing, manual, role transitions, roles, immediate failover, manual failover, immediate option, manual, starting manually, complete, immediate, reenabling after a role transition, reenabling disabled standby databases, reinstatement, how to, using DGMGRL, DGMGRL, reinstating a database, fast-start failover, fast-start, observer, fast-start failover, observer overview, monitoring, monitoring by the observer, shutdown abort, effect on fast-start failover, shutdown abort, detecting, database shutdown, shutting down, manual role changes, performing when fast-start failover is enabled, performing manual failovers when enabled, performing switchover when enabled, directed from an application, DBMS_DG package, using to direct fast-start failover, V$FS_FAILOVER_STATS view, maintaining fast-start failover configuration information, FSFO.DAT file, configuration information in the fsfo.dat file, configuration files, fast-start failover configuration (fsfo.dat) file, START OBSERVER command, fast-start failover configuration file (fsfo.dat), high availability, restoring after fast-start failover, reinstating the former primary database, primary database, reinstating after a fast-start failover, application continuity, support in Oracle Data Guard broker"/>
<meta name="dcterms.created" content="2017-07-21T13:32:49Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Data Guard Broker"/>
<meta name="dcterms.identifier" content="E48241-09"/>
<meta name="dcterms.isVersionOf" content="DGBKR"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="dbresource.htm" title="Previous" type="text/html"/>
<link rel="Next" href="cli.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E48241-09.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-44E7A982-7CD4-4A51-B00E-62C0698C5CD6"></a> <span id="PAGE" style="display:none;">10/17</span> <!-- End Header -->
<script>
//<![CDATA[
window.name='sofo'
//]]>
</script> <script>
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" lang="en-us" ><head><title>');
   
    msg.document.write('Footnote&amp;nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('');
    msg.document.write('<style> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]\u003e <\/style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
</script><noscript>
<p>The script content on this page is for navigation purposes only and does not alter the content in any way.</p>
</noscript><a id="DGBKR330"></a>
<h1 id="DGBKR-GUID-44E7A982-7CD4-4A51-B00E-62C0698C5CD6" class="sect1"><span class="enumeration_chapter">5</span> Switchover and Failover Operations</h1>
<div>
<p>The following topics describe how the broker m<a id="d12131e20" class="indexterm-anchor"></a><a id="d12131e24" class="indexterm-anchor"></a><a id="d12131e28" class="indexterm-anchor"></a><a id="d12131e32" class="indexterm-anchor"></a>anages databases during switchover and failover.</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="sofo.htm#GUID-7F6C5802-E4AF-4680-91F6-AD380679A555">Overview of Switchover and Failover in a Broker Environment</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-2AEF86C4-3CFA-4CF5-AEF3-E25871298363">Choosing a Target Standby Database</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-AC6A6D2B-1112-422B-8A41-02FAC40E2078">Switchover</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-9A988501-7E18-4A62-8CD6-4BDDFA355C98">Manual Failover</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-995CED84-BEA1-4675-9C68-B37CB996924F">Fast-Start Failover</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-790C40A3-B712-4AEB-B70E-1B7987C6315C">Database Client Considerations</a></p>
</li>
</ul>
</div>
<a id="DGBKR3401"></a>
<div class="props_rev_3"><a id="GUID-7F6C5802-E4AF-4680-91F6-AD380679A555"></a>
<h2 id="DGBKR-GUID-7F6C5802-E4AF-4680-91F6-AD380679A555" class="sect2"><span class="enumeration_section">5.1</span> Overview of Switchover and Failover in a Broker Environment</h2>
<div>
<p>An Oracle database operates in one of two roles: primary or standby. Oracle Data Guard helps you change the role of a database using either a switchover or a failover:</p>
<ul style="list-style-type: disc;">
<li>
<p>A <span class="bold">switchover</span> is a role reversal between the primary database and one of its standby databases. A switchover guarantees no data loss and is typically done for planned maintenance of the primary system. During a switchover, the primary database transitions to a standby role, and the standby database transitions to the primary role.</p>
</li>
<li>
<p>A failover is a role transition in which one of the standby databases is transitioned to the primary role after the primary database (all instances in the case of an Oracle RAC database) fails or has become unreachable. A failover may or may not result in data loss depending on the protection mode in effect at the time of the failover.</p>
</li>
</ul>
<p>Without the broker, you perform role transitions by issuing a series of SQL statements (as described in <a class="olink SBYDB00600" target="_blank" href="../SBYDB/role_management.htm#SBYDB00600"><span class="italic">Oracle Data Guard Concepts and Administration</span></a>). The broker simplifies switchovers and failovers by allowing you to invoke them using a single key click in Oracle Enterprise Manager Cloud Control (Cloud Control) or a single command in the DGMGRL command-line interface (referred to in this documentation as <a id="d12131e113" class="indexterm-anchor"></a><span class="italic">manual</span> failover). Moreover, you can enable fast-start failover to fail over automatically when the conditions for fast-start failover are met. When <a id="d12131e118" class="indexterm-anchor"></a>fast-start failover is enabled, the broker determines if a failover is necessary and initiates the failover to the specified target standby database automatically, with no need for DBA intervention.</p>
<p>Fast-start failover allows you to increase availability with less need for manual intervention, thereby reducing management costs. Manual failover gives you control over exactly when a failover occurs and to which target standby database. Regardless of the method you choose, the broker coordinates the role transition on all databases in the configuration.</p>
<div class="infobox-note" id="GUID-7F6C5802-E4AF-4680-91F6-AD380679A555__GUID-14E9CC7F-A2A3-4670-9636-228D86C5CEED">
<p class="notep1">Note:</p>
<p>Neither a switchover nor a failover is possible to a far sync instance.</p>
</div>
</div>
</div>
<a id="DGBKR3650"></a><a id="DGBKR3310"></a>
<div class="props_rev_3"><a id="GUID-2AEF86C4-3CFA-4CF5-AEF3-E25871298363"></a>
<h2 id="DGBKR-GUID-2AEF86C4-3CFA-4CF5-AEF3-E25871298363" class="sect2"><span class="enumeration_section">5.2</span> Choosing a Target Standby Database</h2>
<div>
<p>There are many factors to take into consideration when <a id="d12131e149" class="indexterm-anchor"></a><a id="d12131e153" class="indexterm-anchor"></a><a id="d12131e157" class="indexterm-anchor"></a><a id="d12131e161" class="indexterm-anchor"></a>selecting a standby database to be the next primary database after a switchover or a failover. You need to consider all of the options at the time you are building your Oracle Data Guard configuration, including factors such as the characteristics of physical standbys versus logical standbys versus snapshot standbys, the network latency to your standby database sites, the computing capabilities at a future primary database site, and so on.</p>
<div class="infobox-note" id="GUID-2AEF86C4-3CFA-4CF5-AEF3-E25871298363__GUID-B59A8AAF-681E-44D6-A0D8-2FA4439D2590">
<p class="notep1">Note:</p>
<p>A snapshot standby cannot be the target of a switchover or fast-start failover operation. You can, however, perform a manual failover to a snapshot standby.</p>
<p>A far sync instance is not a database and therefore cannot be the target of a role transition.</p>
</div>
<p>For switchovers, understanding all of the factors can simplify the choice of which standby database to consider as your new primary database. In disaster situations where a failover is necessary, you may be more limited as to which standby database is the best one to pick up the failed primary database&#39;s activities. <a href="sofo.htm#GUID-A3140CC4-EFFF-465E-86FB-D68B15BF130E">Choosing a Target Standby Database for Switchover</a> and <a href="sofo.htm#GUID-0AC8540A-6BB6-4B80-8D55-A3D72AD02486">Choosing a Target Standby Database for Failover</a> provide guidelines to help you choose a target standby database.</p>
<div class="infobox-note" id="GUID-2AEF86C4-3CFA-4CF5-AEF3-E25871298363__GUID-B606AF13-1777-4BD5-8222-24298EBBD6F0">
<p class="notep1">Note:</p>
<p>For fast-start failover, you must pre-select the target standby database that will be used. <a href="sofo.htm#GUID-995CED84-BEA1-4675-9C68-B37CB996924F">Fast-Start Failover</a> provides more information about fast-start failover.</p>
</div>
<div class="section">
<p class="subhead2">Determining a Database&#39;s Readiness to Change Roles</p>
</div>
<!-- class="section" -->
<div class="section">
<p>To help you select an appropriate switchover or failover target, use the DGMGRL <code class="codeph">VALIDATE</code> <code class="codeph">DATABASE</code> command. This commands performs an exhaustive set of checks on the database to determine whether it is ready to complete a role change.</p>
<div class="infoboxnotealso" id="GUID-2AEF86C4-3CFA-4CF5-AEF3-E25871298363__GUID-23266E9A-13AA-4521-BA39-3FF522BB8FEB">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">&#34;<a href="dgmgrl.htm#GUID-06ED8F7F-4547-4D4D-9D1A-4A84FF234A12">VALIDATE DATABASE</a>&#34;</span></p>
</li>
<li>
<p><span class="q">&#34;<a href="cli.htm#GUID-1403D1C3-8944-42D0-8BDA-21D695C7958A">Scenario 9: Performing a Switchover Operation</a>&#34;</span> for an example of using the <code class="codeph">VALIDATE DATABASE</code> command to show a database&#39;s readiness to complete a role switchover</p>
</li>
<li>
<p><span class="q">&#34;<a href="cli.htm#GUID-630F5987-328C-410C-AE3B-A9D66EB233D4">Scenario 10: Performing a Manual Failover Operation</a>&#34;</span> for an example of using the <code class="codeph">VALIDATE DATABASE</code> command to show a database&#39;s readiness to complete a role failover</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
<a id="DGBKR3402"></a>
<div class="props_rev_3"><a id="GUID-A3140CC4-EFFF-465E-86FB-D68B15BF130E"></a>
<h3 id="DGBKR-GUID-A3140CC4-EFFF-465E-86FB-D68B15BF130E" class="sect3"><span class="enumeration_section">5.2.1</span> Choosing a Target Standby Database for Switchover</h3>
<div>
<p>When performing a switchover in a configuration whose standby databases are all of the same type (all physical or all logical standby databases), choose the standby database that has the least amount of unapplied redo. By choosing the standby database with the least amount of unapplied redo, you can minimize the overall time it takes to complete the switchover operation. For example:</p>
<ul style="list-style-type: disc;">
<li>
<p>Using DGMGRL, you can do this by examining the Apply Lag row of the <code class="codeph">SHOW DATABASE</code> output for each standby database in the configuration.</p>
</li>
<li>
<p>Using Cloud Control, you can view the value of the <code class="codeph">ApplyLag</code> column for each standby database in the <code class="codeph">Standby</code> <code class="codeph">Databases</code> section of the Oracle Data Guard Overview page.</p>
</li>
</ul>
<p>If the configuration contains both physical and logical standby databases, consider choosing a physical standby database (that has the least amount of unapplied redo) to be the target standby database. A switchover to a physical standby database is preferable because all databases in the configuration will be available as standby databases to the new primary database after the switchover operation completes. Whereas a switchover to a logical standby database will invalidate and disable all of the physical and snapshot standby databases in the configuration. You will then need to re-create the physical standby databases from a copy of the new primary database before you can reenable them.</p>
<p>You cannot perform a switchover to a snapshot standby database unless you first convert it back to a physical standby database.</p>
<div class="infobox-note" id="GUID-A3140CC4-EFFF-465E-86FB-D68B15BF130E__GUID-C58A0859-AAD8-4383-B951-72CF68AE4CEE">
<p class="notep1">Note:</p>
<p>If the Oracle Data Guard configuration is operating in maximum protection mode, the broker does not allow a switchover to occur to a logical standby database. The configuration must be operating in either maximum availability mode or maximum performance mode in order to be able to switch over to a logical standby database.</p>
</div>
</div>
</div>
<a id="DGBKR3403"></a>
<div class="props_rev_3"><a id="GUID-0AC8540A-6BB6-4B80-8D55-A3D72AD02486"></a>
<h3 id="DGBKR-GUID-0AC8540A-6BB6-4B80-8D55-A3D72AD02486" class="sect3"><span class="enumeration_section">5.2.2</span> Choosing a Target Standby Database for Failover</h3>
<div>
<p>When performing a failover in a configuration whose standbys are all of the same type, choose the standby database that has the smallest transport lag. Doing so can minimize the amount of data loss and in some cases, incur no data loss at all.</p>
<p>If the configuration contains physical, snapshot, and logical standby databases, consider choosing a physical standby database as the target standby database. A failover to a physical standby database is preferable because it is likely that all standby databases in the configuration will still be available as standby databases to the new primary database after the failover operation completes.</p>
<p>You may failover to a snapshot standby database. However failing over to a snapshot standby database will require more time because the broker must first convert it back to a physical standby database. After the conversion, the broker will start Redo Apply to apply accumulated redo data, before failing the database over to the primary role. Because the broker performs the failover after converting the snapshot standby database to a physical standby database, it is likely that all standby databases in the configuration will still be available as standby databases to the new primary database after the failover operation completes.</p>
<p>A failover to a logical standby database requires that all physical and snapshot standby databases be re-created from a copy of the new primary database after the failover completes. In addition, a logical standby database may contain only a subset of the data present in the primary database. (For example, if the <code class="codeph">DBMS_LOGSTDBY.SKIP</code> procedure was used to specify which database operations done on the primary database will not be applied to the logical standby database.)</p>
<p>However, there may be exceptions to the recommendation to choose a physical standby database as the target standby database. For example, if all your physical standbys are also unavailable, then failing over to a logical standby is your only choice.</p>
</div>
</div>
</div>
<a id="DGBKR335"></a>
<div class="props_rev_3"><a id="GUID-AC6A6D2B-1112-422B-8A41-02FAC40E2078"></a>
<h2 id="DGBKR-GUID-AC6A6D2B-1112-422B-8A41-02FAC40E2078" class="sect2"><span class="enumeration_section">5.3</span> Switchover</h2>
<div>
<p>Y<a id="d12131e341" class="indexterm-anchor"></a><a id="d12131e345" class="indexterm-anchor"></a><a id="d12131e349" class="indexterm-anchor"></a><a id="d12131e355" class="indexterm-anchor"></a>ou can switch a database from the primary role to the standby role, as well as from standby to primary. This is known as a database switchover, because the standby database that you specify becomes the primary database, and the original primary database becomes a standby database, with no loss of data.</p>
<p>Whenever possible, you should switch over to a physical standby database:</p>
<ul style="list-style-type: disc;">
<li>
<p>If the <a id="d12131e368" class="indexterm-anchor"></a><a id="d12131e374" class="indexterm-anchor"></a>switchover transitions a physical standby database to the primary role, then:</p>
<ul style="list-style-type: disc;">
<li>
<p>The original primary database will be switched to a physical standby role.</p>
</li>
<li>
<p>Bystander standbys will receive redo from the new primary database.</p>
</li>
<li>
<p>The original primary database will be restarted as a part of the switchover operation. Note that the new primary database does not need to be restarted.</p>
<p>Standby databases not involved in the switchover (known as bystander standby databases)<a id="d12131e391" class="indexterm-anchor"></a> continue operating in the state they were in before the switchover occurred and will automatically begin applying redo data received from the new primary database.</p>
</li>
</ul>
</li>
<li>
<p>If the <a id="d12131e397" class="indexterm-anchor"></a><a id="d12131e403" class="indexterm-anchor"></a>switchover transitions a logical standby database to the primary role, then:</p>
<ul style="list-style-type: disc;">
<li>
<p>The original primary database will be switched to a logical standby role.</p>
</li>
<li>
<p>Neither the primary database nor the logical standby database needs to be restarted after the switchover completes.</p>
<p>Other logical standby bystander databases in the broker configuration will remain viable after the switchover. There is no need to restart any databases. All physical and snapshot standby databases will be disabled and must be re-created from a copy of the new primary database after a switchover to a logical standby database.</p>
</li>
</ul>
<p>Switchover to a logical standby database is disallowed when the configuration is operating in maximum protection mode.</p>
<div class="infoboxnotewarn" id="GUID-AC6A6D2B-1112-422B-8A41-02FAC40E2078__GUID-7838909A-983C-4134-9B67-5DFB6ECAABDF">
<p class="notep1">WARNING:</p>
<p>Switching over to a logical standby database results in the snapshot and physical standby databases in the broker configuration being disabled by the broker, making these databases no longer viable as standby databases. <a href="sofo.htm#GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D">Reenabling Disabled Databases After a Role Change</a> describes how to restore their viability as standby databases.</p>
<p>If you intend to switch back to the original primary database relatively soon, you may allow the physical and snapshot standbys to remain disabled. Once you have completed the switchover back to the original primary, you may then reenable the physical and snapshot standby databases since they are still viable standbys for the original primary database.</p>
</div>
</li>
</ul>
</div>
<a id="DGBKR340"></a>
<div class="props_rev_3"><a id="GUID-F910D713-A55D-4F5B-8744-BF7C98E2843C"></a>
<h3 id="DGBKR-GUID-F910D713-A55D-4F5B-8744-BF7C98E2843C" class="sect3"><span class="enumeration_section">5.3.1</span> Before You Perform a Switchover Operation</h3>
<div>
<p>Consider the following points before you begin a switchover:</p>
<ul style="list-style-type: disc;">
<li>
<p>When you start a switchover, the broker verifies that at least one standby database, including the primary database that is about to be transitioned to the standby role, is configured to support the overall protection mode (maximum protection, maximum availability, or maximum performance) after the switchover is completed.</p>
</li>
<li>
<p><a id="d12131e468" class="indexterm-anchor"></a><a id="d12131e472" class="indexterm-anchor"></a>Prepare the primary database in advance for its possible future role as a standby database in the context of the overall protection mode (see <a href="dbresource.htm#GUID-994BE350-859F-41DC-A1D3-B6E8D5EEF2C8">Managing Data Protection Modes</a>). Such preparation includes:</p>
<ul style="list-style-type: disc;">
<li>
<p>Ensuring that standby redo log files are configured on the primary database.</p>
</li>
<li>
<p>Presetting database properties related to redo transport services, such as <code class="codeph">LogXptMode</code>, <code class="codeph">NetTimeout</code>, <code class="codeph">StandbyArchiveLocation</code>, <code class="codeph">AlternateLocation</code>, and <code class="codeph">RedoRoutes</code>. For more details about managing redo transport services using database properties, see <a href="dbresource.htm#GUID-6DC53E53-63F3-42D7-865E-C7689AEBD44A">Managing Redo Transport Services</a>.</p>
</li>
<li>
<p>Reset database properties related to Redo Apply services, such as <code class="codeph">DelayMins</code>. Any apply delay must be removed before beginning a switchover. Not removing the delay will result in a longer switchover time, and in a future release will cause the switchover to be disallowed. For more details about managing Redo Apply services using properties, see <a href="dbresource.htm#GUID-6753936C-E2E3-471E-BCC5-0C4697AD4255">Managing Log Apply Services</a>.</p>
</li>
<li>
<p>For each temporary table, verifying that temporary files associated with that table on the primary database also exist on the standby database.</p>
</li>
</ul>
<p>Note that the broker does not use the properties to set up redo transport services and Redo Apply services until you actually switch over the primary database to the standby role. Thus, the validity of the values of these properties is not verified until after the switchover. Once you set these properties, their values persist through role changes during switchover and failover.</p>
</li>
<li>
<p>Before performing a switchover to a physical standby database that is in real-time query mode, consider bringing all instances of that standby database to the mounted but not open state to achieve the fastest possible role transition and to cleanly terminate any user sessions connected to the physical standby database prior to the role transition.</p>
</li>
<li>
<p>If fast-start failover is enabled, then a switchover can be performed only to the pre-specified target standby database and only if the standby database is synchronized with the primary database or is within the configured lag limit, for the max availability and max performance modes respectively. For information about enabling fast-start failover, see <a href="sofo.htm#GUID-D26D79F2-0093-4C0E-98CD-224A5C8CBFA4">Enabling Fast-Start Failover</a>.</p>
</li>
</ul>
<p>After a switchover completes, the broker preserves the overall Oracle Data Guard protection mode as part of the switchover process by keeping the protection mode at the same protection level (maximum protection, maximum availability, or maximum performance) it was at before the switchover. Apply services on all other bystander standby databases automatically begin applying redo data received from the new primary database.</p>
<p>If there are physical or snapshot standby databases in the configuration and the switchover occurs to a logical standby database, you need to re-create those databases from a copy of the new primary database and then reenable those databases, as described in <a href="sofo.htm#GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D">Reenabling Disabled Databases After a Role Change</a>.</p>
<div class="infobox-note" id="GUID-F910D713-A55D-4F5B-8744-BF7C98E2843C__GUID-D2E84FB3-E703-4077-B5A8-25937D0DD3C0">
<p class="notep1">Note:</p>
<p>In an Oracle Data Guard configuration, the SRVCTL <code class="codeph">-startoption</code> for a standby database is always set to <code class="codeph">OPEN</code> after a switchover. See <span class="q">&#34;<a href="sofo.htm#GUID-05918DD1-FB0F-435B-873B-A43BEC1C7638">Database Service Configuration Requirements</a>&#34;</span> for additional information about how the broker interacts with Oracle Restart.</p>
</div>
</div>
</div>
<a id="DGBKR3404"></a>
<div class="props_rev_3"><a id="GUID-B31291C3-818E-45E6-8461-3804B1D4BF39"></a>
<h3 id="DGBKR-GUID-B31291C3-818E-45E6-8461-3804B1D4BF39" class="sect3"><span class="enumeration_section">5.3.2</span> Starting a Switchover</h3>
<div>
<div class="section">
<p>The act of switching roles should be a well-planned activity. The primary and standby databases involved in the switchover should have as small a redo lag as possible. <a class="olink SBYDB00600" target="_blank" href="../SBYDB/role_management.htm#SBYDB00600"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> provides information about setting up the databases in preparation of a switchover.</p>
<p>To start a switchover using Cloud Control, select the standby database that you want to change to the primary role and click <span class="bold">Switchover</span>. When using DGMGRL, you need to issue only one <code class="codeph">SWITCHOVER</code> command to specify the name of the standby database that you want to change into the primary role.</p>
<p>The broker controls the rest of the switchover, as described in <a href="sofo.htm#GUID-7A7E5C06-C98F-4517-AA85-3211386280DA">How the Broker Performs a Switchover</a>.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR350"></a>
<div class="props_rev_3"><a id="GUID-7A7E5C06-C98F-4517-AA85-3211386280DA"></a>
<h3 id="DGBKR-GUID-7A7E5C06-C98F-4517-AA85-3211386280DA" class="sect3"><span class="enumeration_section">5.3.3</span> How the Broker Performs a Switchover</h3>
<div>
<p>Once you start the switchover, the broker:</p>
<ol>
<li>
<p>Verifies that the primary and the target standby databases are in the following states:</p>
<ol>
<li>
<p>The primary database is enabled and is in the <code class="codeph">TRANSPORT-ON</code> state.</p>
</li>
<li>
<p>The target standby database is enabled and is in the <code class="codeph">APPLY-ON</code> state.</p>
</li>
</ol>
<p>The broker allows the switchover to proceed as long as there are no errors for the primary database and the standby database that you selected to participate in the switchover operation. Errors occurring for any other bystander standby databases will not impede the switchover.</p>
</li>
<li>
<p>Shuts down all instances except one, if required.</p>
<p>If you are switching over to a physical standby database, the broker shuts down all but one instance on the current primary database. No instances will be shut down on the target physical standby database.</p>
<p>No instances will be shut down if switching over to a logical standby database. You cannot switch over to a snapshot standby database.</p>
</li>
<li>
<p>Switches roles between the p<a id="d12131e665" class="indexterm-anchor"></a><a id="d12131e669" class="indexterm-anchor"></a>rimary and standby databases.</p>
<p>The broker first converts the original primary database to run in the standby role. Then, the broker transitions the target standby database to the primary role. If any errors occur during either conversion, the broker stops the switchover. See <a href="troubleshooting.htm#GUID-E417A951-84C5-4693-9136-8480FB8B1876">Troubleshooting Problems During a Switchover Operation</a> for more information.</p>
</li>
<li>
<p>Updates the broker configuration file to record the change in roles.</p>
<p>This ensures that each database will run in the correct role and state should it be restarted later for any reason.</p>
</li>
<li>
<p>Restarts the new standby (former primary) database if the switchover occurs to a physical standby database, and Redo Apply begins applying redo data from the new primary database. If this is an Oracle RAC physical standby database, the broker directs Oracle Clusterware to restart the instances that were shut down prior to the switchover. In a configuration operating in maximum protection mode, the new primary database will also be restarted.</p>
</li>
<li>
<p>The new primary database is opened in read/write mode and redo transport services are started.</p>
<p>If the former physical standby database was running with real-time query enabled, the new physical standby database will run with real-time query enabled.</p>
</li>
</ol>
<p>The broker verifies the state and status of the databases to ensure that the switchover transitioned the databases to their new role correctly. Bystander s<a id="d12131e697" class="indexterm-anchor"></a><a id="d12131e703" class="indexterm-anchor"></a>tandby databases that are not disabled by the broker after the switchover will continue operating in the state they were in before the switchover. <a id="d12131e708" class="indexterm-anchor"></a><a id="d12131e710" class="indexterm-anchor"></a>Redo Apply and <a id="d12131e713" class="indexterm-anchor"></a>SQL Apply on all other bystander standby databases automatically begin applying redo data received from the new primary database.</p>
<p>In the rare event that a switchover operation fails and you are left with no primary database, retry the switchover command. You can switch back to the original primary and then either retry the switchover to the original target standby, or choose another standby in the configuration to switch over to.</p>
</div>
</div>
</div>
<a id="DGBKR360"></a>
<div class="props_rev_3"><a id="GUID-9A988501-7E18-4A62-8CD6-4BDDFA355C98"></a>
<h2 id="DGBKR-GUID-9A988501-7E18-4A62-8CD6-4BDDFA355C98" class="sect2"><span class="enumeration_section">5.4</span> Manual Failover</h2>
<div>
<p>You can convert a standby database to a primary database when the original primary database fails and there is no possibility of recovering the primary database in a timely manner. This is known as a <strong class="term">manual failover</strong>. There may or may not be data loss depending upon whether your primary and target standby databases were synchronized at the time of the primary database failure. The word <span class="italic">manual</span> is used to contrast this type of failover with a fast-start failover (described in <a href="sofo.htm#GUID-995CED84-BEA1-4675-9C68-B37CB996924F">Fast-Start Failover</a>).</p>
<div class="infobox-note" id="GUID-9A988501-7E18-4A62-8CD6-4BDDFA355C98__GUID-A04710D2-38EC-4CC2-8074-406D1E123E0E">
<p class="notep1">Note:</p>
<p>You can perform a manual failover even if fast-start failover is enabled. See <a href="sofo.htm#GUID-0A81C376-FB77-4EB5-AF59-BD872A875FAE">Performing Manual Role Changes When Fast-Start Failover Is Enabled</a> for more information.</p>
</div>
<p>The following sections describe how to perform manual failovers:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="sofo.htm#GUID-F2E287D9-48A9-4B56-9140-08B3A54185ED">Complete and Immediate Manual Failovers</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-89BF9FC5-1E3F-4C0B-90CB-AF4B39B5245E">Performing a Manual Failover Operation</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D">Reenabling Disabled Databases After a Role Change</a></p>
</li>
</ul>
</div>
<a id="DGBKR3405"></a>
<div class="props_rev_3"><a id="GUID-F2E287D9-48A9-4B56-9140-08B3A54185ED"></a>
<h3 id="DGBKR-GUID-F2E287D9-48A9-4B56-9140-08B3A54185ED" class="sect3"><span class="enumeration_section">5.4.1</span> Complete and Immediate Manual Failovers</h3>
<div>
<p>Using Cloud Control or DGMGRL, you can perform either a <span class="italic">complete</span> (recommended) or an <span class="italic">immediate</span> failover:</p>
<ul style="list-style-type: disc;">
<li>
<p>A <a id="d12131e853" class="indexterm-anchor"></a><a id="d12131e855" class="indexterm-anchor"></a><a id="d12131e859" class="indexterm-anchor"></a><span class="italic">complete</span> failover is the recommended and default failover option. It automatically recovers the maximum amount of redo data for the protection mode the configuration is operating in. A complete failover also attempts to avoid disabling any standby databases that were not the target of the failover, so that they may continue serving as standby databases to the new primary database.</p>
<p>Whether or not standby databases that were not the target of failover (bystander standby databases) are disabled depends upon how much redo data they have applied relative to the failover target and the standby type of the failover target:</p>
<ul style="list-style-type: disc;">
<li>
<p>If the failover target is a physical or snapshot standby database, the original primary database must be reinstated or re-created in order to be a standby database for the new primary database. In addition, some standby databases may be disabled by the broker during the failover if the broker detects that they have applied redo beyond where the new primary database had applied. Any standby database that was disabled by the broker must be reinstated or re-created, as described in <a href="sofo.htm#GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D">Reenabling Disabled Databases After a Role Change</a>, before it can be a standby database for the new primary database.</p>
<p>Note that if failover was performed on a snapshot standby database, the old primary must be either reinstated or re-created as a physical standby database.</p>
</li>
<li>
<p>If the failover target is a logical standby database, the original primary database and all physical and snapshot standby databases in the configuration will be disabled. The primary database can be reinstated if it had flashback database enabled. The physical and snapshot standby databases will have to be re-created from a copy of the new primary database. See <a href="sofo.htm#GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D">Reenabling Disabled Databases After a Role Change</a> for more information.</p>
</li>
</ul>
<p>If the primary database can be mounted, it may be possible to flush any unsent redo data from the primary database to the target standby database using the <code class="codeph">ALTER SYSTEM FLUSH REDO</code> SQL statement. If this operation is successful, a zero data loss failover may be possible even if the primary database is not in a zero data loss protection mode. See <a class="olink SBYDB5171" target="_blank" href="../SBYDB/role_management.htm#SBYDB5171"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> for more information on using the <code class="codeph">ALTER SYSTEM FLUSH REDO</code> statement.</p>
<p>During a complete failover, the broker performs the failover steps described in <a href="sofo.htm#GUID-2CB6E14E-C211-420C-8757-0BCFB1BE9F95">How the Broker Performs a Complete Failover Operation</a>.</p>
</li>
<li>
<p>An <span class="italic">immediate</span> failover is the fastest type of failover. However, no additional data is applied on the standby database once you invoke the failover. Another consequence of immediate failover is that all other databases in the configuration are disabled and must be reinstated or re-created before they can serve as standby databases for the new primary database. <a href="sofo.htm#GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D">Reenabling Disabled Databases After a Role Change</a> describes how to do this. During an immediate failover, the broker performs the failover steps described in <a href="sofo.htm#GUID-1B89CB0D-6C5A-4D3E-8AC0-467D24F4E3B0">How the Broker Performs an Immediate Failover Operation</a>.</p>
<div class="infobox-note" id="GUID-F2E287D9-48A9-4B56-9140-08B3A54185ED__GUID-2D1FF377-B44B-4315-9B79-195D945BC082">
<p class="notep1">Note:</p>
<p>Always try to perform a complete failover first unless redo apply has stopped at the failover target due to an <code class="codeph">ORA-752</code> or <code class="codeph">ORA-600</code> <code class="codeph">[3020]</code> error. If one of these errors has occurred, follow the guidelines in &#34;Resolving ORA-752 or ORA-600 [3020] During Standby Recovery&#34; in My Oracle Support Note 1265884.1 before proceeding. This support note is available at <a href="http://support.oracle.com" target="_blank"><code class="codeph">http://support.oracle.com</code></a>.</p>
<p>An immediate failover should only be performed when a complete failover is unsuccessful or in the error cases just noted. A complete failover can occur without any data loss, depending on the destination attributes of redo transport services, but an immediate failover usually results in some data loss.</p>
</div>
</li>
</ul>
</div>
</div>
<a id="DGBKR370"></a>
<div class="props_rev_3"><a id="GUID-89BF9FC5-1E3F-4C0B-90CB-AF4B39B5245E"></a>
<h3 id="DGBKR-GUID-89BF9FC5-1E3F-4C0B-90CB-AF4B39B5245E" class="sect3"><span class="enumeration_section">5.4.2</span> Performing a Manual Failover Operation</h3>
<div>
<p>After determining that there is no possibility of recovering the primary database in a timely manner, ensure that the primary database is shut down and then begin the failover operation.</p>
<p>The steps in this section describe the tasks involved to perform a manual failover. Depending on the failover and the types of standby databases involved, some of the databases may need to be reinstated or re-created.</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="sofo.htm#GUID-B377087B-2369-4C1E-9A61-D1D058059C27">Performing a Manual Failover Task 1: Determine Which of the Available Standby Databases is the Best Target for the Failover</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-C37C8655-9A78-4857-B302-A015CE54B48C">Performing a Manual Failover Task 2: Start the Failover</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-0C37ACF2-4399-49B0-B9B4-982157FCDDED">Performing a Manual Failover Task 3: Reset the Protection Mode</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-FB1760EA-1393-4522-8F06-9B893F936FFC">Performing a Manual Failover Task 4: Re-establish a Disaster-Recovery Configuration</a></p>
</li>
</ul>
</div>
<div class="props_rev_3"><a id="GUID-B377087B-2369-4C1E-9A61-D1D058059C27"></a>
<h4 id="DGBKR-GUID-B377087B-2369-4C1E-9A61-D1D058059C27" class="sect4"><span class="enumeration_section">5.4.2.1</span> Performing a Manual Failover Task 1: Determine Which of the Available Standby Databases is the Best Target for the Failover</h4>
<div>
<div class="section">
<p>Follow the guidelines described in <a href="sofo.htm#GUID-2AEF86C4-3CFA-4CF5-AEF3-E25871298363">Choosing a Target Standby Database</a>.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-C37C8655-9A78-4857-B302-A015CE54B48C"></a>
<h4 id="DGBKR-GUID-C37C8655-9A78-4857-B302-A015CE54B48C" class="sect4"><span class="enumeration_section">5.4.2.2</span> Performing a Manual Failover Task 2: Start the Failover</h4>
<div>
<div class="section">
<p>Using Cloud Control or DGMGRL, perform either a <span class="italic">complete</span> (recommended) or an <span class="italic">immediate</span> failover.</p>
<p><span class="bold">Manual Failover Using Cloud Control:</span></p>
<p>On the Oracle Data Guard Overview page in Cloud Control, select the standby database that you want to change to the primary role and click <span class="bold">Failover</span>. Then, on the Failover Confirmation page, click <span class="bold">Yes</span> to invoke the default Complete failover option.</p>
<p><span class="bold">Manual Failover Using DGMGRL:</span></p>
<p>Connect to the target standby database and issue the <code class="codeph">FAILOVER</code> command to perform a failover, specifying the name of the standby database that you want to become the primary database:</p>
<pre dir="ltr">DGMGRL&gt; FAILOVER TO <span class="italic">database-name</span>;
</pre>
<p>Specify the optional <code class="codeph">IMMEDIATE</code> clause to perform an immediate failover if any of the following conditions are true:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>An <code class="codeph">ORA-752</code> error has occurred at the standby database</p>
</li>
<li>
<p>An <code class="codeph">ORA-600</code> <code class="codeph">[3020]</code> error has occurred at the standby database and Oracle support has determined that it was caused by a lost write at the primary database</p>
</li>
<li>
<p>A complete failover is not possible</p>
</li>
</ul>
<pre dir="ltr">DGMGRL&gt; FAILOVER TO database-name IMMEDIATE;
</pre>
<div class="infoboxnotealso" id="GUID-C37C8655-9A78-4857-B302-A015CE54B48C__GUID-B1EA2A74-73C7-483C-9300-CFBC7AA03148">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="dgmgrl.htm#GUID-F472B33F-FED1-49C6-A881-8FDA38A25627">FAILOVER</a></p>
</li>
</ul>
</div>
<p>If you are performing a complete failover, then all accumulated redo data is applied before the database role is changed to primary. If you are performing an immediate failover, then the database role is changed to primary without applying any accumulated redo data.</p>
<p>If the target is a snapshot standby database, the broker first converts the database to a physical standby database.</p>
<p>No instances will be shut down if failing over to a physical or logical standby database.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-0C37ACF2-4399-49B0-B9B4-982157FCDDED"></a>
<h4 id="DGBKR-GUID-0C37ACF2-4399-49B0-B9B4-982157FCDDED" class="sect4"><span class="enumeration_section">5.4.2.3</span> Performing a Manual Failover Task 3: Reset the Protection Mode</h4>
<div>
<div class="section">
<p>A<a id="d12131e1140" class="indexterm-anchor"></a>fter a <a id="d12131e1145" class="indexterm-anchor"></a><a id="d12131e1149" class="indexterm-anchor"></a>manual failover (complete or immediate), the overall Oracle Data Guard protection mode is handled as follows:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>If the protection mode was at maximum protection, it is reset to maximum performance. You can upgrade the protection mode later, if necessary, as described in <a href="dbresource.htm#GUID-A938EA13-B128-4D54-8A99-6871D93F01CE">Setting the Protection Mode for Your Configuration</a>.</p>
</li>
<li>
<p>If the protection mode was at maximum availability or maximum performance, it remains unchanged.</p>
</li>
</ul>
<div class="infobox-note" id="GUID-0C37ACF2-4399-49B0-B9B4-982157FCDDED__GUID-9886CA67-459B-45AA-B5E4-F079696F9F6F">
<p class="notep1">Note:</p>
<p>If you perform a manual failover when fast-start failover is enabled:</p>
<ul style="list-style-type: disc;">
<li>
<p>The failover can only be performed to the pre-selected target standby database.</p>
</li>
<li>
<p>The broker preserves the protection mode that was in effect prior to the failover.</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-FB1760EA-1393-4522-8F06-9B893F936FFC"></a>
<h4 id="DGBKR-GUID-FB1760EA-1393-4522-8F06-9B893F936FFC" class="sect4"><span class="enumeration_section">5.4.2.4</span> Performing a Manual Failover Task 4: Re-establish a Disaster-Recovery Configuration</h4>
<div>
<div class="section">
<p>To maintain a viable disaster-recovery solution in the event of another disaster, you may need to perform the additional steps described in <a href="sofo.htm#GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D">Reenabling Disabled Databases After a Role Change</a> to:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Reinstate the original primary database to act as a standby database in the new configuration.</p>
<div class="infobox-note" id="GUID-FB1760EA-1393-4522-8F06-9B893F936FFC__GUID-EB408EAD-2BCD-4546-9905-BDF0A3060C44">
<p class="notep1">Caution:</p>
<p>Do not attempt to reinstate the old primary database if an <code class="codeph">ORA-752</code> or <code class="codeph">ORA-600</code> <code class="codeph">[3020]</code> error has occurred at the failover target, because doing so may lead to data loss. Instead, the old primary database must be re-created as a standby from a backup of the new primary using the procedure described in <a href="sofo.htm#GUID-CA638065-9E57-420F-852B-D05065B6DE24">How to Re-create and Reenable a Disabled Database</a>.</p>
</div>
</li>
<li>
<p>Reinstate or re-create standby databases in the configuration that were disabled by the broker.</p>
<p>After a complete failover finishes, any bystander standby database that is not viable as a standby for the new primary database will be disabled by the broker. This can happen for either of the following reasons:</p>
<ul style="list-style-type: disc;">
<li>
<p>A bystander standby database has applied more redo data than the new primary database itself had applied when it was a standby database. The standby database must be re-created or reinstated before it can serve as a standby for the new primary database.</p>
</li>
<li>
<p>The failover was to a logical standby database. The broker disables all of the physical and snapshot standby databases in the configuration. They must be re-created before they can serve as standby to the new primary database.</p>
</li>
</ul>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR3856"></a><a id="DGBKR3857"></a><a id="DGBKR375"></a>
<div class="props_rev_3"><a id="GUID-2CB6E14E-C211-420C-8757-0BCFB1BE9F95"></a>
<h4 id="DGBKR-GUID-2CB6E14E-C211-420C-8757-0BCFB1BE9F95" class="sect4"><span class="enumeration_section">5.4.2.5</span> How the Broker Performs a Complete Failover Operation</h4>
<div>
<p>Once you start a complete failover, the broker:</p>
<ol>
<li>
<p>Verifies that the target standby database is enabled. If the database is not enabled, you will not be able to perform a failover to this database.</p>
</li>
<li>
<p>Waits for the target standby database to finish applying any unapplied redo data before stopping Redo Apply (if the target is a physical standby database) or SQL Apply (if the target is a logical standby database).</p>
<p>If the target is a snapshot standby database, the broker first converts the database back to a physical standby and then starts Redo Apply to apply all the accumulated redo before completing the failover and opening the database as a primary database.</p>
</li>
<li>
<p>Transitions the target standby database into the primary database role, as follows:</p>
<ol>
<li>
<p>Changes the role of the database from standby to primary.</p>
</li>
<li>
<p>Opens the new primary database in read/write mode.</p>
</li>
<li>
<p>Determines whether or not any standby databases that did not participate in the failover operation have applied redo data beyond the new primary database, and thus need to be disabled.</p>
<p>If a bystander standby database is not disabled by the broker during this failover, it will remain in the state it was in before the failover. For example, if a physical standby database was in the <code class="codeph">APPLY-OFF</code> state, it will remain in the <code class="codeph">APPLY-OFF</code> state.</p>
<p>By default, the broker always determines whether bystander standby databases will be viable standby databases for the new primary when performing a complete failover. If you want the broker to skip this viability check of bystander standby databases during a complete failover, thus decreasing the overall failover time, set the <code class="codeph">BystandersFollowRoleChange</code> configuration property to <code class="codeph">NONE</code>.</p>
<p>When this property is set to <code class="codeph">NONE</code>, the broker will disable all bystander standby databases without checking whether they have applied more redo data than the new primary database. You will have to reinstate or re-create (see <a href="sofo.htm#GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D">Reenabling Disabled Databases After a Role Change</a>) the standby databases after failover has completed. The <code class="codeph">SHOW CONFIGURATION</code> command will show you which databases can be reinstated and which databases must be re-created. Use the <code class="codeph">SHOW CONFIGURATION BystandersFollowRoleChange</code> command to see the value of this property. The default value is <code class="codeph">ALL</code>.</p>
<p>This property also affects whether the broker skips viability checks of bystander standby databases when a fast-start failover occurs.</p>
</li>
<li>
<p>Starts redo transport services to begin transmitting redo data to all bystander standby databases that were not disabled.</p>
<div class="infobox-note" id="GUID-2CB6E14E-C211-420C-8757-0BCFB1BE9F95__GUID-171DBC84-762D-40B6-860D-048067251E68">
<p class="notep1">Note:</p>
<p>Bystander standby databases<a id="d12131e1335" class="indexterm-anchor"></a> may be disabled by the broker during the failover, and they must be reinstated or re-created before they can serve as standby databases to the new primary database. Oracle recommends configuring <a id="d12131e1340" class="indexterm-anchor"></a><a id="d12131e1344" class="indexterm-anchor"></a><a id="d12131e1348" class="indexterm-anchor"></a>Flashback Database on every database so that if failover occurs to a physical standby database, you can more easily reinstate any disabled standby databases. If failover occurs to a logical standby database, all physical and snapshot standby databases will be disabled by the broker. In this case, Flashback Database cannot be used to reinstate databases. They must be re-created from a copy of the new primary database. Logical standby databases that are disabled during failover can be reinstated.</p>
</div>
</li>
</ol>
</li>
<li>
<p>If the failover target database is an Oracle RAC physical or snapshot standby database, the broker directs Oracle Clusterware to restart all instances that may have been shut down prior to the failover.</p>
</li>
</ol>
<p>The broker allows the failover to proceed as long as there are no errors for the standby database that you selected to participate in the failover. Errors occurring for any bystander standby databases will not stop the failover. If you initiated a complete failover and it fails, you might need to use immediate failover.</p>
<div class="section">
<p class="subhead3">Complete Failovers in Configurations Using Far Sync Instances</p>
</div>
<!-- class="section" -->
<div class="section">
<p>It is possible to manually perform a completer failover to a standby database that receives redo data from a far sync instance. To failover, connect to the standby database and use the DGMGRL <code class="codeph">FAILOVER</code> <code class="codeph">TO</code> <span class="italic"><code class="codeph">db-unique-name</code></span> command. Any unsent redo data residing on the far sync instance is transmitted to the target physical standby prior to converting the physical standby into a primary database.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Complete Failovers in Configurations Using Cascaded Standbys</p>
</div>
<!-- class="section" -->
<div class="section">
<p>In a complete failover, it is also possible to failover to a standby database (terminal standby) that gets redo from another standby database (cascader). In such a case, no attempt is made to transmit any unsent redo from the cascader to the terminal standby.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR3858"></a><a id="DGBKR3859"></a><a id="DGBKR380"></a>
<div class="props_rev_3"><a id="GUID-1B89CB0D-6C5A-4D3E-8AC0-467D24F4E3B0"></a>
<h4 id="DGBKR-GUID-1B89CB0D-6C5A-4D3E-8AC0-467D24F4E3B0" class="sect4"><span class="enumeration_section">5.4.2.6</span> How the Broker Performs an Immediate Failover Operation</h4>
<div>
<p>An immediate failover is started with the following DGMGRL command:</p>
<pre dir="ltr">DGMGRL&gt; FAILOVER TO <span class="italic">database-name</span> IMMEDIATE;
</pre>
<p>Once an immediate failover is started, the broker:</p>
<ol>
<li>
<p>Verifies that the target standby database is enabled. If the standby database is not enabled for management by the broker, then the failover cannot occur.</p>
</li>
<li>
<p>Stops Redo Apply or SQL Apply on the standby database immediately, without waiting until all available redo data has been applied. This may result in data loss.</p>
</li>
<li>
<p>Transitions the target standby database into the primary role, opens the new primary database in read/write mode, and starts redo transport services.</p>
<p>After an immediate failover completes, all the standby databases in the configuration, regardless of their type, are disabled. They may be reinstated if Flashback Database is enabled on those databases. Otherwise, they must be re-created from a copy of the new primary database.</p>
</li>
</ol>
<p>The broker allows a complete failover to proceed as long as there are no errors present on the standby database that you selected to participate in the failover.</p>
<p>The broker allows an immediate failover to proceed even if there are errors present on the standby database that you selected to participate in the failover.</p>
<div class="section">
<p class="subhead3">Immediate Failovers in Configurations Using Far Sync Instances</p>
</div>
<!-- class="section" -->
<div class="section">
<p>It is possible to manually perform an immediate failover to a standby database that receives redo data from a far sync instance. In this case, no attempt is made to transmit any unsent redo from the far sync instance to the target physical standby prior to converting the physical standby into a primary database.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Immediate Failovers in Configurations Using Cascaded Standbys</p>
</div>
<!-- class="section" -->
<div class="section">
<p>In an immediate failover, it is also possible to failover to a standby database (terminal standby) that gets redo from another standby database (cascader). In such a case, no attempt is made to transmit any unsent redo from the cascader to the terminal standby.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="DGBKR385"></a>
<div class="props_rev_3"><a id="GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D"></a>
<h3 id="DGBKR-GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D" class="sect3"><span class="enumeration_section">5.4.3</span> Reenabling Disabled Databases After a Role Change</h3>
<div>
<div class="section">
<p>To restore your original disaster-recovery solution after switchover to a logical standby database or after failover to any standby database, you may need to perform additional steps.</p>
<p>Databases that have been disabled after a role transition are not <span class="italic">removed</span> from the broker configuration, but they are no longer managed by the broker.</p>
<p>To reenable broker management of these databases, you must reinstate or re-create the databases using one of the following procedures:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>If a database can be reinstated, the database will show the following status:</p>
<pre dir="ltr">ORA-16661<a id="d12131e1494" class="indexterm-anchor"></a><a id="d12131e1498" class="indexterm-anchor"></a><a id="d12131e1502" class="indexterm-anchor"></a><a id="d12131e1506" class="indexterm-anchor"></a>: the standby database needs to be reinstated
</pre>
<p>Reinstate the database using the DGMGRL <code class="codeph">REINSTATE DATABASE</code> command or the reinstate option in Cloud Control, as described in <a href="sofo.htm#GUID-1899954F-C227-4BC4-A3C9-098A0282AEAC">How to Reinstate a Database</a>.<a id="d12131e1520" class="indexterm-anchor"></a><a id="d12131e1524" class="indexterm-anchor"></a><a id="d12131e1528" class="indexterm-anchor"></a> The broker automatically reenables the database as part of reinstating it.</p>
</li>
<li>
<p>If a database must be re-created from a copy of the new primary database, it will have the following status:</p>
<pre dir="ltr">ORA-16795<a id="d12131e1538" class="indexterm-anchor"></a><a id="d12131e1542" class="indexterm-anchor"></a><a id="d12131e1546" class="indexterm-anchor"></a>: the standby database needs to be re-created
</pre>
<p>Re-create the standby database from a copy of the primary database and then reenable it. The procedures for creating a standby database are documented in <a class="olink SBYDB00200" target="_blank" href="../SBYDB/create_ps.htm#SBYDB00200"><span class="italic">Oracle Data Guard Concepts and Administration</span></a>. See <a href="sofo.htm#GUID-CA638065-9E57-420F-852B-D05065B6DE24">How to Re-create and Reenable a Disabled Database</a> for more information.</p>
</li>
</ul>
<div class="infobox-note" id="GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D__GUID-40AA72DC-633D-437B-9350-5951B2BD2659">
<p class="notep1">Note:</p>
<p>Any database that was disabled while multiple role changes were performed cannot be reinstated. You must re-create the database manually from a copy of the current primary database and then reenable the database in the broker configuration.</p>
</div>
<p>Whether you reinstate or re-create a database depends on if you performed a switchover or failover and on the type of standby database that was the target of the operation. Note that role changes to logical and snapshot standby databases will always result in physical standby database bystanders being disabled. They cannot be reinstated. They must be re-created from a copy of the new primary database.</p>
<p>The following sections describe how to reinstate or reenable a database.</p>
</div>
<!-- class="section" --></div>
<a id="DGBKR3406"></a>
<div class="props_rev_3"><a id="GUID-1899954F-C227-4BC4-A3C9-098A0282AEAC"></a>
<h4 id="DGBKR-GUID-1899954F-C227-4BC4-A3C9-098A0282AEAC" class="sect4"><span class="enumeration_section">5.4.3.1</span> How to Reinstate a Database</h4>
<div>
<p>You can use the broker&#39;s reinstate capability to make the failed primary database a viable standby database for the new primary. This can be done regardless of whether the failover was done to a physical, logical, or snapshot standby database.</p>
<p>You can also reinstate bystander standby databases that were disabled during a failover operation.</p>
<p>Databases that can be reinstated will have the following status value:</p>
<pre dir="ltr"><a id="d12131e1610" class="indexterm-anchor"></a><a id="d12131e1614" class="indexterm-anchor"></a>ORA-16661: the standby database needs to be reinstated
</pre>
<p>For the <code class="codeph">REINSTATE</code> command to succeed, <a id="d12131e1624" class="indexterm-anchor"></a><a id="d12131e1628" class="indexterm-anchor"></a>Flashback Database must have been enabled on the database prior to the failover and there must be sufficient <a id="d12131e1633" class="indexterm-anchor"></a><a id="d12131e1637" class="indexterm-anchor"></a><a id="d12131e1641" class="indexterm-anchor"></a>flashback logs on that database. In addition, the database to be reinstated and the new primary database must have network connectivity.</p>
<p>To reinstate a database:</p>
<ol>
<li>
<p>Restart the database to the mounted state</p>
</li>
<li>
<p>Connect to the new primary database</p>
</li>
<li>
<p>Use Cloud Control or DGMGRL to reinstate the database</p>
</li>
</ol>
<p>The broker reinstates a failed primary database as a standby database of the same type (physical or logical standby database) as the old standby database. The only exception to this is failovers to snapshot standby databases. In such cases, the failed primary database is reinstated as a physical standby database.</p>
<p>The broker reinstates bystander standby databases that were disabled during a failover as standby databases to the new primary database.</p>
<p><span class="bold">Reinstatement Using Cloud Control</span><a id="d12131e1665" class="indexterm-anchor"></a></p>
<p>On the Oracle Data Guard Overview page, click <span class="bold">Database must be reinstated</span>. This brings up the General Properties page that provides a <span class="bold">Reinstate</span> button. After you click the <span class="bold">Reinstate</span> button, Cloud Control begins reinstating the database.</p>
<p>When the process is complete, the database will be enabled as a standby database to the new primary database, and Cloud Control displays the Oracle Data Guard Overview page.</p>
<p><span class="bold">Reinstatement Using DGMGRL</span></p>
<p>Issue the following command while connected to any database in the broker configuration, except the database that is to be reinstated:</p>
<pre dir="ltr">DGMGRL&gt; REINSTATE DATABASE <span class="italic">db_unique_name</span>;
</pre>
<p>The newly reinstated standby database will begin serving as a standby database to the new primary database. If reinstatement of a database fails, its status changes to <code class="codeph">ORA-16795: the standby database needs to be re-created</code>. You must then re-create it from a copy of the new primary database and reenable it as described in <a href="sofo.htm#GUID-CA638065-9E57-420F-852B-D05065B6DE24">How to Re-create and Reenable a Disabled Database</a>.</p>
</div>
</div>
<a id="DGBKR3407"></a>
<div class="props_rev_3"><a id="GUID-CA638065-9E57-420F-852B-D05065B6DE24"></a>
<h4 id="DGBKR-GUID-CA638065-9E57-420F-852B-D05065B6DE24" class="sect4"><span class="enumeration_section">5.4.3.2</span> How to Re-create and Reenable a Disabled Database</h4>
<div>
<div class="section">
<p>If you performed a failover or switchover that requires you to re-create the failed primary database or standby databases that were disabled during the role transition, then follow the procedures in the <a class="olink SBYDB00200" target="_blank" href="../SBYDB/create_ps.htm#SBYDB00200"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> chapter, &#34;Creating a Physical Standby Database&#34; and also the <a class="olink SBYDB00300" target="_blank" href="../SBYDB/create_ls.htm#SBYDB00300"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> chapter, &#34;Creating a Logical Standby Database.&#34;</p>
<p>Note that if you are re-creating the old primary database, it must be created as the standby type of the old standby database. For example, if the old standby was a physical or snapshot standby, then the old primary must be re-created as a physical standby.</p>
<p>After the database has been re-created, enable broker management of the re-created standby database by using the DGMGRL <code class="codeph">ENABLE DATABASE</code> command.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<a id="DGBKR3541"></a><a id="DGBKR390"></a>
<div class="props_rev_3"><a id="GUID-995CED84-BEA1-4675-9C68-B37CB996924F"></a>
<h2 id="DGBKR-GUID-995CED84-BEA1-4675-9C68-B37CB996924F" class="sect2"><span class="enumeration_section">5.5</span> Fast-Start Failover</h2>
<div>
<p><a id="d12131e1800" class="indexterm-anchor"></a><span class="bold">Fast-start failover</span> allows the broker to automatically fail over to a previously chosen standby database in the event of loss of the primary database. Fast-start failover quickly and reliably fails over the target standby database to the primary database role, without requiring you to perform any manual steps to invoke the failover. Fast-start failover can be used only in a broker configuration and can be configured only through DGMGRL or Cloud Control.</p>
<p>Either maximum availability mode or maximum performance mode can be used with fast-start failover. Maximum availability mode provides an automatic failover environment guaranteed to lose no data. Maximum performance mode provides an automatic failover environment guaranteed to lose no more than the amount of data (in seconds) specified by the <code class="codeph">FastStartFailoverLagLimit</code> configuration property. This property indicates the maximum amount of data loss that is permissible in order for an automatic failover to occur. It is only used when fast-start failover is enabled and the configuration is operating in maximum performance mode.</p>
<p>Once fast-start failover is enabled, the broker will ensure that fast-start failover is only possible when the configured data loss guarantee can be upheld. If the configured data loss guarantee cannot be upheld, redo generation on the primary database will be stalled. To avoid a prolonged stall, either the observer or target standby database may allow the primary database to continue redo generation after first recording that a fast-start failover cannot happen.</p>
<p>The broker restores the ability to automatically failover once the configured data loss guarantee can be satisfied. For a configuration that is operating in maximum availability mode, this occurs once the target standby database has received all missing redo data. For a configuration that is operating in maximum performance mode, this occurs once the target standby database&#39;s redo applied point is no longer lagging the primary database&#39;s redo generation point by more than the value specified by the <code class="codeph">FastStartFailoverLagLimit</code> configuration property.</p>
<p>Fast-start failover can be enabled in maximum availability mode when the fast-start failover target is a logical or physical standby database that receives redo data from a far sync instance. This lets you take advantage of the broker&#39;s automatic failover feature in configurations set up for zero data loss protection at any distance. (Fast-start failover cannot be enabled in maximum performance mode when the target standby receives redo from a far sync instance.) See <a href="cli.htm#GUID-09A3230B-A2A2-449D-89E0-EDDBD76A157C">Scenario 7: Enabling Fast-Start Failover When a Far Sync Instance Is In Use</a> for an example of how to set this up.</p>
<p>This section describes how to enable fast-start failover and an <strong class="term">observer</strong> site that monitors the fast-start failover environment. The observer is a separate OCI client-side component that runs on a different computer from the primary and standby databases and monitors the availability of the primary database. The observer is described in more detail in <a href="sofo.htm#GUID-5E2A8696-38B4-4782-B8EF-95C0975CD7C6">Managing the Observer</a>.</p>
<p>Once the observer is started, no further user interaction is required. If both the observer and designated standby database lose connectivity with the primary database for longer than the number of seconds specified by the <code class="codeph">FastStartFailoverThreshold</code> configuration property, the observer will initiate a fast-start failover to the standby database. In addition, the primary database will shut down if it perceives a loss of connectivity for a period longer than <code class="codeph">FastStartFailoverThreshold</code> seconds, if the <code class="codeph">FastStartFailoverPmyShutdown</code> configuration property is set to <code class="codeph">TRUE</code>. After the failover completes, the former primary database is automatically reinstated as a standby database when a connection to it is reestablished, if the <code class="codeph">FastStartFailoverAutoReinstate</code> configuration property is set to <code class="codeph">TRUE</code>.</p>
<div class="infobox-note" id="GUID-995CED84-BEA1-4675-9C68-B37CB996924F__GUID-0C36AC29-9EF1-4232-8C70-0902FD50F330">
<p class="notep1">Note:</p>
<p>When a fast-start failover occurs because either a user configurable fast-start failover condition is detected or an application initiates a fast-start failover by calling the <code class="codeph">DBMS_DG.INITIATE_FS_FAILOVER</code> function, the former primary database is always shut down and never automatically reinstated. This is true regardless of the settings for the <code class="codeph">FastStartFailoverPmyShutdown</code> and <code class="codeph">FastStartFailoverAutoReinstate</code> configuration properties. See <a href="sofo.htm#GUID-D26D79F2-0093-4C0E-98CD-224A5C8CBFA4">Enabling Fast-Start Failover</a> for more information.</p>
</div>
<p><a href="sofo.htm#GUID-995CED84-BEA1-4675-9C68-B37CB996924F__BCGIAIIF">Figure 5-1</a> shows the relationships between the primary database, target standby database, and the observer during fast-start failover:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Before Fast-Start Failover:</span> Oracle Data Guard is operating in a steady state, with the primary database transmitting redo data to the target standby database and the observer monitoring the state of the entire configuration.</p>
</li>
<li>
<p><span class="bold">FastStart Failover Ensues:</span> Disaster strikes the primary database and its network connections to both the observer and the target standby database are lost. Upon detecting the break in communication, the observer attempts to reestablish a connection with the primary database for the amount of time defined by the <code class="codeph">FastStartFailoverThreshold</code> property before initiating a fast-start failover. If the observer is unable to regain a connection to the primary database within the specified time, and the target standby database is ready for fast-start failover, then fast-start failover ensues.</p>
</li>
<li>
<p><span class="bold">After Fast-Start Failover:</span> The fast-start failover has completed and the target standby database is running in the primary database role. After the former primary database has been repaired, the observer reestablishes its connection to that database and reinstates it as a new standby database. The new primary database starts transmitting redo data to the new standby database.</p>
</li>
</ul>
<div class="figure" id="GUID-995CED84-BEA1-4675-9C68-B37CB996924F__BCGIAIIF">
<p class="titleinfigure">Figure 5-1 Relationship of Primary and Standby Databases and the Observer</p>
<img width="660" height="396" src="img/GUID-FD9F2709-BE2A-4313-872B-B7938E030A35-default.gif" alt="Description of Figure 5-1 follows" title="Description of Figure 5-1 follows"/><br/>
<a href="img_text/GUID-FD9F2709-BE2A-4313-872B-B7938E030A35-print.htm">Description of &#34;Figure 5-1 Relationship of Primary and Standby Databases and the Observer&#34;</a></div>
<!-- class="figure" -->
<p>The following sections describe these topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="sofo.htm#GUID-7EAF1865-2F92-4451-8565-D3C6EC4F8005">Prerequisites for Enabling Fast-Start Failover</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-D26D79F2-0093-4C0E-98CD-224A5C8CBFA4">Enabling Fast-Start Failover</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-47C45F0E-ABFA-40D7-83E8-5CCCEED524E5">Viewing Fast-Start Failover Configuration Statistics and Status</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-67878B37-39B5-402A-A219-69E7483405A1">Disabling Fast-Start Failover</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-D2166F5B-9347-46AB-B291-D008C7D95B3A">Performance Considerations for Fast-Start Failover</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-5E2A8696-38B4-4782-B8EF-95C0975CD7C6">Managing the Observer</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-319C443F-4386-49B1-A0FC-9C4166D061CA">Reinstating the Former Primary Database in the Broker Configuration</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-350624B9-ABAD-4894-89AE-7431D52D3818">Shutting Down Databases In a Fast-Start Failover Environment</a></p>
</li>
</ul>
</div>
<a id="DGBKR391"></a>
<div class="props_rev_3"><a id="GUID-7EAF1865-2F92-4451-8565-D3C6EC4F8005"></a>
<h3 id="DGBKR-GUID-7EAF1865-2F92-4451-8565-D3C6EC4F8005" class="sect3"><span class="enumeration_section">5.5.1</span> Prerequisites for Enabling Fast-Start Failover</h3>
<div>
<p>The following p<a id="d12131e1964" class="indexterm-anchor"></a><a id="d12131e1968" class="indexterm-anchor"></a><a id="d12131e1972" class="indexterm-anchor"></a>rerequisites must be met before the broker allows you to enable fast-start failover:</p>
<ul style="list-style-type: disc;">
<li>
<p>Ensure the broker configuration is operating in either m<a id="d12131e1981" class="indexterm-anchor"></a><a id="d12131e1985" class="indexterm-anchor"></a>aximum availability mode or maximum performance mode.</p>
<p>See <a href="dbresource.htm#GUID-A938EA13-B128-4D54-8A99-6871D93F01CE">Setting the Protection Mode for Your Configuration</a> for information about configuring the protection mode, standby redo logs, and the redo transport mode.</p>
</li>
<li>
<p>The selected standby database that will be the fast-start failover target must receive redo directly from the primary database or from a far sync instance.</p>
</li>
<li>
<p>Ensure that the standby database you choose to be the target of fast-start failover has its <code class="codeph">LogXptMode</code> property set to either <code class="codeph">SYNC</code> or <code class="codeph">FASTSYNC</code> if you wish to enable fast-start failover in maximum availability mode, or to <code class="codeph">ASYNC</code> if you wish to enable fast-start failover in maximum performance mode. The current primary database must have its <code class="codeph">LogXptMode</code> property set accordingly and must have standby redo logs configured. Alternatively, use the <code class="codeph">RedoRoutes</code> property to configure the redo transport mode for the target standby and the database currently in the primary role.</p>
</li>
<li>
<p>To use a far sync instance with fast-start failover, the far sync instance transport mode must be set to either <code class="codeph">SYNC</code> or <code class="codeph">FASTSYNC</code> and the target standby database transport mode must be set to <code class="codeph">ASYNC</code>.</p>
</li>
<li>
<p>Enable Flashback Database and set up a fast recovery area on both the primary database and the target standby database.</p>
<p>See <a class="olink BRADV8183" target="_blank" href="../BRADV/rcmconfb.htm#BRADV8183"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a>.</p>
</li>
<li>
<p>Install the DGMGRL command-line interface on the observer computer as described in <a href="install.htm#GUID-DBCAC77D-8B4D-4727-B89E-6CFA69302187">Oracle Data Guard Installation</a>.</p>
</li>
<li>
<p>Configure the <code class="codeph">TNSNAMES.ORA</code> file on the observer system so that the observer is able to connect to the primary database and to the pre-selected target standby database.</p>
</li>
<li>
<p>If you are not using Oracle Clusterware or Oracle Restart, then you must create static service names so that the observer can automatically restart a database as part of reinstatement. See <a href="install.htm#GUID-BFDA8675-DA97-4910-B3FF-5DD5CFF5CC6D">Prerequisites</a> for more information.</p>
</li>
</ul>
</div>
</div>
<a id="DGBKR392"></a>
<div class="props_rev_3"><a id="GUID-D26D79F2-0093-4C0E-98CD-224A5C8CBFA4"></a>
<h3 id="DGBKR-GUID-D26D79F2-0093-4C0E-98CD-224A5C8CBFA4" class="sect3"><span class="enumeration_section">5.5.2</span> Enabling Fast-Start Failover</h3>
<div>
<p>You can enable fast-start failover from any site while connected to any database in the broker configuration. Enabling fast-start failover does not trigger a failover. Instead, it allows the observer that is monitoring the configuration to initiate a fast-start failover should database conditions warrant a failover. (If there are other conditions, unique to an application, that would warrant a fast-start failover then the application can be set up to call the <code class="codeph">DBMS_DG.INITIATE_FS_FAILOVER</code> function and start a fast-start failover immediately should any of those conditions occur. See <a href="sofo.htm#GUID-C98DB3F7-2894-4855-9BBD-E3593E59383C">Directing a Fast-Start Failover From an Application</a>)</p>
<p>Enabling fast-start failover and starting the observer involves the following tasks. These tasks assume that you are connected as <code class="codeph">SYS</code> and that a primary and standby database are already set up in a broker configuration.</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="sofo.htm#GUID-559CC392-EE89-4C57-87F8-14BFDAEA896C">Enabling Fast-Start Failover Task 1: Determine Which of the Available Standby Databases is the Best Target for the Failover</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-ACD0E8F5-EA59-4823-8694-1538A8064C75">Enabling Fast-Start Failover Task 2: Specify the Target Standby Database with the FastStartFailoverTarget Configuration Property</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-94C97FD2-54E3-4DEE-8EF4-0631CE3A3C65">Enabling Fast-Start Failover Task 3: Determine the Protection Mode You Want</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-68161F2B-991E-47B6-8D52-9651248A8162">Enabling Fast-Start Failover Task 4: Set the FastStartFailoverThreshold Configuration Property</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-76F11A61-6A47-4DCA-BFF9-7CD800604290">Enabling Fast-Start Failover Task 5: Set Other Properties Related to Fast-Start Failover (Optional)</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-173419E6-3EDF-4580-B339-B687FE37AB56">Enabling Fast-Start Failover Task 6: Enable Additional Fast-Start Failover Conditions (Optional)</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-A9033D52-EB52-4C33-AB4A-4AEC4AC8C1B9">Enabling Fast-Start Failover Task 7: Using DGMGRL or Cloud Control</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-2D75365F-E3D1-4229-B55B-C58DA9EBFBE9">Enabling Fast-Start Failover Task 8: Start the Observer</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-BA6A87D4-26A1-4CAA-9B71-E91728B21355">Enabling Fast-Start Failover Task 9: Verify the Fast-Start Failover Environment</a></p>
</li>
</ul>
</div>
<div class="props_rev_3"><a id="GUID-559CC392-EE89-4C57-87F8-14BFDAEA896C"></a>
<h4 id="DGBKR-GUID-559CC392-EE89-4C57-87F8-14BFDAEA896C" class="sect4"><span class="enumeration_section">5.5.2.1</span> Enabling Fast-Start Failover Task 1: Determine Which of the Available Standby Databases is the Best Target for the Failover</h4>
<div>
<div class="section">
<p>Follow the guidelines described in <a href="sofo.htm#GUID-2AEF86C4-3CFA-4CF5-AEF3-E25871298363">Choosing a Target Standby Database</a>.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-ACD0E8F5-EA59-4823-8694-1538A8064C75"></a>
<h4 id="DGBKR-GUID-ACD0E8F5-EA59-4823-8694-1538A8064C75" class="sect4"><span class="enumeration_section">5.5.2.2</span> Enabling Fast-Start Failover Task 2: Specify the Target Standby Database with the FastStartFailoverTarget Configuration Property</h4>
<div>
<div class="section">
<p>You can specify only one target standby database when setting the <code class="codeph">FastStartFailoverTarget</code> configuration property on the current primary database:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>If there is only one standby database in the configuration, you can skip this step and continue with Step 3. When enabling fast-start failover, the broker automatically sets the <code class="codeph">FastStartFailoverTarget</code> property on the primary and standby databases to point to each other as their respective target during a failover.</p>
</li>
<li>
<p>If there is more than one standby database in the configuration, you must explicitly set the <code class="codeph">FastStartFailoverTarget</code> property on the primary database to select a target standby database. When enabling fast-start failover, the broker verifies that the property indicates an existing standby, and then reciprocally sets the standby database&#39;s <code class="codeph">FastStartFailoverTarget</code> property to the primary database. (Note that the target standby cannot be a far-sync standby. However the target can receive redo from a far sync instance.)</p>
<div class="infobox-note" id="GUID-ACD0E8F5-EA59-4823-8694-1538A8064C75__GUID-63B8586B-CBCC-4F47-BFF9-9DE942AE6C00">
<p class="notep1">Note:</p>
<p>To change the <code class="codeph">FastStartFailoverTarget</code> property to point to a different standby database, disable fast-start failover, set the <code class="codeph">FastStartFailoverTarget</code> property, and reenable fast-start failover.</p>
</div>
</li>
</ul>
<p>See <a href="dbpropref.htm#GUID-63108DF8-4DAD-40F1-88B1-458C3FCB6C84">FastStartFailoverTarget</a> for more information about this property.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-94C97FD2-54E3-4DEE-8EF4-0631CE3A3C65"></a>
<h4 id="DGBKR-GUID-94C97FD2-54E3-4DEE-8EF4-0631CE3A3C65" class="sect4"><span class="enumeration_section">5.5.2.3</span> Enabling Fast-Start Failover Task 3: Determine the Protection Mode You Want</h4>
<div>
<div class="section">
<p>Fast-start failover can be enabled for either maximum availability mode or maximum performance mode. If you cannot tolerate any loss of data, then ensure that the configuration protection mode is set to maximum availability. To do this, set the <code class="codeph">LogXptMode</code> database property for both the primary and target standby databases to <code class="codeph">SYNC</code> or <code class="codeph">FASTSYNC</code>. For example:</p>
<pre dir="ltr">DGMGRL&gt; EDIT DATABASE &#39;North_Sales&#39; SET PROPERTY LogXptMode=SYNC;
DGMGRL&gt; EDIT DATABASE &#39;South_Sales&#39; SET PROPERTY LogXptMode=SYNC;
DGMGRL&gt; EDIT CONFIGURATION SET PROTECTION MODE AS MaxAvailability;
</pre>
<p>Alternatively, use the <code class="codeph">RedoRoutes</code> property to set the redo transport mode for the target standby and database that is currently in the primary role. Then set the configuration protection mode to maximum availability.</p>
<p>If you are more concerned about the performance of the primary database than a minimal loss of data, consider enabling fast-start failover when the configuration protection mode is set to maximum performance. In this mode you will need to consider how much data loss is acceptable in terms of seconds and set the <code class="codeph">FastStartFailoverLagLimit</code> configuration property accordingly. This property specifies the amount of data, in seconds, that the target standby database can lag behind the primary database in terms of redo applied. If the standby database&#39;s redo applied point is within that many seconds of the primary database&#39;s redo generation point, a fast-start failover will be allowed. The <code class="codeph">FastStartFailoverLagLimit</code> configuration property is only used by the broker when enabling fast-start failover for configurations operating in maximum performance mode. The default value is 30 seconds and the lowest possible value is 10 seconds.</p>
<p>In addition to setting the configuration protection mode to maximum performance, you will also need to ensure that the <code class="codeph">LogXptMode</code> database property for both the primary and target standby database is set to <code class="codeph">ASYNC</code>. For example:</p>
<pre dir="ltr">DGMGRL&gt; EDIT DATABASE &#39;North_Sales&#39; SET PROPERTY LogXptMode=ASYNC;
DGMGRL&gt; EDIT DATABASE &#39;South_Sales&#39; SET PROPERTY LogXptMode=ASYNC;
DGMGRL&gt; EDIT CONFIGURATION SET PROTECTION MODE AS MaxPerformance;
DGMGRL&gt; EDIT CONFIGURATION SET PROPERTY FastStartFailoverLagLimit=45;
</pre>
<p>Alternatively, use the <code class="codeph">RedoRoutes</code> property to set the redo transport mode to <code class="codeph">ASYNC</code> for the target standby and the database currently in the primary role.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-68161F2B-991E-47B6-8D52-9651248A8162"></a>
<h4 id="DGBKR-GUID-68161F2B-991E-47B6-8D52-9651248A8162" class="sect4"><span class="enumeration_section">5.5.2.4</span> Enabling Fast-Start Failover Task 4: Set the FastStartFailoverThreshold Configuration Property</h4>
<div>
<div class="section">
<p>Fast-start failover will occur if both the observer and the target standby database lose connection to the primary database for the period of time specified by the <code class="codeph">FastStartFailoverThreshold</code> configuration property.</p>
<p>Set the <a id="d12131e2320" class="indexterm-anchor"></a><a id="d12131e2324" class="indexterm-anchor"></a><a id="d12131e2328" class="indexterm-anchor"></a><code class="codeph">FastStartFailoverThreshold</code> property to specify the number of seconds you want the observer and target standby database to wait (after detecting the primary database is unavailable) before initiating a failover. For example:</p>
<pre dir="ltr">DGMGRL&gt; EDIT CONFIGURATION SET PROPERTY FastStartFailoverThreshold = 45;
</pre>
<p>The default value for the <code class="codeph">FastStartFailoverThreshold</code> property is 30 seconds and the lowest possible value is 6 seconds. If you have an Oracle RAC primary database, consider specifying a higher value to minimize the possibility of a false failover in the event of an instance failure.</p>
<p>The time interval starts when the observer first loses its connection to the primary database. If the observer is unable to regain a connection to the primary database within the specified time, then the observer begins a fast-start failover provided the standby database is ready to fail over. Although the default value of 30 seconds is typically adequate for detecting outages and failures on most configurations, you can adjust failover sensitivity with this property to decrease the probability of false failovers in a temporarily unstable environment.</p>
<p>If the <code class="codeph">FastStartFailoverPmyShutdown</code> configuration property is set to <code class="codeph">TRUE</code>, the primary database will shut down after <code class="codeph">FastStartFailoverThreshold</code> seconds has elapsed if redo generation has been stalled and the primary database is unable to reestablish connectivity with either the observer or target standby database.</p>
<p>Note that the <code class="codeph">FastStartFailoverThreshold</code> property can be changed even when fast-start failover is enabled.</p>
<div class="infoboxnotealso" id="GUID-68161F2B-991E-47B6-8D52-9651248A8162__GUID-82EDCFCF-D321-44E8-ADE7-704975472A27">
<p class="notep1">See Also:</p>
<p><a href="dbpropref.htm#GUID-B61FE085-699E-4C00-BF09-794D42161C8F">FastStartFailoverThreshold</a> for reference information about the <code class="codeph">FastStartFailoverThreshold</code> property</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-76F11A61-6A47-4DCA-BFF9-7CD800604290"></a>
<h4 id="DGBKR-GUID-76F11A61-6A47-4DCA-BFF9-7CD800604290" class="sect4"><span class="enumeration_section">5.5.2.5</span> Enabling Fast-Start Failover Task 5: Set Other Properties Related to Fast-Start Failover (Optional)</h4>
<div>
<div class="section">
<p>You can optionally set the database properties described in the following table:</p>
<div class="tblformal" id="GUID-76F11A61-6A47-4DCA-BFF9-7CD800604290__GUID-9224833B-ADC1-4217-B4B6-CAE12DB5F941">
<table class="cellalignment5461" summary="This 3 column table shows the properties that can be optionally set to tune fast-start failover. Column 1 is the property name. Column 2 is a description of that property. Column 3 is the default value for that property.">
<thead>
<tr class="cellalignment5445">
<th class="cellalignment5501" id="d12131e2400">Property Name</th>
<th class="cellalignment5502" id="d12131e2403">Description</th>
<th class="cellalignment5503" id="d12131e2406">Default Value</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment5445">
<td class="cellalignment5504" id="d12131e2411" headers="d12131e2400">
<p><code class="codeph">FastStartFailoverPmyShutdown</code></p>
</td>
<td class="cellalignment5505" headers="d12131e2411 d12131e2403">
<p>This configuration property causes the primary database to shut down if fast-start failover is enabled and <code class="codeph">V$DATABASE.FS_FAILOVER_STATUS</code> indicates the primary has been <code class="codeph">STALLED</code> for longer than <code class="codeph">FastStartFailoverThreshold</code> seconds. A value of <code class="codeph">TRUE</code> helps to ensure that an isolated primary database cannot satisfy user queries.</p>
<p>This property cannot be used to prevent the primary database from shutting down if a fast-start failover occurred because a user configuration condition was detected or was requested by an application by calling the <code class="codeph">DBMS_DG.INITIATE_FS_FAILOVER</code> function.</p>
</td>
<td class="cellalignment5506" headers="d12131e2411 d12131e2406">
<p><code class="codeph">TRUE</code></p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5504" id="d12131e2440" headers="d12131e2400">
<p><code class="codeph">FastStartFailoverLagLimit</code></p>
</td>
<td class="cellalignment5505" headers="d12131e2440 d12131e2403">
<p>This configuration property establishes an acceptable limit, in seconds, that the standby is allowed to fall behind the primary in terms of redo applied, beyond which a fast-start failover will not be allowed. The lowest possible value is 10 seconds.</p>
<p>This property is used when fast-start failover is enabled and the configuration is operating in maximum performance mode.</p>
</td>
<td class="cellalignment5506" headers="d12131e2440 d12131e2406">
<p>30 seconds</p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5504" id="d12131e2453" headers="d12131e2400">
<p><code class="codeph">FastStartFailoverAutoReinstate</code></p>
</td>
<td class="cellalignment5505" headers="d12131e2453 d12131e2403">
<p>This configuration property causes the former primary database to be automatically reinstated if a fast-start failover was initiated because the primary database was either isolated or had crashed. To prevent automatic reinstatement of the former primary database in these cases, set this configuration property to <code class="codeph">FALSE</code>. The broker never automatically reinstates the former primary database if a fast-start failover was initiated because a user configuration condition was detected or was requested by an application calling the <code class="codeph">DBMS_DG.INITIATE_FS_FAILOVER</code> function.</p>
</td>
<td class="cellalignment5506" headers="d12131e2453 d12131e2406">
<p><code class="codeph">TRUE</code></p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5504" id="d12131e2471" headers="d12131e2400">
<p><code class="codeph">ObserverConnectIdentifier</code></p>
</td>
<td class="cellalignment5505" headers="d12131e2471 d12131e2403">
<p>This database property is used to specify how the observer should connect to and monitor the primary and standby database. Set this property for the primary and target standby database if you want the observer to use a different connect identifier than that used to ship redo data (that is, the connect identifier specified by the <code class="codeph">DGConnectIdentifier</code> property).</p>
</td>
<td class="cellalignment5506" headers="d12131e2471 d12131e2406">
<p>Observer uses the value of the <code class="codeph">DGConnectIdentifier</code> property to connect to and monitor the primary and target standby databases.</p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5504" id="d12131e2488" headers="d12131e2400">
<p><code class="codeph">ObserverOverride</code></p>
</td>
<td class="cellalignment5505" headers="d12131e2488 d12131e2403">
<p>The <code class="codeph">ObserverOverride</code> configuration property, when set to <code class="codeph">TRUE</code>, allows an automatic failover to occur when the observer has lost connectivity to the primary, even if the standby has a healthy connection to the primary.</p>
</td>
<td class="cellalignment5506" headers="d12131e2488 d12131e2406">
<p><code class="codeph">FALSE</code></p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5504" id="d12131e2506" headers="d12131e2400">
<p><code class="codeph">ObserverReconnect</code></p>
</td>
<td class="cellalignment5505" headers="d12131e2506 d12131e2403">
<p>The <code class="codeph">ObserverReconnect</code> configuration property specifies how often the observer establishes a new connection to the primary database. When this property is set to the default value of 0, it prevents the observer from periodically establishing a new connection with the primary database. While this eliminates the processing overhead associated with periodically establishing a new observer connection to the primary database, it also prevents the observer from detecting that it is not possible to create new connections to the primary database. Oracle recommends that this property be set to a value that is small enough to allow timely detection of faults at the primary database, but large enough to limit the overhead associated with periodic observer connections to an acceptable level.</p>
</td>
<td class="cellalignment5506" headers="d12131e2506 d12131e2406">
<p>0 (zero)</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-173419E6-3EDF-4580-B339-B687FE37AB56"></a>
<h4 id="DGBKR-GUID-173419E6-3EDF-4580-B339-B687FE37AB56" class="sect4"><span class="enumeration_section">5.5.2.6</span> Enabling Fast-Start Failover Task 6: Enable Additional Fast-Start Failover Conditions (Optional)</h4>
<div>
<div class="section">
<p>By default, a fast-start failover is done when both the observer and the standby cannot reach the primary after the configured time threshold (<code class="codeph">FastStartFailoverThreshold</code>) has passed.</p>
<p>You can optionally indicate the database health conditions that should cause fast-start failover to occur. These conditions are described in the following table:</p>
<div class="tblformal" id="GUID-173419E6-3EDF-4580-B339-B687FE37AB56__GUID-2D3C1F39-3FE8-4DD0-A055-9C1263752EDD">
<table class="cellalignment5461" summary="This 2 column table describes the health conditions for FSFO. Column 1 is the health condition. Column 2 is a description of that condition. Column 3 indicates if it is enabled by default.">
<thead>
<tr class="cellalignment5445">
<th class="cellalignment5507" id="d12131e2556">Health Condition</th>
<th class="cellalignment5508" id="d12131e2559">Description</th>
<th class="cellalignment5457" id="d12131e2562">Enabled by Default</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment5445">
<td class="cellalignment5509" id="d12131e2567" headers="d12131e2556">
<p>Datafile Offline</p>
</td>
<td class="cellalignment5510" headers="d12131e2567 d12131e2559">
<p>A datafile is offline because of a write error.</p>
</td>
<td class="cellalignment5459" headers="d12131e2567 d12131e2562">
<p>Yes</p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5509" id="d12131e2577" headers="d12131e2556">
<p>Corrupted Dictionary</p>
</td>
<td class="cellalignment5510" headers="d12131e2577 d12131e2559">
<p>Dictionary corruption of a critical database. Currently, this state can be detected only when the database is open</p>
</td>
<td class="cellalignment5459" headers="d12131e2577 d12131e2562">
<p>Yes</p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5509" id="d12131e2587" headers="d12131e2556">
<p>Corrupted Controlfile</p>
</td>
<td class="cellalignment5510" headers="d12131e2587 d12131e2559">
<p>Controlfile is permanently damaged because of a disk failure.</p>
</td>
<td class="cellalignment5459" headers="d12131e2587 d12131e2562">
<p>Yes</p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5509" id="d12131e2597" headers="d12131e2556">
<p>Inaccessible Logfile</p>
</td>
<td class="cellalignment5510" headers="d12131e2597 d12131e2559">
<p>LGWR is unable to write to any member of the log group because on an I/O error</p>
</td>
<td class="cellalignment5459" headers="d12131e2597 d12131e2562">
<p>No</p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5509" id="d12131e2607" headers="d12131e2556">
<p>Stuck Archiver</p>
</td>
<td class="cellalignment5510" headers="d12131e2607 d12131e2559">
<p>Archiver is unable to archive a redo log because the device is full or unavailable.</p>
</td>
<td class="cellalignment5459" headers="d12131e2607 d12131e2562">
<p>No</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>In Oracle RAC configurations, the Inaccessible Logfile and Stuck Archiver health conditions may only be applicable to a single instance. Careful consideration should be given before enabling fast-start failover for either of these conditions because doing so will supersede availability options provided by Oracle Clusterware.</p>
<p>You can specify particular conditions for which a fast-start failover should occur using either Cloud Control or the DGMGRL <code class="codeph">ENABLE FAST_START FAILOVER CONDITION</code> and <code class="codeph">DISABLE FAST_START FAILOVER CONDITION</code> commands.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-A9033D52-EB52-4C33-AB4A-4AEC4AC8C1B9"></a>
<h4 id="DGBKR-GUID-A9033D52-EB52-4C33-AB4A-4AEC4AC8C1B9" class="sect4"><span class="enumeration_section">5.5.2.7</span> Enabling Fast-Start Failover Task 7: Using DGMGRL or Cloud Control</h4>
<div>
<div class="section">
<p>Use the Cloud Control Fast-Start Failover wizard or the DGMGRL <code class="codeph">ENABLE FAST_START FAILOVER</code> command to enable fast-start failover. To enable fast-start failover, both the primary and target standby databases must be running and have connectivity, and satisfy all of the prerequisite conditions listed in <a href="sofo.htm#GUID-7EAF1865-2F92-4451-8565-D3C6EC4F8005">Prerequisites for Enabling Fast-Start Failover</a>.</p>
<p><span class="bold">Enable Fast-Start Failover Using Cloud Control</span></p>
<p>To enable fast-start failover in Cloud Control, use the Fast-Start Failover wizard. On the Oracle Data Guard Overview page next to the Fast-Start Failover status field, click <span class="bold">Disabled</span> to invoke the Fast-Start Failover page. Then, on the Fast-Start Failover Change Mode page, click <span class="bold">Enabled</span>. Cloud Control will start the observer. Then, on the Fast-Start Failover Configure page, select the standby database that should be the target of a failover. See <a href="sofo.htm#GUID-2AEF86C4-3CFA-4CF5-AEF3-E25871298363">Choosing a Target Standby Database</a> for helpful advice. This page will not allow you to alter the protection mode. Rather, fast-start failover will be enabled in accordance with the current protection mode. If the currently configured mode is maximum protection, Cloud Control will downgrade the mode to maximum availability.</p>
<p><span class="bold">Enable Fast-Start Failover Using DGMGRL</span></p>
<p>To enable fast-start failover with DGMGRL, issue the <code class="codeph">ENABLE FAST_START FAILOVER</code> command while connected to any database in the broker configuration, including on the observer computer. For example:</p>
<pre dir="ltr">DGMGRL&gt; ENABLE FAST_START FAILOVER;
Enabled.
</pre>
<div class="infoboxnotealso" id="GUID-A9033D52-EB52-4C33-AB4A-4AEC4AC8C1B9__GUID-B1A4C7A2-AF7C-4DC6-9DDF-DB797FD1732D">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="dgmgrl.htm#GUID-A521B8A7-825D-429D-B6CA-E8DDAC02672B">ENABLE FAST_START FAILOVER</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-AAE5EA1A-53A2-4D8D-BF59-A2856B38C99D">Scenario 6: Enabling Fast-Start Failover and Starting the Observer</a></p>
</li>
</ul>
</div>
<div class="infobox-note" id="GUID-A9033D52-EB52-4C33-AB4A-4AEC4AC8C1B9__GUID-80629102-1B63-4C8C-8F68-382F90E141A2">
<p class="notep1">Note:</p>
<p>Administration at the target standby site should be as comprehensive as that at the primary site because the standby database may assume the primary role without prior notice. Staff support, hardware and software, security (both software and site), network connections, and bandwidth should be equivalent at both sites.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-2D75365F-E3D1-4229-B55B-C58DA9EBFBE9"></a>
<h4 id="DGBKR-GUID-2D75365F-E3D1-4229-B55B-C58DA9EBFBE9" class="sect4"><span class="enumeration_section">5.5.2.8</span> Enabling Fast-Start Failover Task 8: Start the Observer</h4>
<div>
<div class="section">
<p>The primary database must be running in order to start the observer.</p>
<p>You can start the observer before or after you enable fast-start failover. If fast-start failover is already enabled, the observer immediately begins monitoring the status and connections to the primary and target standby databases. If fast-start failover is not already enabled, the observer waits until fast-start failover gets enabled and then begins monitoring.</p>
<p><span class="bold">Starting the Observer Using Cloud Control</span></p>
<p>If the Cloud Control agent is installed on the observer computer, it automatically starts the observer when you enable fast-start failover through Cloud Control. If the agent is not present, you must start the observer manually using the following instructions for the DGMGRL command-line interface.</p>
<p><span class="bold">Starting the Observer Using DGMGRL</span></p>
<p>To start the observer with DGMGRL, issue the following command on the observer computer:</p>
<pre dir="ltr">DGMGRL&gt; START OBSERVER;
</pre>
<p>The observer is a continuously executing process that is created when the <code class="codeph">START OBSERVER</code> command is issued. Thus, the command-line prompt on the observer computer does not return until you issue the <code class="codeph">STOP OBSERVER</code> command from another DGMGRL session. To issue commands and interact with the broker configuration, you must connect through another DGMGRL client session.</p>
<p>See the <a href="dgmgrl.htm#GUID-8AADB389-6E31-46D6-AB1C-4FBB8EB6C411">START OBSERVER</a> command for more information.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-BA6A87D4-26A1-4CAA-9B71-E91728B21355"></a>
<h4 id="DGBKR-GUID-BA6A87D4-26A1-4CAA-9B71-E91728B21355" class="sect4"><span class="enumeration_section">5.5.2.9</span> Enabling Fast-Start Failover Task 9: Verify the Fast-Start Failover Environment</h4>
<div>
<div class="section">
<p>To verify the readiness of the fast-start failover configuration, issue the DGMGRL <code class="codeph">SHOW CONFIGURATION VERBOSE</code> command or the <code class="codeph">SHOW FAST_START FAILOVER</code> command on the primary database. For example:</p>
<pre dir="ltr">DGMGRL&gt; SHOW FAST_START FAILOVER;
 
Fast-Start Failover: ENABLED
 Threshold: 60 seconds
 Target: South_Sales
 Observer: observer.example.com
 Lag Limit: 30 seconds (not in use)
 Shutdown Primary: TRUE
 Auto-reinstate: TRUE
 Observer Reconnect: (none)
 Observer Override: FALSE
 
Configurable Failover Conditions
 Health Conditions:
  Corrupted Controlfile YES
  Corrupted Dictionary YES
  Inaccessible Logfile NO
  Stuck Archiver NO
  Datafile Offline YES
 
Oracle Error Conditions:
(none)
</pre>
<p>The following sections provide more information about the fast-start failover environment:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><a href="sofo.htm#GUID-824C3FEF-9D1D-4AA7-9C7A-DBDBADC77F47">When Fast-Start Failover Is Enabled and the Observer Is Running</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-3DAD4204-B8FB-425D-9D22-0602C62FA89A">Restrictions When Fast-Start Failover is Enabled</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-0F672CAD-FBDC-4F21-A96F-B5F08993C453">Shutting Down the Primary Database When Fast-Start Failover Is Enabled</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-0A81C376-FB77-4EB5-AF59-BD872A875FAE">Performing Manual Role Changes When Fast-Start Failover Is Enabled</a></p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR3408"></a>
<div class="props_rev_3"><a id="GUID-824C3FEF-9D1D-4AA7-9C7A-DBDBADC77F47"></a>
<h4 id="DGBKR-GUID-824C3FEF-9D1D-4AA7-9C7A-DBDBADC77F47" class="sect4"><span class="enumeration_section">5.5.2.10</span> When Fast-Start Failover Is Enabled and the Observer Is Running</h4>
<div>
<p>Once you enable fast-start failover and start the observer, the observer continuously monitors the environment to ensure the primary database is available. This section lists the steps the observer takes to determine if a fast-start failover is needed and then to perform one, if necessary.</p>
<ol>
<li>
<p>Monitor the environment to ensure the primary database is available.</p>
<p>The observer waits the number of seconds specified by the <code class="codeph">FastStartFailoverThreshold</code> configuration property before attempting a fast-start failover when the primary database has crashed or has lost connectivity with the observer, as in the following situations:</p>
<ul style="list-style-type: disc;">
<li>
<p>The primary database loses its connections with both the observer and target standby database</p>
</li>
<li>
<p>I<a id="d12131e2849" class="indexterm-anchor"></a><a id="d12131e2853" class="indexterm-anchor"></a><a id="d12131e2857" class="indexterm-anchor"></a>nstance failures</p>
<p>If a single-instance primary database (either Oracle RAC or non-Oracle RAC), or if all instances of an Oracle RAC primary database fail, the observer attempts a fast-start failover.</p>
</li>
<li>
<p><a id="d12131e2868" class="indexterm-anchor"></a><a id="d12131e2870" class="indexterm-anchor"></a><a id="d12131e2874" class="indexterm-anchor"></a><a id="d12131e2880" class="indexterm-anchor"></a>Shutdown abort</p>
<p>If a single-instance primary database (either Oracle RAC or non-Oracle RAC), or if all instances of an Oracle RAC primary database are shut down with the <code class="codeph">ABORT</code> option, the observer attempts a fast-start failover. Fast-start failover will not be attempted for the other types of database shutdown (<code class="codeph">NORMAL</code>, <code class="codeph">IMMEDIATE</code>, <code class="codeph">TRANSACTIONAL</code>).</p>
</li>
</ul>
<p>The observer never waits for the threshold to expire to perform a fast-start failover in the following situations:</p>
<ul style="list-style-type: disc;">
<li>
<p>User-configurable condition</p>
<p>If the observer determines that any of the user-configurable conditions has been detected, the observer attempts a fast-start failover.</p>
</li>
<li>
<p>Application calls to <code class="codeph">DBMS_DG.INITIATE_FS_FAILOVER</code></p>
<p>If an application has called this function and it has received a status of <code class="codeph">SUCCESS</code>, the observer attempts a fast-start failover.</p>
</li>
</ul>
</li>
<li>
<p>Reconnect within the time specified by FastStartFailoverThreshold.</p>
<p>If the observer detects an availability problem with the primary database, the observer typically attempts to reconnect to the primary database within the time specified by the <code class="codeph">FastStartFailoverThreshold</code> configuration property. The <code class="codeph">FastStartFailoverThreshold</code> time interval starts when the observer first detects there might be a failure with the primary database.</p>
<p>The time interval specified by the <code class="codeph">FastStartFailoverThreshold</code> property is ignored if the observer detects that a user-configurable condition has occurred or if a fast-start failover has been requested by the <code class="codeph">DBMS_DG.INITIATE_FS_FAILOVER</code> function.</p>
<p>If the primary database is an Oracle <a id="d12131e2940" class="indexterm-anchor"></a>Real Application Clusters (Oracle RAC)<a id="d12131e2945" class="indexterm-anchor"></a><a id="d12131e2949" class="indexterm-anchor"></a> database, the observer will attempt to connect to one of the remaining primary instances. Fast-start failover will not occur unless all instances comprising the Oracle RAC primary database are perceived to have failed. The observer uses the value specified by either the <code class="codeph">DGConnectIdentifier</code> or <code class="codeph">ObserverConnectIdentifier</code> database properties to connect to the primary and fast-start failover target standby databases. The value specified for either of these properties should allow the observer to connect to any instance of an Oracle RAC database.</p>
</li>
<li>
<p>Verify the target standby database is ready for failover.</p>
<p>If fast-start failover is initiated, the observer verifies the target standby database is ready to fail over to the primary database role.</p>
<p>Fast-start failover <span class="italic">cannot</span> occur if:</p>
<ul style="list-style-type: disc;">
<li>
<p>Fast-start failover is no longer enabled</p>
</li>
<li>
<p>The observer cannot connect to the target standby database</p>
<div class="infoboxnotealso" id="GUID-824C3FEF-9D1D-4AA7-9C7A-DBDBADC77F47__GUID-B3DBF670-4C93-434A-A07F-FAE834A4F9C6">
<p class="notep1">See Also:</p>
<p><a href="sofo.htm#GUID-50C2F974-E9F8-44A8-B4BE-5238A22A623C">What Happens if the Observer Fails?</a> if the observer is not running</p>
</div>
</li>
<li>
<p>The observer and the target standby database are inconsistent with regard to the current state of the broker configuration</p>
</li>
<li>
<p>The observer is not running</p>
</li>
<li>
<p>If the protection mode is maximum availability and the target standby database was not synchronized with the primary database at the time the primary database failed</p>
</li>
<li>
<p>If the protection mode is maximum performance and the apply point of the target standby database lags the redo generation point of the primary database by more than the amount specified by the <code class="codeph">FastStartFailoverLagLimit</code> configuration property at the time the primary database failed</p>
</li>
<li>
<p>The target standby database has contact with the primary database. However, failover is attempted if the <code class="codeph">ObserverOverride</code> configuration property is set to <code class="codeph">TRUE</code>.</p>
</li>
<li>
<p>The <code class="codeph">FS_FAILOVER_STATUS</code> column in the <code class="codeph">V$DATABASE</code> view for the target standby database displays a reason why fast-start failover cannot occur</p>
</li>
<li>
<p>A manual failover is already in progress. See <a href="sofo.htm#GUID-9A988501-7E18-4A62-8CD6-4BDDFA355C98">Manual Failover</a> for complete information about manual failovers.</p>
</li>
<li>
<p>The primary database was shut down without using the <code class="codeph">ABORT</code> option</p>
</li>
</ul>
</li>
<li>
<p>Initiate a fast-start failover.</p>
<p>If the target standby database is ready for failover, the observer immediately directs the target standby database to fail over to the primary database role. If failover is not possible for some reason, the observer will continue checking whether the standby database is ready to fail over. But it will also continue trying to reconnect to the primary database indefinitely. If it reconnects to the primary database before the standby agrees to fail over, the observer will stop attempting to initiate a fast-start failover.</p>
</li>
<li>
<p>Reinstate the former primary database as a new standby database.</p>
<p>After the fast-start failover completes successfully, the observer will attempt to reinstate the former primary database as a new standby database when a connection to the former primary database is reestablished, and the <code class="codeph">FastStartFailoverAutoReinstate</code> configuration property is set to <code class="codeph">TRUE</code>. If the <code class="codeph">FastStartFailoverPmyShutdown</code> configuration property is set to <code class="codeph">TRUE</code>, the former primary database will have been automatically shut down and must be manually restarted before the observer can attempt to reinstate it.</p>
<p>Note that these properties only affect whether primary shutdown and automatic reinstatement are performed if a fast-start failover occurs because the primary crashed or was isolated from the observer and target standby database.</p>
<div class="infoboxnotealso" id="GUID-824C3FEF-9D1D-4AA7-9C7A-DBDBADC77F47__GUID-96B2471D-4CC1-49DD-B35D-C71BAB900539">
<p class="notep1">See Also:</p>
<p><a href="sofo.htm#GUID-319C443F-4386-49B1-A0FC-9C4166D061CA">Reinstating the Former Primary Database in the Broker Configuration</a> for more information about reinstatement</p>
</div>
</li>
</ol>
</div>
</div>
<a id="DGBKR393"></a>
<div class="props_rev_3"><a id="GUID-3DAD4204-B8FB-425D-9D22-0602C62FA89A"></a>
<h4 id="DGBKR-GUID-3DAD4204-B8FB-425D-9D22-0602C62FA89A" class="sect4"><span class="enumeration_section">5.5.2.11</span> Restrictions When Fast-Start Failover is Enabled</h4>
<div>
<p>When fast-start failover is enabled, you cannot:</p>
<ul style="list-style-type: disc;">
<li>
<p>Change:</p>
<ul style="list-style-type: disc;">
<li>
<p>The configuration protection mode</p>
</li>
<li>
<p>The redo transport mode used to send redo to the target standby database or the database currently in the primary role</p>
</li>
<li>
<p>The <a href="dbpropref.htm#GUID-63108DF8-4DAD-40F1-88B1-458C3FCB6C84">FastStartFailoverTarget</a> configuration property on the primary or target standby databases</p>
</li>
<li>
<p>The <code class="codeph">RedoRoutes</code> property on the primary or target standby databases</p>
</li>
<li>
<p>The <code class="codeph">RedoRoutes</code> property on a far sync instance if it is being used to receive redo from the primary database and ship redo to the target standby database</p>
</li>
</ul>
</li>
<li>
<p>Disable or delete:</p>
<ul style="list-style-type: disc;">
<li>
<p>The broker configuration</p>
</li>
<li>
<p>The standby database that is the target of fast-start failover</p>
</li>
<li>
<p>A far sync instance if it is being used to receive redo from the primary database and ship redo to the target standby database</p>
</li>
</ul>
</li>
<li>
<p>Perform a manual failover:</p>
<ul style="list-style-type: disc;">
<li>
<p>Unless the conditions listed in <a href="sofo.htm#GUID-0A81C376-FB77-4EB5-AF59-BD872A875FAE">Performing Manual Role Changes When Fast-Start Failover Is Enabled</a> have been met</p>
</li>
<li>
<p>To a standby database that is not configured as the fast-start failover target</p>
<p>To determine if the configuration is ready for fast-start failover to occur, issue the DGMGRL <code class="codeph">SHOW DATABASE &lt;target-standby-database&gt;</code> command, or query the <a id="d12131e3143" class="indexterm-anchor"></a><a id="d12131e3147" class="indexterm-anchor"></a><a id="d12131e3151" class="indexterm-anchor"></a><code class="codeph">V$DATABASE</code> view on either the primary or target standby databases. The column value for <code class="codeph">V$DATABASE.FS_FAILOVER_STATUS</code> will be <code class="codeph">SYNCHRONIZED</code> in a configuration operating in maximum availability mode, and it will be <code class="codeph">TARGET UNDER LAG LIMIT</code> in a configuration operating in maximum performance mode when ready to fast-start failover. The <code class="codeph">FS_FAILOVER_OBSERVER_PRESENT</code> column displays <code class="codeph">YES</code> for the target standby database.</p>
</li>
</ul>
</li>
<li>
<p>Perform a switchover to a standby database that is not configured as the fast-start failover target</p>
</li>
<li>
<p>Perform a switchover to the target standby database in a configuration operating in maximum availability mode, unless the standby database is synchronized with the primary database</p>
</li>
<li>
<p>Perform a switchover to the target standby database in a configuration operating in maximum performance mode, unless the standby database is within the lag limit of the primary database</p>
</li>
<li>
<p>Attempt to open the primary database, or the following error may be returned:</p>
<pre dir="ltr">ORA-16649: possible failover to another database prevents this database from being opened
</pre>
<p>This error may return if the fast-start failover validity check fails or does not complete in under two minutes.</p>
</li>
<li>
<p>Use the SQL <code class="codeph">ALTER DATABASE MOVE DATAFILE</code> command to rename or relocate an online data file on a physical standby that is a fast-start failover target if the standby is mounted, but not open.</p>
</li>
</ul>
</div>
</div>
<a id="DGBKR3409"></a>
<div class="props_rev_3"><a id="GUID-0F672CAD-FBDC-4F21-A96F-B5F08993C453"></a>
<h4 id="DGBKR-GUID-0F672CAD-FBDC-4F21-A96F-B5F08993C453" class="sect4"><span class="enumeration_section">5.5.2.12</span> Shutting Down the Primary Database When Fast-Start Failover Is Enabled</h4>
<div>
<p>Fast-start failover will not be triggered if the primary or standby database is shut down normally (using <code class="codeph">SHUTDOWN NORMAL</code>, <code class="codeph">SHUTDOWN IMMEDIATE</code>, or <code class="codeph">SHUTDOWN TRANSACTIONAL</code>). A normal shutdown will prevent fast-start failover until the primary database and standby database are connected and communicating again.</p>
</div>
</div>
<a id="DGBKR3410"></a>
<div class="props_rev_3"><a id="GUID-0A81C376-FB77-4EB5-AF59-BD872A875FAE"></a>
<h4 id="DGBKR-GUID-0A81C376-FB77-4EB5-AF59-BD872A875FAE" class="sect4"><span class="enumeration_section">5.5.2.13</span> Performing Manual Role Changes When Fast-Start Failover Is Enabled</h4>
<div>
<p>If fast-start failover is enabled you can still perform a switchover or a manual failover as long as the following conditions are met:</p>
<ul style="list-style-type: disc;">
<li>
<p>The role change is directed to the same standby database that was specified for the <code class="codeph">FastStartFailoverTarget</code> database property on the primary database.</p>
</li>
<li>
<p>The target standby database is synchronized with the primary database if it is a configuration operating in maximum availability mode, or the target standby database is within the lag limit if it is a configuration operating in maximum performance mode.</p>
</li>
<li>
<p>For manual failover, the observer is started and communicating with the target standby database. You must ensure that the primary database is shut down prior to performing a manual failover.</p>
</li>
</ul>
<div class="infobox-note" id="GUID-0A81C376-FB77-4EB5-AF59-BD872A875FAE__GUID-7A318476-723B-44CA-87D9-31461DCFCD44">
<p class="notep1">Note:</p>
<p>You can disable fast-start failover if necessary, by using the <code class="codeph">FORCE</code> option. See <a href="sofo.htm#GUID-67878B37-39B5-402A-A219-69E7483405A1">Disabling Fast-Start Failover</a>.</p>
</div>
<div class="infoboxnotealso" id="GUID-0A81C376-FB77-4EB5-AF59-BD872A875FAE__GUID-DEF02924-EC39-472C-B489-340B41C39B00">
<p class="notep1">See Also:</p>
<p><a href="sofo.htm#GUID-AC6A6D2B-1112-422B-8A41-02FAC40E2078">Switchover</a> and <a href="sofo.htm#GUID-9A988501-7E18-4A62-8CD6-4BDDFA355C98">Manual Failover</a> for more information about switchovers and manual failovers, respectively</p>
</div>
</div>
</div>
</div>
<a id="DGBKR3411"></a>
<div class="props_rev_3"><a id="GUID-C98DB3F7-2894-4855-9BBD-E3593E59383C"></a>
<h3 id="DGBKR-GUID-C98DB3F7-2894-4855-9BBD-E3593E59383C" class="sect3"><span class="enumeration_section">5.5.3</span> Directing a Fast-Start Failover From an Application</h3>
<div>
<p>You can customize fast-start failover setup for a specific application by using the <code class="codeph">DBMS_DG</code> PL/SQL package. When a serious condition uniquely known to an application is detected, the application can call the <code class="codeph">DBMS_DG.INITIATE_FS_FAILOVER</code> function to initiate an immediate fast-start failover. This function can be called from a connection to either the primary or any standby in the configuration. The database on which the procedure is called notifies the observer. The observer immediately initiates a fast-start failover, as long as the failover target database is in a valid fast-start failover state (&#34;observed&#34; and either &#34;synchronized&#34; or &#34;within lag&#34;) to accept a failover. Once the observer has initiated a fast-start failover, the primary database shuts down automatically. The observer does not attempt to reinstate the former primary database.</p>
<p>If the configuration is not failable, the <code class="codeph">DBMS_DG.INITIATE_FS_FAILOVER</code> function returns an <code class="codeph">ORA</code> error number (it does not signal an exception) informing the caller that a fast-start failover could not be performed.</p>
<div class="infobox-note" id="GUID-C98DB3F7-2894-4855-9BBD-E3593E59383C__GUID-666284B9-01E5-46B1-9C87-6801EEF629F6">
<p class="notep1">Note:</p>
<p>An application should use caution when calling the <code class="codeph">DBMS_DG.INITIATE_FS_FAILOVER</code> function because the observer will initiate failover, if at all possible.</p>
</div>
<div class="infoboxnotealso" id="GUID-C98DB3F7-2894-4855-9BBD-E3593E59383C__GUID-5D4817B2-11A6-4791-BB2E-2F192758D87D">
<p class="notep1">See Also:</p>
<p><a class="olink ARPLS920" target="_blank" href="../ARPLS/d_dg.htm#ARPLS920"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information about the <code class="codeph">DBMS_DG</code> package</p>
</div>
</div>
</div>
<a id="DGBKR3412"></a>
<div class="props_rev_3"><a id="GUID-47C45F0E-ABFA-40D7-83E8-5CCCEED524E5"></a>
<h3 id="DGBKR-GUID-47C45F0E-ABFA-40D7-83E8-5CCCEED524E5" class="sect3"><span class="enumeration_section">5.5.4</span> Viewing Fast-Start Failover Configuration Statistics and Status</h3>
<div>
<div class="section">
<p>To verify the observer is started and the configuration is ready for fast-start failover, you can issue the DGMGRL <code class="codeph">SHOW DATABASE &lt;target-standby-database&gt;</code> command or query the <code class="codeph">V$DATABASE</code> view on the target standby database.</p>
<p>You can also query the <code class="codeph">V$FS_FAILOVER_STATS</code> view to display statistics about fast-start failover occurring on the system.</p>
<p>The rest of this section provides examples of using DGMGRL <code class="codeph">SHOW</code> commands to display fast-start failover information and includes sections describing the following views:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><a href="sofo.htm#GUID-F00FD0C8-2A9C-4CA6-A629-F35CED45852F">V$DATABASE View</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-FFD3C117-7DE2-4EA3-BB58-BA2690C2F781">V$FS_FAILOVER_STATS View</a></p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Example 1: SHOW FAST_START FAILOVER</p>
</div>
<!-- class="section" -->
<div class="section">
<p>The DGMGRL <code class="codeph">SHOW FAST-START FAILOVER</code> command displays all the fast-start failover related information. For example:</p>
<pre dir="ltr">DGMGRL&gt; SHOW FAST_START FAILOVER;
 
Fast-Start Failover: ENABLED
 Threshold:           60 seconds
 Target:              South_Sales
 Observer:            observer.example.com
 Lag Limit:           30 seconds (not in use)
 Shutdown Primary:    TRUE
 Auto-reinstate:      TRUE
 Observer Reconnect: (none)
 Observer Override: FALSE
 
Configurable Failover Conditions
 Health Conditions:
   Corrupted Controlfile          YES
   Corrupted Dictionary           YES
   Inaccessible Logfile            NO
   Stuck Archiver                  NO
   Datafile Offline               YES
 
 Oracle Error Conditions:
   (none)
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Example 2: SHOW CONFIGURATION VERBOSE</p>
</div>
<!-- class="section" -->
<div class="section">
<p>The following example shows the fast-start failover information for the DRSolution configuration:</p>
<pre dir="ltr">Configuration - DRSolution
 
Protection Mode: MaxAvailability
Databases:
North_Sales - Primary database
South_Sales - (*) Physical standby database
 
(*) Fast-Start Failover target
 
Properties:
  FastStartFailoverThreshold     = &#39;60&#39;
  OperationTimeout               = &#39;30&#39;
  TraceLevel                     = &#39;USER&#39;
  FastStartFailoverLagLimit      = &#39;30&#39;
  CommunicationTimeout           = &#39;180&#39;
  ObserverReconnect              = &#39;0&#39;
  FastStartFailoverAutoReinstate = &#39;TRUE&#39;
  FastStartFailoverPmyShutdown   = &#39;TRUE&#39;
  BystandersFollowRoleChange     = &#39;ALL&#39;
  ObserverOverride               = &#39;FALSE&#39;
  ExternalDestination1           = &#39;&#39;
  ExternalDestination2           = &#39;&#39;
  PrimaryLostWriteAction         = &#39;CONTINUE&#39;
 
Fast-Start Failover: ENABLED
 
  Threshold: 30 seconds
  Target: South_Sales
  Observer: observer.example.com
  Lag Limit: 30 seconds (not in use)
  Shutdown Primary: TRUE
  Auto-reinstate: TRUE
  Observer Reconnect: (none)
  Observer Override: FALSE
 
Configuration Status:
SUCCESS
</pre></div>
<!-- class="section" --></div>
<a id="DGBKR3542"></a><a id="DGBKR3413"></a>
<div class="props_rev_3"><a id="GUID-F00FD0C8-2A9C-4CA6-A629-F35CED45852F"></a>
<h4 id="DGBKR-GUID-F00FD0C8-2A9C-4CA6-A629-F35CED45852F" class="sect4"><span class="enumeration_section">5.5.4.1</span> V$DATABASE View</h4>
<div>
<p>You can query the <code class="codeph">V$DATABASE</code> view <a id="d12131e3486" class="indexterm-anchor"></a><a id="d12131e3490" class="indexterm-anchor"></a>to verify that the observer is started and the configuration is ready for fast-start failover. When querying the <code class="codeph">V$DATABASE</code> view, pay special attention to the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>The <code class="codeph">FS_FAILOVER_STATUS</code> column, which can contain the values described in <a href="sofo.htm#GUID-F00FD0C8-2A9C-4CA6-A629-F35CED45852F__CHDIDBGI" title="Lists the values for the FS_FAILOVER_STATUS column of the V$DATABASE view.">Table 5-1</a>. Note that if the <code class="codeph">V$DATABASE.FS_FAILOVER_STATUS</code> column has a value of <code class="codeph">DISABLED</code>, then any values returned for the remaining columns related to fast-start failover (<code class="codeph">V$DATABASE.FS_FAILOVER_*</code>) become irrelevant.</p>
</li>
<li>
<p>The <code class="codeph">FS_FAILOVER_OBSERVER_PRESENT</code> column, which indicates whether the observer is running and actively pinging the database.</p>
</li>
</ul>
<div class="tblformal" id="GUID-F00FD0C8-2A9C-4CA6-A629-F35CED45852F__CHDIDBGI">
<p class="titleintable">Table 5-1 FS_FAILOVER_STATUS Column of the V$DATABASE View</p>
<table class="cellalignment5461" title="FS_FAILOVER_STATUS Column of the V$DATABASE View" summary="Lists the values for the FS_FAILOVER_STATUS column of the V$DATABASE view.">
<thead>
<tr class="cellalignment5445">
<th class="cellalignment5480" id="d12131e3538">Column Value</th>
<th class="cellalignment5511" id="d12131e3541">Description</th>
<th class="cellalignment5476" id="d12131e3544">Fast-Start Failover ...</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment5445">
<td class="cellalignment5482" id="d12131e3549" headers="d12131e3538">
<p><code class="codeph">BYSTANDER</code></p>
</td>
<td class="cellalignment5512" headers="d12131e3549 d12131e3541">
<p>Fast-start failover is enabled, but this standby database is not the target of the fast-start failover. The database cannot provide fast-start failover status information.</p>
</td>
<td class="cellalignment5478" headers="d12131e3549 d12131e3544">
<p>Is enabled</p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5482" id="d12131e3560" headers="d12131e3538">
<p><code class="codeph">DISABLED</code></p>
</td>
<td class="cellalignment5512" headers="d12131e3560 d12131e3541">
<p>Fast-start failover is disabled.</p>
</td>
<td class="cellalignment5478" headers="d12131e3560 d12131e3544">
<p>Is not possible</p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5482" id="d12131e3571" headers="d12131e3538">
<p><code class="codeph">LOADING DICTIONARY</code></p>
</td>
<td class="cellalignment5512" headers="d12131e3571 d12131e3541">
<p>Displays only on a logical standby database that has not yet completed loading a copy of the primary database&#39;s data dictionary.</p>
</td>
<td class="cellalignment5478" headers="d12131e3571 d12131e3544">
<p>Is not possible</p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5482" id="d12131e3582" headers="d12131e3538">
<p><code class="codeph">PRIMARY UNOBSERVED</code></p>
</td>
<td class="cellalignment5512" headers="d12131e3582 d12131e3541">
<p>Displays only on the target standby database when it is <code class="codeph">SYNCHRONIZED</code> with or is <code class="codeph">TARGET UNDER LAG LIMIT</code> of the primary database, has connectivity to the observer, but the primary database does not have a connection to the observer.</p>
</td>
<td class="cellalignment5478" headers="d12131e3582 d12131e3544">
<p>Is not possible</p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5482" id="d12131e3599" headers="d12131e3538">
<p><code class="codeph">REINSTATE FAILED</code></p>
</td>
<td class="cellalignment5512" headers="d12131e3599 d12131e3541">
<p>Reinstatement of the failed primary database as a new standby database failed. See <a href="troubleshooting.htm#GUID-A7D1301B-635F-46C6-9E33-FDA2093B8ABA">Sources of Diagnostic Information</a> for details about the broker&#39;s <a id="d12131e3610" class="indexterm-anchor"></a><a id="d12131e3614" class="indexterm-anchor"></a><a id="d12131e3620" class="indexterm-anchor"></a><code class="codeph">drc*</code> log files.</p>
</td>
<td class="cellalignment5478" headers="d12131e3599 d12131e3544">
<p>Has completed</p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5482" id="d12131e3631" headers="d12131e3538">
<p><code class="codeph">REINSTATE REQUIRED</code></p>
</td>
<td class="cellalignment5512" headers="d12131e3631 d12131e3541">
<p>The failed primary database requires reinstatement as a new standby database to the new primary. The observer automatically starts the reinstatement process. <code class="codeph">REINSTATE REQUIRED</code> is present only after fast-start failover has occurred and shows on both the new primary database and the database undergoing reinstatement. This is cleared on both when the reinstatement has been completed.</p>
</td>
<td class="cellalignment5478" headers="d12131e3631 d12131e3544">
<p>Has completed</p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5482" id="d12131e3645" headers="d12131e3538">
<p><code class="codeph">STALLED</code></p>
</td>
<td class="cellalignment5512" headers="d12131e3645 d12131e3541">
<p>Displays on the primary database after loss of connectivity to the target standby database and the change to the <code class="codeph">UNSYNCHRONIZED</code> state (maximum availability mode) or to the <code class="codeph">TARGET OVER LAG LIMIT</code> state (maximum performance mode) cannot be confirmed by either the target standby database or the observer. Note that the value of the <code class="codeph">FastStartFailoverPmyShutdown</code> configuration property must be <code class="codeph">FALSE</code> for the primary to stall indefinitely under these conditions. With a value of <code class="codeph">TRUE</code> for this property, the primary will shut down after being stalled for the number of seconds specified by the <code class="codeph">FastStartFailoverThreshold</code> property.</p>
<p>It shuts down or stalls because it is likely a failover has occurred.</p>
<p><span class="bold">Note</span>: this state also occurs on the primary during startup when fast-start failover is possible and neither the target standby database nor the observer are present to confirm it is okay to continue opening the database.</p>
</td>
<td class="cellalignment5478" headers="d12131e3645 d12131e3544">
<p>Is possible</p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5482" id="d12131e3681" headers="d12131e3538">
<p><code class="codeph">TARGET OVER LAG LIMIT</code></p>
</td>
<td class="cellalignment5512" headers="d12131e3681 d12131e3541">
<p>Displays if the standby database&#39;s redo applied point lags the primary database&#39;s redo generation point by more than the number of seconds specified by the <code class="codeph">FastStartFailoverLagLimit</code> configuration property and the configuration is operating in maximum performance mode.</p>
</td>
<td class="cellalignment5478" headers="d12131e3681 d12131e3544">
<p>Is not possible</p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5482" id="d12131e3695" headers="d12131e3538">
<p><code class="codeph">TARGET UNDER LAG LIMIT</code></p>
</td>
<td class="cellalignment5512" headers="d12131e3695 d12131e3541">
<p>Displays if the standby database&#39;s redo applied point does not lag the primary database&#39;s redo generation point by more than the number of seconds specified by the <code class="codeph">FastStartFailoverLagLimit</code> configuration property and the configuration is operating in maximum performance mode.</p>
</td>
<td class="cellalignment5478" headers="d12131e3695 d12131e3544">
<p>Is possible</p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5482" id="d12131e3709" headers="d12131e3538">
<p><code class="codeph">SUSPENDED</code></p>
</td>
<td class="cellalignment5512" headers="d12131e3709 d12131e3541">
<p>Displays only on the target standby database when either the primary or target standby database was shut down in a controlled fashion (using the <code class="codeph">NORMAL</code>, <code class="codeph">IMMEDIATE</code>, or <code class="codeph">TRANSACTIONAL</code>, options, but not the <code class="codeph">ABORT</code> option). Fast-start failover is inhibited in this case. <code class="codeph">SUSPENDED</code> is cleared when connectivity with the primary database is restored.</p>
</td>
<td class="cellalignment5478" headers="d12131e3709 d12131e3544">
<p>Is not possible</p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5482" id="d12131e3735" headers="d12131e3538">
<p><code class="codeph">SYNCHRONIZED</code></p>
</td>
<td class="cellalignment5512" headers="d12131e3735 d12131e3541">
<p>Displays when the primary and target standby databases are synchronized and the configuration is operating in maximum availability mode.</p>
</td>
<td class="cellalignment5478" headers="d12131e3735 d12131e3544">
<p>Is possible if the target standby database displays <code class="codeph">SYNCHRONIZED</code> and the <code class="codeph">FS_FAILOVER_OBSERVER_PRESENT</code> column displays <code class="codeph">YES</code></p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5482" id="d12131e3755" headers="d12131e3538">
<p><code class="codeph">UNSYNCHRONIZED</code></p>
</td>
<td class="cellalignment5512" headers="d12131e3755 d12131e3541">
<p>Displays when the target standby database does not have all of the primary database redo data and the configuration is operating in maximum availability mode.</p>
</td>
<td class="cellalignment5478" headers="d12131e3755 d12131e3544">
<p>Is not possible</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<a id="DGBKR3414"></a>
<div class="props_rev_3"><a id="GUID-FFD3C117-7DE2-4EA3-BB58-BA2690C2F781"></a>
<h4 id="DGBKR-GUID-FFD3C117-7DE2-4EA3-BB58-BA2690C2F781" class="sect4"><span class="enumeration_section">5.5.4.2</span> V$FS_FAILOVER_STATS View</h4>
<div>
<p>Because fast-start failovers are fully automated and can occur at any time, it is useful to query this view on the primary database to display statistics about fast-start failovers that have occurred on the system, including:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">LAST_FAILOVER_TIME</code> that shows the timestamp of last fast-start failover</p>
</li>
<li>
<p><code class="codeph">LAST_FAILOVER_REASON</code> that shows the reason for the last fast-start failover</p>
</li>
</ul>
<p>The following is an example of querying the <code class="codeph">V$FS_FAILOVER_STATS</code> view:</p>
<pre dir="ltr">SQL&gt; SELECT LAST_FAILOVER_TIME, LAST_FAILOVER_REASON FROM V$FS_FAILOVER_STATS;
 
LAST_FAILOVER_TIME
--------------------
LAST_FAILOVER_REASON
------------------------------------------------------------------------------------------------------------------------------------
02/13/2007 16:53:10
Primary Disconnected
</pre></div>
</div>
</div>
<a id="DGBKR3543"></a><a id="DGBKR3390"></a>
<div class="props_rev_3"><a id="GUID-67878B37-39B5-402A-A219-69E7483405A1"></a>
<h3 id="DGBKR-GUID-67878B37-39B5-402A-A219-69E7483405A1" class="sect3"><span class="enumeration_section">5.5.5</span> Disabling Fast-Start Failover</h3>
<div>
<div class="section">
<p>Disablin<a id="d12131e3833" class="indexterm-anchor"></a><a id="d12131e3837" class="indexterm-anchor"></a>g fast-start failover prevents the observer from initiating a failover to the target standby database. In this case, manual failover may still be possible. See <a href="sofo.htm#GUID-9A988501-7E18-4A62-8CD6-4BDDFA355C98">Manual Failover</a> for information about manual failover.</p>
<div class="infobox-note" id="GUID-67878B37-39B5-402A-A219-69E7483405A1__GUID-68843206-9EBC-4EFD-83AB-4C203F295A05">
<p class="notep1">Note:</p>
<p>Disabling fast-start failover does not stop the observer. To stop the observer, see <a href="sofo.htm#GUID-4B70523D-7E11-445C-A585-502ED93CBAB2">Stopping the Observer</a>.</p>
</div>
<p>To disable fast-start failover, use the Fast-S<a id="d12131e3855" class="indexterm-anchor"></a>tart Failover wizard in Cloud Control or the DGMGRL <code class="codeph">DISABLE FAST_START FAILOVER</code> <code class="codeph">[FORCE]</code> command. The <code class="codeph">FORCE</code> option disables fast-start failover on the database to which you are connected even when errors occur. Whether or not you need the <code class="codeph">FORCE</code> option depends mostly on if the primary and target standby database have network connectivity:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>If the primary and target standby database have network connectivity, and the database to which you are connected has network connectivity with the primary database, the <code class="codeph">FORCE</code> option has no effect. Simply use <code class="codeph">DISABLE FAST_START FAILOVER</code>. This method will disable fast-start failover on all databases in the broker configuration.</p>
<p>If errors occur during the disable operation, the broker returns an error message and stops the disable operation.</p>
</li>
<li>
<p>If the primary and target standby databases do not have network connectivity or if the database to which you are connected does not have network connectivity with the primary database, consider using <code class="codeph">DISABLE FAST_START FAILOVER</code> <span class="italic">with</span> the <code class="codeph">FORCE</code> option.</p>
<p>The broker may not be able to d<a id="d12131e3901" class="indexterm-anchor"></a><a id="d12131e3907" class="indexterm-anchor"></a><a id="d12131e3911" class="indexterm-anchor"></a>isable fast-start failover on all databases in the broker configuration when you issue the <code class="codeph">DISABLE FAST_START FAILOVER FORCE</code> command. As a result, there is no guarantee that the observer will not perform a fast-start failover to the target standby database if the observer determines that conditions warrant a failover. The following list indicates the extent to which fast-start failover is disabled in the broker configuration when the <code class="codeph">DISABLE FAST_START FAILOVER FORCE</code> command is issued on the primary database, target standby database, and a standby database that is not the fast-start failover target.</p>
<p>If you issue this command on:</p>
<ul style="list-style-type: disc;">
<li>
<p>The target standby database when it does not have connectivity with the primary database, fast-start failover is disabled only on the target standby database. In this case, the observer cannot perform a fast-start failover even if conditions warrant a failover. Disabling fast-start failover with the <code class="codeph">FORCE</code> option when connected to the target standby database guarantees that fast-start failover will not occur.</p>
<p>When the primary database and the target standby database regain network connectivity, the broker will disable fast-start failover for the entire broker configuration.</p>
</li>
<li>
<p>The primary database, it attempts to disable fast-start failover on as many databases in the configuration with which it has a network connection. If the primary database does not have connectivity with the target standby database, fast-start failover remains enabled on the target standby database and the observer may still attempt a fast-start failover if conditions warrant a failover.</p>
<div class="infobox-note" id="GUID-67878B37-39B5-402A-A219-69E7483405A1__GUID-3A17624B-8CF5-4D60-A92D-D8190E9B4E75">
<p class="notep1">Caution:</p>
<p>This action may result in two databases in the configuration simultaneously assuming the primary database role should fast-start failover occur. For this reason, you should first issue this command on the target standby database.</p>
</div>
</li>
<li>
<p>Another standby database that does not have connectivity with the primary database, fast-start failover is disabled for this database. Because fast-start failover was not disabled on the target standby database, the observer may still attempt a fast-start failover to the target standby database should conditions warrant a failover.</p>
<p>When the primary database and the (non-target) standby database regain network connectivity, the broker will propagate its current fast-start failover setting (<code class="codeph">ENABLED</code> or <code class="codeph">DISABLED</code>) to the non-target standby.</p>
<div class="infobox-note" id="GUID-67878B37-39B5-402A-A219-69E7483405A1__GUID-EF488809-BE46-45CA-89E4-554A32653BBB">
<p class="notep1">Caution:</p>
<p>When you are experiencing network disconnections and you issue the <code class="codeph">DISABLE FAST_START FAILOVER FORCE</code> command on the primary database or a standby database that does not have connectivity with the primary database, fast-start failover may not be disabled for all databases in the broker configuration. As a result the observer may still initiate fast-start failover to the target standby database, if conditions warrant a failover. This may result in two databases in the configuration simultaneously assuming the primary database role.</p>
</div>
</li>
</ul>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Conditions Requiring the FORCE Option</p>
</div>
<!-- class="section" -->
<div class="section">
<p>Disabling fast-start failover without the <code class="codeph">FORCE</code> option can succeed only if the database on which the command is issued has a network connection with the primary database and if the primary database and target standby database have a network connection. This is the recommended method for disabling fast-start failover.</p>
<p>However, there may be situations in which you must disable fast-start failover when the primary database and the target standby database do not have a network connection, or the database on which you issued the disable fast-start failover command does not have a network connection to the primary database. In cases where there is a lost network connection, be aware that the observer may attempt a fast-start failover to the target standby database if conditions warrant a failover.The <code class="codeph">FORCE</code> option may be the preferred method for disabling fast-start failover when:</p>
<ul style="list-style-type: disc;">
<li>
<p>A network outage isolates the primary database from the observer and the target standby database before conditions exist that warrant a failover.</p>
<p>In this case, the primary database stalls and prevents any further transactions from committing because a fast-start failover may have occurred while it was isolated. If you expect the network to be disconnected for a long time and you need to make the primary database available, first confirm that a fast-start failover has not occurred to the target standby database. Then, disable fast-start failover with the <code class="codeph">FORCE</code> option on the primary database.If possible, confirm that fast-start failover has not occurred to the target standby database prior to disabling fast-start failover with the <code class="codeph">FORCE</code> option on the primary database.</p>
<div class="infobox-note" id="GUID-67878B37-39B5-402A-A219-69E7483405A1__GUID-1BB0D4BC-2006-411D-AC4C-365A4F802318">
<p class="notep1">Caution:</p>
<p>This action may result in two databases in the configuration simultaneously assuming the primary database role. This can be avoided by first disabling fast-start failover with the <code class="codeph">FORCE</code> option on the target standby.</p>
</div>
</li>
<li>
<p>You want to conduct a <a id="d12131e3991" class="indexterm-anchor"></a><a id="d12131e3995" class="indexterm-anchor"></a><a id="d12131e3999" class="indexterm-anchor"></a>manual failover to any standby database in the configuration (for example, because a failure occurred on the primary database at a time when the primary and target standby database were not ready to failover).</p>
<p>In this case fast-start failover cannot occur because the databases are not ready to failover. You cannot perform a manual failover to the target standby database for the same reason. To proceed, you must first disable fast-start failover using the <code class="codeph">FORCE</code> option, and then perform a manual failover.</p>
<div class="infobox-note" id="GUID-67878B37-39B5-402A-A219-69E7483405A1__GUID-A20C8CDB-E1E8-498D-877A-691EC2AD6C2A">
<p class="notep1">Caution:</p>
<p>This action will result in loss of data and the possibility of two databases in the configuration simultaneously assuming the primary database role. This can be avoided by first disabling fast-start failover with the <code class="codeph">FORCE</code> option on the target standby.</p>
</div>
</li>
<li>
<p>A fast-start failover to the target standby database fails.</p>
<p>If the failover fails for any reason, it could leave the target standby database inoperable, regardless of whether the target standby database is ready to failover. If there is another standby database that is available for failover, you can perform a manual failover to that standby database after you first disable fast-start failover using the <code class="codeph">FORCE</code> option on that standby database.</p>
</li>
<li>
<p>You want to prevent fast-start failover from occurring because the primary database will resume service soon.</p>
<p>In this case, disable fast-start failover using the <code class="codeph">FORCE</code> option on the target standby database. Once the primary database regains connectivity with the target standby database, fast-start failover will be disabled for all the databases in the configuration.</p>
</li>
</ul>
<p><span class="bold">Disabling Fast-Start Failover Using Cloud Control</span></p>
<p>Click <span class="bold">Disable</span> in the Fast-Start Failover wizard. Then, click <span class="bold">Continue</span> to proceed to the next page. See the Cloud Control online help for more information.</p>
<p><span class="bold">Disabling Fast-Start Failover Using DGMGRL</span></p>
<p>Issue the <code class="codeph">DISABLE FAST_START FAILOVER</code> command or the <code class="codeph">DISABLE FAST_START FAILOVER</code> <code class="codeph">FORCE</code> command. See the <span class="q">&#34;<a href="dgmgrl.htm#GUID-0774E121-0DA8-44FD-BD28-2FDF3E3F63E9">DISABLE FAST_START FAILOVER</a>&#34;</span> command in <a href="dgmgrl.htm#GUID-E7889124-C414-466F-9FBB-B8F035881F89" title="The DGMGRL ADD DATABASE command adds a standby database to an existing broker configuration.The DGMGRL CONNECT command connects you to a database or far sync instance that is a member of a Data Guard broker configuration.">Oracle Data Guard Command-Line Interface Reference</a> for more information.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR396"></a>
<div class="props_rev_3"><a id="GUID-D2166F5B-9347-46AB-B291-D008C7D95B3A"></a>
<h3 id="DGBKR-GUID-D2166F5B-9347-46AB-B291-D008C7D95B3A" class="sect3"><span class="enumeration_section">5.5.6</span> Performance Considerations for Fast-Start Failover</h3>
<div>
<p>Consider the following recommendations to obtain better performance when using fast-start failover:</p>
<ul style="list-style-type: disc;">
<li>
<p>The failover time is dependent upon whether the target standby database (physical or logical standby database) has applied all of the redo data it has received from the primary database.</p>
</li>
<li>
<p>Enabling fast-start failover in a configuration operating in maximum performance mode provides better overall performance on the primary database because redo data is sent asynchronously to the target standby database. Note that this does not guarantee no data will be lost.</p>
</li>
<li>
<p>Fast-start failover is faster when you take steps to optimize recovery so that the application of redo data to the standby database is kept up to date with the primary database&#39;s rate of redo application. To optimize the log apply rate:</p>
<ul style="list-style-type: disc;">
<li>
<p>Do not configure the <code class="codeph">DelayMins</code> database property to delay applying archived redo log files to the standby database (see <a href="dbresource.htm#GUID-6753936C-E2E3-471E-BCC5-0C4697AD4255">Managing Log Apply Services</a> for more information).</p>
</li>
<li>
<p>See <a class="olink SBYDB00580" target="_blank" href="../SBYDB/manage_ps.htm#SBYDB00580"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> for information about tuning the log apply rate for a physical standby database.</p>
</li>
<li>
<p>See the <span class="italic">Oracle Maximum Availability Architecture</span> white papers at:</p>
<p><a href="http://www.oracle.com/goto/maa/" target="_blank"><code class="codeph">http://www.oracle.com/goto/maa</code></a></p>
</li>
</ul>
</li>
<li>
<p>When setting the <code class="codeph">FastStartFailoverLagLimit</code> configuration property, consider these tradeoffs between performance and potential data-loss:</p>
<ul style="list-style-type: disc;">
<li>
<p>A low lag limit will minimize data loss but may impact the performance of the primary database.</p>
</li>
<li>
<p>A high lag limit may lead to more data loss but may lessen the performance impact of the primary database.</p>
</li>
</ul>
</li>
</ul>
</div>
</div>
<a id="DGBKR3544"></a><a id="DGBKR394"></a>
<div class="props_rev_3"><a id="GUID-5E2A8696-38B4-4782-B8EF-95C0975CD7C6"></a>
<h3 id="DGBKR-GUID-5E2A8696-38B4-4782-B8EF-95C0975CD7C6" class="sect3"><span class="enumeration_section">5.5.7</span> Managing the Observer</h3>
<div>
<p>The observer is integrated in the DGMGRL client-side component of the broker and typically runs on a different computer from the primary or standby databases and from the computer where you manage the broker configuration. The observer continuously monitors the fast-start failover environment to ensure the primary database is available (described in <a href="sofo.htm#GUID-824C3FEF-9D1D-4AA7-9C7A-DBDBADC77F47">When Fast-Start Failover Is Enabled and the Observer Is Running</a>). The observer&#39;s main purpose is to enhance high availability and <span class="italic">lights out</span> computing by reducing the human intervention required by the manual failover process that can add minutes or hours to downtime.</p>
<p>You can manage the observer through either the Oracle Data Guard Overview pages in Cloud Control or using DGMGRL commands. <a href="sofo.htm#GUID-5E2A8696-38B4-4782-B8EF-95C0975CD7C6__BCGDGADE">Figure 5-2</a> shows the observer monitoring a fast-start failover configuration.</p>
<div class="figure" id="GUID-5E2A8696-38B4-4782-B8EF-95C0975CD7C6__BCGDGADE">
<p class="titleinfigure">Figure 5-2 The Observer in the Fast-Start Failover Environment</p>
<img width="477" height="243" src="img/GUID-22FFACA8-9B55-4710-BDD5-175182646E5A-default.gif" alt="Description of Figure 5-2 follows" title="Description of Figure 5-2 follows"/><br/>
<a href="img_text/GUID-22FFACA8-9B55-4710-BDD5-175182646E5A-print.htm">Description of &#34;Figure 5-2 The Observer in the Fast-Start Failover Environment&#34;</a></div>
<!-- class="figure" -->
<p>The following sections provide information about managing the observer:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="sofo.htm#GUID-11EF3897-8FCA-4A54-B63B-E8C1668AE21B">Installing and Starting the Observer</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-EDCB8EF3-1B69-483B-BFE5-8AE62B126E1D">Viewing Information About the Observer</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-50C2F974-E9F8-44A8-B4BE-5238A22A623C">What Happens if the Observer Fails?</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-4B70523D-7E11-445C-A585-502ED93CBAB2">Stopping the Observer</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-354F00F7-7B09-4EE3-9422-DD2F00A497D0">Moving the Observer to Another Computer</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-5544AF97-A37C-4F2E-9C72-DCF5FF591A0A">How the Observer Maintains Fast-Start Failover Configuration Information</a></p>
</li>
<li>
<p><a href="sofo.htm#GUID-2C8EF307-908F-4C3F-A6C1-AF995AA77947">Patching an Environment When the Observer Is Running and Fast-start Failover Is Enabled</a></p>
</li>
</ul>
</div>
<a id="DGBKR3721"></a><a id="DGBKR3415"></a>
<div class="props_rev_3"><a id="GUID-11EF3897-8FCA-4A54-B63B-E8C1668AE21B"></a>
<h4 id="DGBKR-GUID-11EF3897-8FCA-4A54-B63B-E8C1668AE21B" class="sect4"><span class="enumeration_section">5.5.7.1</span> Installing and Starting the Observer</h4>
<div>
<p>The observer should be installed and run on a computer system that is separate from the primary and standby systems. Installing and starting the observer is an integral part of using fast-start failover and is described in detail in these sections:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="install.htm#GUID-DBCAC77D-8B4D-4727-B89E-6CFA69302187">Oracle Data Guard Installation</a> explains that you can either install only the Oracle Client Administrator or you can install the complete Oracle Database Enterprise Edition or Personal Edition on the observer system.</p>
</li>
<li>
<p><a href="sofo.htm#GUID-D26D79F2-0093-4C0E-98CD-224A5C8CBFA4">Enabling Fast-Start Failover</a> describes how to start the observer as a part of the step-by-step process to enable fast-start failover. Examples of starting the observer using DGMGRL are included in <a href="cli.htm#GUID-AAE5EA1A-53A2-4D8D-BF59-A2856B38C99D">Scenario 6: Enabling Fast-Start Failover and Starting the Observer</a>.</p>
</li>
</ul>
<p>There can be only one observer monitoring the broker configuration. If you attempt to start another one, the broker returns the following error message:</p>
<pre dir="ltr">ORA-16647: could not start more than one observer
</pre>
<p>To start the observer, you must be able to log in to DGMGRL with an account that has the <code class="codeph">SYSDG</code> or <code class="codeph">SYSDBA</code> privilege. The observer is an OCI client that connects to the primary and target standby databases using the same <code class="codeph">SYS</code> credentials you used when you connected to the Oracle Data Guard configuration with DGMGRL.</p>
<div class="infoboxnotealso" id="GUID-11EF3897-8FCA-4A54-B63B-E8C1668AE21B__GUID-AC60B395-4F0B-44F9-B1A4-D5B40518E2A0">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p>The My Oracle Support note 1625597.1 at <a href="http://support.oracle.com" target="_blank"><code class="codeph">http://support.oracle.com</code></a> for information about compatibility requirements between the observer and DGMGRL</p>
</li>
</ul>
</div>
<div class="section">
<p class="subhead3">Starting Multiple Observers On a Single Host</p>
</div>
<!-- class="section" -->
<div class="section">
<p>If you want to use one Oracle home to start multiple observers, with each observer monitoring a different fast-start failover configuration, use the <code class="codeph">FILE</code> qualifier to specify a unique observer configuration file location for each configuration to be monitored. If you want to capture any logging generated by the observer, use the <code class="codeph">LOGFILE</code> option and ensure that file name is unique as well. For example:</p>
<pre dir="ltr">% dgmgrl -logfile $ORACLE_HOME/rdbms/log/config1.log
DGMGRL&gt; CONNECT /@primary1;
DGMGRL&gt; START OBSERVER FILE=$ORACLE_HOME/dbs/config1.dat;
 
% dgmgrl -logfile $ORACLE_HOME/rdbms/log/config2.log
DGMGRL&gt; CONNECT /@primary2;
DGMGRL&gt; START OBSERVER FILE=$ORACLE_HOME/dbs/config2.dat;
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DGBKR3545"></a><a id="DGBKR3416"></a>
<div class="props_rev_3"><a id="GUID-EDCB8EF3-1B69-483B-BFE5-8AE62B126E1D"></a>
<h4 id="DGBKR-GUID-EDCB8EF3-1B69-483B-BFE5-8AE62B126E1D" class="sect4"><span class="enumeration_section">5.5.7.2</span> Viewing Information About the Observer</h4>
<div>
<div class="section">
<p>You can find information about the observer by querying the following columns in the <code class="codeph">V$DATABASE</code> view:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">FS_FAILOVER_OBSERVER_HOST</code><a id="d12131e4342" class="indexterm-anchor"></a><a id="d12131e4346" class="indexterm-anchor"></a><a id="d12131e4350" class="indexterm-anchor"></a> shows the name of the computer on which the observer is running</p>
</li>
<li>
<p><code class="codeph">FS_FAILOVER_OBSERVER_PRESENT</code><a id="d12131e4359" class="indexterm-anchor"></a><a id="d12131e4363" class="indexterm-anchor"></a><a id="d12131e4367" class="indexterm-anchor"></a><a id="d12131e4371" class="indexterm-anchor"></a> shows whether or not the observer is connected to the local database</p>
</li>
</ul>
<div class="tblformal" id="GUID-EDCB8EF3-1B69-483B-BFE5-8AE62B126E1D__GUID-8031AB26-0FAB-4308-A066-D5D916E28F58">
<p class="titleintable">Table 5-2 FS_FAILOVER_OBSERVER_PRESENT Column of the V$DATABASE View</p>
<table class="cellalignment5461" title="FS_FAILOVER_OBSERVER_PRESENT Column of the V$DATABASE View" summary="This two column tables describes the possible values for the FS_FAILOVER_OBSERVER_PRESENT column in the V$DATABASE view. Column 1 is the value. Column 2 is a description of that value.">
<thead>
<tr class="cellalignment5445">
<th class="cellalignment5476" id="d12131e4386">Column Value(1)</th>
<th class="cellalignment5477" id="d12131e4395">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment5445">
<td class="cellalignment5478" id="d12131e4400" headers="d12131e4386">
<p><code class="codeph">YES</code></p>
</td>
<td class="cellalignment5479" headers="d12131e4400 d12131e4395">
<p>Observer is currently connected to the local database</p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5478" id="d12131e4408" headers="d12131e4386">
<p><code class="codeph">NO</code></p>
</td>
<td class="cellalignment5479" headers="d12131e4408 d12131e4395">
<p>Observer is not connected to the local database</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;1</sup> This value is consistent across instances in an Oracle Real Applications Clusters (Oracle RAC) environment. That is, if the observer is connected to any instance in the Oracle RAC, all instances will show a value of YES.</p>
<p>For example, to determine if fast-start failover can occur, the <code class="codeph">FS_FAILOVER_STATUS</code> column displays either <code class="codeph">SYNCHRONIZED</code> or <code class="codeph">TARGET UNDER LAG LIMIT</code> and the <code class="codeph">FS_FAILOVER_OBSERVER_PRESENT</code> column displays <code class="codeph">YES</code> for the target standby database. For example:</p>
<div class="tblformal" id="GUID-EDCB8EF3-1B69-483B-BFE5-8AE62B126E1D__GUID-E44B2782-E719-4AEE-9FB0-B40B52ACDFEA">
<table class="cellalignment5461" summary="Provides an example of the FS_FAILOVER_STATUS column and the FS_FAILOVER OBSERVER_PRESENT column when connectivity between the primary database and observer is broken.">
<thead>
<tr class="cellalignment5445">
<th class="cellalignment5513" id="d12131e4442">Database</th>
<th class="cellalignment5514" id="d12131e4445">FS_FAILOVER_STATUS</th>
<th class="cellalignment5480" id="d12131e4450">Protection Mode</th>
<th class="cellalignment5515" id="d12131e4453">FS_FAILOVER_OBSERVER_PRESENT</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment5445">
<td class="cellalignment5516" id="d12131e4460" headers="d12131e4442">
<p>Primary</p>
</td>
<td class="cellalignment5517" headers="d12131e4460 d12131e4445">
<p><code class="codeph">SYNCHRONIZED</code></p>
</td>
<td class="cellalignment5482" headers="d12131e4460 d12131e4450">
<p>Maximum Availability</p>
</td>
<td class="cellalignment5518" headers="d12131e4460 d12131e4453">
<p><code class="codeph">YES</code></p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5516" id="d12131e4475" headers="d12131e4442">
<p>Standby</p>
</td>
<td class="cellalignment5517" headers="d12131e4475 d12131e4445">
<p><code class="codeph">SYNCHRONIZED</code></p>
</td>
<td class="cellalignment5482" headers="d12131e4475 d12131e4450">
<p>Maximum Availability</p>
</td>
<td class="cellalignment5518" headers="d12131e4475 d12131e4453">
<p><code class="codeph">YES</code></p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5516" id="d12131e4490" headers="d12131e4442">
<p>Primary</p>
</td>
<td class="cellalignment5517" headers="d12131e4490 d12131e4445">
<p><code class="codeph">TARGET UNDER LAG LIMIT</code></p>
</td>
<td class="cellalignment5482" headers="d12131e4490 d12131e4450">
<p>Maximum Performance</p>
</td>
<td class="cellalignment5518" headers="d12131e4490 d12131e4453">
<p><code class="codeph">YES</code></p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5516" id="d12131e4505" headers="d12131e4442">
<p>Standby</p>
</td>
<td class="cellalignment5517" headers="d12131e4505 d12131e4445">
<p><code class="codeph">TARGET UNDER LAG LIMIT</code></p>
</td>
<td class="cellalignment5482" headers="d12131e4505 d12131e4450">
<p>Maximum Performance</p>
</td>
<td class="cellalignment5518" headers="d12131e4505 d12131e4453">
<p><code class="codeph">YES</code></p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>In the following example, assume the network between the primary database and the observer has failed. In this case, the <code class="codeph">FS_FAILOVER_STATUS</code> and <code class="codeph">FS_FAILOVER_OBSERVER_PRESENT</code> columns will appear as shown in the following table and fast-start failover will not occur:</p>
<div class="tblformal" id="GUID-EDCB8EF3-1B69-483B-BFE5-8AE62B126E1D__GUID-2B1F5C99-B747-41C8-BF35-853AD1A84716">
<table class="cellalignment5461" summary="Provides an example of the FS_FAILOVER_STATUS column and the FS_FAILOVER OBSERVER_PRESENT column when connectivity between the primary database and observer is broken.">
<thead>
<tr class="cellalignment5445">
<th class="cellalignment5519" id="d12131e4536">Database</th>
<th class="cellalignment5498" id="d12131e4539">FS_FAILOVER_STATUS</th>
<th class="cellalignment5520" id="d12131e4544">FS_FAILOVER_OBSERVER_PRESENT</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment5445">
<td class="cellalignment5521" id="d12131e4551" headers="d12131e4536">
<p>Primary</p>
</td>
<td class="cellalignment5500" headers="d12131e4551 d12131e4539">
<p><code class="codeph">SYNCHRONIZED</code></p>
</td>
<td class="cellalignment5522" headers="d12131e4551 d12131e4544">
<p><code class="codeph">NO</code></p>
</td>
</tr>
<tr class="cellalignment5445">
<td class="cellalignment5521" id="d12131e4563" headers="d12131e4536">
<p>Standby</p>
</td>
<td class="cellalignment5500" headers="d12131e4563 d12131e4539">
<p><code class="codeph">PRIMARY UNOBSERVED</code></p>
</td>
<td class="cellalignment5522" headers="d12131e4563 d12131e4544">
<p><code class="codeph">YES</code></p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
<!-- class="section" --></div>
</div>
<a id="DGBKR3417"></a>
<div class="props_rev_3"><a id="GUID-50C2F974-E9F8-44A8-B4BE-5238A22A623C"></a>
<h4 id="DGBKR-GUID-50C2F974-E9F8-44A8-B4BE-5238A22A623C" class="sect4"><span class="enumeration_section">5.5.7.3</span> What Happens if the Observer Fails?</h4>
<div>
<p>If the primary and target standby databases stay connected but the connection to the observer is lost, then the broker reports that the configuration is not observed<a id="d12131e4597" class="indexterm-anchor"></a><a id="d12131e4599" class="indexterm-anchor"></a><a id="d12131e4603" class="indexterm-anchor"></a><a id="d12131e4607" class="indexterm-anchor"></a><a id="d12131e4611" class="indexterm-anchor"></a>. The configuration and database status report that the observer is not running and return one of the following status messages:</p>
<pre dir="ltr">ORA-16658: unobserved fast-start failover configuration
ORA-16820: fast-start failover observer is no longer observing this database
</pre>
<p>While the configuration is in the unobserved state, fast-start failover cannot happen. Therefore, the primary database can continue processing transactions, even if the target standby database fails. The configuration status returns the <code class="codeph">SUCCESS</code> status after the observer reestablishes its connection to the primary database, which then notifies the target standby database.</p>
<div class="infoboxnotealso" id="GUID-50C2F974-E9F8-44A8-B4BE-5238A22A623C__GUID-F432C66E-CE7E-4659-8684-4B56EE992317">
<p class="notep1">See Also:</p>
<p><a href="sofo.htm#GUID-47C45F0E-ABFA-40D7-83E8-5CCCEED524E5">Viewing Fast-Start Failover Configuration Statistics and Status</a></p>
</div>
<div class="section">
<p class="subhead3">Making the Observer Highly Available</p>
<p>Oracle Enterprise Manager Cloud Control (Cloud Control) supports automatic restart of the observer on the same host if it detects that the observer process has failed. This automatic restart ability is activated whenever fast-start failover is enabled.</p>
<p>Cloud Control also supports automatic restart of the observer on an alternate host if the first host fails. Refer to the Cloud Control online help for information about how to designate an alternate observer host.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR3860"></a>
<div class="props_rev_3"><a id="GUID-DF791395-CE3C-4086-8B43-3B0F4377A581"></a>
<h4 id="DGBKR-GUID-DF791395-CE3C-4086-8B43-3B0F4377A581" class="sect4"><span class="enumeration_section">5.5.7.4</span> Managing Observer&#39;s Connection to the Primary</h4>
<div>
<p>The <code class="codeph">ObserverOverride</code> and <code class="codeph">ObserverReconnect</code> properties allow you additional control over the connection to the primary.</p>
<p>When the observer loses its connection to the primary database for a period of time greater than that specified by the <code class="codeph">FastStartFailoverThreshold</code> property, it attempts a failover to the standby database. However, if the standby has had contact from the primary within the period of time specified by the <code class="codeph">FastStartFailoverThreshold</code> property, the standby prevents the failover attempt.</p>
<p>To override this behavior and allow a fast-start failover to occur if the observer is unable to contact the primary for more than <code class="codeph">FastStartFailoverThreshold</code> seconds, set the <code class="codeph">ObserverOverride</code> property to <code class="codeph">TRUE</code>. For example:</p>
<pre dir="ltr">DGMGRL&gt; EDIT CONFIGURATION SET PROPERTY ObserverOverride=TRUE;
</pre>
<p>Ordinarily the observer connects once to the primary and does not attempt to reconnect unless the connection has failed. However, if you want the observer to reconnect to the primary database periodically as a means of testing the health of the network connection to the primary, then use the <code class="codeph">ObserverReconnect</code> configuration property. This specifies how often the observer establishes a new connection to the primary database. In the following example, <code class="codeph">ObserverReconnect</code> is set to 30 seconds. This results in the observer establishing a new connection to the primary database every 30 seconds.</p>
<pre dir="ltr">DGMGRL&gt; EDIT CONFIGURATION SET PROPERTY ObserverReconnect=30;
</pre></div>
</div>
<a id="DGBKR3418"></a>
<div class="props_rev_3"><a id="GUID-4B70523D-7E11-445C-A585-502ED93CBAB2"></a>
<h4 id="DGBKR-GUID-4B70523D-7E11-445C-A585-502ED93CBAB2" class="sect4"><span class="enumeration_section">5.5.7.5</span> Stopping the Observer</h4>
<div>
<div class="section">
<p>You may want to stop the observer when you no longer want to use fast-start failover (see <a href="sofo.htm#GUID-67878B37-39B5-402A-A219-69E7483405A1">Disabling Fast-Start Failover</a>) or if you want to move the observer to a different host machine (see <a href="sofo.htm#GUID-354F00F7-7B09-4EE3-9422-DD2F00A497D0">Moving the Observer to Another Computer</a>).</p>
<p>To stop the observer when fast-start failover <span class="italic">is enabled</span>, the primary database and target standby database must be connected and communicating with each other. Stopping the observer does not disable fast-start failover. However, fast-start failover cannot occur when the target standby database is in the unobserved state.</p>
<p>To stop the observer when fast-start failover <span class="italic">is enabled</span>, but the primary and standby are isolated from each other, you must first disable fast-start failover by using the <code class="codeph">FORCE</code> option, and then stop the observer. (See <a href="sofo.htm#GUID-67878B37-39B5-402A-A219-69E7483405A1">Disabling Fast-Start Failover</a> for important considerations when using the <code class="codeph">FORCE</code> option.)</p>
<p>To stop the observer when fast-start failover <span class="italic">is not enabled</span>, the primary database must be running.You can stop the observer while connected to any database in the broker configuration that has network connectivity to the primary database, as follows:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Using Cloud Control</p>
<p>Choose the <span class="bold">Stop Observer</span> option on the first page of the fast-start failover wizard and click <span class="bold">Continue</span> at the bottom of the page. See the Cloud Control online help for more information.</p>
</li>
<li>
<p>Using DGMGRL</p>
<p>Issue the following command:</p>
<pre dir="ltr">DGMGRL&gt; STOP OBSERVER;
</pre>
<p>See the <a href="dgmgrl.htm#GUID-F9D213F3-12FA-4890-9AD7-A3000D344F3E">STOP OBSERVER</a> command for more information.</p>
<div class="infobox-note" id="GUID-4B70523D-7E11-445C-A585-502ED93CBAB2__GUID-368DAA3A-9216-4AFD-92A3-3B880A9B6D9C">
<p class="notep1">Note:</p>
<p>The observer does not stop immediately when you issue the <code class="codeph">STOP OBSERVER</code> command. After the broker receives the <code class="codeph">STOP OBSERVER</code> request, the request is passed to the observer the next time the observer contacts the broker, and the observer then stops itself.</p>
</div>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR3419"></a>
<div class="props_rev_3"><a id="GUID-354F00F7-7B09-4EE3-9422-DD2F00A497D0"></a>
<h4 id="DGBKR-GUID-354F00F7-7B09-4EE3-9422-DD2F00A497D0" class="sect4"><span class="enumeration_section">5.5.7.6</span> Moving the Observer to Another Computer</h4>
<div>
<div class="section">
<p>To move the observer to another computer:</p>
</div>
<!-- class="section" -->
<ol>
<li><span>Stop the observer from any computer system in the broker configuration, as described in <a href="sofo.htm#GUID-4B70523D-7E11-445C-A585-502ED93CBAB2">Stopping the Observer</a>.</span></li>
<li><span>Start the observer on the new computer system, as described in Step 8 of <a href="sofo.htm#GUID-D26D79F2-0093-4C0E-98CD-224A5C8CBFA4">Enabling Fast-Start Failover</a>.</span></li>
</ol>
<div class="section">
<p>There is no need to disable fast-start failover when you move the observer.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR3420"></a>
<div class="props_rev_3"><a id="GUID-5544AF97-A37C-4F2E-9C72-DCF5FF591A0A"></a>
<h4 id="DGBKR-GUID-5544AF97-A37C-4F2E-9C72-DCF5FF591A0A" class="sect4"><span class="enumeration_section">5.5.7.7</span> How the Observer Maintains Fast-Start Failover Configuration Information</h4>
<div>
<p>The observer persistently maintains information about the fast-start failover configuration in a binary file created in the working directory where you started the observer. By default, the observer creates this file in the current working directory when it is started and names the file <code class="codeph">fsfo.dat</code>. This file contains connect identifiers to both the primary and the target standby databases.</p>
<p>Ensure this file cannot be read by unauthorized users.</p>
<p>Once the observer is started, you cannot change the file&#39;s name and location. However, you can change the name or the location of the file if you start the observer using the DGMGRL <code class="codeph">START OBSERVER</code> command and include the <code class="codeph">FILE IS</code> qualifier. See the <a href="dgmgrl.htm#GUID-8AADB389-6E31-46D6-AB1C-4FBB8EB6C411">START OBSERVER</a> command for more information.</p>
<div class="infobox-note" id="GUID-5544AF97-A37C-4F2E-9C72-DCF5FF591A0A__GUID-73B1F59D-3672-4F28-B42C-2F706D58613B">
<p class="notep1">Note:</p>
<p>If the observer is stopped abnormally (for example, by typing <code class="codeph">CTRL/C</code>), restart it and reference the existing <code class="codeph">fsfo.dat</code> file with the <code class="codeph">FILE IS</code> qualifier.</p>
</div>
</div>
</div>
<a id="DGBKR3936"></a>
<div class="props_rev_3"><a id="GUID-2C8EF307-908F-4C3F-A6C1-AF995AA77947"></a>
<h4 id="DGBKR-GUID-2C8EF307-908F-4C3F-A6C1-AF995AA77947" class="sect4"><span class="enumeration_section">5.5.7.8</span> Patching an Environment When the Observer Is Running and Fast-start Failover Is Enabled</h4>
<div>
<div class="section">
<p>To patch an environment where the Observer is running and fast-start failover is enabled, follow these steps prior to applying the patch:</p>
<ol>
<li>
<p>Stop the observer using the DGMGRL <code class="codeph">STOP</code> <code class="codeph">OBSERVER</code> command. The primary and target standby must have connectivity for this command to complete successfully.</p>
</li>
<li>
<p>Disable fast-start failover using the DGMGRL <code class="codeph">DISABLE</code> <code class="codeph">FAST_START</code> <code class="codeph">FAILOVER</code> command. Note the primary and target standby must have connectivity for this command to complete successfully.</p>
</li>
</ol>
<p>After the patch has been successfully applied to all databases, take the following steps to enable fast-start failover and start the observer.</p>
</div>
<!-- class="section" -->
<ol>
<li><span>Enable fast-start failover using the DGMGRL <code class="codeph">ENABLE</code> <code class="codeph">FAST_START</code> <code class="codeph">FAILOVER</code> command. The primary and target standby must have connectivity for this command to complete successfully.</span></li>
<li><span>Start the observer using the DGMGRL <code class="codeph">START</code> <code class="codeph">OBSERVER</code> command.</span></li>
</ol>
</div>
</div>
</div>
<a id="DGBKR395"></a>
<div class="props_rev_3"><a id="GUID-319C443F-4386-49B1-A0FC-9C4166D061CA"></a>
<h3 id="DGBKR-GUID-319C443F-4386-49B1-A0FC-9C4166D061CA" class="sect3"><span class="enumeration_section">5.5.8</span> Reinstating the Former Primary Database in the Broker Configuration</h3>
<div>
<p>If a fast-start failover was initiated because the primary database had crashed or lost connectivity with the observer and target standby database, the observer automatically attempts to <span class="italic">reinstate</span> the former primary database as a standby database, if the <code class="codeph">FastStartFailoverAutoReinstate</code> configuration property is set to <code class="codeph">TRUE</code>. <span class="bold">Reinstatement</span> restores high availability to the broker configuration so that, in the event of a failure of the new primary database, another fast-start failover can occur. The reinstated database acts as the fast-start failover target for the new primary database, making a subsequent fast-start failover possible. The new standby database is a viable target of a failover when it begins receiving redo data received from the new primary database.</p>
<p>To allow the observer to automatically reinstate the former primary database, the database must be started and mounted, but it cannot be opened. The observer will restart the former primary database to the mounted state if it is open, prior to reinstating the database. The broker reinstates the database as a standby database of the same type as the former standby database of the new primary database.</p>
<p>If the former primary database cannot be reinstated automatically, you can manually reinstate it using either the DGMGRL <code class="codeph">REINSTATE</code> command or Cloud Control. Step-by-step instructions for manual reinstatement are described in <a href="sofo.htm#GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D">Reenabling Disabled Databases After a Role Change</a>.</p>
</div>
<a id="DGBKR3421"></a>
<div class="props_rev_3"><a id="GUID-05BB6664-5DDD-4B07-B076-79BB7BBCED2B"></a>
<h4 id="DGBKR-GUID-05BB6664-5DDD-4B07-B076-79BB7BBCED2B" class="sect4"><span class="enumeration_section">5.5.8.1</span> Requirements</h4>
<div>
<p>Reinstatement is supported only after failover in a broker configuration. It also requires Flashback Database to be enabled on both the primary and target standby databases. <a href="sofo.htm#GUID-7EAF1865-2F92-4451-8565-D3C6EC4F8005">Prerequisites for Enabling Fast-Start Failover</a> provides complete information about all of the fast-start failover and reinstatement requirements.</p>
</div>
</div>
<a id="DGBKR3422"></a>
<div class="props_rev_3"><a id="GUID-B6311A77-B9C9-4A54-AED0-94C373357973"></a>
<h4 id="DGBKR-GUID-B6311A77-B9C9-4A54-AED0-94C373357973" class="sect4"><span class="enumeration_section">5.5.8.2</span> Restrictions on Reinstatement</h4>
<div>
<p>The broker cannot automatically reinstate the former primary database if:</p>
<ul style="list-style-type: disc;">
<li>
<p>A fast-start failover occurred because a user-configurable condition was detected or was requested by an application by calling the <code class="codeph">DBMS_DG.INITIATE_FS_FAILOVER</code> function.</p>
</li>
<li>
<p><code class="codeph">FastStartFailoverAutoReinstate</code> is set to <code class="codeph">FALSE</code></p>
</li>
<li>
<p>Another failover or switchover occurred <span class="italic">after</span> the fast-start failover completed but <span class="italic">before</span> the former primary database restarted</p>
</li>
<li>
<p>Fast-start failover was disabled</p>
</li>
<li>
<p>The observer cannot connect to the former primary database</p>
</li>
<li>
<p>The former primary database cannot connect to the new primary database</p>
</li>
<li>
<p>The former primary database and the new primary database are not configured in the same fast-start failover environment</p>
</li>
<li>
<p>The former primary database was disabled because of a manual failover when fast-start failover was disabled</p>
<div class="infobox-note" id="GUID-B6311A77-B9C9-4A54-AED0-94C373357973__GUID-4BE58E77-82E3-4795-9A2F-D6F031E33907">
<p class="notep1">Note:</p>
<p>Standby databases that are disabled during switchover, manual failover, or fast-start failover will not be automatically reinstated.</p>
</div>
</li>
</ul>
<p>If automatic reinstatement fails, the broker will log errors and the former primary database will remain in the mounted state. At this point, you can either:</p>
<ul style="list-style-type: disc;">
<li>
<p>Disable fast-start failover (described in <a href="sofo.htm#GUID-67878B37-39B5-402A-A219-69E7483405A1">Disabling Fast-Start Failover</a>) and attempt to open the former primary database</p>
</li>
<li>
<p>Manually reinstate the former primary database, as described in <a href="sofo.htm#GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D">Reenabling Disabled Databases After a Role Change</a></p>
</li>
</ul>
</div>
</div>
<a id="DGBKR3423"></a>
<div class="props_rev_3"><a id="GUID-A8921D04-D4E3-4C4F-8441-FFAA279F7835"></a>
<h4 id="DGBKR-GUID-A8921D04-D4E3-4C4F-8441-FFAA279F7835" class="sect4"><span class="enumeration_section">5.5.8.3</span> How the Broker Handles a Failed Reinstatement</h4>
<div>
<p>If a failure occurs once a reinstatement operation (automatic or manual) is underway, the broker logs the appropriate information in the broker configuration files and <a id="d12131e5158" class="indexterm-anchor"></a><a id="d12131e5162" class="indexterm-anchor"></a><a id="d12131e5166" class="indexterm-anchor"></a>broker log files. The former primary database is disabled. Most in-progress failures cannot be restarted (for example, archived redo log file corruption on the primary database). You must manually re-create the database as a standby database and then reenable it.</p>
<div class="infoboxnotealso" id="GUID-A8921D04-D4E3-4C4F-8441-FFAA279F7835__GUID-46F7B537-3907-468D-AB83-C6AA64891507">
<p class="notep1">See Also:</p>
<p><a href="sofo.htm#GUID-CA638065-9E57-420F-852B-D05065B6DE24">How to Re-create and Reenable a Disabled Database</a></p>
</div>
</div>
</div>
</div>
<a id="DGBKR3424"></a>
<div class="props_rev_3"><a id="GUID-350624B9-ABAD-4894-89AE-7431D52D3818"></a>
<h3 id="DGBKR-GUID-350624B9-ABAD-4894-89AE-7431D52D3818" class="sect3"><span class="enumeration_section">5.5.9</span> Shutting Down Databases In a Fast-Start Failover Environment</h3>
<div>
<div class="section">
<p>Perform the following steps if you need to shut down the primary or target standby database:</p>
</div>
<!-- class="section" -->
<ol>
<li><span>Stop the o<a id="d12131e5204" class="indexterm-anchor"></a>bserver and wait for the <code class="codeph">FS_FAILOVER_OBSERVER_PRESENT</code> column in the <code class="codeph">V$DATABASE</code> fixed view to contain the value &#34;<code class="codeph">NO</code>&#34; for both the primary and target standby databases. This ensures that a fast-start failover will not occur while you are shutting down the primary database.</span></li>
<li><span>Shut down the primary database and the target standby database using either DGMGRL <code class="codeph">SHUTDOWN</code> command or the SQL*Plus <code class="codeph">SHUTDOWN</code> statement.</span></li>
</ol>
<div class="section">
<p>When <a id="d12131e5230" class="indexterm-anchor"></a><a id="d12131e5236" class="indexterm-anchor"></a><a id="d12131e5240" class="indexterm-anchor"></a>restarting the databases, you may restart them in any order. When both databases have been restarted, you may restart the observer.</p>
<p>Bystander standby databases can be shut down at any time in any order without impacting fast-start failover.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="DGBKR3425"></a>
<div class="props_rev_3"><a id="GUID-790C40A3-B712-4AEB-B70E-1B7987C6315C"></a>
<h2 id="DGBKR-GUID-790C40A3-B712-4AEB-B70E-1B7987C6315C" class="sect2"><span class="enumeration_section">5.6</span> Database Client Considerations</h2>
<div>
<p>This section describes the event notification and database connection failover support that is available to database clients connected to local database services when a broker-managed failover occurs. For information about event notification and database connection failover support for global services, see the <a class="olink GSMUG123" target="_blank" href="../GSMUG/intro.htm#GSMUG123"><span class="italic">Oracle Database Global Data Services Concepts and Administration Guide</span></a>.</p>
<p>After a failover, the broker publishes Fast Application Notification (FAN) events. These FAN events can be used in the following ways:</p>
<ul style="list-style-type: disc;">
<li>
<p>Applications can use FAN without programmatic changes if they use one of these Oracle integrated database clients: Oracle Database JDBC, Oracle Database Oracle Call Interface (OCI), Oracle Data Provider for .NET ( ODP.NET), or Universal Connection Pool for Java. These clients can be configured for Fast Connection Failover (FCF) to automatically connect to a new primary database after a failover.</p>
</li>
<li>
<p>JAVA applications can use FAN programmatically by using the JDBC FAN application programming interface to subscribe to FAN events and to execute event handling actions upon the receipt of an event.</p>
</li>
<li>
<p>FAN server-side callouts can be configured on the database tier.</p>
</li>
</ul>
<p>FAN events are published using Oracle Notification Services (ONS) for all Oracle integrated database clients in Oracle Database 12c and later. In previous releases, OCI and ODP.NET clients receive FAN notifications via Oracle Advanced Queuing (AQ).</p>
<div class="infobox-note" id="GUID-790C40A3-B712-4AEB-B70E-1B7987C6315C__GUID-6A2DEF78-1B69-4A99-89B0-47BAF4AC0F70">
<p class="notep1">Note:</p>
<p>A single-instance database must be registered with Oracle Restart in order to publish FAN events via ONS.</p>
</div>
<div class="infoboxnotealso" id="GUID-790C40A3-B712-4AEB-B70E-1B7987C6315C__GUID-8E2591C6-B494-4B25-A536-173A942D7F59">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink RACAD7128" target="_blank" href="../RACAD/GUID-EB0E1525-D3B3-469C-BE22-A569C76864A6.htm#RACAD7128"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for more information about configuring FAN, FCF, and ONS on an Oracle Real Application Clusters (Oracle RAC) database</p>
</li>
<li>
<p><a class="olink ADMIN12721" target="_blank" href="../ADMIN/restart.htm#ADMIN12721"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about configuring Oracle Restart, FAN, FCF, and ONS on a single-instance database</p>
</li>
</ul>
</div>
</div>
<a id="DGBKR3546"></a>
<div class="props_rev_3"><a id="GUID-DFFDAA2B-A889-49AD-AB85-747D73FF0FF5"></a>
<h3 id="DGBKR-GUID-DFFDAA2B-A889-49AD-AB85-747D73FF0FF5" class="sect3"><span class="enumeration_section">5.6.1</span> Oracle Data Guard Specific FAN and FCF Configuration Requirements</h3>
<div>
<p>This section describes configuration requirements that must be met in order to publish and properly handle FAN events generated as the result of a broker-managed failover.</p>
<p>These requirements are supplemental to those described in the documents previously referenced and in the following client-specific guides:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink JJDBC20000" target="_blank" href="../JJDBC/getsta.htm#JJDBC20000"><span class="italic">Oracle Database JDBC Developer&#39;s Guide</span></a></p>
</li>
<li>
<p><a class="olink LNOCI020" target="_blank" href="../LNOCI/oci02bas.htm#LNOCI020"><span class="italic">Oracle Call Interface Programmer&#39;s Guide</span></a></p>
</li>
<li>
<p><a class="olink ODPNT130" target="_blank" href="../ODPNT/intro002.htm#ODPNT130"><span class="italic">Oracle Data Provider for .NET Developer&#39;s Guide for Microsoft Windows</span></a></p>
</li>
</ul>
</div>
<a id="DGBKR3547"></a>
<div class="props_rev_3"><a id="GUID-47350552-679A-4567-82DC-A316F7DE3FA2"></a>
<h4 id="DGBKR-GUID-47350552-679A-4567-82DC-A316F7DE3FA2" class="sect4"><span class="enumeration_section">5.6.1.1</span> Oracle Net Configuration Requirements</h4>
<div>
<div class="section">
<p>For FCF to occur, a client must be able to locate the new primary database after a failover. This section describes how to configure an Oracle Net connect descriptor that meets this requirement.</p>
<p>The connect descriptor can be configured in one of two ways:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Configure the connect descriptor for connect-time failover. Add the primary database and each standby database to the address list. Set the <code class="codeph">CONNECT_TIMEOUT</code> parameter to a small value to minimize the delay experienced if a network address is not available. Increase the value of this parameter if resource contention causes connection timeouts to occur during normal operation.</span>
<div>
<p>For example:</p>
<pre dir="ltr">sales =
          (DESCRIPTION= 
            (FAILOVER=ON)
            (CONNECT_TIMEOUT=5)
            (ADDRESS_LIST=
              (ADDRESS=(HOST=boston-scan)(PORT=1521))
              (ADDRESS=(HOST=dallas-scan)(PORT=1521)))
            (CONNECT_DATA=(SERVICE_NAME=sales)))
</pre></div>
</li>
<li class="stepexpand"><span>Configure the connect descriptor with a single network name that is registered with a global naming service such as DNS or LDAP. Create a trigger based on the <code class="codeph">DB_ROLE_CHANGE</code> system event that changes the network address associated with the network name to the network address of the new primary database after a failover.</span>
<div>
<div class="infoboxnotealso" id="GUID-47350552-679A-4567-82DC-A316F7DE3FA2__GUID-A4F2387C-C35F-4C35-83BF-03E126F4EB0E">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink LNPLS20141" target="_blank" href="../LNPLS/triggers.htm#LNPLS20141"><span class="italic">Oracle Database PL/SQL Language Reference</span></a> for more information about the <code class="codeph">DB_ROLE_CHANGE</code> system event</p>
</li>
</ul>
</div>
</div>
</li>
</ol>
<div class="section">
<p>The connect descriptor must contain the <code class="codeph">SERVICE_NAME</code> parameter in either case.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR3548"></a>
<div class="props_rev_3"><a id="GUID-05918DD1-FB0F-435B-873B-A43BEC1C7638"></a>
<h4 id="DGBKR-GUID-05918DD1-FB0F-435B-873B-A43BEC1C7638" class="sect4"><span class="enumeration_section">5.6.1.2</span> Database Service Configuration Requirements</h4>
<div>
<div class="infobox-note" id="GUID-05918DD1-FB0F-435B-873B-A43BEC1C7638__GUID-F77BB3A9-2967-468F-9BDB-B2A904222227">
<p class="notep1">Note:</p>
<p>The examples shown in this section do not necessarily show the specific attributes you might need to use in your own environment. The required attributes vary depending on your configuration (including whether your environment is Oracle RAC-based or single-instance). Refer to the appropriate Oracle RAC or Oracle Restart documentation for further information.</p>
</div>
<p>Database services can be configured to be active in specific database roles on Oracle RAC databases and on single-instance databases managed by Oracle Restart. The broker interacts with Oracle Clusterware or Oracle Restart to ensure that the appropriate database services are active and that the appropriate FAN events are published after a role change.</p>
<p>FAN events are always published through ONS. However, the event notifying a failover is only published for database services that have been configured to be active while the database is in the primary role on the new primary database.</p>
<p>Services that must be active in any given database role (primary, physical standby, logical standby, or snapshot standby) must be configured with the Server Control utility (SRVCTL) explicitly on each database where the service must be active. In the following example commands, a service named <code class="codeph">PAYROLL</code> is configured to be active in the <code class="codeph">PRIMARY</code> role on the primary database <code class="codeph">NORTH</code>. The service is then configured to be active in the <code class="codeph">PRIMARY</code> role on the standby database <code class="codeph">SOUTH</code>, so that it will be active on that database after a role transition. In these sample commands, the ellipse (...) signifies any other <code class="codeph">add service</code> options you wish to supply.</p>
<p>On primary database <code class="codeph">NORTH</code>, execute the following:</p>
<pre dir="ltr">srvctl add service &ndash;db NORTH &ndash;service PAYROLL &ndash;role PRIMARY ...
</pre>
<p>On standby database <code class="codeph">SOUTH</code>, execute the following:</p>
<pre dir="ltr">srvctl add service &ndash;db SOUTH &ndash;service PAYROLL &ndash;role PRIMARY ...
</pre>
<p>Services that are to be active while the database is in the physical standby role must also be created and started on the current primary database regardless of whether the service will be started on that database or not. This is to ensure that the service definition gets propagated to the physical standby database via the redo stream and thus allows for the service to be started on the physical standby database. The service can be started on the physical standby only after the redo generated by starting the service has been applied. It is important that all SRVCTL <code class="codeph">add</code> <code class="codeph">service</code> options be identical on all the databases so that the services behave the same way before and after a role change.</p>
<p>If all the databases do not have the same values, SRVCTL attempts to override the values, which will fail on the physical standby database because it is open read-only. In the following example, a service named <code class="codeph">sales</code> is configured to be active in the <code class="codeph">PHYSICAL_STANDBY</code> role on the primary database <code class="codeph">NORTH</code>. It is then started and stopped on the primary database. It could optionally also be removed from the primary database if there is no intention to ever run this service on the current primary database. It is then configured to be active in the <code class="codeph">PHYSICAL_STANDBY</code> role on the physical standby database <code class="codeph">SOUTH</code>.</p>
<p>Execute the following on primary database <code class="codeph">NORTH</code>:</p>
<pre dir="ltr">srvctl add service -db NORTH -service SALES -role PHYSICAL_STANDBY ...

srvctl start service &ndash;db NORTH &ndash;service SALES

srvctl stop service &ndash;db NORTH &ndash;service SALES
</pre>
<p>Execute the following on the physical standby database <code class="codeph">SOUTH</code>:</p>
<pre dir="ltr">srvctl add service -db SOUTH -service SALES -role PHYSICAL_STANDBY ...
</pre>
<p>If the broker now performs a switchover or failover, it automatically starts the <code class="codeph">SALES</code> service on the correct database, based on the database&#39;s role.</p>
<p>The previous examples dealt with setting up only one service on a database. The following example shows you how to set up more than one service on a database and how using the broker ensures that the correct service starts on the correct database.</p>
<p>Suppose you have a primary database, <code class="codeph">BOSTON</code>, and a standby database, <code class="codeph">CHICAGO</code>. Issue the following SRVCTL commands so that both databases in the Data Guard configuration know about the two potential services for each database:</p>
<p>On <code class="codeph">BOSTON</code></p>
<pre dir="ltr">srvctl add service -db BOSTON -service SALESRW  -role PRIMARY -y AUTOMATIC
srvctl add service -db BOSTON  -service SALESRO  -role PHYSICAL_STANDBY -policy AUTOMATIC
</pre>
<p>On <code class="codeph">CHICAGO</code>:</p>
<pre dir="ltr">srvctl add service -db CHICAGO  -s SALESRW  -role PRIMARY -y AUTOMATIC
srvctl add service -db CHICAGO  -s SALESRO  -role PHYSICAL_STANDBY -policy AUTOMATIC
</pre>
<p>To start things up initially, you must manually start the services on the right node. You must also start and stop the <code class="codeph">SALESRO</code> service on the primary so that it can be started on the standby. Issue the following SRVCTL commands:</p>
<p>On <code class="codeph">BOSTON</code>:</p>
<pre dir="ltr">srvctl start service -db BOSTON -service SALESRW
srvctl start service -db BOSTON -service SALESRO
srvctl stop service -db BOSTON -service SALESRO
</pre>
<p>On <code class="codeph">CHICAGO</code>:</p>
<pre dir="ltr">srvctl start service -db CHICAGO -service SALESRO
</pre>
<p>Now the correct services are running on the correct databases.</p>
<p>If the broker performs a switchover or failover, then it starts the service <code class="codeph">SALESRW</code> or <code class="codeph">SALESRO</code> based on the current role of the database. So <code class="codeph">SALESRW</code> will start on <code class="codeph">CHICAGO</code> (which is now the primary) and <code class="codeph">SALESRO</code> will start on <code class="codeph">BOSTON</code> (which is now the physical standby). The same thing happens if a shutdown and startup of either database occurs - the service that is started is the one that matches the role of the database being started.</p>
<p>Be aware that if you issue the following manual commands on either of those databases, then both the <code class="codeph">SALESRO</code> and <code class="codeph">SALESRW</code> services would be started on the databases regardless of what you may have earlier specified with the SRVCTL -<code class="codeph">role</code> qualifier. This is because the -<code class="codeph">role</code> qualifier is taken into account only by Data Guard broker, and at database startup.</p>
<p>On <code class="codeph">BOSTON</code>:</p>
<pre dir="ltr">srvctl start service -db CHICAGO
</pre>
<p>On <code class="codeph">CHICAGO</code>:</p>
<pre dir="ltr">srvctl start service -db BOSTON
</pre>
<p>The SRVCTL utility does not automatically take the database role into account, so any time you start a service manually, you must specify the name(s) of the service you want started.</p>
<div class="infobox-note" id="GUID-05918DD1-FB0F-435B-873B-A43BEC1C7638__GUID-CA4443C9-B16B-445D-929C-E1167B85CD51">
<p class="notep1">Note:</p>
<p>If the service has been configured to start automatically (<code class="codeph">-policy AUTOMATIC</code>), then the service will automatically start only after a database role change.</p>
</div>
<div class="infobox-note" id="GUID-05918DD1-FB0F-435B-873B-A43BEC1C7638__GUID-18690383-DF19-43C4-B68D-92C17301234D">
<p class="notep1">Note:</p>
<p>In an Oracle Data Guard configuration, the SRVCTL <code class="codeph">-startoption</code> for a standby database is always set to <code class="codeph">OPEN</code> after a switchover.</p>
</div>
<div class="infoboxnotealso" id="GUID-05918DD1-FB0F-435B-873B-A43BEC1C7638__GUID-F4262129-FED3-488C-AD6D-B59F0C2271B1">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p>For single-instance databases managed by Oracle Restart, see <a class="olink ADMIN12927" target="_blank" href="../ADMIN/restart.htm#ADMIN12927"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for more information about configuring database services with the SRVCTL utility</p>
</li>
<li>
<p>For Oracle RAC databases, see <a class="olink RACAD7737" target="_blank" href="../RACAD/GUID-6BC01F04-C46F-47BD-9AAC-CFA88F3D5911.htm#RACAD7737"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for more information about configuring database services with the SRVCTL utility</p>
</li>
</ul>
</div>
</div>
</div>
<a id="DGBKR3549"></a>
<div class="props_rev_3"><a id="GUID-28A09260-5225-4C71-983A-ED99B5329CB2"></a>
<h4 id="DGBKR-GUID-28A09260-5225-4C71-983A-ED99B5329CB2" class="sect4"><span class="enumeration_section">5.6.1.3</span> ONS Configuration Requirements</h4>
<div>
<p>If client-side ONS configuration is used, the client-side ONS configuration file must specify the hostname and port of the ONS daemon(s) of the primary database and each standby database.</p>
<p>If the client uses remote ONS subscription, the client must specify the hostname and port of the ONS daemon(s) of the primary database and each standby database.</p>
</div>
</div>
<a id="DGBKR3926"></a>
<div class="props_rev_3"><a id="GUID-84302AF8-2D6D-436C-AEC9-CD36D76C9F7D"></a>
<h4 id="DGBKR-GUID-84302AF8-2D6D-436C-AEC9-CD36D76C9F7D" class="sect4"><span class="enumeration_section">5.6.1.4</span> Application Continuity</h4>
<div>
<p>Application Continuity is an Oracle Database feature that enables rapid and nondisruptive replays of requests against the database after a recoverable error that made the database session unavailable.</p>
<p>Application Continuity is supported for Oracle Data Guard switchovers to physical standby databases. It is also supported for fast-start failover to physical standbys in maximum availability data protection mode. Note that primary and standby databases must be licensed for Oracle RAC or Oracle Active Data Guard in order to use Application Continuity.</p>
<div class="infoboxnotealso" id="GUID-84302AF8-2D6D-436C-AEC9-CD36D76C9F7D__GUID-F0097D5D-B12F-498A-8253-FA60778B27A5">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink ADFNS1058" target="_blank" href="../ADFNS/adfns_app_continuity.htm#ADFNS1058"><span class="italic">Oracle Database Development Guide</span></a> for information about Application Continuity</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5444">
<tr>
<td class="cellalignment5451">
<table class="cellalignment5449">
<tr>
<td class="cellalignment5448"><a href="dbresource.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5448"><a href="cli.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5453">
<table class="cellalignment5447">
<tr>
<td class="cellalignment5448"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5448"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5448"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5448"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5448"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5448"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>


</body></html>