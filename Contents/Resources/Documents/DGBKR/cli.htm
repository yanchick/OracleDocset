<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-5472"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Scenarios%20Using%20the%20DGMGRL%20Command-Line%20Interface"></a><title>Scenarios Using the DGMGRL Command-Line Interface</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="creating, a broker configuration, broker configurations, enabling, broker configuration, enabling databases, databases, altering, properties, database, states, states, database, disabling, databases"/>
<meta name="dcterms.created" content="2017-07-21T13:32:49Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Data Guard Broker"/>
<meta name="dcterms.identifier" content="E48241-09"/>
<meta name="dcterms.isVersionOf" content="DGBKR"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="sofo.htm" title="Previous" type="text/html"/>
<link rel="Next" href="dgmgrl.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E48241-09.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-D9018A5C-8C7A-4F6C-A7D3-B14E5AF7D4BC"></a> <span id="PAGE" style="display:none;">11/17</span> <!-- End Header -->
<a id="DGBKR495"></a>
<h1 id="DGBKR-GUID-D9018A5C-8C7A-4F6C-A7D3-B14E5AF7D4BC" class="sect1"><span class="enumeration_chapter">6</span> Scenarios Using the DGMGRL Command-Line Interface</h1>
<div>
<p>The following topics describe the prerequisites for getting started using the Oracle Data Guard command-line interface <a id="d20074e20" class="indexterm-anchor"></a>(DGMGRL). They also describes scenarios that demonstrate how to use DGMGRL to create, <a id="d20074e25" class="indexterm-anchor"></a>manage, and <a id="d20074e30" class="indexterm-anchor"></a>monitor a broker configuration.</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="cli.htm#GUID-C9349251-C406-4C10-AFA7-34CA4FB1299B">Prerequisites for Getting Started</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-EBCA7643-F1D9-4EA0-BC5F-45AEEDEBC5BC">Scenario 1: Creating a Configuration</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-94628DB0-9C89-4D05-AB6D-A41555B9C7C4">Scenario 2: Setting Database Properties</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-99E9459D-5F21-4153-8D82-14BDD20A00BB">Scenario 3: Enabling the Configuration and Databases</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-82319941-58E8-4672-8609-7CC496D3DC29">Scenario 4: Setting the Configuration Protection Mode</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-FD18A0B8-350F-44E5-867E-0AD17E65D226">Scenario 5: Setting up Maximum Availability Mode with a Far Sync Instance</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-AAE5EA1A-53A2-4D8D-BF59-A2856B38C99D">Scenario 6: Enabling Fast-Start Failover and Starting the Observer</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-09A3230B-A2A2-449D-89E0-EDDBD76A157C">Scenario 7: Enabling Fast-Start Failover When a Far Sync Instance Is In Use</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-EF93CD0C-B038-4442-9D7F-F0B2B48F8927">Scenario 8: Performing Routine Management Tasks</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-1403D1C3-8944-42D0-8BDA-21D695C7958A">Scenario 9: Performing a Switchover Operation</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-630F5987-328C-410C-AE3B-A9D66EB233D4">Scenario 10: Performing a Manual Failover Operation</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-D46A9644-136B-4149-8C74-BF4E845B3DE3">Scenario 11: Reinstating a Failed Primary Database</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-05313396-B80D-4F53-BB44-AC7B0FF5E8B4">Scenario 12: Converting a Physical Standby to a Snapshot Standby</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-13FDC86F-A736-44F0-A2DD-33B7FF3067A7">Scenario 13: Monitoring a Data Guard Configuration</a></p>
</li>
</ul>
</div>
<a id="DGBKR500"></a>
<div class="props_rev_3"><a id="GUID-C9349251-C406-4C10-AFA7-34CA4FB1299B"></a>
<h2 id="DGBKR-GUID-C9349251-C406-4C10-AFA7-34CA4FB1299B" class="sect2"><span class="enumeration_section">6.1</span> Prerequisites for Getting Started</h2>
<div>
<div class="section">
<p>One of the <a id="d20074e130" class="indexterm-anchor"></a><a id="d20074e134" class="indexterm-anchor"></a>prerequisites for using DGMGRL is that a primary database and any standby databases must already exist. The <a id="d20074e137" class="indexterm-anchor"></a><a id="d20074e139" class="indexterm-anchor"></a><code class="codeph">DG_BROKER_START</code> initialization parameter must be set to <code class="codeph">TRUE</code> for all databases in the configuration. You must use a server parameter file with the broker (see <a href="install.htm#GUID-DBCAC77D-8B4D-4727-B89E-6CFA69302187">Oracle Data Guard Installation</a> and <a href="dgmgrl.htm#GUID-AC5DA9D2-5E60-4484-9099-0388BF238ACA">DGMGRL Command Usage Notes</a>).</p>
<p>Convert the initialization parameter files (PFILE) on both primary and standby databases into server parameter files (SPFILE), if necessary. Use the following SQL*Plus command:</p>
<pre dir="ltr">CREATE SPFILE=&#39;spfilename&#39; FROM PFILE=&#39;pfilename&#39;;
</pre>
<p>If an instance was not started with a server parameter file, then you must shut down the instance and restart it using the server parameter file.</p>
<p>After starting the Oracle instance, set the <code class="codeph">DG_BROKER_START=TRUE</code> initialization parameter using the SQL <code class="codeph">ALTER SYSTEM</code> statement. The parameter value will be saved in the server parameter file. The next time you start the Oracle instance, the broker is started automatically, and you do not need to issue the SQL <code class="codeph">ALTER SYSTEM</code> statement again.</p>
<div class="infoboxnotealso" id="GUID-C9349251-C406-4C10-AFA7-34CA4FB1299B__GUID-C79D09D4-01A3-4593-9F0B-218A3A417C19">
<p class="notep1">See Also:</p>
<p><a class="olink ADMIN11117" target="_blank" href="../ADMIN/create.htm#ADMIN11117"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for detailed information about creating server parameter files</p>
</div>
<p>The following assumptions are made in these scenarios:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>TCP/IP is used to connect to primary and standby databases.</p>
</li>
<li>
<p>The <a id="d20074e192" class="indexterm-anchor"></a>standby database has been created from backups of the <a id="d20074e197" class="indexterm-anchor"></a>primary database control files and datafiles as described in the <a class="olink SBYDB00210" target="_blank" href="../SBYDB/create_ps.htm#SBYDB00210"><span class="italic">Oracle Data Guard Concepts and Administration</span></a>.</p>
</li>
<li>
<p>The scenarios assume the following broker configuration:</p>
<ul style="list-style-type: disc;">
<li>
<p>The configuration name is <code class="codeph">DRSolution</code>.</p>
</li>
<li>
<p>The database unique name (<code class="codeph">DB_UNIQUE_NAME</code>) of the primary database is <code class="codeph">North_Sales</code>.</p>
</li>
<li>
<p>The database unique name (<code class="codeph">DB_UNIQUE_NAME</code>) of the remote standby database is <code class="codeph">South_Sales</code>.</p>
</li>
<li>
<p>The protection mode is maximum performance mode.</p>
</li>
<li>
<p>There are standby redo log files configured for both the primary and standby database. The transport mode for both databases is <code class="codeph">ASYNC</code>.</p>
</li>
<li>
<p>The standby database is a physical standby database.</p>
</li>
</ul>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR505"></a>
<div class="props_rev_3"><a id="GUID-EBCA7643-F1D9-4EA0-BC5F-45AEEDEBC5BC"></a>
<h2 id="DGBKR-GUID-EBCA7643-F1D9-4EA0-BC5F-45AEEDEBC5BC" class="sect2"><span class="enumeration_section">6.2</span> Scenario 1: Creating a Configuration</h2>
<div>
<div class="section">
<p>This section provides examples that <a id="d20074e280" class="indexterm-anchor"></a><a id="d20074e284" class="indexterm-anchor"></a><a id="d20074e288" class="indexterm-anchor"></a>create a broker configuration named <code class="codeph">DRSolution</code> that includes a primary and standby database named <code class="codeph">North_Sales</code> and <code class="codeph">South_Sales</code>.</p>
<p>To create a configuration and add one physical standby database, perform the following tasks:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><a href="cli.htm#GUID-E0E3FE01-BC23-419F-B9B5-4E7035D9455F">Creating a Configuration Task 1: Invoke DGMGRL</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-BA60C699-B35F-454A-A65F-97A521DDE176">Creating a Configuration Task 2: Connect to the Primary Database</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-50D518A0-7832-4DE9-96CC-551CD84F7AC5">Creating a Configuration Task 3: Clear Existing Remote Redo Transport Destinations</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-BAEF04D8-CD69-4637-BF0F-F3108BF5FFB1">Creating a Configuration Task 4: Create the Broker Configuration</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-D399C53D-793E-44EE-80FC-D1F4D0A1D974">Creating a Configuration Task 5: Show the Configuration Information</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-F2361026-9F8B-4A8B-BC40-0ECA570236E9">Creating a Configuration Task 6: Add a Standby Database to the Configuration</a></p>
</li>
</ul>
</div>
<!-- class="section" --></div>
<div class="props_rev_3"><a id="GUID-E0E3FE01-BC23-419F-B9B5-4E7035D9455F"></a>
<h3 id="DGBKR-GUID-E0E3FE01-BC23-419F-B9B5-4E7035D9455F" class="sect3"><span class="enumeration_section">6.2.1</span> Creating a Configuration Task 1: Invoke DGMGRL</h3>
<div>
<div class="section">
<p><a id="d20074e360" class="indexterm-anchor"></a>To start DGMGRL, enter <code class="codeph">dgmgrl</code> at the command-line prompt on a system where Oracle Data Guard is installed:</p>
<pre dir="ltr">$ dgmgrl
</pre>
<p>The DGMGRL prompt is displayed:</p>
<pre dir="ltr">DGMGRL&gt;
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DGBKR3600"></a><a id="DGBKR3599"></a>
<div class="props_rev_3"><a id="GUID-BA60C699-B35F-454A-A65F-97A521DDE176"></a>
<h3 id="DGBKR-GUID-BA60C699-B35F-454A-A65F-97A521DDE176" class="sect3"><span class="enumeration_section">6.2.2</span> Creating a Configuration Task 2: Connect to the Primary Database</h3>
<div>
<div class="section">
<p>Before you specify any command (other than the <code class="codeph">HELP,</code> <code class="codeph">EXIT,</code> or <code class="codeph">QUIT</code>), you must first connect to the primary database using the DGMGRL <code class="codeph">CONNECT</code> command.</p>
<p>The account from which you connect to the database (<code class="codeph">SYS</code> in this example) must have <code class="codeph">SYSDG</code> or <code class="codeph">SYSDBA</code> privileges on the primary and standby databases.</p>
<div class="infobox-note" id="GUID-BA60C699-B35F-454A-A65F-97A521DDE176__GUID-656437C1-8712-469E-A114-459C680C67F9">
<p class="notep1">Note:</p>
<p>You do not have to include <code class="codeph">AS SYSDBA</code> on the <code class="codeph">CONNECT</code> command; it is the default setting.</p>
</div>
<p>The following examples show two variations of the <code class="codeph">CONNECT</code> command. <a href="cli.htm#GUID-BA60C699-B35F-454A-A65F-97A521DDE176__i1005721">Example 6-1</a> shows how to connect to the default database on the local system, and <a href="cli.htm#GUID-BA60C699-B35F-454A-A65F-97A521DDE176__i1005725">Example 6-2</a> includes the Oracle Net Services connect identifier (<code class="codeph">North_Sales.example.com</code>) to make a connection to a database located on a remote system. In both examples, you are prompted for a password.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-BA60C699-B35F-454A-A65F-97A521DDE176__i1005721">
<p class="titleinexample">Example 6-1 Connecting to the Primary Database on the Local System</p>
<pre dir="ltr">DGMGRL&gt; CONNECT sysdg;
Password: <span class="italic">password</span>
Connected as SYSDG.
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-BA60C699-B35F-454A-A65F-97A521DDE176__i1005725">
<p class="titleinexample">Example 6-2 Connecting to the Primary Database on a Remote System</p>
<pre dir="ltr">DGMGRL&gt; CONNECT sysdg@North_Sales.example.com;
Password: <span class="italic">password</span>
Connected as SYSDG.
</pre></div>
<!-- class="example" --></div>
</div>
<div class="props_rev_3"><a id="GUID-50D518A0-7832-4DE9-96CC-551CD84F7AC5"></a>
<h3 id="DGBKR-GUID-50D518A0-7832-4DE9-96CC-551CD84F7AC5" class="sect3"><span class="enumeration_section">6.2.3</span> Creating a Configuration Task 3: Clear Existing Remote Redo Transport Destinations</h3>
<div>
<div class="section">
<p>You must clear any remote redo transport destinations on the primary database that do not have the <code class="codeph">NOREGISTER</code> attribute, before a configuration can be created. Otherwise, the following error message is returned when you attempt to create the configuration:</p>
<pre dir="ltr">ORA-16698: LOG_ARCHIVE_DEST_n parameter set for object to be added
 
Failed.
</pre>
<p>To clear <code class="codeph">LOG_ARCHIVE_DEST_</code><span class="italic"><code class="codeph">n</code></span> settings, use the <code class="codeph">ALTER SYSTEM SET LOG_ARCHIVE_DEST_n=&#34; &#34;</code> SQL*Plus command.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-BAEF04D8-CD69-4637-BF0F-F3108BF5FFB1"></a>
<h3 id="DGBKR-GUID-BAEF04D8-CD69-4637-BF0F-F3108BF5FFB1" class="sect3"><span class="enumeration_section">6.2.4</span> Creating a Configuration Task 4: Create the Broker Configuration</h3>
<div>
<div class="section">
<p>A broker configuration is initially created with just a primary database, which in this case is called <code class="codeph">North_Sales</code>. In a later command, you will add the standby database, <code class="codeph">South_Sales</code>.</p>
<div class="infobox-note" id="GUID-BAEF04D8-CD69-4637-BF0F-F3108BF5FFB1__GUID-64A71AE4-D3F4-4AF9-A189-AB777016B286">
<p class="notep1">Note:</p>
<p>The names for the primary and standby databases must match their database unique names. Fetch these from their <code class="codeph">DB_UNIQUE_NAME</code> initialization parameter as follows:</p>
<pre dir="ltr">SQL&gt; SHOW PARAMETER DB_UNIQUE_NAME;
</pre></div>
<p>Use the <code class="codeph">CREATE CONFIGURATION</code> command to create the <code class="codeph">DRSolution</code> configuration and define the primary database, <code class="codeph">North_Sales</code>:</p>
<pre dir="ltr">DGMGRL&gt; CREATE CONFIGURATION &#39;DRSolution&#39; AS
&gt;  PRIMARY DATABASE IS &#39;North_Sales&#39;
&gt;  CONNECT IDENTIFIER IS North_Sales.example.com;
  
</pre>
<p>DGMGRL returns the following information:</p>
<pre dir="ltr">Configuration &#34;DRSolution&#34; created with primary database &#34;North_Sales&#34;
</pre>
<p>The name <code class="codeph">North_Sales</code> is the value of this database&#39;s <code class="codeph">DB_UNIQUE_NAME</code> initialization parameter.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-D399C53D-793E-44EE-80FC-D1F4D0A1D974"></a>
<h3 id="DGBKR-GUID-D399C53D-793E-44EE-80FC-D1F4D0A1D974" class="sect3"><span class="enumeration_section">6.2.5</span> Creating a Configuration Task 5: Show the Configuration Information</h3>
<div>
<div class="section">
<p>Use the <code class="codeph">SHOW CONFIGURATION</code> command to display a brief summary of the configuration:</p>
<pre dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;
</pre>
<p>DGMGRL returns the following information:</p>
<pre dir="ltr">Configuration - DRSolution
 
  Protection Mode: MaxPerformance
  Databases:
    North_Sales - Primary database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
DISABLED
</pre></div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-F2361026-9F8B-4A8B-BC40-0ECA570236E9"></a>
<h3 id="DGBKR-GUID-F2361026-9F8B-4A8B-BC40-0ECA570236E9" class="sect3"><span class="enumeration_section">6.2.6</span> Creating a Configuration Task 6: Add a Standby Database to the Configuration</h3>
<div>
<div class="section">
<p>To add a standby database to the <code class="codeph">DRSolution</code> configuration, use the <code class="codeph">ADD DATABASE</code> command.</p>
<p>The following command defines <code class="codeph">South_Sales</code> as a standby database, which is the standby database associated with the primary database called <code class="codeph">North_Sales</code>:</p>
<pre dir="ltr">DGMGRL&gt; ADD DATABASE &#39;South_Sales&#39; AS
&gt;  CONNECT IDENTIFIER IS South_Sales.example.com;
</pre>
<p>DGMGRL returns the following information:</p>
<pre dir="ltr">Database &#34;South_Sales&#34; added
</pre>
<p>The name <code class="codeph">South_Sales</code> is the value of the database&#39;s <code class="codeph">DB_UNIQUE_NAME</code> initialization parameter.</p>
<p>Use the <code class="codeph">SHOW CONFIGURATION</code> command to verify that the <code class="codeph">South_Sales</code> database was added to the <code class="codeph">DRSolution</code> configuration:</p>
<pre dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;
</pre>
<p>DGMGRL returns the following information:</p>
<pre dir="ltr">Configuration - DRSolution
 
  Protection Mode: MaxPerformance
  Databases:
    North_Sales  - Primary database
      South_Sales  - Physical standby database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
DISABLED
 
DGMGRL&gt;
</pre></div>
<!-- class="section" --></div>
</div>
</div>
<a id="DGBKR510"></a>
<div class="props_rev_3"><a id="GUID-94628DB0-9C89-4D05-AB6D-A41555B9C7C4"></a>
<h2 id="DGBKR-GUID-94628DB0-9C89-4D05-AB6D-A41555B9C7C4" class="sect2"><span class="enumeration_section">6.3</span> Scenario 2: Setting Database Properties</h2>
<div>
<div class="section">
<p>After you create the configuration with DGMGRL, you can <a id="d20074e683" class="indexterm-anchor"></a><a id="d20074e687" class="indexterm-anchor"></a>set database <a id="d20074e692" class="indexterm-anchor"></a>properties at any time. For example, the following statements set the <code class="codeph">LogArchiveFormat</code> and <code class="codeph">StandbyArchiveLocation</code> database properties for the <code class="codeph">South_Sales</code> standby database:</p>
<pre dir="ltr">DGMGRL&gt; EDIT DATABASE &#39;South_Sales&#39; SET PROPERTY &#39;LogArchiveFormat&#39;=&#39;log_%t_%s_%r_%d.arc&#39;;
Property &#34;LogArchiveFormat&#34; updated.

DGMGRL&gt; EDIT DATABASE &#39;South_Sales&#39; SET PROPERTY &#39;StandbyArchiveLocation&#39;=&#39;/archfs/arch/&#39;;
Property &#34;StandbyArchiveLocation&#34; updated.
</pre>
<p>Use the <code class="codeph">SHOW DATABASE VERBOSE</code> command to view all properties and their values for a database. The following example shows the properties for the <code class="codeph">South_Sales</code> database.</p>
<pre dir="ltr">DGMGRL&gt; SHOW DATABASE VERBOSE &#39;South_Sales&#39;;
 
Database - South_Sales
 
  Role:            PHYSICAL STANDBY
  Intended State:  OFFLINE
  Transport Lag:   (unknown)
  Apply Lag:       (unknown)
  Apply Rate:      (unknown)
  Real Time Query: OFF
  Instance(s):
    south_sales1
 
  Properties:
    DGConnectIdentifier             = &#39;South_Sales.example.com&#39;
    ObserverConnectIdentifier       = &#39;&#39;
    LogXptMode                      = &#39;ASYNC&#39;
    RedoRoutes                      = &#39;&#39;
    DelayMins                       = &#39;0&#39;
    Binding                         = &#39;optional&#39;
    MaxFailure                      = &#39;0&#39;
    MaxConnections                  = &#39;1&#39;
    ReopenSecs                      = &#39;300&#39;
    NetTimeout                      = &#39;30&#39;
    RedoCompression                 = &#39;DISABLE&#39;
    LogShipping                     = &#39;ON&#39;
    PreferredApplyInstance          = &#39;&#39;
    ApplyInstanceTimeout            = &#39;0&#39;
    ApplyLagThreshold               = &#39;0&#39;
    TransportLagThreshold           = &#39;0&#39;
    TransportDisconnectedThreshold  = &#39;0&#39;
    ApplyParallel                   = &#39;AUTO&#39;
    StandbyFileManagement           = &#39;AUTO&#39;
    ArchiveLagTarget                = &#39;0&#39;
    LogArchiveMaxProcesses          = &#39;5&#39;
    LogArchiveMinSucceedDest        = &#39;1&#39;
    DbFileNameConvert               = &#39;dbs/t, dbs/ct, dbs/bt, dbs/ct&#39;
    LogFileNameConvert              = &#39;dbs/t, dbs/ct, dbs/bt, dbs/ct&#39;
    FastStartFailoverTarget         = &#39;&#39;
    InconsistentProperties          = &#39;(monitor)&#39;
    InconsistentLogXptProps         = &#39;(monitor)&#39;
    SendQEntries                    = &#39;(monitor)&#39;
    LogXptStatus                    = &#39;(monitor)&#39;
    RecvQEntries                    = &#39;(monitor)&#39;
    StaticConnectIdentifier         = &#39;(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=south_sales1.example.com)(PORT=2840))
(CONNECT_DATA=(SERVICE_NAME=South_Sales_DGMGRL.example.com)(INSTANCE_NAME=south_sales1)(SERVER=DEDICATED)))&#39;
    StandbyArchiveLocation          = &#39;USE_DB_RECOVERY_FILE_DEST&#39;
    AlternateLocation               = &#39;&#39;
    LogArchiveTrace                 = &#39;255&#39;
    LogArchiveFormat                = &#39;db3r_%d_%t_%s_%R.arc&#39;
    TopWaitEvents                   = &#39;(monitor)&#39;
 
Database Status:
DISABLED
</pre>
<p>If broker management of the database is enabled, setting a database property value causes the underlying parameter value to be changed in the corresponding database, and the value for the changed parameter is reflected in the server parameter file. Thus, if the database is shut down and restarted outside of Oracle Enterprise Manager Cloud Control (Cloud Control) and DGMGRL (such as from the SQL*Plus interface), the database uses the new parameter values from the updated server parameter file when it starts. However, you should not make changes to the redo transport services initialization parameters through SQL statements. Doing so will cause an inconsistency between the database and the broker.</p>
<div class="infobox-note" id="GUID-94628DB0-9C89-4D05-AB6D-A41555B9C7C4__GUID-3EF0D11D-49E1-4F9A-B737-5F65FCA0C115">
<p class="notep1">Note:</p>
<p>The database properties are typically displayed in mixed-case (for example, <code class="codeph">LogArchiveFormat</code>) typeface to help you visually differentiate database properties (from the corresponding initialization parameter, SQL statement, or PL/SQL procedure), which are typically documented in <code class="codeph">UPPERCASE</code> typeface. However, the commands to manage properties are not case sensitive; you can issue commands in uppercase, lowercase, or mixed-case.</p>
</div>
<p>You can change a property if the database is enabled or disabled. However, if the database is disabled when you change a property, the change does not take effect until the database is enabled.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR3601"></a><a id="DGBKR3602"></a><a id="DGBKR3603"></a><a id="DGBKR3604"></a><a id="DGBKR515"></a>
<div class="props_rev_3"><a id="GUID-99E9459D-5F21-4153-8D82-14BDD20A00BB"></a>
<h2 id="DGBKR-GUID-99E9459D-5F21-4153-8D82-14BDD20A00BB" class="sect2"><span class="enumeration_section">6.4</span> Scenario 3: Enabling the Configuration and Databases</h2>
<div>
<div class="section">
<p>So far, the <code class="codeph">DRSolution</code> <a id="d20074e779" class="indexterm-anchor"></a><a id="d20074e783" class="indexterm-anchor"></a>configuration is disabled, which means it is not under the control of the Data Guard broker. When you finish <a id="d20074e788" class="indexterm-anchor"></a>configuring the databases into a broker configuration and setting any necessary database properties, you must <a id="d20074e793" class="indexterm-anchor"></a><a id="d20074e797" class="indexterm-anchor"></a>enable the configuration to allow the Data Guard broker to manage it.</p>
<p>You can enable:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>The entire configuration, including all of its databases</p>
</li>
<li>
<p>A standby database</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Enable the entire configuration</p>
</div>
<!-- class="section" -->
<div class="section">
<p>You can enable the entire configuration, including all of the databases, with the following command:</p>
<pre dir="ltr">DGMGRL&gt; <a id="d20074e820" class="indexterm-anchor"></a>ENABLE CONFIGURATION;
Enabled.
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Show the configuration</p>
</div>
<!-- class="section" -->
<div class="section">
<p>Use the <code class="codeph">SHOW</code> command to verify that the configuration and its databases were successfully enabled:</p>
<pre dir="ltr">DGMGRL&gt; <a id="d20074e834" class="indexterm-anchor"></a>SHOW CONFIGURATION;
</pre>
<p>DGMGRL returns the following information:</p>
<pre dir="ltr">Configuration - DRSolution
 
  Protection Mode: MaxPerformance
  Databases:
    North_Sales  - Primary database
      South_Sales  - Physical standby database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
SUCCESS
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Enable the database</p>
</div>
<!-- class="section" -->
<div class="section">
<p>This step is unnecessary except if the standby database was previously disabled with the <code class="codeph">DISABLE DATABASE</code> command. Normally, enabling the configuration also enables the standby database.</p>
<pre dir="ltr">DGMGRL&gt; ENABLE DATABASE &#39;South_Sales&#39;;
Enabled.
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Show the database</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">DGMGRL&gt; SHOW DATABASE &#39;South_Sales&#39;;

Database - South_Sales
 
  Role:             PHYSICAL STANDBY
  Intended State:   APPLY-ON
  Transport Lag:    0 seconds (computed 1 second ago)
  Apply Lag:        0 seconds (computed 1 second ago)
  Apply Rate:       1.54 MByte/s
  Real Time Query:  OFF
  Instance(s):
    south_sales1
 
Database Status:
SUCCESS
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DGBKR520"></a>
<div class="props_rev_3"><a id="GUID-82319941-58E8-4672-8609-7CC496D3DC29"></a>
<h2 id="DGBKR-GUID-82319941-58E8-4672-8609-7CC496D3DC29" class="sect2"><span class="enumeration_section">6.5</span> Scenario 4: Setting the Configuration Protection Mode</h2>
<div>
<p>You can change the protection mode of the configuration at any time.</p>
<div class="infobox-note" id="GUID-82319941-58E8-4672-8609-7CC496D3DC29__GUID-D37F81EE-1838-4E50-B0BD-9961B79CA3B9">
<p class="notep1">Note:</p>
<p>You cannot change the protection mode from maximum performance mode to maximum protection mode. You must first change the protection mode to maximum availability and then to maximum protection mode.</p>
<p>A restart of the primary database is not necessary when changing the protection mode.</p>
</div>
<p>This scenario sets the protection mode of the configuration to the <code class="codeph">MAXAVAILABILITY</code> mode. Note that this protection mode requires that there be at least one standby configured to use standby redo log files and it must receive redo via <code class="codeph">SYNC</code> or <code class="codeph">FASTSYNC</code> mode if it receives redo directly from the primary database. If the standby receives redo via a far sync instance, then the far sync instance must receive redo via <code class="codeph">SYNC</code> or <code class="codeph">FASTYSYNC</code> mode and the standby must receive redo from the far sync instance via <code class="codeph">ASYNC</code> mode.</p>
<ol>
<li>
<p>Configure standby redo log files, if necessary.</p>
<p>Because you will be setting the protection mode to the <code class="codeph">MAXAVAILABILITY</code> mode, it is important to ensure that sufficient standby redo log files are configured on the standby database. For more information on setting up redo transport, see <a class="olink SBYDB-GUID-04851F96-F8F3-4999-AAAD-83C4C3C7AE14" target="_blank" href="../SBYDB/log_transport.htm#SBYDB-GUID-04851F96-F8F3-4999-AAAD-83C4C3C7AE14"><span><cite>Oracle Data Guard Concepts and Administration</cite></span></a>.</p>
</li>
<li>
<p>Configure redo transport mode appropriately.</p>
<p>Configure the standby to receive redo via <code class="codeph">SYNC</code> or <code class="codeph">FASTSYNC</code> mode, if the standby receives redo directly from the primary database. If the standby receives primary redo via a far sync instance, then configure the far sync instance to receive redo via <code class="codeph">SYNC</code> or <code class="codeph">FASTSYNC</code> mode and configure the standby to receive redo via <code class="codeph">ASYNC</code> mode. For example:</p>
<pre dir="ltr">DGMGRL&gt; EDIT DATABASE &#39;South_Sales&#39; SET PROPERTY &#39;LogXptMode&#39;=&#39;SYNC&#39;;
Property &#34;LogXptMode&#34; updated
</pre>
<p>The broker will not allow this command to succeed unless the standby database is configured with standby redo log files in the configuration.</p>
</li>
<li>
<p>Change the overall protection mode for the configuration.</p>
<p>Use the <code class="codeph">EDIT</code> <code class="codeph">CONFIGURATION</code> command to upgrade the broker configuration to the <code class="codeph">MAXAVAILABILITY</code> protection mode:</p>
<pre dir="ltr">DGMGRL&gt; EDIT CONFIGURATION SET PROTECTION MODE AS MAXAVAILABILITY;
Succeeded.
</pre>
<p>If the configuration is disabled when you enter this command, the actual protection mode change is not applied until you enable the configuration with the <code class="codeph">ENABLE CONFIGURATION</code> command. The broker will not allow you to enable the configuration if it does not find a standby database in the configuration that can support the requirements of the protection mode.</p>
</li>
<li>
<p>Verify the protection mode has changed.</p>
<p>Use the <code class="codeph">SHOW CONFIGURATION</code> command to display the current protection mode for the configuration:</p>
<pre dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;
 
Configuration - DRSolution
 
  <span class="bold">Protection Mode:</span> <span class="bold">MaxAvailability</span>
  Members:
    North_Sales  - Primary database
      South_Sales  - Physical standby database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
SUCCESS
</pre>
<div class="infoboxnotealso" id="GUID-82319941-58E8-4672-8609-7CC496D3DC29__GUID-E5A4FA29-229A-4FB6-88C5-BB31B3BC8F67">
<p class="notep1">See Also:</p>
<p><a href="dbresource.htm#GUID-994BE350-859F-41DC-A1D3-B6E8D5EEF2C8">Managing Data Protection Modes</a></p>
</div>
</li>
</ol>
</div>
</div>
<a id="DGBKR3865"></a><a id="DGBKR3861"></a>
<div class="props_rev_3"><a id="GUID-FD18A0B8-350F-44E5-867E-0AD17E65D226"></a>
<h2 id="DGBKR-GUID-FD18A0B8-350F-44E5-867E-0AD17E65D226" class="sect2"><span class="enumeration_section">6.6</span> Scenario 5: Setting up Maximum Availability Mode with a Far Sync Instance</h2>
<div>
<div class="section">
<p>A far sync instance can be used with maximum availability protection mode if the primary and standby database are geographically far enough apart to make the use of synchronous transport mode impractical. The example in this section shows how to add a far sync instance to the configuration and then set up the <code class="codeph">RedoRoutes</code> property for all members of the configuration. Setting of <code class="codeph">RedoRoutes</code> property for the far sync instance enables it to send redo data based on either the <code class="codeph">North_Sales</code> or <code class="codeph">South_Sales</code> database being the primary.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Issue the following commands to add the far sync instance named <code class="codeph">FS</code> to the broker configuration:</span>
<div>
<pre dir="ltr">DGMGRL&gt; ADD FAR_SYNC &#39;FS&#39; AS CONNECT IDENTIFIER IS FS.EXAMPLE.COM;
DGMGRL&gt; ENABLE FAR_SYNC &#39;FS&#39;;
DGMGRL&gt; SHOW CONFIGURATION;
  
Configuration - DRSolution
 
  Protection Mode: MaxPerformance
  Databases:
  North_Sales - Primary database
    South_Sales - Physical standby database
    FS - Far Sync
 
Fast-Start Failover: DISABLED
 
Configuration Status:
SUCCESS
</pre>
<p>In this output, <code class="codeph">South_Sales</code> and <code class="codeph">FS</code> are indented under <code class="codeph">North_Sales</code>. This indicates that the primary is sending redo data to both <code class="codeph">South_Sales</code> and <code class="codeph">FS</code>.</p>
</div>
</li>
<li class="stepexpand"><span>Issue the following commands so that the current primary (<code class="codeph">North_Sales</code>) sends redo data to the far sync instance only, and the far sync instance sends redo data to <code class="codeph">South_Sales</code> when <code class="codeph">North_Sales</code> is a primary:</span>
<div>
<pre dir="ltr">DGMGRL&gt; EDIT DATABASE &#39;North_Sales&#39; SET PROPERTY RedoRoutes=&#39;(LOCAL : FS SYNC)&#39;;
DGMGRL&gt; EDIT FAR_SYNC &#39;FS&#39; SET PROPERTY RedoRoutes=&#39;(North_Sales : South_Sales&#39;);
DGMGRL&gt; SHOW CONFIGURATION;
 
DGMGRL&gt; SHOW CONFIGURATION;
 
Configuration - DRSolution
 
  Protection Mode: MaxPerformance
  Databases:
  North_Sales - Primary database
    FS - Far Sync
      South_Sales - Physical standby database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
SUCCESS
</pre>
<p>The indentation scheme in the output above indicates that <code class="codeph">North_Sales</code> sends redo data to <code class="codeph">FS</code> and <code class="codeph">FS</code> sends redo data to <code class="codeph">South_Sales</code>.</p>
</div>
</li>
<li class="stepexpand"><span>Issue the following commands to upgrade the protection mode to maximum availability:</span>
<div>
<pre dir="ltr">DGMGRL&gt; EDIT CONFIGURATION SET PROTECTION MODE AS MaxAvailability;
DGMGRL&gt; SHOW CONFIGURATION;
 
Configuration - DRSolution
 
  Protection Mode: MaxAvailability
  Databases:
  North_Sales - Primary database
    FS - Far Sync
      South_Sales - Physical standby database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
SUCCESS
</pre>
<p>If <code class="codeph">South_Sales</code> ever becomes the primary and <code class="codeph">North_Sales</code> becomes a standby database that receives redo data from the far sync instance, <code class="codeph">FS</code>, then the <code class="codeph">RedoRoutes</code> property must be set for <code class="codeph">South_Sales</code>. Additionally, a new rule must be included in the <code class="codeph">RedoRoutes</code> property for <code class="codeph">FS</code> to allow it to send redo data to <code class="codeph">North_Sales</code> when <code class="codeph">South_Sales</code> is the primary database.</p>
<p>If these rules are not created, then <code class="codeph">North_Sales</code> will not be able to receive redo data. To check whether the proper rules have been set, use the <code class="codeph">SHOW</code> <code class="codeph">CONFIGURATION</code> <code class="codeph">WHEN</code> <code class="codeph">PRIMARY</code> <code class="codeph">IS</code> command to see what the redo transport configuration would be if <code class="codeph">South_Sales</code> were the primary database. For example:</p>
<pre dir="ltr">DGMGRL&gt; SHOW CONFIGURATION WHEN PRIMARY IS &#39;South_Sales&#39;;
 
Configuration when South_Sales is primary - DRSolution
 
  Members:
  South_Sales  - Primary database
    FS     - Far Sync 
      North_Sales  - Physical standby database 
 
  Members Not Receiving Redo:
  North_FS - Physical standby database
  Warning: ORA-16685: database does not receive redo data
</pre>
<p>To correct this error, set the <code class="codeph">RedoRoutes</code> property for <code class="codeph">South_Sales</code> and <code class="codeph">FS</code> as follows:</p>
<pre dir="ltr">DGMGRL&gt; EDIT DATABASE &#39;South_Sales&#39; SET PROPERTY RedoRoutes=&#39;(LOCAL : FS SYNC)&#39;;
DGMGRL&gt; EDIT FAR_SYNC &#39;FS&#39; SET PROPERTY RedoRoutes=(&#39;North_Sales : South_Sales)(South_Sales : North_Sales)&#39;;
</pre>
<p>After the change to the <code class="codeph">RedoRoutes</code> property for <code class="codeph">South_Sales</code> and <code class="codeph">FS</code> is complete, use the <code class="codeph">SHOW</code> <code class="codeph">CONFIGURATION</code> <code class="codeph">WHEN</code> <code class="codeph">PRIMARY</code> <code class="codeph">IS</code> command to confirm that the error has been cleared:</p>
<pre dir="ltr">DGMGRL&gt; SHOW CONFIGURATION WHEN PRIMARY IS &#39;South_Sales&#39;;
 
Configuration when South_Sales is primary - DRSolution
 
  Members:
  South_Sales  - Primary database
    FS     - Far Sync 
      North_Sales  - Physical standby database 
</pre></div>
</li>
</ol>
</div>
</div>
<a id="DGBKR3430"></a>
<div class="props_rev_3"><a id="GUID-AAE5EA1A-53A2-4D8D-BF59-A2856B38C99D"></a>
<h2 id="DGBKR-GUID-AAE5EA1A-53A2-4D8D-BF59-A2856B38C99D" class="sect2"><span class="enumeration_section">6.7</span> Scenario 6: Enabling Fast-Start Failover and Starting the Observer</h2>
<div>
<div class="section">
<p>You can enable fast-start failover from any site, including the observer site, while connected to any database in the broker configuration. Enabling fast-start failover does not trigger a failover. Instead, it allows the observer that is monitoring the configuration to initiate a fast-start failover if conditions warrant a failover.</p>
<p>Fast-start failover can be enabled in configurations operating in either maximum performance or maximum availability protection mode. This section describes the steps to enable fast-start failover and start the observer where the configuration protection mode is set to maximum availability mode.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Ensure standby redo logs are configured on the primary and target standby databases. You must stop log apply services prior to configuring standby redo logs.</span>
<div>
<div class="infoboxnotealso" id="GUID-AAE5EA1A-53A2-4D8D-BF59-A2856B38C99D__GUID-DD9D7D36-23D7-412A-8BBA-A5325F9368B2">
<p class="notep1">See Also:</p>
<p><a class="olink SBYDB00426" target="_blank" href="../SBYDB/create_ps.htm#SBYDB00426"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> for instructions on configuring standby redo log files</p>
</div>
</div>
</li>
<li class="stepexpand"><span>Configure the primary and standby databases to receive redo via <code class="codeph">SYNC</code> or <code class="codeph">FASTSYNC</code> mode, if they receive redo directly rather than via a far sync instance. If either database receives redo via a far sync instance, then configure the far sync instance to receive redo via <code class="codeph">SYNC</code> or <code class="codeph">FASTSYNC</code> mode and configure the database to receive redo via <code class="codeph">ASYNC</code> mode. For example:</span>
<div>
<pre dir="ltr">DGMGRL&gt; EDIT DATABASE &#39;North_Sales&#39; SET PROPERTY &#39;LogXptMode&#39;=&#39;SYNC&#39;;
Property &#34;LogXptMode&#34; updated
</pre>
<pre dir="ltr">DGMGRL&gt; EDIT DATABASE &#39;South_Sales&#39; SET PROPERTY &#39;LogXptMode&#39;=&#39;SYNC&#39;;
Property &#34;LogXptMode&#34; updated
</pre>
<p>The broker does not allow these commands to succeed unless the databases are configured with standby redo log files.</p>
</div>
</li>
<li class="stepexpand"><span>If you have two or more standby databases, set up the <code class="codeph">FastStartFailoverTarget</code> configuration property on the primary database to indicate the desired target standby database. The broker reciprocally sets this property for the target standby database to indicate the primary database as its future target standby database when fast-start failover is actually enabled. There is no need for you set this property on the target standby as this is done for you automatically. For example:</span>
<div>
<pre dir="ltr">DGMGRL&gt; EDIT DATABASE &#39;North_Sales&#39; SET PROPERTY FastStartFailoverTarget=&#39;South_Sales&#39;;
Property &#34;FastStartFailoverTarget&#34; updated
</pre></div>
</li>
<li class="stepexpand"><span>If it is necessary to upgrade the protection mode, use the following DGMGRL <code class="codeph">EDIT CONFIGURATION</code> command. For example:</span>
<div>
<pre dir="ltr">DGMGRL&gt; EDIT CONFIGURATION SET PROTECTION MODE AS MAXAVAILABILITY;
</pre></div>
</li>
<li class="stepexpand"><span>If it is not already enabled on the primary and standby databases, enable Flashback Database by issuing the following statements on each database:</span>
<div>
<pre dir="ltr">ALTER SYSTEM SET UNDO_RETENTION=3600 SCOPE=SPFILE;
ALTER SYSTEM SET UNDO_MANAGEMENT=&#39;AUTO&#39; SCOPE=SPFILE;
SHUTDOWN IMMEDIATE;
STARTUP MOUNT;
SHOW PARAMETER UNDO;
ALTER SYSTEM SET DB_FLASHBACK_RETENTION_TARGET=4320 SCOPE=BOTH;
ALTER DATABASE ARCHIVELOG;
ALTER SYSTEM SET db_recovery_file_dest_size=&lt;size&gt;;
ALTER SYSTEM SET db_recovery_file_dest=&lt;directory-specification&gt;;
ALTER DATABASE FLASHBACK ON;
ALTER DATABASE OPEN;
</pre>
<p>Ensure the <code class="codeph">UNDO_RETENTION</code> and <code class="codeph">DB_FLASHBACK_RETENTION_TARGET</code> initialization parameters are set to sufficiently large values so that reinstatement is still possible after a prolonged outage.</p>
</div>
</li>
<li class="stepexpand"><span>Start the observer by logging into the observer computer and running DGMGRL. <a id="d20074e1281" class="indexterm-anchor"></a><a id="d20074e1285" class="indexterm-anchor"></a>Connect to the configuration as a user who has the <code class="codeph">SYSDG</code> or <code class="codeph">SYSDBA</code> privilege and then issue the <code class="codeph">START OBSERVER</code> command. Note that the command does not return; that is you will not get the DGMGRL prompt after issuing the command.</span>
<div>
<pre dir="ltr">DGMGRL&gt; CONNECT sysdg@North_Sales.example.com;
Password: <span class="italic">password</span>
Connected as SYSDG.
DGMGRL&gt; START OBSERVER;
Observer started
</pre>
<p>When starting the observer interactively, Oracle recommends that connection credentials not be supplied as command line parameters to the DGMGRL connect command. This practice prevents other users on the system from using a utility (for example, the UNIX ps utility) to display connection credentials. It also prevents clear-text passwords from being visible on the user&#39;s terminal.</p>
<p>When starting the observer from a script, Oracle recommends that you use a method that supports &#39;connect /&#39;, so that database connection credentials do not have to be embedded within the script. If you choose to use a client-side Oracle Wallet as a secure external password store (see <a class="olink DBIMI160" target="_blank" href="../DBIMI/walet.htm#DBIMI160"><span class="italic">Oracle Database Enterprise User Security Administrator&#39;s Guide</span></a>), be sure to add credentials for both the primary and fast-start failover target standby databases. The database connect string that you specify when adding the credentials for each database must match the <code class="codeph">ObserverConnectIdentifer</code> or <code class="codeph">DGConnectIdentifier</code> database property.</p>
</div>
</li>
<li class="stepexpand"><span>Enable fast-start failover. You can enable fast-start failover while connected to any database system in the broker configuration. For example:</span>
<div>
<pre dir="ltr">DGMGRL&gt; ENABLE FAST_START FAILOVER;
Enabled.
</pre></div>
</li>
<li class="stepexpand"><span>Verify the fast-start failover configuration. Use the <code class="codeph">SHOW FAST_START FAILOVER</code> command to display the fast-start failover settings:</span>
<div>
<pre dir="ltr">DGMGRL&gt; SHOW FAST_START FAILOVER;
 
Fast-Start Failover: DISABLED
 
  Threshold: 30 seconds
  Target: South_Sales
  Observer: observer.example.com
  Lag Limit: 30 seconds (not in use)
  Shutdown Primary: TRUE
  Auto-reinstate: TRUE
  Observer Reconnect: (none)
  Observer Override: FALSE
 
Configurable Failover Conditions
 Health Conditions:
   Corrupted Controlfile YES
  Corrupted Dictionary YES
  Inaccessible Logfile NO
  Stuck Archiver NO
  Datafile Offline YES
 
Oracle Error Conditions:
(none)
</pre>
<p>The following commands show that the <code class="codeph">FastStartFailoverTarget</code> property is set up reciprocally once fast-start failover is enabled. The first command, issued for the current primary database <code class="codeph">North_Sales</code>, shows the value of the <code class="codeph">FastStartFailoverTarget</code> property to be the current target standby, <code class="codeph">South_Sales</code>. The second command, issued for the target standby <code class="codeph">South_Sales</code>, shows the current primary, <code class="codeph">North_Sales</code>, as the target standby&#39;s future target standby should it ever take over as a primary.</p>
<pre dir="ltr">DGMGRL&gt; SHOW DATABASE &#39;North_Sales&#39; FastStartFailoverTarget;
 FastStartFailoverTarget=&#39;South_Sales&#39;;
 
DGMGRL&gt; SHOW DATABASE &#39;South_Sales&#39; FastStartFailoverTarget;
 FastStartFailoverTarget=&#39;North_Sales&#39;;
</pre></div>
</li>
</ol>
</div>
</div>
<a id="DGBKR3866"></a>
<div class="props_rev_3"><a id="GUID-09A3230B-A2A2-449D-89E0-EDDBD76A157C"></a>
<h2 id="DGBKR-GUID-09A3230B-A2A2-449D-89E0-EDDBD76A157C" class="sect2"><span class="enumeration_section">6.8</span> Scenario 7: Enabling Fast-Start Failover When a Far Sync Instance Is In Use</h2>
<div>
<div class="section">
<p>Fast-start failover can be enabled in maximum availability mode when the fast-start failover target is a logical or physical standby database that receives redo data from a far sync instance.</p>
<p>To enable fast-start failover when a far sync instance is used to ship redo data to the standby database, the <code class="codeph">FastStartFailoverTarget</code> property must first be set on both the primary and target standby database, as follows:</p>
<pre dir="ltr">DGMGRL&gt; EDIT DATABASE &#39;North_Sales&#39; SET PROPERTY FastStartFailoverTarget=&#39;South_Sales&#39;;
DGMGRL&gt; EDIT DATABASE &#39;South_Sales&#39; SET PROPERTY FastStartFailoverTarget=&#39;North_Sales&#39;;
</pre>
<p>Then, fast-start failover can be enabled, as follows:</p>
<pre dir="ltr">DGMGRL&gt; ENABLE FAST_START FAILOVER;
</pre>
<p>Note that the far sync instance database is not specified as the fast-start failover target for either <code class="codeph">North_Sales</code> or <code class="codeph">South_Sales</code>.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR525"></a>
<div class="props_rev_3"><a id="GUID-EF93CD0C-B038-4442-9D7F-F0B2B48F8927"></a>
<h2 id="DGBKR-GUID-EF93CD0C-B038-4442-9D7F-F0B2B48F8927" class="sect2"><span class="enumeration_section">6.9</span> Scenario 8: Performing Routine Management Tasks</h2>
<div>
<p>There may be situations in which you want to <a id="d20074e1423" class="indexterm-anchor"></a><a id="d20074e1429" class="indexterm-anchor"></a><a id="d20074e1433" class="indexterm-anchor"></a>change the <a id="d20074e1438" class="indexterm-anchor"></a>state or properties of the databases in a broker configuration to perform routine maintenance on one or more databases. You might also need to temporarily disable broker management of databases in a configuration.</p>
</div>
<a id="DGBKR530"></a>
<div class="props_rev_3"><a id="GUID-8939FDE1-19B9-477E-99F8-5353BDD3AEC2"></a>
<h3 id="DGBKR-GUID-8939FDE1-19B9-477E-99F8-5353BDD3AEC2" class="sect3"><span class="enumeration_section">6.9.1</span> Changing Properties and States</h3>
<div>
<p>As you monitor the configuration, you might need to dynamically modify the states of the databases or their properties. The following sections show how to change the state or properties of the databases in the configuration.</p>
</div>
<a id="DGBKR535"></a>
<div class="props_rev_3"><a id="GUID-13678A7F-F1C7-4676-AD1C-7658461B39B0"></a>
<h4 id="DGBKR-GUID-13678A7F-F1C7-4676-AD1C-7658461B39B0" class="sect4"><span class="enumeration_section">6.9.1.1</span> Alter a Database Property</h4>
<div>
<div class="section">
<p>You can modify the values of database properties at any time&mdash;if the database is enabled or disabled.</p>
<p>The following example shows how to use the <code class="codeph">EDIT DATABASE</code> command to change the <code class="codeph">LogXptMode</code> database property to the value ASYNC for the <code class="codeph">North_Sales</code> database.</p>
<pre dir="ltr">DGMGRL&gt; <a id="d20074e1509" class="indexterm-anchor"></a>EDIT DATABASE &#39;North_Sales&#39; SET PROPERTY &#39;LogXptMode&#39;=ASYNC;
</pre>
<p>DGMGRL returns the following message to indicate that the <code class="codeph">LogXptMode</code> property was updated successfully in the Data Guard configuration file:</p>
<pre dir="ltr">Property &#34;LogXptMode&#34; updated 
</pre>
<p>If the configuration is currently disabled, the database does not use the new property value until you enable the broker configuration with the <code class="codeph">ENABLE CONFIGURATION</code> command.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR3867"></a>
<div class="props_rev_3"><a id="GUID-EF4BE10B-1B4E-43B5-B098-1D9059FE1C7D"></a>
<h4 id="DGBKR-GUID-EF4BE10B-1B4E-43B5-B098-1D9059FE1C7D" class="sect4"><span class="enumeration_section">6.9.1.2</span> Reset a Property to Its Default Value</h4>
<div>
<div class="section">
<p>You can reset a configuration or configurable property to its default value at any time if the database or configuration is enabled or disabled.</p>
<p>The following example shows how to use the <code class="codeph">EDIT</code> <code class="codeph">DATABASE</code> command to reset the <code class="codeph">LogXptMode</code> database configurable property to its default value for the <code class="codeph">North_Sales</code> database.</p>
<pre dir="ltr">EDIT DATABASE &#39;North_Sales&#39; RESET PROPERTY LogXptMode;
</pre>
<p>The following example shows how to use the <code class="codeph">EDIT</code> <code class="codeph">CONFIGURATION</code> command to reset the <code class="codeph">TraceLevel</code> configuration property to its default value.</p>
<pre dir="ltr">EDIT CONFIGURATION RESET PROPERTY TraceLevel;
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DGBKR540"></a>
<div class="props_rev_3"><a id="GUID-269E0143-7540-4D2C-9AE7-0E4F5E6A4D93"></a>
<h4 id="DGBKR-GUID-269E0143-7540-4D2C-9AE7-0E4F5E6A4D93" class="sect4"><span class="enumeration_section">6.9.1.3</span> Alter the State of a Standby Database</h4>
<div>
<div class="section">
<p>You might want to temporarily stop Redo Apply on a physical standby. To change the state of the standby database to <code class="codeph">APPLY-OFF</code>, enter the <code class="codeph">EDIT DATABASE</code> command as shown in the following example.</p>
<pre dir="ltr">DGMGRL&gt; <a id="d20074e1618" class="indexterm-anchor"></a>EDIT DATABASE &#39;South_Sales&#39; SET STATE=&#39;APPLY-OFF&#39;;
Succeeded.
</pre>
<p>Redo data is still being received when you put the physical standby database in the <code class="codeph">APPLY-OFF</code> state.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR545"></a>
<div class="props_rev_3"><a id="GUID-541AB954-CE70-4B06-A9B7-AA31112C2669"></a>
<h4 id="DGBKR-GUID-541AB954-CE70-4B06-A9B7-AA31112C2669" class="sect4"><span class="enumeration_section">6.9.1.4</span> Alter the State of a Primary Database</h4>
<div>
<div class="section">
<p>You might want to stop the transmittal of redo data to the standby database. To change the state of the primary database to accommodate this, use the following command:</p>
<pre dir="ltr">DGMGRL&gt; EDIT DATABASE North_Sales SET STATE=TRANSPORT-OFF;
 
Succeeded.
</pre>
<p>To change the state of the primary database back to TRANSPORT-ON, do the following:</p>
<pre dir="ltr">DGMGRL&gt; EDIT DATABASE North_Sales SET STATE=TRANSPORT-ON;
 
Succeeded.
</pre></div>
<!-- class="section" --></div>
</div>
</div>
<a id="DGBKR550"></a>
<div class="props_rev_3"><a id="GUID-C9CA2EBC-F9DB-4B76-87AB-CC8E3D4A2879"></a>
<h3 id="DGBKR-GUID-C9CA2EBC-F9DB-4B76-87AB-CC8E3D4A2879" class="sect3"><span class="enumeration_section">6.9.2</span> Disabling the Configuration and Databases</h3>
<div>
<p>When you <a id="d20074e1687" class="indexterm-anchor"></a><a id="d20074e1691" class="indexterm-anchor"></a>disable the broker configuration or any of its databases, you are disabling the broker&#39;s management of them and are effectively removing your ability to use DGMGRL to manage and monitor them. However, disabling the broker&#39;s management of a broker configuration does not affect the actual operation of the underlying Oracle Data Guard configuration or the databases. For example, the redo transport services and log apply services in the Oracle Data Guard configuration continue to function unchanged, but you can no longer manage them.</p>
</div>
<a id="DGBKR555"></a>
<div class="props_rev_3"><a id="GUID-F5AE66C9-A0C6-4C9C-BEEB-B037FE900F39"></a>
<h4 id="DGBKR-GUID-F5AE66C9-A0C6-4C9C-BEEB-B037FE900F39" class="sect4"><span class="enumeration_section">6.9.2.1</span> Disable a Configuration</h4>
<div>
<p>You must use the <code class="codeph">DISABLE CONFIGURATION</code> command to disable management of the entire broker configuration including the primary database as shown in the following example.</p>
<pre dir="ltr">DGMGRL&gt; <a id="d20074e1723" class="indexterm-anchor"></a>DISABLE CONFIGURATION;
</pre>
<p>The only way to disable broker management of the primary database is to use the <code class="codeph">DISABLE CONFIGURATION</code> command; the <code class="codeph">DISABLE DATABASE</code> command only disables management of a standby database. Likewise, the <code class="codeph">DISABLE</code> <code class="codeph">FAR_SYNC</code> command only disables management of a far sync instance.</p>
<div class="infobox-note" id="GUID-F5AE66C9-A0C6-4C9C-BEEB-B037FE900F39__GUID-33739F06-9B13-4E45-81BD-926113EB1A2A">
<p class="notep1">Note:</p>
<p>If you disable management of a configuration while connected to the standby database or far sync instance, you must connect to the primary database (that is, a database whose control file role is primary) to reenable the configuration.</p>
</div>
<p>Disabling the broker&#39;s management of a configuration member does not remove the member from the broker configuration file. You can reenable your ability to use DGMGRL (or Cloud Control) to manage the member by entering the appropriate <code class="codeph">ENABLE</code> <code class="codeph">CONFIGURATION</code> or <code class="codeph">ENABLE DATABASE</code> command.</p>
</div>
</div>
<a id="DGBKR560"></a>
<div class="props_rev_3"><a id="GUID-84500DF2-D9A5-4E4A-B09B-9F1EE56562D1"></a>
<h4 id="DGBKR-GUID-84500DF2-D9A5-4E4A-B09B-9F1EE56562D1" class="sect4"><span class="enumeration_section">6.9.2.2</span> Disable a Standby Database</h4>
<div>
<p>You use the <code class="codeph">DISABLE DATABASE</code> command when you temporarily do not want the broker to manage and monitor a standby database.</p>
<p>You can explicitly disable broker management of a standby database to prevent it from being enabled when the rest of the configuration is enabled. The following example shows how to disable the <code class="codeph">South_Sales</code> standby database.</p>
<pre dir="ltr">DGMGRL&gt; <a id="d20074e1794" class="indexterm-anchor"></a>DISABLE DATABASE &#39;South_Sales&#39;;
Disabled.
</pre>
<div class="infobox-note" id="GUID-84500DF2-D9A5-4E4A-B09B-9F1EE56562D1__GUID-23E0E06A-D8F1-48FD-B95A-2D7C277440B9">
<p class="notep1">Note:</p>
<p>You cannot disable a standby database from the configuration if fast-start failover is enabled and the database to be disabled is the target standby database.</p>
</div>
<div class="infobox-note" id="GUID-84500DF2-D9A5-4E4A-B09B-9F1EE56562D1__GUID-9ABD9082-DAC2-4670-9AF4-053576624FEB">
<p class="notep1">Note:</p>
<p>If you disable management of a standby database while connected to that standby database, you must connect to the primary database or another enabled standby database to reenable broker-management of the standby database.</p>
</div>
<div class="infoboxnotewarn" id="GUID-84500DF2-D9A5-4E4A-B09B-9F1EE56562D1__GUID-D6365D4F-2091-452D-8714-43211F8BB9C7">
<p class="notep1">WARNING:</p>
<p>If you disable broker management of a standby database in the broker configuration, that standby database cannot be used by the broker as a failover target in the event of loss of the primary database.</p>
</div>
<p>When operating under either maximum protection mode or maximum availability mode, the broker prevents you from disabling the last standby database that supports the protection mode.</p>
</div>
</div>
<a id="DGBKR3870"></a>
<div class="props_rev_3"><a id="GUID-567D825A-42F7-45AD-869C-8CA2C1191609"></a>
<h4 id="DGBKR-GUID-567D825A-42F7-45AD-869C-8CA2C1191609" class="sect4"><span class="enumeration_section">6.9.2.3</span> Disabling a Far Sync Instance</h4>
<div>
<p>Use the <code class="codeph">DISABLE</code> <code class="codeph">FAR_SYNC</code> command when you temporarily do not want the broker to manage and monitor a far sync instance.</p>
<p>You can explicitly disable broker management of a far sync instance to prevent it from being enabled when the rest of the configuration is enabled. The following example shows how to disable the far sync instance.</p>
<pre dir="ltr">DGMGRL&gt; DISABLE FAR_SYNC &#39;FS&#39;;
Disabled.
</pre>
<div class="infobox-note" id="GUID-567D825A-42F7-45AD-869C-8CA2C1191609__GUID-0F231930-FDBF-47FC-A69C-A8146BFA8C8F">
<p class="notep1">Note:</p>
<p>The following restrictions apply when disabling a far sync instance:</p>
<ul style="list-style-type: disc;">
<li>
<p>You cannot disable a far sync instance if it is specified in the <code class="codeph">RedoRoutes</code> property of any other configuration member.</p>
</li>
<li>
<p>If you disable management of a far sync instance while connected to that far sync instance, you must connect to the primary database or another enabled standby database to reenable broker management of the far sync instance.</p>
</li>
</ul>
</div>
<div class="infobox-note" id="GUID-567D825A-42F7-45AD-869C-8CA2C1191609__GUID-C47C7C9E-DD49-43D4-96EC-2650C10D2867">
<p class="notep1">Caution:</p>
<p>If you disable broker management of a far sync instance in the broker configuration, that far sync instance cannot be specified in a <code class="codeph">RedoRoutes</code> property for any other configuration member.</p>
</div>
</div>
</div>
</div>
<a id="DGBKR565"></a>
<div class="props_rev_3"><a id="GUID-820B4A3F-6FA3-4CC7-A06E-27BE25AB66F4"></a>
<h3 id="DGBKR-GUID-820B4A3F-6FA3-4CC7-A06E-27BE25AB66F4" class="sect3"><span class="enumeration_section">6.9.3</span> Removing the Configuration, a Standby Database, or a Far Sync Instance</h3>
<div>
<p>When you use the <code class="codeph">REMOVE</code> <code class="codeph">CONFIGURATION</code>, <code class="codeph">REMOVE</code> <code class="codeph">DATABASE</code>, or <code class="codeph">REMOVE</code> <code class="codeph">FAR_SYNC</code> command, you effectively delete the configuration, standby database, or far sync instance from the broker configuration file, removing the ability of Oracle Data Guard broker to manage them.</p>
<p>A remove operation with the <code class="codeph">PRESERVE DESTINATIONS</code> clause <span class="italic">does not</span> remove or delete the actual Oracle Data Guard configuration underneath, nor does it affect the operation of the actual Oracle Data Guard configuration and its databases.</p>
<div class="infobox-note" id="GUID-820B4A3F-6FA3-4CC7-A06E-27BE25AB66F4__GUID-07B5045D-3975-47B0-9316-5C87935E952D">
<p class="notep1">Note:</p>
<p>After you use the <code class="codeph">REMOVE</code> <code class="codeph">CONFIGURATION</code>, <code class="codeph">REMOVE</code> <code class="codeph">DATABASE</code>, or <code class="codeph">REMOVE</code> <code class="codeph">FAR_SYNC</code> command, you must reissue the command(s) that you originally issued if you decide to re-create the deleted object. You must go through the steps in <a href="cli.htm#GUID-EBCA7643-F1D9-4EA0-BC5F-45AEEDEBC5BC">Scenario 1: Creating a Configuration</a> as necessary, to create a broker configuration that can be managed with DGMGRL (or Cloud Control).</p>
</div>
<div class="infobox-note" id="GUID-820B4A3F-6FA3-4CC7-A06E-27BE25AB66F4__GUID-CA141A80-2F32-44F4-AA0E-35B1ED718EDC">
<p class="notep1">Note:</p>
<p>The following restrictions apply:</p>
<ul style="list-style-type: disc;">
<li>
<p>You cannot remove a standby database from the configuration if fast-start failover is enabled and the database to be removed is the target standby database.</p>
</li>
<li>
<p>You cannot remove a standby database or a far sync instance if it is specified in the <code class="codeph">RedoRoutes</code> property for any other member in the configuration.</p>
</li>
</ul>
</div>
</div>
<div class="props_rev_3"><a id="GUID-6E5F263A-2E28-4B88-B683-F542C426A554"></a>
<h4 id="DGBKR-GUID-6E5F263A-2E28-4B88-B683-F542C426A554" class="sect4"><span class="enumeration_section">6.9.3.1</span> Removing a Standby Database from the Configuration</h4>
<div>
<div class="section">
<p>When you use the <code class="codeph">REMOVE</code> <code class="codeph">DATABASE</code> command, broker management and monitoring of the database ceases and the database is deleted from the broker configuration file.</p>
<p>Show the configuration before deletion of the <code class="codeph">South_Sales</code> standby database:</p>
<pre dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;
 
Configuration - DRSolution
 
  Protection Mode: MaxPerformance
  Databases:
    North_Sales  - Primary database
      FS - Far Sync
        South_Sales  - Physical standby database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
SUCCESS
</pre>
<p>Issue the DGMGRL <code class="codeph">REMOVE DATABASE</code> command to remove the <code class="codeph">South_Sales</code> database information from the Data Guard configuration file:</p>
<pre dir="ltr">DGMGRL&gt; REMOVE DATABASE &#39;South_Sales&#39;;
Removed database &#34;South_Sales&#34; from the configuration
</pre>
<p>Show the configuration after deletion of the <code class="codeph">South_Sales</code> standby database:</p>
<pre dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;
 
Configuration - DRSolution
 
  Protection Mode: MaxPerformance
  Databases:
    North_Sales  - Primary database
      FS - Far Sync
 
Fast-Start Failover: DISABLED
 
Configuration Status:
SUCCESS
</pre>
<p>When operating under either maximum protection mode or maximum availability mode, the broker prevents you from deleting the last standby database that supports the protection mode.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-6CD89529-74EC-4BE6-BC9C-8BFF01D38E7D"></a>
<h4 id="DGBKR-GUID-6CD89529-74EC-4BE6-BC9C-8BFF01D38E7D" class="sect4"><span class="enumeration_section">6.9.3.2</span> Removing a Far Sync Instance from the Configuration</h4>
<div>
<div class="section">
<p>Use the following command to remove the <code class="codeph">FS</code> far sync instance information from the Oracle Data Guard configuration file:</p>
<pre dir="ltr">DGMGRL&gt; REMOVE FAR_SYNC &#39;FS&#39;;
Removed far sync instance &#34;FS&#34; from the configuration
</pre>
<p>Show the configuration after deletion of the <code class="codeph">FS</code> far sync instance:</p>
<pre dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;
 
Configuration - DRSolution
 
Protection Mode: MaxPerformance
Databases:
North_Sales - Primary database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
SUCCESS
</pre></div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-E2300CF1-C3E4-4C03-812C-316B064A12C5"></a>
<h4 id="DGBKR-GUID-E2300CF1-C3E4-4C03-812C-316B064A12C5" class="sect4"><span class="enumeration_section">6.9.3.3</span> Removing a Broker Configuration</h4>
<div>
<div class="section">
<p>Use the following command to remove the entire configuration from management and monitoring by the broker:</p>
<pre dir="ltr">DGMGRL&gt; <a id="d20074e2064" class="indexterm-anchor"></a>REMOVE CONFIGURATION;
</pre>
<div class="infobox-note" id="GUID-E2300CF1-C3E4-4C03-812C-316B064A12C5__GUID-7FF7ABFB-321C-40E4-BB46-E3682BCED3E0">
<p class="notep1">Note:</p>
<p>You cannot remove the configuration if fast-start failover is enabled.</p>
</div>
<p>DGMGRL returns the following message to indicate the command successfully removed all of the configuration information from the Data Guard configuration file:</p>
<pre dir="ltr">Removed configuration
 
DGMGRL&gt; SHOW CONFIGURATION;
Error: ORA-16532: Data Guard broker configuration does not exist
 
Configuration details cannot be determined by DGMGRL
</pre></div>
<!-- class="section" --></div>
</div>
</div>
</div>
<a id="DGBKR570"></a>
<div class="props_rev_3"><a id="GUID-1403D1C3-8944-42D0-8BDA-21D695C7958A"></a>
<h2 id="DGBKR-GUID-1403D1C3-8944-42D0-8BDA-21D695C7958A" class="sect2"><span class="enumeration_section">6.10</span> Scenario 9: Performing a Switchover Operation</h2>
<div>
<p>You can switch the role of the primary database and a standby database using the <code class="codeph">SWITCHOVER</code> command. Before you issue the <a id="d20074e2101" class="indexterm-anchor"></a><a id="d20074e2103" class="indexterm-anchor"></a><a id="d20074e2109" class="indexterm-anchor"></a><code class="codeph">SWITCHOVER</code> command, you must ensure:</p>
<ul style="list-style-type: disc;">
<li>
<p>The state of the primary and standby databases are <code class="codeph">TRANSPORT-ON</code> and <code class="codeph">APPLY-ON</code>, respectively.</p>
</li>
<li>
<p>All participating databases are in good health, without any errors or warnings present.</p>
</li>
<li>
<p>The standby database properties were set on the primary database, so that the primary database can function correctly when transitioning to a standby database (shown in the following examples in boldface type).</p>
</li>
<li>
<p>Standby redo log files are configured on the primary database.</p>
</li>
<li>
<p>If the configuration is in maximum availability mode, then the current primary is configured to receive redo via <code class="codeph">SYNC</code> or <code class="codeph">FASTSYNC</code> mode if it will receive redo directly from the new primary. If it will receive redo via a far sync instance, then the far sync instance is configured to receive redo via <code class="codeph">SYNC</code> or <code class="codeph">FASTSYNC</code> mode and the current primary is configured to receive redo via <code class="codeph">ASYNC</code> mode. If the configuration is in maximum protection mode, then the current primary is configured to receive redo via <code class="codeph">SYNC</code> mode.</p>
</li>
<li>
<p>If fast-start failover is enabled, you can perform a switchover only to the standby database that was specified as the target standby database.</p>
</li>
</ul>
<p>The following are the tasks necessary to perform a switchover using the <code class="codeph">SWITCHOVER</code> command:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="cli.htm#GUID-B56AA048-02D8-49F4-819C-0B7064E37826">Using the SWITCHOVER Command Task 1: Check the Primary Database</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-1BB2F379-C18F-428A-9BF0-AD25B6802285">Using the SWITCHOVER Command Task 2: Check the Standby Database That is the Target of the Switchover</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-93CA2A90-66C5-4DC8-A39B-5486FD2FC4FD">Using the SWITCHOVER Command Task 3: Confirm That the Database Is Ready for a Role Change</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-486321F6-8816-4966-8813-EB5514A38FF2">Using the SWITCHOVER Command Task 4: Issue the Switchover Command</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-DE45B0C6-0536-4852-B66A-CECA69CEF4DD">Using the SWITCHOVER Command Task 5: Show the Configuration</a></p>
</li>
</ul>
</div>
<div class="props_rev_3"><a id="GUID-B56AA048-02D8-49F4-819C-0B7064E37826"></a>
<h3 id="DGBKR-GUID-B56AA048-02D8-49F4-819C-0B7064E37826" class="sect3"><span class="enumeration_section">6.10.1</span> Using the SWITCHOVER Command Task 1: Check the Primary Database</h3>
<div>
<div class="section">
<p>Use the <code class="codeph">SHOW DATABASE VERBOSE</code> command to check the state, health, and properties of the primary database, as follows:</p>
<pre dir="ltr">DGMGRL&gt; SHOW DATABASE VERBOSE &#39;North_Sales&#39;;
 
Database - North_Sales
 
  Role:            PRIMARY
  Intended State:  TRANSPORT-ON
  Instance(s):
    north_sales1
 
  Properties:
    DGConnectIdentifier             = &#39;North_Sales.example.com&#39;
    ObserverConnectIdentifier       = &#39;&#39;
    <span class="bold">LogXptMode                      = &#39;ASYNC&#39;</span>
    RedoRoutes                      = &#39;&#39;
    DelayMins                       = &#39;0&#39;
    Binding                         = &#39;optional&#39;
    MaxFailure                      = &#39;0&#39;
    MaxConnections                  = &#39;1&#39;
    ReopenSecs                      = &#39;300&#39;
    NetTimeout                      = &#39;30&#39;
    RedoCompression                 = &#39;DISABLE&#39;
    LogShipping                     = &#39;ON&#39;
    PreferredApplyInstance          = &#39;&#39;
    ApplyInstanceTimeout            = &#39;0&#39;
    ApplyLagThreshold               = &#39;0&#39;
    TransportLagThreshold           = &#39;0&#39;
    TransportDisconnectedThreshold  = &#39;0&#39;
    ApplyParallel                   = &#39;AUTO&#39;
    StandbyFileManagement           = &#39;AUTO&#39;
    ArchiveLagTarget                = &#39;0&#39;
    LogArchiveMaxProcesses          = &#39;5&#39;
    LogArchiveMinSucceedDest        = &#39;1&#39;
    <span class="bold">DbFileNameConvert               = &#39;dbs/bt, dbs/t, dbs/ct, dbs/t&#39;</span>
    <span class="bold">LogFileNameConvert              = &#39;dbs/bt, dbs/t, dbs/ct, dbs/t&#39;</span>
    FastStartFailoverTarget         = &#39;South_Sales&#39;
    InconsistentProperties          = &#39;(monitor)&#39;
    InconsistentLogXptProps         = &#39;(monitor)&#39;
    SendQEntries                    = &#39;(monitor)&#39;
    LogXptStatus                    = &#39;(monitor)&#39;
    RecvQEntries                    = &#39;(monitor)&#39;
    StaticConnectIdentifier         = &#39;DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=north_sales1.example.com)(PORT=2840))
(CONNECT_DATA=(SERVICE_NAME=North_Sales_DGMGRL.example.com)(INSTANCE_NAME=north_sales1)(SERVER=DEDICATED)))&#39;
    <span class="bold">StandbyArchiveLocation          = &#39;USE_DB_RECOVERY_FILE_DEST&#39;</span>
    AlternateLocation               = &#39;&#39;
    LogArchiveTrace                 = &#39;255&#39;
    <span class="bold">LogArchiveFormat                = &#39;db1r_%d_%t_%s_%R.arc&#39;</span>
    TopWaitEvents                   = &#39;(monitor)&#39;
 
Database Status:
SUCCESS
</pre>
<p>In particular, you should examine the boldface properties and the current status of the primary database. See <a href="dbresource.htm#GUID-0CD70A29-4F51-4CC1-88EB-2D8AA29F75D7">Managing the Members of a Broker Configuration</a> for information about managing databases.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-1BB2F379-C18F-428A-9BF0-AD25B6802285"></a>
<h3 id="DGBKR-GUID-1BB2F379-C18F-428A-9BF0-AD25B6802285" class="sect3"><span class="enumeration_section">6.10.2</span> Using the SWITCHOVER Command Task 2: Check the Standby Database That is the Target of the Switchover</h3>
<div>
<div class="section">
<p>Use the <code class="codeph">SHOW DATABASE</code> command to check the status of the standby database that is the target of the switchover. For example:</p>
<pre dir="ltr">DGMGRL&gt; SHOW DATABASE &#39;South_Sales&#39;;
 
Database - South_Sales
 
  Role: PHYSICAL STANDBY
  Intended State: APPLY-ON
  Transport Lag: 0 seconds (computed 0 seconds ago)
  Apply Lag: 0 seconds (computed 0 seconds ago)
  Apply Rate: 1.44 MByte/s
  Real Time Query: OFF
  Instance(s):
    south_sales1
 
Database Status:
SUCCESS
</pre></div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-93CA2A90-66C5-4DC8-A39B-5486FD2FC4FD"></a>
<h3 id="DGBKR-GUID-93CA2A90-66C5-4DC8-A39B-5486FD2FC4FD" class="sect3"><span class="enumeration_section">6.10.3</span> Using the SWITCHOVER Command Task 3: Confirm That the Database Is Ready for a Role Change</h3>
<div>
<div class="section">
<p>Prior to performing a role change, you can use the <code class="codeph">VALIDATE</code> <code class="codeph">DATABASE</code> command to perform an exhaustive set of checks on the database to confirm that it is ready for a role change.</p>
<p>The examples shown in this step use the <code class="codeph">VALIDATE</code> <code class="codeph">DATABASE</code> command for all three databases in the <code class="codeph">DRSolution</code> configuration: a primary, logical standby, and physical standby database. The configuration looks as follows:</p>
<pre dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;
 
Configuration - DRSolution
 
  Protection Mode: MaxAvailability
  Databases:
  North_Sales - Primary database
    West_Sales - Logical standby database
    South_Sales - Physical standby database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
SUCCESS
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Example: Validate the Primary Database</p>
</div>
<!-- class="section" -->
<div class="section">
<pre dir="ltr">DGMGRL&gt; VALIDATE DATABASE &#39;North_Sales&#39;;
 
  Database Role:    Primary database
 
  Ready for Switchover:  Yes
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Example: Validate the Logical Standby Database</p>
</div>
<!-- class="section" -->
<div class="section">
<p>Validate the logical standby database, as follows:</p>
<pre dir="ltr">DGMGRL&gt; VALIDATE DATABASE &#39;West_Sales&#39;;
 
  Database Role:     Logical standby database
  Primary Database:  North_Sales
 
  Ready for Switchover:  Yes
  Ready for Failover:    Yes (Primary Running)
    Warning: Physical and snapshot standby databases will
    be disabled if a role change is performed to this database
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Example: Validate the Physical Standby Database</p>
</div>
<!-- class="section" -->
<div class="section">
<p>Validate the physical standby database, as follows:</p>
<pre dir="ltr">DGMGRL&gt; VALIDATE DATABASE &#39;South_Sales&#39;;
 
  Database Role:     Physical standby database
  Protection Mode:   MaxAvailability
    Error: Switchover to this standby is not possible since there
    are no other standbys that can support the protection mode
 
  Primary Database:  North_Sales
 
  Ready for Switchover:  No
  Ready for Failover:    Yes (Primary Running)
 
  Transport-Related Property Settings:
    Property                        North_Sales Value        South_Sales Value
    LogXptMode                      ASYNC                    SYNC
</pre>
<p>Because the configuration protection is set to maximum availability mode and database <code class="codeph">South_Sales</code> is the only one that has its <code class="codeph">LogXptMode</code> property set to <code class="codeph">SYNC</code>, an error is displayed to indicate that a switchover is not possible. Note that when a database receives redo from a database or a far sync instance that has the <code class="codeph">RedoRoutes</code> property configured with a transport mode, that mode overrides the transport mode specified by <code class="codeph">LogXptMode</code>.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-486321F6-8816-4966-8813-EB5514A38FF2"></a>
<h3 id="DGBKR-GUID-486321F6-8816-4966-8813-EB5514A38FF2" class="sect3"><span class="enumeration_section">6.10.4</span> Using the SWITCHOVER Command Task 4: Issue the Switchover Command</h3>
<div>
<div class="section">
<p>Issue the <code class="codeph">SWITCHOVER</code> command to swap the roles of the primary and standby databases. The following example shows how the broker automatically shuts down and restarts the old primary database as a part of the switchover. (See the usage notes in <a href="dgmgrl.htm#GUID-AC5DA9D2-5E60-4484-9099-0388BF238ACA">DGMGRL Command Usage Notes</a> for information about how to set up the broker environment so that DGMGRL can automatically restart the primary and standby databases for you.)</p>
<pre dir="ltr">DGMGRL&gt; SWITCHOVER TO &#39;South_Sales&#39;;
Performing switchover NOW, please wait...
Operation requires a connection to instance &#34;south_sales1&#34; on database &#34;South_Sales&#34;
Connecting to instance &#34;south_sales1&#34;...
Connected as SYSDBA.
New primary database &#34;South_Sales&#34; is opening...
Operation requires startup of instance &#34;north_sales1&#34; on database &#34;North_Sales&#34;
Starting instance &#34;north_sales1&#34;...
ORACLE instance started.
Database mounted.
Switchover succeeded, new primary is &#34;South_Sales&#34;
</pre>
<p>After the switchover completes, use the <code class="codeph">SHOW CONFIGURATION</code> and <code class="codeph">SHOW DATABASE</code> commands to verify that the switchover operation was successful.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-DE45B0C6-0536-4852-B66A-CECA69CEF4DD"></a>
<h3 id="DGBKR-GUID-DE45B0C6-0536-4852-B66A-CECA69CEF4DD" class="sect3"><span class="enumeration_section">6.10.5</span> Using the SWITCHOVER Command Task 5: Show the Configuration</h3>
<div>
<div class="section">
<p>Issue the <code class="codeph">SHOW CONFIGURATION</code> command to verify that the switchover was successful.</p>
<pre dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;
 
Configuration - DRSolution
 
  Protection Mode: MaxAvailability
  Databases:
    South_Sales  - Primary database
      West_Sales  - Logical standby database
      North_Sales - Physical standby database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
SUCCESS
</pre></div>
<!-- class="section" --></div>
</div>
</div>
<a id="DGBKR575"></a>
<div class="props_rev_3"><a id="GUID-630F5987-328C-410C-AE3B-A9D66EB233D4"></a>
<h2 id="DGBKR-GUID-630F5987-328C-410C-AE3B-A9D66EB233D4" class="sect2"><span class="enumeration_section">6.11</span> Scenario 10: Performing a Manual Failover Operation</h2>
<div>
<div class="section">
<p>You invoke a <a id="d20074e2436" class="indexterm-anchor"></a><a id="d20074e2438" class="indexterm-anchor"></a><a id="d20074e2444" class="indexterm-anchor"></a><a id="d20074e2448" class="indexterm-anchor"></a>failover operation in response to an emergency situation, usually when the primary database cannot be accessed or is unavailable. See <a href="sofo.htm#GUID-2AEF86C4-3CFA-4CF5-AEF3-E25871298363">Choosing a Target Standby Database</a> before you fail over to decide which standby database should be the target of the failover. The following scenario describes a failover to the remote database called <code class="codeph">South_Sales</code>.</p>
<div class="infobox-note" id="GUID-630F5987-328C-410C-AE3B-A9D66EB233D4__GUID-03286FB9-6404-4790-9138-CDD43199D629">
<p class="notep1">Note:</p>
<p>If fast-start failover is enabled, you can perform a manual failover only to the standby database that was specified as the target of a fast-start failover and only when the observer is running and currently has connectivity with the standby database.</p>
<p>If you want to perform a manual failover to a standby database that is not the fast-start failover target standby database, you must first disable fast-start failover using the <code class="codeph">FORCE</code> option on the standby database you want to fail over. See <a href="sofo.htm#GUID-67878B37-39B5-402A-A219-69E7483405A1">Disabling Fast-Start Failover</a> for more information about the <code class="codeph">FORCE</code> option.</p>
</div>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>(Optional) Check the readiness of the target standby.</span>
<div>
<p>To validate the target standby database to ensure that it&#39;s ready to become the new primary database, use the <code class="codeph">VALIDATE</code> <code class="codeph">DATABASE</code> command, as shown in the following example:</p>
<pre dir="ltr">DGMGRL&gt; VALIDATE DATABASE &#39;South_Sales&#39;;
 
Database Role: Physical standby database
Primary Database: South_Sales
 
Ready for Switchover: Yes
Ready for Failover: Yes
</pre></div>
</li>
<li class="stepexpand"><span>To perform the failover operation, you must connect to the standby database to which you want to fail over as a user that has the <code class="codeph">SYSDG</code> or <code class="codeph">SYSDBA</code> privilege. For example:</span>
<div>
<pre dir="ltr">DGMGRL&gt; CONNECT sysdg@South_Sales.example.com;
Password: <span class="italic">password</span>
Connected as SYSDG.
</pre></div>
</li>
<li class="stepexpand"><span>Now you can issue the failover command to make the target standby database the new primary database for the configuration.</span>
<div>
<pre dir="ltr">DGMGRL&gt; FAILOVER TO &#39;South_Sales&#39;;
Performing failover NOW, please wait...
Failover succeeded, new primary is &#34;South_Sales&#34;
</pre>
<p>Note that after the failover completes, the original primary database cannot be used as a standby database of the new primary database unless it is reinstated or re-created (as described in <a href="sofo.htm#GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D">Reenabling Disabled Databases After a Role Change</a>).</p>
</div>
</li>
<li class="stepexpand"><span>Issue the SHOW CONFIGURATION command to verify the failover.</span>
<div>
<pre dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;
 
Configuration - DRSolution
 
  Protection Mode: MaxAvailability
  Databases:
    South_Sales  - Primary database
      Warning: ORA-16629: database reports a different protection level from the protection mode
 
      North_Sales - Physical standby database (disabled)
        ORA-16661: the standby database needs to be reinstated
 
Fast-Start Failover: DISABLED
 
Configuration Status:
WARNING
</pre>
<p>Note that in this example, the configuration was operating in maximum availability mode. The protection mode was preserved after the failover. The configuration also has a warning status. The <code class="codeph">SHOW DATABASE</code> command for the new primary shows that the warning is the result of not having an enabled physical standby database. As a result, the warning status indicates that the protection level of the configuration is not the same as the configured mode.</p>
</div>
</li>
<li class="stepexpand"><span>Show the new primary database.</span>
<div>
<pre dir="ltr">DGMGRL&gt; SHOW DATABASE South_Sales;
Database - South_Sales
 
  Role:            PRIMARY
  Intended State:  TRANSPORT-ON
  Instance(s):
    south_sales1
 
  Database Warning(s):
    ORA-16629: database reports a different protection level from the protection mode
 
Database Status:
WARNING
</pre></div>
</li>
<li class="stepexpand"><span>Issue the <code class="codeph">SHOW DATABASE</code> command to see that the former (failed) primary database was disabled by the broker as a consequence of the failover. It must be reinstated (as described in <a href="sofo.htm#GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D">Reenabling Disabled Databases After a Role Change</a>).</span>
<div>
<pre dir="ltr">DGMGRL&gt; SHOW DATABASE &#39;North_Sales&#39;;
Database - North_Sales
 
  Role: PHYSICAL STANDBY
  Intended State: APPLY-ON
  Transport Lag: (unknown)
  Apply Lag: (unknown)
  Apply Rate: (unknown)
  Real Time Query: OFF
  Instance(s):
    north_sales1
 
Database Status:
ORA-16661: the standby database needs to be reinstated
</pre></div>
</li>
</ol>
</div>
</div>
<a id="DGBKR3431"></a>
<div class="props_rev_3"><a id="GUID-D46A9644-136B-4149-8C74-BF4E845B3DE3"></a>
<h2 id="DGBKR-GUID-D46A9644-136B-4149-8C74-BF4E845B3DE3" class="sect2"><span class="enumeration_section">6.12</span> Scenario 11: Reinstating a Failed Primary Database</h2>
<div>
<div class="section">
<p>If your former primary database was configured with Flashback Database, you can easily reinstate the failed primary database as a standby database of the new primary database. The failed primary database will be reinstated as a standby type that matches the old standby database. For example, if you failed over to a physical standby database, the old primary will be reinstated as a physical standby database.</p>
<p>To reinstate the failed primary database, start it to the mounted state. Then run DGMGRL, connect to the new primary database and reinstate the old primary database.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Restart the old primary database:</span>
<div>
<pre dir="ltr">% dgmgrl connect sysdg
Password: <span class="italic">password</span>
Connected as SYSDG.
DGMGRL&gt; startup mount;
ORACLE instance started.
Database mounted.
</pre></div>
</li>
<li class="stepexpand"><span>Reinstate the old primary database:</span>
<div>
<pre dir="ltr">% dgmgrl connect sysdg
Password: <span class="italic">password</span>
Connected as SYSDG.
DGMGRL&gt; REINSTATE DATABASE &#39;North_Sales&#39;;
Reinstating database &#34;North_Sales&#34;, please wait...
Reinstatement of database &#34;North_Sales&#34; succeeded
 
Database dismounted.
ORACLE instance shut down.
Operation requires startup of instance &#34;north_sales1&#34; on database &#34;North_Sales&#34;
Starting instance &#34;north_sales1&#34;...
ORACLE instance started.
Database mounted.
Continuing to reinstate database &#34;North_Sales&#34; ...
Reinstatement of database &#34;North_Sales&#34; succeeded
</pre>
<p>After the primary has been reinstated, issue the <code class="codeph">SHOW CONFIGURATION</code> and <code class="codeph">SHOW DATABASE</code> commands to confirm that the old primary has been successfully reinstated.</p>
</div>
</li>
<li class="stepexpand"><span>Show the configuration and databases:</span>
<div>
<pre dir="ltr">DGMGRL&gt; SHOW CONFIGURATION
 
Configuration - DRSolution
 
  Protection Mode: MaxAvailability
  Databases:
    South_Sales  - Primary database
      North_Sales  - Physical standby database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
SUCCESS

DGMGRL&gt; SHOW DATABASE &#39;South_Sales&#39;;
 
Database - South_Sales
 
  Role:            PRIMARY
  Intended State:  TRANSPORT-ON
  Instance(s):
    south_sales1
 
Database Status:
SUCCESS
 
DGMGRL&gt; SHOW DATABASE &#39;North_Sales&#39;
 
Database - &#39;North_Sales&#39;
 
  Role: PHYSICAL STANDBY
  Intended State: APPLY-ON
  Transport Lag: 0 seconds (computed 1 second ago)
  Apply Lag: 0 seconds (computed 1 second ago)
  Apply Rate: 0 Byte/s
  Real Time Query: OFF
  Instance(s):
    north_sales1
 
Database Status:
SUCCESS
</pre></div>
</li>
</ol>
</div>
</div>
<a id="DGBKR3432"></a>
<div class="props_rev_3"><a id="GUID-05313396-B80D-4F53-BB44-AC7B0FF5E8B4"></a>
<h2 id="DGBKR-GUID-05313396-B80D-4F53-BB44-AC7B0FF5E8B4" class="sect2"><span class="enumeration_section">6.13</span> Scenario 12: Converting a Physical Standby to a Snapshot Standby</h2>
<div>
<div class="section">
<p>If you have a physical standby database that you would like to convert to a snapshot standby database, use the DGMGRL <code class="codeph">CONVERT DATABASE</code> command. Redo data will continue to be received by the database while it is operating as a snapshot standby database, but it will not be applied until the snapshot standby is converted back into a physical standby database.</p>
<p>A physical standby database must be configured with a fast recovery area to convert it to a snapshot standby database. This is because a guaranteed restore point is created during the conversion process, and guaranteed restore points require a fast recovery area.</p>
<pre dir="ltr">DGMGRL&gt; convert database &#39;South_Sales&#39; to snapshot standby;
Converting database &#34;South_Sales&#34; to a Snapshot Standby database, please wait...
Database &#34;South_Sales&#34; converted successfully

DGMGRL&gt; SHOW CONFIGURATION;
 
Configuration - DRSolution
 
  Protection Mode: MaxPerformance
  Databases:
    North_Sales  - Primary database
      South_Sales  - Snapshot standby database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
SUCCESS
</pre>
<p>When you are ready to revert the database back to a physical standby database, use the DGMGRL <code class="codeph">CONVERT DATABASE</code> command again as follows. Any updates made to the database while it was operating as a snapshot standby database will be discarded. All accumulated redo data will be applied by Redo Apply services after the database is converted back to a physical standby database.</p>
<pre dir="ltr">DGMGRL&gt; CONVERT DATABASE &#39;South_Sales&#39; to PHYSICAL STANDBY;
 
Converting database &#34;South_Sales&#34; to a Physical Standby database, please wait...
Operation requires shutdown of instance &#34;south_sales1&#34; on database &#34;South_Sales&#34;
Shutting down instance &#34;south_sales1&#34;...
Database closed.
Database dismounted.
ORACLE instance shut down.
Operation requires startup of instance &#34;south_sales1&#34; on database &#34;South_Sales&#34;
Starting instance &#34;south_sales1&#34;...
ORACLE instance started.
Database mounted.
Continuing to convert database &#34;South_Sales&#34; ...
Database &#34;South_Sales&#34; converted successfully
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DGBKR580"></a>
<div class="props_rev_3"><a id="GUID-13FDC86F-A736-44F0-A2DD-33B7FF3067A7"></a>
<h2 id="DGBKR-GUID-13FDC86F-A736-44F0-A2DD-33B7FF3067A7" class="sect2"><span class="enumeration_section">6.14</span> Scenario 13: Monitoring a Data Guard Configuration</h2>
<div>
<p>The <a id="d20074e2665" class="indexterm-anchor"></a><a id="d20074e2669" class="indexterm-anchor"></a><a id="d20074e2673" class="indexterm-anchor"></a>scenario in this section demonstrates the tasks necessary to use the <code class="codeph">SHOW</code> command and monitorable properties to identify and resolve a failure situation.</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="cli.htm#GUID-17C2B086-D11B-4C63-9AF6-8809FA0CA015">Monitoring a Configuration Task 1: Check the Configuration Status</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-4CA56BEF-3309-48D8-A8C1-4DEA2F5C2B8B">Monitoring a Configuration Task 2: Check the Database Status</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-FCD421A4-EF56-45BB-BE88-F585C84914EE">Monitoring a Configuration Task 3: Check the LogXptStatus Monitorable Property</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-1E835BCE-D741-4A71-97A8-206BAE362A35">Monitoring a Configuration Task 4: Check the InconsistentProperties Monitorable Property</a></p>
</li>
<li>
<p><a href="cli.htm#GUID-2C585CD3-F32B-432F-8DCE-3288344FBA97">Monitoring a Configuration Task 5: Check the InconsistentLogXptProps Monitorable Property</a></p>
</li>
</ul>
</div>
<div class="props_rev_3"><a id="GUID-17C2B086-D11B-4C63-9AF6-8809FA0CA015"></a>
<h3 id="DGBKR-GUID-17C2B086-D11B-4C63-9AF6-8809FA0CA015" class="sect3"><span class="enumeration_section">6.14.1</span> Monitoring a Configuration Task 1: Check the Configuration Status</h3>
<div>
<div class="section">
<p>The status of the broker configuration is an aggregated status of all databases and instances in the broker configuration. You can check the configuration status first to determine whether or not any further action needs to be taken. If the configuration status is SUCCESS, everything in the broker configuration is working properly. However, if you see a status of WARNING or ERROR, then something is wrong in the configuration.</p>
<p>For example, in the following display, you can see that the primary database has multiple warnings:</p>
<pre dir="ltr">DGMGRL&gt; SHOW CONFIGURATION;
Configuration - DRSolution
 
  Protection Mode: MaxPerformance
  Databases:
    North_Sales  - Primary database
      Warning: ORA-16809: multiple warnings detected for the database
 
      South_Sales  - Physical standby database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
WARNING
</pre></div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-4CA56BEF-3309-48D8-A8C1-4DEA2F5C2B8B"></a>
<h3 id="DGBKR-GUID-4CA56BEF-3309-48D8-A8C1-4DEA2F5C2B8B" class="sect3"><span class="enumeration_section">6.14.2</span> Monitoring a Configuration Task 2: Check the Database Status</h3>
<div>
<div class="section">
<p>To identify the warnings on the primary database, show its status using the <code class="codeph">SHOW DATABASE</code> command:</p>
<pre dir="ltr">DGMGRL&gt; SHOW DATABASE &#39;North_Sales&#39;;
Database - North_Sales
 
  Role:            PRIMARY
  Intended State:  TRANSPORT-ON
  Instance(s):
    north_sales1
      Warning: ORA-16737: the redo transport service for standby &#34;South_Sales&#34; has an error
      Warning: ORA-16714: the value of property LogArchiveTrace is inconsistent with the database setting
      Warning: ORA-16715: redo transport-related property ReopenSecs of standby
 database &#34;South_Sales&#34; is inconsistent

Database Status:
WARNING
</pre></div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-FCD421A4-EF56-45BB-BE88-F585C84914EE"></a>
<h3 id="DGBKR-GUID-FCD421A4-EF56-45BB-BE88-F585C84914EE" class="sect3"><span class="enumeration_section">6.14.3</span> Monitoring a Configuration Task 3: Check the LogXptStatus Monitorable Property</h3>
<div>
<div class="section">
<p>The <code class="codeph">SHOW DATABASE</code> output in step 2 shows a Warning for error ORA-16737. To identify the exact transport error, use the <code class="codeph">LogXptStatus</code> monitorable property:</p>
<pre dir="ltr">DGMGRL&gt; SHOW DATABASE &#39;North_Sales&#39; &#39;LogXptStatus&#39;;
LOG TRANSPORT STATUS
PRIMARY_INSTANCE_NAME  STANDBY_DATABASE_NAME  STATUS 
         north_sales1            South_Sales  ORA-12541: TNS:no listener
</pre>
<p>The output shows that the listener for the physical standby database is not running. To fix this error, start the listener for the physical standby database <code class="codeph">South_Sales</code>.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-1E835BCE-D741-4A71-97A8-206BAE362A35"></a>
<h3 id="DGBKR-GUID-1E835BCE-D741-4A71-97A8-206BAE362A35" class="sect3"><span class="enumeration_section">6.14.4</span> Monitoring a Configuration Task 4: Check the InconsistentProperties Monitorable Property</h3>
<div>
<div class="section">
<p>The <code class="codeph">SHOW DATABASE</code> output in step 2 also shows a Warning for error ORA-16714. To identify the exact error, use the <code class="codeph">InconsistentProperties</code> monitorable property:</p>
<pre dir="ltr">DGMGRL&gt; SHOW DATABASE &#39;North_Sales&#39; &#39;InconsistentProperties&#39;;
INCONSISTENT PROPERTIES
 INSTANCE_NAME  PROPERTY_NAME   MEMORY_VALUE SPFILE_VALUE BROKER_VALUE
 north_sales1   LogArchiveTrace 511          255          255
</pre>
<p>The current database memory value (511) is different from both the server parameter file (SPFILE) value (255) and the Oracle Data Guard broker&#39;s property value (255). If you decide the database memory value is correct, you can update the Oracle Data Guard broker&#39;s property value using the following command:</p>
<pre dir="ltr">DGMGRL&gt; EDIT DATABASE &#39;North_Sales&#39; SET PROPERTY &#39;LogArchiveTrace&#39;=511;
Property &#34;LogArchiveTrace&#34; updated
</pre>
<p>This command will result in the broker updating the SPFILE value so that the value of <code class="codeph">LogArchiveTrace</code> is kept consistent.</p>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-2C585CD3-F32B-432F-8DCE-3288344FBA97"></a>
<h3 id="DGBKR-GUID-2C585CD3-F32B-432F-8DCE-3288344FBA97" class="sect3"><span class="enumeration_section">6.14.5</span> Monitoring a Configuration Task 5: Check the InconsistentLogXptProps Monitorable Property</h3>
<div>
<div class="section">
<p>Another warning shown in the <code class="codeph">SHOW DATABASE</code> display in Step 2 is ORA-16715. To identify the inconsistent values for the redo transport database property, <code class="codeph">ReopenSecs</code>, you can use the <code class="codeph">InconsistentLogXptProps</code> monitorable property:</p>
<pre dir="ltr">DGMGRL&gt; SHOW DATABASE &#39;North_Sales&#39; &#39;InconsistentLogXptProps&#39;;
INCONSISTENT LOG TRANSPORT PROPERTIES
 INSTANCE_NAME  STANDBY_NAME  PROPERTY_NAME  MEMORY_VALUE  BROKER_VALUE 
   south_sales1   South_Sales     ReopenSecs           600           300
</pre>
<p>The current database memory value (600) is different from the Oracle Data Guard broker&#39;s property value (300). If you think the broker&#39;s property value is correct, you can fix the inconsistency by re-editing the property of the standby database with the same value, as shown in the following example:</p>
<pre dir="ltr">DGMGRL&gt; EDIT DATABASE &#39;South_Sales&#39; SET PROPERTY &#39;ReopenSecs&#39;=300;
Property &#34;ReopenSecs&#34; updated
</pre>
<p>You can also reenable the standby database or reset the state of the primary database to <code class="codeph">TRANSPORT-ON</code> to fix this inconsistency.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5444">
<tr>
<td class="cellalignment5451">
<table class="cellalignment5449">
<tr>
<td class="cellalignment5448"><a href="sofo.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5448"><a href="dgmgrl.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5453">
<table class="cellalignment5447">
<tr>
<td class="cellalignment5448"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5448"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5448"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5448"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5448"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5448"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>