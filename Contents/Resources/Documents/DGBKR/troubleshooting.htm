<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-5567"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Troubleshooting%20Oracle%20Data%20Guard"></a><title>Troubleshooting Oracle Data Guard</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="diagnostic information, sources"/>
<meta name="dcterms.created" content="2017-07-21T13:32:49Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Data Guard Broker"/>
<meta name="dcterms.identifier" content="E48241-09"/>
<meta name="dcterms.isVersionOf" content="DGBKR"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="dbpropref.htm" title="Previous" type="text/html"/>
<link rel="Next" href="upgrade_appx.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E48241-09.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-CF46FC94-2F5B-40AA-89A6-8B8F2B124807"></a> <span id="PAGE" style="display:none;">14/17</span> <!-- End Header -->
<a id="DGBKR1020"></a>
<h1 id="DGBKR-GUID-CF46FC94-2F5B-40AA-89A6-8B8F2B124807" class="sect1"><span class="enumeration_chapter">9</span> Troubleshooting Oracle Data Guard</h1>
<div>
<p>The following topics describe various Oracle Data Guard errors and how to solve them:<a id="d63634e20" class="indexterm-anchor"></a><a id="d63634e24" class="indexterm-anchor"></a></p>
<ul style="list-style-type: disc;">
<li>
<p><a href="troubleshooting.htm#GUID-A7D1301B-635F-46C6-9E33-FDA2093B8ABA">Sources of Diagnostic Information</a></p>
</li>
<li>
<p><a href="troubleshooting.htm#GUID-0AED2023-2A96-4B7B-96A2-CE0942AC0144">General Problems and Solutions</a></p>
</li>
<li>
<p><a href="troubleshooting.htm#GUID-E417A951-84C5-4693-9136-8480FB8B1876">Troubleshooting Problems During a Switchover Operation</a></p>
</li>
<li>
<p><a href="troubleshooting.htm#GUID-0BA77759-4B36-42FA-BEE1-BE132ED88ACE">Troubleshooting Problems During a Failover Operation</a></p>
</li>
<li>
<p><a href="troubleshooting.htm#GUID-C6AAB2E3-1714-4AFB-AC7B-BEA4B43F19C9">Troubleshooting Problems with the Observer</a></p>
</li>
</ul>
</div>
<a id="DGBKR1025"></a>
<div class="props_rev_3"><a id="GUID-A7D1301B-635F-46C6-9E33-FDA2093B8ABA"></a>
<h2 id="DGBKR-GUID-A7D1301B-635F-46C6-9E33-FDA2093B8ABA" class="sect2"><span class="enumeration_section">9.1</span> Sources of Diagnostic Information</h2>
<div>
<p>The Oracle Data Guard broker provides information about its activities in several forms:</p>
<ul style="list-style-type: disc;">
<li>
<p>Database status information (see <a href="dbresource.htm#GUID-85D20060-248B-42A1-B78D-15C23AAA2F59">Database Status</a>)</p>
</li>
<li>
<p>Oracle alert log files</p>
<p>The broker records key information in the alert log file for each instance of each database in a broker configuration. You can check the alert log files for such information when troubleshooting Oracle Data Guard.</p>
</li>
<li>
<p>Oracle Data Guard &#34;broker log files&#34; <a id="d63634e98" class="indexterm-anchor"></a><a id="d63634e102" class="indexterm-anchor"></a><a id="d63634e106" class="indexterm-anchor"></a></p>
<p>For each instance of each database in a broker configuration, the broker DMON process records important behavior and status information in a broker log file, useful in diagnosing Oracle Data Guard failures. The <code class="codeph">TraceLevel</code> configuration property (see <a href="dbpropref.htm#GUID-30441264-7892-48EC-96B0-A63D70CF46F8">TraceLevel</a>) is used to specify the level of diagnostic information reported in the broker log files.</p>
<p>The broker log file is created in the same directory as the alert log and is named <code class="codeph">drc&lt;$ORACLE_SID&gt;.log</code>.</p>
</li>
<li>
<p>Oracle Data Guard command line (DGMGRL) logfile</p>
<p>If the DGMGRL command-line interface was started with the <code class="codeph">-logfile</code> optional parameter (see <a href="dgmgrl.htm#GUID-69FF2BB6-5026-4549-9BF8-86E69C1AF6C3">DGMGRL Optional Parameters</a>), then the resulting log file may contain a useful record of past operations, error conditions, or both.</p>
</li>
</ul>
</div>
</div>
<a id="DGBKR1030"></a>
<div class="props_rev_3"><a id="GUID-0AED2023-2A96-4B7B-96A2-CE0942AC0144"></a>
<h2 id="DGBKR-GUID-0AED2023-2A96-4B7B-96A2-CE0942AC0144" class="sect2"><span class="enumeration_section">9.2</span> General Problems and Solutions</h2>
<div>
<p>This section describes general problems and solutions. This section contains the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="troubleshooting.htm#GUID-17E8BAEE-3D30-4A49-9869-C3D13180C709">ORA-16596: database not part of the Oracle Data Guard broker configuration</a></p>
</li>
<li>
<p><a href="troubleshooting.htm#GUID-203CF4DA-A3D3-4BB3-A840-64D61CE2862B">Redo Accumulating on the Primary Is Not Sent to Some Standby Databases</a></p>
</li>
<li>
<p><a href="troubleshooting.htm#GUID-87B880E0-EA12-4C6A-8640-0EF39EF0C378">Many Log Files Are Received on a Standby Database But Not Applied</a></p>
</li>
<li>
<p><a href="troubleshooting.htm#GUID-3C04CB40-B5E3-4952-BD2D-C953CE1FCC57">The Request Timed Out or Cloud Control Performance Is Sluggish</a></p>
</li>
<li>
<p><a href="troubleshooting.htm#GUID-AE89C1C3-F896-4526-A0EA-372301DAF5C4">The Primary Database is Flashed Back</a></p>
</li>
<li>
<p><a href="troubleshooting.htm#GUID-AC5641FD-20E9-411C-A9D2-5F2EA384325E">Standby Fails to Automatically Start Up Due to Unknown Service (ORA-12514)</a></p>
</li>
</ul>
</div>
<a id="DGBKR3614"></a><a id="DGBKR1035"></a>
<div class="props_rev_3"><a id="GUID-17E8BAEE-3D30-4A49-9869-C3D13180C709"></a>
<h3 id="DGBKR-GUID-17E8BAEE-3D30-4A49-9869-C3D13180C709" class="sect3"><span class="enumeration_section">9.2.1</span> ORA-16596: database not part of the Oracle Data Guard broker configuration</h3>
<div>
<div class="section">
<p>A request was issued to the broker, but the database instance through which you have connected is no longer a part of the broker configuration.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Solution</p>
</div>
<!-- class="section" -->
<div class="section">
<p>Reconnect to the configuration through another database that you know is part of the broker configuration. Confirm that a database exists in the broker configuration that has a name that matches the <code class="codeph">db_unique_name</code> value of the database that returned the ORA-16596 error.</p>
<p>This problem can also occur if you attempt to enable a configuration, but the broker configuration file for one of its databases was accidentally removed or is outdated. In this case, remove the database from the broker configuration, manually delete the configuration file for that standby database (not for the primary database), and try again to enable the configuration. After the configuration is enabled, you can either use the Cloud Control Add Standby Database wizard and choose the <span>Add existing standby database</span> option, or you can use the DGMGRL command-line interface and issue the <code class="codeph">ADD DATABASE</code> command.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR3615"></a><a id="DGBKR1040"></a>
<div class="props_rev_3"><a id="GUID-203CF4DA-A3D3-4BB3-A840-64D61CE2862B"></a>
<h3 id="DGBKR-GUID-203CF4DA-A3D3-4BB3-A840-64D61CE2862B" class="sect3"><span class="enumeration_section">9.2.2</span> Redo Accumulating on the Primary Is Not Sent to Some Standby Databases</h3>
<div>
<div class="section">
<p>By viewing the Log File Details page in Cloud Control, you have determined that log files are accumulating on the primary database and are not being archived to some of the standby databases in the broker configuration.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Solution</p>
</div>
<!-- class="section" -->
<div class="section">
<p>To narrow down the problem, do the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>Verify that the state of the primary database is in the <code class="codeph">TRANSPORT-ON</code> state (not <code class="codeph">TRANSPORT-OFF</code>).</p>
</li>
<li>
<p>Verify that the value of the <code class="codeph">LogShipping</code> database property of the standby database in question is <code class="codeph">ON</code>.</p>
</li>
<li>
<p>Check the status of the redo transport services on the primary database using the <code class="codeph">LogXptStatus</code> monitorable property. If redo transport services have an error, then use the error message to determine further checking and resolution action. For example:</p>
<ul style="list-style-type: disc;">
<li>
<p>If the error indicates the standby database is not available, you need to restart the standby database.</p>
</li>
<li>
<p>If the error indicates no listener, you need to restart the listener.</p>
</li>
<li>
<p>If the error indicates the standby database has no local destination, you need to set up a standby location to store archived redo log files from the primary database.</p>
</li>
</ul>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR3616"></a><a id="DGBKR3617"></a><a id="DGBKR3618"></a><a id="DGBKR1045"></a>
<div class="props_rev_3"><a id="GUID-87B880E0-EA12-4C6A-8640-0EF39EF0C378"></a>
<h3 id="DGBKR-GUID-87B880E0-EA12-4C6A-8640-0EF39EF0C378" class="sect3"><span class="enumeration_section">9.2.3</span> Many Log Files Are Received on a Standby Database But Not Applied</h3>
<div>
<div class="section">
<p>By viewing the Performance page or Log File Details page in Cloud Control, you have determined that the standby database accumulates too many log files without applying them.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Solution</p>
</div>
<!-- class="section" -->
<div class="section">
<p>There are many possible reasons why archived redo log files might not be applied to the standby database. Investigate why the log files are building up and rule out the valid reasons.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">If the current status of the standby database is not normal:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Determine whether or not the log apply services might be unexpectedly stopped. See the ORA-16766 (for physical standby databases) or ORA-16768 (for logical standby databases) error description and solution statement for more help.</p>
</li>
<li>
<p>If this is a logical standby database, check to see if a failed transaction has occurred.</p>
</li>
<li>
<p>If you want to suppress the error while you investigate the problem, you can temporarily disable broker management of the database.</p>
<div class="infoboxnotealso" id="GUID-87B880E0-EA12-4C6A-8640-0EF39EF0C378__GUID-800585DC-4D65-499D-A9D3-2BFD697BB884">
<p class="notep1">See Also:</p>
<p><a href="dgmgrl.htm#GUID-E7889124-C414-466F-9FBB-B8F035881F89" title="The DGMGRL ADD DATABASE command adds a standby database to an existing broker configuration.The DGMGRL CONNECT command connects you to a database or far sync instance that is a member of a Data Guard broker configuration.">Oracle Data Guard Command-Line Interface Reference</a> for additional information about disabling the database using the DGMGRL command-line interface</p>
</div>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">If the current status of the standby database is normal:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Verify the state of the standby database is <code class="codeph">APPLY-ON</code> (not in the <code class="codeph">APPLY-OFF</code> state).</p>
</li>
<li>
<p>Verify the state of the primary database is <code class="codeph">TRANSPORT-ON</code> (not in the <code class="codeph">TRANSPORT-OFF</code> state).</p>
<div class="infoboxnotealso" id="GUID-87B880E0-EA12-4C6A-8640-0EF39EF0C378__GUID-05F262BD-68EB-4EB0-8674-53F3E9B72096">
<p class="notep1">See Also:</p>
<p><a href="dbpropref.htm#GUID-1966A317-DD75-4385-8A64-ADEC75662F7E">Oracle Data Guard Broker Properties</a> for additional information about the <code class="codeph">LogShipping</code> database property</p>
</div>
</li>
<li>
<p>Check to see if log files are building up because the value of the <code class="codeph">DelayMins</code> property is set too large. (Log apply services will delay applying the archived redo log files on the standby database for the number of minutes specified.)</p>
<div class="infoboxnotealso" id="GUID-87B880E0-EA12-4C6A-8640-0EF39EF0C378__GUID-A2496017-567A-4479-954A-81E3DC973249">
<p class="notep1">See Also:</p>
<p><a href="dbpropref.htm#GUID-1966A317-DD75-4385-8A64-ADEC75662F7E">Oracle Data Guard Broker Properties</a> for additional information about the <code class="codeph">DelayMins</code> database property</p>
</div>
</li>
<li>
<p>If you cannot see any errors, compare the archive rate to the apply rate on the Performance page in Cloud Control to see if the apply rate is lower than the archive rate.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR3443"></a>
<div class="props_rev_3"><a id="GUID-3C04CB40-B5E3-4952-BD2D-C953CE1FCC57"></a>
<h3 id="DGBKR-GUID-3C04CB40-B5E3-4952-BD2D-C953CE1FCC57" class="sect3"><span class="enumeration_section">9.2.4</span> The Request Timed Out or Cloud Control Performance Is Sluggish</h3>
<div>
<div class="section">
<p>If the broker requests are not completing within the normal timeout parameters, try the following actions to solve the problem:</p>
<ol>
<li>
<p>Verify the network is operating appropriately.</p>
</li>
<li>
<p>Try to ping all of the nodes in the configuration.</p>
</li>
<li>
<p>Try reconnecting through another database to retry the operation.</p>
</li>
<li>
<p>Run the <code class="codeph">VERIFY</code> command to determine on which database the broker is unable to process the requests.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR1050"></a>
<div class="props_rev_3"><a id="GUID-AE89C1C3-F896-4526-A0EA-372301DAF5C4"></a>
<h3 id="DGBKR-GUID-AE89C1C3-F896-4526-A0EA-372301DAF5C4" class="sect3"><span class="enumeration_section">9.2.5</span> The Primary Database is Flashed Back</h3>
<div>
<div class="section">
<p>If the primary database is flashed back, the standby databases in the configuration must be also be flashed back or re-created to be viable targets for switchovers or failovers. The broker will report errors for the standby databases if the primary database has been flashed back.</p>
<p>For more information about restoring the viability of a standby database that was disabled by the broker, see <a href="sofo.htm#GUID-D1C0709A-FBF0-4635-95A4-385506A5EC2D">Reenabling Disabled Databases After a Role Change</a>.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR3846"></a>
<div class="props_rev_3"><a id="GUID-AC5641FD-20E9-411C-A9D2-5F2EA384325E"></a>
<h3 id="DGBKR-GUID-AC5641FD-20E9-411C-A9D2-5F2EA384325E" class="sect3"><span class="enumeration_section">9.2.6</span> Standby Fails to Automatically Start Up Due to Unknown Service (ORA-12514)</h3>
<div>
<div class="section">
<p>If the DGMGRL CLI fails to automatically start up an instance after a broker operation (for example, a switchover, reinstatement, convert to physical standby, or upgrade of protection mode to maximum protection mode), and you receive an <code class="codeph">ORA-12514: TNS:listener does not currently know of service requested in connect descriptor</code> error, then you must manually start the instance to complete or continue the broker operation.</p>
<p>You can restart the instance before or after completing the following steps:</p>
<ol>
<li>
<p>Issue the following DGMGRL CLI command to check the value of the <code class="codeph">StaticConnectIdentifer</code> configurable property for the instance the DGMGRL CLI was unable to restart. (You will have to connect to another running instance to issue this command):</p>
<pre dir="ltr">DGMGRL&gt; SHOW INSTANCE VERBOSE &#39;<span class="italic">instance_name</span>&#39; ON DATABASE <span class="italic">db_unique_name</span>;
</pre></li>
<li>
<p>The static service name specified in the value of the <code class="codeph">StaticConnectIdentifer</code> instance property should be registered with the listener specified in the property value. The default value for the static service name is of the following form:</p>
<pre dir="ltr"><span class="italic">db_unique_name</span>_DGMGRL.<span class="italic">db_domain</span>
</pre>
<p>See <a href="install.htm#GUID-BFDA8675-DA97-4910-B3FF-5DD5CFF5CC6D">Prerequisites</a> for more information about this, and other prerequisites, for using the broker.</p>
</li>
<li>
<p>Confirm that the static service name is registered with the listener specified in the <code class="codeph">StaticConnectIdentifer</code> configurable property value by using the Listener Control utility&#39;s status command. If the static service name is properly registered with the listener, it will be included in the output generated by the following command:</p>
<pre dir="ltr">lsnrctl status
</pre></li>
<li>
<p>If you are working in an Oracle RAC environment, you may want to repeat steps 1 and 2 for each instance to ensure that a static service name is properly registered with its respective listener.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="DGBKR1060"></a>
<div class="props_rev_3"><a id="GUID-E417A951-84C5-4693-9136-8480FB8B1876"></a>
<h2 id="DGBKR-GUID-E417A951-84C5-4693-9136-8480FB8B1876" class="sect2"><span class="enumeration_section">9.3</span> Troubleshooting Problems During a Switchover Operation</h2>
<div>
<p>If the switchover fails due to problems with the configuration, then the broker reports any problems it encounters in the alert log files or in the broker log files (see <a href="troubleshooting.htm#GUID-A7D1301B-635F-46C6-9E33-FDA2093B8ABA">Sources of Diagnostic Information</a>). If the reported problems can be corrected, you can retry the switchover operation and it will usually succeed. If the reported problems cannot be corrected or the switchover operation fails even after correcting the reported problems, then you can choose another database for the switchover or restore the configuration to its pre-switchover state and then retry the switchover.</p>
<p>If fast-start failover is enabled, the broker does not allow switchover to any standby database except to the target standby database. In addition, switchover to the target standby database is allowed only when the value of the <code class="codeph">FS_FAILOVER_STATUS</code> column in the <code class="codeph">V$DATABASE</code> view on the target standby database is either <code class="codeph">READY</code> or <code class="codeph">SUSPENDED</code>.</p>
<div class="infoboxnotealso" id="GUID-E417A951-84C5-4693-9136-8480FB8B1876__GUID-BFC682AD-0276-4755-A3DC-18E8FBED7899">
<p class="notep1">See Also:</p>
<p><a href="sofo.htm#GUID-824C3FEF-9D1D-4AA7-9C7A-DBDBADC77F47">When Fast-Start Failover Is Enabled and the Observer Is Running</a></p>
</div>
</div>
</div>
<a id="DGBKR1055"></a>
<div class="props_rev_3"><a id="GUID-0BA77759-4B36-42FA-BEE1-BE132ED88ACE"></a>
<h2 id="DGBKR-GUID-0BA77759-4B36-42FA-BEE1-BE132ED88ACE" class="sect2"><span class="enumeration_section">9.4</span> Troubleshooting Problems During a Failover Operation</h2>
<div>
<p>Although it is possible for a failover operation to fail, it is unlikely. If an error occurs, use the guidelines given in the following subsections to fix the problem and then retry the broker failover.</p>
</div>
<a id="DGBKR3452"></a>
<div class="props_rev_3"><a id="GUID-17CB06EF-2B0E-41F7-9D08-7759987FFB4E"></a>
<h3 id="DGBKR-GUID-17CB06EF-2B0E-41F7-9D08-7759987FFB4E" class="sect3"><span class="enumeration_section">9.4.1</span> Failed Failovers to Physical Standby Databases</h3>
<div>
<div class="section">
<p>Use the steps below to recover from a failed broker failover to a physical standby database.</p>
</div>
<!-- class="section" --></div>
<a id="DGBKR3453"></a>
<div class="props_rev_3"><a id="GUID-5FB1AC6D-D817-4064-BD39-D9F7B965452A"></a>
<h4 id="DGBKR-GUID-5FB1AC6D-D817-4064-BD39-D9F7B965452A" class="sect4"><span class="enumeration_section">9.4.1.1</span> Failed Broker Complete Physical Failovers</h4>
<div>
<div class="section">
<p>Examine the alert log file and the broker log file (drc*.log) on the target standby database to determine the cause of the failure and correct the problem. If the reported problem can be corrected, then retry the failover operation. If the reported problem cannot be corrected or if the failover operation fails again after the reported problem has been corrected, then take the following steps:</p>
<ol>
<li>
<p>Connect to the target standby database and disable fast-start failover using the <code class="codeph">FORCE</code> option if it is enabled.</p>
</li>
<li>
<p>Then you can either:</p>
<ul style="list-style-type: disc;">
<li>
<p>Connect to another physical standby database and attempt a broker complete failover.</p>
</li>
<li>
<p>Perform a broker immediate failover to the target physical standby database.</p>
</li>
</ul>
</li>
<li>
<p>Reinstate the original primary database and any bystander physical standby databases that are disabled with a status of reinstatement required (<code class="codeph">ORA-16661</code>).</p>
</li>
<li>
<p>Reenable fast-start failover if it was disabled in step 1.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR3454"></a>
<div class="props_rev_3"><a id="GUID-BEBFF44B-9000-44EE-9F1F-0640F49B183A"></a>
<h4 id="DGBKR-GUID-BEBFF44B-9000-44EE-9F1F-0640F49B183A" class="sect4"><span class="enumeration_section">9.4.1.2</span> Failed Broker Immediate Physical Failovers</h4>
<div>
<div class="section">
<p>Examine the alert log file and the broker log file (drc*.log) on the target standby database to determine the cause of the failure and correct the problem. If the problem can be corrected, retry the broker immediate failover. Otherwise connect to another physical standby database and attempt either a broker complete or immediate failover.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="DGBKR3455"></a>
<div class="props_rev_3"><a id="GUID-AF1C816F-A0E5-4F6C-9DA6-A489EB256388"></a>
<h3 id="DGBKR-GUID-AF1C816F-A0E5-4F6C-9DA6-A489EB256388" class="sect3"><span class="enumeration_section">9.4.2</span> Failed Failovers to Logical Standby Databases</h3>
<div>
<div class="section">
<ol>
<li>
<p>Examine the alert log file and the broker log file (drc*.log) on the target standby database to determine the cause of the failure and correct the problem.</p>
</li>
<li>
<p>Connect to the target standby database and disable fast-start failover using the <code class="codeph">FORCE</code> option if it is enabled.</p>
</li>
<li>
<p>Retry the broker failover.</p>
</li>
<li>
<p>Reinstate the old primary database. All bystander standby databases will be re-created from a copy of the new primary database.</p>
</li>
<li>
<p>Reenable fast-start failover if it was disabled in step 1.</p>
</li>
</ol>
<p>If broker failover continues to fail, you should stop the broker on all databases in the Oracle Data Guard configuration (set the <code class="codeph">DG_BROKER_START</code> initialization parameter to <code class="codeph">FALSE</code>). Remove the Oracle Data Guard broker configuration files from all databases. Attempt a manual failover using the guidelines for role transitions in <a class="olink SBYDB00635" target="_blank" href="../SBYDB/role_management.htm#SBYDB00635"><span class="italic">Oracle Data Guard Concepts and Administration</span></a>.</p>
<div class="infobox-note" id="GUID-AF1C816F-A0E5-4F6C-9DA6-A489EB256388__GUID-0FC2BF42-091A-47FD-B95D-5FF4431D640A">
<p class="notep1">Note:</p>
<p>You can enable or disable the broker configuration using DGMGRL <code class="codeph">ENABLE CONFIGURATION</code> and <code class="codeph">DISABLE CONFIGURATION</code> commands. You cannot disable the configuration using Cloud Control. You can only enable the configuration using Cloud Control if it was previously disabled using DGMGRL.</p>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="DGBKR3456"></a>
<div class="props_rev_3"><a id="GUID-C6AAB2E3-1714-4AFB-AC7B-BEA4B43F19C9"></a>
<h2 id="DGBKR-GUID-C6AAB2E3-1714-4AFB-AC7B-BEA4B43F19C9" class="sect2"><span class="enumeration_section">9.5</span> Troubleshooting Problems with the Observer</h2>
<div>
<p>The observer continuously monitors the fast-start failover environment to ensure the primary database is available. Installing and starting the observer is an integral part of using fast-start failover. The following sections describe techniques for troubleshooting the observer:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="troubleshooting.htm#GUID-F936FD70-FA71-44C1-9FB7-373F0EEC54C4">Problems Starting the Observer</a></p>
</li>
<li>
<p><a href="troubleshooting.htm#GUID-19CF1965-70A1-45B4-B398-3781937E4B0F">Problems Because the Observer Has Stopped</a></p>
</li>
<li>
<p><a href="troubleshooting.htm#GUID-5B9D54C8-C446-4678-A770-2851C41C9265">Capturing Observer Actions in the Observer Log File</a></p>
</li>
</ul>
</div>
<a id="DGBKR3457"></a>
<div class="props_rev_3"><a id="GUID-F936FD70-FA71-44C1-9FB7-373F0EEC54C4"></a>
<h3 id="DGBKR-GUID-F936FD70-FA71-44C1-9FB7-373F0EEC54C4" class="sect3"><span class="enumeration_section">9.5.1</span> Problems Starting the Observer</h3>
<div>
<div class="section">
<p>Only one observer can be observing the broker configuration at any given time. If you attempt to start a second observer, one of the following errors is returned:</p>
<pre dir="ltr">ORA-16647: could not start more than one observer
DGM-16954: Unable to open and lock the Observer configuration file
</pre>
<p>Use the DGMGRL <code class="codeph">SHOW CONFIGURATION VERBOSE</code> command to determine the location of the observer that is currently associated with the broker configuration.</p>
<pre dir="ltr">DGMGRL&gt; SHOW CONFIGURATION VERBOSE;
 
Configuration - DRSolution
 
  Protection Mode: MaxAvailability
  Databases:
  North_Sales- Primary database
  South_Sales- Physical standby database
 
Properties:
  FastStartFailoverThreshold     = &#39;30&#39;
  OperationTimeout               = &#39;30&#39;
  TraceLevel                     = &#39;USER&#39;
  FastStartFailoverLagLimit      = &#39;30
  CommunicationTimeout           = &#39;180&#39;
  ObserverReconnect              = &#39;0&#39;
  FastStartFailoverAutoReinstate = &#39;TRUE&#39;
  FastStartFailoverPmyShutdown   = &#39;TRUE&#39;
  BystandersFollowRoleChange     = &#39;ALL&#39;
  ObserverOverride               = &#39;FALSE&#39;
  ExternalDestination1           = &#39;&#39;ExternalDestination2             = &#39;&#39;PrimaryLostWriteAction           = &#39;CONTINUE&#39;
 
Fast-Start Failover: ENABLED
 
  Threshold: 30 seconds
  Target: South_Sales
  <span class="bold">Observer: observer.example.com</span>
  Lag Limit: 30 seconds (not in use)
  Shutdown Primary: TRUE
  Auto-reinstate: TRUE
  Observer Reconnect: (none)
  Observer Override: FALSE
 
Configuration Status:
SUCCESS
</pre></div>
<!-- class="section" --></div>
</div>
<a id="DGBKR3458"></a>
<div class="props_rev_3"><a id="GUID-19CF1965-70A1-45B4-B398-3781937E4B0F"></a>
<h3 id="DGBKR-GUID-19CF1965-70A1-45B4-B398-3781937E4B0F" class="sect3"><span class="enumeration_section">9.5.2</span> Problems Because the Observer Has Stopped</h3>
<div>
<div class="section">
<p>If the observer host machine crashes, the broker configuration is no longer observed and fast-start failover is no longer possible. In this case, you may have to move the observer to a new host if the original host machine cannot be repaired in a timely fashion. To move the observer, you must stop allowing the first observer to observe this broker configuration, and then start a new observer on another host.</p>
<ol>
<li>
<p>Issue the DGMGRL <code class="codeph">STOP OBSERVER</code> command to sever the link between the original observer and the broker configuration:</p>
<pre dir="ltr">DGMGRL&gt; STOP OBSERVER;
Done.
</pre></li>
<li>
<p>Issue the DGMGRL <code class="codeph">SHOW CONFIGURATION VERBOSE</code> command to verify that the configuration is no longer being observed:</p>
<pre dir="ltr">DGMGRL&gt; SHOW CONFIGURATION VERBOSE;
 
Configuration - DRSolution
 
  Protection Mode: MaxAvailability
  Databases:
    North_Sales - Primary database
    Warning: ORA-16819: fast-start failover observer not started
 
    South_Sales - (*) Physical standby database
    Warning: ORA-16819: fast-start failover observer not started
 
(*) Fast-Start Failover target
 
Properties:
  FastStartFailoverThreshold     = &#39;30&#39;
  OperationTimeout               = &#39;30&#39;
  TraceLevel                     = &#39;USER&#39;
  FastStartFailoverLagLimit      = &#39;30&#39;
  CommunicationTimeout           = &#39;180&#39;
  ObserverReconnect              = &#39;0&#39;
  FastStartFailoverAutoReinstate = &#39;TRUE&#39;
  FastStartFailoverPmyShutdown   = &#39;TRUE&#39;
  BystandersFollowRoleChange     = &#39;ALL&#39;
  ObserverOverride               = &#39;FALSE&#39;
  ExternalDestination1           = &#39;&#39;
  ExternalDestination2           = &#39;&#39;  PrimaryLostWriteAction         = &#39;CONTINUE&#39;
 
Fast-Start Failover: ENABLED
 
  Threshold: 30 seconds
  Target: South_Sales
  <span class="bold">Observer: observer.example.com</span>
  Lag Limit: 30 seconds (not in use)
  Shutdown Primary: TRUE
  Auto-reinstate: TRUE
  Observer Reconnect: (none)
  Observer Override: FALSE
 
Configuration Status:
WARNING
</pre></li>
<li>
<p>Note that you do not need to issue the DGMGRL <code class="codeph">SHOW CONFIGURATION</code> command to verify that the observer has actually stopped. Successful completion of the DGMGRL <code class="codeph">STOP OBSERVER</code> command will allow a new observer to become associated with the configuration.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="DGBKR3459"></a>
<div class="props_rev_3"><a id="GUID-5B9D54C8-C446-4678-A770-2851C41C9265"></a>
<h3 id="DGBKR-GUID-5B9D54C8-C446-4678-A770-2851C41C9265" class="sect3"><span class="enumeration_section">9.5.3</span> Capturing Observer Actions in the Observer Log File</h3>
<div>
<div class="section">
<p>You can use the DGMGRL <code class="codeph">-logfile</code> option to start the observer, so that all of the troubleshooting actions performed in <a href="troubleshooting.htm#GUID-F936FD70-FA71-44C1-9FB7-373F0EEC54C4">Problems Starting the Observer</a> can be captured in a file. For example:</p>
<pre dir="ltr">% dgmgrl -logfile observer.log / &#34;start observer&#34;
</pre>
<p>All the observer output is then recorded in a file named <code class="codeph">observer.log</code> in the current working directory where you issued the DGMGRL command. If the specified log file is not accessible, then the observer output is sent to standard output as though a log file had not been specified.</p>
<p>Note that this is not only useful for troubleshooting problems with the observer, but also for troubleshooting problems with fast-start failover in general.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5444">
<tr>
<td class="cellalignment5451">
<table class="cellalignment5449">
<tr>
<td class="cellalignment5448"><a href="dbpropref.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5448"><a href="upgrade_appx.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5453">
<table class="cellalignment5447">
<tr>
<td class="cellalignment5448"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5448"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5448"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5448"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5448"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5448"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>