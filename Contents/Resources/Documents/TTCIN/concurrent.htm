<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-107482"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Concurrent%20Operations"></a><title>Concurrent Operations</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 726"/>
<meta name="dcterms.created" content="2014-06-06T13:40:25Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="TimesTen Application-Tier Database Cache Introduction"/>
<meta name="dcterms.identifier" content="E21631-06"/>
<meta name="dcterms.isVersionOf" content="TTCIN"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2012, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="arch.htm" title="Previous" type="text/html"/>
<link rel="Next" href="query.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E21631-06.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">8/14</span> <!-- End Header -->
<div id="TTCIN170" class="chapter"><a id="BABFFHGG"></a>
<h1 class="chapter"><span class="secnum">4</span> Concurrent Operations</h1>
<p>When a database is accessed by multiple transactions, there must be a way to coordinate concurrent changes to data with reads of the same data in the database. TimesTen and TimesTen Cache use transaction isolation and locks to coordinate concurrent access to data.</p>
<p>This chapter includes the following topics:</p>
<ul>
<li>
<p><a href="#BAABJABJ">Transaction isolation</a></p>
</li>
<li>
<p><a href="#BAACFEFE">Locking levels</a></p>
</li>
</ul>
<a id="BAABJABJ"></a>
<div id="TTCIN171" class="sect1">
<h2 class="sect1">Transaction isolation<a id="sthref88"></a><a id="sthref89"></a></h2>
<p>Transaction isolation provides an application with the appearance that the system performs one transaction at a time, even though there are concurrent connections to the database. Applications can use the <code>Isolation</code> general connection attribute to set the isolation level for a connection. Concurrent connections can use different isolation levels.</p>
<p>Isolation level and concurrency are inversely related. A lower isolation level enables greater concurrency, but with greater risk of data inconsistencies. A higher isolation level provides a higher degree of data consistency, but at the expense of concurrency.</p>
<p>TimesTen supports two isolation levels:</p>
<ul>
<li>
<p><a href="#BAADCFJH">Read committed isolation</a></p>
</li>
<li>
<p><a href="#BAAEGEGC">Serializable isolation</a></p>
</li>
</ul>
<a id="BAADCFJH"></a>
<div id="TTCIN172" class="sect2">
<h3 class="sect2">Read committed isolation<a id="sthref90"></a><a id="sthref91"></a><a id="sthref92"></a></h3>
<p>When an application uses read committed isolation, readers use a separate copy of the data from writers, so read locks are not needed. Read committed isolation is nonblocking for queries and can work with <a href="#BAAEGEGC">Serializable isolation</a> or read committed isolation. Under read committed isolation, writers block only other writers and readers using serializable isolation; writers do not block readers using read committed isolation. Read committed isolation is the default isolation level.</p>
<p>TimesTen and TimesTen Cache use <span class="italic">versioning</span> to implement read committed isolation. TimesTen and TimesTen Cache update operations create new copies of the rows they update to allow nonserializable reads of those rows to proceed without waiting.</p>
<p><a href="#BAAJCCGE">Figure 4-1</a> shows that some applications read a committed copy of the data while another application writes and reads on an uncommitted copy.</p>
<div id="TTCIN173" class="figure">
<p class="titleinfigure"><a id="BAAJCCGE"></a>Figure 4-1 Read committed isolation</p>
<img width="530" height="176" src="img/readcommitted.gif" alt="Description of Figure 4-1 follows"/><br/>
<a id="sthref93" href="img_text/readcommitted.htm">Description of &#34;Figure 4-1 Read committed isolation&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>Read committed isolation provides increased concurrency because readers do not block writers and writers do not block readers. This isolation level is useful for applications that have long-running scans that may conflict with other operations needing access to a scanned row. However, the disadvantage when using this isolation level is that non-repeatable reads are possible within a transaction or even a single statement (for example, the inner loop of a nested join).</p>
<p>When using this isolation level, DDL statements that operate on a table can block readers and writers of that table. For example, an application cannot read a row from a table if another application has an uncommitted <code>DROP TABLE</code>, <code>CREATE INDEX</code>, or <code>ALTER TABLE</code> operation on that table. In addition, blocking checkpoints blocks readers and writers.</p>
<p>Read committed isolation does acquire read locks as needed during materialized view maintenance to ensure that views are consistent with their detail tables. These locks are not held until the end of the transaction but are instead released when maintenance has been completed.</p>
</div>
<!-- class="sect2" -->
<a id="BAAEGEGC"></a>
<div id="TTCIN174" class="sect2">
<h3 class="sect2">Serializable isolation<a id="sthref94"></a><a id="sthref95"></a></h3>
<p>When an application uses serializable isolation, locks are acquired within a transaction and are held until the transaction commits or rolls back for both reads and writes. As a result, a row that has been read by one transaction cannot be updated or deleted by another transaction until the original transaction completes. Similarly, a row that has been inserted, updated, or deleted by a transaction cannot be accessed in any way by another transaction until the original transaction completes.</p>
<p>This level of isolation provides for repeatable reads and increased isolation within a transaction at the expense of decreased concurrency. Transactions use serializable isolation when database-level locking is chosen.</p>
<p><a href="#BAAEBDBH">Figure 4-2</a> shows that locks are held until the transaction is committed.</p>
<div id="TTCIN175" class="figure">
<p class="titleinfigure"><a id="BAAEBDBH"></a>Figure 4-2 Serializable isolation</p>
<img width="566" height="180" src="img/serializable.gif" alt="Description of Figure 4-2 follows"/><br/>
<a id="sthref96" href="img_text/serializable.htm">Description of &#34;Figure 4-2 Serializable isolation&#34;</a><br/>
<br/></div>
<!-- class="figure" -->
<p>Serializable isolation level is useful for transactions that require the strongest level of isolation. Concurrent applications that must modify the data that is read by a transaction may encounter lock timeouts because read locks are held until the transaction commits.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BAACFEFE"></a>
<div id="TTCIN176" class="sect1">
<h2 class="sect1">Locking levels<a id="sthref97"></a><a id="sthref98"></a></h2>
<p>Locks are used to serialize access to resources to prevent one user from changing an element that is being read or changed by another user. TimesTen and TimesTen Cache automatically perform locking for all database accesses.</p>
<ul>
<li>
<p>A share lock enables the associated resource to be shared, depending on the operations involved (that is, you should not alter or drop a row, table, or view if it is being shared). Several transactions can acquire share locks on the same resource.</p>
</li>
<li>
<p>An exclusive lock ensures that there is no more than one active transaction in the database at any given time. This lock prevents the resource from being shared and is obtained to modify data. The first transaction to lock a resource exclusively is the only transaction that can alter the resource until the exclusive lock is released when the transaction completes.</p>
</li>
</ul>
<p>Serializable transactions acquire share locks on the items they read and exclusive locks on the items they write. These locks are held until the transaction commits or rolls back. Read-committed transactions acquire exclusive locks on the items they write and hold these locks until the transactions are committed. Read-committed transactions do not acquire locks on the items they read. Committing or rolling back a transaction closes all cursors and releases all locks held by the transaction.</p>
<p>TimesTen and TimesTen Cache perform deadlock detection to report and eliminate deadlock situations. If an application is denied a lock because of a deadlock error, it should roll back the entire transaction and retry it.</p>
<p>Applications can select from three lock levels:</p>
<ul>
<li>
<p><a href="#BAAGBJJA">Database-level locking</a></p>
</li>
<li>
<p><a href="#BAACEADB">Table-level locking</a></p>
</li>
<li>
<p><a href="#BAADJBII">Row-level locking</a></p>
</li>
</ul>
<a id="BAAGBJJA"></a>
<div id="TTCIN177" class="sect2">
<h3 class="sect2">Database-level locking<a id="sthref99"></a></h3>
<p>Locking at the database level locks an entire database when it is accessed by a transaction. All database-level locks are exclusive. A transaction that requires a database-level lock cannot start until there are no active transactions on the database. After a transaction has obtained a database-level lock, all other transactions are blocked until the transaction commits or rolls back.</p>
<p>Database-level locking restricts concurrency more than table-level locking and is useful only for initialization operations such as bulkloading, when no concurrency is necessary. Database-level locking has better response time than row-level or table-level locking at the cost of diminished concurrency and diminished throughput.</p>
<p>Different transactions can coexist with different levels of locking, but the presence of even one transaction that uses database-level locking leads to reduced concurrency.</p>
<p>Use the <code>LockLevel</code> general connection attribute or the <code>ttLockLevel</code> built-in procedure to implement database-level locking. See <a class="olink TTREF259" href="../TTREF/proced.htm#TTREF259">&#34;ttLockLevel&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Reference</span> for more information.</p>
</div>
<!-- class="sect2" -->
<a id="BAACEADB"></a>
<div id="TTCIN178" class="sect2">
<h3 class="sect2">Table-level locking<a id="sthref100"></a></h3>
<p>Table-level locking locks a table when it is accessed by a transaction. It is useful when a statement accesses most of the rows in a table. Applications can call the <code>ttOptSetFlag</code> built-in procedure to request that the optimizer use table locks. The optimizer determines when a table lock should be used.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
See <a class="olink TTREF271" href="../TTREF/proced.htm#TTREF271">&#34;ttOptSetFlag&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Reference</span> for more information.</div>
<p>Table locks can reduce throughput, so they should be used only when a substantial portion of the table must be locked or when high concurrency is not needed. For example, tables can be locked for operations such as bulk updates. In read-committed isolation, TimesTen and TimesTen Cache do not use table-level locking for read operations unless it is explicitly requested by the application.</p>
</div>
<!-- class="sect2" -->
<a id="BAADJBII"></a>
<div id="TTCIN179" class="sect2">
<h3 class="sect2">Row-level locking<a id="sthref101"></a></h3>
<p>Row-level locking locks only the rows that are accessed by a transaction. It provides the best concurrency by allowing concurrent transactions to access rows in the same table. Row-level locking is preferable when there are many concurrent transactions, each operating on different rows of the same tables.</p>
<p>Applications can use the <code>LockLevel</code> general connection attribute, the <code>ttLockLevel</code> built-in procedure and the <code>ttOptSetFlag</code> built-in procedure to manage row-level locking.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
See <a class="olink TTREF259" href="../TTREF/proced.htm#TTREF259">&#34;ttLockLevel&#34;</a> and <a class="olink TTREF271" href="../TTREF/proced.htm#TTREF271">&#34;ttOptSetFlag&#34;</a> in the <span class="italic">Oracle TimesTen In-Memory Database Reference</span> for more information.</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<div id="TTCIN180" class="sect1"><a id="sthref102"></a>
<h2 class="sect1">For more information</h2>
<p>For more information about locks and transaction isolation, see <a class="olink TTOPR392" href="../TTOPR/trans.htm#TTOPR392">&#34;Transaction Management&#34;</a> in <span class="italic">Oracle TimesTen In-Memory Database Operations Guide</span>.</p>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2928">
<tr>
<td class="cellalignment2937">
<table class="cellalignment2933">
<tr>
<td class="cellalignment2932"><a href="arch.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2932"><a href="query.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2012, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2939">
<table class="cellalignment2931">
<tr>
<td class="cellalignment2932"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2932"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2932"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2932"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2932"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2932"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>