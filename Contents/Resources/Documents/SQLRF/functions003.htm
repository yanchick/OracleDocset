<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-102085"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Aggregate%20Functions"></a><title>Aggregate Functions</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1093"/>
<meta name="dcterms.created" content="2017-07-18T18:52:11Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database SQL Language Reference"/>
<meta name="dcterms.identifier" content="E41329-25"/>
<meta name="dcterms.isVersionOf" content="SQLRF"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2017,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="functions002.htm" title="Previous" type="text/html"/>
<link rel="Next" href="functions004.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41329-25.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">76/555</span> <!-- End Header --><a id="i89203"></a>
<div id="SQLRF20035" class="sect1"><!-- infolevel="all" infotype="General" -->
<h1 class="sect1">Aggregate Functions <a id="sthref1180"></a><a id="sthref1181"></a></h1>
<p>Aggregate functions return a single result row based on groups of rows, rather than on single rows. Aggregate functions can appear in select lists and in <code dir="ltr">ORDER</code> <code dir="ltr">BY</code> and <code dir="ltr">HAVING</code> clauses. They are commonly used with the <code dir="ltr">GROUP</code> <code dir="ltr">BY</code> clause in a <code dir="ltr">SELECT</code> statement, where Oracle Database divides the rows of a queried table or view into groups. In a query containing a <code dir="ltr">GROUP</code> <code dir="ltr">BY</code> clause, the elements of the select list can be aggregate functions, <code dir="ltr">GROUP</code> <code dir="ltr">BY</code> expressions, constants, or expressions involving one of these. Oracle applies the aggregate functions to each group of rows and returns a single result row for each group.</p>
<p>If you omit the <code dir="ltr">GROUP</code> <code dir="ltr">BY</code> clause, then Oracle applies aggregate functions in the select list to all the rows in the queried table or view. You use aggregate functions in the <code dir="ltr">HAVING</code> clause to eliminate groups from the output based on the results of the aggregate functions, rather than on the values of the individual rows of the queried table or view.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="statements_10002.htm#i2066419">&#34;Using the GROUP BY Clause: Examples&#34;</a> and the <a href="statements_10002.htm#i2078943">&#34;HAVING Clause&#34;</a> for more information on the <code dir="ltr">GROUP</code> <code dir="ltr">BY</code> clause and <code dir="ltr">HAVING</code> clauses in queries and subqueries</div>
<p>Many (but not all) aggregate functions that take a single argument accept these clauses:</p>
<ul>
<li>
<p><code dir="ltr">DISTINCT</code> and <code dir="ltr">UNIQUE</code>, which are synonymous, cause an aggregate function to consider only distinct values of the argument expression. The syntax diagrams for aggregate functions in this chapter use the keyword <code dir="ltr">DISTINCT</code> for simplicity.</p>
</li>
<li>
<p><code dir="ltr">ALL</code> causes an aggregate function to consider all values, including all duplicates.</p>
</li>
</ul>
<p>For example, the <code dir="ltr">DISTINCT</code> average of 1, 1, 1, and 3 is 2. The <code dir="ltr">ALL</code> average is 1.5. If you specify neither, then the default is <code dir="ltr">ALL</code>.</p>
<p>Some aggregate functions allow the <code dir="ltr"><span class="codeinlineitalic">windowing_clause</span></code>, which is part of the syntax of analytic functions. Refer to <a href="functions004.htm#i97640"><span class="xreftitleitalic"><span class="italic">windowing_clause</span></span></a> for information about this clause. In the listing of aggregate functions at the end of this section, the functions that allow the <code dir="ltr"><span class="codeinlineitalic">windowing_clause</span></code> are followed by an asterisk (*)</p>
<p>All aggregate functions except <code dir="ltr">COUNT</code>(*), <code dir="ltr">GROUPING</code>, and <code dir="ltr">GROUPING_ID</code> ignore nulls. You can use the <code dir="ltr">NVL</code> function in the argument to an aggregate function to substitute a value for a null. <code dir="ltr">COUNT</code> and <code dir="ltr">REGR_COUNT</code> never return null, but return either a number or zero. For all the remaining aggregate functions, if the data set contains no rows, or contains only rows with nulls as arguments to the aggregate function, then the function returns null.</p>
<p><a id="sthref1182"></a>The aggregate functions <code dir="ltr">MIN</code>, <code dir="ltr">MAX</code>, <code dir="ltr">SUM</code>, <code dir="ltr">AVG</code>, <code dir="ltr">COUNT</code>, <code dir="ltr">VARIANCE</code>, and <code dir="ltr">STDDEV</code>, when followed by the <code dir="ltr">KEEP</code> keyword, can be used in conjunction with the <code dir="ltr">FIRST</code> or <code dir="ltr">LAST</code> function to operate on a set of values from a set of rows that rank as the <code dir="ltr">FIRST</code> or <code dir="ltr">LAST</code> with respect to a given sorting specification. Refer to <a href="functions074.htm#i1000901">FIRST</a> for more information.</p>
<p>You can nest aggregate functions. For example, the following example calculates the average of the maximum salaries of all the departments in the sample schema <code dir="ltr">hr</code>:</p>
<pre dir="ltr">SELECT AVG(MAX(salary))
  FROM employees
  GROUP BY department_id;

AVG(MAX(SALARY))
----------------
      10926.3333
</pre>
<p>This calculation evaluates the inner aggregate (<code dir="ltr">MAX</code>(<code dir="ltr">salary</code>)) for each group defined by the <code dir="ltr">GROUP</code> <code dir="ltr">BY</code> clause (<code dir="ltr">department_id</code>), and aggregates the results again.</p>
<p>In the list of aggregate functions that follows, functions followed by an asterisk (*) allow the <code dir="ltr"><span class="codeinlineitalic">windowing_clause</span></code>.</p>
<br/>
<a href="functions013.htm#CJAEJAGD">APPROX_COUNT_DISTINCT</a><br/>
<a href="functions019.htm#i82074">AVG</a><br/>
<a href="functions034.htm#i1271564">COLLECT</a><br/>
<a href="functions042.htm#i82637">CORR</a><br/>
<a href="functions043.htm#i1293691">CORR_*</a><br/>
<a href="functions046.htm#i82697">COUNT</a><br/>
<a href="functions047.htm#i1008854">COVAR_POP</a><br/>
<a href="functions048.htm#i82820">COVAR_SAMP</a><br/>
<a href="functions050.htm#i82886">CUME_DIST</a><br/>
<a href="functions060.htm#i1064409">DENSE_RANK</a><br/>
<a href="functions074.htm#i1000901">FIRST</a><br/>
<a href="functions079.htm#i1002035">GROUP_ID</a><br/>
<a href="functions080.htm#i77498">GROUPING</a><br/>
<a href="functions081.htm#i1001964">GROUPING_ID</a><br/>
<a href="functions095.htm#i1000905">LAST</a><br/>
<a href="functions101.htm#CJABDFBD">LISTAGG</a><br/>
<a href="functions110.htm#i89072">MAX</a><br/>
<a href="functions111.htm#i1279886">MEDIAN</a><br/>
<a href="functions112.htm#i1280029">MIN</a><br/>
<a href="functions140.htm#i1043951">PERCENT_RANK</a><br/>
<a href="functions141.htm#i1000909">PERCENTILE_CONT</a><br/>
<a href="functions142.htm#i1000913">PERCENTILE_DISC</a><br/>
<a href="functions155.htm#i1269223">RANK</a><br/>
<a href="functions165.htm#i85922">REGR_ (Linear Regression) Functions</a><br/>
<a href="functions184.htm#i1279891">STATS_BINOMIAL_TEST</a><br/>
<a href="functions185.htm#i1333770">STATS_CROSSTAB</a><br/>
<a href="functions186.htm#i1279901">STATS_F_TEST</a><br/>
<a href="functions187.htm#i1279906">STATS_KS_TEST</a><br/>
<a href="functions188.htm#i1279911">STATS_MODE</a><br/>
<a href="functions189.htm#i1279921">STATS_MW_TEST</a><br/>
<a href="functions190.htm#i1335576">STATS_ONE_WAY_ANOVA</a><br/>
<a href="functions191.htm#i1279931">STATS_T_TEST_*</a><br/>
<a href="functions192.htm#i1279951">STATS_WSR_TEST</a><br/>
<a href="functions193.htm#i89108">STDDEV</a><br/>
<a href="functions194.htm#i86639">STDDEV_POP</a><br/>
<a href="functions195.htm#i86697">STDDEV_SAMP</a><br/>
<a href="functions197.htm#i89126">SUM</a><br/>
<a href="functions203.htm#CJABIIAF">SYS_OP_ZONE_ID</a><br/>
<a href="functions205.htm#i1006716">SYS_XMLAGG</a><br/>
<a href="functions246.htm#i87119">VAR_POP</a><br/>
<a href="functions247.htm#i87169">VAR_SAMP</a><br/>
<a href="functions248.htm#i89144">VARIANCE</a><br/>
<a href="functions251.htm#i1286333">XMLAGG</a></div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5862">
<tr>
<td class="cellalignment5869">
<table class="cellalignment5867">
<tr>
<td class="cellalignment5866"><a href="functions002.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5866"><a href="functions004.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2017,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5871">
<table class="cellalignment5865">
<tr>
<td class="cellalignment5866"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5866"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5866"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5866"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5866"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5866"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>