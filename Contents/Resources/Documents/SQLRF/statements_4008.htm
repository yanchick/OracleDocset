<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-103622"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/AUDIT%20%28Unified%20Auditing%29"></a><title>AUDIT (Unified Auditing)</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1093"/>
<meta name="dcterms.created" content="2017-07-18T18:52:42Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database SQL Language Reference"/>
<meta name="dcterms.identifier" content="E41329-25"/>
<meta name="dcterms.isVersionOf" content="SQLRF"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2017,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="statements_4007.htm" title="Previous" type="text/html"/>
<link rel="Next" href="statements_4009.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41329-25.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">411/555</span> <!-- End Header --><a id="BABCABGI"></a>
<div id="SQLRF56110" class="refsect1"><!-- infolevel="all" infotype="General" -->
<h1 class="refsect1">AUDIT (Unified Auditing)<a id="sthref4416"></a><a id="sthref4417"></a></h1>
<p>This section describes the <code dir="ltr">AUDIT</code> statement for <span class="bold">unified</span> <span class="bold">auditing</span>. This type of auditing is new beginning with Oracle Database 12<span class="italic">c</span> and provides a full set of enhanced auditing features. Refer to <a class="olink DBSEG630" href="../DBSEG/auditing.htm#DBSEG630"><span class="italic">Oracle Database Security Guide</span></a> for more information on unified auditing.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4418"></a>Purpose</p>
<p>Use the <code dir="ltr">AUDIT</code> statement to:</p>
<ul>
<li>
<p>Enable a unified audit policy for all users or for specified users</p>
</li>
<li>
<p>Specify whether an audit record is created if the audited event fails, succeeds, or both</p>
</li>
<li>
<p>Specify application context attributes, whose values will be recorded in audit records</p>
</li>
</ul>
<p>Operations performed with this statement take effect in subsequent user sessions, not in the current session.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="statements_9019.htm#BGEEFAFE">NOAUDIT (Unified Auditing)</a></p>
</li>
<li>
<p><a href="statements_5001.htm#BGEJHBAE">CREATE AUDIT POLICY (Unified Auditing)</a></p>
</li>
<li>
<p><a href="statements_1004.htm#BGEJGHBH">ALTER AUDIT POLICY (Unified Auditing)</a></p>
</li>
<li>
<p><a href="statements_8007.htm#BABDFFIG">DROP AUDIT POLICY (Unified Auditing)</a></p>
</li>
</ul>
</div>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4419"></a>Prerequisites</p>
<p>You must have the <code dir="ltr">AUDIT</code> <code dir="ltr">SYSTEM</code> system privilege or the <code dir="ltr">AUDIT_ADMIN</code> role.</p>
<p>If you are connected to a multitenant container database (CDB), then to enable a common unified audit policy, the current container must be the root and you must have the commonly granted <code dir="ltr">AUDIT</code> <code dir="ltr">SYSTEM</code> privilege or the <code dir="ltr">AUDIT_ADMIN</code> common role. To enable a local unified audit policy, the current container must be the container in which the audit policy was created and you must have the commonly granted <code dir="ltr">AUDIT</code> <code dir="ltr">SYSTEM</code> privilege or the <code dir="ltr">AUDIT_ADMIN</code> common role, or you must have the locally granted <code dir="ltr">AUDIT</code> <code dir="ltr">SYSTEM</code> privilege or the <code dir="ltr">AUDIT_ADMIN</code> local role in the container.</p>
<p>To specify the <code dir="ltr">AUDIT</code> <code dir="ltr">CONTEXT</code> ... statement when connected to a CDB, you must have the commonly granted <code dir="ltr">AUDIT</code> <code dir="ltr">SYSTEM</code> privilege or the <code dir="ltr">AUDIT_ADMIN</code> common role, or you must have the locally granted <code dir="ltr">AUDIT</code> <code dir="ltr">SYSTEM</code> privilege or the <code dir="ltr">AUDIT_ADMIN</code> local role in the current session&#39;s container.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4420"></a>Syntax</p>
<p class="subhead2"><a id="SQLRF56111"></a><span class="italic">unified_audit</span>::=</p>
<img width="820" height="192" src="img/unified_audit.gif" alt="Description of unified_audit.gif follows"/><br/>
<a id="sthref4421" href="img_text/unified_audit.htm">Description of the illustration &#39;&#39;unified_audit.gif&#39;&#39;</a><br/>
<br/></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4422"></a>Semantics</p>
<p class="subhead1"><a id="SQLRF56172"></a><span class="italic">policy</span></p>
<p>Specify the name of the unified audit policy to be enabled. The policy must have been created using the <code dir="ltr">CREATE</code> <code dir="ltr">AUDIT</code> <code dir="ltr">POLICY</code> statement.</p>
<p>You can find descriptions of all unified audit policies by querying the <code dir="ltr">AUDIT_UNIFIED_POLICIES</code> view and descriptions of all <span class="italic">enabled</span> unified audit policies by querying the <code dir="ltr">AUDIT_UNIFIED_ENABLED_POLICIES</code> view.</p>
<p>When you enable a unified audit policy, all SQL statements and operations that satisfy either a system privilege or action or role audit option specified in the enabled policy will be audited&mdash;that is, a unified audit record will be created in the <code dir="ltr">UNIFIED_AUDIT_TRAIL</code> view. If a single SQL statement or operation satisfies multiple enabled policies, then only one unified audit record will be created and all satisfied audit policy names will appear in a comma-separated list in the <code dir="ltr">UNIFIED_AUDIT_POLICIES</code> column of the <code dir="ltr">UNIFIED_AUDIT_TRAIL</code> view.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="statements_5001.htm#BGEJHBAE">CREATE AUDIT POLICY (Unified Auditing)</a></p>
</li>
<li>
<p><span class="italic">Oracle Database Reference</span> for more information on the <a class="olink REFRN29157" href="../REFRN/GUID-D5F941B7-67B9-4936-8B00-8590FBBBF6DB.htm#REFRN29157"><code dir="ltr">AUDIT_UNIFIED_POLICIES</code></a>, <a class="olink REFRN29158" href="../REFRN/GUID-31A07468-11E0-43AD-9A5D-71B5A5AA03C3.htm#REFRN29158"><code dir="ltr">AUDIT_UNIFIED_ENABLED_POLICIES</code></a>, and <a class="olink REFRN29162" href="../REFRN/GUID-B7CE1C02-2FD4-47D6-80AA-CF74A60CDD1D.htm#REFRN29162"><code dir="ltr">UNIFIED_AUDIT_TRAIL</code></a> views</p>
</li>
</ul>
</div>
<p class="subhead1"><a id="SQLRF56173"></a>BY | EXCEPT</p>
<p>Specify the <code dir="ltr">BY</code> clause to enable <code dir="ltr"><span class="codeinlineitalic">policy</span></code> for only the specified users.</p>
<p>Specify the <code dir="ltr">EXCEPT</code> clause to enable <code dir="ltr"><span class="codeinlineitalic">policy</span></code> for all users except the specified users.</p>
<p>If you omit the <code dir="ltr">BY</code> and <code dir="ltr">EXCEPT</code> clauses, then Oracle Database enables <code dir="ltr"><span class="codeinlineitalic">policy</span></code> for all users.</p>
<p>If <code dir="ltr"><span class="codeinlineitalic">policy</span></code> is a common unified audit policy, then <code dir="ltr"><span class="codeinlineitalic">user</span></code> must be a common user. If <code dir="ltr"><span class="codeinlineitalic">policy</span></code> is a local unified audit policy, then <code dir="ltr"><span class="codeinlineitalic">user</span></code> must be a common user or a local user in the container to which you are connected.</p>
<p><a id="SQLRF56408"></a><span class="subhead3">Notes on the BY and EXCEPT Clauses&nbsp;</span>The following notes apply to the <code dir="ltr">BY</code> and <code dir="ltr">EXCEPT</code> clauses:</p>
<ul>
<li>
<p>If multiple <code dir="ltr">AUDIT</code> ... <code dir="ltr">BY</code> ... statements are specified for the same unified audit policy, then the policy is enabled for the union of the users specified in each statement.</p>
</li>
<li>
<p>If multiple <code dir="ltr">AUDIT</code> ... <code dir="ltr">EXCEPT</code> ... statements are specified for the same unified audit policy, then only the most recently specified statement takes effect. That is, the policy is enabled for all users except the users specified in the most recent <code dir="ltr">AUDIT</code> ... <code dir="ltr">EXCEPT</code> ... statement.</p>
</li>
<li>
<p>If a policy is enabled using the <code dir="ltr">BY</code> clause and you would like to instead enable it using the <code dir="ltr">EXCEPT</code> clause, then you must first use the <code dir="ltr">NOAUDIT</code> ... <code dir="ltr">BY</code> ... statement to disable the policy for all users for whom the policy is currently enabled, and then enable the policy with the <code dir="ltr">AUDIT</code> ... <code dir="ltr">EXCEPT</code> ... statement.</p>
</li>
<li>
<p>If a policy is enabled using the <code dir="ltr">EXCEPT</code> clause and you would like to instead enable it using the <code dir="ltr">BY</code> clause, then you must first use the <code dir="ltr">NOAUDIT</code> statement to disable the audit policy. Note that you cannot specify the <code dir="ltr">EXCEPT</code> clause with the <code dir="ltr">NOAUDIT</code> statement. You can then enable the policy with the <code dir="ltr">AUDIT</code> ... <code dir="ltr">BY</code> ... statement.</p>
</li>
</ul>
<p><a id="SQLRF56409"></a><span class="subhead3">Restriction on the BY and EXCEPT Clauses&nbsp;</span>You cannot specify an <code dir="ltr">AUDIT</code> ... <code dir="ltr">BY</code> ... statement and an <code dir="ltr">AUDIT</code> ... <code dir="ltr">EXCEPT</code> ... statement for the same unified audit policy. If you attempt to do so, then an error occurs.</p>
<p class="subhead1"><a id="SQLRF56174"></a>WHENEVER [NOT] SUCCESSFUL</p>
<p>Specify <code dir="ltr">WHENEVER</code> <code dir="ltr">SUCCESSFUL</code> to audit only SQL statements and operations that succeed.</p>
<p>Specify <code dir="ltr">WHENEVER</code> <code dir="ltr">NOT</code> <code dir="ltr">SUCCESSFUL</code> to audit only SQL statements and operations that fail or result in errors.</p>
<p>If you omit this clause, then Oracle Database performs the audit regardless of success or failure.</p>
<p class="subhead1"><a id="SQLRF56175"></a>CONTEXT Clause</p>
<p>Specify the <code dir="ltr">CONTEXT</code> clause to include the values of context attributes in audit records.</p>
<ul>
<li>
<p>For <code dir="ltr"><span class="codeinlineitalic">namespace</span></code>, specify the context namespace.</p>
</li>
<li>
<p>For <code dir="ltr"><span class="codeinlineitalic">attribute</span></code>, specify one or more context attributes whose values you want to include in audit records.</p>
</li>
<li>
<p>Use the optional <code dir="ltr">BY</code> <code dir="ltr"><span class="codeinlineitalic">user</span></code> clause to include the values of the context attributes only in audit records for events executed by the specified users. If you omit the <code dir="ltr">BY</code> clause, then the values of the context attributes are included in all audit records.</p>
</li>
</ul>
<p>If you specify the <code dir="ltr">CONTEXT</code> clause when the current container is the root of a CDB, then the values of context attributes will be included in audit records only for events executed in the root. If you specify the optional <code dir="ltr">BY</code> clause, then <code dir="ltr"><span class="codeinlineitalic">user</span></code> must be a common user.</p>
<p>If you specify the <code dir="ltr">CONTEXT</code> clause when the current container is a pluggable database (PDB), then the values of context attributes will be included in audit records only for events executed in that PDB. If you specify the optional <code dir="ltr">BY</code> clause, then <code dir="ltr"><span class="codeinlineitalic">user</span></code> must be a common user or a local user in that PDB.</p>
<p>You can find the application context attributes that are configured to be captured in the audit trail by querying the <code dir="ltr">AUDIT_UNIFIED_CONTEXTS</code> view.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink REFRN29159" href="../REFRN/GUID-ED1387E3-7828-4B39-A2B3-2C8ADFD36943.htm#REFRN29159"><span class="italic">Oracle Database Reference</span></a> for more information on the <code dir="ltr">AUDIT_UNIFIED_CONTEXTS</code> view</div>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="BABGCDGC"></a>Examples</p>
<p>The following examples enable unified audit policies that were created in the <code dir="ltr">CREATE</code> <code dir="ltr">AUDIT</code> <code dir="ltr">POLICY</code> <a href="statements_5001.htm#BGEGDCFA">&#34;Examples&#34;</a>.</p>
<p><a id="SQLRF56426"></a><span class="subhead3">Enabling a Unified Audit Policy for All Users: Example&nbsp;</span>The following statement enables unified audit policy <code dir="ltr">table_pol</code> for all users:</p>
<pre dir="ltr">AUDIT POLICY table_pol;
</pre>
<p>The following statement verifies that <code dir="ltr">table_pol</code> is enabled for all users:</p>
<pre dir="ltr">SELECT policy_name, enabled_opt, user_name
  FROM audit_unified_enabled_policies
  WHERE policy_name = &#39;TABLE_POL&#39;;
 
POLICY_NAME  ENABLED_OPT  USER_NAME
-----------  -----------  ---------
TABLE_POL    BY           ALL USERS
</pre>
<p><a id="SQLRF56427"></a><span class="subhead3">Enabling a Unified Audit Policy for Specific Users: Examples&nbsp;</span>The following statement enables unified audit policy <code dir="ltr">dml_pol</code> for only users <code dir="ltr">hr</code> and <code dir="ltr">sh</code>:</p>
<pre dir="ltr">AUDIT POLICY dml_pol BY hr, sh;
</pre>
<p>The following statement verifies that <code dir="ltr">dml_pol</code> is enabled for only users <code dir="ltr">hr</code> and <code dir="ltr">sh</code>:</p>
<pre dir="ltr">SELECT policy_name, enabled_opt, user_name
  FROM audit_unified_enabled_policies
  WHERE policy_name = &#39;DML_POL&#39;
  ORDER BY user_name;
 
POLICY_NAME  ENABLED_OPT  USER_NAME
-----------  -----------  ---------
DML_POL      BY           HR
DML_POL      BY           SH
</pre>
<p>The following statement enables unified audit policy <code dir="ltr">read_dir_pol</code> for all users except <code dir="ltr">hr</code>:</p>
<pre dir="ltr">AUDIT POLICY read_dir_pol EXCEPT hr;
</pre>
<p>The following statement verifies that <code dir="ltr">read_dir_pol</code> is enabled for all users except <code dir="ltr">hr</code>:</p>
<pre dir="ltr">SELECT policy_name, enabled_opt, user_name
  FROM audit_unified_enabled_policies
  WHERE policy_name = &#39;READ_DIR_POL&#39;;
 
POLICY_NAME   ENABLED_OPT  USER_NAME
------------  -----------  ---------
READ_DIR_POL  EXCEPT       HR
</pre>
<p>The following statement enables unified audit policy <code dir="ltr">security_pol</code> for user <code dir="ltr">hr</code> and audits only the SQL statements and operations that fail:</p>
<pre dir="ltr">AUDIT POLICY security_pol BY hr WHENEVER NOT SUCCESSFUL;
</pre>
<p>The following statement verifies that <code dir="ltr">security_pol</code> is enabled for only user <code dir="ltr">hr</code> and that only the SQL statements and operations that fail will be audited:</p>
<pre dir="ltr">SELECT policy_name, enabled_opt, user_name, success, failure
  FROM audit_unified_enabled_policies
  WHERE policy_name = &#39;SECURITY_POL&#39;;
 
POLICY_NAME   ENABLED_OPT           USER_NAME   SUCCESS  FAILURE
------------  --------------------  ----------  -------  -------
SECURITY_POL  BY                    HR          NO       YES
</pre>
<p><a id="SQLRF56428"></a><span class="subhead3">Including Values of Context Attributes in Audit Records: Example&nbsp;</span>The following statement instructs the database to include the values of namespace <code dir="ltr">USERENV</code> attributes <code dir="ltr">CURRENT_USER</code> and <code dir="ltr">DB_NAME</code> in all audit records for user <code dir="ltr">hr</code>:</p>
<pre dir="ltr">AUDIT CONTEXT NAMESPACE userenv
  ATTRIBUTES current_user, db_name
  BY hr;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5862">
<tr>
<td class="cellalignment5869">
<table class="cellalignment5867">
<tr>
<td class="cellalignment5866"><a href="statements_4007.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5866"><a href="statements_4009.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2017,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5871">
<table class="cellalignment5865">
<tr>
<td class="cellalignment5866"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5866"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5866"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5866"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5866"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5866"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>