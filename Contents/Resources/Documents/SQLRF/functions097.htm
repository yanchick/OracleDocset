<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-102179"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/LAST_VALUE"></a><title>LAST_VALUE</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1093"/>
<meta name="dcterms.created" content="2017-07-18T18:52:16Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database SQL Language Reference"/>
<meta name="dcterms.identifier" content="E41329-25"/>
<meta name="dcterms.isVersionOf" content="SQLRF"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2017,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="functions096.htm" title="Previous" type="text/html"/>
<link rel="Next" href="functions098.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41329-25.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">170/555</span> <!-- End Header --><a id="i83648"></a>
<div id="SQLRF00655" class="refsect1"><!-- infolevel="all" infotype="General" -->
<h1 class="refsect1">LAST_VALUE <a id="sthref1559"></a><a id="sthref1560"></a></h1>
<p class="subhead1"><a id="SQLRF51471"></a>Syntax</p>
<img width="697" height="162" src="img/last_value.gif" alt="Description of last_value.gif follows"/><br/>
<a id="sthref1561" href="img_text/last_value.htm">Description of the illustration &#39;&#39;last_value.gif&#39;&#39;</a><br/>
<br/>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="functions004.htm#i81407">&#34;Analytic Functions&#34;</a> for information on syntax, semantics, and restrictions, including valid forms of <code dir="ltr"><span class="codeinlineitalic">expr</span></code></div>
<p class="subhead1"><a id="SQLRF51472"></a>Purpose</p>
<p><code dir="ltr">LAST_VALUE</code> is an analytic function that is useful for data densification. It returns the last value in an ordered set of values.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The two forms of this syntax have the same behavior. The top branch is the ANSI format, which Oracle recommends for ANSI compatibility.</div>
<p>{<code dir="ltr">RESPECT</code> | <code dir="ltr">IGNORE</code>} <code dir="ltr">NULLS</code> determines whether null values of <code dir="ltr"><span class="codeinlineitalic">expr</span></code> are included in or eliminated from the calculation. The default is <code dir="ltr">RESPECT</code> <code dir="ltr">NULLS</code>. If the last value in the set is null, then the function returns <code dir="ltr">NULL</code> unless you specify <code dir="ltr">IGNORE</code> <code dir="ltr">NULLS</code>. If you specify <code dir="ltr">IGNORE NULLS</code>, then <code dir="ltr">LAST_VALUE</code> returns the last non-null value in the set, or <code dir="ltr">NULL</code> if all values are null. Refer to <a href="statements_10002.htm#i2177515">&#34;Using Partitioned Outer Joins: Examples&#34;</a> for an example of data densification.</p>
<p>You cannot nest analytic functions by using <code dir="ltr">LAST_VALUE</code> or any other analytic function for <code dir="ltr"><span class="codeinlineitalic">expr</span></code>. However, you can use other built-in function expressions for <code dir="ltr"><span class="codeinlineitalic">expr</span></code>. Refer to <a href="expressions001.htm#i1002626">&#34;About SQL Expressions&#34;</a> for information on valid forms of <code dir="ltr"><span class="codeinlineitalic">expr</span></code>.</p>
<p>If you omit the <code dir="ltr"><span class="codeinlineitalic">windowing_clause</span></code> of the <code dir="ltr"><span class="codeinlineitalic">analytic_clause</span></code>, it defaults to <code dir="ltr">RANGE</code> <code dir="ltr">BETWEEN</code> <code dir="ltr">UNBOUNDED</code> <code dir="ltr">PRECEDING</code> <code dir="ltr">AND</code> <code dir="ltr">CURRENT</code> <code dir="ltr">ROW</code>. This default sometimes returns an unexpected value, because the last value in the window is at the bottom of the window, which is not fixed. It keeps changing as the current row changes. For expected results, specify the <code dir="ltr"><span class="codeinlineitalic">windowing_clause</span></code> as <code dir="ltr">RANGE</code> <code dir="ltr">BETWEEN</code> <code dir="ltr">UNBOUNDED</code> <code dir="ltr">PRECEDING</code> <code dir="ltr">AND</code> <code dir="ltr">UNBOUNDED</code> <code dir="ltr">FOLLOWING</code>. Alternatively, you can specify the <code dir="ltr"><span class="codeinlineitalic">windowing_clause</span></code> as <code dir="ltr">RANGE</code> <code dir="ltr">BETWEEN</code> <code dir="ltr">CURRENT</code> <code dir="ltr">ROW</code> <code dir="ltr">AND</code> <code dir="ltr">UNBOUNDED</code> <code dir="ltr">FOLLOWING</code>.</p>
<p class="subhead1"><a id="SQLRF51473"></a>Examples</p>
<p>The following example returns, for each row, the hire date of the employee earning the lowest salary:</p>
<pre dir="ltr">SELECT employee_id, last_name, salary, hire_date,
       LAST_VALUE(hire_date)
         OVER (ORDER BY salary DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED
               FOLLOWING) AS lv
  FROM (SELECT * FROM employees
          WHERE department_id = 90
          ORDER BY hire_date);

EMPLOYEE_ID LAST_NAME                     SALARY HIRE_DATE LV
----------- ------------------------- ---------- --------- ---------
        100 King                           24000 17-JUN-03 13-JAN-01
        101 Kochhar                        17000 21-SEP-05 13-JAN-01
        102 De Haan                        17000 13-JAN-01 13-JAN-01
</pre>
<p>This example illustrates the nondeterministic nature of the <code dir="ltr">LAST_VALUE</code> function. Kochhar and De Haan have the same salary, so they are in adjacent rows. Kochhar appears first because the rows in the subquery are ordered by <code dir="ltr">hire_date</code>. However, if the rows are ordered by <code dir="ltr">hire_date</code> in descending order, as in the next example, then the function returns a different value:</p>
<pre dir="ltr">SELECT employee_id, last_name, salary, hire_date,
       LAST_VALUE(hire_date)
         OVER (ORDER BY salary DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED
               FOLLOWING) AS lv
  FROM (SELECT * FROM employees
          WHERE department_id = 90
          ORDER BY hire_date <span class="bold">DESC</span>);

EMPLOYEE_ID LAST_NAME                     SALARY HIRE_DATE LV
----------- ------------------------- ---------- --------- ---------
        100 King                           24000 17-JUN-03 21-SEP-05
        102 De Haan                        17000 13-JAN-01 21-SEP-05
        101 Kochhar                        17000 21-SEP-05 21-SEP-05
</pre>
<p>The following two examples show how to make the <code dir="ltr">LAST_VALUE</code> function deterministic by ordering on a unique key. By ordering within the function by both <code dir="ltr">salary</code> and the unique key <code dir="ltr">employee_id</code>, you can ensure the same result regardless of the ordering in the subquery.</p>
<pre dir="ltr">SELECT employee_id, last_name, salary, hire_date,
       LAST_VALUE(hire_date)
         OVER (ORDER BY salary DESC, <span class="bold">employee_id</span> ROWS BETWEEN UNBOUNDED PRECEDING
               AND UNBOUNDED FOLLOWING) AS lv
  FROM (SELECT * FROM employees
          WHERE department_id = 90
          ORDER BY hire_date);

EMPLOYEE_ID LAST_NAME                     SALARY HIRE_DATE LV
----------- ------------------------- ---------- --------- ---------
        100 King                           24000 17-JUN-03 13-JAN-01
        101 Kochhar                        17000 21-SEP-05 13-JAN-01
        102 De Haan                        17000 13-JAN-01 13-JAN-01


SELECT employee_id, last_name, salary, hire_date,
       LAST_VALUE(hire_date)
         OVER (ORDER BY salary DESC, <span class="bold">employee_id</span> ROWS BETWEEN UNBOUNDED PRECEDING
               AND UNBOUNDED FOLLOWING) AS lv
  FROM (SELECT * FROM employees
          WHERE department_id = 90
          ORDER BY hire_date <span class="bold">DESC</span>);

EMPLOYEE_ID LAST_NAME                     SALARY HIRE_DATE LV
----------- ------------------------- ---------- --------- ---------
        100 King                           24000 17-JUN-03 13-JAN-01
        101 Kochhar                        17000 21-SEP-05 13-JAN-01
        102 De Haan                        17000 13-JAN-01 13-JAN-01
</pre>
<p>The following two examples show that the <code dir="ltr">LAST_VALUE</code> function is deterministic when you use a logical offset (<code dir="ltr">RANGE</code> instead of <code dir="ltr">ROWS</code>). When duplicates are found for the <code dir="ltr">ORDER</code> <code dir="ltr">BY</code> expression, the <code dir="ltr">LAST_VALUE</code> is the highest value of <code dir="ltr"><span class="codeinlineitalic">expr</span></code>:</p>
<pre dir="ltr">SELECT employee_id, last_name, salary, hire_date,
       LAST_VALUE(hire_date)
         OVER (ORDER BY salary DESC <span class="bold">RANGE</span> BETWEEN UNBOUNDED PRECEDING AND
               UNBOUNDED FOLLOWING) AS lv
  FROM (SELECT * FROM employees
          WHERE department_id = 90
          ORDER BY hire_date);

EMPLOYEE_ID LAST_NAME                     SALARY HIRE_DATE LV
----------- ------------------------- ---------- --------- ---------
        100 King                           24000 17-JUN-03 21-SEP-05
        102 De Haan                        17000 13-JAN-01 21-SEP-05
        101 Kochhar                        17000 21-SEP-05 21-SEP-05


SELECT employee_id, last_name, salary, hire_date,
       LAST_VALUE(hire_date)
         OVER (ORDER BY salary DESC <span class="bold">RANGE</span> BETWEEN UNBOUNDED PRECEDING AND
               UNBOUNDED FOLLOWING) AS lv
  FROM (SELECT * FROM employees
          WHERE department_id = 90
          ORDER BY hire_date <span class="bold">DESC</span>);

EMPLOYEE_ID LAST_NAME                     SALARY HIRE_DATE LV
----------- ------------------------- ---------- --------- ---------
        100 King                           24000 17-JUN-03 21-SEP-05
        102 De Haan                        17000 13-JAN-01 21-SEP-05
        101 Kochhar                        17000 21-SEP-05 21-SEP-05
</pre></div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5862">
<tr>
<td class="cellalignment5869">
<table class="cellalignment5867">
<tr>
<td class="cellalignment5866"><a href="functions096.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5866"><a href="functions098.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2017,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5871">
<table class="cellalignment5865">
<tr>
<td class="cellalignment5866"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5866"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5866"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5866"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5866"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5866"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>