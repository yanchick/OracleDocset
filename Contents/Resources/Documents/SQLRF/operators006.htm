<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-103533"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Multiset%20Operators"></a><title>Multiset Operators</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1093"/>
<meta name="dcterms.created" content="2017-07-18T18:52:9Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database SQL Language Reference"/>
<meta name="dcterms.identifier" content="E41329-25"/>
<meta name="dcterms.isVersionOf" content="SQLRF"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2017,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="operators005.htm" title="Previous" type="text/html"/>
<link rel="Next" href="operators007.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41329-25.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">38/555</span> <!-- End Header --><a id="i1035617"></a>
<div id="SQLRF0032" class="sect1"><!-- infolevel="all" infotype="General" -->
<h1 class="sect1">Multiset Operators <a id="sthref911"></a><a id="sthref912"></a></h1>
<p>Multiset operators combine the results of two nested tables into a single nested table.</p>
<p>The examples related to multiset operators require that two nested tables be created and loaded with data as follows:</p>
<p>First, make a copy of the <code dir="ltr">oe.customers</code> table called <code dir="ltr">customers_demo</code>:</p>
<pre dir="ltr">CREATE TABLE customers_demo AS
  SELECT * FROM customers;
</pre>
<p>Next, create a table type called <code dir="ltr">cust_address_tab_typ</code>. This type will be used when creating the nested table columns.</p>
<pre dir="ltr">CREATE TYPE cust_address_tab_typ AS
  TABLE OF cust_address_typ;
/
</pre>
<p>Now, create two nested table columns in the <code dir="ltr">customers_demo</code> table:</p>
<pre dir="ltr">ALTER TABLE customers_demo
  ADD (cust_address_ntab cust_address_tab_typ,
       cust_address2_ntab cust_address_tab_typ)
    NESTED TABLE cust_address_ntab STORE AS cust_address_ntab_store
    NESTED TABLE cust_address2_ntab STORE AS cust_address2_ntab_store;
</pre>
<p>Finally, load data into the two new nested table columns using data from the <code dir="ltr">cust_address</code> column of the <code dir="ltr">oe.customers</code> table:</p>
<pre dir="ltr">UPDATE customers_demo cd
  SET cust_address_ntab = 
    CAST(MULTISET(SELECT cust_address
                    FROM customers c
                    WHERE c.customer_id =
                          cd.customer_id) as cust_address_tab_typ);

UPDATE customers_demo cd
  SET cust_address2_ntab = 
    CAST(MULTISET(SELECT cust_address
                    FROM customers c
                    WHERE c.customer_id =
                          cd.customer_id) as cust_address_tab_typ);
</pre>
<a id="i1035635"></a>
<div id="SQLRF51166" class="sect2"><!-- infolevel="all" infotype="General" -->
<h2 class="sect2">MULTISET EXCEPT <a id="sthref913"></a><a id="sthref914"></a><a id="sthref915"></a></h2>
<p><code dir="ltr">MULTISET</code> <code dir="ltr">EXCEPT</code> takes as arguments two nested tables and returns a nested table whose elements are in the first nested table but not in the second nested table. The two input nested tables must be of the same type, and the returned nested table is of the same type as well.</p>
<img width="524" height="79" src="img/multiset_except.gif" alt="Description of multiset_except.gif follows"/><br/>
<a id="sthref916" href="img_text/multiset_except.htm">Description of the illustration &#39;&#39;multiset_except.gif&#39;&#39;</a><br/>
<br/>
<ul>
<li>
<p>The <code dir="ltr">ALL</code> keyword instructs Oracle to return all elements in <code dir="ltr"><span class="codeinlineitalic">nested_table1</span></code> that are not in <code dir="ltr"><span class="codeinlineitalic">nested_table2</span></code>. For example, if a particular element occurs <code dir="ltr"><span class="codeinlineitalic">m</span></code> times in <code dir="ltr"><span class="codeinlineitalic">nested_table1</span></code> and <code dir="ltr"><span class="codeinlineitalic">n</span></code> times in <code dir="ltr"><span class="codeinlineitalic">nested_table2</span></code>, then the result will have <code dir="ltr"><span class="codeinlineitalic">(m-n)</span></code> occurrences of the element if <code dir="ltr"><span class="codeinlineitalic">m &gt;n</span></code> and 0 occurrences if <code dir="ltr"><span class="codeinlineitalic">m&lt;=n</span></code>. <code dir="ltr">ALL</code> is the default.</p>
</li>
<li>
<p>The <code dir="ltr">DISTINCT</code> keyword instructs Oracle to eliminate any element in <code dir="ltr"><span class="codeinlineitalic">nested_table1</span></code> which is also in <code dir="ltr"><span class="codeinlineitalic">nested_table2</span></code>, regardless of the number of occurrences.</p>
</li>
<li>
<p>The element types of the nested tables must be comparable. Refer to <a href="conditions002.htm#i1033286">&#34;Comparison Conditions&#34;</a> for information on the comparability of nonscalar types.</p>
</li>
</ul>
<p class="subhead1"><a id="SQLRF51167"></a>Example</p>
<p>The following example compares two nested tables and returns a nested table of those elements found in the first nested table but not in the second nested table:</p>
<pre dir="ltr">SELECT customer_id, cust_address_ntab
  MULTISET EXCEPT DISTINCT cust_address2_ntab multiset_except
  FROM customers_demo
  ORDER BY customer_id;

CUSTOMER_ID MULTISET_EXCEPT(STREET_ADDRESS, POSTAL_CODE, CITY, STATE_PROVINCE, COUNTRY_ID)
----------- --------------------------------------------------------------------------------
        101 CUST_ADDRESS_TAB_TYP()
        102 CUST_ADDRESS_TAB_TYP()
        103 CUST_ADDRESS_TAB_TYP()
        104 CUST_ADDRESS_TAB_TYP()
        105 CUST_ADDRESS_TAB_TYP()
. . .
</pre>
<p>The preceding example requires the table <code dir="ltr">customers_demo</code> and two nested table columns containing data. Refer to <a href="#i1035617">&#34;Multiset Operators&#34;</a> to create this table and nested table columns.</p>
</div>
<!-- class="sect2" -->
<a id="i1035636"></a>
<div id="SQLRF51168" class="sect2"><!-- infolevel="all" infotype="General" -->
<h2 class="sect2">MULTISET INTERSECT <a id="sthref917"></a><a id="sthref918"></a><a id="sthref919"></a></h2>
<p><code dir="ltr">MULTISET</code> <code dir="ltr">INTERSECT</code> takes as arguments two nested tables and returns a nested table whose values are common in the two input nested tables. The two input nested tables must be of the same type, and the returned nested table is of the same type as well.</p>
<img width="543" height="79" src="img/multiset_intersect.gif" alt="Description of multiset_intersect.gif follows"/><br/>
<a id="sthref920" href="img_text/multiset_intersect.htm">Description of the illustration &#39;&#39;multiset_intersect.gif&#39;&#39;</a><br/>
<br/>
<ul>
<li>
<p>The <code dir="ltr">ALL</code> keyword instructs Oracle to return all common occurrences of elements that are in the two input nested tables, including duplicate common values and duplicate common <code dir="ltr">NULL</code> occurrences. For example, if a particular value occurs <code dir="ltr">m</code> times in <code dir="ltr"><span class="codeinlineitalic">nested_table1</span></code> and <code dir="ltr">n</code> times in <code dir="ltr"><span class="codeinlineitalic">nested_table2</span></code>, then the result would contain the element <code dir="ltr">min(m,n)</code> times. <code dir="ltr">ALL</code> is the default.</p>
</li>
<li>
<p>The <code dir="ltr">DISTINCT</code> keyword instructs Oracle to eliminate duplicates from the returned nested table, including duplicates of <code dir="ltr">NULL</code>, if they exist.</p>
</li>
<li>
<p>The element types of the nested tables must be comparable. Refer to <a href="conditions002.htm#i1033286">&#34;Comparison Conditions&#34;</a> for information on the comparability of nonscalar types.</p>
</li>
</ul>
<p class="subhead1"><a id="SQLRF51169"></a>Example</p>
<p>The following example compares two nested tables and returns a nested table of those elements found in both input nested tables:</p>
<pre dir="ltr">SELECT customer_id, cust_address_ntab
  MULTISET INTERSECT DISTINCT cust_address2_ntab multiset_intersect
  FROM customers_demo
  ORDER BY customer_id;

CUSTOMER_ID MULTISET_INTERSECT(STREET_ADDRESS, POSTAL_CODE, CITY, STATE_PROVINCE, COUNTRY_ID
----------- -----------------------------------------------------------------------------------
        101 CUST_ADDRESS_TAB_TYP(CUST_ADDRESS_TYP(&#39;514 W Superior St&#39;, &#39;46901&#39;, &#39;Kokomo&#39;, &#39;IN&#39;, &#39;US&#39;))
        102 CUST_ADDRESS_TAB_TYP(CUST_ADDRESS_TYP(&#39;2515 Bloyd Ave&#39;, &#39;46218&#39;, &#39;Indianapolis&#39;, &#39;IN&#39;, &#39;US&#39;))
        103 CUST_ADDRESS_TAB_TYP(CUST_ADDRESS_TYP(&#39;8768 N State Rd 37&#39;, &#39;47404&#39;, &#39;Bloomington&#39;, &#39;IN&#39;, &#39;US&#39;))
        104 CUST_ADDRESS_TAB_TYP(CUST_ADDRESS_TYP(&#39;6445 Bay Harbor Ln&#39;, &#39;46254&#39;, &#39;Indianapolis&#39;, &#39;IN&#39;, &#39;US&#39;))
        105 CUST_ADDRESS_TAB_TYP(CUST_ADDRESS_TYP(&#39;4019 W 3Rd St&#39;, &#39;47404&#39;, &#39;Bloomington&#39;, &#39;IN&#39;, &#39;US&#39;))
. . .
</pre>
<p>The preceding example requires the table <code dir="ltr">customers_demo</code> and two nested table columns containing data. Refer to <a href="#i1035617">&#34;Multiset Operators&#34;</a> to create this table and nested table columns.</p>
</div>
<!-- class="sect2" -->
<a id="i1035637"></a>
<div id="SQLRF51170" class="sect2"><!-- infolevel="all" infotype="General" -->
<h2 class="sect2">MULTISET UNION <a id="sthref921"></a><a id="sthref922"></a><a id="sthref923"></a></h2>
<p><code dir="ltr">MULTISET</code> <code dir="ltr">UNION</code> takes as arguments two nested tables and returns a nested table whose values are those of the two input nested tables. The two input nested tables must be of the same type, and the returned nested table is of the same type as well.</p>
<img width="515" height="79" src="img/multiset_union.gif" alt="Description of multiset_union.gif follows"/><br/>
<a id="sthref924" href="img_text/multiset_union.htm">Description of the illustration &#39;&#39;multiset_union.gif&#39;&#39;</a><br/>
<br/>
<ul>
<li>
<p>The <code dir="ltr">ALL</code> keyword instructs Oracle to return all elements that are in the two input nested tables, including duplicate values and duplicate <code dir="ltr">NULL</code> occurrences. This is the default.</p>
</li>
<li>
<p>The <code dir="ltr">DISTINCT</code> keyword instructs Oracle to eliminate duplicates from the returned nested table, including duplicates of <code dir="ltr">NULL</code>, if they exist.</p>
</li>
<li>
<p>The element types of the nested tables must be comparable. Refer to <a href="conditions002.htm#i1033286">&#34;Comparison Conditions&#34;</a> for information on the comparability of nonscalar types.</p>
</li>
</ul>
<p class="subhead1"><a id="SQLRF51171"></a>Example</p>
<p>The following example compares two nested tables and returns a nested table of elements from both input nested tables:</p>
<pre dir="ltr">SELECT customer_id, cust_address_ntab
  MULTISET UNION cust_address2_ntab multiset_union
  FROM customers_demo
  ORDER BY customer_id;

CUSTOMER_ID MULTISET_UNION(STREET_ADDRESS, POSTAL_CODE, CITY, STATE_PROVINCE, COUNTRY_ID)
----------- -------------------------------------------------------------------------------
        101 CUST_ADDRESS_TAB_TYP(CUST_ADDRESS_TYP(&#39;514 W Superior St&#39;, &#39;46901&#39;, &#39;Kokomo&#39;, &#39;IN&#39;, &#39;US&#39;),
                                 CUST_ADDRESS_TYP(&#39;514 W Superior St&#39;, &#39;46901&#39;, &#39;Kokomo&#39;, &#39;IN&#39;, &#39;US&#39;))
        102 CUST_ADDRESS_TAB_TYP(CUST_ADDRESS_TYP(&#39;2515 Bloyd Ave&#39;, &#39;46218&#39;, &#39;Indianapolis&#39;, &#39;IN&#39;, &#39;US&#39;), 
                                 CUST_ADDRESS_TYP(&#39;2515 Bloyd Ave&#39;, &#39;46218&#39;, &#39;Indianapolis&#39;, &#39;IN&#39;,&#39;US&#39;))
        103 CUST_ADDRESS_TAB_TYP(CUST_ADDRESS_TYP(&#39;8768 N State Rd 37&#39;, &#39;47404&#39;, &#39;Bloomington&#39;, &#39;IN&#39;, &#39;US&#39;), 
                                 CUST_ADDRESS_TYP(&#39;8768 N State Rd 37&#39;, &#39;47404&#39;, &#39;Bloomington&#39;, &#39;IN&#39;, &#39;US&#39;))
        104 CUST_ADDRESS_TAB_TYP(CUST_ADDRESS_TYP(&#39;6445 Bay Harbor Ln&#39;, &#39;46254&#39;, &#39;Indianapolis&#39;, &#39;IN&#39;, &#39;US&#39;), 
                                 CUST_ADDRESS_TYP(&#39;6445 Bay Harbor Ln&#39;, &#39;46254&#39;, &#39;Indianapolis&#39;, &#39;IN&#39;, &#39;US&#39;))
        105 CUST_ADDRESS_TAB_TYP(CUST_ADDRESS_TYP(&#39;4019 W 3Rd St&#39;, &#39;47404&#39;, &#39;Bloomington&#39;, &#39;IN&#39;, &#39;US&#39;), 
                                 CUST_ADDRESS_TYP(&#39;4019 W 3Rd St&#39;, &#39;47404&#39;, &#39;Bloomington&#39;, &#39;IN&#39;, &#39;US&#39;))
. . .
</pre>
<p>The preceding example requires the table <code dir="ltr">customers_demo</code> and two nested table columns containing data. Refer to <a href="#i1035617">&#34;Multiset Operators&#34;</a> to create this table and nested table columns.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5862">
<tr>
<td class="cellalignment5869">
<table class="cellalignment5867">
<tr>
<td class="cellalignment5866"><a href="operators005.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5866"><a href="operators007.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2017,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5871">
<table class="cellalignment5865">
<tr>
<td class="cellalignment5866"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5866"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5866"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5866"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5866"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5866"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>