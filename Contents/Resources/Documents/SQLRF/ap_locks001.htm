<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-102013"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Automatic%20Locks%20in%20DML%20Operations"></a><title>Automatic Locks in DML Operations</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1093"/>
<meta name="dcterms.created" content="2017-07-18T18:53:5Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database SQL Language Reference"/>
<meta name="dcterms.identifier" content="E41329-25"/>
<meta name="dcterms.isVersionOf" content="SQLRF"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2017,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="ap_locks.htm" title="Previous" type="text/html"/>
<link rel="Next" href="ap_locks002.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41329-25.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">526/555</span> <!-- End Header -->
<script>
<!-- // <![CDATA[
window.name='ap_locks001'
// ]]> -->
</script> <script>
// <![CDATA[
function footdisplay(footnum,footnote) {
    var msg = window.open('', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');

    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">');
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>');
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('');
    msg.document.write('<style> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]\u003e <\/style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() { var height = msg.document.getElementById('footnote').offsetHeight; msg.resizeTo(598, height + 100); }, 100);
    msg.focus();
}
// ]]>
</script> <noscript>
<p>The script content on this page is for navigation purposes only and does not alter the content in any way.</p>
</noscript><a id="CIHBDAAH"></a>
<div id="SQLRF55502" class="sect1">
<h1 class="sect1">Automatic Locks in DML Operations</h1>
<p><a id="sthref7592"></a><a id="sthref7593"></a>The purpose of a DML lock, also called a <span class="bold">data lock</span>, is to guarantee the integrity of data being accessed concurrently by multiple users. For example, a DML lock can prevent multiple customers from buying the last copy of a book available from an online bookseller. DML locks prevent destructive interference of simultaneous conflicting DML or DDL operations.</p>
<p>DML statements automatically acquire locks at both the table level and the row level. In the sections that follow, the acronym in parentheses after each type of lock or lock mode is the abbreviation used in the Locks Monitor of Oracle Enterprise Manager. Enterprise Manager might display &#34;TM&#34; for any table lock, rather than indicate the mode of table lock (such as RS or SRX).</p>
<p>The types of row and table locks are summarized here. For a more complete discussion of the types of row and table locks, see <a class="olink CNCPT1339" href="../CNCPT/consist.htm#CNCPT1339"><span class="italic">Oracle Database Concepts</span></a>.</p>
<p><a id="SQLRF55503"></a><span class="subhead3">Row Locks (TX)&nbsp;</span><a id="sthref7594"></a><a id="sthref7595"></a><a id="sthref7596"></a><a id="sthref7597"></a><a id="sthref7598"></a><a id="sthref7599"></a>A <span class="bold">row lock</span>, also called a <span class="bold">TX lock</span>, is a lock on a single row of a table. A transaction acquires a row lock for each row modified by one of the following statements: <code>INSERT</code>, <code dir="ltr">UPDATE</code>, <code dir="ltr">DELETE</code>, <code dir="ltr">MERGE</code>, and <code dir="ltr">SELECT</code> ... <code dir="ltr">FOR</code> <code dir="ltr">UPDATE</code>. The row lock exists until the transaction commits or rolls back.</p>
<p>When a transaction obtains a row lock for a row, the transaction also acquires a table lock for the table in which the row resides. The table lock prevents conflicting DDL operations that would override data changes in a current transaction.</p>
<p><a id="SQLRF55504"></a><span class="subhead3">Table Locks (TM)&nbsp;</span><a id="sthref7600"></a><a id="sthref7601"></a>A transaction automatically acquires a table lock (<span class="bold">TM lock</span>) when a table is modified with the following statements: <code dir="ltr">INSERT</code>, <code dir="ltr">UPDATE</code>, <code dir="ltr">DELETE</code>, <code dir="ltr">MERGE</code>, and <code dir="ltr">SELECT</code> ... <code dir="ltr">FOR</code> <code dir="ltr">UPDATE</code>. These DML operations require table locks to reserve DML access to the table on behalf of a transaction and to prevent DDL operations that would conflict with the transaction. You can explicitly obtain a table lock using the <code dir="ltr">LOCK</code> <code dir="ltr">TABLE</code> statement, as described in <a href="ap_locks003.htm#CEGFGJAE">&#34;Manual Data Locking&#34;</a>.</p>
<p>A table lock can be held in any of the following modes:</p>
<ul>
<li>
<p>A <span class="bold">row share lock (RS)</span>, also called a <span class="bold">subshare table lock (SS)</span>, indicates that the transaction holding the lock on the table has locked rows in the table and intends to update them. An SS lock is the least restrictive mode of table lock, offering the highest degree of concurrency for a table.</p>
</li>
<li>
<p>A <span class="bold">row exclusive lock (RX)</span>, also called a <span class="bold">subexclusive table lock (SX)</span>, indicates that the transaction holding the lock has updated table rows or issued <code dir="ltr">SELECT</code> ... <code dir="ltr">FOR</code> <code dir="ltr">UPDATE</code>. An SX lock allows other transactions to query, insert, update, delete, or lock rows concurrently in the same table. Therefore, SX locks allow multiple transactions to obtain simultaneous SX and SS locks for the same table.</p>
</li>
<li>
<p>A <span class="bold">share table lock (S)</span> held by one transaction allows other transactions to query the table (without using <code dir="ltr">SELECT</code> ... <code dir="ltr">FOR</code> <code dir="ltr">UPDATE</code>) but allows updates only if a single transaction holds the share table lock. Multiple transactions may hold a share table lock concurrently, so holding this lock is not sufficient to ensure that a transaction can modify the table.</p>
</li>
<li>
<p>A <span class="bold">share row exclusive table lock (SRX)</span>, also called a <span class="bold">share-subexclusive table lock (SSX)</span>, is more restrictive than a share table lock. Only one transaction at a time can acquire an SSX lock on a given table. An SSX lock held by a transaction allows other transactions to query the table (except for <code dir="ltr">SELECT</code> ... <code dir="ltr">FOR</code> <code dir="ltr">UPDATE</code>) but not to update the table.</p>
</li>
<li>
<p>An <span class="bold">exclusive table lock (X)</span> is the most restrictive mode of table lock, allowing the transaction that holds the lock exclusive write access to the table. Only one transaction can obtain an X lock for a table.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="ap_locks003.htm#CEGFGJAE">&#34;Manual Data Locking&#34;</a></div>
<p class="subhead2"><a id="SQLRF55505"></a>Locks in DML Operations</p>
<p>Oracle Database automatically obtains row-level and table-level locks on behalf of DML operations. The type of operation determines the locking behavior. <a href="#BABCJIAJ">Table B-1</a> summarizes the information in this section.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The implicit SX locks shown for the DML statements in <a href="#BABCJIAJ">Table B-1</a> can sometimes be exclusive (X) locks for a short time owing to side effects from constraints.</div>
<div id="SQLRF55506" class="tblformal">
<p class="titleintable"><a id="sthref7602"></a><a id="BABCJIAJ"></a>Table B-1 Summary of Locks Obtained by DML Statements</p>
<table class="cellalignment5874" title="Summary of Locks Obtained by DML Statements " summary="Summary of Table Locks" dir="ltr">
<thead>
<tr class="cellalignment5863">
<th class="cellalignment5873" id="r1c1-t4">SQL Statement</th>
<th class="cellalignment5873" id="r1c2-t4">Row Locks</th>
<th class="cellalignment5873" id="r1c3-t4">Table Lock Mode</th>
<th class="cellalignment5873" id="r1c4-t4">RS</th>
<th class="cellalignment5873" id="r1c5-t4">RX</th>
<th class="cellalignment5873" id="r1c6-t4">S</th>
<th class="cellalignment5873" id="r1c7-t4">SRX</th>
<th class="cellalignment5873" id="r1c8-t4">X</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r2c1-t4" headers="r1c1-t4">
<p><code dir="ltr">SELECT</code> ... <code dir="ltr">FROM</code> <code dir="ltr"><span class="codeinlineitalic">table</span></code><code dir="ltr">...</code></p>
</td>
<td class="cellalignment5869" headers="r2c1-t4 r1c2-t4">
<p>&mdash;</p>
</td>
<td class="cellalignment5869" headers="r2c1-t4 r1c3-t4">
<p>none</p>
</td>
<td class="cellalignment5869" headers="r2c1-t4 r1c4-t4">
<p>Y</p>
</td>
<td class="cellalignment5869" headers="r2c1-t4 r1c5-t4">
<p>Y</p>
</td>
<td class="cellalignment5869" headers="r2c1-t4 r1c6-t4">
<p>Y</p>
</td>
<td class="cellalignment5869" headers="r2c1-t4 r1c7-t4">
<p>Y</p>
</td>
<td class="cellalignment5869" headers="r2c1-t4 r1c8-t4">
<p>Y</p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r3c1-t4" headers="r1c1-t4">
<p><code dir="ltr">INSERT</code> <code dir="ltr">INTO</code> <code dir="ltr"><span class="codeinlineitalic">table</span></code> ...</p>
</td>
<td class="cellalignment5869" headers="r3c1-t4 r1c2-t4">
<p>Yes</p>
</td>
<td class="cellalignment5869" headers="r3c1-t4 r1c3-t4">
<p>SX</p>
</td>
<td class="cellalignment5869" headers="r3c1-t4 r1c4-t4">
<p>Y</p>
</td>
<td class="cellalignment5869" headers="r3c1-t4 r1c5-t4">
<p>Y</p>
</td>
<td class="cellalignment5869" headers="r3c1-t4 r1c6-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r3c1-t4 r1c7-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r3c1-t4 r1c8-t4">
<p>N</p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r4c1-t4" headers="r1c1-t4">
<p><code dir="ltr">UPDATE</code> <code dir="ltr"><span class="codeinlineitalic">table</span></code> ...</p>
</td>
<td class="cellalignment5869" headers="r4c1-t4 r1c2-t4">
<p>Yes</p>
</td>
<td class="cellalignment5869" headers="r4c1-t4 r1c3-t4">
<p>SX</p>
</td>
<td class="cellalignment5869" headers="r4c1-t4 r1c4-t4">
<p>Y<a id="BABHAJFD" href="#BABHAJFD" onclick="footdisplay(1,&#34;Yes, if no conflicting row locks are held by another transaction. Otherwise, waits occur.&#34;)"><sup class="tablefootnote">Foot&nbsp;1&nbsp;</sup></a></p>
</td>
<td class="cellalignment5869" headers="r4c1-t4 r1c5-t4">
<p>Y<a id="sthref7603" href="#sthref7603" onclick="footdisplay(1,&#34;Yes, if no conflicting row locks are held by another transaction. Otherwise, waits occur.&#34;)"><sup class="footnotenumber">Footref&nbsp;1</sup></a></p>
</td>
<td class="cellalignment5869" headers="r4c1-t4 r1c6-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r4c1-t4 r1c7-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r4c1-t4 r1c8-t4">
<p>N</p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r5c1-t4" headers="r1c1-t4">
<p><code dir="ltr">MERGE</code> <code dir="ltr">INTO</code> <code dir="ltr"><span class="codeinlineitalic">table</span></code> ...</p>
</td>
<td class="cellalignment5869" headers="r5c1-t4 r1c2-t4">
<p>Yes</p>
</td>
<td class="cellalignment5869" headers="r5c1-t4 r1c3-t4">
<p>SX</p>
</td>
<td class="cellalignment5869" headers="r5c1-t4 r1c4-t4">
<p>Y</p>
</td>
<td class="cellalignment5869" headers="r5c1-t4 r1c5-t4">
<p>Y</p>
</td>
<td class="cellalignment5869" headers="r5c1-t4 r1c6-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r5c1-t4 r1c7-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r5c1-t4 r1c8-t4">
<p>N</p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r6c1-t4" headers="r1c1-t4">
<p><code dir="ltr">DELETE</code> <code dir="ltr">FROM</code> <code dir="ltr"><span class="codeinlineitalic">table</span></code> ...</p>
</td>
<td class="cellalignment5869" headers="r6c1-t4 r1c2-t4">
<p>Yes</p>
</td>
<td class="cellalignment5869" headers="r6c1-t4 r1c3-t4">
<p>SX</p>
</td>
<td class="cellalignment5869" headers="r6c1-t4 r1c4-t4">
<p>Y<a id="sthref7604" href="#sthref7604" onclick="footdisplay(1,&#34;Yes, if no conflicting row locks are held by another transaction. Otherwise, waits occur.&#34;)"><sup class="footnotenumber">Footref&nbsp;1</sup></a></p>
</td>
<td class="cellalignment5869" headers="r6c1-t4 r1c5-t4">
<p>Y<a id="sthref7605" href="#sthref7605" onclick="footdisplay(1,&#34;Yes, if no conflicting row locks are held by another transaction. Otherwise, waits occur.&#34;)"><sup class="footnotenumber">Footref&nbsp;1</sup></a></p>
</td>
<td class="cellalignment5869" headers="r6c1-t4 r1c6-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r6c1-t4 r1c7-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r6c1-t4 r1c8-t4">
<p>N</p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r7c1-t4" headers="r1c1-t4">
<p><code dir="ltr">SELECT</code> ... <code dir="ltr">FROM</code> <code dir="ltr"><span class="codeinlineitalic">table</span></code> <code dir="ltr">FOR</code> <code dir="ltr">UPDATE</code> <code dir="ltr">OF</code> ...</p>
</td>
<td class="cellalignment5869" headers="r7c1-t4 r1c2-t4">
<p>Yes</p>
</td>
<td class="cellalignment5869" headers="r7c1-t4 r1c3-t4">
<p>SX</p>
</td>
<td class="cellalignment5869" headers="r7c1-t4 r1c4-t4">
<p>Y<a id="sthref7606" href="#sthref7606" onclick="footdisplay(1,&#34;Yes, if no conflicting row locks are held by another transaction. Otherwise, waits occur.&#34;)"><sup class="footnotenumber">Footref&nbsp;1</sup></a></p>
</td>
<td class="cellalignment5869" headers="r7c1-t4 r1c5-t4">
<p>Y<a id="sthref7607" href="#sthref7607" onclick="footdisplay(1,&#34;Yes, if no conflicting row locks are held by another transaction. Otherwise, waits occur.&#34;)"><sup class="footnotenumber">Footref&nbsp;1</sup></a></p>
</td>
<td class="cellalignment5869" headers="r7c1-t4 r1c6-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r7c1-t4 r1c7-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r7c1-t4 r1c8-t4">
<p>N</p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r8c1-t4" headers="r1c1-t4">
<p><code dir="ltr">LOCK</code> <code dir="ltr">TABLE</code> <code dir="ltr"><span class="codeinlineitalic">table</span></code> <code dir="ltr">IN</code> ...</p>
</td>
<td class="cellalignment5869" headers="r8c1-t4 r1c2-t4">
<p>&mdash;</p>
</td>
<td class="cellalignment5869" headers="r8c1-t4 r1c3-t4">&nbsp;</td>
<td class="cellalignment5869" headers="r8c1-t4 r1c4-t4">&nbsp;</td>
<td class="cellalignment5869" headers="r8c1-t4 r1c5-t4">&nbsp;</td>
<td class="cellalignment5869" headers="r8c1-t4 r1c6-t4">&nbsp;</td>
<td class="cellalignment5869" headers="r8c1-t4 r1c7-t4">&nbsp;</td>
<td class="cellalignment5869" headers="r8c1-t4 r1c8-t4">&nbsp;</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r9c1-t4" headers="r1c1-t4">
<p>&nbsp;&nbsp;&nbsp;<code dir="ltr">ROW</code> <code dir="ltr">SHARE</code> <code dir="ltr">MODE</code></p>
</td>
<td class="cellalignment5869" headers="r9c1-t4 r1c2-t4">&nbsp;</td>
<td class="cellalignment5869" headers="r9c1-t4 r1c3-t4">
<p>SS</p>
</td>
<td class="cellalignment5869" headers="r9c1-t4 r1c4-t4">
<p>Y</p>
</td>
<td class="cellalignment5869" headers="r9c1-t4 r1c5-t4">
<p>Y</p>
</td>
<td class="cellalignment5869" headers="r9c1-t4 r1c6-t4">
<p>Y</p>
</td>
<td class="cellalignment5869" headers="r9c1-t4 r1c7-t4">
<p>Y</p>
</td>
<td class="cellalignment5869" headers="r9c1-t4 r1c8-t4">
<p>N</p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r10c1-t4" headers="r1c1-t4">
<p>&nbsp;&nbsp;&nbsp;<code dir="ltr">ROW</code> <code dir="ltr">EXCLUSIVE</code> <code dir="ltr">MODE</code></p>
</td>
<td class="cellalignment5869" headers="r10c1-t4 r1c2-t4">&nbsp;</td>
<td class="cellalignment5869" headers="r10c1-t4 r1c3-t4">
<p>SX</p>
</td>
<td class="cellalignment5869" headers="r10c1-t4 r1c4-t4">
<p>Y</p>
</td>
<td class="cellalignment5869" headers="r10c1-t4 r1c5-t4">
<p>Y</p>
</td>
<td class="cellalignment5869" headers="r10c1-t4 r1c6-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r10c1-t4 r1c7-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r10c1-t4 r1c8-t4">
<p>N</p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r11c1-t4" headers="r1c1-t4">
<p>&nbsp;&nbsp;&nbsp;<code dir="ltr">SHARE</code> <code dir="ltr">MODE</code></p>
</td>
<td class="cellalignment5869" headers="r11c1-t4 r1c2-t4">&nbsp;</td>
<td class="cellalignment5869" headers="r11c1-t4 r1c3-t4">
<p>S</p>
</td>
<td class="cellalignment5869" headers="r11c1-t4 r1c4-t4">
<p>Y</p>
</td>
<td class="cellalignment5869" headers="r11c1-t4 r1c5-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r11c1-t4 r1c6-t4">
<p>Y</p>
</td>
<td class="cellalignment5869" headers="r11c1-t4 r1c7-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r11c1-t4 r1c8-t4">
<p>N</p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r12c1-t4" headers="r1c1-t4">
<p>&nbsp;&nbsp;&nbsp;<code dir="ltr">SHARE</code> <code dir="ltr">ROW</code> <code dir="ltr">EXCLUSIVE</code> <code dir="ltr">MODE</code></p>
</td>
<td class="cellalignment5869" headers="r12c1-t4 r1c2-t4">&nbsp;</td>
<td class="cellalignment5869" headers="r12c1-t4 r1c3-t4">
<p>SSX</p>
</td>
<td class="cellalignment5869" headers="r12c1-t4 r1c4-t4">
<p>Y</p>
</td>
<td class="cellalignment5869" headers="r12c1-t4 r1c5-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r12c1-t4 r1c6-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r12c1-t4 r1c7-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r12c1-t4 r1c8-t4">
<p>N</p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r13c1-t4" headers="r1c1-t4">
<p>&nbsp;&nbsp;&nbsp;<code dir="ltr">EXCLUSIVE</code> <code dir="ltr">MODE</code></p>
</td>
<td class="cellalignment5869" headers="r13c1-t4 r1c2-t4">&nbsp;</td>
<td class="cellalignment5869" headers="r13c1-t4 r1c3-t4">
<p>X</p>
</td>
<td class="cellalignment5869" headers="r13c1-t4 r1c4-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r13c1-t4 r1c5-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r13c1-t4 r1c6-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r13c1-t4 r1c7-t4">
<p>N</p>
</td>
<td class="cellalignment5869" headers="r13c1-t4 r1c8-t4">
<p>N</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;1&nbsp;</sup>Yes, if no conflicting row locks are held by another transaction. Otherwise, waits occur.</p>
<p class="subhead2"><a id="SQLRF55507"></a>Locks When Rows Are Queried</p>
<p><a id="sthref7608"></a>A query can be explicit, as in the <code dir="ltr">SELECT</code> statement, or implicit, as in most <code dir="ltr">INSERT</code>, <code dir="ltr">MERGE</code>, <code dir="ltr">UPDATE</code>, and <code dir="ltr">DELETE</code> statements. The only DML statement that does not necessarily include a query component is an <code dir="ltr">INSERT</code> statement with a <code dir="ltr">VALUES</code> clause. Because queries only read data, they are the SQL statements least likely to interfere with other SQL statements.</p>
<p>The following characteristics apply to a query <span class="italic">without</span> the <code dir="ltr">FOR</code> <code dir="ltr">UPDATE</code> clause:</p>
<ul>
<li>
<p>The query acquires no data locks. Therefore, other transactions can query and update a table being queried, including the specific rows being queried. Because queries without the <code dir="ltr">FOR</code> <code dir="ltr">UPDATE</code> clause do not acquire any data locks to block other operations, such queries are often referred to as <span class="bold">nonblocking queries</span>.</p>
</li>
<li>
<p>The query does not have to wait for any data locks to be released. Therefore, the query can always proceed. An exception to this rule is that queries may have to wait for data locks in some very specific cases of pending distributed transactions.</p>
</li>
</ul>
<p class="subhead2"><a id="SQLRF55508"></a>Locks When Rows Are Modified</p>
<p>Some databases use a lock manager to maintain a list of locks in memory. Oracle Database, in contrast, stores lock information in the data block that contains the locked row. Each row lock affects only a single row.</p>
<p>Oracle Database uses a queuing mechanism for acquisition of row locks. If a transaction requires a row lock, and if the row is not already locked, then the transaction acquires a lock in the row&#39;s data block. The transaction itself has an entry in the <span class="bold">interested transaction list (ITL)</span> section of the block header. Each row modified by this transaction points to a copy of the transaction ID stored in the ITL. Thus, 100 rows in the same block modified by a single transaction require 100 row locks, but all 100 rows reference a single transaction ID.</p>
<p>When a transaction ends, the transaction ID remains in the ITL section of the data block header. If a new transaction wants to modify a row, then it uses the transaction ID to determine whether the lock is active. If the lock is active, then the session of the new transaction asks to be notified when the lock is released; otherwise, the new transaction acquires the lock.</p>
<p>The characteristics of <code dir="ltr">INSERT</code>, <code dir="ltr">UPDATE</code>, <code dir="ltr">DELETE</code>, and <code dir="ltr">SELECT</code> ... <code dir="ltr">FOR</code> <code dir="ltr">UPDATE</code> statements are as follows:</p>
<ul>
<li>
<p>A transaction containing a DML statement acquires exclusive row locks on the rows modified by the statement. Therefore, other transactions cannot update or delete the locked rows until the locking transaction either commits or rolls back.</p>
</li>
<li>
<p>In addition to these row locks, a transaction containing a DML statement that modifies data also requires at least a subexclusive table lock (SX) on the table that contains the affected rows. If the transaction already holds an S, SRX, or X table lock for the table, which are more restrictive than an SX lock, then the SX lock is not needed and is not acquired. If the containing transaction already holds only an SS lock, however, then Oracle Database automatically converts the SS lock to an SX lock.</p>
</li>
<li>
<p>A transaction that contains a DML statement does not require row locks on any rows selected by a subquery or an implicit query.</p>
<p>In the following sample <code dir="ltr">UPDATE</code> statement, the <code dir="ltr">SELECT</code> statement in parentheses is a subquery, whereas the <code dir="ltr">WHERE a &gt; 5</code> clause is an implicit query:</p>
<pre dir="ltr">UPDATE t SET x = ( SELECT y FROM t2 WHERE t2.z = t.z ) WHERE a &gt; 5;
</pre>
<p>A subquery or implicit query inside a DML statement is guaranteed to be consistent as of the start of the query and does not see the effects of the DML statement of which it forms a part.</p>
</li>
<li>
<p>A query in a transaction can see the changes made by previous DML statements in the same transaction, but not the uncommitted changes of other transactions.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink CNCPT1359" href="../CNCPT/consist.htm#CNCPT1359"><span class="italic">Oracle Database Concepts</span></a> for information on locks in foreign keys</div>
</div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5862">
<tr>
<td class="cellalignment5869">
<table class="cellalignment5867">
<tr>
<td class="cellalignment5866"><a href="ap_locks.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5866"><a href="ap_locks002.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2017,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5871">
<table class="cellalignment5865">
<tr>
<td class="cellalignment5866"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5866"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5866"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5866"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5866"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5866"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>


</body></html>