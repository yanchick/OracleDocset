<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-103627"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/CREATE%20AUDIT%20POLICY%20%28Unified%20Auditing%29"></a><title>CREATE AUDIT POLICY (Unified Auditing)</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1093"/>
<meta name="dcterms.created" content="2017-07-18T18:52:42Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database SQL Language Reference"/>
<meta name="dcterms.identifier" content="E41329-25"/>
<meta name="dcterms.isVersionOf" content="SQLRF"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2017,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="statements_5.htm" title="Previous" type="text/html"/>
<link rel="Next" href="statements_5002.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41329-25.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">416/555</span> <!-- End Header --><a id="BGEJHBAE"></a>
<div id="SQLRF56055" class="refsect1"><!-- infolevel="all" infotype="General" -->
<h1 class="refsect1">CREATE AUDIT POLICY (Unified Auditing)<a id="sthref4509"></a><a id="sthref4510"></a><a id="sthref4511"></a><a id="sthref4512"></a></h1>
<p>This section describes the <code dir="ltr">CREATE</code> <code dir="ltr">AUDIT</code> <code dir="ltr">POLICY</code> statement for <span class="bold">unified</span> <span class="bold">auditing</span>. This type of auditing is new beginning with Oracle Database 12<span class="italic">c</span> and provides a full set of enhanced auditing features. Refer to <a class="olink DBSEG630" href="../DBSEG/auditing.htm#DBSEG630"><span class="italic">Oracle Database Security Guide</span></a> for more information on unified auditing.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4513"></a>Purpose</p>
<p>Use the <code dir="ltr">CREATE</code> <code dir="ltr">AUDIT</code> <code dir="ltr">POLICY</code> statement to create a unified audit policy.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="statements_1004.htm#BGEJGHBH">ALTER AUDIT POLICY (Unified Auditing)</a></p>
</li>
<li>
<p><a href="statements_8007.htm#BABDFFIG">DROP AUDIT POLICY (Unified Auditing)</a></p>
</li>
<li>
<p><a href="statements_4008.htm#BABCABGI">AUDIT (Unified Auditing)</a></p>
</li>
<li>
<p><a href="statements_9019.htm#BGEEFAFE">NOAUDIT (Unified Auditing)</a></p>
</li>
</ul>
</div>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4514"></a>Prerequisites</p>
<p>You must have the <code dir="ltr">AUDIT</code> <code dir="ltr">SYSTEM</code> system privilege or the <code dir="ltr">AUDIT_ADMIN</code> role.</p>
<p>To specify the <code dir="ltr">CONTAINER</code> clause, you must be connected to a multitenant container database (CDB). To create a common unified audit policy, you must have the commonly granted <code dir="ltr">AUDIT</code> <code dir="ltr">SYSTEM</code> privilege or the <code dir="ltr">AUDIT_ADMIN</code> common role. To create a local unified audit policy, you must have the commonly granted <code dir="ltr">AUDIT</code> <code dir="ltr">SYSTEM</code> privilege or the <code dir="ltr">AUDIT_ADMIN</code> common role, or you must have the locally granted <code dir="ltr">AUDIT</code> <code dir="ltr">SYSTEM</code> privilege or the <code dir="ltr">AUDIT_ADMIN</code> local role in the container to which you are connected.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4515"></a>Syntax</p>
<p class="subhead2"><a id="SQLRF56056"></a><span class="italic">create_audit_policy</span>::=</p>
<img width="853" height="187" src="img/create_audit_policy.gif" alt="Description of create_audit_policy.gif follows"/><br/>
<a id="sthref4516" href="img_text/create_audit_policy.htm">Description of the illustration &#39;&#39;create_audit_policy.gif&#39;&#39;</a><br/>
<br/>
<div class="infobox-note">
<p class="notep1">Note:</p>
You must specify at least one of the clauses <code dir="ltr"><span class="codeinlineitalic">privilege_audit_clause</span></code>, <code dir="ltr"><span class="codeinlineitalic">action_audit_clause</span></code>, or <code dir="ltr"><span class="codeinlineitalic">role_audit_clause</span></code>.</div>
<p>(<a href="#BGEDDIIC"><span class="xreftitleitalic"><span class="italic"><span class="italic">privilege_audit_clause</span></span>::=</span></a>, <a href="#BGEFFEGE"><span class="xreftitleitalic"><span class="italic"><span class="italic">action_audit_clause</span></span>::=</span></a>, <a href="#BGEEIAEG"><span class="xreftitleitalic"><span class="italic"><span class="italic">role_audit_clause</span></span>::=</span></a>)</p>
<p class="subhead2"><a id="BGEDDIIC"></a><a id="SQLRF56057"></a><span class="italic"><a href="#BGECCGCH"><span class="xreftitleitalic"><span class="italic">privilege_audit_clause</span></span></a></span>::=</p>
<img width="254" height="58" src="img/privilege_audit_clause.gif" alt="Description of privilege_audit_clause.gif follows"/><br/>
<a id="sthref4517" href="img_text/privilege_audit_clause.htm">Description of the illustration &#39;&#39;privilege_audit_clause.gif&#39;&#39;</a><br/>
<br/>
<p class="subhead2"><a id="BGEFFEGE"></a><a id="SQLRF56058"></a><span class="italic"><a href="#BGEGECCJ"><span class="xreftitleitalic"><span class="italic">action_audit_clause</span></span></a></span>::=</p>
<img width="206" height="70" src="img/action_audit_clause.gif" alt="Description of action_audit_clause.gif follows"/><br/>
<a id="sthref4518" href="img_text/action_audit_clause.htm">Description of the illustration &#39;&#39;action_audit_clause.gif&#39;&#39;</a><br/>
<br/>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can specify only the <code dir="ltr"><span class="codeinlineitalic">standard_actions</span></code> clause, only the <code dir="ltr"><span class="codeinlineitalic">component_actions</span></code> clause, or both clauses in either order, but you can specify each clause at most once.</div>
<p class="subhead2"><a id="SQLRF56059"></a><span class="italic"><a href="#BGEIHFBI"><span class="xreftitleitalic"><span class="italic">standard_actions</span></span></a></span>::=</p>
<img width="723" height="227" src="img/standard_actions.gif" alt="Description of standard_actions.gif follows"/><br/>
<a id="sthref4519" href="img_text/standard_actions.htm">Description of the illustration &#39;&#39;standard_actions.gif&#39;&#39;</a><br/>
<br/>
<p class="subhead2"><a id="SQLRF56060"></a><span class="italic"><a href="#BGEFDDJB"><span class="xreftitleitalic"><span class="italic">component_actions</span></span></a></span>::=</p>
<img width="586" height="187" src="img/component_actions.gif" alt="Description of component_actions.gif follows"/><br/>
<a id="sthref4520" href="img_text/component_actions.htm">Description of the illustration &#39;&#39;component_actions.gif&#39;&#39;</a><br/>
<br/>
<p class="subhead2"><a id="BGEEIAEG"></a><a id="SQLRF56061"></a><span class="italic"><a href="#BGEDDDBI"><span class="xreftitleitalic"><span class="italic">role_audit_clause</span></span></a></span>::=</p>
<img width="159" height="58" src="img/role_audit_clause.gif" alt="Description of role_audit_clause.gif follows"/><br/>
<a id="sthref4521" href="img_text/role_audit_clause.htm">Description of the illustration &#39;&#39;role_audit_clause.gif&#39;&#39;</a><br/>
<br/></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4522"></a>Semantics</p>
<p class="subhead1"><a id="SQLRF56076"></a><span class="italic">policy</span></p>
<p>Specify the name of the unified audit policy to be created. The name must satisfy the requirements listed in <a href="sql_elements008.htm#i27570">&#34;Database Object Naming Rules&#34;</a>. You can find the names of all unified audit policies by querying the <code dir="ltr">AUDIT_UNIFIED_POLICIES</code> view.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink REFRN29157" href="../REFRN/GUID-D5F941B7-67B9-4936-8B00-8590FBBBF6DB.htm#REFRN29157"><span class="italic">Oracle Database Reference</span></a> for more information on the <code dir="ltr">AUDIT_UNIFIED_POLICIES</code> view</div>
<p class="subhead1"><a id="BGECCGCH"></a><a id="SQLRF56077"></a><span class="italic">privilege_audit_clause</span></p>
<p>Use this clause to audit one or more system privileges. SQL statements that require the system privilege(s) in order to succeed are audited. For <code dir="ltr"><span class="codeinlineitalic">system_privilege</span></code>, specify a valid system privilege. To view all valid system privileges, query the <code dir="ltr">NAME</code> column of the <code dir="ltr">SYSTEM_PRIVILEGE_MAP</code> view.</p>
<p><a id="SQLRF56353"></a><span class="subhead3">Restriction on Auditing System Privileges&nbsp;</span>You cannot audit the following system privileges: <code dir="ltr">INHERIT</code> <code dir="ltr">ANY</code> <code dir="ltr">PRIVILEGES</code>, <code dir="ltr">SYSASM</code>, <code dir="ltr">SYSBACKUP</code>, <code dir="ltr">SYSDBA</code>, <code dir="ltr">SYSDG</code>, <code dir="ltr">SYSKM</code>, <code dir="ltr">SYSOPER</code>, and <code dir="ltr">TRANSLATE</code> <code dir="ltr">ANY</code> <code dir="ltr">SQL</code>.</p>
<p class="subhead1"><a id="BGEGECCJ"></a><a id="SQLRF56078"></a><span class="italic">action_audit_clause</span></p>
<p>Use this clause to specify one or more actions to be audited. Use the <code dir="ltr"><span class="codeinlineitalic">standard_actions</span></code> clause to audit actions on standard RDBMS objects and to audit standard RDBMS system actions for the database. Use the <code dir="ltr"><span class="codeinlineitalic">component_actions</span></code> clause to audit actions for components.</p>
<p class="subhead2"><a id="BGEIHFBI"></a><a id="SQLRF56079"></a><span class="italic">standard_actions</span></p>
<p>Use this clause to audit actions on standard RDBMS objects and to audit standard RDBMS system actions for the database.</p>
<p><a id="SQLRF56354"></a><span class="subhead3"><span class="italic">object_action</span> ON&nbsp;</span>Use this clause to audit an action on the specified object. For <code dir="ltr"><span class="codeinlineitalic">object_action</span></code>, specify the action to be audited. <a href="#BGEGGCBI">Table 14-1</a> lists the actions that can be audited on each type of object.</p>
<p><a id="SQLRF56355"></a><span class="subhead3">ALL ON&nbsp;</span>Use this clause to audit all actions on the specified object. All of the actions listed in <a href="#BGEGGCBI">Table 14-1</a> for the type of object that you specify in the <code dir="ltr">ON</code> clause will be audited.</p>
<p><a id="SQLRF56356"></a><span class="subhead3">ON Clause&nbsp;</span>Use the <code dir="ltr">ON</code> clause to specify the object to be audited. Directories and data mining models are identified separately because they reside in separate namespaces. To audit actions on a directory, specify <code dir="ltr">ON</code> <code dir="ltr">DIRECTORY</code> <code dir="ltr"><span class="codeinlineitalic">directory_name</span></code>. To audit actions on a data mining model, specify <code dir="ltr">ON</code> <code dir="ltr">MINING</code> <code dir="ltr">MODEL</code> <code dir="ltr"><span class="codeinlineitalic">object_name</span></code>. To audit actions on the other types of objects listed in <a href="#BGEGGCBI">Table 14-1</a>, specify <code dir="ltr">ON</code> <code dir="ltr"><span class="codeinlineitalic">object_name</span></code>. If you do not qualify <code dir="ltr"><span class="codeinlineitalic">object_name</span></code> with <code dir="ltr"><span class="codeinlineitalic">schema</span></code>, then the database assumes the object is in your own schema.</p>
<div id="SQLRF56357" class="tblhruleformal">
<p class="titleintable"><a id="sthref4523"></a><a id="BGEGGCBI"></a>Table 14-1 Unified Auditing Objects and Actions</p>
<table class="cellalignment5872" title="Unified Auditing Objects and Actions" summary="Column 1 lists types of objects. Column 2 lists the valid actions for each type of object." dir="ltr">
<thead>
<tr class="cellalignment5863">
<th class="cellalignment5873" id="r1c1-t6">Type of Object</th>
<th class="cellalignment5873" id="r1c2-t6">Actions</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r2c1-t6" headers="r1c1-t6">
<p>Directory</p>
</td>
<td class="cellalignment5869" headers="r2c1-t6 r1c2-t6">
<p><code dir="ltr">AUDIT</code>, <code dir="ltr">GRANT</code>, <code dir="ltr">READ</code></p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r3c1-t6" headers="r1c1-t6">
<p>Function</p>
</td>
<td class="cellalignment5869" headers="r3c1-t6 r1c2-t6">
<p><code dir="ltr">AUDIT</code>, <code dir="ltr">EXECUTE</code> (Notes 1 and 2), <code dir="ltr">GRANT</code></p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r4c1-t6" headers="r1c1-t6">
<p>Java Schema Objects (Source, Class, Resource)</p>
</td>
<td class="cellalignment5869" headers="r4c1-t6 r1c2-t6">
<p><code dir="ltr">AUDIT</code>, <code dir="ltr">EXECUTE</code>, <code dir="ltr">GRANT</code></p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r5c1-t6" headers="r1c1-t6">
<p>Library</p>
</td>
<td class="cellalignment5869" headers="r5c1-t6 r1c2-t6">
<p><code dir="ltr">EXECUTE</code>, <code dir="ltr">GRANT</code></p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r6c1-t6" headers="r1c1-t6">
<p>Materialized Views</p>
</td>
<td class="cellalignment5869" headers="r6c1-t6 r1c2-t6">
<p><code dir="ltr">ALTER</code>, <code dir="ltr">AUDIT</code>, <code dir="ltr">COMMENT</code>, <code dir="ltr">DELETE</code>, <code dir="ltr">INDEX</code>, <code dir="ltr">INSERT</code>, <code dir="ltr">LOCK</code>, <code dir="ltr">SELECT</code>, <code dir="ltr">UPDATE</code></p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r7c1-t6" headers="r1c1-t6">
<p>Mining Model</p>
</td>
<td class="cellalignment5869" headers="r7c1-t6 r1c2-t6">
<p><code dir="ltr">AUDIT</code>, <code dir="ltr">COMMENT</code>, <code dir="ltr">GRANT</code>, <code dir="ltr">RENAME</code>, <code dir="ltr">SELECT</code></p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r8c1-t6" headers="r1c1-t6">
<p>Object Type</p>
</td>
<td class="cellalignment5869" headers="r8c1-t6 r1c2-t6">
<p><code dir="ltr">ALTER</code>, <code dir="ltr">AUDIT</code>, <code dir="ltr">GRANT</code></p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r9c1-t6" headers="r1c1-t6">
<p>Package</p>
</td>
<td class="cellalignment5869" headers="r9c1-t6 r1c2-t6">
<p><code dir="ltr">AUDIT</code>, <code dir="ltr">EXECUTE</code>, <code dir="ltr">GRANT</code></p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r10c1-t6" headers="r1c1-t6">
<p>Procedure</p>
</td>
<td class="cellalignment5869" headers="r10c1-t6 r1c2-t6">
<p><code dir="ltr">AUDIT</code>, <code dir="ltr">EXECUTE</code> (Notes 1 and 2), <code dir="ltr">GRANT</code></p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r11c1-t6" headers="r1c1-t6">
<p>Sequence</p>
</td>
<td class="cellalignment5869" headers="r11c1-t6 r1c2-t6">
<p><code dir="ltr">ALTER</code>, <code dir="ltr">AUDIT</code>, <code dir="ltr">GRANT</code>, <code dir="ltr">SELECT</code></p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r12c1-t6" headers="r1c1-t6">
<p>Table</p>
</td>
<td class="cellalignment5869" headers="r12c1-t6 r1c2-t6">
<p><code dir="ltr">ALTER</code>, <code dir="ltr">AUDIT</code>, <code dir="ltr">COMMENT</code>, <code dir="ltr">DELETE</code>, <code dir="ltr">FLASHBACK</code>, <code dir="ltr">GRANT</code>, <code dir="ltr">INDEX</code>, <code dir="ltr">INSERT</code>, <code dir="ltr">LOCK</code>, <code dir="ltr">RENAME</code>, <code dir="ltr">SELECT</code>, <code dir="ltr">UPDATE</code></p>
</td>
</tr>
<tr class="cellalignment5863">
<td class="cellalignment5869" id="r13c1-t6" headers="r1c1-t6">
<p>View</p>
</td>
<td class="cellalignment5869" headers="r13c1-t6 r1c2-t6">
<p><code dir="ltr">AUDIT</code>, <code dir="ltr">DELETE</code>, <code dir="ltr">FLASHBACK</code>, <code dir="ltr">GRANT</code>, <code dir="ltr">INSERT</code>, <code dir="ltr">LOCK</code>, <code dir="ltr">RENAME</code>, <code dir="ltr">SELECT</code>, <code dir="ltr">UPDATE</code></p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblhruleformal" -->
<p>Note 1: When you audit the <code dir="ltr">EXECUTE</code> operation on a PL/SQL stored procedure or stored function, the database considers only its ability to find the procedure or function and authorize its execution when determining the success or failure of the operation for the purposes of auditing. Therefore, if you specify the <code dir="ltr">WHENEVER</code> <code dir="ltr">NOT</code> <code dir="ltr">SUCCESSFUL</code> clause, then only invalid object errors, non-existent object errors, and authorization failures are audited; errors encountered during the execution of the procedure or function are not audited. If you specify the <code dir="ltr">WHENEVER</code> <code dir="ltr">SUCCESSFUL</code> clause, then all executions that are not blocked by invalid object errors, non-existent object errors, or authorization failures are audited, regardless of whether errors are encountered during execution.</p>
<p>Note 2: To audit the failure of a recursive SQL operation inside a PL/SQL stored procedure or stored function, configure auditing for the SQL operation.</p>
<p><a id="SQLRF56358"></a><span class="subhead3"><span class="italic">system_action</span>&nbsp;</span>Use this clause to audit a system action for the database. To view the valid values for <code dir="ltr"><span class="codeinlineitalic">system_action</span></code>, query the <code dir="ltr">NAME</code> column of the <code dir="ltr">AUDITABLE_SYSTEM_ACTIONS</code> view where <code dir="ltr">COMPONENT</code> is &#39;<code dir="ltr">Standard</code>&#39;.</p>
<p><a id="SQLRF56359"></a><span class="subhead3">ALL&nbsp;</span>Use this clause to audit all system actions for the database.</p>
<p class="subhead2"><a id="BGEFDDJB"></a><a id="SQLRF56081"></a><span class="italic">component_actions</span></p>
<p>Use this clause to audit actions for the following components: Oracle Data Pump, Oracle SQL*Loader Direct Path Load, Oracle Label Security, Oracle Database Real Application Security, and Oracle Database Vault.</p>
<p><a id="SQLRF56360"></a><span class="subhead3">DATAPUMP&nbsp;</span>Use this clause to audit actions for Oracle Data Pump. For <code dir="ltr"><span class="codeinlineitalic">component_action</span></code>, specify the action to be audited. To view the valid actions for Oracle Data Pump, query the <code dir="ltr">NAME</code> column of the <code dir="ltr">AUDITABLE_SYSTEM_ACTIONS</code> view where <code dir="ltr">COMPONENT</code> is <code dir="ltr">Datapump</code>. For example:</p>
<pre dir="ltr">SELECT name FROM auditable_system_actions WHERE component = &#39;Datapump&#39;;
</pre>
<p>Refer to <a class="olink DBSEG928" href="../DBSEG/audit_config.htm#DBSEG928"><span class="italic">Oracle Database Security Guide</span></a> for complete information on auditing Oracle Data Pump.</p>
<p><a id="SQLRF56361"></a><span class="subhead3">DIRECT_LOAD&nbsp;</span>Use this clause to audit actions for Oracle SQL*Loader Direct Path Load. For <code dir="ltr"><span class="codeinlineitalic">component_action</span></code>, specify the action to be audited. To view the valid actions for Oracle SQL*Loader Direct Path Load, query the <code dir="ltr">NAME</code> column of the <code dir="ltr">AUDITABLE_SYSTEM_ACTIONS</code> view where <code dir="ltr">COMPONENT</code> is <code dir="ltr">Direct</code> <code dir="ltr">path</code> <code dir="ltr">API</code>. For example:</p>
<pre dir="ltr">SELECT name FROM auditable_system_actions WHERE component = &#39;Direct path API&#39;;
</pre>
<p>Refer to <a class="olink DBSEG120" href="../DBSEG/audit_config.htm#DBSEG120"><span class="italic">Oracle Database Security Guide</span></a> for complete information on auditing Oracle SQL*Loader Direct Path Load.</p>
<p><a id="SQLRF56362"></a><span class="subhead3">OLS&nbsp;</span>Use this clause to audit actions for Oracle Label Security. For <code dir="ltr"><span class="codeinlineitalic">component_action</span></code>, specify the action to be audited. To view the valid actions for Oracle Label Security, query the <code dir="ltr">NAME</code> column of the <code dir="ltr">AUDITABLE_SYSTEM_ACTIONS</code> view where <code dir="ltr">COMPONENT</code> is <code dir="ltr">Label</code> <code dir="ltr">Security</code>. For example:</p>
<pre dir="ltr">SELECT name FROM auditable_system_actions WHERE component = &#39;Label Security&#39;;
</pre>
<p>Refer to <a class="olink DBSEG454" href="../DBSEG/audit_config.htm#DBSEG454"><span class="italic">Oracle Database Security Guide</span></a> for complete information on auditing Oracle Label Security.</p>
<p><a id="SQLRF56363"></a><span class="subhead3">XS&nbsp;</span>Use this clause to audit actions for Oracle Database Real Application Security. For <code dir="ltr"><span class="codeinlineitalic">component_action</span></code>, specify the action to be audited. To view the valid actions for Oracle Database Real Application Security, query the <code dir="ltr">NAME</code> column of the <code dir="ltr">AUDITABLE_SYSTEM_ACTIONS</code> view where <code dir="ltr">COMPONENT</code> is <code dir="ltr">XS</code>. For example:</p>
<pre dir="ltr">SELECT name FROM auditable_system_actions WHERE component = &#39;XS&#39;;
</pre>
<p>Refer to <a class="olink DBSEG367" href="../DBSEG/audit_config.htm#DBSEG367"><span class="italic">Oracle Database Security Guide</span></a> for complete information on auditing Oracle Database Real Application Security.</p>
<p><a id="SQLRF56364"></a><span class="subhead3">DV&nbsp;</span>Use this clause to audit actions for Oracle Database Vault. For <code dir="ltr"><span class="codeinlineitalic">component_action</span></code>, specify the action to be audited. To view the valid actions for Oracle Database Vault, query the <code dir="ltr">NAME</code> column of the <code dir="ltr">AUDITABLE_SYSTEM_ACTIONS</code> view where <code dir="ltr">COMPONENT</code> is <code dir="ltr">Database</code> <code dir="ltr">Vault</code>. For example:</p>
<pre dir="ltr">SELECT name FROM auditable_system_actions WHERE component = &#39;Database Vault&#39;;
</pre>
<p>For <code dir="ltr"><span class="codeinlineitalic">object_name</span></code>, specify the name of the Database Vault object to be audited.</p>
<p>Refer to <a class="olink DBSEG419" href="../DBSEG/audit_config.htm#DBSEG419"><span class="italic">Oracle Database Security Guide</span></a> for complete information on auditing Oracle Database Vault.</p>
<p class="subhead1"><a id="BGEDDDBI"></a><a id="SQLRF56083"></a><span class="italic">role_audit_clause</span></p>
<p>Use this clause to specify one or more roles to be audited. When you audit a role, Oracle Database audits all system privileges that are granted directly to the role. SQL statements that require the system privileges in order to succeed are audited. For <code dir="ltr"><span class="codeinlineitalic">role</span></code>, specify either a user-defined (local or external) or predefined role. For a list of predefined roles, refer to <a class="olink DBSEG4414" href="../DBSEG/authorization.htm#DBSEG4414"><span class="italic">Oracle Database Security Guide</span></a>.</p>
<p class="subhead1"><a id="SQLRF56084"></a>WHEN Clause</p>
<p>Use this clause to control when the unified audit policy is enforced.</p>
<p><a id="BGEBAIJA"></a><a id="SQLRF56085"></a><span class="subhead3"><span class="italic">audit_condition</span>&nbsp;</span>Specify a condition that determines if the unified audit policy is enforced. If <code dir="ltr"><span class="codeinlineitalic">audit_condition</span></code> evaluates to <code dir="ltr">TRUE</code>, then the policy is enforced. If <code dir="ltr">FALSE</code>, then the policy is not enforced.</p>
<p>The <code dir="ltr"><span class="codeinlineitalic">audit_condition</span></code> can have a maximum length of 4000 characters. It can contain expressions, as well as the following functions and conditions:</p>
<ul>
<li>
<p>Numeric functions: <code dir="ltr">BITAND</code>, <code dir="ltr">CEIL</code>, <code dir="ltr">FLOOR</code>, <code dir="ltr">POWER</code></p>
</li>
<li>
<p>Character functions returning character values: <code dir="ltr">CONCAT</code>, <code dir="ltr">LOWER</code>, <code dir="ltr">UPPER</code></p>
</li>
<li>
<p>Character functions returning number values: <code dir="ltr">INSTR</code>, <code dir="ltr">LENGTH</code></p>
</li>
<li>
<p>Environment and identifier functions: <code dir="ltr">SYS_CONTEXT</code>, <code dir="ltr">UID</code></p>
</li>
<li>
<p>Comparison conditions: <code dir="ltr">=</code>, <code dir="ltr">!=</code>, <code dir="ltr">&lt;&gt;</code>, <code dir="ltr">&lt;</code>, <code dir="ltr">&gt;</code>, <code dir="ltr">&lt;=</code>, <code dir="ltr">&gt;=</code></p>
</li>
<li>
<p>Logical conditions: <code dir="ltr">AND</code>, <code dir="ltr">OR</code></p>
</li>
<li>
<p>Null conditions: <code dir="ltr">IS</code> <code dir="ltr">[NOT]</code> <code dir="ltr">NULL</code></p>
</li>
<li>
<p><code dir="ltr">[NOT]</code> <code dir="ltr">BETWEEN</code> condition</p>
</li>
<li>
<p><code dir="ltr">[NOT]</code> <code dir="ltr">IN</code> condition</p>
</li>
</ul>
<p>The <code dir="ltr"><span class="codeinlineitalic">audit_condition</span></code> must be enclosed in single quotation marks. If the <code dir="ltr"><span class="codeinlineitalic">audit_condition</span></code> contains a single quotation mark, then specify two single quotation marks instead. For example, to specify the following condition:</p>
<pre dir="ltr">SYS_CONTEXT(&#39;USERENV&#39;, &#39;CLIENT_IDENTIFIER&#39;) = &#39;myclient&#39;
</pre>
<p>Specify the following for <code dir="ltr">&#39;</code><code dir="ltr"><span class="codeinlineitalic">audit_condition</span></code><code dir="ltr">&#39;</code>:</p>
<pre dir="ltr">&#39;SYS_CONTEXT(&#39;&#39;USERENV&#39;&#39;, &#39;&#39;CLIENT_IDENTIFIER&#39;&#39;) = &#39;&#39;myclient&#39;&#39;&#39;
</pre>
<p><a id="BGEJBBDB"></a><a id="SQLRF56231"></a><span class="subhead3">EVALUATE PER STATEMENT&nbsp;</span>Specify this clause to evaluate the <code dir="ltr"><span class="codeinlineitalic">audit_condition</span></code> for each auditable statement. If the <code dir="ltr"><span class="codeinlineitalic">audit_condition</span></code> evaluates to <code dir="ltr">TRUE</code>, then the unified audit policy is enforced for the statement. If <code dir="ltr">FALSE</code>, then the unified audit policy is not enforced for the statement.</p>
<p><a id="BGECIFGJ"></a><a id="SQLRF56232"></a><span class="subhead3">EVALUATE PER SESSION&nbsp;</span>Specify this clause to evaluate the <code dir="ltr"><span class="codeinlineitalic">audit_condition</span></code> once during the session. The <code dir="ltr"><span class="codeinlineitalic">audit_condition</span></code> is evaluated for the first auditable statement that is executed during the session. If the <code dir="ltr"><span class="codeinlineitalic">audit_condition</span></code> evaluates to <code dir="ltr">TRUE</code>, then the unified audit policy is enforced for all applicable statements for the rest of the session. If <code dir="ltr">FALSE</code>, then the unified audit policy is not enforced for all applicable statements for the rest of the session.</p>
<p><a id="BGEJIBAE"></a><a id="SQLRF56233"></a><span class="subhead3">EVALUATE PER INSTANCE&nbsp;</span>Specify this clause to evaluate the <code dir="ltr"><span class="codeinlineitalic">audit_condition</span></code> once during the lifetime of the instance. The <code dir="ltr"><span class="codeinlineitalic">audit_condition</span></code> is evaluated for the first auditable statement that is executed during the instance lifetime. If the <code dir="ltr"><span class="codeinlineitalic">audit_condition</span></code> evaluates to <code dir="ltr">TRUE</code>, then the unified audit policy is enforced for all applicable statements for the rest of the lifetime of the instance. If <code dir="ltr">FALSE</code>, then the unified audit policy is not enforced for all applicable statements for the rest of the lifetime of the instance.</p>
<p class="subhead1"><a id="SQLRF56086"></a>CONTAINER Clause</p>
<p>Use the <code dir="ltr">CONTAINER</code> clause to specify the scope of the unified audit policy.</p>
<ul>
<li>
<p>Specify <code dir="ltr">CONTAINER</code> <code dir="ltr">=</code> <code dir="ltr">ALL</code> to create a <span class="bold">common</span> <span class="bold">unified</span> <span class="bold">audit</span> <span class="bold">policy</span>. This type of policy is available to all pluggable databases (PDBs) in the CDB. The current container must be the root. If you specify the <code dir="ltr">ACTIONS</code> <code dir="ltr"><span class="codeinlineitalic">object_action</span></code> <code dir="ltr">ON</code> or <code dir="ltr">ACTIONS</code> <code dir="ltr">ALL</code> <code dir="ltr">ON</code> clause, then you must specify a common object.</p>
</li>
<li>
<p>Specify <code dir="ltr">CONTAINER</code> <code dir="ltr">=</code> <code dir="ltr">CURRENT</code> to create a <span class="bold">local</span> <span class="bold">unified</span> <span class="bold">audit</span> <span class="bold">policy</span> in the current container. The current container can be the root or a PDB. If the current container is the root, then you cannot specify the clauses <code dir="ltr">ACTIONS</code> <code dir="ltr"><span class="codeinlineitalic">system_action</span></code>, <code dir="ltr">ACTIONS</code> <code dir="ltr">ALL</code>, or <code dir="ltr"><span class="codeinlineitalic">privilege_audit_clause</span></code>.</p>
</li>
</ul>
<p>If you omit the <code dir="ltr">CONTAINER</code> clause and the current container is the root, then <code dir="ltr">CONTAINER</code> <code dir="ltr">=</code> <code dir="ltr">ALL</code> is the default. If you omit the <code dir="ltr">CONTAINER</code> clause and the current container is a pluggable database (PDB), then <code dir="ltr">CONTAINER</code> <code dir="ltr">=</code> <code dir="ltr">CURRENT</code> is the default.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
You cannot alter the scope of a unified audit policy after it has been created.</div>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="BGEGDCFA"></a>Examples</p>
<p><a id="SQLRF56365"></a><span class="subhead3">Auditing System Privileges: Example&nbsp;</span>The following statement creates unified audit policy <code dir="ltr">table_pol</code>, which audits the system privileges <code dir="ltr">CREATE</code> <code dir="ltr">ANY</code> <code dir="ltr">TABLE</code> and <code dir="ltr">DROP</code> <code dir="ltr">ANY</code> <code dir="ltr">TABLE</code>:</p>
<pre dir="ltr">CREATE AUDIT POLICY table_pol
  PRIVILEGES CREATE ANY TABLE, DROP ANY TABLE;
</pre>
<p>The following statement verifies that <code dir="ltr">table_pol</code> now appears in the <code dir="ltr">AUDIT_UNIFIED_POLICIES</code> view:</p>
<pre dir="ltr">SELECT *
  FROM audit_unified_policies
  WHERE policy_name = &#39;TABLE_POL&#39;;
</pre>
<p><a id="SQLRF56366"></a><span class="subhead3">Auditing Actions on Objects: Examples&nbsp;</span>The following statement creates unified audit policy <code dir="ltr">dml_pol</code>, which audits <code dir="ltr">DELETE</code>, <code dir="ltr">INSERT</code>, and <code dir="ltr">UPDATE</code> actions on table <code dir="ltr">hr</code>.<code dir="ltr">employees</code>, and all auditable actions on table <code dir="ltr">hr</code>.<code dir="ltr">departments</code>:</p>
<pre dir="ltr">CREATE AUDIT POLICY dml_pol
  ACTIONS DELETE on hr.employees,
          INSERT on hr.employees,
          UPDATE on hr.employees,
          ALL on hr.departments;
</pre>
<p>The following statement creates unified audit policy <code dir="ltr">read_dir_pol</code>, which audits <code dir="ltr">READ</code> actions on directory <code dir="ltr">bfile_dir</code> (created in <a href="statements_5008.htm#i2092417">&#34;Creating a Directory: Examples&#34;</a>):</p>
<pre dir="ltr">CREATE AUDIT POLICY read_dir_pol
  ACTIONS READ ON DIRECTORY bfile_dir;
</pre>
<p><a id="SQLRF56367"></a><span class="subhead3">Auditing System Actions: Examples&nbsp;</span>The following query displays the standard RDBMS system actions that can be audited for the database:</p>
<pre dir="ltr">SELECT name FROM auditable_system_actions
  WHERE component = &#39;Standard&#39;
  ORDER BY name;

NAME
----
ADMINISTER KEY MANAGEMENT
ALL
ALTER ASSEMBLY
ALTER AUDIT POLICY
ALTER CLUSTER
...
</pre>
<p>The following statement creates unified audit policy <code dir="ltr">security_pol</code>, which audits the system action <code dir="ltr">ADMINISTER</code> <code dir="ltr">KEY</code> <code dir="ltr">MANAGEMENT</code>:</p>
<pre dir="ltr">CREATE AUDIT POLICY security_pol
  ACTIONS ADMINISTER KEY MANAGEMENT;
</pre>
<p>The following statement creates unified audit policy <code dir="ltr">all_actions_pol</code>, which audits all standard RDBMS system actions for the database:</p>
<pre dir="ltr">CREATE AUDIT POLICY all_actions_pol
  ACTIONS ALL;
</pre>
<p><a id="SQLRF56368"></a><span class="subhead3">Auditing Component Actions: Example&nbsp;</span>The following query displays the actions that can be audited for Oracle Data Pump:</p>
<pre dir="ltr">SELECT name FROM auditable_system_actions
  WHERE component = &#39;Datapump&#39;;

NAME
----
EXPORT
IMPORT
ALL
</pre>
<p>The following statement creates unified audit policy <code dir="ltr">dp_actions_pol</code>, which audits <code dir="ltr">IMPORT</code> actions for Oracle Data Pump:</p>
<pre dir="ltr">CREATE AUDIT POLICY dp_actions_pol
  ACTIONS COMPONENT = datapump IMPORT;
</pre>
<p><a id="SQLRF56369"></a><span class="subhead3">Auditing Roles: Example&nbsp;</span>The following statement creates unified audit policy <code dir="ltr">java_pol</code>, which audits the predefined roles <code dir="ltr">java_admin</code> and <code dir="ltr">java_deploy</code>:</p>
<pre dir="ltr">CREATE AUDIT POLICY java_pol
  ROLES java_admin, java_deploy;
</pre>
<p><a id="SQLRF56370"></a><span class="subhead3">Auditing System Privileges, Actions, and Roles: Example&nbsp;</span>The following statement creates unified audit policy <code dir="ltr">hr_admin_pol</code>, which audits multiple system privileges, actions, and roles:</p>
<pre dir="ltr">CREATE AUDIT POLICY hr_admin_pol
  PRIVILEGES CREATE ANY TABLE, DROP ANY TABLE
  ACTIONS DELETE on hr.employees,
          INSERT on hr.employees,
          UPDATE on hr.employees,
          ALL on hr.departments,
          LOCK TABLE
  ROLES audit_admin, audit_viewer;
</pre>
<p><a id="SQLRF56371"></a><span class="subhead3">Controlling When a Unified Audit Policy is Enforced: Examples&nbsp;</span>The following statement creates unified audit policy <code dir="ltr">order_updates_pol</code>, which audits <code dir="ltr">UPDATE</code> actions on table <code dir="ltr">oe</code>.<code dir="ltr">orders</code>. This policy is enforced only when the auditable statement is issued by an external user. The audit condition is checked once per session.</p>
<pre dir="ltr">CREATE AUDIT POLICY order_updates_pol
  ACTIONS UPDATE ON oe.orders
  WHEN &#39;SYS_CONTEXT(&#39;&#39;USERENV&#39;&#39;, &#39;&#39;IDENTIFICATION_TYPE&#39;&#39;) = &#39;&#39;EXTERNAL&#39;&#39;&#39;
  EVALUATE PER SESSION;
</pre>
<p>The following statement creates unified audit policy <code dir="ltr">emp_updates_pol</code>, which audits <code dir="ltr">DELETE</code>, <code dir="ltr">INSERT</code>, and <code dir="ltr">UPDATE</code> actions on table <code dir="ltr">hr</code>.<code dir="ltr">employees</code>. This policy is enforced only when the auditable statement is issued by a user who does not have a UID of 100, 105, or 107. The audit condition is checked for each auditable statement.</p>
<pre dir="ltr">CREATE AUDIT POLICY emp_updates_pol
  ACTIONS DELETE on hr.employees,
          INSERT on hr.employees,
          UPDATE on hr.employees
  WHEN &#39;UID NOT IN (100, 105, 107)&#39;
  EVALUATE PER STATEMENT;
</pre>
<p><a id="SQLRF56372"></a><span class="subhead3">Creating a Local Unified Audit Policy: Example&nbsp;</span>The following statement creates local unified audit policy <code dir="ltr">local_table_pol</code>, which audits the system privileges <code dir="ltr">CREATE</code> <code dir="ltr">ANY</code> <code dir="ltr">TABLE</code> and <code dir="ltr">DROP</code> <code dir="ltr">ANY</code> <code dir="ltr">TABLE</code> in the current container::</p>
<pre dir="ltr">CREATE AUDIT POLICY local_table_pol
  PRIVILEGES CREATE ANY TABLE, DROP ANY TABLE
  CONTAINER = CURRENT;
</pre>
<p><a id="SQLRF56373"></a><span class="subhead3">Creating a Common Unified Audit Policy: Example&nbsp;</span>The following statement creates common unified audit policy <code dir="ltr">common_role1_pol</code>, which audits the common role <code dir="ltr">c##role1</code> (created in <code dir="ltr">CREATE</code> <code dir="ltr">ROLE</code> <a href="statements_6014.htm#i2066883">&#34;Examples&#34;</a>) across the entire CDB:</p>
<pre dir="ltr">CREATE AUDIT POLICY common_role1_pol
  ROLES c##role1
  CONTAINER = ALL;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5862">
<tr>
<td class="cellalignment5869">
<table class="cellalignment5867">
<tr>
<td class="cellalignment5866"><a href="statements_5.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5866"><a href="statements_5002.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2017,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5871">
<table class="cellalignment5865">
<tr>
<td class="cellalignment5866"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5866"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5866"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5866"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5866"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5866"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>