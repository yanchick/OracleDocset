<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-4649"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/An%20Example%20Policy%20Set%20Configuration"></a><title>An Example Policy Set Configuration</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="dcterms.created" content="2017-07-14T14:47:18Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Clusterware Administration and Deployment Guide"/>
<meta name="dcterms.identifier" content="E48819-11"/>
<meta name="dcterms.isVersionOf" content="CWADD"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2007, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="GUID-C12500DD-8097-41C7-93E3-089A49CBE7F6.htm" title="Previous" type="text/html"/>
<link rel="Next" href="GUID-DF441DD8-B3B4-48C2-96B5-3DD59EAAC8EF.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E48819-11.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-B5EA4AB9-D9B6-4D8C-BCEF-1551607B2EA9"></a> <span id="PAGE" style="display:none;">101/713</span> <!-- End Header -->
<a id="CWADD92889"></a><a id="CWADD92890"></a><a id="CWADD92640"></a>
<h1 id="CWADD-GUID-B5EA4AB9-D9B6-4D8C-BCEF-1551607B2EA9" class="sect1">An Example Policy Set Configuration</h1>
<div>
<div class="section">
<p>Assume that you have a four-node cluster that is used by three different applications, <span class="italic">app1</span>, <span class="italic">app2</span>, and <span class="italic">app3</span>, and that you have created three server pools, <span class="italic">pool1</span>, <span class="italic">pool2</span>, and <span class="italic">pool3</span>. You configure the server pools such that each application is assigned to run in its own server pool, and that <span class="italic">app1</span> wants to have two servers, and <span class="italic">app2</span> and <span class="italic">app3</span> each want one server. The server pool configurations are as follows:</p>
<pre dir="ltr"><span class="bold">$ crsctl status serverpool pool1 -p</span>
NAME=pool1
IMPORTANCE=0
MIN_SIZE=2
MAX_SIZE=2
SERVER_NAMES=
PARENT_POOLS=
EXCLUSIVE_POOLS=
ACL=owner:mjk:rwx,pgrp:g900:rwx,other::r--
SERVER_CATEGORY=

<span class="bold">$ crsctl status serverpool pool2 -p</span>
NAME=pool2
IMPORTANCE=0
MIN_SIZE=1
MAX_SIZE=1
SERVER_NAMES=
PARENT_POOLS=
EXCLUSIVE_POOLS=
ACL=owner:mjk:rwx,pgrp:g900:rwx,other::r--
SERVER_CATEGORY=

<span class="bold">$ crsctl status serverpool pool3 -p</span>
NAME=pool3
IMPORTANCE=0
MIN_SIZE=1
MAX_SIZE=1
SERVER_NAMES=
PARENT_POOLS=
EXCLUSIVE_POOLS=
ACL=owner:mjk:rwx,pgrp:g900:rwx,other::r--
SERVER_CATEGORY=
</pre>
<div class="infobox-note" id="GUID-B5EA4AB9-D9B6-4D8C-BCEF-1551607B2EA9__GUID-966969B0-56AF-4B70-878F-943D7D1955AC">
<p class="notep1">Note:</p>
<p>The <code class="codeph">crsctl status serverpool</code> command shown in the preceding examples only functions if you created the server pools using CRSCTL.</p>
</div>
<p>This configuration, however, does not consider the fact that some applications need server time at different times of the day, week, or month. Email applications, for example, typically use more resources during business hours and use less resources at night and on weekends.</p>
<p>Further assume that <span class="italic">app1</span> requires two servers during business hours, but only requires one server at night and does not require any servers on weekends. At the same time, <span class="italic">app2</span> and <span class="italic">app3</span> each require one server during business hours, while at night, <span class="italic">app2</span> requires two servers and <span class="italic">app3</span> requires one. On the weekend, <span class="italic">app2</span> requires one server and <span class="italic">app3</span> requires three. This scenario suggests three configurations that you must configure for the cluster:</p>
<ol>
<li>
<p><span class="bold">Day Time</span>:</p>
<ul class="simple" style="list-style-type: none;padding-left:0;">
<li><span class="italic">app1</span> uses two servers</li>
<li><span class="italic">app2</span> and <span class="italic">app3</span> use one server, each</li>
</ul>
</li>
<li>
<p><span class="bold">Night Time</span>:</p>
<ul class="simple" style="list-style-type: none;padding-left:0;">
<li><span class="italic">app1</span> uses one server</li>
<li><span class="italic">app2</span> uses two servers</li>
<li><span class="italic">app3</span> uses one server</li>
</ul>
</li>
<li>
<p><span class="bold">Weekend</span>:</p>
<ul class="simple" style="list-style-type: none;padding-left:0;">
<li><span class="italic">app1</span> is not running (0 servers)</li>
<li><span class="italic">app2</span> uses one server</li>
<li><span class="italic">app3</span> uses three servers</li>
</ul>
</li>
</ol>
<p><span class="bold">Policy Set Creation</span></p>
<p>Given these assumptions, run the <code class="codeph">crsctl create policyset</code> command to create a policy set with a single policy named <code class="codeph">Default</code>, which reflects the configuration displayed by the <code class="codeph">crsctl status serverpool</code> command. You can use the <code class="codeph">Default</code> policy to create other policies to meet the needs assumed in this example. The <code class="codeph">crsctl create policyset</code> command creates a text file similar to <a href="GUID-B5EA4AB9-D9B6-4D8C-BCEF-1551607B2EA9.htm#GUID-B5EA4AB9-D9B6-4D8C-BCEF-1551607B2EA9__BHCHBAHI">Example 3-1</a>.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-B5EA4AB9-D9B6-4D8C-BCEF-1551607B2EA9__BHCHBAHI">
<p class="titleinexample">Example 3-1 Policy Set Text File</p>
<pre dir="ltr">SERVER_POOL_NAMES=Free pool1 pool2 pool3
POLICY
  NAME=Default
  SERVERPOOL
    NAME=pool1
    IMPORTANCE=0
    MAX_SIZE=2
    MIN_SIZE=2
    SERVER_CATEGORY=
  SERVERPOOL
    NAME=pool2
    IMPORTANCE=0
    MAX_SIZE=1
    MIN_SIZE=1
    SERVER_CATEGORY=
  SERVERPOOL
    NAME=pool3
    IMPORTANCE=0
    MAX_SIZE=1
    MIN_SIZE=1
    SERVER_CATEGORY=
</pre></div>
<!-- class="example" -->
<div class="section">
<p><span class="bold">Policy Modification</span></p>
<p>To modify the preceding policy set to meet the needs assumed in this example, edit the text file to define policies for the three scenarios discussed previously, by changing the name of the policy from <code class="codeph">Default</code> to <code class="codeph">DayTime</code>. Then, copy the policy and paste it twice to form two subsequent policies, which you name <code class="codeph">NightTime</code> and <code class="codeph">Weekend</code>, as shown in <a href="GUID-B5EA4AB9-D9B6-4D8C-BCEF-1551607B2EA9.htm#GUID-B5EA4AB9-D9B6-4D8C-BCEF-1551607B2EA9__BHCJHGCG">Example 3-2</a>.</p>
</div>
<!-- class="section" -->
<div class="example" id="GUID-B5EA4AB9-D9B6-4D8C-BCEF-1551607B2EA9__BHCJHGCG">
<p class="titleinexample">Example 3-2 Modified Policy Set Text File</p>
<pre dir="ltr">SERVER_POOL_NAMES=Free pool1 pool2 pool3
POLICY
  NAME=<span class="bold">DayTime</span>
  SERVERPOOL
    NAME=pool1
    IMPORTANCE=0
    <span class="bold">MAX_SIZE=2</span>
    <span class="bold">MIN_SIZE=2</span>
    SERVER_CATEGORY=
  SERVERPOOL
    NAME=pool2
    IMPORTANCE=0
    <span class="bold">MAX_SIZE=1</span>
    <span class="bold">MIN_SIZE=1</span>
    SERVER_CATEGORY=
  SERVERPOOL
    NAME=pool3
    IMPORTANCE=0
    <span class="bold">MAX_SIZE=1</span>
    <span class="bold">MIN_SIZE=1</span>
    SERVER_CATEGORY=
POLICY
  NAME=<span class="bold">NightTime</span>
  SERVERPOOL
    NAME=pool1
    IMPORTANCE=0
    <span class="bold">MAX_SIZE=1</span>
    <span class="bold">MIN_SIZE=1</span>
    SERVER_CATEGORY=
  SERVERPOOL
    NAME=pool2
    IMPORTANCE=0
    <span class="bold">MAX_SIZE=2</span>
    <span class="bold">MIN_SIZE=2</span>
    SERVER_CATEGORY=
  SERVERPOOL
    NAME=pool3
    IMPORTANCE=0
    <span class="bold">MAX_SIZE=1</span>
    <span class="bold">MIN_SIZE=1</span>
    SERVER_CATEGORY=
POLICY
  NAME=<span class="bold">Weekend</span>
  SERVERPOOL
    NAME=pool1
    IMPORTANCE=0
    <span class="bold">MAX_SIZE=0</span>
    <span class="bold">MIN_SIZE=0</span>
    SERVER_CATEGORY=
  SERVERPOOL
    NAME=pool2
    IMPORTANCE=0
    <span class="bold">MAX_SIZE=1</span>
    <span class="bold">MIN_SIZE=1</span>
    SERVER_CATEGORY=
  SERVERPOOL
    NAME=pool3
    IMPORTANCE=0
    <span class="bold">MAX_SIZE=3</span>
    <span class="bold">MIN_SIZE=3</span>
    SERVER_CATEGORY=
</pre></div>
<!-- class="example" -->
<div class="section">
<p>Notice that, in addition to changing the names of the individual policies, the <code class="codeph">MAX_SIZE</code> and <code class="codeph">MIN_SIZE</code> policy attributes for each of the server pools in each of the policies were also modified according to the needs of the applications.</p>
<p>The following command registers the policy set stored in a file with Oracle Clusterware:</p>
<pre dir="ltr">$ crsctl modify policyset -file <span class="italic">file_name</span>
</pre>
<p>You can achieve the same results as shown in the previous examples by editing the <code class="codeph">Default</code> policy set, as a whole, using the <code class="codeph">crsctl modify policyset</code> command, and by using the <code class="codeph">crsctl modify serverpool</code> command to change individual server pool attributes for a specific policy.</p>
<p>The following command modifies the <code class="codeph">Default</code> policy set to manage the three server pools:</p>
<pre dir="ltr">$ crsctl modify policyset &ndash;attr &#34;SERVER_POOL_NAMES=Free pool1 pool2 pool3&#34;
</pre>
<p>The following commands add the three policies:</p>
<pre dir="ltr">$ crsctl add policy <span class="bold">DayTime</span>
$ crsctl add policy <span class="bold">NightTime</span>
$ crsctl add policy <span class="bold">Weekend</span>
</pre>
<p>The following commands configure the three server pools according to the requirements of the policies:</p>
<pre dir="ltr">$ crsctl modify serverpool <span class="bold">pool1</span> -attr &#34;MIN_SIZE=2,MAX_SIZE=2&#34; -policy DayTime
$ crsctl modify serverpool <span class="bold">pool1</span> -attr &#34;MIN_SIZE=1,MAX_SIZE=1&#34; -policy NightTime
$ crsctl modify serverpool <span class="bold">pool1</span> -attr &#34;MIN_SIZE=0,MAX_SIZE=0&#34; -policy Weekend

$ crsctl modify serverpool <span class="bold">pool2</span> -attr &#34;MIN_SIZE=1,MAX_SIZE=1&#34; -policy DayTime
$ crsctl modify serverpool <span class="bold">pool2</span> -attr &#34;MIN_SIZE=2,MAX_SIZE=2&#34; -policy NightTime
$ crsctl modify serverpool <span class="bold">pool2</span> -attr &#34;MIN_SIZE=1,MAX_SIZE=1&#34; -policy Weekend

$ crsctl modify serverpool <span class="bold">pool3</span> -attr &#34;MIN_SIZE=1,MAX_SIZE=1&#34; -policy DayTime
$ crsctl modify serverpool <span class="bold">pool3</span> -attr &#34;MIN_SIZE=1,MAX_SIZE=1&#34; -policy NightTime
$ crsctl modify serverpool <span class="bold">pool3</span> -attr &#34;MIN_SIZE=3,MAX_SIZE=3&#34; -policy Weekend
</pre>
<p>There are now three distinct policies to manage the server pools to accommodate the requirements of the three applications.</p>
<p><span class="bold">Policy Activation</span></p>
<p>The policy set is now configured and controlling the three server pools with three different policies. You can activate policies when necessary, prompting Oracle Clusterware to reconfigure a server pool according to each policy&#39;s configuration.</p>
<p>The following command activates the <code class="codeph">DayTime</code> policy:</p>
<pre dir="ltr">$ crsctl modify policyset -attr &#34;LAST_ACTIVATED_POLICY=<span class="bold">DayTime</span>&#34;
</pre>
<p>The current status of the resources is as follows:</p>
<pre dir="ltr">$ crsctl status resource -t
--------------------------------------------------------------------------------
Name           Target  State        Server                   State details
--------------------------------------------------------------------------------
Cluster Resources
--------------------------------------------------------------------------------
app1
      1        ONLINE  ONLINE       mjk_has3_2               STABLE
      2        ONLINE  ONLINE       mjk_has3_0               STABLE
app2
      1        ONLINE  ONLINE       mjk_has3_1               STABLE
app3
      1        ONLINE  ONLINE       mjk_has3_3               STABLE
</pre>
<p>The status of the server pools is as follows:</p>
<pre dir="ltr">$ crsctl stat serverpool
NAME=Free
ACTIVE_SERVERS=

NAME=Generic
ACTIVE_SERVERS=

NAME=pool1
ACTIVE_SERVERS=mjk_has3_0 mjk_has3_2

NAME=pool2
ACTIVE_SERVERS=mjk_has3_1

NAME=pool3
ACTIVE_SERVERS=mjk_has3_3
</pre>
<p>The servers are allocated according to the <code class="codeph">DayTime</code> policy and the applications run on their respective servers.</p>
<p>The following command activates the <code class="codeph">Weekend</code> policy (remember, because the server pools have different sizes, as servers move between server pools, some applications will be stopped and others will be started):</p>
<pre dir="ltr">$ crsctl modify policyset -attr &#34;LAST_ACTIVATED_POLICY=<span class="bold">Weekend</span>&#34;
CRS-2673: Attempting to stop &#39;app1&#39; on &#39;mjk_has3_2&#39;
CRS-2673: Attempting to stop &#39;app1&#39; on &#39;mjk_has3_0&#39;
CRS-2677: Stop of &#39;app1&#39; on &#39;mjk_has3_0&#39; succeeded
CRS-2672: Attempting to start &#39;app3&#39; on &#39;mjk_has3_0&#39;
CRS-2677: Stop of &#39;app1&#39; on &#39;mjk_has3_2&#39; succeeded
CRS-2672: Attempting to start &#39;app3&#39; on &#39;mjk_has3_2&#39;
CRS-2676: Start of &#39;app3&#39; on &#39;mjk_has3_2&#39; succeeded
CRS-2676: Start of &#39;app3&#39; on &#39;mjk_has3_0&#39; succeeded
</pre>
<p>The current status of the resources is as follows:</p>
<pre dir="ltr">$ crsctl status resource -t
--------------------------------------------------------------------------------
Name           Target  State        Server                   State details      
--------------------------------------------------------------------------------
Cluster Resources
--------------------------------------------------------------------------------
app1
      1        ONLINE  OFFLINE                               STABLE
      2        ONLINE  OFFLINE                               STABLE
app2
      1        ONLINE  ONLINE       mjk_has3_1               STABLE
app3
      1        ONLINE  ONLINE       mjk_has3_0               STABLE
      2        ONLINE  ONLINE       mjk_has3_2               STABLE
      3        ONLINE  ONLINE       mjk_has3_3               STABLE
--------------------------------------------------------------------------------
</pre>
<p>The status of the server pools is as follows:</p>
<pre dir="ltr">$ crsctl status serverpool
NAME=Free
ACTIVE_SERVERS=

NAME=Generic
ACTIVE_SERVERS=

NAME=pool1
ACTIVE_SERVERS=

NAME=pool2
ACTIVE_SERVERS=mjk_has3_1

NAME=pool3
ACTIVE_SERVERS=mjk_has3_0 mjk_has3_2 mjk_has3_3
</pre>
<p>Using the <code class="codeph">crsctl modify policyset</code> command, Oracle Clusterware changed server pool configuration, moved servers according to the requirements of the policy, and stopped and started the applications.</p>
<div class="infoboxnotealso" id="GUID-B5EA4AB9-D9B6-4D8C-BCEF-1551607B2EA9__GUID-35DA05EE-75CD-411C-AA9E-C1B811084045">
<p class="notep1">See Also:</p>
<p><a href="GUID-1A6774CF-FD5F-463E-817F-34E4466443C7.htm">Oracle Clusterware Control (CRSCTL) Utility Reference</a> for complete details on using the CRSCTL commands shown in this example</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5560">
<tr>
<td class="cellalignment5574">
<table class="cellalignment5565">
<tr>
<td class="cellalignment5564"><a href="GUID-C12500DD-8097-41C7-93E3-089A49CBE7F6.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5564"><a href="GUID-DF441DD8-B3B4-48C2-96B5-3DD59EAAC8EF.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2007, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5576">
<table class="cellalignment5563">
<tr>
<td class="cellalignment5564"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5564"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5564"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5564"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5564"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5564"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>