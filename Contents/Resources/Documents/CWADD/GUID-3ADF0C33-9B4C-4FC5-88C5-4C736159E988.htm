<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-4291"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Restoring%20the%20Oracle%20Cluster%20Registry%20on%20Linux%20or%20UNIX%20Systems"></a><title>Restoring the Oracle Cluster Registry on Linux or UNIX Systems</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="dcterms.created" content="2017-07-14T14:47:18Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Clusterware Administration and Deployment Guide"/>
<meta name="dcterms.identifier" content="E48819-11"/>
<meta name="dcterms.isVersionOf" content="CWADD"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2007, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="GUID-648BB199-AFB9-416A-8438-E0331C255E78.htm" title="Previous" type="text/html"/>
<link rel="Next" href="GUID-7372F903-4BC0-4FB1-80AA-33B7BBD726EB.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E48819-11.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988"></a> <span id="PAGE" style="display:none;">143/713</span> <!-- End Header -->
<h1 id="CWADD-GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988" class="sect1">Restoring the Oracle Cluster Registry on Linux or UNIX Systems</h1>
<div>
<div class="section">
<p>If you are storing OCR on an Oracle ASM disk group, and that disk group is corrupt, then you must restore the Oracle ASM disk group using Oracle ASM utilities, and then mount the disk group again before recovering OCR. Recover OCR by running the <code class="codeph">ocrconfig -restore</code> command, as instructed in the following procedure.</p>
<div class="infobox-note" id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__GUID-BC1A351D-E254-47B0-9E1F-20728249A8DE">
<p class="notep1">Note:</p>
<p>If the original OCR location does not exist, then you must create an empty (0 byte) OCR location with the same name as the original OCR location before you run the <code class="codeph">ocrconfig -restore</code> command.</p>
</div>
<div class="infoboxnotealso" id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__GUID-B46493C7-2BD3-4ED4-859A-95D20B00BDE9">
<p class="notep1">See Also:</p>
<p><a class="olink OSTMG94584" target="_blank" href="../OSTMG/GUID-FEA13FA9-4FB3-4C4B-B728-99AD2452888A.htm#OSTMG94584"><span class="italic">Oracle Automatic Storage Management Administrator&#39;s Guide</span></a> for information about how to restore Oracle ASM disk groups</p>
</div>
<p>Use the following procedure to restore OCR on <a id="d34928e117" class="indexterm-anchor"></a>Linux or UNIX systems:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>List the nodes in your cluster by running the following command on one node:</span>
<div>
<pre dir="ltr">$ olsnodes
</pre></div>
</li>
<li class="stepexpand"><span>Depending on whether OCR is located in an Oracle ASM disk group or on network attached storage (NAS), stop Oracle Clusterware by running one of the following commands as root on all of the nodes:</span>
<div>
<p>If OCR is located in an Oracle ASM disk group, then stop the Oracle Clusterware daemon:</p>
<pre dir="ltr"># crsctl stop crs
</pre>
<p>If the preceding command returns any error due to OCR corruption, then force stop Oracle Clusterware by running the following command as <code class="codeph">root</code> on all of the nodes:</p>
<pre dir="ltr"># crsctl stop crs -f
</pre></div>
</li>
<li class="stepexpand"><span>If you are restoring OCR to a cluster file system or network file system, then run the following command as <code class="codeph">root</code> to restore OCR with an OCR backup that you can identify in <span class="q">&#34;<a href="GUID-6921B0DB-4C97-48D6-9128-373544663DCF.htm">Listing Backup Files</a>&#34;</span>:</span>
<div>
<pre dir="ltr"># ocrconfig -restore <span class="italic">file_name</span>
</pre>
<div class="infobox-note" id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__GUID-CB3047A5-9646-4C48-B2EA-F0658F23A30B">
<p class="notep1">Note:</p>
<p>If the OCR backup file is located in an Oracle ASM disk group, then ensure that the disk group exists and is mounted.</p>
</div>
<p>After you complete this step, proceed to step <a href="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988.htm#GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__CHDCIGEE">11</a>.</p>
<p>If you are <span class="italic">not</span> restoring OCR to a cluster file system or network file system, then proceed to the next step.</p>
</div>
</li>
<li class="stepexpand"><span>Start the Oracle Clusterware stack on one node in exclusive mode by running the following command as <code class="codeph">root</code>:</span>
<div>
<pre dir="ltr"># crsctl start crs -excl -nocrs
</pre>
<p>The <code class="codeph">-nocrs</code> option ensures that the CRSD process and OCR do not start with the rest of the Oracle Clusterware stack.</p>
<p>Ignore any errors that display.</p>
</div>
</li>
<li class="stepexpand"><span>Check whether CRSD is running by running the following command:</span>
<div>
<pre dir="ltr">$ crsctl status resource ora.crsd -init
</pre>
<p>If CRSD is running, then stop it by running the following command as <code class="codeph">root</code>:</p>
<pre dir="ltr"># crsctl stop resource ora.crsd -init
</pre>
<div class="infobox-note" id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__GUID-A1CDB843-0497-4251-8FE9-FB71879AF66B">
<p class="notep1">Caution:</p>
<p><span class="italic">Do not</span> use the <code class="codeph">-init</code> flag with any other command unless directed to do so by My Oracle Support.</p>
</div>
</div>
</li>
<li class="stepexpand"><span>To restore OCR to an Oracle ASM disk group, you must first create a disk group using SQL*Plus that has the same name as the disk group you want to restore and mount it on the local node.</span>
<div>
<p>If you cannot mount the disk group locally, then run the following SQL*Plus command:</p>
<pre dir="ltr">SQL&gt; drop diskgroup <span class="italic">disk_group_name</span> force including contents;
</pre></div>
</li>
<li class="stepexpand"><span>Restore OCR with an OCR backup that you can identify in <span class="q">&#34;<a href="GUID-6921B0DB-4C97-48D6-9128-373544663DCF.htm">Listing Backup Files</a>&#34;</span> by running the following command as <code class="codeph">root</code>:</span>
<div>
<pre dir="ltr"># ocrconfig -restore <span class="italic">file_name</span>
</pre>
<div class="infobox-note" id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__GUID-3F136B1E-8331-4E8D-96F0-8BD82A11B8A5">
<p class="notep1">Note:</p>
<ul style="list-style-type: disc;">
<li>
<p>If the original OCR location does not exist, then you must create an empty (0 byte) OCR location before you run the <code class="codeph">ocrconfig -restore</code> command.</p>
</li>
<li>
<p>Ensure that the OCR devices that you specify in the OCR configuration exist and that these OCR devices are valid.</p>
</li>
<li>
<p>If you configured OCR in an Oracle ASM disk group, then ensure that the Oracle ASM disk group exists and is mounted.</p>
</li>
<li>
<p>If the OCR backup file is located in an Oracle ASM disk group, then ensure that the disk group exists and is mounted.</p>
</li>
</ul>
</div>
<div class="infoboxnotealso" id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__GUID-4EBBE40F-34D3-45EB-A050-0091E2D33DDA">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink CWGEN" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=CWGEN"><span class="italic">Oracle Grid Infrastructure Installation Guide</span></a> for information about creating OCRs</p>
</li>
<li>
<p><a class="olink OSTMG137" target="_blank" href="../OSTMG/GUID-C455CEB1-0FC3-4DF4-9CD4-25EFA4D2BE01.htm#OSTMG137"><span class="italic">Oracle Automatic Storage Management Administrator&#39;s Guide</span></a> for more information about Oracle ASM disk group management</p>
</li>
</ul>
</div>
</div>
</li>
<li class="stepexpand"><span>Verify the integrity of OCR:</span>
<div>
<pre dir="ltr"># ocrcheck
</pre></div>
</li>
<li class="stepexpand"><span>Stop Oracle Clusterware on the node where it is running in exclusive mode:</span>
<div>
<pre dir="ltr"># crsctl stop crs -f
</pre></div>
</li>
<li class="stepexpand"><span>Run the <code class="codeph">ocrconfig -repair -replace</code> command as <code class="codeph">root</code> on all the nodes in the cluster where you <span class="italic">did not</span> the <code class="codeph">ocrconfig -restore</code> command. For example, if you ran the <code class="codeph">ocrconfig -restore</code> command on node 1 of a four-node cluster, then you must run the <code class="codeph">ocrconfig -repair -replace</code> command on nodes 2, 3, and 4.</span></li>
<li class="stepexpand" id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__CHDCIGEE"><span>Begin to start Oracle Clusterware by running the following command as <code class="codeph">root</code> on all of the nodes:</span>
<div>
<pre dir="ltr"># crsctl start crs
</pre></div>
</li>
<li class="stepexpand"><span>Verify OCR integrity of all of the cluster nodes that are configured as part of your cluster by running the following CVU command:</span>
<div>
<pre dir="ltr">$ cluvfy comp ocr -n all -verbose
</pre></div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__GUID-3A706590-2236-4731-81C2-2CF84FEEE34E">
<p class="notep1">See Also:</p>
<p><a href="GUID-B445A858-9F00-4423-990E-109545AC11C3.htm">Cluster Verification Utility Reference</a> for more information about enabling and using CVU</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5560">
<tr>
<td class="cellalignment5574">
<table class="cellalignment5565">
<tr>
<td class="cellalignment5564"><a href="GUID-648BB199-AFB9-416A-8438-E0331C255E78.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5564"><a href="GUID-7372F903-4BC0-4FB1-80AA-33B7BBD726EB.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2007, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5576">
<table class="cellalignment5563">
<tr>
<td class="cellalignment5564"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5564"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5564"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5564"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5564"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5564"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>