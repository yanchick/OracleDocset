<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-4569"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Migrating%20Oracle%20Cluster%20Registry%20to%20Oracle%20Automatic%20Storage%20Management"></a><title>Migrating Oracle Cluster Registry to Oracle Automatic Storage Management</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="dcterms.created" content="2017-07-14T14:47:18Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Clusterware Administration and Deployment Guide"/>
<meta name="dcterms.identifier" content="E48819-11"/>
<meta name="dcterms.isVersionOf" content="CWADD"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2007, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="GUID-20101C89-B87C-49C9-BA63-634376EDB62E.htm" title="Previous" type="text/html"/>
<link rel="Next" href="GUID-45585A36-F1D3-49AC-B2FB-4EE0F608C6DF.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E48819-11.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC"></a> <span id="PAGE" style="display:none;">131/713</span> <!-- End Header -->
<a id="CWADD91099"></a>
<h1 id="CWADD-GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC" class="sect1">Migrating Oracle Cluster Registry to Oracle Automatic Storage Management</h1>
<div>
<div class="section">
<p>To improve Oracle Clusterware storage manageability, OCR is configured, by default, to use Oracle ASM in Oracle Database 12<span class="italic">c</span>. With the Oracle Clusterware storage residing in an Oracle ASM disk group, you can manage both database and clusterware storage using Oracle Enterprise Manager.</p>
<p>However, if you upgrade from a previous version of Oracle Clusterware, you can migrate OCR to reside on Oracle ASM, and take advantage of the improvements in managing Oracle Clusterware storage.</p>
<div class="infobox-note" id="GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC__GUID-66A5C727-16DC-4472-AB00-6E292BA62DC5">
<p class="notep1">Note:</p>
<p>If you upgrade from a previous version of Oracle Clusterware to Oracle Clusterware 12<span class="italic">c</span> and you want to store OCR in an Oracle ASM disk group, then you must set the <span class="bold">ASM Compatibility</span> compatibility attribute to <code class="codeph">11.2.0.2</code>, or later.</p>
</div>
<div class="infoboxnotealso" id="GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC__GUID-07069223-ACB7-47DB-8C01-C0C2066CC2D3">
<p class="notep1">See Also:</p>
<p><a class="olink OSTMG02700" target="_blank" href="../OSTMG/GUID-FBB5AA72-5208-48E1-BD8D-0FD4C6876F34.htm#OSTMG02700"><span class="italic">Oracle Automatic Storage Management Administrator&#39;s Guide</span></a> for information about setting Oracle ASM compatibility attributes</p>
</div>
<p>To migrate <a id="d32931e126" class="indexterm-anchor"></a><a id="d32931e130" class="indexterm-anchor"></a><a id="d32931e136" class="indexterm-anchor"></a><a id="d32931e140" class="indexterm-anchor"></a>OCR to Oracle ASM using OCRCONFIG:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Ensure the upgrade to Oracle Clusterware 12<span class="italic">c</span> is complete. Run the following command to verify the current running version:</span>
<div>
<pre dir="ltr">$ crsctl query crs activeversion
</pre></div>
</li>
<li class="stepexpand"><span>Use the Oracle ASM Configuration Assistant (ASMCA) to configure and start Oracle ASM on all nodes in the cluster.</span>
<div>
<div class="infoboxnotealso" id="GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC__GUID-B12B1863-5E43-46E6-81AE-37FC346363DC">
<p class="notep1">See Also:</p>
<p><a class="olink OSTMG50000" target="_blank" href="../OSTMG/GUID-C29F444F-C440-450B-A13B-84CC2147826F.htm#OSTMG50000"><span class="italic">Oracle Automatic Storage Management Administrator&#39;s Guide</span></a> for more information about using ASMCA</p>
</div>
</div>
</li>
<li class="stepexpand"><span>Use ASMCA to create an Oracle ASM disk group that is at least the same size of the existing OCR and has at least normal redundancy.</span>
<div>
<div class="infobox-note" id="GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC__GUID-F34C5E10-56DE-40B5-BBE1-C8BAA9F54E0E">
<p class="notep1">Note:</p>
<ul style="list-style-type: disc;">
<li>
<p>If OCR is stored in an Oracle ASM disk group with external redundancy, then Oracle recommends that you add another OCR location to another disk group to avoid the loss of OCR, if a disk fails in the disk group.</p>
<p>Oracle does not support storing OCR on different storage types simultaneously, such as storing OCR on both Oracle ASM and a shared file system, except during a migration.</p>
</li>
<li>
<p>If an Oracle ASM instance fails on any node, then OCR becomes unavailable on that particular node.</p>
<p>If the CRSD process running on the node affected by the Oracle ASM instance failure is the <a href="GUID-FB51DFBE-3132-42F6-AF8F-36820197EF6B.htm#GUID-20E48152-87E0-4668-B8E6-3B0CF469B544"><span class="xrefglossterm">OCR writer</span></a>, the majority of the OCR locations are stored in Oracle ASM, and you attempt I/O on OCR during the time the Oracle ASM instance is down on this node, then CRSD stops and becomes inoperable. Cluster management is now affected on this particular node.</p>
<p>Under no circumstances will the failure of one Oracle ASM instance on one node affect the whole cluster.</p>
</li>
<li>
<p>Ensure that Oracle ASM disk groups that you create are mounted on all of the nodes in the cluster.</p>
</li>
</ul>
</div>
<div class="infoboxnotealso" id="GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC__GUID-03D335A2-6905-4948-8EDA-A93E4EB7DC50">
<p class="notep1">See Also:</p>
<p><a class="olink CWGEN" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=CWGEN"><span class="italic">Oracle Grid Infrastructure Installation Guide</span></a> for more detailed sizing information</p>
</div>
</div>
</li>
<li class="stepexpand"><span>To add OCR to an Oracle ASM disk group, ensure that the <a href="GUID-FB51DFBE-3132-42F6-AF8F-36820197EF6B.htm#GUID-C1F07478-A146-48E0-94E2-A93F6ED7B34A"><span class="xrefglossterm">Oracle Clusterware stack</span></a> is running and run the following command as <code class="codeph">root</code>:</span>
<div>
<pre dir="ltr"># ocrconfig -add +<span class="italic">new_disk_group</span>
</pre>
<p>You can run this command more than once if you add multiple OCR locations. You can have up to five OCR locations. However, each successive run must point to a different disk group.</p>
</div>
</li>
<li class="stepexpand"><span>To remove storage configurations no longer in use, run the following command as <code class="codeph">root</code>:</span>
<div>
<pre dir="ltr"># ocrconfig -delete <span class="italic">old_storage_location</span>
</pre>
<p>Run this command for every configured OCR.</p>
</div>
</li>
</ol>
<div class="section">
<p>The following example shows how to migrate two OCRs to Oracle ASM using OCRCONFIG.</p>
<pre dir="ltr"># ocrconfig -add +<span class="italic">new_disk_group</span>
# ocrconfig -delete /ocrdata/ocr_1
# ocrconfig -delete /ocrdata/ocr_2
</pre>
<div class="infobox-note" id="GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC__GUID-88CE998C-0FE6-4468-B3A3-E829ABAC7929">
<p class="notep1">Note:</p>
<ul style="list-style-type: disc;">
<li>
<p>OCR inherits the redundancy of the disk group. If you want high redundancy for OCR, you must configure the disk group with high redundancy when you create it.</p>
</li>
<li>
<p>Oracle recommends that you put the SPFILE for Oracle ASM in this newly-created OCR location.</p>
</li>
</ul>
</div>
<div class="infoboxnotealso" id="GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC__GUID-E83978C6-8906-48E2-A570-D779F91AFC25">
<p class="notep1">See Also:</p>
<p><a class="olink OSTMG94437" target="_blank" href="../OSTMG/GUID-8946D285-8EAF-4466-8985-BDE95EE5B0C7.htm#OSTMG94437"><span class="italic">Oracle Automatic Storage Management Administrator&#39;s Guide</span></a> for information about setting the location of the Oracle ASM SPFILE</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5560">
<tr>
<td class="cellalignment5574">
<table class="cellalignment5565">
<tr>
<td class="cellalignment5564"><a href="GUID-20101C89-B87C-49C9-BA63-634376EDB62E.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5564"><a href="GUID-45585A36-F1D3-49AC-B2FB-4EE0F608C6DF.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2007, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5576">
<table class="cellalignment5563">
<tr>
<td class="cellalignment5564"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5564"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5564"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5564"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5564"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5564"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>