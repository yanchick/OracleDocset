<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-4386"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Examples%20of%20Action%20Scripts%20for%20Third-party%20Applications"></a><title>Examples of Action Scripts for Third-party Applications</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="dcterms.created" content="2017-07-14T14:47:18Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Clusterware Administration and Deployment Guide"/>
<meta name="dcterms.identifier" content="E48819-11"/>
<meta name="dcterms.isVersionOf" content="CWADD"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2007, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="GUID-1F6DCC68-2E8C-40F4-BCAD-9CA02B253F22.htm" title="Previous" type="text/html"/>
<link rel="Next" href="GUID-5AB4A4C6-E771-4560-B3CF-BB89A34AAFE8.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E48819-11.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-58143813-C77F-4EAF-8E2C-D82E10F13B26"></a> <span id="PAGE" style="display:none;">343/713</span> <!-- End Header -->
<a id="CWADD92006"></a><a id="CWADD91496"></a><a id="CWADD91497"></a><a id="CWADD91495"></a>
<h1 id="CWADD-GUID-58143813-C77F-4EAF-8E2C-D82E10F13B26" class="sect1">Examples of Action Scripts for Third-party Applications</h1>
<div>
<p>This section includes examples of third-party applications using script agents.</p>
<p><a href="GUID-58143813-C77F-4EAF-8E2C-D82E10F13B26.htm#GUID-58143813-C77F-4EAF-8E2C-D82E10F13B26__CHDJABHC">Example B-1</a> shows an action script that fails over the Apache Web server.</p>
<div class="example" id="GUID-58143813-C77F-4EAF-8E2C-D82E10F13B26__CHDJABHC">
<p class="titleinexample">Example B-1 Apache Action Script</p>
<pre dir="ltr">#!/bin/sh

HTTPDCONFLOCATION=/etc/httpd/conf/httpd.conf
WEBPAGECHECK=http://&lt;MyVIP&gt;:80/icons/apache_pb.gif

case $1 in
&#39;start&#39;)
    /usr/sbin/apachectl -k start -f $HTTPDCONFLOCATION
   RET=$?
    ;;
sleep(10)
    ;;
&#39;stop&#39;)
    /usr/sbin/apachectl -k stop
   RET=$?
    ;;
&#39;clean&#39;)
    /usr/sbin/apachectl -k stop
   RET=$?
    ;;
&#39;check&#39;)
    /usr/bin/wget -q --delete-after $WEBPAGECHECK
   RET=$?
    ;;
*)
   RET=0
    ;;
esac
# 0: success; 1 : error
if [ $RET -eq 0 ]; then
exit 0
else
exit 1
fi
</pre></div>
<!-- class="example" -->
<p><a href="GUID-58143813-C77F-4EAF-8E2C-D82E10F13B26.htm#GUID-58143813-C77F-4EAF-8E2C-D82E10F13B26__CHDCDGHF">Example B-2</a> shows the <span class="bold">xclock</span> script, which is a simple action script using <code class="codeph">xclock</code> available as a default binary on all Linux and UNIX platforms.</p>
<div class="example" id="GUID-58143813-C77F-4EAF-8E2C-D82E10F13B26__CHDCDGHF">
<p class="titleinexample">Example B-2 xclock Action Script</p>
<pre dir="ltr">#!/bin/bash
# start/stop/check script for xclock example
# To test this change BIN_DIR to the directory where xclock is based
# and set the DISPLAY variable to a server within your network.

BIN_DIR=/usr/X11R6/bin
LOG_DIR=/tmp
BIN_NAME=xclock
DISPLAY=yourhost.domain.com:0.0
export DISPLAY
exit_code=0

if [ ! -d $BIN_DIR ]
then
        echo &#34;start failed&#34;
        exit 2
fi

PID1=`ps -ef | grep $BIN_NAME | grep -v grep | grep -v xclock_app | awk &#39;{ print $2 }&#39;`
case $1 in
&#39;start&#39;)
        if [ &#34;$PID1&#34; != &#34;&#34; ]
        then
           status_p1=&#34;running&#34;
        else
           if [ -x $BIN_DIR/$BIN_NAME ]
           then
             umask 002
             ${BIN_DIR}/${BIN_NAME} &amp; 2&gt;${LOG_DIR}/${BIN_NAME}.log
             status_p1=&#34;started&#34;
           else
             echo `basename $0`&#34;: $BIN_NAME: Executable not found&#34;
             exit_code=1
           fi
        fi

         echo &#34;$BIN_NAME: $status_p1&#34;
         exit $exit_code
        ;;

&#39;stop&#39;)
        if [ &#34;${PID1}&#34; != &#34;&#34; ]
        then
           kill -9 ${PID1} &amp;&amp; echo &#34;$BIN_NAME daemon killed&#34;
        else
           echo &#34;$BIN_NAME: no running Process!&#34;
        fi
        exit $exit_code
        ;;
&#39;check&#39;)
        if [ &#34;$PID1&#34; != &#34;&#34; ]
        then
           echo &#34;running&#34;
           exit 0
        else
           echo &#34;not running&#34;
           exit 1
        fi
        ;;*)
        echo &#34;Usage: &#34;`basename $0`&#34; {start|stop|check}&#34;
        ;;
esac
</pre></div>
<!-- class="example" -->
<p><a href="GUID-58143813-C77F-4EAF-8E2C-D82E10F13B26.htm#GUID-58143813-C77F-4EAF-8E2C-D82E10F13B26__CHDGJFJG">Example B-3</a> shows an example of a shell script for an agent to monitor a file. When the agent is started, it creates the file (which is specified through an attribute) and when it is stopped, it deletes the file. The CHECK action consists of only checking whether the file exists. The variables with the <code class="codeph">_CRS_</code> prefix are attribute values that are provided to the script in its environment.</p>
<div class="example" id="GUID-58143813-C77F-4EAF-8E2C-D82E10F13B26__CHDGJFJG">
<p class="titleinexample">Example B-3 Action Script Example</p>
<pre dir="ltr">#!/bin/sh
TOUCH=/bin/touch
RM=/bin/rm
PATH_NAME=/tmp/$_CRS_NAME

#
# These messages go into the CRSD agent log file.
echo &#34; *******   `date` ********** &#34;
echo &#34;Action script &#39;$_CRS_ACTION_SCRIPT&#39; for resource[$_CRS_NAME] called for action $1&#34;
#

case &#34;$1&#34; in
  &#39;start&#39;)
     echo &#34;START entry point has been called..&#34;
     echo &#34;Creating the file: $PATH_NAME&#34;
     $TOUCH $PATH_NAME
     exit 0
     ;;

  &#39;stop&#39;)
     echo &#34;STOP entry point has been called..&#34; 
     echo &#34;Deleting the file: $PATH_NAME&#34;
     $RM $PATH_NAME
     exit 0
     ;;

  &#39;check&#39;)
    echo &#34;CHECK entry point has been called..&#34;
    if [ -e $PATH_NAME ]; then
        echo &#34;Check -- SUCCESS&#34;
        exit 0
    else
        echo &#34;Check -- FAILED&#34;
        exit 1
    fi
    ;;

  &#39;clean&#39;)
     echo &#34;CLEAN entry point has been called..&#34;
     echo &#34;Deleting the file: $PATH_NAME&#34;
     $RM -f $PATH_NAME
     exit 0
     ;;

esac
</pre></div>
<!-- class="example" --></div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5560">
<tr>
<td class="cellalignment5574">
<table class="cellalignment5565">
<tr>
<td class="cellalignment5564"><a href="GUID-1F6DCC68-2E8C-40F4-BCAD-9CA02B253F22.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5564"><a href="GUID-5AB4A4C6-E771-4560-B3CF-BB89A34AAFE8.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2007, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5576">
<table class="cellalignment5563">
<tr>
<td class="cellalignment5564"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5564"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5564"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5564"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5564"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5564"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>