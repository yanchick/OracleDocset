<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-4757"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Changing%20the%20Virtual%20IP%20Addresses%20Using%20SRVCTL"></a><title>Changing the Virtual IP Addresses Using SRVCTL</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="dcterms.created" content="2017-07-14T14:47:18Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Clusterware Administration and Deployment Guide"/>
<meta name="dcterms.identifier" content="E48819-11"/>
<meta name="dcterms.isVersionOf" content="CWADD"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2007, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="GUID-4C37D5FD-C68D-4561-BC9F-2183EA166101.htm" title="Previous" type="text/html"/>
<link rel="Next" href="GUID-2ED1AAF6-F26F-4A3F-A334-38C8EF6BC42F.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E48819-11.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-DCA6B7FF-70F7-4CBC-9E87-0ACB4F69AD4A"></a> <span id="PAGE" style="display:none;">72/713</span> <!-- End Header -->
<a id="CWADD92080"></a>
<h1 id="CWADD-GUID-DCA6B7FF-70F7-4CBC-9E87-0ACB4F69AD4A" class="sect1">Changing the Virtual IP Addresses Using SRVCTL</h1>
<div>
<div class="section">
<p><a id="d21350e99" class="indexterm-anchor"></a>Clients configured to use public VIP addresses for Oracle Database releases before Oracle Database 11<span class="italic">g</span> release 2 (11.2) can continue to use their existing connection addresses. Oracle recommends that you configure clients to use SCANs, but you are not required to use SCANs. When an earlier version of Oracle Database is upgraded, it is registered with the SCAN, and clients can start using the SCAN to connect to that database, or continue to use VIP addresses for connections.</p>
<p>If you continue to use VIP addresses for client connections, you can modify the VIP address while Oracle Database and Oracle ASM continue to run. However, you must stop services while you modify the address. When you restart the VIP address, services are also restarted on the node.</p>
<p>You cannot use this procedure to change a static public subnet to use DHCP. Only the <code class="codeph">srvctl add network -subnet</code> command creates a DHCP network.</p>
<div class="infoboxnotealso" id="GUID-DCA6B7FF-70F7-4CBC-9E87-0ACB4F69AD4A__GUID-29F8A038-8002-4488-9CD9-4BD941BE6089">
<p class="notep1">See Also:</p>
<p><a class="olink RACAD8248" target="_blank" href="../RACAD/GUID-E9B08A79-CE87-47ED-8FD8-7EAF421CCD88.htm#RACAD8248"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for more information about the <code class="codeph">srvctl add network</code> command</p>
</div>
<div class="infobox-note" id="GUID-DCA6B7FF-70F7-4CBC-9E87-0ACB4F69AD4A__GUID-77DA9B8E-D5F3-41D8-93D7-304957EE4A67">
<p class="notep1">Note:</p>
<p>The following instructions describe how to change only a VIP address, and assume that the host name associated with the VIP address does not change. Note that you do not need to update VIP addresses manually if you are using GNS, and VIPs are assigned using DHCP.</p>
<p>If you are changing only the VIP address, then update the DNS and the client hosts files. Also, update the server hosts files, if those are used for VIP addresses.</p>
</div>
<p>Perform the following steps to change a VIP address:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span><a id="d21350e134" class="indexterm-anchor"></a><a id="d21350e140" class="indexterm-anchor"></a>Stop all services running on the node whose VIP address you want to change using the following command syntax, where <span class="italic"><code class="codeph">database_name</code></span> is the name of the database, <span class="italic"><code class="codeph">service_name_list</code></span> is a list of the services you want to stop, and <span class="italic"><code class="codeph">my_node</code></span> is the name of the node whose VIP address you want to change:</span>
<div>
<pre dir="ltr">srvctl stop service -db <span class="italic">database_name</span> -service &#34;<span class="italic">service_name_list</span>&#34; -node <span class="italic">node_name</span>
</pre>
<p>The following example specifies the database name (<code class="codeph">grid</code>) using the <code class="codeph">-db</code> option and specifies the services (<code class="codeph">sales,oltp</code>) on the appropriate node (<code class="codeph">mynode</code>).</p>
<pre dir="ltr">$ srvctl stop service -db grid -service &#34;sales,oltp&#34; -node mynode
</pre></div>
</li>
<li class="stepexpand"><span>Confirm the current IP address for the VIP address by running the <code class="codeph">srvctl config vip</code> command. This command displays the current VIP address bound to one of the network interfaces. The following example displays the configured VIP address for a VIP named <code class="codeph">node03-vip</code>:</span>
<div>
<pre dir="ltr">$ srvctl config vip -vipname node03-vip
VIP exists: /node03-vip/192.168.2.20/255.255.255.0/eth0
</pre></div>
</li>
<li class="stepexpand"><span>Stop the VIP resource using the <a id="d21350e198" class="indexterm-anchor"></a><code class="codeph">srvctl stop vip</code> command:</span>
<div>
<pre dir="ltr">$ srvctl stop vip -node <span class="italic">node_name</span>
</pre></div>
</li>
<li class="stepexpand"><span>Verify that the VIP resource is no longer running by running the <code class="codeph">ifconfig -a</code> command on Linux and UNIX systems (or issue the <code class="codeph">ipconfig /all</code> command on Windows systems), and confirm that the interface (in the example it was <code class="codeph">eth0:1</code>) is no longer listed in the output.</span></li>
<li class="stepexpand"><span>Make any changes necessary to the <code class="codeph">/etc/hosts</code> files on all nodes on Linux and UNIX systems, or the <code class="codeph">%windir%\system32\drivers\etc\hosts</code> file on Windows systems, and make any necessary DNS changes to associate the new IP address with the old host name.</span></li>
<li class="stepexpand"><span>To use a different subnet or network interface card for the default network before you change any VIP resource, you must use the <code class="codeph">srvctl modify network -subnet</code> <span class="italic"><code class="codeph">subnet</code></span><code class="codeph">/</code><span class="italic"><code class="codeph">netmask</code></span><code class="codeph">/</code><span class="italic"><code class="codeph">interface</code></span> command as <code class="codeph">root</code> to change the network resource, where <span class="italic"><code class="codeph">subnet</code></span> is the new subnet address, <span class="italic"><code class="codeph">netmask</code></span> is the new netmask, and <span class="italic"><code class="codeph">interface</code></span> is the new interface. After you change the subnet, then you must change each node&#39;s VIP to an IP address on the new subnet, as described in the next step.</span></li>
<li class="stepexpand"><span>Modify the node applications and provide the new VIP address using the following <code class="codeph">srvctl modify nodeapps</code> syntax:</span>
<div>
<pre dir="ltr">$ srvctl modify nodeapps -node <span class="italic">node_name</span> -address <span class="italic">new_vip_address</span>
</pre>
<p>The command includes the following flags and values:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">-n</code> <span class="italic"><code class="codeph">node_name</code></span> is the node name</p>
</li>
<li>
<p><code class="codeph">-A</code> <span class="italic"><code class="codeph">new_vip_address</code></span> is the node-level VIP address: <span class="italic"><code class="codeph">name</code></span>|<span class="italic"><code class="codeph">ip</code></span><code class="codeph">/</code><span class="italic"><code class="codeph">netmask</code></span><code class="codeph">/</code><code class="codeph">[</code><span class="italic"><code class="codeph">if1</code></span><code class="codeph">[|</code><span class="italic"><code class="codeph">if2</code></span><code class="codeph">|...]]</code></p>
<p>For example, issue the following command as the <code class="codeph">root</code> user:</p>
<pre dir="ltr">srvctl modify nodeapps -node mynode -address 192.168.2.125/255.255.255.0/eth0
</pre>
<p>Attempting to issue this command as the installation owner account may result in an error. For example, if the installation owner is <code class="codeph">oracle</code>, then you may see the error <code class="codeph">PRCN-2018: Current user oracle is not a privileged user</code>.To avoid the error, run the command as the <code class="codeph">root</code> or system administrator account.</p>
</li>
</ul>
</div>
</li>
<li class="stepexpand"><span>Start the node VIP by running the <code class="codeph">srvctl start vip</code> command:</span>
<div>
<pre dir="ltr">$ srvctl start vip -node <span class="italic">node_name</span>
</pre>
<p>The following command example starts the VIP on the node named <code class="codeph">mynode</code>:</p>
<pre dir="ltr">$ srvctl start vip -node mynode
</pre></div>
</li>
<li class="stepexpand"><span>Repeat the steps for each node in the cluster.</span>
<div>
<p>Because the SRVCTL utility is a clusterwide management tool, you can accomplish these tasks for any specific node from any node in the cluster, without logging in to each of the cluster nodes.</p>
</div>
</li>
<li class="stepexpand"><span>Run the following command to verify node connectivity between all of the nodes for which your cluster is configured. This command discovers all of the network interfaces available on the cluster nodes and verifies the connectivity between all of the nodes by way of the discovered interfaces. This command also lists all of the interfaces available on the nodes which are suitable for use as VIP addresses.</span>
<div>
<pre dir="ltr">$ <a id="d21350e377" class="indexterm-anchor"></a>cluvfy comp nodecon -n all -verbose
</pre></div>
</li>
</ol>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment5560">
<tr>
<td class="cellalignment5574">
<table class="cellalignment5565">
<tr>
<td class="cellalignment5564"><a href="GUID-4C37D5FD-C68D-4561-BC9F-2183EA166101.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5564"><a href="GUID-2ED1AAF6-F26F-4A3F-A334-38C8EF6BC42F.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2007, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment5576">
<table class="cellalignment5563">
<tr>
<td class="cellalignment5564"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5564"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5564"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5564"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5564"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5564"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>