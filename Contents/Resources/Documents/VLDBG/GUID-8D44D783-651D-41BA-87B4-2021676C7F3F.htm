<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-114415"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Partial%20Partition-Wise%20Joins%3A%20Single-Level%20Partitioning"></a><title>Partial Partition-Wise Joins: Single-Level Partitioning</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="keywords" content="partial partition-wise joins, single-level"/>
<meta name="dcterms.created" content="2016-07-20T13:00:08Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database VLDB and Partitioning Guide"/>
<meta name="dcterms.identifier" content="E41057-12"/>
<meta name="dcterms.isVersionOf" content="VLDBG"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2008, 2016, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="GUID-34563811-55B5-4ABF-8960-F225AB3CC240.htm" title="Previous" type="text/html"/>
<link rel="Next" href="GUID-5B63C8B9-2CF8-4411-AA07-5979AD7104BA.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41057-12.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-8D44D783-651D-41BA-87B4-2021676C7F3F"></a> <span id="PAGE" style="display:none;">75/481</span> <!-- End Header --><a id="VLDBG1249"></a><a id="VLDBG1248"></a>
<h1 id="VLDBG-GUID-8D44D783-651D-41BA-87B4-2021676C7F3F" class="sect1">Partial Partition-Wise Joins: Single-Level Partitioning</h1>
<div>
<p>The simplest method to enable a partial partition-wise join is to partition <code>sales</code> by hash on <code>cust_id</code>. The number of partitions determines the maximum degree of parallelism, because the partition is the smallest granule of parallelism for partial partition-wise join operations.</p>
<p>The parallel execution of a partial partition-wise join, illustrated in the following figure, assumes that both the degree of parallelism and the number of partitions of <code>sales</code> are 16. The execution involves two sets of query servers: one set, labeled <span class="italic">set 1</span>, scans the <code>customers</code> table in parallel. The granule of parallelism for the scan operation is a range of blocks.</p>
<p>Rows from <code>customers</code> that are selected by the first set, in this case all rows, are redistributed to the second set of query servers by hashing <code>cust_id</code>. For example, all rows in <code>customers</code> that could have matching rows in partition <code>P1</code> of <code>sales</code> are sent to query server 1 in the second set. Rows received by the second set of query servers are joined with the rows from the corresponding partitions in <code>sales</code>. Query server number 1 in the second set joins all <code>customers</code> rows that it receives with partition <code>P1</code> of <code>sales</code>.</p>
<div class="figure" id="GUID-8D44D783-651D-41BA-87B4-2021676C7F3F__PARTIALPARTITION-WISEJOIN-33227885">
<p class="titleinfigure">Figure 3-3 Partial Partition-Wise Join</p>
<img width="471" height="336" src="img/GUID-E1F54D79-26AB-4FA8-91BB-604B92272D4C-default.gif" alt="Description of Figure 3-3 follows" title="Description of Figure 3-3 follows"/><br/>
<a href="img_text/GUID-E1F54D79-26AB-4FA8-91BB-604B92272D4C-default.htm">Description of &#34;Figure 3-3 Partial Partition-Wise Join&#34;</a></div>
<!-- class="figure" -->
<p>The example below shows the execution plan for the partial partition-wise join between <code>sales</code> and <code>customers</code>.</p>
<pre dir="ltr">-----------------------------------------------------------------------------------------------
| Id  | Operation                             | Name      | Pstart| Pstop |IN-OUT| PQ Distrib |
-----------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                      |           |       |       |      |            |
|   1 |  PX COORDINATOR                       |           |       |       |      |            |
|   2 |   PX SEND QC (RANDOM)                 | :TQ10002  |       |       | P-&gt;S | QC (RAND)  |
|*  3 |    FILTER                             |           |       |       | PCWC |            |
|   4 |     HASH GROUP BY                     |           |       |       | PCWP |            |
|   5 |      PX RECEIVE                       |           |       |       | PCWP |            |
|   6 |       PX SEND HASH                    | :TQ10001  |       |       | P-&gt;P | HASH       |
|   7 |        HASH GROUP BY                  |           |       |       | PCWP |            |
|*  8 |         HASH JOIN                     |           |       |       | PCWP |            |
|   9 |          PART JOIN FILTER CREATE      | :BF0000   |       |       | PCWP |            |
|  10 |           PX RECEIVE                  |           |       |       | PCWP |            |
|  11 |            PX SEND PARTITION (KEY)    | :TQ10000  |       |       | P-&gt;P | PART (KEY) |
|  12 |             PX BLOCK ITERATOR         |           |       |       | PCWC |            |
|  13 |              TABLE ACCESS FULL        | CUSTOMERS |       |       | PCWP |            |
|  14 |          PX PARTITION HASH JOIN-FILTER|           |:BF0000|:BF0000| PCWC |            |
|* 15 |           TABLE ACCESS FULL           | SALES     |:BF0000|:BF0000| PCWP |            |
-----------------------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   3 - filter(COUNT(SYS_OP_CSR(SYS_OP_MSR(COUNT(*)),0))&gt;100)
   8 - access(&#34;S&#34;.&#34;CUST_ID&#34;=&#34;C&#34;.&#34;CUST_ID&#34;)
  15 - filter(&#34;S&#34;.&#34;TIME_ID&#34;&lt;=TO_DATE(&#39; 1999-10-01 00:00:00&#39;, &#39;syyyy-mm-dd hh24:mi:ss&#39;) AND 
&#34;S&#34;.&#34;TIME_ID&#34;&gt;=TO_DATE(&#39; 1999-07-01
              00:00:00&#39;, &#39;syyyy-mm-dd hh24:mi:ss&#39;))
</pre>
<p>This query runs in parallel, as displayed in the plan, because there are <code>PX</code> row sources. One table is partitioned, which is the <code>SALES</code> table. You can determine this because the <code>PX PARTITION HASH</code> row source contains a nonpartitioned table <code>CUSTOMERS</code> that is distributed through <code>PX SEND PARTITION</code> to a different slave set that performs the join.</p>
<div class="infobox-note" id="GUID-8D44D783-651D-41BA-87B4-2021676C7F3F__GUID-A52CD2C3-EF62-45C2-9A09-D4F3F5ED0CFB">
<p class="notep1">Note:</p>
<p>The <code>Rows</code>, <code>Cost (%CPU)</code>, <code>Time</code>, and <code>TQ</code> columns were removed from the plan table output in this example.</p>
</div>
<div class="infobox-note" id="GUID-8D44D783-651D-41BA-87B4-2021676C7F3F__GUID-025AA221-0018-4857-8959-FA59D6181778">
<p class="notep1">Note:</p>
<p>This section is based on hash partitioning, but it also applies for range, list, and interval partial partition-wise joins.</p>
</div>
<p>Considerations for full partition-wise joins also apply to partial partition-wise joins:</p>
<ul style="list-style-type: disc;">
<li>
<p>The degree of parallelism does not need to equal the number of partitions. In the figure, the query executes with two sets of 16 query servers. In this case, Oracle assigns 1 partition to each query server of the second set. Again, the number of partitions should always be a multiple of the degree of parallelism.</p>
</li>
<li>
<p>In Oracle RAC environments on MPPs, each hash partition of <code>sales</code> should preferably have affinity to only one node to avoid remote I/Os. Also, spread partitions over all nodes to avoid bottlenecks and use all CPU resources available on the system. A node can host multiple partitions when there are more partitions than nodes.</p>
<div class="infoboxnotealso" id="GUID-8D44D783-651D-41BA-87B4-2021676C7F3F__GUID-697A500C-D16D-4C74-96FC-2D89CFA6E634">
<p class="notep1">See Also:</p>
<p><a class="olink RACAD1111" target="_blank" href="../RACAD/GUID-5A1B02A2-A327-42DD-A1AD-20610B2A9D92.htm#RACAD1111"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for more information about data affinity</p>
</div>
</li>
</ul>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2957">
<tr>
<td class="cellalignment2964">
<table class="cellalignment2962">
<tr>
<td class="cellalignment2961"><a href="GUID-34563811-55B5-4ABF-8960-F225AB3CC240.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2961"><a href="GUID-5B63C8B9-2CF8-4411-AA07-5979AD7104BA.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2008, 2016, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2966">
<table class="cellalignment2960">
<tr>
<td class="cellalignment2961"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2961"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2961"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2961"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2961"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2961"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>