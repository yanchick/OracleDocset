<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-114124"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Downgrading%20Oracle%20Database%20to%20an%20Earlier%20Release"></a><title>Downgrading Oracle Database to an Earlier Release</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1091"/>
<meta name="dcterms.created" content="2017-07-10T11:50:4Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Upgrade Guide"/>
<meta name="dcterms.identifier" content="E41397-13"/>
<meta name="dcterms.isVersionOf" content="UPGRD"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2002, 2017,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="app.htm" title="Previous" type="text/html"/>
<link rel="Next" href="expimp.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41397-13.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">10/14</span> <!-- End Header -->
<div id="UPGRD007" class="chapter"><a id="CACGBHDB"></a> <a id="i1010243"></a>
<h1 class="chapter"><span class="secnum">6</span> Downgrading Oracle Database to an Earlier Release</h1>
<p>For supported releases of Oracle Database, you can downgrade a database to the release from which you last upgraded. For example, if you recently upgraded from release 11.2.0.4 to Oracle Database 12<span class="italic">c</span>, and you did not change the compatible initialization parameter to 12.1 or higher, then you can downgrade to release 11.2.0.4. If your Oracle Database 12<span class="italic">c</span> is release 12.1.0.2, and you did not change the compatible initialization parameter to 12.1.0.2, then you can downgrade to release 12.1.0.1 and so forth.</p>
<p>This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#i1010267">Supported Releases for Downgrading Oracle Database</a></p>
</li>
<li>
<p><a href="#i1010279">Checking for Incompatibilities When Downgrading Oracle Database</a></p>
</li>
<li>
<p><a href="#i1010298">Performing a Full Backup Before Downgrading Oracle Database</a></p>
</li>
<li>
<p><a href="#CACEFBIB">Performing Required Pre-Downgrade Steps for Oracle Database</a></p>
</li>
<li>
<p><a href="#i1010311">Downgrading a CDB or Non-CDB Oracle Database</a></p>
</li>
<li>
<p><a href="#CACJBADJ">Downgrading a Single Pluggable Oracle Database (PDB)</a></p>
</li>
<li>
<p><a href="#BABJAGHA">Post-Downgrade Tasks for Oracle Database Downgrades</a></p>
</li>
<li>
<p><a href="#CACGFHDC">Troubleshooting the Downgrade of Oracle Database</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1"><span class="bold">See Also</span>:</p>
<a class="olink GINST" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=GINST"><span class="italic">Oracle Database Installation Guide</span></a> for your operating system for discussions of downgrading that are operating system-specific</div>
<a id="i1010267"></a>
<div id="UPGRD00710" class="sect1">
<h2 class="sect1"><span class="secnum">6.1</span> Supported Releases for Downgrading Oracle Database</h2>
<p>You can downgrade both major releases and patchset releases<a id="sthref560"></a><a id="sthref561"></a>, based on the original Oracle Database release from which the database was upgraded. Major release downgrades are supported back to Oracle Database 11<span class="italic">g</span> Release 2 (11.2.0.2) and subsequent 11.2 releases, and Oracle Database 11<span class="italic">g</span> Release 1 (11.1.0.7). Patchset downgrades are supported back to Oracle Database release 11.2 patchsets, except release 11.2.0.1.</p>
<p><a href="#CACGDDHC">Table 6-1</a> provides a summary of releases supported for downgrading. When using this table, also read about compatibility in <a href="#i1010279">&#34;Checking for Incompatibilities When Downgrading Oracle Database.&#34;</a></p>
<div class="tblformal">
<p class="titleintable"><a id="sthref562"></a><a id="CACGDDHC"></a>Table 6-1 Supported Releases and Editions for Downgrading</p>
<table class="cellalignment1841" title="Supported Releases and Editions for Downgrading" summary="This table is described in the following notes and bullet points." dir="ltr">
<thead>
<tr class="cellalignment1828">
<th class="cellalignment1838" id="r1c1-t3">Oracle Database Release or Edition</th>
<th class="cellalignment1838" id="r1c2-t3">Downgradable?</th>
<th class="cellalignment1838" id="r1c3-t3">Notes</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r2c1-t3" headers="r1c1-t3">
<p>12.1.0.2</p>
</td>
<td class="cellalignment1834" headers="r2c1-t3 r1c2-t3">
<p>Y</p>
</td>
<td class="cellalignment1834" headers="r2c1-t3 r1c3-t3">
<p>You cannot downgrade a database once you have set the compatible initialization parameter to 12.1.0.2.</p>
<p>Only if the compatibility is set to 12.1.0.1 will a downgrade be possible for a pluggable database (PDB).</p>
<p>The patch set update PSU4 is required in order to downgrade a CDB, or unplug and downgrade a PDB. PSUs are available for download on My Oracle Support (MOS) at <code dir="ltr"><a href="https://support.oracle.com/">https://support.oracle.com/</a></code>. See MOS Note 756671.1 to obtain the latest patch set and any required set of additional fixes. (Search in the general search box on the Patches and Updates page.)</p>
<p>You cannot downgrade back to release 10.2.0.5 because the minimum compatibility setting for Oracle Database 12c is 11.0.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r3c1-t3" headers="r1c1-t3">
<p>12.1.0.1</p>
</td>
<td class="cellalignment1834" headers="r3c1-t3 r1c2-t3">
<p>Y</p>
</td>
<td class="cellalignment1834" headers="r3c1-t3 r1c3-t3">
<p>If you unplug a 12.1.0.1 PDB from a 12.1.0.1 database and then plug this PDB into a 12.1.0.2 database for upgrade, then you cannot downgrade this PDB if the compatible initialization parameter in the 12.1.0.2 database is higher than &#39;12.1.0.1.0&#39;.</p>
<p>You cannot downgrade back to release 10.2.0.5 because the minimum compatibility setting for Oracle Database 12<span class="italic">c</span> is 11.0.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r4c1-t3" headers="r1c1-t3">
<p>Oracle Enterprise Manager</p>
</td>
<td class="cellalignment1834" headers="r4c1-t3 r1c2-t3">
<p>N</p>
</td>
<td class="cellalignment1834" headers="r4c1-t3 r1c3-t3">
<p>You must reconfigure Oracle Enterprise Manager controls if you downgrade to an earlier supported release. See <a href="#CACFBHCB">&#34;Restoring Oracle Enterprise Manager after Downgrading Oracle Database.&#34;</a></p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r5c1-t3" headers="r1c1-t3">
<p>Oracle Database Express Edition</p>
</td>
<td class="cellalignment1834" headers="r5c1-t3 r1c2-t3">
<p>N</p>
</td>
<td class="cellalignment1834" headers="r5c1-t3 r1c3-t3">
<p>You cannot downgrade a database that was upgraded from Oracle Database Express Edition</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" -->
<div class="infoboxnotewarn">
<p class="notep1">Important:</p>
<p class="warnsp">The following information is very important to understand regarding compatibility if you expect to be able to downgrade.</p>
<ul>
<li>
<p class="warnsp">You cannot downgrade a database once you have set the compatible initialization parameter to 12.1.0.2.</p>
</li>
<li>
<p class="warnsp">Only if the compatibility is set to 12.1.0.1 will a downgrade be possible for a pluggable database (PDB).</p>
</li>
<li>
<p class="warnsp">If you unplug a release 12.1.0.1 PDB from a 12.1.0.1 database and then plug this PDB into a release 12.1.0.2 database, you cannot downgrade this PDB.</p>
</li>
<li>
<p class="warnsp">PSU4 (that is <span class="italic">patch set update</span>) is required in order to downgrade a CDB or unplug and downgrade a PDB. See MOS Note 756671.1 to obtain the latest patch set, and any required set of additional fixes, at My Oracle Support (MOS) at <code dir="ltr"><a href="https://support.oracle.com/">https://support.oracle.com/</a></code></p>
</li>
</ul>
</div>
<div class="infobox-note">
<p class="notep1">Note:</p>
You cannot downgrade back to release 10.2.0.5 because the minimum compatibility setting for Oracle Database 12<span class="italic">c</span> is 11.0. Additionally, you cannot downgrade a database that was upgraded from Oracle Database Express Edition.</div>
<p>The following recommendations for earlier supported releases affect downgrading for Oracle Database:</p>
<ul>
<li>
<p><span class="bold">This release includes multitenant architecture, which provides features for a multitentant container database (CDB) and pluggable databases (PDBs). Therefore, setting the compatible initialization parameter to the highest level after upgrading to this release prevents the capability to downgrade.</span></p>
</li>
<li>
<p>This release contains a new object privilege, <code dir="ltr">READ</code>, in addition to <code dir="ltr">SELECT</code>. After you downgrade:</p>
<ul>
<li>
<p>If you have the <code dir="ltr">SELECT</code> and <code dir="ltr">READ</code> object privileges, the <code dir="ltr">READ</code> privilege is removed.</p>
</li>
<li>
<p>If you only had the <code dir="ltr">READ</code> object privilege, then this is transformed into the <code dir="ltr">SELECT</code> object privilege.</p>
</li>
</ul>
<p>See <a class="olink DBSEG992" href="../DBSEG/authorization.htm#DBSEG992"><span class="italic">Oracle Database Security Guide</span></a> for information about the <code dir="ltr">READ</code> and <code dir="ltr">SELECT</code> object privileges.</p>
</li>
<li>
<p>The earliest release that you can downgrade back to is Oracle Database release 11.1.0.7. Because the minimum compatibility for Oracle Database 12<span class="italic">c</span> is 11.0, after you upgrade to release 12.1, the compatibility must be set to at least 11.0. Once compatibility is set, this changes the on-disk structure of the database and enables new features that are controlled by the compatible setting. Therefore, downgrade to a release earlier than 11.1.0.7 is no longer an option.</p>
</li>
<li>
<p>If Oracle XML DB was not present in the database to be upgraded, then Oracle XML DB is uninstalled during the downgrade. For example, if you did not install Oracle XML DB with Oracle Database 11<span class="italic">g</span> Release 2 (11.2), then when upgrading to Oracle Database 12<span class="italic">c</span>, Oracle XML DB is installed because it is included with this release. During a downgrade back to Oracle Database 11<span class="italic">g</span> Release 2 (11.2), Oracle XML DB is removed.</p>
</li>
<li>
<p>During upgrade to Oracle Database 12<span class="italic">c</span>, the Database (DB) Control repository is removed. If you downgrade, you must reconfigure the Database (DB) Control to use it again in the earlier, downgraded release. See <a href="preup.htm#BABDDCCI">&#34;Saving Oracle Enterprise Manager Database Control Configuration and Data.&#34;</a></p>
</li>
<li>
<p>Downgrade is not supported for Oracle Enterprise Manager. You must reconfigure Oracle Enterprise Manager controls if you downgrade to an earlier supported release. See <a href="#CACFBHCB">&#34;Restoring Oracle Enterprise Manager after Downgrading Oracle Database.&#34;</a></p>
</li>
<li>
<p>Oracle Clusterware for Oracle Database 12<span class="italic">c</span> does not support downgrading to Oracle Database release 10.2 and release 11.1 on Windows. A fresh install is required for releases earlier than release 11.2.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="intro.htm#BHCJFHFG">&#34;Oracle Database Releases That Support Direct Upgrade&#34;</a></div>
</div>
<!-- class="sect1" -->
<a id="i1010279"></a>
<div id="UPGRD12554" class="sect1">
<h2 class="sect1"><span class="secnum">6.2</span> Checking for Incompatibilities When Downgrading Oracle Database<a id="sthref563"></a><a id="sthref564"></a><a id="sthref565"></a></h2>
<p>Check the compatibility level of your database to see if the database might have incompatibilities that prevent you from downgrading. If the compatibility level of your Oracle Database 12<span class="italic">c</span> database is <code dir="ltr">12.1.0</code>, then you are not able to downgrade.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="intro.htm#BHCCDCAA">&#34;Checking the Compatibility Level of Oracle Database&#34;</a></div>
<p>If you are downgrading to Oracle Database 11<span class="italic">g</span> Release 2 (11.2.0.2), Oracle Database 11<span class="italic">g</span> Release 2 (11.2.0.3), or Oracle Database 11<span class="italic">g</span> Release 2 (11.2.0.4), then the <code dir="ltr">COMPATIBLE</code> initialization parameter must be set to <code dir="ltr">11.2.0</code> or lower. Downgrading to release 11.2.0.1 is not supported.</p>
<p>If you are downgrading to Oracle Database 11<span class="italic">g</span> Release 1 (11.1.0.7), then the <code dir="ltr">COMPATIBLE</code> initialization parameter must be set to <code dir="ltr">11.1.0</code> or lower. Only downgrading to release 11.1.0.7 is supported for Oracle Database 11<span class="italic">g</span> Release 1.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
For Oracle ASM disk groups, if you changed disk group compatibility to 12.1.0.0.0 when you upgraded your database, then when you downgrade to the earlier release you will be unable to mount your Oracle ASM disk groups.
<p>You must manually restore compatibility of Oracle ASM disk groups before downgrade. Otherwise, the instance cannot mount the disk groups after downgrade.</p>
<p>See <a class="olink OSTMG02700" href="../OSTMG/GUID-FBB5AA72-5208-48E1-BD8D-0FD4C6876F34.htm#OSTMG02700"><span class="italic">Oracle Automatic Storage Management Administrator&#39;s Guide</span></a> for information about Oracle ASM disk group compatibility.</p>
</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="intro.htm#i883686">&#34;About Downgrading and Compatibility for Upgrading Oracle Database&#34;</a> and <a href="changes.htm#BABHACIE">Appendix A, &#34;Changes for Earlier Releases of Oracle Database&#34;</a></div>
</div>
<!-- class="sect1" -->
<a id="i1010298"></a>
<div id="UPGRD12555" class="sect1">
<h2 class="sect1"><span class="secnum">6.3</span> Performing a Full Backup Before Downgrading Oracle Database<a id="sthref566"></a><a id="sthref567"></a></h2>
<p>Oracle strongly recommends that you perform a full backup of your Oracle Database 12<span class="italic">c</span> database before you downgrade to a supported earlier releases.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink BRADV8003" href="../BRADV/rcmbckba.htm#BRADV8003"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> for information about performing RMAN backups</div>
</div>
<!-- class="sect1" -->
<a id="CACEFBIB"></a>
<div id="UPGRD60142" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">6.4</span> Performing Required Pre-Downgrade Steps for Oracle Database</h2>
<p>Before downgrading to the earlier release from which you upgraded, you must complete required preparation. For example, you may need to determine if components in the database must be disabled first.</p>
<p>To prepare for downgrading:</p>
<ol>
<li>
<p>If you are downgrading a CDB or unplugging and downgrading a PDB in Oracle Database release 12.1.0.2, then you must first apply PSU4 (patch set update 4). You obtain PSU4 and any required set of additional fixes by going to My Oracle Support at <code dir="ltr"><a href="https://support.oracle.com/">https://support.oracle.com/</a></code>. The patch set information and link is contained in MOS Note 756671.1. Search for 756671.1 in the general search box on the Patches and Updates page. This is a requirement before you can downgrade.</p>
</li>
<li>
<p>If you are downgrading to Oracle Database release 11.1, then before starting the downgrade procedures, ensure that you know the password for any newly-created database links. These are database links that you may have created while running releases 11.2 or 12.1. Knowing the database link password is necessary because you will need to reset the database link password after downgrading to Oracle Database release 11.1. See <a href="#CACEIDHE">&#34;Issue with Password for Database Links After Downgrading&#34;</a> for more information.</p>
</li>
<li>
<p>If you have enabled Oracle Database Vault on your database, then disable Oracle Database Vault before downgrading the database.</p>
<p>To find if Oracle Database Vault is enabled, query the <code dir="ltr">V$OPTION</code> dynamic view as follows:</p>
<p>Enter <code dir="ltr">Oracle Database Vault</code> in the case shown in this query. If the output is <code dir="ltr">TRUE</code>, then Oracle Database Vault is enabled, so you must disable it. See <a class="olink DVADM012" href="../DVADM/dvdisabl.htm#DVADM012"><span class="italic">Oracle Database Vault Administrator&#39;s Guide</span></a> for instructions.</p>
</li>
<li>
<p>If your database uses Oracle Label Security <span class="bold">and</span> you are downgrading to release 11.2 or earlier, then run the Oracle Label Security (OLS) preprocess downgrade <code dir="ltr">olspredowngrade.sql</code> script in the new Oracle Database 12<span class="italic">c</span> Oracle home. You do not need to run <code dir="ltr">olspredowngrade.sql</code> if you are downgrading release 12.1.0.2 to release 12.1.0.1.</p>
<div class="infobox-note">
<p class="notep1">Important:</p>
Running the <code dir="ltr">olspredowngrade.sql</code> script before downgrading is mandatory for downgrading from Oracle Database 12<span class="italic">c</span> to database release 11.2 (and earlier) in databases that use Oracle Label Security and Oracle Database Vault.</div>
<ol>
<li>
<p>To find out if Oracle Label Security is enabled, query the <code dir="ltr">V$OPTION</code> dynamic view as follows:</p>
<pre dir="ltr">SQL&gt; SELECT VALUE FROM V$OPTION WHERE PARAMETER = &#39;Oracle Label Security&#39;;
</pre></li>
<li>
<p>Run the <code dir="ltr">olspredowngrade.sql</code> script.</p>
<pre dir="ltr">SQL&gt; @<span class="italic">ORACLE_HOME</span>/rdbms/admin/olspredowngrade.sql
</pre>
<p>See <a class="olink OLSAG3416" href="../OLSAG/utilities.htm#OLSAG3416"><span class="italic">Oracle Label Security Administrator&#39;s Guide</span></a> for more information.</p>
</li>
</ol>
</li>
<li>
<p>If you have enabled unified auditing, then optionally back up and purge the unified audit trail.</p>
<ol>
<li>
<p>Find if unified audit records exist.</p>
</li>
<li>
<p>Back up the existing audit data to a table. For example:</p>
<pre dir="ltr">SQL&gt; CREATE TABLE UA_DATA AS (SELECT * FROM V$UNIFIED_AUDIT_TRAIL);
</pre></li>
<li>
<p>Clean up the audit trail.</p>
<pre dir="ltr">EXEC DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL(audit_trail_type =&gt; DBMS_AUDIT_MGMT.AUDIT_TRAIL_UNIFIED, use_last_arch_timestamp =&gt; FALSE);
</pre></li>
</ol>
</li>
<li>
<p>If you previously installed a recent version of the time zone file and used the <code dir="ltr">DBMS_DST</code> PL/SQL package to upgrade <code dir="ltr">TIMESTAMP</code> <code dir="ltr">WITH</code> <code dir="ltr">TIME</code> <code dir="ltr">ZONE</code> data to that version, then install the same version of the time zone file in the release to which you are downgrading. If after the database upgrade, you had used <code dir="ltr">DBMS_DST</code> to upgrade the <code dir="ltr">TIMESTAMP</code> <code dir="ltr">WITH</code> <code dir="ltr">TIME</code> <code dir="ltr">ZONE</code> data to the latest version of the time zone file, then install this latest version time zone file in the release to which you are downgrading. This ensures that your <code dir="ltr">TIMESTAMP</code> <code dir="ltr">WITH</code> <code dir="ltr">TIME</code> <code dir="ltr">ZONE</code> data is not logically corrupted during retrieval.</p>
<p>To find which timze zone file version your database is currently using, query <code dir="ltr">V$TIMEZONE_FILE</code> as follows:</p>
<pre dir="ltr">SQL&gt; select * from  V$TIMEZONE_FILE;
</pre>
<p>Copy the time zone files from the current Oracle home to the Orache home to which you are downgrading. For example, after you see the results of your query, you might choose from the following:</p>
<pre dir="ltr">%ORACLE_HOME%\oracore\zoneinfo\timezlrg_18.dat
%ORACLE_HOME%\oracore\zoneinfo\timezone_18.dat
</pre>
<p>See <a class="olink NLSPG259" href="../NLSPG/ch4datetime.htm#NLSPG259"><span class="italic">Oracle Database Globalization Support Guide</span></a> for more information on upgrading time zone files, and <a class="olink ARPLS234" href="../ARPLS/d_dst.htm#ARPLS234"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the <code dir="ltr">DBMS_DST</code> package.</p>
</li>
<li>
<p>If you set the <code dir="ltr">ORA_TZFILE</code> environment variable to the full path name of the time zone file when you upgraded to Oracle Database 12<span class="italic">c</span>, then you must unset it if you subsequently downgrade your database.</p>
<p><a id="sthref568"></a><a id="sthref569"></a>Two time zone files are included in the Oracle home directory:</p>
<ul>
<li>
<p>The default time zone file, which is for the database server, at</p>
<pre dir="ltr">$ORACLE_HOME/oracore/zoneinfo/timezonelrg.dat
</pre></li>
<li>
<p>A smaller time zone file, which is typically used for clients, at</p>
<pre dir="ltr">$ORACLE_HOME/oracore/zoneinfo/timezone.dat
</pre></li>
</ul>
<p>If you do not unset the <code dir="ltr">ORA_TZFILE</code> variable, then connecting to the database using the smaller time zone file might produce the following errors:</p>
<pre dir="ltr">SP2-1503: Unable to initialize Oracle call interface
SP2-0152: ORACLE may not be functioning properly
</pre>
<p>See <a class="olink NLSPG004" href="../NLSPG/ch4datetime.htm#NLSPG004"><span class="italic">Oracle Database Globalization Support Guide</span></a> for more information about date and time data types and time zone support.</p>
</li>
<li>
<p>Optional: If you are downgrading to Oracle Database 11<span class="italic">g</span> Release 1 (11.1.0.7) and you have Oracle Application Express in your database, then you must copy the <code dir="ltr">apxrelod.sql</code> file<a id="sthref570"></a><a id="sthref571"></a> from the Oracle Database 12<span class="italic">c</span> <code dir="ltr">ORACLE_HOME/apex/</code> directory to a directory outside of the Oracle home, such as a temporary directory on your system.</p>
<p>Make a note of the new location of this file. You need this later in the procedure.</p>
</li>
<li>
<p>If you have created objects based on fixed objects, then drop these objects to avoid possible <code dir="ltr">ORA-00600</code> errors. You can re-create these objects after the downgrade.</p>
</li>
<li>
<p>If you have Oracle Enterprise Manager configured in your database, then drop the Enterprise Manager user:</p>
<pre dir="ltr">DROP USER sysman CASCADE;
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
After this step, MGMT* synonyms may be invalid. You must reconfigure Oracle Enterprise Manager to use any Oracle Enterprise Manager controls in the downgraded database.</div>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="i1010311"></a>
<div id="UPGRD12556" class="sect1">
<h2 class="sect1"><span class="secnum">6.5</span> Downgrading a CDB or Non-CDB Oracle Database<a id="sthref572"></a><a id="sthref573"></a></h2>
<p>Oracle provides a procedure for downgrading your Oracle Database 12<span class="italic">c</span> database to a supported major release or a relevant patchset upgrade. If you are downgrading from release 12.1.0.2 or higher to release 12.1.0.1, you can downgrade all databases in a multitenant container database (CDB) or one pluggable database (PDB) within a CDB. Oracle Database releases earlier than Oracle Database 12<span class="italic">c</span> did not use multitenant architecture. See <a href="#CACJBADJ">&#34;Downgrading a Single Pluggable Oracle Database (PDB)&#34;</a> for the procedure for downgrading one PDB.</p>
<p>The procedure in this section assumes that you understand <a href="#i1010267">&#34;Supported Releases for Downgrading Oracle Database.&#34;</a></p>
<p>To downgrade the database, whether a CDB or not, to an earlier supported release:</p>
<ol>
<li>
<p>Log in to the system as the owner of the Oracle Database 12<span class="italic">c</span> Oracle home directory.</p>
</li>
<li>
<p>At a system prompt, change to the <code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code><code dir="ltr">/rdbms/admin</code> directory, where <code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code> is the Oracle home on your system.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you are downgrading a cluster database, then shut down the database completely and change the <code dir="ltr">CLUSTER_DATABASE</code> initialization parameter to <code dir="ltr">FALSE</code>. After the downgrade, you must set this parameter back to <code dir="ltr">TRUE</code>.</div>
</li>
<li>
<p>Using SQL*Plus, connect to the database instance as a user with <code dir="ltr">SYSDBA</code> privileges.</p>
<pre dir="ltr">sqlplus sys as sysdba
Enter password: <span class="italic">password</span>
</pre></li>
<li>
<p>Log in to the system as the owner of the Oracle home under the new Oracle Database 12<span class="italic">c</span>.</p>
</li>
<li>
<p>From the <code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code><code dir="ltr">/rdbms/admin</code> directory, start SQL*Plus.</p>
</li>
<li>
<p>Connect to the database to be upgraded using an account with DBA privileges:</p>
<pre dir="ltr">CONNECT / AS SYSDBA
</pre></li>
<li>
<p>Start the instance in downgrade mode by issuing the following SQL*Plus command for your Oracle Database instance type. You may be required to use the <code dir="ltr">PFILE</code> option to specify the location of your initialization parameter file.</p>
<p>For Non-CDB instances:</p>
<pre dir="ltr">SQL&gt; startup downgrade pfile=<span class="codeinlineitalic">pfile_name</span>
</pre>
<p>For CDB instances:</p>
<pre dir="ltr">SQL&gt; startup downgrade pfile=pfile_name
SQL&gt; alter pluggable database all open downgrade;
</pre>
<p>Specify the location of your initialization parameter file <code dir="ltr">PFILE</code>. See <a class="olink ADMIN12825" href="../ADMIN/start.htm#ADMIN12825"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about specifying initialization parameters at startup and the initialization parameter file.</p>
</li>
<li id="i1010335">
<p>Optional: If you are downgrading a non-CDB, you can set the system to spool results to a log file so you can track the changes and issues. (A CDB automatically spools output to the catcon_logs; therefore, you can skip this step for a CDB.)</p>
<pre dir="ltr">SQL&gt; SPOOL downgrade.log
</pre></li>
<li>
<p><a id="sthref574"></a><a id="sthref575"></a>Run <code dir="ltr"><a id="sthref576"></a>catdwgrd.sql</code>.</p>
<p>For a non-CDB:</p>
<pre dir="ltr">SQL&gt; @catdwgrd.sql
</pre>
<p>For a CDB:</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl $ORACLE_HOME/rdbms/admin/catcon.pl -d 
 $ORACLE_HOME/rdbms/admin -e -b catdwgrd -l &lt;output directory&gt; -r 
 catdwgrd.sql
</pre>
<p>In the CDB example <code dir="ltr">catcon.pl</code> is run with <code dir="ltr">catdwgrd</code>. You first start PERL. The -d parameter tells <code dir="ltr">catcon.pl</code> where to find <code dir="ltr">catdwgrd</code>. The -l parameter specifies the output directory for log files (instead of writing to the rdbms/admin directory). You must use the <code dir="ltr">-r</code> parameter to run the two scripts together.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<ul>
<li>
<p>You must use the version of the <code dir="ltr"><a id="sthref577"></a>catdwgrd.sql</code> script included with Oracle Database 12<span class="italic">c</span>.</p>
</li>
<li>
<p>You must run <code dir="ltr"><a id="sthref578"></a>catdwgrd.sql</code> in the Oracle Database 12<span class="italic">c</span> environment.</p>
</li>
<li>
<p>You must specify the <code dir="ltr">-r</code> parameter in order to run the two scripts together at the same time.</p>
</li>
<li>
<p>The <code dir="ltr"><a id="sthref579"></a>catdwgrd.sql</code> script downgrades all Oracle Database components in the database to the supported major release or patch release from which you originally upgraded.</p>
</li>
</ul>
</div>
<p><a id="sthref580"></a><a id="sthref581"></a>If you encounter any problems when you run the <code dir="ltr"><a id="sthref582"></a>catdwgrd.sql</code> script, or any of the scripts in the remaining steps, then correct the causes of the problems and rerun the script. You can rerun any of the scripts described in this chapter as many times as necessary.</p>
<div class="infobox-note">
<p class="notep1">Caution:</p>
If the downgrade for a component fails, then an <code dir="ltr">ORA-39709</code> error is displayed and the SQL*Plus session terminates without downgrading the Oracle Database data dictionary. All components must be successfully downgraded before the Oracle Database data dictionary is downgraded. You must identify and fix the problem before rerunning the <code dir="ltr">catdwgrd.sql</code> script.</div>
</li>
<li>
<p>For non-CDB only, turn off the spooling of script results to the log file:</p>
<pre dir="ltr">SQL&gt; SPOOL OFF
</pre>
<p>Then, check the spool file and verify that there were no errors generated during the downgrade. You named the spool file in Step&nbsp;<a href="#i1010335">8</a> and the suggested name was <code dir="ltr">downgrade.log</code>. Correct any problems you find in this file and rerun the downgrade script if necessary.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you want to save the results of the first time you ran the downgrade script, then before you rerun it be sure to rename <code dir="ltr">downgrade.log</code> to something else.</div>
</li>
<li>
<p>Shut down the instance:</p>
<pre dir="ltr">SQL&gt; SHUTDOWN IMMEDIATE
</pre></li>
<li>
<p>Exit SQL*Plus.</p>
</li>
<li>
<p>If your operating system is Linux or UNIX, then change the following environment variables to point to the directories of the release to which you are downgrading:</p>
<ul>
<li>
<p><code dir="ltr">ORACLE_HOME</code></p>
</li>
<li>
<p><code dir="ltr">PATH</code></p>
</li>
</ul>
<p>You should also check that your <code dir="ltr">oratab</code> file and any client scripts that set the value of <code dir="ltr">ORACLE_HOME</code> point to the downgraded Oracle home.</p>
<p>See <a class="olink GINST" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=GINST"><span class="italic">Oracle Database Installation Guide</span></a> for your operating system for information about setting other important environment variables on your operating system.</p>
</li>
<li>
<p>If your operating system is Windows, then complete the following steps:</p>
<ol>
<li>
<p>Stop all Oracle services, including the <code dir="ltr">OracleService</code><code dir="ltr"><span class="codeinlineitalic">SID</span></code> Oracle service of the Oracle Database 12<span class="italic">c</span> database, where <code dir="ltr"><span class="codeinlineitalic">SID</span></code> is the instance name.</p>
<p>For example, if your <span class="italic">SID</span> is ORCL, then enter the following at a command prompt:</p>
<pre dir="ltr">C:\&gt; NET STOP OracleServiceORCL
</pre>
<p>See <a class="olink NTQRF206" href="../NTQRF/admin.htm#NTQRF206"><span class="italic">Oracle Database Platform Guide for Microsoft Windows</span></a> for more information about stopping Oracle services on Windows.</p>
</li>
<li>
<p>Delete the Oracle service at a command prompt by issuing the <code dir="ltr">ORADIM</code> command.</p>
<p>For example, if your <span class="italic">SID</span> is ORCL, then enter the following command:</p>
<pre dir="ltr">C:\&gt; ORADIM -DELETE -SID ORCL
</pre></li>
<li>
<p><a id="sthref583"></a><a id="sthref584"></a>Create the Oracle service of the database that you are downgrading at a command prompt using the <code dir="ltr">ORADIM</code> command.</p>
<pre dir="ltr">C:\&gt; ORADIM -NEW -SID <span class="italic">SID</span> -INTPWD <span class="italic">PASSWORD</span> -MAXUSERS <span class="italic">USERS</span>
-STARTMODE MANUAL -PFILE <span class="italic">ORACLE_HOME</span>\DATABASE\INIT<span class="italic">SID</span>.ORA
</pre>
<p>See <a class="olink NTQRF05011" href="../NTQRF/create.htm#NTQRF05011"><span class="italic">Oracle Database Platform Guide for Microsoft Windows</span></a> for information about administering an Oracle Database instance using <code dir="ltr">ORADIM</code>. The syntax for <code dir="ltr">ORADIM</code> includes the following variables:</p>
<div class="inftblinformal">
<table class="cellalignment1837" title="ORADIM Syntax" summary="This table is described in the preceding text" dir="ltr">
<thead>
<tr class="cellalignment1828">
<th class="cellalignment1838" id="r1c1-t17">Variable</th>
<th class="cellalignment1838" id="r1c2-t17">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r2c1-t17" headers="r1c1-t17"><code dir="ltr"><span class="codeinlineitalic">SID</span></code></td>
<td class="cellalignment1834" headers="r2c1-t17 r1c2-t17">Same SID name as the SID of the database being downgraded.</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r3c1-t17" headers="r1c1-t17"><code dir="ltr"><span class="codeinlineitalic">PASSWORD</span></code></td>
<td class="cellalignment1834" headers="r3c1-t17 r1c2-t17">Password for the database instance. This is the password for the user connected with <code dir="ltr">SYSDBA</code> privileges. The -<code dir="ltr">INTPWD</code> option is not required. If you are prompted for a password, use the password for the standard user account for this Windows platform.</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r4c1-t17" headers="r1c1-t17"><code dir="ltr"><span class="codeinlineitalic">USERS</span></code></td>
<td class="cellalignment1834" headers="r4c1-t17 r1c2-t17">Maximum number of users who can be granted <code dir="ltr">SYSDBA</code> and <code dir="ltr">SYSOPER</code> privileges.</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r5c1-t17" headers="r1c1-t17"><code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code></td>
<td class="cellalignment1834" headers="r5c1-t17 r1c2-t17">Oracle home directory of the database to which you are downgrading. Ensure that you specify the full path name with the <code dir="ltr">-PFILE</code> option, including drive letter of the Oracle home directory. See <a class="olink ADMIN12825" href="../ADMIN/start.htm#ADMIN12825"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about specifying initialization parameters at startup and the initialization parameter file.</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblinformal" -->
<p>For example, if your <span class="italic">SID</span> is <code dir="ltr">ORCL</code>, your <span class="italic">PASSWORD</span> is <code dir="ltr">TWxy5791</code>, the maximum number of <span class="italic">USERS</span> is 10, and the <span class="italic">ORACLE_HOME</span> directory is C:\ORANT, then enter the following command:</p>
<pre dir="ltr">C:\&gt; ORADIM -NEW -SID ORCL -INTPWD TWxy5791 -MAXUSERS 10
     -STARTMODE MANUAL -PFILE C:\ORANT\DATABASE\INITORCL.ORA
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
The <code dir="ltr">ORADIM</code> command prompts you for the password for the Oracle home user account. You can specify other options using <code dir="ltr">ORADIM</code>.
<p>You are not required to change any Windows Registry settings when downgrading a database. The <code dir="ltr">ORADIM</code> utility makes all necessary changes automatically.</p>
</div>
</li>
</ol>
</li>
<li>
<p>Restore the configuration files (for example, parameter files, password files, and so on) of the release to which you are downgrading.</p>
<p>If this is an Oracle RAC database, execute the following command to return the database to single instance mode:</p>
<pre dir="ltr">SET CLUSTER_DATABASE=FALSE
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you are downgrading a cluster database, then perform this step on all nodes on which this cluster database has instances configured. Set the <code dir="ltr">CLUSTER_DATABASE</code> initialization parameter to <code dir="ltr">FALSE</code>. After the downgrade, you must set this initialization parameter back to <code dir="ltr">TRUE</code>.
<p>See <a class="olink RACAD017" href="../RACAD/GUID-59DEC066-5743-4EDE-9A02-E8896005F658.htm#RACAD017"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for information about initialization parameter use in Oracle RAC.</p>
</div>
</li>
<li>
<p>At a system prompt, change to the <code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code><code dir="ltr">/rdbms/admin</code> directory of the earlier release to which you are downgrading.</p>
</li>
<li id="i1010463">
<p>Start SQL*Plus and connect to the database instance as a user with <code dir="ltr">SYSDBA</code> privileges.</p>
<p>For a non-CDB:</p>
<pre dir="ltr">SQL&gt; CONNECT / AS SYSDBA
SQL&gt; <a id="sthref585"></a><a id="sthref586"></a>STARTUP UPGRADE
</pre>
<p>For a CDB:</p>
<pre dir="ltr">connect / as sysdba
startup database mount;
alter database open upgrade;
alter pluggable database all open upgrade;
</pre></li>
<li id="i1010469">
<p>Optional: For a non-CDB, set the system to spool results to a log file to track changes and issues. This step is not needed for a CDB.</p>
<pre dir="ltr">SQL&gt; SPOOL reload.log
</pre></li>
<li>
<p>Run <code dir="ltr">catrelod.sql</code>.</p>
<p>For a non-CDB:</p>
<pre dir="ltr"><a id="sthref587"></a><a id="sthref588"></a>SQL&gt; @catrelod.sql
</pre>
<p>For a CDB:</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl catcon.pl -n 1 -e -b catrelod -d &#39;&#39;&#39;.&#39;&#39;&#39; catrelod.sql
</pre>
<p>The <code dir="ltr">catrelod.sql</code> script reloads the appropriate version for each of the database components in the downgraded database.</p>
</li>
<li>
<p>If you are downgrading to Oracle Database 11<span class="italic">g</span> Release 1 (11.1.0.7) and you have Oracle Application Express in your database, then change to the directory to which you had copied the <code dir="ltr">apxrelod.sql</code> script. Manually reload Oracle Application Express by running the <code dir="ltr">apxrelod.sql</code> script:</p>
<pre dir="ltr">SQL&gt; @apxrelod.sql
</pre>
<p>Running the <code dir="ltr">apxrelod.sql</code> script avoids package <code dir="ltr">APEX_030200.WWV_FLOW_HELP</code> being <code dir="ltr">INVALID</code> due to the following error:</p>
<pre dir="ltr">PLS-00201: identifier &#39;CTX_DDL&#39; must be declared
</pre></li>
<li>
<p>If you had turned spooling on for a non-CDB, now turn off the spooling of script results to the log file:</p>
<pre dir="ltr">SQL&gt; SPOOL OFF
</pre>
<p>Then, check the spool file and verify that the packages and procedures compiled successfully. Correct any problems you find in this log file and rerun the appropriate script if necessary.</p>
</li>
<li>
<p>Shut down and restart the instance for normal operation:</p>
<pre dir="ltr">SQL&gt; SHUTDOWN IMMEDIATE
SQL&gt; STARTUP
</pre>
<p>You might be required to use the <code dir="ltr">PFILE</code> option to specify the location of your initialization parameter file. See <a class="olink ADMIN12825" href="../ADMIN/start.htm#ADMIN12825"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about specifying initialization parameters at startup and the initialization parameter file.</p>
</li>
<li>
<p>Perform this step if the database is configured for Oracle Label Security.</p>
<ol>
<li>
<p>Copy the <code dir="ltr">olstrig.sql</code> script from the Oracle home under Oracle Database 12<span class="italic">c</span> to the Oracle home of the release to which the database is to be downgraded.</p>
</li>
<li>
<p>From the Oracle home of the release you are downgrading to, run <code dir="ltr">olstrig.sql</code> to re-create DML triggers on tables with Oracle Label Security policies:</p>
<pre dir="ltr">SQL&gt; @olstrig.sql
</pre>
<p>See <a class="olink OLSAG" href="../OLSAG/toc.htm"><span class="italic">Oracle Label Security Administrator&#39;s Guide</span></a> for more information about Oracle Label Security.</p>
</li>
</ol>
</li>
<li>
<p>Run the <code dir="ltr">utlrp.sql</code> script.</p>
<p>For a non-CDB:</p>
<pre dir="ltr">SQL&gt; @utlrp.sql
</pre>
<p>For a CDB run <a id="sthref589"></a><code dir="ltr">catcon.pl</code> to invoke <a id="sthref590"></a><a id="sthref591"></a><a id="sthref592"></a><code dir="ltr">utlrp.sql</code> to recompile any remaining stored PL/SQL and Java code. Use the following syntax:</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl catcon.pl -n 1 -e -b utlrp -d &#39;&#39;&#39;.&#39;&#39;&#39; utlrp.sql
</pre>
<p>The <code dir="ltr">utlrp.sql</code> script recompiles all existing PL/SQL modules that were previously in an <code dir="ltr">INVALID</code> state, such as packages, procedures, types, and so on. The log file <code dir="ltr">utlrp0.log</code> is generated with the results of the recompilations.</p>
</li>
<li>
<p>Exit SQL*Plus.</p>
</li>
<li>
<p>If you are downgrading a cluster database, then you must run the following command to downgrade the Oracle Clusterware database configuration:</p>
<pre dir="ltr">$ srvctl downgrade database -d <span class="italic">db-unique-name</span> -o <span class="italic">oraclehome</span> -<span class="italic">t to_version</span>
</pre>
<p>[where <code dir="ltr"><span class="codeinlineitalic">db-unique-name</span></code> is the database name (not the instance name), <code dir="ltr"><span class="codeinlineitalic">oraclehome</span></code> is the location of the old Oracle home for the downgraded database, and <code dir="ltr"><span class="codeinlineitalic">to_version</span></code> is the database release to which the database is downgraded. (For example: 11.2.0.3.0.)]</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Execute this command from the current Oracle Database 12<span class="italic">c</span> Oracle home, not from the Oracle home to which the database is being downgraded.</div>
</li>
</ol>
<p>Your database is now downgraded.</p>
</div>
<!-- class="sect1" -->
<a id="CACJBADJ"></a>
<div class="sect1">
<h2 class="sect1"><span class="secnum">6.6</span> Downgrading a Single Pluggable Oracle Database (PDB)</h2>
<p>If you are downgrading the latest release of Oracle Database 12<span class="italic">c</span>, you can downgrade one PDB without downgrading the whole CDB. For example, you can unplug a PDB from a release 12.1.0.2 CDB, downgrade it, and then plug it in to a release 12.1.0.1 CDB or convert the database to a standalone database.</p>
<p>The procedure in this section assumes that you understand <a href="#i1010267">&#34;Supported Releases for Downgrading Oracle Database.&#34;</a></p>
<dl>
<dd><a id="sthref593"></a></dd>
<dt class="seghead">Step 1&nbsp;&nbsp;&nbsp;Downgrade the PDB</dt>
<dd>
<p>In this step you downgrade the PDB to release 12.1.0.1.</p>
<ol>
<li>
<p>Start up the release 12.1.0.2 PDB in DOWNGRADE mode. The CDB can be in normal mode when you do this.</p>
<pre dir="ltr">SQL&gt; alter pluggable database CDB1_PDB1 open downgrade;
</pre></li>
<li>
<p>Downgrade the PDB by running <code dir="ltr">catdwgrd</code>, which in this example is <code dir="ltr">PDB1</code>.</p>
<p>Run <code dir="ltr">catdwgrd</code> as follows:</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl $ORACLE_HOME/rdbms/admin/catcon.pl -d
 $ORACLE_HOME/rdbms/admin -n 1 -l &lt;output directory&gt; -e -b catdwgrd -c &#39;PDB1&#39;
 catdwgrd.sql
</pre>
<p>In the example <code dir="ltr">catcon.pl</code> is run with <code dir="ltr">catdwgrd</code>. You first start PERL. The <code dir="ltr">-d</code> parameter tells <code dir="ltr">catcon.pl</code> where to find <code dir="ltr">catdwgrd</code>. The <code dir="ltr">-l</code> parameter specifies the output directory for log files (instead of writing to the rdbms/admin directory). You must use the <code dir="ltr">-r</code> parameter to run the two scripts together at the same time.</p>
</li>
<li>
<p>Close the PDB.</p>
</li>
</ol>
</dd>
<dd><a id="sthref594"></a></dd>
<dt class="seghead">Step 2&nbsp;&nbsp;&nbsp;Unplug the PDB from the CDB</dt>
<dd>
<p>In this step you unplug the downgraded PDB from the release 12.1.0.2 CDB.</p>
<ol>
<li>
<p>Connect to the 12.1.0.2 CDB.</p>
</li>
<li>
<p>Close the PDB to be unplugged.</p>
<pre dir="ltr">SQL&gt; alter pluggable database PDB1 close;
</pre></li>
<li>
<p>Unplug the downgraded 12.1.0.1 PDB.</p>
<pre dir="ltr">SQL&gt; alter pluggable database PDB1 unplug into &#39;<span class="italic">path</span>/PDB1.xml&#39;;
</pre>
<p>You will see <code dir="ltr">Pluggable database altered</code>.</p>
</li>
</ol>
</dd>
<dd><a id="sthref595"></a></dd>
<dt class="seghead">Step 3&nbsp;&nbsp;&nbsp;Plug in the Downgraded 12.1.0.1 PDB</dt>
<dd>
<p>In this step you plug the downgraded 12.1.0.1 PDB into the 12.1.0.1 CDB. To do this, you must create the PDB in this CDB. In this example, we create PDB1.</p>
<ol>
<li>
<p>Connect to the 12.1.0.1 CDB.</p>
</li>
<li>
<p>Plug in the 12.1.0.1 PDB.</p>
<pre dir="ltr">SQL&gt; create pluggable database PDB1 using &#39;<span class="italic">path</span>/PDB1.xml&#39;;
</pre>
<p>You will see <code dir="ltr">Pluggable database created</code>.</p>
</li>
<li>
<p>Open the PDB in upgrade mode in order to run the scripts shown in the subsequent steps in this procedure.</p>
<pre dir="ltr">SQL&gt; alter pluggable database PDB1 open upgrade;
</pre></li>
<li>
<p>Connect to the PDB:</p>
<pre dir="ltr">SQL&gt; alter session set container=PDB1;
</pre></li>
<li>
<p>Run <code dir="ltr">catrelod</code> in the PDB:</p>
<pre dir="ltr"><a id="sthref596"></a><a id="sthref597"></a>SQL&gt; @$ORACLE_HOME/rdbms/admin/catrelod.sql
</pre>
<p>The <code dir="ltr">catrelod.sql</code> script reloads the appropriate version for each of the database components in the downgraded database.</p>
</li>
<li>
<p>Run <code dir="ltr">utlrp</code> in the PDB:</p>
<pre dir="ltr">SQL&gt; @$ORACLE_HOME/rdbms/admin/utlrp.sql
</pre>
<p>The <code dir="ltr">utlrp.sql</code> script recompiles all existing PL/SQL modules that were previously in an <code dir="ltr">INVALID</code> state, such as packages, procedures, types, and so on.</p>
</li>
</ol>
</dd>
</dl>
</div>
<!-- class="sect1" -->
<a id="BABJAGHA"></a>
<div id="UPGRD12557" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">6.7</span> Post-Downgrade Tasks for Oracle Database Downgrades</h2>
<p>Additional tasks may be required after downgrading an Oracle database due to changes that affect compatibility, components, and supported protocols.</p>
<p>This section contains the following topics:</p>
<ul>
<li>
<p><a href="#CACIJDED">Oracle XML DB Authentication Recommendations for an Oracle Database Downgrade</a></p>
</li>
<li>
<p><a href="#CACDEAFD">Re-creating the Network Listener When Downgrading to Release 11.1.0.7</a></p>
</li>
<li>
<p><a href="#BABJCEJE">Re-enabling Oracle Database Vault after Downgrading Oracle Database</a></p>
</li>
<li>
<p><a href="#BABCIJFC">Restoration of the Configuration for Oracle Clusterware</a></p>
</li>
<li>
<p><a href="#CACFBHCB">Restoring Oracle Enterprise Manager after Downgrading Oracle Database</a></p>
</li>
<li>
<p><a href="#CACDDIIB">Restoring Oracle Application Express to the Earlier Version</a></p>
</li>
</ul>
<a id="CACIJDED"></a>
<div id="UPGRD52884" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.7.1</span> Oracle XML DB Authentication Recommendations for an Oracle Database Downgrade</h3>
<p>If you downgrade to a release that is earlier than Oracle Database 12<span class="italic">c</span>, in which digest authentication is not supported, digest authentication is disabled and made unavailable as an authentication choice. This affects HTTP authentication for Oracle XML DB Repository. If you did not take advantage of digest authentication and instead used the default configuration, then no further actions are necessary.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADXDB6110" href="../ADXDB/appaman.htm#ADXDB6110"><span class="italic">Oracle XML DB Developer&#39;s Guide</span></a> for information about authentication with Oracle XML DB for database installation, upgrade, and downgrade</div>
</div>
<!-- class="sect2" -->
<a id="CACDEAFD"></a>
<div id="UPGRD52749" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.7.2</span> Re-creating the Network Listener When Downgrading to Release 11.1.0.7</h3>
<p>If you are downgrading to Oracle Database 11<span class="italic">g</span> Release 1 (11.1.0.7), then you must re-create the listener after performing the downgrade steps. Run Oracle Net Manager to delete the old listener and create a new listener.</p>
<ul>
<li>
<p>To start Oracle Net Manager from the Oracle Enterprise Manager console, select <span class="bold">Service Management</span> from the Tools menu, then select <span class="bold">Oracle Net Manager</span>.</p>
</li>
<li>
<p>On Windows, select <span class="bold">Programs</span> from the Start menu, and then select <span class="bold">Oracle -</span> <span class="bolditalic">HOME_NAME</span>. Next, select <span class="bold">Configuration and Migration Tools</span>, and then <span class="bold">Net Manager</span>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink NETAG" href="../NETAG/toc.htm"><span class="italic">Oracle Database Net Services Administrator&#39;s Guide</span></a></div>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="BABJCEJE"></a>
<div id="UPGRD12559" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.7.3</span> Re-enabling Oracle Database Vault after Downgrading Oracle Database</h3>
<p>If you use Oracle Database Vault, then you may have been instructed to disable it before downgrading your database. To use Oracle Database Vault after downgrading, you must re-enable it.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink DVADM30031" href="../DVADM/getting_started.htm#DVADM30031"><span class="italic">Oracle Database Vault Administrator&#39;s Guide</span></a> for the complete procedure</div>
</div>
<!-- class="sect2" -->
<a id="BABCIJFC"></a>
<div id="UPGRD52664" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.7.4</span> Restoration of the Configuration for Oracle Clusterware</h3>
<p>You can restore the Oracle Clusterware configuration to the state it was in before the Oracle Clusterware 12<span class="italic">c</span> Release 1 (12.1) upgrade. To restore the configuration, you must restore the release from which you were upgrading. Any configuration changes that you have performed during or after the Oracle Database 12<span class="italic">c</span> upgrade process are removed and cannot be recovered.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink CWLIN" href="../CWLIN/toc.htm"><span class="italic">Oracle Grid Infrastructure Installation Guide for Linux</span></a></p>
</li>
<li>
<p><a class="olink CWWIN" href="../CWWIN/toc.htm"><span class="italic">Oracle Grid Infrastructure Installation Guide for Microsoft Windows x64 (64-Bit)</span></a></p>
</li>
<li>
<p><a class="olink CWADD" href="../CWADD/toc.htm"><span class="italic">Oracle Clusterware Administration and Deployment Guide</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CACFBHCB"></a>
<div id="UPGRD60106" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.7.5</span> Restoring Oracle Enterprise Manager after Downgrading Oracle Database</h3>
<p>The <span class="italic">restore</span> task described in this section is required only if you are <a id="sthref598"></a>downgrading in some form and Oracle Enterprise Manager is configured on the host. To restore Oracle Enterprise Manager to its previous state, you must have saved your Oracle Enterprise Manager configuration files and data before upgrading. You restore your configuration by first running the Oracle Enterprise Manager configuration assistant (EMCA) as described in this section, and then running <a id="sthref599"></a>the <code dir="ltr">emdwgrd</code> utility as described in <a href="#CACGFCBF">&#34;Running the emdwgrd utility to restore Enterprise Manager Database Control.&#34;</a></p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="preup.htm#BABDDCCI">&#34;Saving Oracle Enterprise Manager Database Control Configuration and Data&#34;</a></div>
<p>If this is an Oracle RAC database using Oracle Clusterware, the database must be registered with the <code dir="ltr">srvctl</code> before running <a id="sthref600"></a>the <code dir="ltr">emca -restore</code> command. This needs to be executed from the <code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code>/bin of the release to which the database is being downgraded.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink CWADD" href="../CWADD/toc.htm"><span class="italic">Oracle Clusterware Administration and Deployment Guide</span></a> for information about <code dir="ltr">srvctl</code></div>
<p>Run the <code dir="ltr">emca</code> <code dir="ltr">-restore</code> command with the appropriate options to restore Oracle Enterprise Manager Database Control or Grid Control to the old Oracle home. <span class="bold">Important: Use the Oracle Database 12<span class="italic">c</span> version of emca for this procedure.</span> See <a class="olink ADMIN" href="../ADMIN/toc.htm"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for complete information about <code dir="ltr">emca</code>.</p>
<p>The options that you specify for <code dir="ltr">emca</code> depend on whether the database being downgraded is a single-instance database, an Oracle RAC database, or an Oracle ASM database as follows:</p>
<ul>
<li>
<p><a href="#CACIFIFD">Running emca on a Single-Instance Oracle Database Without Oracle ASM</a></p>
</li>
<li>
<p><a href="#CACFAFCH">Running emca on an Oracle RAC Database Without Oracle ASM</a></p>
</li>
<li>
<p><a href="#CACIHCJJ">Running emca on a Single-Instance Oracle ASM Instance</a></p>
</li>
<li>
<p><a href="#CACGDHCD">Running emca on an Oracle ASM on Oracle RAC Instance</a></p>
</li>
<li>
<p><a href="#CACEBDDC">Running emca on a Single-Instance Oracle Database With Oracle ASM</a></p>
</li>
<li>
<p><a href="#CACJFHAE">Running emca on an Oracle RAC Database and Oracle ASM Instance</a></p>
</li>
</ul>
<p class="subhead2"><a id="CACIFIFD"></a><a id="UPGRD60107"></a>Running emca on a Single-Instance Oracle Database Without Oracle ASM</p>
<pre dir="ltr">ORACLE_HOME/bin/emca -restore db
</pre>
<p>You are prompted to enter the following information:</p>
<ul>
<li>
<p>Oracle home for the database to be restored</p>
</li>
<li>
<p>Database SID</p>
</li>
<li>
<p>Listener port number</p>
</li>
</ul>
<p class="subhead2"><a id="CACFAFCH"></a><a id="UPGRD60108"></a>Running emca on an Oracle RAC Database Without Oracle ASM</p>
<pre dir="ltr">ORACLE_HOME/bin/emca -restore db -cluster
</pre>
<p>You are prompted to enter the following information:</p>
<ul>
<li>
<p>Oracle home for the database to be restored</p>
</li>
<li>
<p>Database unique name</p>
</li>
<li>
<p>Listener port number</p>
</li>
</ul>
<p class="subhead2"><a id="CACIHCJJ"></a><a id="UPGRD60109"></a>Running emca on a Single-Instance Oracle ASM Instance</p>
<pre dir="ltr">ORACLE_HOME/bin/emca -restore asm
</pre>
<p>You are prompted to enter the following information:</p>
<ul>
<li>
<p>Oracle home for the database to be restored</p>
</li>
<li>
<p>Oracle ASM port</p>
</li>
<li>
<p>Oracle ASM SID</p>
</li>
</ul>
<p class="subhead2"><a id="CACGDHCD"></a><a id="UPGRD60110"></a>Running emca on an Oracle ASM on Oracle RAC Instance</p>
<pre dir="ltr">ORACLE_HOME/bin/emca -restore asm -cluster
</pre>
<p>You are prompted to enter the following information:</p>
<ul>
<li>
<p>Oracle home for the database to be restored</p>
</li>
<li>
<p>Oracle ASM port</p>
</li>
</ul>
<p class="subhead2"><a id="CACEBDDC"></a><a id="UPGRD60111"></a>Running emca on a Single-Instance Oracle Database With Oracle ASM</p>
<pre dir="ltr">ORACLE_HOME/bin/emca -restore db_asm
</pre>
<p>You are prompted to enter the following information:</p>
<ul>
<li>
<p>Oracle home for the database to be restored</p>
</li>
<li>
<p>Database SID</p>
</li>
<li>
<p>Listener port number</p>
</li>
<li>
<p>Oracle ASM port</p>
</li>
<li>
<p>Oracle ASM home</p>
</li>
<li>
<p>Oracle ASM SID [+ASM]</p>
</li>
</ul>
<p class="subhead2"><a id="CACJFHAE"></a><a id="UPGRD60112"></a>Running emca on an Oracle RAC Database and Oracle ASM Instance</p>
<pre dir="ltr">ORACLE_HOME/bin/emca -restore db_asm -cluster
</pre>
<p>You are prompted to enter the following information:</p>
<ul>
<li>
<p>Oracle home for the database to be restored</p>
</li>
<li>
<p>Database unique name</p>
</li>
<li>
<p>Listener port number</p>
</li>
<li>
<p>Oracle ASM port</p>
</li>
<li>
<p>Oracle ASM Oracle home</p>
</li>
<li>
<p>Oracle ASM SID [+ASM]</p>
</li>
</ul>
<p>The output of <code dir="ltr">emca</code> varies according to the options that you specify and the values that you enter at the prompts. This step must be repeated on all the nodes in Oracle RAC environments.</p>
<p>You must now run the <code dir="ltr">emdwgrd</code> utility to restore Oracle Enterprise Manager Database Control and data.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#CACGFCBF">&#34;Running the emdwgrd utility to restore Enterprise Manager Database Control&#34;</a></div>
<a id="CACGFCBF"></a>
<div id="UPGRD60113" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">6.7.5.1</span> Running the emdwgrd utility to restore Enterprise Manager Database Control</h4>
<p>After completing the <code dir="ltr">emca</code> <code dir="ltr">-restore</code> procedure you are ready to restore the Oracle Enterprise Manager Database Control and data with the <code dir="ltr">emdwgrd</code> utility. You must run the <code dir="ltr">emdwgrd</code> utility from the Oracle Database 12<span class="italic">c</span> home. Then <code dir="ltr">ORACLE_HOME</code> and other environment variables must be set to point to the Oracle home from which the upgrade originally took place.</p>
<p>The following procedure is for Linux and UNIX. To run it on Windows, simply substitute <code dir="ltr">emdwgrd.bat</code> for <code dir="ltr">emdwgrd</code>.</p>
<p>Follow these steps to restore Oracle Enterprise Manager Database Control and data:</p>
<ol>
<li>
<p>Set <code dir="ltr">ORACLE_HOME</code> to the Oracle home from which the database upgrade originally took place.</p>
</li>
<li>
<p>Set <code dir="ltr">ORACLE_SID</code> to the SID of the database that was upgraded and then downgraded.</p>
</li>
<li>
<p>Set <code dir="ltr">PATH</code>, <code dir="ltr">LD_LIBRARY_PATH</code> and <code dir="ltr">SHLIB_PATH</code> to point to the Oracle home from which the database upgrade originally took place.</p>
</li>
<li>
<p>Go to the Oracle Database 12<span class="italic">c</span> Oracle home:</p>
<pre dir="ltr">cd <span class="italic">ORACLE_HOME</span>/bin
</pre></li>
<li>
<p>Execute one of the following:</p>
<ol>
<li>
<p>For a single-instance database, run the following command, where <code dir="ltr"><span class="codeinlineitalic">SID</span></code> is the SID of the database that was upgraded and then downgraded and <code dir="ltr"><span class="codeinlineitalic">save_directory</span></code> is the path to the storage location you chose when saving your database control files and data:</p>
<pre dir="ltr">emdwgrd -restore -sid <span class="italic">SID</span> -path save_sirectory -tempTablespace TEMP
</pre></li>
<li>
<p>For an Oracle RAC database, remote copy is required across the cluster nodes. Define an environment variable to indicate which remote copy is configured. For example:</p>
<pre dir="ltr">setenv EM_REMCP /usr/bin/scp
</pre>
<p>Then, execute the following <code dir="ltr">restore</code> command:</p>
<pre dir="ltr">emdwgrd -restore -tempTablespace TEMP -cluster -sid <span class="italic">SID10g</span> -path <span class="italic">save_directory</span>
</pre>
<p>If the Oracle home is on a shared device, add <code dir="ltr">-shared</code> to the previous command line.</p>
</li>
</ol>
</li>
<li>
<p>Enter the SYS and SYSMAN passwords when prompted by <code dir="ltr">emdwgrd</code>.</p>
</li>
<li>
<p>When <code dir="ltr">emdwgrd</code> completes, Oracle Enterprise Manager Database Control is downgraded to the old Oracle home.</p>
</li>
</ol>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CACDDIIB"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.7.6</span> Restoring Oracle Application Express to the Earlier Version</h3>
<p>If the database that was upgraded had an Oracle Application Express version earlier than version 4.2, then downgrading the database will have caused Oracle Application Express to also be downgraded. You will need to compile the SYS-owned objects <code dir="ltr">WWV_FLOW_VAL</code> and <code dir="ltr">WWV_DBMS_SQL</code> from the earlier version of the Oracle Application Express source.</p>
<ol>
<li>
<p>Change your working directory to the core directory of the earlier version of Application Express source.</p>
</li>
<li>
<p>Connect to the database as SYS / SYSDBA.</p>
</li>
<li>
<p>Run the following scripts in the order shown:</p>
<ol>
<li>
<p><kbd>@wwv_flow_val.plb</kbd></p>
</li>
<li>
<p><kbd>@wwv_dbms_sql.sql</kbd></p>
</li>
<li>
<p><kbd>@wwv_dbms_sql.plb</kbd></p>
</li>
</ol>
</li>
<li>
<p>If you were using the embedded PL/SQL gateway of the Oracle XML DB Protocol Server, you will need to restore the images directory to the earlier version as follows.</p>
<ol>
<li>
<p>Change your working directory to the earlier version of the Application Express source.</p>
</li>
<li>
<p>Invoke <code dir="ltr">apxldimg.sql</code> connected as SYS as SYSDBA passing the path to the earlier version source as in the following example.</p>
<pre dir="ltr">@apxldimg.sql /tmp/apex32
</pre></li>
</ol>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CACGFHDC"></a>
<div id="UPGRD52750" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">6.8</span> Troubleshooting the Downgrade of Oracle Database</h2>
<p>Oracle provides troubleshooting information for issues that may occur when downgrading Oracle Database. This section contains known errors that may occur and corresponding workarounds when needed.</p>
<p>This section contains the following topics:</p>
<ul>
<li>
<p><a href="#CACBHBJH">Oracle Multimedia Downgrade and imrelod.sql Script Error</a></p>
</li>
<li>
<p><a href="#CACGFBGD">Oracle Database Vault and dvrelod.sql Script Error</a></p>
</li>
<li>
<p><a href="#CACFHAFI">Downgrading Grid Infrastructure Standalone (Oracle Restart) After Successful or Failed Upgrade</a></p>
</li>
<li>
<p><a href="#CACDFFCI">Issue with Downgrading Oracle ACFS and Oracle Grid Infrastructure</a></p>
</li>
<li>
<p><a href="#CACEIDHE">Issue with Password for Database Links After Downgrading</a></p>
</li>
</ul>
<a id="CACBHBJH"></a>
<div id="UPGRD60114" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.8.1</span> Oracle Multimedia Downgrade and imrelod.sql Script Error</h3>
<p>When downgrading Oracle Database from release 12.1 to release 11.2.0.2, an error may be raised from the <code dir="ltr">imrelod.sql</code> script, which is included with release 11.2.0.2.</p>
<div class="msgset"><a id="tahiti71881786"></a>
<div class="msgentry">
<dl>
<dt><span class="msg"><a class="dashingAutolink" name="autolink-114122"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="sthref601"></a>ORA-20000: Oracle ORDIM component in registry is status: DOWNGRADED. Oracle ORDIM must be installed and valid prior to Oracle Multimedia upgrade, downgrade, or patch.</span> <!-- class="msg" --></dt>
<dd>
<div class="msgexplan"><span class="msgexplankw">Cause:</span> The <code dir="ltr">imrelod.sql</code> script raises this error because it does not know the status of ORDIM.</div>
<!-- class="msgexplan" --></dd>
<dd>
<div class="msgaction"><span class="msgactionkw">Action:</span> No action. This error can safely be ignored.</div>
<!-- class="msgaction" --></dd>
</dl>
</div>
<!-- class="msgentry" --></div>
<!-- class="msgset" --></div>
<!-- class="sect2" -->
<a id="CACGFBGD"></a>
<div id="UPGRD60115" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.8.2</span> Oracle Database Vault and dvrelod.sql Script Error</h3>
<p>When downgrading Oracle Database from release 12.1 to release 11.2.0.3, databases that use Oracle Database Vault may encounter an error from the <code dir="ltr">dvrelod.sql</code> script, which is included with release 11.2.0.3.</p>
<div class="msgset"><a id="tahiti71881958"></a>
<div class="msgentry">
<dl>
<dt><span class="msg"><a class="dashingAutolink" name="autolink-114123"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="sthref602"></a>ORA-31011: XML parsing failed; Oracle Database Vault downgrade to release 11.2.0.3</span> <!-- class="msg" --></dt>
<dd>
<div class="msgexplan"><span class="msgexplankw">Cause:</span> The <code dir="ltr">dvrelod.sql</code> script does not know the status of XML parsing.</div>
<!-- class="msgexplan" --></dd>
<dd>
<div class="msgaction"><span class="msgactionkw">Action:</span> No action. This error can safely be ignored.</div>
<!-- class="msgaction" --></dd>
</dl>
</div>
<!-- class="msgentry" --></div>
<!-- class="msgset" --></div>
<!-- class="sect2" -->
<a id="CACFHAFI"></a>
<div id="UPGRD60143" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.8.3</span> Downgrading Grid Infrastructure Standalone (Oracle Restart) After Successful or Failed Upgrade</h3>
<p>In order to downgrade Oracle Restart, you must deconfigure and then reinstall Oracle Grid Infrastructure. You can then add back the databases and services.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p>Support note 1364412.1 on My Oracle Support at <code dir="ltr"><a href="http://support.oracle.com">http://support.oracle.com</a></code></p>
</li>
<li>
<p><a class="olink CWLIN430" href="../CWLIN/procstop.htm#CWLIN430"><span class="italic">Oracle Grid Infrastructure Installation Guide for Linux</span></a> or <a class="olink CWWIN484" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=CWWIN484"><span class="italic">Oracle Grid Infrastructure Installation Guide for Microsoft Windows x64 (64-Bit)</span></a> for information about downgrading Oracle Clusterware after an upgrade</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CACDFFCI"></a>
<div id="UPGRD60116" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.8.4</span> Issue with Downgrading Oracle ACFS and Oracle Grid Infrastructure</h3>
<p>If you use Oracle ASM Cluster File System (Oracle ACFS), and you upgrade to Oracle Grid Infrastructure 12<span class="italic">c</span>, either for a cluster or for an Oracle Restart standalone server, and then you choose to downgrade to Oracle Grid Infrastructure 11<span class="italic">g</span> Release 2 (11.2), you must run the command <code dir="ltr">acfsroot</code> <code dir="ltr">install</code> from the release 11.2 Oracle home before you attempt to start the release 11.2 software stack.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink READM" href="../READM/toc.htm"><span class="italic">Oracle Database Readme</span></a> and the release notes for your operating system platform for the latest information about isssues and solutions</div>
</div>
<!-- class="sect2" -->
<a id="CACEIDHE"></a>
<div id="UPGRD60144" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.8.5</span> Issue with Password for Database Links After Downgrading</h3>
<p>After downgrading to Oracle Database release 11.1, you are required to reset the passwords for any database links that were created in releases 11.2 or 12.1. See <a href="#CACHCFGD">&#34;Using Oracle Data Pump Export to Create a Dump File Containing All Existing Database Links.&#34;</a> Unless the database link password is reset, an internal error will be displayed when anyone attempts to make use of the database link. For reference, the internal error which is reported in the oracle trace file when the oracle server fails to retrieve the password of the database link is as follows: &#34;ORA-00600: [kzdlk_zt2 err], [18446744073709551601]&#34;.</p>
<p>To reset the password for the database link after downgrading to release 11.1, use the <code dir="ltr">ALTER</code> <code dir="ltr">DATABASE</code> <code dir="ltr">LINK</code> command to change the password back to the original password by specifying the original password in the <code dir="ltr">IDENTIFIED</code> <code dir="ltr">BY</code> clause. See <a class="olink SQLRF30050" href="../SQLRF/statements_1007.htm#SQLRF30050"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about <code dir="ltr">ALTER</code> <code dir="ltr">DATABASE</code> <code dir="ltr">LINK</code>, and <a class="olink ADMIN12194" href="../ADMIN/ds_appdev.htm#ADMIN12194"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about controlling connections established by database links.</p>
<p>If you want to create new database links while running Oracle Database release 11.2 or 12.1 that do not have this password issue, then you can contact Oracle support for information on how to use the <code dir="ltr">IDENTIFIED</code> <code dir="ltr">BY</code> <code dir="ltr">VALUES</code> clause of the <code dir="ltr">CREATE</code> <code dir="ltr">DATABASE</code> <code dir="ltr">LINK</code> command.</p>
<a id="CACHCFGD"></a>
<div id="UPGRD60145" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">6.8.5.1</span> Using Oracle Data Pump Export to Create a Dump File Containing All Existing Database Links</h4>
<p>Before performing the downgrade, please use Oracle Data Pump export to create a dump file that contains all the existing database links. This will include any newly-created database links. The procedure uses the <code dir="ltr">FULL=Y</code> and <code dir="ltr">INCLUDE=DB_LINK</code> parameters with the <code dir="ltr">expdp</code> command.To create the dump file that contains all the existing database links:</p>
<ol>
<li>
<p>Log in to SQL*Plus.</p>
<pre dir="ltr">sqlplus system/manager
</pre></li>
<li>
<p>Drop the dump directory in case one exists.</p>
<pre dir="ltr">SQL&gt; DROP DIRECTORY dpump_dir;
SQL&gt; CREATE DIRECTORY dpump_dir AS &#39;/location_to_write_datapump_dump_file&#39;;
</pre></li>
<li>
<p>Export the database links as follows:</p>
<pre dir="ltr">$ expdp system/manager FULL=Y directory=dpump_dir 
  dumpfile=saved_dblinks.dmp INCLUDE=DB_LINK;
</pre></li>
<li>
<p>Optional step for troubleshooting. After the downgrade, if any of the downgraded database links are not working properly (for example, exhibiting the internal error ORA-00600), they can be dropped and imported from the dump file as follows, after which they should work as intended.</p>
<pre dir="ltr">$ impdp system/manager directory=dpump_dir dumpfile=saved_dblinks.dmp;
</pre></li>
</ol>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1827">
<tr>
<td class="cellalignment1834">
<table class="cellalignment1832">
<tr>
<td class="cellalignment1831"><a href="app.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1831"><a href="expimp.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2002, 2017,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1836">
<table class="cellalignment1830">
<tr>
<td class="cellalignment1831"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1831"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1831"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1831"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1831"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1831"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>