<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<a class="dashingAutolink" name="autolink-114155"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Upgrading%20Oracle%20Database"></a><title>Upgrading Oracle Database</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1091"/>
<meta name="dcterms.created" content="2017-07-10T11:50:3Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Upgrade Guide"/>
<meta name="dcterms.identifier" content="E41397-13"/>
<meta name="dcterms.isVersionOf" content="UPGRD"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2002, 2017,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Prev" href="preup.htm" title="Previous" type="text/html"/>
<link rel="Next" href="afterup.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E41397-13.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">7/14</span> <!-- End Header -->
<div id="UPGRD003" class="chapter"><a id="BABJADGA"></a> <a id="i1011372"></a>
<h1 class="chapter"><span class="secnum">3</span> Upgrading Oracle Database</h1>
<p>Oracle provides a comprehensive set of tools for upgrading Oracle Database with minimal downtime and for migrating your applications to the new release.</p>
<p>This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#CHDHCIAB">Upgrade Strategies for Oracle Database</a></p>
</li>
<li>
<p><a href="#i1011482">Upgrading with Oracle Database Upgrade Assistant (DBUA)</a></p>
</li>
<li>
<p><a href="#CHDBBIFA">About the Parallel Upgrade Utility for Oracle Database</a></p>
</li>
<li>
<p><a href="#CHDBHAHE">Manually Upgrading a Non-CDB Oracle Database</a></p>
</li>
<li>
<p><a href="#CACGGHJC">Manually Upgrading a Multitenant Container Oracle Database (CDB)</a></p>
</li>
<li>
<p><a href="#BABEEEJG">How the Data Dictionary is Upgraded and Status is Displayed</a></p>
</li>
<li>
<p><a href="#CHDHBFHA">About the catupgrd.sql Script in Earlier Releases of Oracle Database</a></p>
</li>
<li>
<p><a href="#CHDDCGCH">About the catuppst.sql Script</a></p>
</li>
<li>
<p><a href="#CHDBDJIC">About Transporting and Upgrading a Database (Full Transportable Export/Import)</a></p>
</li>
<li>
<p><a href="#i1012368">Troubleshooting the Upgrade for Oracle Database</a></p>
</li>
<li>
<p><a href="#BABCGHFJ">Rerunning the Upgrade for Oracle Database</a></p>
</li>
</ul>
<div class="infoboxnotewarn">
<p class="notep1">Caution:</p>
<p class="warnsp">If you retain the old Oracle software, then never start the upgraded database with the old Oracle software. Only start the database with the executables in the new Oracle Database installation.</p>
</div>
<a id="CHDHCIAB"></a>
<div id="UPGRD60130" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">3.1</span> Upgrade Strategies for Oracle Database</h2>
<p><a id="sthref325"></a>Starting with Oracle Database 12<span class="italic">c</span>, multitenant architecture enables an Oracle database to function as a <a id="sthref326"></a>multitenant container database (CDB) with pluggable databases. All Oracle Database releases earlier than Oracle Database 12<span class="italic">c</span> were non-CDB. See <a class="olink CNCPT89234" href="../CNCPT/cdbovrvw.htm#CNCPT89234"><span class="italic">Oracle Database Concepts</span></a> for an overview of multitenant architecture.</p>
<p>This release provides more strategies for upgrading. After upgrading an earlier release to Oracle Database 12<span class="italic">c</span>, you can plug the upgraded database into a CDB as described in <a href="#CHDBHIHI">&#34;Upgrading an Earlier Release and Plugging a PDB into a CDB.&#34;</a></p>
<div class="infoboxnotewarn">
<p class="notep1">Important:</p>
<p class="warnsp">You cannot downgrade a database once you have set the compatible initialization parameter to 12.1.0.2. Only if the compatibility is set to 12.1.0.1 will a downgrade be possible for a pluggable database (PDB), and there may still be restrictions on downgrading. See <a href="downgrade.htm#CACGBHDB">Chapter 6, &#34;Downgrading Oracle Database to an Earlier Release.&#34;</a></p>
</div>
<p>This section contains the following topics:</p>
<ul>
<li>
<p><a href="#CHDCEGEC">Upgrading a Non-CDB Oracle Database</a></p>
</li>
<li>
<p><a href="#CHDBHIHI">Upgrading an Earlier Release and Plugging a PDB into a CDB</a></p>
</li>
<li>
<p><a href="#CHDBEDDA">Upgrading a Multitenant (CDB) Oracle Database</a></p>
</li>
<li>
<p><a href="#CHDCGIJC">Upgrading a Pluggable Database (PDB)</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADMIN13514" href="../ADMIN/cdb_create.htm#ADMIN13514"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for complete information about creating and configuring a CDB and <a class="olink CNCPT89234" href="../CNCPT/cdbovrvw.htm#CNCPT89234"><span class="italic">Oracle Database Concepts</span></a> for an overview of multitenant architecture</div>
<a id="CHDCEGEC"></a>
<div id="UPGRD60155" class="sect2">
<h3 class="sect2"><span class="secnum">3.1.1</span> Upgrading a Non-CDB Oracle Database</h3>
<p>A non-CDB Oracle Database does not use the multitenant architecture and does not contain pluggable databases (PDBs). You can upgrade the database with Oracle Database Upgrade Assistant (DBUA) or manually. Follow the procedures in <a href="#i1011482">&#34;Upgrading with Oracle Database Upgrade Assistant (DBUA),&#34;</a> or <a href="#CHDBHAHE">&#34;Manually Upgrading a Non-CDB Oracle Database.&#34;</a></p>
</div>
<!-- class="sect2" -->
<a id="CHDBHIHI"></a>
<div id="UPGRD60131" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.1.2</span> <a id="sthref327"></a>Upgrading an Earlier Release and Plugging a PDB into a CDB</h3>
<p>You can upgrade earlier releases of Oracle Database using either DBUA or the Parallel Upgrade Utility and then plug the upgraded database into a multitenant container database (CDB). The upgraded release 12.1 database can be plugged into an existing CDB. Be sure to follow any necessary pre-upgrade procedures described in <a href="preup.htm#CEGIJFGC">Chapter 2, &#34;Preparing to Upgrade Oracle Database.&#34;</a> The following procedure assumes that both databases are on the same system.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADMIN13549" href="../ADMIN/cdb_plug.htm#ADMIN13549"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about creating and removing PDBs with SQL*Plus, and <a class="olink ADMIN13576" href="../ADMIN/cdb_plug.htm#ADMIN13576"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for examples of various scenarios with different factors.</div>
<p>To upgrade a database and plug it into a CDB:</p>
<ol>
<li>
<p>Install the new Oracle Database 12<span class="italic">c</span> software. See <a class="olink GINST" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=GINST"><span class="italic">Oracle Database Installation Guide</span></a> for your operating system platform.</p>
</li>
<li>
<p>Upgrade the database as described in this guide. See <a href="#BABJADGA">Chapter 3, &#34;Upgrading Oracle Database.&#34;</a></p>
</li>
<li>
<p>Set the <code dir="ltr">COMPATIBLE</code> parameter to 12.0.0, if you have not already done so as part of the upgrade process. See <a href="intro.htm#BHCJHGFA">&#34;The COMPATIBLE Initialization Parameter in Oracle Database.&#34;</a></p>
</li>
<li>
<p>Make sure the database is in read-only mode.</p>
<pre dir="ltr">SQL&gt; startup mount
SQL&gt; alter database open read only;
</pre></li>
<li>
<p>Ensure that the prerequisites for plugging an unplugged PDB are met. See <a class="olink ADMIN13855" href="../ADMIN/cdb_plug.htm#ADMIN13855"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about using the <code dir="ltr">DBMS_PDB.CHECK_PLUG_COMPATIBILITY</code> function to determine whether these requirements are met.</p>
</li>
<li>
<p>Create the XML file for the PDB. The root name for the XML file matches the name of the PDB. The <code dir="ltr"><span class="codeinlineitalic">path</span></code> to the location can be anything you choose. This location is where the XML file will be saved.</p>
<pre dir="ltr">SQL&gt; exec DBMS_PDB.DESCRIBE(&#39;<span class="italic">path</span>/PDB1.xml&#39;);
</pre></li>
<li>
<p>Shut down the database.</p>
<pre dir="ltr">SQL&gt; SHUTDOWN IMMEDIATE
</pre></li>
<li>
<p>Plug the database into the CDB.</p>
<pre dir="ltr">SQL&gt; CREATE PLUGGABLE DATABASE <span class="codeinlineitalic">PDB1</span> USING &#39;<span class="italic">path</span>/PDB1.xml&#39; NOCOPY TEMPFILE REUSE;
</pre>
<p>In this example, the PDB is named <code dir="ltr"><span class="codeinlineitalic">PDB1</span></code>. You can use any name, but the name must be unique for this CDB.</p>
<p>This example also assumes that the data files remain in the same location as they were when the database was standalone. If the data files have been copied to a different location (for example, stored with Oracle ASM), then the parameter <code dir="ltr">SOURCE_FILE_NAME_CONVERT</code> must be specified. See <a class="olink ADMIN13564" href="../ADMIN/cdb_plug.htm#ADMIN13564"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for an example of using the <code dir="ltr">SOURCE_FILE_NAME_CONVERT</code> clause.</p>
<p><code dir="ltr">TEMPFILE</code> <code dir="ltr">REUSE</code> specifies that the existing TEMP tablespaces can be reused.</p>
<p>You should see &#34;<code dir="ltr">Pluggable database created.</code>&#34; The upgraded database is now a PDB ready for the CDB.</p>
</li>
<li>
<p>Connect to the PDB using a previously configured listener. The name of the PDB in this example is <code dir="ltr">PDB1</code>.</p>
<pre dir="ltr">SQL&gt; sys/oracle@PDB1 as sysdba
</pre>
<p>You can alternatively connect to the PDB as follows:</p>
<pre dir="ltr">SQL&gt; ALTER SESSION set container=PDB1;
</pre></li>
<li>
<p>Convert the dictionary to the PDB type. From the <code dir="ltr">admin</code> directory, run the <code dir="ltr">noncdb_to_pdb.sql</code> script. This script must be run before the PDB can be opened for the first time.</p>
<pre dir="ltr">@$ORACLE_HOME/rdbms/admin/noncdb_to_pdb.sql
</pre></li>
<li>
<p>Startup and open the new PDB in read/write mode. You must open the new PDB in read/write mode for Oracle Database to complete the integration of the new PDB into the CDB. See <a class="olink ADMIN14091" href="../ADMIN/cdb_admin.htm#ADMIN14091"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for more information about modifying the open mode of PDBs with the <code dir="ltr">STARTUP</code> SQL*Plus command.</p>
<pre dir="ltr">SQL&gt; STARTUP PLUGGABLE DATABASE PDB1 OPEN;
</pre></li>
<li>
<p>Back up the PDB. See <a class="olink BRADV428" href="../BRADV/rcmbckba.htm#BRADV428"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> for information about backing up a PDB.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CHDBEDDA"></a>
<div class="sect2">
<h3 class="sect2"><span class="secnum">3.1.3</span> Upgrading a Multitenant (CDB) Oracle Database</h3>
<p>Starting with Oracle Database 12<span class="italic">c</span>, Oracle provides multitenant architecture, which enables the creation and administration of pluggable databases (PDBs). You can upgrade the CDB with Oracle Database Upgrade Assistant (DBUA) or manually, as you would a non-CDB database. Follow the procedures in <a href="#i1011482">&#34;Upgrading with Oracle Database Upgrade Assistant (DBUA),&#34;</a> or <a href="#CACGGHJC">&#34;Manually Upgrading a Multitenant Container Oracle Database (CDB).&#34;</a></p>
</div>
<!-- class="sect2" -->
<a id="CHDCGIJC"></a>
<div id="UPGRD60151" class="sect2">
<h3 class="sect2"><span class="secnum">3.1.4</span> Upgrading a Pluggable Database (PDB)</h3>
<p>A CDB can contain zero, one, or more pluggable databases (PDBs). You can upgrade one PDB without upgrading the whole CDB. For example, you can unplug a PDB from a release 12.1.0.1 CDB, plug it into a release 12.1.0.2 CDB, and then upgrade that PDB to release 12.1.0.2. You cannot use DBUA to upgrade a PDB; therefore you can manually upgrade the PDB. Follow the procedure in this section, and for more information see <a href="#CACGGHJC">&#34;Manually Upgrading a Multitenant Container Oracle Database (CDB).&#34;</a></p>
<div class="infobox-note">
<p class="notep1">Note:</p>
A PDB cannot be recovered unless it is backed up. After upgrading using the method of creating a CDB and plugging in a database, be sure to back up the PDB. See <a class="olink BRADV428" href="../BRADV/rcmbckba.htm#BRADV428"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> for information about backing up a PDB.</div>
<dl>
<dd><a id="UPGRD60154"></a><a id="CHDJEAJC"></a></dd>
<dt class="seghead">Step 1&nbsp;&nbsp;&nbsp;Prepare the release 12.1.0.1 PDB</dt>
<dd>
<p>In this step you prepare the PDB you want to upgrade to release 12.1.0.2.</p>
<ol>
<li>
<p>In the release 12.1.0.1 environment, switch to the PDB you want to upgrade. For example, PDB1:</p>
<pre dir="ltr">SQL&gt; alter session set container=PDB1;
</pre></li>
<li>
<p>Run the <span class="bold">preupgrade</span> script from the release 12.1.0.2 environment to generate fixup scripts:</p>
<pre dir="ltr">@$ORACLE_HOME_12102/rdbms/admin/preupgrd.sql
</pre>
<p>The output of the preupgrade.log includes the location of the fixup scripts. The log files and fixup scripts will be created under <span class="italic">ORACLE_BASE</span>/cfgtoollogs, if <span class="italic">ORACLE_BASE</span> is defined. If <span class="italic">ORACLE_BASE</span> is not defined, then the files will be created under ORACLE_HOME/cfgtoollogs instead of <span class="italic">ORACLE_BASE</span>/cfgtoollogs.</p>
<p>To view the PDB-only output, see <code dir="ltr">cfgtoollogs/SID/preupgrade/pdbfiles</code>. The PDB files are first written to <code dir="ltr">preupgrade/pdbfiles</code> and then concatenated to <code dir="ltr">preupgrade.log</code>, <code dir="ltr">preupgrade_fixups.sql</code>, and <code dir="ltr">postupgrade_fixups.sql</code> in the <code dir="ltr">cfgtoollogs/</code><code dir="ltr"><span class="codeinlineitalic">SID</span></code><code dir="ltr">/preupgrade</code> directory.</p>
</li>
<li>
<p>Run the fixup script as follows:</p>
<pre dir="ltr">@$<span class="codeinlineitalic">ORACLE_BASE</span>/cfgtoollogs/CDB1/preupgrade/preupgrade_fixups.sql
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
You must be connected to the PDB before you run <code dir="ltr">preupgrade_fixups.sql</code>.</div>
</li>
<li>
<p>To decrease the amount of downtime during upgrade, gather optimizer statistics as follows:</p>
<pre dir="ltr">SQL&gt; exec dbms_stats.gather_dictionary_stats;
</pre>
<p>At this time, also apply any additional recommendations from the preupgrade.log.</p>
</li>
<li>
<p>Switch to the CDB root container:</p>
<pre dir="ltr">SQL&gt; alter session set container=CDB$ROOT;
</pre></li>
<li>
<p>Close the PDB, in this example <code dir="ltr">PDB1</code>:</p>
<pre dir="ltr">SQL&gt; alter pluggable database PDB1 close;
</pre></li>
<li>
<p>Unplug <code dir="ltr">PDB1</code> and stage it so it can be plugged into the 12.1.0.2 CDB. Then exit this CDB when finished. For example:</p>
<pre dir="ltr">SQL&gt; alter pluggable database PDB1 unplug into &#39;/stage/PDB1.xml&#39;;
SQL&gt; exit
</pre></li>
</ol>
<p>You are now ready to plug the standalone PDB in to the release 12.1.0.2 CDB, as described in <a href="#CHDEEFBH">&#34;Plug the PDB into the 12.1.0.2 CDB.&#34;</a></p>
</dd>
<dd><a id="CHDEEFBH"></a></dd>
<dt class="seghead">Step 2&nbsp;&nbsp;&nbsp;Plug the PDB into the 12.1.0.2 CDB</dt>
<dd>
<p>In this step you plug the PDB that you prepared in Step <a href="#CHDJEAJC">1</a> in to the release 12.1.0.2 CDB. The example uses a PDB named <code dir="ltr">PDB1</code>. Note that when you ran DBCA for release 12.1.0.2, the compatible parameter was set to 12.1.0.2 by default. If you changed the compatible parameter to an earlier release, then you must set it to 12.1.0.2 in order to perform the upgrade.</p>
<ol>
<li>
<p>Connect to the release 12.1.0.2 CDB:</p>
<pre dir="ltr">SQL&gt; alter session set container=CDB$ROOT;
</pre></li>
<li>
<p>Create the 12.1.0.2 PDB using the staged 12.1.0.1 PDB:</p>
<pre dir="ltr">SQL&gt; create pluggable database PDB1 using &#39;/stage/PDB1.xml&#39;
file_name_convert=(&#39;/oradata/CDB1/PDB1&#39;, &#39;/oradata/CDB2/PDB1&#39;);
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADMIN13551" href="../ADMIN/cdb_plug.htm#ADMIN13551"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about creating PDBs with SQL*Plus</div>
</li>
<li>
<p>Open the PDB in upgrade mode:</p>
<pre dir="ltr">SQL&gt; alter pluggable database PDB1 open upgrade;
</pre></li>
<li>
<p>Exit SQL*Plus in order to run the Parallel Upgrade Utility, which is a Perl script, in Step <a href="#CHDICAAD">3</a>.</p>
<pre dir="ltr">SQL&gt; Exit
</pre></li>
</ol>
</dd>
<dd><a id="CHDICAAD"></a></dd>
<dt class="seghead">Step 3&nbsp;&nbsp;&nbsp;Upgrade the PDB</dt>
<dd>
<p>In this step you run the Parallel Upgrade Utility and the fixup scripts to complete the upgrade.</p>
<ol>
<li>
<p>From the command prompt, change to the admin directory of the 12.1.0.2 Oracle home:</p>
<pre dir="ltr">cd $ORACLE_HOME/rdbms/admin 
</pre></li>
<li>
<p>Run the Parallel Upgrade Utility, <code dir="ltr">catctl.pl</code>. Use the syntax you normally use with <code dir="ltr">catctl.pl</code>, except that you must use the <code dir="ltr">-c</code> <code dir="ltr"><span class="codeinlineitalic">PDBname</span></code> option to specify which PDB you are upgrading. Capitalize the name of your PDB as shown in the example using <code dir="ltr">PDB1</code>.</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl catctl.pl -c &#34;PDB1&#34; -l /home/oracle/upgrade
 catupgrd.sql
</pre>
<p>Refer to <a href="#CHDFHHEB">&#34;Parallel Upgrade Utility (catctl.pl) Parameters&#34;</a> for information about the syntax for <code dir="ltr">catctl.pl</code>.</p>
</li>
<li>
<p>Log in to SQL*Plus and start the PDB to run required scripts and the <span class="bold">post-upgrade</span> fixup scripts.</p>
<pre dir="ltr">SQL&gt; alter session set container=PDB1;
SQL&gt; startup
</pre></li>
<li>
<p>Run <code dir="ltr">utlrp.sql</code> to compile objects.</p>
<pre dir="ltr">@?/rdbms/admin/utlrp.sql
</pre></li>
<li>
<p>Run the post-upgrade fixup scripts to complete the upgrade. (Make sure you are connected to the PDB.)</p>
<pre dir="ltr">$ORACLE_BASE/cfgtoollogs/CDB1/preupgrade/postupgrade_fixups.sql
</pre>
<p>If <span class="italic">ORACLE_BASE</span> is not set, the files will be created under <code dir="ltr">$ORACLE_HOME/cfgtoollogs</code> instead of <code dir="ltr">$ORACLE_BASE/cfgtoollogs</code>.</p>
</li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
<ul>
<li>
<p>If you move either a PDB or any other stand-alone database from server A to server B, you must copy the <code dir="ltr">postupgrade_fixups.sql</code> script to the new location to execute it post-upgrade in the new environment.</p>
</li>
<li>
<p>The post-upgrade fixup script for the specified PDB is located in <code dir="ltr">preupgrade/pdbfiles/postupgrade_fixups.</code><code dir="ltr"><span class="codeinlineitalic">PDB NAME</span></code><code dir="ltr">.sql</code> and its contents are concatenated to <code dir="ltr">preupgrade/postupgrade_fixups.sql</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
<p>Repeat the steps to upgrade multiple PDBs. When you run <code dir="ltr">catctl.pl</code> you can specify all the PDBs at once using a space-delimited list of PDBs. For example:</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl catctl.pl -c &#34;PDB1 PDB2&#34; -l /home/oracle/upgrade
 catupgrd.sql
</pre></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1011482"></a>
<div id="UPGRD105" class="sect1">
<h2 class="sect1"><span class="secnum">3.2</span> Upgrading with Oracle Database Upgrade Assistant (DBUA)<a id="sthref328"></a><a id="sthref329"></a></h2>
<p>Database Upgrade Assistant (DBUA) provides a graphical user interface to guide you through the upgrade of Oracle Database. DBUA works for CDB and non-CDB database systems.</p>
<p>The following topics describe recommendations and procedures for upgrading a database using DBUA:</p>
<ul>
<li>
<p><a href="#CHDDCBHG">Recommendations for Using DBUA</a></p>
</li>
<li>
<p><a href="#CHDDFBBD">How DBUA Processes the Upgrade for Oracle Database</a></p>
</li>
<li>
<p><a href="#CHDJJJEE">Using DBUA to Upgrade the Database on Linux, UNIX, and Windows Systems</a></p>
</li>
<li>
<p><a href="#CHDCDDHE">About Windows Authentication When Upgrading</a></p>
</li>
<li>
<p><a href="#CHDJBECI">Moving a Database from an Existing 12<span class="italic">c</span> Oracle Home</a></p>
</li>
<li>
<p><a href="#CHDFIFHF">Using DBUA in Silent Mode to Upgrade Oracle Database</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can invoke DBUA in silent mode, which does not present a user interface, as described in <a href="#CHDFIFHF">&#34;Using DBUA in Silent Mode to Upgrade Oracle Database&#34;</a>. This is useful for large roll-outs and scripts.</div>
<a id="CHDDCBHG"></a>
<div id="UPGRD52727" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.2.1</span> Recommendations for Using DBUA</h3>
<p>The procedures for using DBUA are the same for a multitenant container database (CDB), <a id="sthref330"></a>pluggable databases (<a id="sthref331"></a>PDBs), and for a non-CDB. See <a class="olink CNCPT89234" href="../CNCPT/cdbovrvw.htm#CNCPT89234"><span class="italic">Oracle Database Concepts</span></a> for an overview and documentation roadmap for working with a CDB and PDBs. However, there are considerations and recommendations for running DBUA. This section summarizes the recommendations. Also see <a href="#CHDHFCIG">&#34;About Stopping DBUA When Upgrading.&#34;</a></p>
<p>Recommendations for using DBUA are as follows:</p>
<ul>
<li>
<p>Oracle strongly recommends that you run the Pre-Upgrade Information Tool before starting the upgrade with DBUA. Although DBUA runs the Pre-Upgrade Information Tool as part of the pre-requisite checks, it is good practice to run the tool ahead of time in order to analyze the database and take actions that can decrease downtime for upgrading. See <a href="preup.htm#BABBCGJC">&#34;About the Pre-Upgrade Information Tool for Oracle Database&#34;</a> for information and steps.</p>
</li>
<li>
<p>Set Archive Log <code dir="ltr">ON</code> during upgrade. Oracle recommends that you set Archive Log <code dir="ltr">ON</code> in order for DBUA to create and update the log file for the upgrade process.</p>
</li>
<li>
<p>If the database instance is not running, then DBUA tries to start the instance. If the instance is up and running, then DBUA connects to it.</p>
</li>
<li>
<p>For Oracle RAC, if you upgrade a cluster database using DBUA, then you must leave the <code dir="ltr">CLUSTER_DATABASE</code> initialization parameter set to <code dir="ltr">TRUE</code>.</p>
</li>
<li>
<p>If you restore your database manually (not using DBUA), then remove the <code dir="ltr">Welcome_</code><code dir="ltr"><span class="codeinlineitalic">SID</span></code><code dir="ltr">.txt</code> file, which is located in the <code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code><code dir="ltr">/cfgtoollogs/dbua/logs/</code> directory, before starting DBUA. The presence of this file indicates to DBUA that this is a re-run operation.</p>
</li>
<li>
<p>If Oracle Database Vault is enabled, then see <a href="preup.htm#BABIHIGB">&#34;Requirement for Upgrading Oracle Databases That Use Oracle Database Vault&#34;</a>.</p>
</li>
</ul>
<a id="CHDHFCIG"></a>
<div id="UPGRD60156" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">3.2.1.1</span> About Stopping DBUA When Upgrading</h4>
<p>If you stop the upgrade, but do not restore the database, then you cannot restart DBUA until you start the existing database in <code dir="ltr">UPGRADE</code> mode using the Oracle Database 12<span class="italic">c</span> server. You cannot go back to the original Oracle Database server unless you restore your database. Instead, you must continue with a manual (command line) upgrade as described in <a href="#CACGGHJC">&#34;Manually Upgrading a Multitenant Container Oracle Database (CDB)&#34;</a>.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CHDDFBBD"></a>
<div id="UPGRD52728" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.2.2</span> How DBUA<a id="sthref332"></a> Processes the Upgrade for Oracle Database</h3>
<p>If you installed the software for Oracle Database 12<span class="italic">c</span> and specified that you are upgrading an existing Oracle database, then DBUA starts automatically. You can also start DBUA independently after the installation is complete as described in <a href="#BABCGHFJ">&#34;Rerunning the Upgrade for Oracle Database&#34;</a>.</p>
<p>While the upgrade is in process, DBUA shows the upgrade progress for each component. DBUA writes detailed trace and log files and produces a complete HTML report for later reference. To enhance security, DBUA automatically locks new user accounts in the upgraded database. DBUA then proceeds to create new configuration files (parameter and listener files) in the new Oracle home.</p>
<p>DBUA does not begin the upgrade process until all of the pre-upgrade steps are completed. Refer to <a href="preup.htm#i1007753">&#34;Tasks for Preparing to Upgrade Oracle Database&#34;</a>, which provides a general overview and pointers to further information and procedures.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#CHDHIJFG">&#34;Upgrade Scripts Invoked by DBUA&#34;</a></div>
<a id="CHDHIJFG"></a>
<div id="UPGRD52730" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">3.2.2.1</span> Upgrade Scripts Invoked by DBUA</h4>
<p>During the upgrade, DBUA automatically modifies or creates new required tablespaces and invokes the appropriate upgrade scripts.</p>
<p>During the prerequisite phase, DBUA runs the Pre-Upgrade Information Tool, <code dir="ltr">preupgrd.sql</code>, and uses the following logic to modify or create new required tablespaces:</p>
<ul>
<li>
<p>If the datafiles are auto-extensible and have enough disk space to grow, then DBUA continues with the upgrade.</p>
</li>
<li>
<p>If the datafiles are not auto-extensible, then DBUA prompts you and makes the files auto-extensible.</p>
</li>
<li>
<p>If the tablespaces are auto-extensible and the <code dir="ltr">MAXSIZE</code> initialization parameter needs adjustment, then DBUA prompts for the same and adjusts the <code dir="ltr">MAXSIZE</code> parameter.</p>
</li>
<li>
<p>If there is not enough disk space to grow, then DBUA prompts you to create space (by adding more datafiles). DBUA does not automatically add new datafiles because DBUA cannot determine where to create the files.</p>
</li>
</ul>
<p>DBUA addresses many issues found during the prerequisite phase. For example, DBUA can ensure that the correct time zone file is used and make ACL adjustments for network access control lists.</p>
<p>During the upgrade phase, DBUA runs <code dir="ltr">catctl.pl</code>, which runs the upgrade processes in parallel instead of serially, optimally taking advantage of CPU capacity to decrease downtime as much as possible.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CHDJJJEE"></a>
<div id="UPGRD52860" class="sect2">
<h3 class="sect2"><span class="secnum">3.2.3</span> Using DBUA<a id="sthref333"></a> to Upgrade the Database on Linux, UNIX, and Windows Systems</h3>
<p>The steps to upgrade a database using the DBUA graphical user interface are performed from within the new Oracle home where the Oracle Database 12<span class="italic">c</span> software has been installed. Only an Administrator should invoke DBUA for Windows systems (see <a href="#CHDCDDHE">&#34;About Windows Authentication When Upgrading&#34;</a>).</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="preup.htm#BABJHIEH">&#34;Installing the New Oracle Database Software&#34;</a> for more information about the software location</p>
</li>
<li>
<p><a href="preup.htm#BABHHIBG">&#34;Pre-Upgrade Information Tool Warnings and Recommendations for Oracle Database&#34;</a> for information about preparing for the upgrade to minimize down time</p>
</li>
<li>
<p><a href="#CHDJBECI">&#34;Moving a Database from an Existing 12<span class="italic">c</span> Oracle Home&#34;</a> for the procedure to move an existing database</p>
</li>
</ul>
</div>
<p>To upgrade a database using DBUA on Linux, UNIX, or Windows:</p>
<ol>
<li>
<p>The <code dir="ltr">dbua</code> executable is located in the <span class="italic">ORACLE_HOME</span>/bin directory. Start DBUA from the Oracle home where the new database software has been installed:</p>
<ul>
<li>
<p>On Linux or UNIX platforms, enter the following command at a system prompt in the new home for Oracle Database 12<span class="italic">c</span>:</p>
<pre dir="ltr">dbua
</pre></li>
<li>
<p>On Windows operating systems, select <span class="bold">Start</span> &gt; <span class="bold">Programs</span> &gt; <span class="bold">Oracle-</span><span class="bolditalic">HOME_NAME</span> &gt; <span class="bold">Configuration and Migration Tools</span> &gt; <span class="bold">Database Upgrade Assistant</span>.</p>
</li>
</ul>
<p>The DBUA Select Operation page displays.</p>
<img width="800" height="600" src="img/dbua_1.png" alt="Description of dbua_1.png follows"/><br/>
<a id="sthref334" href="img_text/dbua_1.htm">Description of the illustration &#39;&#39;dbua_1.png&#39;&#39;</a><br/>
<br/></li>
<li>
<p>If you need help at any DBUA page or want to consult more documentation about DBUA, then click <span class="bold">Help</span> to open the online help.</p>
<p>Click <span class="bold">Next</span>.</p>
<p>The Select Database page appears, listing the databases available for upgrade.</p>
<p>If the source database does not have operating system authentication, then DBUA prompts you for SYSDBA user name and password.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#CHDJBECI">&#34;Moving a Database from an Existing 12<span class="italic">c</span> Oracle Home&#34;</a> for the procedure to move a database from an existing 12.1 Oracle home to a new 12.1 Oracle home</div>
<div class="infobox-note">
<p class="notep1">Note:</p>
<ul>
<li>
<p>This may affect your authentication on Windows systems: Starting with Oracle Database 12<span class="italic">c</span>, Windows NTS authentication using the NTLM protocol is no longer supported for security reasons. Kerberos authentication is the only supported authentication. In this release, NTS does not work in Windows NT domains nor in domains with Windows NT controllers.</p>
</li>
<li>
<p>This may affect user accounts on Windows Systems: Starting with Oracle Database 12<span class="italic">c</span>, Oracle uses the standard Windows User Account instead of Local System Account to run Oracle database services. This separation of roles provides better security on Windows.</p>
</li>
</ul>
<p>See <a class="olink NTDBI1340" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=NTDBI1340"><span class="italic">Oracle Database Platform Guide for Microsoft Windows</span></a> for information about managing user accounts on Windows systems.</p>
</div>
<img width="800" height="600" src="img/dbua_2.png" alt="Description of dbua_2.png follows"/><br/>
<a id="sthref335" href="img_text/dbua_2.htm">Description of the illustration &#39;&#39;dbua_2.png&#39;&#39;</a><br/>
<br/></li>
<li>
<p>From the <span class="bold">Source Database Oracle Home</span> drop-down list, choose the database you want to upgrade to Oracle Database 12<span class="italic">c</span>. DBUA fills in the information for the release and selects the Oracle database associated with the selected Oracle home.</p>
<p>You can select only one database at a time. If the database does not appear in the list, then make sure an entry with the database name exists in the <code dir="ltr">oratab</code> file in the <code dir="ltr">etc</code> directory.</p>
<p>If you run DBUA from a user account that does not have <code dir="ltr">SYSDBA</code> privileges, then you must enter the user name and password credentials to enable <code dir="ltr">SYSDBA</code> privileges for the selected database.</p>
<p>Click <span class="bold">Next</span>.</p>
<p>If the selected database is a multitenant container database (CDB), then DBUA displays the Pluggable Databases page. The Pluggable Databases page lists the pluggable databases contained in the CDB, which will be upgraded along with the selected CDB.</p>
<img width="800" height="600" src="img/dbua_pdb_2a.png" alt="Description of dbua_pdb_2a.png follows"/><br/>
<a id="sthref336" href="img_text/dbua_pdb_2a.htm">Description of the illustration &#39;&#39;dbua_pdb_2a.png&#39;&#39;</a><br/>
<br/>
<p>Click <span class="bold">Next</span> again.</p>
<p>DBUA analyzes the database, performing pre-upgrade checks and displaying warnings as necessary. Examples of DBUA database checks include:</p>
<ul>
<li>
<p>Empty database recycle bin.</p>
</li>
<li>
<p>Invalid objects.</p>
</li>
<li>
<p>Deprecated and desupported initialization parameters.</p>
</li>
<li>
<p>Time zone data file version.</p>
</li>
</ul>
<p>When DBUA finishes its analysis, the Prerequisite Checks page displays. The analysis takes several minutes to complete.</p>
<img width="800" height="600" src="img/dbua_3.png" alt="Description of dbua_3.png follows"/><br/>
<a id="sthref337" href="img_text/dbua_3.htm">Description of the illustration &#39;&#39;dbua_3.png&#39;&#39;</a><br/>
<br/></li>
<li>
<p>The Prerequisite Checks page shows the validation and results, the severity, whether the result is fixable if there is a problem, and the action you can take. When you select the validation result, the Fixable column displays whether the result can be fixed or not. The Action drop-down list shows actions you can take. For example, select <span class="bold">Fix</span> for DBUA to run a script or command to fix the problem.</p>
<p>When you select a result in the Validation column, DBUA displays information about the result in the bottom area of the page.</p>
<ul>
<li>
<p>Click the link for <span class="bold">more details</span> in the text information area. The Validation Details box appears with more information.</p>
</li>
<li>
<p>If there are validation errors or warnings and these are fixable, you can select an Action to take.</p>
</li>
</ul>
<p>Click <span class="bold">Next</span>.</p>
<p>The Upgrade Options Configuration page appears with the Upgrade Options tab selected.</p>
<img width="806" height="600" src="img/dbua_4.png" alt="Description of dbua_4.png follows"/><br/>
<a id="sthref338" href="img_text/dbua_4.htm">Description of the illustration &#39;&#39;dbua_4.png&#39;&#39;</a><br/>
<br/></li>
<li>
<p>The Upgrade Options page with the Upgrade Options tab selected provides the following options:</p>
<p><span class="bold">Select Upgrade Parallelism</span></p>
<p>The Upgrade Parallelism section enables the degree of parallelism for the upgrade process. This option reduces the time needed to perform the upgrade, based on the number of CPUs available to handle the running of scripts and processes simultaneously.</p>
<p>By default, DBUA sets Upgrade Parallelism to the number of CPUs or 2 if the number of CPUs is less than 4. You can adjust this default value by selecting a new value from the Degree of Parallelism drop-down list.</p>
<p><span class="bold">Recompile Invalid Objects During Post Upgrade</span></p>
<p>Recompile all invalid PL/SQL modules after the upgrade is complete. Specify the parallelism for the recompilation of invalid objects during post upgrade. DBUA provides a recommended degree of Recompilation Parallelism, which it sets to one less than the number of CPU you have available. Taking advantage of parallelism can significantly reduce the upgrade time. If you do not have DBUA recompile invalid objects in its post-upgrade phase, then you must manually recompile invalid objects after the database is upgraded.</p>
<p><span class="bold">Upgrade Time Zone Data</span></p>
<p>Update the time zone data file for this release. If you do not select this option, then you must update the time zone configuration file manually after the upgrade.</p>
<p><span class="bold">Gather Statistics Before Upgrade</span></p>
<p>Reduce the overall time for the upgrade process by gathering statistics before upgrading.</p>
<p><span class="bold">Set User Tablespaces to Read Only During the Upgrade</span></p>
<p>Uncheck if you are upgrading a database in which you must transport tablespaces. Transportable tablespaces must have writable file headers.</p>
<p><span class="bold">Diagnostic Destination</span></p>
<p>The location for output that DBUA creates for diagnostics. You can accept the default, enter a full path into the field, or click <span class="bold">Browse</span> to navigate to a location.</p>
<p><span class="bold">Audit File Destination</span></p>
<p>The location for DBUA to save audit files. Accept the default, or click <span class="bold">Browse</span> to navigate to a different location.</p>
<p>(Optional) Click the <span class="bold">Custom SQL Scripts</span> tab to specify custom SQL scripts that you would like to run before and after the upgrade.</p>
<p>The Custom Scripts page appears. You may click <span class="bold">Next</span> without using the Custom SQL Scripts option.</p>
<img width="806" height="600" src="img/dbua_4b.png" alt="Description of dbua_4b.png follows"/><br/>
<a id="sthref339" href="img_text/dbua_4b.htm">Description of the illustration &#39;&#39;dbua_4b.png&#39;&#39;</a><br/>
<br/></li>
<li>
<p>Optional: In the <span class="bold">Before Upgrade</span> and <span class="bold">After Upgrade</span> fields, browse to the location of any custom SQL scripts that you would like to run. You can specify either one or both, or leave the fields blank to skip this option.</p>
<p>Click <span class="bold">Next</span>.</p>
<p>The Management Options page appears.</p>
<img width="806" height="600" src="img/dbua_mgt_options.png" alt="Description of dbua_mgt_options.png follows"/><br/>
<a id="sthref340" href="img_text/dbua_mgt_options.htm">Description of the illustration &#39;&#39;dbua_mgt_options.png&#39;&#39;</a><br/>
<br/></li>
<li>
<p>In the Management Options page, select the management options:</p>
<ul>
<li>
<p><span class="bold">Configure Enterprise Manager (EM) Database Express</span></p>
<p>Oracle Enterprise Manager Database Express is a web-based database management application that is built into Oracle Database 12<span class="italic">c</span>. EM Express replaces the DB Control component that was available in releases 10<span class="italic">g</span> and 11<span class="italic">g</span>. Enter the EM Database Express Port number, for example 5502.</p>
</li>
<li>
<p><span class="bold">Register with Enterprise Manager (EM) Cloud Control</span></p>
<p>Registering with Oracle Enterprise Manager Cloud Control adds the database and its related entities such as Listener, Oracle ASM disk groups, and Oracle Clusterware as managed targets.</p>
<p>If you select this option, then you must provide information in the following fields:</p>
<ul>
<li>
<p>OMS Host</p>
</li>
<li>
<p>OMS Port</p>
</li>
<li>
<p>EM Admin Username</p>
</li>
<li>
<p>EM Admin Password</p>
</li>
<li>
<p>DBSNMP User Password</p>
</li>
</ul>
</li>
</ul>
<p>Click <span class="bold">Next</span>.</p>
<p>If you are upgrading a single-instance database or Oracle Express Edition (XE), then the Move Database Files page appears.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you are upgrading an Oracle Real Application Clusters database, then the Move Database Files page does not display. To continue with your Oracle RAC upgrade, you can skip the steps pertaining to moving database files and configuring the network.</div>
<img width="806" height="600" src="img/dbua_5.png" alt="Description of dbua_5.png follows"/><br/>
<a id="sthref341" href="img_text/dbua_5.htm">Description of the illustration &#39;&#39;dbua_5.png&#39;&#39;</a><br/>
<br/>
<p>If you are upgrading an Oracle Express database (Oracle XE), then the Move Database Files screen additionally includes Rename Database with the Global Database Name and SID fields as follows:</p>
<img width="632" height="217" src="img/dbua_xe7.png" alt="Description of dbua_xe7.png follows"/><br/>
<a id="sthref342" href="img_text/dbua_xe7.htm">Description of the illustration &#39;&#39;dbua_xe7.png&#39;&#39;</a><br/>
<br/></li>
<li>
<p>In the Move Database Files page, select an option:</p>
<ul>
<li>
<p><span class="bold">Move Database Files as Part of Upgrade</span></p>
</li>
<li>
<p><span class="bold">Move Fast Recovery Area as Part of Upgrade</span></p>
</li>
</ul>
<p>If you are upgrading an Oracle XE database, then you must provide the <span class="bold">Global Database Name</span> and <span class="bold">SID</span>. The rest of the Move Database Files options are the same as for Oracle Database.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The fast recovery area is an Oracle-managed disk location used for storing backup and recovery-related files. Oracle strongly recommends configuring a fast recovery area, because it significantly enhances speed, reliability, and manageability of the database recovery process. The location of the fast recovery area is also used by Oracle Enterprise Manager if you enable local management on the Management Options page.</div>
</li>
<li>
<p>If you choose <span class="bold">Move Database Files as Part of Upgrade</span>, then you must also configure <span class="bold">Storage Type</span> for the database files.</p>
<p>In the <span class="bold">Storage Type</span> drop-down list, select <span class="bold">File System</span> or <span class="bold">Oracle ASM</span>.</p>
<ul>
<li>
<p>If you select <span class="bold">File System</span>, then your database files are moved to the host file system.</p>
</li>
<li>
<p>If you select <span class="bold">Oracle Automatic Storage Management (Oracle ASM)</span>, then your database files are moved to Oracle ASM storage, which must currently exist on your system. If you do not have an Oracle ASM instance, then you can create one using Automatic Storage Management Configuration Assistant (ASMCA) from the Oracle Grid Infrastructure home and then restart DBUA.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink CWGEN" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=CWGEN"><span class="italic">Oracle Grid Infrastructure Installation Guide</span></a> for information about installing and configuring Oracle ASM</p>
</li>
<li>
<p><a class="olink OSTMG51000" href="../OSTMG/GUID-4A1F8835-47C8-4A25-9D34-3FF3D2B409A1.htm#OSTMG51000"><span class="italic">Oracle Automatic Storage Management Administrator&#39;s Guide</span></a> for information about managing Oracle ASM instances with ASMCA</p>
</li>
</ul>
</div>
</li>
<li>
<p>You can choose either <span class="bold">Use Common Location for All Database Files</span> or <span class="bold">Use a Mapping File to Specify Location of Database Files</span>. Specify the location in the file location field or browse to the location.</p>
</li>
<li>
<p>If you choose <span class="bold">Use Oracle Managed Files</span>, then click <span class="bold">Multiplex Redo Logs and Control Files</span>. The Multiplex Redo Logs and Control Files dialog box appears with location fields. Enter locations for online redo logs and control files to be written. Use multiple locations spread across different disks to provide greater fault tolerance.</p>
<img width="550" height="249" src="img/dbua_multiplex_files.png" alt="Description of dbua_multiplex_files.png follows"/><br/>
<a id="sthref343" href="img_text/dbua_multiplex_files.htm">Description of the illustration &#39;&#39;dbua_multiplex_files.png&#39;&#39;</a><br/>
<br/></li>
</ul>
</li>
<li>
<p>If you choose <span class="bold">Move Fast Recovery Area as Part of Upgrade</span>, then you must also configure the storage type and location for the fast recovery area and specify the size to be allocated as described in this step.</p>
<ul>
<li>
<p>The Move Database Files and Move Fast Recovery Area options are independent of each other. For example, you can choose to move database files to Oracle ASM and leave the fast recovery area on the file system.</p>
</li>
<li>
<p>When you choose to move the fast recovery area, DBUA does not physically move existing archived redo logs to a new location. Instead, DBUA sets the <code dir="ltr">DB_RECOVERY_FILE_DEST</code> and <code dir="ltr">DB_RECOVERY_FILE_DEST_SIZE</code> initialization parameters to the new location and new size when the database is started from the new Oracle home.</p>
</li>
<li>
<p>If an Oracle Express Edition database is being upgraded to Oracle Enterprise Edition, then you must configure a fast recovery area. If a fast recovery area is currently configured, then the current settings are retained but the page displays to enable you to override these values.</p>
</li>
</ul>
<p><span class="bold">Storage Type</span></p>
<p>In the Storage Type list, select <span class="bold">File System</span> or <span class="bold">Oracle ASM</span>.</p>
<p>If you select File System, then your fast recovery area is on the host file system.</p>
<p>If you select Oracle Automatic Storage Management (Oracle ASM), then your fast recovery area is on Oracle ASM storage, which must currently exist on your system. If you do not have an Oracle ASM instance, then you can create one using Automatic Storage Management Configuration Assistant (ASMCA) from the Grid Infrastructure home and then restart DBUA.</p>
<p><span class="bold">Fast Recovery Area Location</span></p>
<p>Browse to the location on the host file system, or on Oracle ASM storage.</p>
<p><span class="bold">Fast Recovery Area Size</span></p>
<p>Specify the size to allocate for the fast recovery area. The default is 1024 MB.</p>
<p>Click <span class="bold">Next</span>.</p>
<p>The Network Configuration page appears for listener selection.</p>
<img width="806" height="600" src="img/dbua_6.png" alt="Description of dbua_6.png follows"/><br/>
<a id="sthref344" href="img_text/dbua_6.htm">Description of the illustration &#39;&#39;dbua_6.png&#39;&#39;</a><br/>
<br/></li>
<li>
<p>The Listener Selection area of the Network Configuration page shows a table with: Name, Port, Oracle home, Status, and Migrate columns. To the left of the listener name is a box for selecting the listener.</p>
<p>Select one or more listeners from the source Oracle home to be migrated to the new upgraded Oracle home.</p>
<ol>
<li>
<p>DBUA adds the selected listener to the <code dir="ltr">listener.ora</code> file of the target Oracle home and starts it.</p>
</li>
<li>
<p>DBUA removes the entry of the upgraded database from the old (source) <code dir="ltr">listener.ora</code> file.</p>
</li>
<li>
<p>DBUA reloads the <code dir="ltr">listener.ora</code> file in both the source and target Oracle Database environments.</p>
</li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
If there are other databases registered with the same listener, then their new client connection requests may be affected during listener migration.</div>
<p>Select <span class="bold">Create a New Listener</span> to create a new listener. Provide the name and port number.</p>
<p>Click <span class="bold">Next</span>.</p>
<p>DBUA displays the Recovery Options page. DBUA performs the listener migration during the pre-upgrade steps.</p>
<img width="800" height="600" src="img/dbua_7.png" alt="Description of dbua_7.png follows"/><br/>
<a id="sthref345" href="img_text/dbua_7.htm">Description of the illustration &#39;&#39;dbua_7.png&#39;&#39;</a><br/>
<br/></li>
<li>
<p>In the Recovery Options page, select the recovery method to use in case the upgrade process encounters a problem.</p>
<p>The following recovery options and configurations are available:</p>
<ul>
<li>
<p><span class="bold">Use RMAN Backup</span></p>
</li>
<li>
<p><span class="bold">Use Flashback and Guaranteed Restore Point</span></p>
</li>
<li>
<p><span class="bold">I have my own backup and restore strategy</span></p>
</li>
</ul>
<p><span class="bold">Use RMAN Backup</span></p>
<p>If you select <span class="bold">Create a New Offline RMAN Backup</span>, then enter the full path for a location for the backup in the Backup Location field.</p>
<p>If you select <span class="bold">Use Latest Available RMAN Backup</span> but do not choose to create an RMAN backup before upgrading, then DBUA displays the time stamp for the latest RMAN backup that exists. You can click <span class="bold">Restore Script</span> next to the time stamp to select an existing script to run for restoring this backup.</p>
<p><span class="bold">Use Flashback and Guaranteed Restore Point</span></p>
<p>Select <span class="bold">Create a New Guaranteed Restore Point</span> to have DBUA create a restore point before DBUA enters the upgrade process.</p>
<p>If you previously enabled Flashback Database and configured a fast recovery area with a flashback retention target, then you can select <span class="bold">Use Available Guaranteed Restore Point</span> and pick the named SCN from the drop-down list. Your current settings for the restore point are retained. DBUA displays a page to permit you to override these values if needed.</p>
<p><span class="bold">I have my own backup and restore strategy</span></p>
<p>Select this option only if you used your own backup procedure to back up the database. In this case, <span class="bold">Restore</span> restores only the original database settings. To restore the database itself, you must restore the backup you created with your own backup utilities.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The database you are upgrading must be release 11.1.0.7 or later in order to take advantage of Flashback and Guaranteed Restore Point, and this must be enabled in the source database.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink BRADV71000" href="../BRADV/flashdb.htm#BRADV71000"><span class="italic">Oracle Database Backup and Recovery User&#39;s Guide</span></a> for more information on using Flashback Database and guaranteed restore points</div>
<p>Click <span class="bold">Next</span>.</p>
<p>The Database Upgrade Summary page appears.</p>
<img width="800" height="600" src="img/dbua_8.png" alt="Description of dbua_8.png follows"/><br/>
<a id="sthref346" href="img_text/dbua_8.htm">Description of the illustration &#39;&#39;dbua_8.png&#39;&#39;</a><br/>
<br/></li>
<li>
<p>The Summary page shows information about the upgrade before it starts. Scroll down the list to see all the details. For example:</p>
<ul>
<li>
<p>Source Database</p>
</li>
<li>
<p>Target Database</p>
</li>
<li>
<p>Pluggable Databases</p>
</li>
<li>
<p>Pre-Upgrade Checks</p>
</li>
<li>
<p>Initialization Parameters changes</p>
</li>
<li>
<p>Timezone Upgrade</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="afterup.htm#CHDFIFFC">&#34;Setting the COMPATIBLE Initialization Parameter&#34;</a> for information about setting the <code dir="ltr">COMPATIBLE</code> initialization parameter after the upgrade</div>
<p>Check all of the details. Then click <span class="bold">Back</span> or <span class="bold">Finish</span> as follows:</p>
<ul>
<li>
<p>Click <span class="bold">Back</span> if anything is incorrect until you reach the page where you can correct it.</p>
</li>
<li>
<p>Click <span class="bold">Finish</span> if everything is correct.</p>
</li>
</ul>
<p>The Progress page displays with the progress bar and DBUA begins the upgrade. The Progress page also shows a table with the steps being performed, the time duration, and the status as the upgrade proceeds. DBUA provides a Stop button in case you must cancel the upgrade at this point.</p>
<img width="800" height="600" src="img/dbua_9.png" alt="Description of dbua_9.png follows"/><br/>
<a id="sthref347" href="img_text/dbua_9.htm">Description of the illustration &#39;&#39;dbua_9.png&#39;&#39;</a><br/>
<br/>
<p>When the upgrade has progressed through finishing the upgrade of the CDB root and each PDB seed, the Progress page marks the status Finished. You can click Activity Log, Alert Log, and Upgrade Results to view more information.</p>
<img width="800" height="600" src="img/dbua_9b.png" alt="Description of dbua_9b.png follows"/><br/>
<a id="sthref348" href="img_text/dbua_9b.htm">Description of the illustration &#39;&#39;dbua_9b.png&#39;&#39;</a><br/>
<br/></li>
<li>
<p>After the upgrade has completed, the Upgrade Results page displays a description of the original database and the upgraded database and shows the changes made to the initialization parameters. The page also shows the directory where various log files are stored after the upgrade, and pluggable databases. Scroll down to see more details about pre-upgrade checks.</p>
<img width="800" height="600" src="img/dbua_10.png" alt="Description of dbua_10.png follows"/><br/>
<a id="sthref349" href="img_text/dbua_10.htm">Description of the illustration &#39;&#39;dbua_10.png&#39;&#39;</a><br/>
<br/></li>
<li>
<p>Optional: Examine the log files to obtain more details about the upgrade process. The DBUA log files are located under /<code dir="ltr"><span class="codeinlineitalic">ORACLE_BASE</span></code>/cfgtoollogs/dbua/logs.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
An HTML version of the Upgrade Results is also saved in the log files directory. You can click the links in this HTML page to view the log pages in your browser.</div>
<p>If you are satisfied with the upgrade results, then click <span class="bold">Close</span> to quit DBUA and use your newly upgraded database.</p>
</li>
<li>
<p>Complete the procedures described in <a href="afterup.htm#BABEEEFF">Chapter 4, &#34;Post-Upgrade Tasks for Oracle Database&#34;</a>.</p>
</li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
To prevent unauthorized use of the database, Oracle recommends that you change all user passwords immediately after you upgrade your database.
<p>If the default security settings for Oracle Database 12<span class="italic">c</span> are in place, then passwords must be at least eight characters, and passwords such as <code dir="ltr">welcome</code> and <code dir="ltr">oracle</code> are not allowed. See <a class="olink DBSEG003" href="../DBSEG/authentication.htm#DBSEG003"><span class="italic">Oracle Database Security Guide</span></a> for information about configuring authentication.</p>
</div>
</div>
<!-- class="sect2" -->
<a id="CHDCDDHE"></a>
<div id="UPGRD60019" class="sect2">
<h3 class="sect2"><span class="secnum">3.2.4</span> About Windows Authentication When Upgrading</h3>
<p>On Windows systems, users who connect with the SYSDBA privilege can take advantage of Windows native authentication. If these users work with Oracle Database using their domain accounts, then you must explicitly grant them local administrative privileges and <code dir="ltr">ORA_DBA</code> membership.</p>
<p>Unlike earlier releases, it is not mandatory that the Oracle Database services run using the privileges of a Local System account. You can run Oracle Database services using the privileges of a Windows user account. To authenticate to the database, you can use the Oracle Database Windows-specific operating system groups.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink DBSEG99827" href="../DBSEG/authentication.htm#DBSEG99827"><span class="italic">Oracle Database Security Guide</span></a> for information on authenticating database administrators by using the operating system</p>
</li>
<li>
<p><a class="olink NTQRF120" href="../NTQRF/authen.htm#NTQRF120"><span class="italic">Oracle Database Platform Guide for Microsoft Windows</span></a> for information on authenticating database users with Windows</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CHDJBECI"></a>
<div id="UPGRD60002" class="sect2">
<h3 class="sect2"><span class="secnum">3.2.5</span> Moving a Database from an Existing 12<span class="italic">c</span> Oracle Home</h3>
<p>With DBUA you can migrate an Oracle Database 12<span class="italic">c</span> database from an existing 12<span class="italic">c</span> Oracle home to another 12<span class="italic">c</span> Oracle home.</p>
<p>To move a database from an existing 12<span class="italic">c</span> home to a new 12<span class="italic">c</span> Oracle home:</p>
<ol>
<li>
<p>Start DBUA as described in <a href="#CHDJJJEE">&#34;Using DBUA to Upgrade the Database on Linux, UNIX, and Windows Systems&#34;</a>.</p>
<p>DBUA starts with the The Select Operation page.</p>
<img width="812" height="612" src="img/dbua_movedb1.png" alt="Description of dbua_movedb1.png follows"/><br/>
<a id="sthref350" href="img_text/dbua_movedb1.htm">Description of the illustration &#39;&#39;dbua_movedb1.png&#39;&#39;</a><br/>
<br/></li>
<li>
<p>In the Select Operation page, choose <span class="bold">Move Database from a Different Release 12.1 Oracle Home</span> and click <span class="bold">Next</span>.</p>
<p>The Select Database page appears.</p>
<img width="814" height="613" src="img/dbua_movedb2.png" alt="Description of dbua_movedb2.png follows"/><br/>
<a id="sthref351" href="img_text/dbua_movedb2.htm">Description of the illustration &#39;&#39;dbua_movedb2.png&#39;&#39;</a><br/>
<br/></li>
<li>
<p>In the Select Database page, select the database you want to move to the new Oracle home. Only databases under a release 12<span class="italic">c</span> Oracle home appear. If you do not have an Oracle Database 12<span class="italic">c</span> database, then no database is available for the move operation.</p>
<p>Click <span class="bold">Next</span>. The Move Database Options page appears.</p>
</li>
<li>
<p>In the Move Database Options page, you can specify a different location for the diagnostic log files that DBUA creates, and you can optionally specify your custom SQL scripts, if any, to run after moving the database.</p>
<p>Click <span class="bold">Next</span>. The Database Move Summary page appears.</p>
</li>
<li>
<p>Review the summary for the move operation and click <span class="bold">Next</span>. The Progress page appears showing the processes for DBUA moving the database.</p>
</li>
<li>
<p>Click <span class="bold">Finish</span> when the move operation completes.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CHDFIFHF"></a>
<div id="UPGRD52861" class="sect2">
<h3 class="sect2"><span class="secnum">3.2.6</span> Using DBUA in Silent Mode<a id="sthref352"></a><a id="sthref353"></a> to Upgrade Oracle Database</h3>
<p>When invoked with the <code dir="ltr">-silent</code> command line option, DBUA operates in silent mode. In silent mode, DBUA does not present a user interface. DBUA writes messages (including information, errors, and warnings) to a log file in <span class="italic">ORACLE_HOME</span><code dir="ltr">/cfgtoollogs/dbua/SID/upgrade</code><span class="italic">n</span>, where <span class="italic">n</span> represents the consecutive number for the upgrade that DBUA has run. Oracle strongly recommends that you read the resulting DBUA log files to ensure a successful upgrade.</p>
<p class="itemizedlisttitle">To upgrade a database with DBUA in silent mode&nbsp;</p>
<ul>
<li>
<p>Issue the following command</p>
<pre dir="ltr">dbua -silent -sid ORCL &amp;
</pre>
<p>where the database is named <code dir="ltr">ORCL</code> in this example.</p>
</li>
</ul>
<div id="UPGRD52862" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref355"></a>
<h4 class="sect3"><span class="secnum">3.2.6.1</span> Oracle DBUA Command Line Options for Silent Mode</h4>
<p>Database Upgrade Assistant (DBUA) supports command line options when run in silent mode. <a href="#CHDBFBGA">Table 3-1</a> describes the various options and the corresponding parameters that are supported by DBUA.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If the default Oracle Database security settings are in place, then passwords must be at least eight characters, and passwords such as <code dir="ltr">welcome</code> and <code dir="ltr">oracle</code> are not allowed. See <a class="olink DBSEG10005" href="../DBSEG/guidelines.htm#DBSEG10005"><span class="italic">Oracle Database Security Guide</span></a> for more information.</div>
<div id="UPGRD52863" class="tblformal">
<p class="titleintable"><a id="sthref356"></a><a id="CHDBFBGA"></a>Table 3-1 DBUA Command Line Options</p>
<table class="cellalignment1841" title="DBUA Command Line Options" summary="This table is described in the preceding text" dir="ltr">
<thead>
<tr class="cellalignment1828">
<th class="cellalignment1838" id="r1c1-t26">Option</th>
<th class="cellalignment1838" id="r1c2-t26">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r2c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-silent</code></p>
</td>
<td class="cellalignment1834" headers="r2c1-t26 r1c2-t26">
<p>Specifies that DBUA should operate in silent mode.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r3c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-sid</code> <code dir="ltr"><span class="codeinlineitalic">SID</span></code></p>
</td>
<td class="cellalignment1834" headers="r3c1-t26 r1c2-t26">
<p>Specifies the system identifier (SID) of the database to upgrade.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r4c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-oracleHome</code> <code dir="ltr"><span class="codeinlineitalic">home_name</span></code></p>
</td>
<td class="cellalignment1834" headers="r4c1-t26 r1c2-t26">
<p>Specifies the Oracle Database home directory of the database to upgrade.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r5c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-oracleBase</code> <code dir="ltr"><span class="codeinlineitalic">base_name</span></code></p>
</td>
<td class="cellalignment1834" headers="r5c1-t26 r1c2-t26">
<p>Specifies the Oracle Database base directory of the database to upgrade.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r6c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-listeners</code></p>
</td>
<td class="cellalignment1834" headers="r6c1-t26 r1c2-t26">
<p>To create a listener in the Oracle home of the new release, specify <code dir="ltr"><span class="codeinlineitalic">listenrName:lsnrPort</span></code>.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r7c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-createListeners</code></p>
</td>
<td class="cellalignment1834" headers="r7c1-t26 r1c2-t26">
<p>To register the database with existing listeners, pass listeners by comma separated <code dir="ltr"><span class="codeinlineitalic">listenerName:Oracle Home</span></code>. Listeners from the earlier release home are migrated to the new release home. By specifying <code dir="ltr">-listeners</code> <code dir="ltr"><span class="codeinlineitalic">lsnrName1,lsnrName2</span></code>, DBUA searches the specified listeners from the Grid Infrastructure home (if Grid Infrastructure is configured), the target home, and the source home.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r8c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-diagnosticDest</code> <code dir="ltr"><span class="codeinlineitalic">diagnostic_destination</span></code></p>
</td>
<td class="cellalignment1834" headers="r8c1-t26 r1c2-t26">
<p>Specifies the default location to store Oracle trace and diagnostic files. It replaces the initialization parameter settings for background dump destination and user dump destination from earlier releases.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r9c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-sysDBAUserName</code> <code dir="ltr"><span class="codeinlineitalic">SYSDBA_user</span></code></p>
</td>
<td class="cellalignment1834" headers="r9c1-t26 r1c2-t26">
<p>Specifies a user with <code dir="ltr">SYSDBA</code> privileges.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r10c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-sysDBAPassword</code> <code dir="ltr"><span class="codeinlineitalic">SYSDBA_pwd</span></code></p>
</td>
<td class="cellalignment1834" headers="r10c1-t26 r1c2-t26">
<p>Specifies the password for <span class="italic">SYSDBA_user</span>.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r11c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-autoextendFiles</code></p>
</td>
<td class="cellalignment1834" headers="r11c1-t26 r1c2-t26">
<p>Autoextends database files during the upgrade. Data files revert to their original autoextend settings after the upgrade.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r12c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-newGlobalDbName</code> <code dir="ltr"><span class="codeinlineitalic">db_name</span></code></p>
</td>
<td class="cellalignment1834" headers="r12c1-t26 r1c2-t26">
<p>Specifies a new global database name. This option applies only if you are moving data files or upgrading an Oracle XE database.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r13c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-newSid</code> <code dir="ltr"><span class="codeinlineitalic">new_SID</span></code></p>
</td>
<td class="cellalignment1834" headers="r13c1-t26 r1c2-t26">
<p>Specifies a new system identifier (SID) of the database to upgrade. This option applies only if you are moving data files or upgrading an Oracle XE database.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r14c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-upgradeTimezone</code></p>
</td>
<td class="cellalignment1834" headers="r14c1-t26 r1c2-t26">
<p>Upgrades the time zone file version for the database.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r15c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-generateMapFile</code></p>
</td>
<td class="cellalignment1834" headers="r15c1-t26 r1c2-t26">
<p>Applies only if you are moving data files or upgrading an Oracle XE database. If you specify this option, then DBUA only generates a database map file in the log location and then exits.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r16c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-useASM</code></p>
</td>
<td class="cellalignment1834" headers="r16c1-t26 r1c2-t26">
<p>Applies only if you are moving data files or upgrading an Oracle XE database. If the database to upgrade has an Oracle ASM instance, then this option tells DBUA to use it for the upgrade.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r17c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-commonFileLocation</code> <code dir="ltr"><span class="codeinlineitalic">common_files</span></code></p>
</td>
<td class="cellalignment1834" headers="r17c1-t26 r1c2-t26">
<p>Specifies a common location to store database files. This option applies only if you are moving data files or upgrading an Oracle XE database.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r18c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-omfLocation</code> <code dir="ltr"><span class="codeinlineitalic">omf_area</span></code></p>
</td>
<td class="cellalignment1834" headers="r18c1-t26 r1c2-t26">
<p>Specifies a database area for Oracle Managed Files. This option applies only if you are moving data files or upgrading an Oracle XE database.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r19c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-databaseMapFile</code> <code dir="ltr"><span class="codeinlineitalic">map_file_name</span></code></p>
</td>
<td class="cellalignment1834" headers="r19c1-t26 r1c2-t26">
<p>Specifies the full name of the map file to map database files. This option applies only if you are moving data files or upgrading an Oracle XE database.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r20c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-newRecoveryArea</code> <code dir="ltr"><span class="codeinlineitalic">recover_area</span></code></p>
</td>
<td class="cellalignment1834" headers="r20c1-t26 r1c2-t26">
<p>Specifies the recovery area for a database that is moved during upgrade. This option applies only if you are moving data files or upgrading an Oracle XE database.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r21c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-newRecoveryAreaSize</code> <code dir="ltr"><span class="codeinlineitalic">recover_size</span></code></p>
</td>
<td class="cellalignment1834" headers="r21c1-t26 r1c2-t26">
<p>Specifies the recovery area size (MB) for a database that is moved during upgrade. This option applies only if you are moving data files or upgrading an Oracle XE database.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r22c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-apexAdminPassword</code> <code dir="ltr"><span class="codeinlineitalic">apex_pwd</span></code></p>
</td>
<td class="cellalignment1834" headers="r22c1-t26 r1c2-t26">
<p>Specifies the password for the Application Express Administrator.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r23c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-disableUpgradeScriptLogging</code></p>
</td>
<td class="cellalignment1834" headers="r23c1-t26 r1c2-t26">
<p>Disables the detailed log generation for running SQL scripts during the upgrade process. This is enabled by default. To enable log generation, do not specify this option.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r24c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-backupLocation</code> <code dir="ltr"><span class="codeinlineitalic">directory</span></code></p>
</td>
<td class="cellalignment1834" headers="r24c1-t26 r1c2-t26">
<p>Specifies a directory to back up your database before the upgrade starts.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r25c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-postUpgradeScripts</code> <code dir="ltr"><span class="codeinlineitalic">script</span></code> <code dir="ltr">[,</code> <code dir="ltr"><span class="codeinlineitalic">script</span></code> <code dir="ltr">] ...</code></p>
</td>
<td class="cellalignment1834" headers="r25c1-t26 r1c2-t26">
<p>Specifies a comma-delimited list of SQL scripts. Specify complete path names. The scripts are executed after the upgrade.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r26c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-initParam</code> <code dir="ltr"><span class="codeinlineitalic">parameter</span></code><code dir="ltr">=</code><code dir="ltr"><span class="codeinlineitalic">value</span></code> <code dir="ltr">[,</code> <code dir="ltr"><span class="codeinlineitalic">parameter</span></code><code dir="ltr">=</code><code dir="ltr"><span class="codeinlineitalic">value</span></code> <code dir="ltr">] ...</code></p>
</td>
<td class="cellalignment1834" headers="r26c1-t26 r1c2-t26">
<p>Specifies a comma-delimited list of initialization parameter values of the form <span class="italic">name</span>=<span class="italic">value</span>.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r27c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-disableArchiveLogMode</code></p>
</td>
<td class="cellalignment1834" headers="r27c1-t26 r1c2-t26">
<p>Turns off archiving and flashback logging for the duration of the upgrade.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r28c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-recompile_invalid_objects true|false</code></p>
</td>
<td class="cellalignment1834" headers="r28c1-t26 r1c2-t26">
<p>When you specify <code dir="ltr">TRUE</code> for this option, DBUA recompiles all invalid PL/SQL modules immediately after the upgrade is performed.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r29c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-degree_of_parallelism</code> <code dir="ltr"><span class="codeinlineitalic">number</span></code></p>
</td>
<td class="cellalignment1834" headers="r29c1-t26 r1c2-t26">
<p>Specifies the level to be used for parallel recompilation.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r30c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-recoveryAreaDestination</code> <code dir="ltr"><span class="codeinlineitalic">directory</span></code></p>
</td>
<td class="cellalignment1834" headers="r30c1-t26 r1c2-t26">
<p>Specifies the destination directory for all recovery files. This option applies only if you are moving data files, upgrading an Oracle XE database, or configuring Oracle Enterprise Manager.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r31c1-t26" headers="r1c1-t26">
<p><code dir="ltr">[-localRacSid</code> <code dir="ltr"><span class="codeinlineitalic">SID</span></code></p>
</td>
<td class="cellalignment1834" headers="r31c1-t26 r1c2-t26">
<p>Specifies the local SID of the cluster database if the cluster database is not registered in the Oracle Cluster Registry.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r32c1-t26" headers="r1c1-t26">
<p><code dir="ltr">-h | -help</code></p>
</td>
<td class="cellalignment1834" headers="r32c1-t26 r1c2-t26">
<p>Displays help for DBUA.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblformal" --></div>
<!-- class="sect3" -->
<div id="UPGRD52864" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref357"></a>
<h4 class="sect3"><span class="secnum">3.2.6.2</span> DBUA Command Line Syntax for Silent Mode</h4>
<p>You can specify all valid options from the command line using the following syntax:</p>
<pre dir="ltr">dbua [ -silent ] [ -sid <span class="italic">SID</span> ] [-oracleHome <span class="italic">home_name</span>] [-oracleBase <span class="italic">base_name</span>]
[-diagnosticDest <span class="italic">diagnostic_destination</span>]
[-sysDBAUserName <span class="italic">SYSDBA_user</span>] [-sysDBAPassword <span class="italic">SYSDBA_pwd</span>]
[-upgradeASM] [-autoextendFiles] [-newGlobalDbName <span class="italic">db_name</span>] [-newSid <span class="italic">new_SID</span>]
[-generateMapFile] [-useASM] [-commonFileLocation <span class="italic">common_files</span>]
[-omfLocation <span class="italic">omf_area</span>] [-databaseMapFile <span class="italic">map_file_name</span>]
[-newRecoveryArea <span class="italic">recover_area</span>] [-newRecoveryAreaSize <span class="italic">recover_size</span>]
[-apexAdminPassword <span class="italic">apex_pwd</span>] [-disableUpgradeScriptLogging ] 
[-backupLocation <span class="italic">directory</span>]
[-sysauxTablespace -datafileName <span class="italic">name</span> -datafileSize <span class="italic">size</span> 
  -datafileSizeNext <span class="italic">size</span> -datafileSizeMax <span class="italic">size</span>]
[-postUpgradeScripts <span class="italic">script</span> [, <span class="italic">script</span> ] ... ]
[-initParam <span class="italic">parameter</span>=<span class="italic">value</span> [, <span class="italic">parameter</span>=<span class="italic">value</span> ] ... ]
[-disableArchiveLogMode] [-recompile_invalid_objects true | false]
[-degree_of_parallelism <span class="italic">number</span>]
[-recoveryAreaDestination <span class="italic">directory</span>] [-h|-help]
</pre></div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDBBIFA"></a>
<div id="UPGRD52865" class="sect1">
<h2 class="sect1"><span class="secnum">3.3</span> About the Parallel Upgrade Utility for Oracle Database</h2>
<p>Oracle Database 12<span class="italic">c</span> introduces the Parallel Upgrade Utility (<code dir="ltr">catctl.pl</code>), which enables components that do not have to be upgraded in a specific order to be upgraded at the same time, taking full advantage of CPU capacity. Oracle continues to make improvements to the upgrade process to simplify both manual upgrades and upgrades performed with the Database Upgrade Assistant (DBUA). DBUA and the manual upgrade procedures take advantage of the new Parallel Upgrade Utility. The Parallel Upgrade Utility reduces the total amount of time it takes to perform an upgrade by loading the database dictionary in parallel using multiple SQL processes to upgrade the database.</p>
<p>Related topics about the new Parallel Upgrade Utility (<code dir="ltr">catctl.pl</code>) are as follows:</p>
<ul>
<li>
<p><a href="#CHDDEIFJ">General Steps for Running the New Parallel Upgrade Utility (catctl.pl)</a></p>
</li>
<li>
<p><a href="#CHDFHHEB">Parallel Upgrade Utility (catctl.pl) Parameters</a></p>
</li>
<li>
<p><a href="#CHDJICFA">Example for Using the Parallel Upgrade Utility</a></p>
</li>
</ul>
<a id="CHDDEIFJ"></a>
<div id="UPGRD52866" class="sect2">
<h3 class="sect2"><span class="secnum">3.3.1</span> General Steps for Running the New Parallel Upgrade Utility (catctl.pl)</h3>
<p>The Parallel Upgrade Utility loads the data dictionary and components in parallel, thus reducing the overall upgrade time. Before invoking the Parallel Upgrade Utility, <code dir="ltr">catctl.pl</code>, follow the procedures for backing up your database that you would normally do before upgrading. Also, as a prerequisite, you must run the Pre-Upgrade Information Tool (<code dir="ltr">preupgrd.sql</code>) to identify any problems that a database administrator must address before the upgrade proceeds.</p>
<p>The detailed procedure for manually running <code dir="ltr">catctl.pl</code> is described in <a href="#CACGGHJC">&#34;Manually Upgrading a Multitenant Container Oracle Database (CDB)&#34;</a>. The general steps for upgrading your database with the Parallel Upgrade Utility are as follows:</p>
<ol>
<li>
<p>Back up your current database as described in <a href="preup.htm#BABGEICG">&#34;Backing Up Oracle Database for Upgrading&#34;</a>.</p>
</li>
<li>
<p>Install the Oracle Database 12<span class="italic">c</span> software for the new release as described in <a href="preup.htm#BABJHIEH">&#34;Installing the New Oracle Database Software&#34;</a>.</p>
</li>
<li>
<p>Ensure the Pre-Upgrade Information Tool (<code dir="ltr">preupgrd.sql</code>) has been run on the source database as described in <a href="preup.htm#BABBCGJC">&#34;About the Pre-Upgrade Information Tool for Oracle Database&#34;</a>.</p>
</li>
<li>
<p>From the <code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code><code dir="ltr">/rdbms/admin</code> directory, start SQL*Plus.</p>
</li>
<li>
<p>Connect to the database to be upgraded using an account with DBA privileges:</p>
<pre dir="ltr">CONNECT / AS SYSDBA
</pre></li>
<li>
<p>Start the database in upgrade mode.</p>
<p>For a multitenant container database (CDB):</p>
<pre dir="ltr">SQL&gt; alter pluggable database all open upgrade;
</pre>
<p>For a non-CDB:</p>
<pre dir="ltr">SQL&gt; startup upgrade
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
The <code dir="ltr">UPGRADE</code> keyword performs operations that prepare the environment for the upgrade.</div>
<p>You might be required to use the <code dir="ltr">PFILE</code> option in your startup command to specify the location of your initialization parameter file. See <a class="olink ADMIN12825" href="../ADMIN/start.htm#ADMIN12825"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about specifying initialization parameters at startup and the initialization parameter file.</p>
<p>Once the database is started in upgrade mode, only queries on fixed views execute without errors until after the <code dir="ltr">catctl.pl</code> script is run. Before running <code dir="ltr">catctl.pl</code>, queries on any other view or the use of PL/SQL returns an error.</p>
<p>If errors appear listing desupported initialization parameters, then make a note of the desupported initialization parameters and continue with the upgrade. Remove the desupported initialization parameters the next time you shut down the database.</p>
</li>
<li>
<p>Exit SQL*Plus.</p>
</li>
<li>
<p>Run <code dir="ltr">catctl.pl</code> from the new Oracle home. See <a href="#CHDFHHEB">&#34;Parallel Upgrade Utility (catctl.pl) Parameters&#34;</a> for the parameters available for running <code dir="ltr">catctl.pl</code>.</p>
<p>To run <code dir="ltr">catctl.pl</code> on Linux:</p>
<pre dir="ltr">cd $ORACLE_HOME/rdbms/admin
$ORACLE_HOME/perl/bin/perl catctl.pl catupgrd.sql -l
</pre>
<p>To run <code dir="ltr">catctl.pl</code> on Windows:</p>
<pre dir="ltr">cd %ORACLE_HOME%\rdbms\admin
%ORACLE_HOME%\perl\bin\perl catctl.pl catupgrd.sql -l
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CHDFHHEB"></a>
<div id="UPGRD52867" class="sect2">
<h3 class="sect2"><span class="secnum">3.3.2</span> Parallel Upgrade Utility (catctl.pl) Parameters</h3>
<p>The parameters listed in <a href="#CHDHIFAA">Table 3-2</a> are available when invoking <code dir="ltr">catctl.pl</code>. See <a href="#CHDJICFA">&#34;Example for Using the Parallel Upgrade Utility&#34;</a> for more information on how <code dir="ltr">catctl.pl</code> processes the upgrade phases and for an example.</p>
<div id="UPGRD52868" class="tblhruleformal">
<p class="titleintable"><a id="sthref358"></a><a id="CHDHIFAA"></a>Table 3-2 catctl.pl Parameters</p>
<table class="cellalignment1837" title="catctl.pl Parameters" summary="The catctl.pl parameters table lists the arguments for the parallel upgrade utility. Column 1 is for parameter, and Column 2 provides the description." dir="ltr">
<thead>
<tr class="cellalignment1828">
<th class="cellalignment1838" id="r1c1-t28">Parameter</th>
<th class="cellalignment1838" id="r1c2-t28">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r2c1-t28" headers="r1c1-t28">
<p>-c</p>
</td>
<td class="cellalignment1834" headers="r2c1-t28 r1c2-t28">
<p>Specifies the PDBs that you want to upgrade.</p>
<p>This parameter provides an inclusion list. For example, include the PDBs named here (skip all PDBs not named here):</p>
<p>For Linux and UNIX (use single quotes):</p>
<pre dir="ltr">-c &#39;PDB1 PDB2&#39;
</pre>
<p>For Windows (use double quotes):</p>
<pre dir="ltr">-c &#34;PDB1 PDB2&#34;
</pre></td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r3c1-t28" headers="r1c1-t28">
<p>-C</p>
</td>
<td class="cellalignment1834" headers="r3c1-t28 r1c2-t28">
<p>Specifies the PDBs that you do not want to upgrade.</p>
<p>This parameter provides an exclusion list. For example, skip all PDBs named here (all other PDBs are upgraded):</p>
<p>For Linux and UNIX (use single quotes):</p>
<pre dir="ltr">-C &#39;PDB1 PDB2&#39;
</pre>
<p>For Windows (use double quotes):</p>
<pre dir="ltr">-C &#34;PDB1 PDB2&#34;
</pre>
<p>Note: <code dir="ltr">-c</code> and <code dir="ltr">-C</code> are mutually exclusive.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r4c1-t28" headers="r1c1-t28">
<p>-d</p>
</td>
<td class="cellalignment1834" headers="r4c1-t28 r1c2-t28">
<p>Specifies the location of the directory containing the files to be processed.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r5c1-t28" headers="r1c1-t28">
<p>-e</p>
</td>
<td class="cellalignment1834" headers="r5c1-t28 r1c2-t28">
<p>Sets echo OFF while running the scripts. The default is echo ON.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r6c1-t28" headers="r1c1-t28">
<p>-i</p>
</td>
<td class="cellalignment1834" headers="r6c1-t28 r1c2-t28">
<p>Specifies an identifier to use when creating spool log files.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r7c1-t28" headers="r1c1-t28">
<p>-l</p>
</td>
<td class="cellalignment1834" headers="r7c1-t28 r1c2-t28">
<p>Specifies the location for the directory to use for spool log files. The default is the current working directory.</p>
<p>Oracle strongly recommends that you do not write log files to the <code dir="ltr">\admin</code> directory.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r8c1-t28" headers="r1c1-t28">
<p>-M</p>
</td>
<td class="cellalignment1834" headers="r8c1-t28 r1c2-t28">
<p>Keeps CDB$ROOT in UPGRADE mode while the PDBs are upgraded.For non-CDBs, this parameter is ignored.During CDB upgrades, using this parameter setting places the CDB and all of its PDBs in upgrade mode, which may reduce total upgrade time. However, you cannot bring up any of the PDBs until the CDB and all of its PDBs are upgraded.By default, if you do not use the -M parameter setting, then CDB$ROOT is upgraded and restarted in normal mode, and the normal background processes are started. As each PDB is upgraded, you can bring the PDB online while other PDBs are still being upgraded.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r9c1-t28" headers="r1c1-t28">
<p>-n</p>
</td>
<td class="cellalignment1834" headers="r9c1-t28 r1c2-t28">
<p>Specifies the number of processes to use for parallel operations.</p>
<p>For non-CDBs, it specifies the number of SQL processors to use when upgrading the database. The maximum value is 8. The minimum value is 1. The default value is 4.</p>
<p>For CDBs, multiple PDB upgrades are processed together. The number of PDBs upgraded concurrently is controlled by the value of the -n parameter. The default value is the number of CPUs divided by 2 (cpu_count/2). A cpu_count equal to 24 equates to 12 PDB upgrades running concurrently. The maximum value is 64. The minimum value is 4. The maximum PDB upgrades running concurrently is 32 (64/2), and the minimum value is 2 (4/2).</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r10c1-t28" headers="r1c1-t28">
<p>-N</p>
</td>
<td class="cellalignment1834" headers="r10c1-t28 r1c2-t28">
<p>Specifies the number of SQL processors to use when upgrading PDBs.</p>
<p>For non-CDBs, this parameter is ignored.</p>
<p>For CDBs, the maximum value is 8. The minimum value is 1. The default value is 2.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r11c1-t28" headers="r1c1-t28">
<p>-p</p>
</td>
<td class="cellalignment1834" headers="r11c1-t28 r1c2-t28">
<p>Restarts the specified phase (skip successful phases on a rerun).</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r12c1-t28" headers="r1c1-t28">
<p>-P</p>
</td>
<td class="cellalignment1834" headers="r12c1-t28 r1c2-t28">
<p>Stop the specified phase.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r13c1-t28" headers="r1c1-t28">
<p>-s</p>
</td>
<td class="cellalignment1834" headers="r13c1-t28 r1c2-t28">
<p>Names the SQL script to initialize sessions.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r14c1-t28" headers="r1c1-t28">
<p>-S</p>
</td>
<td class="cellalignment1834" headers="r14c1-t28 r1c2-t28">
<p>Specify <span class="italic">serial</span> upgrade instead of parallel.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r15c1-t28" headers="r1c1-t28">
<p>-u</p>
</td>
<td class="cellalignment1834" headers="r15c1-t28 r1c2-t28">
<p>Specifies username and prompts for password.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r16c1-t28" headers="r1c1-t28">
<p>-y</p>
</td>
<td class="cellalignment1834" headers="r16c1-t28 r1c2-t28">
<p>Displays phases only.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r17c1-t28" headers="r1c1-t28">
<p>-z</p>
</td>
<td class="cellalignment1834" headers="r17c1-t28 r1c2-t28">
<p>Turns on debug information for catcon.pm.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r18c1-t28" headers="r1c1-t28">
<p>-Z</p>
</td>
<td class="cellalignment1834" headers="r18c1-t28 r1c2-t28">
<p>Turns on debug tracing information for <code dir="ltr">catctl.pl</code>.</p>
<p>For example, to set the number to 1, enter <code dir="ltr">-Z 1</code>.</p>
</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="tblhruleformal" --></div>
<!-- class="sect2" -->
<a id="CHDJICFA"></a>
<div id="UPGRD52869" class="sect2">
<h3 class="sect2"><span class="secnum">3.3.3</span> Example for Using the Parallel Upgrade Utility</h3>
<p>The <code dir="ltr">catctl.pl</code> Parallel Upgrade Utility is integrated with DBUA. However, for manual, command line upgrades, you can run <code dir="ltr">catctl.pl</code> with various parameters. For example, to run <code dir="ltr">catctl.pl</code> in serial mode instead of using parallel operations, specify the -S parameter. See <a href="#CHDHIFAA">Table 3-2, &#34;catctl.pl Parameters&#34;</a> for the available parameters.</p>
<div id="UPGRD52870" class="example">
<p class="titleinexample"><a id="sthref359"></a>Example 3-1 Running catctl.pl with select parameters</p>
<p>If -n 4 is used when invoking <code dir="ltr">catctl.pl</code>, then catupgrd0.log, catupgrd1.log, catupgrd2.log, and catupgrd3.log are created during the upgrade process. When evaluating if an upgrade succeeded or failed, all of the catupgrd#.log files must be checked. If <code dir="ltr">catctl.pl</code> is rerun, then the previous log files are overwritten unless you specify a different log directory.</p>
<pre dir="ltr">cd $ORACLE_HOME/rdbms/admin
$ORACLE_HOME/perl/bin/perl catctl.pl -n 4 -l $ORACLE_HOME/diagnostics catupgrd.sql
</pre></div>
<!-- class="example" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDBHAHE"></a>
<div class="sect1">
<h2 class="sect1"><span class="secnum">3.4</span> Manually Upgrading a Non-CDB Oracle Database</h2>
<p>After installing the software for Oracle Database 12<span class="italic">c</span> and preparing the new Oracle home, you can proceed with a manual, command-line upgrade rather than use DBUA.</p>
<p>The procedure in this section provides steps for upgrading an Oracle Database that is <span class="bold">not</span> an Oracle Multitenant container database (CDB). This procedure assumes that you installed the software for Oracle Database 12<span class="italic">c</span>, that you prepared the new Oracle home, and that you have run the Pre-Upgrade Information Tool. Refer to <a href="preup.htm#BABJHIEH">&#34;Installing the New Oracle Database Software&#34;</a> and <a href="preup.htm#BABGBFCJ">&#34;Preparing the New Oracle Home for Upgrading&#34;</a> for additional procedures.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink CNCPT89234" href="../CNCPT/cdbovrvw.htm#CNCPT89234"><span class="italic">Oracle Database Concepts</span></a> for an overview of multitenant architecture</div>
<p>To manually upgrade a non-CDB database:</p>
<ol>
<li>
<p>If you have not done so, run the Pre-Upgrade Information Tool as described in <a href="preup.htm#BABBCGJC">&#34;About the Pre-Upgrade Information Tool for Oracle Database&#34;</a>. Review the Pre-Upgrade Information tool output and correct all issues noted in the output before proceeding. Refer to <a href="preup.htm#BABHHIBG">&#34;Pre-Upgrade Information Tool Warnings and Recommendations for Oracle Database&#34;</a> for information about fixing any issues.</p>
</li>
<li>
<p>Back up the source database as described in <a href="preup.htm#BABGEICG">&#34;Backing Up Oracle Database for Upgrading&#34;</a>.</p>
</li>
<li>
<p>If you have not done so, prepare the new Oracle home as described in <a href="preup.htm#BABGBFCJ">&#34;Preparing the New Oracle Home for Upgrading&#34;</a>.</p>
</li>
<li>
<p>Shut down the database.</p>
<pre dir="ltr">SQL&gt; SHUTDOWN IMMEDIATE
</pre></li>
<li>
<p>If your operating system is Windows, then complete the following steps:</p>
<ol>
<li>
<p>Stop the <code dir="ltr">OracleService</code><code dir="ltr"><span class="codeinlineitalic">SID</span></code> Oracle service of the database you are upgrading, where <code dir="ltr"><span class="codeinlineitalic">SID</span></code> is the instance name. For example, if your <code dir="ltr"><span class="codeinlineitalic">SID</span></code> is <code dir="ltr">ORCL</code>, then enter the following at a command prompt:</p>
<pre dir="ltr">C:\&gt; NET STOP OracleServiceORCL
</pre></li>
<li>
<p><a id="sthref360"></a><a id="sthref361"></a>Delete the Oracle service at a command prompt using <code dir="ltr">ORADIM</code>. Refer to <a href="#CHDJEGFH">&#34;Variables for using ORADIM When Upgrading Oracle Database on Windows&#34;</a> for more information. Refer to your platform guide for a complete list of the <code dir="ltr">ORADIM</code> syntax and commands.</p>
<p>If your <code dir="ltr"><span class="codeinlineitalic">SID</span></code> is <code dir="ltr">ORCL</code>, then enter the following command. Substitute the actual name for your <code dir="ltr"><span class="codeinlineitalic">SID</span></code>.</p>
<pre dir="ltr">C:\&gt; ORADIM -DELETE -SID ORCL
</pre></li>
<li>
<p>Create the service for Oracle Database 12<span class="italic">c</span> at a command prompt using the <code dir="ltr">ORADIM</code> command of the new Oracle Database release as shown in the following example:</p>
<pre dir="ltr">C:\&gt; ORADIM -NEW -SID <span class="italic">SID</span> -SYSPWD <span class="italic">PASSWORD</span> -MAXUSERS <span class="italic">USERS</span>
     -STARTMODE AUTO -PFILE <span class="italic">ORACLE_HOME</span>\DATABASE\INIT<span class="italic">SID</span>.ORA
</pre>
<p>Most Oracle Database services log on to the system using the privileges of the Oracle Home User. The service runs with the privileges of this user. The <code dir="ltr">ORADIM</code> command prompts you for the password to this user account. You can specify other options using <code dir="ltr">ORADIM</code>.</p>
<p>In this example, if your <code dir="ltr">SID</code> is <code dir="ltr">ORCL</code>, your <code dir="ltr">password</code> (<code dir="ltr">SYSPWD</code>) is <code dir="ltr">TWxy5791</code>, the maximum number of users (<code dir="ltr">MAXUSERS</code>) is 10, and the <span class="italic">ORACLE_HOME</span> directory is <code dir="ltr">C:\ORACLE\PRODUCT\11.2.0\DB</code>, then enter the following command:</p>
<pre dir="ltr">C:\&gt; ORADIM -NEW -SID ORCL -SYSPWD TWxy5791 -MAXUSERS 10
-STARTMODE AUTO -PFILE C:\ORACLE\PRODUCT\11.2.0\DB\DATABASE\INITORCL.ORA
</pre>
<p><code dir="ltr">ORADIM</code> writes a log file to the <code dir="ltr">ORACLE_HOME\database</code> directory. The log file contains the name of the PDB in the multitenant database.</p>
</li>
</ol>
</li>
<li>
<p><a id="sthref362"></a>If your operating system is Linux or UNIX, then perform the following checks:</p>
<ol>
<li>
<p>Your <code dir="ltr">ORACLE_SID</code> is set correctly</p>
</li>
<li>
<p>The <code dir="ltr">oratab</code> file points to the Oracle home for Oracle Database 12<span class="italic">c</span></p>
</li>
<li>
<p>The following environment variables point to the Oracle Database 12<span class="italic">c</span> directories:</p>
<ul>
<li>
<p><code dir="ltr">ORACLE_HOME</code></p>
</li>
<li>
<p><code dir="ltr">PATH</code></p>
</li>
</ul>
</li>
<li>
<p>Any scripts that clients use to set the <span class="italic">ORACLE_HOME</span> value must point to the new Oracle home.</p>
</li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you are upgrading a cluster database, then perform these checks on all nodes on which this cluster database has instances configured.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink GINST" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=GINST"><span class="italic">Oracle Database Installation Guide</span></a> for operating system-specific information about setting other important environment variables on your operating system</div>
</li>
<li>
<p>Log in to the system as the owner of the Oracle home under the new Oracle Database 12<span class="italic">c</span>.</p>
</li>
<li>
<p>From the <code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code><code dir="ltr">/rdbms/admin</code> directory, start SQL*Plus.</p>
</li>
<li>
<p>Connect to the database to be upgraded using an account with DBA privileges:</p>
<pre dir="ltr">SQL&gt; CONNECT / AS SYSDBA
</pre></li>
<li>
<p>Start the instance by issuing the following command in SQL*Plus:</p>
<pre dir="ltr">SQL&gt; startup upgrade pfile=<span class="codeinlineitalic">pfile_name</span>
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
The <code dir="ltr">UPGRADE</code> keyword enables you to open a database based on an earlier Oracle Database release. It also restricts logons to <code dir="ltr">AS SYSDBA</code> sessions, disables system triggers, and performs additional operations that prepare the environment for the upgrade.</div>
<p>Specify the location of your initialization parameter file <code dir="ltr">PFILE</code>. See <a class="olink ADMIN12825" href="../ADMIN/start.htm#ADMIN12825"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about specifying initialization parameters at startup and the initialization parameter file.</p>
<p>If errors appear listing desupported initialization parameters, then make a note of the desupported initialization parameters and continue with the upgrade. Remove the desupported initialization parameters the next time you shut down the database.</p>
</li>
<li>
<p>Exit SQL*Plus before proceeding to the next step.</p>
</li>
<li>
<p><a id="sthref363"></a><a id="sthref364"></a>Run the <code dir="ltr">catctl.pl</code> script from the new Oracle home as described in this step. The Parallel Upgrade Utility, <code dir="ltr">catctl.pl</code>, provides parallel upgrade options that reduce downtime.</p>
<p>To run <code dir="ltr">catctl.pl</code> on Linux:</p>
<pre dir="ltr">cd $ORACLE_HOME/rdbms/admin
$ORACLE_HOME/perl/bin/perl catctl.pl catupgrd.sql
</pre>
<p>To run <code dir="ltr">catctl.pl</code> on Windows:</p>
<pre dir="ltr">cd %ORACLE_HOME%\rdbms\admin
%ORACLE_HOME%\perl\bin\perl catctl.pl catupgrd.sql
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
<ul>
<li>
<p>You can use the -d option to specify the directory that contains the files to be processed, and -l to specify the directory to use for spool log files. You can use <code dir="ltr">catctl.pl -S</code> to run the upgrade processes serially. Refer to <a href="#CHDHIFAA">Table 3-2, &#34;catctl.pl Parameters&#34;</a> for all the options.</p>
</li>
<li>
<p>If you choose to run the <code dir="ltr">catupgrd.sql</code> script on a non-CDB, then doing so now requires an additional input parameter as follows:</p>
<pre dir="ltr">SQL&gt; @catupgrd.sql PARALLEL=NO
</pre></li>
</ul>
</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#CHDDEIFJ">&#34;General Steps for Running the New Parallel Upgrade Utility (catctl.pl)&#34;</a> for information about <code dir="ltr">catctl.pl</code> parameters and options</div>
</li>
<li>
<p>The upgraded database is shut down after running <code dir="ltr">catctl.pl</code>. Restart the instance to reinitialize the system parameters for normal operation.</p>
<pre dir="ltr">SQL&gt; STARTUP
</pre>
<p>This restart, following the database shutdown performed as part of the <code dir="ltr">catctl.pl</code> script, flushes all caches, clears buffers, and performs other housekeeping activities. These measures are an important final step to ensure the integrity and consistency of the newly upgraded Oracle Database software.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you encountered a message listing desupported initialization parameters when you started the database in Step&nbsp;<a href="#i1012182">11</a>, then remove the desupported initialization parameters from the parameter file before restarting. If necessary, convert the <code dir="ltr">SPFILE</code> to a <code dir="ltr">PFILE</code> so you can edit the file to delete parameters. See <a class="olink ADMIN12825" href="../ADMIN/start.htm#ADMIN12825"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about specifying initialization parameters at startup and the initialization parameter file.</div>
</li>
<li>
<p><span class="bold">Important:</span> The <code dir="ltr">catuppst.sql</code> script is run as part of the upgrade unless the upgrade returns errors during the process. Check the log file for &#34;Rem BEGIN catuppst.sql&#34; to verify that <code dir="ltr">catuppst.sql</code> ran during the upgrade process.</p>
<p>If <code dir="ltr">catuppst.sql</code> has not run, then proceed to run <code dir="ltr">catuppst.sql</code> as shown in this step. Warning messages are also displayed when running <code dir="ltr">catctl.pl</code> indicating that <code dir="ltr">catuppst.sql</code> was not run during the upgrade.</p>
<p>Run <code dir="ltr">catuppst.sql</code> as follows:</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl catcon.pl -n 1 -e -b catuppst -d &#39;&#39;&#39;.&#39;&#39;&#39; catuppst.sql
</pre>
<p>The log file <code dir="ltr">catuppst0.log</code> will be generated with the results of the post upgrade.</p>
</li>
<li>
<p>Run <a id="sthref365"></a><code dir="ltr">catcon.pl</code> to invoke <a id="sthref366"></a><a id="sthref367"></a><a id="sthref368"></a><code dir="ltr">utlrp.sql</code> to recompile any remaining stored PL/SQL and Java code. Use the following syntax:</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl catcon.pl -n 1 -e -b utlrp -d &#39;&#39;&#39;.&#39;&#39;&#39; utlrp.sql
</pre>
<p>The log file <code dir="ltr">utlrp0.log</code> is generated with the results of the recompilations.</p>
</li>
<li>
<p>Run <code dir="ltr">postupgrade_fixups.sql</code>. See <a href="afterup.htm#CHDJACCG">&#34;Run the postupgrade_fixups.sql Script.&#34;</a></p>
</li>
<li>
<p>Run <code dir="ltr">utlu121s.sql</code> to verify that all issues have been fixed.</p>
<pre dir="ltr">SQL&gt; @rdbms/admin/utlu121s.sql
</pre>
<p>The log file <code dir="ltr">utlu121s0.log</code> will be generated with the upgrade results.</p>
<p>To see information about the state of the database, you can run <code dir="ltr">utlu121s.sql</code> as many times as you want, any time <span class="italic">after</span> completing the upgrade. If the <code dir="ltr">utlu121s.sql</code> script returns errors or shows components that are not <code dir="ltr">VALID</code> or not the most recent release, then see <a href="#i1012368">&#34;Troubleshooting the Upgrade for Oracle Database&#34;</a> for more information.</p>
</li>
<li>
<p>Verify that all expected packages and classes are valid. (This step assumes that you previously ran <code dir="ltr">preupgrd.sql</code> before starting the upgrade.)</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl catcon.pl -n 1 -e -b utluiobj -d &#39;&#39;&#39;.&#39;&#39;&#39; utluiobj.sql
</pre>
<p>The log file <code dir="ltr">utluiobj0.log</code> will be generated with the results of the verification.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If the Pre-upgrade Information Tool detected <code dir="ltr">INVALID</code> objects and populated the <code dir="ltr">registry$sys_inv_objs</code> and <code dir="ltr">registry$nonsys_inv_objs</code> tables, then execute <code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code><code dir="ltr">/rdbms/admin/utluiobj.sql</code> to display only those objects which are newly invalid because of the upgrade process. The <code dir="ltr">utluiobj.sql</code> script only displays objects that are now <code dir="ltr">INVALID</code> but which were <code dir="ltr">VALID</code> before the upgrade. See <a href="preup.htm#BABCEFJD">&#34;Using the Pre-Upgrade Information Tool (preupgrd.sql).&#34;</a>.</div>
</li>
<li>
<p>Exit SQL*Plus if you are still in it.</p>
</li>
<li>
<p>If you are upgrading a cluster database from releases 10.2, 11.1, or 11.2, then upgrade the database configuration in Oracle Clusterware using the following command:</p>
<pre dir="ltr">$ srvctl upgrade database -d <span class="italic">db-unique-name</span> -o <span class="italic">oraclehome</span>
</pre>
<p>where <code dir="ltr"><span class="codeinlineitalic">db-unique-name</span></code> is the database name assigned to it (not the instance name), and <code dir="ltr"><span class="codeinlineitalic">oraclehome</span></code> is the Oracle home location in which the database is being upgraded. The <code dir="ltr">SRVCTL</code> utility supports long GNU-style options in addition to short CLI options used in earlier releases.</p>
</li>
</ol>
<p>Your database is now upgraded to Oracle Database 12<span class="italic">c</span>. You are ready to complete the procedures described in <a href="afterup.htm#BABEEEFF">Chapter 4, &#34;Post-Upgrade Tasks for Oracle Database&#34;</a>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<a id="sthref369"></a>Oracle Warehouse Builder (OWB) components are not upgraded as part of the Oracle Database upgrade process. Oracle Warehouse Builder is not installed as part of Oracle Database 12<span class="italic">c</span>. See <a href="preup.htm#BABBHCBB">&#34;Requirement for Upgrading Databases that Use Oracle Warehouse Builder (OWB)&#34;</a> for more information.</div>
<div class="infoboxnotewarn">
<p class="notep1">Caution:</p>
<p class="warnsp">If you retain the old Oracle software, then never start the upgraded database with the old software. Only start the database with the executables in the new Oracle Database installation. Also, before you remove the old Oracle environment, make sure you relocate any data files in that environment to the new Oracle Database environment. See the <a class="olink ADMIN012" href="../ADMIN/dfiles.htm#ADMIN012"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about relocating data files.</p>
</div>
<a id="CHDJEGFH"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.4.1</span> Variables for using ORADIM When Upgrading Oracle Database on Windows</h3>
<p>On Windows platforms, <code dir="ltr">ORADIM</code> provides a command-line interface to manually perform administrative tasks for Windows databases and services. Database Configuration Assistant (DBCA) provides a graphical user interface to perform the same tasks. The variables for ORADIM that you must know about when upgrading Oracle Database include the SID of the database you are upgrading, the new Oracle home location, and the password for the new database instance. Also, <code dir="ltr">ORADIM</code> writes a log file to the <code dir="ltr">ORACLE_HOME\database</code> directory.</p>
<p>The following table describes the variables for using <code dir="ltr">ORADIM</code> when upgrading:</p>
<div class="inftblinformal">
<table class="cellalignment1837" title="ORADIM Syntax" summary="This table is described in the preceding text" dir="ltr">
<thead>
<tr class="cellalignment1828">
<th class="cellalignment1838" id="r1c1-t39">ORADIM Variable</th>
<th class="cellalignment1838" id="r1c2-t39">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r2c1-t39" headers="r1c1-t39"><code dir="ltr"><span class="codeinlineitalic">SID</span></code></td>
<td class="cellalignment1834" headers="r2c1-t39 r1c2-t39">The same SID name as the SID of the database you are upgrading.</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r3c1-t39" headers="r1c1-t39"><code dir="ltr"><span class="codeinlineitalic">PASSWORD</span></code></td>
<td class="cellalignment1834" headers="r3c1-t39 r1c2-t39">The password for the new Oracle Database 12<span class="italic">c</span> database instance. This is the password for the user connected with <code dir="ltr">SYSDBA</code> privileges. The <code dir="ltr">-SYSPWD</code> option is required.
<p>The default Oracle Database 12<span class="italic">c</span> security settings require that passwords must be at least eight characters, and passwords such as <code dir="ltr">welcome</code> and <code dir="ltr">oracle</code> are not allowed. See <a class="olink DBSEG10005" href="../DBSEG/guidelines.htm#DBSEG10005"><span class="italic">Oracle Database Security Guide</span></a> for more information.</p>
</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r4c1-t39" headers="r1c1-t39"><code dir="ltr"><span class="codeinlineitalic">USERS</span></code></td>
<td class="cellalignment1834" headers="r4c1-t39 r1c2-t39">The maximum number of users who can be granted <code dir="ltr">SYSDBA</code> and <code dir="ltr">SYSOPER</code> privileges.</td>
</tr>
<tr class="cellalignment1828">
<td class="cellalignment1834" id="r5c1-t39" headers="r1c1-t39"><code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code></td>
<td class="cellalignment1834" headers="r5c1-t39 r1c2-t39">The Oracle home location for Oracle Database 12<span class="italic">c</span>. Ensure that you specify the full path name with the <code dir="ltr">-PFILE</code> option, including the drive letter of the Oracle home location. See <a class="olink ADMIN12825" href="../ADMIN/start.htm#ADMIN12825"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about specifying initialization parameters at startup and the initialization parameter file.</td>
</tr>
</tbody>
</table>
<br/></div>
<!-- class="inftblinformal" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink NTQRF070" href="../NTQRF/admin.htm#NTQRF070"><span class="italic">Oracle Database Platform Guide for Microsoft Windows</span></a> for complete information about using ORADIM to administer a database instance</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CACGGHJC"></a>
<div id="UPGRD12408" class="sect1">
<h2 class="sect1"><span class="secnum">3.5</span> Manually Upgrading a Multitenant Container Oracle Database (CDB)</h2>
<p>Oracle Database 12<span class="italic">c</span> introduces multitenant architecture, which enables an Oracle database to function as a <a id="sthref370"></a>multitenant container database (CDB) with pluggable databases. You can upgrade the CDB, thereby upgrading all the pluggable databases in the CDB at the same time. After installing the software for Oracle Database 12<span class="italic">c</span> and preparing the new Oracle home, you can proceed with a manual, command-line upgrade rather than use DBUA.</p>
<p>The procedure in this section provides steps for upgrading a CDB. This procedure assumes that you installed the software for Oracle Database 12<span class="italic">c</span>, that you prepared the new Oracle home, and that you have run the Pre-Upgrade Information Tool. Refer to <a href="preup.htm#BABJHIEH">&#34;Installing the New Oracle Database Software&#34;</a> and <a href="preup.htm#BABGBFCJ">&#34;Preparing the New Oracle Home for Upgrading&#34;</a> for additional procedures.</p>
<p>To manually upgrade a CDB database:</p>
<ol>
<li>
<p>If you have not done so, run the Pre-Upgrade Information Tool as described in <a href="preup.htm#BABBCGJC">&#34;About the Pre-Upgrade Information Tool for Oracle Database&#34;</a>. Review the Pre-Upgrade Information tool output and correct all issues noted in the output before proceeding. Refer to <a href="preup.htm#BABHHIBG">&#34;Pre-Upgrade Information Tool Warnings and Recommendations for Oracle Database&#34;</a> for information about fixing any issues.</p>
</li>
<li>
<p>Back up the source database as described in <a href="preup.htm#BABGEICG">&#34;Backing Up Oracle Database for Upgrading&#34;</a>.</p>
</li>
<li>
<p>If you have not done so, prepare the new Oracle home as described in <a href="preup.htm#BABGBFCJ">&#34;Preparing the New Oracle Home for Upgrading&#34;</a>.</p>
</li>
<li>
<p>Shut down the database. (The syntax is the same for a non-CDB and a CDB.)</p>
<pre dir="ltr">SQL&gt; SHUTDOWN IMMEDIATE
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
To close a PDB, you can specify it from the CDB root: <code dir="ltr">alter pluggable database</code> <code dir="ltr"><span class="codeinlineitalic">PDBname</span></code> <code dir="ltr">close</code>.</div>
</li>
<li>
<p>If your operating system is Windows, then complete the following steps:</p>
<ol>
<li>
<p>Stop the <code dir="ltr">OracleService</code><code dir="ltr"><span class="codeinlineitalic">SID</span></code> Oracle service of the database you are upgrading, where <code dir="ltr"><span class="codeinlineitalic">SID</span></code> is the instance name. For example, if your <code dir="ltr"><span class="codeinlineitalic">SID</span></code> is <code dir="ltr">ORCL</code>, then enter the following at a command prompt:</p>
<pre dir="ltr">C:\&gt; NET STOP OracleServiceORCL
</pre></li>
<li>
<p><a id="sthref371"></a><a id="sthref372"></a>Delete the Oracle service at a command prompt using <code dir="ltr">ORADIM</code>. Refer to <a href="#CHDJEGFH">&#34;Variables for using ORADIM When Upgrading Oracle Database on Windows&#34;</a> for more information. Also refer to your platform guide for a list the <code dir="ltr">ORADIM</code> syntax and commands.</p>
<p>If your <code dir="ltr"><span class="codeinlineitalic">SID</span></code> is <code dir="ltr">ORCL</code>, then enter the following command. Substitute the actual name for your <code dir="ltr"><span class="codeinlineitalic">SID</span></code>.</p>
<pre dir="ltr">C:\&gt; ORADIM -DELETE -SID ORCL
</pre></li>
<li>
<p>Create the service for Oracle Database 12<span class="italic">c</span> at a command prompt using the <code dir="ltr">ORADIM</code> command of the new Oracle Database release as shown in the following example:</p>
<pre dir="ltr">C:\&gt; ORADIM -NEW -SID <span class="italic">SID</span> -SYSPWD <span class="italic">PASSWORD</span> -MAXUSERS <span class="italic">USERS</span>
     -STARTMODE AUTO -PFILE <span class="italic">ORACLE_HOME</span>\DATABASE\INIT<span class="italic">SID</span>.ORA
</pre>
<p>Most Oracle Database services log on to the system using the privileges of the Oracle Home User. The service runs with the privileges of this user. The <code dir="ltr">ORADIM</code> command prompts you for the password to this user account. You can specify other options using <code dir="ltr">ORADIM</code>.</p>
<p>In this example, if your <code dir="ltr">SID</code> is <code dir="ltr">ORCL</code>, your <code dir="ltr">password</code> (<code dir="ltr">SYSPWD</code>) is <code dir="ltr">TWxy5791</code>, the maximum number of users (<code dir="ltr">MAXUSERS</code>) is 10, and the <span class="italic">ORACLE_HOME</span> directory is <code dir="ltr">C:\ORACLE\PRODUCT\11.2.0\DB</code>, then enter the following command:</p>
<pre dir="ltr">C:\&gt; ORADIM -NEW -SID ORCL -SYSPWD TWxy5791 -MAXUSERS 10
-STARTMODE AUTO -PFILE C:\ORACLE\PRODUCT\11.2.0\DB\DATABASE\INITORCL.ORA
</pre>
<p><code dir="ltr">ORADIM</code> writes a log file to the <code dir="ltr">ORACLE_HOME\database</code> directory. The log file contains the name of the PDB in the multitenant database.</p>
</li>
</ol>
</li>
<li>
<p><a id="sthref373"></a>If your operating system is Linux or UNIX, then perform the following checks:</p>
<ol>
<li>
<p>Your <code dir="ltr">ORACLE_SID</code> is set correctly</p>
</li>
<li>
<p>The <code dir="ltr">oratab</code> file points to the Oracle home for Oracle Database 12<span class="italic">c</span></p>
</li>
<li>
<p>The following environment variables point to the Oracle Database 12<span class="italic">c</span> directories:</p>
<ul>
<li>
<p><code dir="ltr">ORACLE_HOME</code></p>
</li>
<li>
<p><code dir="ltr">PATH</code></p>
</li>
</ul>
</li>
<li>
<p>Any scripts that clients use to set the <span class="italic">ORACLE_HOME</span> value must point to the new Oracle home.</p>
</li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you are upgrading a cluster database, then perform these checks on all nodes on which this cluster database has instances configured.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink GINST" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=GINST"><span class="italic">Oracle Database Installation Guide</span></a> for operating system-specific information about setting other important environment variables on your operating system</div>
</li>
<li>
<p>Log in to the system as the owner of the Oracle home under the new Oracle Database 12<span class="italic">c</span>.</p>
</li>
<li>
<p>From the <code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code><code dir="ltr">/rdbms/admin</code> directory, start SQL*Plus.</p>
</li>
<li>
<p>Connect to the database to be upgraded using an account with DBA privileges:</p>
<pre dir="ltr">SQL&gt; CONNECT / AS SYSDBA
</pre></li>
<li>
<p>Start the CDB in upgrade mode:</p>
<pre dir="ltr">SQL&gt; startup upgrade
</pre></li>
<li id="i1012182">
<p>Start the instance by issuing the following command in SQL*Plus:</p>
<pre dir="ltr">SQL&gt; alter pluggable database all open upgrade;
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
The <code dir="ltr">UPGRADE</code> keyword enables you to open a database based on an earlier Oracle Database release. It also restricts logons to <code dir="ltr">AS SYSDBA</code> sessions, disables system triggers, and performs additional operations that prepare the environment for the upgrade.</div>
<p>Specify the location of your initialization parameter file <code dir="ltr">PFILE</code>. See <a class="olink ADMIN12825" href="../ADMIN/start.htm#ADMIN12825"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about specifying initialization parameters at startup and the initialization parameter file.</p>
<p>If errors appear listing desupported initialization parameters, then make a note of the desupported initialization parameters and continue with the upgrade. Remove the desupported initialization parameters the next time you shut down the database.</p>
</li>
<li>
<p>Exit SQL*Plus before proceeding to the next step.</p>
</li>
<li>
<p>To upgrade an entire CDB, <a id="sthref374"></a><a id="sthref375"></a>Run the <code dir="ltr">catctl.pl</code> script from the new Oracle home as described in this step. The Parallel Upgrade Utility, <code dir="ltr">catctl.pl</code>, provides parallel upgrade options that reduce downtime.</p>
<p>To run <code dir="ltr">catctl.pl</code> on Linux:</p>
<pre dir="ltr">cd $ORACLE_HOME/rdbms/admin
$ORACLE_HOME/perl/bin/perl catctl.pl catupgrd.sql
</pre>
<p>To run <code dir="ltr">catctl.pl</code> on Windows:</p>
<pre dir="ltr">cd %ORACLE_HOME%\rdbms\admin
%ORACLE_HOME%\perl\bin\perl catctl.pl catupgrd.sql
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
<ul>
<li>
<p>You can use the -d option to specify the directory that contains the files to be processed, and -l to specify the directory to use for spool log files. You can use <code dir="ltr">catctl.pl -S</code> to run the upgrade processes serially. Refer to <a href="#CHDHIFAA">Table 3-2, &#34;catctl.pl Parameters&#34;</a> for all the options.</p>
</li>
<li>
<p>If you choose to run the <code dir="ltr">catupgrd.sql</code> script on a non-CDB, doing so now requires an additional input parameter as follows:</p>
<pre dir="ltr">SQL&gt; @catupgrd.sql PARALLEL=NO
</pre></li>
<li>
<p>When upgrading an entire CDB, upgrade aborts if there are errors in the CDB root or PDB seed.</p>
</li>
<li>
<p>To run <code dir="ltr">catupgrd.sql</code> on a CDB, you must run it in the CDB$ROOT and PDB$SEED for all the PDBs. For example:</p>
<pre dir="ltr">SQL&gt; ALTER SESSION SET CONTAINER = &#34;CDB$ROOT&#34;
SQL&gt; catupgrd.sql PARALLEL=NO
SQL&gt; ALTER SESSION SET CONTAINER = &#34;PDB$SEED&#34;
SQL&gt; catupgrd.sql PARALLEL=NO
SQL&gt; ALTER SESSION SET CONTAINER = &#34;PDB1&#34;
SQL&gt; catupgrd.sql PARALLEL=NO
</pre></li>
</ul>
</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#CHDDEIFJ">&#34;General Steps for Running the New Parallel Upgrade Utility (catctl.pl)&#34;</a> for information about <code dir="ltr">catctl.pl</code> parameters and options</div>
</li>
<li>
<p>To upgrade a subset of PDBs within a CDB, you can specify either an inclusion list or an exclusion list as shown in the examples in this step.</p>
<ol>
<li>
<p>Inclusion list to upgrade PDB1 only:</p>
<pre dir="ltr">cd $ORACLE_HOME/rdbms/admin
$ORACLE_HOME/perl/bin/perl catctl.pl -c &#39;PDB1&#39; catupgrd.sql
</pre></li>
<li>
<p>Exclusion list to upgrade everything in the CDB except PDB1:</p>
<pre dir="ltr">cd $ORACLE_HOME/rdbms/admin
$ORACLE_HOME/perl/bin/perl catctl.pl -C &#39;PDB1&#39; catupgrd.sql
</pre></li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can also upgrade a specific PDB by itself by unplugging it and then plugging it back into the CDB. This is described in <a href="#CHDCGIJC">&#34;Upgrading a Pluggable Database (PDB).&#34;</a>
<p>For Windows, the -C option must be specified with quotes around the CDB root name and PDB seed name, for example:</p>
<p>... <code dir="ltr">-C &#34;CDB$ROOT PDB$SEED&#34;</code></p>
</div>
</li>
<li>
<p><span class="bold">Important:</span> The <code dir="ltr">catuppst.sql</code> script is run as part of the upgrade process unless the upgrade returns errors during the process. Check the log file for &#34;Started: catuppst.sql&#34; to verify that <code dir="ltr">catuppst.sql</code> ran during the upgrade process. If <code dir="ltr">catuppst.sql</code> has not run, then proceed to run <code dir="ltr">catuppst.sql</code> as shown in this step. Warning messages are also displayed when running <code dir="ltr">catctl.pl</code> indicating that <code dir="ltr">catuppst.sql</code> was not run during the upgrade.</p>
<p>Run <code dir="ltr">catuppst.sql</code> as follows:</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl catcon.pl -n 1 -e -b catuppst -d &#39;&#39;&#39;.&#39;&#39;&#39; catuppst.sql
</pre>
<p>The log file <code dir="ltr">catuppst0.log</code> will be generated with the results of the post upgrade.</p>
</li>
<li id="BABBDJGJ">
<p>Run <a id="sthref376"></a><code dir="ltr">catcon.pl</code> to invoke <a id="sthref377"></a><a id="sthref378"></a><a id="sthref379"></a><code dir="ltr">utlrp.sql</code> to recompile any remaining stored PL/SQL and Java code. Use the following syntax:</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl catcon.pl -n 1 -e -b utlrp -d &#39;&#39;&#39;.&#39;&#39;&#39; utlrp.sql
</pre>
<p>The log file <code dir="ltr">utlrp0.log</code> is generated with the results of the recompilations.</p>
</li>
<li>
<p>Run <code dir="ltr">utlu121s.sql</code> to verify that all issues have been fixed.</p>
<p>In a CDB:</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl catcon.pl -n 1 -e -b utlu121s -d &#39;&#39;&#39;.&#39;&#39;&#39; utlu121s.sql
</pre>
<p>In a non-CDB:</p>
<pre dir="ltr">SQL&gt; @rdbms/admin/utlu121s.sql
</pre>
<p>The log file <code dir="ltr">utlu121s0.log</code> will be generated with the upgrade results.</p>
<p>To see information about the state of the database, you can run <code dir="ltr">utlu121s.sql</code> as many times as you want, any time <span class="italic">after</span> completing the upgrade. If the <code dir="ltr">utlu121s.sql</code> script returns errors or shows components that are not <code dir="ltr">VALID</code> or not the most recent release, then see <a href="#i1012368">&#34;Troubleshooting the Upgrade for Oracle Database&#34;</a> for more information.</p>
</li>
<li>
<p>Verify that all expected packages and classes are valid. (This step assumes that you previously ran <code dir="ltr">preupgrd.sql</code> before starting the upgrade.)</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl catcon.pl -n 1 -e -b utluiobj -d &#39;&#39;&#39;.&#39;&#39;&#39; utluiobj.sql
</pre>
<p>The log file <code dir="ltr">utluiobj0.log</code> will be generated with the results of the verification.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If the Pre-upgrade Information Tool detected <code dir="ltr">INVALID</code> objects and populated the <code dir="ltr">registry$sys_inv_objs</code> and <code dir="ltr">registry$nonsys_inv_objs</code> tables, then execute <code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code><code dir="ltr">/rdbms/admin/utluiobj.sql</code> to display only those objects which are newly invalid because of the upgrade process. The <code dir="ltr">utluiobj.sql</code> script only displays objects that are now <code dir="ltr">INVALID</code> but which were <code dir="ltr">VALID</code> before the upgrade. See <a href="preup.htm#BABCEFJD">&#34;Using the Pre-Upgrade Information Tool (preupgrd.sql).&#34;</a>.</div>
</li>
<li>
<p>At this time you may ensure that the time zone data files are current. If you need to update the time zone, then you must update the time zone both in CDB$ROOT and in the PDB databases. You can also make this adjustment after the upgrade.</p>
<p>See <a href="afterup.htm#CEGBGBDA">&#34;Upgrade the Time Zone File Version After Upgrading Oracle Database.&#34;</a></p>
</li>
<li>
<p>Exit SQL*Plus if you are still in it, for example, in a non-CDB.</p>
</li>
<li>
<p>If you are upgrading a cluster database from releases 10.2, 11.1, or 11.2, then upgrade the database configuration in Oracle Clusterware using the following command:</p>
<pre dir="ltr">$ srvctl upgrade database -d <span class="italic">db-unique-name</span> -o <span class="italic">oraclehome</span>
</pre>
<p>where <code dir="ltr"><span class="codeinlineitalic">db-unique-name</span></code> is the database name assigned to it (not the instance name), and <code dir="ltr"><span class="codeinlineitalic">oraclehome</span></code> is the Oracle home location in which the database is being upgraded. The <code dir="ltr">SRVCTL</code> utility supports long GNU-style options in addition to short CLI options used in earlier releases.</p>
</li>
</ol>
<p>Your database is now upgraded to Oracle Database 12<span class="italic">c</span>. You are ready to complete the procedures described in <a href="afterup.htm#BABEEEFF">Chapter 4, &#34;Post-Upgrade Tasks for Oracle Database&#34;</a>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<a id="sthref380"></a>Oracle Warehouse Builder (OWB) components are not upgraded as part of the Oracle Database upgrade process. Oracle Warehouse Builder is not installed as part of Oracle Database 12<span class="italic">c</span>. See <a href="preup.htm#BABBHCBB">&#34;Requirement for Upgrading Databases that Use Oracle Warehouse Builder (OWB)&#34;</a> for more information.</div>
<div class="infoboxnotewarn">
<p class="notep1">Caution:</p>
<p class="warnsp">If you retain the old Oracle software, then never start the upgraded database with the old software. Only start the database with the executables in the new Oracle Database installation. Also, before you remove the old Oracle environment, make sure you relocate any data files in that environment to the new Oracle Database environment. See the <a class="olink ADMIN012" href="../ADMIN/dfiles.htm#ADMIN012"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about relocating data files.</p>
</div>
</div>
<!-- class="sect1" -->
<a id="BABEEEJG"></a>
<div id="UPGRD52887" class="sect1">
<h2 class="sect1"><span class="secnum">3.6</span> How the Data Dictionary is Upgraded and Status is Displayed</h2>
<p>In Oracle Database 12<span class="italic">c</span>, improvements have been made to the upgrade process and how upgrade status appears for the upgraded database.</p>
<p>The following topics discuss changes that affect performance and status for data dictionary objects:</p>
<ul>
<li>
<p><a href="#BABHBGAC">Parallel Upgrading of Data Dictionary</a></p>
</li>
<li>
<p><a href="#BABBFHAE">Change to Upgrade Status Setting</a></p>
</li>
<li>
<p><a href="#BABFJEIE">Change to Status After Running the Re-compilation utlrp.sql Script</a></p>
</li>
</ul>
<a id="BABHBGAC"></a>
<div id="UPGRD52888" class="sect2">
<h3 class="sect2"><span class="secnum">3.6.1</span> Parallel Upgrading of Data Dictionary</h3>
<p>Upgrading the data dictionary in Oracle Database is now done in parallel with the <code dir="ltr">catctl.pl</code> utility, which speeds up the upgrade process. Instead of one SQL process loading the data dictionary, there can now be multiple processes, depending on CPU capacity. The <code dir="ltr">catctl.pl</code> utility loads data into the dictionary as fast as possible and defers any work that can be done in <span class="italic">normal</span> mode instead of <span class="italic">upgrade</span> mode. Upgrading the database in this fashion reduces the overall downtime.</p>
</div>
<!-- class="sect2" -->
<a id="BABBFHAE"></a>
<div id="UPGRD52889" class="sect2">
<h3 class="sect2"><span class="secnum">3.6.2</span> Change to Upgrade Status Setting</h3>
<p>When the upgrade is complete and if there are no errors, then the status of the database is set to <code dir="ltr">UPGRADED</code>. This behavior differs from earlier releases where the status of the database was set to <code dir="ltr">VALID</code> after upgrading. The <code dir="ltr">UPGRADED</code> status indicates that the data dictionary has been loaded without any errors. If any errors are logged to <code dir="ltr">registry$error</code>, then the status of the upgrade is set to <code dir="ltr">INVALID</code>.</p>
</div>
<!-- class="sect2" -->
<a id="BABFJEIE"></a>
<div id="UPGRD52890" class="sect2">
<h3 class="sect2"><span class="secnum">3.6.3</span> Change to Status After Running the Re-compilation utlrp.sql Script</h3>
<p>In earlier releases of Oracle Database after upgrading a database, <code dir="ltr">VALID</code> meant that all objects in the data dictionary have been recompiled and are ready for use. In Oracle Database 12<span class="italic">c</span>, obtaining a <code dir="ltr">VALID</code> status differs. Running the <code dir="ltr">utlrp.sql</code> script in <span class="italic">normal</span> mode, recompiles data dictionary objects and moves the data dictionary from an <code dir="ltr">UPGRADED</code> status to a <code dir="ltr">VALID</code> status.</p>
<p>Oracle cannot guarantee that the database upgrade is <span class="italic">valid</span> unless <code dir="ltr">utlrp.sql</code> has been run after upgrading and before starting the upgraded database for the first time. Not running <code dir="ltr">utlrp.sql</code> after performing an upgrade forces data dictionary objects to be compiled during their first access. The first user accessing the database suffers the performance hit for each of the invalid objects accessed at this point. Once recompilation of those invalid objects is completed, then normal processing returns. Running <code dir="ltr">utlrp.sql</code> ensures that the database is ready for use after upgrading. Any errors found are reported immediately and can be fixed before users of the upgraded database encounter problems.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDHBFHA"></a>
<div class="sect1">
<h2 class="sect1"><span class="secnum">3.7</span> About the catupgrd.sql Script in Earlier Releases of Oracle Database</h2>
<p>Earlier releases of Oracle Database used the <code dir="ltr">catupgrd.sql</code> Upgrade Utility to process the upgrade. Oracle strongly recommends that starting with Oracle Database 12<span class="italic">c</span>, you use the <code dir="ltr">catctl.pl</code> Parallel Upgrade Utility, which replaces <code dir="ltr">catupgrd.sql</code> and provides both parallel processing mode and serial mode. The information about <code dir="ltr">catupgrd.sql</code> is provided here for backward compatibility with any custom scripts or processes that you use for upgrading. You must execute the <code dir="ltr">catupgrd.sql</code> script from the Oracle Database 12<span class="italic">c</span> environment.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you run <code dir="ltr">catupgrd.sql</code> by itself, then <code dir="ltr">catuppst.sql</code> does not run as part of the upgrade process. The <code dir="ltr">catuppst.sql</code> script must be run after <code dir="ltr">catupgrd.sql</code> completes.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="deprecated.htm#BABFAEDJ">&#34;Deprecation of catupgrd.sql Script and Introduction of New catctl.pl Utility,&#34;</a> for information about running the earlier Upgrade Utility</div>
<p>The <code dir="ltr">catupgrd.sql</code> script creates and alters certain data dictionary tables. It also upgrades or installs the following database components in the new Oracle Database 12<span class="italic">c</span> database:</p>
<ul>
<li>
<p>Oracle Database Catalog Views</p>
</li>
<li>
<p>Oracle Database Packages and Types</p>
</li>
<li>
<p>JServer JAVA Virtual Machine</p>
</li>
<li>
<p>Oracle Database Java Packages</p>
</li>
<li>
<p>Oracle XDK</p>
</li>
<li>
<p>Oracle Real Application Clusters</p>
</li>
<li>
<p>Oracle Workspace Manager</p>
</li>
<li>
<p>Oracle Multimedia</p>
</li>
<li>
<p>Oracle XML Database</p>
</li>
<li>
<p>OLAP Analytic Workspace</p>
</li>
<li>
<p>Oracle OLAP API</p>
</li>
<li>
<p>Oracle Text</p>
</li>
<li>
<p>Oracle Spatial and Graph</p>
</li>
<li>
<p>Oracle Data Mining</p>
</li>
<li>
<p>Oracle Label Security</p>
</li>
<li>
<p>Messaging Gateway</p>
</li>
<li>
<p>Oracle Database Vault</p>
</li>
<li>
<p>Oracle Application Express</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="CHDDCGCH"></a>
<div class="sect1">
<h2 class="sect1"><span class="secnum">3.8</span> About the catuppst.sql Script</h2>
<p>The <code dir="ltr">catuppst.sql</code> script generates informational messages and log files during the upgrade. DBUA and <code dir="ltr">catctl.pl</code> automatically run <code dir="ltr">catuppst.sql</code>. Run this script separately if any errors occurred during the manual upgrade.</p>
<p>The <code dir="ltr">catuppst.sql</code> script, which is located in the ORACLE_HOME/rdbms/admin directory, performs remaining upgrade actions that do not require the database to be in UPGRADE mode. This script also automatically applies the latest Oracle patch set update (PSU).</p>
<p>An example of the <code dir="ltr">catuppst.sql</code> output is as follows:</p>
<pre dir="ltr">Generating apply and rollback scripts...
Check the following file for errors:
Apply script: .*
Rollback script: .*
Executing script file...
Updating registry...
Check the following log file for errors: 

Generating apply and rollback scripts...
Check the following file for errors:
.../cfgtoollogs/catbundle/catbundle_PSU_*.log
Apply script:
.../rdbms/admin/catbundle_PSU_*_APPLY.sql
Rollback script:
.../rdbms/admin/catbundle_PSU_*_ROLLBACK.sql
Executing script file... 

Updating registry...
Check the following log file for errors:
.../cfgtoollogs/catbundle/catbundle_PSU_<span class="codeinlineitalic">PDB_name</span>.log 
</pre></div>
<!-- class="sect1" -->
<a id="CHDBDJIC"></a>
<div id="UPGRD60134" class="sect1">
<h2 class="sect1"><span class="secnum">3.9</span> About Transporting and Upgrading a Database (Full Transportable Export/Import)</h2>
<p>The <a id="sthref381"></a>Full <a id="sthref382"></a>Transportable Export/Import feature of Oracle Data Pump provides two options, which are described in detail in <span class="italic">Oracle Database Administrator&#39;s Guide</span>. The two options are:</p>
<ul>
<li>
<p>Using a file-based Oracle Data Pump export/import</p>
</li>
<li>
<p>Using a non-file based network mode Oracle Data Pump import</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p>Information about transporting a database using an export dump file in <a class="olink ADMIN13726" href="../ADMIN/transport.htm#ADMIN13726"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a></p>
</li>
<li>
<p>The full procedure in the <a class="olink ADMIN13873" href="../ADMIN/transport.htm#ADMIN13873"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for transporting a database over the network</p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="i1012368"></a>
<div id="UPGRD12409" class="sect1">
<h2 class="sect1"><span class="secnum">3.10</span> Troubleshooting the Upgrade for Oracle Database<a id="sthref383"></a><a id="sthref384"></a></h2>
<p>Oracle provides troubleshooting tips for errors or issues you may encounter while upgrading your database. To learn about important changes that affect this release, be sure to read <a href="deprecated.htm#BABBIBFB">Chapter 8, &#34;Deprecated and Desupported Features for Oracle Database 12<span class="italic">c</span>.&#34;</a></p>
<p>This section contains the following topics:</p>
<ul>
<li>
<p><a href="#CHDIFICB">About Starting Oracle Database in Upgrade Mode</a></p>
</li>
<li>
<p><a href="#CHDJFFFI">Running DBUA with Different ORACLE_HOME Owner</a></p>
</li>
<li>
<p><a href="#CHDIIHII">Oracle Database Upgrade Script Termination Errors</a></p>
</li>
<li>
<p><a href="#CHDBBAEI">Invalid Object Warnings and DBA Registry Errors</a></p>
</li>
<li>
<p><a href="#CHDHGADF">Invalid Objects and Premature Use of Postupgrade Tool</a></p>
</li>
<li>
<p><a href="#BABGJJJE">Resource Limits for Upgrading Oracle Database</a></p>
</li>
<li>
<p><a href="#CHDDCJDB">SQL*Plus Edition Session Startup Error for Oracle Database</a></p>
</li>
<li>
<p><a href="#CIACJFDD">Manual Workaround for ORA-01408 on Oracle Database Index</a></p>
</li>
<li>
<p><a href="#CHDGADBE">Error ORA-00018 for DBCA Processes with Release 11.1.0.7 Databases</a></p>
</li>
<li>
<p><a href="#CHDHGBDG">Error ORA-00020 Maximum Number of Processes Exceeded When Running utlrp.sql</a></p>
</li>
<li>
<p><a href="#CIAIJGDI">Running the DBMS_DST Package After Upgrade Can Result in ORA-01822</a></p>
</li>
<li>
<p><a href="#CHDIDCFI">Continuing Upgrades After Server Restarts (ADVM/ACFS Driver Error)</a></p>
</li>
<li>
<p><a href="#BABHDDFE">Understanding Component Status of the Post-Upgrade Status Tool</a></p>
</li>
<li>
<p><a href="#CHDCDEAE">Adjusting Oracle ASM Password File Location After Upgrade</a></p>
</li>
<li>
<p><a href="#CHDIEEIE">Error ORA-27248: sys.dra_reevaluate_open_failures is running</a></p>
</li>
<li>
<p><a href="#CHDDHIHE">Oracle Database Enterprise User Security, OLS-OID, and Provisioning Profile Error</a></p>
</li>
<li>
<p><a href="#CHDCIHGH">32K Migration Error with utl32k.sql and MAX_STRING_SIZE</a></p>
</li>
<li>
<p><a href="#CHDDAIAE">ASM Loses Rolling Migration State If CRS Shutdown On All Nodes</a></p>
</li>
<li>
<p><a href="#CHDBDJEB">Data Type Versioning Could Cause Cross-Version Replication (ORA-26656)</a></p>
</li>
<li>
<p><a href="#CHDJBAJB">Oracle XML DB Errors ORA-64123 and ORA-14097</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#BABCGHFJ">&#34;Rerunning the Upgrade for Oracle Database&#34;</a></div>
<a id="CHDIFICB"></a>
<div id="UPGRD52874" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.10.1</span> About Starting Oracle Database in Upgrade Mode</h3>
<p>Once the database is <a id="sthref385"></a>started in upgrade mode, only queries on fixed views execute without errors until after you run the <code dir="ltr">catctl.pl</code> script. Before running an upgrade script, queries on any other view or the use of PL/SQL returns an error.</p>
<p>Errors described in this section might occur when attempting to start the new Oracle Database 12<span class="italic">c</span> database. Some of these errors write to the alert log and not to your session. If you receive any of these errors, then issue the <code dir="ltr">SHUTDOWN ABORT</code> command to shut down the database and correct the problem.</p>
<ul>
<li>
<p><code dir="ltr"><a id="sthref386"></a>ORA-00401: the value for parameter compatible is not supported by this release</code></p>
<p>The <code dir="ltr">COMPATIBLE</code> initialization parameter is set to a value less than <code dir="ltr">11.0.0</code>.</p>
</li>
<li>
<p><code dir="ltr"><a id="sthref387"></a>ORA-39701: database must be mounted EXCLUSIVE for UPGRADE or DOWNGRADE</code></p>
<p>The <a id="sthref388"></a><code dir="ltr">CLUSTER_DATABASE</code> initialization parameter is set to <code dir="ltr">TRUE</code> instead of <code dir="ltr">FALSE</code>.</p>
</li>
<li>
<p><code dir="ltr"><a id="sthref389"></a>ORA-39700: database must be opened with UPGRADE option</code></p>
<p>The <code dir="ltr">STARTUP</code> command was issued without the <code dir="ltr">UPGRADE</code> keyword.</p>
</li>
<li>
<p><code dir="ltr"><a id="sthref390"></a>Ora-00704: bootstrap failure</code></p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
Ora-00704, Ora-39700: Database Must Be Opened With Upgrade Option (Doc ID 1349722.1) on My Oracle Support at <code dir="ltr"><a href="http://support.oracle.com">http://support.oracle.com</a></code></div>
</li>
<li>
<p><code dir="ltr"><a id="sthref391"></a>ORA-00336: log file size xxxx blocks is less than minimum 8192 blocks</code></p>
<p>A redo log file size is less than 4 MB:</p>
</li>
</ul>
<p>If errors appear listing desupported initialization parameters, then make a note of the desupported initialization parameters and continue with the upgrade. Remove the desupported initialization parameters the next time you shut down the database.</p>
</div>
<!-- class="sect2" -->
<a id="CHDJFFFI"></a>
<div id="UPGRD60135" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.10.2</span> Running DBUA with Different ORACLE_HOME Owner</h3>
<p>When upgrading your database, DBUA expects that both the source (pre-12<span class="italic">c</span>) Oracle home and the destination (new 12<span class="italic">c</span>) Oracle home are owned by the same user. If this is not the case in your environment, then you need to make some changes to database file permissions and pass additional parameters to DBUA. Otherwise on the DBUA Prerequisite Checks page you will see the &#34;upgrade.xml not found&#34; error, and you will not be able to proceed with the upgrade.</p>
<ul>
<li>
<p>First, ensure all database files (data files, the redo file, control files, archive log destination, recovery area, Spfile, and password file) are readable and writable by both the new 12<span class="italic">c</span> and pre-12<span class="italic">c</span> binary owners. This can be achieved by having both users in the same group, such as &#34;oinstall&#34; and by giving the group read/write access to all the database files.</p>
</li>
<li>
<p>Run DBUA by specifying the <code dir="ltr">-logdir</code> command line switch, and provide a directory that both 12<span class="italic">c</span> and pre-12<span class="italic">c</span> binary owners can write to, for example, <code dir="ltr">/tmp</code>. DBUA will use this directory to store the output from the Pre-upgrade Information Tool (which you execute on the pre-12<span class="italic">c</span> instance running under the pre-12<span class="italic">c</span> binary owner) and any DBUA logs generated by the 12<span class="italic">c</span> binary owner during upgrade.</p>
<ul>
<li>
<p>For example, run DBUA as follows at the command line:</p>
<pre dir="ltr">dbua -logdir /tmp
</pre></li>
</ul>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="CHDIIHII"></a>
<div id="UPGRD52875" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.10.3</span> Oracle Database Upgrade Script Termination Errors</h3>
<p>If you did not run the Pre-Upgrade Information Tool before starting the upgrade, then the <code dir="ltr">catctl.pl</code> and <code dir="ltr">catupgrd.sql</code> scripts terminate with errors as follows<a id="sthref392"></a><a id="sthref393"></a><a id="sthref394"></a><a id="sthref395"></a>:</p>
<pre dir="ltr">ORA-00942: table or view does not exist
<a id="sthref396"></a><a id="sthref397"></a>ORA-00904: &#34;TZ_VERSION&#34;: invalid identifier
<a id="sthref398"></a><a id="sthref399"></a>ORA-01722: invalid number
</pre>
<p>If you receive any of these errors, issue the <code dir="ltr">SHUTDOWN ABORT</code> statement. Then revert to the original Oracle home directory, and run the Pre-Upgrade Information Tool (<code dir="ltr">ultu121i.sql</code>) as described in <a href="preup.htm#BABBCGJC">&#34;About the Pre-Upgrade Information Tool for Oracle Database&#34;</a>.</p>
</div>
<!-- class="sect2" -->
<a id="CHDBBAEI"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.10.4</span> Invalid Object Warnings and DBA Registry Errors</h3>
<p>Before you start your upgrade, Oracle strongly recommends that you run the Pre-Upgrade Information Tool (<code dir="ltr">preupgrd.sql</code>).</p>
<p>The Pre-Upgrade Information Tool identifies invalid SYS and SYSTEM objects, as well as other invalid objects. Use <code dir="ltr">utlrp.sql</code> to recompile invalid objects. If you fail to do this before an upgrade, then it becomes difficult to determine which objects in your system were invalid before starting the upgrade, and which objects become invalid as a result of the upgrade.</p>
</div>
<!-- class="sect2" -->
<a id="CHDHGADF"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.10.5</span> Invalid Objects and Premature Use of Postupgrade Tool</h3>
<p>Never run the postupgrade status tool for the new Oracle Database 12.1 release (<code dir="ltr">utlu121s.sql</code> ) until after you complete the upgrade.</p>
<p>Oracle recommends that you run the postupgrade status tool only after the upgrade process is complete, and after you have run <code dir="ltr">utlrp.sql</code>. If the postupgrade status tool is run before you run <code dir="ltr">@utlrp.sql</code>, then the output of tool may not display the accurate final component status value. If the tool is run before running <code dir="ltr">utlrp.sql</code>, then the component status values may not properly reflect the final state. You can only determine the final component state after running <code dir="ltr">utlrp.sql</code>.</p>
</div>
<!-- class="sect2" -->
<a id="BABGJJJE"></a>
<div id="UPGRD12410" class="sect2">
<h3 class="sect2"><span class="secnum">3.10.6</span> Resource Limits for Upgrading Oracle Database</h3>
<p>If you <a id="sthref400"></a>run out of resources during the upgrade, then increase the resource allocation. After increasing the resource allocation, you should perform a <code dir="ltr">SHUTDOWN ABORT</code> and restart the instance (in <code dir="ltr">UPGRADE</code> mode) before rerunning the <code dir="ltr">catupgrd.sql</code> script or restarting DBUA.</p>
<p>The resources that generally require increases for a new Oracle Database release are as follows:</p>
<ul>
<li>
<p><a id="sthref401"></a><code dir="ltr">SYSTEM</code> and <code dir="ltr">SYSAUX</code> tablespaces</p>
<p>Typically if your <code dir="ltr">SYSTEM</code> tablespace size is insufficient, you receive an error message during the upgrade as follows:</p>
<pre dir="ltr">ORA-01650: unable to extend rollback segment <span class="italic">string</span> by <span class="italic">string</span> in tablespace <span class="italic">string</span>
ORA-01651: unable to extend save undo segment by <span class="italic">string</span> for tablespace <span class="italic">string</span>
ORA-01652: unable to extend temp segment by <span class="italic">string</span> in tablespace <span class="italic">string</span>
ORA-01653: unable to extend table <span class="italic">string</span>.<span class="italic">string</span> by <span class="italic">string</span> in tablespace <span class="italic">string</span>
ORA-01654: unable to extend index <span class="italic">string</span>.<span class="italic">string</span> by <span class="italic">string</span> in tablespace <span class="italic">string</span>
ORA-01655: unable to extend cluster <span class="italic">string</span>.<span class="italic">string</span> by <span class="italic">string</span> in tablespace <span class="italic">string</span>
</pre>
<p>To avoid these errors, set <code dir="ltr">AUTOEXTEND ON MAXSIZE UNLIMITED</code> for the <code dir="ltr">SYSTEM</code> and <code dir="ltr">SYSAUX</code> tablespaces.</p>
</li>
<li>
<p><a id="sthref402"></a>Shared memory</p>
<p>You might require larger shared memory pool sizes in some cases. The error message indicates which shared memory initialization parameter must be increased.</p>
<pre dir="ltr"><a id="sthref403"></a>ORA-04031: unable to allocate <span class="italic">string</span> bytes of shared memory (&#34;<span class="italic">string</span>&#34;,&#34;<span class="italic">string</span>&#34;,&#34;<span class="italic">string</span>&#34;,&#34;<span class="italic">string</span>&#34;)
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADMIN11218" href="../ADMIN/memory.htm#ADMIN11218"><span class="italic">Oracle Database Administrator&#39;s Guide</span></a> for information about using manual shared memory management</div>
</li>
<li>
<p><a id="sthref404"></a>Rollback segments/undo tablespace</p>
<p>If you are using rollback segments, then you must have a single large (100 MB) <code dir="ltr">PUBLIC</code> rollback segment online while the upgrade scripts are being run. Smaller public rollback segments should be taken offline during the upgrade. Typically you get the following error if your rollback segment size is insufficient:</p>
<pre dir="ltr"><a id="sthref405"></a>ORA-01562: failed to extend rollback segment number <span class="italic">string</span>
</pre>
<p>If you are using an undo tablespace, then be sure it is at least 400 MB.</p>
</li>
<li>
<p><a id="sthref406"></a>Fast Recovery Area</p>
<p>If you are using a <a id="sthref407"></a>Fast Recovery Area and it fills up during the upgrade, then the following error appears in the alert log, followed by suggestions for recovering from the problem:</p>
<pre dir="ltr"><a id="sthref408"></a>ORA-19815: WARNING: db_recovery_file_dest_size of <span class="italic">string</span> bytes is 98.99%
used, and has <span class="italic">string</span> remaining bytes available.
</pre>
<p>Identify the root cause of the problem and take appropriate actions to proceed with the upgrade. To avoid issues during the upgrade, increase the amount of space available in your Fast Recovery Area before starting the upgrade.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="CHDDCJDB"></a>
<div id="UPGRD52742" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.10.7</span> SQL*Plus Edition Session Startup Error for Oracle Database</h3>
<p>If an upgrade script or command running in SQL*Plus set the <a id="sthref409"></a><code dir="ltr">EDITION</code> parameter, then Oracle Database cannot start properly afterward and error <a id="sthref410"></a><code dir="ltr">SP2-1540</code>: &#34;Oracle Database cannot startup in an Edition session&#34; is thrown. To avoid this problem, after running <code dir="ltr">catugrd.sql</code> or any SQL*Plus session where this parameter is changed, exit the SQL*Plus session and restart the instance in a different session.</p>
</div>
<!-- class="sect2" -->
<a id="CIACJFDD"></a>
<div id="UPGRD52647" class="sect2">
<h3 class="sect2"><span class="secnum">3.10.8</span> Manual Workaround for <a id="sthref411"></a><a id="sthref412"></a>ORA-01408 on Oracle Database Index</h3>
<p>The <code dir="ltr">ORA-01408</code> error on the index is a known problem with Oracle Application databases, because the same index exists with a different name in these databases.</p>
<pre dir="ltr">SQL&gt; create index system.repcat$_audit_column_f2_idx on
2  system.repcat$_audit_column(base_sname,base_oname,base_conflict_type_id,
3  base_reference_name)
4  /
system.repcat$_audit_column(base_sname,base_oname,base_conflict_type_id,
                          *ERROR at line 2:
ORA-01408: such column list indexed
</pre>
<p>The workaround is to drop the <a id="sthref413"></a><code dir="ltr">REPCAT$_AUDIT_COLUMN_IDX1</code> index and rerun the upgrade as described in <a href="#BABCGHFJ">&#34;Rerunning the Upgrade for Oracle Database&#34;</a>.</p>
</div>
<!-- class="sect2" -->
<a id="CHDGADBE"></a>
<div id="UPGRD60032" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.10.9</span> Error ORA-00018 for DBCA Processes with Release 11.1.0.7 Databases</h3>
<p>If you are using Oracle Grid Infrastructure and you want to create an Oracle RAC release 11.1.0.7 database, then you may need to increase the DBCA default for session processes. For Oracle Database 12<span class="italic">c</span>, DBCA sets the default value for processes to 300. In earlier releases, DBCA set the default value to 150.</p>
<p>If you see the error message &#34;ORA-00018:maximum number of session exceeded,&#34; then change the default value for session processes in DBCA to 300. DBCA then successfully creates the release 11.1.0.7 database to use with Oracle Grid Infrastructure release 12.1.</p>
</div>
<!-- class="sect2" -->
<a id="CHDHGBDG"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.10.10</span> Error ORA-00020 Maximum Number of Processes Exceeded When Running utlrp.sql</h3>
<p>This error may indicate that your Oracle configuration does not have sufficient number of processes available for the recompile. Refer to documentation for more details about setting the PROCESSES parameter.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink REFRN10175" href="../REFRN/GUID-B757AF80-DA38-4167-A914-FE376A3AD4FE.htm#REFRN10175"><span class="italic">Oracle Database Reference</span></a></div>
</div>
<!-- class="sect2" -->
<a id="CIAIJGDI"></a>
<div id="UPGRD52648" class="sect2">
<h3 class="sect2"><span class="secnum">3.10.11</span> Running the <a id="sthref414"></a>DBMS_DST Package After Upgrade Can Result in <a id="sthref415"></a><a id="sthref416"></a>ORA-01822</h3>
<p>Running the <code dir="ltr">DBMS_DST</code> package after upgrading to Oracle Database 12<span class="italic">c</span> can result in the <code dir="ltr">ORA-01882: time zone region not found</code> error.</p>
<p>This error is returned if the time zone file version has been set incorrectly, which results in the region IDs of several time zone regions being stored incorrectly in the database. For example:</p>
<pre dir="ltr">ERROR at line 1:
@  ORA-01882: time zone region not found
@  ORA-06512: at &#34;SYS.DBMS_DST&#34;, line 113
@  ORA-06512: at &#34;SYS.DBMS_DST&#34;, line 1101
@  ORA-06512: at line 1
</pre>
<p>To fix this problem, update the time zone version as described in <a href="preup.htm#BABJBJBH">&#34;About Oracle Database Warnings for TIMESTAMP WITH TIME ZONE Data Type&#34;</a> and rerun the upgrade as described in <a href="#BABCGHFJ">&#34;Rerunning the Upgrade for Oracle Database&#34;</a>.</p>
</div>
<!-- class="sect2" -->
<a id="CHDIDCFI"></a>
<div id="UPGRD60105" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.10.12</span> Continuing Upgrades After Server Restarts (ADVM/ACFS Driver Error)</h3>
<p>On Windows platforms, an error may occur related to ADVM or ACFS drivers if a server restarts during an upgrade. You may see the following error message.</p>
<div class="msgset"><a id="tahiti71890286"></a>
<div class="msgentry">
<dl>
<dt><span class="msg"><a class="dashingAutolink" name="autolink-114154"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a id="sthref417"></a>ACFS-9427: Failed to unload ADVM/ACFS drivers. A system reboot is recommended, or ACFS-9428 Failed to load ADVM/ACFS drivers. A system reboot is recommended.</span> <!-- class="msg" --></dt>
<dd>
<div class="msgexplan"><span class="msgexplankw">Cause:</span> If you see these errors during an upgrade, then the cause is that the ADVM and ACFS drivers are still in use, and you must restart the system to start the new drivers.</div>
<!-- class="msgexplan" --></dd>
<dd>
<div class="msgaction"><span class="msgactionkw">Action:</span> Complete the steps as described in the following procedures.</div>
<!-- class="msgaction" --></dd>
</dl>
</div>
<!-- class="msgentry" --></div>
<!-- class="msgset" -->
<p>For nodes other than the first node (the node on which the upgrade is started):</p>
<ol>
<li>
<p>Restart the node where the error occurs.</p>
</li>
<li>
<p>Run the root script on that node again.</p>
</li>
</ol>
<p>For first nodes (the node on which the upgrade is started):</p>
<ol>
<li>
<p>Complete the upgrade of all other nodes in the cluster.</p>
</li>
<li>
<p>Restart the first node.</p>
</li>
<li>
<p>Run the root script on the first node again.</p>
</li>
<li>
<p>To complete the upgrade, log in as root, and run the script <code dir="ltr">configToolAllCommands</code>, located in the path <code dir="ltr"><span class="codeinlineitalic">Grid_home</span></code><code dir="ltr">/cfgtoollogs/configToolAllCommands</code>.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink CWGEN" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=CWGEN"><span class="italic">Oracle Grid Infrastructure Installation Guide</span></a> for your operating system for more information about troubleshooting upgrade issues for clusters</div>
</div>
<!-- class="sect2" -->
<a id="BABHDDFE"></a>
<div id="UPGRD12411" class="sect2">
<h3 class="sect2"><span class="secnum">3.10.13</span> Understanding <a id="sthref418"></a>Component Status of the Post-Upgrade Status Tool</h3>
<p>The <code dir="ltr">utlu121s.sql</code> Post-Upgrade Status Tool reports the status for database components after the upgrade. This tool can be run anytime after upgrade, post-upgrade, or after recompiling invalid objects with <code dir="ltr">utlrp.sql</code>. An example of the summary report is provided in <a href="#CHDBHJHD">&#34;Sample Upgrade Summary Report for the Post-Upgrade Status Tool (utlu121s.sql).&#34;</a></p>
<p>The following list briefly describes the status values that you might see:</p>
<ul>
<li>
<p><a id="sthref419"></a><a id="sthref420"></a><code dir="ltr">INVALID</code></p>
<p>Some objects for the component were invalid at the completion of the upgrade. If there were no errors during the component upgrade, then running <a id="sthref421"></a><code dir="ltr">utlrp.sql</code> might change the status to <code dir="ltr">VALID</code> without rerunning the entire upgrade. Check the <a id="sthref422"></a><code dir="ltr">DBA_REGISTRY</code> view after running <code dir="ltr">utlrp.sql</code>. See <a href="intro.htm#BHCCAIGF">&#34;Scripts for Upgrading Oracle Database&#34;</a>.</p>
</li>
<li>
<p><code dir="ltr">VALID</code></p>
<p>The component is valid with no errors.</p>
</li>
<li>
<p><code dir="ltr">LOADING</code></p>
<p>The component is loading</p>
</li>
<li>
<p><code dir="ltr">LOADED</code></p>
<p>The component has successfully finished loading.</p>
</li>
<li>
<p><code dir="ltr">UPGRADING</code></p>
<p>The component is in process being upgraded.</p>
</li>
<li>
<p><a id="sthref423"></a><a id="sthref424"></a><code dir="ltr">UPGRADED</code></p>
<p>The component has completed upgrading with no errors.</p>
</li>
<li>
<p><code dir="ltr">DOWNGRADING</code></p>
<p>The component is in process being downgraded.</p>
</li>
<li>
<p><code dir="ltr">DOWNGRADED</code></p>
<p>The component has completed downgrading with no errors.</p>
</li>
<li>
<p><code dir="ltr">REMOVING</code></p>
<p>The component is in process being removed.</p>
</li>
<li>
<p><a id="sthref425"></a><a id="sthref426"></a><code dir="ltr">REMOVED</code></p>
<p>The component was not upgraded because it was removed from the database.</p>
</li>
<li>
<p><a id="sthref427"></a><a id="sthref428"></a><code dir="ltr">OPTION OFF</code></p>
<p>The server option required for the component was not installed or was not linked with the server. Check the <a id="sthref429"></a><code dir="ltr">V$OPTION</code> view and the install logs. Install the component or relink the server with the required option, and then rerun <code dir="ltr">catctl.pl</code>. See <a href="intro.htm#BHCCAIGF">&#34;Scripts for Upgrading Oracle Database&#34;</a>.</p>
</li>
<li>
<p><a id="sthref430"></a><a id="sthref431"></a><code dir="ltr">NO SCRIPT</code></p>
<p>The component upgrade script was not found in <span class="italic">ORACLE_HOME</span>. Check the <a id="sthref432"></a>install logs, install the component software, and then rerun <code dir="ltr">catctl.pl</code>. See <a href="intro.htm#BHCCAIGF">&#34;Scripts for Upgrading Oracle Database&#34;</a>.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#BABBFHAE">&#34;Change to Upgrade Status Setting.&#34;</a></div>
<a id="CHDBHJHD"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">3.10.13.1</span> Sample Upgrade Summary Report for the Post-Upgrade Status Tool (utlu121s.sql)</h4>
<p>The Post-Upgrade Status Tool creates the upgrade summary report. The upgrade summary report contains the status of all components within the database as shown in <a href="#CHDBHFDB">Example 3-2, &#34;Upgrade Summary Report for the Post-Upgrade Status Tool&#34;</a>. The example shows the report for a multitenant container database (CDB) and the pluggable databases (PDBs).</p>
<p>After the upgrade completes, a copy of the report is placed in one of the following locations:</p>
<ol>
<li>
<p>$ORACLE_BASE/cfgtoollogs/<span class="italic">db-unique-name</span>/upgrade/upg_summary.rpt</p>
</li>
<li>
<p>$ORACLE_HOME/cfgtoollogs/<span class="italic">db-unique-name</span>/upgrade/upg_summary.rpt</p>
</li>
<li>
<p>$ORACLE_HOME/rdbms/logs/upg_summary.rpt</p>
</li>
</ol>
<p>The locations are shown in the order that <code dir="ltr">utlu121s.sql</code> uses to create the report. If it cannot create the report under the first directory scheme, then it tries the second and then the third location before it does not try further to write the report.</p>
<div class="example">
<p class="titleinexample"><a id="CHDBHFDB"></a>Example 3-2 Upgrade Summary Report for the Post-Upgrade Status Tool</p>
<pre dir="ltr">Oracle Database 12.1 Post-Upgrade Status Tool           06-12-2014 20:37:07     
.                             CDB$ROOT:1                                        
Component                               Current         Version  Elapsed Time   
Name                                    Status          Number   HH:MM:SS       
.                                                                               
Oracle Server                                                                   
.                                      UPGRADED      12.1.0.2.0  00:14:26       
JServer JAVA Virtual Machine                                                    
.                                         VALID      12.1.0.2.0  00:05:50       
Oracle Real Application Clusters                                                
.                                    OPTION OFF      12.1.0.2.0  00:00:01       
Oracle Workspace Manager                                                        
.                                         VALID      12.1.0.2.0  00:01:19       
Oracle Label Security                                                           
.                                         VALID      12.1.0.2.0  00:00:11       
Oracle XDK                                                                      
.                                         VALID      12.1.0.2.0  00:00:59       
Oracle Text                                                                     
.                                         VALID      12.1.0.2.0  00:00:32       
Oracle XML Database                                                             
.                                         VALID      12.1.0.2.0  00:01:40       
Oracle Database Java Packages                                                   
.                                         VALID      12.1.0.2.0  00:00:21       
Oracle Multimedia                                                               
.                                         VALID      12.1.0.2.0  00:03:43       
Oracle Database Vault                                                           
.                                         VALID      12.1.0.2.0  00:00:13       
Post Upgrade                                                                    
.                                                                00:01:25       
Final Actions                                                                   
.                                                                00:00:15       
Total Upgrade Time: 00:31:47                                                    
 
PL/SQL procedure successfully completed.
 
Elapsed: 00:00:00.11
.                                                                               
Oracle Database 12.1 Post-Upgrade Status Tool           06-12-2014 21:00:02     
.                             PDB$SEED:2                                        
Component                               Current         Version  Elapsed Time   
Name                                    Status          Number   HH:MM:SS       
.                                                                               
Oracle Server                                                                   
.                                      UPGRADED      12.1.0.2.0  00:13:19       
JServer JAVA Virtual Machine                                                    
.                                         VALID      12.1.0.2.0  00:02:24       
Oracle Real Application Clusters                                                
.                                    OPTION OFF      12.1.0.2.0  00:00:01       
Oracle Workspace Manager                                                        
.                                         VALID      12.1.0.2.0  00:00:51       
Oracle Label Security                                                           
.                                         VALID      12.1.0.2.0  00:00:06       
Oracle XDK                                                                      
.                                         VALID      12.1.0.2.0  00:00:40       
Oracle Text                                                                     
.                                         VALID      12.1.0.2.0  00:00:11       
Oracle XML Database                                                             
.                                         VALID      12.1.0.2.0  00:00:48       
Oracle Database Java Packages                                                   
.                                         VALID      12.1.0.2.0  00:00:11       
Oracle Multimedia                                                               
.                                         VALID      12.1.0.2.0  00:01:41       
Oracle Database Vault                                                           
.                                         VALID      12.1.0.2.0  00:00:12       
Post Upgrade                                                                    
.                                                                00:01:19       
Final Actions                                                                   
.                                                                00:00:01       
Total Upgrade Time: 00:22:24                                                    
 
PL/SQL procedure successfully completed.
 
Elapsed: 00:00:00.08
.                                                                               
Oracle Database 12.1 Post-Upgrade Status Tool           06-12-2014 21:24:16     
.                             CDB1_PDB1:3                                       
Component                               Current         Version  Elapsed Time   
Name                                    Status          Number   HH:MM:SS       
.                                                                               
Oracle Server                                                                   
.                                      UPGRADED      12.1.0.2.0  00:13:05       
JServer JAVA Virtual Machine                                                    
.                                         VALID      12.1.0.2.0  00:03:01       
Oracle Real Application Clusters                                                
.                                    OPTION OFF      12.1.0.2.0  00:00:02       
Oracle Workspace Manager                                                        
.                                         VALID      12.1.0.2.0  00:01:01       
Oracle Label Security                                                           
.                                         VALID      12.1.0.2.0  00:00:06       
Oracle XDK                                                                      
.                                         VALID      12.1.0.2.0  00:00:45       
Oracle Text                                                                     
.                                         VALID      12.1.0.2.0  00:00:15       
Oracle XML Database                                                             
.                                         VALID      12.1.0.2.0  00:00:55       
Oracle Database Java Packages                                                   
.                                         VALID      12.1.0.2.0  00:00:17       
Oracle Multimedia                                                               
.                                         VALID      12.1.0.2.0  00:01:59       
Oracle Database Vault                                                           
.                                         VALID      12.1.0.2.0  00:00:10       
Post Upgrade                                                                    
.                                                                00:01:18       
Final Actions                                                                   
.                                                                00:00:01       
Total Upgrade Time: 00:23:33                                                    
 
PL/SQL procedure successfully completed.
 
Elapsed: 00:00:00.12
.                                                                               
Oracle Database 12.1 Post-Upgrade Status Tool           06-12-2014 21:27:03     
.                             CDB1_PDB2:4                                       
Component                               Current         Version  Elapsed Time   
Name                                    Status          Number   HH:MM:SS       
.                                                                               
Oracle Server                                                                   
.                                      UPGRADED      12.1.0.2.0  00:14:01       
JServer JAVA Virtual Machine                                                    
.                                         VALID      12.1.0.2.0  00:03:11       
Oracle Real Application Clusters                                                
.                                    OPTION OFF      12.1.0.2.0  00:00:02       
Oracle Workspace Manager                                                        
.                                         VALID      12.1.0.2.0  00:01:05       
Oracle Label Security                                                           
.                                         VALID      12.1.0.2.0  00:00:07       
Oracle XDK                                                                      
.                                         VALID      12.1.0.2.0  00:00:49       
Oracle Text                                                                     
.                                         VALID      12.1.0.2.0  00:00:12       
Oracle XML Database                                                             
.                                         VALID      12.1.0.2.0  00:00:54       
Oracle Database Java Packages                                                   
.                                         VALID      12.1.0.2.0  00:00:15       
Oracle Multimedia                                                               
.                                         VALID      12.1.0.2.0  00:02:03       
Oracle Database Vault                                                           
.                                         VALID      12.1.0.2.0  00:00:13       
Post Upgrade                                                                    
.                                                                00:01:18       
Final Actions                                                                   
.                                                                00:00:01       
Total Upgrade Time: 00:24:51                                                    
 
PL/SQL procedure successfully completed.
 
Elapsed: 00:00:00.11
.                                                                               
Oracle Database 12.1 Post-Upgrade Status Tool           06-12-2014 21:49:18     
.                             CDB1_PDB3:5                                       
Component                               Current         Version  Elapsed Time   
Name                                    Status          Number   HH:MM:SS       
.                                                                               
Oracle Server                                                                   
.                                      UPGRADED      12.1.0.2.0  00:13:57       
JServer JAVA Virtual Machine                                                    
.                                         VALID      12.1.0.2.0  00:03:01       
Oracle Real Application Clusters                                                
.                                    OPTION OFF      12.1.0.2.0  00:00:02       
Oracle Workspace Manager                                                        
.                                         VALID      12.1.0.2.0  00:01:07       
Oracle Label Security                                                           
.                                         VALID      12.1.0.2.0  00:00:07       
Oracle XDK                                                                      
.                                         VALID      12.1.0.2.0  00:00:46       
Oracle Text                                                                     
.                                         VALID      12.1.0.2.0  00:00:12       
Oracle XML Database                                                             
.                                         VALID      12.1.0.2.0  00:00:58       
Oracle Database Java Packages                                                   
.                                         VALID      12.1.0.2.0  00:00:13       
Oracle Multimedia                                                               
.                                         VALID      12.1.0.2.0  00:02:10       
Oracle Database Vault                                                           
.                                         VALID      12.1.0.2.0  00:00:13       
Post Upgrade                                                                    
.                                                                00:01:17       
Final Actions                                                                   
.                                                                00:00:01       
Total Upgrade Time: 00:24:42                                                    
 
PL/SQL procedure successfully completed.
 
Elapsed: 00:00:00.10
.                                                                               
Oracle Database 12.1 Post-Upgrade Status Tool           06-12-2014 21:51:15     
.                             CDB1_PDB4:6                                       
Component                               Current         Version  Elapsed Time   
Name                                    Status          Number   HH:MM:SS       
.                                                                               
Oracle Server                                                                   
.                                      UPGRADED      12.1.0.2.0  00:13:41       
JServer JAVA Virtual Machine                                                    
.                                         VALID      12.1.0.2.0  00:02:48       
Oracle Real Application Clusters                                                
.                                    OPTION OFF      12.1.0.2.0  00:00:04       
Oracle Workspace Manager                                                        
.                                         VALID      12.1.0.2.0  00:00:58       
Oracle Label Security                                                           
.                                         VALID      12.1.0.2.0  00:00:07       
Oracle XDK                                                                      
.                                         VALID      12.1.0.2.0  00:00:40       
Oracle Text                                                                     
.                                         VALID      12.1.0.2.0  00:00:15       
Oracle XML Database                                                             
.                                         VALID      12.1.0.2.0  00:00:50       
Oracle Database Java Packages                                                   
.                                         VALID      12.1.0.2.0  00:00:16       
Oracle Multimedia                                                               
.                                         VALID      12.1.0.2.0  00:02:04       
Oracle Database Vault                                                           
.                                         VALID      12.1.0.2.0  00:00:15       
Post Upgrade                                                                    
.                                                                00:01:16       
Final Actions                                                                   
.                                                                00:00:01       
Total Upgrade Time: 00:23:54                                                    
 
PL/SQL procedure successfully completed.
 
Elapsed: 00:00:00.08
.                                                                               
Oracle Database 12.1 Post-Upgrade Status Tool           06-12-2014 22:08:18     
.                             CDB1_PDB5:7                                       
Component                               Current         Version  Elapsed Time   
Name                                    Status          Number   HH:MM:SS       
.                                                                               
Oracle Server                                                                   
.                                      UPGRADED      12.1.0.2.0  00:09:42       
JServer JAVA Virtual Machine                                                    
.                                         VALID      12.1.0.2.0  00:02:31       
Oracle Real Application Clusters                                                
.                                    OPTION OFF      12.1.0.2.0  00:00:01       
Oracle Workspace Manager                                                        
.                                         VALID      12.1.0.2.0  00:00:52       
Oracle Label Security                                                           
.                                         VALID      12.1.0.2.0  00:00:05       
Oracle XDK                                                                      
.                                         VALID      12.1.0.2.0  00:00:42       
Oracle Text                                                                     
.                                         VALID      12.1.0.2.0  00:00:13       
Oracle XML Database                                                             
.                                         VALID      12.1.0.2.0  00:00:44       
Oracle Database Java Packages                                                   
.                                         VALID      12.1.0.2.0  00:00:12       
Oracle Multimedia                                                               
.                                         VALID      12.1.0.2.0  00:01:44       
Oracle Database Vault                                                           
.                                         VALID      12.1.0.2.0  00:00:12       
Post Upgrade                                                                    
.                                                                00:01:08       
Final Actions                                                                   
.                                                                00:00:01       
Total Upgrade Time: 00:18:44                                                    
 
PL/SQL procedure successfully completed.
 
Elapsed: 00:00:00.08
.       
</pre></div>
<!-- class="example" --></div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<div class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref433"></a>
<h3 class="sect2"><span class="secnum">3.10.14</span> Standard Edition Starter Database and Components with Status OPTION OFF</h3>
<p>When the <a id="sthref434"></a>Standard Edition (SE) starter database is upgraded, components that are not included with the starter database cannot be upgraded by the SE server because they require options that are not installed in the Standard Edition.</p>
<p>After the upgrade, components may have a <code dir="ltr">STATUS</code> value of <code dir="ltr">OPTION OFF</code> in the <code dir="ltr">DBA_REGISTRY</code> view, and there are some invalid objects in the associated component schemas. The Database Upgrade Assistant (DBUA) shows unsuccessful upgrades for these components.</p>
</div>
<!-- class="sect2" -->
<a id="CHDCDEAE"></a>
<div id="UPGRD60136" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.10.15</span> Adjusting Oracle ASM Password File Location After Upgrade</h3>
<p>The Oracle ASM password file location is not shown in the command output when you invoke <code dir="ltr">srvctl config asm</code> after a Grid Infrastructure upgrade. The location of the password file is not automatically passed to the new Oracle ASM disk group. To enable SRVCTL to have the password file location after upgrade, you must advance the diskgroup compatibility setting and create a PWFILE in the diskgroup. Then SRVCTL will report the configured location of the shared PWFILE.</p>
<p>Follow the procedure in <a class="olink OSTMG95331" href="../OSTMG/GUID-DB3721CE-B1F4-4FB4-B290-B6D33BEAA5F2.htm#OSTMG95331"><span class="italic">Oracle Automatic Storage Management Administrator&#39;s Guide</span></a> for managing a shared password file in a disk group.</p>
</div>
<!-- class="sect2" -->
<a id="CHDIEEIE"></a>
<div id="UPGRD60137" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.10.16</span> Error ORA-27248: sys.dra_reevaluate_open_failures is running</h3>
<p>If DBUA failed with error &#34;ORA-27248: sys.dra_reevaluate_open_failures is running&#34; when upgrading the database, then the job <code dir="ltr">DRA_REEVALUATE_OPEN_FAILURES</code> is running and causes upgrade failure. You need to ensure that the job is stopped.</p>
<p>In a job definition, if <code dir="ltr">ALLOW_RUNS_IN_RESTRICTED_MODE</code> is set to TRUE, the job is permitted to run when the database is in restricted or upgrade mode, provided that the job owner is permitted to log in during this mode. The default setting is FALSE.</p>
<p>You can use the following query to see the state of any jobs that may be running:</p>
<pre dir="ltr">SQL&gt; select OBJECT_NAME, Owner, OBJECT_TYPE from dba_objects whereobject_name like &#39;%DRA_REEVA%&#39;;
</pre></div>
<!-- class="sect2" -->
<a id="CHDDHIHE"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.10.17</span> Oracle Database Enterprise User Security, OLS-OID, and Provisioning Profile Error</h3>
<p>After upgrading databases that use OLS and a standby database, you might see ORA-16000 (database open for read-only access). After switchover, the Provisioning profile should be updated with the connect information of the new primary. Otherwise, the policies will continue to get propagated to the new standby (old primary) and will fail with ORA-16000. See <a class="olink DBIMI10245" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=DBIMI10245"><span class="italic">Oracle Database Enterprise User Security Administrator&#39;s Guide</span></a> for information about the additional steps required for upgrading Oracle Database from release 10<span class="italic">g</span> (10.1) and higher to Oracle Database 12<span class="italic">c</span>.</p>
</div>
<!-- class="sect2" -->
<a id="CHDCIHGH"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.10.18</span> 32K Migration Error with utl32k.sql and MAX_STRING_SIZE</h3>
<p>An error is generated if the initialization parameter <code dir="ltr">MAX_STRING_SIZE</code> is set to <code dir="ltr">EXTENDED</code> but the 32K migration had not completed running the <code dir="ltr">utl32k.sql</code> script. The database upgrade will terminate with the following error:</p>
<pre dir="ltr">SELECT TO_NUMBER(&#39;32K_MIGRATION_NOT_COMPLETED&#39;)
                    *
      ERROR at line 1:
      ORA-01722: invalid number
</pre>
<p>The database upgrade does not automatically run the <code dir="ltr">utl32k.sql</code> script and does not perform the 32K migration.</p>
<p>To complete the upgrade and the 32K migration after upgrading:</p>
<ol>
<li>
<p>Reset the initialization parameter <code dir="ltr">MAX_STRING_SIZE</code> to <code dir="ltr">STANDARD</code>.</p>
</li>
<li>
<p>Restart the database in <code dir="ltr">UPGRADE</code> mode.</p>
</li>
<li>
<p>Rerun the upgrade, either with DBUA or the manual procedure.</p>
</li>
<li>
<p>After the database has been upgraded, set the initialization parameter <code dir="ltr">MAX_STRING_SIZE</code> to <code dir="ltr">EXTENDED</code>.</p>
</li>
<li>
<p>Restart the database in <code dir="ltr">UPGRADE</code> mode.</p>
</li>
<li>
<p>Run <code dir="ltr">../rdbms/admin/utl32k.sql</code>.</p>
</li>
</ol>
<p>The upgraded database will complete the 32K migration and will support the <code dir="ltr">EXTENDED</code> parameter.</p>
</div>
<!-- class="sect2" -->
<a id="CHDDAIAE"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.10.19</span> ASM Loses Rolling Migration State If CRS Shutdown On All Nodes</h3>
<p>Oracle Automatic Storage Management (Oracle ASM) loses the rolling migration state if Cluster Ready Services (CRS) shuts down on all nodes. Consider the following scenario of four nodes (node1, node2, node3, and node4) that are at Oracle Database release 11.2.0.2 and being upgraded to release 12.1.0.2.</p>
<ul>
<li>
<p>Node1 and node2 are upgraded to 12.1.0.2 and running.</p>
</li>
<li>
<p>Node3 and node 4 are still at 11.2.0.2 and running.</p>
</li>
<li>
<p>Now consider that there is an outage where all CRS stacks are down, which leaves the cluster in a heterogeneous state (that is, two nodes at 11.2.0.2 and two nodes at 12.1.0.2).</p>
</li>
</ul>
<p>To proceed with the upgrade, only nodes at release 11.2.0.2 (i.e., node3 or node4 or both) should be started and the following command needs to be executed: <code dir="ltr">ALTER SYSTEM START ROLLING MIGRATION TO &#39;12.1.0.2&#39;</code> command on the Oracle ASM instance on node3 or node4 before starting any 12.1.0.2 node.</p>
<p>Note that before executing above step to bring the Oracle ASM cluster back into rolling migration, you cannot start two nodes of different versions in the cluster. If you do so, one of the Oracle ASM versions will fail with either the ORA-15153 or ORA-15163 error message.</p>
<p>Continue the upgrade procedure as already documented from this point forward.</p>
</div>
<!-- class="sect2" -->
<a id="CHDBDJEB"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.10.20</span> Data Type Versioning Could Cause Cross-Version Replication (ORA-26656)</h3>
<p>As part of release 12.1.0.2, versioning of data types that could be attributes of Oracle object types have been introduced (reference Bug 18897657). Because of this feature, cross-version replication between release 12.1.0.1 and release 12.1.0.2 databases might be affected resulting in the ORA-26656 error.</p>
<p>If any user-defined object types contain attributes of <code dir="ltr">DATE</code>, <code dir="ltr">TIMESTAMP</code>, <code dir="ltr">TIMESTAMP WITH TIME ZONE</code>, <code dir="ltr">TIMESTAMP WITH LOCAL TIME ZONE</code>, <code dir="ltr">BINARY_FLOAT</code>, <code dir="ltr">BINARY_DOUBLE</code>, <code dir="ltr">NCHAR</code>, <code dir="ltr">NVARCHAR2</code>, <code dir="ltr">NCLOB</code>, <code dir="ltr">ANYDATA</code>, etc., you must apply the mandatory Patch Set Update 18038108 to all release 12.1.0.1 instances.</p>
</div>
<!-- class="sect2" -->
<a id="CHDJBAJB"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.10.21</span> Oracle XML DB Errors ORA-64123 and ORA-14097</h3>
<p>The issue described in this section is for upgrading release 11.2.0.2 Oracle Database only.</p>
<p>The following scenario will cause the <code dir="ltr">ALTER TABLE EXCHANGE PARTITION</code> statement to fail with errors:</p>
<p>On an 11.2.0.2 database, you create an XMLType table or a table with an XMLType column that is partitioned and then create a structured XMLIndex on the table. Next, you upgrade the 11.2.0.2 database to Oracle Database 12<span class="italic">c</span> or above. If you execute the <code dir="ltr">ALTER TABLE EXCHANGE PARTITION</code> statement on one of the base table partitions with another partition or table that is created in the Oracle Database 12<span class="italic">c</span> database with the same structure and similar XMLIndex, then it will fail with the following error:</p>
<pre dir="ltr">ORA-64123: XMLIndex DDL: failure of a recursive DDL 
ORA-14097: column type or size mismatch in ALTER TABLE EXCHANGE PARTITION 
</pre>
<p>This is not an issue if your index was created on a non-11.2.0.2 database. 11.2.0.2 is the only database release with this issue. Other database releases, like 11.2.0.1 and 11.2.0.3, do not have this issue.</p>
<p>The <span class="bold">workaround</span> is as follows: after upgrading to Oracle Database 12<span class="italic">c</span> or later, drop and re-create the structured XMLIndex on the table where the index was upgraded from release 11.2.0.2.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABCGHFJ"></a>
<div id="UPGRD12412" class="sect1">
<h2 class="sect1"><span class="secnum">3.11</span> Rerunning the Upgrade for Oracle Database</h2>
<p>When upgrading Oracle Database, the upgrade process can be rerun or restarted with DBUA or with the <code dir="ltr">catctl.pl</code> script.</p>
<p>You can use the following methods to rerun the upgrade:</p>
<ul>
<li>
<p><a href="#CHDDFEIF">Rerunning the Upgrade with the Upgrade (catctl.pl) Script</a></p>
</li>
<li>
<p><a href="#CHDHBDHB">Options for Rerunning the Upgrade for a Multitenant Database (CDB)</a></p>
</li>
</ul>
<a id="CHDDFEIF"></a>
<div id="UPGRD52809" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.11.1</span> Rerunning the Upgrade with the Upgrade (catctl.pl) Script</h3>
<p>You can rerun the upgrade with the <code dir="ltr">catctl.pl</code> script. Also see <a href="#CHDHBDHB">&#34;Options for Rerunning the Upgrade for a Multitenant Database (CDB).&#34;</a></p>
<ol>
<li>
<p>Shut down the database. For a non-CDB and a CDB, the syntax is the same.</p>
<pre dir="ltr">SQL&gt; SHUTDOWN IMMEDIATE
</pre></li>
<li>
<p>Restart the database in <code dir="ltr">UPGRADE</code> mode.</p>
<p>For a non-CDB:</p>
<pre dir="ltr">SQL&gt; STARTUP UPGRADE
</pre>
<p>For a CDB:</p>
<pre dir="ltr">SQL&gt; STARTUP UPGRADE alter pluggable database all open upgrade;
</pre></li>
<li>
<p>Rerun <code dir="ltr">catctl.pl</code>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can rerun the <code dir="ltr">catctl.pl</code> script as many times as necessary. For a CDB you can rerun <code dir="ltr">catctl.pl</code> for a specific PDB. For example, for a PDB named PDB1:
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl catctl.pl -n 4 -l $ORACLE_HOME/diagnostics catupgrd.sql -c &#39;PDB1&#39;
</pre></div>
</li>
<li id="CHDBDFHC">
<p>Run <code dir="ltr">utlu121s.sql</code>, the Post-Upgrade Status Tool, which provides a summary of the status of the upgrade in the spool log. You can run <code dir="ltr">utlu121s.sql</code> any time <span class="italic">before</span> or <span class="italic">after</span> completing the upgrade.</p>
<p>In a non-CDB:</p>
<pre dir="ltr">SQL&gt; @rdbms/admin/utlu121s.sql
</pre>
<p>In a CDB:</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl catcon.pl -n 1 -e -b utlu121s -d &#39;&#39;&#39;.&#39;&#39;&#39; utlu121s.sql
</pre>
<p>If the <code dir="ltr">utlu121s.sql</code> script returns errors or shows components that are not <code dir="ltr">VALID</code> or not the most recent release, then see <a href="#i1012368">&#34;Troubleshooting the Upgrade for Oracle Database&#34;</a> for more information.</p>
</li>
<li>
<p><span class="bold">Important:</span> The <code dir="ltr">catuppst.sql</code> script is run as part of the upgrade process unless the upgrade returns errors during the process. Check the log file for &#34;Started: catuppst.sql&#34; to verify that <code dir="ltr">catuppst.sql</code> ran during the upgrade process. If <code dir="ltr">catuppst.sql</code> has not run, then proceed to run <code dir="ltr">catuppst.sql</code> as shown in this step. Warning messages are also displayed when running <code dir="ltr">catctl.pl</code> indicating that <code dir="ltr">catuppst.sql</code> was not run during the upgrade.</p>
<p>Run <code dir="ltr">catuppst.sql</code>, which is located in the <code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code><code dir="ltr">/rdbms/admin</code> directory, as follows:</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl catcon.pl -n 1 -e -b catuppst -d &#39;&#39;&#39;.&#39;&#39;&#39; catuppst.sql
</pre>
<p>The log file <code dir="ltr">catuppst0.log</code> will be generated with the results of the post upgrade.</p>
</li>
<li>
<p>Run <code dir="ltr">utlrp.sql</code> to recompile any remaining stored PL/SQL and Java code.</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl catcon.pl -n 1 -e -b utlrp -d &#39;&#39;&#39;.&#39;&#39;&#39; utlrp.sql
</pre>
<p>The log file <code dir="ltr">utlrp0.log</code> will be generated with the results of the re-compilations.</p>
<p>Verify that all expected packages and classes are valid.</p>
<p>In a single PDB (<code dir="ltr">PDB1</code> in this example), open the PDB in normal mode as follows:</p>
<pre dir="ltr">alter pluggable database PDB1 open;
</pre>
<p>Run <code dir="ltr">catcon.pl</code> to invoke <code dir="ltr">utlrp.sql</code> in the PDB to recompile any remaining stored PL/SQL and Java code. Use the following syntax:</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl catcon.pl -n 1 -e -b utlrp -d &#39;&#39;&#39;.&#39;&#39;&#39; -c &#39;PDB1&#39;
 utlrp.sql
</pre>
<p>In a non-CDB:</p>
<pre dir="ltr">SQL&gt; SELECT count(*) FROM dba_invalid_objects;
SQL&gt; SELECT distinct object_name FROM dba_invalid_objects;
</pre>
<p>In an entire CDB:</p>
<pre dir="ltr">SQL&gt; ALTER SESSION SET CONTAINER = &#34;CDB$ROOT&#34;
SQL&gt; SELECT count(*) FROM dba_invalid_objects;
SQL&gt; SELECT distinct object_name FROM dba_invalid_objects;
SQL&gt; ALTER SESSION SET CONTAINER = &#34;PDB$SEED&#34;
SQL&gt; SELECT count(*) FROM dba_invalid_objects;
SQL&gt; SELECT distinct object_name FROM dba_invalid_objects;
SQL&gt; ALTER SESSION SET CONTAINER = &#34;PDB1&#34;
SQL&gt; SELECT count(*) FROM dba_invalid_objects;
SQL&gt; SELECT distinct object_name FROM dba_invalid_objects;
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
If the Pre-upgrade Information Tool detected <code dir="ltr">INVALID</code> objects and populated the <code dir="ltr">registry$sys_inv_objs</code> and <code dir="ltr">registry$nonsys_inv_objs</code> tables, then execute <code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code><code dir="ltr">/rdbms/admin/utluiobj.sql</code> to display only those objects which are newly invalid because of the upgrade process. The <code dir="ltr">utluiobj.sql</code> script only displays objects that are now <code dir="ltr">INVALID</code> but which were <code dir="ltr">VALID</code> before the upgrade.</div>
</li>
<li>
<p>Run <code dir="ltr">utlu121s.sql</code> again to verify that all issues have been fixed.</p>
<p>In a non-CDB:</p>
<pre dir="ltr">SQL&gt; @rdbms/admin/utlu121s.sql
</pre>
<p>In a CDB:</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl catcon.pl -n 1 -e -b utlu121s -d &#39;&#39;&#39;.&#39;&#39;&#39; utlu121s.sql
</pre></li>
<li>
<p>Exit SQL*Plus.</p>
</li>
<li>
<p>If you are upgrading a cluster database from releases 10.2, 11.1, or 11.2, then upgrade the database configuration in Oracle Clusterware using the following command:</p>
<pre dir="ltr">$ srvctl upgrade database -d <span class="italic">db-unique-name</span> -o <span class="italic">Oracle_home</span>
</pre>
<p>where <code dir="ltr"><span class="codeinlineitalic">db-unique-name</span></code> is the database name assigned to it (not the instance name), and <code dir="ltr"><span class="codeinlineitalic">Oracle_home</span></code> is the Oracle home location in which the database is being upgraded.</p>
</li>
</ol>
<p>Your database is now upgraded to Oracle Database 12<span class="italic">c</span>. You are ready to complete the procedures described in <a href="afterup.htm#BABEEEFF">Chapter 4, &#34;Post-Upgrade Tasks for Oracle Database&#34;</a>.</p>
</div>
<!-- class="sect2" -->
<a id="CHDHBDHB"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.11.2</span> Options for Rerunning the Upgrade for a Multitenant Database (CDB)</h3>
<p>Depending on the configuration of your multitenant database (CDB), there are several scenarios for rerunning the upgrade. You may opt to do the following:</p>
<ul>
<li>
<p><a href="#CHDECJIE">Rerun the Entire Upgrade for the CDB</a></p>
</li>
<li>
<p><a href="#CHDBFDID">Rerun the Upgrade Only on Specified CDBs</a></p>
</li>
<li>
<p><a href="#CHDHDHCA">Rerun the Upgrade While Other PDBs Are Online Using an Exclusion List</a></p>
</li>
<li>
<p><a href="#CHDCIGJI">Rerun the Upgrade Using an Inclusion List to Specify a CDB or PDBs</a></p>
</li>
<li>
<p><a href="#CHDDCAGD">Restarting the Upgrade from a Specific Phase that Failed Using -p</a></p>
</li>
</ul>
<a id="CHDECJIE"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">3.11.2.1</span> Rerun the Entire Upgrade for the CDB</h4>
<p>You may need to rerun the entire upgrade in the case where several different issues occur during the first attempt. This example demonstrates reupgrading the <code dir="ltr">CDB$ROOT</code>, <code dir="ltr">PDB$SEED</code> and containers when a problem such as running out of shared pool occurs.</p>
<ol>
<li>
<p>Start the upgrade again.</p>
<pre dir="ltr">SQL&gt; startup upgrade;
      alter pluggable database all open upgrade;
</pre></li>
<li>
<p>Run <code dir="ltr">catctl.pl</code> as follows:</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl $ORACLE_HOME/rdbms/admin/catctl.pl -d $ORACLE_
HOME/rdbms/admin -l $ORACLE_HOME/rdbms/log catctl.pl catupgrd.sql
</pre>
<p>The upgrade will be run again on all the containers included with <code dir="ltr">CDB$ROOT</code> and <code dir="ltr">PDB$SEED</code>.</p>
</li>
</ol>
</div>
<!-- class="sect3" -->
<a id="CHDBFDID"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">3.11.2.2</span> Rerun the Upgrade Only on Specified CDBs</h4>
<p>You may rerun the upgrade only on one or more specified multitenant containers (CDBs). You can do this with an exclusion list. An exclusion list contains containers that you do not want to upgrade. An exclusion list uses the <code dir="ltr">-C</code> parameter option in <code dir="ltr">catctl.pl</code>. (You must use uppercase C for this parameter; it is case sensitive.) This method can come in handy when there are many PDBs to reupgrade.</p>
<p>In this example, the multitenant container database contains five PDBs. All the upgrades were successful except that <code dir="ltr">CDB1_PDB1</code> and <code dir="ltr">CDB1_PDB2</code> failed with an upgrade error. The goal is to run the upgrade in <code dir="ltr">CDB1_PDB1</code> and <code dir="ltr">CDB1_PDB2</code> containers only. You can achieve this by shutting down the entire multitenant database and restarting only the PDBs you want to upgrade.</p>
<ol>
<li>
<p>Shutdown and then startup in upgrade mode.</p>
<pre dir="ltr">SQL&gt; shutdown immediate;
      startup upgrade;
      alter pluggable database CDB1_PDB1 open upgrade;
      alter pluggable database CDB1_PDB2 open upgrade;
</pre></li>
<li>
<p>Show the status of the CDB and PDBs.</p>
<pre dir="ltr"> SQL&gt; show pdbs
 
       CON_ID CON_NAME                       OPEN MODE  RESTRICTED
       ---------- ------------------------------ ---------- ----------
           2 PDB$SEED                       MIGRATE    YES
           3 CDB1_PDB1                      MIGRATE    YES
           4 CDB1_PDB2                      MIGRATE    YES
           5 CDB1_PDB3                      MOUNTED
           6 CDB1_PDB4                      MOUNTED
           7 CDB1_PDB5                      MOUNTED
</pre></li>
<li>
<p>Rerun the upgrade excluding <code dir="ltr">CDB$ROOT</code> and <code dir="ltr">PDB$SEED</code> from the upgrade.</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl $ORACLE_HOME/rdbms/admin/catctl.pl -d $ORACLE_
HOME/rdbms/admin -l $ORACLE_HOME/rdbms/log catctl.pl -C &#39;CDB$ROOT PDB$SEED&#39; 
catupgrd.sql
</pre></li>
</ol>
<p>The upgrade reruns and completes on <code dir="ltr">CDB1_PDB1</code> and <code dir="ltr">CDB1_PDB2</code>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
For Windows, the -C option must be specified with quotes around the CDB root name and PDB seed name, for example:
<p>... <code dir="ltr">-C &#34;CDB$ROOT PDB$SEED&#34;</code></p>
</div>
</div>
<!-- class="sect3" -->
<a id="CHDHDHCA"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">3.11.2.3</span> Rerun the Upgrade While Other PDBs Are Online Using an Exclusion List</h4>
<p>In this example, the <code dir="ltr">CDB$ROOT</code> will be started up in normal mode and the containers: <code dir="ltr">CDB1_PDB3</code>, <code dir="ltr">CDB1_PDB4</code>, and <code dir="ltr">CDB1_PDB5</code> are online. In this case the upgrade failed in containers <code dir="ltr">CDB1_PDB1</code> and <code dir="ltr">CDB1_PDB2</code>, but succeeded in containers: <code dir="ltr">CDB1_PDB3</code>, <code dir="ltr">CDB1_PDB4</code>, and <code dir="ltr">CDB1_PDB5</code>. The DBA reviews the upgrade logs for <code dir="ltr">CDB1_PDB3</code>, <code dir="ltr">CDB1_PDB4</code>, and <code dir="ltr">CDB1_PDB5</code> and brings these specific containers online.</p>
<p>To rerun upgrade on containers: <code dir="ltr">CDB1_PDB1</code> and <code dir="ltr">CDB1_PDB2</code> do the following:</p>
<ol>
<li>
<p>Bring up <code dir="ltr">CDB$ROOT</code> in normal mode and open <code dir="ltr">CDB1_PDB1</code> and <code dir="ltr">CDB1_PDB2</code> in upgrade mode. <code dir="ltr">CDB1_PDB3</code>, <code dir="ltr">CDB1_PDB4</code>, <code dir="ltr">CDB1_PDB5</code> are in normal mode. The example is as follows:</p>
<pre dir="ltr">SQL&gt; startup;
      alter pluggable database CDB1_PDB1 open upgrade;
      alter pluggable database CDB1_PDB2 open upgrade;
      alter pluggable database cdb1_pdb3 open;
      alter pluggable database cdb1_pdb4 open;
      alter pluggable database cdb1_pdb5 open;
</pre></li>
<li>
<p>Show the PDBs status.</p>
<pre dir="ltr">SQL&gt; show pdbs

        CON_ID CON_NAME                       OPEN MODE  RESTRICTED
        ---------- ------------------------------ ---------- ----------
             2 PDB$SEED                       READ ONLY  NO
             3 CDB1_PDB1                      MIGRATE    YES
             4 CDB1_PDB2                      MIGRATE    YES
             5 CDB1_PDB3                      READ WRITE NO
             6 CDB1_PDB4                      READ WRITE NO
             7 CDB1_PDB5                      READ WRITE NO
</pre></li>
<li>
<p>Now rerun the upgrade, excluding <code dir="ltr">CDB$ROOT</code> from the upgrade.</p>
<pre dir="ltr">$ORACLE_HOME/perl/bin/perl $ORACLE_HOME/rdbms/admin/catctl.pl -d $ORACLE_
HOME/rdbms/admin -l $ORACLE_HOME/rdbms/log catctl.pl -C &#39;CDB$ROOT&#39; 
catupgrd.sql
</pre>
<p>For Windows, the -C option must be specified with quotes around the CDB root name and PDB seed name, for example:</p>
<p>... <code dir="ltr">-C &#34;CDB$ROOT PDB$SEED&#34;</code></p>
<p>The upgrade reruns and completes on <code dir="ltr">CDB1_PDB1</code> and <code dir="ltr">CDB1_PDB2</code>.</p>
</li>
</ol>
</div>
<!-- class="sect3" -->
<a id="CHDCIGJI"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">3.11.2.4</span> Rerun the Upgrade Using an Inclusion List to Specify a CDB or PDBs</h4>
<p>Instead of using an exclusion list to rerun the upgrade, you can alternatively use an inclusion list to specify the CDB and/or PDBs you want to rerun the upgrading on. An inclusion list uses the <code dir="ltr">-c</code> parameter in <code dir="ltr">catctl.pl</code> as shown in this example:</p>
<pre dir="ltr"> $ORACLE_HOME/perl/bin/perl $ORACLE_HOME/rdbms/admin/catctl.pl -d $ORACLE_HOME/rdbms/admin -l $ORACLE_HOME/rdbms/log catctl.pl -c &#39;CDB1_PDB1 CDB1_PDB2&#39; catupgrd.sql
</pre>
<p>The upgrade reruns and completes on <code dir="ltr">CDB1_PDB1</code> and <code dir="ltr">CDB1_PDB2</code>.</p>
</div>
<!-- class="sect3" -->
<a id="CHDDCAGD"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">3.11.2.5</span> Restarting the Upgrade from a Specific Phase that Failed Using -p</h4>
<p>You can use <code dir="ltr">catctl.pl</code> to rerun an upgrade and skip upgrade phases that already have run successfully. To determine the phase number to restart, examine the upgrade log to identify where the first error occurred, and in what phase.</p>
<div class="sect4"><!-- infolevel="all" infotype="General" --><a id="sthref435"></a>
<h5 class="sect4"><span class="secnum">3.11.2.5.1</span> Reviewing Non-CDB Log Files for Failed Phases</h5>
<p>Log files can span from catupgrd0...catupgrd7.log.</p>
</div>
<!-- class="sect4" -->
<div class="sect4"><!-- infolevel="all" infotype="General" --><a id="sthref436"></a>
<h5 class="sect4"><span class="secnum">3.11.2.5.2</span> Reviewing CDB Log Files for Failed Phases</h5>
<p>Log files for CDB$ROOT (CDBs) can span from catupgrd0...catupgrd7.log. Log files for Containers (PDBs) span from catupgrdpdbname0...catupgradepdbname7.log.</p>
</div>
<!-- class="sect4" -->
<div class="sect4"><!-- infolevel="all" infotype="General" --><a id="sthref437"></a>
<h5 class="sect4"><span class="secnum">3.11.2.5.3</span> Procedure for Finding and Restarting Multitenant Upgrades from a Failed Phase</h5>
<p>To restart a multitenant upgrade from a failed phase, first identify which PDB created the error and then search its appropriate log file.</p>
<p>To identify the PDB that caused a multitenant upgrade failure, look at the upgrade summary report, or review catupgrd0.log; this log contains the upgrade summary report at the end of the file.</p>
<p>Use this procedure to check each log file looking for errors:</p>
<ol>
<li>
<p>Locate log files with errors. For example:</p>
<p>Linux and UNIX:</p>
<pre dir="ltr">$ grep -i &#39;error at line&#39; catupgrd*.log 
</pre>
<p>Windows:</p>
<pre dir="ltr">C:\&gt; find /I &#34;error at line&#34; catupgrd*.log
</pre>
<p>The <code dir="ltr">grep</code> or <code dir="ltr">find</code> command displays the filenames of log files in which an error is found.</p>
</li>
<li>
<p>Check each log file that has an error and identify where the first error occurred. Use the text editor of your choice to review each log file. Search for the first occurrence of the phrase &#39;error at line&#39;. When you find the phrase, then search backwards from the error (reverse search) for PHASE_TIME___START. For example:</p>
<pre dir="ltr">PHASE_TIME___START 15 15-01-16 08:49:41
</pre>
<p>The number after PHASE_TIME___START is the phase number where the error has occurred. In this example, the phase number is15.</p>
<p>Each log file can have an error in it. Repeat this phrase check, and identify the phase number with errors for each log file that contains an error, and identify the log file that contains the lowest phase number.</p>
<p>The log file that contains the lowest phase number is the restart phase number. This is the phase number from which you restart the upgrade.</p>
<p>For example:</p>
<p><code dir="ltr">catupgrd0.log</code> error occurred in phase 15:</p>
<pre dir="ltr">PHASE_TIME___START 15 15-01-16 08:49:41
</pre>
<p><code dir="ltr">catupgrd1.log</code> error occurred in phase 19:</p>
<pre dir="ltr">PHASE_TIME___START 19 15-01-16 08:50:01
</pre>
<p>In this example, the restart phase number is 15. Ensure that you identify the first error seen in all the log files, so that you can restart the upgrade from that phase.</p>
</li>
<li>
<p>Restart the upgrade from the failed phase by changing directory to the running the catctl.pl command using the -p flag, and providing the restart phase number. In multitenant databases, also use the -c flag using the syntax <code dir="ltr">-c &#39;</code><code dir="ltr"><span class="codeinlineitalic">PDBname</span></code><code dir="ltr">&#39;</code>, where <code dir="ltr"><span class="codeinlineitalic">PDBname</span></code> is the name of the PDB where the failure occurred.</p>
<p>For example:</p>
<p>Non-CDB Oracle Database:</p>
<pre dir="ltr">cd $ORACLE_HOME/rdbms/admin
$ORACLE_HOME/perl/bin/perl catctl.pl -p 15 catupgrd.sql
</pre>
<p>PDB in a multitenant Oracle Database (CDB):</p>
<pre dir="ltr">cd $ORACLE_HOME/rdbms/admin
$ORACLE_HOME/perl/bin/perl catctl.pl -p 15 -c &#39;PDB1&#39; catupgrd.sql
</pre>
<p>In both examples, the upgrade is restarted from phase 15, identified with the -p flag. In the multitenant example, the PDB with the error is identified with the -c flag.</p>
<p>In these examples, the upgrade starts from phase 15 and runs to the end of the upgrade.</p>
</li>
<li>
<p>(Optional) You can also run the phase that contained an error by specifying a stop phase, using the -P flag. Using a stop phase allows the upgrade to just rerun that phase in which the error occurred. You can determine quickly if the error is fixed by running it on the phase with the error, without running the entire upgrade.</p>
<p>In the following catctl.pl command example, the upgrade is restarted at phase 15, and it is stopped at the end of phase 15 using the -P flag to specify the stop phase:</p>
<pre dir="ltr">cd $ORACLE_HOME/rdbms/admin
$ORACLE_HOME/perl/bin/perl catctl.pl -p 15 -P 15 -c &#39;PDB1&#39; catupgrd.sql
</pre>
<p>After you confirm that the error is fixed in the phase with the error, you can then resume the upgrade after that phase.</p>
<p>For example, if you have confirmed that the error in phase 15 of your multitenant database upgrade of PDB1 is fixed, then you can use the following command to continue the upgrade at phase 16:</p>
<pre dir="ltr">cd $ORACLE_HOME/rdbms/admin $ORACLE_HOME/perl/bin/perl catctl.pl -p 16 -c &#39;PDB1&#39; catupgrd.sql
</pre></li>
</ol>
</div>
<!-- class="sect4" --></div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1827">
<tr>
<td class="cellalignment1834">
<table class="cellalignment1832">
<tr>
<td class="cellalignment1831"><a href="preup.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1831"><a href="afterup.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2002, 2017,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1836">
<table class="cellalignment1830">
<tr>
<td class="cellalignment1831"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1831"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1831"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1831"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1831"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1831"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>