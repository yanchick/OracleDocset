<!DOCTYPE html><html lang="en-US"><head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="UTF-8"/>
<a class="dashingAutolink" name="autolink-5271"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Administering%20the%20Audit%20Trail"></a><title>Administering the Audit Trail</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"/>
<meta name="description" content="As a user who has been granted the AUDIT_ADMIN role, you can manage the audit trail, archive the audit trail, and purge audit trail records."/>
<meta name="keywords" content="auditing, when audit options take effect, sessions, when auditing options take effect, unified audit trail, when records are created, writing audit trail records to AUDSYS, minimum flush threshold for queues, mandatory auditing, administrative users, mandatorily audited, cursors, affect on auditing, cursors, affect on auditing, about, immediate-write mode, queued-write mode, configuring modes, manually flushing records to AUDSYS, databases, when unavailable, loading audit records to, loading audit records to unified audit trail, unified auditing, disabling, audit files, operating system file, archiving, operating system audit files, standard audit trail, records, purging, audit trail, unified, records, archiving, standard auditing, archiving audit trail, fine-grained auditing, SYS.FGA_LOG$ table, SYS.AUD$ table, records, auditing, purging records, general steps for, roadmap, purging records, general steps for scheduledl purges, general steps for scheduled purges, general steps for manual purges, DBMS_SCHEDULER package, creating audit trail, purge job, Oracle Database Real Application Clusters, archive timestamp for audit records, archiving, setting timestamp, timestamping audit trail, operating system audit trail, setting archive timestamp, creating the purge job, scheduling the purge job, purging audit trail manually, enabling purge jobs, disabling purge jobs, time interval for named purge job, deleting a purge job, cancelling archive timestamp, purging records, example, examples, audit trail, purging unified trail, example, views, audit management settings, finding information about audit management"/>
<meta name="dcterms.created" content="2017-06-05T11:20:26Z"/>
<meta name="robots" content="all"/>
<meta name="dcterms.title" content="Database Security Guide"/>
<meta name="dcterms.identifier" content="E48135-19"/>
<meta name="dcterms.isVersionOf" content="DBSEG"/>
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2006, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved."/>
<link rel="Start" href="../index.htm" title="Home" type="text/html"/>
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html"/>

<script type="application/javascript" src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript" src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html"/>
<link rel="Index" href="index.htm" title="Index" type="text/html"/>
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html"/>
<link rel="Prev" href="audit_config.htm" title="Previous" type="text/html"/>
<link rel="Next" href="part_7.htm" title="Next" type="text/html"/>
<link rel="alternate" href="E48135-19.pdf" title="PDF version" type="application/pdf"/>
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/header.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/footer.css"/>
<link rel="stylesheet" type="text/css" href="../dcommon/css/fonts.css"/>
<link rel="stylesheet" href="../dcommon/css/foundation.css"/>
<link rel="stylesheet" href="../dcommon/css/codemirror.css"/>
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css"/>
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css"/>
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="/s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet" href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen"/>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-9F298B8A-6196-4206-A889-A7CEB0924CF1"></a> <span id="PAGE" style="display:none;">34/44</span> <!-- End Header -->
<a id="DBSEG1026"></a>
<h1 id="DBSEG-GUID-9F298B8A-6196-4206-A889-A7CEB0924CF1" class="sect1"><span class="enumeration_chapter">23</span> Administering the Audit Trail</h1>
<div>
<p>As a user who has been granted the <code class="codeph">AUDIT_ADMIN</code> role, you can manage the audit trail, archive the audit trail, and purge audit trail records.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="audit_admin.htm#GUID-2A5CFDFC-320B-41D0-86AB-B524992E02A8" title="Auditing is enabled by default, but you can control when audit records are written to disk.">Managing the Unified Audit Trail</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-58CFB1F4-7E76-46A4-8DDD-2546DBD67FBE" title="You can archive the traditional operating system, unified database, and traditional database audit trails.">Archiving the Audit Trail</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-9B891A44-3DF4-4B52-98D4-A931DBFAEC1D" title="You can use the DBMS_AUDIT_MGMT PL/SQL package to schedule automatic purge jobs, manually purge audit records, and perform other audit trail operations.">Purging Audit Trail Records</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-2AC6F69F-5BEA-4AC7-9A22-2966121A43ED" title="Oracle Database provides data dictionary views that list information about audit trail management settings.">Audit Trail Management Data Dictionary Views</a></p>
</li>
</ul>
</div>
<a id="DBSEG629"></a>
<div class="props_rev_3"><a id="GUID-2A5CFDFC-320B-41D0-86AB-B524992E02A8"></a>
<h2 id="DBSEG-GUID-2A5CFDFC-320B-41D0-86AB-B524992E02A8" class="sect2">Managing the Unified Audit Trail</h2>
<div>
<p>Auditing is enabled by default, but you can control when audit records are written to disk.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="audit_admin.htm#GUID-4E26E99D-C2CC-4A35-8720-F9E1CA3D95CC" title="Auditing is always enabled. Oracle Database generates audit records during or after the execution phase of the audited SQL statements.">When Are Audit Records Created?</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-AA781864-5756-464E-AFB6-675625AF0EF5" title="The UNIFIED_AUDIT_TRAIL data dictionary view captures activities from administrative users such as SYSDBA, SYSBACKUP, and SYSKM.">Activities That Are Mandatorily Audited</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-59DE03A1-8446-4F38-B35E-306D61616F21" title="For each execution of an auditable operation within a cursor, Oracle Database inserts one audit record into the audit trail.">How Do Cursors Affect Auditing?</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-1DD625ED-AC75-47E7-ADF6-1C7C93656F22" title="Oracle Database writes audit records to the AUDSYS schema.">Writing the Unified Audit Trail Records to the AUDSYS Schema</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-91B14CCD-E408-4669-82FA-EE833EDBBBA9" title="Audit records can be written to external files in the $ORACLE_BASE/audit/$ORACLE_SID directory.">Moving Operating System Audit Records into the Unified Audit Trail</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-80D9305C-29F6-4F3B-BDDB-371F619B08D8" title="You can disable unified auditing.">Disabling Unified Auditing</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-2A5CFDFC-320B-41D0-86AB-B524992E02A8__GUID-80118EB6-5097-4574-AC7E-D3B36E79229A">
<p class="notep1">See Also:</p>
<p><a href="audit_admin.htm#GUID-9B891A44-3DF4-4B52-98D4-A931DBFAEC1D" title="You can use the DBMS_AUDIT_MGMT PL/SQL package to schedule automatic purge jobs, manually purge audit records, and perform other audit trail operations.">Purging Audit Trail Records</a></p>
</div>
</div>
<a id="DBSEG353"></a>
<div class="props_rev_3"><a id="GUID-4E26E99D-C2CC-4A35-8720-F9E1CA3D95CC"></a>
<h3 id="DBSEG-GUID-4E26E99D-C2CC-4A35-8720-F9E1CA3D95CC" class="sect3">When Are Audit Records Created?</h3>
<div>
<p>Auditing is always enabled. Oracle Database generates audit records during or after the execution phase of the audited SQL statements.</p>
<p>Oracle Database individually audits SQL statements inside PL/SQL program units, as necessary, when the program unit is run.</p>
<p>You can control the frequency when audit trail records are written to disk. If the write mode is set to queued, then the audit records are written periodically to the SGA and not to disk immediately. If you want to write the audit records immediately to disk, then you can set it to immediate-write mode. Otherwise, there is a minimum flush threshold configured by default which checks if the queues were flushed more than 3 seconds before and accordingly flushes the audit records in the SGA queue. However, owing to the database activity, the flush may not happen every 3 seconds and could take longer.</p>
<p>The generation and insertion of an audit trail record is independent of the user transaction being committed. That is, even if a user transaction is rolled back, the audit trail record remains committed.</p>
<p>Statement and privilege audit options from unified audit policies that are in effect at the time a database user connects to the database remain in effect for the duration of the session. When the session is already active, setting or changing statement or privilege unified audit options does not take effect in that session. The modified statement or privilege audit options take effect only when the current session ends and a new session is created.</p>
<p>In contrast, changes to schema object audit options become immediately effective for current sessions.</p>
<p>By default, audit trail records are written to the <code class="codeph">SYSAUX</code> tablespace. You can designate a different tablespace, including one that is encrypted, by using the <code class="codeph">DBMS_AUDIT_MGMT.SET_AUDIT_TRAIL_LOCATION</code> procedure.</p>
<div class="infoboxnotealso" id="GUID-4E26E99D-C2CC-4A35-8720-F9E1CA3D95CC__GUID-E11FFEE8-8FFD-4AB9-A733-E3D5BEE6F2E7">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="audit_admin.htm#GUID-1DD625ED-AC75-47E7-ADF6-1C7C93656F22" title="Oracle Database writes audit records to the AUDSYS schema.">Writing the Unified Audit Trail Records to the AUDSYS Schema</a> for more information about immediate-write mode and queued-write mode</p>
</li>
<li>
<p><a class="olink CNCPT015" target="_blank" href="../CNCPT/sqllangu.htm#CNCPT015"><span><cite>Oracle Database Concepts</cite></span></a> for information about the different phases of SQL statement processing and shared SQL</p>
</li>
<li>
<p><a class="olink ARPLS65427" target="_blank" href="../ARPLS/d_audit_mgmt.htm#ARPLS65427"><span class="italic"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></span></a> for more information about the <code class="codeph">DBMS_AUDIT_MGMT.SET_AUDIT_TRAIL_LOCATION</code> procedure</p>
</li>
</ul>
</div>
</div>
</div>
<a id="DBSEG361"></a>
<div class="props_rev_3"><a id="GUID-AA781864-5756-464E-AFB6-675625AF0EF5"></a>
<h3 id="DBSEG-GUID-AA781864-5756-464E-AFB6-675625AF0EF5" class="sect3">Activities That Are Mandatorily Audited</h3>
<div>
<p>The <code class="codeph">UNIFIED_AUDIT_TRAIL</code> data dictionary view captures activities from administrative users such as <code class="codeph">SYSDBA</code>, <code class="codeph">SYSBACKUP</code>, and <code class="codeph">SYSKM</code>.</p>
<p>You do not need to audit the unified audit trail. The unified audit trail resides in a read-only table in the <code class="codeph">AUDSYS</code> schema. Hence, DMLs are not permitted on the unified audit trail views. Even DML and DDL operations on the underlying dictionary tables from <code class="codeph">AUDSYS</code> schema are not permitted.</p>
<p>The <code class="codeph">SYSTEM_PRIVILEGE_USED</code> column shows the type of administrative privilege that was used for the activity.</p>
<p>The following audit-related activities, such as modifications to audit policies, are mandatorily audited:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">CREATE AUDIT POLICY</code></p>
</li>
<li>
<p><code class="codeph">ALTER AUDIT POLICY</code></p>
</li>
<li>
<p><code class="codeph">DROP AUDIT POLICY</code></p>
</li>
<li>
<p><code class="codeph">AUDIT</code></p>
</li>
<li>
<p><code class="codeph">NOAUDIT</code></p>
</li>
<li>
<p><code class="codeph">EXECUTE</code> of the <code class="codeph">DBMS_FGA</code> PL/SQL package</p>
</li>
<li>
<p><code class="codeph">EXECUTE</code> of the <code class="codeph">DBMS_AUDIT_MGMT</code> PL/SQL package</p>
</li>
<li>
<p><code class="codeph">ALTER TABLE</code> attempts on the <code class="codeph">AUDSYS</code> audit trail table (remember that this table cannot be altered)</p>
</li>
<li>
<p>Top level statements by the administrative users <code class="codeph">SYS</code>, <code class="codeph">SYSDBA</code>, <code class="codeph">SYSOPER</code>, <code class="codeph">SYSASM</code>, <code class="codeph">SYSBACKUP</code>, <code class="codeph">SYSDG</code>, and <code class="codeph">SYSKM</code>, until the database opens. When the database opens, Oracle Database audits these users using the audit configurations in the system&mdash;not just the ones that were applied using the <code class="codeph">BY</code> clause in the <code class="codeph">AUDIT</code> statement, for example, but those that were applied for all users when <code class="codeph">AUDIT</code> statement does not have a <code class="codeph">BY</code> clause or when the <code class="codeph">EXCEPT</code> clause was used and these users were not excluded.</p>
</li>
<li>
<p>All user-issued DML statements on the <code class="codeph">SYS.AUD$</code> and <code class="codeph">SYS.FGA_LOG$</code> dictionary tables</p>
</li>
<li>
<p>Any attempts to modify the data or metadata of the unified audit internal table. <code class="codeph">SELECT</code> statements on this table are not audited by default or mandatorily.</p>
</li>
<li>
<p>All configuration changes that are made to Oracle Database Vault</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-AA781864-5756-464E-AFB6-675625AF0EF5__GUID-E21C5321-B62D-466F-86DD-50A22348D58A">
<p class="notep1">See Also:</p>
<p><a href="audit_config.htm#GUID-D352B575-2EA9-451D-9170-FD9298993DEF" title="Oracle Database provides a set of default administrative user accounts, such as SYS. You can create unified audit policies to capture the actions of these users.">Auditing Administrative Users</a></p>
</div>
</div>
</div>
<a id="DBSEG370"></a>
<div class="props_rev_3"><a id="GUID-59DE03A1-8446-4F38-B35E-306D61616F21"></a>
<h3 id="DBSEG-GUID-59DE03A1-8446-4F38-B35E-306D61616F21" class="sect3">How Do Cursors Affect Auditing?</h3>
<div>
<p>For each execution of an auditable operation within a cursor, Oracle Database inserts one audit record into the audit trail.</p>
<p>Events that cause cursors to be reused include the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>An application, such as Oracle Forms, holding a cursor open for reuse</p>
</li>
<li>
<p>Subsequent execution of a cursor using new bind variables</p>
</li>
<li>
<p>Statements executed within PL/SQL loops where the PL/SQL engine optimizes the statements to reuse a single cursor</p>
</li>
</ul>
<p>Auditing is <span class="italic">not</span> affected by whether or not a cursor is shared. Each user creates her or his own audit trail records on first execution of the cursor.</p>
</div>
</div>
<a id="DBSEG631"></a>
<div class="props_rev_3"><a id="GUID-1DD625ED-AC75-47E7-ADF6-1C7C93656F22"></a>
<h3 id="DBSEG-GUID-1DD625ED-AC75-47E7-ADF6-1C7C93656F22" class="sect3">Writing the Unified Audit Trail Records to the AUDSYS Schema</h3>
<div>
<p>Oracle Database writes audit records to the <code class="codeph">AUDSYS</code> schema.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="audit_admin.htm#GUID-84EE2115-DE09-4028-ACE9-CC331389A9CA" title="In a new or just-migrated Oracle Database installation, the AUDSYS schema is empty until unified auditing is initiated and records are generated.">About Writing Unified Audit Trail Records to AUDSYS</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-6C2F428C-E209-4626-8A5F-616CF0D31476" title="In a multitenant environment, the DBMS_AUDIT_MGMT.SET_AUDIT_TRAIL_PROPERTY procedure applies to the current pluggable database (PDB) only.">Setting the Write Mode for Unified Audit Trail Records</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-11FEBEC6-608F-48D9-8582-47BB555FC700" title="If you choose to use queued-write mode, then you can manually writing records to the unified audit trail.">Manually Flushing Audit Records to the Audit Trail in Queued-Write Mode</a></p>
</li>
</ul>
</div>
<a id="DBSEG827"></a>
<div class="props_rev_3"><a id="GUID-84EE2115-DE09-4028-ACE9-CC331389A9CA"></a>
<h4 id="DBSEG-GUID-84EE2115-DE09-4028-ACE9-CC331389A9CA" class="sect4">About Writing Unified Audit Trail Records to AUDSYS</h4>
<div>
<p>In a new or just-migrated Oracle Database installation, the <code class="codeph">AUDSYS</code> schema is empty until unified auditing is initiated and records are generated.</p>
<div class="infobox-note" id="GUID-84EE2115-DE09-4028-ACE9-CC331389A9CA__GUID-EC297E1A-C86F-4304-A72B-B10B7A161C04">
<p class="notep1">Note:</p>
<p>Starting with Oracle Database 12<span class="italic">c</span> release 12.2, the ability to flush audit records deprecated but is retained for backward compatibility.</p>
</div>
<p>This design greatly improves the performance of the audit trail processes and the database as a whole. In the previous release, in the event of an instance crash or during <code class="codeph">SHUTDOWN ABORT</code> operations, there was a chance that some audit records would be lost. Oracle recommends that you configure the audit trail to immediately write audit records to the <code class="codeph">AUDSYS</code> schema audit table by using the <code class="codeph">DBMS_AUDIT_MGMT.TRANSFER_UNIFIED_AUDIT_RECORDS</code> procedure to transfer the audit records to an internal relational table in the <code class="codeph">AUDSYS</code> schema.</p>
<p>From the previous release, the following modes, deprecated but retained for backward compatibility, are available. However, Oracle recommends that you use the <code class="codeph">DBMS_AUDIT_MGMT.TRANSFER_UNIFIED_AUDIT_RECORDS</code> procedure instead, as described in <a class="olink UPGRD-GUID-4BC5F146-BF0D-4BCF-8A0B-1B67B767EEF1" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=UPGRD-GUID-4BC5F146-BF0D-4BCF-8A0B-1B67B767EEF1"><span><cite>Oracle Database Upgrade Guide</cite></span></a>.</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Immediate-write mode.</span> This setting writes all audit records to the audit trail immediately. However, be aware that database performance may be affected.</p>
</li>
<li>
<p><span class="bold">Queued-write mode.</span> This setting, which is the default write mode, queues the audit records in memory to be written periodically to the <code class="codeph">AUDSYS</code> schema audit table. To set the size of the SGA, set the <code class="codeph">UNIFIED_AUDIT_SGA_QUEUE_SIZE</code> initialization parameter. The default size is 1 MB, and you can enter a range of <code class="codeph">1</code> through <code class="codeph">30</code>.</p>
</li>
</ul>
<div class="infobox-note" id="GUID-84EE2115-DE09-4028-ACE9-CC331389A9CA__GUID-651DDAC7-67A7-4B41-9CF9-1ACC5F0E8D16">
<p class="notep1">Note:</p>
<p>The <code class="codeph">UNIFIED_AUDIT_SGA_QUEUE_SIZE</code> initialization parameter has been deprecated, but is currently retained for backward compatibility.</p>
</div>
<div class="infoboxnotealso" id="GUID-84EE2115-DE09-4028-ACE9-CC331389A9CA__GUID-C93C700B-7F3F-4193-B42F-C0C6B6EB1225">
<p class="notep1">See Also:</p>
<p><a class="olink REFRN10343" target="_blank" href="../REFRN/GUID-060707DF-8431-4866-8B9F-4F450472D95E.htm#REFRN10343"><span><cite>Oracle Database Reference</cite></span></a> for more information about the <code class="codeph">UNIFIED_AUDIT_SGA_QUEUE_SIZE</code> initialization parameter</p>
</div>
</div>
</div>
<a id="DBSEG828"></a>
<div class="props_rev_3"><a id="GUID-6C2F428C-E209-4626-8A5F-616CF0D31476"></a>
<h4 id="DBSEG-GUID-6C2F428C-E209-4626-8A5F-616CF0D31476" class="sect4">Setting the Write Mode for Unified Audit Trail Records</h4>
<div>
<p>In a multitenant environment, the <code class="codeph">DBMS_AUDIT_MGMT.SET_AUDIT_TRAIL_PROPERTY</code> procedure applies to the current pluggable database (PDB) only.</p>
<div class="section">
<p>If the database is read-only, then <code class="codeph">DBMS_AUDIT_MGMT.SET_AUDIT_TRAIL_PROPERTY</code> sets the value directly in the SGA.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Log in to SQL*Plus as a user who has been granted the <code class="codeph">AUDIT_ADMIN</code> role.</span>
<div>
<p>For example:</p>
<pre dir="ltr">sqlplus audit_admin
Enter password: <span class="italic">password</span>
</pre></div>
</li>
<li class="stepexpand"><span>In a multitenant environment, connect to the appropriate PDB.</span>
<div>
<p>For example:</p>
<pre dir="ltr">CONNECT audit_admin@hrpdb
Enter password: <span class="italic">password</span>
</pre>
<p>To find the available PDBs, query the <code class="codeph">DBA_PDBS</code> data dictionary view. To check the current PDB, run the <code class="codeph">show con_name</code> command.</p>
</div>
</li>
<li class="stepexpand"><span>Set the <code class="codeph">AUDIT_TRAIL_MODE</code> property of the <code class="codeph">DBMS_AUDIT_MGMT</code> package, as follows:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p>To use immediate-write mode, run the following procedure:</p>
<pre dir="ltr">BEGIN
 DBMS_AUDIT_MGMT.SET_AUDIT_TRAIL_PROPERTY(
  DBMS_AUDIT_MGMT.AUDIT_TRAIL_UNIFIED,
  DBMS_AUDIT_MGMT.AUDIT_TRAIL_WRITE_MODE, 
  DBMS_AUDIT_MGMT.AUDIT_TRAIL_IMMEDIATE_WRITE);
END;
/
</pre></li>
<li>
<p>To use queued-write mode, run the following procedure:</p>
<pre dir="ltr">BEGIN
 DBMS_AUDIT_MGMT.SET_AUDIT_TRAIL_PROPERTY(
  DBMS_AUDIT_MGMT.AUDIT_TRAIL_UNIFIED, 
  DBMS_AUDIT_MGMT.AUDIT_TRAIL_WRITE_MODE, 
  DBMS_AUDIT_MGMT.AUDIT_TRAIL_QUEUED_WRITE);
END;
/
</pre></li>
</ul>
</div>
</li>
</ol>
<div class="section">
<p>The settings take effect on subsequent database sessions.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="DBSEG829"></a>
<div class="props_rev_3"><a id="GUID-11FEBEC6-608F-48D9-8582-47BB555FC700"></a>
<h4 id="DBSEG-GUID-11FEBEC6-608F-48D9-8582-47BB555FC700" class="sect4">Manually Flushing Audit Records to the Audit Trail in Queued-Write Mode</h4>
<div>
<p>If you choose to use queued-write mode, then you can manually writing records to the unified audit trail.</p>
<p>Be aware that there is a minimum flush threshold that is configured by default. It checks if the queues were flushed more than 3 seconds before and accordingly flushes the audit records in the SGA queue. However, owing to the database activity, the flush may not happen every 3 seconds and could take longer.</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="audit_admin.htm#GUID-9A17031A-5350-4D69-AE88-F46CC88562A6" title="You can manually write records to disk for the current database instance or the current Oracle Real Application Clusters (Oracle RAC) instance.">Writing Records to Disk for the Current Database Instance</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-509A994F-9354-4A25-B169-7E6A0C5A62C4" title="You can flush audit records across all Oracle Real Application Cluster (Oracle RAC) instances.">Writing Records to Disk Across an Oracle RAC Environment</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-F5F69055-025F-4FCF-8A50-3A23ED74AD7D" title="In a multitenant environment, you can write the audit trail records to disk for the current PDB or across all PDBs in a multitenent environment.">Writing Records to Disk in a Multitenant Environment</a></p>
</li>
</ul>
</div>
<a id="DBSEG898"></a>
<div class="props_rev_3"><a id="GUID-9A17031A-5350-4D69-AE88-F46CC88562A6"></a>
<h5 id="DBSEG-GUID-9A17031A-5350-4D69-AE88-F46CC88562A6" class="sect5">Writing Records to Disk for the Current Database Instance</h5>
<div>
<p>You can manually write records to disk for the current database instance or the current Oracle Real Application Clusters (Oracle RAC) instance.</p>
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>To manually write records to disk, run either of the following procedures:</p>
<pre dir="ltr">EXEC DBMS_AUDIT_MGMT.FLUSH_UNIFIED_AUDIT_TRAIL;

EXEC DBMS_AUDIT_MGMT.FLUSH_UNIFIED_AUDIT_TRAIL(DBMS_AUDIT_MGMT.FLUSH_CURRENT_INSTANCE);
</pre></li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="DBSEG925"></a>
<div class="props_rev_3"><a id="GUID-509A994F-9354-4A25-B169-7E6A0C5A62C4"></a>
<h5 id="DBSEG-GUID-509A994F-9354-4A25-B169-7E6A0C5A62C4" class="sect5">Writing Records to Disk Across an Oracle RAC Environment</h5>
<div>
<p>You can flush audit records across all Oracle Real Application Cluster (Oracle RAC) instances.</p>
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Run the following procedure to flush audit records on Oracle RAC instances:</p>
<pre dir="ltr">EXEC DBMS_AUDIT_MGMT.FLUSH_UNIFIED_AUDIT_TRAIL(DBMS_AUDIT_MGMT.FLUSH_ALL_INSTANCES);
</pre></li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="DBSEG926"></a>
<div class="props_rev_3"><a id="GUID-F5F69055-025F-4FCF-8A50-3A23ED74AD7D"></a>
<h5 id="DBSEG-GUID-F5F69055-025F-4FCF-8A50-3A23ED74AD7D" class="sect5">Writing Records to Disk in a Multitenant Environment</h5>
<div>
<p>In a multitenant environment, you can write the audit trail records to disk for the current PDB or across all PDBs in a multitenent environment.</p>
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>To write audit trail records to disk, use one of the following procedures:</p>
<ul style="list-style-type: disc;">
<li>
<p>For the current PDB:</p>
<pre dir="ltr">BEGIN  
 DBMS_AUDIT_MGMT.FLUSH_UNIFIED_AUDIT_TRAIL(
  CONTAINER  =&gt; DBMS_AUDIT_MGMT.CONTAINER_CURRENT);
END;
/
</pre></li>
<li>
<p>For all PDBs in the multitenant environment:</p>
<pre dir="ltr">BEGIN  
 DBMS_AUDIT_MGMT.FLUSH_UNIFIED_AUDIT_TRAIL(
  CONTAINER  =&gt; DBMS_AUDIT_MGMT.CONTAINER_ALL);
END;
/
</pre></li>
</ul>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<a id="DBSEG731"></a>
<div class="props_rev_3"><a id="GUID-91B14CCD-E408-4669-82FA-EE833EDBBBA9"></a>
<h3 id="DBSEG-GUID-91B14CCD-E408-4669-82FA-EE833EDBBBA9" class="sect3">Moving Operating System Audit Records into the Unified Audit Trail</h3>
<div>
<p>Audit records can be written to external files in the <code class="codeph">$ORACLE_BASE/audit/$ORACLE_SID</code> directory.</p>
<div class="section">
<p>When the database is not writable (such as during database mounts), if the database is closed, or if it is read-only, then Oracle Database writes the audit records to these external files.</p>
<p>You can load the files into the database by running the <code class="codeph">DBMS_AUDIT_MGMT.LOAD_UNIFIED_AUDIT_FILES</code> procedure. Be aware that if you are moving a large number of operating system audit records to the unified audit trail, performance may be affected.</p>
<p>To move the audit records in these files to the <code class="codeph">AUDSYS</code> schema audit table when the database is writable:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Log into the database instance as a user who has been granted the <code class="codeph">AUDIT_ADMIN</code> role.</span>
<div>
<p>For example:</p>
<pre dir="ltr">CONNECT aud_admin
Enter password: <span class="italic">password</span>
Connected.
</pre>
<p>In a multitenant environment, log into the PDB in which you want to move the audit trail records to the unified audit trail.</p>
<p>For example:</p>
<pre dir="ltr">CONNECT aud_admin@hrpdb
Enter password: <span class="italic">password</span>
Connected.
</pre>
<p>To find the available PDBs, query the <code class="codeph">DBA_PDBS</code> data dictionary view. To check the current PDB, run the <code class="codeph">show con_name</code> command.</p>
</div>
</li>
<li class="stepexpand"><span>Ensure that the database is open and writable.</span>
<div>
<p>For a non-CDB architecture, to find the databases that are open and writable, query the <code class="codeph">V$DATABASE</code> view.</p>
<p>For example:</p>
<pre dir="ltr">SELECT NAME, OPEN_MODE FROM V$DATABASE;

NAME            OPEN_MODE  
--------------- ---------- 
HRPDB           READ WRITE 
</pre>
<p>In a multitenant environment, you can query the <code class="codeph">V$PDBS</code> view to find information about PDBs associated with the current instance.</p>
<p>For example:</p>
<pre dir="ltr">SELECT NAME, OPEN_MODE FROM V$PDBS;

NAME            OPEN_MODE  
--------------- ---------- 
HRPDB           READ WRITE 
</pre></div>
</li>
<li class="stepexpand"><span>Run the <code class="codeph">DBMS_AUDIT_MGMT.LOAD_UNIFIED_AUDIT_FILES</code> procedure.</span>
<div>
<pre dir="ltr">EXEC DBMS_AUDIT_MGMT.LOAD_UNIFIED_AUDIT_FILES;
</pre></div>
</li>
</ol>
<div class="section">
<p>The audit records are loaded into the <code class="codeph">AUDSYS</code> schema audit table immediately, and then deleted from the <code class="codeph">$ORACLE_BASE/audit/$ORACLE_SID</code> directory.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="DBSEG821"></a>
<div class="props_rev_3"><a id="GUID-80D9305C-29F6-4F3B-BDDB-371F619B08D8"></a>
<h3 id="DBSEG-GUID-80D9305C-29F6-4F3B-BDDB-371F619B08D8" class="sect3">Disabling Unified Auditing</h3>
<div>
<p>You can disable unified auditing.</p>
<div class="section">
<ol>
<li>
<p>Disable any unified audit policies that are currently enabled.</p>
<p>This step prevents the database from going into mixed mode auditing after you complete this procedure. See <a href="auditing.htm#GUID-E9DB31BB-E90C-4B22-B29D-F9A44B350F9B" title="Mixed mode auditing enables both traditional (that is, the audit facility from releases earlier than Release 12c) and the new audit facilities (unified auditing).">About Mixed Mode Auditing</a> for more information about mixed mode auditing.</p>
<ol>
<li>
<p>Log into the database instance as a user who has been granted the <code class="codeph">AUDIT_ADMIN</code> role.</p>
</li>
<li>
<p>Query the <code class="codeph">POLICY_NAME</code> and <code class="codeph">ENABLED_OPT</code> columns of the <code class="codeph">AUDIT_UNIFIED_ENABLED_POLICIES</code> data dictionary view to find unified audit policies that are enabled.</p>
</li>
<li>
<p>Run the <code class="codeph">NOAUDIT POLICY</code> statement to disable each enabled policy.</p>
<p>See <a href="audit_config.htm#GUID-1577CCEB-2AFD-417C-9238-9DFF13149766" title="You can use the NOAUDIT POLICY statement to disable a unified audit policy.">Disabling Unified Audit Policies</a> for more information.</p>
</li>
</ol>
</li>
<li>
<p>Connect as user <code class="codeph">SYS</code> with the <code class="codeph">SYSOPER</code> privilege.</p>
<pre dir="ltr">CONNECT sys as sysoper
Enter password: <span class="italic">password</span>
</pre>
<p>In a multitenant environment, this command connects you to the root.</p>
</li>
<li>
<p>Shut down the database.</p>
<p>For example:</p>
<pre dir="ltr">SHUTDOWN IMMEDIATE
</pre>
<p>In a multitenant environment, this command shuts down all PDBs in the CDB.</p>
</li>
<li>
<p>Depending on your platform, do the following:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">UNIX systems:</span> Run the following commands:</p>
<pre dir="ltr">cd $ORACLE_HOME/rdbms/lib
make -f ins_rdbms.mk uniaud_off ioracle
</pre></li>
<li>
<p><span class="bold">Windows systems:</span> Rename the <code class="codeph">%ORACLE_HOME%/bin/orauniaud12.dll</code> file to <code class="codeph">%ORACLE_HOME%/bin/orauniaud12.dll.dbl</code>.</p>
</li>
</ul>
<p>In a multitenant environment, these actions disable unified auditing in all PDBs in the CDB.</p>
</li>
<li>
<p>In SQL*Plus, restart the database.</p>
<pre dir="ltr">STARTUP
</pre>
<p>In a multitenant environment, this command restarts all PDBs in the CDB.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="DBSEG732"></a>
<div class="props_rev_3"><a id="GUID-58CFB1F4-7E76-46A4-8DDD-2546DBD67FBE"></a>
<h2 id="DBSEG-GUID-58CFB1F4-7E76-46A4-8DDD-2546DBD67FBE" class="sect2">Archiving the Audit Trail</h2>
<div>
<p>You can archive the traditional operating system, unified database, and traditional database audit trails.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="audit_admin.htm#GUID-04612F83-EC57-462C-A4F4-7562C4CAD8B5" title="You can create an archive of the traditional operating system audit files after you have upgraded Oracle Database.">Archiving the Traditional Operating System Audit Trail</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-DACD856C-F3B2-40A1-9D48-882BBF438FCB" title="You should periodically archive and then purge the audit trail to prevent it from growing too large.">Archiving the Unified and Traditional Database Audit Trails</a></p>
</li>
</ul>
</div>
<a id="DBSEG734"></a>
<div class="props_rev_3"><a id="GUID-04612F83-EC57-462C-A4F4-7562C4CAD8B5"></a>
<h3 id="DBSEG-GUID-04612F83-EC57-462C-A4F4-7562C4CAD8B5" class="sect3">Archiving the Traditional Operating System Audit Trail</h3>
<div>
<p>You can create an archive of the traditional operating system audit files after you have upgraded Oracle Database.</p>
<div class="section">
<p>To archive the traditional operating system audit trail from an upgraded database, use your platform-specific operating system tools to create an archive of the traditional operating system audit files.</p>
<ul style="list-style-type: disc;">
<li>
<p>Use the following methods to archive the traditional operating system audit files:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Use Oracle Audit Vault and Database Firewall.</span> You install Oracle Audit Vault and Database Firewall separately from Oracle Database.</p>
</li>
<li>
<p><span class="bold">Create tape or disk backups.</span> You can create a compressed file of the audit files, and then store it on tapes or disks. Consult your operating system documentation for more information.</p>
</li>
</ul>
</li>
</ul>
<p>Afterwards, you should purge (delete) the traditional operating system audit records both to free audit trail space and to facilitate audit trail management.</p>
<div class="infoboxnotealso" id="GUID-04612F83-EC57-462C-A4F4-7562C4CAD8B5__GUID-C1163A5F-3462-4E88-9752-454E39B0AD85">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink SIGAD40485" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=SIGAD40485"><span><cite>Oracle Audit Vault and Database Firewall Administrator&#39;s Guide</cite></span></a> for more information about Oracle Audit Vault and Database Firewall</p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-91B14CCD-E408-4669-82FA-EE833EDBBBA9" title="Audit records can be written to external files in the $ORACLE_BASE/audit/$ORACLE_SID directory.">Moving Operating System Audit Records into the Unified Audit Trail</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-9B891A44-3DF4-4B52-98D4-A931DBFAEC1D" title="You can use the DBMS_AUDIT_MGMT PL/SQL package to schedule automatic purge jobs, manually purge audit records, and perform other audit trail operations.">Purging Audit Trail Records</a></p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="DBSEG733"></a>
<div class="props_rev_3"><a id="GUID-DACD856C-F3B2-40A1-9D48-882BBF438FCB"></a>
<h3 id="DBSEG-GUID-DACD856C-F3B2-40A1-9D48-882BBF438FCB" class="sect3">Archiving the Unified and Traditional Database Audit Trails</h3>
<div>
<p>You should periodically archive and then purge the audit trail to prevent it from growing too large.</p>
<div class="section">
<p>Archiving and purging both frees audit trail space and facilitates the purging of the database audit trail.</p>
<p>You can create an archive of the unified and traditional database audit trail by using Oracle Audit Vault and Database Firewall. You install Oracle Audit Vault and Database Firewall separately from Oracle Database.</p>
<p>After you complete the archive, you can purge the database audit trail contents.</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>To archive the unified, traditional standard, and traditional fine-grained audit records, copy the relevant records to a normal database table.</p>
<p>For example:</p>
<pre dir="ltr">INSERT INTO <span class="italic">table</span> SELECT ... FROM UNIFIED_AUDIT_TRAIL ...;
INSERT INTO <span class="italic">table</span> SELECT ... FROM SYS.AUD$ ...;
INSERT INTO <span class="italic">table</span> SELECT ... FROM SYS.FGA_LOG$ ...; 
</pre></li>
</ul>
<div class="infoboxnotealso" id="GUID-DACD856C-F3B2-40A1-9D48-882BBF438FCB__GUID-E98ED452-077F-4CD5-94F6-4B2B9C004D1B">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink SIGAD40485" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=SIGAD40485"><span><cite>Oracle Audit Vault and Database Firewall Administrator&#39;s Guide</cite></span></a> for more information about Oracle Audit Vault and Database Firewall</p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-9B891A44-3DF4-4B52-98D4-A931DBFAEC1D" title="You can use the DBMS_AUDIT_MGMT PL/SQL package to schedule automatic purge jobs, manually purge audit records, and perform other audit trail operations.">Purging Audit Trail Records</a></p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="DBSEG90934"></a>
<div class="props_rev_3"><a id="GUID-9B891A44-3DF4-4B52-98D4-A931DBFAEC1D"></a>
<h2 id="DBSEG-GUID-9B891A44-3DF4-4B52-98D4-A931DBFAEC1D" class="sect2">Purging Audit Trail Records</h2>
<div>
<p>You can use the <code class="codeph">DBMS_AUDIT_MGMT</code> PL/SQL package to schedule automatic purge jobs, manually purge audit records, and perform other audit trail operations.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="audit_admin.htm#GUID-60118D0C-75D7-4FF6-9965-2A23A2584E2A" title="You can use a variety of ways to purge audit trail records.">About Purging Audit Trail Records</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-5761FBDA-91F9-4E0F-82E5-B52F3022324F" title="How you select an audit trail purge method depends on whether you want perform the purge on a regularly scheduled basis or run it at a specified times.">Selecting an Audit Trail Purge Method</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-C1EB1E76-B15B-4450-A4C3-ED525E17CBCA" title="When you schedule an automatic purge job, you need to tune the online and archive redo log sizes, plan a timestamp and archive strategy, optionally set an archive timestamp, and then create and schedule the purge job.">Scheduling an Automatic Purge Job for the Audit Trail</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-B9D2B078-2567-4002-A906-E293DE94549E" title="You can use the DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL procedure to manually purge the audit trail.">Manually Purging the Audit Trail</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-91B17A5D-A702-4C9D-92C4-CF62A4BC4A5A" title="Other kinds of audit trail purge include enabling or disabling the audit trail purge job, setting the default audit trail purge job interval, deleting an audit trail purge job, and clearing an archive timestamp setting.">Other Audit Trail Purge Operations</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-532781DA-B568-4F37-84B7-D051D564D355" title="You can create a customized archive procedure to directly call a unified audit trail purge operation.">Example: Directly Calling a Unified Audit Trail Purge Operation</a></p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-9B891A44-3DF4-4B52-98D4-A931DBFAEC1D__GUID-61797988-698E-4485-A9C5-CA579D03B112">
<p class="notep1">See Also:</p>
<p><a href="audit_admin.htm#GUID-2A5CFDFC-320B-41D0-86AB-B524992E02A8" title="Auditing is enabled by default, but you can control when audit records are written to disk.">Managing the Unified Audit Trail</a></p>
</div>
</div>
<a id="DBSEG462"></a>
<div class="props_rev_3"><a id="GUID-60118D0C-75D7-4FF6-9965-2A23A2584E2A"></a>
<h3 id="DBSEG-GUID-60118D0C-75D7-4FF6-9965-2A23A2584E2A" class="sect3">About Purging Audit Trail Records</h3>
<div>
<p>You can use a variety of ways to purge audit trail records.</p>
<p>You should periodically archive and then delete (purge) audit trail records. You can purge a subset of audit trail records or create a purge job that performs at a specified time interval. Oracle Database either purges the audit trail records that were created before the archive timestamp, or it purges all audit trail records. You can purge audit trail records in both read-write and read-only databases.</p>
<p>The purge process takes into account not just the unified audit trail, but audit trails from earlier releases of Oracle Database. For example, if you have migrated an upgraded database that still has operating system or XML audit records, then you can use the procedures in this section to archive and purge them.</p>
<p>To perform the audit trail purge tasks, in most cases, you use the <code class="codeph">DBMS_AUDIT_MGMT</code> PL/SQL package. You must have the <code class="codeph">AUDIT_ADMIN</code> role before you can use the <code class="codeph">DBMS_AUDIT_MGMT</code> package. Oracle Database mandatorily audits all executions of the <code class="codeph">DBMS_AUDIT_MGMT</code> PL/SQL package procedures.</p>
<p>If you have Oracle Audit Vault and Database Firewall installed, the audit trail purge process differs from the procedures described in this manual. For example, Oracle Audit Vault archives the audit trail for you.</p>
<div class="infobox-note" id="GUID-60118D0C-75D7-4FF6-9965-2A23A2584E2A__GUID-641347DF-5904-4300-A25B-B7EA16B785CC">
<p class="notep1">Note:</p>
<p>Oracle Database audits all deletions from the audit trail, without exception.</p>
</div>
<div class="infoboxnotealso" id="GUID-60118D0C-75D7-4FF6-9965-2A23A2584E2A__GUID-A838F213-0F34-481F-8471-4A4043D265DA">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink SIGAD40485" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E50529-01&amp;id=SIGAD40485"><span><cite>Oracle Audit Vault and Database Firewall Administrator&#39;s Guide</cite></span></a> for information about Oracle Audit Vault and Database Firewall</p>
</li>
<li>
<p><a class="olink ARPLS241" target="_blank" href="../ARPLS/d_audit_mgmt.htm#ARPLS241"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for more information about the <code class="codeph">DBMS_AUDIT_MGMT</code> PL/SQL package</p>
</li>
<li>
<p><a class="olink REFRN" target="_blank" href="../REFRN/toc.htm"><span><cite>Oracle Database Reference</cite></span></a> for detailed information about the <code class="codeph">DBA_AUDIT_MGMT</code>-related views</p>
</li>
</ul>
</div>
</div>
</div>
<a id="DBSEG463"></a>
<div class="props_rev_3"><a id="GUID-5761FBDA-91F9-4E0F-82E5-B52F3022324F"></a>
<h3 id="DBSEG-GUID-5761FBDA-91F9-4E0F-82E5-B52F3022324F" class="sect3">Selecting an Audit Trail Purge Method</h3>
<div>
<p>How you select an audit trail purge method depends on whether you want perform the purge on a regularly scheduled basis or run it at a specified times.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="audit_admin.htm#GUID-1FB29F4F-F90A-4B7A-A77D-8347E3F97A1A" title="You can purge all audit records, or audit records that were created before a specified timestamp, on a regularly scheduled basis.">Purging the Audit Trail on a Regularly Scheduled Basis</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-BCA62445-B081-4DD5-BBC4-792CC0591776" title="You can manually purge the audit records right away in a one-time operation, rather than creating a purge schedule.">Manually Purging the Audit Trail at a Specific Time</a></p>
</li>
</ul>
</div>
<a id="DBSEG1121"></a>
<div class="props_rev_3"><a id="GUID-1FB29F4F-F90A-4B7A-A77D-8347E3F97A1A"></a>
<h4 id="DBSEG-GUID-1FB29F4F-F90A-4B7A-A77D-8347E3F97A1A" class="sect4">Purging the Audit Trail on a Regularly Scheduled Basis</h4>
<div>
<p>You can purge all audit records, or audit records that were created before a specified timestamp, on a regularly scheduled basis.</p>
<div class="section">For example, you can schedule the purge for every Saturday at 2 a.m.</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>If necessary, tune online and archive redo log sizes to accommodate the additional records generated during the audit table purge process.</span></li>
<li class="stepexpand"><span>Plan a timestamp and archive strategy.</span></li>
<li class="stepexpand"><span>Optionally, set an archive timestamp for the audit records.</span></li>
<li class="stepexpand"><span>Create and schedule the purge job.</span>
<div>
<p>See <a href="audit_admin.htm#GUID-C1EB1E76-B15B-4450-A4C3-ED525E17CBCA" title="When you schedule an automatic purge job, you need to tune the online and archive redo log sizes, plan a timestamp and archive strategy, optionally set an archive timestamp, and then create and schedule the purge job.">Scheduling an Automatic Purge Job for the Audit Trail</a> for more information.</p>
</div>
</li>
</ol>
</div>
</div>
<a id="DBSEG1122"></a>
<div class="props_rev_3"><a id="GUID-BCA62445-B081-4DD5-BBC4-792CC0591776"></a>
<h4 id="DBSEG-GUID-BCA62445-B081-4DD5-BBC4-792CC0591776" class="sect4">Manually Purging the Audit Trail at a Specific Time</h4>
<div>
<p>You can manually purge the audit records right away in a one-time operation, rather than creating a purge schedule.</p>
<ol>
<li class="stepexpand"><span>If necessary, tune online and archive redo log sizes to accommodate the additional records generated during the audit table purge process.</span></li>
<li class="stepexpand"><span>Plan a timestamp and archive strategy.</span></li>
<li class="stepexpand"><span>Optionally, set an archive timestamp for the audit records.</span></li>
<li class="stepexpand"><span>Run the purge operation.</span>
<div>
<p>See <a href="audit_admin.htm#GUID-B9D2B078-2567-4002-A906-E293DE94549E" title="You can use the DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL procedure to manually purge the audit trail.">Manually Purging the Audit Trail</a> for more information.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<a id="DBSEG465"></a>
<div class="props_rev_3"><a id="GUID-C1EB1E76-B15B-4450-A4C3-ED525E17CBCA"></a>
<h3 id="DBSEG-GUID-C1EB1E76-B15B-4450-A4C3-ED525E17CBCA" class="sect3">Scheduling an Automatic Purge Job for the Audit Trail</h3>
<div>
<p>When you schedule an automatic purge job, you need to tune the online and archive redo log sizes, plan a timestamp and archive strategy, optionally set an archive timestamp, and then create and schedule the purge job.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="audit_admin.htm#GUID-90647C68-F671-4AB0-978F-81D7AB0E63F9" title="You can purge the entire audit trail, or only a portion of the audit trail that was created before a timestamp.">About Scheduling an Automatic Purge Job</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-2F1AAC07-30A4-4B3A-B9E2-ADEC02E70533" title="The purge process may generate additional redo logs.">Step 1: If Necessary, Tune Online and Archive Redo Log Sizes</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-F5B4C780-584A-4555-9608-1F5F9D62C7CA" title="You must record the timestamp of the audit records before you can archive them.">Step 2: Plan a Timestamp and Archive Strategy</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-1C9053BB-30B8-48DB-9062-44DD42A75B4E" title="If you want to delete all of the audit trail, then you can bypass this step.">Step 3: Optionally, Set an Archive Timestamp for Audit Records</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-07ECB9A9-369A-4668-A0BC-D29CDB367ABF" title="You can use the DBMS_AUDIT_MGMT PL/SQL package to create and schedule the purge job.">Step 4: Create and Schedule the Purge Job</a></p>
</li>
</ul>
</div>
<a id="DBSEG735"></a>
<div class="props_rev_3"><a id="GUID-90647C68-F671-4AB0-978F-81D7AB0E63F9"></a>
<h4 id="DBSEG-GUID-90647C68-F671-4AB0-978F-81D7AB0E63F9" class="sect4">About Scheduling an Automatic Purge Job</h4>
<div>
<p>You can purge the entire audit trail, or only a portion of the audit trail that was created before a timestamp.</p>
<p>The individual audit records created before the timestamp can be purged.</p>
<p>Be aware that purging the audit trail, particularly a large one, can take a while to complete. Consider scheduling the purge job so that it runs during a time when the database is not busy.</p>
<p>You can create multiple purge jobs for different audit trail types, so long as they do not conflict. For example, you can create a purge job for the standard audit trail table and then the fine-grained audit trail table. However, you cannot then create a purge job for both or all types, that is, by using the <code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_DB_STD</code> or <code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_ALL</code> property. In addition, be aware that the jobs created by the <code class="codeph">DBMS_SCHEDULER</code> PL/SQL package do not execute on a read-only database. An automatic purge job created with <code class="codeph">DBMS_AUDIT_MGMT</code> uses the <code class="codeph">DBMS_SCHEDULER</code> package to schedule the tasks. Therefore, these jobs cannot run on a database or PDB that is open in read-only mode.</p>
</div>
</div>
<a id="DBSEG466"></a>
<div class="props_rev_3"><a id="GUID-2F1AAC07-30A4-4B3A-B9E2-ADEC02E70533"></a>
<h4 id="DBSEG-GUID-2F1AAC07-30A4-4B3A-B9E2-ADEC02E70533" class="sect4">Step 1: If Necessary, Tune Online and Archive Redo Log Sizes</h4>
<div>
<p>The purge process may generate additional redo logs.</p>
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>If necessary, tune online and archive redo log sizes to accommodate the additional records generated during the audit table purge process.</p>
</li>
</ul>
<p>In a unified auditing environment, the purge process does not generate as many redo logs as in a mixed mode auditing environment, so if you have migrated to unified auditing, then you may want to bypass this step.</p>
<div class="infoboxnotealso" id="GUID-2F1AAC07-30A4-4B3A-B9E2-ADEC02E70533__GUID-AAEB6566-1011-4F23-8BC0-B3CF224D4B99">
<p class="notep1">See Also:</p>
<p><a class="olink ADMIN007" target="_blank" href="../ADMIN/onlineredo.htm#ADMIN007"><span><cite>Oracle Database Administrator&rsquo;s Guide</cite></span></a> for more information about tuning log files</p>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="DBSEG467"></a>
<div class="props_rev_3"><a id="GUID-F5B4C780-584A-4555-9608-1F5F9D62C7CA"></a>
<h4 id="DBSEG-GUID-F5B4C780-584A-4555-9608-1F5F9D62C7CA" class="sect4">Step 2: Plan a Timestamp and Archive Strategy</h4>
<div>
<p>You must record the timestamp of the audit records before you can archive them.</p>
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>To find the timestamp date, query the <code class="codeph">DBA_AUDIT_MGMT_LAST_ARCH_TS</code> data dictionary view.</p>
</li>
</ul>
<p>Later on, when the purge takes place, Oracle Database purges only the audit trail records that were created before the date of this timestamp. See <a href="audit_admin.htm#GUID-1C9053BB-30B8-48DB-9062-44DD42A75B4E" title="If you want to delete all of the audit trail, then you can bypass this step.">Step 3: Optionally, Set an Archive Timestamp for Audit Records</a></p>
<p>After you have timestamped the records, you are ready to archive them. See <a href="audit_admin.htm#GUID-58CFB1F4-7E76-46A4-8DDD-2546DBD67FBE" title="You can archive the traditional operating system, unified database, and traditional database audit trails.">Archiving the Audit Trail</a> for more information.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="DBSEG469"></a>
<div class="props_rev_3"><a id="GUID-1C9053BB-30B8-48DB-9062-44DD42A75B4E"></a>
<h4 id="DBSEG-GUID-1C9053BB-30B8-48DB-9062-44DD42A75B4E" class="sect4">Step 3: Optionally, Set an Archive Timestamp for Audit Records</h4>
<div>
<p>If you want to delete all of the audit trail, then you can bypass this step.</p>
<div class="section">
<p>You can set a timestamp for when the last audit record was archived. Setting an archive timestamp provides the point of cleanup to the purge infrastructure. If you are setting a timestamp for a read-only database, then you can use the <code class="codeph">DBMS_AUDIT.MGMT.GET_LAST_ARCHIVE_TIMESTAMP</code> function to find the last archive timestamp that was configured for the instance on which it was run. For a read-write database, you can query the <code class="codeph">DBA_AUDIT_MGMT_LAST_ARCH_TS</code> data dictionary view.</p>
<p>To find the last archive timestamps for the unified audit trail, you can query the <code class="codeph">DBA_AUDIT_MGMT_LAST_ARCH_TS</code> data dictionary view. After you set the timestamp, all audit records in the audit trail that indicate a time earlier than that timestamp are purged when you run the <code class="codeph">DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL</code> PL/SQL procedure. If you want to clear the archive timestamp setting, see <a href="audit_admin.htm#GUID-4AE3F98A-BB9E-437B-BCEB-4DA626F2302E" title="The DBMS_AUDIT_MGMT.CLEAR_LAST_ARCHIVE_TIMESTAMP procedure can clear the archive timestamp setting.">Clearing the Archive Timestamp Setting</a>.</p>
<p>If you are using Oracle Database Real Application Clusters, then use Network Time Protocol (NTP) to synchronize the time on each computer where you have installed an Oracle Database instance. For example, suppose you set the time for one Oracle RAC instance node at 11:00:00 a.m. and then set the next Oracle RAC instance node at 11:00:05. As a result, the two nodes have inconsistent times. You can use Network Time Protocol (NTP) to synchronize the times for these Oracle RAC instance nodes.</p>
<p>To set the timestamp for the purge job:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Log into the database instance as a user who has been granted the <code class="codeph">AUDIT_ADMIN</code> role.</span>
<div>
<p>In a multitenant environment, log into either the root or the PDB in which you want to schedule the purge job. In most cases, you may want to schedule the purge job on individual PDBs.</p>
<p>For example, to log into a PDB called <code class="codeph">hrpdb</code>:</p>
<pre dir="ltr">CONNECT aud_admin@hrpdb
Enter password: <span class="italic">password</span>
Connected.
</pre></div>
</li>
<li class="stepexpand"><span>Run the <code class="codeph">DBMS_AUDIT_MGMT.SET_LAST_ARCHIVE_TIMESTAMP</code> PL/SQL procedure to set the timestamp.</span>
<div>
<p>For example:</p>
<pre dir="ltr">BEGIN
  DBMS_AUDIT_MGMT.SET_LAST_ARCHIVE_TIMESTAMP(
   AUDIT_TRAIL_TYPE     =&gt;  DBMS_AUDIT_MGMT.AUDIT_TRAIL_UNIFIED,
   LAST_ARCHIVE_TIME    =&gt;  &#39;12-OCT-2013 06:30:00.00&#39;,
   RAC_INSTANCE_NUMBER  =&gt;  1,
   CONTAINER            =&gt; DBMS_AUDIT_MGMT.CONTAINER_CURRENT);
END;
/
</pre>
<p>In this example:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">AUDIT_TRAIL_TYPE</code> specifies the audit trail type. <code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_UNIFIED</code> sets it for the unified audit trail.</p>
<p>For upgraded databases that still have traditional audit data from previous releases:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_AUD_STD</code> is used for the traditional standard audit trail table, <code class="codeph">AUD$</code>. (This setting does not apply to read-only databases.)</p>
</li>
<li>
<p><code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_FGA_STD</code> is used for the traditional fine-grained audit trail table, <code class="codeph">FGA_LOG$</code>. (This setting does not apply to read-only databases.)</p>
</li>
<li>
<p><code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_OS</code> is used for the traditional operating system audit trail files with the <code class="codeph">.aud</code> extension. (This setting does not apply to Windows Event Log entries.)</p>
</li>
<li>
<p><code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_XML</code> is used for the XML traditional operating system audit trail files.</p>
</li>
</ul>
</li>
<li>
<p><code class="codeph">LAST_ARCHIVE_TIME</code> specifies the timestamp in <code class="codeph">YYYY-MM-DD HH:MI:SS.FF</code> UTC (Coordinated Universal Time) format for <code class="codeph">AUDIT_TRAIL_UNIFIED</code>, <code class="codeph">AUDIT_TRAIL_AUD_STD</code>, and <code class="codeph">AUDIT_TRAIL_FGA_STD</code>, and in the Local Time Zone for <code class="codeph">AUDIT_TRAIL_OS</code> and <code class="codeph">AUDIT_TRAIL_XML</code>.</p>
</li>
<li>
<p><code class="codeph">RAC_INSTANCE_NUMBER</code> specifies the instance number for an Oracle RAC installation. This setting is not relevant for single instance databases. If you specified the <code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_AUD_STD</code> or <code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_FGA_STD</code> audit trail types, then you can omit the <code class="codeph">RAC_INSTANCE_NUMBER</code> argument. This is because there is only one <code class="codeph">AUD$</code> or <code class="codeph">FGA_LOG$</code> table, even for an Oracle RAC installation. The default is <code class="codeph">NULL</code>. You can find the instance number for the current instance by issuing the <code class="codeph">SHOW PARAMETER INSTANCE_NUMBER</code> command in SQL*Plus.</p>
</li>
<li>
<p><code class="codeph">CONTAINER</code> applies the timestamp to a multitenant environment. <code class="codeph">DBMS_AUDIT_MGMT.CONTAINER_CURRENT</code> specifies the current PDB; <code class="codeph">DBMS_AUDIT_MGMT.CONTAINER_ALL</code> applies to all PDBs in the multitenant environment.</p>
<p>Note that you can set <code class="codeph">CONTAINER</code> to <code class="codeph">DBMS_MGMT.CONTAINER_ALL</code> only from the root, and <code class="codeph">DBMS_MGMT.CONTAINER_CURRENT</code> only from a PDB.</p>
</li>
</ul>
<p>Typically, after you set the timestamp, you can use the <code class="codeph">DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL</code> PL/SQL procedure to remove the audit records that were created before the timestamp date.</p>
</div>
</li>
</ol>
</div>
</div>
<a id="DBSEG470"></a>
<div class="props_rev_3"><a id="GUID-07ECB9A9-369A-4668-A0BC-D29CDB367ABF"></a>
<h4 id="DBSEG-GUID-07ECB9A9-369A-4668-A0BC-D29CDB367ABF" class="sect4">Step 4: Create and Schedule the Purge Job</h4>
<div>
<p>You can use the <code class="codeph">DBMS_AUDIT_MGMT</code> PL/SQL package to create and schedule the purge job.</p>
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Create and schedule the purge job by running the <code class="codeph">DBMS_AUDIT_MGMT.CREATE_PURGE_JOB</code> PL/SQL procedure.</p>
<p>For example:</p>
<pre dir="ltr">CONNECT aud_admin@hrpdb
Enter password: <span class="italic">password</span>
Connected.

BEGIN
  DBMS_AUDIT_MGMT.CREATE_PURGE_JOB (
   AUDIT_TRAIL_TYPE            =&gt; DBMS_AUDIT_MGMT.AUDIT_TRAIL_UNIFIED, 
   AUDIT_TRAIL_PURGE_INTERVAL  =&gt; 12,
   AUDIT_TRAIL_PURGE_NAME      =&gt; &#39;Audit_Trail_PJ&#39;,
   USE_LAST_ARCH_TIMESTAMP     =&gt; TRUE,
   CONTAINER                   =&gt; DBMS_AUDIT_MGMT.CONTAINER_CURRENT);
END;
/
</pre></li>
</ul>
<p>In this example:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">AUDIT_TRAIL_TYPE</code>: Specifies the audit trail type. <code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_UNIFIED</code> sets it for the unified audit trail.</p>
<p>For upgraded databases that still have audit data from previous releases:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_AUD_STD</code> is used for the standard audit trail table, <code class="codeph">AUD$</code>. (This setting does not apply to read-only databases.)</p>
</li>
<li>
<p><code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_FGA_STD</code> is used for the fine-grained audit trail table, <code class="codeph">FGA_LOG$</code>. (This setting does not apply to read-only databases.)</p>
</li>
<li>
<p><code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_DB_STD</code> is used for both standard and fine-grained audit trail tables. (This setting does not apply to read-only databases.)</p>
</li>
<li>
<p><code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_OS</code> is used for the operating system audit trail files with the <code class="codeph">.aud</code> extension. (This setting does not apply to Windows Event Log entries.)</p>
</li>
<li>
<p><code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_XML</code> is used for the XML operating system audit trail files.</p>
</li>
<li>
<p><code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_FILES</code> is used for both operating system and XML audit trail files.</p>
</li>
<li>
<p><code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_ALL</code> is used for all audit trail records, that is, both database audit trail and operating system audit trail types. (This setting does not apply to read-only databases.)</p>
</li>
</ul>
</li>
<li>
<p><code class="codeph">AUDIT_TRAIL_PURGE_INTERVAL</code> specifies the hourly interval for this purge job to run. The timing begins when you run the <code class="codeph">DBMS_AUDIT_MGMT.CREATE_PURGE_JOB</code> procedure, in this case, 12 hours after you run this procedure. Later on, if you want to update this value, run the <code class="codeph">DBMS_AUDIT_MGMT.SET_PURGE_JOB_INTERVAL</code> procedure.</p>
</li>
<li>
<p><code class="codeph">USE_LAST_ARCH_TIMESTAMP</code> accepts either of the following settings:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">TRUE</code> deletes audit records created before the last archive timestamp. To check the last recorded timestamp, query the <code class="codeph">LAST_ARCHIVE_TS</code> column of the <code class="codeph">DBA_AUDIT_MGMT_LAST_ARCH_TS</code> data dictionary view for read-write databases and the <code class="codeph">DBMS_AUDIT_MGMT.GET_LAST_ARCHIVE_TIMESTAMP</code> function for read-only databases. The default value is <code class="codeph">TRUE</code>. Oracle recommends that you set <code class="codeph">USE_LAST_ARCH_TIMESTAMP</code> to <code class="codeph">TRUE</code>.</p>
</li>
<li>
<p><code class="codeph">FALSE</code> deletes all audit records without considering last archive timestamp. Be careful about using this setting, in case you inadvertently delete audit records that should have been deleted.</p>
</li>
</ul>
</li>
<li>
<p><code class="codeph">CONTAINER</code> is used for a multitenant environment to define where to create the purge job. If you set <code class="codeph">CONTAINER</code> to <code class="codeph">DBMS_AUDIT_MGMT.CONTAINER_CURRENT</code>, then it is available, visible, and managed only from the current PDB. The <code class="codeph">DBMS_AUDIT_MGMT.CONTAINER_ALL</code> setting creates the job in the root. This defines the job as a global job, which runs according to the defined job schedule. When the job is invoked, it cleans up audit trails in all the PDBs in the multitenant environment. If you create the job in the root, then it is visible only in the root. Hence, you can enable, disable, and drop it from the root only.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="DBSEG472"></a>
<div class="props_rev_3"><a id="GUID-B9D2B078-2567-4002-A906-E293DE94549E"></a>
<h3 id="DBSEG-GUID-B9D2B078-2567-4002-A906-E293DE94549E" class="sect3">Manually Purging the Audit Trail</h3>
<div>
<p>You can use the <code class="codeph">DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL</code> procedure to manually purge the audit trail.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="audit_admin.htm#GUID-2663202E-F69F-4635-811A-5217F6C66BF0" title="You can manually purge the audit trail right away, without scheduling a purge job.">About Manually Purging the Audit Trail</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-7D2E55CE-2820-47E3-A989-5F7AAB19CD76" title="After you complete preparatory steps, you can use the DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL procedure to manually purge the audit trail.">Using DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL to Manually Purge the Audit Trail</a></p>
</li>
</ul>
</div>
<a id="DBSEG885"></a>
<div class="props_rev_3"><a id="GUID-2663202E-F69F-4635-811A-5217F6C66BF0"></a>
<h4 id="DBSEG-GUID-2663202E-F69F-4635-811A-5217F6C66BF0" class="sect4">About Manually Purging the Audit Trail</h4>
<div>
<p>You can manually purge the audit trail right away, without scheduling a purge job.</p>
<p>Similar to a purge job, you can purge audit trail records that were created before an archive timestamp date or all the records in the audit trail. Only the current audit directory is cleaned up when you run this procedure.</p>
<p>For upgraded databases that may still have audit trails from earlier releases, note the following about the <code class="codeph">DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL</code> PL/SQL procedure:</p>
<ul style="list-style-type: disc;">
<li>
<p>On Microsoft Windows, because the <code class="codeph">DBMS_AUDIT_MGMT</code> package does not support cleanup of Windows Event Viewer, setting the <code class="codeph">AUDIT_TRAIL_TYPE</code> property to <code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_OS</code> has no effect. This is because operating system audit records on Windows are written to Windows Event Viewer. The <code class="codeph">DBMS_AUDIT_MGMT</code> package does not support this type of cleanup operation.</p>
</li>
<li>
<p>On UNIX platforms, if you had set the <code class="codeph">AUDIT_SYSLOG_LEVEL</code> initialization parameter, then Oracle Database writes the operating system log files to syslog files. (Be aware that when you configure the use of syslog files, the messages are sent to the syslog daemon process. The syslog daemon process does not return an acknowledgement to Oracle Database indicating a committed write to the syslog files.) If you set the <code class="codeph">AUDIT_TRAIL_TYPE</code> property to <code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_OS</code>, then the procedure only removes <code class="codeph">.aud</code> files under audit directory (This directory is specified by the <code class="codeph">AUDIT_FILE_DEST</code> initialization parameter).</p>
</li>
</ul>
</div>
</div>
<a id="DBSEG886"></a>
<div class="props_rev_3"><a id="GUID-7D2E55CE-2820-47E3-A989-5F7AAB19CD76"></a>
<h4 id="DBSEG-GUID-7D2E55CE-2820-47E3-A989-5F7AAB19CD76" class="sect4">Using DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL to Manually Purge the Audit Trail</h4>
<div>
<p>After you complete preparatory steps, you can use the <code class="codeph">DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL</code> procedure to manually purge the audit trail.</p>
<ol>
<li class="stepexpand"><span>Follow these steps under <a href="audit_admin.htm#GUID-C1EB1E76-B15B-4450-A4C3-ED525E17CBCA" title="When you schedule an automatic purge job, you need to tune the online and archive redo log sizes, plan a timestamp and archive strategy, optionally set an archive timestamp, and then create and schedule the purge job.">Scheduling an Automatic Purge Job for the Audit Trail</a>:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p><a href="audit_admin.htm#GUID-2F1AAC07-30A4-4B3A-B9E2-ADEC02E70533" title="The purge process may generate additional redo logs.">Step 1: If Necessary, Tune Online and Archive Redo Log Sizes</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-F5B4C780-584A-4555-9608-1F5F9D62C7CA" title="You must record the timestamp of the audit records before you can archive them.">Step 2: Plan a Timestamp and Archive Strategy</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-1C9053BB-30B8-48DB-9062-44DD42A75B4E" title="If you want to delete all of the audit trail, then you can bypass this step.">Step 3: Optionally, Set an Archive Timestamp for Audit Records</a></p>
</li>
</ul>
</div>
</li>
<li class="stepexpand"><span>If you are using a multitenant environment, then connect to the database in which you created the purge job.</span>
<div>
<p>If you created the purge job in the root, then you must log into the root. If you created the purge job in a specific PDB, then log into that PDB.</p>
<p>For example:</p>
<pre dir="ltr">CONNECT aud_admin@hrpdb
Enter password: <span class="italic">password</span>
Connected.
</pre></div>
</li>
<li class="stepexpand"><span>Purge the audit trail records by running the <code class="codeph">DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL</code> PL/SQL procedure.</span>
<div>
<p>For example:</p>
<pre dir="ltr">BEGIN
  DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL(
   AUDIT_TRAIL_TYPE           =&gt;  DBMS_AUDIT_MGMT.AUDIT_TRAIL_UNIFIED,
   USE_LAST_ARCH_TIMESTAMP    =&gt;  TRUE,
   CONTAINER                  =&gt;  DBMS_AUDIT_MGMT.CONTAINER_CURRENT );
END;
/
</pre>
<p>In this example:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">AUDIT_TRAIL_TYPE</code>: Specifies the audit trail type. <code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_UNIFIED</code> sets it for the unified audit trail.</p>
<p>For upgraded databases that still have audit data from previous releases:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_AUD_STD</code>: Standard audit trail table, <code class="codeph">AUD$</code>. (This setting does not apply to read-only databases.)</p>
</li>
<li>
<p><code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_FGA_STD</code>: Fine-grained audit trail table, <code class="codeph">FGA_LOG$</code>. (This setting does not apply to read-only databases.)</p>
</li>
<li>
<p><code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_DB_STD</code>: Both standard and fine-grained audit trail tables. (This setting does not apply to read-only databases)</p>
</li>
<li>
<p><code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_OS</code>: Operating system audit trail files with the <code class="codeph">.aud</code> extension. (This setting does not apply to Windows Event Log entries.)</p>
</li>
<li>
<p><code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_XML</code>: XML Operating system audit trail files.</p>
</li>
<li>
<p><code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_FILES</code>: Both operating system and XML audit trail files.</p>
</li>
<li>
<p><code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_ALL</code>: All audit trail records, that is, both database audit trail and operating system audit trail types. (This setting does not apply to read-only databases.)</p>
</li>
</ul>
</li>
<li>
<p><code class="codeph">USE_LAST_ARCH_TIMESTAMP</code>: Enter either of the following settings:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">TRUE</code>: Deletes audit records created before the last archive timestamp. To set the archive timestamp, see <a href="audit_admin.htm#GUID-1C9053BB-30B8-48DB-9062-44DD42A75B4E" title="If you want to delete all of the audit trail, then you can bypass this step.">Step 3: Optionally, Set an Archive Timestamp for Audit Records</a>. The default (and recommended) value is <code class="codeph">TRUE</code>. Oracle recommends that you set <code class="codeph">USE_LAST_ARCH_TIMESTAMP</code> to <code class="codeph">TRUE</code>.</p>
</li>
<li>
<p><code class="codeph">FALSE</code>: Deletes all audit records without considering last archive timestamp. Be careful about using this setting, in case you inadvertently delete audit records that should have been deleted.</p>
</li>
</ul>
</li>
<li>
<p><code class="codeph">CONTAINER</code>: Applies the cleansing to a multitenant environment. <code class="codeph">DBMS_AUDIT_MGMT.CONTAINER_CURRENT</code> specifies the local PDB; <code class="codeph">DBMS_AUDIT_MGMT.CONTAINER_ALL</code> applies to all databases.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<a id="DBSEG474"></a>
<div class="props_rev_3"><a id="GUID-91B17A5D-A702-4C9D-92C4-CF62A4BC4A5A"></a>
<h3 id="DBSEG-GUID-91B17A5D-A702-4C9D-92C4-CF62A4BC4A5A" class="sect3">Other Audit Trail Purge Operations</h3>
<div>
<p>Other kinds of audit trail purge include enabling or disabling the audit trail purge job, setting the default audit trail purge job interval, deleting an audit trail purge job, and clearing an archive timestamp setting.</p>
<p>Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="audit_admin.htm#GUID-34AE7B90-11F2-42FD-9D80-8E411AA4406A" title="The DBMS_AUDIT_MGMT.SET_PURGE_JOB_STATUS procedure enables or disables an audit trail purge job.">Enabling or Disabling an Audit Trail Purge Job</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-2D0E56B0-A17E-441A-8F40-321C0E594D51" title="You can set a default purge operation interval, in hours, that must pass before the next purge job operation takes place.">Setting the Default Audit Trail Purge Job Interval for a Specified Purge Job</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-B5DD2078-5EFD-4979-BE22-643D4EC028EB" title="You can delete existing audit trail purge jobs.">Deleting an Audit Trail Purge Job</a></p>
</li>
<li>
<p><a href="audit_admin.htm#GUID-4AE3F98A-BB9E-437B-BCEB-4DA626F2302E" title="The DBMS_AUDIT_MGMT.CLEAR_LAST_ARCHIVE_TIMESTAMP procedure can clear the archive timestamp setting.">Clearing the Archive Timestamp Setting</a></p>
</li>
</ul>
</div>
<a id="DBSEG478"></a>
<div class="props_rev_3"><a id="GUID-34AE7B90-11F2-42FD-9D80-8E411AA4406A"></a>
<h4 id="DBSEG-GUID-34AE7B90-11F2-42FD-9D80-8E411AA4406A" class="sect4">Enabling or Disabling an Audit Trail Purge Job</h4>
<div>
<p>The <code class="codeph">DBMS_AUDIT_MGMT.SET_PURGE_JOB_STATUS</code> procedure enables or disables an audit trail purge job.</p>
<div class="section">
<p>In a multitenant environment, where you run the <code class="codeph">DBMS_AUDIT_MGMT.SET_PURGE_JOB_STATUS</code> procedure depends on the location of the purge job, which is determined by the <code class="codeph">CONTAINER</code> parameter of the <code class="codeph">DBMS_MGMT.CREATE_PURGE_JOB</code> procedure. If you had set <code class="codeph">CONTAINER</code> to <code class="codeph">CONTAINER_ALL</code> (to create the purge job in the root), then you must run the <code class="codeph">DBMS_AUDIT_MGMT.SET_PURGE_JOB_STATUS</code> procedure from the root. If you had set <code class="codeph">CONTAINER</code> to <code class="codeph">CONTAINER_CURRENT</code>, then you must run the <code class="codeph">DBMS_AUDIT_MGMT.SET_PURGE_JOB_STATUS</code> procedure from the PDB in which it was created.</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>To enable or disable an audit trail purge job, use the <code class="codeph">DBMS_AUDIT_MGMT.SET_PURGE_JOB_STATUS</code> PL/SQL procedure.</p>
<p>For example, assuming that you had created the purge job in a the <code class="codeph">hrpdb</code> PDB:</p>
<pre dir="ltr">CONNECT aud_admin@hrpdb
Enter password: <span class="italic">password</span>
Connected.

BEGIN
 DBMS_AUDIT_MGMT.SET_PURGE_JOB_STATUS(
  AUDIT_TRAIL_PURGE_NAME      =&gt; &#39;Audit_Trail_PJ&#39;,
  AUDIT_TRAIL_STATUS_VALUE    =&gt; DBMS_AUDIT_MGMT.PURGE_JOB_ENABLE);
END;
/
</pre></li>
</ul>
<p>In this example:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">AUDIT_TRAIL_PURGE_NAME</code> specifies a purge job called <code class="codeph">Audit_Trail_PJ</code>. To find existing purge jobs, query the <code class="codeph">JOB_NAME</code> and <code class="codeph">JOB_STATUS</code> columns of the <code class="codeph">DBA_AUDIT_MGMT_CLEANUP_JOBS</code> data dictionary view.</p>
</li>
<li>
<p><code class="codeph">AUDIT_TRAIL_STATUS_VALUE</code> accepts either of the following properties:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">DBMS_AUDIT_MGMT.PURGE_JOB_ENABLE</code> enables the specified purge job.</p>
</li>
<li>
<p><code class="codeph">DBMS_AUDIT_MGMT.PURGE_JOB_DISABLE</code> disables the specified purge job.</p>
</li>
</ul>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="DBSEG479"></a>
<div class="props_rev_3"><a id="GUID-2D0E56B0-A17E-441A-8F40-321C0E594D51"></a>
<h4 id="DBSEG-GUID-2D0E56B0-A17E-441A-8F40-321C0E594D51" class="sect4">Setting the Default Audit Trail Purge Job Interval for a Specified Purge Job</h4>
<div>
<p>You can set a default purge operation interval, in hours, that must pass before the next purge job operation takes place.</p>
<div class="section">The interval setting that is used in the <code class="codeph">DBMS_AUDIT_MGMT.CREATE_PURGE_JOB</code> procedure takes precedence over this setting.</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>To set the default audit trail purge job interval for a specific purge job, run the <code class="codeph">DBMS_AUDIT_MGMT.SET_PURGE_JOB_INTERVAL</code> procedure.</p>
<p>For example, assuming that you had created the purge job in the <code class="codeph">hrpdb</code> PDB:</p>
<pre dir="ltr">CONNECT aud_admin@hrpdb
Enter password: <span class="italic">password</span>
Connected.

BEGIN
 DBMS_AUDIT_MGMT.SET_PURGE_JOB_INTERVAL(
  AUDIT_TRAIL_PURGE_NAME       =&gt; &#39;Audit_Trail_PJ&#39;,
  AUDIT_TRAIL_INTERVAL_VALUE   =&gt; 24);
END;
/
</pre></li>
</ul>
<p>In this example:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">AUDIT_TRAIL_PURGE_NAME</code> specifies the name of the audit trail purge job. To find a list of existing purge jobs, query the <code class="codeph">JOB_NAME</code> and <code class="codeph">JOB_STATUS</code> columns of the <code class="codeph">DBA_AUDIT_MGMT_CLEANUP_JOBS</code> data dictionary view.</p>
</li>
<li>
<p><code class="codeph">AUDIT_TRAIL_INTERVAL_VALUE</code> updates the default hourly interval set by the <code class="codeph">DBMS_AUDIT_MGMT.CREATE_PURGE_JOB</code> procedure. Enter a value between <code class="codeph">1</code> and <code class="codeph">999</code>. The timing begins when you run the purge job.</p>
</li>
</ul>
<p>In a multitenant environment, where you run the <code class="codeph">DBMS_AUDIT_MGMT.SET_PURGE_JOB_INTERVAL</code> procedure depends on the location of the purge job, which is determined by the <code class="codeph">CONTAINER</code> parameter of the <code class="codeph">DBMS_MGMT.CREATE_PURGE_JOB</code> procedure. If you had set <code class="codeph">CONTAINER</code> to <code class="codeph">CONTAINER_ALL</code>, then the purge job exists in the root, so you must run the <code class="codeph">DBMS_AUDIT_MGMT.SET_PURGE_JOB_STATUS</code> procedure from the root. If you had set <code class="codeph">CONTAINER</code> to <code class="codeph">CONTAINER_CURRENT</code>, then you must run the <code class="codeph">DBMS_AUDIT_MGMT.SET_PURGE_JOB_INTERVAL</code> procedure from the PDB in which it was created.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="DBSEG480"></a>
<div class="props_rev_3"><a id="GUID-B5DD2078-5EFD-4979-BE22-643D4EC028EB"></a>
<h4 id="DBSEG-GUID-B5DD2078-5EFD-4979-BE22-643D4EC028EB" class="sect4">Deleting an Audit Trail Purge Job</h4>
<div>
<p>You can delete existing audit trail purge jobs.</p>
<div class="section">
<p>To find existing purge jobs, query the <code class="codeph">JOB_NAME</code> and <code class="codeph">JOB_STATUS</code> columns of the <code class="codeph">DBA_AUDIT_MGMT_CLEANUP_JOBS</code> data dictionary view.</p>
<ul style="list-style-type: disc;">
<li>
<p>To delete an audit trail purge job, use the <code class="codeph">DBMS_AUDIT_MGMT.DROP_PURGE_JOB</code> PL/SQL procedure.</p>
</li>
</ul>
<p>For example, assuming that you had created the purge job in the <code class="codeph">hrpdb</code> PDB:</p>
<pre dir="ltr">CONNECT aud_admin@hrpdb
Enter password: <span class="italic">password</span>
Connected.

BEGIN
 DBMS_AUDIT_MGMT.DROP_PURGE_JOB(
  AUDIT_TRAIL_PURGE_NAME  =&gt; &#39;Audit_Trail_PJ&#39;);
END;
/
</pre>
<p>In a multitenant environment, where you run the <code class="codeph">DBMS_AUDIT_MGMT.DROP_PURGE_JOB</code> procedure depends on the location of the purge job, which is determined by the <code class="codeph">CONTAINER</code> parameter of the <code class="codeph">DBMS_MGMT.CREATE_PURGE_JOB</code> procedure. If you had set <code class="codeph">CONTAINER</code> to <code class="codeph">CONTAINER_ALL</code>, then the purge job exists in the root, so you must run the <code class="codeph">DBMS_AUDIT_MGMT.SET_PURGE_JOB_STATUS</code> procedure from the root. If you had set <code class="codeph">CONTAINER</code> to <code class="codeph">CONTAINER_CURRENT</code>, then you must run the <code class="codeph">DBMS_AUDIT_MGMT.DROP_PURGE_JOB_INTERVAL</code> procedure from the PDB in which it was created.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="DBSEG481"></a>
<div class="props_rev_3"><a id="GUID-4AE3F98A-BB9E-437B-BCEB-4DA626F2302E"></a>
<h4 id="DBSEG-GUID-4AE3F98A-BB9E-437B-BCEB-4DA626F2302E" class="sect4">Clearing the Archive Timestamp Setting</h4>
<div>
<p>The <code class="codeph">DBMS_AUDIT_MGMT.CLEAR_LAST_ARCHIVE_TIMESTAMP</code> procedure can clear the archive timestamp setting.</p>
<div class="section">
<p>To find a history of audit trail log cleanup, you can query the <code class="codeph">UNIFIED_AUDIT_TRAIL</code> data dictionary view, using the following criteria: <code class="codeph">OBJECT_NAME</code> is <code class="codeph">DBMS_AUDIT_MGMT</code>, <code class="codeph">OBJECT_SCHEMA</code> is <code class="codeph">SYS</code>, and <code class="codeph">SQL_TEXT</code> is set to <code class="codeph">LIKE %DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL%</code>.</p>
<ul style="list-style-type: disc;">
<li>
<p>To clear the archive timestamp setting, use the <code class="codeph">DBMS_AUDIT_MGMT.CLEAR_LAST_ARCHIVE_TIMESTAMP</code> PL/SQL procedure to specify the audit trail type and for a multitenant environment, the container type.</p>
<p>For example, assuming that you had created the purge job in the <code class="codeph">hrpdb</code> PDB:</p>
<pre dir="ltr">CONNECT aud_admin@hrpdb
Enter password: <span class="italic">password</span>
Connected.

BEGIN
  DBMS_AUDIT_MGMT.CLEAR_LAST_ARCHIVE_TIMESTAMP(
   AUDIT_TRAIL_TYPE     =&gt;  DBMS_AUDIT_MGMT.AUDIT_TRAIL_UNIFIED,
   CONTAINER            =&gt;  DBMS_AUDIT_MGMT.CONTAINER_CURRENT);
END;
/
</pre></li>
</ul>
<p>In this example:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">AUDIT_TRAIL_TYPE</code> is set for the unified audit trail. If the <code class="codeph">AUDIT_TRAIL_TYPE</code> property is set to <code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_OS</code> or <code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_XML</code>, then you cannot set <code class="codeph">RAC_INSTANCE_NUMBER</code> to <code class="codeph">0</code>. You can omit the <code class="codeph">RAC_INSTANCE_NUMBER</code> setting if you set <code class="codeph">AUDIT_TRAIL_TYPE</code> to <code class="codeph">DBMS_AUDIT_MGMT.AUDIT_TRAIL_UNIFIED</code>.</p>
</li>
<li>
<p><code class="codeph">CONTAINER</code> applies the timestamp to a multitenant environment. <code class="codeph">DBMS_AUDIT_MGMT.CONTAINER_CURRENT</code> specifies the local PDB; <code class="codeph">DBMS_AUDIT_MGMT.CONTAINER_ALL</code> applies to all databases.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="DBSEG484"></a><a id="DBSEG483"></a>
<div class="props_rev_3"><a id="GUID-532781DA-B568-4F37-84B7-D051D564D355"></a>
<h3 id="DBSEG-GUID-532781DA-B568-4F37-84B7-D051D564D355" class="sect3">Example: Directly Calling a Unified Audit Trail Purge Operation</h3>
<div>
<p>You can create a customized archive procedure to directly call a unified audit trail purge operation.</p>
<p>The pseudo code in <a href="audit_admin.htm#GUID-532781DA-B568-4F37-84B7-D051D564D355__BCGJGCHA">Example 23-1</a> creates a database audit trail purge operation that the user calls by invoking the <code class="codeph">DBMS_ADUIT.CLEAN_AUDIT_TRAIL</code> procedure for the unified audit trail.</p>
<p>The purge operation deletes records that were created before the last archived timestamp by using a loop. The loop archives the audit records, calculates which audit records were archived and uses the <code class="codeph">SetCleanUpAuditTrail</code> call to set the last archive timestamp, and then calls the <code class="codeph">CLEAN_AUDIT_TRAIL</code> procedure. In this example, major steps are in <span class="bold">bold</span> typeface.</p>
<div class="example" id="GUID-532781DA-B568-4F37-84B7-D051D564D355__BCGJGCHA">
<p class="titleinexample">Example 23-1 Directly Calling a Database Audit Trail Purge Operation</p>
<pre dir="ltr"><span class="bold">-- 1. Set the last archive timestamp:</span>
PROCEDURE SetCleanUpAuditTrail()
 BEGIN
  CALL FindLastArchivedTimestamp(AUD$);
  DBMS_AUDIT_MGMT.SET_LAST_ARCHIVE_TIMESTAMP(
   AUDIT_TRAIL_TYPE          =&gt; DBMS_AUDIT_MGMT.AUDIT_TRAIL_UNIFIED,
   LAST_ARCHIVE_TIME         =&gt; &#39;23-AUG-2013 12:00:00&#39;,
   CONTAINER                 =&gt; DBMS_AUDIT_MGMT.CONTAINER_CURRENT);
 END;
/
<span class="bold">-- 2. Run a customized archive procedure to purge the audit trail records:</span>
BEGIN
  CALL MakeAuditSettings();
  LOOP (/* How long to loop*/)
    -- Invoke function for audit record archival
    CALL DoUnifiedAuditRecordArchival();
 
    CALL SetCleanUpAuditTrail(); 
    IF(/* Clean up is needed immediately */)
      DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL(
       AUDIT_TRAIL_TYPE        =&gt; DBMS_AUDIT_MGMT.AUDIT_TRAIL_UNIFIED,
       USE_LAST_ARCH_TIMESTAMP =&gt; TRUE,
       CONTAINER               =&gt; DBMS_AUDIT_MGMT.CONTAINER_CURRENT );
    END IF
  END LOOP /*LOOP*/
END; /* PROCEDURE */ 
/
</pre>
<p>If you want to modify this example for other audit trail types, be aware that additional steps may be required. For more information, see the Oracle Database 11<span class="italic">g</span> Release 2 (11.2) version of <span class="italic">Oracle Database Security Guide</span>, which is available from the following documentation library:</p>
<p><a href="http://www.oracle.com/pls/db112/homepage" target="_blank"><code class="codeph">http://www.oracle.com/pls/db112/homepage</code></a></p>
</div>
<!-- class="example" --></div>
</div>
</div>
<a id="DBSEG1028"></a><a id="DBSEG1027"></a>
<div class="props_rev_3"><a id="GUID-2AC6F69F-5BEA-4AC7-9A22-2966121A43ED"></a>
<h2 id="DBSEG-GUID-2AC6F69F-5BEA-4AC7-9A22-2966121A43ED" class="sect2">Audit Trail Management Data Dictionary Views</h2>
<div>
<p>Oracle Database provides data dictionary views that list information about audit trail management settings.</p>
<div class="section">
<p><a href="audit_admin.htm#GUID-2AC6F69F-5BEA-4AC7-9A22-2966121A43ED__CDCJJEFD" title="Audit Trail Admin Views">Table 23-1</a> lists these views.</p>
</div>
<!-- class="section" -->
<div class="tblformalwide" id="GUID-2AC6F69F-5BEA-4AC7-9A22-2966121A43ED__CDCJJEFD">
<p class="titleintable">Table 23-1 Views That Display Information about Audit Trail Management Settings</p>
<table class="cellalignment3691" title="Views That Display Information about Audit Trail Management Settings" summary="Audit Trail Admin Views">
<thead>
<tr class="cellalignment3671">
<th class="cellalignment3724" id="d147389e4885">View</th>
<th class="cellalignment3725" id="d147389e4888">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment3671">
<td class="cellalignment3726" id="d147389e4893" headers="d147389e4885">
<p><code class="codeph">DBA_AUDIT_MGMT_CLEAN_EVENTS</code></p>
</td>
<td class="cellalignment3727" headers="d147389e4893 d147389e4888">
<p>Displays the history of purge events of the traditional (that is, non-unified) audit trails. Periodically, as a user who has been granted the <code class="codeph">AUDIT_ADMIN</code> role, you should delete the contents of this view so that it does not grow too large. For example:</p>
<pre dir="ltr">DELETE FROM DBA_AUDIT_MGMT_CLEAN_EVENTS;
</pre>
<p>This view applies to read-write databases only. For read-only databases, a history of purge events is in the alert log.</p>
<p>For unified auditing, you can find a history of purged events by querying the <code class="codeph">UNIFIED_AUDIT_TRAIL</code> data dictionary view, using the following criteria: <code class="codeph">OBJECT_NAME</code> is <code class="codeph">DBMS_AUDIT_MGMT</code>, <code class="codeph">OBJECT_SCHEMA</code> is <code class="codeph">SYS</code>, and <code class="codeph">SQL_TEXT</code> is set to <code class="codeph">LIKE %DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL%</code>.</p>
</td>
</tr>
<tr class="cellalignment3671">
<td class="cellalignment3726" id="d147389e4932" headers="d147389e4885">
<p><code class="codeph">DBA_AUDIT_MGMT_CLEANUP_JOBS</code></p>
</td>
<td class="cellalignment3727" headers="d147389e4932 d147389e4888">
<p>Displays the currently configured audit trail purge jobs</p>
</td>
</tr>
<tr class="cellalignment3671">
<td class="cellalignment3726" id="d147389e4940" headers="d147389e4885">
<p><code class="codeph">DBA_AUDIT_MGMT_CONFIG_PARAMS</code></p>
</td>
<td class="cellalignment3727" headers="d147389e4940 d147389e4888">
<p>Displays the currently configured audit trail properties that are used by the <code class="codeph">DBMS_AUDIT_MGMT</code> PL/SQL package</p>
</td>
</tr>
<tr class="cellalignment3671">
<td class="cellalignment3726" id="d147389e4951" headers="d147389e4885">
<p><code class="codeph">DBA_AUDIT_MGMT_LAST_ARCH_TS</code></p>
</td>
<td class="cellalignment3727" headers="d147389e4951 d147389e4888">
<p>Displays the last archive timestamps that have set for audit trail purges</p>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<div class="section">
<div class="infoboxnotealso" id="GUID-2AC6F69F-5BEA-4AC7-9A22-2966121A43ED__GUID-487F0CDD-9967-48A8-BD82-F58793D764B7">
<p class="notep1">See Also:</p>
<a class="olink REFRN" target="_blank" href="../REFRN/toc.htm"><span><cite>Oracle Database Reference</cite></span></a> for detailed information about these views</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment3670">
<tr>
<td class="cellalignment3684">
<table class="cellalignment3675">
<tr>
<td class="cellalignment3674"><a href="audit_config.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment3674"><a href="part_7.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2006, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment3686">
<table class="cellalignment3673">
<tr>
<td class="cellalignment3674"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment3674"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment3674"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment3674"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment3674"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment3674"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>


</body></html>